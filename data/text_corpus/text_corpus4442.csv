index,text
22210,the floating oscillating surge wave energy converter foswec is a wave energy converter that was designed built and tested to develop an open access data set for the purpose of numerical model validation this paper details the experimental testing of the 1 33 scale foswec in a directional wave basin and compares experimental data to numerical simulations using the wave energy converter simulator wec sim open source code the foswec consists of a floating platform moving in heave pitch and surge and two pitching flaps power is extracted through relative motion between each of the flaps and the platform the device was designed to constrain different degrees of freedom so that it could be configured into a variety of operating conditions with varying dynamics the foswec was tested in a range of different conditions including static offset free decay forced oscillation wave excitation and dynamic response to regular waves in this paper results from the range of experimental tests are presented and compared to numerical simulations using the wec sim code keywords wave energy experimental testing numerical simulation wec sim validation 1 introduction wave energy converters wecs are devices designed to generate power by extracting energy from ocean waves these devices have been conceptualized researched and tested for decades however most wecs are considered to be at low to mid range technology readiness levels trls and have yet to reach utility scale commercialization weber 2012 unlike the wind industry that has largely converged on the three bladed horizontal axis wind turbine the wave energy industry is still evaluating a wide range of design archetypes with fundamentally different operating principles wecs are often categorized into the follow device types point absorbers attenuators oscillating wave surge devices oscillating water columns overtopping devices and pressure differential devices however due to the large range of existing design archetypes researchers often differ on their categorization of wecs cruz 2008 lopez et al 2013 this wide range of design archetypes has made numerical modeling and simulation of wecs a challenging research topic because the numerical requirements between wec designs vary substantially historically wecs have been modeled using numerical methods developed for naval architecture offshore oil and gas applications or custom built models for specific devices more recently commercial and open source codes have been developed specifically for modeling wecs numerical models of wecs must resolve complex hydrodynamics associated with wave device interaction body to body interactions moorings and electro mechanical dynamics at the power take off pto to predict device performance and response a common numerical approach for simulating wecs is to use the time domain cummins impulse response formulation cummins 1962 the cummins formulation requires hydrodynamic coefficients for added mass radiation damping and wave excitation details of which are provided in the following section using this formulation the radiation and excitation forces are converted from the frequency domain into their time domain equivalents in the form of impulse response functions through an inverse fourier transform typically these hydrodynamic coefficients are determined from a frequency domain boundary element method bem solution based on linear potential flow theory linear potential flow assumes inviscid fluid irrotational flow and small amplitude motion while this approach is common practice wec dynamics in real ocean waves violate these assumptions the advantage of the cummins formulation is that by moving from the frequency domain to the time domain nonlinearities can be included this allows for the inclusion of nonlinear effects such as drag proportional to velocity squared realistic implementation of nonlinear pto and control and modeling of complex mooring systems the example applications of this numerical approach are numerous ranging from modeling the searev device to the center for ocean energy research modeling competition to wavebob and powerbuoy inspired point absorbers to name a few josset et al 2007 garcia rosa et al 2015 beatty et al 2015 it is worth nothing that while the cummins formulation is a common numerical approach there are many other relevant approaches for modeling wecs for a detailed review of these methods refer to folley 2016 model verification and validation are essential for numerical method development which is commonly used to evaluate the confidence and accuracy of the model often in lieu of validation through comparison to experimental data numerical models go through verification via comparison to other numerical models i e a code to code comparison combourieu et al 2015 wendt et al 2017 on the other hand to ensure the numerical model accurately represents the physical system a validation study is often carried out by comparing the numerical solutions to measurements from experimental tests due to the wide variations in device archetypes differences in the dominant physics and intended application it is preferable to validate these models against wec specific experimental data lawson et al 2015 ruehl et al 2014 however the wave energy industry is still in the early stages of development and developers want to maintain a competitive advantage and preserve their intellectual property this means many experimental data sets are not made public and availability of nonproprietary open access data sets for validation is limited in the last few years this paradigm has begun to shift and there is now more focus on development open access data sets and open source codes for example the u s department of energy doe now requires data from all projects funded by the water power technologies office wpto to be posted to the marine and hydrokinetic data repository mhkdr mhkdr 2019 in addition to data available from doe wpto similar efforts to share and disseminate data are being made domestically and internationally opera 2019 in this study experimental wave tank tests and numerical simulations of a 1 33 scale floating oscillating surge wave energy converter foswec are compared the foswec was tested in a range of different conditions including static offset free decay forced oscillation wave excitation and dynamic response to regular waves in four different device configurations the numerical simulations are performed using the open source wec sim code and the simulation performance is evaluated in an a priori sense i e unadvised by experimental data and a posteriori in which the simulation has been tuned based upon experimental cases the foswec experimental data is available open access on the mhkdr and foswec data processing scripts are available on a public github repository sandia national laboratories 2019a b 2 foswec the device tested in this validation study is the 1 33 scale foswec shown in fig 1 the foswec consists of a floating platform orange with two pitching flaps yellow each flap hinges about a horizontal shaft and generates power through the relative pitch motion between the flap and platform the flaps each have a pto system consisting of a gearbox electric motor and torque transducer housed in a waterproof pto box they are also instrumented with a 6 degree of freedom dof load cell at the connection of the flap to the shaft and a rotary encoder a rendering of the foswec with the sensors labeled is shown in fig 1 the x axis is defined along the incident wave direction at the still water line swl as labeled at the top of fig 1 the geometric and mass properties of the foswec were determined from dry tests and are summarized in table 1 and fig 2 all moments of inertia are relative to the center of gravity c g for details on how these tests were performed refer to bosma et al 2016 and sandia national laboratories 2019a a motion constraint system was designed and built to selectively restrict the foswec s motion in order to vary the foswec s configuration to isolate individual degrees of freedom a rendering of the motion constraint arm is shown in fig 3 for more information about its design refer to sandia national laboratories 2019a the base of the constraint system is affixed rigidly to the basin floor and acts as a mooring system for the device in this way coupling between modes of motion could be isolated to allow for independent characterization the available dof for each of the four configurations is listed in table 2 for example in config 3 both flaps are free to move in pitch and the platform is allowed to move in heave implying that the pitch and surge constraints are engaged a load cell and position sensors were installed on the arm to measure 6 dof loads and motion in heave pitch and surge the motion constraint consists of three components 1 a surge guiderail constraint 2 pitch constraint and 3 heave constraint fixed to the basin floor the mass and inertia properties for the moving components of the motion constraint are defined in table 3 the mass and inertia of each moving component need to be included in numerical simulations depending on the motion constraint configuration details of which will be provided in the following section 3 wec sim wec sim is an open source code developed in matlab simulink as a library and accompanying scripts that utilize simscape multibody to solve for a wec s rigid body dynamics in the time domain the code allows users to model complex wec designs consisting of multiple bodies pto systems mooring systems and controls for a variety of wave conditions wec sim 2019 wec sim is based on linear wave theory in which the waves are assumed to be a linear superposition of incident radiated and diffracted wave components with added external forcing terms e g pto and mooring forces and empirical viscous damping terms wec sim solves the following time domain equation of motion due to wave forcing for each rigid body around its center of gravity 1 m a x f e x c t f r a d t f h s t f v i s t f p t o t f m t f e x t t where m is the mass and inertia matrix a is the added mass matrix at infinite wave frequency x is the body s displacement in 6 dof and a dot implies a time derivative f e x c t is the wave excitation force vector and f r a d t is the radiation damping force vector defined as 2 f r a d t 0 t k r t τ x τ d τ calculated by convolving the radiation impulse response function k r in each dof with the 6 element velocity vector x the radiation impulse response function k r is the inverse fourier transform of radiation damping defined as 3 k r t 2 π 0 b ω cos ω t d ω where b ω is radiation damping and ω is wave frequency in rad s the hydrostatic restoring force f h s t is defined as 4 f h s t k h s x where k h s is a 6 by 6 matrix of constant hydrostatic stiffness coefficients with units of n m in translation and nm rad in rotation and x is a 6 element displacement vector the viscous force f v i s t is defined as 5 f v i s t c v x c d ρ a s 2 x x c v x c d x x where c v is the linear viscous damping coefficient and the quadratic drag c d is a function of the drag coefficient c d water density ρ and the cross sectional area a s f p t o t is the force applied on the wec from the pto f m t is the mooring force and f e x t t is the external force from joints at the interface between component bodies the latter force is calculated by the multi body dynamics solver within simulink based upon user defined device geometry joint parameters and relative body motions further description of each of these forces will be provided in the following sections wec sim utilizes hydrodynamic coefficients in the frequency domain and determines their time domain equivalent in the form of excitation and radiation impulse response functions and infinite frequency added mass using the cummins formulation these hydrodynamic coefficients are typically determined from bem solutions but can also be determined experimentally for the wec sim solutions presented in this study the hydrodynamic coefficients were solved for using the bem code wamit lee and newman 2017 two wamit solutions for the foswec were run with 458 evenly spaced frequencies from 0 05 to 22 8 rad s one for all three bodies and another for the flap only the flap only wamit solution was run with the origin at the hinge location so that its results could be used for direct comparison to the experimentally determined wave excitation radiation damping and added mass the three body wamit solution was run so solve for body to body interactions and was used for all of the wec sim simulations e g free decay and wave cases the wamit solutions exclude the presence of the motion constraint which was assumed to have minimal effect on the hydrodynamic parameters of the foswec itself the foswec device was simulated in wec sim using the measured mass and inertia properties defined in tables 1 and 3 and using the hydrodynamic parameters determined from wamit in addition to experimentally determined parameters because the determination of some device parameters required limiting available dof constrained wec sim models were used in the simulations to be representative of experimental conditions denoted as config 1 config 4 all wec sim simulations were run using the parameters listed in table 4 an image of the wec sim simulink model is shown in fig 4 the platform gray and flaps yellow are modeled as hydrodynamic bodies the motion constraint is modeled as four nonhydrodynamic bodies red and blue and each of the joints are modeled as constraints white details of the validation effort are described in the following sections 4 experiments the foswec was evaluated in a series of experimental wave tank tests for comparison to the frequency domain wamit hydrodynamic coefficients and the time domain wec sim simulations with the experimentally observed device response the experimental tests were performed in the directional wave basin at the hinsdale wave research laboratory located at oregon state university hinsdale 2019 the test objectives were to determine the mass inertia the hydrodynamic properties of the foswec components as defined in eq 1 and the response of the device when subject to incident waves in different configurations table 2 a summary of the experimental wave tank tests performed and their corresponding test objectives is provided in table 5 this section will provide an explanation of the tests performed and the experimental derivation of the terms defined in eq 1 for more information about the tests performed and for a more detailed description of the test facility refer to bosma et al 2016 and ruehl et al 2016 unless otherwise noted device data e g loads positions were collected at 100 hz and wave sensor data was collected at 50 hz 4 1 static offset the objective of the static offset test is to determine the hydrostatic restoring coefficient k h s in each dof namely the flap in pitch and the platform in heave pitch and surge during each test all dofs aside from those being evaluated were locked the hydrostatic restoring force f h s referenced in eq 1 is the force exerted on a submerged body by the static fluid as defined in eq 4 x is a six element displacement vector and k h s is a 6 by 6 matrix of constant hydrostatic stiffness coefficients with units of n m in translation and nm rad in rotation for translation in heave the hydrostatic stiffness coefficient k 33 is defined as 6 k 33 ρ g a w p where ρ is the density of water g is the acceleration due to gravity and a w p is the cut water plane area for rotation in pitch the hydrostatic stiffness coefficient k 55 is defined as 7 k 55 ρ g i y ρ g v z g m g z b where i y is the second moment of area of the cut water plane area v is the submerged volume z g is the z coordinate of the center of gravity m is the body mass and z b is the z coordinate of the center of buoyancy it should be noted that while both k 33 and k 55 are modeled in wec sim as constant linear spring terms they are in fact nonlinear for example for motion in heave the cut water plane area a w p changes and for motion in pitch the submerged volume v is not constant it is also worth noting that there is no hydrostatic stiffness in surge i e k 11 0 to restore the foswec in surge a series of rubber bungee cords were installed on both sides of the motion constraint perpendicular to the surge guiderail and attached to the foswec such that they did not interfere with flap motion this restoring force is described as surge mooring stiffness k m the hydrostatic and mooring stiffness were determined from a series of static offset tests that will be detailed in the following sections 4 2 free decay the free decay test objectives are to determine the natural frequency ω n and estimate the total linear damping c t o t for each body in its relevant dof free decay estimates of damping are also used to validate the c d estimate of flap pitch forced oscillation tests free decay tests were performed for the flap in pitch and the platform in heave pitch and surge during each test all dofs aside from those being evaluated were locked data processing for each of the decay tests was completed in a similar manner however for the sake of brevity only the analysis of the flap s free decay will be described in this section with noted exceptions the same methodology was applied to the platform s free decay tests in heave pitch and surge for these free decay tests the pto drivetrain was disconnected because the pto was disconnected it can be assumed that the flap s free decay response is purely a hydrodynamic response with small frictional forces the flap was initially displaced with no incident waves to a prescribed angle and released the flap motion was then recorded until it returned to steady state at its equilibrium position under these test conditions eq 1 simplifies to 8 i y y a 55 θ c t o t θ c d θ θ k 55 θ where i y y is the moment of inertia in pitch a 55 ω d is the added mass in pitch at the damped natural frequency c t o t ω d b 55 ω d c v ω d is the total damping due to radiation damping and viscous damping at the damped natural frequency and θ is the flap angular displacement equivalent to x 5 bosma et al 2016 flap angular displacement was low pass filtered with a first order back to back finite impulse response filter to remove instrument noise without introducing a phase shift it should be noted that while b 55 ω and c v ω are frequency dependent damping values because free decay occurs at the damped natural frequency only the damping values at the damped natural frequency b 55 ω d and c v ω d are relevant similarly the total damping c t o t and c d are generally frequency dependent but only the c t o t ω d and c d ω d can be determined from free decay tests for decay tests the damping ratio ζ can be determined from time domain data following the logarithmic decrement method using the initial adjacent peaks inman 2008 based on the experimentally derived ζ linear damping is defined as 9 c l i n ω d 2 ζ i y y a 55 ω n where ω n is the natural frequency calculated from the observed damped natural frequency by 10 ω n 1 ζ 2 ω d for flap pitch decay in order to validate the quadratic damping coefficient estimations from the forced oscillation experiments free decay damping is temporarily assumed to have solely linear components expressed as c l i n for different initial displacements the mass normalized linear and quadratic components of damping can be estimated at ω d via linear regression as suggested by inman 2008 11 f v i s i y y a 55 c l i n θ i y y a 55 c t o t 8 c d ω θ 3 π i y y a 55 θ where mass normalized damping coefficients are then multiplied by i y y a 55 and a 55 is estimated from forced oscillation tests at a nearby frequency then compared to c t o t and c d estimates calculated in an analogous way from forced oscillation tests because forced oscillation tests were not performed for the platform in heave surge or pitch c d cannot be validated for the platform by this methodology therefore it is assumed that c l i n c t o t as calculated via eq 9 using bem estimate of added mass and c d is used as a simulation tuning parameter 4 3 wave excitation the objective of the wave excitation test is to determine the wave excitation force coefficient f e x c ω for this study only excitation torque on the flap in pitch was considered for direct comparison to the bem solution from wamit in order to isolate the forces on the flap to those exclusively due to wave excitation the device was locked in all degrees of freedom during the test as a result the left hand side of eq 1 goes to zero additionally because the flap and platform are fixed the radiation force f r a d hydrostatic force f h s viscous force f v i s pto force f p t o f e x t and mooring force f m are also zero thus the forces measured at the flap load cell will be equal to f e x c for this set of experiments wave calibration tests were carried out in the wave tank prior to installation of the foswec a wave gauge was placed at the future location of the foswec to measure the wave surface elevation at the center of the foswec prior to its installation and to ensure that the desired wave cases were repeatable this means that the wave field measured at the device location by this wave gauge includes only the undisturbed incident wave elevation additionally the wave basin was instrumented with an array of wave gauges both subsea and overhead that provided other spatially and temporally resolved measurements of the wave field the parameter space is summarized in table 6 where t is the wave period in s and h is the wave height in m at 1 33 scale wave generation was found to be highly repeatable for each of the wave cases marked with an x wave cases that were not found repeatable were not considered because it is not possible to measure purely excitation waves at the device location with the foswec device installed and the wave device interactions will generate additional waves wave data for the proceeding analysis comes from the wave calibration study for the appropriate wave case the wave excitation force is most commonly calculated in the frequency domain where it is a complex value having both a magnitude f e x c ω and a phase f e x c ω relative to the amplitude and phase of the wave field in this way the wave excitation force can be represented as 12 f e x c ω f e x c ω η ω where f e x c ω is the complex excitation force torque coefficient as a function of frequency and η ω is the frequency domain representation of the measured wave surface elevation time series η t for analysis of the regular wave excitation η t was restricted to 20 crest to crest wave cycles for which the first crest was at a minimum of 75 of the maximum recorded wave height for the run this criteria ensured that the wave field considered was fully developed and excluded initial transients related to start up of the wave maker further limiting the sampling duration ensures the actual wave field is well approximated by η t as determined by the wave calibration study for which the foswec was absent and that device generated waves do not have sufficient time to reflect off of basin boundaries and affect the measured forces after propagating back to the device the measured forces over this time interval were considered each time series was low pass filtered via a first order back to back finite impulse response filter to remove instrument noise without introducing a phase shift the amplitudes of the nominally sinusoidal time series were calculated for force and wave height for each cycle and the median ratio for each cycle was taken as an estimate of the average excitation coefficient magnitude a 95 confidence interval was calculated by examining the standard deviation of the f e x c ω calculated for each of the included 20 cycles by using multiple regular wave runs at various amplitudes and periods an estimate of f e x c ω was determined and its nonlinear dependence on wave amplitude was assessed 4 4 forced oscillation the forced oscillation test objectives are to experimentally determine the added mass a ω total damping c t o t ω and quadratic drag c d this test was run in still water by controlling the pto to force the flap to oscillate at different combinations of periods and amplitudes with the platform constrained in all degrees of freedom and measuring the corresponding force the radiation damping force refers to the forces exerted on an oscillating body by the wave radiated as a result of the body s oscillation the radiation force in the time domain is defined by the convolution integral eq 2 under this operating condition the dynamic equation for the flap in pitch simplifies to 13 f p t o t k h s θ i y y a 55 θ c t o t θ c d θ θ where f p t o t is the driving pto force c t o t ω b 55 ω c v ω is the total linear damping at the oscillation frequency consisting of radiation damping b 55 ω and the linear viscous damping coefficient c v ω and c d ω is the quadratic drag term as shown in eq 13 by subtracting the hydrostatic contribution from the measured pto force the added mass a 55 ω total damping c t o t ω and quadratic drag c d ω can be extracted by considering different points in the forced oscillation forced sinusoidally a point of maximum velocity has an acceleration of zero and vice versa ideally this allows for the damping forces proportional to velocity to be separated from the inertia forces proportional to acceleration by analyzing velocity maxima and acceleration maxima separately as in beatty et al 2015 however in practice velocity maxima did not occur simultaneously at zeros of acceleration and vice versa likely due to a small dead band observed in the flap position sensor near x 0 and drive train slack as such this method was not perfectly applicable for the foswec data set further work by brown et al 2017 has highlighted the frequency independence of c d over small ranges of the keulegan carpenter k c number which can be calculated for the prescribed sinusoidal oscillations 14 k c θ t l where θ is the amplitude of the angular velocity oscillation t is the period of oscillation and l is the amplitude of oscillation in rad traditionally k c is derived in terms of linear distances and translational velocities the k c number was found to be nearly constant across prescribed tested conditions for forced oscillation and therefore c d was presumed constant over the range of ω tested the range of k c numbers is calculated from observed test conditions to validate this assumption additionally simulation results were found to be insensitive to adjustments to c d within an order of magnitude so any modeling errors introduced due to this approximation are minor the considered time series was restricted to symmetric oscillations at the prescribed amplitude and filtered using the same method as in the wave excitation studies this served to exclude any transients related to start up and to reduce the impact of any position varying parameters for some test cases this combination of conditions severely limited or entirely eliminated the available data these cases have been flagged in the data set beginning at a velocity peak the data were then windowed to one half of an oscillation period ensuring both large accelerations and velocities would be included in the window because θ θ is highly correlated with θ it is not possible to solve simultaneously for c d and c v in a least squares sense so a two step procedure was adopted firstly hydrostatic contributions were subtracted from each window and eq 13 was solved in a least squares sense for damping and added mass assuming all damping drag viscous and radiation c l i n is proportional to pitch velocity 15 f p t o k h s θ θ θ c l i n i y y a 55 then using different amplitudes of θ at a given frequency the linearization proposed by inman 2008 and utilized by van riij et al 2017 was adopted to calculate a c d estimate for each oscillation frequency via linear regression 16 f v i s c l i n θ c t o t 8 c d ω θ 3 π θ such that the y intercept of the fitted line is the linear damping term c t o t the combination of radiation and viscous damping and the slope proportional to 8 ω θ 3 π is the quadratic coefficient c d by earlier arguments c d is assumed to be constant over tested conditions and as such the estimates for c d for each frequency of oscillation were averaged for a more robust estimate with the estimate for c d the contribution of quadratic drag was removed along with hydrostatic contributions from the measured force and the added mass and linear damping parameters were recalculated for each test case by 17 f p t o k h s θ c d θ θ θ θ c t o t i y y a 55 where c t o t ω is the frequency dependent contribution of the linear damping details of the resulting comparisons between experimental data and numerical simulations will be detailed in the following sections 4 5 regular wave the objective of the regular wave test is to characterize the foswec s response to regular waves with various device configurations corresponding to config 1 config 4 in the first configuration config 1 only the front flap s motion in pitch is free to move config 2 allows both flaps to pitch and thus includes the motion of two interacting flaps config 3 allows both flaps to pitch and the platform to move in heave the final configuration config 4 allows both flaps to pitch and the platform to move in heave pitch and surge for wave response tests the wave basin generated several sets of regular wave fields see table 6 measurement of the foswec motion was achieved via encoders mounted on each flap to measure pitch response and sensors mounted on the platform to measure response in heave pitch and surge refer to fig 1 additionally 6 dof load cells were mounted on each shaft to measure the loads on the flaps and a 6 dof load cell was mounted on the arm s connections to the platform to measure its loads results from regular wave response tests are presented as response amplitude operators raos for each of the four foswec configurations where the rao is defined as the ratio between the magnitude of response to the incident wave height 18 r a o ω x h where x is the peak to peak motion response magnitude and h is the wave height as determined from a corresponding wave calibration run for translational motion response the rao has units of m m and for rotation motion response the rao has units of deg m similar to the data analysis of the wave excitation tests analysis of the regular wave response x was filtered and restricted to ensure that the wave field considered was fully developed and excluded initial transients related to start up of the wave basin raos were then calculated using 20 crest to crest wave cycles of fully developed response 5 results 5 1 static offset static offset tests were performed for the flap in pitch and the platform in heave pitch and surge corresponding to each of the foswec s degrees of freedom these tests were performed by offsetting the body in each degree of freedom holding it statically at varying displacements and measuring the resulting force torque for more information about the hydrostatic test setup refer to bosma et al 2016 and sandia national laboratories 2019a when running wec sim with linear hydrostatics the hydrostatic restoring force is modeled as a function of the body s displacement multiplied by a constant hydrostatic stiffness coefficient k h s as defined in eq 4 when hydrostatic stiffness is modeled as a constant coefficient a linear regression was fit between measured force torque and displacement and the correlation coefficient r 2 of the fit was calculated any nonlinearity will reduce r 2 an overview of the resulting k h s and r 2 values for each dof is presented in table 7 and a discussion of the results is given in the following sections the experimentally derived k h s is always larger than the hydrostatic stiffness determined by the wamit solution this is because in the as built system there are stiffness terms in addition to hydrostatic stiffness caused by the physics of joints constraints ptos and the surge restoring bungees 5 1 1 flap pitch the relationship between hydrostatic torque measured at the hinge and angular displacement of the foswec flap is shown in fig 5 top left as expected from the flap s geometry the hydrostatic torque increases with flap angular displacement because the perpendicular distance to the flap center of mass at which the buoyancy force acts increases with the displacement angle refer to eq 7 in addition since the flap is a wedge shape which is above the water surface at equilibrium the relationship between water displacement and flap displacement in pitch is expected to be nonlinear this results in a slightly higher correlation coefficient for a quadratic fit r 2 0 988 when compared to the linear regression the results of this test demonstrate that while k 55 may be slightly nonlinear a linear hydrostatic stiffness for the flap in pitch is still an appropriate assumption however the effect of this nonlinearity is most pronounced at small and large angles of displacement and the resulting linear fit predicts zero force at zero displacement inspection of the experimental data and the polynomial fit indicates a nonzero torque value at zero displacement indicating the presence of static friction significant static friction is unsurprising given the large drivetrain gear ratio and highlights a shortcoming of the linear fit the experimentally determined hydrostatic stiffness is nearly double the wamit estimate the flap pitch static offset test was performed with the flap pto connected and there is additional stiffness in the system caused by the physics of the pto drivetrain not modeled by wamit 5 1 2 platform heave the relationship between hydrostatic force measured from the overhead crane and displacement of the foswec platform in heave is shown in fig 5 top right for translation in heave the foswec has a strongly linear relationship between measured force and displacement with a hydrostatic stiffness of k 33 7150 n m and correlation coefficient of r 2 0 9998 a linear relationship for k 33 is expected in this range because while there are changes in the cut waterplane area of the platform in heave for very large displacements z m i n 0 06 m and z m a x 0 37 m when the platform is fully submerged or out of the water the static offset test was performed for displacements with small changes in the cut waterplane area the results of this test demonstrate that a linear hydrostatic stiffness for the platform in heave is appropriate however comparison of the experimentally derived stiffness to the hydrostatic stiffness determined by wamit k 33 5610 n m demonstrates that the motion constraint in heave provides an additional stiffness that is not fully captured by hydrostatics alone as shown in table 7 5 1 3 platform pitch the relationship between hydrostatic torque and rotation of the foswec platform in pitch is shown in fig 5 bottom left similar to the results for heave for rotation in pitch the foswec also has a strongly linear relationship between measured torque and displacement with a hydrostatic stiffness of k 55 p 39 8 nm deg and a correlation coefficient of r 2 0 996 the strongly linear relationship for k 55 p is expected because while there are changes in the submerged volume of the platform in pitch the foswec platform s pitch range of motion is small less than 10 so the resulting change in displaced volume is relatively small again a comparison of the experimentally derived stiffness to the hydrostatic stiffness determined by wamit k 55 p 21 2 nm deg indicates nonhydrostatic sources of stiffness table 7 note that in both experimental and wamit evaluations the platform pitch and heave hydrostatic responses are evaluated with the flaps attached as there were no considered device configurations in which the flaps were not present 5 1 4 platform surge as mentioned in the previous section there is no hydrostatic restoring force in surge bungee cords were installed on the foswec s motion constraint arm in lieu of a traditional mooring system to restore the foswec s displacement in surge therefore no restoring force from wamit the surge static offset test was used to characterize the bungee force as a function of surge displacement the relationship between hydrostatic force measured from the overhead crane used to laterally displace the device and translation of the foswec platform in surge is shown in fig 5 bottom right of the static offset tests performed the surge test had the poorest linear fit between measured force and displacement with a surge mooring stiffness of k m 963 n m and a correlation coefficient of r 2 0 961 see table 7 however while the other linear fits had higher correlation coefficients the linear regression for surge force still appears to capture the overall trend of the data particularly the nonzero intercept predicted by the linear fit indicates the presence of significant static friction in the surge guiderails and deviations from the linear trend suggest nonlinear behavior in the bungees 5 2 free decay free decay tests were performed by offsetting the body to various initial displacements in each degree of freedom releasing the body from its initial displacement and measuring the resulting motion response to steady state equilibrium the purpose of the free decay test was to determine the natural period t n of the foswec in each dof and estimate the corresponding total damping c t o t as described in table 5 additionally the flap free decay test was used to validate estimates of c t o t and c d calculated separately from forced oscillation testing an overview of the results from the free decay tests is shown in table 8 and details of each test will be described in the following sections recall that c d for flap pitch indicated by an asterisk in table 8 was calculated from eq 11 using an added mass estimate from forced oscillation testing while other c d values were selected by tuning parameters further the added mass estimate used to normalize flap pitch damping coefficients was from forced oscillation experimental data while other degrees of freedom were estimated using bem added mass predictions 5 2 1 flap pitch the flap decay for each initial displacement is shown in fig 6 top left with 95 confidence intervals indicated at the minimums and maximums utilized by the logarithm decrement method the damping ratio for each initial displacement was calculated and the mean total damping c t o t was determined the total damping was then subtracted by the radiation damping to determine the mean viscous damping c v 4 68 nms rad which was applied in the wec sim simulation on the flap in pitch similarly a drag of c d 7 45 nm rad 2 s s the product of the slope of eq 11 and i y y a 55 the added mass estimate from the tested forced oscillation frequency ω 1 90 rad s the closest to ω d was used in simulation the comparison between these parameters and those derived from forced oscillation testing is discussed in the forthcoming section the experimentally observed natural period is relatively constant for each initial displacement with a damped natural period of 4 43 s 4 35 s and 4 33 s for the 10 15 and 20 initial offsets respectively the corresponding simulated flap pitch decay damped natural periods estimated as the time from release to the first local maximum are 4 37 s 4 35 s and 4 32 s a comparison of the experiment to simulation results shows that wec sim accurately estimates the damped natural period and that the pitch decay rate accurately approximates the experimental rate until the oscillations become 10 of the initial displacement it should be noted that although the results of the flap static offset include the pto drivetrain the flap free decay tests were performed with the pto drivetrain disconnected to approximately isolate the hydrodynamic effects however the more abrupt decay in experiment suggests that the static bearing friction not modeled in simulation likely becomes significant for small flap oscillations 5 2 2 platform heave the platform heave decay results for each initial displacement are shown in fig 6 top right with 95 confidence intervals indicated at the minimums and maximums the mean viscous damping was determined to be c v 502 4 ns m which was then applied in the wec sim simulations for the platform decay in heave because forced oscillation tests were not completed for the platform drag was used as a tuning parameter and a drag of c d 300 ns 2 m 2 was selected to provide the best fit as shown in fig 6 top right the experimental natural period for each heave decay initial displacement remains relatively constant slightly increasing with larger initial displacement the experimental heave decay damped natural periods are 1 52 s 1 54 s and 1 56 s for the 7 cm 10 cm and 15 cm initial offsets respectively the corresponding simulated platform heave decay damped natural periods are 1 35 s 1 36 s and 1 38 s while there is a discrepancy between the experimental and simulated natural periods it can be observed that the wec sim simulations are within the 95 confidence intervals at the first negative peak t 0 72 s capturing both the period and magnitude of oscillation the difference between simulated and observed heave decay occurs at small relative displacements z z 0 0 2 and is likely due to unmodeled static friction in the heave telescoping constraint this effect is exemplified through the experimental results for the smallest initial displacement of z 0 7 cm when compared to the larger initial displacements wherein the first negative peak has the largest relative displacement but the smallest relative displacement at the first positive peak t 1 51 s this experimental observation is typical of a system dominated by friction an overview of these experimental and simulated results is shown in table 8 5 2 3 platform pitch the platform pitch decay for each initial displacement is shown as fig 6 bottom left with 95 confidence intervals indicated at the minimums and maximums the mean viscous damping c v 14 nms rad was applied in the wec sim simulation on the platform in pitch because forced oscillation tests were not completed for the platform drag was used as a tuning parameter and a drag of c d 25 2 nm rad 2 s s was selected to provide the best fit the natural period is relatively constant for each initial displacement with a damped natural period of 1 66 s 1 68 s and 1 68 s for the 5 7 and 8 4 initial offsets respectively the corresponding simulated platform pitch decay damped natural periods are 1 63 s 1 64 s and 1 66 s like the flap pitch decay test the pitch decay rate is slightly overdamped in the experimental data compared to the simulations this is demonstrated by the fact that the simulation results are within the 95 confidence intervals for the regions of larger relative displacement θ θ 0 0 3 this again suggests that unmodeled static friction may become significant at small displacements 5 2 4 platform surge the platform surge decay for each initial displacement is shown as fig 6 bottom right with 95 confidence intervals indicated because this oscillation is an overdamped system the logarithmic decrement method is inappropriate for damping ratio determination the damping ratio and natural frequency for each initial displacement was instead calculated using an iterative least squares fit of the canonical equation of a normalized damped harmonic oscillator 19 y t 1 exp ζ ω n t cos ω n t 1 ζ 2 ζ 1 ζ 2 sin ω n t 1 ζ 2 using matlab s fminsearch function from the fitted damping ratio and natural frequency the mean total damping c t o t was determined using the same method as for previous free decay tests the total damping was then subtracted by the radiation damping to determine the mean viscous damping c v 347 ns m and was applied in the wec sim simulation on the platform in surge because forced oscillation tests were not completed for the platform drag was used as a tuning parameter and a drag of c d 7808 ns 2 m 2 was selected to provide the best fit based on the results from the static offset test in surge a mooring stiffness of k m 963 n m was applied in surge to model the effect of the bungees the surge decay experimental and numerical comparison shows that the results decay at a similar rate but the wec sim results have substantial overshoot in comparison to the experimental data this is likely because the bungees are nonlinear in nature and the presence of unmodeled static friction along the surge guide rail nonetheless the numerical and experimental comparison is acceptable considering the underlying dynamics for surge decay are not modeled by hydrodynamics the driving force in this case is the restoring bungee force it should also be noted that the large drag is expected because the surge decay test was performed with both flaps locked in the vertical position so any movement in surge would have to overcome a large drag force caused by the surface area of the flaps refer to eq 5 5 3 wave excitation the purpose of the wave excitation test is to determine the wave excitation force coefficient f e x c on flap 1 as described in table 5 wave excitation tests were performed by locking the flap motion in pitch and measuring the resulting wave loading at the load cell mounted on the hinge this experiment was performed for a range of incident wave conditions corresponding to the regular waves with different combinations of wave period and wave height as listed in table 6 results from the wave excitation experiments were then compared to the flap s bem solution in wamit which were calculated with the origin at the hinge location to restrict all wave excitation to the pitch dof this allows for direct comparison to the experimental results a comparison between wave excitation force coefficients f e x c for flap 1 measured from regular wave experiments with 95 confidence intervals and the corresponding bem solution from wamit is shown in fig 7 the experimentally determined wave excitation force coefficient was measured from the load cell mounted on the flap s shaft thus the relevant dof is flap rotation in pitch because wec sim solves for a wec s motion about each body s c g the bem solution used by wec sim must be solved at the c g however for these comparisons the wamit solution was solved with the origin at the hinge location to allow for direct comparison between the measured wave excitation force coefficient from the experiments to that from wamit analysis of the experimentally determined wave excitation from regular wave tests does not show a strong dependence on wave height this is demonstrated by the fact that over most of the explored wave frequencies the measured wave excitation force coefficients fall within the 95 confidence intervals of the other wave heights this confirms the linear assumption for wave excitation on the flap meaning that the wave excitation coefficient for the flap can be assumed to be frequency dependent but not also amplitude dependent it should be noted that at ω 4 rad s the largest wave height exhibited overtopping reducing the excitation force coefficient significantly over the smaller wave heights fig 7 shows that the measured wave excitation force coefficients follow a similar curve shape as the wamit solution however wamit consistently underpredicts the excitation force coefficient for wave frequencies ω 4 rad s corresponding to t 1 57 s the underprediction of the wave excitation coefficient from the wamit solution for t 1 57 s is expected because wamit only solves for the excitation force on the wetted surface of the body in still water however substantial wave runup and overtopping were observed during the wave excitation tests especially for the longer wave periods the runup and overtopping were partially caused by the fact that the foswec platform was fixed in order to measure the wave excitation force thus the foswec was unable to heave along with the free surface as would typically be the case for floating bodies additionally the foswec flaps are surface piercing with a freeboard of 0 12 m and wave excitation tests were performed for wave heights of h 0 015 m 0 045 m and 0 136 m as a result the experimentally derived wave excitation coefficient is expected to have a larger magnitude because the true wetted surface of the flap and resulting torque are larger than those solved for by wamit a notable departure from the experimental trend occurs for ω 5 2 rad s for which experimental estimates of wave excitation exhibit substantially increased uncertainty i e large standard deviations and reduced mean values both flaps were locked vertically during the excitation tests this resulted in standing waves reflections from downstream flap contained by the buoyancy floats at this frequency these reflections were significant and out of phase with the upstream flap as evidenced by an atypically large excitation coefficient for flap 2 at this frequency not shown this interference decreased the observed load on flap 1 and reduced the excitation coefficient further the phase variation between the excited wave and the radiated wave from the second flap would contribute to the higher cycle to cycle variation observed in the excitation coefficient since this wamit was run using only a single flap excluding the downstream flap and buoyancy floats this body to body interaction was not present in bem parameter estimates the bem estimate would have likely been more representative if the downstream flap was locked in a horizontal position such that wave reflections were reduced 5 4 forced oscillation the purpose of the forced oscillation tests was to determine the added mass a 55 ω and radiation damping b 55 ω components of the radiation force on flap 1 as described in table 5 forced oscillation tests were performed in still water by controlling the pto to force flap 1 to oscillate at different combinations of periods and amplitudes the force required to drive the flap in oscillation was measured corresponding to the radiation force by subtracting the hydrostatic and quadratic damping contributions to measured force according to eq 13 an experimental estimation of viscous damping and added mass were made assuming a constant c d over the relatively constant k c number the observed k c numbers calculated using eq 14 show small variation as shown in table 9 at high frequencies of forced oscillation particularly at high amplitudes wave overtopping was prevalent as a result eq 16 does not have a positive slope at these frequencies yielding a nonphysical negative estimate for c d further asymmetric oscillations were more prevalent under high frequency test conditions decreasing the number of valid tests and as a result the number of points in the linear regression eq 16 diminishing confidence in this estimate finally brown et al 2017 derives the k c number independence of c d using morison s equation which is appropriate for slender bodies for which wave diffraction effects can be neglected at higher tested frequencies this is a poor assumption for the foswec device because the wavelength implied at these frequencies approximates flap length for these reasons estimations of c d were excluded from the average for cases ω 5 rad s this resulted in a c d estimate of 14 22 nm rad 2 s 2 comparisons of the experimentally determined added mass a 55 ω and radiation damping b 55 ω to the bem solution from wamit are shown in fig 8 in fig 8 experimentally determined c t o t ω and a 55 ω are plotted with colored squares for each oscillation amplitude and results from the bem solution in wamit are plotted with a solid black line bars indicate the 95 confidence interval of least squares parameter estimation for each calculation window small bars indicate little cycle to cycle variation as expected the experimentally determined total damping c t o t ω is much larger than the wamit solution of b 55 ω shown on the left hand side of fig 8 this is unsurprising as the bem solution is based on a potential flow solution method and thus excludes the contribution due to viscosity c v ω in order to determine the contribution due to viscosity c v ω was applied in all wec sim simulations and the difference between c t o t ω and b 55 ω was used similarly a comparison between the experimentally determined added mass and the wamit solution is shown on the right hand side of fig 8 bem added mass underpredicts experimental results at low frequencies corresponding to ω 3 rad s and overpredicts for 3 ω 6 rad s note that the resulting estimate of c t o t at the highest frequency is less than the bem estimated damping implying c v 0 refer to eq 17 in addition to the comparison of the wamit solution to the experiments it is worth noting the effect of oscillation amplitude on experimentally determined coefficients each of the forced oscillation tests was performed for the range of oscillation periods defined in table 6 and for three different magnitudes corresponding to δ θ 5 10 and 20 where δ θ is the difference between the maximum displacement and steady state equilibrium the experimentally determined c t o t ω only demonstrates significant dependence on oscillation magnitude for the largest wave frequency where a larger oscillation magnitude corresponds to smaller total damping at midrange frequencies ω 4 rad s ω 3 rad s there is a smaller dependence on magnitude and the trend is reversed larger oscillations exhibit increased damping the experimentally determined a 55 ω only demonstrates amplitude dependence for ω 3 3 rad s where the numerical result agrees closely with the experimental results using the ω 1 9 rad s forced oscillation case the average of the added mass values as there is little amplitude dependence was multiplied with the free decay mass normalized estimates of damping coefficients refer to eq 11 and table 8 for comparison with forced oscillation derived damping estimates the discrepancy between forced oscillation and free decay damping estimates is small unlikely to affect simulation accuracy and is explainable first the trend in added mass suggests that the added mass at ω d likely was larger than at ω 1 9 rad s therefore the decay test damping estimates were likely underestimated by this method second c d can only be presumed constant for a constant k c number while that was shown to be approximately true for forced oscillation testing it is untrue for free decay tests which oscillate at a fixed period t d but through diminishing velocity amplitude a free decay test would have covered a range of k c numbers and some discrepancy in c d estimate might thus be expected meanwhile the c v estimate from free decay appears to be smaller than the forced oscillation estimate perhaps again suggesting an underestimated added mass the experimentally derived c v ω and c d terms from forced oscillation testing were applied to all regular wave simulations based on their observed frequency and amplitude dependence 5 5 wave response the purpose of the wave response test was to characterize the foswec s response to regular waves with various device configurations corresponding to config 1 config 4 as described in table 5 wave response tests were performed for four different configurations of the foswec each with different degrees of freedom and resulting dynamics config 1 corresponds to flap 1 pitch motion config 2 corresponds to flap 1 and flap 2 pitch motion config 3 corresponds to the addition of platform heave motion and config 4 allows both flaps to pitch and the platform to move in heave pitch and surge the directional wave basin at the hinsdale wave research laboratory generated regular wave fields which is summarized in table 6 at 1 33 scale these wave cases were selected because they were found to be highly repeatable during the wave calibration runs each of the wave cases listed in table 6 were run once for config 1 and all of the wave cases except h 1 0 015 m were run for config 2 config 4 to simplify comparisons between configurations h 1 results are omitted from config 1 plots for all configurations wave cases of h 2 0 045 m and t 1 22 1 91 and 2 61 s were repeated three times to demonstrate the repeatability of the measured rao response in the following sections comparison of the experimentally measured response of the foswec is compared to the numerical simulations for the same conditions the results are presented as raos for each of the four foswec configurations where the rao is defined by eq 18 5 5 1 config 1 comparison of the experimentally determined rao for config 1 to wec sim simulations is shown in fig 9 experimentally measured raos are plotted with colored squares for each wave height and rao results from wec sim simulations are plotted with dotted lines and square markers standard deviation bars refer to the standard deviation of the parameter estimation for each cycle small standard deviation bars indicate little cycle to cycle variation for the wec sim raos the simulations were run with linear hydrodynamics which explains why the resulting simulations have similar trends for different wave heights wec sim closely estimates the rao for all wave frequencies except the lowest frequency this is expected because the flap is near resonance at the lowest wave frequency and potential flow based codes are known to be inaccurate near resonance this is exemplified through the comparison between the experimentally derived radiation terms shown in fig 8 for all of the wec sim simulations the radiation damping and drag coefficients were modified based on the results of the forced oscillation tests in the form of c v and c d however the added mass was not adjusted the experimentally determined added mass a 55 ω is much larger than the bem solution for ω 3 rad s which explains why the wec sim simulation overpredicts the flap s pitch motion response for low frequencies additionally the presence of static friction as suggested during hydrostatic and decay tests would likely reduce the experimentally observed rao magnitude for cases of lower wave excitation forces which inspection of fig 7 suggests will occur at the lowest tested wave frequency if the simulation had been adjusted to account for the experimentally derived added mass and modeled the static friction the simulated rao near the resonance would likely have better agreement with the measurements this is an area of future investigation nonetheless the simulated rao has good agreement with the experimental values for most wave periods 5 5 2 config 2 comparison of the experimentally determined raos for config 2 to wec sim simulations are shown in fig 10 similar to the results from config 1 wec sim does a good job estimating the raos for both flaps at all wave frequencies except the lowest frequency the explanation for this discrepancy is also similar since for config 2 each of the flaps added mass at low frequencies was significantly underestimated by the wamit solution however for wave frequencies greater than the flap s resonance ω 2 rad s the rao response is within reasonable error 5 5 3 config 3 comparison of the experimentally determined raos for config 3 to wec sim simulations are shown in fig 11 similar to config 1 and config 2 wec sim simulations for config 3 were run with linear hydrodynamics the simulated and experimental rao response for flaps 1 and 2 are similar to those from config 2 and demonstrate the same divergence near resonance and agreement for ω 2 5 rad s config 3 is the first configuration to include the motion response from the platform where the platform is free to move in heave unlike the characterization of the flap through forced oscillation tests the platform did not undergo tests to experimentally determine c t o t ω c d ω and a ω as a result the hydrodynamic coefficients for the platform are based on the results from the wamit solution c v from free decay testing and c d used as a tuning parameter nonetheless the numerical simulations from wec sim for the platform s heave motion response agree well versus the experimental raos at all wave frequencies the wec sim results systemically overpredict the platform s heave response but they are within reasonable error and predict the overall shape of the rao curve well wec sim overprediction of the heave response is likely because the physics of motion constraint are not fully captured in the simulation particularly any influence of static friction the presence of which was suggested by the hydrostatic and free decay tests for this degree of freedom as discussed in previous sections the motion constraint provided a mechanism through which the foswec could be easily configured to operate in different degrees of freedom 5 5 4 config 4 comparison of the experimentally determined raos for config 4 to wec sim simulations are shown in fig 12 the simulated and experimental rao response for flap 1 flap 2 and platform heave are similar to those from config 3 albeit with a notable reduction in experimental platform heave rao amplitude for ω 3 29 rad s indicating that the availability of surge and platform pitch degrees of freedom reduces heave response at these frequencies in addition platform heave and both pitching flaps config 4 also includes platform motion in surge and pitch as with platform heave forced oscillation tests were not performed on the platform hydrodynamic coefficients for the platform were determined in the same way as config 3 additionally for the surge dof a mooring stiffness k m was applied based on the surge static offset test particularly at low frequencies experimental surge rao magnitudes show a strong dependence on wave height while the simulated rao shows significantly less sensitivity this could be explained by the influence of unmodeled static friction small waves could not overcome this force resulting in an rao near zero while large waves could significantly larger surge raos were observed in the experiment than predicted by simulation suggesting bem estimates of hydrodynamic parameters may be poor at these frequencies for platform motion in pitch the wec sim rao estimates the rao curve shape but the pitch rao magnitude is systematically overpredicted for all but the largest wave frequencies particularly simulation predicts a peak at ω 5 2 rad s that is not observed in the experimental data it is also worth observing the difference in raos for the different experimental configurations due to coupling between degrees of freedom for ease of direct comparison the rao for each dof is plotted on the same axis scale for config 1 config 4 looking at the experimental raos for flap 1 across all configurations it is clear that the experimental raos for config 1 have the largest overall magnitude with r a o 200 deg m for ω 4 rad s for h 2 in this configuration only flap 1 is allowed to move thus there is no coupling between degrees of freedom once flap 2 is free to move in config 2 the range of r a o 200 deg m for flap 1 is reduced for ω 2 8 rad s and ω 3 3 rad s corresponding to t 2 26 s and t 1 91 s respectively similarly the inclusion of the platform motion in heave for config3 reduces the instances of flap 1 r a o 200 deg m to a single wave frequency ω 3 3 rad s corresponding to t 1 91 s and once the platform is free it move in heave pitch and surge there are zero instances of flap 1 r a o 200 deg m similar observations can be made about the effects coupling between degrees of freedom have on other raos further it is notable that the observed experimental reduction in rao of flap 1 is not always reflected by the simulated estimate this suggests a potential limit of the linear simulation as for reasons highlighted above this reduction is due principally to nonlinear effects gaining a better understanding of the influence of coupling between degrees of freedom and body to body interactions was the primary motivation for selecting a device like the foswec which can be configured to include different operating dynamics 5 6 time series comparison in addition to comparing raos it is desirable that a simulation can accurately predict time resolved wec behavior when provided with experimentally or numerical estimates of hydrodynamic parameters to this end the time series representations of two config 1 raos are presented as fig 13 the results provided are for a common wave period of t 6 2 61 s but for two different wave heights h 2 0 045 m and h 3 0 136 m as noted in the previous discussions the error in the h 3 0 136 m case is attributed to nonlinear position dependent response to wave excitation larger waves tended to oscillate the flaps more asymmetrically in the experiment as mean flap angle departs from zero only a component of the wave excitation force will impart flap motion resulting generally in simulation overpredicting the rao for larger wave heights the relative asymmetry of the experimental data and the reduced amplitude of oscillation align with this reasoning for the common frequency of oscillation it is unlikely that unmodeled static friction drives error in the second case the larger error occurs for the larger h 3 0 136 m wave for which there would be larger forces than the well modeled h 2 0 045 m wave case further reducing the impact of static friction which already appears to be negligible for the smaller wave case this suggests that the asymmetric flap oscillation may increase simulation error for high amplitude oscillations while unmodeled static friction increases simulation error for lower amplitude lower force operating conditions for which friction dominates 6 conclusion in this study experimental wave tank tests and numerical simulations of a 1 33 scale floating oscillating surge wave energy converter foswec are compared in regular waves in order to develop an open access validation data set the foswec was designed built and tested the device was tested for a range of different conditions including static offset free decay forced oscillation wave excitation and response to regular waves furthermore the foswec was tested in four different device configurations config 1 config 4 the details of the experimental setup and data analysis for each of the foswec tests are described in this paper and the experimental data simulations and processing for the foswec are available on public repositories in an open access format data from the experimental test were then compared to numerical simulations using the open source wec sim code informed by the bem solution calculated using wamit the wamit solution was evaluated a priori i e unadvised by experimental data and the wec sim results were evaluated a posteriori wherein the simulations were tuned based on experimental findings this comparison between numerical simulations and experiments uses raos in each of the degrees of freedom dof to compare the simulated and observed motion response the results detailed in this paper demonstrate that with some limitations wec sim is able to accurately simulate the response of the foswec in each of the four different configurations when subject to regular waves based on the limitations determined through this study the following future work items have been identified as exemplified through the comparison of the bem solution from wamit to the experimentally derived coefficients for the flap a large discrepancy between low frequency added mass estimates contributed to systematic overprediction of flap pitch response at these frequencies the authors of this paper believe that the inclusion of additional added mass for the flap at low wave frequencies would reduce the pitch raos substantially and bring the simulations into agreement with experiments however the wec sim code does not currently allow users to directly import experimentally derived coefficients such as added mass particularly when these parameters are derived in a distinct coordinate system from that used in simulation users are able to augment existing bem radiation damping and added mass data but there is no way to directly import frequency and amplitude dependent experimentally derived coefficients notably while much attention in the literature has been given to determination of viscous damping and drag these results suggest that equal attention should be paid to improving the accuracy of added mass estimates further the discrepancy between bem and experimentally derived estimates for the flap suggest that similar differences are likely for the platform highlighting the potential importance of forced oscillation testing in each degree of freedom for which accurate added mass estimates are essential to useful simulation results substantial modeling errors were observed for degrees of freedom subjected to small excitation loads and displacements due to the presence of unmodeled static friction while modeling accuracy could be enhanced through the inclusion of a static friction model it is noted that static friction is undesirable in a power producing wec and accurate modeling for low excitation conditions is of less interest than accuracy near power producing conditions where static friction is ideally insignificant a static friction model is therefore a lower priority improvement than allowing for direct definition of experimentally determined added mass in addition to work identified as a result of the regular wave simulation and data analysis future work beyond the scope of this publication includes expanding the numerical and experimental foswec comparison to irregular waves and loads characterization incorporating nonlinear hydrodynamics including froude krylov forces to the wec sim simulation will provide an additional point of comparison potentially improve simulation performance and further specify sources of discrepancy between experiment and simulation acknowledgments the authors would like to thank the following people for their support of wec sim validation testing and data analysis pedro lomonaco bret bosma ratanak so and asher simmons from oregon state university s o h hinsdale wave research laboratory andrews cooper for the design and fabrication of the foswec d for design and fabrication of the motion constraint and budi gunawan giorgio bacelli christopher a kelley chris simmons and carlos michelen from sandia national laboratories funding provided by the u s department of energy office of energy efficiency and renewable energy united states of america water power technologies office united states of america sandia national laboratories is a multimission laboratory managed and operated by national technology and engineering solutions of sandia llc a wholly owned subsidiary of honeywell international inc for the u s department of energy s national nuclear security administration under contract de na0003525 this work was also authored by the national renewable energy laboratory operated by the alliance for sustainable energy llc for the u s department of energy under contract no de ac36 08go28308 the views expressed in the article do not necessarily represent the views of the doe or the u s government 
22210,the floating oscillating surge wave energy converter foswec is a wave energy converter that was designed built and tested to develop an open access data set for the purpose of numerical model validation this paper details the experimental testing of the 1 33 scale foswec in a directional wave basin and compares experimental data to numerical simulations using the wave energy converter simulator wec sim open source code the foswec consists of a floating platform moving in heave pitch and surge and two pitching flaps power is extracted through relative motion between each of the flaps and the platform the device was designed to constrain different degrees of freedom so that it could be configured into a variety of operating conditions with varying dynamics the foswec was tested in a range of different conditions including static offset free decay forced oscillation wave excitation and dynamic response to regular waves in this paper results from the range of experimental tests are presented and compared to numerical simulations using the wec sim code keywords wave energy experimental testing numerical simulation wec sim validation 1 introduction wave energy converters wecs are devices designed to generate power by extracting energy from ocean waves these devices have been conceptualized researched and tested for decades however most wecs are considered to be at low to mid range technology readiness levels trls and have yet to reach utility scale commercialization weber 2012 unlike the wind industry that has largely converged on the three bladed horizontal axis wind turbine the wave energy industry is still evaluating a wide range of design archetypes with fundamentally different operating principles wecs are often categorized into the follow device types point absorbers attenuators oscillating wave surge devices oscillating water columns overtopping devices and pressure differential devices however due to the large range of existing design archetypes researchers often differ on their categorization of wecs cruz 2008 lopez et al 2013 this wide range of design archetypes has made numerical modeling and simulation of wecs a challenging research topic because the numerical requirements between wec designs vary substantially historically wecs have been modeled using numerical methods developed for naval architecture offshore oil and gas applications or custom built models for specific devices more recently commercial and open source codes have been developed specifically for modeling wecs numerical models of wecs must resolve complex hydrodynamics associated with wave device interaction body to body interactions moorings and electro mechanical dynamics at the power take off pto to predict device performance and response a common numerical approach for simulating wecs is to use the time domain cummins impulse response formulation cummins 1962 the cummins formulation requires hydrodynamic coefficients for added mass radiation damping and wave excitation details of which are provided in the following section using this formulation the radiation and excitation forces are converted from the frequency domain into their time domain equivalents in the form of impulse response functions through an inverse fourier transform typically these hydrodynamic coefficients are determined from a frequency domain boundary element method bem solution based on linear potential flow theory linear potential flow assumes inviscid fluid irrotational flow and small amplitude motion while this approach is common practice wec dynamics in real ocean waves violate these assumptions the advantage of the cummins formulation is that by moving from the frequency domain to the time domain nonlinearities can be included this allows for the inclusion of nonlinear effects such as drag proportional to velocity squared realistic implementation of nonlinear pto and control and modeling of complex mooring systems the example applications of this numerical approach are numerous ranging from modeling the searev device to the center for ocean energy research modeling competition to wavebob and powerbuoy inspired point absorbers to name a few josset et al 2007 garcia rosa et al 2015 beatty et al 2015 it is worth nothing that while the cummins formulation is a common numerical approach there are many other relevant approaches for modeling wecs for a detailed review of these methods refer to folley 2016 model verification and validation are essential for numerical method development which is commonly used to evaluate the confidence and accuracy of the model often in lieu of validation through comparison to experimental data numerical models go through verification via comparison to other numerical models i e a code to code comparison combourieu et al 2015 wendt et al 2017 on the other hand to ensure the numerical model accurately represents the physical system a validation study is often carried out by comparing the numerical solutions to measurements from experimental tests due to the wide variations in device archetypes differences in the dominant physics and intended application it is preferable to validate these models against wec specific experimental data lawson et al 2015 ruehl et al 2014 however the wave energy industry is still in the early stages of development and developers want to maintain a competitive advantage and preserve their intellectual property this means many experimental data sets are not made public and availability of nonproprietary open access data sets for validation is limited in the last few years this paradigm has begun to shift and there is now more focus on development open access data sets and open source codes for example the u s department of energy doe now requires data from all projects funded by the water power technologies office wpto to be posted to the marine and hydrokinetic data repository mhkdr mhkdr 2019 in addition to data available from doe wpto similar efforts to share and disseminate data are being made domestically and internationally opera 2019 in this study experimental wave tank tests and numerical simulations of a 1 33 scale floating oscillating surge wave energy converter foswec are compared the foswec was tested in a range of different conditions including static offset free decay forced oscillation wave excitation and dynamic response to regular waves in four different device configurations the numerical simulations are performed using the open source wec sim code and the simulation performance is evaluated in an a priori sense i e unadvised by experimental data and a posteriori in which the simulation has been tuned based upon experimental cases the foswec experimental data is available open access on the mhkdr and foswec data processing scripts are available on a public github repository sandia national laboratories 2019a b 2 foswec the device tested in this validation study is the 1 33 scale foswec shown in fig 1 the foswec consists of a floating platform orange with two pitching flaps yellow each flap hinges about a horizontal shaft and generates power through the relative pitch motion between the flap and platform the flaps each have a pto system consisting of a gearbox electric motor and torque transducer housed in a waterproof pto box they are also instrumented with a 6 degree of freedom dof load cell at the connection of the flap to the shaft and a rotary encoder a rendering of the foswec with the sensors labeled is shown in fig 1 the x axis is defined along the incident wave direction at the still water line swl as labeled at the top of fig 1 the geometric and mass properties of the foswec were determined from dry tests and are summarized in table 1 and fig 2 all moments of inertia are relative to the center of gravity c g for details on how these tests were performed refer to bosma et al 2016 and sandia national laboratories 2019a a motion constraint system was designed and built to selectively restrict the foswec s motion in order to vary the foswec s configuration to isolate individual degrees of freedom a rendering of the motion constraint arm is shown in fig 3 for more information about its design refer to sandia national laboratories 2019a the base of the constraint system is affixed rigidly to the basin floor and acts as a mooring system for the device in this way coupling between modes of motion could be isolated to allow for independent characterization the available dof for each of the four configurations is listed in table 2 for example in config 3 both flaps are free to move in pitch and the platform is allowed to move in heave implying that the pitch and surge constraints are engaged a load cell and position sensors were installed on the arm to measure 6 dof loads and motion in heave pitch and surge the motion constraint consists of three components 1 a surge guiderail constraint 2 pitch constraint and 3 heave constraint fixed to the basin floor the mass and inertia properties for the moving components of the motion constraint are defined in table 3 the mass and inertia of each moving component need to be included in numerical simulations depending on the motion constraint configuration details of which will be provided in the following section 3 wec sim wec sim is an open source code developed in matlab simulink as a library and accompanying scripts that utilize simscape multibody to solve for a wec s rigid body dynamics in the time domain the code allows users to model complex wec designs consisting of multiple bodies pto systems mooring systems and controls for a variety of wave conditions wec sim 2019 wec sim is based on linear wave theory in which the waves are assumed to be a linear superposition of incident radiated and diffracted wave components with added external forcing terms e g pto and mooring forces and empirical viscous damping terms wec sim solves the following time domain equation of motion due to wave forcing for each rigid body around its center of gravity 1 m a x f e x c t f r a d t f h s t f v i s t f p t o t f m t f e x t t where m is the mass and inertia matrix a is the added mass matrix at infinite wave frequency x is the body s displacement in 6 dof and a dot implies a time derivative f e x c t is the wave excitation force vector and f r a d t is the radiation damping force vector defined as 2 f r a d t 0 t k r t τ x τ d τ calculated by convolving the radiation impulse response function k r in each dof with the 6 element velocity vector x the radiation impulse response function k r is the inverse fourier transform of radiation damping defined as 3 k r t 2 π 0 b ω cos ω t d ω where b ω is radiation damping and ω is wave frequency in rad s the hydrostatic restoring force f h s t is defined as 4 f h s t k h s x where k h s is a 6 by 6 matrix of constant hydrostatic stiffness coefficients with units of n m in translation and nm rad in rotation and x is a 6 element displacement vector the viscous force f v i s t is defined as 5 f v i s t c v x c d ρ a s 2 x x c v x c d x x where c v is the linear viscous damping coefficient and the quadratic drag c d is a function of the drag coefficient c d water density ρ and the cross sectional area a s f p t o t is the force applied on the wec from the pto f m t is the mooring force and f e x t t is the external force from joints at the interface between component bodies the latter force is calculated by the multi body dynamics solver within simulink based upon user defined device geometry joint parameters and relative body motions further description of each of these forces will be provided in the following sections wec sim utilizes hydrodynamic coefficients in the frequency domain and determines their time domain equivalent in the form of excitation and radiation impulse response functions and infinite frequency added mass using the cummins formulation these hydrodynamic coefficients are typically determined from bem solutions but can also be determined experimentally for the wec sim solutions presented in this study the hydrodynamic coefficients were solved for using the bem code wamit lee and newman 2017 two wamit solutions for the foswec were run with 458 evenly spaced frequencies from 0 05 to 22 8 rad s one for all three bodies and another for the flap only the flap only wamit solution was run with the origin at the hinge location so that its results could be used for direct comparison to the experimentally determined wave excitation radiation damping and added mass the three body wamit solution was run so solve for body to body interactions and was used for all of the wec sim simulations e g free decay and wave cases the wamit solutions exclude the presence of the motion constraint which was assumed to have minimal effect on the hydrodynamic parameters of the foswec itself the foswec device was simulated in wec sim using the measured mass and inertia properties defined in tables 1 and 3 and using the hydrodynamic parameters determined from wamit in addition to experimentally determined parameters because the determination of some device parameters required limiting available dof constrained wec sim models were used in the simulations to be representative of experimental conditions denoted as config 1 config 4 all wec sim simulations were run using the parameters listed in table 4 an image of the wec sim simulink model is shown in fig 4 the platform gray and flaps yellow are modeled as hydrodynamic bodies the motion constraint is modeled as four nonhydrodynamic bodies red and blue and each of the joints are modeled as constraints white details of the validation effort are described in the following sections 4 experiments the foswec was evaluated in a series of experimental wave tank tests for comparison to the frequency domain wamit hydrodynamic coefficients and the time domain wec sim simulations with the experimentally observed device response the experimental tests were performed in the directional wave basin at the hinsdale wave research laboratory located at oregon state university hinsdale 2019 the test objectives were to determine the mass inertia the hydrodynamic properties of the foswec components as defined in eq 1 and the response of the device when subject to incident waves in different configurations table 2 a summary of the experimental wave tank tests performed and their corresponding test objectives is provided in table 5 this section will provide an explanation of the tests performed and the experimental derivation of the terms defined in eq 1 for more information about the tests performed and for a more detailed description of the test facility refer to bosma et al 2016 and ruehl et al 2016 unless otherwise noted device data e g loads positions were collected at 100 hz and wave sensor data was collected at 50 hz 4 1 static offset the objective of the static offset test is to determine the hydrostatic restoring coefficient k h s in each dof namely the flap in pitch and the platform in heave pitch and surge during each test all dofs aside from those being evaluated were locked the hydrostatic restoring force f h s referenced in eq 1 is the force exerted on a submerged body by the static fluid as defined in eq 4 x is a six element displacement vector and k h s is a 6 by 6 matrix of constant hydrostatic stiffness coefficients with units of n m in translation and nm rad in rotation for translation in heave the hydrostatic stiffness coefficient k 33 is defined as 6 k 33 ρ g a w p where ρ is the density of water g is the acceleration due to gravity and a w p is the cut water plane area for rotation in pitch the hydrostatic stiffness coefficient k 55 is defined as 7 k 55 ρ g i y ρ g v z g m g z b where i y is the second moment of area of the cut water plane area v is the submerged volume z g is the z coordinate of the center of gravity m is the body mass and z b is the z coordinate of the center of buoyancy it should be noted that while both k 33 and k 55 are modeled in wec sim as constant linear spring terms they are in fact nonlinear for example for motion in heave the cut water plane area a w p changes and for motion in pitch the submerged volume v is not constant it is also worth noting that there is no hydrostatic stiffness in surge i e k 11 0 to restore the foswec in surge a series of rubber bungee cords were installed on both sides of the motion constraint perpendicular to the surge guiderail and attached to the foswec such that they did not interfere with flap motion this restoring force is described as surge mooring stiffness k m the hydrostatic and mooring stiffness were determined from a series of static offset tests that will be detailed in the following sections 4 2 free decay the free decay test objectives are to determine the natural frequency ω n and estimate the total linear damping c t o t for each body in its relevant dof free decay estimates of damping are also used to validate the c d estimate of flap pitch forced oscillation tests free decay tests were performed for the flap in pitch and the platform in heave pitch and surge during each test all dofs aside from those being evaluated were locked data processing for each of the decay tests was completed in a similar manner however for the sake of brevity only the analysis of the flap s free decay will be described in this section with noted exceptions the same methodology was applied to the platform s free decay tests in heave pitch and surge for these free decay tests the pto drivetrain was disconnected because the pto was disconnected it can be assumed that the flap s free decay response is purely a hydrodynamic response with small frictional forces the flap was initially displaced with no incident waves to a prescribed angle and released the flap motion was then recorded until it returned to steady state at its equilibrium position under these test conditions eq 1 simplifies to 8 i y y a 55 θ c t o t θ c d θ θ k 55 θ where i y y is the moment of inertia in pitch a 55 ω d is the added mass in pitch at the damped natural frequency c t o t ω d b 55 ω d c v ω d is the total damping due to radiation damping and viscous damping at the damped natural frequency and θ is the flap angular displacement equivalent to x 5 bosma et al 2016 flap angular displacement was low pass filtered with a first order back to back finite impulse response filter to remove instrument noise without introducing a phase shift it should be noted that while b 55 ω and c v ω are frequency dependent damping values because free decay occurs at the damped natural frequency only the damping values at the damped natural frequency b 55 ω d and c v ω d are relevant similarly the total damping c t o t and c d are generally frequency dependent but only the c t o t ω d and c d ω d can be determined from free decay tests for decay tests the damping ratio ζ can be determined from time domain data following the logarithmic decrement method using the initial adjacent peaks inman 2008 based on the experimentally derived ζ linear damping is defined as 9 c l i n ω d 2 ζ i y y a 55 ω n where ω n is the natural frequency calculated from the observed damped natural frequency by 10 ω n 1 ζ 2 ω d for flap pitch decay in order to validate the quadratic damping coefficient estimations from the forced oscillation experiments free decay damping is temporarily assumed to have solely linear components expressed as c l i n for different initial displacements the mass normalized linear and quadratic components of damping can be estimated at ω d via linear regression as suggested by inman 2008 11 f v i s i y y a 55 c l i n θ i y y a 55 c t o t 8 c d ω θ 3 π i y y a 55 θ where mass normalized damping coefficients are then multiplied by i y y a 55 and a 55 is estimated from forced oscillation tests at a nearby frequency then compared to c t o t and c d estimates calculated in an analogous way from forced oscillation tests because forced oscillation tests were not performed for the platform in heave surge or pitch c d cannot be validated for the platform by this methodology therefore it is assumed that c l i n c t o t as calculated via eq 9 using bem estimate of added mass and c d is used as a simulation tuning parameter 4 3 wave excitation the objective of the wave excitation test is to determine the wave excitation force coefficient f e x c ω for this study only excitation torque on the flap in pitch was considered for direct comparison to the bem solution from wamit in order to isolate the forces on the flap to those exclusively due to wave excitation the device was locked in all degrees of freedom during the test as a result the left hand side of eq 1 goes to zero additionally because the flap and platform are fixed the radiation force f r a d hydrostatic force f h s viscous force f v i s pto force f p t o f e x t and mooring force f m are also zero thus the forces measured at the flap load cell will be equal to f e x c for this set of experiments wave calibration tests were carried out in the wave tank prior to installation of the foswec a wave gauge was placed at the future location of the foswec to measure the wave surface elevation at the center of the foswec prior to its installation and to ensure that the desired wave cases were repeatable this means that the wave field measured at the device location by this wave gauge includes only the undisturbed incident wave elevation additionally the wave basin was instrumented with an array of wave gauges both subsea and overhead that provided other spatially and temporally resolved measurements of the wave field the parameter space is summarized in table 6 where t is the wave period in s and h is the wave height in m at 1 33 scale wave generation was found to be highly repeatable for each of the wave cases marked with an x wave cases that were not found repeatable were not considered because it is not possible to measure purely excitation waves at the device location with the foswec device installed and the wave device interactions will generate additional waves wave data for the proceeding analysis comes from the wave calibration study for the appropriate wave case the wave excitation force is most commonly calculated in the frequency domain where it is a complex value having both a magnitude f e x c ω and a phase f e x c ω relative to the amplitude and phase of the wave field in this way the wave excitation force can be represented as 12 f e x c ω f e x c ω η ω where f e x c ω is the complex excitation force torque coefficient as a function of frequency and η ω is the frequency domain representation of the measured wave surface elevation time series η t for analysis of the regular wave excitation η t was restricted to 20 crest to crest wave cycles for which the first crest was at a minimum of 75 of the maximum recorded wave height for the run this criteria ensured that the wave field considered was fully developed and excluded initial transients related to start up of the wave maker further limiting the sampling duration ensures the actual wave field is well approximated by η t as determined by the wave calibration study for which the foswec was absent and that device generated waves do not have sufficient time to reflect off of basin boundaries and affect the measured forces after propagating back to the device the measured forces over this time interval were considered each time series was low pass filtered via a first order back to back finite impulse response filter to remove instrument noise without introducing a phase shift the amplitudes of the nominally sinusoidal time series were calculated for force and wave height for each cycle and the median ratio for each cycle was taken as an estimate of the average excitation coefficient magnitude a 95 confidence interval was calculated by examining the standard deviation of the f e x c ω calculated for each of the included 20 cycles by using multiple regular wave runs at various amplitudes and periods an estimate of f e x c ω was determined and its nonlinear dependence on wave amplitude was assessed 4 4 forced oscillation the forced oscillation test objectives are to experimentally determine the added mass a ω total damping c t o t ω and quadratic drag c d this test was run in still water by controlling the pto to force the flap to oscillate at different combinations of periods and amplitudes with the platform constrained in all degrees of freedom and measuring the corresponding force the radiation damping force refers to the forces exerted on an oscillating body by the wave radiated as a result of the body s oscillation the radiation force in the time domain is defined by the convolution integral eq 2 under this operating condition the dynamic equation for the flap in pitch simplifies to 13 f p t o t k h s θ i y y a 55 θ c t o t θ c d θ θ where f p t o t is the driving pto force c t o t ω b 55 ω c v ω is the total linear damping at the oscillation frequency consisting of radiation damping b 55 ω and the linear viscous damping coefficient c v ω and c d ω is the quadratic drag term as shown in eq 13 by subtracting the hydrostatic contribution from the measured pto force the added mass a 55 ω total damping c t o t ω and quadratic drag c d ω can be extracted by considering different points in the forced oscillation forced sinusoidally a point of maximum velocity has an acceleration of zero and vice versa ideally this allows for the damping forces proportional to velocity to be separated from the inertia forces proportional to acceleration by analyzing velocity maxima and acceleration maxima separately as in beatty et al 2015 however in practice velocity maxima did not occur simultaneously at zeros of acceleration and vice versa likely due to a small dead band observed in the flap position sensor near x 0 and drive train slack as such this method was not perfectly applicable for the foswec data set further work by brown et al 2017 has highlighted the frequency independence of c d over small ranges of the keulegan carpenter k c number which can be calculated for the prescribed sinusoidal oscillations 14 k c θ t l where θ is the amplitude of the angular velocity oscillation t is the period of oscillation and l is the amplitude of oscillation in rad traditionally k c is derived in terms of linear distances and translational velocities the k c number was found to be nearly constant across prescribed tested conditions for forced oscillation and therefore c d was presumed constant over the range of ω tested the range of k c numbers is calculated from observed test conditions to validate this assumption additionally simulation results were found to be insensitive to adjustments to c d within an order of magnitude so any modeling errors introduced due to this approximation are minor the considered time series was restricted to symmetric oscillations at the prescribed amplitude and filtered using the same method as in the wave excitation studies this served to exclude any transients related to start up and to reduce the impact of any position varying parameters for some test cases this combination of conditions severely limited or entirely eliminated the available data these cases have been flagged in the data set beginning at a velocity peak the data were then windowed to one half of an oscillation period ensuring both large accelerations and velocities would be included in the window because θ θ is highly correlated with θ it is not possible to solve simultaneously for c d and c v in a least squares sense so a two step procedure was adopted firstly hydrostatic contributions were subtracted from each window and eq 13 was solved in a least squares sense for damping and added mass assuming all damping drag viscous and radiation c l i n is proportional to pitch velocity 15 f p t o k h s θ θ θ c l i n i y y a 55 then using different amplitudes of θ at a given frequency the linearization proposed by inman 2008 and utilized by van riij et al 2017 was adopted to calculate a c d estimate for each oscillation frequency via linear regression 16 f v i s c l i n θ c t o t 8 c d ω θ 3 π θ such that the y intercept of the fitted line is the linear damping term c t o t the combination of radiation and viscous damping and the slope proportional to 8 ω θ 3 π is the quadratic coefficient c d by earlier arguments c d is assumed to be constant over tested conditions and as such the estimates for c d for each frequency of oscillation were averaged for a more robust estimate with the estimate for c d the contribution of quadratic drag was removed along with hydrostatic contributions from the measured force and the added mass and linear damping parameters were recalculated for each test case by 17 f p t o k h s θ c d θ θ θ θ c t o t i y y a 55 where c t o t ω is the frequency dependent contribution of the linear damping details of the resulting comparisons between experimental data and numerical simulations will be detailed in the following sections 4 5 regular wave the objective of the regular wave test is to characterize the foswec s response to regular waves with various device configurations corresponding to config 1 config 4 in the first configuration config 1 only the front flap s motion in pitch is free to move config 2 allows both flaps to pitch and thus includes the motion of two interacting flaps config 3 allows both flaps to pitch and the platform to move in heave the final configuration config 4 allows both flaps to pitch and the platform to move in heave pitch and surge for wave response tests the wave basin generated several sets of regular wave fields see table 6 measurement of the foswec motion was achieved via encoders mounted on each flap to measure pitch response and sensors mounted on the platform to measure response in heave pitch and surge refer to fig 1 additionally 6 dof load cells were mounted on each shaft to measure the loads on the flaps and a 6 dof load cell was mounted on the arm s connections to the platform to measure its loads results from regular wave response tests are presented as response amplitude operators raos for each of the four foswec configurations where the rao is defined as the ratio between the magnitude of response to the incident wave height 18 r a o ω x h where x is the peak to peak motion response magnitude and h is the wave height as determined from a corresponding wave calibration run for translational motion response the rao has units of m m and for rotation motion response the rao has units of deg m similar to the data analysis of the wave excitation tests analysis of the regular wave response x was filtered and restricted to ensure that the wave field considered was fully developed and excluded initial transients related to start up of the wave basin raos were then calculated using 20 crest to crest wave cycles of fully developed response 5 results 5 1 static offset static offset tests were performed for the flap in pitch and the platform in heave pitch and surge corresponding to each of the foswec s degrees of freedom these tests were performed by offsetting the body in each degree of freedom holding it statically at varying displacements and measuring the resulting force torque for more information about the hydrostatic test setup refer to bosma et al 2016 and sandia national laboratories 2019a when running wec sim with linear hydrostatics the hydrostatic restoring force is modeled as a function of the body s displacement multiplied by a constant hydrostatic stiffness coefficient k h s as defined in eq 4 when hydrostatic stiffness is modeled as a constant coefficient a linear regression was fit between measured force torque and displacement and the correlation coefficient r 2 of the fit was calculated any nonlinearity will reduce r 2 an overview of the resulting k h s and r 2 values for each dof is presented in table 7 and a discussion of the results is given in the following sections the experimentally derived k h s is always larger than the hydrostatic stiffness determined by the wamit solution this is because in the as built system there are stiffness terms in addition to hydrostatic stiffness caused by the physics of joints constraints ptos and the surge restoring bungees 5 1 1 flap pitch the relationship between hydrostatic torque measured at the hinge and angular displacement of the foswec flap is shown in fig 5 top left as expected from the flap s geometry the hydrostatic torque increases with flap angular displacement because the perpendicular distance to the flap center of mass at which the buoyancy force acts increases with the displacement angle refer to eq 7 in addition since the flap is a wedge shape which is above the water surface at equilibrium the relationship between water displacement and flap displacement in pitch is expected to be nonlinear this results in a slightly higher correlation coefficient for a quadratic fit r 2 0 988 when compared to the linear regression the results of this test demonstrate that while k 55 may be slightly nonlinear a linear hydrostatic stiffness for the flap in pitch is still an appropriate assumption however the effect of this nonlinearity is most pronounced at small and large angles of displacement and the resulting linear fit predicts zero force at zero displacement inspection of the experimental data and the polynomial fit indicates a nonzero torque value at zero displacement indicating the presence of static friction significant static friction is unsurprising given the large drivetrain gear ratio and highlights a shortcoming of the linear fit the experimentally determined hydrostatic stiffness is nearly double the wamit estimate the flap pitch static offset test was performed with the flap pto connected and there is additional stiffness in the system caused by the physics of the pto drivetrain not modeled by wamit 5 1 2 platform heave the relationship between hydrostatic force measured from the overhead crane and displacement of the foswec platform in heave is shown in fig 5 top right for translation in heave the foswec has a strongly linear relationship between measured force and displacement with a hydrostatic stiffness of k 33 7150 n m and correlation coefficient of r 2 0 9998 a linear relationship for k 33 is expected in this range because while there are changes in the cut waterplane area of the platform in heave for very large displacements z m i n 0 06 m and z m a x 0 37 m when the platform is fully submerged or out of the water the static offset test was performed for displacements with small changes in the cut waterplane area the results of this test demonstrate that a linear hydrostatic stiffness for the platform in heave is appropriate however comparison of the experimentally derived stiffness to the hydrostatic stiffness determined by wamit k 33 5610 n m demonstrates that the motion constraint in heave provides an additional stiffness that is not fully captured by hydrostatics alone as shown in table 7 5 1 3 platform pitch the relationship between hydrostatic torque and rotation of the foswec platform in pitch is shown in fig 5 bottom left similar to the results for heave for rotation in pitch the foswec also has a strongly linear relationship between measured torque and displacement with a hydrostatic stiffness of k 55 p 39 8 nm deg and a correlation coefficient of r 2 0 996 the strongly linear relationship for k 55 p is expected because while there are changes in the submerged volume of the platform in pitch the foswec platform s pitch range of motion is small less than 10 so the resulting change in displaced volume is relatively small again a comparison of the experimentally derived stiffness to the hydrostatic stiffness determined by wamit k 55 p 21 2 nm deg indicates nonhydrostatic sources of stiffness table 7 note that in both experimental and wamit evaluations the platform pitch and heave hydrostatic responses are evaluated with the flaps attached as there were no considered device configurations in which the flaps were not present 5 1 4 platform surge as mentioned in the previous section there is no hydrostatic restoring force in surge bungee cords were installed on the foswec s motion constraint arm in lieu of a traditional mooring system to restore the foswec s displacement in surge therefore no restoring force from wamit the surge static offset test was used to characterize the bungee force as a function of surge displacement the relationship between hydrostatic force measured from the overhead crane used to laterally displace the device and translation of the foswec platform in surge is shown in fig 5 bottom right of the static offset tests performed the surge test had the poorest linear fit between measured force and displacement with a surge mooring stiffness of k m 963 n m and a correlation coefficient of r 2 0 961 see table 7 however while the other linear fits had higher correlation coefficients the linear regression for surge force still appears to capture the overall trend of the data particularly the nonzero intercept predicted by the linear fit indicates the presence of significant static friction in the surge guiderails and deviations from the linear trend suggest nonlinear behavior in the bungees 5 2 free decay free decay tests were performed by offsetting the body to various initial displacements in each degree of freedom releasing the body from its initial displacement and measuring the resulting motion response to steady state equilibrium the purpose of the free decay test was to determine the natural period t n of the foswec in each dof and estimate the corresponding total damping c t o t as described in table 5 additionally the flap free decay test was used to validate estimates of c t o t and c d calculated separately from forced oscillation testing an overview of the results from the free decay tests is shown in table 8 and details of each test will be described in the following sections recall that c d for flap pitch indicated by an asterisk in table 8 was calculated from eq 11 using an added mass estimate from forced oscillation testing while other c d values were selected by tuning parameters further the added mass estimate used to normalize flap pitch damping coefficients was from forced oscillation experimental data while other degrees of freedom were estimated using bem added mass predictions 5 2 1 flap pitch the flap decay for each initial displacement is shown in fig 6 top left with 95 confidence intervals indicated at the minimums and maximums utilized by the logarithm decrement method the damping ratio for each initial displacement was calculated and the mean total damping c t o t was determined the total damping was then subtracted by the radiation damping to determine the mean viscous damping c v 4 68 nms rad which was applied in the wec sim simulation on the flap in pitch similarly a drag of c d 7 45 nm rad 2 s s the product of the slope of eq 11 and i y y a 55 the added mass estimate from the tested forced oscillation frequency ω 1 90 rad s the closest to ω d was used in simulation the comparison between these parameters and those derived from forced oscillation testing is discussed in the forthcoming section the experimentally observed natural period is relatively constant for each initial displacement with a damped natural period of 4 43 s 4 35 s and 4 33 s for the 10 15 and 20 initial offsets respectively the corresponding simulated flap pitch decay damped natural periods estimated as the time from release to the first local maximum are 4 37 s 4 35 s and 4 32 s a comparison of the experiment to simulation results shows that wec sim accurately estimates the damped natural period and that the pitch decay rate accurately approximates the experimental rate until the oscillations become 10 of the initial displacement it should be noted that although the results of the flap static offset include the pto drivetrain the flap free decay tests were performed with the pto drivetrain disconnected to approximately isolate the hydrodynamic effects however the more abrupt decay in experiment suggests that the static bearing friction not modeled in simulation likely becomes significant for small flap oscillations 5 2 2 platform heave the platform heave decay results for each initial displacement are shown in fig 6 top right with 95 confidence intervals indicated at the minimums and maximums the mean viscous damping was determined to be c v 502 4 ns m which was then applied in the wec sim simulations for the platform decay in heave because forced oscillation tests were not completed for the platform drag was used as a tuning parameter and a drag of c d 300 ns 2 m 2 was selected to provide the best fit as shown in fig 6 top right the experimental natural period for each heave decay initial displacement remains relatively constant slightly increasing with larger initial displacement the experimental heave decay damped natural periods are 1 52 s 1 54 s and 1 56 s for the 7 cm 10 cm and 15 cm initial offsets respectively the corresponding simulated platform heave decay damped natural periods are 1 35 s 1 36 s and 1 38 s while there is a discrepancy between the experimental and simulated natural periods it can be observed that the wec sim simulations are within the 95 confidence intervals at the first negative peak t 0 72 s capturing both the period and magnitude of oscillation the difference between simulated and observed heave decay occurs at small relative displacements z z 0 0 2 and is likely due to unmodeled static friction in the heave telescoping constraint this effect is exemplified through the experimental results for the smallest initial displacement of z 0 7 cm when compared to the larger initial displacements wherein the first negative peak has the largest relative displacement but the smallest relative displacement at the first positive peak t 1 51 s this experimental observation is typical of a system dominated by friction an overview of these experimental and simulated results is shown in table 8 5 2 3 platform pitch the platform pitch decay for each initial displacement is shown as fig 6 bottom left with 95 confidence intervals indicated at the minimums and maximums the mean viscous damping c v 14 nms rad was applied in the wec sim simulation on the platform in pitch because forced oscillation tests were not completed for the platform drag was used as a tuning parameter and a drag of c d 25 2 nm rad 2 s s was selected to provide the best fit the natural period is relatively constant for each initial displacement with a damped natural period of 1 66 s 1 68 s and 1 68 s for the 5 7 and 8 4 initial offsets respectively the corresponding simulated platform pitch decay damped natural periods are 1 63 s 1 64 s and 1 66 s like the flap pitch decay test the pitch decay rate is slightly overdamped in the experimental data compared to the simulations this is demonstrated by the fact that the simulation results are within the 95 confidence intervals for the regions of larger relative displacement θ θ 0 0 3 this again suggests that unmodeled static friction may become significant at small displacements 5 2 4 platform surge the platform surge decay for each initial displacement is shown as fig 6 bottom right with 95 confidence intervals indicated because this oscillation is an overdamped system the logarithmic decrement method is inappropriate for damping ratio determination the damping ratio and natural frequency for each initial displacement was instead calculated using an iterative least squares fit of the canonical equation of a normalized damped harmonic oscillator 19 y t 1 exp ζ ω n t cos ω n t 1 ζ 2 ζ 1 ζ 2 sin ω n t 1 ζ 2 using matlab s fminsearch function from the fitted damping ratio and natural frequency the mean total damping c t o t was determined using the same method as for previous free decay tests the total damping was then subtracted by the radiation damping to determine the mean viscous damping c v 347 ns m and was applied in the wec sim simulation on the platform in surge because forced oscillation tests were not completed for the platform drag was used as a tuning parameter and a drag of c d 7808 ns 2 m 2 was selected to provide the best fit based on the results from the static offset test in surge a mooring stiffness of k m 963 n m was applied in surge to model the effect of the bungees the surge decay experimental and numerical comparison shows that the results decay at a similar rate but the wec sim results have substantial overshoot in comparison to the experimental data this is likely because the bungees are nonlinear in nature and the presence of unmodeled static friction along the surge guide rail nonetheless the numerical and experimental comparison is acceptable considering the underlying dynamics for surge decay are not modeled by hydrodynamics the driving force in this case is the restoring bungee force it should also be noted that the large drag is expected because the surge decay test was performed with both flaps locked in the vertical position so any movement in surge would have to overcome a large drag force caused by the surface area of the flaps refer to eq 5 5 3 wave excitation the purpose of the wave excitation test is to determine the wave excitation force coefficient f e x c on flap 1 as described in table 5 wave excitation tests were performed by locking the flap motion in pitch and measuring the resulting wave loading at the load cell mounted on the hinge this experiment was performed for a range of incident wave conditions corresponding to the regular waves with different combinations of wave period and wave height as listed in table 6 results from the wave excitation experiments were then compared to the flap s bem solution in wamit which were calculated with the origin at the hinge location to restrict all wave excitation to the pitch dof this allows for direct comparison to the experimental results a comparison between wave excitation force coefficients f e x c for flap 1 measured from regular wave experiments with 95 confidence intervals and the corresponding bem solution from wamit is shown in fig 7 the experimentally determined wave excitation force coefficient was measured from the load cell mounted on the flap s shaft thus the relevant dof is flap rotation in pitch because wec sim solves for a wec s motion about each body s c g the bem solution used by wec sim must be solved at the c g however for these comparisons the wamit solution was solved with the origin at the hinge location to allow for direct comparison between the measured wave excitation force coefficient from the experiments to that from wamit analysis of the experimentally determined wave excitation from regular wave tests does not show a strong dependence on wave height this is demonstrated by the fact that over most of the explored wave frequencies the measured wave excitation force coefficients fall within the 95 confidence intervals of the other wave heights this confirms the linear assumption for wave excitation on the flap meaning that the wave excitation coefficient for the flap can be assumed to be frequency dependent but not also amplitude dependent it should be noted that at ω 4 rad s the largest wave height exhibited overtopping reducing the excitation force coefficient significantly over the smaller wave heights fig 7 shows that the measured wave excitation force coefficients follow a similar curve shape as the wamit solution however wamit consistently underpredicts the excitation force coefficient for wave frequencies ω 4 rad s corresponding to t 1 57 s the underprediction of the wave excitation coefficient from the wamit solution for t 1 57 s is expected because wamit only solves for the excitation force on the wetted surface of the body in still water however substantial wave runup and overtopping were observed during the wave excitation tests especially for the longer wave periods the runup and overtopping were partially caused by the fact that the foswec platform was fixed in order to measure the wave excitation force thus the foswec was unable to heave along with the free surface as would typically be the case for floating bodies additionally the foswec flaps are surface piercing with a freeboard of 0 12 m and wave excitation tests were performed for wave heights of h 0 015 m 0 045 m and 0 136 m as a result the experimentally derived wave excitation coefficient is expected to have a larger magnitude because the true wetted surface of the flap and resulting torque are larger than those solved for by wamit a notable departure from the experimental trend occurs for ω 5 2 rad s for which experimental estimates of wave excitation exhibit substantially increased uncertainty i e large standard deviations and reduced mean values both flaps were locked vertically during the excitation tests this resulted in standing waves reflections from downstream flap contained by the buoyancy floats at this frequency these reflections were significant and out of phase with the upstream flap as evidenced by an atypically large excitation coefficient for flap 2 at this frequency not shown this interference decreased the observed load on flap 1 and reduced the excitation coefficient further the phase variation between the excited wave and the radiated wave from the second flap would contribute to the higher cycle to cycle variation observed in the excitation coefficient since this wamit was run using only a single flap excluding the downstream flap and buoyancy floats this body to body interaction was not present in bem parameter estimates the bem estimate would have likely been more representative if the downstream flap was locked in a horizontal position such that wave reflections were reduced 5 4 forced oscillation the purpose of the forced oscillation tests was to determine the added mass a 55 ω and radiation damping b 55 ω components of the radiation force on flap 1 as described in table 5 forced oscillation tests were performed in still water by controlling the pto to force flap 1 to oscillate at different combinations of periods and amplitudes the force required to drive the flap in oscillation was measured corresponding to the radiation force by subtracting the hydrostatic and quadratic damping contributions to measured force according to eq 13 an experimental estimation of viscous damping and added mass were made assuming a constant c d over the relatively constant k c number the observed k c numbers calculated using eq 14 show small variation as shown in table 9 at high frequencies of forced oscillation particularly at high amplitudes wave overtopping was prevalent as a result eq 16 does not have a positive slope at these frequencies yielding a nonphysical negative estimate for c d further asymmetric oscillations were more prevalent under high frequency test conditions decreasing the number of valid tests and as a result the number of points in the linear regression eq 16 diminishing confidence in this estimate finally brown et al 2017 derives the k c number independence of c d using morison s equation which is appropriate for slender bodies for which wave diffraction effects can be neglected at higher tested frequencies this is a poor assumption for the foswec device because the wavelength implied at these frequencies approximates flap length for these reasons estimations of c d were excluded from the average for cases ω 5 rad s this resulted in a c d estimate of 14 22 nm rad 2 s 2 comparisons of the experimentally determined added mass a 55 ω and radiation damping b 55 ω to the bem solution from wamit are shown in fig 8 in fig 8 experimentally determined c t o t ω and a 55 ω are plotted with colored squares for each oscillation amplitude and results from the bem solution in wamit are plotted with a solid black line bars indicate the 95 confidence interval of least squares parameter estimation for each calculation window small bars indicate little cycle to cycle variation as expected the experimentally determined total damping c t o t ω is much larger than the wamit solution of b 55 ω shown on the left hand side of fig 8 this is unsurprising as the bem solution is based on a potential flow solution method and thus excludes the contribution due to viscosity c v ω in order to determine the contribution due to viscosity c v ω was applied in all wec sim simulations and the difference between c t o t ω and b 55 ω was used similarly a comparison between the experimentally determined added mass and the wamit solution is shown on the right hand side of fig 8 bem added mass underpredicts experimental results at low frequencies corresponding to ω 3 rad s and overpredicts for 3 ω 6 rad s note that the resulting estimate of c t o t at the highest frequency is less than the bem estimated damping implying c v 0 refer to eq 17 in addition to the comparison of the wamit solution to the experiments it is worth noting the effect of oscillation amplitude on experimentally determined coefficients each of the forced oscillation tests was performed for the range of oscillation periods defined in table 6 and for three different magnitudes corresponding to δ θ 5 10 and 20 where δ θ is the difference between the maximum displacement and steady state equilibrium the experimentally determined c t o t ω only demonstrates significant dependence on oscillation magnitude for the largest wave frequency where a larger oscillation magnitude corresponds to smaller total damping at midrange frequencies ω 4 rad s ω 3 rad s there is a smaller dependence on magnitude and the trend is reversed larger oscillations exhibit increased damping the experimentally determined a 55 ω only demonstrates amplitude dependence for ω 3 3 rad s where the numerical result agrees closely with the experimental results using the ω 1 9 rad s forced oscillation case the average of the added mass values as there is little amplitude dependence was multiplied with the free decay mass normalized estimates of damping coefficients refer to eq 11 and table 8 for comparison with forced oscillation derived damping estimates the discrepancy between forced oscillation and free decay damping estimates is small unlikely to affect simulation accuracy and is explainable first the trend in added mass suggests that the added mass at ω d likely was larger than at ω 1 9 rad s therefore the decay test damping estimates were likely underestimated by this method second c d can only be presumed constant for a constant k c number while that was shown to be approximately true for forced oscillation testing it is untrue for free decay tests which oscillate at a fixed period t d but through diminishing velocity amplitude a free decay test would have covered a range of k c numbers and some discrepancy in c d estimate might thus be expected meanwhile the c v estimate from free decay appears to be smaller than the forced oscillation estimate perhaps again suggesting an underestimated added mass the experimentally derived c v ω and c d terms from forced oscillation testing were applied to all regular wave simulations based on their observed frequency and amplitude dependence 5 5 wave response the purpose of the wave response test was to characterize the foswec s response to regular waves with various device configurations corresponding to config 1 config 4 as described in table 5 wave response tests were performed for four different configurations of the foswec each with different degrees of freedom and resulting dynamics config 1 corresponds to flap 1 pitch motion config 2 corresponds to flap 1 and flap 2 pitch motion config 3 corresponds to the addition of platform heave motion and config 4 allows both flaps to pitch and the platform to move in heave pitch and surge the directional wave basin at the hinsdale wave research laboratory generated regular wave fields which is summarized in table 6 at 1 33 scale these wave cases were selected because they were found to be highly repeatable during the wave calibration runs each of the wave cases listed in table 6 were run once for config 1 and all of the wave cases except h 1 0 015 m were run for config 2 config 4 to simplify comparisons between configurations h 1 results are omitted from config 1 plots for all configurations wave cases of h 2 0 045 m and t 1 22 1 91 and 2 61 s were repeated three times to demonstrate the repeatability of the measured rao response in the following sections comparison of the experimentally measured response of the foswec is compared to the numerical simulations for the same conditions the results are presented as raos for each of the four foswec configurations where the rao is defined by eq 18 5 5 1 config 1 comparison of the experimentally determined rao for config 1 to wec sim simulations is shown in fig 9 experimentally measured raos are plotted with colored squares for each wave height and rao results from wec sim simulations are plotted with dotted lines and square markers standard deviation bars refer to the standard deviation of the parameter estimation for each cycle small standard deviation bars indicate little cycle to cycle variation for the wec sim raos the simulations were run with linear hydrodynamics which explains why the resulting simulations have similar trends for different wave heights wec sim closely estimates the rao for all wave frequencies except the lowest frequency this is expected because the flap is near resonance at the lowest wave frequency and potential flow based codes are known to be inaccurate near resonance this is exemplified through the comparison between the experimentally derived radiation terms shown in fig 8 for all of the wec sim simulations the radiation damping and drag coefficients were modified based on the results of the forced oscillation tests in the form of c v and c d however the added mass was not adjusted the experimentally determined added mass a 55 ω is much larger than the bem solution for ω 3 rad s which explains why the wec sim simulation overpredicts the flap s pitch motion response for low frequencies additionally the presence of static friction as suggested during hydrostatic and decay tests would likely reduce the experimentally observed rao magnitude for cases of lower wave excitation forces which inspection of fig 7 suggests will occur at the lowest tested wave frequency if the simulation had been adjusted to account for the experimentally derived added mass and modeled the static friction the simulated rao near the resonance would likely have better agreement with the measurements this is an area of future investigation nonetheless the simulated rao has good agreement with the experimental values for most wave periods 5 5 2 config 2 comparison of the experimentally determined raos for config 2 to wec sim simulations are shown in fig 10 similar to the results from config 1 wec sim does a good job estimating the raos for both flaps at all wave frequencies except the lowest frequency the explanation for this discrepancy is also similar since for config 2 each of the flaps added mass at low frequencies was significantly underestimated by the wamit solution however for wave frequencies greater than the flap s resonance ω 2 rad s the rao response is within reasonable error 5 5 3 config 3 comparison of the experimentally determined raos for config 3 to wec sim simulations are shown in fig 11 similar to config 1 and config 2 wec sim simulations for config 3 were run with linear hydrodynamics the simulated and experimental rao response for flaps 1 and 2 are similar to those from config 2 and demonstrate the same divergence near resonance and agreement for ω 2 5 rad s config 3 is the first configuration to include the motion response from the platform where the platform is free to move in heave unlike the characterization of the flap through forced oscillation tests the platform did not undergo tests to experimentally determine c t o t ω c d ω and a ω as a result the hydrodynamic coefficients for the platform are based on the results from the wamit solution c v from free decay testing and c d used as a tuning parameter nonetheless the numerical simulations from wec sim for the platform s heave motion response agree well versus the experimental raos at all wave frequencies the wec sim results systemically overpredict the platform s heave response but they are within reasonable error and predict the overall shape of the rao curve well wec sim overprediction of the heave response is likely because the physics of motion constraint are not fully captured in the simulation particularly any influence of static friction the presence of which was suggested by the hydrostatic and free decay tests for this degree of freedom as discussed in previous sections the motion constraint provided a mechanism through which the foswec could be easily configured to operate in different degrees of freedom 5 5 4 config 4 comparison of the experimentally determined raos for config 4 to wec sim simulations are shown in fig 12 the simulated and experimental rao response for flap 1 flap 2 and platform heave are similar to those from config 3 albeit with a notable reduction in experimental platform heave rao amplitude for ω 3 29 rad s indicating that the availability of surge and platform pitch degrees of freedom reduces heave response at these frequencies in addition platform heave and both pitching flaps config 4 also includes platform motion in surge and pitch as with platform heave forced oscillation tests were not performed on the platform hydrodynamic coefficients for the platform were determined in the same way as config 3 additionally for the surge dof a mooring stiffness k m was applied based on the surge static offset test particularly at low frequencies experimental surge rao magnitudes show a strong dependence on wave height while the simulated rao shows significantly less sensitivity this could be explained by the influence of unmodeled static friction small waves could not overcome this force resulting in an rao near zero while large waves could significantly larger surge raos were observed in the experiment than predicted by simulation suggesting bem estimates of hydrodynamic parameters may be poor at these frequencies for platform motion in pitch the wec sim rao estimates the rao curve shape but the pitch rao magnitude is systematically overpredicted for all but the largest wave frequencies particularly simulation predicts a peak at ω 5 2 rad s that is not observed in the experimental data it is also worth observing the difference in raos for the different experimental configurations due to coupling between degrees of freedom for ease of direct comparison the rao for each dof is plotted on the same axis scale for config 1 config 4 looking at the experimental raos for flap 1 across all configurations it is clear that the experimental raos for config 1 have the largest overall magnitude with r a o 200 deg m for ω 4 rad s for h 2 in this configuration only flap 1 is allowed to move thus there is no coupling between degrees of freedom once flap 2 is free to move in config 2 the range of r a o 200 deg m for flap 1 is reduced for ω 2 8 rad s and ω 3 3 rad s corresponding to t 2 26 s and t 1 91 s respectively similarly the inclusion of the platform motion in heave for config3 reduces the instances of flap 1 r a o 200 deg m to a single wave frequency ω 3 3 rad s corresponding to t 1 91 s and once the platform is free it move in heave pitch and surge there are zero instances of flap 1 r a o 200 deg m similar observations can be made about the effects coupling between degrees of freedom have on other raos further it is notable that the observed experimental reduction in rao of flap 1 is not always reflected by the simulated estimate this suggests a potential limit of the linear simulation as for reasons highlighted above this reduction is due principally to nonlinear effects gaining a better understanding of the influence of coupling between degrees of freedom and body to body interactions was the primary motivation for selecting a device like the foswec which can be configured to include different operating dynamics 5 6 time series comparison in addition to comparing raos it is desirable that a simulation can accurately predict time resolved wec behavior when provided with experimentally or numerical estimates of hydrodynamic parameters to this end the time series representations of two config 1 raos are presented as fig 13 the results provided are for a common wave period of t 6 2 61 s but for two different wave heights h 2 0 045 m and h 3 0 136 m as noted in the previous discussions the error in the h 3 0 136 m case is attributed to nonlinear position dependent response to wave excitation larger waves tended to oscillate the flaps more asymmetrically in the experiment as mean flap angle departs from zero only a component of the wave excitation force will impart flap motion resulting generally in simulation overpredicting the rao for larger wave heights the relative asymmetry of the experimental data and the reduced amplitude of oscillation align with this reasoning for the common frequency of oscillation it is unlikely that unmodeled static friction drives error in the second case the larger error occurs for the larger h 3 0 136 m wave for which there would be larger forces than the well modeled h 2 0 045 m wave case further reducing the impact of static friction which already appears to be negligible for the smaller wave case this suggests that the asymmetric flap oscillation may increase simulation error for high amplitude oscillations while unmodeled static friction increases simulation error for lower amplitude lower force operating conditions for which friction dominates 6 conclusion in this study experimental wave tank tests and numerical simulations of a 1 33 scale floating oscillating surge wave energy converter foswec are compared in regular waves in order to develop an open access validation data set the foswec was designed built and tested the device was tested for a range of different conditions including static offset free decay forced oscillation wave excitation and response to regular waves furthermore the foswec was tested in four different device configurations config 1 config 4 the details of the experimental setup and data analysis for each of the foswec tests are described in this paper and the experimental data simulations and processing for the foswec are available on public repositories in an open access format data from the experimental test were then compared to numerical simulations using the open source wec sim code informed by the bem solution calculated using wamit the wamit solution was evaluated a priori i e unadvised by experimental data and the wec sim results were evaluated a posteriori wherein the simulations were tuned based on experimental findings this comparison between numerical simulations and experiments uses raos in each of the degrees of freedom dof to compare the simulated and observed motion response the results detailed in this paper demonstrate that with some limitations wec sim is able to accurately simulate the response of the foswec in each of the four different configurations when subject to regular waves based on the limitations determined through this study the following future work items have been identified as exemplified through the comparison of the bem solution from wamit to the experimentally derived coefficients for the flap a large discrepancy between low frequency added mass estimates contributed to systematic overprediction of flap pitch response at these frequencies the authors of this paper believe that the inclusion of additional added mass for the flap at low wave frequencies would reduce the pitch raos substantially and bring the simulations into agreement with experiments however the wec sim code does not currently allow users to directly import experimentally derived coefficients such as added mass particularly when these parameters are derived in a distinct coordinate system from that used in simulation users are able to augment existing bem radiation damping and added mass data but there is no way to directly import frequency and amplitude dependent experimentally derived coefficients notably while much attention in the literature has been given to determination of viscous damping and drag these results suggest that equal attention should be paid to improving the accuracy of added mass estimates further the discrepancy between bem and experimentally derived estimates for the flap suggest that similar differences are likely for the platform highlighting the potential importance of forced oscillation testing in each degree of freedom for which accurate added mass estimates are essential to useful simulation results substantial modeling errors were observed for degrees of freedom subjected to small excitation loads and displacements due to the presence of unmodeled static friction while modeling accuracy could be enhanced through the inclusion of a static friction model it is noted that static friction is undesirable in a power producing wec and accurate modeling for low excitation conditions is of less interest than accuracy near power producing conditions where static friction is ideally insignificant a static friction model is therefore a lower priority improvement than allowing for direct definition of experimentally determined added mass in addition to work identified as a result of the regular wave simulation and data analysis future work beyond the scope of this publication includes expanding the numerical and experimental foswec comparison to irregular waves and loads characterization incorporating nonlinear hydrodynamics including froude krylov forces to the wec sim simulation will provide an additional point of comparison potentially improve simulation performance and further specify sources of discrepancy between experiment and simulation acknowledgments the authors would like to thank the following people for their support of wec sim validation testing and data analysis pedro lomonaco bret bosma ratanak so and asher simmons from oregon state university s o h hinsdale wave research laboratory andrews cooper for the design and fabrication of the foswec d for design and fabrication of the motion constraint and budi gunawan giorgio bacelli christopher a kelley chris simmons and carlos michelen from sandia national laboratories funding provided by the u s department of energy office of energy efficiency and renewable energy united states of america water power technologies office united states of america sandia national laboratories is a multimission laboratory managed and operated by national technology and engineering solutions of sandia llc a wholly owned subsidiary of honeywell international inc for the u s department of energy s national nuclear security administration under contract de na0003525 this work was also authored by the national renewable energy laboratory operated by the alliance for sustainable energy llc for the u s department of energy under contract no de ac36 08go28308 the views expressed in the article do not necessarily represent the views of the doe or the u s government 
22211,a novel mathematical model formulation based on spectral boundary element method sbem is presented to examine the wave response in the pohang new harbor pnh south korea and paradip port odisha india in sbem the boundary element method bem is coupled with the spectral element method sem to enhance the numerical accuracy of the present numerical scheme the numerical solution on each boundary element is obtained by using boundary integral associated with chebyshev point discretization the boundary integrals are transformed using jacobians and evaluated with clenshaw curtis quadrature rule convergence analysis is performed on rectangular domain for present scheme bem and hybrid finite element method hfem which shows that the present numerical scheme is better as compared to other traditional numerical schemes further the simulation results are validated with bem analytical method and experimental data from lee 1971 and ippen and goda 1963 the wave amplification is obtained at six record stations inside the pnh south korea and paradip port odisha india in addition the spectral density is also determined for multidirectional random waves propagating towards the pnh and paradip port at the same record station the resonant frequencies are estimated in pnh and paradip port for the safe navigation of moored ship keywords spectral boundary element method chebyshev point discretization helmholtz equation paradip port and pohang new harbor spectral density 1 introduction wave excitation around coastal regions is consequence of geometry configuration incident wave angle variation and bathymetry variation these oscillations interrupt the loading unloading of cargo damage mooring lines coastal structures and many more the resonance inside the port harbor is generated by the long period waves giorgio bellotti 2007 gonzález marco et al 2008 gao et al 2016 oscillations as well as short period waves agnon and mei 1989 girolamo 1996 due to diffraction refraction and partial reflection of wave with the interior boundary of harbor many research projects are executed by researchers to understand the phenomenon of resonance induced by the long wave and short wave propagating towards the harbor agnon and mei 1989 girolamo 1996 chen et al 2004 gonzález marco et al 2008 g bellotti et al 2012a to construct an efficient numerical model reliable understanding of the long short wave propagation is crucial in coastal engineering with applications in modification redesigning or maintenance of harbor ports coastal engineering manual 2008 therefore a mathematical model based on long and short waves is constructed to predict the wave oscillations resonance in the port for the safety of moored vessels from the last several years mathematical models based on numerical technique plays significant role in better understanding of the long short waves propagation problem around the coastal regions many numerical techniques have been reported by several researchers to solve boundary value problem governing the two dimensional helmholtz equation but the classical approach of solving such type of boundary value problem is based on boundary element method bem chou and han 1994 hamanaka 1997 kumar et al 2013 lee 1971 2004 lee and williams 2002 lee et al 2009 boundary element approach was introduced to treat the wave problem in harbors considering the partially reflecting boundary condition hamanaka 1997 isaacson and qu 1990 lee et al 2009 lee and williams 2002 in 2015 harwood et al introduced a methodology to construct green s function to solve helmholtz equation based on bem with dirichlet to neumann boundary condition harwood and dupère 2015 wave field analysis by 2d bem was presented by kumar et al 2013 further 3d bem is introduced to treat the highly irregular shaped domain with variable bathymetry kumar and gulshan 2018 finite element method fem becomes popular to solve the boundary value problem such as helmholtz equation as this technique results in sparse matrices which is further solved by using iterative methods babuska et al 1995 harari and hughes 1991 thompson and pinsky 1995 bem is accurate for wave scattering problems in unbounded regions also it satisfies the sommerfield radiation condition at infinity automatically in recent years many investigators have carried out analysis of wave excitation behavior due to incoming long and short waves propagating from open sea towards realistic ports or harbors using different numerical schemes a mathematical scheme based on fem is applied to estimate the wave response inside long beach harbor california usa xing 2009 port of marina di carrara italy giorgio bellotti et al 2012b yacht harbor of rome ostia italy bellotti 2007 and barbers point harbor hawaii chen and houston 1987 bem is utilized to analyze the wave response inside pnh south korea and paradip port odisha india kumar et al 2015 kumar and gulshan 2017 to improve the solution accuracy many researchers have developed mathematical models based on coupling of numerical methods to analyze the long and short wave propagation characteristics oscillation modes wave frequencies wave period wave height for example combination of fem and bem is introduced for the wave analysis belytschko et al 1989 hauguel 1978 kielhorn et al 2017 shaw and falby 1978 a hybrid finite difference method fdm and bem was developed to study wave properties zadeh and bingham 2010 naserizadeh et al 2011 hybrid finite element method hfem is utilized to analyze the wave oscillation modes around the coastal regions demirbilek and panchang 1998 houston 1981 kumar and rupali 2018 mei and chen 1976 each of these techniques has merits and demerits for their accuracy stability applicability and computational cost when implemented on different equations in 1980 s a hybrid spectral and finite element approach has been presented patera 1984 to study wave characteristics high order sem to model the unbounded problem based on helmholtz equation was presented he et al 2016 mehdizadeh and paraschivoiu 2003 further finite sem with hp convergence approach was presented to solve the helmholtz equation vos et al 2010 in this paper a numerical scheme based on spectral boundary element method sbem has been developed to predict the wave characteristics in a pnh south korea and paradip port odisha india this work focuses on the combined approach based on sem and bem that provides better convergence accuracy for treating the complex geometrical domain in this approach the boundary is discretized such that the nodes are the roots or extremes of the chebyshev polynomials and the integrals are transformed on each boundary segment with jacobian and evaluated using the numerical quadrature formula trefethen 2000 an important feature of sbem is that it provides the accurate information near the corners of the boundary where it is expected that the solution changes very sharply the validation and convergence of present numerical scheme is conducted which shows a good agreement with previous studies the current numerical scheme is applied on realistic ports such as pnh kumar et al 2016 and paradip port and the amplification factor inside these ports are computed to examine the resonant frequency for different incident wave directions additionally the wave spectral density is examined for the incoming long and short wave inside the realistic ports at six record stations in this paper section 1 presents the introduction background objective and motivation of this work section 2 describes the model geometry followed by formulating the mathematical model with appropriate boundary conditions and numerical calculation using spectral boundary element discretization scheme in sections 3 validation of present numerical scheme and comparison of convergence and error analysis for different numerical schemes is reported the present numerical model is applied on realistic harbors pnh and paradip port and the obtained simulations including the wave spectral density are discussed in detail in section 4 finally the conclusion on the basis of present work analysis is drawn in section 5 2 methodology 2 1 1 model geometry the computational domain is subdivided into two regions as displayed in fig 1 the interior region is bounded region denoted by ω2 and the outer region is unbounded denoted by ω1 the cartesian coordinates is placed on the entrance pq in which x axis is lying along the coastal boundary i e along the entrance y axis is towards the open sea and z axis is directed upwards the sea surface assuming that the fluid flow is irrotational and the fluid is incompressible and inviscid the velocity potential of the fluid in both the regions is expressed as follows 1 φ x y z t i a 0 g ω ϕ x y cosh k z h cosh k h exp i ω t where a 0 denotes the incident wave amplitude h is the local depth of water ω is the angular velocity and k represents the wave number satisfy the dispersion relation ω 2 g k tanh k h and ϕ x y is the potential function satisfying the helmholtz equation kumar et al 2015 the gradient of the velocity potential is termed as velocity vector and is expressed as u φ 2 2 wave function in bounded region to estimate the value of velocity potential eq 1 in the bounded region first the wave function ϕ 2 is evaluated which satisfies the 2 dimensional helmholtz equation 2 ϕ 2 k 2 ϕ 2 0 with boundary conditions given as follows a boundary condition at sea bottom is defined as 2 ϕ 2 z 0 at z h b linearized dynamic free surface boundary condition is 3 ϕ 2 z ω 2 g ϕ 2 at z 0 c the partially reflecting boundary condition is written as 4 ϕ 2 n β k ϕ 2 0 along ω 2 where n is the normal vector in outward direction and β is the transmission coefficient that can be expressed in term of reflection coefficient as β 1 k r 1 k r k r is the reflection coefficient isaacson and qu 1990 with value lying between 0 and 1 for fully reflecting boundary reflection coefficient is one and zero for fully absorbing boundary the wave function ϕ 2 x y at any point in the domain ω2 is obtained by using the green s identity formula and is expressed in the following form 5 ϕ 2 x y c ω ϕ 2 x 0 y 0 n h 0 1 k r h 0 1 k r n ϕ 2 x 0 y 0 d s where h 0 1 k r is the hankel function the first kind of order zeroth satisfying the helmholtz equation and r is the distance between point x y in the domain to the boundary point x 0 y 0 the complex geometrical parameter c for the bounded region is given as follows 6 c i 4 if x y is inside domain i 2 if x y is at boundary i π 2 α if x y is at corner point where α denote corner angle the parameter c is described in details for given three different forms as mentioned in eq 6 the wave function at any point in the bounded region is written as 7 ϕ 2 x i y i i 4 ω ϕ 2 x 0 y 0 n h 0 1 k r h 0 1 k r n ϕ 2 x 0 y 0 d s if the point x y in ω2 approaches to the boundary point x i y i and the element under integration is close to the collocation point or source point then integrand becomes weakly singular and hence require special treatment of regularization technique that is removing singularity and integrating separately for this let us consider a small circle ρ ε with radius ε that surrounds singularity then wave function is expressed in terms of sum of two integrals as follows 8 ϕ 2 x i y i i 4 ω ρ ε ρ ε ϕ 2 x 0 y 0 n h 0 1 k r h 0 1 k r n ϕ 2 x 0 y 0 d s taking limit ε 0 and applying cauchy principal value to the singular integral and using the asymptotic form for the hankel function for small ε eq 8 is rewritten as 9 ϕ 2 x i y i i 4 ω ϕ 2 x 0 y 0 n h 0 1 k r h 0 1 k r n ϕ 2 x 0 y 0 d s i 4 lim ε 0 ρ ε ϕ 2 x 0 y 0 2 i π r 1 2 i π log k r n ϕ 2 x 0 y 0 d s so the wave function for the boundary point is expressed as follows 10 ϕ 2 x i y i i 2 ω ϕ 2 x 0 y 0 n h 0 1 k r h 0 1 k r n ϕ 2 x 0 y 0 d s similarly if the point x y in ω2 approaches to the corner boundary point x i y i with interior angle α as shown in fig 1 the resulting wave function is given as 11 α 2 π ϕ 2 x i y i i 4 ω ϕ 2 x 0 y 0 n h 0 1 k r h 0 1 k r n ϕ 2 x 0 y 0 d s 2 2 1 spectral discretization in spectral approach the function is approximated by an interpolating polynomial over an interval chebyshev polynomial is considered as interpolating polynomial in which the chebyshev points x j cos j π n 0 j n are the projection of equispaced points on unit circle to 1 1 these points are the zeros of the chebyshev polynomial t n x cos n cos 1 x n 0 1 2 with the property that t n x 1 for x 1 in this problem the boundary of the computational domain ω is divided into number of linear segments i e ω ω n 1 ω n 2 ω n m each linear segment ω n k is further discretized into finite number of points onto 1 1 using the chebyshev discretization with following expression 12 x i x n k 1 x n k x n k 1 y i y n k 1 y n k y n k 1 z i 1 2 where z i cos π i n i 0 1 n where n is the total number of discretized points on the k t h boundary so the i t h point on the k t h boundary segment is given as follows 13 x i x n k 1 z i 1 2 x n k x n k 1 y i y n k 1 z i 1 2 y n k y n k 1 the wave function ϕ 2 x y on the boundary of domain given in eq 7 is expressed as sum of wave function on each discretized boundary and is written as follows 14 ϕ 2 x j y j i 2 i 1 m ω n i ϕ 2 x y n h 0 1 k r h 0 1 k r n ϕ 2 x y d s where m represents the total boundary segments further every i t h boundary segment i e ω n i is projected onto interval 1 1 and is partitioned into n i i linear chebyshev segments using chebyshev point discretization and the wave function is expressed as 15 ϕ 2 x j y j i 2 1 1 ϕ 2 x y n h 0 1 k r h 0 1 k r n ϕ 2 x y j 1 d z 1 1 ϕ 2 x y n h 0 1 k r h 0 1 k r n ϕ 2 x y j 2 d z 1 1 ϕ 2 x y n h 0 1 k r h 0 1 k r n ϕ 2 x y j n m d z above eq 15 is written in summation form as 16 ϕ 2 x j y j i 2 i 1 m 1 1 ϕ 2 x y n h 0 1 k r h 0 1 k r n ϕ 2 x y j i d z j 1 2 n where n n 1 1 n 2 2 n m m is the total number of discretized points on the whole boundary j i is the jacobian of transformation corresponding to i t h boundary element ω n i which is evaluated as follows 17 s x x i 2 y y i 2 z 1 2 x i x i 1 2 y i y i 1 2 j i d s d z x i x i 1 2 y i y i 1 2 2 i 1 2 m the wave function in eq 16 is expressed in the following matrix form 18 x i 2 i 1 n 1 1 g n 1 n i j x i g i j n 1 c i w i j 1 i 1 n 2 2 g n 2 n i j x i g i j n 2 c i w i j 2 i 1 n m m g n m n i j x i g i j n m c i w i j m where w i represents the weight functions obtained through clenshaw curtis quadrature rule for different discretization of the boundary the components in eq 18 are represented as follows 19 g n i j n h 0 1 k r i j i j 1 2 3 n c i n ϕ 2 x i y i x i ϕ 2 x i y i g i j h 0 1 k r i j thus the matrix form of eq 18 is given as 20 x b g n n 1 x n 1 g n 1 c n 1 g n n 2 x n 2 g n 2 c n 2 g n n m x n m g n m c n m where g n n 1 and g n 1 are matrix of dimension n n 1 1 1 g n n m and g n m are matrix of dimension n n m m 1 whereas g n n k and g n k are matrices of dimension n n k k k 2 3 m 1 respectively c n i represents the vector of normal derivative of wave function for the n i t h boundary and x n i denotes the vector of unknowns corresponding to n i t h boundary and b i 2 eq 20 provides the wave function along the boundary of the computational domain 2 3 wave function in open sea region the wave function ϕ 1 x y for the unbounded region is represented by sum of incident reflected and scattered wave function defined as 21 ϕ 1 x y ϕ i x y ϕ r x y ϕ s x y where ϕ i is the wave function for the monochromatic incident wave coming from the open sea towards the entrance ϕ r is the reflected wave function and ϕ s is scattered wave function due to the diffraction and reflection of incoming short or long waves to the inner boundary of the computational domain the expression for the incident wave function and the reflected wave function is given as 22 ϕ i x y a exp i k r cos θ θ 0 23 ϕ r x y a k r exp i k r cos θ θ 0 where θ 0 is the incident wave angle and a represents the incident wave amplitude respectively in the unbounded region the expression for the scattered wave function ϕ s x y is to be determined such that it satisfy the 2 dimensional helmholtz equation 2 ϕ s k 2 ϕ s 0 and the following boundary conditions a radiation boundary condition at infinity 24 lim r r n i k ϕ s 0 r x 2 y 2 b matching condition on the pseudo boundary 25 ϕ 1 ϕ 2 and ϕ 1 n ϕ 2 n c boundary condition along the exterior solid coastline 26 ϕ s n i k a 1 k r sin θ 0 exp i k x cos θ 0 therefore the scattered wave function at any point in the outer region obtained by utilizing green s identity formula and for point x y in the unbounded region that approaches to boundary point x i y i the scattered wave function is 27 ϕ s x i y i i 2 ω ϕ s x 0 y 0 n h 0 1 k r h 0 1 k r n ϕ s x 0 y 0 d s suppose the pseudo boundary is discretized into n 0 number of segments then the wave function is expressed as 28 ϕ s x i y i i 2 j 1 n 0 1 1 ϕ s x 0 y 0 n h 0 1 k r h 0 1 k r n ϕ s x 0 y 0 w j j j d z wave function for the unbounded region is determined by substituting eqs 22 and 23 and eq 28 into eq 21 further the unknown c i s normal derivative of the wave function for bounded region for each boundary points are evaluated by utilizing the matching condition from eq 25 along the pseudo boundary after that the wave function for the bounded region at boundary point is computed from eq 20 moreover the wave function ϕ 2 inside the bounded region is evaluated by the following expression 29 ϕ 2 x y i 4 i 1 n e 1 1 ϕ 2 x y n h 0 1 k r h 0 1 k r n ϕ 2 x y j i d z here amplification factor a f at any point x y is defined as the ratio of wave function for response wave to the monochromatic incident wave falling at entrance with incident angle θ 0 the amplification factor is computed to determine the wave frequency that generate strong and weak oscillation inside the region of definition 3 convergence and validation of numerical scheme 3 1 numerical discretization the numerical technique described above will be implemented to the model geometry under consideration for this the boundary of domain is discretized into number of segments using the spectral discretization chebyshev gauss lobatto nodes as well as regular discretization the numerical computation has been carried out on a rectangular harbor with width 0 06 m length 0 31 m and depth 0 26 m model geometry for rectangular harbor with x axis parallel to the coastal boundary and y axis towards the open sea is shown in fig 2 a for the validation and comparison of the convergence of present numerical scheme with other numerical schems regular discretized and spectral discretizated image of the rectangular domain is given in fig 2 b and c boundary of this rectangular domain is discretized into n1 100 n2 200 n3 400 and n 4 800 number of discrete straight segments to determine the numerical and convergence accuracy of the present scheme fig 2 b shows the discretization using spectral approach which gives dense points near the boundary whereas fig 2 c shows discretization of the boundary by regular division 3 2 validation of numerical model the present numerical scheme is validated by comparing the simulation results with the numerical scheme based on bem kumar et al 2013 experimental data of ippen and goda 1963 ippen and goda 1963 experimental data of lee 1971 lee 1971 and the analytical approximation for the rectangular domain in fig 3 the amplification factor as ordinate is shown which is evaluated at the center of the back wall boundary marked as w in fig 2 a and the abscissa represents the non dimensional wave number kl l is the length of the rectangular domain it is observed that present numerical model shows satisfactory comparison with the existing data the two resonance modes using the previous numerical schemes are obtained corresponding to non dimensional wave number kl 1 32 and kl 4 2 which is similar to wave number for the present numerical scheme 3 3 convergence of numerical model the numerical scheme is convergent if sequence of solutions obtained with refined discretization of domain approaches to a constant value furthermore a numerical scheme is consistent if the sequences of solutions converges to exact solution to analyze the order of convergence of the present numerical scheme based on spectral method convergence of the conventional bem and hfem least square method is utilized for this the computational domain is divided into n1 100 n2 200 n3 400 and n4 800 number of discrete elements respectively and the results are compared using the error formula for n1 n2 n3 and n4 number of elements given as 30 ϕ n 1 ϕ n 4 2 β n 1 α 31 ϕ n 2 ϕ n 4 2 β n 2 α where n 4 is taken as maximum number of elements n 4 n represents the order of convergence and β is a error constant the convergence results for different numerical schemes are shown in fig 4 and the order of convergence is obtained by solving eqs 30 and 31 in fig 4 the comparison of convergence and error analysis of different numerical schemes are presented in the left panel of fig 4 the error norm is given as ordinate and the abscissa represents the total number of discretized elements as per different numerical schemes the right panel represents the logarithm error norm in ordinate and abscissa with the logarithmic value the total number of discretized elements the order of convergence of sbem bem and hfem is obtained as 1 74 1 5 and 1 25 respectively on the basis of convergence results sbem have higher order of accuracy as compared to other numerical scheme thus the current numerical scheme sbem is applied on the irregular domain such as pnh and paradip port for practical applications 4 simulation results 4 1 implementation on pnh pnh located on the yongil bay in south korea experiences extreme wave oscillations during the hazardous weather condition this causes obstruction in loading unloading processes the topographic view of pnh is displayed in fig 5 a a pseudo boundary is placed in open sea region located at far distance from the port the discretized image of pnh model is shown in fig 5 b in which the cartesian coordinates are placed at the entrance along x axis and y axis is directed towards the open sea region the mean water depth is 10m the pnh boundaries are assumed as partially reflecting partially absorbing the above verified numerical scheme is employed to realistic pnh to predict the wave responses for this eight record stations w1 w8 are selected and are marked in fig 5 b the pnh boundary is partitioned by spectral discretization 4 1 1 amplification factor for pnh the above numerical scheme is employed to compute the amplification factor with respect to non dimensional wave number at each of the eight record stations marked as w1 w8 see fig 5 wave and tide gauge instrument wtg is installed at the inner record stations from w1 to w6 and wave rider buoy is set up at the outer record station w7 and w8 kumar et al 2014 fig 6 shows the eight amplification factor curve for the eight record stations for various incident angle directions fig 6 clearly revealed that the first five resonant frequencies are obtained at wave number k 1 0 32 k 2 2 04 k 3 2 7 k 4 4 04 and k 5 4 3 respectively for different incident wave angles it is observed that the wave amplitude varies with the variation of incident wave direction incident wave coming with these resonant frequencies generates strong wave excitation inside the harbor and these extreme waves can damage the harbor boundaries mooring ropes coastal boundaries therefore to examine the incident wave direction impact inside the harbor three direction incident wave angles are taken θ 0 π 4 east direction π 2 southeast direction and 3 π 4 south direction respectively further amplification factor is computed at each of the eight record stations inside the pnh for these incident wave angles it is visualized from the amplification curves shown in fig 6 that at all the record stations wave amplification is stronger for the incident wave angle θ 0 π 2 as compared to other incident wave directions for the first resonance peak at k 1 0 32 wave amplifies high at record station w4 w7 and w8 for the second resonant peak at wave number k 2 2 04 wave amplifies at record station w7 and w8 for the third peak at k 3 2 7 wave amplifies at record station w1 and w5 respectively whereas wave amplifies strongly at station w1 corresponding to the fourth and fifth resonant peak overall wave amplification at record stations w1 w7 and w8 are higher as compared to other record stations for all the incident wave angles hence the wave analysis assists in predicting the safest location of the mooring system inside the pnh 4 1 2 spectral density for pnh the spectral density is determined to analyze the wave energy distribution corresponding to various wave periods the wave spectral density plot shows the wave energy distribution as function of wave frequency or wave period the wave tide gauge measuring instrument is set up inside the pnh boundary at six locations market as w1 to w6 and the wave rider buoy measuring device is set up outside the pnh at locations marked as w7 and w8 in fig 5 b the numerical scheme is implemented to examine the spectral density at the eight key locations selected inside the pnh the plot for spectral density of long wave is obtained with respect to wave period taken from 30 s to 100 min with wave difference range of 30 s fig 7 displays the spectral density plot with respect to wave period at the key locations w1 w8 in which the resonant modes occurred at wave periods t1 3 5 min t2 8 t3 21 23 and t4 76 82 5 respectively it is observed that the energy distribution of waves varies with respect to different wave period and location of record points the monochromatic waves coming towards the coastal zones with wave period t1 t4 produces higher oscillations in the pnh for the short wave the wave spectral density is estimated numerically with respect to wave period ranges from 10sec to 10 min at eight record stations w1 to w8 the spectral density function for the eight record stations is displayed in fig 8 with frequency interval of 10 s the frequency peak at each record station is occurring at wave period t1 3 8 min and t2 8 9 5 min respectively the incoming long short wave corresponding to peak frequency produces high oscillations in the harbor the refined frequency interval i e δt 10 s is taken to clearly visualize the fluctuations of wave energy distributions at different record stations in the pnh to verify the present numerical scheme the simulation results of the present numerical scheme are compared with the measured data in fig 9 a the plot for wave spectral density with respect to wave period is shown for the measured data at the record stations w1 w5 and w8 respectively the resonant peaks of measured data are occurring at wave periods t1 5 min t2 8 min t3 22 24 min and t4 76 84 min respectively in fig 9 b the wave spectral density is computed from the present numerical scheme with respect to different wave periods at the record stations w1 w5 and w8 respectively the resonant peaks in fig 9 b are occurring approximately at wave periods t1 3 5 min t2 8 min t3 21 23 min and t4 76 82 5 min respectively thus the present model shows almost similar resonant frequencies when compared with the measured data plot the comparison of simulation results in fig 9 shows the numerical stability of present numerical scheme so the current model is implemented on any realistic port to determine the wave spectral density for different wave periods 4 2 implementation on paradip port paradip port located in east coast of india odisha is one of the international port for coastal trades large number of different materials are exported and imported from paradip port thus it is invariably a source for the economic growth of the nation a topographic image of the paradip port is displayed in fig 10 a generation of wave excitation beyond a threshold limit around this region due to seasonal variations affect various activities such as loading unloading of materials breakage of port boundaries etc so wave study has been done to have an accurate estimation of various wave frequencies that produces high or low wave oscillations inside the port for this six record points w1 w6 are identified inside the port for wave analysis and the port boundary is discretized into 1250 nodes using spectral discretization which is shown in fig 10 b 4 2 1 amplification factor for paradip port in fig 11 the amplification factor is shown at the port boundary corresponding to non dimensional wave number with incident angle variation which are θ 0 π 4 π 2 and 3 π 4 from fig 11 the resonant frequencies are arriving at non dimensional wave number k 1 0 4 k 2 1 2 k 3 2 02 and k 4 3 8 respectively with a wave frequency difference of 0 01 it is observed from the shown figure that wave amplitude is higher for the incident angle θ 0 π 2 as compared to other angles incident wave arriving with wave frequency k 1 0 4 k 2 1 2 k 3 2 02 and k 4 3 8 induces strong oscillations in the port wave amplification corresponding to the first resonant frequency k 1 0 4 is strong at the record stations w4 w6 for second resonant frequency i e k 2 1 2 strong wave generates around the record stations w2 w6 for third i e k 3 2 02 wave amplifies strongly at w5 and w6 respectively compared to remaining record stations whereas wave with frequency k 4 3 8 induces high oscillations at record station w1 and w6 hence an incident wave from diverse directions arriving at the harbor entrance with various resonant frequencies generates the wave amplifications in the interior of paradip port so the obtained simulation results assist in inspecting the secure location for the mooring vessels 4 2 2 spectral density for paradip port the above numerical scheme is employed to examine the wave spectral density inside the paradip port at various locations marked as w1 w6 in fig 10 with respect to different wave period in fig 12 the wave spectral density is plotted in which the abscissa is taken as wave period the resonant peaks for the long period wave are incurred approximately at frequency t1 9 10 min t2 25 min t3 36 5 min and t4 71 5 78 min respectively it is observed from fig 12 that the peaks of the spectral density varies with different wave period as well as the location of record stations inside the port the incoming long and short waves arriving with wave period t1 to t4 induces strong oscillations of the water surface in the paradip port these waves can damage the coastal boundaries and restrict the vessel movement in the port and interrupt the handling of cargo process when incoming long and short waves with frequency close to the range from t1 to t4 come into harbor entrance they can amplify the waves in the inner basin and can induce large oscillations hence the wave spectral density plotted at various record stations inside the paradip port provide significant information for the incoming wave intensity corresponding to these wave frequencies or wave period for the short wave the wave spectral density is estimated numerically with respect to wave period ranges from 10sec to 10 min at six record stations w1 to w6 the spectral density function for the six record stations is displayed in fig 13 with frequency interval of 10 s the frequency peak at each record station is occurring at wave period t1 1 7 min and t2 9 10 min respectively the incoming long short wave corresponding to peak frequency produces strong oscillation in the port the refined frequency interval i e δt 10 s is taken to clearly visualize the fluctuations of wave energy distributions at different record stations in the paradip port 5 conclusion a mathematical model is developed as the combination of bem and sem to analyze the characteristics of long and short period water wave in realistic harbors such as pnh south korea and paradip port india in this model the numerical accuracy is enhanced with the utilization of spectral discretization chebyshev gauss lobatto nodes further the convergence analysis of the present numerical scheme is shown that the coupled numerical model sbem have the higher convergence rate as compared to hfem and bem the simulation result of present numerical scheme has shown a good agreement with experimental data and analytical approximation the amplification factor is obtained at eight record stations specified as w1 to w8 inside the pnh and at six record stations w1 to w6 inside the paradip port for different incident wave angles θ 0 π 4 to 3 π 4 the resonant frequencies are obtained at wavenumber k 1 0 32 k 2 2 04 k 3 2 7 k 4 4 04 and k 5 4 3 in pnh and the resonant frequencies in paradip port are obtained at wave number k 1 0 4 k 2 1 2 k 3 2 02 and k 4 3 8 respectively the wave amplification is stronger for incident wave striking the entrance with angle θ 0 π 2 as compared to other incident wave angles θ 0 π 4 3 π 4 at the entrance additionally the spectral density at eight record stations from w1 to w8 in pnh and six locations w1 to w6 in paradip port are computed with respect to the wave period in minutes for the long wave simulation wave period ranges from 30 s to 100 min with frequency difference δt of 30 s in both the ports for the short wave wave period ranges from 10 s to 10 min with frequency difference δt of 10 s inside both the ports in pnh the resonant frequencies for long period wave are attained approximately at wave period t1 3 5 t2 8 t3 21 23 and t4 76 82 5 min respectively and the resonant frequencies in paradip port are attained at wave period t1 9 10 min t2 25 min t3 36 5 min and t4 71 5 78 min respectively whereas for short period wave the resonant frequencies are obtained at wave period t1 3 8 min t2 8 9 5 min in pnh and resonant frequencies in paradip port are attained at wave period t1 1 7 min and t2 9 10 min respectively moreover the comparison of the wave spectral density of present numerical scheme shows satisfactory agreement with the measured data the present numerical model is an efficient numerical tool to analyze the wave amplification in any realistic ports and harbors in the world credit author statement rupali conceptualization methodology software data curation validation writing original draft preparation prashant kumar visualization investigation supervision rajni writing reviewing and editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this work was supported by department of applied science mathematics national institute of technology delhi and the science engineering research board serb department of science and technology dst project grant no ecr 2016 001680 under the government of india we would like to thank prof kim kwang ik emeritus professor department of mathematics pohang university of science and technology south korea for providing us the measurement data for pnh we are thankful to the reviewers for their useful and valuable suggestions to improve our manuscript 
22211,a novel mathematical model formulation based on spectral boundary element method sbem is presented to examine the wave response in the pohang new harbor pnh south korea and paradip port odisha india in sbem the boundary element method bem is coupled with the spectral element method sem to enhance the numerical accuracy of the present numerical scheme the numerical solution on each boundary element is obtained by using boundary integral associated with chebyshev point discretization the boundary integrals are transformed using jacobians and evaluated with clenshaw curtis quadrature rule convergence analysis is performed on rectangular domain for present scheme bem and hybrid finite element method hfem which shows that the present numerical scheme is better as compared to other traditional numerical schemes further the simulation results are validated with bem analytical method and experimental data from lee 1971 and ippen and goda 1963 the wave amplification is obtained at six record stations inside the pnh south korea and paradip port odisha india in addition the spectral density is also determined for multidirectional random waves propagating towards the pnh and paradip port at the same record station the resonant frequencies are estimated in pnh and paradip port for the safe navigation of moored ship keywords spectral boundary element method chebyshev point discretization helmholtz equation paradip port and pohang new harbor spectral density 1 introduction wave excitation around coastal regions is consequence of geometry configuration incident wave angle variation and bathymetry variation these oscillations interrupt the loading unloading of cargo damage mooring lines coastal structures and many more the resonance inside the port harbor is generated by the long period waves giorgio bellotti 2007 gonzález marco et al 2008 gao et al 2016 oscillations as well as short period waves agnon and mei 1989 girolamo 1996 due to diffraction refraction and partial reflection of wave with the interior boundary of harbor many research projects are executed by researchers to understand the phenomenon of resonance induced by the long wave and short wave propagating towards the harbor agnon and mei 1989 girolamo 1996 chen et al 2004 gonzález marco et al 2008 g bellotti et al 2012a to construct an efficient numerical model reliable understanding of the long short wave propagation is crucial in coastal engineering with applications in modification redesigning or maintenance of harbor ports coastal engineering manual 2008 therefore a mathematical model based on long and short waves is constructed to predict the wave oscillations resonance in the port for the safety of moored vessels from the last several years mathematical models based on numerical technique plays significant role in better understanding of the long short waves propagation problem around the coastal regions many numerical techniques have been reported by several researchers to solve boundary value problem governing the two dimensional helmholtz equation but the classical approach of solving such type of boundary value problem is based on boundary element method bem chou and han 1994 hamanaka 1997 kumar et al 2013 lee 1971 2004 lee and williams 2002 lee et al 2009 boundary element approach was introduced to treat the wave problem in harbors considering the partially reflecting boundary condition hamanaka 1997 isaacson and qu 1990 lee et al 2009 lee and williams 2002 in 2015 harwood et al introduced a methodology to construct green s function to solve helmholtz equation based on bem with dirichlet to neumann boundary condition harwood and dupère 2015 wave field analysis by 2d bem was presented by kumar et al 2013 further 3d bem is introduced to treat the highly irregular shaped domain with variable bathymetry kumar and gulshan 2018 finite element method fem becomes popular to solve the boundary value problem such as helmholtz equation as this technique results in sparse matrices which is further solved by using iterative methods babuska et al 1995 harari and hughes 1991 thompson and pinsky 1995 bem is accurate for wave scattering problems in unbounded regions also it satisfies the sommerfield radiation condition at infinity automatically in recent years many investigators have carried out analysis of wave excitation behavior due to incoming long and short waves propagating from open sea towards realistic ports or harbors using different numerical schemes a mathematical scheme based on fem is applied to estimate the wave response inside long beach harbor california usa xing 2009 port of marina di carrara italy giorgio bellotti et al 2012b yacht harbor of rome ostia italy bellotti 2007 and barbers point harbor hawaii chen and houston 1987 bem is utilized to analyze the wave response inside pnh south korea and paradip port odisha india kumar et al 2015 kumar and gulshan 2017 to improve the solution accuracy many researchers have developed mathematical models based on coupling of numerical methods to analyze the long and short wave propagation characteristics oscillation modes wave frequencies wave period wave height for example combination of fem and bem is introduced for the wave analysis belytschko et al 1989 hauguel 1978 kielhorn et al 2017 shaw and falby 1978 a hybrid finite difference method fdm and bem was developed to study wave properties zadeh and bingham 2010 naserizadeh et al 2011 hybrid finite element method hfem is utilized to analyze the wave oscillation modes around the coastal regions demirbilek and panchang 1998 houston 1981 kumar and rupali 2018 mei and chen 1976 each of these techniques has merits and demerits for their accuracy stability applicability and computational cost when implemented on different equations in 1980 s a hybrid spectral and finite element approach has been presented patera 1984 to study wave characteristics high order sem to model the unbounded problem based on helmholtz equation was presented he et al 2016 mehdizadeh and paraschivoiu 2003 further finite sem with hp convergence approach was presented to solve the helmholtz equation vos et al 2010 in this paper a numerical scheme based on spectral boundary element method sbem has been developed to predict the wave characteristics in a pnh south korea and paradip port odisha india this work focuses on the combined approach based on sem and bem that provides better convergence accuracy for treating the complex geometrical domain in this approach the boundary is discretized such that the nodes are the roots or extremes of the chebyshev polynomials and the integrals are transformed on each boundary segment with jacobian and evaluated using the numerical quadrature formula trefethen 2000 an important feature of sbem is that it provides the accurate information near the corners of the boundary where it is expected that the solution changes very sharply the validation and convergence of present numerical scheme is conducted which shows a good agreement with previous studies the current numerical scheme is applied on realistic ports such as pnh kumar et al 2016 and paradip port and the amplification factor inside these ports are computed to examine the resonant frequency for different incident wave directions additionally the wave spectral density is examined for the incoming long and short wave inside the realistic ports at six record stations in this paper section 1 presents the introduction background objective and motivation of this work section 2 describes the model geometry followed by formulating the mathematical model with appropriate boundary conditions and numerical calculation using spectral boundary element discretization scheme in sections 3 validation of present numerical scheme and comparison of convergence and error analysis for different numerical schemes is reported the present numerical model is applied on realistic harbors pnh and paradip port and the obtained simulations including the wave spectral density are discussed in detail in section 4 finally the conclusion on the basis of present work analysis is drawn in section 5 2 methodology 2 1 1 model geometry the computational domain is subdivided into two regions as displayed in fig 1 the interior region is bounded region denoted by ω2 and the outer region is unbounded denoted by ω1 the cartesian coordinates is placed on the entrance pq in which x axis is lying along the coastal boundary i e along the entrance y axis is towards the open sea and z axis is directed upwards the sea surface assuming that the fluid flow is irrotational and the fluid is incompressible and inviscid the velocity potential of the fluid in both the regions is expressed as follows 1 φ x y z t i a 0 g ω ϕ x y cosh k z h cosh k h exp i ω t where a 0 denotes the incident wave amplitude h is the local depth of water ω is the angular velocity and k represents the wave number satisfy the dispersion relation ω 2 g k tanh k h and ϕ x y is the potential function satisfying the helmholtz equation kumar et al 2015 the gradient of the velocity potential is termed as velocity vector and is expressed as u φ 2 2 wave function in bounded region to estimate the value of velocity potential eq 1 in the bounded region first the wave function ϕ 2 is evaluated which satisfies the 2 dimensional helmholtz equation 2 ϕ 2 k 2 ϕ 2 0 with boundary conditions given as follows a boundary condition at sea bottom is defined as 2 ϕ 2 z 0 at z h b linearized dynamic free surface boundary condition is 3 ϕ 2 z ω 2 g ϕ 2 at z 0 c the partially reflecting boundary condition is written as 4 ϕ 2 n β k ϕ 2 0 along ω 2 where n is the normal vector in outward direction and β is the transmission coefficient that can be expressed in term of reflection coefficient as β 1 k r 1 k r k r is the reflection coefficient isaacson and qu 1990 with value lying between 0 and 1 for fully reflecting boundary reflection coefficient is one and zero for fully absorbing boundary the wave function ϕ 2 x y at any point in the domain ω2 is obtained by using the green s identity formula and is expressed in the following form 5 ϕ 2 x y c ω ϕ 2 x 0 y 0 n h 0 1 k r h 0 1 k r n ϕ 2 x 0 y 0 d s where h 0 1 k r is the hankel function the first kind of order zeroth satisfying the helmholtz equation and r is the distance between point x y in the domain to the boundary point x 0 y 0 the complex geometrical parameter c for the bounded region is given as follows 6 c i 4 if x y is inside domain i 2 if x y is at boundary i π 2 α if x y is at corner point where α denote corner angle the parameter c is described in details for given three different forms as mentioned in eq 6 the wave function at any point in the bounded region is written as 7 ϕ 2 x i y i i 4 ω ϕ 2 x 0 y 0 n h 0 1 k r h 0 1 k r n ϕ 2 x 0 y 0 d s if the point x y in ω2 approaches to the boundary point x i y i and the element under integration is close to the collocation point or source point then integrand becomes weakly singular and hence require special treatment of regularization technique that is removing singularity and integrating separately for this let us consider a small circle ρ ε with radius ε that surrounds singularity then wave function is expressed in terms of sum of two integrals as follows 8 ϕ 2 x i y i i 4 ω ρ ε ρ ε ϕ 2 x 0 y 0 n h 0 1 k r h 0 1 k r n ϕ 2 x 0 y 0 d s taking limit ε 0 and applying cauchy principal value to the singular integral and using the asymptotic form for the hankel function for small ε eq 8 is rewritten as 9 ϕ 2 x i y i i 4 ω ϕ 2 x 0 y 0 n h 0 1 k r h 0 1 k r n ϕ 2 x 0 y 0 d s i 4 lim ε 0 ρ ε ϕ 2 x 0 y 0 2 i π r 1 2 i π log k r n ϕ 2 x 0 y 0 d s so the wave function for the boundary point is expressed as follows 10 ϕ 2 x i y i i 2 ω ϕ 2 x 0 y 0 n h 0 1 k r h 0 1 k r n ϕ 2 x 0 y 0 d s similarly if the point x y in ω2 approaches to the corner boundary point x i y i with interior angle α as shown in fig 1 the resulting wave function is given as 11 α 2 π ϕ 2 x i y i i 4 ω ϕ 2 x 0 y 0 n h 0 1 k r h 0 1 k r n ϕ 2 x 0 y 0 d s 2 2 1 spectral discretization in spectral approach the function is approximated by an interpolating polynomial over an interval chebyshev polynomial is considered as interpolating polynomial in which the chebyshev points x j cos j π n 0 j n are the projection of equispaced points on unit circle to 1 1 these points are the zeros of the chebyshev polynomial t n x cos n cos 1 x n 0 1 2 with the property that t n x 1 for x 1 in this problem the boundary of the computational domain ω is divided into number of linear segments i e ω ω n 1 ω n 2 ω n m each linear segment ω n k is further discretized into finite number of points onto 1 1 using the chebyshev discretization with following expression 12 x i x n k 1 x n k x n k 1 y i y n k 1 y n k y n k 1 z i 1 2 where z i cos π i n i 0 1 n where n is the total number of discretized points on the k t h boundary so the i t h point on the k t h boundary segment is given as follows 13 x i x n k 1 z i 1 2 x n k x n k 1 y i y n k 1 z i 1 2 y n k y n k 1 the wave function ϕ 2 x y on the boundary of domain given in eq 7 is expressed as sum of wave function on each discretized boundary and is written as follows 14 ϕ 2 x j y j i 2 i 1 m ω n i ϕ 2 x y n h 0 1 k r h 0 1 k r n ϕ 2 x y d s where m represents the total boundary segments further every i t h boundary segment i e ω n i is projected onto interval 1 1 and is partitioned into n i i linear chebyshev segments using chebyshev point discretization and the wave function is expressed as 15 ϕ 2 x j y j i 2 1 1 ϕ 2 x y n h 0 1 k r h 0 1 k r n ϕ 2 x y j 1 d z 1 1 ϕ 2 x y n h 0 1 k r h 0 1 k r n ϕ 2 x y j 2 d z 1 1 ϕ 2 x y n h 0 1 k r h 0 1 k r n ϕ 2 x y j n m d z above eq 15 is written in summation form as 16 ϕ 2 x j y j i 2 i 1 m 1 1 ϕ 2 x y n h 0 1 k r h 0 1 k r n ϕ 2 x y j i d z j 1 2 n where n n 1 1 n 2 2 n m m is the total number of discretized points on the whole boundary j i is the jacobian of transformation corresponding to i t h boundary element ω n i which is evaluated as follows 17 s x x i 2 y y i 2 z 1 2 x i x i 1 2 y i y i 1 2 j i d s d z x i x i 1 2 y i y i 1 2 2 i 1 2 m the wave function in eq 16 is expressed in the following matrix form 18 x i 2 i 1 n 1 1 g n 1 n i j x i g i j n 1 c i w i j 1 i 1 n 2 2 g n 2 n i j x i g i j n 2 c i w i j 2 i 1 n m m g n m n i j x i g i j n m c i w i j m where w i represents the weight functions obtained through clenshaw curtis quadrature rule for different discretization of the boundary the components in eq 18 are represented as follows 19 g n i j n h 0 1 k r i j i j 1 2 3 n c i n ϕ 2 x i y i x i ϕ 2 x i y i g i j h 0 1 k r i j thus the matrix form of eq 18 is given as 20 x b g n n 1 x n 1 g n 1 c n 1 g n n 2 x n 2 g n 2 c n 2 g n n m x n m g n m c n m where g n n 1 and g n 1 are matrix of dimension n n 1 1 1 g n n m and g n m are matrix of dimension n n m m 1 whereas g n n k and g n k are matrices of dimension n n k k k 2 3 m 1 respectively c n i represents the vector of normal derivative of wave function for the n i t h boundary and x n i denotes the vector of unknowns corresponding to n i t h boundary and b i 2 eq 20 provides the wave function along the boundary of the computational domain 2 3 wave function in open sea region the wave function ϕ 1 x y for the unbounded region is represented by sum of incident reflected and scattered wave function defined as 21 ϕ 1 x y ϕ i x y ϕ r x y ϕ s x y where ϕ i is the wave function for the monochromatic incident wave coming from the open sea towards the entrance ϕ r is the reflected wave function and ϕ s is scattered wave function due to the diffraction and reflection of incoming short or long waves to the inner boundary of the computational domain the expression for the incident wave function and the reflected wave function is given as 22 ϕ i x y a exp i k r cos θ θ 0 23 ϕ r x y a k r exp i k r cos θ θ 0 where θ 0 is the incident wave angle and a represents the incident wave amplitude respectively in the unbounded region the expression for the scattered wave function ϕ s x y is to be determined such that it satisfy the 2 dimensional helmholtz equation 2 ϕ s k 2 ϕ s 0 and the following boundary conditions a radiation boundary condition at infinity 24 lim r r n i k ϕ s 0 r x 2 y 2 b matching condition on the pseudo boundary 25 ϕ 1 ϕ 2 and ϕ 1 n ϕ 2 n c boundary condition along the exterior solid coastline 26 ϕ s n i k a 1 k r sin θ 0 exp i k x cos θ 0 therefore the scattered wave function at any point in the outer region obtained by utilizing green s identity formula and for point x y in the unbounded region that approaches to boundary point x i y i the scattered wave function is 27 ϕ s x i y i i 2 ω ϕ s x 0 y 0 n h 0 1 k r h 0 1 k r n ϕ s x 0 y 0 d s suppose the pseudo boundary is discretized into n 0 number of segments then the wave function is expressed as 28 ϕ s x i y i i 2 j 1 n 0 1 1 ϕ s x 0 y 0 n h 0 1 k r h 0 1 k r n ϕ s x 0 y 0 w j j j d z wave function for the unbounded region is determined by substituting eqs 22 and 23 and eq 28 into eq 21 further the unknown c i s normal derivative of the wave function for bounded region for each boundary points are evaluated by utilizing the matching condition from eq 25 along the pseudo boundary after that the wave function for the bounded region at boundary point is computed from eq 20 moreover the wave function ϕ 2 inside the bounded region is evaluated by the following expression 29 ϕ 2 x y i 4 i 1 n e 1 1 ϕ 2 x y n h 0 1 k r h 0 1 k r n ϕ 2 x y j i d z here amplification factor a f at any point x y is defined as the ratio of wave function for response wave to the monochromatic incident wave falling at entrance with incident angle θ 0 the amplification factor is computed to determine the wave frequency that generate strong and weak oscillation inside the region of definition 3 convergence and validation of numerical scheme 3 1 numerical discretization the numerical technique described above will be implemented to the model geometry under consideration for this the boundary of domain is discretized into number of segments using the spectral discretization chebyshev gauss lobatto nodes as well as regular discretization the numerical computation has been carried out on a rectangular harbor with width 0 06 m length 0 31 m and depth 0 26 m model geometry for rectangular harbor with x axis parallel to the coastal boundary and y axis towards the open sea is shown in fig 2 a for the validation and comparison of the convergence of present numerical scheme with other numerical schems regular discretized and spectral discretizated image of the rectangular domain is given in fig 2 b and c boundary of this rectangular domain is discretized into n1 100 n2 200 n3 400 and n 4 800 number of discrete straight segments to determine the numerical and convergence accuracy of the present scheme fig 2 b shows the discretization using spectral approach which gives dense points near the boundary whereas fig 2 c shows discretization of the boundary by regular division 3 2 validation of numerical model the present numerical scheme is validated by comparing the simulation results with the numerical scheme based on bem kumar et al 2013 experimental data of ippen and goda 1963 ippen and goda 1963 experimental data of lee 1971 lee 1971 and the analytical approximation for the rectangular domain in fig 3 the amplification factor as ordinate is shown which is evaluated at the center of the back wall boundary marked as w in fig 2 a and the abscissa represents the non dimensional wave number kl l is the length of the rectangular domain it is observed that present numerical model shows satisfactory comparison with the existing data the two resonance modes using the previous numerical schemes are obtained corresponding to non dimensional wave number kl 1 32 and kl 4 2 which is similar to wave number for the present numerical scheme 3 3 convergence of numerical model the numerical scheme is convergent if sequence of solutions obtained with refined discretization of domain approaches to a constant value furthermore a numerical scheme is consistent if the sequences of solutions converges to exact solution to analyze the order of convergence of the present numerical scheme based on spectral method convergence of the conventional bem and hfem least square method is utilized for this the computational domain is divided into n1 100 n2 200 n3 400 and n4 800 number of discrete elements respectively and the results are compared using the error formula for n1 n2 n3 and n4 number of elements given as 30 ϕ n 1 ϕ n 4 2 β n 1 α 31 ϕ n 2 ϕ n 4 2 β n 2 α where n 4 is taken as maximum number of elements n 4 n represents the order of convergence and β is a error constant the convergence results for different numerical schemes are shown in fig 4 and the order of convergence is obtained by solving eqs 30 and 31 in fig 4 the comparison of convergence and error analysis of different numerical schemes are presented in the left panel of fig 4 the error norm is given as ordinate and the abscissa represents the total number of discretized elements as per different numerical schemes the right panel represents the logarithm error norm in ordinate and abscissa with the logarithmic value the total number of discretized elements the order of convergence of sbem bem and hfem is obtained as 1 74 1 5 and 1 25 respectively on the basis of convergence results sbem have higher order of accuracy as compared to other numerical scheme thus the current numerical scheme sbem is applied on the irregular domain such as pnh and paradip port for practical applications 4 simulation results 4 1 implementation on pnh pnh located on the yongil bay in south korea experiences extreme wave oscillations during the hazardous weather condition this causes obstruction in loading unloading processes the topographic view of pnh is displayed in fig 5 a a pseudo boundary is placed in open sea region located at far distance from the port the discretized image of pnh model is shown in fig 5 b in which the cartesian coordinates are placed at the entrance along x axis and y axis is directed towards the open sea region the mean water depth is 10m the pnh boundaries are assumed as partially reflecting partially absorbing the above verified numerical scheme is employed to realistic pnh to predict the wave responses for this eight record stations w1 w8 are selected and are marked in fig 5 b the pnh boundary is partitioned by spectral discretization 4 1 1 amplification factor for pnh the above numerical scheme is employed to compute the amplification factor with respect to non dimensional wave number at each of the eight record stations marked as w1 w8 see fig 5 wave and tide gauge instrument wtg is installed at the inner record stations from w1 to w6 and wave rider buoy is set up at the outer record station w7 and w8 kumar et al 2014 fig 6 shows the eight amplification factor curve for the eight record stations for various incident angle directions fig 6 clearly revealed that the first five resonant frequencies are obtained at wave number k 1 0 32 k 2 2 04 k 3 2 7 k 4 4 04 and k 5 4 3 respectively for different incident wave angles it is observed that the wave amplitude varies with the variation of incident wave direction incident wave coming with these resonant frequencies generates strong wave excitation inside the harbor and these extreme waves can damage the harbor boundaries mooring ropes coastal boundaries therefore to examine the incident wave direction impact inside the harbor three direction incident wave angles are taken θ 0 π 4 east direction π 2 southeast direction and 3 π 4 south direction respectively further amplification factor is computed at each of the eight record stations inside the pnh for these incident wave angles it is visualized from the amplification curves shown in fig 6 that at all the record stations wave amplification is stronger for the incident wave angle θ 0 π 2 as compared to other incident wave directions for the first resonance peak at k 1 0 32 wave amplifies high at record station w4 w7 and w8 for the second resonant peak at wave number k 2 2 04 wave amplifies at record station w7 and w8 for the third peak at k 3 2 7 wave amplifies at record station w1 and w5 respectively whereas wave amplifies strongly at station w1 corresponding to the fourth and fifth resonant peak overall wave amplification at record stations w1 w7 and w8 are higher as compared to other record stations for all the incident wave angles hence the wave analysis assists in predicting the safest location of the mooring system inside the pnh 4 1 2 spectral density for pnh the spectral density is determined to analyze the wave energy distribution corresponding to various wave periods the wave spectral density plot shows the wave energy distribution as function of wave frequency or wave period the wave tide gauge measuring instrument is set up inside the pnh boundary at six locations market as w1 to w6 and the wave rider buoy measuring device is set up outside the pnh at locations marked as w7 and w8 in fig 5 b the numerical scheme is implemented to examine the spectral density at the eight key locations selected inside the pnh the plot for spectral density of long wave is obtained with respect to wave period taken from 30 s to 100 min with wave difference range of 30 s fig 7 displays the spectral density plot with respect to wave period at the key locations w1 w8 in which the resonant modes occurred at wave periods t1 3 5 min t2 8 t3 21 23 and t4 76 82 5 respectively it is observed that the energy distribution of waves varies with respect to different wave period and location of record points the monochromatic waves coming towards the coastal zones with wave period t1 t4 produces higher oscillations in the pnh for the short wave the wave spectral density is estimated numerically with respect to wave period ranges from 10sec to 10 min at eight record stations w1 to w8 the spectral density function for the eight record stations is displayed in fig 8 with frequency interval of 10 s the frequency peak at each record station is occurring at wave period t1 3 8 min and t2 8 9 5 min respectively the incoming long short wave corresponding to peak frequency produces high oscillations in the harbor the refined frequency interval i e δt 10 s is taken to clearly visualize the fluctuations of wave energy distributions at different record stations in the pnh to verify the present numerical scheme the simulation results of the present numerical scheme are compared with the measured data in fig 9 a the plot for wave spectral density with respect to wave period is shown for the measured data at the record stations w1 w5 and w8 respectively the resonant peaks of measured data are occurring at wave periods t1 5 min t2 8 min t3 22 24 min and t4 76 84 min respectively in fig 9 b the wave spectral density is computed from the present numerical scheme with respect to different wave periods at the record stations w1 w5 and w8 respectively the resonant peaks in fig 9 b are occurring approximately at wave periods t1 3 5 min t2 8 min t3 21 23 min and t4 76 82 5 min respectively thus the present model shows almost similar resonant frequencies when compared with the measured data plot the comparison of simulation results in fig 9 shows the numerical stability of present numerical scheme so the current model is implemented on any realistic port to determine the wave spectral density for different wave periods 4 2 implementation on paradip port paradip port located in east coast of india odisha is one of the international port for coastal trades large number of different materials are exported and imported from paradip port thus it is invariably a source for the economic growth of the nation a topographic image of the paradip port is displayed in fig 10 a generation of wave excitation beyond a threshold limit around this region due to seasonal variations affect various activities such as loading unloading of materials breakage of port boundaries etc so wave study has been done to have an accurate estimation of various wave frequencies that produces high or low wave oscillations inside the port for this six record points w1 w6 are identified inside the port for wave analysis and the port boundary is discretized into 1250 nodes using spectral discretization which is shown in fig 10 b 4 2 1 amplification factor for paradip port in fig 11 the amplification factor is shown at the port boundary corresponding to non dimensional wave number with incident angle variation which are θ 0 π 4 π 2 and 3 π 4 from fig 11 the resonant frequencies are arriving at non dimensional wave number k 1 0 4 k 2 1 2 k 3 2 02 and k 4 3 8 respectively with a wave frequency difference of 0 01 it is observed from the shown figure that wave amplitude is higher for the incident angle θ 0 π 2 as compared to other angles incident wave arriving with wave frequency k 1 0 4 k 2 1 2 k 3 2 02 and k 4 3 8 induces strong oscillations in the port wave amplification corresponding to the first resonant frequency k 1 0 4 is strong at the record stations w4 w6 for second resonant frequency i e k 2 1 2 strong wave generates around the record stations w2 w6 for third i e k 3 2 02 wave amplifies strongly at w5 and w6 respectively compared to remaining record stations whereas wave with frequency k 4 3 8 induces high oscillations at record station w1 and w6 hence an incident wave from diverse directions arriving at the harbor entrance with various resonant frequencies generates the wave amplifications in the interior of paradip port so the obtained simulation results assist in inspecting the secure location for the mooring vessels 4 2 2 spectral density for paradip port the above numerical scheme is employed to examine the wave spectral density inside the paradip port at various locations marked as w1 w6 in fig 10 with respect to different wave period in fig 12 the wave spectral density is plotted in which the abscissa is taken as wave period the resonant peaks for the long period wave are incurred approximately at frequency t1 9 10 min t2 25 min t3 36 5 min and t4 71 5 78 min respectively it is observed from fig 12 that the peaks of the spectral density varies with different wave period as well as the location of record stations inside the port the incoming long and short waves arriving with wave period t1 to t4 induces strong oscillations of the water surface in the paradip port these waves can damage the coastal boundaries and restrict the vessel movement in the port and interrupt the handling of cargo process when incoming long and short waves with frequency close to the range from t1 to t4 come into harbor entrance they can amplify the waves in the inner basin and can induce large oscillations hence the wave spectral density plotted at various record stations inside the paradip port provide significant information for the incoming wave intensity corresponding to these wave frequencies or wave period for the short wave the wave spectral density is estimated numerically with respect to wave period ranges from 10sec to 10 min at six record stations w1 to w6 the spectral density function for the six record stations is displayed in fig 13 with frequency interval of 10 s the frequency peak at each record station is occurring at wave period t1 1 7 min and t2 9 10 min respectively the incoming long short wave corresponding to peak frequency produces strong oscillation in the port the refined frequency interval i e δt 10 s is taken to clearly visualize the fluctuations of wave energy distributions at different record stations in the paradip port 5 conclusion a mathematical model is developed as the combination of bem and sem to analyze the characteristics of long and short period water wave in realistic harbors such as pnh south korea and paradip port india in this model the numerical accuracy is enhanced with the utilization of spectral discretization chebyshev gauss lobatto nodes further the convergence analysis of the present numerical scheme is shown that the coupled numerical model sbem have the higher convergence rate as compared to hfem and bem the simulation result of present numerical scheme has shown a good agreement with experimental data and analytical approximation the amplification factor is obtained at eight record stations specified as w1 to w8 inside the pnh and at six record stations w1 to w6 inside the paradip port for different incident wave angles θ 0 π 4 to 3 π 4 the resonant frequencies are obtained at wavenumber k 1 0 32 k 2 2 04 k 3 2 7 k 4 4 04 and k 5 4 3 in pnh and the resonant frequencies in paradip port are obtained at wave number k 1 0 4 k 2 1 2 k 3 2 02 and k 4 3 8 respectively the wave amplification is stronger for incident wave striking the entrance with angle θ 0 π 2 as compared to other incident wave angles θ 0 π 4 3 π 4 at the entrance additionally the spectral density at eight record stations from w1 to w8 in pnh and six locations w1 to w6 in paradip port are computed with respect to the wave period in minutes for the long wave simulation wave period ranges from 30 s to 100 min with frequency difference δt of 30 s in both the ports for the short wave wave period ranges from 10 s to 10 min with frequency difference δt of 10 s inside both the ports in pnh the resonant frequencies for long period wave are attained approximately at wave period t1 3 5 t2 8 t3 21 23 and t4 76 82 5 min respectively and the resonant frequencies in paradip port are attained at wave period t1 9 10 min t2 25 min t3 36 5 min and t4 71 5 78 min respectively whereas for short period wave the resonant frequencies are obtained at wave period t1 3 8 min t2 8 9 5 min in pnh and resonant frequencies in paradip port are attained at wave period t1 1 7 min and t2 9 10 min respectively moreover the comparison of the wave spectral density of present numerical scheme shows satisfactory agreement with the measured data the present numerical model is an efficient numerical tool to analyze the wave amplification in any realistic ports and harbors in the world credit author statement rupali conceptualization methodology software data curation validation writing original draft preparation prashant kumar visualization investigation supervision rajni writing reviewing and editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this work was supported by department of applied science mathematics national institute of technology delhi and the science engineering research board serb department of science and technology dst project grant no ecr 2016 001680 under the government of india we would like to thank prof kim kwang ik emeritus professor department of mathematics pohang university of science and technology south korea for providing us the measurement data for pnh we are thankful to the reviewers for their useful and valuable suggestions to improve our manuscript 
22212,with the increase of the equipment size and the operating environment requirement more and more rectangular moonpools with large aspect ratios are used to instead of the circular or square moonpools with small aspect ratios however the research on the rectangular moonpool with a large aspect ratio is few firstly the fluid motion characteristic in the rectangular moonpool with a large aspect ratio is investigated experimentally in this paper by tracking and quantizing the free surface motion the moonpool has obvious shielding effects then the natural frequency of the piston motion in the moonpool is derived by theoretical methods which agrees well with the experimental results when the incident wave s period approximates the moonpool s natural oscillation period the resonant motion occurs with some adverse effects finally the reduction effects of four damping devices the positive grid of flaps negative grid of flaps grid of baffles and vertical bulkhead are investigated to reduce the adverse effects the damping devices have good reduction effects coupling with some incentive effects the grid of flaps effectively destroy the shear layer self sustaining oscillations and generate vortices the grid of baffles increases the fluid motion damping and forms the waterfall the vertical bulkhead causes interlaced motion keywords rectangular moonpool large aspect ratio hydrodynamic characteristics damping devices reduction effect 1 introduction the moonpool is widely used in the naval architecture and ocean engineering field because of its simple structure such as drilling vessels scientific research vessels and offshore platforms in harsh marine environments it provides a relatively quiet working environment for risers drills sonars and other devices the fluid inside and outside the moonpool is directly connected making the fluid movement in the moonpool complicated the fluid oscillation in the moonpool is a typical form of the internal free surface flow problem chen et al 2014 faltinsen 1993 faltinsen et al 2007 faltinsen and timokha 2015 heo et al 2014 ikeda et al 2012 mavrakos and chatjigeorgiou 2009 yu et al 2017 zhang and bandyk 2014 according to numerous studies the motion of water in the moonpool can be described as two modes piston motion and sloshing motion the vertical motion of fluid in the moonpool is piston motion and the horizontal motion of fluid in the moonpool which is similar to the motion in a rocking channel is referred to as sloshing motion fukuda 1977 kristiansen and faltinsen 2012 mciver 2005 molin 2001 zhou and zhang 2013 when the frequency of the incident wave is similar with the natural frequency of the fluid motion in the moonpool the resonant motion occur in the moonpool the internal water oscillations can reach several times of the incident wave height kristiansen 2009 kristiansen and faltinsen 2008 at a higher resonance frequency standing waves appear in the moonpool as the width of the moonpool becomes smaller the amplitude of the resonance increases dramatically chatellier et al 2004 fredriksen et al 2014 kristiansen and faltinsen 2010 liu et al 2017 to understand the resonance period the fluid motion in the moonpool was simplified as a mass spring system to establish the equations of fluid motion in the moonpool aalbers 1984 coupling with the resonant motion many adverse effects occur such as green water and the ship resistance increases endangering production and affecting the hydrodynamic performance of the structure sajjan and surendran 2013 tikhonov et al 1991 zhou and zhang 2013 to reduce the adverse effects different devices and technology were studied on the one hand the wave synchronizing crane was used to improve the working environment for riser launching and retrieving johansen et al 2003 messineo and serrani 2009 sagatun et al 2002 spanos et al 2011 on the other hand many damping devices were equipped in the moonpools to reduce the resistance during ships sailing and improve the hydrodynamic performance of offshore structures for example the wedges and cut out parts were arranged at the bottom of moonpool multiple sets of flaps or doors were arranged along the length of moonpool and the horizontal damping blocks were installed on the front and rear walls of moonpool to reduce the ship resistance park et al 2007 sivabalan and surendran 2017 a single layer of baffle or appendage was installed on the front or rear walls of the moonpool or a recess structure was added inside moonpool to increase damping and reduce the piston mode water motion guo et al 2017 lu et al 2015 michima and kawabe 2018 molin 2017 the bilge keel was extended to the structured skirt which reduced the unfavorable motion of the floating production drilling storage and offloading fpdso the opening size of the bottom of the moonpool was also changed in an attempt to reduce the heave motions of the monocolumn hull or the truss spar platform liu et al 2014 2015 sphaier et al 2007 the early application scenarios of the moonpool include scientific research vessels spar platforms and so on these studies primarily focused on square moonpools round moonpools or rectangular moonpools with small aspect ratio the aspect ratio is the ratio of the length to width of moonpool with the rapid development of marine engineering technology marine equipment is becoming larger to provide greater operating space and better production environments the large aspect ratio moonpools would be more widely used however there are relatively few studies of the rectangular moonpool with a large aspect ratio there is a critical need to study the fluid motion characteristic and damping devices for the rectangular moonpools with a large aspect ratio in this paper under the action of regular wave the fluid motion characteristic in the rectangular moonpool with a large aspect ratio is studied experimentally by quantizing and analyzing the free surface motion in the moonpool at the same time the natural frequency of the fluid piston motion in the moonpool is derived by theoretical methods which is verified with the experimental results on this basis the reduction effects of damping devices for the rectangular moonpool with a large aspect ratio are researched which are the positive grid of flaps the negative grid of flaps the grid of baffles and the vertical bulkhead 2 experiment set up the experiment is carried out in a wave channel with the size of 36 m long 1 2 m wide and 1 m deep the schematic of the wave channel can be seen in fig 1 a as shown in fig 1 a the wave maker is in the left side of the channel the damping zone is set at the right and there are eight wave height probes in the wave channel at the bottom of the channel a long bubble generator was equipped below the moonpool to assist in capturing the flow field changes the ship model is 2 99 m long and a rectangular moonpool model is installed in the ship model the rectangular moonpool model is 0 7 m long 0 24 m wide and 0 6 m high the draught of the rectangular moonpool model is 0 16 m fig 1 b gives the 3d schematic of the ship model used in this experiment as shown in fig 1 b the ship model include front and rear baffles actually the longer the length of the front and rear baffles the better the steady flow parallel to the parallel medium body but it will greatly increase the difficulty and cost of the model s manufacture studies have shown that when the ratio of the length of the baffle to the moonpool is 1 67 1 kang 2006 the impact is less so the length of the front baffle is set to 1 25 m the length of the rear baffle is set to 1 04 m to facilitate the monitoring of experimental phenomena the models are made of transparent acrylic material as shown in fig 1 c the middle section of the ship model includes the mounting holes for bow and stern and the mounting place for different moonpools the bow and stern models are arc so the waves can transmit efficiently in the channel the ship and moonpool model are fixed to reduce unnecessary oscillation during the experiment the ship model is fixed in the channel heading regular waves there are 20 different regular waves in this experiment as shown in table 1 when the period is a constant if the wave height continues to its maximum the wave will break therefore the corresponding maximum wave height value is set according to different periods in addition there are rectangular moonpool rectangular moonpool with positive grid of flaps rectangular moonpool with negative grid of flaps rectangular moonpool with grid of baffles and rectangular moonpool with vertical bulkhead five different moonpools in this study however the five different moonpools are subjected to the same test cases in the process of the experiment design the level of uncertainty on the experimental results is considered the ship model size and shape are designed reasonably according to the channel s principal dimensions the ship and moonpool model are fixed to reduce unnecessary oscillation the experimental results show that the influence of oscillation is within the acceptable range the eight wave height probes are produced in the same batch and have the same measurement standards the consistency experiment of the eight wave height probes has been completed before the formal experiment some experimental phenomena such as the sloshing motion the piston motion and so on are similar with the findings of other researchers faltinsen and timokha 2015 molin 2017 in the paper the experimental results and the experimental phenomena are mutually verified 3 hydrodynamic characteristics of fluid in the rectangular moonpool to illustrate the fluid motion characteristics in the rectangular moonpool with a large aspect ratio the free surface evolution within one resonant period in the moonpool for case 14 is given in fig 2 when t 1 4t the incident wave peak passes the moonpool and the fluid in the moonpool rises as a whole at this time the free surface shows a significant drooping state and obviously climbs along the moonpool s walls when t 1 2t the fluid in the moonpool falls as a whole the free surface clearly shows a hogging condition forming a steep peak in the middle of the moonpool when t 3 4t the fluid in the moonpool begins to rise and the double peaks appear in the free surface the peak height at this time is less than the one formed at 1 2t when t t the fluid in the moonpool rises a single peak appears in the free surface but the peak position is not located in the center of the moonpool during the entire period there is a visible piston and sloshing motion in the moonpool the fluid motion characteristics in the rectangular moonpool with a large aspect ratio will be studied below from the piston and sloshing motion two aspects particularly for case 2 the free surface in the moonpool tends to be flat while the wave outside the moonpool has a relative large height as shown in fig 3 a as shown in fig 3 b for the period of t 0 32 s there is no wave activity deeper than 0 08 m half of the wavelength considering that the draught of the moonpool is 0 16 m there is almost no wave excitation inside the moonpool the essence of the excitation of incident waves on the fluid in the moonpool is the process of the energy of incident wave transmitting into the moonpool the wave power can be calculated as falnes 2002 1 ρ 0 976 t h 2 where p is the wave power t is the wave period and h is the wave height according to eq 1 when the wave period is small the wave power is litter making it impossible to penetrate the shield of the moonpool effectively and stimulate the fluid motion in the moonpool so the experimental results of the two cases with a period of 0 32 s would not be discussed below 3 1 piston motion to illustrate the piston motion of the fluid in the rectangular moonpool the statistics of the motion amplitude at point e is given in fig 4 h e0 represent the fluid motion amplitude at point e in the rectangular moonpool with a large aspect ratio as shown in fig 4 the fluid in the moonpool is excited by the incident waves and the free surface fluctuation value at the point e increases as the incident wave height increases when the incident wave height is less than 0 07 m the fluid motion amplitude in the moonpool is similar for the cases with same wave height and different periods which shows the obvious shielding effect of the moonpool when the incident wave height is greater than 0 07 m the fluid motion amplitude in the moonpool is different for the cases with same wave heights and different periods the higher the incident wave height the greater the incident wave energy and the stronger the excitation to the fluid in the moonpool the main phenomenon is that when the incident wave height is large the fluid motion in the moonpool shows the forced oscillation characteristics the fluid piston motion in the moonpool is the most intense under the action of the incident wave with the period of 1 28 s therefore it is estimated that 1 28 s approximates the inherent piston oscillation period of the moonpool which causes the resonant motion the responsive amplitude is 1 74 times the incident wave height to study the piston resonance motion of the fluid in the rectangular moonpool with a large aspect ratio a periodic formula of the natural period for fluid piston motion in the rectangular moonpool with a large aspect ratio is derived the research objective in this paper is the moonpool with a length width draught ratio of 4 42 1 51 1 that is characteristic length is much greater than the width and draught the natural period formula for the piston motion of the fluid in the moonpool obtained by faltinsen 1993 only involves draughts and does not involve the length and width of the moonpool fukuda 1977 proposed the formula for the circular moonpool and the rectangular moonpool the maximum aspect ratio of the rectangular moonpool is 2 7 while the one in ours paper is 2 9 therefore it is necessary to derive a new formula suitable for a rectangular moonpool with a large aspect ratio the fluid piston motion in the moonpool is simplified to be a mass spring vibration system as shown in fig 5 a the fluid piston motion in the moonpool with length l width b and draught d is assumed to be a vertical movement of rectangular objects with an equal volume and density of ρ floating on the free surface the coordinate of the moonpool s section is shown in fig 5 b the equation of motion is established by the d alembert principle kang 2006 2 m δ m z ρ g s z 0 where m is the mass of the fluid in the moonpool δ m is the additional mass and s is the cross sectional area equal to l b the formula meyerhoff 1970 sarpkaya 2010 solves δ m 0 the additional mass of a plate of unit width immersed in water as it oscillates vertically 3 δ m 0 ρ π l 2 4 consider that the fluid in the moonpool has a fluid piston oscillation in the vertical direction at the liquid level so at this time 4 δ m 0 ρ π l 2 8 therefore it is possible to obtain an additional mass for a rectangular floating cross section making a heave motion on the free surface 5 δ m b δ m 0 d y b ρ π l 2 8 d y ρ π l 2 b 8 finally the natural frequency of the fluid piston oscillation in the rectangular moonpool is 6 f 0 1 2 π ρ g s m δ m 1 2 π g d π l 8 according to eq 6 the theoretical value of the natural frequency of the piston motion in the moonpool is 0 76 hz which is similar to the frequency of the incident wave s period of 0 78 hz in the experiment the fluid in the moonpool forms a resonance motion the responsive amplitude is significantly greater than the incident wave height at the same time the fluid motion amplitudes at points a and b are counted to analyze the fluid motion near the wall of the moonpool h a0 and h b0 represent the fluid motion amplitude at points a and b in the rectangular moonpool with a large aspect ratio respectively the amplitude of the fluid piston motion at point a in the moonpool increases with the increase of the incident wave height in fig 6 a for the cases with periods of 1 28 s or 1 92 s the piston motion amplitude in the moonpool is greater than the corresponding incident wave height however for the cases with a period of 0 64 s the amplitude of the fluid motion in the moonpool is less than the corresponding incident wave height when excited by the incident wave the amplitude of the piston motion at point b increases with the increase of the incident wave height in fig 6 b under the action of different incident waves with same wave height the fluid motion values in the rear of the moonpool are similar compared fig 6 a with fig 6 b it can be seen that under the action of waves with a large period and high amplitude the fluid motion amplitudes at points a and b in the moonpool are greater than the incident wave height this is primarily because the two points a and b are close to the moonpool s walls and water climbs along the walls causing the fluid to move vigorously for the cases with a period of 0 64 s the amplitude of the piston motion at the rear of the moonpool is greater than at the front of the moonpool indicating that the fluid motion in the rear of the moonpool is more intense to further illustrate the shielding effect of the moonpool fig 7 gives the time histories of the wave elevation at some points for case 5 as shown in fig 7 on the one hand the phase of fluid motion at point e in the moonpool lags behind the phase of the incident wave at point f out the moonpool the moonpool hinders the flow field inside and outside forming a shielding effect and creating a relatively stable working space on the other hand the fluid motion amplitude at point e is smaller than the wave height at point f it is because that during the fluid exchange process inside and outside the vortex forms at the front and rear walls of the moonpool which dissipates energy the fluid motion in the moonpool is weakened the vortex motion is shown in fig 8 to further illustrate the forced oscillation characteristics of the fluid motion in the moonpool fig 9 gives the time histories of wave elevations at some points for case 19 as shown in fig 9 the phase fluid motion inside and outside moonpool are similar the incident wave with large period has the diffraction effect therefore the fluid motion in the moonpool is much more affected by such incident waves and exhibits the characteristics of forced oscillation 3 2 sloshing motion to illustrate the sloshing motion of the fluid in the rectangular moonpool the free surface shapes in moonpool at different times for case 13 are given in fig 10 as shown in fig 10 the length of the moonpool is greater than the wavelength of the generated wave in the moonpool the fluid motion difference at points a e is taken as the sloshing amplitude for case 13 however unlike the wavelengths formed in the rectangular moonpool for case 13 fig 11 gives the wavelengths formed in the moonpool for case 5 and case 19 as shown in fig 11 the length of the moonpool is less than one wavelength of waves formed in the moonpool the fluid motion difference at points a b is taken as the sloshing amplitude for case 5 and case 19 the fluid motion difference between the front and rear monitoring points is not certainly the sloshing motion amplitude in the moonpool therefore the fluid motion difference at points a e a b and b e compared statistically the maximum value is taken as the x axis sloshing amplitude as the model is in the wave facing state the y axis sloshing motion amplitude is the motion difference of the points c e or d e table 2 gives the statistics of difference points took for fluid sloshing motion amplitude in x axis in the rectangular moonpool as shown in table 2 for the cases with periods of 0 64 s and 1 92 s the sloshing motion amplitude in the x axis takes the fluid motion difference between the points a b which is close to the front and the rear walls of the moonpool for the cases with a period of 1 28 s the points change from e b to a e as the incident wave height increases under the action of incident waves with a small height the fluid motion in the rear of the moonpool is stronger than that in the front under the action of waves with large height the fluid motion in the front of the moonpool is stronger than the motion in the rear for further studying the sloshing motion of the fluid in the moonpool the sloshing motion in x axis and y axis are given in fig 12 h s0 represents the sloshing motion amplitude in the rectangular moonpool as shown in fig 12 a the fluid sloshing motion in x axis in the moonpool becomes intense as the incident wave height increases for the cases with a period of 0 64 s the x axis sloshing motion in the moonpool is obvious but its amplitude is smaller than the incident wave height for the cases with a period of 1 92 s the x axis sloshing motion amplitude is smaller than the incident wave height and the sloshing motion in the moonpool is obviously weaker than the piston motion according to the molin formula molin 2001 the period of fluid sloshing in the moonpool can be obtained as 1 21 s which is approximately the 1 28 s wave period therefore under the action of the incident wave with a period of 1 28 s and large wave height the x axis sloshing motion in the moonpool is the most intense the ratio of the amplitude of sloshing motion to the incident wave height is 1 48 as shown in fig 12 b the amplitude of the y axis sloshing motion is less than that of the x axis in the moonpool under the action of incident waves with large heights and different periods the amplitudes of y axis sloshing motion in the moonpool are similar indicating that the fluid sloshing motion in the moonpool shows self sustaining oscillation characteristics when the incident wave frequency is similar with the resonance frequency of fluid motion in the moonpool the y axis sloshing motion in the moonpool increases sharply the maximum value is 6 2 10 2 m but the y axis sloshing motion is still weaker than that of the x axis there are two main reasons for this on the one hand the ship is in the condition of a head sea so the flow field is symmetrical along the longitudinal section in the ship moreover there is no obvious pressure and acceleration difference on the left and right sides of the moonpool on the other hand during the vertical oscillation in the moonpool a shear layer forms along the walls of the moonpool therefore the fluid motion along the walls lags behind fluid motion in the center of the moonpool which is an important reason for the y axis sloshing motion to analysis the sloshing resonance motion fig 13 gives the time histories of sloshing motion in the rectangular moonpool and corresponding spectrum analysis maps for typical test case as shown in fig 13 a the main peak frequency in the spectrum analysis maps for case 5 is 1 56 hz while the incident wave s frequency is 1 56 hz as shown in fig 13 b the main peak frequency in the spectrum analysis maps for case 13 is 0 78 hz in addition the incident wave s frequency is 0 78 hz which is close to the natural frequency of fluid sloshing motion in the moonpool with a value of 0 82 hz forming resonance and sloshing intensely at this time the fluid sloshing motion in the moonpool exhibits the self excited oscillation characteristics as shown in fig 13 c the main peak frequency in the spectrum analysis maps for case 19 is 0 52 hz while the incident wave s frequency is 0 52 hz for cases 05 and 19 the fluid motion in the moonpool is significantly excited by incident waves 4 reduction effect of damping devices in the rectangular moonpool to facilitate the evaluation of the reduction effect for piston motion we performed a non dimensional treatment for the experimental data the reduction coefficient c p for piston motion is defined as follows 7 c p h p 0 h p h p 0 where h p0 is the statistical value of the fluid piston motion at point e in the rectangular moonpool without the damping device and h p is the statistical value of the piston motion at point e in the moonpool with damping devices similarly the sloshing reduction coefficient c s is defined as follows 8 c s h s 0 h s h s 0 where h s0 is the statistical value of the fluid sloshing motion in the rectangular moonpool without the damping device and h s is the statistical value of the sloshing motion in the rectangular moonpool with damping devices 4 1 positive grid of flaps the positive grid of flaps are installed at the bottom of the moonpool fig 14 gives the pictures of the model of grid of flaps as shown in fig 14 a the grid of flaps is a ramp shaped structure consisting of horizontal flaps inclined flaps and three longitudinal girders the width of the horizontal flap is 19 mm the inclined flap is 34 mm wide and 30 inclined as shown in fig 14 b the opening ratio of the moonpool s bottom is 0 32 because the inclined flaps have directionality the reduction effects in different installation directions are studied experimentally the positive direction of the grid of flaps is that the inclined flaps are close to the front wall of the moonpool and the horizontal plate is close to the rear wall of the moonpool to facilitate the monitoring of the experimental phenomenon the material of the grid of flaps is a blue acrylic plate which is in sharp contrast with the transparent acrylic of the moonpool to illustrate the fluid motion characteristics in the rectangular moonpool with the positive grid of flaps fig 15 gives the free surface evolution within one resonant period at the longitudinal section of the moonpool with the positive grid of flaps for case 14 when t 0 the incident wave trough is outside of moonpool the fluid in the moonpool fluctuates slightly with the fluid close to the rear wall obviously depressed when t 1 4t the fluid motion amplitude in the front of the moonpool is higher than that in the rear while the fluid near the rear wall fluctuates obviously at the same time the free surface is seriously disturbed close to the rear wall when t 1 2t the incident wave crest is outside of the moonpool the fluid climbs significantly along the rear wall of the moonpool therefore the fluid motion amplitude in the rear of the moonpool is higher than that in the front part at t 3 4t there is a slight fluid fluctuation in the moonpool and an isolated small peak appears in the rear of the moonpool 4 1 1 effect on piston motion to study the reduction effect of the positive grid of flaps on the piston motion in the moonpool the fluid motion at point e in the rectangular moonpool with without the positive grid of flaps are compared fig 16 gives the statistics of fluid piston motion amplitude and c p at point e in the moonpool with the positive grid of flaps as shown in fig 16 a the fluid motion amplitude in the moonpool increases as the incident wave height increases for the cases with a period of 0 64 s the fluid piston motion amplitude increases slowly in the moonpool as the incident wave height increases for the cases with periods of 1 28 s and 1 92 s the fluid motion amplitude in the moonpool is close to the incident wave height and its growth rate is large the resonance phenomenon disappears and the forced motion phenomenon appears as shown in fig 16 b for the cases with a period of 0 64 s c p is between 0 6 and 0 75 and the reduction effect is obvious the positive grid of flaps reduces the water permeable area at the moonpool s bottom reducing the fluid exchange speed inside and outside the moonpool and hindering the fluid piston motion in the moonpool as a result the shielding function of the moonpool is strengthened in other words a significant reduction effect is achieved for the cases with a period of 1 28 s c p increases from zero to 0 4 with the increase of the incident wave height indicating that the greater the incident wave height the more obvious the reduction effect when the rectangular moonpool is not equipped with the positive grid of flaps the fluid motion amplitude in the moonpool is greater than the incident wave height after the installation of the positive grid of flaps the fluid motion amplitude in the moonpool is similar to the incident wave height showing the forced motion characteristics for the cases with a period of 1 92 s c p maintains between zero and 0 1 and the reduction effect is not obvious for the cases with a period of 1 92 s the fluid motion in the moonpool is forced to oscillate at this time the positive grid of flaps weakens some energy of the incident wave but the reduction effect is not obvious the main reason is that the incident wave with a period of 1 92 s has a longer wavelength which easily causes diffraction when it encounters the flaps therefore the flaps reduction effect on the long wave is weaker than on the short one to illustrate the fluid motion under the action of the positive grid of flaps fig 17 gives the flow field and free surface in the rectangular moonpool with the positive grid of flaps for case 13 as shown in fig 17 a two vortices form disturbing the fluid motion in the moonpool at the same time the streamlines indicate that flaps obstruct the fluid exchange inside and outside the moonpool and destroy the fluid s self sustaining sloshing motion in the moonpool as shown in fig 17 b the front free surface is relatively flat and the back has some peaks with different height overall the free surface appears discontinuous fig 18 gives the time histories of fluid motion at point e f in the rectangular moonpool with the positive grid of flaps for case 13 as shown in fig 18 the fluid motion response in the moonpool lags behind the external excitation wave the fluid motion trajectory inside and outside the moonpool has a folding angle with the positive grid of flaps installed in other words a partition formed between the fluid in the moonpool and the incident wave so the fluid exchange not timely the horizontal and sloping flaps will guide the water flow to produce the horizontal and oblique shear layer self sustaining oscillations at the edges of the flaps the vertical motion exchanges with the horizontal motion the fluid falls off on the edge of the flaps with the vortex easily generating the vortex destroys the original piston motion so the positive grid of flaps reduces the energy of the external fluid entering the moonpool the positive grid of flaps present at the bottom of the moonpool causes the piston motion to be hindered the shear layer self sustaining oscillations decrease as the vertical motion speed decreases in other words the positive grid of flaps greatly weakens the exciting effect of the incident wave resulting in a significant reduction effect 4 1 2 effect on sloshing motion to illustrate the sloshing motion of the fluid in the rectangular moonpool with the positive grid of flaps the statistics of difference points taken for fluid sloshing motion amplitude in x axis are given in table 3 the choice of points reflects the position of the violently fluid motion in the moonpool the points a b fluid motion difference is mostly taken as the x axis sloshing motion amplitude in the moonpool equipped with the positive grid of flaps while the points a e difference is taken in fewer test cases the positive grid of flaps has an obvious influence on the original resonance condition with a period of 1 28 s when the flaps are not equipped the x axis sloshing motion amplitude takes the fluid motion difference at points e b or a e in other words the sloshing motion in the moonpool is asymmetrical when the flaps are equipped the x axis sloshing motion amplitude in the moonpool is only taken from the fluid motion difference at points a b which corresponds to fig 20 under the action of the positive grid of flaps the free surface in the moonpool tends to be flat forming a slope as a whole in some of the cases with small wave height the x axis sloshing motion amplitude takes on the fluid motion difference at the points a e mainly in the test cases with small wave height the free surface in the moonpool is flat however fluid climbs obviously at point a it exhibits nonlinear characteristics and forms solitary waves in the center of the moonpool the reduction effects for the sloshing motion are analyzed from the sloshing motion in x axis and y axis fig 19 gives the statistics of sloshing motion amplitude and c s in x axis in the rectangular moonpool with the positive grid o flaps as shown in fig 19 a the x axis sloshing motion amplitude in the moonpool increases as the incident wave height increases and the x axis sloshing motion amplitude is smaller than the incident wave height when the incident wave height is a constant the smaller the period of the incident wave the greater is the fluid sloshing motion amplitude in the moonpool under the action of the positive grid of flaps the original resonance phenomenon disappears in the rectangular moonpool as shown in fig 19 b for the cases with a period of 1 28 s c s increases with the increase of the incident wave height and the maximum is 0 6 therefore the reduction effect is obvious for the cases with a period of 0 64 s the c s is nominally zero and the reduction effect is not obvious for the cases with a period of 1 92 s the c s is concentrated between 0 3 and 0 6 and the reduction effect is very poor conversely under the action of the positive grid of flaps the sloshing motion in the moonpool is intensified primarily because the flaps hinder the fluid in the moonpool at the same time under the guidance of the flaps the vertical piston motion converts to the horizontal sloshing motion with a large number of vortices generating at the same time because of the action of the flaps the rates of fluid exchange in the vertical section of the moonpool are different resulting in a horizontal speed difference and forcing fluids to produce a horizontal sloshing motion fig 20 gives the statistics of fluid sloshing motion amplitude and c s in y axis as shown in fig 20 the y axis sloshing motion in the moonpool becomes intense with the increase of the incident wave height at the same time the sloshing motion amplitude is much less than the incident wave height for the cases with a period of 0 64 s c s is concentrated between 0 6 and 0 8 under the action of the positive grid of flaps and the reduction effect is obvious for the cases with a period of 1 28 s c s increases with the increase of the incident wave height and the maximum of c s is 0 6 the c s is concentrated between 0 2 and zero for the incident waves with a period of 1 92 s which decreases with the increase of the incident wave height in other words at this time the positive grid of flaps has no reduction effect 4 2 negative grid of flaps the difference between the positive and negative grid of flaps is the installation direction of the grid of flaps the reduction effects of the negative grid of flaps are researched and compared with that of the positive grid of flaps fig 21 gives the fluid motion in the moonpool with the negative grid of flaps when t 0 the incident wave trough outside of the moonpool the free surface shows a slight hogging condition when t 1 4t the fluid in the moonpool begins to rise with the external fluid flooding into the moonpool at the same time the fluid in the front of the moonpool rises slowly compared with the fluid in the rear of the moonpool moreover there is a significant depression in the front free surface when t 1 2t the free surface has a slight oscillation forming a hogging condition when t 3 4t the fluid in the moonpool begins to decrease and the front part descends slowly forming an isolated peak with the free surface significantly higher than the rear part overall under the effect of the negative grid of flaps the free surface in the moonpool is relatively calm and no isolated waves form in the center of the moonpool 4 2 1 effect on piston motion to study the reduction effect of the negative grid of flaps on the piston motion in the moonpool the fluid motion at point e in the rectangular moonpool with without the negative grid of flaps are compared fig 22 gives the statistics of fluid piston motion amplitude and c p at point e as shown in fig 22 the fluid motion amplitude in the moonpool increases with the increase of the incident wave height for the cases with a period of 0 64 s the fluid motion amplitude in the moonpool grows slowly and less than the incident wave height in addition the c p is between 0 6 and 0 65 with the reduction effect obvious for the cases with periods of 1 28 s and 1 92 s the fluid motion amplitude in the moonpool is similar to the incident wave height and the growth rate is large for the cases with a period of 1 28 s the c p increases with the increase of the incident wave height from 0 to 0 35 indicating that the greater the wave height the more obvious the reduction effect for the cases with a period of 1 92 s the c p is always around zero in addition the reduction effect is not obvious indicating that the incident wave with a longer wavelength has a diffraction effect on the flaps the reduction effects of the positive and negative grid of flaps are compared h e is the difference between the fluid sloshing amplitudes at point e in the moonpools with the negative positive grid of flaps h e are positive in fig 23 as the incident wave height increases h e increases at this time the negative grid of flaps has a better effect on reducing the piston oscillation than the positive grid of flaps to compare the piston motion in the moonpools with the positive and negative grid flaps fig 24 gives the free surface inside outside the moonpools with the positive and negative grid flaps for case 13 as shown in fig 24 the free surface in the moonpool is axisymmetric with the grid of flaps installed in the opposite direction a significant collapse occurs at the rear of the moonpool under the action of the negative grid of flaps as can be seen from the previous section the piston motion in the front of the moonpool is more severe than that in the rear while the negative grid of flaps successfully suppresses the piston motion in the front of the moonpool this is the reason that the negative grid of flaps inhibits piston motion well 4 2 2 effect on sloshing motion to illustrate the sloshing motion of the fluid in the rectangular moonpool with the negative grid of flaps table 4 gives the statistics of difference points taken for fluid sloshing motion amplitude in x axis in the rectangular moonpool with negative grid of flaps the choice of points reflects the position of the violently fluid motion in the rectangular moonpool with the negative grid of flaps the x axis sloshing motion amplitude in the moonpool mostly takes the fluid motion difference at points a b while the points a e and e b are taken in fewer cases similarly the negative grid of flaps has an obvious effect on the original resonance condition for the cases with a period of 1 28 s with the increase of the incident wave height the x axis sloshing motion amplitude in the moonpool sequentially takes the fluid motion difference at points e b a e and a b for the cases with a period of 0 64 s a set of sloshing amplitudes takes from the fluid motion difference at points a e this is mainly because the free surface tends to be flat as a whole but the fluid climbs along the moonpool s walls the reduction effects of the negative grid of flaps for the sloshing motion are analyzed from the sloshing motion in x axis and y axis fig 25 gives the statistics of fluid sloshing motion amplitude and c s in x axis in the rectangular moonpool with the negative grid of flaps as shown in fig 25 a the x axis sloshing motion amplitude in the moonpool increases with the increase of the incident wave height and the sloshing motion amplitude is smaller than the incident wave height when the incident wave height is a constant the x axis sloshing motion amplitude in the moonpool decreases as the incident wave s period increases as shown in fig 25 b for the cases with a period of 0 64 s the c s is concentrated between 0 2 and 0 the negative grid of flaps intensifies the x axis sloshing motion in the moonpool instead of reducing it for the cases with a period of 1 28 s the c s increases with the increase of the incident wave height and the maximum is 0 7 indicating that the reduction effect is obvious for the cases with a period of 1 92 s the c s decreases with the increase of the incident wave height while the value of c s changes from positive to negative indicating that the negative grid of flaps plays a counteraction at this time for the cases with a period of 1 92 s the reduction effect of the positive or negative grid of flaps for x axis sloshing motion is poor for further studying the reduction effects of the negative grid of flaps for the fluid sloshing motion the sloshing motion in y axis in the moonpool with the negative grid of flaps is given in fig 26 as shown in fig 26 a the y axis sloshing motion amplitude in the moonpool increases with the increase of the incident wave height but the sloshing motion amplitude is smaller than the incident wave height under the same wave height the sloshing motion amplitude in the moonpool for the cases with a period of 0 64 s is the smallest as shown in fig 26 b the c s for the cases with a period of 0 64 s is between 0 4 and 0 8 indicating that the reduction effect is obvious for the other cases with periods of 1 28 s and 1 92 s the sloshing amplitudes are similar for the cases with a period of 1 28 s the c s increases with the increase of the incident wave height moreover the maximum of c s is 0 7 indicating that the reduction effect is obvious the c s for the cases with a period of 1 92 s is nominally zero indicating that the reduction effect is poor the difference between the positive and the negative grid of flaps is the installation direction of the flaps the schematic of fluid motion inside outside the moonpools with different grids of flaps is given in fig 27 as shown in fig 27 a when the incident wave passes through the moonpool with the positive grid of flaps the overall velocity of the fluid outside the moonpool is greater than that inside it causes the fluid pressure outside the moonpool to be less than that inside forming a pumping action and guiding the fluid in the moonpool to accelerate out of the moonpool as shown in fig 27 b when the fluid in the moonpool with the negative grid of flaps flows out it conflicts with the outside fluid under the action of confliction some fluid is forced to flow into the moonpool forming vortices on the flaps which increases the intensity of fluid motion the reduction effects of the positive and negative grid of flaps for the sloshing motion are compared form the sloshing motion in x axis and y axis h x is the difference between the fluid sloshing amplitudes in x axis in the moonpools with the negative positive grid of flaps h y is the difference between the fluid sloshing amplitudes in y axis in the moonpools with the negative positive grid of flaps fig 28 gives the statistics of h x and h y as shown in fig 28 a h x is greater than zero for the cases with periods of 1 28 s and 1 92 s moreover h x increases with the increase of the incident wave height indicating that the reduction effect of the negative grid of flaps is better than the positive grid of flaps for the cases with a period of 0 64 s h x is less than zero as the incident wave height increases h x increases first and then decreases it shows that the reduction effect of the negative grid of flaps is worse than the positive grid of flaps as shown in fig 28 b the fluid sloshing motion amplitude in moonpool with the negative grid of flaps is mostly smaller than the positive one at the same time for the cases with a period of 1 92 s the reduction effect of the positive grid of flaps is obviously better than the negative grid of flaps 4 3 grid of baffles in the process of drilling ship operations it is inevitable to encounter a complex and variable marine environment increasing the damping of the fluid motion in the moonpool is an effective and convenient wave minimization method with a wide range of applications fig 29 gives the pictures of the models of the grid of baffles as shown in fig 29 the walls of the moonpool are vertically equipped with 8 horizontal baffles and 22 vertical baffles circumferentially a horizontal baffle is divided into two l shape baffles diagonally a translucent acrylic and semi blue acrylic are assembled together the horizontal baffles effectively increase the fluid vertical motion damping in the moonpool inhibiting the fluid climbing along the moonpool wall the vertical baffles can effectively increase the fluid sloshing motion damping and dissipate the kinetic energy of the fluid inhibiting the fluid motion to better understand and study the fluid movement in the moonpool with the grid of baffles fig 30 gives the free surface evolution within one resonant period at the longitudinal section of the moonpool with grid of baffles for case 13 when t 1 4t the free surface in moonpool is generally in a sagging condition the free surface in the front of the moonpool is stable and the whole is slope like with the height lowered from front to back the fluid at the rear of the moonpool exhibits a significant turbulent motion under the action of the grid of baffles the fluid in the turbulent zone causes a large impact on the baffles accompanied by noise and the significant climbing phenomenon when t 1 2t the free surface in the front of the moonpool is stable in addition a small peak appears close to the center of the moonpool the fluid in the rear of the moonpool is turbulent but the thickness of the turbulent area is less than that of the case t 1 4t when t 3 4t the free surface in the front part of the moonpool is still stable and the fluid in the rear of the moonpool moves vigorously showing a significant turbulent state the fluid slams against the rear wall of the moonpool which has a reaction to the free surface in the moonpool causing the free surface to break and form an independent peak when t t the free surface slowly rises from the front to the center of the moonpool forming an obvious slope the fluid motion in the back of the moonpool is in a turbulent state which is higher than that in the front the grid of baffles transforms the walls of the moonpool from smooth to rough which greatly increases the fluid motion damping in the moonpool the kinetic energy of fluid in the moonpool is reduced by baffles rapidly and is partially converted into sound energy as inferred from the above phenomenon most of the fluid in the moonpool enters from the back of the moonpool which has a significant impact on the grid baffles on the back wall of the moonpool during the fluid piston motion a large amount of fluid retains on the baffles when the free surface drops the retained fluid will quickly drop on and affect the free surface directly overall the grid of baffles not only inhibits the fluid motion but also creates a new excitation source as the incident wave period and wave height change the reduction and excitation effects change accordingly 4 3 1 effect on piston motion the fluid motion at point e in the rectangular moonpool with without the grid of baffles are compared to measure the reduction effect of grid of baffles on the piston motion in the moonpool fig 31 gives the statistics of fluid piston motion amplitude and c p at point e as shown in fig 31 a the fluid motion amplitude increases with the increase of the incident wave height under the action of the incident wave with a period of 0 64 s the fluid motion amplitude in the moonpool is significantly smaller than the incident wave height under the action of the same incident wave height and different periods of 1 28 s and 1 92 s the amplitude of fluid motions in the moonpool are similar and slightly greater than the incident wave height indicating that the original resonance motion reduces well as shown in fig 31 b c p for the incident wave with a period of 0 64 s is concentrated between 0 18 and 0 37 the higher the incident wave height the smaller c p for the incident wave with a period of 1 28 s c p increases from zero to 0 35 with the increase of the incident wave height indicating that the greater the incident wave height the more obvious the reduction effect for the cases with a period of 1 92 s c p always maintains at zero indicating that there is no reduction effect consistent with fig 32 for case 13 the free surface in the rectangular moonpool is relatively calm and the free surface slope is small the residual fluid on the baffles falls on the free surface exciting the fluid motion in the moonpool for the piston motion in the moonpool the grid of baffles greatly increases the damping of the fluid vertical motion in the moonpool and effectively inhibits the fluid from climbing along the walls the boundary conditions near the wall change creating a new internal excitation source that destroys the self sustained oscillation of the fluid close to the walls of the moonpool for the cases with periods of 0 64 s and 1 28 s the reduction effect of the grid of baffles is stronger than the excitation effect for the cases with a period of 1 92 s the excitation effect of the grid plate is slightly stronger than the reduction effect 4 3 2 effect on sloshing motion to illustrate the sloshing motion of the fluid in the rectangular moonpool with the grid of baffles table 5 gives the statistics of difference points taken for fluid sloshing motion amplitude in x axis in the rectangular moonpool with the grid of baffles under the action of the incident wave with a period of 0 64 s most of the x axis sloshing motion amplitude in the moonpool takes the fluid motion difference at the points a b and rarely the points e b under the action of the incident wave with a period of 1 28 s most of the x axis sloshing motion amplitude takes the fluid motion difference at the points e b under the action of the incident wave with a period of 1 92 s most of the x axis sloshing motion amplitude takes the fluid motion difference at the points a b and rarely the points e b overall the x axis sloshing motion amplitude takes from the fluid motion differences at the points a b or e b and rarely from the points a e it corresponds to fig 28 that the free surface in the front of the moonpool is relatively stable in addition the height difference between the free surface of the back and front in the moonpool is obvious at the same time the fluid in the rear of the moonpool is turbulent under the action of the grid of baffles the motion state in the rear of the moonpool is significantly stronger than the front one the reduction effects of the grid of baffles for the sloshing motion are analyzed from the sloshing motion in x axis and y axis fig 33 gives the statistics of fluid sloshing motion amplitude and c s in x axis in the rectangular moonpool with the grid of baffles as shown in fig 33 a the x axis sloshing motion amplitude in the moonpool increases with the increase of the incident wave height when the incident wave height is same the x axis sloshing motion amplitude in the moonpool decreases as the incident wave s period increases as shown in fig 33 b for the case with a period of 0 64 s the c s increases from 0 2 to zero with the increase of the incident wave height indicating that the grid of baffles reduction effect is poor for the case with a period of 1 28 s the c s increases with the increase of the incident wave height moreover the maximum of c s is 0 65 which indicates that the reduction effect is good for the case with a period of 1 92 s the c s decreases first and then increases with the increase of the incident wave height at the same time the c s concentrates on the negative value and the minimum is close to 0 4 which indicates that the reduction effect is poor the grid of baffles mainly has the following effects on the sloshing motion 1 the grid of baffles becomes a new excitation source in the moonpool so that the fluid self sustaining oscillation in the moonpool changes into the self excited motion 2 the grid of baffles inhibits the fluid climbing motion in the moonpool 3 the fluid retained on the grid plate will drip vertically to form a waterfall which forces the free surface to break for further studying the reduction effects of the grid of baffles for the fluid sloshing motion fig 34 gives the statistics of fluid sloshing motion amplitude and c s in y axis in the rectangular moonpool with the grid of baffles as shown in fig 34 a the sloshing motion amplitude in y axis in the moonpool increases with the increase of the incident wave height and the sloshing motion amplitude is much less than the incident wave height under the action of the incident wave with different periods and a constant wave height the fluid sloshing motion amplitude in the moonpool is relatively similar showing self sustaining oscillation characteristics as shown in fig 34 b for the cases with a period of 0 64 s c s is negative and increases with the increase of the incident wave height indicating that the reduction effect is poor for the cases with a period of 1 28 s c s increases with the increase of the incident wave height and its maximum approaches 0 53 indicating that the reduction effect is good for the cases with a period of 1 92 s c s is not more than zero in addition its minimum is 0 27 indicating that the reduction effect is poor as seen from the analysis of cases for the rectangular moonpool that are under the action of the incident wave with a period of 0 64 s the y axis sloshing motion amplitude is small in the moonpool exhibiting a self sustaining oscillation characteristic under the action of the grid of baffles the self sustaining oscillation of the moonpool is destroyed at the same time the baffles suppress the fluid motion along the wall causing the free surface in the moonpool to be broken therefore under the action of the grid of baffles the reduction effect in y axis is poor indicating that baffles play a negative role however considering that the y axis motion amplitude is small c p and c s in the x axis are the main criteria for considering the grid of baffles reduction effect 4 4 vertical bulkhead the vertical bulkhead has the advance of reducing the range of fluid motion and preserving the working space in the rectangular moonpool with large aspect ratios based on the structural characteristics of the vertical bulkhead the model and experiments are arranged according to fig 35 the wave probes are at eight points along the longitudinal section of the moonpool instead of the cross section primarily for the following two reasons firstly when the rectangular moonpool is divided into two smaller ones the shape of the small moonpool approximated square referring to the research results of previous studies the y axis sloshing is negligible in this kind of moonpool secondly the divided moonpools are so small that the excessive wave probes would affect the fluid motion in the moonpool the piston motion measurement selects points b and e as data points the sloshing motion amplitude in the left moonpool takes the fluid motion difference at the points a c the sloshing motion amplitude in the right moonpool takes the fluid motion difference at the points d f fig 36 gives the pictures of the models of the moonpool with the vertical bulkhead as shown in fig 36 the vertical bulkhead is located at the center of the moonpool dividing the moonpool into two halves the l shaped brackets are used for the installation of the vertical bulkhead and increasing the connection strength between the vertical bulkhead and the moonpool the dimensions of the moonpool determine the natural oscillation frequency when the incident wave s frequency is a constant the natural oscillation frequency of the moonpool could be changed to effectively avoid resonance and reduce the fluid motion in the moonpool at the same time as a large scale rectangular moonpool divided into two the left and right moonpools can be used at the same time which can fully meet the production needs to illustrate the fluid movement in the moonpool with the vertical bulkhead fig 21 gives the free surface evolution within one resonant period at the longitudinal section of the moonpool with the vertical bulkhead for case 5 when t 1 4t the incident wave peak passes through the moonpool and the free surface in the left moonpool is significantly higher than in the right one in fig 37 the fluids in the left and right moonpools form a height difference the pressure difference forms a bending moment acting on the vertical bulkhead when t 1 2t the fluid in the moonpool climbs along the vertical bulkhead at the same time the fluid in the right moonpool slams against the vertical bulkhead forming an isolated peak the fluid in the left and right moonpools tends to be flat when t 3 4t the fluid in the left moonpool is in hogging condition indicating that the fluid in the moonpool is ascending at the same time the fluid in the right moonpool is in a sagging condition indicating that the fluid in the moonpool is falling the fluid in two moonpools climbs along the vertical bulkhead when t t the fluid in the two moonpools tends to be flat and the fluid climbs along the vertical bulkhead overall there is a significant displacement of the piston motion in the two moonpools which creates compression on the vertical bulkhead 4 4 1 effect on piston motion considering the structural characteristics of the vertical bulkhead the motion at the center points in the left and right moonpool are selected for the piston motion research to illustrate the piston motion of the fluid in the right moonpool fig 38 gives the statistics of fluid piston motion amplitude and c p at point e in the right moonpool as shown in fig 38 a the fluid motion amplitude in the right moonpool increases with the increase of the incident wave height and the amplitude in the moonpool is slightly greater than the incident wave height showing a forced motion state as shown in fig 38 b for the cases with a period of 0 64 s c p increases as the incident wave height increases which is always less than zero it shows that the vertical bulkhead increases the fluid heave motion in the moonpool instead of achieving the reduction effect the negative effect decreases as the incident wave height increases for the cases with a period of 1 92 s as the incident wave height increases c p decreases slightly which is always less than zero it also shows that the vertical bulkhead exacerbates the fluid piston motion in the moonpools as the incident wave height increases the fluid motion is more intense in the moonpools for the cases with a period of 1 28 s c p is positive indicating that the reduction effect of the vertical bulkhead is satisfactory c p increases with the increase of the incident wave height indicating that the greater the incident wave height the better the reduction effect to illustrate the piston motion of the fluid in the right moonpool fig 39 gives the statistics of fluid piston motion amplitude and c p at point b as shown in fig 39 a for the cases with a same period the greater the incident wave height the greater the fluid motion amplitude in the left moonpool for the same incident wave height the fluid motion amplitude in the moonpool under the action of the incident wave with a period of 1 28 s is the greatest the fluid motion amplitude in the moonpool under the action of the incident wave with a period of 0 64 s is the smallest combined with fig 37 b for the cases with a period of 0 64 s c p decreases with the increase of the incident wave height from 0 33 to 0 08 and the reduction effect becomes worse for the cases with a period of 1 92 s c p fluctuates around 0 05 and the reduction effect is not obvious for the cases with a period of 1 28 s c p increases with increasing incident wave height increasing from 0 08 to 0 16 when the incident wave height is small c p is close to zero indicating that the vertical bulkhead has a poor reduction effect however as the incident wave height increases the reduction effect gradually appears indicating that the vertical bulkhead is beneficial to weaken the moonpool s excitation for the cases with large incident wave height compared the piston motion in right and left moonpool the vertical bulkhead has a certain reduction effect for the cases with a period of 1 28 s in the right moonpool however for the cases with periods of 0 64 s and 1 92 s it increases the intensity of the fluid motion in the moonpool in the left moonpool the vertical bulkhead has the poorest reduction effect for the cases with a period of 1 92 s and maximum reduction effect for the cases with a period of 0 64 s overall the reduction effect for the front fluid motion is better than the rear fluid motion to a certain extent it also indicates that most of the fluid enters the moonpool through the back of the moonpool the fluid motion in the back of the moonpool is stronger than that in the front if the vertical bulkhead moves toward the back wall of the moonpool the movement of the displaced piston motion will be more pronounced 4 4 2 effect on sloshing motion the sloshing motion in the left and right moonpools was studied separately to research the sloshing motion in the moonpool with the vertical bulkhead to illustrate the sloshing motion of the fluid in the left moonpool fig 40 gives the statistics of fluid sloshing motion amplitude and c s in x axis in the left moonpool as shown in fig 40 a the x axis sloshing motion amplitude in the left moonpool increases with the increase of the incident wave height and the x axis sloshing motion amplitude is smaller than the incident wave height the sloshing amplitudes in the moonpool for the cases with a period of 1 28 s is largest while the sloshing amplitudes for the test cases with a period of 1 92 s is greater than the amplitudes for the test cases with a period of 0 64 s as shown in fig 40 b c s for the test cases with a period of 0 64 s is a constant at about 0 8 and the reduction effect is obvious for the test cases with a period of 1 28 s c s is between 0 2 and 0 5 indicating that the reduction effect is good for the cases with a period of 1 92 s c s is less than zero and the minimum is 1 the reduction effect is very poor and the vertical bulkhead enhances the x axis sloshing motion in the left moonpool to illustrate the sloshing motion of the fluid in the right moonpool fig 41 gives the statistics of the fluid sloshing motion amplitude and c s in x axis in the right moonpool as shown in fig 41 a the x axis sloshing motion amplitude in the right moonpool increases with the increase of the incident wave height the sloshing motion amplitude for the cases with a period of 1 28 s is greater than other test cases while the sloshing motion amplitude for the cases with a period of 0 64 s is similar to the amplitudes for the cases with a period of 1 92 s the x axis sloshing motion amplitude in the right moonpool is less than the incident wave height as shown in fig 41 b for the cases with a period of 0 64 s c s is about 0 75 and the reduction effect is obvious for the cases with a period of 1 28 s c s firstly reduced to a negative value and then increased it indicates that the reduction effect on the incident wave with a small height is poor and the reduction effect on an incident wave with a large height is good for the cases with a period of 1 92 s c s increases with the increase of the incident wave height and the max is 0 36 indicating that the reduction effect is obvious by analyzing the sloshing motion in the left and right moonpools the vertical bulkhead has a significant reduction effect for the cases with a period of 0 64 s in addition for the left moonpool the vertical bulkhead has an effective reduction effect on the test cases with a period of 1 28 s however for the cases with a period of 1 92 s the excitation effect is greater than the reduction effect for the right moonpool the reduction effect is good for the cases with periods of 1 28 s and 1 92 s in general the reduction effect would improve by adjusting the positions of the vertical bulkhead during the experiment the dislocation movement in the left and right moonpool is found to analyze the dislocation motion quantitatively fig 42 gives the fluid motion differences between the points b e in the left and right moonpools as shown in fig 42 the motion difference increases as the incident wave height increases when incident wave height is a constant the greater the incident wave period the smaller the fluid motion difference at the points b e for the cases with a period of 0 64 s the fluid motion difference at the points b e is greater than the incident wave height for the cases with periods of 1 28 s and 1 92 s the points b e motion difference is less than the incident wave height fig 43 gives the time histories of the wave elevation at points b e for case 5 as shown in fig 43 the phase of fluid motion in the left and right moonpools always differs by 1 4 period for case 5 there is always a motion height difference between the left and right moonpools which presents a misalignment phenomenon causing extrusion to the vertical bulkhead because the height difference is always present the extrusion repeatedly acts to the vertical bulkhead which tends to cause fatigue and damage to the structure the weakest part of the structure is the connection between the vertical bulkhead and the moonpool consequently in this study l shaped brackets were equipped to strengthen the connection 5 conclusion in this study the fluid motion characteristics in the rectangular moonpool under action of regular waves have been investigated by experimental methods furthermore the reduction effects of four kinds of damping devices have been explored which were the positive grid of flaps the negative grid of flaps the grid of baffles and the vertical bulkhead the main conclusions of this work can be summarized as follows 1 the theoretical calculations of the fluid piston motion natural period agrees well with the experimental results the ratio between the response amplitude and the incident wave height can approach 1 74 the incident wave with a small period is more likely to stimulate the fluid sloshing movement 2 the grid of flaps guides the piston motion to the sloshing motion and produces the self sustaining motion of the shear layer on the flaps forming a new excitation source overall the positive grid of flaps is better than the negative grid of flaps 3 through the study of the grid of baffles most of the fluid enters the moonpool from the back of the moonpool at the same time the grid of baffles has both reduction and excitation effects 4 the vertical bulkhead causes the dislocation motion in the moonpool forming repeated extrusion on the vertical bulkhead the location of the vertical bulkhead can be changed according to the operational demand and the purpose of reducing the dislocation motion acknowledgements the present investigation is supported and funded by the national natural science foundation of china grant no 51779056 national key r d program foundation of china grant no 2018yfc0310400 national natural science foundation of china grant no 51779109 jiangsu natural science fund of china grant no bk20171306 all of the help is greatly appreciated and acknowledged by the authors 
22212,with the increase of the equipment size and the operating environment requirement more and more rectangular moonpools with large aspect ratios are used to instead of the circular or square moonpools with small aspect ratios however the research on the rectangular moonpool with a large aspect ratio is few firstly the fluid motion characteristic in the rectangular moonpool with a large aspect ratio is investigated experimentally in this paper by tracking and quantizing the free surface motion the moonpool has obvious shielding effects then the natural frequency of the piston motion in the moonpool is derived by theoretical methods which agrees well with the experimental results when the incident wave s period approximates the moonpool s natural oscillation period the resonant motion occurs with some adverse effects finally the reduction effects of four damping devices the positive grid of flaps negative grid of flaps grid of baffles and vertical bulkhead are investigated to reduce the adverse effects the damping devices have good reduction effects coupling with some incentive effects the grid of flaps effectively destroy the shear layer self sustaining oscillations and generate vortices the grid of baffles increases the fluid motion damping and forms the waterfall the vertical bulkhead causes interlaced motion keywords rectangular moonpool large aspect ratio hydrodynamic characteristics damping devices reduction effect 1 introduction the moonpool is widely used in the naval architecture and ocean engineering field because of its simple structure such as drilling vessels scientific research vessels and offshore platforms in harsh marine environments it provides a relatively quiet working environment for risers drills sonars and other devices the fluid inside and outside the moonpool is directly connected making the fluid movement in the moonpool complicated the fluid oscillation in the moonpool is a typical form of the internal free surface flow problem chen et al 2014 faltinsen 1993 faltinsen et al 2007 faltinsen and timokha 2015 heo et al 2014 ikeda et al 2012 mavrakos and chatjigeorgiou 2009 yu et al 2017 zhang and bandyk 2014 according to numerous studies the motion of water in the moonpool can be described as two modes piston motion and sloshing motion the vertical motion of fluid in the moonpool is piston motion and the horizontal motion of fluid in the moonpool which is similar to the motion in a rocking channel is referred to as sloshing motion fukuda 1977 kristiansen and faltinsen 2012 mciver 2005 molin 2001 zhou and zhang 2013 when the frequency of the incident wave is similar with the natural frequency of the fluid motion in the moonpool the resonant motion occur in the moonpool the internal water oscillations can reach several times of the incident wave height kristiansen 2009 kristiansen and faltinsen 2008 at a higher resonance frequency standing waves appear in the moonpool as the width of the moonpool becomes smaller the amplitude of the resonance increases dramatically chatellier et al 2004 fredriksen et al 2014 kristiansen and faltinsen 2010 liu et al 2017 to understand the resonance period the fluid motion in the moonpool was simplified as a mass spring system to establish the equations of fluid motion in the moonpool aalbers 1984 coupling with the resonant motion many adverse effects occur such as green water and the ship resistance increases endangering production and affecting the hydrodynamic performance of the structure sajjan and surendran 2013 tikhonov et al 1991 zhou and zhang 2013 to reduce the adverse effects different devices and technology were studied on the one hand the wave synchronizing crane was used to improve the working environment for riser launching and retrieving johansen et al 2003 messineo and serrani 2009 sagatun et al 2002 spanos et al 2011 on the other hand many damping devices were equipped in the moonpools to reduce the resistance during ships sailing and improve the hydrodynamic performance of offshore structures for example the wedges and cut out parts were arranged at the bottom of moonpool multiple sets of flaps or doors were arranged along the length of moonpool and the horizontal damping blocks were installed on the front and rear walls of moonpool to reduce the ship resistance park et al 2007 sivabalan and surendran 2017 a single layer of baffle or appendage was installed on the front or rear walls of the moonpool or a recess structure was added inside moonpool to increase damping and reduce the piston mode water motion guo et al 2017 lu et al 2015 michima and kawabe 2018 molin 2017 the bilge keel was extended to the structured skirt which reduced the unfavorable motion of the floating production drilling storage and offloading fpdso the opening size of the bottom of the moonpool was also changed in an attempt to reduce the heave motions of the monocolumn hull or the truss spar platform liu et al 2014 2015 sphaier et al 2007 the early application scenarios of the moonpool include scientific research vessels spar platforms and so on these studies primarily focused on square moonpools round moonpools or rectangular moonpools with small aspect ratio the aspect ratio is the ratio of the length to width of moonpool with the rapid development of marine engineering technology marine equipment is becoming larger to provide greater operating space and better production environments the large aspect ratio moonpools would be more widely used however there are relatively few studies of the rectangular moonpool with a large aspect ratio there is a critical need to study the fluid motion characteristic and damping devices for the rectangular moonpools with a large aspect ratio in this paper under the action of regular wave the fluid motion characteristic in the rectangular moonpool with a large aspect ratio is studied experimentally by quantizing and analyzing the free surface motion in the moonpool at the same time the natural frequency of the fluid piston motion in the moonpool is derived by theoretical methods which is verified with the experimental results on this basis the reduction effects of damping devices for the rectangular moonpool with a large aspect ratio are researched which are the positive grid of flaps the negative grid of flaps the grid of baffles and the vertical bulkhead 2 experiment set up the experiment is carried out in a wave channel with the size of 36 m long 1 2 m wide and 1 m deep the schematic of the wave channel can be seen in fig 1 a as shown in fig 1 a the wave maker is in the left side of the channel the damping zone is set at the right and there are eight wave height probes in the wave channel at the bottom of the channel a long bubble generator was equipped below the moonpool to assist in capturing the flow field changes the ship model is 2 99 m long and a rectangular moonpool model is installed in the ship model the rectangular moonpool model is 0 7 m long 0 24 m wide and 0 6 m high the draught of the rectangular moonpool model is 0 16 m fig 1 b gives the 3d schematic of the ship model used in this experiment as shown in fig 1 b the ship model include front and rear baffles actually the longer the length of the front and rear baffles the better the steady flow parallel to the parallel medium body but it will greatly increase the difficulty and cost of the model s manufacture studies have shown that when the ratio of the length of the baffle to the moonpool is 1 67 1 kang 2006 the impact is less so the length of the front baffle is set to 1 25 m the length of the rear baffle is set to 1 04 m to facilitate the monitoring of experimental phenomena the models are made of transparent acrylic material as shown in fig 1 c the middle section of the ship model includes the mounting holes for bow and stern and the mounting place for different moonpools the bow and stern models are arc so the waves can transmit efficiently in the channel the ship and moonpool model are fixed to reduce unnecessary oscillation during the experiment the ship model is fixed in the channel heading regular waves there are 20 different regular waves in this experiment as shown in table 1 when the period is a constant if the wave height continues to its maximum the wave will break therefore the corresponding maximum wave height value is set according to different periods in addition there are rectangular moonpool rectangular moonpool with positive grid of flaps rectangular moonpool with negative grid of flaps rectangular moonpool with grid of baffles and rectangular moonpool with vertical bulkhead five different moonpools in this study however the five different moonpools are subjected to the same test cases in the process of the experiment design the level of uncertainty on the experimental results is considered the ship model size and shape are designed reasonably according to the channel s principal dimensions the ship and moonpool model are fixed to reduce unnecessary oscillation the experimental results show that the influence of oscillation is within the acceptable range the eight wave height probes are produced in the same batch and have the same measurement standards the consistency experiment of the eight wave height probes has been completed before the formal experiment some experimental phenomena such as the sloshing motion the piston motion and so on are similar with the findings of other researchers faltinsen and timokha 2015 molin 2017 in the paper the experimental results and the experimental phenomena are mutually verified 3 hydrodynamic characteristics of fluid in the rectangular moonpool to illustrate the fluid motion characteristics in the rectangular moonpool with a large aspect ratio the free surface evolution within one resonant period in the moonpool for case 14 is given in fig 2 when t 1 4t the incident wave peak passes the moonpool and the fluid in the moonpool rises as a whole at this time the free surface shows a significant drooping state and obviously climbs along the moonpool s walls when t 1 2t the fluid in the moonpool falls as a whole the free surface clearly shows a hogging condition forming a steep peak in the middle of the moonpool when t 3 4t the fluid in the moonpool begins to rise and the double peaks appear in the free surface the peak height at this time is less than the one formed at 1 2t when t t the fluid in the moonpool rises a single peak appears in the free surface but the peak position is not located in the center of the moonpool during the entire period there is a visible piston and sloshing motion in the moonpool the fluid motion characteristics in the rectangular moonpool with a large aspect ratio will be studied below from the piston and sloshing motion two aspects particularly for case 2 the free surface in the moonpool tends to be flat while the wave outside the moonpool has a relative large height as shown in fig 3 a as shown in fig 3 b for the period of t 0 32 s there is no wave activity deeper than 0 08 m half of the wavelength considering that the draught of the moonpool is 0 16 m there is almost no wave excitation inside the moonpool the essence of the excitation of incident waves on the fluid in the moonpool is the process of the energy of incident wave transmitting into the moonpool the wave power can be calculated as falnes 2002 1 ρ 0 976 t h 2 where p is the wave power t is the wave period and h is the wave height according to eq 1 when the wave period is small the wave power is litter making it impossible to penetrate the shield of the moonpool effectively and stimulate the fluid motion in the moonpool so the experimental results of the two cases with a period of 0 32 s would not be discussed below 3 1 piston motion to illustrate the piston motion of the fluid in the rectangular moonpool the statistics of the motion amplitude at point e is given in fig 4 h e0 represent the fluid motion amplitude at point e in the rectangular moonpool with a large aspect ratio as shown in fig 4 the fluid in the moonpool is excited by the incident waves and the free surface fluctuation value at the point e increases as the incident wave height increases when the incident wave height is less than 0 07 m the fluid motion amplitude in the moonpool is similar for the cases with same wave height and different periods which shows the obvious shielding effect of the moonpool when the incident wave height is greater than 0 07 m the fluid motion amplitude in the moonpool is different for the cases with same wave heights and different periods the higher the incident wave height the greater the incident wave energy and the stronger the excitation to the fluid in the moonpool the main phenomenon is that when the incident wave height is large the fluid motion in the moonpool shows the forced oscillation characteristics the fluid piston motion in the moonpool is the most intense under the action of the incident wave with the period of 1 28 s therefore it is estimated that 1 28 s approximates the inherent piston oscillation period of the moonpool which causes the resonant motion the responsive amplitude is 1 74 times the incident wave height to study the piston resonance motion of the fluid in the rectangular moonpool with a large aspect ratio a periodic formula of the natural period for fluid piston motion in the rectangular moonpool with a large aspect ratio is derived the research objective in this paper is the moonpool with a length width draught ratio of 4 42 1 51 1 that is characteristic length is much greater than the width and draught the natural period formula for the piston motion of the fluid in the moonpool obtained by faltinsen 1993 only involves draughts and does not involve the length and width of the moonpool fukuda 1977 proposed the formula for the circular moonpool and the rectangular moonpool the maximum aspect ratio of the rectangular moonpool is 2 7 while the one in ours paper is 2 9 therefore it is necessary to derive a new formula suitable for a rectangular moonpool with a large aspect ratio the fluid piston motion in the moonpool is simplified to be a mass spring vibration system as shown in fig 5 a the fluid piston motion in the moonpool with length l width b and draught d is assumed to be a vertical movement of rectangular objects with an equal volume and density of ρ floating on the free surface the coordinate of the moonpool s section is shown in fig 5 b the equation of motion is established by the d alembert principle kang 2006 2 m δ m z ρ g s z 0 where m is the mass of the fluid in the moonpool δ m is the additional mass and s is the cross sectional area equal to l b the formula meyerhoff 1970 sarpkaya 2010 solves δ m 0 the additional mass of a plate of unit width immersed in water as it oscillates vertically 3 δ m 0 ρ π l 2 4 consider that the fluid in the moonpool has a fluid piston oscillation in the vertical direction at the liquid level so at this time 4 δ m 0 ρ π l 2 8 therefore it is possible to obtain an additional mass for a rectangular floating cross section making a heave motion on the free surface 5 δ m b δ m 0 d y b ρ π l 2 8 d y ρ π l 2 b 8 finally the natural frequency of the fluid piston oscillation in the rectangular moonpool is 6 f 0 1 2 π ρ g s m δ m 1 2 π g d π l 8 according to eq 6 the theoretical value of the natural frequency of the piston motion in the moonpool is 0 76 hz which is similar to the frequency of the incident wave s period of 0 78 hz in the experiment the fluid in the moonpool forms a resonance motion the responsive amplitude is significantly greater than the incident wave height at the same time the fluid motion amplitudes at points a and b are counted to analyze the fluid motion near the wall of the moonpool h a0 and h b0 represent the fluid motion amplitude at points a and b in the rectangular moonpool with a large aspect ratio respectively the amplitude of the fluid piston motion at point a in the moonpool increases with the increase of the incident wave height in fig 6 a for the cases with periods of 1 28 s or 1 92 s the piston motion amplitude in the moonpool is greater than the corresponding incident wave height however for the cases with a period of 0 64 s the amplitude of the fluid motion in the moonpool is less than the corresponding incident wave height when excited by the incident wave the amplitude of the piston motion at point b increases with the increase of the incident wave height in fig 6 b under the action of different incident waves with same wave height the fluid motion values in the rear of the moonpool are similar compared fig 6 a with fig 6 b it can be seen that under the action of waves with a large period and high amplitude the fluid motion amplitudes at points a and b in the moonpool are greater than the incident wave height this is primarily because the two points a and b are close to the moonpool s walls and water climbs along the walls causing the fluid to move vigorously for the cases with a period of 0 64 s the amplitude of the piston motion at the rear of the moonpool is greater than at the front of the moonpool indicating that the fluid motion in the rear of the moonpool is more intense to further illustrate the shielding effect of the moonpool fig 7 gives the time histories of the wave elevation at some points for case 5 as shown in fig 7 on the one hand the phase of fluid motion at point e in the moonpool lags behind the phase of the incident wave at point f out the moonpool the moonpool hinders the flow field inside and outside forming a shielding effect and creating a relatively stable working space on the other hand the fluid motion amplitude at point e is smaller than the wave height at point f it is because that during the fluid exchange process inside and outside the vortex forms at the front and rear walls of the moonpool which dissipates energy the fluid motion in the moonpool is weakened the vortex motion is shown in fig 8 to further illustrate the forced oscillation characteristics of the fluid motion in the moonpool fig 9 gives the time histories of wave elevations at some points for case 19 as shown in fig 9 the phase fluid motion inside and outside moonpool are similar the incident wave with large period has the diffraction effect therefore the fluid motion in the moonpool is much more affected by such incident waves and exhibits the characteristics of forced oscillation 3 2 sloshing motion to illustrate the sloshing motion of the fluid in the rectangular moonpool the free surface shapes in moonpool at different times for case 13 are given in fig 10 as shown in fig 10 the length of the moonpool is greater than the wavelength of the generated wave in the moonpool the fluid motion difference at points a e is taken as the sloshing amplitude for case 13 however unlike the wavelengths formed in the rectangular moonpool for case 13 fig 11 gives the wavelengths formed in the moonpool for case 5 and case 19 as shown in fig 11 the length of the moonpool is less than one wavelength of waves formed in the moonpool the fluid motion difference at points a b is taken as the sloshing amplitude for case 5 and case 19 the fluid motion difference between the front and rear monitoring points is not certainly the sloshing motion amplitude in the moonpool therefore the fluid motion difference at points a e a b and b e compared statistically the maximum value is taken as the x axis sloshing amplitude as the model is in the wave facing state the y axis sloshing motion amplitude is the motion difference of the points c e or d e table 2 gives the statistics of difference points took for fluid sloshing motion amplitude in x axis in the rectangular moonpool as shown in table 2 for the cases with periods of 0 64 s and 1 92 s the sloshing motion amplitude in the x axis takes the fluid motion difference between the points a b which is close to the front and the rear walls of the moonpool for the cases with a period of 1 28 s the points change from e b to a e as the incident wave height increases under the action of incident waves with a small height the fluid motion in the rear of the moonpool is stronger than that in the front under the action of waves with large height the fluid motion in the front of the moonpool is stronger than the motion in the rear for further studying the sloshing motion of the fluid in the moonpool the sloshing motion in x axis and y axis are given in fig 12 h s0 represents the sloshing motion amplitude in the rectangular moonpool as shown in fig 12 a the fluid sloshing motion in x axis in the moonpool becomes intense as the incident wave height increases for the cases with a period of 0 64 s the x axis sloshing motion in the moonpool is obvious but its amplitude is smaller than the incident wave height for the cases with a period of 1 92 s the x axis sloshing motion amplitude is smaller than the incident wave height and the sloshing motion in the moonpool is obviously weaker than the piston motion according to the molin formula molin 2001 the period of fluid sloshing in the moonpool can be obtained as 1 21 s which is approximately the 1 28 s wave period therefore under the action of the incident wave with a period of 1 28 s and large wave height the x axis sloshing motion in the moonpool is the most intense the ratio of the amplitude of sloshing motion to the incident wave height is 1 48 as shown in fig 12 b the amplitude of the y axis sloshing motion is less than that of the x axis in the moonpool under the action of incident waves with large heights and different periods the amplitudes of y axis sloshing motion in the moonpool are similar indicating that the fluid sloshing motion in the moonpool shows self sustaining oscillation characteristics when the incident wave frequency is similar with the resonance frequency of fluid motion in the moonpool the y axis sloshing motion in the moonpool increases sharply the maximum value is 6 2 10 2 m but the y axis sloshing motion is still weaker than that of the x axis there are two main reasons for this on the one hand the ship is in the condition of a head sea so the flow field is symmetrical along the longitudinal section in the ship moreover there is no obvious pressure and acceleration difference on the left and right sides of the moonpool on the other hand during the vertical oscillation in the moonpool a shear layer forms along the walls of the moonpool therefore the fluid motion along the walls lags behind fluid motion in the center of the moonpool which is an important reason for the y axis sloshing motion to analysis the sloshing resonance motion fig 13 gives the time histories of sloshing motion in the rectangular moonpool and corresponding spectrum analysis maps for typical test case as shown in fig 13 a the main peak frequency in the spectrum analysis maps for case 5 is 1 56 hz while the incident wave s frequency is 1 56 hz as shown in fig 13 b the main peak frequency in the spectrum analysis maps for case 13 is 0 78 hz in addition the incident wave s frequency is 0 78 hz which is close to the natural frequency of fluid sloshing motion in the moonpool with a value of 0 82 hz forming resonance and sloshing intensely at this time the fluid sloshing motion in the moonpool exhibits the self excited oscillation characteristics as shown in fig 13 c the main peak frequency in the spectrum analysis maps for case 19 is 0 52 hz while the incident wave s frequency is 0 52 hz for cases 05 and 19 the fluid motion in the moonpool is significantly excited by incident waves 4 reduction effect of damping devices in the rectangular moonpool to facilitate the evaluation of the reduction effect for piston motion we performed a non dimensional treatment for the experimental data the reduction coefficient c p for piston motion is defined as follows 7 c p h p 0 h p h p 0 where h p0 is the statistical value of the fluid piston motion at point e in the rectangular moonpool without the damping device and h p is the statistical value of the piston motion at point e in the moonpool with damping devices similarly the sloshing reduction coefficient c s is defined as follows 8 c s h s 0 h s h s 0 where h s0 is the statistical value of the fluid sloshing motion in the rectangular moonpool without the damping device and h s is the statistical value of the sloshing motion in the rectangular moonpool with damping devices 4 1 positive grid of flaps the positive grid of flaps are installed at the bottom of the moonpool fig 14 gives the pictures of the model of grid of flaps as shown in fig 14 a the grid of flaps is a ramp shaped structure consisting of horizontal flaps inclined flaps and three longitudinal girders the width of the horizontal flap is 19 mm the inclined flap is 34 mm wide and 30 inclined as shown in fig 14 b the opening ratio of the moonpool s bottom is 0 32 because the inclined flaps have directionality the reduction effects in different installation directions are studied experimentally the positive direction of the grid of flaps is that the inclined flaps are close to the front wall of the moonpool and the horizontal plate is close to the rear wall of the moonpool to facilitate the monitoring of the experimental phenomenon the material of the grid of flaps is a blue acrylic plate which is in sharp contrast with the transparent acrylic of the moonpool to illustrate the fluid motion characteristics in the rectangular moonpool with the positive grid of flaps fig 15 gives the free surface evolution within one resonant period at the longitudinal section of the moonpool with the positive grid of flaps for case 14 when t 0 the incident wave trough is outside of moonpool the fluid in the moonpool fluctuates slightly with the fluid close to the rear wall obviously depressed when t 1 4t the fluid motion amplitude in the front of the moonpool is higher than that in the rear while the fluid near the rear wall fluctuates obviously at the same time the free surface is seriously disturbed close to the rear wall when t 1 2t the incident wave crest is outside of the moonpool the fluid climbs significantly along the rear wall of the moonpool therefore the fluid motion amplitude in the rear of the moonpool is higher than that in the front part at t 3 4t there is a slight fluid fluctuation in the moonpool and an isolated small peak appears in the rear of the moonpool 4 1 1 effect on piston motion to study the reduction effect of the positive grid of flaps on the piston motion in the moonpool the fluid motion at point e in the rectangular moonpool with without the positive grid of flaps are compared fig 16 gives the statistics of fluid piston motion amplitude and c p at point e in the moonpool with the positive grid of flaps as shown in fig 16 a the fluid motion amplitude in the moonpool increases as the incident wave height increases for the cases with a period of 0 64 s the fluid piston motion amplitude increases slowly in the moonpool as the incident wave height increases for the cases with periods of 1 28 s and 1 92 s the fluid motion amplitude in the moonpool is close to the incident wave height and its growth rate is large the resonance phenomenon disappears and the forced motion phenomenon appears as shown in fig 16 b for the cases with a period of 0 64 s c p is between 0 6 and 0 75 and the reduction effect is obvious the positive grid of flaps reduces the water permeable area at the moonpool s bottom reducing the fluid exchange speed inside and outside the moonpool and hindering the fluid piston motion in the moonpool as a result the shielding function of the moonpool is strengthened in other words a significant reduction effect is achieved for the cases with a period of 1 28 s c p increases from zero to 0 4 with the increase of the incident wave height indicating that the greater the incident wave height the more obvious the reduction effect when the rectangular moonpool is not equipped with the positive grid of flaps the fluid motion amplitude in the moonpool is greater than the incident wave height after the installation of the positive grid of flaps the fluid motion amplitude in the moonpool is similar to the incident wave height showing the forced motion characteristics for the cases with a period of 1 92 s c p maintains between zero and 0 1 and the reduction effect is not obvious for the cases with a period of 1 92 s the fluid motion in the moonpool is forced to oscillate at this time the positive grid of flaps weakens some energy of the incident wave but the reduction effect is not obvious the main reason is that the incident wave with a period of 1 92 s has a longer wavelength which easily causes diffraction when it encounters the flaps therefore the flaps reduction effect on the long wave is weaker than on the short one to illustrate the fluid motion under the action of the positive grid of flaps fig 17 gives the flow field and free surface in the rectangular moonpool with the positive grid of flaps for case 13 as shown in fig 17 a two vortices form disturbing the fluid motion in the moonpool at the same time the streamlines indicate that flaps obstruct the fluid exchange inside and outside the moonpool and destroy the fluid s self sustaining sloshing motion in the moonpool as shown in fig 17 b the front free surface is relatively flat and the back has some peaks with different height overall the free surface appears discontinuous fig 18 gives the time histories of fluid motion at point e f in the rectangular moonpool with the positive grid of flaps for case 13 as shown in fig 18 the fluid motion response in the moonpool lags behind the external excitation wave the fluid motion trajectory inside and outside the moonpool has a folding angle with the positive grid of flaps installed in other words a partition formed between the fluid in the moonpool and the incident wave so the fluid exchange not timely the horizontal and sloping flaps will guide the water flow to produce the horizontal and oblique shear layer self sustaining oscillations at the edges of the flaps the vertical motion exchanges with the horizontal motion the fluid falls off on the edge of the flaps with the vortex easily generating the vortex destroys the original piston motion so the positive grid of flaps reduces the energy of the external fluid entering the moonpool the positive grid of flaps present at the bottom of the moonpool causes the piston motion to be hindered the shear layer self sustaining oscillations decrease as the vertical motion speed decreases in other words the positive grid of flaps greatly weakens the exciting effect of the incident wave resulting in a significant reduction effect 4 1 2 effect on sloshing motion to illustrate the sloshing motion of the fluid in the rectangular moonpool with the positive grid of flaps the statistics of difference points taken for fluid sloshing motion amplitude in x axis are given in table 3 the choice of points reflects the position of the violently fluid motion in the moonpool the points a b fluid motion difference is mostly taken as the x axis sloshing motion amplitude in the moonpool equipped with the positive grid of flaps while the points a e difference is taken in fewer test cases the positive grid of flaps has an obvious influence on the original resonance condition with a period of 1 28 s when the flaps are not equipped the x axis sloshing motion amplitude takes the fluid motion difference at points e b or a e in other words the sloshing motion in the moonpool is asymmetrical when the flaps are equipped the x axis sloshing motion amplitude in the moonpool is only taken from the fluid motion difference at points a b which corresponds to fig 20 under the action of the positive grid of flaps the free surface in the moonpool tends to be flat forming a slope as a whole in some of the cases with small wave height the x axis sloshing motion amplitude takes on the fluid motion difference at the points a e mainly in the test cases with small wave height the free surface in the moonpool is flat however fluid climbs obviously at point a it exhibits nonlinear characteristics and forms solitary waves in the center of the moonpool the reduction effects for the sloshing motion are analyzed from the sloshing motion in x axis and y axis fig 19 gives the statistics of sloshing motion amplitude and c s in x axis in the rectangular moonpool with the positive grid o flaps as shown in fig 19 a the x axis sloshing motion amplitude in the moonpool increases as the incident wave height increases and the x axis sloshing motion amplitude is smaller than the incident wave height when the incident wave height is a constant the smaller the period of the incident wave the greater is the fluid sloshing motion amplitude in the moonpool under the action of the positive grid of flaps the original resonance phenomenon disappears in the rectangular moonpool as shown in fig 19 b for the cases with a period of 1 28 s c s increases with the increase of the incident wave height and the maximum is 0 6 therefore the reduction effect is obvious for the cases with a period of 0 64 s the c s is nominally zero and the reduction effect is not obvious for the cases with a period of 1 92 s the c s is concentrated between 0 3 and 0 6 and the reduction effect is very poor conversely under the action of the positive grid of flaps the sloshing motion in the moonpool is intensified primarily because the flaps hinder the fluid in the moonpool at the same time under the guidance of the flaps the vertical piston motion converts to the horizontal sloshing motion with a large number of vortices generating at the same time because of the action of the flaps the rates of fluid exchange in the vertical section of the moonpool are different resulting in a horizontal speed difference and forcing fluids to produce a horizontal sloshing motion fig 20 gives the statistics of fluid sloshing motion amplitude and c s in y axis as shown in fig 20 the y axis sloshing motion in the moonpool becomes intense with the increase of the incident wave height at the same time the sloshing motion amplitude is much less than the incident wave height for the cases with a period of 0 64 s c s is concentrated between 0 6 and 0 8 under the action of the positive grid of flaps and the reduction effect is obvious for the cases with a period of 1 28 s c s increases with the increase of the incident wave height and the maximum of c s is 0 6 the c s is concentrated between 0 2 and zero for the incident waves with a period of 1 92 s which decreases with the increase of the incident wave height in other words at this time the positive grid of flaps has no reduction effect 4 2 negative grid of flaps the difference between the positive and negative grid of flaps is the installation direction of the grid of flaps the reduction effects of the negative grid of flaps are researched and compared with that of the positive grid of flaps fig 21 gives the fluid motion in the moonpool with the negative grid of flaps when t 0 the incident wave trough outside of the moonpool the free surface shows a slight hogging condition when t 1 4t the fluid in the moonpool begins to rise with the external fluid flooding into the moonpool at the same time the fluid in the front of the moonpool rises slowly compared with the fluid in the rear of the moonpool moreover there is a significant depression in the front free surface when t 1 2t the free surface has a slight oscillation forming a hogging condition when t 3 4t the fluid in the moonpool begins to decrease and the front part descends slowly forming an isolated peak with the free surface significantly higher than the rear part overall under the effect of the negative grid of flaps the free surface in the moonpool is relatively calm and no isolated waves form in the center of the moonpool 4 2 1 effect on piston motion to study the reduction effect of the negative grid of flaps on the piston motion in the moonpool the fluid motion at point e in the rectangular moonpool with without the negative grid of flaps are compared fig 22 gives the statistics of fluid piston motion amplitude and c p at point e as shown in fig 22 the fluid motion amplitude in the moonpool increases with the increase of the incident wave height for the cases with a period of 0 64 s the fluid motion amplitude in the moonpool grows slowly and less than the incident wave height in addition the c p is between 0 6 and 0 65 with the reduction effect obvious for the cases with periods of 1 28 s and 1 92 s the fluid motion amplitude in the moonpool is similar to the incident wave height and the growth rate is large for the cases with a period of 1 28 s the c p increases with the increase of the incident wave height from 0 to 0 35 indicating that the greater the wave height the more obvious the reduction effect for the cases with a period of 1 92 s the c p is always around zero in addition the reduction effect is not obvious indicating that the incident wave with a longer wavelength has a diffraction effect on the flaps the reduction effects of the positive and negative grid of flaps are compared h e is the difference between the fluid sloshing amplitudes at point e in the moonpools with the negative positive grid of flaps h e are positive in fig 23 as the incident wave height increases h e increases at this time the negative grid of flaps has a better effect on reducing the piston oscillation than the positive grid of flaps to compare the piston motion in the moonpools with the positive and negative grid flaps fig 24 gives the free surface inside outside the moonpools with the positive and negative grid flaps for case 13 as shown in fig 24 the free surface in the moonpool is axisymmetric with the grid of flaps installed in the opposite direction a significant collapse occurs at the rear of the moonpool under the action of the negative grid of flaps as can be seen from the previous section the piston motion in the front of the moonpool is more severe than that in the rear while the negative grid of flaps successfully suppresses the piston motion in the front of the moonpool this is the reason that the negative grid of flaps inhibits piston motion well 4 2 2 effect on sloshing motion to illustrate the sloshing motion of the fluid in the rectangular moonpool with the negative grid of flaps table 4 gives the statistics of difference points taken for fluid sloshing motion amplitude in x axis in the rectangular moonpool with negative grid of flaps the choice of points reflects the position of the violently fluid motion in the rectangular moonpool with the negative grid of flaps the x axis sloshing motion amplitude in the moonpool mostly takes the fluid motion difference at points a b while the points a e and e b are taken in fewer cases similarly the negative grid of flaps has an obvious effect on the original resonance condition for the cases with a period of 1 28 s with the increase of the incident wave height the x axis sloshing motion amplitude in the moonpool sequentially takes the fluid motion difference at points e b a e and a b for the cases with a period of 0 64 s a set of sloshing amplitudes takes from the fluid motion difference at points a e this is mainly because the free surface tends to be flat as a whole but the fluid climbs along the moonpool s walls the reduction effects of the negative grid of flaps for the sloshing motion are analyzed from the sloshing motion in x axis and y axis fig 25 gives the statistics of fluid sloshing motion amplitude and c s in x axis in the rectangular moonpool with the negative grid of flaps as shown in fig 25 a the x axis sloshing motion amplitude in the moonpool increases with the increase of the incident wave height and the sloshing motion amplitude is smaller than the incident wave height when the incident wave height is a constant the x axis sloshing motion amplitude in the moonpool decreases as the incident wave s period increases as shown in fig 25 b for the cases with a period of 0 64 s the c s is concentrated between 0 2 and 0 the negative grid of flaps intensifies the x axis sloshing motion in the moonpool instead of reducing it for the cases with a period of 1 28 s the c s increases with the increase of the incident wave height and the maximum is 0 7 indicating that the reduction effect is obvious for the cases with a period of 1 92 s the c s decreases with the increase of the incident wave height while the value of c s changes from positive to negative indicating that the negative grid of flaps plays a counteraction at this time for the cases with a period of 1 92 s the reduction effect of the positive or negative grid of flaps for x axis sloshing motion is poor for further studying the reduction effects of the negative grid of flaps for the fluid sloshing motion the sloshing motion in y axis in the moonpool with the negative grid of flaps is given in fig 26 as shown in fig 26 a the y axis sloshing motion amplitude in the moonpool increases with the increase of the incident wave height but the sloshing motion amplitude is smaller than the incident wave height under the same wave height the sloshing motion amplitude in the moonpool for the cases with a period of 0 64 s is the smallest as shown in fig 26 b the c s for the cases with a period of 0 64 s is between 0 4 and 0 8 indicating that the reduction effect is obvious for the other cases with periods of 1 28 s and 1 92 s the sloshing amplitudes are similar for the cases with a period of 1 28 s the c s increases with the increase of the incident wave height moreover the maximum of c s is 0 7 indicating that the reduction effect is obvious the c s for the cases with a period of 1 92 s is nominally zero indicating that the reduction effect is poor the difference between the positive and the negative grid of flaps is the installation direction of the flaps the schematic of fluid motion inside outside the moonpools with different grids of flaps is given in fig 27 as shown in fig 27 a when the incident wave passes through the moonpool with the positive grid of flaps the overall velocity of the fluid outside the moonpool is greater than that inside it causes the fluid pressure outside the moonpool to be less than that inside forming a pumping action and guiding the fluid in the moonpool to accelerate out of the moonpool as shown in fig 27 b when the fluid in the moonpool with the negative grid of flaps flows out it conflicts with the outside fluid under the action of confliction some fluid is forced to flow into the moonpool forming vortices on the flaps which increases the intensity of fluid motion the reduction effects of the positive and negative grid of flaps for the sloshing motion are compared form the sloshing motion in x axis and y axis h x is the difference between the fluid sloshing amplitudes in x axis in the moonpools with the negative positive grid of flaps h y is the difference between the fluid sloshing amplitudes in y axis in the moonpools with the negative positive grid of flaps fig 28 gives the statistics of h x and h y as shown in fig 28 a h x is greater than zero for the cases with periods of 1 28 s and 1 92 s moreover h x increases with the increase of the incident wave height indicating that the reduction effect of the negative grid of flaps is better than the positive grid of flaps for the cases with a period of 0 64 s h x is less than zero as the incident wave height increases h x increases first and then decreases it shows that the reduction effect of the negative grid of flaps is worse than the positive grid of flaps as shown in fig 28 b the fluid sloshing motion amplitude in moonpool with the negative grid of flaps is mostly smaller than the positive one at the same time for the cases with a period of 1 92 s the reduction effect of the positive grid of flaps is obviously better than the negative grid of flaps 4 3 grid of baffles in the process of drilling ship operations it is inevitable to encounter a complex and variable marine environment increasing the damping of the fluid motion in the moonpool is an effective and convenient wave minimization method with a wide range of applications fig 29 gives the pictures of the models of the grid of baffles as shown in fig 29 the walls of the moonpool are vertically equipped with 8 horizontal baffles and 22 vertical baffles circumferentially a horizontal baffle is divided into two l shape baffles diagonally a translucent acrylic and semi blue acrylic are assembled together the horizontal baffles effectively increase the fluid vertical motion damping in the moonpool inhibiting the fluid climbing along the moonpool wall the vertical baffles can effectively increase the fluid sloshing motion damping and dissipate the kinetic energy of the fluid inhibiting the fluid motion to better understand and study the fluid movement in the moonpool with the grid of baffles fig 30 gives the free surface evolution within one resonant period at the longitudinal section of the moonpool with grid of baffles for case 13 when t 1 4t the free surface in moonpool is generally in a sagging condition the free surface in the front of the moonpool is stable and the whole is slope like with the height lowered from front to back the fluid at the rear of the moonpool exhibits a significant turbulent motion under the action of the grid of baffles the fluid in the turbulent zone causes a large impact on the baffles accompanied by noise and the significant climbing phenomenon when t 1 2t the free surface in the front of the moonpool is stable in addition a small peak appears close to the center of the moonpool the fluid in the rear of the moonpool is turbulent but the thickness of the turbulent area is less than that of the case t 1 4t when t 3 4t the free surface in the front part of the moonpool is still stable and the fluid in the rear of the moonpool moves vigorously showing a significant turbulent state the fluid slams against the rear wall of the moonpool which has a reaction to the free surface in the moonpool causing the free surface to break and form an independent peak when t t the free surface slowly rises from the front to the center of the moonpool forming an obvious slope the fluid motion in the back of the moonpool is in a turbulent state which is higher than that in the front the grid of baffles transforms the walls of the moonpool from smooth to rough which greatly increases the fluid motion damping in the moonpool the kinetic energy of fluid in the moonpool is reduced by baffles rapidly and is partially converted into sound energy as inferred from the above phenomenon most of the fluid in the moonpool enters from the back of the moonpool which has a significant impact on the grid baffles on the back wall of the moonpool during the fluid piston motion a large amount of fluid retains on the baffles when the free surface drops the retained fluid will quickly drop on and affect the free surface directly overall the grid of baffles not only inhibits the fluid motion but also creates a new excitation source as the incident wave period and wave height change the reduction and excitation effects change accordingly 4 3 1 effect on piston motion the fluid motion at point e in the rectangular moonpool with without the grid of baffles are compared to measure the reduction effect of grid of baffles on the piston motion in the moonpool fig 31 gives the statistics of fluid piston motion amplitude and c p at point e as shown in fig 31 a the fluid motion amplitude increases with the increase of the incident wave height under the action of the incident wave with a period of 0 64 s the fluid motion amplitude in the moonpool is significantly smaller than the incident wave height under the action of the same incident wave height and different periods of 1 28 s and 1 92 s the amplitude of fluid motions in the moonpool are similar and slightly greater than the incident wave height indicating that the original resonance motion reduces well as shown in fig 31 b c p for the incident wave with a period of 0 64 s is concentrated between 0 18 and 0 37 the higher the incident wave height the smaller c p for the incident wave with a period of 1 28 s c p increases from zero to 0 35 with the increase of the incident wave height indicating that the greater the incident wave height the more obvious the reduction effect for the cases with a period of 1 92 s c p always maintains at zero indicating that there is no reduction effect consistent with fig 32 for case 13 the free surface in the rectangular moonpool is relatively calm and the free surface slope is small the residual fluid on the baffles falls on the free surface exciting the fluid motion in the moonpool for the piston motion in the moonpool the grid of baffles greatly increases the damping of the fluid vertical motion in the moonpool and effectively inhibits the fluid from climbing along the walls the boundary conditions near the wall change creating a new internal excitation source that destroys the self sustained oscillation of the fluid close to the walls of the moonpool for the cases with periods of 0 64 s and 1 28 s the reduction effect of the grid of baffles is stronger than the excitation effect for the cases with a period of 1 92 s the excitation effect of the grid plate is slightly stronger than the reduction effect 4 3 2 effect on sloshing motion to illustrate the sloshing motion of the fluid in the rectangular moonpool with the grid of baffles table 5 gives the statistics of difference points taken for fluid sloshing motion amplitude in x axis in the rectangular moonpool with the grid of baffles under the action of the incident wave with a period of 0 64 s most of the x axis sloshing motion amplitude in the moonpool takes the fluid motion difference at the points a b and rarely the points e b under the action of the incident wave with a period of 1 28 s most of the x axis sloshing motion amplitude takes the fluid motion difference at the points e b under the action of the incident wave with a period of 1 92 s most of the x axis sloshing motion amplitude takes the fluid motion difference at the points a b and rarely the points e b overall the x axis sloshing motion amplitude takes from the fluid motion differences at the points a b or e b and rarely from the points a e it corresponds to fig 28 that the free surface in the front of the moonpool is relatively stable in addition the height difference between the free surface of the back and front in the moonpool is obvious at the same time the fluid in the rear of the moonpool is turbulent under the action of the grid of baffles the motion state in the rear of the moonpool is significantly stronger than the front one the reduction effects of the grid of baffles for the sloshing motion are analyzed from the sloshing motion in x axis and y axis fig 33 gives the statistics of fluid sloshing motion amplitude and c s in x axis in the rectangular moonpool with the grid of baffles as shown in fig 33 a the x axis sloshing motion amplitude in the moonpool increases with the increase of the incident wave height when the incident wave height is same the x axis sloshing motion amplitude in the moonpool decreases as the incident wave s period increases as shown in fig 33 b for the case with a period of 0 64 s the c s increases from 0 2 to zero with the increase of the incident wave height indicating that the grid of baffles reduction effect is poor for the case with a period of 1 28 s the c s increases with the increase of the incident wave height moreover the maximum of c s is 0 65 which indicates that the reduction effect is good for the case with a period of 1 92 s the c s decreases first and then increases with the increase of the incident wave height at the same time the c s concentrates on the negative value and the minimum is close to 0 4 which indicates that the reduction effect is poor the grid of baffles mainly has the following effects on the sloshing motion 1 the grid of baffles becomes a new excitation source in the moonpool so that the fluid self sustaining oscillation in the moonpool changes into the self excited motion 2 the grid of baffles inhibits the fluid climbing motion in the moonpool 3 the fluid retained on the grid plate will drip vertically to form a waterfall which forces the free surface to break for further studying the reduction effects of the grid of baffles for the fluid sloshing motion fig 34 gives the statistics of fluid sloshing motion amplitude and c s in y axis in the rectangular moonpool with the grid of baffles as shown in fig 34 a the sloshing motion amplitude in y axis in the moonpool increases with the increase of the incident wave height and the sloshing motion amplitude is much less than the incident wave height under the action of the incident wave with different periods and a constant wave height the fluid sloshing motion amplitude in the moonpool is relatively similar showing self sustaining oscillation characteristics as shown in fig 34 b for the cases with a period of 0 64 s c s is negative and increases with the increase of the incident wave height indicating that the reduction effect is poor for the cases with a period of 1 28 s c s increases with the increase of the incident wave height and its maximum approaches 0 53 indicating that the reduction effect is good for the cases with a period of 1 92 s c s is not more than zero in addition its minimum is 0 27 indicating that the reduction effect is poor as seen from the analysis of cases for the rectangular moonpool that are under the action of the incident wave with a period of 0 64 s the y axis sloshing motion amplitude is small in the moonpool exhibiting a self sustaining oscillation characteristic under the action of the grid of baffles the self sustaining oscillation of the moonpool is destroyed at the same time the baffles suppress the fluid motion along the wall causing the free surface in the moonpool to be broken therefore under the action of the grid of baffles the reduction effect in y axis is poor indicating that baffles play a negative role however considering that the y axis motion amplitude is small c p and c s in the x axis are the main criteria for considering the grid of baffles reduction effect 4 4 vertical bulkhead the vertical bulkhead has the advance of reducing the range of fluid motion and preserving the working space in the rectangular moonpool with large aspect ratios based on the structural characteristics of the vertical bulkhead the model and experiments are arranged according to fig 35 the wave probes are at eight points along the longitudinal section of the moonpool instead of the cross section primarily for the following two reasons firstly when the rectangular moonpool is divided into two smaller ones the shape of the small moonpool approximated square referring to the research results of previous studies the y axis sloshing is negligible in this kind of moonpool secondly the divided moonpools are so small that the excessive wave probes would affect the fluid motion in the moonpool the piston motion measurement selects points b and e as data points the sloshing motion amplitude in the left moonpool takes the fluid motion difference at the points a c the sloshing motion amplitude in the right moonpool takes the fluid motion difference at the points d f fig 36 gives the pictures of the models of the moonpool with the vertical bulkhead as shown in fig 36 the vertical bulkhead is located at the center of the moonpool dividing the moonpool into two halves the l shaped brackets are used for the installation of the vertical bulkhead and increasing the connection strength between the vertical bulkhead and the moonpool the dimensions of the moonpool determine the natural oscillation frequency when the incident wave s frequency is a constant the natural oscillation frequency of the moonpool could be changed to effectively avoid resonance and reduce the fluid motion in the moonpool at the same time as a large scale rectangular moonpool divided into two the left and right moonpools can be used at the same time which can fully meet the production needs to illustrate the fluid movement in the moonpool with the vertical bulkhead fig 21 gives the free surface evolution within one resonant period at the longitudinal section of the moonpool with the vertical bulkhead for case 5 when t 1 4t the incident wave peak passes through the moonpool and the free surface in the left moonpool is significantly higher than in the right one in fig 37 the fluids in the left and right moonpools form a height difference the pressure difference forms a bending moment acting on the vertical bulkhead when t 1 2t the fluid in the moonpool climbs along the vertical bulkhead at the same time the fluid in the right moonpool slams against the vertical bulkhead forming an isolated peak the fluid in the left and right moonpools tends to be flat when t 3 4t the fluid in the left moonpool is in hogging condition indicating that the fluid in the moonpool is ascending at the same time the fluid in the right moonpool is in a sagging condition indicating that the fluid in the moonpool is falling the fluid in two moonpools climbs along the vertical bulkhead when t t the fluid in the two moonpools tends to be flat and the fluid climbs along the vertical bulkhead overall there is a significant displacement of the piston motion in the two moonpools which creates compression on the vertical bulkhead 4 4 1 effect on piston motion considering the structural characteristics of the vertical bulkhead the motion at the center points in the left and right moonpool are selected for the piston motion research to illustrate the piston motion of the fluid in the right moonpool fig 38 gives the statistics of fluid piston motion amplitude and c p at point e in the right moonpool as shown in fig 38 a the fluid motion amplitude in the right moonpool increases with the increase of the incident wave height and the amplitude in the moonpool is slightly greater than the incident wave height showing a forced motion state as shown in fig 38 b for the cases with a period of 0 64 s c p increases as the incident wave height increases which is always less than zero it shows that the vertical bulkhead increases the fluid heave motion in the moonpool instead of achieving the reduction effect the negative effect decreases as the incident wave height increases for the cases with a period of 1 92 s as the incident wave height increases c p decreases slightly which is always less than zero it also shows that the vertical bulkhead exacerbates the fluid piston motion in the moonpools as the incident wave height increases the fluid motion is more intense in the moonpools for the cases with a period of 1 28 s c p is positive indicating that the reduction effect of the vertical bulkhead is satisfactory c p increases with the increase of the incident wave height indicating that the greater the incident wave height the better the reduction effect to illustrate the piston motion of the fluid in the right moonpool fig 39 gives the statistics of fluid piston motion amplitude and c p at point b as shown in fig 39 a for the cases with a same period the greater the incident wave height the greater the fluid motion amplitude in the left moonpool for the same incident wave height the fluid motion amplitude in the moonpool under the action of the incident wave with a period of 1 28 s is the greatest the fluid motion amplitude in the moonpool under the action of the incident wave with a period of 0 64 s is the smallest combined with fig 37 b for the cases with a period of 0 64 s c p decreases with the increase of the incident wave height from 0 33 to 0 08 and the reduction effect becomes worse for the cases with a period of 1 92 s c p fluctuates around 0 05 and the reduction effect is not obvious for the cases with a period of 1 28 s c p increases with increasing incident wave height increasing from 0 08 to 0 16 when the incident wave height is small c p is close to zero indicating that the vertical bulkhead has a poor reduction effect however as the incident wave height increases the reduction effect gradually appears indicating that the vertical bulkhead is beneficial to weaken the moonpool s excitation for the cases with large incident wave height compared the piston motion in right and left moonpool the vertical bulkhead has a certain reduction effect for the cases with a period of 1 28 s in the right moonpool however for the cases with periods of 0 64 s and 1 92 s it increases the intensity of the fluid motion in the moonpool in the left moonpool the vertical bulkhead has the poorest reduction effect for the cases with a period of 1 92 s and maximum reduction effect for the cases with a period of 0 64 s overall the reduction effect for the front fluid motion is better than the rear fluid motion to a certain extent it also indicates that most of the fluid enters the moonpool through the back of the moonpool the fluid motion in the back of the moonpool is stronger than that in the front if the vertical bulkhead moves toward the back wall of the moonpool the movement of the displaced piston motion will be more pronounced 4 4 2 effect on sloshing motion the sloshing motion in the left and right moonpools was studied separately to research the sloshing motion in the moonpool with the vertical bulkhead to illustrate the sloshing motion of the fluid in the left moonpool fig 40 gives the statistics of fluid sloshing motion amplitude and c s in x axis in the left moonpool as shown in fig 40 a the x axis sloshing motion amplitude in the left moonpool increases with the increase of the incident wave height and the x axis sloshing motion amplitude is smaller than the incident wave height the sloshing amplitudes in the moonpool for the cases with a period of 1 28 s is largest while the sloshing amplitudes for the test cases with a period of 1 92 s is greater than the amplitudes for the test cases with a period of 0 64 s as shown in fig 40 b c s for the test cases with a period of 0 64 s is a constant at about 0 8 and the reduction effect is obvious for the test cases with a period of 1 28 s c s is between 0 2 and 0 5 indicating that the reduction effect is good for the cases with a period of 1 92 s c s is less than zero and the minimum is 1 the reduction effect is very poor and the vertical bulkhead enhances the x axis sloshing motion in the left moonpool to illustrate the sloshing motion of the fluid in the right moonpool fig 41 gives the statistics of the fluid sloshing motion amplitude and c s in x axis in the right moonpool as shown in fig 41 a the x axis sloshing motion amplitude in the right moonpool increases with the increase of the incident wave height the sloshing motion amplitude for the cases with a period of 1 28 s is greater than other test cases while the sloshing motion amplitude for the cases with a period of 0 64 s is similar to the amplitudes for the cases with a period of 1 92 s the x axis sloshing motion amplitude in the right moonpool is less than the incident wave height as shown in fig 41 b for the cases with a period of 0 64 s c s is about 0 75 and the reduction effect is obvious for the cases with a period of 1 28 s c s firstly reduced to a negative value and then increased it indicates that the reduction effect on the incident wave with a small height is poor and the reduction effect on an incident wave with a large height is good for the cases with a period of 1 92 s c s increases with the increase of the incident wave height and the max is 0 36 indicating that the reduction effect is obvious by analyzing the sloshing motion in the left and right moonpools the vertical bulkhead has a significant reduction effect for the cases with a period of 0 64 s in addition for the left moonpool the vertical bulkhead has an effective reduction effect on the test cases with a period of 1 28 s however for the cases with a period of 1 92 s the excitation effect is greater than the reduction effect for the right moonpool the reduction effect is good for the cases with periods of 1 28 s and 1 92 s in general the reduction effect would improve by adjusting the positions of the vertical bulkhead during the experiment the dislocation movement in the left and right moonpool is found to analyze the dislocation motion quantitatively fig 42 gives the fluid motion differences between the points b e in the left and right moonpools as shown in fig 42 the motion difference increases as the incident wave height increases when incident wave height is a constant the greater the incident wave period the smaller the fluid motion difference at the points b e for the cases with a period of 0 64 s the fluid motion difference at the points b e is greater than the incident wave height for the cases with periods of 1 28 s and 1 92 s the points b e motion difference is less than the incident wave height fig 43 gives the time histories of the wave elevation at points b e for case 5 as shown in fig 43 the phase of fluid motion in the left and right moonpools always differs by 1 4 period for case 5 there is always a motion height difference between the left and right moonpools which presents a misalignment phenomenon causing extrusion to the vertical bulkhead because the height difference is always present the extrusion repeatedly acts to the vertical bulkhead which tends to cause fatigue and damage to the structure the weakest part of the structure is the connection between the vertical bulkhead and the moonpool consequently in this study l shaped brackets were equipped to strengthen the connection 5 conclusion in this study the fluid motion characteristics in the rectangular moonpool under action of regular waves have been investigated by experimental methods furthermore the reduction effects of four kinds of damping devices have been explored which were the positive grid of flaps the negative grid of flaps the grid of baffles and the vertical bulkhead the main conclusions of this work can be summarized as follows 1 the theoretical calculations of the fluid piston motion natural period agrees well with the experimental results the ratio between the response amplitude and the incident wave height can approach 1 74 the incident wave with a small period is more likely to stimulate the fluid sloshing movement 2 the grid of flaps guides the piston motion to the sloshing motion and produces the self sustaining motion of the shear layer on the flaps forming a new excitation source overall the positive grid of flaps is better than the negative grid of flaps 3 through the study of the grid of baffles most of the fluid enters the moonpool from the back of the moonpool at the same time the grid of baffles has both reduction and excitation effects 4 the vertical bulkhead causes the dislocation motion in the moonpool forming repeated extrusion on the vertical bulkhead the location of the vertical bulkhead can be changed according to the operational demand and the purpose of reducing the dislocation motion acknowledgements the present investigation is supported and funded by the national natural science foundation of china grant no 51779056 national key r d program foundation of china grant no 2018yfc0310400 national natural science foundation of china grant no 51779109 jiangsu natural science fund of china grant no bk20171306 all of the help is greatly appreciated and acknowledged by the authors 
22213,wave driven impact of small icebergs with offshore structures is a design consideration in arctic and sub arctic regions the near field hydrodynamic interaction of these wave driven ice masses has been investigated through experimental and cfd studies by sayeed et al 2017b 2018a 2018b these studies found that motions were significantly influenced by the standing wave generated due to the superposition of the incident and reflected waves in front of the fixed structure in regular waves the small bodies may or may not impact the structure depending on initial starting condition whereas in irregular waves the ice masses hit the structure in all cases spectrum analysis carried out over the entire distance travelled by the free floating ice mass in irregular waves revealed relatively small difference in surge and heave velocity due to the presence of the structure sayeed et al 2018b the reason is attributed to insufficient data at each separation distances to capture the motion responses for all the frequencies in the spectrum in this paper the surge and heave motion time series data in irregular waves are reanalyzed in a similar manner as was previously done for regular waves sayeed et al 2018a the present analysis reveals correlation of significant wavelength with the motion history at variable separation distances in front of the fixed structure a statistical approach is then adopted to both regular and irregular wave motion data sets to identify percentiles of velocity response vs position as the small floating bodies approach head on to the fixed structure these findings enable the identification of the motions of small bodies at specific locations in front of the structure and provide understanding of how wave induced surge and heave velocities change as small floating bodies approach a fixed structure in a realistic wave field keywords iceberg bergy bit hydrodynamic interaction fixed offshore structure wave body interaction 1 introduction offshore structures in ice infested regions like the grand banks of newfoundland face additional environmental challenges from glacial ice fragments large icebergs can be easily detectable and usually deflected by towing growlers and bergy bits estimated mass 10 000 tonne are often difficult to detect in rough seas or at night according to the report by husky oil operations 2000 growlers and bergy bit frequencies in the white rose site in grand banks constitute 31 of the total iceberg distribution these smaller bergs even when detected are unstable and difficult to deflect in high seas mak 1989 the potential hazard is intensified by the fact that these smaller ice pieces can exhibit significantly higher impact speed than their mean drift speed attwood 1987 with relatively short impact duration lever et al 1988b these higher impact velocities are associated with wave induced component of the smaller icebergs and bergy bits close vicinity hydrodynamic interaction between a bergy bit and an offshore structure influences the impact velocity various model testing programs revealed associated events like velocity reduction added mass change negative drift force fluid cushioning shadowing eccentric impact passing around without impact etc due to this near field hydrodynamic interaction salvalaggio and rojansky 1986 mctaggart 1989 lever et al 1990b mak et al 1990 and isaacson and mctaggart 1990a 1990c iso 19 906 iso 19906 2010 also recommends hydrodynamic interaction effects to be considered in terms of velocity reduction and change in added mass but does not provide specific guidelines sayeed et al 2017a identified existent research gaps in this area through a comprehensive literature survey hydrodynamic effects will tend to be more significant for smaller icebergs and wider structures moreover these effects will have a large influence on impact kinetic energy and potentially a smaller rate effect influence of ice strength thus the study of near proximity hydrodynamic interaction is essential to accurately estimate the impact loads since 1980s several experimental campaigns have been conducted to investigate the iceberg structure interaction in waves attwood 1987 and lever et al 1988a 1988b observed that the iceberg models behaved like fluid particle when the ratio of wave length to characteristic iceberg size is greater than 13 for this ratio below 10 diffracted wave and viscous forces were anticipated to have significant effects salvalaggio and rojansky 1986 observed no impact when the iceberg diameter was less than approximately half the structure diameter lever et al 1990a included randomly varying iceberg shape to improve their impact velocity probability statistics the total impact velocity was considered as the sum of the drift velocity in open water and the significant velocity in waves lever et al 1990b investigated the wave induced motions of bergy bits impacting a semi submersible in irregular waves similar tests were conducted by mak et al 1990 in regular and irregular waves with a floating oil production platform with larger physical dimensions than the wave transparent semi submersible tested by lever et al 1990b open water significant velocities were found to be 10 40 higher than significant impact velocities mak 1989 also identified that berg rotation contributes a small portion to the total impact kinetic energy and the relative motion between berg and floating structure has a tendency to mitigate the impact mctaggart 1989 and isaacson and mctaggart 1990a 1990c conducted experiments and numerical analysis to investigate the hydrodynamic interaction during iceberg drift in proximity with an offshore structure no impact occurred for the wave driven iceberg when the ratio of iceberg diameter and structure diameter is less than or equal to 0 2 whereas salvalaggio and rojansky 1986 in their experiments found the ratio to be 0 5 it was reported that the presence of the structure resulted in 10 or more velocity reduction for smaller icebergs kazi et al 1998 observed repulsive interaction force during the experiments between a fixed cylinder and free floating cylinders of various shapes and sizes model scale experiments of iceberg and bergy bit impact with terra nova fpso were conducted by colbourne et al 1998 the effect of reflected and radiated waves resulted in confused collision trends and the impact energies for small ice pieces were found to be reduced in higher sea states the reason was attributed to the reflected wave energy which tends to negate the increased berg energy colbourne 2000 the hydrodynamic interaction between a floating ice mass and a tanker passing at speed was investigated by gagnon 2004 an increase in maximum sway motion of the ice mass was observed due to the proximity effect with the tanker acting as a temporary wall tsarau et al 2014 observed positive and negative hydrodynamic forces depending on the separation distance when a cylinder structure was towed past a fixed submerged sphere ice mass at different speeds and separation distances in calm water kim 2014 towed ice blocks at two speeds and impacted onto a stiffened steel panels of a moored structure to investigate simultaneous inelastic deformations of ice and steel structure some tests were conducted in air to separate the hydrodynamic effects the wave induced motions of ice floes of various sizes and shapes were investigated in regular waves by mcgovern and bai 2014a ice floes exhibited different motions than those of icebergs due to flat low draft geometry the isolated floe showed fluid particle type motions at wavelength to characteristic length ratio of 3 3 5 mcgovern and bai 2014b also investigated the kinematics of ice floes approaching head on to a circular cylinder in regular and irregular waves an increase in heave response and a significant reduction in surge response was observed when the separation distance to cylinder diameter ratio was less than 10 the mean drift velocities also showed low and negative values when the ice floe is close the cylinder sayeed et al 2017b 2018a 2018b conducted multi phase experimental and numerical studies to investigate near field hydrodynamic interaction of a small moving body towards a fixed structure in both regular and irregular waves sayeed et al 2017b measured the wave forces on different sized spherical ice masses at different locations away from the structure the separation distance to wavelength ratio was found to dictate the corresponding wave forces in surge and heave directions most of the cases where the ice mass is positioned close to the structure the mean drift force became negative also when the ice mass was closer to the structure the non dimensional surge forces decreased and the non dimensional heave forces increased sayeed et al 2018a measured the wave induced motions of same spherical and one cylindrical ice masses approaching a fixed structure in regular waves similar to previous findings the motions were found to be significantly influenced by the standing wave in front of the structure depending on the separation distance to wavelength ratio the motions were amplified at nodes and antinodes of the standing wave at nodal locations the surge motions were increased and heave motions were decreased and at anti nodal locations the surge motions were decreased and heave motions were increased as the body approached head on near the structure the surge motion slowed down and at the same time the heave motion was increased also non linear heave motions of the spherical models were observed due to their deep draft and large excursions from equilibrium position when subjected to wave excitation sayeed et al 2018b investigated wave induced forces and motions of the same models with the presence of the fixed structure in irregular waves measurements of significant wave heights in front of the fixed structure showed that even in irregular waves there exists a standing wave generated by the superposition of the incident and reflected peak frequency wave the significant wave loads at different proximity to the fixed structure varied with the ratio of separation distance to peak frequency wavelength moreover as the body is located closer to the structure the non dimensional significant surge forces decrease and the non dimensional significant heave forces increase small differences in the significant surge and heave velocity spectra were observed due to the presence of the structure the reason is attributed to the lack of data at specific location to fully capture the motion responses for all the frequencies in the spectrum it was also observed that the small bodies in regular waves may or may not hit the structure depending on the initial starting condition sayeed et al 2018a whereas the ice masses hit the structure in all cases of irregular waves sayeed et al 2018b in the present study the non dimensional surge and heave motion data up to the first impact in irregular waves are reanalyzed by normalizing the separation distance d with significant wavelength λ p the objective is to identify possible correlation between significant wavelength of the irregular wave spectrum with the spatial motion history in front of the fixed structure a statistical approach is then taken to both regular and irregular wave data sets due to extreme non linearity evident in the heave data for regular waves and to properly assess the response in irregular waves thus the data is presented in terms of percentiles of velocity response vs position as the small floating bodies approach the fixed structure this allows an assessment of trends in mean velocity but also provides an indication of the expected variability in the response 2 experimental program experiments were carried out to measure the motions of the free floating ice masses approaching a fixed structure in regular and irregular waves the objective was to investigate close proximity hydrodynamic interaction between approaching ice mass and fixed structure the details of the test program can be found in sayeed et al 2018a 2018b a brief description of the experimental campaign is provided in this section 2 1 facility the experiments were conducted in the towing tank of the ocean engineering research center oerc at memorial university of newfoundland mun in st john s nl canada the towing tank is 58m long and 4 5m wide with maximum still water depth of 2 2m 2 2 models and instrumentation a hexagonal aluminium cylinder of diameter d s 0 5 m was used as the fixed offshore structure three spheres of diameters d i d s 0 3 0 4 a n d 0 6 and one cylinder of diameter d i d s 0 4 and 0 098m height were used as ice masses the scale ratio is nominally 1 50 thus the full scale structure diameter is 25m and full scale diameters of ice masses are 7 6m 10 15m and 15 25m respectively all these models provide relatively large floating masses in relation to the structure diameter thus the effects observed in these experiments for the tested size of the structure relative to wavelength can be considered to represent the lower bound of the velocity reduction effect it is expected that larger structures relative to wavelength would show stronger effects in reducing the velocities of approaching icebergs qualisys optical tracking system was used to measure the rigid body motions in 6 degrees of freedom three infrared cameras were mounted and calibrated to cover the desired field view three capacitance type wave probes were used to measure the wave profile of the incoming and reflected waves fig 1 shows the layout of the experimental set up of motion experiments in the towing tank with dimensions and coordinate system in addition videos were recorded and digital still photographs were taken during experiments 2 3 environment the water depth in the towing tank was 1 8m six regular waves with two different wave steepness and five irregular waves of different significant wave heights and periods are used a jonswap wave spectrum was used to generate the irregular sea with peak enhancement factor γ of 2 2 the duration of the generated wave trains was about 2 min to avoid reflections from the beach the wave particulars for regular and irregular waves are given in tables 1 a and 1b respectively the peak frequency wavelength λ p is calculated using the dispersion relationship of linear wave theory 2 4 methodology the fixed structure model was ballasted with water and placed in the tank the spheres were ballasted with paraffin wax of density 870 k g m 3 to provide neutral buoyancy at the correct draft the cylindrical model was made by stacking and bonding polypropylene circular blocks the submersion depth was approximately 0 2 diameter of the respective model the ice model motions were restrained in sway and roll by two guide wires and a light weight carbon rod on top of the sphere fig 2 moreover the spheres were ballasted by inserting a rod at the bottom of the spheres with small weights at the end to reduce excessive pitch motions to facilitate the analysis optical tracking system four light weight reflective passive marker balls were installed on the rod attached to the model the marker balls were arranged in such a manner that there is no shadowing of multiple markers when the model rotates and the markers can be seen distinctively by the cameras the model was held at the release distance from the structure and then was let go after few seconds the initial release distance was measured from the face of the fixed structure to the center of the sphere the release distances were 2m for the cylinder medium and large spheres and 1 6m for the small sphere since this sphere took a longer time to travel due to smaller wave drift velocity compared to the two other spheres each test duration was about 2 min and the waiting time between tests was about 15 min to let the tank settle once the tests with the structure in place were finished the structure was taken out of the tank and the models were tested in a similar fashion without the presence of the structure the release locations for the no structure cases were the same as the test cases with the structure a number of repeat tests were conducted to validate and quantify the repeatability of the results froude scaling law was applied since surface gravity waves are the main driving factor all previous experiments followed the same scaling law isaacson and mctaggart 1990a lever et al 1990a 1990b mak et al 1990 colbourne et al 1998 mcgovern and bai 2014a 2014b it is also expected that reynolds dissimilitude will not have an effect since three different sizes of identical shape are used for the spheres attwood 1987 lever et al 1988a mcgovern and bai 2014a moreover sayeed et al 2017b found from the numerical analysis that the viscous forces are negligible compared to pressure forces for the simulated cases 2 5 test matrix the test matrix for the free floating motion experiments in regular and irregular waves are given in tables 2 a and 2b respectively fig 3 shows the spherical models during two typical regular and irregular wave experiments 3 results and discussion time series of full 6 dof motions and the wave profiles from the wave probes are available for the ice models subjected to regular and irregular waves in regular waves the models may or may not hit the structure but for all test cases in irregular waves the models eventually go forward and hit the structure only surge and heave motions are analyzed for the purpose of the study surge and heave velocities are calculated by differentiating the corresponding surge and heave displacements figs 4 and 5 show the time series of surge and heave velocity for sphere d i d s 0 4 tested with structure in regular wave λ d s 3 5 and cylinder d i d s 0 4 tested with structure in irregular wave λ p d s 6 4 respectively both figures also include results from repeat tests it is to be noted that the wave phases were not matched while releasing the models during these experiments 3 1 reanalyzed irregular wave data sayeed et al 2018a discussed how standing waves in front of the fixed structure influence the motions of the approaching ice mass in regular waves the ratio of separation distance to wavelength was found to dictate the surge and heave motions of the ice model coming towards the structure sayeed et al 2018b measured the significant wave heights at different locations away from the fixed structure and found a similar but less distinct standing wave pattern for irregular waves when the separation distance was non dimensionalized by the peak frequency wavelength relatively small differences were reported in significant surge and heave velocities for the with structure and no structure conditions the reason was attributed to the insufficient data at specific locations to fully capture the motion responses for all the frequencies in the spectrum in the present analysis all the data tested in irregular waves up to the first impact are re analyzed the surge and heave rms velocities are normalized by the rms velocities of surge and heave for no structure cases in the same wave conditions these normalized velocities are plotted against an average range of separation distance d to significant wavelength λ p ratio the variable separation distance d was calculated from the measured drift motion data figs 6 13 show the non dimensional surge and heave velocities for spheres d i d s 0 6 0 4 0 3 and for cylinder d i d s 0 4 all tested in irregular waves with structure and plotted against d λ p the results also contain all the repeat runs r refers to repeat cases there is more scatter in non dimensional heave velocities for the spheres because of the non linear heave motions for most of the wave cases these figures clearly demonstrate similar findings as obtained during the experiments in regular waves the influence of the standing wave is also obvious to the surge and heave motions of small bodies in front of the fixed structure even in irregular waves the motions are amplified at nodal and anti nodal locations as expected in general the surge velocities are found to be reduced whereas the heave velocities are increased just prior to impact 3 2 percentile analysis of regular and irregular wave data in this section the normalized data for both regular and irregular waves are further analyzed by taking bins of 1 20 times distance wavelength from the fixed structure and sorting the heave and surge velocities into these bins the velocity data in each bin was fit using a log normal distribution for that separation distance and the 10th 50th and 90th percentile velocity values extracted for each mean separation distance this analysis is performed separately for spheres and the cylinder in order to illustrate the effects of shape as the cylinder data showed a much more linear heave response however all the data for spheres regardless of size were combined in the same plot figs 14 21 show the percentile analysis results for both regular and irregular waves presented separately for spheres and cylinder in these plots the raw non dimensional data is in the background with the calculated percentile data plotted as lines superimposed on the raw data these lines show the mean trend but also the bounds of the expected response for all cases the surge data for both spheres and the cylinder in regular waves show the most evident effects of the standing wave pattern in front of the structure although there is still a considerable range of response between the extreme values however it is clear that in the very near field the surge velocity decreases as the floating body approaches the structure and that even the 90th percentile value is below 1 at the nearest location measured the heave values for the cylinder in regular waves also show a pronounced effect of the standing wave and in this case the heave velocities are sharply increased in the near field the results for the heave velocity of the spheres in regular waves do not show the same level of influence of the standing wave pattern this is thought to be mainly due to the non linear heave response associated with the highly variable water plane area of the largely submerged spherical shape this leads to a more chaotic heave response in spherical shapes and consequently less definite trends in the heave velocity data similar non linear chaotic heave motions for spherical models were also observed by other researchers like attwood 1987 wishahy et al 1987 and hinchey et al 1991 irregular wave data for all shapes show the expected trends in both surge velocity and heave velocity in the very near field but the effects further from the structure are obscured by the multiple frequencies present in the incident and reflected waves the near field values are also subject to wider variation also thought to be due to the presence of multiple frequencies thus the results are not as clear cut but the data does show both the mean trend and the extremes 4 conclusions the design of offshore installations in harsh arctic environments must consider the potential impact loads from icebergs and bergy bits although large bergs can easily be tracked and deflected as necessary growlers and bergy bits may slip the ice management surveillance system these smaller ice pieces are significantly influenced by close proximity hydrodynamic interaction between the berg and the structure sayeed et al 2017b 2018a 2018b conducted multi phase experimental and numerical studies where wave induced forces and motions of small ice masses near a fixed structure were investigated in both regular and irregular waves spatial wave profile measurements sayeed et al 2017b 2018b in front of the fixed structure showed the standing wave pattern generated by the superposition of incident and reflected wave in both regular and irregular waves both wave force and motion measurements sayeed et al 2017b 2018a in regular waves showed that the separation distance to wavelength ratio plays a significant role in determining the corresponding wave forces and motions in that location wave forces and motions were found to be amplified at nodal and anti nodal locations and the non dimensional surge forces motions tend to go down and the non dimensional heave forces motions tend to increase as the separation distance to wavelength ratio becomes increasingly greater than 0 25 in the present paper irregular free floating motion data up to the first impact have been reanalyzed in a similar manner as was previously done for regular waves sayeed et al 2018a the new normalized results clearly show the influence of peak frequency wavelength to the spatial motion time history the normalized motions follow the similar trend depending on the ratio of separation distance to peak frequency wavelength the present analysis also included a simple statistical look at the expected range of surge and heave velocity values based on a non dimensional presentation of the data the objective of this analysis was to establish the range of velocities for a realistic irregular wave train in order to determine whether the near field wave effects need to be considered in estimating small iceberg impact velocities velocity was measured as a function of separation distance and compared with velocities when no structure is present the impact velocity would be the velocity at zero separation this impact velocity showed a variation associated with wavelength and a statistical distribution in a multi wavelength irregular wave train based on the present findings it is concluded that realistic wave effects cause significant increases in heave velocities for small bergs approaching a structure but that the reductions in surge velocity although significant on average present a sufficiently wide range of values that a calculated reduction in berg approach velocity would not be justified for narrow fixed structures the current structure size relative to wavelength is in the lower range of the velocity reduction effect due to its relative slenderness it is expected that relatively larger diameter structures would have a greater effect on the velocity of approaching bergs further testing using larger structures diameter to wavelength ratio are recommended in the future when a more suitable facility becomes available the present findings of increased heave motions may have serious implications for potential impacts with topsides and other overhanging structures this effect will be pronounced for smaller icebergs and bergy bits since large bergs with high sails will be less influenced by wave effects in close vicinity to the structure declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors highly appreciate the supports from national research council canada ocre research center to draft this article 
22213,wave driven impact of small icebergs with offshore structures is a design consideration in arctic and sub arctic regions the near field hydrodynamic interaction of these wave driven ice masses has been investigated through experimental and cfd studies by sayeed et al 2017b 2018a 2018b these studies found that motions were significantly influenced by the standing wave generated due to the superposition of the incident and reflected waves in front of the fixed structure in regular waves the small bodies may or may not impact the structure depending on initial starting condition whereas in irregular waves the ice masses hit the structure in all cases spectrum analysis carried out over the entire distance travelled by the free floating ice mass in irregular waves revealed relatively small difference in surge and heave velocity due to the presence of the structure sayeed et al 2018b the reason is attributed to insufficient data at each separation distances to capture the motion responses for all the frequencies in the spectrum in this paper the surge and heave motion time series data in irregular waves are reanalyzed in a similar manner as was previously done for regular waves sayeed et al 2018a the present analysis reveals correlation of significant wavelength with the motion history at variable separation distances in front of the fixed structure a statistical approach is then adopted to both regular and irregular wave motion data sets to identify percentiles of velocity response vs position as the small floating bodies approach head on to the fixed structure these findings enable the identification of the motions of small bodies at specific locations in front of the structure and provide understanding of how wave induced surge and heave velocities change as small floating bodies approach a fixed structure in a realistic wave field keywords iceberg bergy bit hydrodynamic interaction fixed offshore structure wave body interaction 1 introduction offshore structures in ice infested regions like the grand banks of newfoundland face additional environmental challenges from glacial ice fragments large icebergs can be easily detectable and usually deflected by towing growlers and bergy bits estimated mass 10 000 tonne are often difficult to detect in rough seas or at night according to the report by husky oil operations 2000 growlers and bergy bit frequencies in the white rose site in grand banks constitute 31 of the total iceberg distribution these smaller bergs even when detected are unstable and difficult to deflect in high seas mak 1989 the potential hazard is intensified by the fact that these smaller ice pieces can exhibit significantly higher impact speed than their mean drift speed attwood 1987 with relatively short impact duration lever et al 1988b these higher impact velocities are associated with wave induced component of the smaller icebergs and bergy bits close vicinity hydrodynamic interaction between a bergy bit and an offshore structure influences the impact velocity various model testing programs revealed associated events like velocity reduction added mass change negative drift force fluid cushioning shadowing eccentric impact passing around without impact etc due to this near field hydrodynamic interaction salvalaggio and rojansky 1986 mctaggart 1989 lever et al 1990b mak et al 1990 and isaacson and mctaggart 1990a 1990c iso 19 906 iso 19906 2010 also recommends hydrodynamic interaction effects to be considered in terms of velocity reduction and change in added mass but does not provide specific guidelines sayeed et al 2017a identified existent research gaps in this area through a comprehensive literature survey hydrodynamic effects will tend to be more significant for smaller icebergs and wider structures moreover these effects will have a large influence on impact kinetic energy and potentially a smaller rate effect influence of ice strength thus the study of near proximity hydrodynamic interaction is essential to accurately estimate the impact loads since 1980s several experimental campaigns have been conducted to investigate the iceberg structure interaction in waves attwood 1987 and lever et al 1988a 1988b observed that the iceberg models behaved like fluid particle when the ratio of wave length to characteristic iceberg size is greater than 13 for this ratio below 10 diffracted wave and viscous forces were anticipated to have significant effects salvalaggio and rojansky 1986 observed no impact when the iceberg diameter was less than approximately half the structure diameter lever et al 1990a included randomly varying iceberg shape to improve their impact velocity probability statistics the total impact velocity was considered as the sum of the drift velocity in open water and the significant velocity in waves lever et al 1990b investigated the wave induced motions of bergy bits impacting a semi submersible in irregular waves similar tests were conducted by mak et al 1990 in regular and irregular waves with a floating oil production platform with larger physical dimensions than the wave transparent semi submersible tested by lever et al 1990b open water significant velocities were found to be 10 40 higher than significant impact velocities mak 1989 also identified that berg rotation contributes a small portion to the total impact kinetic energy and the relative motion between berg and floating structure has a tendency to mitigate the impact mctaggart 1989 and isaacson and mctaggart 1990a 1990c conducted experiments and numerical analysis to investigate the hydrodynamic interaction during iceberg drift in proximity with an offshore structure no impact occurred for the wave driven iceberg when the ratio of iceberg diameter and structure diameter is less than or equal to 0 2 whereas salvalaggio and rojansky 1986 in their experiments found the ratio to be 0 5 it was reported that the presence of the structure resulted in 10 or more velocity reduction for smaller icebergs kazi et al 1998 observed repulsive interaction force during the experiments between a fixed cylinder and free floating cylinders of various shapes and sizes model scale experiments of iceberg and bergy bit impact with terra nova fpso were conducted by colbourne et al 1998 the effect of reflected and radiated waves resulted in confused collision trends and the impact energies for small ice pieces were found to be reduced in higher sea states the reason was attributed to the reflected wave energy which tends to negate the increased berg energy colbourne 2000 the hydrodynamic interaction between a floating ice mass and a tanker passing at speed was investigated by gagnon 2004 an increase in maximum sway motion of the ice mass was observed due to the proximity effect with the tanker acting as a temporary wall tsarau et al 2014 observed positive and negative hydrodynamic forces depending on the separation distance when a cylinder structure was towed past a fixed submerged sphere ice mass at different speeds and separation distances in calm water kim 2014 towed ice blocks at two speeds and impacted onto a stiffened steel panels of a moored structure to investigate simultaneous inelastic deformations of ice and steel structure some tests were conducted in air to separate the hydrodynamic effects the wave induced motions of ice floes of various sizes and shapes were investigated in regular waves by mcgovern and bai 2014a ice floes exhibited different motions than those of icebergs due to flat low draft geometry the isolated floe showed fluid particle type motions at wavelength to characteristic length ratio of 3 3 5 mcgovern and bai 2014b also investigated the kinematics of ice floes approaching head on to a circular cylinder in regular and irregular waves an increase in heave response and a significant reduction in surge response was observed when the separation distance to cylinder diameter ratio was less than 10 the mean drift velocities also showed low and negative values when the ice floe is close the cylinder sayeed et al 2017b 2018a 2018b conducted multi phase experimental and numerical studies to investigate near field hydrodynamic interaction of a small moving body towards a fixed structure in both regular and irregular waves sayeed et al 2017b measured the wave forces on different sized spherical ice masses at different locations away from the structure the separation distance to wavelength ratio was found to dictate the corresponding wave forces in surge and heave directions most of the cases where the ice mass is positioned close to the structure the mean drift force became negative also when the ice mass was closer to the structure the non dimensional surge forces decreased and the non dimensional heave forces increased sayeed et al 2018a measured the wave induced motions of same spherical and one cylindrical ice masses approaching a fixed structure in regular waves similar to previous findings the motions were found to be significantly influenced by the standing wave in front of the structure depending on the separation distance to wavelength ratio the motions were amplified at nodes and antinodes of the standing wave at nodal locations the surge motions were increased and heave motions were decreased and at anti nodal locations the surge motions were decreased and heave motions were increased as the body approached head on near the structure the surge motion slowed down and at the same time the heave motion was increased also non linear heave motions of the spherical models were observed due to their deep draft and large excursions from equilibrium position when subjected to wave excitation sayeed et al 2018b investigated wave induced forces and motions of the same models with the presence of the fixed structure in irregular waves measurements of significant wave heights in front of the fixed structure showed that even in irregular waves there exists a standing wave generated by the superposition of the incident and reflected peak frequency wave the significant wave loads at different proximity to the fixed structure varied with the ratio of separation distance to peak frequency wavelength moreover as the body is located closer to the structure the non dimensional significant surge forces decrease and the non dimensional significant heave forces increase small differences in the significant surge and heave velocity spectra were observed due to the presence of the structure the reason is attributed to the lack of data at specific location to fully capture the motion responses for all the frequencies in the spectrum it was also observed that the small bodies in regular waves may or may not hit the structure depending on the initial starting condition sayeed et al 2018a whereas the ice masses hit the structure in all cases of irregular waves sayeed et al 2018b in the present study the non dimensional surge and heave motion data up to the first impact in irregular waves are reanalyzed by normalizing the separation distance d with significant wavelength λ p the objective is to identify possible correlation between significant wavelength of the irregular wave spectrum with the spatial motion history in front of the fixed structure a statistical approach is then taken to both regular and irregular wave data sets due to extreme non linearity evident in the heave data for regular waves and to properly assess the response in irregular waves thus the data is presented in terms of percentiles of velocity response vs position as the small floating bodies approach the fixed structure this allows an assessment of trends in mean velocity but also provides an indication of the expected variability in the response 2 experimental program experiments were carried out to measure the motions of the free floating ice masses approaching a fixed structure in regular and irregular waves the objective was to investigate close proximity hydrodynamic interaction between approaching ice mass and fixed structure the details of the test program can be found in sayeed et al 2018a 2018b a brief description of the experimental campaign is provided in this section 2 1 facility the experiments were conducted in the towing tank of the ocean engineering research center oerc at memorial university of newfoundland mun in st john s nl canada the towing tank is 58m long and 4 5m wide with maximum still water depth of 2 2m 2 2 models and instrumentation a hexagonal aluminium cylinder of diameter d s 0 5 m was used as the fixed offshore structure three spheres of diameters d i d s 0 3 0 4 a n d 0 6 and one cylinder of diameter d i d s 0 4 and 0 098m height were used as ice masses the scale ratio is nominally 1 50 thus the full scale structure diameter is 25m and full scale diameters of ice masses are 7 6m 10 15m and 15 25m respectively all these models provide relatively large floating masses in relation to the structure diameter thus the effects observed in these experiments for the tested size of the structure relative to wavelength can be considered to represent the lower bound of the velocity reduction effect it is expected that larger structures relative to wavelength would show stronger effects in reducing the velocities of approaching icebergs qualisys optical tracking system was used to measure the rigid body motions in 6 degrees of freedom three infrared cameras were mounted and calibrated to cover the desired field view three capacitance type wave probes were used to measure the wave profile of the incoming and reflected waves fig 1 shows the layout of the experimental set up of motion experiments in the towing tank with dimensions and coordinate system in addition videos were recorded and digital still photographs were taken during experiments 2 3 environment the water depth in the towing tank was 1 8m six regular waves with two different wave steepness and five irregular waves of different significant wave heights and periods are used a jonswap wave spectrum was used to generate the irregular sea with peak enhancement factor γ of 2 2 the duration of the generated wave trains was about 2 min to avoid reflections from the beach the wave particulars for regular and irregular waves are given in tables 1 a and 1b respectively the peak frequency wavelength λ p is calculated using the dispersion relationship of linear wave theory 2 4 methodology the fixed structure model was ballasted with water and placed in the tank the spheres were ballasted with paraffin wax of density 870 k g m 3 to provide neutral buoyancy at the correct draft the cylindrical model was made by stacking and bonding polypropylene circular blocks the submersion depth was approximately 0 2 diameter of the respective model the ice model motions were restrained in sway and roll by two guide wires and a light weight carbon rod on top of the sphere fig 2 moreover the spheres were ballasted by inserting a rod at the bottom of the spheres with small weights at the end to reduce excessive pitch motions to facilitate the analysis optical tracking system four light weight reflective passive marker balls were installed on the rod attached to the model the marker balls were arranged in such a manner that there is no shadowing of multiple markers when the model rotates and the markers can be seen distinctively by the cameras the model was held at the release distance from the structure and then was let go after few seconds the initial release distance was measured from the face of the fixed structure to the center of the sphere the release distances were 2m for the cylinder medium and large spheres and 1 6m for the small sphere since this sphere took a longer time to travel due to smaller wave drift velocity compared to the two other spheres each test duration was about 2 min and the waiting time between tests was about 15 min to let the tank settle once the tests with the structure in place were finished the structure was taken out of the tank and the models were tested in a similar fashion without the presence of the structure the release locations for the no structure cases were the same as the test cases with the structure a number of repeat tests were conducted to validate and quantify the repeatability of the results froude scaling law was applied since surface gravity waves are the main driving factor all previous experiments followed the same scaling law isaacson and mctaggart 1990a lever et al 1990a 1990b mak et al 1990 colbourne et al 1998 mcgovern and bai 2014a 2014b it is also expected that reynolds dissimilitude will not have an effect since three different sizes of identical shape are used for the spheres attwood 1987 lever et al 1988a mcgovern and bai 2014a moreover sayeed et al 2017b found from the numerical analysis that the viscous forces are negligible compared to pressure forces for the simulated cases 2 5 test matrix the test matrix for the free floating motion experiments in regular and irregular waves are given in tables 2 a and 2b respectively fig 3 shows the spherical models during two typical regular and irregular wave experiments 3 results and discussion time series of full 6 dof motions and the wave profiles from the wave probes are available for the ice models subjected to regular and irregular waves in regular waves the models may or may not hit the structure but for all test cases in irregular waves the models eventually go forward and hit the structure only surge and heave motions are analyzed for the purpose of the study surge and heave velocities are calculated by differentiating the corresponding surge and heave displacements figs 4 and 5 show the time series of surge and heave velocity for sphere d i d s 0 4 tested with structure in regular wave λ d s 3 5 and cylinder d i d s 0 4 tested with structure in irregular wave λ p d s 6 4 respectively both figures also include results from repeat tests it is to be noted that the wave phases were not matched while releasing the models during these experiments 3 1 reanalyzed irregular wave data sayeed et al 2018a discussed how standing waves in front of the fixed structure influence the motions of the approaching ice mass in regular waves the ratio of separation distance to wavelength was found to dictate the surge and heave motions of the ice model coming towards the structure sayeed et al 2018b measured the significant wave heights at different locations away from the fixed structure and found a similar but less distinct standing wave pattern for irregular waves when the separation distance was non dimensionalized by the peak frequency wavelength relatively small differences were reported in significant surge and heave velocities for the with structure and no structure conditions the reason was attributed to the insufficient data at specific locations to fully capture the motion responses for all the frequencies in the spectrum in the present analysis all the data tested in irregular waves up to the first impact are re analyzed the surge and heave rms velocities are normalized by the rms velocities of surge and heave for no structure cases in the same wave conditions these normalized velocities are plotted against an average range of separation distance d to significant wavelength λ p ratio the variable separation distance d was calculated from the measured drift motion data figs 6 13 show the non dimensional surge and heave velocities for spheres d i d s 0 6 0 4 0 3 and for cylinder d i d s 0 4 all tested in irregular waves with structure and plotted against d λ p the results also contain all the repeat runs r refers to repeat cases there is more scatter in non dimensional heave velocities for the spheres because of the non linear heave motions for most of the wave cases these figures clearly demonstrate similar findings as obtained during the experiments in regular waves the influence of the standing wave is also obvious to the surge and heave motions of small bodies in front of the fixed structure even in irregular waves the motions are amplified at nodal and anti nodal locations as expected in general the surge velocities are found to be reduced whereas the heave velocities are increased just prior to impact 3 2 percentile analysis of regular and irregular wave data in this section the normalized data for both regular and irregular waves are further analyzed by taking bins of 1 20 times distance wavelength from the fixed structure and sorting the heave and surge velocities into these bins the velocity data in each bin was fit using a log normal distribution for that separation distance and the 10th 50th and 90th percentile velocity values extracted for each mean separation distance this analysis is performed separately for spheres and the cylinder in order to illustrate the effects of shape as the cylinder data showed a much more linear heave response however all the data for spheres regardless of size were combined in the same plot figs 14 21 show the percentile analysis results for both regular and irregular waves presented separately for spheres and cylinder in these plots the raw non dimensional data is in the background with the calculated percentile data plotted as lines superimposed on the raw data these lines show the mean trend but also the bounds of the expected response for all cases the surge data for both spheres and the cylinder in regular waves show the most evident effects of the standing wave pattern in front of the structure although there is still a considerable range of response between the extreme values however it is clear that in the very near field the surge velocity decreases as the floating body approaches the structure and that even the 90th percentile value is below 1 at the nearest location measured the heave values for the cylinder in regular waves also show a pronounced effect of the standing wave and in this case the heave velocities are sharply increased in the near field the results for the heave velocity of the spheres in regular waves do not show the same level of influence of the standing wave pattern this is thought to be mainly due to the non linear heave response associated with the highly variable water plane area of the largely submerged spherical shape this leads to a more chaotic heave response in spherical shapes and consequently less definite trends in the heave velocity data similar non linear chaotic heave motions for spherical models were also observed by other researchers like attwood 1987 wishahy et al 1987 and hinchey et al 1991 irregular wave data for all shapes show the expected trends in both surge velocity and heave velocity in the very near field but the effects further from the structure are obscured by the multiple frequencies present in the incident and reflected waves the near field values are also subject to wider variation also thought to be due to the presence of multiple frequencies thus the results are not as clear cut but the data does show both the mean trend and the extremes 4 conclusions the design of offshore installations in harsh arctic environments must consider the potential impact loads from icebergs and bergy bits although large bergs can easily be tracked and deflected as necessary growlers and bergy bits may slip the ice management surveillance system these smaller ice pieces are significantly influenced by close proximity hydrodynamic interaction between the berg and the structure sayeed et al 2017b 2018a 2018b conducted multi phase experimental and numerical studies where wave induced forces and motions of small ice masses near a fixed structure were investigated in both regular and irregular waves spatial wave profile measurements sayeed et al 2017b 2018b in front of the fixed structure showed the standing wave pattern generated by the superposition of incident and reflected wave in both regular and irregular waves both wave force and motion measurements sayeed et al 2017b 2018a in regular waves showed that the separation distance to wavelength ratio plays a significant role in determining the corresponding wave forces and motions in that location wave forces and motions were found to be amplified at nodal and anti nodal locations and the non dimensional surge forces motions tend to go down and the non dimensional heave forces motions tend to increase as the separation distance to wavelength ratio becomes increasingly greater than 0 25 in the present paper irregular free floating motion data up to the first impact have been reanalyzed in a similar manner as was previously done for regular waves sayeed et al 2018a the new normalized results clearly show the influence of peak frequency wavelength to the spatial motion time history the normalized motions follow the similar trend depending on the ratio of separation distance to peak frequency wavelength the present analysis also included a simple statistical look at the expected range of surge and heave velocity values based on a non dimensional presentation of the data the objective of this analysis was to establish the range of velocities for a realistic irregular wave train in order to determine whether the near field wave effects need to be considered in estimating small iceberg impact velocities velocity was measured as a function of separation distance and compared with velocities when no structure is present the impact velocity would be the velocity at zero separation this impact velocity showed a variation associated with wavelength and a statistical distribution in a multi wavelength irregular wave train based on the present findings it is concluded that realistic wave effects cause significant increases in heave velocities for small bergs approaching a structure but that the reductions in surge velocity although significant on average present a sufficiently wide range of values that a calculated reduction in berg approach velocity would not be justified for narrow fixed structures the current structure size relative to wavelength is in the lower range of the velocity reduction effect due to its relative slenderness it is expected that relatively larger diameter structures would have a greater effect on the velocity of approaching bergs further testing using larger structures diameter to wavelength ratio are recommended in the future when a more suitable facility becomes available the present findings of increased heave motions may have serious implications for potential impacts with topsides and other overhanging structures this effect will be pronounced for smaller icebergs and bergy bits since large bergs with high sails will be less influenced by wave effects in close vicinity to the structure declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors highly appreciate the supports from national research council canada ocre research center to draft this article 
22214,reliable navigation systems are fundamental for autonomous underwater vehicles auvs to perform complex tasks and missions it is well known that the global positioning system gps cannot be employed in underwater scenarios thus during missions below the sea s surface the real time position is usually obtained with expensive sensors such as the doppler velocity log dvl integrated within a navigation filter such as an extended kalman filter ekf unscented kalman filter ukf or dead reckoning dr strategies the goal of this work is to develop an underwater navigation system that does not rely on a dvl and where linear speed estimations are obtained exploiting data from a forward looking sonar fls or in its absence taking advantage of a dynamic model that presents a reduced set of parameters the proposed solution is validated through the use of navigation data obtained during sea trials undertaken in july 2018 with feelhippo auv at la spezia italy at the nato science and technology organization center for maritime research and experimentation cmre keywords auvs underwater robotics autonomous navigation acoustic odometry sonar 1 introduction today autonomous underwater vehicles auvs are widely employed for many applications in diverse fields and the availability of a precise and reliable navigation system is of utmost importance regardless of the kind of mission the underwater vehicle is required to perform the final result is affected by its overall navigation performance moreover it is well known that the unavailability of the global positioning system gps signal like other electromagnetic signals in the underwater domain barclay 2003 makes the localization and navigation task more difficult the majority of underwater navigation systems are based on either the kalman filter kf kalman 1960 the extended kalman filter ekf bar shalom et al 2004 or the unscented kalman filter ukf allotta et al 2016c costanzi et al 2018 typically employed when non linearities in the dynamic description of the system arise as the simplest solution despite their straightforward philosophy dead reckoning dr strategies have proven satisfyingly reliable if the available sensors are sufficiently accurate generally speaking all require knowledge of the linear speed of the auv which is for the majority of times obtained by means of specialized and ad hoc underwater sensors such as the doppler velocity log dvl in addition absolute underwater position information can be obtained using beacons with two types of system most commonly employed being the long baseline lbl and the ultra short baseline usbl leonard and bahr 2016 conversely as stated in melo and matos 2017 the main disadvantages are the total cost the deployment and recovery time especially for the lbl and a detailed calibration process which is necessary to obtain optimal positioning accuracy especially for the usbl to ease the localization problem static and or dynamic local sensors networks composed of localizing acoustic devices have gained attention yoerger et al 2007 and bahr et al 2009 single beacon localization has been proposed whereby a vehicle usually known as beacon vehicle with good quality positioning information is able to transmit range information acoustically to one or more underwater vehicles as described in tan et al 2014 and webster et al 2013 in addition moving long baseline mlbl systems that are a generalization of the lbl have been suggested here as stated in yan et al 2015 the arrays of transponders are fully mobile and self calibrating thus they do not constrain the operating site to a fixed area contributions can be found for example in curcio et al 2005 and bishop et al 2010 over the last two decades several strategies exploiting optical or acoustic payload to solve localization problems have been proposed in particular simultaneous localization and mapping slam techniques have been successfully applied further information concerning underwater slam can be found in chaves et al 2017 optical sensors e g optical cameras are relatively inexpensive with high resolution information provided at high refresh rates but adverse conditions in the underwater domain are likely to be present for example it is well known that turbid waters turbulence sediment or poor lighting conditions can lead to a limited visibility range usually less than 10 m thus jeopardizing operations with optical devices mallios et al 2014 as a consequence researchers have often relied on acoustic payload sensors such as sonar and more recently forward looking sonar fls considering them a more robust option hurtós et al 2015 acoustic payloads present higher costs and lower resolution than optical ones on the other hand the former are able to penetrate the water even in poor visibility conditions for longer ranges e g fls can reach distances greater than 150 m mallios et al 2014 more information concerning the state of the art in underwater navigation and localization which is beyond the scope of this work can be found in leonard and bahr 2016 and paull et al 2014 the main contribution of the work presented here focuses on promoting the use of fls to aid underwater navigation proposing a solution able to estimate linear speed without exploiting dvl measurements working on fls images a fourier based registration method is employed and to cope with feature poor environments a dynamic model that exploits a reduced set of parameters is used when no linear speed measurement from the acoustic payload is available the results are shown to be comparable with those obtained with a dvl based navigation system the authors are aware that the achieved performance is unlikely to be better with respect to a dvl based navigation system even in the near future indeed the authors wish to point out that even if the proposed solution is shown to work without exploiting any dvl measurement cooperation with the dvl is possible this way more linear speed measurements could be obtained in addition to this using fls to aid navigation could potentially outline other advantages in fact using an augmented set of devices able to provide navigation information represents an intrinsic boost in redundancy preventing failures due for example to underwater sensor denied scenarios such as dvl denied scenarios when proximity to the seafloor or other surfaces takes place miller et al 2010 or when a substantial number of gaseous bubbles is present moreover although bigger auvs enable the use of more complex instrumentation and are able to carry a heavy payload smaller auvs are constrained to limited payload carrying capabilities hence in addition to constituting a valuable research interest multitasking on board sensors represent a solution that offers compactness and avoids the use of some instruments the results of this study were obtained using navigation data gathered during the european robotics league student autonomous underwater vehicles challenge 2018 erl sauc e 2018 competition ferri et al 2015 and ferri et al 2017 held in la spezia italy in july 2018 this involved using feelhippo auv a lightweight vehicle developed by the department of industrial engineering of the university of florence unifi dief during the above mentioned tests feelhippo auv navigated by dr with its standard equipment see allotta et al 2017a b and costanzi et al 2016 and the proposed solution was tested and validated offline some points are worth highlighting first this work focused on post processed data however a testing framework as close as possible to a real online test was adopted in particular all the sensor data have been used as input for the proposed solution with a time synchronization based on the time at which messages were received moreover the validation was performed using the same navigation software present on feelhippo auv second the performed underwater mission was planned to try to simulate a composite scenario where different elementary motions were present turns at right angles sharp turns short transects around 3 0 m medium transects around 16 0 m and longer ones around 30 0 m last the underwater environment was not known a priori both high informative seabed areas and poor ones were present the obtained results are promising and on line underwater tests will be implemented in the near future the remainder of the paper is organized as follows related works in the underwater domain are described in section 2 whereas section 3 is dedicated to preliminaries useful in the development of this work and to the description of the current navigation system present on feelhippo auv section 4 addresses the proposed navigation strategy whereas section 5 focuses on the mechanical design and on the hardware architecture of feelhippo auv section 6 illustrates the conducted sea trials and performance of the proposed navigation solution finally section 7 draws conclusions 2 related works the vast majority of contributions concerning acoustic payload in navigation aiding are focused on constraining the navigation drift of the auv thus particular emphasis has been paid to the use of these devices complementary to a standard navigation sensors set comprising for example a dvl inertial measurement unit imu and fiber optic gyro fog see paull et al 2014 accordingly as stated by durrant whyte and bailey 2006 and li et al 2018 navigation can be adjusted for example by means of self correction using environmental landmarks whereby observations of features or landmarks assumed time invariant and re observation of the landmarks are crucial hidalgo and bräunl 2015 therefore acoustic payload is usually included in a slam framework sonar based slam is approached in two ways depending on whether a set of range and bearing measurements is produced this can be achieved with multibeam echosounders mbes or an acoustic image of the scene is acquired this can be achieved with flss side scan sonars ssss or mechanically scanned imaging sonars msiss ribas et al 2010 a concise overview of the main contributions for navigation purposes is reported here and for further information the interested reader is encouraged to read ribas et al 2010 and valencia and andrade cetto 2018 in walter et al 2008 an fls based slam for performing a ship hull inspection is shown here fls images are related by means of features extracted from different frames conversely the velocity relative to the ship hull is retrieved exploiting a dvl this therefore constitutes a part of the navigation system a similar solution based on sss and re observation of landmarks previously detected to reduce navigation drift is presented in ruiz et al 2004 in johannsson et al 2010 a drift free navigation solution during harbor surveillance and ship hull inspection by means of an fls is proposed where a dvl to measure velocity relative to a surface and a ring laser gyro are present on board another feature based solution is proposed in li et al 2018 where a ship hull inspection is undertaken a slam algorithm that makes use of an fls as the sole perceptual sensor to perform navigation drift correction of a dvl imu based odometry navigation framework is outlined many authors such as hurtós et al 2015 and hurtós et al 2013 have indicated that feature detection by means of acoustic images might be difficult in a generic natural underwater environment feature based techniques present repeatability and discrimination issues due to for example low resolution and illumination changes consequently several researchers have tried to use either features at a region level or the entire image a study by aykin and negahdaripour 2012 describes a technique implemented on fls images able to detect stable and reliable features located at region rather than at pixel level however although the proposed solution is considered able to improve the precision of auv navigation no specific result was outlined in hurtós et al 2015 a mosaicing framework is presented able to create acoustic maps along various vehicle track lines where both translational and rotational 2d motions can be handled however the authors state that the proposed framework is tailored for an offline approach where the trajectory followed by the vehicle is computed a posteriori and integration in an online navigation system is only hypothesized in ferreira et al 2015 a real time mosaicing framework for fls applications is presented here the purpose is to propose an automatic target recognition atr technique in the context of mine detection the fls is used as a sole perceptual sensor and no integration with the navigation filter is proposed in ribas et al 2008 and mallios et al 2014 two ekf are used in parallel dr navigation is performed with the first where a dvl and an attitude and heading reference system ahrs are employed the second makes use of range and bearing data retrieved from an msis and the filter is updated via feature extracted from the environment in the former and via a probabilistic scan matching in the latter in white et al 2010 six slam techniques have been applied to the exploration and mapping of ancient cisterns but the proposed solution is said to be capable of mapping and navigating underwater tunnel systems where it is much easier to retrieve information from the surrounding environment however the open sea navigation problem is not tackled in norgren and skjetne 2018 the authors propose an iceberg mapping method using an auv equipped with an mbe by estimating the position and orientation of the iceberg in particular a top level ekf provides the relative position and orientation between the auv and the iceberg whereas a bottom level estimator is based on the bathymetric distributed particle slam bpslam algorithm among other navigation sensors an upwards looking dvl is considered in the solution in rahman et al 2018 the authors employ data from a stereo camera angular velocity and linear acceleration data from an imu and range data from an msis in this work experimental tests have been conducted in rich environments such as artificial shipwrecks and a submerged bus but no quantitative evaluation of the navigation is given to the authors best knowledge few proposals focused on effectively substituting a dvl in favor of an fls for underwater navigation are present for example in song et al 2018 a method is presented that relies on optical and acoustic images for localization purposes a mixed approach that uses an fls a standard camera or a dr strategy is proposed although the solution is tested using data gathered from experimental tests the navigation performance of the technique is not thoroughly investigated 3 preliminaries and notation first the notation employed in the rest of the work the kinematic and dynamic modelling of an auv the imaging geometry model of an fls and the key concepts of fourier based registration methods are reported after a brief description is given of the current navigation algorithm present on feelhippo auv 3 1 kinematic and dynamic modelling of the auv the pose of the auv in terms of position and attitude is retrieved with respect to a local earth fixed reference frame with axes pointing north east and down ned frame o n x n y n z n whereas the body frame is centered in the center of gravity cg of the vehicle with the forward motion direction represented by the x axis surge and the z axis heave pointing down o b x b y b z b lastly the y axis sway completes a right handed reference frame to describe the kinematic model of the vehicle sname notation is employed fossen et al 1994 see fig 1 the auv is represented with η η 1 η 2 t where η 1 indicates the position of the auv and η 2 its orientation in particular a triplet of euler angles expressed with respect to a fixed frame namely roll ϕ pitch θ and yaw ψ rpy is used moreover the linear and angular velocities of the vehicle with respect to a body fixed reference frame is denoted with ν ν 1 ν 2 t the vector of forces and moments acting on the auv is τ r 6 whereas t r m and u r m with m the number of motors in this case four are a vector that collects the thrusts and the vector of rotational speed of the motors for the sake of clarity the kinematic model of the auv is reported in eq 1 eq 2 1 η η 1 t η 2 t t η 1 x y z t η 2 ϕ θ ψ t ν ν 1 t ν 2 t t ν 1 u v w t ν 2 p q r t 2a η j η ν 2b η 1 η 2 r b n η 2 0 3 3 0 3 3 e 1 η 2 ν 1 ν 2 where r b n represents the rotation matrix between the body and the fixed reference system and e is the euler matrix in addition the forces and moments on the auv and the thrusts carried out by the motors are linked using the linear model 3 τ ν u b t ν u where b is a constant matrix assuming the vehicle and the thrusters are not reconfigurable that depends upon the thruster poses with respect to the cg its expression is reported in eq 4 and eq 5 assuming as already stated that the body frame is centered in the cg 4 b b 1 b 2 with 5 b 1 n m i b b 2 p m i b n m i b where n m i b is the axis of the i th motor expressed in the body frame o b x b y b z b and p m i b is the thruster center of the i th motor with respect to the cg expressed in the body frame according to fossen et al 1994 the dynamic of the auv can be described as 6 m ν c ν ν d ν ν g η τ ν u m is the mass matrix c ν is the centrifugal and coriolis matrix d ν is the damping matrix g η takes into account the effects of gravity and buoyancy and τ ν u describes the map between the vehicle speed ν and the rotational speed of the motors u to the resultant thrust action on the vehicle 3 2 fls imaging model and phase correlation technique the area covered by an fls that insonifies the sea bottom can be described using spherical coordinates r α β where r is the range α is the azimuth angle and β is the elevation angle let us assume a reference frame o f s x f s y f s z f s centered on the fls center with the x axis pointing forward the z axis pointing down and the y axis completing a right handed reference frame the position and orientation of the fls with respect to the o b x b y b z b frame can be represented as follows see eq 7 7 a f s r b f s p fs o 1 where r b f s is the matrix between the fls and the body reference system and p fs is the position of the fls with respect to the cg expressed in the o b x b y b z b frame in the following the uppercase will indicate a 3d point whereas with the lowercase the same 3d point is projected on the image plane the coordinates of a generic 3d point p in the o f s x f s y f s z f s reference system expressed in spherical coordinates are see fig 2 8 p x y z r cos α cos β r sin α cos β r sin β the nonlinear model that projects a 3d point p on the point p belonging to the image plane is 9 p x y r cos α r sin α 1 cos β x y more information can be found in walter 2008 negaharipour 2012 an image in the spatial domain is indicated with the lowercase i x y whereas an image in the fourier domain is expressed with the uppercase i m m an image collected at a certain absolute time t i r is defined as i t i x y or i t i m n in the spatial and the fourier domains respectively where i t i m n f i t i x y and with f is denoted as the fourier transform ft the phase correlation algorithm or its variants which is a fourier based method de castro and morandi 1987 and reddy and chatterji 1996 has been widely used for registration of roto translated optical images over the years such as in ojansivu and heikkila 2007 tzimiropoulos et al 2010 li et al 2007 or eustice et al 2002 in the underwater domain differently its use in fls is less prevalent the key concept is based on the so called fourier shift property in the fourier domain a shift between two functions e g images appears as a linear phase shift given two images i t 1 x y and i t 2 x y with t 1 t 2 let us suppose that i t 2 x y is a translated and rotated replica of i t 1 x y 10 i t 1 x y i t 2 x cos θ 0 y sin θ 0 s x x sin θ 0 y cos θ 0 s y where s x r and s y r are the translation which can be put together in s s x s y r 2 and θ 0 r is the rotation angle their ft is 11 i t 1 m n e j 2 π m s x n s y i t 2 m cos θ 0 n sin θ 0 m sin θ 0 n cos θ 0 when pure translations are considered θ 0 0 see eq 12 eq 11 becomes eq 13 12 i t 1 x y i t 2 x s x y s y 13 i t 1 m n e j 2 π m s x n s y i t 2 m n in this case from eq 13 the normalized cross power spectrum is 14 c m n i t 1 m n i t 2 m n i t 1 m n i t 2 m n e j 2 π m s x n s y where denotes the complex conjugate it is easy to note that the inverse ft of eq 14 reported in eq 15 is a 2d dirac function centered on s and its location can be found with eq 16 15 c x y f 1 c m n 16 s s x s y arg max x y c x y in conclusion by solving eq 16 the location of the peak of the cross power spectrum in eq 14 can be obtained and therefore the translation s between i t 1 x y and i t 2 x y can be found see eq 12 in the rest of the paper because of the digital nature of the images involved the discrete case of the ft is employed more information regarding phase correlation applied to discrete cases with subpixel translation estimation can be found in foroosh et al 2002 3 3 current navigation system a detailed treatment of the current navigation system of feelhippo auv is beyond the goal of this work however a brief description will be provided in the following in order to retrieve an accurate estimate of the pose of the vehicle with respect to a local ned frame feelhippo auv employs a parallel structure where attitude is independently estimated from position and it constitutes an input that is fed to the position estimation filter see fig 3 in particular concerning attitude the filter structure has been originally proposed in mahony et al 2008 and then suitably modified by the authors in allotta et al 2016a costanzi et al 2016 whose principle aim is to integrate angular rate changes measured by gyroscopes and correct the obtained values exploiting accelerometers and magnetometers with regard to position estimation feelhippo auv is able to navigate exploiting a dr strategy and additionally it can resort to an ukf based estimator where a mixed kinematic dynamic vehicle model is proposed taking into account longitudinal dynamics only a reduced computational burden is present on the processing unit a complete treatment is detailed in allotta et al 2016c and allotta et al 2017a b 4 proposed solution first the main assumptions on which this work is based are outlined second how to estimate the linear speed of the auv is broadly treated last how the proposed solution has been integrated in the current navigation framework is described assumption 1 most of the dynamics of the auv take place in the longitudinal direction in fact even if feelhippo auv does not properly possess a torpedo shape it can be easily noted see fig 4 that longitudinal direction is still that of minimal resistance in order to reduce battery consumption feelhippo auv mainly performs missions along the longitudinal direction assumption 2 because the body reference frame of feelhippo auv is aligned with the vehicle principal axes of inertia the mass matrix can be considered as diagonal assumption 3 the maximum vehicle speed is not too high approximately 1 m s see table 2 thus the coupling between the dissipative effects can be neglected leading to a diagonal damping matrix in addition only a quadratic damping term has been taken into account assumption 4 gravitational centripetal and coriolis effects have been neglected and added masses are not considered sea currents are hypothesized to be small assumptions 1 4 are similar to those made by the authors in allotta et al 2016c therefore the classic dynamic description of fossen et al 1994 and reported in eq 6 can be simplified for the longitudinal motion with eq 17 17 m ν 1 x m u τ 1 x ν u f 1 ν f 1 ν obtained from the dynamic model in fossen et al 1994 can be further simplified with the aim of reducing the number of parameters as follows 18 f 1 ν a f c u ρ ν 1 x 2 sgn ν 1 x 2 where m is the mass of the vehicle ρ is the density of the water a f is the frontal area of the vehicle and c u is the drag along the surge axis generally the drag effect depends upon among other things the speed of the auv relative to the viscous fluid in light of assumption 4 eq 18 where just the velocity of the vehicle is taken into account can be considered a good approximation with regard to added masses acceleration terms are usually numerically negligible underwater missions for the most part are composed of phases within which the vehicle moves forward at an approximately constant speed as a consequence the dry mass m can be considered a good approximation assumption 5 roll and pitch motion cannot be actively controlled see section 5 1 but their dynamics are controlled by hydrostatic stability their variations are thus limited and can be neglected assumption 6 the four quadrant motor characteristic is approximated with 19 t i ν u i sgn u i k u i 2 k u i g sgn u i v a i p where i refers to the i t h motor and 20 g x 0 f o r x 0 x f o r 0 x u i p u i p f o r x u i p and where p is the propeller pitch k is a construction parameter that relates motor thrust and propeller speed at bollard conditions i e when the advance speed v a i 0 see eq 22 and v a i which is the speed of the i t h motor can be expressed as a function of the speed vector ν 21 v a i n m i b t ν 1 ν 2 p m i b 0 b 22 k t ν u u 2 v a i 0 assumption 6 has already been exploited by the authors in allotta et al 2016b and more information can be found in pivano et al 2009 and carlton 2012 assumption 7 the fls is positioned at a fixed pose with respect to the vehicle s frame in addition to this the fls which is mounted on the bow of the vehicle is positioned approximately parallel with respect to the sea bottom that is supposed not to change abruptly in order to insonify wider areas assumption 8 the elevation angle around 7 10 for most typical fls devices can be considered small assumptions 7 and 8 make it possible to take advantage of a 2d approximated model instead of a complete non linear projection model see eq 9 in other words the projection p is substituted with the orthogonal projection p ˆ as reported in fig 2 thus eq 9 becomes eq 23 23 p ˆ 1 0 0 0 1 0 x y z a similar proposal can be found in ferreira et al 2014 ferreira et al 2015 hurtós et al 2015 and has already been exploited by the authors in franchi et al 2018 in light of the proposed imaging model and neglecting roll and pitch variations see assumption 5 it can be seen that a 3 parameter euclidean transformation plane roto translation puts two different fls views of the same object in relation a demonstration can be found for example here walter 2008 hence fourier based methods that are known to manage up to similarity transformations de castro and morandi 1987 can be employed 4 1 speed estimation of the vehicle the navigation framework depicted in fig 3 is modified to obtain the solution shown in fig 5 therefore it is clear that the core aim of this paper is to show how to estimate the auv speed in order to mimic dvl measurements to this end the proposed solution utilizes two different approaches in fact a generic underwater scenario can present both areas where the sea bottom contains a high informative content such as wrecks or debris and regions where the sea floor is invariable and unaltered briefly the case of unavailability of linear speed measurements from the fls must be handled therefore to address different situations a dynamic model that exploits a reduced set of parameters is employed when no linear speed measurement from the fls is available this complementarity of the two solutions is shown to achieve promising results 4 1 1 fls based speed estimation the key process through which a pair of overlapped images obtained from different viewpoints namely two images that insonify a common region are related each other is called registration or more specifically pairwise registration in the last decade researchers have tried to use feature detection methods both at pixel and region levels but it is obvious that the presence of stable and conspicuous features is necessary although computationally heavy a phase correlation method see section 3 2 is the most suitable to face mutable underwater scenarios anyway to make this method work it is worth noting that this consideration is not limited to phase correlation it is necessary for an overlap between the images nevertheless the magnitude of the minimum overlapping area cannot be known a priori indeed it can depend upon the informative content of the insonified area for example an overlapping close to 100 can produce incorrect results if the sea bottom in uninformative on the other hand an overlap of about 50 can be sufficient if a rich environment is present for fls application remarkable contributions can be found in hurtós et al 2015 and hurtós et al 2013 here the proposed method is the core of the fls based linear speed estimation and it can be divided into three steps in the first step raw fls images are filtered and rotated to be pairwise aligned section 4 1 1 1 in the second the linear translation between two subsequent fls images is retrieved section 4 1 1 2 in the third step the linear speed estimation is computed section 4 1 1 3 4 1 1 1 pre filtering and alignment for each step two subsequent raw fls images e g i t 1 and i t 2 are collected together with their absolute acquisition times e g t 1 and t 2 the fls is a device that intrinsically operates with polar variables namely range r and bearing angle α in fig 2 but when the raw acoustic image is created it is usually represented in the cartesian space therefore a fan shape clearly visible in fig 6 arises this particular fan shaped image presents an abrupt transition between the actual image content inside the fan and the background outside the fan thus when the ft is applied to all the image content frequency components not related to the real image content are inevitably introduced to overcome this issue the fan shaped contour of fls images is typically smoothed performing a windowing operation see the right fls image in fig 6 before applying the ft more information about window functions in the fourier domain is presented for example in harris 1978 smoothing the raw fls image implies a slight loss in the image content see the right fls image in fig 6 however this seems not to have negatively affected the speed estimation method from eq 10 it can be noted that rotations and translations if both present are coupled generally it is well known that when quantities are coupled it might be difficult to estimate them separately therefore because of the importance of rotation evaluation the authors have decided to retrieve them not working on images but relying on specialized sensors and algorithms that proposed by the authors in costanzi et al 2016 briefly introduced in section 3 3 and visible in fig 5 has therefore been used by knowing the location of the fls p fs in eq 7 the rotation center position of feelhippo auv and the output of the attitude estimation filter present in fig 5 i t 1 can be rotated to be aligned with i t 2 it is worth highlighting that because the acoustic insonification of a scene can produce different results according to the relative attitude between the source the fls and the target the proposed method may lead to registration issues when rotations are not small conversely given the fls acquisition rate usually more than 1 hz and the relative slow dynamics of the underwater vehicle this phenomenon can usually be neglected 4 1 1 2 phase correlation for linear translation the phase correlation technique is performed and the translation s see eq 16 between the two subsequent fls images i t 1 and i t 2 is computed from the peak on the normalized cross power spectrum eq 14 eq 15 and eq 16 the typical noise present in fls images leads to a cross power spectrum c x y with several peaks in the spatial domain and to overcome this issue filtering operations are necessary to c m n before applying eq 15 in this work with the aim of maintaining the computational burden as low as possible a non adaptive low pass lp butterworth filter a commonly used filter in image processing defined in eq 24 has been tested and further references can be found in weeks 1996 the final tuning parameters have been obtained after testing different combinations a fourth order butterworth filter with a cut off frequency of 110 0 pixels the image resolution is 894 477 pixels has been found to be the best solution in terms of overall behavior because the choice of the cut off frequency as well as the filter order is not adaptive its performance might have issues when different kinds of sea bottom e g sandy rocky or when feature rich environments are present are encountered on the other hand the achieved results seem not to be significantly affected by this fact see section 6 at the same time keeping the complexity low 24 h m n 1 1 d m n d 0 2 l where h m n is the transfer function d 0 is the cut off frequency l is the filter order and d m n m m 2 2 n n 2 2 1 2 where m is the number of columns and n is the number of rows regardless of the specific filtering approach the amplitude of the normalized cross power spectrum gives a measure of the goodness of the obtained translation and a binary acceptance law based on the value of r in eq 25 is performed in particular if r is more than 0 97 the registration is deemed correct otherwise it is discarded 25 p max c x y r 1 c x y p where c x y is the average value of the normalized cross power spectrum and p is its actual peak in fig 7 and fig 8 the normalized cross power spectrum c x y is shown both without and with the abovementioned lp filtering action to c m n respectively the presence of the lp filter leads to a surface where the peak is clearly visible and thus simpler to detect see fig 8 4 1 1 3 body speed estimation given the exact absolute arrival time of the two fls images t 1 and t 2 and the retrieved translation s see eq 15 the latter is mapped from pixel to meters or another similar physical quantity by taking advantage of the following linear transformation 26 d r m a x d h where d d x d y r 2 is a distance in pixel d d x d y r 2 is the same physical quantity expressed in meters r m a x is the maximum range delivered by the fls and h is the maximum fls range expressed as number of rows pixel in the fls image see fig 9 the conversion factor r m a x h in eq 26 is true for displacement along the rows of the image but it is an approximation for those along the columns exploiting assumption 1 most of feelhippo auv s motion takes place along the surge axis and given the placement of the fls see fig 15 the majority of the displacements takes place along the row of the images and the approximation can be sufficient at this point the body speed estimation can be easily computed 27 ν 1 s t 2 t 1 it should be stressed that in light of the proposed method section 3 2 only the speed in the plane x b y b can be obtained nevertheless the speed along the z b axis can be estimated using the ds before using the retrieved speed as input for the navigation filter see fig 5 its value is checked with the maximum performance that feelhippo auv is able to carry out in particular if the longitudinal speed is more than 1 0 m s and the lateral speed exceeds 0 2 m s see table 2 the retrieved velocity is discarded the oldest image namely i t 1 is deleted and a new one is acquired a complete overview of the proposed method is depicted in fig 10 4 1 2 model based speed estimation the identification of the most important hydrodynamic parameters is a crucial step in developing a reliable model based navigation system two kinds of identification tests have been undertaken first a test campaign to characterize the propulsion system second a test campaign to characterize the longitudinal drag with regard to the propulsion model presented in eq 19 new tests with the aim of obtaining a complete characterization of feelhippo auv propulsion system bluerobotics t200 blu 2019 see section 5 1 have been conducted and the experimental work presented by the authors in allotta et al 2017a b has been improved in particular new tests have been performed with different voltage supplies to gain more insight into the propulsion system to this end a new test rig has been designed and developed see fig 11 furthermore taking into account dead zones between the command drive and the motor thrust the propulsion model presented in eq 19 and proposed in allotta et al 2017a b has been enhanced and the final result is shown in eq 29 a quantitative evaluation of the analytical expression in eq 19 requires the knowledge of the propeller pitch p which is a construction parameter usually provided by the manufacturer and of the coefficient k this relates motor thrust and propeller speed at bollard conditions i e when the advance speed v a i 0 see eq 22 bollard thrust tests have been performed in a testing pool and the thrust propeller rotational speed voltage supply triad has been measured in several working conditions voltage supplies have been increased at discrete steps 12 0 14 0 16 0 22 0 and 25 2 v and for each value the thrust has been measured varying the propeller rotational speed because of the asymmetry of the bluerobotics t200 propeller both forward first quadrant motor operation and backward third quadrant motor operation tests have been conducted the complete results are presented in fig 12 and fig 13 where the bollard coefficients are 0 0128 n2 for the forward motion and for the backward one 0 008753 n2 respectively in the first case the coefficient of determination r 2 defined in eq 28 is 0 9922 whereas in the second it is 0 9639 28 r 2 1 s s res s s tot where s s res is the sum of squares of residuals and s s tot is the total sum of squares it is worth highlighting how the exerted thrust does not depend on the voltage supply but is uniquely influenced by the rotational speed see figs 12 and 13 this is not surprising as the bollard coefficient is only affected by the propeller and nozzle geometry given a certain rotational speed the results presented in fig 13 backward motion are slightly worse because of the compression localized on the load cell leading to small skids this is due to the connection clearance between the load cell and the test rig bar which adversely affects the measurements see fig 11 the experimental test rig set up was composed of a tas510 load cell by ht sensor technology co ltd htt 2019 and a cf350 fft spectrum analyzer by ono sokki co ltd ono 2019 for precise rotational speed measurements for the propeller to amplify the thrust exerted by the motors mechanically a leverage system composed of standard aluminum profiles was designed more specifically the thrust measurement is obtained as the result of the ratio between the thruster arm and the cell arm and their lengths can be easily regulated by a screw a schematic representation is visible in fig 11b currently during underwater operations feelhippo auv is not equipped with a sensor able to measure the actual propeller rotational speed such as hall effect based speed sensors see section 5 1 only its reference value is available conversely exploiting assumption 4 and noting that the propulsion system normally presents fast dynamics with respect to the relatively slow dynamics of the vehicle counterpart the committed error can be considered a further approximation with respect to the one already introduced by the four quadrant motor characteristic in eq 19 and eq 29 such that even if it represents a satisfying description it inevitably introduces unknown model errors briefly reference values for the rotational speed below a certain threshold are not actually followed where the drive command signal is not sufficient to produce a rotational movement for the thruster in fig 14 it can be cleared noted that the minimum rotational speed that can be actually obtained depends on the voltage supply indeed given a certain command drive logic the lower the supply voltage the less the output voltage furthermore the resulting behavior is clearly not affected by the direction of motion to prove this the slopes of the lines depicted in fig 14 are almost the same in absolute value at 0 5974 and 0 5866 this is not surprising as it is known that a linear relation between rotational speed and voltage supply holds for a direct current dc motor the point to highlight from the above treatment is that in case of the unavailability of direct speed measurements the coupling between thruster and command driver needs to be investigated in conclusion eq 19 becomes eq 29 29 t i ν u ˆ i d u ˆ v sgn u ˆ i k u ˆ i 2 k u ˆ i g sgn u ˆ i v a i p where u ˆ is the reference value for the rotational speed of the i t h motor v is the voltage supply and d x is defined in eq 30 30 d x v 0 for x u v 0 for x u v 1 otherwise where u backward motion and u forward motion are the boundary values for the dead zone that depend upon the voltage supply level if the reference value for the rotational speed falls within this interval the exerted thrust is zero for the longitudinal drag the authors implemented a standard least squares ls estimation technique applied to data longitudinal thrust and longitudinal speed gathered under steady state conditions when the auv moves forward at approximately constant speed a complete overview of the procedure developed by unifi dief even if applied to another auv can be found in allotta et al 2018 a list of the identified main hydrodynamic parameters is reported in table 1 where v is the voltage supply feelhippo auv description first a brief overview of the mechanical design of feelhippo auv and a description of its hardware is reported 5 1 mechanical design and hardware description feelhippo auv visible in fig 15 has been designed and developed both for the participation in student robotics competitions e g sauc e 2013 and erl sauc e in 2018 and for undertaking research topics several autonomous underwater navigation missions principally in shallow waters have been performed since 2013 the main features of the vehicle are reduced dimensions and weight making it a compact and reliable underwater platform a plexiglass hull with an internal diameter of 200 mm and 5 mm thickness constitutes the central body of the vehicle where the non watertight hardware and electronics are housed the connection between the central part of the vehicle and the two outermost domes is provided by two metal flanges and two o rings that guarantee a watertight connection in addition six metal bars act as tie rods increasing the overall stiffness results four thrusters arranged in a vectored configuration two on the stern and one each on both lateral sides tilted at 45 are connected to feelhippo auv by means of custom made plastic parts except for the roll and pitch motion that are limited by hydrostatic stability the rest of the degrees of freedom dofs of the vehicle translational motion and yaw can be controlled a list of all the electronic devices and sensor sets with which feelhippo auv is equipped is listed as follows intel i 7 mobile cpu used for onboard processing u blox 7p precision gps orientus advanced navigation ahrs composed of triaxial accelerometers gyroscopes and magnetometers together with a kvh dsp 1760 single axis high precision fog for attitude estimation of the vehicle nortek dvl1000 dvl measuring linear velocity and acting as ds the device is located on the bottom of the vehicle close to the cg an evologics s2cr 18 34 acoustic mode one teledyne blueview m900 2d fls mounted on the bow of the vehicle one wifi access point ubiquiti bullet m2 for fast high band shortrange communication on the sea s surface one radio modem 868 by rf design employed to send short messages from high distances on the sea s surface one bottom looking elp 720p mini ip camera one microsoft lifecam cinema forward looking camera which can be used for the tele operated guide two lateral elp 1080p mini ip cameras 6 navigation results the results reported in this section refer to the navigation data retrieved during a mission performed at the erl sauc e competition held in la spezia italy in july 2018 the mission was executed at the desired depth of 2 m with a reference longitudinal cruise speed of 0 5 m s lasting 960 0 s and covering approximately 220 0 m in addition the fls range was set to 10 0 m water current measurements were not available during the day of the trial but on the other hand the test site described here is a small basin at the nato sto cmre where water currents are usually of low intensity and thus negligible the area of interest was a rectangle with the approximate dimensions 36 20 m the underwater scenario presented both areas where the sea bottom contained a high informative content two underwater structures each approximately 2 2 3 2 1 2 m composed of underwater plastic pipes were positioned on the sea bottom see fig 16 with some metallic chains also present and regions where the sea floor was basically unaltered and flat the vehicle relied on the sensors and the payload described in section 5 1 for the extent of the mission and it performed the required navigation tasks exploiting a dvl based dr strategy with the navigation filter structure shown in fig 3 moreover gps fixes were acquired before diving and after resurfacing the dvl based underwater navigation strategy as well as the gps fixes were used as ground truth to validate the proposed fls based solution it is useful to highlight that although the used ground truth does not provide an absolute positioning system except from gps fixes before diving and after surfacing the navigation appears reliable because of the small error after resurfacing around 3 5 m see figs 17 19f where the relative value is less than 2 after about 16 min of autonomous navigation to assess the goodness of the proposed solution the speed estimation technique reported in section 4 and explained in fig 5 was thus tested and the results can be found in fig 17 here it should be stressed that the results were obtained in post processing on the other hand as explained in section 1 a testing framework as close as possible to a real online test was adopted furthermore with the aim of evaluating the impact of fls based speed measurements a simulation is presented in fig 18 where feelhippo auv navigates solely exploiting the model described in section 4 1 2 for the sake of completeness another simulation that exploits the model in section 4 1 2 without the introduced dead zone was performed the goal was to highlight that in case of unavailability of direct rotational speed measurements for the thrusters the relationship between the reference command value provided by the driver and the produced thrust needs to be further investigated the final results are presented in fig 19 the ground truth navigation was compared with the proposed solution and the results are presented in fig 20 and fig 21 where it can be easily noted how fls based speed measurements improve the overall performance the employed metrics are defined in eq 31 and eq 32 31 e k η 1 g t k η 1 t s k 32 e k i 0 i k e i k where e k r denotes the navigation error at the instant k n η 1 g t k and η 1 t s k indicate the position of the auv at instant k with respect to a o n x n y n z n ned frame according to the ground truth and to the current tested solution respectively and e k r is the mean of all the computed errors e k to gain greater insights into the proposed results further analysis is presented a comparison among the model based estimated speed the fls based one and dvl readings is shown in fig 22 because most of the vehicle dynamics take place on the surge axis the reported speeds are those occurring along this axis the figure depicts what happens for the extent of the underwater mission it is worth noting that for the first approximately 100 s feelhippo auv is on the surface thus only dvl readings are reported in addition for what concerns fls based speed estimations the obtained results due to erroneous peak detection exceeded the maximum speed of the vehicle see table 2 16 times over approximately 900 registrations around 1 8 thus in light of the speed check in fig 10 these estimations have not been employed by the navigation filter from fig 22 it is not easy to understand the advantages and disadvantages of the employed speed estimation methods therefore a further comparison is depicted in fig 23 to this end two straight transects and two turns where fls based speed estimations are almost able to cover the full duration of each operation have been considered turns on the second and the seventeenth way point wp and two straight transects the first from fourth to fifth wp and the second from eighth to ninth wp see fig 24 b for further information almost able to cover means that fls based estimations are continuously present for almost all the extent of the considered operation for each operation two simulations were compared one with the model based speed estimations only and another with fls based speed estimations only it is worth noting that the plotted results comparing speeds in the same way are delivered to the navigation filter in particular model based speed estimations have the same frequency as the navigation filter whereas those obtained with the fls in the best case scenario rich sea bottom have a frequency equal to the refresh rate of the raw fls images moreover until the arrival of the next fls image the speed is maintained at the previous value by observing fig 23 it can be noted that fls based speed estimation works well both during turns and when the vehicle moves forward moreover the model based solution performs worse when the vehicle does not move at approximately constant speed this is not surprising recalling assumption 4 added masses are neglected and moreover because dead zone arises at low rotational speed its nonlinear contributions are more affected here finally how the underwater scenario affects fls based speed estimations is presented in particular it can be easily understood that in the first part of the mission the error remains bounded to values below 1 m here the speed from the fls is present most of the time due to the pier basin inside the nato sto cmre as noted in fig 24b indeed the pier makes the fls images a rich source of information after because of the presence of less informative sea bottom areas the error grows due to several model based speed estimations in addition when feelhippo auv is close to the two underwater structures the error is small again and comparable with that identified in the first part of the mission this can be understood by observing the location of the two underwater structures in fig 24b and the corresponding navigation error see the rectangle 0 m 10 m east and 25 m 20 m north in fig 24a in conclusion if the sea bottom is reach and fls based speed estimation can be performed the obtained results present good performance otherwise when the dynamic model is used several times the overall estimation performance becomes worse 7 conclusion this paper illustrates how feelhippo auv is able to navigate exploiting an fls based dr strategy without using dvl readings but not obstructing cooperation the navigation approach has been tested and validated through data gathered during sea trials undertaken in la spezia italy at the nato sto cmre in july 2018 the presented solution is shown to achieve a mean error of approximately 0 9 m with a maximum error of approximately 2 0 m with respect to a ground truth solution constituted by a dvl based dr strategy with gps fixes before diving and after resurfacing in section 6 it is shown how speed estimates from fls improve a simple model based navigation system see fig 17 fig 18 figs 19 fig 20 and fig 21 indeed a simple dynamic model by virtue of the introduced assumptions assumptions 1 6 obviously cannot fully describe the complex nonlinearities that arise during the motion being too simple a solution future developments will involve testing of the navigation strategy on feelhippo auv during experimental campaigns additionally the authors are planning to integrate the proposed solution into the ukf based navigation filter already developed by them in allotta et al 2016c in fact the presented technique tries to exploit primarily fls measurements whereas model based estimations only possess a complementary role nevertheless the same importance is given to each contribution both from fls and from model but this situation does not accurately describe the reality hence a probabilistic description of the system by means for example of an ukf estimator may outperform the current proposed solution ultimately reliable rotation estimation via fls images is a subject worth further investigation accordingly the obtained auv would be a compact platform capable of navigating with an even more reduced set of on board sensors declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the research leading to these results has been partially supported by the european project eumarinerobots eumr which received funding from the european union s horizon 2020 research and innovation program under grant agreement no 731103 
22214,reliable navigation systems are fundamental for autonomous underwater vehicles auvs to perform complex tasks and missions it is well known that the global positioning system gps cannot be employed in underwater scenarios thus during missions below the sea s surface the real time position is usually obtained with expensive sensors such as the doppler velocity log dvl integrated within a navigation filter such as an extended kalman filter ekf unscented kalman filter ukf or dead reckoning dr strategies the goal of this work is to develop an underwater navigation system that does not rely on a dvl and where linear speed estimations are obtained exploiting data from a forward looking sonar fls or in its absence taking advantage of a dynamic model that presents a reduced set of parameters the proposed solution is validated through the use of navigation data obtained during sea trials undertaken in july 2018 with feelhippo auv at la spezia italy at the nato science and technology organization center for maritime research and experimentation cmre keywords auvs underwater robotics autonomous navigation acoustic odometry sonar 1 introduction today autonomous underwater vehicles auvs are widely employed for many applications in diverse fields and the availability of a precise and reliable navigation system is of utmost importance regardless of the kind of mission the underwater vehicle is required to perform the final result is affected by its overall navigation performance moreover it is well known that the unavailability of the global positioning system gps signal like other electromagnetic signals in the underwater domain barclay 2003 makes the localization and navigation task more difficult the majority of underwater navigation systems are based on either the kalman filter kf kalman 1960 the extended kalman filter ekf bar shalom et al 2004 or the unscented kalman filter ukf allotta et al 2016c costanzi et al 2018 typically employed when non linearities in the dynamic description of the system arise as the simplest solution despite their straightforward philosophy dead reckoning dr strategies have proven satisfyingly reliable if the available sensors are sufficiently accurate generally speaking all require knowledge of the linear speed of the auv which is for the majority of times obtained by means of specialized and ad hoc underwater sensors such as the doppler velocity log dvl in addition absolute underwater position information can be obtained using beacons with two types of system most commonly employed being the long baseline lbl and the ultra short baseline usbl leonard and bahr 2016 conversely as stated in melo and matos 2017 the main disadvantages are the total cost the deployment and recovery time especially for the lbl and a detailed calibration process which is necessary to obtain optimal positioning accuracy especially for the usbl to ease the localization problem static and or dynamic local sensors networks composed of localizing acoustic devices have gained attention yoerger et al 2007 and bahr et al 2009 single beacon localization has been proposed whereby a vehicle usually known as beacon vehicle with good quality positioning information is able to transmit range information acoustically to one or more underwater vehicles as described in tan et al 2014 and webster et al 2013 in addition moving long baseline mlbl systems that are a generalization of the lbl have been suggested here as stated in yan et al 2015 the arrays of transponders are fully mobile and self calibrating thus they do not constrain the operating site to a fixed area contributions can be found for example in curcio et al 2005 and bishop et al 2010 over the last two decades several strategies exploiting optical or acoustic payload to solve localization problems have been proposed in particular simultaneous localization and mapping slam techniques have been successfully applied further information concerning underwater slam can be found in chaves et al 2017 optical sensors e g optical cameras are relatively inexpensive with high resolution information provided at high refresh rates but adverse conditions in the underwater domain are likely to be present for example it is well known that turbid waters turbulence sediment or poor lighting conditions can lead to a limited visibility range usually less than 10 m thus jeopardizing operations with optical devices mallios et al 2014 as a consequence researchers have often relied on acoustic payload sensors such as sonar and more recently forward looking sonar fls considering them a more robust option hurtós et al 2015 acoustic payloads present higher costs and lower resolution than optical ones on the other hand the former are able to penetrate the water even in poor visibility conditions for longer ranges e g fls can reach distances greater than 150 m mallios et al 2014 more information concerning the state of the art in underwater navigation and localization which is beyond the scope of this work can be found in leonard and bahr 2016 and paull et al 2014 the main contribution of the work presented here focuses on promoting the use of fls to aid underwater navigation proposing a solution able to estimate linear speed without exploiting dvl measurements working on fls images a fourier based registration method is employed and to cope with feature poor environments a dynamic model that exploits a reduced set of parameters is used when no linear speed measurement from the acoustic payload is available the results are shown to be comparable with those obtained with a dvl based navigation system the authors are aware that the achieved performance is unlikely to be better with respect to a dvl based navigation system even in the near future indeed the authors wish to point out that even if the proposed solution is shown to work without exploiting any dvl measurement cooperation with the dvl is possible this way more linear speed measurements could be obtained in addition to this using fls to aid navigation could potentially outline other advantages in fact using an augmented set of devices able to provide navigation information represents an intrinsic boost in redundancy preventing failures due for example to underwater sensor denied scenarios such as dvl denied scenarios when proximity to the seafloor or other surfaces takes place miller et al 2010 or when a substantial number of gaseous bubbles is present moreover although bigger auvs enable the use of more complex instrumentation and are able to carry a heavy payload smaller auvs are constrained to limited payload carrying capabilities hence in addition to constituting a valuable research interest multitasking on board sensors represent a solution that offers compactness and avoids the use of some instruments the results of this study were obtained using navigation data gathered during the european robotics league student autonomous underwater vehicles challenge 2018 erl sauc e 2018 competition ferri et al 2015 and ferri et al 2017 held in la spezia italy in july 2018 this involved using feelhippo auv a lightweight vehicle developed by the department of industrial engineering of the university of florence unifi dief during the above mentioned tests feelhippo auv navigated by dr with its standard equipment see allotta et al 2017a b and costanzi et al 2016 and the proposed solution was tested and validated offline some points are worth highlighting first this work focused on post processed data however a testing framework as close as possible to a real online test was adopted in particular all the sensor data have been used as input for the proposed solution with a time synchronization based on the time at which messages were received moreover the validation was performed using the same navigation software present on feelhippo auv second the performed underwater mission was planned to try to simulate a composite scenario where different elementary motions were present turns at right angles sharp turns short transects around 3 0 m medium transects around 16 0 m and longer ones around 30 0 m last the underwater environment was not known a priori both high informative seabed areas and poor ones were present the obtained results are promising and on line underwater tests will be implemented in the near future the remainder of the paper is organized as follows related works in the underwater domain are described in section 2 whereas section 3 is dedicated to preliminaries useful in the development of this work and to the description of the current navigation system present on feelhippo auv section 4 addresses the proposed navigation strategy whereas section 5 focuses on the mechanical design and on the hardware architecture of feelhippo auv section 6 illustrates the conducted sea trials and performance of the proposed navigation solution finally section 7 draws conclusions 2 related works the vast majority of contributions concerning acoustic payload in navigation aiding are focused on constraining the navigation drift of the auv thus particular emphasis has been paid to the use of these devices complementary to a standard navigation sensors set comprising for example a dvl inertial measurement unit imu and fiber optic gyro fog see paull et al 2014 accordingly as stated by durrant whyte and bailey 2006 and li et al 2018 navigation can be adjusted for example by means of self correction using environmental landmarks whereby observations of features or landmarks assumed time invariant and re observation of the landmarks are crucial hidalgo and bräunl 2015 therefore acoustic payload is usually included in a slam framework sonar based slam is approached in two ways depending on whether a set of range and bearing measurements is produced this can be achieved with multibeam echosounders mbes or an acoustic image of the scene is acquired this can be achieved with flss side scan sonars ssss or mechanically scanned imaging sonars msiss ribas et al 2010 a concise overview of the main contributions for navigation purposes is reported here and for further information the interested reader is encouraged to read ribas et al 2010 and valencia and andrade cetto 2018 in walter et al 2008 an fls based slam for performing a ship hull inspection is shown here fls images are related by means of features extracted from different frames conversely the velocity relative to the ship hull is retrieved exploiting a dvl this therefore constitutes a part of the navigation system a similar solution based on sss and re observation of landmarks previously detected to reduce navigation drift is presented in ruiz et al 2004 in johannsson et al 2010 a drift free navigation solution during harbor surveillance and ship hull inspection by means of an fls is proposed where a dvl to measure velocity relative to a surface and a ring laser gyro are present on board another feature based solution is proposed in li et al 2018 where a ship hull inspection is undertaken a slam algorithm that makes use of an fls as the sole perceptual sensor to perform navigation drift correction of a dvl imu based odometry navigation framework is outlined many authors such as hurtós et al 2015 and hurtós et al 2013 have indicated that feature detection by means of acoustic images might be difficult in a generic natural underwater environment feature based techniques present repeatability and discrimination issues due to for example low resolution and illumination changes consequently several researchers have tried to use either features at a region level or the entire image a study by aykin and negahdaripour 2012 describes a technique implemented on fls images able to detect stable and reliable features located at region rather than at pixel level however although the proposed solution is considered able to improve the precision of auv navigation no specific result was outlined in hurtós et al 2015 a mosaicing framework is presented able to create acoustic maps along various vehicle track lines where both translational and rotational 2d motions can be handled however the authors state that the proposed framework is tailored for an offline approach where the trajectory followed by the vehicle is computed a posteriori and integration in an online navigation system is only hypothesized in ferreira et al 2015 a real time mosaicing framework for fls applications is presented here the purpose is to propose an automatic target recognition atr technique in the context of mine detection the fls is used as a sole perceptual sensor and no integration with the navigation filter is proposed in ribas et al 2008 and mallios et al 2014 two ekf are used in parallel dr navigation is performed with the first where a dvl and an attitude and heading reference system ahrs are employed the second makes use of range and bearing data retrieved from an msis and the filter is updated via feature extracted from the environment in the former and via a probabilistic scan matching in the latter in white et al 2010 six slam techniques have been applied to the exploration and mapping of ancient cisterns but the proposed solution is said to be capable of mapping and navigating underwater tunnel systems where it is much easier to retrieve information from the surrounding environment however the open sea navigation problem is not tackled in norgren and skjetne 2018 the authors propose an iceberg mapping method using an auv equipped with an mbe by estimating the position and orientation of the iceberg in particular a top level ekf provides the relative position and orientation between the auv and the iceberg whereas a bottom level estimator is based on the bathymetric distributed particle slam bpslam algorithm among other navigation sensors an upwards looking dvl is considered in the solution in rahman et al 2018 the authors employ data from a stereo camera angular velocity and linear acceleration data from an imu and range data from an msis in this work experimental tests have been conducted in rich environments such as artificial shipwrecks and a submerged bus but no quantitative evaluation of the navigation is given to the authors best knowledge few proposals focused on effectively substituting a dvl in favor of an fls for underwater navigation are present for example in song et al 2018 a method is presented that relies on optical and acoustic images for localization purposes a mixed approach that uses an fls a standard camera or a dr strategy is proposed although the solution is tested using data gathered from experimental tests the navigation performance of the technique is not thoroughly investigated 3 preliminaries and notation first the notation employed in the rest of the work the kinematic and dynamic modelling of an auv the imaging geometry model of an fls and the key concepts of fourier based registration methods are reported after a brief description is given of the current navigation algorithm present on feelhippo auv 3 1 kinematic and dynamic modelling of the auv the pose of the auv in terms of position and attitude is retrieved with respect to a local earth fixed reference frame with axes pointing north east and down ned frame o n x n y n z n whereas the body frame is centered in the center of gravity cg of the vehicle with the forward motion direction represented by the x axis surge and the z axis heave pointing down o b x b y b z b lastly the y axis sway completes a right handed reference frame to describe the kinematic model of the vehicle sname notation is employed fossen et al 1994 see fig 1 the auv is represented with η η 1 η 2 t where η 1 indicates the position of the auv and η 2 its orientation in particular a triplet of euler angles expressed with respect to a fixed frame namely roll ϕ pitch θ and yaw ψ rpy is used moreover the linear and angular velocities of the vehicle with respect to a body fixed reference frame is denoted with ν ν 1 ν 2 t the vector of forces and moments acting on the auv is τ r 6 whereas t r m and u r m with m the number of motors in this case four are a vector that collects the thrusts and the vector of rotational speed of the motors for the sake of clarity the kinematic model of the auv is reported in eq 1 eq 2 1 η η 1 t η 2 t t η 1 x y z t η 2 ϕ θ ψ t ν ν 1 t ν 2 t t ν 1 u v w t ν 2 p q r t 2a η j η ν 2b η 1 η 2 r b n η 2 0 3 3 0 3 3 e 1 η 2 ν 1 ν 2 where r b n represents the rotation matrix between the body and the fixed reference system and e is the euler matrix in addition the forces and moments on the auv and the thrusts carried out by the motors are linked using the linear model 3 τ ν u b t ν u where b is a constant matrix assuming the vehicle and the thrusters are not reconfigurable that depends upon the thruster poses with respect to the cg its expression is reported in eq 4 and eq 5 assuming as already stated that the body frame is centered in the cg 4 b b 1 b 2 with 5 b 1 n m i b b 2 p m i b n m i b where n m i b is the axis of the i th motor expressed in the body frame o b x b y b z b and p m i b is the thruster center of the i th motor with respect to the cg expressed in the body frame according to fossen et al 1994 the dynamic of the auv can be described as 6 m ν c ν ν d ν ν g η τ ν u m is the mass matrix c ν is the centrifugal and coriolis matrix d ν is the damping matrix g η takes into account the effects of gravity and buoyancy and τ ν u describes the map between the vehicle speed ν and the rotational speed of the motors u to the resultant thrust action on the vehicle 3 2 fls imaging model and phase correlation technique the area covered by an fls that insonifies the sea bottom can be described using spherical coordinates r α β where r is the range α is the azimuth angle and β is the elevation angle let us assume a reference frame o f s x f s y f s z f s centered on the fls center with the x axis pointing forward the z axis pointing down and the y axis completing a right handed reference frame the position and orientation of the fls with respect to the o b x b y b z b frame can be represented as follows see eq 7 7 a f s r b f s p fs o 1 where r b f s is the matrix between the fls and the body reference system and p fs is the position of the fls with respect to the cg expressed in the o b x b y b z b frame in the following the uppercase will indicate a 3d point whereas with the lowercase the same 3d point is projected on the image plane the coordinates of a generic 3d point p in the o f s x f s y f s z f s reference system expressed in spherical coordinates are see fig 2 8 p x y z r cos α cos β r sin α cos β r sin β the nonlinear model that projects a 3d point p on the point p belonging to the image plane is 9 p x y r cos α r sin α 1 cos β x y more information can be found in walter 2008 negaharipour 2012 an image in the spatial domain is indicated with the lowercase i x y whereas an image in the fourier domain is expressed with the uppercase i m m an image collected at a certain absolute time t i r is defined as i t i x y or i t i m n in the spatial and the fourier domains respectively where i t i m n f i t i x y and with f is denoted as the fourier transform ft the phase correlation algorithm or its variants which is a fourier based method de castro and morandi 1987 and reddy and chatterji 1996 has been widely used for registration of roto translated optical images over the years such as in ojansivu and heikkila 2007 tzimiropoulos et al 2010 li et al 2007 or eustice et al 2002 in the underwater domain differently its use in fls is less prevalent the key concept is based on the so called fourier shift property in the fourier domain a shift between two functions e g images appears as a linear phase shift given two images i t 1 x y and i t 2 x y with t 1 t 2 let us suppose that i t 2 x y is a translated and rotated replica of i t 1 x y 10 i t 1 x y i t 2 x cos θ 0 y sin θ 0 s x x sin θ 0 y cos θ 0 s y where s x r and s y r are the translation which can be put together in s s x s y r 2 and θ 0 r is the rotation angle their ft is 11 i t 1 m n e j 2 π m s x n s y i t 2 m cos θ 0 n sin θ 0 m sin θ 0 n cos θ 0 when pure translations are considered θ 0 0 see eq 12 eq 11 becomes eq 13 12 i t 1 x y i t 2 x s x y s y 13 i t 1 m n e j 2 π m s x n s y i t 2 m n in this case from eq 13 the normalized cross power spectrum is 14 c m n i t 1 m n i t 2 m n i t 1 m n i t 2 m n e j 2 π m s x n s y where denotes the complex conjugate it is easy to note that the inverse ft of eq 14 reported in eq 15 is a 2d dirac function centered on s and its location can be found with eq 16 15 c x y f 1 c m n 16 s s x s y arg max x y c x y in conclusion by solving eq 16 the location of the peak of the cross power spectrum in eq 14 can be obtained and therefore the translation s between i t 1 x y and i t 2 x y can be found see eq 12 in the rest of the paper because of the digital nature of the images involved the discrete case of the ft is employed more information regarding phase correlation applied to discrete cases with subpixel translation estimation can be found in foroosh et al 2002 3 3 current navigation system a detailed treatment of the current navigation system of feelhippo auv is beyond the goal of this work however a brief description will be provided in the following in order to retrieve an accurate estimate of the pose of the vehicle with respect to a local ned frame feelhippo auv employs a parallel structure where attitude is independently estimated from position and it constitutes an input that is fed to the position estimation filter see fig 3 in particular concerning attitude the filter structure has been originally proposed in mahony et al 2008 and then suitably modified by the authors in allotta et al 2016a costanzi et al 2016 whose principle aim is to integrate angular rate changes measured by gyroscopes and correct the obtained values exploiting accelerometers and magnetometers with regard to position estimation feelhippo auv is able to navigate exploiting a dr strategy and additionally it can resort to an ukf based estimator where a mixed kinematic dynamic vehicle model is proposed taking into account longitudinal dynamics only a reduced computational burden is present on the processing unit a complete treatment is detailed in allotta et al 2016c and allotta et al 2017a b 4 proposed solution first the main assumptions on which this work is based are outlined second how to estimate the linear speed of the auv is broadly treated last how the proposed solution has been integrated in the current navigation framework is described assumption 1 most of the dynamics of the auv take place in the longitudinal direction in fact even if feelhippo auv does not properly possess a torpedo shape it can be easily noted see fig 4 that longitudinal direction is still that of minimal resistance in order to reduce battery consumption feelhippo auv mainly performs missions along the longitudinal direction assumption 2 because the body reference frame of feelhippo auv is aligned with the vehicle principal axes of inertia the mass matrix can be considered as diagonal assumption 3 the maximum vehicle speed is not too high approximately 1 m s see table 2 thus the coupling between the dissipative effects can be neglected leading to a diagonal damping matrix in addition only a quadratic damping term has been taken into account assumption 4 gravitational centripetal and coriolis effects have been neglected and added masses are not considered sea currents are hypothesized to be small assumptions 1 4 are similar to those made by the authors in allotta et al 2016c therefore the classic dynamic description of fossen et al 1994 and reported in eq 6 can be simplified for the longitudinal motion with eq 17 17 m ν 1 x m u τ 1 x ν u f 1 ν f 1 ν obtained from the dynamic model in fossen et al 1994 can be further simplified with the aim of reducing the number of parameters as follows 18 f 1 ν a f c u ρ ν 1 x 2 sgn ν 1 x 2 where m is the mass of the vehicle ρ is the density of the water a f is the frontal area of the vehicle and c u is the drag along the surge axis generally the drag effect depends upon among other things the speed of the auv relative to the viscous fluid in light of assumption 4 eq 18 where just the velocity of the vehicle is taken into account can be considered a good approximation with regard to added masses acceleration terms are usually numerically negligible underwater missions for the most part are composed of phases within which the vehicle moves forward at an approximately constant speed as a consequence the dry mass m can be considered a good approximation assumption 5 roll and pitch motion cannot be actively controlled see section 5 1 but their dynamics are controlled by hydrostatic stability their variations are thus limited and can be neglected assumption 6 the four quadrant motor characteristic is approximated with 19 t i ν u i sgn u i k u i 2 k u i g sgn u i v a i p where i refers to the i t h motor and 20 g x 0 f o r x 0 x f o r 0 x u i p u i p f o r x u i p and where p is the propeller pitch k is a construction parameter that relates motor thrust and propeller speed at bollard conditions i e when the advance speed v a i 0 see eq 22 and v a i which is the speed of the i t h motor can be expressed as a function of the speed vector ν 21 v a i n m i b t ν 1 ν 2 p m i b 0 b 22 k t ν u u 2 v a i 0 assumption 6 has already been exploited by the authors in allotta et al 2016b and more information can be found in pivano et al 2009 and carlton 2012 assumption 7 the fls is positioned at a fixed pose with respect to the vehicle s frame in addition to this the fls which is mounted on the bow of the vehicle is positioned approximately parallel with respect to the sea bottom that is supposed not to change abruptly in order to insonify wider areas assumption 8 the elevation angle around 7 10 for most typical fls devices can be considered small assumptions 7 and 8 make it possible to take advantage of a 2d approximated model instead of a complete non linear projection model see eq 9 in other words the projection p is substituted with the orthogonal projection p ˆ as reported in fig 2 thus eq 9 becomes eq 23 23 p ˆ 1 0 0 0 1 0 x y z a similar proposal can be found in ferreira et al 2014 ferreira et al 2015 hurtós et al 2015 and has already been exploited by the authors in franchi et al 2018 in light of the proposed imaging model and neglecting roll and pitch variations see assumption 5 it can be seen that a 3 parameter euclidean transformation plane roto translation puts two different fls views of the same object in relation a demonstration can be found for example here walter 2008 hence fourier based methods that are known to manage up to similarity transformations de castro and morandi 1987 can be employed 4 1 speed estimation of the vehicle the navigation framework depicted in fig 3 is modified to obtain the solution shown in fig 5 therefore it is clear that the core aim of this paper is to show how to estimate the auv speed in order to mimic dvl measurements to this end the proposed solution utilizes two different approaches in fact a generic underwater scenario can present both areas where the sea bottom contains a high informative content such as wrecks or debris and regions where the sea floor is invariable and unaltered briefly the case of unavailability of linear speed measurements from the fls must be handled therefore to address different situations a dynamic model that exploits a reduced set of parameters is employed when no linear speed measurement from the fls is available this complementarity of the two solutions is shown to achieve promising results 4 1 1 fls based speed estimation the key process through which a pair of overlapped images obtained from different viewpoints namely two images that insonify a common region are related each other is called registration or more specifically pairwise registration in the last decade researchers have tried to use feature detection methods both at pixel and region levels but it is obvious that the presence of stable and conspicuous features is necessary although computationally heavy a phase correlation method see section 3 2 is the most suitable to face mutable underwater scenarios anyway to make this method work it is worth noting that this consideration is not limited to phase correlation it is necessary for an overlap between the images nevertheless the magnitude of the minimum overlapping area cannot be known a priori indeed it can depend upon the informative content of the insonified area for example an overlapping close to 100 can produce incorrect results if the sea bottom in uninformative on the other hand an overlap of about 50 can be sufficient if a rich environment is present for fls application remarkable contributions can be found in hurtós et al 2015 and hurtós et al 2013 here the proposed method is the core of the fls based linear speed estimation and it can be divided into three steps in the first step raw fls images are filtered and rotated to be pairwise aligned section 4 1 1 1 in the second the linear translation between two subsequent fls images is retrieved section 4 1 1 2 in the third step the linear speed estimation is computed section 4 1 1 3 4 1 1 1 pre filtering and alignment for each step two subsequent raw fls images e g i t 1 and i t 2 are collected together with their absolute acquisition times e g t 1 and t 2 the fls is a device that intrinsically operates with polar variables namely range r and bearing angle α in fig 2 but when the raw acoustic image is created it is usually represented in the cartesian space therefore a fan shape clearly visible in fig 6 arises this particular fan shaped image presents an abrupt transition between the actual image content inside the fan and the background outside the fan thus when the ft is applied to all the image content frequency components not related to the real image content are inevitably introduced to overcome this issue the fan shaped contour of fls images is typically smoothed performing a windowing operation see the right fls image in fig 6 before applying the ft more information about window functions in the fourier domain is presented for example in harris 1978 smoothing the raw fls image implies a slight loss in the image content see the right fls image in fig 6 however this seems not to have negatively affected the speed estimation method from eq 10 it can be noted that rotations and translations if both present are coupled generally it is well known that when quantities are coupled it might be difficult to estimate them separately therefore because of the importance of rotation evaluation the authors have decided to retrieve them not working on images but relying on specialized sensors and algorithms that proposed by the authors in costanzi et al 2016 briefly introduced in section 3 3 and visible in fig 5 has therefore been used by knowing the location of the fls p fs in eq 7 the rotation center position of feelhippo auv and the output of the attitude estimation filter present in fig 5 i t 1 can be rotated to be aligned with i t 2 it is worth highlighting that because the acoustic insonification of a scene can produce different results according to the relative attitude between the source the fls and the target the proposed method may lead to registration issues when rotations are not small conversely given the fls acquisition rate usually more than 1 hz and the relative slow dynamics of the underwater vehicle this phenomenon can usually be neglected 4 1 1 2 phase correlation for linear translation the phase correlation technique is performed and the translation s see eq 16 between the two subsequent fls images i t 1 and i t 2 is computed from the peak on the normalized cross power spectrum eq 14 eq 15 and eq 16 the typical noise present in fls images leads to a cross power spectrum c x y with several peaks in the spatial domain and to overcome this issue filtering operations are necessary to c m n before applying eq 15 in this work with the aim of maintaining the computational burden as low as possible a non adaptive low pass lp butterworth filter a commonly used filter in image processing defined in eq 24 has been tested and further references can be found in weeks 1996 the final tuning parameters have been obtained after testing different combinations a fourth order butterworth filter with a cut off frequency of 110 0 pixels the image resolution is 894 477 pixels has been found to be the best solution in terms of overall behavior because the choice of the cut off frequency as well as the filter order is not adaptive its performance might have issues when different kinds of sea bottom e g sandy rocky or when feature rich environments are present are encountered on the other hand the achieved results seem not to be significantly affected by this fact see section 6 at the same time keeping the complexity low 24 h m n 1 1 d m n d 0 2 l where h m n is the transfer function d 0 is the cut off frequency l is the filter order and d m n m m 2 2 n n 2 2 1 2 where m is the number of columns and n is the number of rows regardless of the specific filtering approach the amplitude of the normalized cross power spectrum gives a measure of the goodness of the obtained translation and a binary acceptance law based on the value of r in eq 25 is performed in particular if r is more than 0 97 the registration is deemed correct otherwise it is discarded 25 p max c x y r 1 c x y p where c x y is the average value of the normalized cross power spectrum and p is its actual peak in fig 7 and fig 8 the normalized cross power spectrum c x y is shown both without and with the abovementioned lp filtering action to c m n respectively the presence of the lp filter leads to a surface where the peak is clearly visible and thus simpler to detect see fig 8 4 1 1 3 body speed estimation given the exact absolute arrival time of the two fls images t 1 and t 2 and the retrieved translation s see eq 15 the latter is mapped from pixel to meters or another similar physical quantity by taking advantage of the following linear transformation 26 d r m a x d h where d d x d y r 2 is a distance in pixel d d x d y r 2 is the same physical quantity expressed in meters r m a x is the maximum range delivered by the fls and h is the maximum fls range expressed as number of rows pixel in the fls image see fig 9 the conversion factor r m a x h in eq 26 is true for displacement along the rows of the image but it is an approximation for those along the columns exploiting assumption 1 most of feelhippo auv s motion takes place along the surge axis and given the placement of the fls see fig 15 the majority of the displacements takes place along the row of the images and the approximation can be sufficient at this point the body speed estimation can be easily computed 27 ν 1 s t 2 t 1 it should be stressed that in light of the proposed method section 3 2 only the speed in the plane x b y b can be obtained nevertheless the speed along the z b axis can be estimated using the ds before using the retrieved speed as input for the navigation filter see fig 5 its value is checked with the maximum performance that feelhippo auv is able to carry out in particular if the longitudinal speed is more than 1 0 m s and the lateral speed exceeds 0 2 m s see table 2 the retrieved velocity is discarded the oldest image namely i t 1 is deleted and a new one is acquired a complete overview of the proposed method is depicted in fig 10 4 1 2 model based speed estimation the identification of the most important hydrodynamic parameters is a crucial step in developing a reliable model based navigation system two kinds of identification tests have been undertaken first a test campaign to characterize the propulsion system second a test campaign to characterize the longitudinal drag with regard to the propulsion model presented in eq 19 new tests with the aim of obtaining a complete characterization of feelhippo auv propulsion system bluerobotics t200 blu 2019 see section 5 1 have been conducted and the experimental work presented by the authors in allotta et al 2017a b has been improved in particular new tests have been performed with different voltage supplies to gain more insight into the propulsion system to this end a new test rig has been designed and developed see fig 11 furthermore taking into account dead zones between the command drive and the motor thrust the propulsion model presented in eq 19 and proposed in allotta et al 2017a b has been enhanced and the final result is shown in eq 29 a quantitative evaluation of the analytical expression in eq 19 requires the knowledge of the propeller pitch p which is a construction parameter usually provided by the manufacturer and of the coefficient k this relates motor thrust and propeller speed at bollard conditions i e when the advance speed v a i 0 see eq 22 bollard thrust tests have been performed in a testing pool and the thrust propeller rotational speed voltage supply triad has been measured in several working conditions voltage supplies have been increased at discrete steps 12 0 14 0 16 0 22 0 and 25 2 v and for each value the thrust has been measured varying the propeller rotational speed because of the asymmetry of the bluerobotics t200 propeller both forward first quadrant motor operation and backward third quadrant motor operation tests have been conducted the complete results are presented in fig 12 and fig 13 where the bollard coefficients are 0 0128 n2 for the forward motion and for the backward one 0 008753 n2 respectively in the first case the coefficient of determination r 2 defined in eq 28 is 0 9922 whereas in the second it is 0 9639 28 r 2 1 s s res s s tot where s s res is the sum of squares of residuals and s s tot is the total sum of squares it is worth highlighting how the exerted thrust does not depend on the voltage supply but is uniquely influenced by the rotational speed see figs 12 and 13 this is not surprising as the bollard coefficient is only affected by the propeller and nozzle geometry given a certain rotational speed the results presented in fig 13 backward motion are slightly worse because of the compression localized on the load cell leading to small skids this is due to the connection clearance between the load cell and the test rig bar which adversely affects the measurements see fig 11 the experimental test rig set up was composed of a tas510 load cell by ht sensor technology co ltd htt 2019 and a cf350 fft spectrum analyzer by ono sokki co ltd ono 2019 for precise rotational speed measurements for the propeller to amplify the thrust exerted by the motors mechanically a leverage system composed of standard aluminum profiles was designed more specifically the thrust measurement is obtained as the result of the ratio between the thruster arm and the cell arm and their lengths can be easily regulated by a screw a schematic representation is visible in fig 11b currently during underwater operations feelhippo auv is not equipped with a sensor able to measure the actual propeller rotational speed such as hall effect based speed sensors see section 5 1 only its reference value is available conversely exploiting assumption 4 and noting that the propulsion system normally presents fast dynamics with respect to the relatively slow dynamics of the vehicle counterpart the committed error can be considered a further approximation with respect to the one already introduced by the four quadrant motor characteristic in eq 19 and eq 29 such that even if it represents a satisfying description it inevitably introduces unknown model errors briefly reference values for the rotational speed below a certain threshold are not actually followed where the drive command signal is not sufficient to produce a rotational movement for the thruster in fig 14 it can be cleared noted that the minimum rotational speed that can be actually obtained depends on the voltage supply indeed given a certain command drive logic the lower the supply voltage the less the output voltage furthermore the resulting behavior is clearly not affected by the direction of motion to prove this the slopes of the lines depicted in fig 14 are almost the same in absolute value at 0 5974 and 0 5866 this is not surprising as it is known that a linear relation between rotational speed and voltage supply holds for a direct current dc motor the point to highlight from the above treatment is that in case of the unavailability of direct speed measurements the coupling between thruster and command driver needs to be investigated in conclusion eq 19 becomes eq 29 29 t i ν u ˆ i d u ˆ v sgn u ˆ i k u ˆ i 2 k u ˆ i g sgn u ˆ i v a i p where u ˆ is the reference value for the rotational speed of the i t h motor v is the voltage supply and d x is defined in eq 30 30 d x v 0 for x u v 0 for x u v 1 otherwise where u backward motion and u forward motion are the boundary values for the dead zone that depend upon the voltage supply level if the reference value for the rotational speed falls within this interval the exerted thrust is zero for the longitudinal drag the authors implemented a standard least squares ls estimation technique applied to data longitudinal thrust and longitudinal speed gathered under steady state conditions when the auv moves forward at approximately constant speed a complete overview of the procedure developed by unifi dief even if applied to another auv can be found in allotta et al 2018 a list of the identified main hydrodynamic parameters is reported in table 1 where v is the voltage supply feelhippo auv description first a brief overview of the mechanical design of feelhippo auv and a description of its hardware is reported 5 1 mechanical design and hardware description feelhippo auv visible in fig 15 has been designed and developed both for the participation in student robotics competitions e g sauc e 2013 and erl sauc e in 2018 and for undertaking research topics several autonomous underwater navigation missions principally in shallow waters have been performed since 2013 the main features of the vehicle are reduced dimensions and weight making it a compact and reliable underwater platform a plexiglass hull with an internal diameter of 200 mm and 5 mm thickness constitutes the central body of the vehicle where the non watertight hardware and electronics are housed the connection between the central part of the vehicle and the two outermost domes is provided by two metal flanges and two o rings that guarantee a watertight connection in addition six metal bars act as tie rods increasing the overall stiffness results four thrusters arranged in a vectored configuration two on the stern and one each on both lateral sides tilted at 45 are connected to feelhippo auv by means of custom made plastic parts except for the roll and pitch motion that are limited by hydrostatic stability the rest of the degrees of freedom dofs of the vehicle translational motion and yaw can be controlled a list of all the electronic devices and sensor sets with which feelhippo auv is equipped is listed as follows intel i 7 mobile cpu used for onboard processing u blox 7p precision gps orientus advanced navigation ahrs composed of triaxial accelerometers gyroscopes and magnetometers together with a kvh dsp 1760 single axis high precision fog for attitude estimation of the vehicle nortek dvl1000 dvl measuring linear velocity and acting as ds the device is located on the bottom of the vehicle close to the cg an evologics s2cr 18 34 acoustic mode one teledyne blueview m900 2d fls mounted on the bow of the vehicle one wifi access point ubiquiti bullet m2 for fast high band shortrange communication on the sea s surface one radio modem 868 by rf design employed to send short messages from high distances on the sea s surface one bottom looking elp 720p mini ip camera one microsoft lifecam cinema forward looking camera which can be used for the tele operated guide two lateral elp 1080p mini ip cameras 6 navigation results the results reported in this section refer to the navigation data retrieved during a mission performed at the erl sauc e competition held in la spezia italy in july 2018 the mission was executed at the desired depth of 2 m with a reference longitudinal cruise speed of 0 5 m s lasting 960 0 s and covering approximately 220 0 m in addition the fls range was set to 10 0 m water current measurements were not available during the day of the trial but on the other hand the test site described here is a small basin at the nato sto cmre where water currents are usually of low intensity and thus negligible the area of interest was a rectangle with the approximate dimensions 36 20 m the underwater scenario presented both areas where the sea bottom contained a high informative content two underwater structures each approximately 2 2 3 2 1 2 m composed of underwater plastic pipes were positioned on the sea bottom see fig 16 with some metallic chains also present and regions where the sea floor was basically unaltered and flat the vehicle relied on the sensors and the payload described in section 5 1 for the extent of the mission and it performed the required navigation tasks exploiting a dvl based dr strategy with the navigation filter structure shown in fig 3 moreover gps fixes were acquired before diving and after resurfacing the dvl based underwater navigation strategy as well as the gps fixes were used as ground truth to validate the proposed fls based solution it is useful to highlight that although the used ground truth does not provide an absolute positioning system except from gps fixes before diving and after surfacing the navigation appears reliable because of the small error after resurfacing around 3 5 m see figs 17 19f where the relative value is less than 2 after about 16 min of autonomous navigation to assess the goodness of the proposed solution the speed estimation technique reported in section 4 and explained in fig 5 was thus tested and the results can be found in fig 17 here it should be stressed that the results were obtained in post processing on the other hand as explained in section 1 a testing framework as close as possible to a real online test was adopted furthermore with the aim of evaluating the impact of fls based speed measurements a simulation is presented in fig 18 where feelhippo auv navigates solely exploiting the model described in section 4 1 2 for the sake of completeness another simulation that exploits the model in section 4 1 2 without the introduced dead zone was performed the goal was to highlight that in case of unavailability of direct rotational speed measurements for the thrusters the relationship between the reference command value provided by the driver and the produced thrust needs to be further investigated the final results are presented in fig 19 the ground truth navigation was compared with the proposed solution and the results are presented in fig 20 and fig 21 where it can be easily noted how fls based speed measurements improve the overall performance the employed metrics are defined in eq 31 and eq 32 31 e k η 1 g t k η 1 t s k 32 e k i 0 i k e i k where e k r denotes the navigation error at the instant k n η 1 g t k and η 1 t s k indicate the position of the auv at instant k with respect to a o n x n y n z n ned frame according to the ground truth and to the current tested solution respectively and e k r is the mean of all the computed errors e k to gain greater insights into the proposed results further analysis is presented a comparison among the model based estimated speed the fls based one and dvl readings is shown in fig 22 because most of the vehicle dynamics take place on the surge axis the reported speeds are those occurring along this axis the figure depicts what happens for the extent of the underwater mission it is worth noting that for the first approximately 100 s feelhippo auv is on the surface thus only dvl readings are reported in addition for what concerns fls based speed estimations the obtained results due to erroneous peak detection exceeded the maximum speed of the vehicle see table 2 16 times over approximately 900 registrations around 1 8 thus in light of the speed check in fig 10 these estimations have not been employed by the navigation filter from fig 22 it is not easy to understand the advantages and disadvantages of the employed speed estimation methods therefore a further comparison is depicted in fig 23 to this end two straight transects and two turns where fls based speed estimations are almost able to cover the full duration of each operation have been considered turns on the second and the seventeenth way point wp and two straight transects the first from fourth to fifth wp and the second from eighth to ninth wp see fig 24 b for further information almost able to cover means that fls based estimations are continuously present for almost all the extent of the considered operation for each operation two simulations were compared one with the model based speed estimations only and another with fls based speed estimations only it is worth noting that the plotted results comparing speeds in the same way are delivered to the navigation filter in particular model based speed estimations have the same frequency as the navigation filter whereas those obtained with the fls in the best case scenario rich sea bottom have a frequency equal to the refresh rate of the raw fls images moreover until the arrival of the next fls image the speed is maintained at the previous value by observing fig 23 it can be noted that fls based speed estimation works well both during turns and when the vehicle moves forward moreover the model based solution performs worse when the vehicle does not move at approximately constant speed this is not surprising recalling assumption 4 added masses are neglected and moreover because dead zone arises at low rotational speed its nonlinear contributions are more affected here finally how the underwater scenario affects fls based speed estimations is presented in particular it can be easily understood that in the first part of the mission the error remains bounded to values below 1 m here the speed from the fls is present most of the time due to the pier basin inside the nato sto cmre as noted in fig 24b indeed the pier makes the fls images a rich source of information after because of the presence of less informative sea bottom areas the error grows due to several model based speed estimations in addition when feelhippo auv is close to the two underwater structures the error is small again and comparable with that identified in the first part of the mission this can be understood by observing the location of the two underwater structures in fig 24b and the corresponding navigation error see the rectangle 0 m 10 m east and 25 m 20 m north in fig 24a in conclusion if the sea bottom is reach and fls based speed estimation can be performed the obtained results present good performance otherwise when the dynamic model is used several times the overall estimation performance becomes worse 7 conclusion this paper illustrates how feelhippo auv is able to navigate exploiting an fls based dr strategy without using dvl readings but not obstructing cooperation the navigation approach has been tested and validated through data gathered during sea trials undertaken in la spezia italy at the nato sto cmre in july 2018 the presented solution is shown to achieve a mean error of approximately 0 9 m with a maximum error of approximately 2 0 m with respect to a ground truth solution constituted by a dvl based dr strategy with gps fixes before diving and after resurfacing in section 6 it is shown how speed estimates from fls improve a simple model based navigation system see fig 17 fig 18 figs 19 fig 20 and fig 21 indeed a simple dynamic model by virtue of the introduced assumptions assumptions 1 6 obviously cannot fully describe the complex nonlinearities that arise during the motion being too simple a solution future developments will involve testing of the navigation strategy on feelhippo auv during experimental campaigns additionally the authors are planning to integrate the proposed solution into the ukf based navigation filter already developed by them in allotta et al 2016c in fact the presented technique tries to exploit primarily fls measurements whereas model based estimations only possess a complementary role nevertheless the same importance is given to each contribution both from fls and from model but this situation does not accurately describe the reality hence a probabilistic description of the system by means for example of an ukf estimator may outperform the current proposed solution ultimately reliable rotation estimation via fls images is a subject worth further investigation accordingly the obtained auv would be a compact platform capable of navigating with an even more reduced set of on board sensors declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the research leading to these results has been partially supported by the european project eumarinerobots eumr which received funding from the european union s horizon 2020 research and innovation program under grant agreement no 731103 
