index,text
22815,hydrodynamic improvement of wave energy converter wec s performance tends to reach a bottleneck in that it becomes difficult to further jump over the present low efficiency stage instead of focusing on conventional geometry or layout optimization of wecs this study investigates an alternative way to overcome the efficiency challenge inspired by a parabolic reflector that can reflect sound towards a focal point this study explores the concept of breakwater with parabolic openings to converge propagating waves toward a focus position the wave energy harvest can be increased when a buoy type wec is set at the focus position a 3d numerical wave tank based on the boundary element method is developed to investigate the wave field around this parabolic breakwater it is confirmed that reflected waves from the parabolic opening of the breakwater can travel towards a fixed focus position the maximum wave height of the full wave field appears at a location half or one wave length away from the vertex of the parabolic opening for a specified wave environment the wave height at the focus position can reach over four times the incident wave height indicating wave energy multiplication effects of the neighbouring openings distance on the wave field are also investigated as this distance increases the maximum wave height at the focus position decreases accordingly further the wave field around a parabolic breakwater with its focus inside or outside the parabolic opening area is discussed it is recommended to design the breakwater with its focus position located inside the parabolic opening area finally a truncated circular cylinder as a simplified buoy type wec is placed at the focus position of each parabolic opening in front of the breakwater compared with the conventional design the heave response of the buoy in front of the parabolic breakwater can be amplified by about three times keywords breakwater wave energy fluid structure interaction floating body bem 1 introduction since the first oil crisis in 1974 serious scientific attempts have been made to develop renewable energy techniques including wind solar and ocean energy vicinanza et al 2014 as a largely untapped ocean energy resource the wave energy characterised by inexhaustibility predictability and high power density has attracted the renewable energy developers for several decades pecher and kofoed 2017 until now about one thousand wave energy converter wec inventions have been patented mustapa et al 2017 with over two hundred reaching the model testing stage hayward et al 2012 however the present commercialization of wecs is still restricted by two important factors i e the high cost and low energy conversion efficiency compared to some other renewable energy technologies to help reduce the manufacturing construction and installation costs some studies have suggested embedding wecs in coastal structures or offshore wind energy facilities thereby leveraging cost sharing benefits rather than deploying standalone wec devices vicinanza et al 2014 astariz and iglesias 2015 prez collazo et al 2015 from the coastal engineering background some recent studies suggest that the integration of wecs into breakwater can be a promising solution to address both the challenges of cost and efficiency as comprehensively reviewed by mustapa et al 2017 beneficial effects of the wec breakwater integration are supported by the fact that both facilities work naturally with similar effects the breakwater works by dissipating incident waves or reflecting them back to sea mccartney 1985 while the wec takes advantage of wave energy for power generation such an integration of wecs and breakwater is expected to reduce the construction cost through cost sharing and help improve the efficiency through a wave amplitude magnification in front of the breakwater after wave reflection at present typical concepts of this integration can be roughly categorized into the overtopping ot oscillating water collumn owc and oscillating buoy ob wec breakwaters kofoed 2002 in his thesis conduced hydraulic model tests for breakwater structures with single or multi level reservoirs installed on the top as a representive study of the ot wec breakwater vicinanza et al 2014 and contestabile et al 2017 introduced an ot wec breakwater named by obrec with a reservoir located in front of the rubble mound breakwater for wave overtopping capture in the second category a number of owc wec breakwaters have been practically designed and deployed at sakata port takahashi et al 1992 pico in portugal brito melo et al 2008 isle of islay scotland whittaker et al 2004 south african coast joubert 2013 mutriku port in spain ortubia et al 2009 and civitavecchia in italy arena et al 2013 the owc wec breakwater concept was also widely studied in laboratory for example he et al 2013 2017 investigated a floating box type breakwater with owc wec chambers elhanafi et al 2017 2018 experimentally studied an offshore floating moored owc device with single or dual chamber systems respectively lopez et al lpez et al 2014 numerically studied the performance improvement of the owc wec with damping effects ning et al 2015 2016a and wang et al 2018 numerically and experimentally studied the hydrodynamic performance of land based owc wecs howe and nader 2017 experimentally investigated the performance of an owc wec in front of a bottom mounted breakwater xu and huang 2018 studied the integration of owc wecs into a pile breakwater with each pile equipped with a power take off pto device in the third category mciver and evans 1988 first proposed the idea of adding reflecting harbour walls to improve the performance of wave energy devices mavrakos et al 2004 considered an array of cylindrical wecs heaving in front of a vertical breakwater michailides and angelides 2012 performed hydroelastic analyses on a flexible floating breakwater used for both shore protection and wave energy production schay et al 2013 numerically studied the hydrodynamic performance of a heaving point absorber near a fixed vertical wall zanuttigh and angelelli 2013 conducted experiments on a combined installation for wave energy production and coastal defence zheng and zhang 2015 2016 presented an analytical model to predict the 3d wave diffraction and radiation of a single floating cylinder located in front of a vertical wall at a finite water depth ning et al 2016b and zhao and ning 2018 considered the integration of the ob wecs into a pile restrained floating breakwater ning et al 2018 and zhao et al 2019 further studied an array of ob wecs attached to a fixed pontoon notwithstanding the integration of wecs with breakwaters as described above current wec designs are still restricted by the energy conversion efficiency for practical applications a large proportion of relevant research has attenpted to improve the efficiency of wecs through an optimization of the device geometry goggins and finnegan 2014 or spatial layout child 2011 kara 2016 and many have produced favourable results however it is still inevitable that these types of efficiency improvement have a ceiling limit taking ob wecs for example it is not easy to further gain a dramatic leap for example 10 of the efficiency solely through geometry optimization based on the current stage of development mccormick 2007 from a different perspective some pioneering studies have concentrated their effort on increasing the energy density of waves by confining wave energy to a focal area for example mehlum and stamnes 1980 and stamnes 1986 introduced a zone plate lens composed of submerged trapezoidal elements each element had a slope which changed the direction of wave propagation based on the wave refraction principle so that incident water waves can be converged at a certain focal area ertekin and monopolis 1985 studied the increase in energy density of shallow water waves at a given location with a parabolic step change in water depth they observed wave amplification up to eight times in their experiments the feasibility of using a parabolic wall as a reflector was also tested along with small scale experiments yang and ertekin 1991 further used the 3d boundary element method bem to predict the wave amplitude amplification at the focal point of the parabolic step it was demonstrated that the energy density of waves increases not only at the focal point but also at a series of locations along the parabolic step discontinuity van der wiel et al van der wiel et al 2016 investigated a model with a circular shoal to refract shallow water waves to a focal area and a parabolic structure on the shoal to further reflect waves to the focal area numerical studies were carried out for 5 5 wecs in the front of the parabolic structure in this study we focus our investigation on the breakwater part of the wec breakwater as demonstrated by some existing applications a properly optimised breakwater can help increase the energy harvest one example is the stellenbosch wec as a land based breakwater with owc wecs retief et al 1984 the breakwater has two 160 m long arms arranged in a v shape to guide incoming waves to the air turbine mounted at the intersection of two arms another example is the mutriku owc wec that is installed on a curved breakwater section tease et al 2007 furthermore the ot wec wavecat uses two hulls to form a wedge in the plan view so that wave energy can be converged to the hinged hull sterns fernandez et al 2012 this study focused on a special concept of breakwaters with parabolic openings hereafter called parabolic breakwater for convenience the concept is inspired by the parabolic reflector that can be used to collect energy from a distant source of light sound or radio waves according to the principle of reflection the parabolic reflector can converge an incoming wave travelling parallel to the axis toward the focus similarly for water waves it is expected that the propagating waves during certain conditions can converge at the focus of the parabolic opening of the breakwater where an ob wec can be placed at the focus position to maximise the energy capture efficiency the concepts of ob wecs integrated into conventional plane and the proposed parabolic breakwaters are illustrated in fig 1 a and b respectively fig 1c shows an example of 3d design sketch for this novel parabolic breakwater concept it is feasible that this parabolic design can also be applied in floating breakwaters ji et al 2018 the purpose of this study is to investigate wave field characteristics around this type of parabolic breakwater and hydrodynamic properties of an ob wec installed on the breakwater it should be mentioned that water waves have specific features compared with light waves a perpendicularly incident light wave has an extremely short wavelength so that its energy can always be converged at the focus of a parabolic reflector the wavelength of water waves is usually comparable to the focal length of the parabolic breakwater as a result of the interaction of incident and reflected waves the maximum wave height does not always manifest at the focus position thus this study will first investigate quantitative details of water wave fields around parabolic breakwaters a 3d numerical wave flume based on boundary element method bem is developed wave fields around the parabolic breakwater with different geometric parameters are simulated corresponding to different incident waves further the parabolic breakwater with a buoy type wec installed is studied aiming to demonstrate effectiveness of this parabolic breakwater concept on increasing the energy harvest this paper is structured as follows section 2 gives the mathematical description of the problem and associated numerical techniques section 3 presents results and discussions for a parametric study conclusions are reported in section 4 2 mathematical formulae as a preliminary concept examination a near shore bottom mounted breakwater is considered the breakwater is assumed to be parallel with a straight coastline so that incident waves can be considered to propagate perpendicularly towards the structure for convenience the breakwater is assumed to be infinitely long with an array of identical parabolic openings uniformly distributed on its seaward side each parabolic opening has its symmetry axis parallel to the propagation direction of incident waves a cylindrical ob wec with one degree of freedom dof in the vertical direction i e only with heave mode is deployed on the symmetry axis of each parabolic opening due to the geometric symmetry the whole breakwater can be considered as the combination of identical breakwater units with a parabolic opening the wave behaviour in front of each opening is identical so that the hydrodynamic model of ob wecs in these openings can be equivalently considered as that of an individual ob wec in a wave flume with a parabolic end fig 2 a and b shows the top and side views of the physical model respectively a right handed cartesian coordinate system o x y z is introduced in fig 2 the origin o is defined on the still water free surface at the intersection of the flume s centre axis and the tangential plane of the breakwater s seaward side the x axis points perpendicularly into the breakwater and z axis points vertically upward the ob wec is rigid its heave motion is determined by newton s second law as 1 m s t c s t f fk t f s t f damp t f pto t where m is the mass of the ob wec c is the restoring coefficient f fk denotes froude krylov fk force f s is the scattering wave force f damp is the damping force from the fluid f pto is the damping force associated with the power take off system t is the time variable and s s and s represent the vertical displacement velocity and acceleration of the floating body respectively in this study f damp and f pto which correspond to the damping dissipation from the fluid and the pto system are neglected this is in order to highlight the increase of total energy amount as a result of the wave focusing the fk force f fk represents the force introduced by the dynamic pressure of undisturbed incident waves while the scattering wave force f s is the force caused by disturbed waves due to the existence and oscillation of the buoy both forces can be calculated using the potential flow theory based on the potential flow theory the velocity potential φ whose gradient is the fluid velocity can be introduced by assuming the fluid to be inviscid incompressible and flow irrotational the velocity potential can be split in two parts i e the incident potential φ i which is known from the definition of the incident wave field and the remaining scattering potential φ the fk force is associated with the incident potential while the scattering force can be obtained from the scattering potential the value of f fk can be obtained through an integration of the dynamic pressure p i of incident waves over the mean wet surface of the ob wec the dynamic pressure of incident waves can be described analytically as 2 p i ρ φ i t 3 φ i g a ω cosh k z h cosh k h cos ω t k x here g denotes the gravitational acceleration constant h the water depth ρ the water density and a ω and k the amplitude angular frequency and wave number of incident waves respectively variables with the subscript i are associated with the incident wave field the value of f s can be calculated by integrating the pressure p of the scattering problem over the mean wet body surface here p can be obtained using the linearised bernoulli s equation 4 p ρ φ t the velocity potential φ corresponding to the scattering wave field can be solved by the following boundary value problem 5 2 φ 0 in v 6 η t φ z on s f 7 φ t g η on s f 8 φ n φ i n on s w 9 φ φ i n υ n on s b where η x y t denotes the free surface elevation of scattered waves n is the unit normal vector on the fluid boundary pointing outward from the fluid v is the velocity vector of the ob wec and v s f s w and s b represent the fluid domain free surface symmetric surface and seabed respectively a boundary condition with respect to φ is also required on the open boundary s c for the completeness of the boundary value problem eq 9 gives the boundary condition on the mean wet body surface where υ is determined by the equation of motion as eq 1 to guarantee that scattered waves cannot to be re reflected from s c a damping zone is applied on the free surface close to s c the damping zone is achieved by introducing two artificial damping terms to the kinematic free surface boundary condition as kim et al 1997 10 η t φ z μ 1 η μ 2 g φ 0 for x dl x x d 0 0 on s f where x d 0 and x dl indicate the x coordinate of the beginning and ending boundaries of the damping zone respectively the damping parameters μ 1 and μ 2 are functions of the x coordinate satisfying the relationship kim et al 1997 11 μ 1 3 μ 0 x x 0 2 x l x 0 3 μ 2 μ 1 2 4 with μ 0 the damping strength here the term μ 1 is a type of newtonian cooling and the term μ 2 is the rayleigh viscosity acting as a wave dissipation sponge the damping strength is constant on the free surface of x x dl and zero for x x d 0 with the introduced damping zone the boundary condition of φ on s c can be simplified to 12 φ n 0 on s c an integral time marching method is derived to update the free surface boundary conditions in the time domain combining the kinematic and dynamic conditions leads to 13 2 φ t 2 g φ z μ 1 φ t μ 2 φ 0 integrating both sides of eq 13 twice with respect to time we can obtain an explicit form of φ as 14 φ x y z t φ x y z 0 0 t φ x y z 0 τ d τ g 0 t t τ φ x y z τ z d τ μ 1 0 t φ x y z τ d τ 0 t φ x y z 0 d τ μ 2 0 t t τ φ x y z τ d τ 0 where the following relationship is applied 15 0 τ d τ 1 0 τ 1 f t d t 0 τ f t d t t τ d τ 1 0 τ τ t f t d t 0 t t τ f τ d τ then a trapezoidal numerical integral method is used for the integration terms 16 1 1 2 μ 1 δ t φ t n δ t φ t 0 n δ t φ τ t 0 g δ t 2 1 2 n φ z t 0 i 1 n 1 n i φ z t i δ t μ 1 δ t 1 2 n δ t φ t 0 i 1 n 1 φ t i δ t μ 2 δ t 2 1 2 n φ t 0 i 1 n 1 n i φ t i δ t where δ t is the time step for the time marching scheme in this study the wave motion starts from stationary with initial conditions 17 φ 0 and φ t 0 in v for t 0 therefore eq 16 can be further simplified as 18 1 1 2 μ 1 δ t φ t n δ t g δ t 2 i 1 n 1 n i φ z t i δ t μ 1 δ t i 1 n 1 φ t i δ t μ 2 δ t 2 i 1 n 1 n i φ t i δ t the boundary value problem of φ can be solved numerically by bem the laplace equation eq 5 is first transformed into a boundary integral equation bie over the entire fluid boundary s based on the green s third identity 19 c x p φ x p s g x p x φ n φ x g x p x n d s 20 g x p x 1 x x p 2 y y p 2 z z p 2 1 2 where x p x p y p z p denotes the position vector of a collocation point p on s x x y z represents a location on s c x p is the solid angle and g denotes green s function then the bie is numerically expressed by discretizing the boundary into triangular or rectangular flat elements the velocity potential and its normal derivative on each element are assumed to be constant thus the boundary integral equation is discretized into the following numerical integration form 21 2 π ϕ i e 1 n e ϕ e h i e e 1 n e ϕ n e g i e for i 1 2 n e 22 h i e s e g x i x n d s and g i e s e g x i x d s where n e denotes the total number of elements s e the eth element x i the geometric centre of the ith element and 2 π corresponds to the solid angle at x i 3 numerical results the parabolic opening in the breakwater can be mathematically described by y 2 2 a x x 0 in the o x y z coordinate system where a is a parameter that determines the concavity of the curve around the symmetry axis and x 0 0 is the vertex location along the central axis of the parabola the focus of the parabola is at x y x f 0 with x f x 0 a 2 the focus and vertex of the parabola are at x y x f 0 and x 0 0 respectively with x f x 0 a 2 the width of the parabolic opening is denoted by b with shoulder points at x y 0 b 2 the distance between two shoulder points of neighbour openings is 2 w these geometry parameters are marked in fig 3 the area formed by the parabolic surface and y axis is called the opening area for convenience in the following simulations all length related variables are non dimensionalized by the water depth h besides h the water density ρ and gravitational acceleration constant g are also chosen as bases of non dimensionalization for dynamic properties so that the nondimensional pressure can be given according to p ρ g h p the non dimensional forms of eqs 5 18 can be obtained by assigning ρ and g the value 1 for the present model the fluid is stationary at the initial time step when incident waves enter from the open boundary on the left hand side of the fluid domain in fig 3 the waves are reflected back to the open boundary after they reach the breakwater the damping zone on the free surface near the open boundary is used to dissipate the waves propagating from the breakwater in subsequent simulations the length of the damping zone is set to 1 5 times the wave length l d i e l d 1 5 l w the damping strength for the nondimensional numerical model is set to μ 0 1 the effectiveness of the damping parameters have been verified in our previous investigation zhang and duan 2012 which can also be found later in this section 3 1 wave field in front of a plane breakwater the wave field in front of a plane breakwater is first simulated to verify the accuracy of the numerical model geometry parameters of the breakwater are set to x 0 0 w 0 a 0 and b 1 regular incident waves with the wave length l w 1 and wave amplitude a 0 001 i e wave height h 0 0 002 are selected here a is a dimensionless wave amplitude relative to the water depth h geometry parameters of the breakwater including x 0 w a b and l w are also non dimensionalized relative to the water depth h the length of the wave flume is set to l 5 l w fig 4 a shows the mesh model for the numerical computation taking advantage of the geometric symmetry only half of the computational domain is needed by reforming green s function in eq 20 as 23 g x p x 1 x x p 2 y y p 2 z z p 2 1 2 1 x x p 2 y y p 2 z z p 2 1 2 1 x x p 2 y y p 2 2 h z z p 2 1 2 1 x x p 2 y y p 2 2 h z z p 2 1 2 the length width and depth of the fluid domain are discretized into 100 20 and 20 segments respectively then 4800 quadrilateral elements are generated on the computational boundary including 2000 on the free surface 2000 on the symmetric plane 400 on the inlet boundary and 400 on the breakwater surface the time step is set to δ t t 100 with t as the wave period numerical convergence of the above spatial and temporal discretization has been verified in our previous studies zhang and duan 2012 which is not repeated here similar to the mesh model in fig 4a the computational boundary for cases of parabolic breakwaters can be obtained easily where fig 4b depicts a mesh example referring to the incident wave field defined by eq 3 the instantaneous wave elevation distribution in the tank can be written as 24 η x t 2 a cos k x sin ω t fig 5 compares the calculated wave elevation histories at two test points x y 0 525 0 025 and 1 025 0 025 to avoid an abrupt start up of the numerical simulation the wave amplitude of the incident wave is modulated by a factor f m for a time length t m here we let t m 5 t and f m 0 5 0 5 cos π t t m from fig 5 it is clear that the present numerical results agree well the corresponding analytical solutions reflecting the accuracy of the present numerical model the wave amplitudes of the first five periods are modulated smoothly corresponding to the time duration in fig 5 the maximum wave height mwh distribution in the wave flume is shown in fig 6 the mwh at a location in the wave flume is defined as the difference between the highest and lowest wave elevation appearing at that location for a specified time duration in subsequent results every mwh distribution map is normalized by the incident wave height h 0 with the denotation h w h 0 it should be noted that the present bem can only give values at the centre of each boundary element so that the mwh distribution map presented is obtained through interpolation and extrapolation operations of scattered mwh values on the free surface for this reason the mwh values at x 0 on the breakwater may lack accuracy after numerical extrapolation which is not discussed in detail hereafter fig 6a shows the mwh distribution of reflected waves corresponding to the boundary value problem of ϕ the interface between the damping zone and the observation area is highlighted in the figure to distinguish each zone it can be seen that the mwh of reflected waves in the observation area is distributed uniformly in the space this is consistent with the analytical solution that the mwh of reflected waves in the observation area should be as constant as that of incident waves i e h w h 0 the uniform mwh distribution of reflected waves in this area also indicates that the reflected waves have propagated through the whole wave flume and reached a steady state after 15 periods fig 6b corresponds to the mwh distribution of the superposition of incident and reflected waves which is called the full wave field for convenience it can be seen that peak values of the mwh distribution appear periodically along the x axis two pentagrams at x 0 5 l w and l w are marked in the figure from their locations it can be observed that the peak values of the mwh for the full wave field can be found at a distance 0 5 n l w n 1 2 away from the plane breakwater further details of the mwh along the x axis of the wave flume are presented in fig 7 from fig 7a it can be found that the mwh of reflected waves is identical to the incident wave height in the observation area this verifies the accuracy of the present numerical model in the damping zone the mwh of reflected waves gradually reduces to zero from the damping zone edge to the open boundary this confirms that a damping zone with μ 0 1 and l d 1 5 l w can dissipate the outgoing waves effectively fig 7b shows the mwh distribution of the full wave field along the x axis it can be confirmed that the peak value of the mwh for the full wave field is two times the incident wave height this appears at every location which is a multiple of half of the wave length away from the plane breakwater in consideration of the wave energy application background the ob wecs are recommended to be placed at a distance of 0 5 l w or l w away from the breakwater when integrated into the plane breakwater 3 2 wave field in front of a parabolic breakwater in this subsection the wave field in front of a representative parabolic breakwater is presented the following geometric parameters are chosen x 0 0 5 w 0 a 1 and b 1 with the focus position at x f 0 5 the wave length of incident waves varies from l w 0 6 to l w 1 4 and the wave height is set to h 0 0 002 fig 4b depicts the mesh model for the numerical computation the damping zone set up is the same as that in subsection 3 1 fig 8 shows the mwh distribution of reflected waves corresponding to five different wave lengths to guarantee a fully developed wave field the time duration of each simulation case is set to 2 l v w with v w as the phase velocity of incident waves a pentagram is marked in the wave field to indicate the focus position from fig 8 a e it can be seen that the mwh of reflected waves have their peak value occurring at the focus position the focusing of the plane waves is analogous to the manner in which a beam of light is focussed each ray of light is reflected toward the focus after it enters the parabolic opening during which process the path length of each light ray is the same based on the axiomatic fact that every point on the parabola is equidistant from the focus and from the directrix as a result the wave phases along any light ray s path are the same at the focus position leading to a superposition of wave crests in other words reflected waves from the parabolic surface travel towards the focus leading to a wave focusing at that position fig 9 gives the mwh distribution of the full wave field through a superposition of incident and reflected waves in contrast to the observation in fig 8 the peak mwh value for the full wave field does not always occur at the focus position two red pentagrams are marked in each sub figure to indicate the position that is half and one wave length away from the vertex of the parabolic opening respectively hereafter we let x 0 5 l and x 1 0 l denote positions of two red pentagrams for convenience cases of l w 1 and l w 1 are called shorter and longer wave cases respectively based on the criteria that the focus position is exactly coincident with x 0 5 l for the case of l w 1 0 fig 10 gives further details of the mwh distribution along the axis line at y 0 corresponding to cases in fig 9 through a comparable analysis of figs 9 and 10 the following observations can be stated 1 for shorter wave cases the mwh at x 0 5 l and x 1 0 l can reach about four times the wave height of incident waves 2 for the case of l w 1 0 the peak mwh value can be found at x 0 5 l at which location it is over four times the wave height of incident waves 3 for longer wave cases the pattern of the mwh distribution is more regular than that of the shorter wave and l w 1 0 cases in the longer wave cases the peak mwh value can reach about 3 times the wave height of incident waves 4 for longer wave cases the position where the peak mwh value appears is not exactly at x 0 5 l or x 1 0 l this may be due to the wave disturbance from neighbour breakwater units following ertekin and monopolis 1985 conclusion that the peak wave height in the parabolic opening corresponds to the wavelength being equal to the focal length the above additional findings further show that as the wave length increases an even larger peak wave height can also occur when half the wavelength equals to the focal length fig 11 shows the variation of the mwh at x l 0 5 and x l 1 0 with respect to the wave length it can be seen that the mwh at x l 0 5 increases with the wave length for shorter wave cases and reaches its peak value at over four times the incident wave height for l w 1 however at x l 1 0 the mwh decreases from h w h 0 4 to h w h 0 2 as the wave length increases from l w 0 6 to l w 1 0 for longer wave cases of l w 1 2 and 1 4 the mwh at x l 0 5 and x l 1 0 are similar which is consistent with the mwh distribution in fig 10d and e except for the shorter wave case of l w 0 6 the wave height ratio h w h 0 at x l 0 5 is generally greater than that at x l 1 0 therefore the location x l 0 5 is more optimal to be chosen for the ob wec deployment it should be emphasised that fig 10 displays the distribution of maximum wave height detected at each location along the centre line of the tank a near standing wave is formed in the tank due to the superposition of incident and reflected waves so that the wave elevation history at each location along the centre line is generally steady as shown in fig 12 fig 12 presents wave elevation histories at the centre of a boundary element close to x l 0 5 it can be seen that the wave elevation near x l 0 5 can reach a steady state with an almost constant wave height which demonstrates that the peak mwh value at x l 0 5 appears not occasionally but regularly for the case of l w 1 when x l 0 5 is at the focus position of the parabolic breakwater the wave height at x l 0 5 reaches up to four times of that of the incident wave based on this fact for a given wave environment with a dominant wave length l w the parabolic breakwater can be designed with its focus at 0 5 l w away from the vertex of the parabolic opening in such a situation when an ob wec is placed at the focus position of the breakwater the wave energy that can be harvested is maximised 3 3 effects of separation distance between parabolic openings in this subsection effects of the distance denoted by w between neighbouring openings on the wave field is considered hydrodynamic differences caused by the geometry parameter w essentially reflect wave field interactions among neighbour openings the parabolic opening with x 0 0 5 is taken as an example the wave length of incident waves is l w 1 fig 13 compares the mwh distribution of reflected waves with respect to three distances w 0 0 5 and 0 75 for all three cases the peak mwh value can be found at the focus position indicating that the separation distance between openings does not change the focusing location of reflected waves however the mwh value at the focus position in the reflected wave field decreases visibly for a larger value of w this confirms that the reflected waves from the neighbour openings can help amplify the wave focusing effect in front of the parabolic breakwater fig 14 shows the mwh distribution of the full wave field after a superposition of incident and reflected waves for three cases with different values of w it is found that the peak mwh value of the full wave field appears at the focus position in all cases fig 15 gives wave elevation histories at the centre of a boundary element near the focus position i e at x y 0 025 0 025 for these three cases it is shown that the free surface near the focus position oscillates constantly at a steady stage the wave amplitude decreases with an increase in the separation distance of neighbouring openings the mwh values at the focus position for three cases are compared in fig 16 it shows that as the distance between neighbouring openings increases from w 0 to w 0 75 the mwh at the focus position decreases from above 4 to approximately 3 5 times the incident wave height however it should be highlighted that even in the worst case with a large distance between neighbour openings the parabolic breakwater still works better than the conventional plane breakwater for wave focusing effects 3 4 effects of focus position in subsection 3 2 and 3 3 the focus position is located at the origin of the coordinate system this subsection will consider the situation when the focus is located within or outside of the opening area in the first case geometric parameters are set to x 0 0 75 b 2 and w 0 with a 2 3 and x f 0 417 the wave length is set to l w 2 3 to guarantee x l 0 5 coincident with the focus position of the parabolic opening fig 17 a shows the mwh distribution of the full wave field and fig 17b is the corresponding mwh distribution along the symmetry axis of the parabolic breakwater it can be seen that the peak mwh value is over four times the incident wave height appearing at the focus of the breakwater this is consistent with the conclusion made in subsection 3 2 in the second case we set x 0 0 25 b 2 and w 0 with a 2 and x f 0 75 where the focus position is located outside the opening area the wave length is set to l w 2 satisfying the relationship 0 5 l w x 0 x f fig 18 and a show the mwh distribution of the full wave field and along the symmetry axis respectively an obvious difference compared with the previous results is that the peak mwh value appears on the breakwater surface instead of the focus position this may be because the focus position in the open sea is located far away from the breakwater so that the reflected waves are likely to be disturbed by waves from the neighbouring openings in terms of an efficient design for a parabolic breakwater this type of geometry should be avoided and it is more effective to set the focus position within or on the straight edge of the opening area 3 5 cases with floating buoy in the preceding subsections we have studied the wave field in front of parabolic breakwaters and identified the target location where the largest wave height appears in this subsection we will place an ob wec at the target location and compare its motion in waves with that of an ob wec in front of a conventional plane breakwater for simplicity the ob wec can be considered as a truncated circular cylinder restricted to heave motion the motion module of the present numerical code is first tested here consider a truncated cylinder floating in the open sea in order to compare with the literature the cylinder has radius r 1 m draught d 1 m and mass m ρ π r 2 h with ρ 1023 kg m 3 and g 9 81 m s 2 the water depth is h 100 m taking advantage of the geometric symmetry we can generate mesh elements only on half of the fluid boundary there are 308 and 2000 mesh elements deployed on the body and free surface respectively the body is initially at equilibrium with incident waves propagating along the x axis the wave amplitude is set to a 0 1 r and the wave frequency varies from ω 2 to 4 rad s the body motion can reach a steady state for each case of wave frequencies the heave response amplitude operator rao defined as the amplitude ratio between the buoy motion and incoming waves is shown in fig 19 the obtained raos are compared with the wamit results given in reference watai 2015 the wamit results are based on the higher order approach with a panel size parameter of 0 05 which was defined by a prior grid convergence analysis good agreement between the present and wamit results can be observed supporting the accuracy of the present numerical model then the present numerical method is used to simulate an array of truncated cylinders floating in front of parabolic and plane breakwaters we consider a wave environment with the dominant wave length l w 1 and wave amplitude a 0 01 we can design a parabolic breakwater with geometric parameters x 0 0 5 w 0 b 2 and x f 0 which guarantees the peak mwh value occurring at the focus position the wave flume has the total length l 5 l w and damping zone length l d 1 5 l w the truncated cylinder having a radius r 0 2 and a draught h 0 2 is placed at the focus position in front of the breakwater the cylinder can heave freely in the wave field acting as an ob wec here the fluid s viscous damping and pto damping forces are omitted to highlight the wave driven motion of the floating body applying the geometric symmetry illustrated in fig 2 the mesh model in fig 20 a with 4381 elements in total including 200 on body surface 2364 on free surface 1200 on symmetric boundary and breakwater surface and 617 on inlet boundary is adopted for computation for results comparison a numerical wave flume with the same length and width is built for the case of plane breakwater the truncated cylinder is placed 0 5 l w away from the breakwater corresponding to the peak mwh value location in fig 6 fig 20b shows the boundary mesh for numerical computation with 200 elements on the body surface 2079 on the free surface 1200 on the symmetric boundary and breakwater surface and 208 on the inlet boundary fig 21 compares heave histories of the floating buoy in front of the parabolic and plane breakwaters where z b is used to denoted the vertical displacement of the buoy five cases of incident wavelengths are considered for comparison from l w 0 6 to l w 1 4 only the first 30 periods of the buoy motion are considered thus avoiding any potential disturbance from the secondary reflection of waves off the incident boundary in each sub figure an irregular buoy motion can be observed in the beginning of the time history due to the absence of damping forces associated with the buoy as reflected waves reach the damping zone the body motion gradually tends to settle to a near steady state during the near steady state phase the body motion amplitude is modulated this is because the body motion consists of at least two oscillation components corresponding to the natural frequency of the body motion and the wave excitation frequency it is expected that the buoy motion will reach a steady state after a much longer duration due to the contribution of the damping zone from these five wave cases it is evident that the buoy experiences the largest motion amplitude for the case of l w 1 0 in fig 21c this corresponds to the situation when the buoy is placed at the first pentagram position near the breakwater in figs 6b and 9c within the time duration between t 20 t and 30 t the oscillation amplitude of the body in front of the parabolic breakwater is about three times larger than that of the body in front of the conventional plane breakwater referring to fig 16 it is reasonable to attribute this motion amplification to the wave focusing effect of the parabolic breakwater considering fig 21a b d and e as the wavelength shifts away from the design wavelength the wave amplitude at the location of the buoy reduces this leads to a much smaller response of the buoy in waves in each of these four subfigures motion results for the parabolic and plane breakwaters do not exhibit a large difference in the steady stage this means that a parabolic breakwater must be carefully designed according to the local dominant wavelengths based on the above observations it is suggested to design a breakwater with the focal length of its parabolic opening equal to half the dominant wave length furthermore it should be mentioned that the power capture performance of a wec is the final goal for engineering practice the largest displacement of a wave energy device does not necessarily correspond to the largest power take off yield this is because the captured power is dependent on many complex factors such as damping characteristics of the pto system and control strategies e g passive loading control latching control or reactive loading control however for an ob wec without any pto damping included the largest body displacement indicates that the total amount of wave energy transferred to the wec is also maximised thus this motion amplification of the buoy reflects the effectiveness of the design of a breakwater with parabolic openings further if the geometry and size of the ob wec is optimised for example by adjusting the natural oscillation frequency of the ob wec to the dominant wave frequency an even larger motion response can be expected moreover this study has only considered cases with respect to regular incident waves in real sea states with small amplitude irregular waves the hydrodynamic results can be obtained from a superposition of the above linear results however in cases with large amplitude irregular waves higher order nonlinearities due to wave to wave and wave to body interactions must be considered for an accurate prediction of the buoy motion amplitude 4 conclusions this study investigates hydrodynamics of a distinctive breakwater with parabolic openings for energy harvesting a 3d numerical wave flume based on the boundary element method bem is developed to investigate the wave field around the parabolic breakwater an illustrative case of a parabolic breakwater is first shown the reflected and full wave fields are studied independently and compared it is confirmed that perpendicularly incident wave strips after reflection by the parabolic wall always travel towards the focus position the maximum wave height in the full wave field appears at a location that is half or one wave length away from the vertex of the parabolic opening based on this fact for a specific wave environment with a dominant wave length the parabolic breakwater can be designed with its focus on the symmetry axis at half the wave length away from the vertex of the parabolic opening in this condition the wave height at the focus position can reach over four times the incident wave height if the oscillating buoy wave energy converter ob wec is placed at this focus location the harvested wave energy can be greatly increased next effects of the separation distance between neighbouring openings on the wave field are investigated it is shown that as the distance between parabolic openings increases the maximum wave height at the focus position decreases accordingly however even with a larger distance between neighbouring openings the parabolic breakwater still works better than a conventional plane breakwater for wave focusing effects further the wave field around a parabolic breakwater with its focus inside or outside the parabolic opening area is discussed it is recommended to design a parabolic breakwater with its focus position inside the parabolic opening area finally a truncated circular cylinder as a simplified ob wec is placed at the focus position of a parabolic breakwater compared with the case of an ob wec located in front of a plane breakwater the heave response of the body is amplified by about three times by further optimizing the geometry the ob wec is expected to have a greater motion amplitude it should be mentioned that the viscous and pto damping forces are also important factors that can affect hydrodynamic properties of a wec these also deserve in depth analyses in future studies hydrodynamic interactions of ob wec arrays also warrant further investigation in the future the findings of this study contribute towards the commercial deployment of practical wecs by multiplying the wave energy that can be used for electricity production which can also benefit the coastal engineering community in terms of cost savings acknowledgement this study is supported by the national key r d program of china grant no 2018yfb151900 innovative technology research and development of efficient utilization of marine energy based on china s resource characteristics the national natural science foundation of china grant nos 51709038 and 51679036 and the project funded by china postdoctoral science foundation no 2018m630289 appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 04 056 
22815,hydrodynamic improvement of wave energy converter wec s performance tends to reach a bottleneck in that it becomes difficult to further jump over the present low efficiency stage instead of focusing on conventional geometry or layout optimization of wecs this study investigates an alternative way to overcome the efficiency challenge inspired by a parabolic reflector that can reflect sound towards a focal point this study explores the concept of breakwater with parabolic openings to converge propagating waves toward a focus position the wave energy harvest can be increased when a buoy type wec is set at the focus position a 3d numerical wave tank based on the boundary element method is developed to investigate the wave field around this parabolic breakwater it is confirmed that reflected waves from the parabolic opening of the breakwater can travel towards a fixed focus position the maximum wave height of the full wave field appears at a location half or one wave length away from the vertex of the parabolic opening for a specified wave environment the wave height at the focus position can reach over four times the incident wave height indicating wave energy multiplication effects of the neighbouring openings distance on the wave field are also investigated as this distance increases the maximum wave height at the focus position decreases accordingly further the wave field around a parabolic breakwater with its focus inside or outside the parabolic opening area is discussed it is recommended to design the breakwater with its focus position located inside the parabolic opening area finally a truncated circular cylinder as a simplified buoy type wec is placed at the focus position of each parabolic opening in front of the breakwater compared with the conventional design the heave response of the buoy in front of the parabolic breakwater can be amplified by about three times keywords breakwater wave energy fluid structure interaction floating body bem 1 introduction since the first oil crisis in 1974 serious scientific attempts have been made to develop renewable energy techniques including wind solar and ocean energy vicinanza et al 2014 as a largely untapped ocean energy resource the wave energy characterised by inexhaustibility predictability and high power density has attracted the renewable energy developers for several decades pecher and kofoed 2017 until now about one thousand wave energy converter wec inventions have been patented mustapa et al 2017 with over two hundred reaching the model testing stage hayward et al 2012 however the present commercialization of wecs is still restricted by two important factors i e the high cost and low energy conversion efficiency compared to some other renewable energy technologies to help reduce the manufacturing construction and installation costs some studies have suggested embedding wecs in coastal structures or offshore wind energy facilities thereby leveraging cost sharing benefits rather than deploying standalone wec devices vicinanza et al 2014 astariz and iglesias 2015 prez collazo et al 2015 from the coastal engineering background some recent studies suggest that the integration of wecs into breakwater can be a promising solution to address both the challenges of cost and efficiency as comprehensively reviewed by mustapa et al 2017 beneficial effects of the wec breakwater integration are supported by the fact that both facilities work naturally with similar effects the breakwater works by dissipating incident waves or reflecting them back to sea mccartney 1985 while the wec takes advantage of wave energy for power generation such an integration of wecs and breakwater is expected to reduce the construction cost through cost sharing and help improve the efficiency through a wave amplitude magnification in front of the breakwater after wave reflection at present typical concepts of this integration can be roughly categorized into the overtopping ot oscillating water collumn owc and oscillating buoy ob wec breakwaters kofoed 2002 in his thesis conduced hydraulic model tests for breakwater structures with single or multi level reservoirs installed on the top as a representive study of the ot wec breakwater vicinanza et al 2014 and contestabile et al 2017 introduced an ot wec breakwater named by obrec with a reservoir located in front of the rubble mound breakwater for wave overtopping capture in the second category a number of owc wec breakwaters have been practically designed and deployed at sakata port takahashi et al 1992 pico in portugal brito melo et al 2008 isle of islay scotland whittaker et al 2004 south african coast joubert 2013 mutriku port in spain ortubia et al 2009 and civitavecchia in italy arena et al 2013 the owc wec breakwater concept was also widely studied in laboratory for example he et al 2013 2017 investigated a floating box type breakwater with owc wec chambers elhanafi et al 2017 2018 experimentally studied an offshore floating moored owc device with single or dual chamber systems respectively lopez et al lpez et al 2014 numerically studied the performance improvement of the owc wec with damping effects ning et al 2015 2016a and wang et al 2018 numerically and experimentally studied the hydrodynamic performance of land based owc wecs howe and nader 2017 experimentally investigated the performance of an owc wec in front of a bottom mounted breakwater xu and huang 2018 studied the integration of owc wecs into a pile breakwater with each pile equipped with a power take off pto device in the third category mciver and evans 1988 first proposed the idea of adding reflecting harbour walls to improve the performance of wave energy devices mavrakos et al 2004 considered an array of cylindrical wecs heaving in front of a vertical breakwater michailides and angelides 2012 performed hydroelastic analyses on a flexible floating breakwater used for both shore protection and wave energy production schay et al 2013 numerically studied the hydrodynamic performance of a heaving point absorber near a fixed vertical wall zanuttigh and angelelli 2013 conducted experiments on a combined installation for wave energy production and coastal defence zheng and zhang 2015 2016 presented an analytical model to predict the 3d wave diffraction and radiation of a single floating cylinder located in front of a vertical wall at a finite water depth ning et al 2016b and zhao and ning 2018 considered the integration of the ob wecs into a pile restrained floating breakwater ning et al 2018 and zhao et al 2019 further studied an array of ob wecs attached to a fixed pontoon notwithstanding the integration of wecs with breakwaters as described above current wec designs are still restricted by the energy conversion efficiency for practical applications a large proportion of relevant research has attenpted to improve the efficiency of wecs through an optimization of the device geometry goggins and finnegan 2014 or spatial layout child 2011 kara 2016 and many have produced favourable results however it is still inevitable that these types of efficiency improvement have a ceiling limit taking ob wecs for example it is not easy to further gain a dramatic leap for example 10 of the efficiency solely through geometry optimization based on the current stage of development mccormick 2007 from a different perspective some pioneering studies have concentrated their effort on increasing the energy density of waves by confining wave energy to a focal area for example mehlum and stamnes 1980 and stamnes 1986 introduced a zone plate lens composed of submerged trapezoidal elements each element had a slope which changed the direction of wave propagation based on the wave refraction principle so that incident water waves can be converged at a certain focal area ertekin and monopolis 1985 studied the increase in energy density of shallow water waves at a given location with a parabolic step change in water depth they observed wave amplification up to eight times in their experiments the feasibility of using a parabolic wall as a reflector was also tested along with small scale experiments yang and ertekin 1991 further used the 3d boundary element method bem to predict the wave amplitude amplification at the focal point of the parabolic step it was demonstrated that the energy density of waves increases not only at the focal point but also at a series of locations along the parabolic step discontinuity van der wiel et al van der wiel et al 2016 investigated a model with a circular shoal to refract shallow water waves to a focal area and a parabolic structure on the shoal to further reflect waves to the focal area numerical studies were carried out for 5 5 wecs in the front of the parabolic structure in this study we focus our investigation on the breakwater part of the wec breakwater as demonstrated by some existing applications a properly optimised breakwater can help increase the energy harvest one example is the stellenbosch wec as a land based breakwater with owc wecs retief et al 1984 the breakwater has two 160 m long arms arranged in a v shape to guide incoming waves to the air turbine mounted at the intersection of two arms another example is the mutriku owc wec that is installed on a curved breakwater section tease et al 2007 furthermore the ot wec wavecat uses two hulls to form a wedge in the plan view so that wave energy can be converged to the hinged hull sterns fernandez et al 2012 this study focused on a special concept of breakwaters with parabolic openings hereafter called parabolic breakwater for convenience the concept is inspired by the parabolic reflector that can be used to collect energy from a distant source of light sound or radio waves according to the principle of reflection the parabolic reflector can converge an incoming wave travelling parallel to the axis toward the focus similarly for water waves it is expected that the propagating waves during certain conditions can converge at the focus of the parabolic opening of the breakwater where an ob wec can be placed at the focus position to maximise the energy capture efficiency the concepts of ob wecs integrated into conventional plane and the proposed parabolic breakwaters are illustrated in fig 1 a and b respectively fig 1c shows an example of 3d design sketch for this novel parabolic breakwater concept it is feasible that this parabolic design can also be applied in floating breakwaters ji et al 2018 the purpose of this study is to investigate wave field characteristics around this type of parabolic breakwater and hydrodynamic properties of an ob wec installed on the breakwater it should be mentioned that water waves have specific features compared with light waves a perpendicularly incident light wave has an extremely short wavelength so that its energy can always be converged at the focus of a parabolic reflector the wavelength of water waves is usually comparable to the focal length of the parabolic breakwater as a result of the interaction of incident and reflected waves the maximum wave height does not always manifest at the focus position thus this study will first investigate quantitative details of water wave fields around parabolic breakwaters a 3d numerical wave flume based on boundary element method bem is developed wave fields around the parabolic breakwater with different geometric parameters are simulated corresponding to different incident waves further the parabolic breakwater with a buoy type wec installed is studied aiming to demonstrate effectiveness of this parabolic breakwater concept on increasing the energy harvest this paper is structured as follows section 2 gives the mathematical description of the problem and associated numerical techniques section 3 presents results and discussions for a parametric study conclusions are reported in section 4 2 mathematical formulae as a preliminary concept examination a near shore bottom mounted breakwater is considered the breakwater is assumed to be parallel with a straight coastline so that incident waves can be considered to propagate perpendicularly towards the structure for convenience the breakwater is assumed to be infinitely long with an array of identical parabolic openings uniformly distributed on its seaward side each parabolic opening has its symmetry axis parallel to the propagation direction of incident waves a cylindrical ob wec with one degree of freedom dof in the vertical direction i e only with heave mode is deployed on the symmetry axis of each parabolic opening due to the geometric symmetry the whole breakwater can be considered as the combination of identical breakwater units with a parabolic opening the wave behaviour in front of each opening is identical so that the hydrodynamic model of ob wecs in these openings can be equivalently considered as that of an individual ob wec in a wave flume with a parabolic end fig 2 a and b shows the top and side views of the physical model respectively a right handed cartesian coordinate system o x y z is introduced in fig 2 the origin o is defined on the still water free surface at the intersection of the flume s centre axis and the tangential plane of the breakwater s seaward side the x axis points perpendicularly into the breakwater and z axis points vertically upward the ob wec is rigid its heave motion is determined by newton s second law as 1 m s t c s t f fk t f s t f damp t f pto t where m is the mass of the ob wec c is the restoring coefficient f fk denotes froude krylov fk force f s is the scattering wave force f damp is the damping force from the fluid f pto is the damping force associated with the power take off system t is the time variable and s s and s represent the vertical displacement velocity and acceleration of the floating body respectively in this study f damp and f pto which correspond to the damping dissipation from the fluid and the pto system are neglected this is in order to highlight the increase of total energy amount as a result of the wave focusing the fk force f fk represents the force introduced by the dynamic pressure of undisturbed incident waves while the scattering wave force f s is the force caused by disturbed waves due to the existence and oscillation of the buoy both forces can be calculated using the potential flow theory based on the potential flow theory the velocity potential φ whose gradient is the fluid velocity can be introduced by assuming the fluid to be inviscid incompressible and flow irrotational the velocity potential can be split in two parts i e the incident potential φ i which is known from the definition of the incident wave field and the remaining scattering potential φ the fk force is associated with the incident potential while the scattering force can be obtained from the scattering potential the value of f fk can be obtained through an integration of the dynamic pressure p i of incident waves over the mean wet surface of the ob wec the dynamic pressure of incident waves can be described analytically as 2 p i ρ φ i t 3 φ i g a ω cosh k z h cosh k h cos ω t k x here g denotes the gravitational acceleration constant h the water depth ρ the water density and a ω and k the amplitude angular frequency and wave number of incident waves respectively variables with the subscript i are associated with the incident wave field the value of f s can be calculated by integrating the pressure p of the scattering problem over the mean wet body surface here p can be obtained using the linearised bernoulli s equation 4 p ρ φ t the velocity potential φ corresponding to the scattering wave field can be solved by the following boundary value problem 5 2 φ 0 in v 6 η t φ z on s f 7 φ t g η on s f 8 φ n φ i n on s w 9 φ φ i n υ n on s b where η x y t denotes the free surface elevation of scattered waves n is the unit normal vector on the fluid boundary pointing outward from the fluid v is the velocity vector of the ob wec and v s f s w and s b represent the fluid domain free surface symmetric surface and seabed respectively a boundary condition with respect to φ is also required on the open boundary s c for the completeness of the boundary value problem eq 9 gives the boundary condition on the mean wet body surface where υ is determined by the equation of motion as eq 1 to guarantee that scattered waves cannot to be re reflected from s c a damping zone is applied on the free surface close to s c the damping zone is achieved by introducing two artificial damping terms to the kinematic free surface boundary condition as kim et al 1997 10 η t φ z μ 1 η μ 2 g φ 0 for x dl x x d 0 0 on s f where x d 0 and x dl indicate the x coordinate of the beginning and ending boundaries of the damping zone respectively the damping parameters μ 1 and μ 2 are functions of the x coordinate satisfying the relationship kim et al 1997 11 μ 1 3 μ 0 x x 0 2 x l x 0 3 μ 2 μ 1 2 4 with μ 0 the damping strength here the term μ 1 is a type of newtonian cooling and the term μ 2 is the rayleigh viscosity acting as a wave dissipation sponge the damping strength is constant on the free surface of x x dl and zero for x x d 0 with the introduced damping zone the boundary condition of φ on s c can be simplified to 12 φ n 0 on s c an integral time marching method is derived to update the free surface boundary conditions in the time domain combining the kinematic and dynamic conditions leads to 13 2 φ t 2 g φ z μ 1 φ t μ 2 φ 0 integrating both sides of eq 13 twice with respect to time we can obtain an explicit form of φ as 14 φ x y z t φ x y z 0 0 t φ x y z 0 τ d τ g 0 t t τ φ x y z τ z d τ μ 1 0 t φ x y z τ d τ 0 t φ x y z 0 d τ μ 2 0 t t τ φ x y z τ d τ 0 where the following relationship is applied 15 0 τ d τ 1 0 τ 1 f t d t 0 τ f t d t t τ d τ 1 0 τ τ t f t d t 0 t t τ f τ d τ then a trapezoidal numerical integral method is used for the integration terms 16 1 1 2 μ 1 δ t φ t n δ t φ t 0 n δ t φ τ t 0 g δ t 2 1 2 n φ z t 0 i 1 n 1 n i φ z t i δ t μ 1 δ t 1 2 n δ t φ t 0 i 1 n 1 φ t i δ t μ 2 δ t 2 1 2 n φ t 0 i 1 n 1 n i φ t i δ t where δ t is the time step for the time marching scheme in this study the wave motion starts from stationary with initial conditions 17 φ 0 and φ t 0 in v for t 0 therefore eq 16 can be further simplified as 18 1 1 2 μ 1 δ t φ t n δ t g δ t 2 i 1 n 1 n i φ z t i δ t μ 1 δ t i 1 n 1 φ t i δ t μ 2 δ t 2 i 1 n 1 n i φ t i δ t the boundary value problem of φ can be solved numerically by bem the laplace equation eq 5 is first transformed into a boundary integral equation bie over the entire fluid boundary s based on the green s third identity 19 c x p φ x p s g x p x φ n φ x g x p x n d s 20 g x p x 1 x x p 2 y y p 2 z z p 2 1 2 where x p x p y p z p denotes the position vector of a collocation point p on s x x y z represents a location on s c x p is the solid angle and g denotes green s function then the bie is numerically expressed by discretizing the boundary into triangular or rectangular flat elements the velocity potential and its normal derivative on each element are assumed to be constant thus the boundary integral equation is discretized into the following numerical integration form 21 2 π ϕ i e 1 n e ϕ e h i e e 1 n e ϕ n e g i e for i 1 2 n e 22 h i e s e g x i x n d s and g i e s e g x i x d s where n e denotes the total number of elements s e the eth element x i the geometric centre of the ith element and 2 π corresponds to the solid angle at x i 3 numerical results the parabolic opening in the breakwater can be mathematically described by y 2 2 a x x 0 in the o x y z coordinate system where a is a parameter that determines the concavity of the curve around the symmetry axis and x 0 0 is the vertex location along the central axis of the parabola the focus of the parabola is at x y x f 0 with x f x 0 a 2 the focus and vertex of the parabola are at x y x f 0 and x 0 0 respectively with x f x 0 a 2 the width of the parabolic opening is denoted by b with shoulder points at x y 0 b 2 the distance between two shoulder points of neighbour openings is 2 w these geometry parameters are marked in fig 3 the area formed by the parabolic surface and y axis is called the opening area for convenience in the following simulations all length related variables are non dimensionalized by the water depth h besides h the water density ρ and gravitational acceleration constant g are also chosen as bases of non dimensionalization for dynamic properties so that the nondimensional pressure can be given according to p ρ g h p the non dimensional forms of eqs 5 18 can be obtained by assigning ρ and g the value 1 for the present model the fluid is stationary at the initial time step when incident waves enter from the open boundary on the left hand side of the fluid domain in fig 3 the waves are reflected back to the open boundary after they reach the breakwater the damping zone on the free surface near the open boundary is used to dissipate the waves propagating from the breakwater in subsequent simulations the length of the damping zone is set to 1 5 times the wave length l d i e l d 1 5 l w the damping strength for the nondimensional numerical model is set to μ 0 1 the effectiveness of the damping parameters have been verified in our previous investigation zhang and duan 2012 which can also be found later in this section 3 1 wave field in front of a plane breakwater the wave field in front of a plane breakwater is first simulated to verify the accuracy of the numerical model geometry parameters of the breakwater are set to x 0 0 w 0 a 0 and b 1 regular incident waves with the wave length l w 1 and wave amplitude a 0 001 i e wave height h 0 0 002 are selected here a is a dimensionless wave amplitude relative to the water depth h geometry parameters of the breakwater including x 0 w a b and l w are also non dimensionalized relative to the water depth h the length of the wave flume is set to l 5 l w fig 4 a shows the mesh model for the numerical computation taking advantage of the geometric symmetry only half of the computational domain is needed by reforming green s function in eq 20 as 23 g x p x 1 x x p 2 y y p 2 z z p 2 1 2 1 x x p 2 y y p 2 z z p 2 1 2 1 x x p 2 y y p 2 2 h z z p 2 1 2 1 x x p 2 y y p 2 2 h z z p 2 1 2 the length width and depth of the fluid domain are discretized into 100 20 and 20 segments respectively then 4800 quadrilateral elements are generated on the computational boundary including 2000 on the free surface 2000 on the symmetric plane 400 on the inlet boundary and 400 on the breakwater surface the time step is set to δ t t 100 with t as the wave period numerical convergence of the above spatial and temporal discretization has been verified in our previous studies zhang and duan 2012 which is not repeated here similar to the mesh model in fig 4a the computational boundary for cases of parabolic breakwaters can be obtained easily where fig 4b depicts a mesh example referring to the incident wave field defined by eq 3 the instantaneous wave elevation distribution in the tank can be written as 24 η x t 2 a cos k x sin ω t fig 5 compares the calculated wave elevation histories at two test points x y 0 525 0 025 and 1 025 0 025 to avoid an abrupt start up of the numerical simulation the wave amplitude of the incident wave is modulated by a factor f m for a time length t m here we let t m 5 t and f m 0 5 0 5 cos π t t m from fig 5 it is clear that the present numerical results agree well the corresponding analytical solutions reflecting the accuracy of the present numerical model the wave amplitudes of the first five periods are modulated smoothly corresponding to the time duration in fig 5 the maximum wave height mwh distribution in the wave flume is shown in fig 6 the mwh at a location in the wave flume is defined as the difference between the highest and lowest wave elevation appearing at that location for a specified time duration in subsequent results every mwh distribution map is normalized by the incident wave height h 0 with the denotation h w h 0 it should be noted that the present bem can only give values at the centre of each boundary element so that the mwh distribution map presented is obtained through interpolation and extrapolation operations of scattered mwh values on the free surface for this reason the mwh values at x 0 on the breakwater may lack accuracy after numerical extrapolation which is not discussed in detail hereafter fig 6a shows the mwh distribution of reflected waves corresponding to the boundary value problem of ϕ the interface between the damping zone and the observation area is highlighted in the figure to distinguish each zone it can be seen that the mwh of reflected waves in the observation area is distributed uniformly in the space this is consistent with the analytical solution that the mwh of reflected waves in the observation area should be as constant as that of incident waves i e h w h 0 the uniform mwh distribution of reflected waves in this area also indicates that the reflected waves have propagated through the whole wave flume and reached a steady state after 15 periods fig 6b corresponds to the mwh distribution of the superposition of incident and reflected waves which is called the full wave field for convenience it can be seen that peak values of the mwh distribution appear periodically along the x axis two pentagrams at x 0 5 l w and l w are marked in the figure from their locations it can be observed that the peak values of the mwh for the full wave field can be found at a distance 0 5 n l w n 1 2 away from the plane breakwater further details of the mwh along the x axis of the wave flume are presented in fig 7 from fig 7a it can be found that the mwh of reflected waves is identical to the incident wave height in the observation area this verifies the accuracy of the present numerical model in the damping zone the mwh of reflected waves gradually reduces to zero from the damping zone edge to the open boundary this confirms that a damping zone with μ 0 1 and l d 1 5 l w can dissipate the outgoing waves effectively fig 7b shows the mwh distribution of the full wave field along the x axis it can be confirmed that the peak value of the mwh for the full wave field is two times the incident wave height this appears at every location which is a multiple of half of the wave length away from the plane breakwater in consideration of the wave energy application background the ob wecs are recommended to be placed at a distance of 0 5 l w or l w away from the breakwater when integrated into the plane breakwater 3 2 wave field in front of a parabolic breakwater in this subsection the wave field in front of a representative parabolic breakwater is presented the following geometric parameters are chosen x 0 0 5 w 0 a 1 and b 1 with the focus position at x f 0 5 the wave length of incident waves varies from l w 0 6 to l w 1 4 and the wave height is set to h 0 0 002 fig 4b depicts the mesh model for the numerical computation the damping zone set up is the same as that in subsection 3 1 fig 8 shows the mwh distribution of reflected waves corresponding to five different wave lengths to guarantee a fully developed wave field the time duration of each simulation case is set to 2 l v w with v w as the phase velocity of incident waves a pentagram is marked in the wave field to indicate the focus position from fig 8 a e it can be seen that the mwh of reflected waves have their peak value occurring at the focus position the focusing of the plane waves is analogous to the manner in which a beam of light is focussed each ray of light is reflected toward the focus after it enters the parabolic opening during which process the path length of each light ray is the same based on the axiomatic fact that every point on the parabola is equidistant from the focus and from the directrix as a result the wave phases along any light ray s path are the same at the focus position leading to a superposition of wave crests in other words reflected waves from the parabolic surface travel towards the focus leading to a wave focusing at that position fig 9 gives the mwh distribution of the full wave field through a superposition of incident and reflected waves in contrast to the observation in fig 8 the peak mwh value for the full wave field does not always occur at the focus position two red pentagrams are marked in each sub figure to indicate the position that is half and one wave length away from the vertex of the parabolic opening respectively hereafter we let x 0 5 l and x 1 0 l denote positions of two red pentagrams for convenience cases of l w 1 and l w 1 are called shorter and longer wave cases respectively based on the criteria that the focus position is exactly coincident with x 0 5 l for the case of l w 1 0 fig 10 gives further details of the mwh distribution along the axis line at y 0 corresponding to cases in fig 9 through a comparable analysis of figs 9 and 10 the following observations can be stated 1 for shorter wave cases the mwh at x 0 5 l and x 1 0 l can reach about four times the wave height of incident waves 2 for the case of l w 1 0 the peak mwh value can be found at x 0 5 l at which location it is over four times the wave height of incident waves 3 for longer wave cases the pattern of the mwh distribution is more regular than that of the shorter wave and l w 1 0 cases in the longer wave cases the peak mwh value can reach about 3 times the wave height of incident waves 4 for longer wave cases the position where the peak mwh value appears is not exactly at x 0 5 l or x 1 0 l this may be due to the wave disturbance from neighbour breakwater units following ertekin and monopolis 1985 conclusion that the peak wave height in the parabolic opening corresponds to the wavelength being equal to the focal length the above additional findings further show that as the wave length increases an even larger peak wave height can also occur when half the wavelength equals to the focal length fig 11 shows the variation of the mwh at x l 0 5 and x l 1 0 with respect to the wave length it can be seen that the mwh at x l 0 5 increases with the wave length for shorter wave cases and reaches its peak value at over four times the incident wave height for l w 1 however at x l 1 0 the mwh decreases from h w h 0 4 to h w h 0 2 as the wave length increases from l w 0 6 to l w 1 0 for longer wave cases of l w 1 2 and 1 4 the mwh at x l 0 5 and x l 1 0 are similar which is consistent with the mwh distribution in fig 10d and e except for the shorter wave case of l w 0 6 the wave height ratio h w h 0 at x l 0 5 is generally greater than that at x l 1 0 therefore the location x l 0 5 is more optimal to be chosen for the ob wec deployment it should be emphasised that fig 10 displays the distribution of maximum wave height detected at each location along the centre line of the tank a near standing wave is formed in the tank due to the superposition of incident and reflected waves so that the wave elevation history at each location along the centre line is generally steady as shown in fig 12 fig 12 presents wave elevation histories at the centre of a boundary element close to x l 0 5 it can be seen that the wave elevation near x l 0 5 can reach a steady state with an almost constant wave height which demonstrates that the peak mwh value at x l 0 5 appears not occasionally but regularly for the case of l w 1 when x l 0 5 is at the focus position of the parabolic breakwater the wave height at x l 0 5 reaches up to four times of that of the incident wave based on this fact for a given wave environment with a dominant wave length l w the parabolic breakwater can be designed with its focus at 0 5 l w away from the vertex of the parabolic opening in such a situation when an ob wec is placed at the focus position of the breakwater the wave energy that can be harvested is maximised 3 3 effects of separation distance between parabolic openings in this subsection effects of the distance denoted by w between neighbouring openings on the wave field is considered hydrodynamic differences caused by the geometry parameter w essentially reflect wave field interactions among neighbour openings the parabolic opening with x 0 0 5 is taken as an example the wave length of incident waves is l w 1 fig 13 compares the mwh distribution of reflected waves with respect to three distances w 0 0 5 and 0 75 for all three cases the peak mwh value can be found at the focus position indicating that the separation distance between openings does not change the focusing location of reflected waves however the mwh value at the focus position in the reflected wave field decreases visibly for a larger value of w this confirms that the reflected waves from the neighbour openings can help amplify the wave focusing effect in front of the parabolic breakwater fig 14 shows the mwh distribution of the full wave field after a superposition of incident and reflected waves for three cases with different values of w it is found that the peak mwh value of the full wave field appears at the focus position in all cases fig 15 gives wave elevation histories at the centre of a boundary element near the focus position i e at x y 0 025 0 025 for these three cases it is shown that the free surface near the focus position oscillates constantly at a steady stage the wave amplitude decreases with an increase in the separation distance of neighbouring openings the mwh values at the focus position for three cases are compared in fig 16 it shows that as the distance between neighbouring openings increases from w 0 to w 0 75 the mwh at the focus position decreases from above 4 to approximately 3 5 times the incident wave height however it should be highlighted that even in the worst case with a large distance between neighbour openings the parabolic breakwater still works better than the conventional plane breakwater for wave focusing effects 3 4 effects of focus position in subsection 3 2 and 3 3 the focus position is located at the origin of the coordinate system this subsection will consider the situation when the focus is located within or outside of the opening area in the first case geometric parameters are set to x 0 0 75 b 2 and w 0 with a 2 3 and x f 0 417 the wave length is set to l w 2 3 to guarantee x l 0 5 coincident with the focus position of the parabolic opening fig 17 a shows the mwh distribution of the full wave field and fig 17b is the corresponding mwh distribution along the symmetry axis of the parabolic breakwater it can be seen that the peak mwh value is over four times the incident wave height appearing at the focus of the breakwater this is consistent with the conclusion made in subsection 3 2 in the second case we set x 0 0 25 b 2 and w 0 with a 2 and x f 0 75 where the focus position is located outside the opening area the wave length is set to l w 2 satisfying the relationship 0 5 l w x 0 x f fig 18 and a show the mwh distribution of the full wave field and along the symmetry axis respectively an obvious difference compared with the previous results is that the peak mwh value appears on the breakwater surface instead of the focus position this may be because the focus position in the open sea is located far away from the breakwater so that the reflected waves are likely to be disturbed by waves from the neighbouring openings in terms of an efficient design for a parabolic breakwater this type of geometry should be avoided and it is more effective to set the focus position within or on the straight edge of the opening area 3 5 cases with floating buoy in the preceding subsections we have studied the wave field in front of parabolic breakwaters and identified the target location where the largest wave height appears in this subsection we will place an ob wec at the target location and compare its motion in waves with that of an ob wec in front of a conventional plane breakwater for simplicity the ob wec can be considered as a truncated circular cylinder restricted to heave motion the motion module of the present numerical code is first tested here consider a truncated cylinder floating in the open sea in order to compare with the literature the cylinder has radius r 1 m draught d 1 m and mass m ρ π r 2 h with ρ 1023 kg m 3 and g 9 81 m s 2 the water depth is h 100 m taking advantage of the geometric symmetry we can generate mesh elements only on half of the fluid boundary there are 308 and 2000 mesh elements deployed on the body and free surface respectively the body is initially at equilibrium with incident waves propagating along the x axis the wave amplitude is set to a 0 1 r and the wave frequency varies from ω 2 to 4 rad s the body motion can reach a steady state for each case of wave frequencies the heave response amplitude operator rao defined as the amplitude ratio between the buoy motion and incoming waves is shown in fig 19 the obtained raos are compared with the wamit results given in reference watai 2015 the wamit results are based on the higher order approach with a panel size parameter of 0 05 which was defined by a prior grid convergence analysis good agreement between the present and wamit results can be observed supporting the accuracy of the present numerical model then the present numerical method is used to simulate an array of truncated cylinders floating in front of parabolic and plane breakwaters we consider a wave environment with the dominant wave length l w 1 and wave amplitude a 0 01 we can design a parabolic breakwater with geometric parameters x 0 0 5 w 0 b 2 and x f 0 which guarantees the peak mwh value occurring at the focus position the wave flume has the total length l 5 l w and damping zone length l d 1 5 l w the truncated cylinder having a radius r 0 2 and a draught h 0 2 is placed at the focus position in front of the breakwater the cylinder can heave freely in the wave field acting as an ob wec here the fluid s viscous damping and pto damping forces are omitted to highlight the wave driven motion of the floating body applying the geometric symmetry illustrated in fig 2 the mesh model in fig 20 a with 4381 elements in total including 200 on body surface 2364 on free surface 1200 on symmetric boundary and breakwater surface and 617 on inlet boundary is adopted for computation for results comparison a numerical wave flume with the same length and width is built for the case of plane breakwater the truncated cylinder is placed 0 5 l w away from the breakwater corresponding to the peak mwh value location in fig 6 fig 20b shows the boundary mesh for numerical computation with 200 elements on the body surface 2079 on the free surface 1200 on the symmetric boundary and breakwater surface and 208 on the inlet boundary fig 21 compares heave histories of the floating buoy in front of the parabolic and plane breakwaters where z b is used to denoted the vertical displacement of the buoy five cases of incident wavelengths are considered for comparison from l w 0 6 to l w 1 4 only the first 30 periods of the buoy motion are considered thus avoiding any potential disturbance from the secondary reflection of waves off the incident boundary in each sub figure an irregular buoy motion can be observed in the beginning of the time history due to the absence of damping forces associated with the buoy as reflected waves reach the damping zone the body motion gradually tends to settle to a near steady state during the near steady state phase the body motion amplitude is modulated this is because the body motion consists of at least two oscillation components corresponding to the natural frequency of the body motion and the wave excitation frequency it is expected that the buoy motion will reach a steady state after a much longer duration due to the contribution of the damping zone from these five wave cases it is evident that the buoy experiences the largest motion amplitude for the case of l w 1 0 in fig 21c this corresponds to the situation when the buoy is placed at the first pentagram position near the breakwater in figs 6b and 9c within the time duration between t 20 t and 30 t the oscillation amplitude of the body in front of the parabolic breakwater is about three times larger than that of the body in front of the conventional plane breakwater referring to fig 16 it is reasonable to attribute this motion amplification to the wave focusing effect of the parabolic breakwater considering fig 21a b d and e as the wavelength shifts away from the design wavelength the wave amplitude at the location of the buoy reduces this leads to a much smaller response of the buoy in waves in each of these four subfigures motion results for the parabolic and plane breakwaters do not exhibit a large difference in the steady stage this means that a parabolic breakwater must be carefully designed according to the local dominant wavelengths based on the above observations it is suggested to design a breakwater with the focal length of its parabolic opening equal to half the dominant wave length furthermore it should be mentioned that the power capture performance of a wec is the final goal for engineering practice the largest displacement of a wave energy device does not necessarily correspond to the largest power take off yield this is because the captured power is dependent on many complex factors such as damping characteristics of the pto system and control strategies e g passive loading control latching control or reactive loading control however for an ob wec without any pto damping included the largest body displacement indicates that the total amount of wave energy transferred to the wec is also maximised thus this motion amplification of the buoy reflects the effectiveness of the design of a breakwater with parabolic openings further if the geometry and size of the ob wec is optimised for example by adjusting the natural oscillation frequency of the ob wec to the dominant wave frequency an even larger motion response can be expected moreover this study has only considered cases with respect to regular incident waves in real sea states with small amplitude irregular waves the hydrodynamic results can be obtained from a superposition of the above linear results however in cases with large amplitude irregular waves higher order nonlinearities due to wave to wave and wave to body interactions must be considered for an accurate prediction of the buoy motion amplitude 4 conclusions this study investigates hydrodynamics of a distinctive breakwater with parabolic openings for energy harvesting a 3d numerical wave flume based on the boundary element method bem is developed to investigate the wave field around the parabolic breakwater an illustrative case of a parabolic breakwater is first shown the reflected and full wave fields are studied independently and compared it is confirmed that perpendicularly incident wave strips after reflection by the parabolic wall always travel towards the focus position the maximum wave height in the full wave field appears at a location that is half or one wave length away from the vertex of the parabolic opening based on this fact for a specific wave environment with a dominant wave length the parabolic breakwater can be designed with its focus on the symmetry axis at half the wave length away from the vertex of the parabolic opening in this condition the wave height at the focus position can reach over four times the incident wave height if the oscillating buoy wave energy converter ob wec is placed at this focus location the harvested wave energy can be greatly increased next effects of the separation distance between neighbouring openings on the wave field are investigated it is shown that as the distance between parabolic openings increases the maximum wave height at the focus position decreases accordingly however even with a larger distance between neighbouring openings the parabolic breakwater still works better than a conventional plane breakwater for wave focusing effects further the wave field around a parabolic breakwater with its focus inside or outside the parabolic opening area is discussed it is recommended to design a parabolic breakwater with its focus position inside the parabolic opening area finally a truncated circular cylinder as a simplified ob wec is placed at the focus position of a parabolic breakwater compared with the case of an ob wec located in front of a plane breakwater the heave response of the body is amplified by about three times by further optimizing the geometry the ob wec is expected to have a greater motion amplitude it should be mentioned that the viscous and pto damping forces are also important factors that can affect hydrodynamic properties of a wec these also deserve in depth analyses in future studies hydrodynamic interactions of ob wec arrays also warrant further investigation in the future the findings of this study contribute towards the commercial deployment of practical wecs by multiplying the wave energy that can be used for electricity production which can also benefit the coastal engineering community in terms of cost savings acknowledgement this study is supported by the national key r d program of china grant no 2018yfb151900 innovative technology research and development of efficient utilization of marine energy based on china s resource characteristics the national natural science foundation of china grant nos 51709038 and 51679036 and the project funded by china postdoctoral science foundation no 2018m630289 appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 04 056 
22816,conventional system reset methods establish the relationship between measurements such as position or heading and gyro drifts by the psi equation following which they iteratively calculate the gyro drifts however these methods have some limitations in practice first the process of system reset takes a long time and usually the interval between two samples is a few hours second the position information of multiple points is generally difficult to obtain for an underwater vehicle in order to solve the above problem a system reset method suitable for underwater strapdown inertial navigation system ins is proposed in this paper this method uses external velocity as aiding information which relates the measurement velocity to gyro drifts position and heading by the intermediate vector on the geographical frame and then calculates the gyro drifts and the errors of position and heading the results of simulation and trial show that the proposed system reset method only spends 2 min on correcting system errors including gyro drifts position errors and heading error only using the aiding velocities from a doppler velocity log keywords strapdown ins system reset external velocity information gyro drift 1 introduction from the analysis of the inertial navigation system gyro drifts are known to be the primary cause of system error accumulation the following two methods are implemented to solve this problem 1 select high performance gyroscopes and accelerometers or 2 estimate the gyro drifts and make the correction cheng et al 2014 although the application of high performance gyroscopes and accelerometers most effectively increases the accuracy of inertial navigation systems this method is very cost expensive therefore estimating the gyro drifts is commonly the preferred method as no extra cost is incurred as a result of implementing this method in order to estimate the gyro drifts and bound the system errors the usual option is to apply integrated navigation technology xue et al 2011 the accurate position and velocity of the strapdown ins obtained from the external equipment are used as measurements and then a filter algorithm is applied to estimate and compensate the system errors thus the errors do not diverge compared with a pure strapdown ins kaygisiz and sen 2015 de silva et al 2015 however an integrated navigation system needs successive external measurements for more than 20 min to stabilize tucker et al 2000 the system estimates gyro drifts and misalignment angles in these 20 min but the estimates are unstable i e the system requires an adjustment process furthermore because the time consuming and successive measurements are often difficult to obtain underwater integrated navigation technology is not suitable for underwater vehicles gao et al 2017 xu et al 2017 system reset is another option to estimate and correct gyro drifts to date there have been many reports on system reset in the early 1960s a system reset method based on a deterministic model was proposed to limit the errors of the platform ins installed on a vehicle at sea bona and smay 1962 in addition benso and duplessis presented a three fix reset scheme using position and heading information and then analyzed the errors after the reset was performed benso and duplessis 1963 based on the three fix reset scheme the idea of point point reset was developed in which the second point in the three fix reset scheme is considered the first point of the next reset such that the estimation and compensation can be performed after each acquisition of position information yang provided an elaborate error analysis during the two point system reset and deduced the relationship between the estimation errors of the gyro drift the accuracy of the external measurement and the level angle errors xiaodong and taiguang 2011 in all the above methods the gyro is installed on the platform and the torque output by the gyro can control the platform to follow the navigation coordinate system these methods are the system reset technologies for the platform ins the strapdown ins is currently in wide use various system reset methods suitable for strapdown ins have been proposed as a result of improving the system reset method of the platform ins as with the platform ins conventional system reset methods of the strapdown ins have also been categorized as either a two point reset three point reset or point point reset shi and yang 2016 the two point system reset method requires the position and heading information of two points however because the heading information is difficult to obtain the three point system reset method is most commonly implemented in practice as this method only requires the position information of three points ben et al 2014 as compared to the integrated navigation technology the system reset method only requires occasional measurements at two or three measurement points instead of successive measurements however the time interval between point measurements is long typically lasting more than 1 h furthermore and more importantly multi point position measurements are difficult to obtain for an underwater vehicle therefore the existing system reset methods cannot be well applied to an underwater strapdown ins in this study a novel system reset method suitable for an underwater strapdown ins was developed to rectify the problems outlined above with this method the gyro drifts are quickly estimated and corrected in a matter of 1 2 min based on velocity information and position and heading errors are simultaneously calculated moreover because a doppler velocity log dvl is effectively used underwater the accuracy of its average measurement velocity is high gao et al 2014 thus the velocity information is provided by the dvl in this study compared with conventional system reset methods and integrated navigation systems the novel method proposed in this study significantly reduces the time required for a system reset to approximately 2 min 2 nomenclature commonly used nomenclature in this article 1 frame definitions 2 1 i inertial frame the origin of the inertial frame is earth s center of mass the z axis is along earth s polar axis the x axis and y axis lie in the equatorial plane and point to a fixed star 2 2 e earth frame the origin of the earth frame is earth s center of mass the z axis is along earth s polar axis the x axis lies along the intersection of the plane of the greenwich meridian with earth s equatorial plane the y axis is in the equatorial plane which forms the right handed system with the x axis and y axis the earth frame rotates with respect to the inertial frame at a rate ω earth rotation rate about the z axis the i frame and e frame are illustrated in fig 1 2 3 n navigation frame in this study the geographic frame was selected as the navigation frame the geographic frame is a local navigational frame that has its origin at the system s true location and its axes aligned with the east north and up directions 2 4 p mathematical platform frame the platform frame is used to track the navigation frame when there is no error in the strapdown inertial navigation system the platform frame and the navigation frame coincide when the strapdown inertial navigation system has errors the error angle will appear between the platform frame and the navigation frame the n frame and p frame are illustrated in fig 2 2 5 c geographical frame of the computed position this frame is a local navigational frame that has its origin at the system s computed location and its axes aligned with the east north and up directions the only difference from the n frame is that the origin of the c frame is at the calculation position the relationship between the n frame and c frame is illustrated in fig 3 where δ ϕ is the latitude error and δ λ is the longitude error 2 6 o oepq frame the origin o of the oepq frame is located at the vehicle center of mass the e axis is tangential to the latitude circle and points east the p axis is parallel to earth s polar axis the q axis is on the latitude plane which forms the right handed system with the e axis and p axis the characteristic of the oepq coordinate system is that there are no components of the earth rotation angular rate on the e axis and q axis the o frame is illustrated in fig 4 2 7 b body frame the body frame constitutes the familiar vehicle axes of pitch roll and yaw and has its origin at the vehicle center of mass the pitch axis points to the right hand side the roll axis points forward and the yaw axis points upward all with respect to the vehicle the b frame is illustrated in fig 5 2 error angle definitions δ θ position error angle ψ platform drift error angle φ total error angle the relationship between the vector angles δ θ ψ and φ is shown in fig 6 the meaning of vector angles δ θ ψ and φ are thus explained δ θ is such that if an n frame is rotated along its unit vector by an amount equivalent to δ θ the c frame is obtained similarly p frame is obtained by rotating the ψ angle of the c frame the total error φ is the sum of the platform drift error ψ and position error δ θ and it is necessary to rotate the vector angle φ from the n frame to the p frame 3 other symbols φ local latitude λ local longitude ω earth rotation rate ε gyro drift c a b transformation matrix from a frame to b frame u 1 u 3 u 2 u 3 1 u 1 u 2 u 1 1 the antisymmetric matrix of vector u u 1 u 2 u 3 t 3 theory 3 1 strapdown ins error equations in this section we will introduce the strapdown ins error model which is the prerequisite knowledge for the subsequent derivation the ψ angle error equations in strapdown ins that are used to update attitude position and velocity are expressed in the c frame zhao et al 2016 as 1 ψ c ω i c c ψ c c b c ε b 2 δ r c δ v c ω e c c δ r c 3 δ v c 2 ω i e c ω e c c δ v c δ f c δ g c where ψ c is the rate of growth of ψ in the c frame ω i c c is the angular velocity of the c frame relative to the i frame in the c frame the term c b c is the transformation matrix from the b frame to the c frame ε b are the gyro drifts in the b frame δ r c is the rate of growth of the position error in the c frame δ v c is the rate of growth of the velocity error in the c frame δ f c is the specific force error in the c frame and δ g c is the error of the gravity vector in the c frame there are two factors causing errors of the acceleration along the c frame f c platform drift ψ and accelerometer bias consequently δ f c can be expressed as follows 4 δ f c f c ψ c δ f c where ψ c is the vector angle ψ in the c frame δ f c is the accelerometer measurement error in the c frame f c is the specific force output by the accelerometer in the c frame from 4 it can be seen that the relationship between velocity error δ v c and ψ c is established via δ f c furthermore considering the relationship between ψ c and gyro drifts ε b we can calculate gyro drifts through velocity error in this paper the navigation calculation is carried out in the c frame which is the geographical frame of the computed position the origin of this frame is the position of the strapdown ins estimated by the computer in an ideal environment without errors the n frame c frame and p frame are completely coincident 3 2 derivation of psi equation according to the reference unified approach to inertial navigation system error modeling goshen meskin and bar itzhackf 1992 the general form of the psi equation for the platform inertial navigation system in the u frame can be written as follows 5 ψ u ω i u u ψ u c w u ε w where u represents any selected frame w represents the frame in which the gyroscopes are installed i represents inertial frame and ω i u u depicts the angular velocity of the u frame with respect to the i frame in the u frame in the platform inertial navigation system the role of the gyroscope is to control the angular motion of the inertial platform therefore the gyro drift directly causes the drift of the inertial platform and the positive gyro drift causes the positive drift of the platform the system reset method proposed in this paper is based on the strapdown inertial navigation system the gyroscope in the strapdown system is only used as a measuring component which is different from the platform inertial navigation system the direction of the gyro drift is opposite to the direction of the mathematical platform drift that is the positive gyro drift causes a negative mathematical platform drift and vice versa the gyroscopes are installed in the b frame for the strapdown ins so w is b frame body frame according to 5 when u i the psi equation in the i frame can be derived as 6 ψ i ω i i i ψ i c b i ε b where ω i i i 0 0 0 t therefore 7 ψ i c b i ε b where ψ i is the rate of growth of ψ in the i frame the term c b i can be obtained via iterative calculation of the following differential equation gao et al 2011 8 c b i c b i ω i b b where ω i b b are the gyro outputs and the value of c b i at the beginning of the system reset c b i t n is given by the following equation 9 c b i t n c i n t n 1 c b n t n where c b n t n is the transformation matrix from the b frame to the n frame at time point t n c i n t n is the transformation matrix from the i frame to the n frame at a time point t n 10 c i n t n sin λ ω i e t n cos λ ω i e t n 0 sin ϕ cos λ ω i e t n sin ϕ sin λ ω i e t n cos ϕ cos ϕ cos λ ω i e t n cos ϕ sin λ ω i e t n sin ϕ where the latitude information φ and longitude information λ of the vehicle can be provided by gps at the time point t n if the gps signal cannot be received they can also be provided by the strapdown ins itself the relationship between the position calculated by the strapdown ins and the true position is as follows 11 ϕ c ϕ δ ϕ λ c λ δ λ where ϕ c and λ c are the latitude value and longitude value calculated by the strapdown ins in the c frame respectively δ ϕ is the latitude error and δ λ is the longitude error based on geographical analysis they can be described by 12 δ λ δ p e r cos ϕ δ ϕ δ p n r where δ p e and δ p n are the east and north position errors of the strapdown ins respectively usually they are approximately a few nautical miles 1 nautical mile 1852 m for a normal strapdown ins let us consider a concrete instance in which ϕ π 4 δ p e δ p n 2 1852 m and r 6378393 m is earth s radius then 13 δ λ δ p e r cos ϕ 2 1852 6378393 cos π 4 8 21 10 4 r a d δ ϕ δ p n r 2 1852 6378393 5 81 10 4 r a d let us check the values of their sine and cosine functions as δ ϕ and δ λ are small quantities their sine and cosine functions can be approximated as 14 sin ϕ c sin ϕ δ ϕ sin ϕ cos δ ϕ sin ϕ cos δ ϕ sin ϕ similarly 15 cos ϕ c cos ϕ sin λ c sin λ cos λ c cos λ therefore if the gps signal cannot be obtained it is optional to use latitude and longitude information provided by the strapdown ins equation 7 is the derivative of the psi equation in the i frame on which we develop our approach to system reset of a strapdown ins here the psi equation in our method is compared with the psi equation in the conventional system reset methods in the conventional system reset methods for the platform inertial navigation system bona and smay 1962 benso and duplessis 1963 the gyroscopes are installed on the platform according to 5 when u o and w p platform frame the psi equation in the o frame oepq frame can be derived as 16 ψ o ω i o o ψ o c p o ε p where ω i o o ω i e o ω e o o and 17 c p o 1 0 0 0 cos ϕ sin ϕ 0 sin ϕ cos ϕ ω i e o 0 ω 0 t in the psi equation based on the oepq frame owing to the existence of the term ω i o o ψ o when solving the psi equation the following assumptions are made in the method 1 the ground velocity is sufficiently small to ensure the assumption ω i o ω i e and then ω i o is a constant vector in the o frame because ω i e is a constant vector in the o frame 2 the vehicle sails at the same latitude to solve the psi equation in the oepq frame c p o ε p is required to be a constant in the p frame the gyro drift ε p is a constant so the matrix c p o is required to remain unchanged according to 17 the vehicle is required to sail at the same latitude during system reset observing 7 it is clear that it differs from the psi equation in oepq frame it is constructed in the inertial frame and comprises only gyro drifts in the b frame the psi equation is in the inertial frame the term ω i i i ψ i is a zero term ω i i i 0 0 0 t therefore the requirement for low speed motion of the vehicle can be removed at the same time the matrix c b i is updated in real time so the requirement that the vehicle sails at the same latitude can also be removed in summary the derivation of the previous methods bona and smay 1962 benso and duplessis 1963 make some assumptions whereas our method does not make any special assumption precondition on the motions of the vehicle that is there is no extra limitation on vehicle movement in the system reset process the resolution of the derivative of ψ is 18 ψ i t ψ i 0 0 t c b i d t ε b where ε b ε x b ε y b ε z b according to 18 the psi equation can be given at t n and at t n 1 respectively as follows 19 ψ i t n ψ i 0 0 t n c b i d t ε b ψ i t n 1 ψ i 0 0 t n 1 c b i d t ε b furthermore the relationship between ψ i t n and ψ i t n 1 can be expressed as follows 20 ψ i t n 1 ψ i t n ψ i t n 1 t n where ψ i t n 1 t n is the growth of ψ i from the time point t n to the time point t n 1 moreover integrating 19 and 20 yields the following expression 21 ψ i t n 1 t n a t n 1 t n ε b where a t n 1 t n t n t n 1 c b i d t can be calculated iteratively by the output of the gyro 3 3 velocity error equation derivation in section 3 2 the psi equation relating the vector angle ψ and gyro drifts ε b has been established in order to relate the measured velocity and gyro drifts we derive the mathematical relationship between velocity error and vector angle ψ in this section substituting 4 into 3 yields 22 δ v c 2 ω i e c ω e c c δ v c f c ψ c δ f c δ g c where δ g c 0 0 δ g c t we describe 22 in matrix form as follows 23 δ v e c δ v n c δ v u c 0 ω z ω y ω z 0 ω x ω y ω x 0 δ v e c δ v n c δ v u c 0 f u c f n c f u c 0 f e c f n c f e p 0 ψ e c ψ n c ψ u c δ f e c δ f n c δ f u c δ g c where ω ω x ω y ω z t is the sum of the two angular velocities ω i e c and ω e c c as follows 24 ω 2 ω i e c ω e c c v n c r 2 ω i e cos ϕ c v e c r 2 ω i e sin ϕ c v e c r tan ϕ c in order to solve the above differential equation we utilize the laplace transform equation 23 in the time domain can be transformed into the frequency domain as follows 25 s δ v e c s s δ v n c s s δ v u c s 0 ω z ω y ω z 0 ω x ω y ω x 0 δ v e c s δ v n c s δ v u c s 0 f u c f n c f u c 0 f e c f n c f e p 0 ψ e c s ψ n c s ψ u c s δ v e 0 c δ v n 0 c δ v u 0 c δ f e c s δ f n c s δ f u c s δ g c s representing 25 in vector form yields 26 s x s a x s b y s x t 0 w s where x s δ v e c s δ v n c s δ v u c s y s ψ e c s ψ n c s ψ u c s x t 0 δ v e 0 c δ v n 0 c δ v u 0 c a 0 ω z ω y ω z 0 ω x ω y ω x 0 b 0 f u c f n c f u c 0 f e c f n c f e c 0 w s δ f e c s δ f n c s δ f u c s δ g c s and x t 0 is the initial velocity error after rearranging 26 we obtain 27 x s s i a 1 b y s x 0 w s where 28 s i a s ω z ω y ω z s ω x ω y ω x s the inverse of s i a can be given by 29 s i a 1 n s δ s where δ s is the determinant of s i a and n s is the adjoint matrix of s i a their detailed expressions are 30 δ s s 3 ω x 2 ω y 2 ω z 2 s 31 ν s s 2 ω x 2 ω z s ω x ω y ω y s ω x ω z ω z s ω x ω y s 2 ω y 2 ω x s ω y ω z ω y s ω x ω z ω x s ω y ω z s 2 ω z 2 substituting 29 into 27 yields 32 x s n s δ s b y s x t 0 w s n s δ s b y s n s δ s x t 0 w s furthermore we introduce the notations 33 f s n s δ s e s n s δ s b and simplify 32 as 34 x s e s y s f s x t 0 w s to obtain the time domain of 34 the inverse laplace transform of 34 is carried out 35 δ v e c t δ v n c t δ v u c t e t ψ e c t ψ n c t ψ u c t f t x t 0 w t where x t 0 δ v e 0 c δ v n 0 c δ v u 0 c w t δ f e c t δ f n c t δ f u c t δ g c t e t and f t are 3 3 matrixes the detailed expansions of which are given in the appendix let us recall that the psi equation 7 is expressed in the i frame thus the vector angle ψ c in 35 needs to be transformed into the i frame 36 δ v e c t δ v n c t δ v u c t ε t c i c t ψ x i t ψ y i t ψ z i t f t x t 0 w t where c i c t is the transformation matrix from the i frame to the c frame at a time point t which can be obtained by the strapdown ins outputs ϕ c and λ c as follows 37 c i c t sin λ c ω i e t cos λ c ω i e t 0 sin ϕ c cos λ c ω i e t sin ϕ c sin λ c ω i e t cos ϕ c cos ϕ c cos λ c ω i e t cos ϕ c sin λ c ω i e t sin ϕ c equation 36 represents our derived results in the form of a velocity error equation the mathematical relationship between velocity errors and the vector angle ψ i t is established through this equation as the vertical channel of the pure strapdown ins is unstable a depthometer is often installed to aid the strapdown ins for underwater vehicles this depthometer provides height information for the system and the vertical speed of the strapdown ins is reset by the speed provided by the dvl directly 3 4 gyro drifts estimation gyro drifts are the dominant error sources of the strapdown ins if it is possible to estimate them then the reset could be implemented to make the correction the general idea of our method is to obtain velocity information for one or 2 min from the dvl and then utilize 20 21 and 36 to estimate the gyro drifts after moving the vector angle ψ i t to the left of 36 the unknown quantities ψ i t are calculated as follows 38 ψ x i t ψ y i t ψ z i t e t c i c t 1 δ v e c t δ v n c t δ v u c t e t c i c t 1 f t x t 0 w t according to 38 the drifts at the time point t n ψ i t n can be obtained as follows 39 ψ x i t n ψ y i t n ψ z i t n e t n c i c t n 1 δ v e c t n δ v n c t n δ v u c t n e t n c i c t n 1 f t x t 0 w t n describing 39 in vector form we have 40 ψ i t n e t n c i c t n 1 δ v c t n e t n c i c t n 1 f t n x t 0 w t n where the vectors are ψ i t n ψ x i t n ψ y i t n ψ z i t n δ v c t n δ v e c t n δ v n c t n δ v u c t n in the same manner at the time point t n 1 we have 41 ψ i t n 1 e t n 1 c i c t n 1 1 δ v c t n 1 e t n 1 c i c t n 1 1 f t n 1 x t 0 w t n 1 in 40 and 41 δ v c t n and δ v c t n 1 are the velocity errors at the time points t n and t n 1 respectively they are the differences between the calculated velocities of the strapdown ins v i n s and the velocities of dvl v d v l 42 δ v c t n v i n s t n v d v l t n δ v c t n 1 v i n s t n 1 v d v l t n 1 subtracting ψ i t n from ψ i t n 1 yields 43 ψ i t n 1 ψ i t n e t n 1 c i c t n 1 1 δ v c t n 1 e t n c i c t n 1 δ v c t n e t n 1 c i c t n 1 1 f t n 1 x t 0 w t n 1 e t n c i c t n 1 f t n x t 0 w t n substituting 20 and 21 into 43 we have 44 a t n 1 t n ε b ψ i t n 1 t n ψ i t n 1 ψ i t n e t n 1 c i c t n 1 1 δ v c t n 1 e t n c i c t n 1 δ v c t n e t n 1 c i c t n 1 1 f t n 1 x t 0 w t n 1 e t n c i c t n 1 f t n x t 0 w t n generally accelerometer measurement errors w t could be assumed as a constant error i e w t n 1 w t n the initial value of the velocity error x t 0 is usually much larger than the measurement error of the accelerometer i e x t 0 dominates and w t n and w t n 1 are secondary in 44 and can be ignored then 44 becomes 45 a t n 1 t n ε b ψ i t n 1 t n ψ i t n 1 ψ i t n e t n 1 c i c t n 1 1 δ v c t n 1 e t n c i c t n 1 δ v c t n e t n 1 c i c t n 1 1 f t n 1 e t n c i c t n 1 f t n x t 0 according to the above equation the gyro drift quantities ε b are calculated as follows 46 ε b a t n 1 t n 1 e t n 1 c i c t n 1 1 δ v n t n 1 e t n c i c t n 1 δ v n t n e t n 1 c i c t n 1 1 f t n 1 e t n c i c t n 1 f t n x t 0 observing 46 we find that e t n 1 and e t n together with f t n 1 and f t n are the calculated results of the strapdown ins itself and only external velocity information from dvl is required in this method two dvl velocities at the sample points with a short interval often one or 2 min are sufficient as conventional methods usually take a few hours this novel method greatly reduces the time required for system reset 3 5 position and heading errors estimation in the conventional two point reset method the position and heading of strapdown ins are directly reset by using the external position and heading information however position and heading aiding information is usually difficult to obtain in practice for an underwater vehicle referring to section 3 4 where ψ is used as an intermediate vector to relate measurements and gyro drifts we will also use ψ to establish the relationship among velocity errors and the errors of position and heading following which the errors of position and heading can be estimated and corrected the mathematic relationship between the vector angle ψ and the errors of position and heading should be established here as described in section 2 the total error φ comprises two parts position error δ θ and platform drift error ψ therefore we can write 47 φ ψ δ θ considering the high precision pitch and roll from a strapdown ins we can assume that the level errors can be ignored 48 φ x φ y 0 therefore we obtain 49 δ θ x ψ x δ θ y ψ y δ θ z ψ z φ z in this article the geographic frame is set as the navigation frame the relationship between the vector angle δ θ and the position errors is as follows 50 δ θ x δ ϕ δ θ y δ λ cos ϕ δ θ z δ λ sin ϕ further determination of the heading error δk as being equal to the total error angle along the z axis φ z for an underwater vehicle is simple li et al 2015 specifically 51 δ k k c k φ z by arranging 49 50 and 51 the vector angle ψ position errors and heading error are related as 52 δ ϕ ψ x δ λ ψ y sec ϕ δ k ψ y tan ϕ ψ z we describe 52 in matrix form as follows 53 δ ϕ t δ λ t δ k t 1 0 0 0 sec ϕ t 0 0 tan ϕ t 1 ψ x n t ψ y n t ψ z n t the platform drift error angle ψ n in the n frame is converted into the i frame by the transformation matrix c i n i e ψ n c i n ψ i where c i n can be obtained using 10 then we can obtain 54 δ ϕ t δ λ t δ k t sin λ ω i e t cos λ ω i e t 0 tan ϕ cos λ ω i e t tan ϕ sin λ ω i e t 1 cos λ ω i e t tan ϕ sin ϕ cos ϕ sin λ ω i e t tan ϕ sin ϕ cos ϕ 0 ψ x i t ψ y i t ψ z i t by using the notation m t sin λ ω i e t cos λ ω i e t 0 tan ϕ cos λ ω i e t tan ϕ sin λ ω i e t 1 cos λ ω i e t tan ϕ sin ϕ cos ϕ sin λ ω i e t tan ϕ sin ϕ cos ϕ 0 we have 55 p t m t ψ i t where p t δ ϕ t δ λ t δ k t t equation 55 represents the deduced results and is called the p equation here the mathematical relationship between the position errors heading error and the platform drift error angle ψ is established through this equation substituting 38 into the p equation yields 56 p t m t e t c i c t 1 δ v c t m t e t c i c t 1 f t x t 0 in this method we need to obtain two points of external velocity information and the interval is only 2 min therefore we only estimate the errors of position and heading at the second point t n 1 according to 56 the errors of position and heading at the time point t n 1 can be calculated by 57 δ ϕ t n 1 δ λ t n 1 δ k t n 1 m t n 1 e t n 1 c i c t n 1 1 δ v e c t n 1 δ v n c t n 1 δ v u c t n 1 m t n 1 e t n 1 c i c t n 1 1 f t n 1 x t 0 based on the above sections the procedure of the proposed system reset method for a dvl aiding strapdown ins is summarized in table 1 4 simulation and trial 4 1 simulation in this section we report on a simulation experiment conducted to verify the performance of the proposed system reset for strapdown ins medium precision gyroscopes and accelerometers were applied in the simulator the constant drifts of the gyroscope were 0 05 deg h and the accelerometer biases were 0 0001 g the strapdown ins obtained the external velocity information from the dvl at 2 min intervals in the system reset process we need to obtain the velocity information of two points and correct the system errors only at the second time point so the entire process takes only 2 min the total duration of the entire simulation experiment was 8 h the system reset was performed at the sixth hour and the system errors were corrected after 2 min here we provide the following clarification before presenting the results of the simulation the heading error and the two level gyro drifts are coupled together and they are inseparable if no accurate external heading information is provided employing the integrated navigation system to estimate the gyro drifts and compensating the system errors can also result in the same conclusion as the above clarification ben et al 2014 therefore we only corrected the z axis gyro drift in the simulation we applied the three motion schemes in table 2 to verify that the proposed method can be used in the actual system the system reset proposed in this paper was implemented in the above three motion schemes the results of the gyro drift estimation are listed in table 3 we can observe from table 3 that the z axis gyro drift ε z b can be estimated accurately in the three motion schemes but the x axis gyro drift ε x b and y axis gyro drift ε y b cannot be estimated this result is consistent with the clarification given before the motion schemes of the simulation were proposed that is the two level gyro drifts and heading error cannot be separated if no accurate external heading information is available the mean value and standard deviation value of the ε z b estimation are 0 04948 deg h and 0 00307 deg h respectively in addition by observing the estimations of the z axis gyro drift in the three schemes it can be further concluded that the state of the vehicle motion will not affect the estimation result we will applied the system reset on the strapdown ins after getting the above estimation results here considering the length limitations of the paper we only give the figures of the system reset for motion scheme 1 in table 2 because the other two motion schemes have similar results we applied the following four reset scenarios 1 no reset 2 only velocity reset 3 velocity reset position error and heading error corrections 4 velocity reset position error heading error and orientation gyro drift corrections the simulation results of latitude and longitude errors velocity errors and heading error are given in figs 7 9 figs 7 9 compare the system errors of the four reset scenarios compared with no reset there are fluctuations of different degrees after the implementation of the other three reset scenarios resulting in overshoot however the system will stabilize after a short period of time and the relative transient behavior after the system reset can be seen in the figures by observing figs 7 9 we compare the performance of the system with different reset scenarios and summarize the conclusions 1 if no reset occurred in the system the errors of the strapdown ins increase with time because of error sources such as the gyro drift and the latitude error 2 if only velocity reset occurred in the system the east velocity error and north velocity error can be completely eliminated at the second time point but they subsequently increase quickly and there is no obvious change in the position and heading errors 3 if velocity reset position error and heading error corrections are performed in the system the values of the velocity error are slightly smaller than in the only velocity reset scheme but the change trend of the velocity errors is consistent the position and heading errors are reduced rapidly at the second time point and they subsequently increase at the previous rate 4 if velocity reset position error heading error and orientation gyro drift corrections have all been performed in the system the system errors are rapidly reduced and can be limited to a preferable range therefore this case is the optimal system reset scheme 4 2 trial we conducted the trial in huludao to validate the feasibility and availability of the proposed system reset method the main trial equipment is shown in fig 10 we installed the self made strapdown ins the high precision inertial navigation system phins and a dvl on board at the bottom of the boat we used the data output by phins as the reference value for attitude position and velocity to measure the performance of the proposed system reset method and the dvl was used to provide the external velocity information phins ixblue france served as the benchmark the gyro constant drift was 0 01 deg h and the accelerometer bias was 5 10 5 g the phins is actually a gps ins integrated navigation system and the gps and ins information is combined through a kalman filter in addition it can detect gps malfunctions and prevent the input of wrong signals the trial procedure was as follows starting from the end of the initial alignment of the vehicle the system reset was performed in the fifth hour and the system errors were corrected after 2 min the total duration of the trial was 20 h the trial results are given in figs 11 15 velocity errors latitude and longitude errors and heading errors are given in figs 11 15 from the figures it can be seen that the errors of velocity position and heading increase quickly if the strapdown ins is not reset the coupling of gyro drifts heading and velocity leads to the rapid development of velocity errors the maximum amplitude values of the east velocity error and north velocity error are 2 5 m s and 1 5 m s respectively both the maximum amplitude values of the latitude error and longitude error are approximately 4 104 m the heading error fluctuates greatly if we apply the system reset method proposed in this paper all the errors of the strapdown ins including velocity errors position errors heading error and z axis gyro drift will be corrected after the system reset the maximum amplitude values of the east velocity error and north velocity error are not more than 0 5 m s the latitude error is stable in the range of 2000 m the longitude error is not more than 5000 m the maximum value of the heading error is only approximately 0 1 from figs 11 15 it is clear that the correction scenario not only removes the velocity errors and heading error at the reset time point but counteracts the error sources of velocity such as gyro drift latitude error etc the system reset method proposed in this paper can control the system errors in a desirable scope improving the navigation accuracy of the strapdown ins 5 conclusions in this paper because conventional system reset methods usually take a long time and multi point position information is generally difficult to obtain in underwater scenarios a new system reset method based on velocity information was proposed for a strapdown ins in the proposed method gyro drift and position and heading errors are estimated and corrected by using external velocity information in a short period simulation and trial results verified the feasibility of the proposed system reset method and showed that it can effectively improve the accuracy of the strapdown ins for long term navigation acknowledgements funding this work was supported by the postdoctoral science foundation of china grant number 2015m581440 the national natural science foundation of china grant numbers 61503090 51509063 and the heilongjiang natural science foundation grant number qc2015078 appendix detailed expansions this section gives the detailed expressions for e t and f t they are written as e t e 11 t e 12 t e 13 t e 21 t e 22 t e 23 t e 31 t e 32 t e 33 t f t f 11 t f 12 t f 13 t f 21 t f 22 t f 23 t f 31 t f 32 t f 33 t where the elements of matrices e t and f t in the calculation process are e 11 t ω z ω sin ω t ω x ω y ω 2 1 cos ω t f u c t ω y ω sin ω t ω x ω z ω 2 1 cos ω t f n c t e 12 t cos ω t ω x 2 ω 2 1 cos ω t f u c t ω y ω sin ω t ω x ω z ω 2 1 cos ω t f e c t e 13 t cos ω t ω x 2 ω 2 1 cos ω t f n c t ω z ω sin ω t ω x ω y ω 2 1 cos ω t f e c t e 21 t cos ω t ω y 2 ω 2 1 cos ω t f u c t ω x ω sin ω t ω y ω z ω 2 1 cos ω t f n c t e 22 t ω z ω sin ω t ω x ω y ω 2 1 cos ω t f u c t ω x ω sin ω t ω y ω z ω 2 1 cos ω t f e c t e 23 t ω z ω sin ω t ω x ω y ω 2 1 cos ω t f n c t cos ω t ω y 2 ω 2 1 cos ω t f e c t e 31 t ω x ω sin ω t ω y ω z ω 2 1 cos ω t f u c t cos ω t ω z 2 ω 2 1 cos ω t f n c t e 32 t ω y ω sin ω t ω x ω z ω 2 1 cos ω t f u c t cos ω t ω z 2 ω 2 1 cos ω t f e c t e 33 t ω y ω sin ω t ω x ω z ω 2 1 cos ω t f n c t ω x ω cos ω t ω y ω z ω 2 1 cos ω t f e c t f 11 t c o s ω t ω x 2 ω 2 1 c o s ω t f 12 t ω z ω sin ω t ω x ω y ω 2 1 c o s ω t f 13 t ω y ω sin ω t ω x ω z ω 2 1 c o s ω t f 21 t ω z ω sin ω t ω x ω y ω 2 1 c o s ω t f 22 t c o s ω t ω y 2 ω 2 1 c o s ω t f 23 t ω x ω sin ω t ω y ω z ω 2 1 c o s ω t f 31 t ω y ω sin ω t ω x ω z ω 2 1 c o s ω t f 32 t ω x ω sin ω t ω y ω z ω 2 1 c o s ω t f 33 t c o s ω t ω z 2 ω 2 1 c o s ω t where ω 2 ω x 2 ω y 2 ω z 2 v n c r 2 2 ω i e v e c r cos ϕ 2 
22816,conventional system reset methods establish the relationship between measurements such as position or heading and gyro drifts by the psi equation following which they iteratively calculate the gyro drifts however these methods have some limitations in practice first the process of system reset takes a long time and usually the interval between two samples is a few hours second the position information of multiple points is generally difficult to obtain for an underwater vehicle in order to solve the above problem a system reset method suitable for underwater strapdown inertial navigation system ins is proposed in this paper this method uses external velocity as aiding information which relates the measurement velocity to gyro drifts position and heading by the intermediate vector on the geographical frame and then calculates the gyro drifts and the errors of position and heading the results of simulation and trial show that the proposed system reset method only spends 2 min on correcting system errors including gyro drifts position errors and heading error only using the aiding velocities from a doppler velocity log keywords strapdown ins system reset external velocity information gyro drift 1 introduction from the analysis of the inertial navigation system gyro drifts are known to be the primary cause of system error accumulation the following two methods are implemented to solve this problem 1 select high performance gyroscopes and accelerometers or 2 estimate the gyro drifts and make the correction cheng et al 2014 although the application of high performance gyroscopes and accelerometers most effectively increases the accuracy of inertial navigation systems this method is very cost expensive therefore estimating the gyro drifts is commonly the preferred method as no extra cost is incurred as a result of implementing this method in order to estimate the gyro drifts and bound the system errors the usual option is to apply integrated navigation technology xue et al 2011 the accurate position and velocity of the strapdown ins obtained from the external equipment are used as measurements and then a filter algorithm is applied to estimate and compensate the system errors thus the errors do not diverge compared with a pure strapdown ins kaygisiz and sen 2015 de silva et al 2015 however an integrated navigation system needs successive external measurements for more than 20 min to stabilize tucker et al 2000 the system estimates gyro drifts and misalignment angles in these 20 min but the estimates are unstable i e the system requires an adjustment process furthermore because the time consuming and successive measurements are often difficult to obtain underwater integrated navigation technology is not suitable for underwater vehicles gao et al 2017 xu et al 2017 system reset is another option to estimate and correct gyro drifts to date there have been many reports on system reset in the early 1960s a system reset method based on a deterministic model was proposed to limit the errors of the platform ins installed on a vehicle at sea bona and smay 1962 in addition benso and duplessis presented a three fix reset scheme using position and heading information and then analyzed the errors after the reset was performed benso and duplessis 1963 based on the three fix reset scheme the idea of point point reset was developed in which the second point in the three fix reset scheme is considered the first point of the next reset such that the estimation and compensation can be performed after each acquisition of position information yang provided an elaborate error analysis during the two point system reset and deduced the relationship between the estimation errors of the gyro drift the accuracy of the external measurement and the level angle errors xiaodong and taiguang 2011 in all the above methods the gyro is installed on the platform and the torque output by the gyro can control the platform to follow the navigation coordinate system these methods are the system reset technologies for the platform ins the strapdown ins is currently in wide use various system reset methods suitable for strapdown ins have been proposed as a result of improving the system reset method of the platform ins as with the platform ins conventional system reset methods of the strapdown ins have also been categorized as either a two point reset three point reset or point point reset shi and yang 2016 the two point system reset method requires the position and heading information of two points however because the heading information is difficult to obtain the three point system reset method is most commonly implemented in practice as this method only requires the position information of three points ben et al 2014 as compared to the integrated navigation technology the system reset method only requires occasional measurements at two or three measurement points instead of successive measurements however the time interval between point measurements is long typically lasting more than 1 h furthermore and more importantly multi point position measurements are difficult to obtain for an underwater vehicle therefore the existing system reset methods cannot be well applied to an underwater strapdown ins in this study a novel system reset method suitable for an underwater strapdown ins was developed to rectify the problems outlined above with this method the gyro drifts are quickly estimated and corrected in a matter of 1 2 min based on velocity information and position and heading errors are simultaneously calculated moreover because a doppler velocity log dvl is effectively used underwater the accuracy of its average measurement velocity is high gao et al 2014 thus the velocity information is provided by the dvl in this study compared with conventional system reset methods and integrated navigation systems the novel method proposed in this study significantly reduces the time required for a system reset to approximately 2 min 2 nomenclature commonly used nomenclature in this article 1 frame definitions 2 1 i inertial frame the origin of the inertial frame is earth s center of mass the z axis is along earth s polar axis the x axis and y axis lie in the equatorial plane and point to a fixed star 2 2 e earth frame the origin of the earth frame is earth s center of mass the z axis is along earth s polar axis the x axis lies along the intersection of the plane of the greenwich meridian with earth s equatorial plane the y axis is in the equatorial plane which forms the right handed system with the x axis and y axis the earth frame rotates with respect to the inertial frame at a rate ω earth rotation rate about the z axis the i frame and e frame are illustrated in fig 1 2 3 n navigation frame in this study the geographic frame was selected as the navigation frame the geographic frame is a local navigational frame that has its origin at the system s true location and its axes aligned with the east north and up directions 2 4 p mathematical platform frame the platform frame is used to track the navigation frame when there is no error in the strapdown inertial navigation system the platform frame and the navigation frame coincide when the strapdown inertial navigation system has errors the error angle will appear between the platform frame and the navigation frame the n frame and p frame are illustrated in fig 2 2 5 c geographical frame of the computed position this frame is a local navigational frame that has its origin at the system s computed location and its axes aligned with the east north and up directions the only difference from the n frame is that the origin of the c frame is at the calculation position the relationship between the n frame and c frame is illustrated in fig 3 where δ ϕ is the latitude error and δ λ is the longitude error 2 6 o oepq frame the origin o of the oepq frame is located at the vehicle center of mass the e axis is tangential to the latitude circle and points east the p axis is parallel to earth s polar axis the q axis is on the latitude plane which forms the right handed system with the e axis and p axis the characteristic of the oepq coordinate system is that there are no components of the earth rotation angular rate on the e axis and q axis the o frame is illustrated in fig 4 2 7 b body frame the body frame constitutes the familiar vehicle axes of pitch roll and yaw and has its origin at the vehicle center of mass the pitch axis points to the right hand side the roll axis points forward and the yaw axis points upward all with respect to the vehicle the b frame is illustrated in fig 5 2 error angle definitions δ θ position error angle ψ platform drift error angle φ total error angle the relationship between the vector angles δ θ ψ and φ is shown in fig 6 the meaning of vector angles δ θ ψ and φ are thus explained δ θ is such that if an n frame is rotated along its unit vector by an amount equivalent to δ θ the c frame is obtained similarly p frame is obtained by rotating the ψ angle of the c frame the total error φ is the sum of the platform drift error ψ and position error δ θ and it is necessary to rotate the vector angle φ from the n frame to the p frame 3 other symbols φ local latitude λ local longitude ω earth rotation rate ε gyro drift c a b transformation matrix from a frame to b frame u 1 u 3 u 2 u 3 1 u 1 u 2 u 1 1 the antisymmetric matrix of vector u u 1 u 2 u 3 t 3 theory 3 1 strapdown ins error equations in this section we will introduce the strapdown ins error model which is the prerequisite knowledge for the subsequent derivation the ψ angle error equations in strapdown ins that are used to update attitude position and velocity are expressed in the c frame zhao et al 2016 as 1 ψ c ω i c c ψ c c b c ε b 2 δ r c δ v c ω e c c δ r c 3 δ v c 2 ω i e c ω e c c δ v c δ f c δ g c where ψ c is the rate of growth of ψ in the c frame ω i c c is the angular velocity of the c frame relative to the i frame in the c frame the term c b c is the transformation matrix from the b frame to the c frame ε b are the gyro drifts in the b frame δ r c is the rate of growth of the position error in the c frame δ v c is the rate of growth of the velocity error in the c frame δ f c is the specific force error in the c frame and δ g c is the error of the gravity vector in the c frame there are two factors causing errors of the acceleration along the c frame f c platform drift ψ and accelerometer bias consequently δ f c can be expressed as follows 4 δ f c f c ψ c δ f c where ψ c is the vector angle ψ in the c frame δ f c is the accelerometer measurement error in the c frame f c is the specific force output by the accelerometer in the c frame from 4 it can be seen that the relationship between velocity error δ v c and ψ c is established via δ f c furthermore considering the relationship between ψ c and gyro drifts ε b we can calculate gyro drifts through velocity error in this paper the navigation calculation is carried out in the c frame which is the geographical frame of the computed position the origin of this frame is the position of the strapdown ins estimated by the computer in an ideal environment without errors the n frame c frame and p frame are completely coincident 3 2 derivation of psi equation according to the reference unified approach to inertial navigation system error modeling goshen meskin and bar itzhackf 1992 the general form of the psi equation for the platform inertial navigation system in the u frame can be written as follows 5 ψ u ω i u u ψ u c w u ε w where u represents any selected frame w represents the frame in which the gyroscopes are installed i represents inertial frame and ω i u u depicts the angular velocity of the u frame with respect to the i frame in the u frame in the platform inertial navigation system the role of the gyroscope is to control the angular motion of the inertial platform therefore the gyro drift directly causes the drift of the inertial platform and the positive gyro drift causes the positive drift of the platform the system reset method proposed in this paper is based on the strapdown inertial navigation system the gyroscope in the strapdown system is only used as a measuring component which is different from the platform inertial navigation system the direction of the gyro drift is opposite to the direction of the mathematical platform drift that is the positive gyro drift causes a negative mathematical platform drift and vice versa the gyroscopes are installed in the b frame for the strapdown ins so w is b frame body frame according to 5 when u i the psi equation in the i frame can be derived as 6 ψ i ω i i i ψ i c b i ε b where ω i i i 0 0 0 t therefore 7 ψ i c b i ε b where ψ i is the rate of growth of ψ in the i frame the term c b i can be obtained via iterative calculation of the following differential equation gao et al 2011 8 c b i c b i ω i b b where ω i b b are the gyro outputs and the value of c b i at the beginning of the system reset c b i t n is given by the following equation 9 c b i t n c i n t n 1 c b n t n where c b n t n is the transformation matrix from the b frame to the n frame at time point t n c i n t n is the transformation matrix from the i frame to the n frame at a time point t n 10 c i n t n sin λ ω i e t n cos λ ω i e t n 0 sin ϕ cos λ ω i e t n sin ϕ sin λ ω i e t n cos ϕ cos ϕ cos λ ω i e t n cos ϕ sin λ ω i e t n sin ϕ where the latitude information φ and longitude information λ of the vehicle can be provided by gps at the time point t n if the gps signal cannot be received they can also be provided by the strapdown ins itself the relationship between the position calculated by the strapdown ins and the true position is as follows 11 ϕ c ϕ δ ϕ λ c λ δ λ where ϕ c and λ c are the latitude value and longitude value calculated by the strapdown ins in the c frame respectively δ ϕ is the latitude error and δ λ is the longitude error based on geographical analysis they can be described by 12 δ λ δ p e r cos ϕ δ ϕ δ p n r where δ p e and δ p n are the east and north position errors of the strapdown ins respectively usually they are approximately a few nautical miles 1 nautical mile 1852 m for a normal strapdown ins let us consider a concrete instance in which ϕ π 4 δ p e δ p n 2 1852 m and r 6378393 m is earth s radius then 13 δ λ δ p e r cos ϕ 2 1852 6378393 cos π 4 8 21 10 4 r a d δ ϕ δ p n r 2 1852 6378393 5 81 10 4 r a d let us check the values of their sine and cosine functions as δ ϕ and δ λ are small quantities their sine and cosine functions can be approximated as 14 sin ϕ c sin ϕ δ ϕ sin ϕ cos δ ϕ sin ϕ cos δ ϕ sin ϕ similarly 15 cos ϕ c cos ϕ sin λ c sin λ cos λ c cos λ therefore if the gps signal cannot be obtained it is optional to use latitude and longitude information provided by the strapdown ins equation 7 is the derivative of the psi equation in the i frame on which we develop our approach to system reset of a strapdown ins here the psi equation in our method is compared with the psi equation in the conventional system reset methods in the conventional system reset methods for the platform inertial navigation system bona and smay 1962 benso and duplessis 1963 the gyroscopes are installed on the platform according to 5 when u o and w p platform frame the psi equation in the o frame oepq frame can be derived as 16 ψ o ω i o o ψ o c p o ε p where ω i o o ω i e o ω e o o and 17 c p o 1 0 0 0 cos ϕ sin ϕ 0 sin ϕ cos ϕ ω i e o 0 ω 0 t in the psi equation based on the oepq frame owing to the existence of the term ω i o o ψ o when solving the psi equation the following assumptions are made in the method 1 the ground velocity is sufficiently small to ensure the assumption ω i o ω i e and then ω i o is a constant vector in the o frame because ω i e is a constant vector in the o frame 2 the vehicle sails at the same latitude to solve the psi equation in the oepq frame c p o ε p is required to be a constant in the p frame the gyro drift ε p is a constant so the matrix c p o is required to remain unchanged according to 17 the vehicle is required to sail at the same latitude during system reset observing 7 it is clear that it differs from the psi equation in oepq frame it is constructed in the inertial frame and comprises only gyro drifts in the b frame the psi equation is in the inertial frame the term ω i i i ψ i is a zero term ω i i i 0 0 0 t therefore the requirement for low speed motion of the vehicle can be removed at the same time the matrix c b i is updated in real time so the requirement that the vehicle sails at the same latitude can also be removed in summary the derivation of the previous methods bona and smay 1962 benso and duplessis 1963 make some assumptions whereas our method does not make any special assumption precondition on the motions of the vehicle that is there is no extra limitation on vehicle movement in the system reset process the resolution of the derivative of ψ is 18 ψ i t ψ i 0 0 t c b i d t ε b where ε b ε x b ε y b ε z b according to 18 the psi equation can be given at t n and at t n 1 respectively as follows 19 ψ i t n ψ i 0 0 t n c b i d t ε b ψ i t n 1 ψ i 0 0 t n 1 c b i d t ε b furthermore the relationship between ψ i t n and ψ i t n 1 can be expressed as follows 20 ψ i t n 1 ψ i t n ψ i t n 1 t n where ψ i t n 1 t n is the growth of ψ i from the time point t n to the time point t n 1 moreover integrating 19 and 20 yields the following expression 21 ψ i t n 1 t n a t n 1 t n ε b where a t n 1 t n t n t n 1 c b i d t can be calculated iteratively by the output of the gyro 3 3 velocity error equation derivation in section 3 2 the psi equation relating the vector angle ψ and gyro drifts ε b has been established in order to relate the measured velocity and gyro drifts we derive the mathematical relationship between velocity error and vector angle ψ in this section substituting 4 into 3 yields 22 δ v c 2 ω i e c ω e c c δ v c f c ψ c δ f c δ g c where δ g c 0 0 δ g c t we describe 22 in matrix form as follows 23 δ v e c δ v n c δ v u c 0 ω z ω y ω z 0 ω x ω y ω x 0 δ v e c δ v n c δ v u c 0 f u c f n c f u c 0 f e c f n c f e p 0 ψ e c ψ n c ψ u c δ f e c δ f n c δ f u c δ g c where ω ω x ω y ω z t is the sum of the two angular velocities ω i e c and ω e c c as follows 24 ω 2 ω i e c ω e c c v n c r 2 ω i e cos ϕ c v e c r 2 ω i e sin ϕ c v e c r tan ϕ c in order to solve the above differential equation we utilize the laplace transform equation 23 in the time domain can be transformed into the frequency domain as follows 25 s δ v e c s s δ v n c s s δ v u c s 0 ω z ω y ω z 0 ω x ω y ω x 0 δ v e c s δ v n c s δ v u c s 0 f u c f n c f u c 0 f e c f n c f e p 0 ψ e c s ψ n c s ψ u c s δ v e 0 c δ v n 0 c δ v u 0 c δ f e c s δ f n c s δ f u c s δ g c s representing 25 in vector form yields 26 s x s a x s b y s x t 0 w s where x s δ v e c s δ v n c s δ v u c s y s ψ e c s ψ n c s ψ u c s x t 0 δ v e 0 c δ v n 0 c δ v u 0 c a 0 ω z ω y ω z 0 ω x ω y ω x 0 b 0 f u c f n c f u c 0 f e c f n c f e c 0 w s δ f e c s δ f n c s δ f u c s δ g c s and x t 0 is the initial velocity error after rearranging 26 we obtain 27 x s s i a 1 b y s x 0 w s where 28 s i a s ω z ω y ω z s ω x ω y ω x s the inverse of s i a can be given by 29 s i a 1 n s δ s where δ s is the determinant of s i a and n s is the adjoint matrix of s i a their detailed expressions are 30 δ s s 3 ω x 2 ω y 2 ω z 2 s 31 ν s s 2 ω x 2 ω z s ω x ω y ω y s ω x ω z ω z s ω x ω y s 2 ω y 2 ω x s ω y ω z ω y s ω x ω z ω x s ω y ω z s 2 ω z 2 substituting 29 into 27 yields 32 x s n s δ s b y s x t 0 w s n s δ s b y s n s δ s x t 0 w s furthermore we introduce the notations 33 f s n s δ s e s n s δ s b and simplify 32 as 34 x s e s y s f s x t 0 w s to obtain the time domain of 34 the inverse laplace transform of 34 is carried out 35 δ v e c t δ v n c t δ v u c t e t ψ e c t ψ n c t ψ u c t f t x t 0 w t where x t 0 δ v e 0 c δ v n 0 c δ v u 0 c w t δ f e c t δ f n c t δ f u c t δ g c t e t and f t are 3 3 matrixes the detailed expansions of which are given in the appendix let us recall that the psi equation 7 is expressed in the i frame thus the vector angle ψ c in 35 needs to be transformed into the i frame 36 δ v e c t δ v n c t δ v u c t ε t c i c t ψ x i t ψ y i t ψ z i t f t x t 0 w t where c i c t is the transformation matrix from the i frame to the c frame at a time point t which can be obtained by the strapdown ins outputs ϕ c and λ c as follows 37 c i c t sin λ c ω i e t cos λ c ω i e t 0 sin ϕ c cos λ c ω i e t sin ϕ c sin λ c ω i e t cos ϕ c cos ϕ c cos λ c ω i e t cos ϕ c sin λ c ω i e t sin ϕ c equation 36 represents our derived results in the form of a velocity error equation the mathematical relationship between velocity errors and the vector angle ψ i t is established through this equation as the vertical channel of the pure strapdown ins is unstable a depthometer is often installed to aid the strapdown ins for underwater vehicles this depthometer provides height information for the system and the vertical speed of the strapdown ins is reset by the speed provided by the dvl directly 3 4 gyro drifts estimation gyro drifts are the dominant error sources of the strapdown ins if it is possible to estimate them then the reset could be implemented to make the correction the general idea of our method is to obtain velocity information for one or 2 min from the dvl and then utilize 20 21 and 36 to estimate the gyro drifts after moving the vector angle ψ i t to the left of 36 the unknown quantities ψ i t are calculated as follows 38 ψ x i t ψ y i t ψ z i t e t c i c t 1 δ v e c t δ v n c t δ v u c t e t c i c t 1 f t x t 0 w t according to 38 the drifts at the time point t n ψ i t n can be obtained as follows 39 ψ x i t n ψ y i t n ψ z i t n e t n c i c t n 1 δ v e c t n δ v n c t n δ v u c t n e t n c i c t n 1 f t x t 0 w t n describing 39 in vector form we have 40 ψ i t n e t n c i c t n 1 δ v c t n e t n c i c t n 1 f t n x t 0 w t n where the vectors are ψ i t n ψ x i t n ψ y i t n ψ z i t n δ v c t n δ v e c t n δ v n c t n δ v u c t n in the same manner at the time point t n 1 we have 41 ψ i t n 1 e t n 1 c i c t n 1 1 δ v c t n 1 e t n 1 c i c t n 1 1 f t n 1 x t 0 w t n 1 in 40 and 41 δ v c t n and δ v c t n 1 are the velocity errors at the time points t n and t n 1 respectively they are the differences between the calculated velocities of the strapdown ins v i n s and the velocities of dvl v d v l 42 δ v c t n v i n s t n v d v l t n δ v c t n 1 v i n s t n 1 v d v l t n 1 subtracting ψ i t n from ψ i t n 1 yields 43 ψ i t n 1 ψ i t n e t n 1 c i c t n 1 1 δ v c t n 1 e t n c i c t n 1 δ v c t n e t n 1 c i c t n 1 1 f t n 1 x t 0 w t n 1 e t n c i c t n 1 f t n x t 0 w t n substituting 20 and 21 into 43 we have 44 a t n 1 t n ε b ψ i t n 1 t n ψ i t n 1 ψ i t n e t n 1 c i c t n 1 1 δ v c t n 1 e t n c i c t n 1 δ v c t n e t n 1 c i c t n 1 1 f t n 1 x t 0 w t n 1 e t n c i c t n 1 f t n x t 0 w t n generally accelerometer measurement errors w t could be assumed as a constant error i e w t n 1 w t n the initial value of the velocity error x t 0 is usually much larger than the measurement error of the accelerometer i e x t 0 dominates and w t n and w t n 1 are secondary in 44 and can be ignored then 44 becomes 45 a t n 1 t n ε b ψ i t n 1 t n ψ i t n 1 ψ i t n e t n 1 c i c t n 1 1 δ v c t n 1 e t n c i c t n 1 δ v c t n e t n 1 c i c t n 1 1 f t n 1 e t n c i c t n 1 f t n x t 0 according to the above equation the gyro drift quantities ε b are calculated as follows 46 ε b a t n 1 t n 1 e t n 1 c i c t n 1 1 δ v n t n 1 e t n c i c t n 1 δ v n t n e t n 1 c i c t n 1 1 f t n 1 e t n c i c t n 1 f t n x t 0 observing 46 we find that e t n 1 and e t n together with f t n 1 and f t n are the calculated results of the strapdown ins itself and only external velocity information from dvl is required in this method two dvl velocities at the sample points with a short interval often one or 2 min are sufficient as conventional methods usually take a few hours this novel method greatly reduces the time required for system reset 3 5 position and heading errors estimation in the conventional two point reset method the position and heading of strapdown ins are directly reset by using the external position and heading information however position and heading aiding information is usually difficult to obtain in practice for an underwater vehicle referring to section 3 4 where ψ is used as an intermediate vector to relate measurements and gyro drifts we will also use ψ to establish the relationship among velocity errors and the errors of position and heading following which the errors of position and heading can be estimated and corrected the mathematic relationship between the vector angle ψ and the errors of position and heading should be established here as described in section 2 the total error φ comprises two parts position error δ θ and platform drift error ψ therefore we can write 47 φ ψ δ θ considering the high precision pitch and roll from a strapdown ins we can assume that the level errors can be ignored 48 φ x φ y 0 therefore we obtain 49 δ θ x ψ x δ θ y ψ y δ θ z ψ z φ z in this article the geographic frame is set as the navigation frame the relationship between the vector angle δ θ and the position errors is as follows 50 δ θ x δ ϕ δ θ y δ λ cos ϕ δ θ z δ λ sin ϕ further determination of the heading error δk as being equal to the total error angle along the z axis φ z for an underwater vehicle is simple li et al 2015 specifically 51 δ k k c k φ z by arranging 49 50 and 51 the vector angle ψ position errors and heading error are related as 52 δ ϕ ψ x δ λ ψ y sec ϕ δ k ψ y tan ϕ ψ z we describe 52 in matrix form as follows 53 δ ϕ t δ λ t δ k t 1 0 0 0 sec ϕ t 0 0 tan ϕ t 1 ψ x n t ψ y n t ψ z n t the platform drift error angle ψ n in the n frame is converted into the i frame by the transformation matrix c i n i e ψ n c i n ψ i where c i n can be obtained using 10 then we can obtain 54 δ ϕ t δ λ t δ k t sin λ ω i e t cos λ ω i e t 0 tan ϕ cos λ ω i e t tan ϕ sin λ ω i e t 1 cos λ ω i e t tan ϕ sin ϕ cos ϕ sin λ ω i e t tan ϕ sin ϕ cos ϕ 0 ψ x i t ψ y i t ψ z i t by using the notation m t sin λ ω i e t cos λ ω i e t 0 tan ϕ cos λ ω i e t tan ϕ sin λ ω i e t 1 cos λ ω i e t tan ϕ sin ϕ cos ϕ sin λ ω i e t tan ϕ sin ϕ cos ϕ 0 we have 55 p t m t ψ i t where p t δ ϕ t δ λ t δ k t t equation 55 represents the deduced results and is called the p equation here the mathematical relationship between the position errors heading error and the platform drift error angle ψ is established through this equation substituting 38 into the p equation yields 56 p t m t e t c i c t 1 δ v c t m t e t c i c t 1 f t x t 0 in this method we need to obtain two points of external velocity information and the interval is only 2 min therefore we only estimate the errors of position and heading at the second point t n 1 according to 56 the errors of position and heading at the time point t n 1 can be calculated by 57 δ ϕ t n 1 δ λ t n 1 δ k t n 1 m t n 1 e t n 1 c i c t n 1 1 δ v e c t n 1 δ v n c t n 1 δ v u c t n 1 m t n 1 e t n 1 c i c t n 1 1 f t n 1 x t 0 based on the above sections the procedure of the proposed system reset method for a dvl aiding strapdown ins is summarized in table 1 4 simulation and trial 4 1 simulation in this section we report on a simulation experiment conducted to verify the performance of the proposed system reset for strapdown ins medium precision gyroscopes and accelerometers were applied in the simulator the constant drifts of the gyroscope were 0 05 deg h and the accelerometer biases were 0 0001 g the strapdown ins obtained the external velocity information from the dvl at 2 min intervals in the system reset process we need to obtain the velocity information of two points and correct the system errors only at the second time point so the entire process takes only 2 min the total duration of the entire simulation experiment was 8 h the system reset was performed at the sixth hour and the system errors were corrected after 2 min here we provide the following clarification before presenting the results of the simulation the heading error and the two level gyro drifts are coupled together and they are inseparable if no accurate external heading information is provided employing the integrated navigation system to estimate the gyro drifts and compensating the system errors can also result in the same conclusion as the above clarification ben et al 2014 therefore we only corrected the z axis gyro drift in the simulation we applied the three motion schemes in table 2 to verify that the proposed method can be used in the actual system the system reset proposed in this paper was implemented in the above three motion schemes the results of the gyro drift estimation are listed in table 3 we can observe from table 3 that the z axis gyro drift ε z b can be estimated accurately in the three motion schemes but the x axis gyro drift ε x b and y axis gyro drift ε y b cannot be estimated this result is consistent with the clarification given before the motion schemes of the simulation were proposed that is the two level gyro drifts and heading error cannot be separated if no accurate external heading information is available the mean value and standard deviation value of the ε z b estimation are 0 04948 deg h and 0 00307 deg h respectively in addition by observing the estimations of the z axis gyro drift in the three schemes it can be further concluded that the state of the vehicle motion will not affect the estimation result we will applied the system reset on the strapdown ins after getting the above estimation results here considering the length limitations of the paper we only give the figures of the system reset for motion scheme 1 in table 2 because the other two motion schemes have similar results we applied the following four reset scenarios 1 no reset 2 only velocity reset 3 velocity reset position error and heading error corrections 4 velocity reset position error heading error and orientation gyro drift corrections the simulation results of latitude and longitude errors velocity errors and heading error are given in figs 7 9 figs 7 9 compare the system errors of the four reset scenarios compared with no reset there are fluctuations of different degrees after the implementation of the other three reset scenarios resulting in overshoot however the system will stabilize after a short period of time and the relative transient behavior after the system reset can be seen in the figures by observing figs 7 9 we compare the performance of the system with different reset scenarios and summarize the conclusions 1 if no reset occurred in the system the errors of the strapdown ins increase with time because of error sources such as the gyro drift and the latitude error 2 if only velocity reset occurred in the system the east velocity error and north velocity error can be completely eliminated at the second time point but they subsequently increase quickly and there is no obvious change in the position and heading errors 3 if velocity reset position error and heading error corrections are performed in the system the values of the velocity error are slightly smaller than in the only velocity reset scheme but the change trend of the velocity errors is consistent the position and heading errors are reduced rapidly at the second time point and they subsequently increase at the previous rate 4 if velocity reset position error heading error and orientation gyro drift corrections have all been performed in the system the system errors are rapidly reduced and can be limited to a preferable range therefore this case is the optimal system reset scheme 4 2 trial we conducted the trial in huludao to validate the feasibility and availability of the proposed system reset method the main trial equipment is shown in fig 10 we installed the self made strapdown ins the high precision inertial navigation system phins and a dvl on board at the bottom of the boat we used the data output by phins as the reference value for attitude position and velocity to measure the performance of the proposed system reset method and the dvl was used to provide the external velocity information phins ixblue france served as the benchmark the gyro constant drift was 0 01 deg h and the accelerometer bias was 5 10 5 g the phins is actually a gps ins integrated navigation system and the gps and ins information is combined through a kalman filter in addition it can detect gps malfunctions and prevent the input of wrong signals the trial procedure was as follows starting from the end of the initial alignment of the vehicle the system reset was performed in the fifth hour and the system errors were corrected after 2 min the total duration of the trial was 20 h the trial results are given in figs 11 15 velocity errors latitude and longitude errors and heading errors are given in figs 11 15 from the figures it can be seen that the errors of velocity position and heading increase quickly if the strapdown ins is not reset the coupling of gyro drifts heading and velocity leads to the rapid development of velocity errors the maximum amplitude values of the east velocity error and north velocity error are 2 5 m s and 1 5 m s respectively both the maximum amplitude values of the latitude error and longitude error are approximately 4 104 m the heading error fluctuates greatly if we apply the system reset method proposed in this paper all the errors of the strapdown ins including velocity errors position errors heading error and z axis gyro drift will be corrected after the system reset the maximum amplitude values of the east velocity error and north velocity error are not more than 0 5 m s the latitude error is stable in the range of 2000 m the longitude error is not more than 5000 m the maximum value of the heading error is only approximately 0 1 from figs 11 15 it is clear that the correction scenario not only removes the velocity errors and heading error at the reset time point but counteracts the error sources of velocity such as gyro drift latitude error etc the system reset method proposed in this paper can control the system errors in a desirable scope improving the navigation accuracy of the strapdown ins 5 conclusions in this paper because conventional system reset methods usually take a long time and multi point position information is generally difficult to obtain in underwater scenarios a new system reset method based on velocity information was proposed for a strapdown ins in the proposed method gyro drift and position and heading errors are estimated and corrected by using external velocity information in a short period simulation and trial results verified the feasibility of the proposed system reset method and showed that it can effectively improve the accuracy of the strapdown ins for long term navigation acknowledgements funding this work was supported by the postdoctoral science foundation of china grant number 2015m581440 the national natural science foundation of china grant numbers 61503090 51509063 and the heilongjiang natural science foundation grant number qc2015078 appendix detailed expansions this section gives the detailed expressions for e t and f t they are written as e t e 11 t e 12 t e 13 t e 21 t e 22 t e 23 t e 31 t e 32 t e 33 t f t f 11 t f 12 t f 13 t f 21 t f 22 t f 23 t f 31 t f 32 t f 33 t where the elements of matrices e t and f t in the calculation process are e 11 t ω z ω sin ω t ω x ω y ω 2 1 cos ω t f u c t ω y ω sin ω t ω x ω z ω 2 1 cos ω t f n c t e 12 t cos ω t ω x 2 ω 2 1 cos ω t f u c t ω y ω sin ω t ω x ω z ω 2 1 cos ω t f e c t e 13 t cos ω t ω x 2 ω 2 1 cos ω t f n c t ω z ω sin ω t ω x ω y ω 2 1 cos ω t f e c t e 21 t cos ω t ω y 2 ω 2 1 cos ω t f u c t ω x ω sin ω t ω y ω z ω 2 1 cos ω t f n c t e 22 t ω z ω sin ω t ω x ω y ω 2 1 cos ω t f u c t ω x ω sin ω t ω y ω z ω 2 1 cos ω t f e c t e 23 t ω z ω sin ω t ω x ω y ω 2 1 cos ω t f n c t cos ω t ω y 2 ω 2 1 cos ω t f e c t e 31 t ω x ω sin ω t ω y ω z ω 2 1 cos ω t f u c t cos ω t ω z 2 ω 2 1 cos ω t f n c t e 32 t ω y ω sin ω t ω x ω z ω 2 1 cos ω t f u c t cos ω t ω z 2 ω 2 1 cos ω t f e c t e 33 t ω y ω sin ω t ω x ω z ω 2 1 cos ω t f n c t ω x ω cos ω t ω y ω z ω 2 1 cos ω t f e c t f 11 t c o s ω t ω x 2 ω 2 1 c o s ω t f 12 t ω z ω sin ω t ω x ω y ω 2 1 c o s ω t f 13 t ω y ω sin ω t ω x ω z ω 2 1 c o s ω t f 21 t ω z ω sin ω t ω x ω y ω 2 1 c o s ω t f 22 t c o s ω t ω y 2 ω 2 1 c o s ω t f 23 t ω x ω sin ω t ω y ω z ω 2 1 c o s ω t f 31 t ω y ω sin ω t ω x ω z ω 2 1 c o s ω t f 32 t ω x ω sin ω t ω y ω z ω 2 1 c o s ω t f 33 t c o s ω t ω z 2 ω 2 1 c o s ω t where ω 2 ω x 2 ω y 2 ω z 2 v n c r 2 2 ω i e v e c r cos ϕ 2 
22817,stationary tests to find mean values are common in testing e g when measuring the resistance force of a model ship in a towing tank facility literature involving uncertainty analysis often suggest that quantifying the random scatter of mean should be done by performing repeat tests however this may be expensive and time consuming this paper presents an estimator to quantify the random uncertainty of the mean rum from a stationary single time series without performing actual repeat tests the numerical implementation of this estimator is provided as well further this paper presents two other methods one to qualify the stationarity and one to quantify spectral contributions to the random uncertainty the presented estimator and methods are based on the auto covariance of a time series and are valid for certain classes of random signals these classes are typical for time series measured in stationary tests for these classes rum has been validated with the analytical solution for the random uncertainty of mean to check for stationarity of time series data a pragmatic method has been developed the transient scanning technique tst the tst objectively identifies and deletes start and end effects in measurements it detects instationarities which wouldn t be detected by visual inspection of the time series data a by product of a rum calculation is a spectral distribution of the uncertainty contributions to the random uncertainty of mean this method is called the uncertainty spectrum technique ust the rum tst and ust are demonstrated with a set of flat plate measurements keywords uncertainty random stationarity transient auto covariance spectrum nomenclature acm auto covariance method b bandwidth c xx auto covariance function e expected value f frequency f c centre frequency containing energy in a noise process f h highest frequency containing energy in a noise process f l lowest frequency containing energy in a noise process i depending on context indicates a particular realisation of a theoretically infinite process x or the ith component in a summation of band pass processes k coverage factor m i estimate of μ x for realisation i or sample time average m u1 average of u 1 estimates n depending on context indicates the number of samples in a realisation or the number of band pass processes in a summation rum random uncertainty of mean estimator sm standard deviation of mean s xx spectral density si x sine integral of x t time t total measurement time simulation time section size tst transient scanning technique u 1 standard uncertainty of mean at the first order replication level u m expanded uncertainty of mean ust uncertainty spectrum technique x infinite theoretical process x i realisation i of a process a time series δf spectral resolution μ x mean of x σ i standard deviation of mean per lag i σ x standard deviation of x τ time shift 1 introduction 1 1 random uncertainty of mean in experimental towing tank facilities computational towing tanks or facilities in which similar test requirements may apply tests are carried out in a wide range of design conditions in many experiments the mean value of a measurement is used for analysis in order to generate reliable results often steady state conditions during measurements are required in steady state conditions it is assumed that random physical processes have become stationary after a start up time this means that the statistical properties of the process do not change over time and the process can be extrapolated into the future for example the mean value and the variance of a measured time series are constant furthermore the auto covariance does not depend on time and it is only a function of the time shift in case of finite time series the random uncertainty of mean is almost always present usually it has a small value because the time series are long enough to capture low frequency processes however if a measured signal contains low frequency components with large amplitudes the finite length of the test could cause a measurable random uncertainty in the mean value a typical example is the towing force on a ship model measured in a towing tank this uncertainty becomes evident when performing repeat tests each repeated estimate for the mean will be slightly different from the other however all of them should be in the same region around the true mean of an infinite process gleser 1998 the authors of this journal paper researched the magnitude and behaviour of the uncertainty of mean and published the findings at conferences brouwer et al 2013 2015a 2016 this journal paper contains a bundled and revised version of the information published at these conferences new insights and background information are added making it a single cohesive story the most noteworthy additions are the classification of random signal types and the elaboration of numerical instabilities that occur in the numerical estimators 1 2 history the most common way to assess random uncertainties is by replication of experiment however commercial research does not always allow this due to restrictions in budget and time attempts have been made in the past to find an appropriate estimator for the random uncertainty of mean without having to perform repeat tests lin et al 1990 proposed to divide a measurement signal into seven segments with slightly varying lengths each comprising at least two or three peak oscillation periods the mean values of these individual segments are collected and the collection s standard deviation is calculated this standard deviation is regarded representative for the standard random uncertainty another method proposes to use 1 of the maximum value encountered in a signal molloy 2010 a well known engineering approach is to use the formulae for the standard deviation or standard error of mean for uncorrelated data the standard deviation of the signal and divide by the square root of number of independent samples n normally n is an experience based value e g the number of peaks in a signal or the number of individual samples in a time series these methods could be classified as best guesses without an analytical proof of the their validity analytical determination of the random uncertainty in finite length measurement signals has been described before tucker 1957 bendat and piersol 2010 steen et al 2015 moffat 1988 bendat and piersol 2010 describe mathematical techniques to derive the expected variance of statistical estimators like mean based on the auto covariance of a time series this variance is a measure for the random uncertainty the examples and trends provided are valid for the limiting case of random processes with evenly distributed spectral energy in the lower frequencies down to zero frequency the magnitude and behaviour of the uncertainty of mean are significantly different when the energy in the lower frequencies diminishes the latter is very common in testing practices since a practitioner often strives for an experiment to be long enough in order to be steady state and to contain all frequency components of the system being tested brouwer et al 2013 derived the analytical solution of standard deviation of mean for any band pass noise process this solution is very generic and covered both the solution for band limited gaussian noise as provided by piersol and bendat and the standard deviation relation for uncorrelated data points white noise the most remarkable feature found was that standard deviation of mean of a time series decays with the inverse of the measurement length rather than the inverse square root of measurement length this is valid when measurement time is longer than the longest fluctuation period of the measured process in the same publication two numerical estimators to find the uncertainty of mean from a single result were presented one based on the auto covariance method acm and one on the segment method the first estimator is called random uncertainty of mean estimator rum the second estimator is a less accurate and less versatile estimator but its addition served to demonstrate how a segment based method should be implemented correctly since the authors have seen many examples of similar methods being applied incorrectly in brouwer et al 2015a the subject of stationarity verification was addressed stationarity is often assumed but it is not corroborated only if there is doubt the time series will be visually checked on the presence of a trend if there is no obvious trend visible it is concluded that the time series is stationary this is an inaccurate and subjective check building further on the knowledge of the 2013 publication a new objective method to verify stationarity was devised the transient scanning technique tst in the 2016 publication one further aspect of the mathematics considering the uncertainty of mean was elaborated the contributions of various noise sources on the uncertainty of mean can be separated and quantified using the uncertainty spectrum technique or ust this technique was devised in an effort to improve measurement quality by lowering the random uncertainty therefore it is needed to distinguish the individual contributions from various noise sources in a qualitative manner the current paper focuses entirely on the random uncertainty of one statistical moment the mean value however a similar derivation can be made for the variance and hence standard deviation of signals this has been done recently in brouwer and tukker 2017 1 3 structure chapter 2 presents the theoretical basics it starts with a classifications of random stationary signals or time series in section 2 1 this journal paper contains a bundled and revised version of the information previously published at conferences new insights and background information are added making it a single cohesive story it describes the theory of the standard deviation s m of mean due to restricted signal length two analytical formulae for s m as function of the signal length t are presented 2 2 and 2 3 chapter 3 presents three analysis tools the first tool is the random uncertainty of mean estimator rum described in section 3 1 the rum has been verified with the analytical formulae presented in section 2 2 the second tool is the transient scanning technique tst described in section 3 2 the tst can be used to select the stationary part of a measured time series the third tool is the uncertainty spectrum technique ust described in section 3 3 the ust can be used to analyse which spectral components are related to the most important uncertainty contributions to the random uncertainty these three tools are demonstrated with an experimental application in chapter 4 this paper finishes with a discussion in chapter 5 and with conclusions and recommendations in chapter 6 2 theory measured data of physical phenomena can be classified as deterministic or random or non deterministic in this paper measured data are considered to originate from a stochastic process this process can be described by two statistical properties the mean value and the auto covariance function the auto covariance function describes the internal coherence of the random data in general these statistical properties depend on time the random process can be considered as a stationary process if these properties do not vary in time further it is assumed that all data is ergodic which means that the time average is equal to the ensemble average signal length restrictions introduce random deviations of the mean value from the real mean value a measure for these deviations is the random uncertainty it must be noted here that u 1 refers to a first order replication level moffat 1988 a representative value for the random standard uncertainty u 1 is the sample standard deviation of mean s m coleman and steele 2009 1 u 1 s m this standard deviation describes the width of the statistical probability distribution of the mean value when repeat tests are performed s m can be evaluated from the series of mean values however if only one test result is available s m cannot be evaluated using this standard signal analysis technique instead it is possible to determine s m without repeat tests by evaluating the auto covariance function c xx τ where τ is a time shift bendat and piersol 2010 2 1 classification of stationary processes before the derivation of s m is explained it is useful to consider the following classification of stationary processes since it precisely bounds the limiting cases that apply the classification is based on block shaped power density functions see fig 1 the phase of all spectral components is assumed to be random in the block region the spectral density s xx f is non zero and equal to σ x 2 b where f is the frequency σ x is the standard deviation of the signal and b the spectral bandwidth this band resides between the lower and higher limits denoted by f l and f h outside this band the amplitude is defined as zero a white noise signal is characterised by the absence of any correlation between adjacent samples its power density function has a constant value for the full frequency range fig 1a other types of noise signals are characterised with some internal correlation however these signals are divided by the characteristic time scales of the internal correlation when spectral contribution of frequencies higher than f h are absent the noise signal is classified as a red noise signal fig 1b when spectral contributions of frequencies lower than f l are absent the noise signal is classified as a blue noise signal fig 1c a green noise signal has only spectral components between the lowest frequency component f l and highest frequency component f h fig 1d measured signals which are similar to green noise signals or a summation of a multiple of green noise signals are very common note that for digital white and blue noise signals the band containing energy is assumed finite but limited to half the sample frequency or nyquist frequency 2 2 analytical solution for standard deviation of mean this section starts with a small recap of some essential background provided by bendat and piersol 2010 it shows how the standard deviation of mean may be derived from basic algebra the starting point is to consider a measured time series x i t with finite length t as a sample record or realisation of an ergodic stationary random process x t the sample time average m i is an estimator of the real mean μ x of the process 2 m i 1 t 0 t x i t d t due to practical restrictions of the time series length t there will be a deviation between the estimated mean m i and the real mean μ x this deviation can be considered as a random process too the size of these deviations is described by the so called standard deviation of mean s m following bendat and piersol 2010 s m can be written in statistical terms of the expected value e 3 s m e m i μ x 2 1 t 2 0 t 0 t e x i ξ x i η d η d ξ μ x 2 combined with the auto covariance function c xx τ for a stationary process so without dependency on t this standard deviation s m can be worked out into the form 4 s m 2 t 0 t 1 τ t c x x τ d τ where τ is the time shift the information up to here comes directly from piersol and bendat solving for block shaped spectra in general fig 1d reveals a general solution for block shaped spectra in general the auto covariance function c xx τ is equal to 5 c x x τ σ x 2 sin π b τ π b τ cos 2 π f c τ where f c is the centre frequency of the band substituting eq 5 into eq 4 gives the analytical solution of s m for any block shaped noise process 6 s m a n a l y t i c a l σ x 1 π b t s i 2 π f h t s i 2 π f l t f c π 2 b t 2 1 f c 2 1 4 b 2 sin 2 π f c t sin π b t 1 2 π 2 t 2 1 f c 2 1 4 b 2 cos 2 π f c t cos π b t 1 2 π 2 t 2 1 f c 2 1 4 b 2 1 2 i ii iii iv si x is the sine integral of x to get more insight into the behaviour of eq 6 a parameter variation is shown in fig 2 the spectral shape of the signal described by b and f c determines how s m σ x depends on t a typical example is the combination of f c 0 5 hz and b 0 98 hz which shows three distinct regions in the first region approximated by 0 t t c with t c 1 f c 2 0 s the ratio s m σ x approaches 1 when t approaches 0 close to t c s m σ x starts curving into the second region which is approximated by t c t t l with t l 1 f l 100 s here s m decays with the inverse square root of t the first three terms in eq 6 are dominant and converge to the solution as provided by piersol and bendat 7 s m σ x 1 2 b t 1 f c t 1 f l this solution holds typically for measured signals using a digital acquisition system comprising an anti aliasing filter if 2bt is equal to the number of independent samples n the solution is equal to the well known relation for the standard deviation of mean for uncorrelated data coleman and steele 2009 bendat and piersol 2010 lehman 1999 hunter 2011 8 s m σ x 1 n 2 b t n the third region is t t l here the ratio s m σ x curves can be approximated with a linear decay eventually the fourth term in eq 6 is dominant and gives 9 s m σ x 1 2 π t 1 f c 2 1 4 b 2 o r 1 2 π t 1 f l f h t 1 f l this is clearly visible in fig 2 this figure shows a slowly decaying oscillation around a linear decay for t t l once the measurement time is longer than the largest periods in a signal t t l the standard deviation of mean decays with the inverse of the measurement time see eq 9 since researchers and test engineers often intrinsically aim for a measurement time to be longer than the largest period in the signal this solution is very relevant in general measurement and simulation practice and forms the basis for all analysis techniques presented afterwards it should be noted that condition t t l is fulfilled in case of green noise and blue noise signals for these type of signals s m decays linearly with 1 t eq 9 however both white noise and red noise signals possess a different behaviour because always t t l for these type of signals s m decays with 1 t eq 7 2 3 spectral distribution having established the basic behaviour of standard deviation of mean s m for green noise signals the mathematics can be extended to more general random noise signals it is a small step to consider the contribution per frequency band which is called the uncertainty spectrum for mean this spectrum is useful when particular frequency bands can be deduced to originate from specific characteristics of a test set up with the uncertainty spectrum the contribution of those characteristics to the standard uncertainty can be properly quantified based on this information smart scientific and business decisions to alter the test set up can be made in the previous section it was shown that for green noise signals s m decays with the inverse of measurement length t as described by eq 9 when a signal has no measurable energy in the frequencies f below the inverse measurement length 1 t the signal can be thought of as a process with an arbitrary spectrum made by a superposition of multiple uncorrelated green noise signals with bandwidth b equal to the spectral resolution δf this is demonstrated in fig 3 if this is applicable to the measurement the standard deviation of mean can be approximated using taylor series method for the propagation of uncertainties coleman and steele 2009 10 s m i 1 n s m i 2 i 1 n σ i 2 f c i 2 1 4 b i 2 2 π t t 1 f l here i denotes the individual green noise component at the ith lag of the spectral density spectrum s xx with n components in total this equation can also be expressed as a function of the spectral density s the signal standard deviation per lag σ i is directly related to the square root of the integrated power spectrum per lag s i of the process this results in 11 σ i s i δ f s m i f i 1 2 π t s x x i δ f f i 2 1 4 δ f 2 t 1 f l all contributions per frequency band together construct a spectral distribution for s m in fig 4 a spectral distribution for s m is shown for a green noise signal with a signal length t of 50 s fig 1d the power density spectrum is shown as s xx f in blue the spectral distribution for s m is shown as s m i f i in red while s xx is constant over the range of frequencies that contain energy s m i f i shows a hyperbolic trend showing that lower frequency oscillations contribute more to standard deviation of mean than higher frequency oscillations this agrees with eq 11 showing that s m i f i decrease linearly with 1 f i 3 implementation techniques in order to exploit the theory behind the standard deviation of mean for stationary signals as presented in section 2 this section elaborates on implementation of it in three numerical techniques the first one considers an uncertainty estimator called random uncertainty of mean estimator rum the rum estimates the random uncertainty of mean from a single time series the second one is the transient scanning technique tst tst verifies whether a single signal can be regarded as being stationary or not the third one is the uncertainty spectrum technique ust the ust can be used to analyse which spectral components are related to the most important uncertainty contributions to the random uncertainty 3 1 random uncertainty of mean estimator random uncertainty of mean estimator rum uses the auto covariance method acm to estimate the standard random uncertainty of mean using eq 4 the output of the rum is the expanded uncertainty u m of mean for a level of confidence of 95 the uncertainty is evaluated according iso iec guide 98 3 2008 iso 2008 this estimator is verified in par 3 1 2 for green noise signals this verification is based on the analytical solution eq 6 3 1 1 auto covariance method the random standard uncertainty of mean u 1 is computed by eq 4 with u 1 s m the autocorrelation function c xx τ can be calculated using the fourier transform of the one sided auto spectral density function s xx f 12 c x x τ 0 s x x f cos 2 π f τ d f eq 12 is known as a wiener khinchine relation bendat and piersol 2010 the auto spectral density function s xx f is computed from the fourier transform x f of the time series x i t 13 s x x f 2 t x f 2 x f 0 t x i t m i e j 2 π f t d t bendat and piersol 2010 give a complete numerical procedure to compute the auto covariance function with eq 12 the latest step of their procedure is to compute the unbiased auto covariance function c xx unbiased τ from the biased estimate c xx biased τ according to 14 c x x u n b i a s e d τ t t τ c x x b i a s e d τ using this numerical approach a problem arises the standard approach is to find and to use unbiased estimators in general however fig 5 show the difference between an unbiased estimate of c xx τ a biased estimate of c xx τ and the analytical solution of c xx τ for a green noise signal the numerical noise of the unbiased estimate for large values of τ is caused by the diminishing number of correlations that can be constructed for larger τ using unbiased estimators this numerical noise is strongly amplified for large values of τ this will lead to unstable integration of eq 4 moffat 1982 suggests to utilize a cut off point after which the auto covariance is assumed zero but this may still result in numerical problems during integration the integral can even yield negative values for the variance of the mean u 1 2 resulting in complex values and non interpretable values for u 1 the approach in the acm is to use a biased estimator for c xx τ instead of an unbiased one as a consequence using a biased estimate of c xx τ returns a biased uncertainty of mean u 1 b i a s e d the bias error is equal to the difference between the biased estimation u 1 b i a s e d and the unbiased estimation u 1 u n b i a s e d the unbiased uncertainty of mean u 1 u n b i a s e d is equal to s m a n a l y t i c a l see eq 6 this bias error depends on the type of signal for green and blue noise signals the bias is found by rewriting eq 4 for biased definitions and substituting eq 14 15 u 1 b i a s e d 2 t 0 t 1 τ t c x x b i a s e d τ d τ 2 t 0 t 1 τ t 2 c x x u n b i a s e d τ d τ solving for block shaped processes with random phase spectrum the following analytical solution for eq 15 is found 16 u 1 b i a s e d σ x 2 b f l f h 2 π 3 t 3 2 f h f l π 2 t 2 s i 2 π f h t s i 2 π f l t 2 b 3 π t 8 b f c 2 π t 4 f c 2 b 2 sin π b t cos 2 π f c t sin 2 π f c t 2 π f c t 4 f c 2 b 2 sin π b t sin 2 π f c t b cos π b t 4 f c 2 b 2 π t cos 2 π f c t 4 f c sin 2 π f c t 1 2 it can be derived from eqs 16 and 6 that the ratio of the biased to the unbiased uncertainty of mean becomes 17 u 1 b i a s e d u 1 u n b i a s e d 2 for t 1 f l it is assumed that the signal length t is longer than the largest time scale t l with t l 1 f l combining this with eq 4 gives the standard random uncertainty of mean u 1 18 u 1 1 t 0 t 1 τ t c x x b i a s e d τ d τ the output of rum is the expanded random uncertainty u m of the mean u m is obtained by multiplying eq 18 by a coverage factor k based on a normal distribution 19 u m k u 1 for a confidence level of 95 the coverage factor k is equal to 2 0 iso 2008 3 1 2 verification of rum to verify the random uncertainty of mean estimator rum and to find the boundaries of its usage simulations were performed using artificially created green noise signals a master signal x master t was created by superposition of a large number of sinusoidal components with frequencies ranging between f l 0 25 hz and f h 0 75 hz with a constant amplitude and random phase similarly as shown in fig 1d the total signal length was 55 h the sampling frequency was 100 hz the master signal itself can be regarded as a virtually infinite non repeating signal from this master signal n sample records or realisations x i t were taken at random with n 1000 for each t sample records up to several minutes were picked and studied rum computes the standard uncertainty u 1 and the expanded uncertainty u m for each sample record the output were two series of n values one for u 1 and one for u m the reference for verification is the analytical solution of eq 6 a comparison of the uncertainty values u 1 computed by the rum with the analytical solution is shown in fig 6 the blue lines indicate the analytical solution the average value of u 1 m u1 is plotted as thick coloured lines as a function of t the inner 95 percentile is visualised with coloured patches for small t the uncertainty is underestimated u 1 values are underestimated for t is long enough t 1 f l the estimated values u 1 lie in the region of the analytical solution the predicted average uncertainty is acceptable with only a small underestimation of about 10 fig 7 shows the distribution of the estimated values u 1 for t 2000 s this distribution is clearly asymmetric it is assumed that this asymmetrical distribution is responsible for the small underestimation of the mean value m u1 relative to the analytical solution a second verification method is based on the statistical spreading of the uncertainty estimates u m in other words it is based on the uncertainty of the uncertainty estimates since the master signal is fully defined the confidence interval can be compared with the known mean value μ x according to 20 m i u m i μ x m i u m i μ x p o u t i 1 o t h e r w i s e p o u t i 0 the average percentage of outliers p out t per t is determined by 21 p o u t t 100 1 n i n p o u t i for an accurate 95 confidence interval the percentage of outliers p out should only be 5 the verification results are shown in fig 8 it is observed that p out for very short t t 1 f l is unacceptably large in all cases for increasing t a steep decline in the number of outliers is observed it is seen that for t 1 f l p out approaches the target value of 5 for the estimator in this region the results are still scattering between approximately 3 and 7 since the simulations are done with a limited number repeats per signal length t in conclusion the rum is a reliable estimator for the estimation of the random uncertainty of the mean value of a stationary green noise signal for a confidence level of 95 3 2 transient scanning technique the rum yields a reliable estimation of the random uncertainty if the signal is stationary the stationarity of a signal can be checked with the transient scanning technique tst it is a practical and simple tool to verify whether the time series is stationary a stationary time series has a constant mean value the tst checks the stationarity and locates trends and transients in measured signals at the beginning or at the end of time series these trends and transients are often too small to observe visually transients such as start up effects and end effects can be removed straightforward from the time series the residual part of the time series is stationary and can be used for further analysis this enables the test engineer or researcher to judge the optimum stable section selection e g during vibration induced motion vim measurements another application is cfd of stationary flows the tst can be used to determine whether the computation time needs to be extended to guarantee a stationary cfd solution brouwer et al 2015a 3 2 1 creating a tst result the tst combines the theoretic behaviour of the random uncertainty with the estimation of standard uncertainty of mean u 1 as function of the signal length t it is based on the auto covariance method acm see eq 18 22 u 1 t 1 t 0 t 1 τ t c x x b i a s e d τ d τ further it uses the numerical techniques implemented in the random uncertainty of mean estimator rum as described before the dependency of u 1 t on the signal length t is similar to the dependency of s m on t section 2 2 fig 2 shows that for stationary green and blue noise signals s m u 1 decays with the inverse of t the inverse relation between u 1 and t can be visualised in a graph where t is drawn on the x axis and u 1 on the y axis both axis are displayed with logarithmic scales for stationary signals this should result in a line with a slope of minus one would the slope be different the signal is said to be non stationary or unsteady the tst can be applied in two ways the tst can be applied forward tst a or backward tst b it depends on how the signal parts are selected the signal starts at t t begin and ends at t t end the tst a starts at the begin of the signal t begin tst a selects signal sections t begin t begin t for each section size t the tst b starts from the end the tst b selects sections t end t t end for each t the maximum value t max is equal to t end t begin the results are plotted in a double logarithmic graph with t plotted on the x axis and u 1 on the y axis once t is long enough the underlying statistics are converged both tst a and tst b will attain a slope of minus one u 1 1 t in case the slope is different the signal may have a trend a start up effect or an end effect another possibility is that the measurement or simulation time was too short and the signal cannot be considered as a green or blue noise like signal often start up effects and vice versa for end effects are artefacts originating from the finite nature of measurement laboratories available measurement time or available computation time the information in the tst plots can be used to identify these unwanted artefacts and remove them from the time series the tst provides a much higher level of fidelity compared to a visual inspection of the time series of a signal tst a is very strong in identifying significant end effects in the signal tst b identifies significant start up effects in the signal 3 2 2 visualization of tst to demonstrate the tst a realisation is selected from an artificially created stochastic green noise signal this simulated signal is virtually infinite in duration since it has a 55 h repeat time its mean is zero and it has no energy below 0 25 hz and above 0 75 hz the selected realisation has a duration of 100 s which is long enough to be stationary a second signal is created from the realisation which is made non stationary on purpose by adding a small start up effect in the first 20 s both signals and the disturbance are shown in fig 9 fig 10 and fig 11 it should be noted that the classic method of checking for stationarity by visual inspection fails for the signal in fig 11 this is due to the start up effect which has a much smaller amplitude than the oscillations present in the signal however using the tst b it becomes easy to spot the start up effect in fig 12 the tst b results for both the stationary and non stationary signal are presented in fig 12 both tst results show a large range where u 1 decays with the inverse of t the signal is stationary in this range the most interesting feature is the appearance of a steep incline in u 1 of the non stationary signal for t 90 s this rise is called a hockey stick since u 1 is calculated from the end of the signal the hockey stick identifies a significant start up transient for t t end 90 s 10 s it is noted that for small sections approximately t 14 s in this case the values of u 1 fall below the trend of the stationary range in this region the section lengths are too short relative to the longest oscillation periods 1 f l 4 s in the stochastic process which are equal to 4 s 1 f l this phenomena has been discussed in section 2 2 the different areas of the tst as discussed so far are indicated in the tst results in fig 13 the optimal section that provides the most accurate mean value of the stationary process is identified just left of the onset of the hockey stick in this case the last 90 s of the signal represent the optimal section see fig 14 the first 10 s of the signal should be excluded the detected start up transient of 10 s is smaller than the added start up disturbance of 20 s see fig 10 this shows the distinctiveness of tst for transients the rest of the added start up disturbance 10 s t 20 s has no significant contribution of the uncertainty relative to the signal noise fig 9 the tst detects only significant transients the cropped signal without the significant start up transient can be considered as a stationary signal the effect of removing the start up is directly visible in the uncertainty of the mean value of this example the mean value of the complete signal m is 0 031 rum yields an expanded uncertainty u m of 0 044 see eq 16 this yields a 95 confidence interval of 23 m 0 031 0 044 after removing the start up effect m of the optimal section is 0 0034 with u m is 0 021 summarized 24 m 0 003 0 021 the real mean of the process μ which is zero lies well within both estimated confidence intervals removing the start up transient has reduced the uncertainty of mean with a factor 2 the application of tst has increased the reliability or credibility of the measured mean value 3 3 uncertainty spectrum technique the rum outputs an estimated value for the random uncertainty this shows the size of the uncertainty region around the measured value it does not give information about the origin of the random uncertainty a method to get insight in the uncertainty sources is the uncertainty spectrum technique ust as introduced in section 2 3 an uncertainty spectrum shows the spectral contributions to the random uncertainty of mean the spectrum gives information about the possible important sources of random uncertainty parts of this section have previously been published by brouwer and klinkenberg 2016 the uncertainty spectrum technique ust is based on the auto covariance method acm see eq 11 25 u 1 i f 1 2 π t s i δ f f i 2 1 4 δ f 2 with u 1 i s m i it uses the same numerical techniques implemented in the random uncertainty of mean estimator rum rum outputs the total random uncertainty u 1 t o t a l which is an estimation for s m the relative uncertainty contribution to the total uncertainty is expressed in terms of the uncertainty percentage contribution upc the upc is constructed by taking the square of each individual uncertainty contribution and dividing by the overall uncertainty 26 u p c i u 1 i 2 u 1 t o t a l 2 100 the higher the upci for a frequency component the more useful it is to attempt to remove the uncertainty source from the measurement the upci s are plotted as function of the spectral frequency f in hz this is called the uncertainty spectrum for the lowest frequencies f i the calculation of the uncertainty spectra appears to be sensitive for numerical spectral noise due to the weighting factor 1 f i 2 1 4 δ f 2 this sensitivity on numerical noise is comparable to the noise sensitivity of the unbiased estimation of auto correlation c x x for large τ further the presence of numerical noise is visible in the summation of all upci s in theory the summation of all upci s is 100 of u 1 total 2 coleman and steele 2009 however due to the numerical noise this summation could mostly be larger to suppress the numerical noise the ust can be extended with a simple spectral filter 27 s x x f i 0 i f s x x f i s x x m e a n α s x x m e a n is the mean value of the power density spectral values s x x f i the filter parameter α has been selected based on the histogram of s x x f i s x x m e a n the implemented value for α is 0 1 the feasibility of this implementation on a broad range of signals will be a part of further research 4 application the presented tools have been applied on various experimental signals and simulation data here the application of them on a set of load measurements on a flat plate is described the objective of the flat plate research is to determine the frictional resistance of surfaces with varying roughness and coatings the measurements had been performed in the concept basin of marin the flat plate had a length of 6 3 m the plate was vertically mounted at an immersion of 1 m the tools tst rum and ust have been used to evaluate the measured load measurements the example demonstrated here considers the load force f x on the flat plate in the towing direction the towing speed is 5 m s start up and end distortions have removed from the signal by visual inspection the selected signal part with a length of 16 s is shown in fig 15 top this signal part looks like steady without a trend or start up or end effects the rum outputs the mean value with the corresponding random uncertainty u m 28 f x 584 3 8 1 n this signal part has been evaluated with the tst tool the results are shown in fig 15 the tst b shows a distinct increase of the random uncertainty of mean for signal length t longer than 6 s this indicates start up effects because tst b starts at the end of the signal therefore the first part with a length of 10 s has been removed the residual part with a length of 6 s has been analysed with tst again fig 16 below shows that both new tst a and tst b show a 1 t behaviour this indicates that this cropped signal part is stationary the rum yields a new 95 confidence interval around a new mean value 29 f x 603 7 1 6 n this mean value is more reliable than the mean of the total signal because the cropped signal part is stationary in this example the mean value of the cropped signal part is larger than the original determined mean this shift of mean value of 19 4 n is larger than the expanded uncertainty u m of 8 1 n this shows that removing the unsteady signal parts could give a significant shift of the mean value besides this cropping the signal gives a reduction of the random uncertainty with a factor of 5 in section 2 2 it was assumed that the measurement time t is longer than the largest time scale in a stationary signal this implies that the corresponding power density spectrum has no spectral energy for the lowest spectral component f 1 t this property is clearly visible in the power density spectra of the original signal and of the cropped signal in fig 17 in the original signal the power spectrum shows a distinct value of about 5000 n2 hz at the first spectral component f 0 063 hz the corresponding time scale is 16 s which is equal to the signal length t fig 15 top this indicates the presence of unsteady effects in the signal on the other hand the spectral components of the cropped signal for the lowest spectral components are very small these values are smaller than the numerical noise of the spectral estimator this numerical noise is smaller than 1000 n2 hz therefore these spectral values can be considered as zero values this agrees with the conclusion that the cropped signal part is stationary the power density spectrum s x x in fig 18 top shows two significant spectral areas one around f 6 hz and one around f 15 hz the spectral contribution of latter area to s x x is larger than the former area this suggests that the signal fluctuations around f 15 hz would contribute more to the random uncertainty of mean than the fluctuations around f 6 hz to check this the uncertainty spectrum has been computed with the ust tool fig 18 below shows that the uncertainty contributions around f 6 hz are larger than these around f 15 hz the relative uncertainty contribution upc around f 6 hz is 40 13 53 this is the most important contribution to the random uncertainty of mean the contribution around f 15 hz is only about 25 this is a factor of 2 lower besides this the uncertainty spectrum shows a third uncertainty contribution low frequencies around 1 hz contribute significantly to the random uncertainty its contribution is about equal to the contribution around f 15 hz this shows directly the added value of the uncertainty spectrum relative to the power density spectrum s x x in s x x the spectral contributions around f 1 hz are very small and are hardly visible however in this example these low frequencies attribute significantly to the random uncertainty of mean with this knowledge of the uncertainty contributions it can be evaluated how the measurement set up can be improved based on experience we know that the sources of the frequencies around 15 hz are the mechanical vibrations of the carriage the contributions around 6 hz are probably related to inertia forces of the vibrating flat plat it is assumed that the possible sources for the low frequency contributions around 1 hz are the flow around the flat plat and control system of the moving carriage all these information is input for further research in conclusion the uncertainty spectrum gives insight in the sources of the random uncertainty this can be used for an effective approach to suppress the uncertainty and to improve the measurement quality 5 discussion although not shown here the authors have studied systematically a wide range of artificially generated signals with spectra closer to the reality of measurements of physical processes these spectra include more smooth forms but can contain multiple areas where energy resides with various bandwidths as well these signals show very similar behaviour of s m σ x as that described in section 2 2 therefore the band pass noise signal is regarded as representative in describing the dominant phenomena and trends of real measurement signals in the theory chapter 2 the phase spectrum of the artificially created master signal is assumed to be fully uncorrelated according to the central limit theorem this gives signals with a normally distributed probability density functions if the spectral bandwidth b 0 hz in reality measured time series can contain bands of high probability and or skewed probability density functions and or coupled harmonics these phenomena may have a significant effect on the random uncertainty of mean therefore this needs to be further investigated furthermore experiments can be intended to have a very narrow spectrum b 0 hz e g regular wave experiments for sea keeping tests in these cases the amplitude and phase of the dominant frequency are of interest as well as the mean as shown in fig 2 case f c 5 0 hz and b 0 5 hz the actual s m is relatively low when t is an integer number of the central period t c the signal is dominated by periodic components in these cases it is advised to remove these periodic components bendat and piersol 2010 and analyse the remainder with rum tst and ust throughout this paper all data is assumed to be stationary in some cases an experiment itself is intended to be quasi steady in dang et al 2012 and brouwer et al 2015b a preliminary version of rum was used on these measurements to compare to the quality of quasi steady measurement methods because of an increasing interest in quasi steady tests further development verification and validation on estimators for uncertainty analysis of quasi steady or quasi stationary time series is desirable it should be noted that rum only give a quantification of the random or aleatory uncertainty the systematic or epistemic uncertainty needs to be quantified by other techniques in experimental fluid dynamics a signal or time series results from a measurement of a quantity representative for a physical process in other words a signal is a statistical realisation of a physical process a tst evaluation gives information whether the realised signal is stationary or non stationary it can be applied on a wide range of signals from an almost perfect sine wave to nearly white noise for pure white noise signals this technique does not work because their uncertainty of the mean decays with the square root of the number of samples see section 2 2 white noise signals are characterised by subsequent samples without any correlation between them this type of signals hardly occur in experimental fluid dynamics if the tst result of a realised signal indicates stationarity then it can be concluded that the corresponding physical process is stationary however if a signal is marked as non stationary according to the tst evaluation then the corresponding physical process could be stationary but the measurement length too short the solution is to increase the measurement length when the measurement length is sufficiently long the tst results may indicate the presence of trends or transients these transients can be removed to select the stationary signal part for final analyses a typical example is given in chapter 4 a load measurement of a flat plate test another experimental example of the benefits of tst can be found in brouwer et al 2015a regarding a towed ship in ice conditions that paper describes a successful application of tst on a cfd simulation as well this concerns a time dependent resistance calculation of a cylinder in a uniform flow 6 conclusions and recommendations this paper gives an overview of three corresponding signal analyse methods random uncertainty of mean estimator rum the transient scanning technique tst and the uncertainty spectrum technique ust the developed methods allow the experimenter to quantify the quality of measurement results and optimise the measurement process the random uncertainty of mean estimator rum has been developed this estimator computes the random uncertainty of mean u m for an uncertainty level of 95 rum has been verified successfully for green noise signals the quantification of the random uncertainty of the mean for a single measurement with rum is a big improvements of the measurement results a remarkable finding is that for stationary green and blue noise like signals s um decays with the inverse of the sample record length t only white and red noise like signals show a decay with inverse of the square root of t based on this behaviour the transient scanning technique tst has been developed to check effectively the stationarity of measured signals the tst can be applied in two ways based on selection of signal parts from the beginning of a signal called tst a based on selection of signal parts from the end of a signal called tst b the tst a is very strong in identifying end effects in the signal while the tst b is very strong in identifying start up effects in the signal showing tst results on logarithmic scales three cases can be discerned the data shows a linear decrease a 1 t behaviour till t t max then the signal is stationary the data shows no 1 t behaviour then the signal is not stationary the data shows 1 t behaviour for a limited range of t then start up and or end transients are present the uncertainty spectrum technique ust gives information about the spectral uncertainty contributions of separate frequency ranges the uncertainty spectrum allows to detect which frequency ranges contribute significantly to the random uncertainty of mean this can contribute to improve the measurement set up and hence the measurement result quality it has been demonstrated using actual tank test data ust can be used to identify the limits of accuracy of a facility or computational program with respect to the randomness in its signals or processes as well 6 1 recommendations it is advised to extend the validation of the random uncertainty of mean estimator rum for other types of measured time series using the repeat reference with simulated data special focus needs to be on time series with correlated phase spectra because the theory of rum is based on uncorrelated phase spectra future development is required for similar estimators for quasi stationary or quasi steady signals instead of stationary signals until now the presence of the 1 t behaviour in the tst plots has been detected visually the following step is to extend the tst with algorithms for automatic detection of the 1 t behaviour in the tst plots regarding ust it is advised to study in detail the effect of numerical noise on the uncertainty spectral values this may result a more effective noise filter feasible for a broad range of signals 
22817,stationary tests to find mean values are common in testing e g when measuring the resistance force of a model ship in a towing tank facility literature involving uncertainty analysis often suggest that quantifying the random scatter of mean should be done by performing repeat tests however this may be expensive and time consuming this paper presents an estimator to quantify the random uncertainty of the mean rum from a stationary single time series without performing actual repeat tests the numerical implementation of this estimator is provided as well further this paper presents two other methods one to qualify the stationarity and one to quantify spectral contributions to the random uncertainty the presented estimator and methods are based on the auto covariance of a time series and are valid for certain classes of random signals these classes are typical for time series measured in stationary tests for these classes rum has been validated with the analytical solution for the random uncertainty of mean to check for stationarity of time series data a pragmatic method has been developed the transient scanning technique tst the tst objectively identifies and deletes start and end effects in measurements it detects instationarities which wouldn t be detected by visual inspection of the time series data a by product of a rum calculation is a spectral distribution of the uncertainty contributions to the random uncertainty of mean this method is called the uncertainty spectrum technique ust the rum tst and ust are demonstrated with a set of flat plate measurements keywords uncertainty random stationarity transient auto covariance spectrum nomenclature acm auto covariance method b bandwidth c xx auto covariance function e expected value f frequency f c centre frequency containing energy in a noise process f h highest frequency containing energy in a noise process f l lowest frequency containing energy in a noise process i depending on context indicates a particular realisation of a theoretically infinite process x or the ith component in a summation of band pass processes k coverage factor m i estimate of μ x for realisation i or sample time average m u1 average of u 1 estimates n depending on context indicates the number of samples in a realisation or the number of band pass processes in a summation rum random uncertainty of mean estimator sm standard deviation of mean s xx spectral density si x sine integral of x t time t total measurement time simulation time section size tst transient scanning technique u 1 standard uncertainty of mean at the first order replication level u m expanded uncertainty of mean ust uncertainty spectrum technique x infinite theoretical process x i realisation i of a process a time series δf spectral resolution μ x mean of x σ i standard deviation of mean per lag i σ x standard deviation of x τ time shift 1 introduction 1 1 random uncertainty of mean in experimental towing tank facilities computational towing tanks or facilities in which similar test requirements may apply tests are carried out in a wide range of design conditions in many experiments the mean value of a measurement is used for analysis in order to generate reliable results often steady state conditions during measurements are required in steady state conditions it is assumed that random physical processes have become stationary after a start up time this means that the statistical properties of the process do not change over time and the process can be extrapolated into the future for example the mean value and the variance of a measured time series are constant furthermore the auto covariance does not depend on time and it is only a function of the time shift in case of finite time series the random uncertainty of mean is almost always present usually it has a small value because the time series are long enough to capture low frequency processes however if a measured signal contains low frequency components with large amplitudes the finite length of the test could cause a measurable random uncertainty in the mean value a typical example is the towing force on a ship model measured in a towing tank this uncertainty becomes evident when performing repeat tests each repeated estimate for the mean will be slightly different from the other however all of them should be in the same region around the true mean of an infinite process gleser 1998 the authors of this journal paper researched the magnitude and behaviour of the uncertainty of mean and published the findings at conferences brouwer et al 2013 2015a 2016 this journal paper contains a bundled and revised version of the information published at these conferences new insights and background information are added making it a single cohesive story the most noteworthy additions are the classification of random signal types and the elaboration of numerical instabilities that occur in the numerical estimators 1 2 history the most common way to assess random uncertainties is by replication of experiment however commercial research does not always allow this due to restrictions in budget and time attempts have been made in the past to find an appropriate estimator for the random uncertainty of mean without having to perform repeat tests lin et al 1990 proposed to divide a measurement signal into seven segments with slightly varying lengths each comprising at least two or three peak oscillation periods the mean values of these individual segments are collected and the collection s standard deviation is calculated this standard deviation is regarded representative for the standard random uncertainty another method proposes to use 1 of the maximum value encountered in a signal molloy 2010 a well known engineering approach is to use the formulae for the standard deviation or standard error of mean for uncorrelated data the standard deviation of the signal and divide by the square root of number of independent samples n normally n is an experience based value e g the number of peaks in a signal or the number of individual samples in a time series these methods could be classified as best guesses without an analytical proof of the their validity analytical determination of the random uncertainty in finite length measurement signals has been described before tucker 1957 bendat and piersol 2010 steen et al 2015 moffat 1988 bendat and piersol 2010 describe mathematical techniques to derive the expected variance of statistical estimators like mean based on the auto covariance of a time series this variance is a measure for the random uncertainty the examples and trends provided are valid for the limiting case of random processes with evenly distributed spectral energy in the lower frequencies down to zero frequency the magnitude and behaviour of the uncertainty of mean are significantly different when the energy in the lower frequencies diminishes the latter is very common in testing practices since a practitioner often strives for an experiment to be long enough in order to be steady state and to contain all frequency components of the system being tested brouwer et al 2013 derived the analytical solution of standard deviation of mean for any band pass noise process this solution is very generic and covered both the solution for band limited gaussian noise as provided by piersol and bendat and the standard deviation relation for uncorrelated data points white noise the most remarkable feature found was that standard deviation of mean of a time series decays with the inverse of the measurement length rather than the inverse square root of measurement length this is valid when measurement time is longer than the longest fluctuation period of the measured process in the same publication two numerical estimators to find the uncertainty of mean from a single result were presented one based on the auto covariance method acm and one on the segment method the first estimator is called random uncertainty of mean estimator rum the second estimator is a less accurate and less versatile estimator but its addition served to demonstrate how a segment based method should be implemented correctly since the authors have seen many examples of similar methods being applied incorrectly in brouwer et al 2015a the subject of stationarity verification was addressed stationarity is often assumed but it is not corroborated only if there is doubt the time series will be visually checked on the presence of a trend if there is no obvious trend visible it is concluded that the time series is stationary this is an inaccurate and subjective check building further on the knowledge of the 2013 publication a new objective method to verify stationarity was devised the transient scanning technique tst in the 2016 publication one further aspect of the mathematics considering the uncertainty of mean was elaborated the contributions of various noise sources on the uncertainty of mean can be separated and quantified using the uncertainty spectrum technique or ust this technique was devised in an effort to improve measurement quality by lowering the random uncertainty therefore it is needed to distinguish the individual contributions from various noise sources in a qualitative manner the current paper focuses entirely on the random uncertainty of one statistical moment the mean value however a similar derivation can be made for the variance and hence standard deviation of signals this has been done recently in brouwer and tukker 2017 1 3 structure chapter 2 presents the theoretical basics it starts with a classifications of random stationary signals or time series in section 2 1 this journal paper contains a bundled and revised version of the information previously published at conferences new insights and background information are added making it a single cohesive story it describes the theory of the standard deviation s m of mean due to restricted signal length two analytical formulae for s m as function of the signal length t are presented 2 2 and 2 3 chapter 3 presents three analysis tools the first tool is the random uncertainty of mean estimator rum described in section 3 1 the rum has been verified with the analytical formulae presented in section 2 2 the second tool is the transient scanning technique tst described in section 3 2 the tst can be used to select the stationary part of a measured time series the third tool is the uncertainty spectrum technique ust described in section 3 3 the ust can be used to analyse which spectral components are related to the most important uncertainty contributions to the random uncertainty these three tools are demonstrated with an experimental application in chapter 4 this paper finishes with a discussion in chapter 5 and with conclusions and recommendations in chapter 6 2 theory measured data of physical phenomena can be classified as deterministic or random or non deterministic in this paper measured data are considered to originate from a stochastic process this process can be described by two statistical properties the mean value and the auto covariance function the auto covariance function describes the internal coherence of the random data in general these statistical properties depend on time the random process can be considered as a stationary process if these properties do not vary in time further it is assumed that all data is ergodic which means that the time average is equal to the ensemble average signal length restrictions introduce random deviations of the mean value from the real mean value a measure for these deviations is the random uncertainty it must be noted here that u 1 refers to a first order replication level moffat 1988 a representative value for the random standard uncertainty u 1 is the sample standard deviation of mean s m coleman and steele 2009 1 u 1 s m this standard deviation describes the width of the statistical probability distribution of the mean value when repeat tests are performed s m can be evaluated from the series of mean values however if only one test result is available s m cannot be evaluated using this standard signal analysis technique instead it is possible to determine s m without repeat tests by evaluating the auto covariance function c xx τ where τ is a time shift bendat and piersol 2010 2 1 classification of stationary processes before the derivation of s m is explained it is useful to consider the following classification of stationary processes since it precisely bounds the limiting cases that apply the classification is based on block shaped power density functions see fig 1 the phase of all spectral components is assumed to be random in the block region the spectral density s xx f is non zero and equal to σ x 2 b where f is the frequency σ x is the standard deviation of the signal and b the spectral bandwidth this band resides between the lower and higher limits denoted by f l and f h outside this band the amplitude is defined as zero a white noise signal is characterised by the absence of any correlation between adjacent samples its power density function has a constant value for the full frequency range fig 1a other types of noise signals are characterised with some internal correlation however these signals are divided by the characteristic time scales of the internal correlation when spectral contribution of frequencies higher than f h are absent the noise signal is classified as a red noise signal fig 1b when spectral contributions of frequencies lower than f l are absent the noise signal is classified as a blue noise signal fig 1c a green noise signal has only spectral components between the lowest frequency component f l and highest frequency component f h fig 1d measured signals which are similar to green noise signals or a summation of a multiple of green noise signals are very common note that for digital white and blue noise signals the band containing energy is assumed finite but limited to half the sample frequency or nyquist frequency 2 2 analytical solution for standard deviation of mean this section starts with a small recap of some essential background provided by bendat and piersol 2010 it shows how the standard deviation of mean may be derived from basic algebra the starting point is to consider a measured time series x i t with finite length t as a sample record or realisation of an ergodic stationary random process x t the sample time average m i is an estimator of the real mean μ x of the process 2 m i 1 t 0 t x i t d t due to practical restrictions of the time series length t there will be a deviation between the estimated mean m i and the real mean μ x this deviation can be considered as a random process too the size of these deviations is described by the so called standard deviation of mean s m following bendat and piersol 2010 s m can be written in statistical terms of the expected value e 3 s m e m i μ x 2 1 t 2 0 t 0 t e x i ξ x i η d η d ξ μ x 2 combined with the auto covariance function c xx τ for a stationary process so without dependency on t this standard deviation s m can be worked out into the form 4 s m 2 t 0 t 1 τ t c x x τ d τ where τ is the time shift the information up to here comes directly from piersol and bendat solving for block shaped spectra in general fig 1d reveals a general solution for block shaped spectra in general the auto covariance function c xx τ is equal to 5 c x x τ σ x 2 sin π b τ π b τ cos 2 π f c τ where f c is the centre frequency of the band substituting eq 5 into eq 4 gives the analytical solution of s m for any block shaped noise process 6 s m a n a l y t i c a l σ x 1 π b t s i 2 π f h t s i 2 π f l t f c π 2 b t 2 1 f c 2 1 4 b 2 sin 2 π f c t sin π b t 1 2 π 2 t 2 1 f c 2 1 4 b 2 cos 2 π f c t cos π b t 1 2 π 2 t 2 1 f c 2 1 4 b 2 1 2 i ii iii iv si x is the sine integral of x to get more insight into the behaviour of eq 6 a parameter variation is shown in fig 2 the spectral shape of the signal described by b and f c determines how s m σ x depends on t a typical example is the combination of f c 0 5 hz and b 0 98 hz which shows three distinct regions in the first region approximated by 0 t t c with t c 1 f c 2 0 s the ratio s m σ x approaches 1 when t approaches 0 close to t c s m σ x starts curving into the second region which is approximated by t c t t l with t l 1 f l 100 s here s m decays with the inverse square root of t the first three terms in eq 6 are dominant and converge to the solution as provided by piersol and bendat 7 s m σ x 1 2 b t 1 f c t 1 f l this solution holds typically for measured signals using a digital acquisition system comprising an anti aliasing filter if 2bt is equal to the number of independent samples n the solution is equal to the well known relation for the standard deviation of mean for uncorrelated data coleman and steele 2009 bendat and piersol 2010 lehman 1999 hunter 2011 8 s m σ x 1 n 2 b t n the third region is t t l here the ratio s m σ x curves can be approximated with a linear decay eventually the fourth term in eq 6 is dominant and gives 9 s m σ x 1 2 π t 1 f c 2 1 4 b 2 o r 1 2 π t 1 f l f h t 1 f l this is clearly visible in fig 2 this figure shows a slowly decaying oscillation around a linear decay for t t l once the measurement time is longer than the largest periods in a signal t t l the standard deviation of mean decays with the inverse of the measurement time see eq 9 since researchers and test engineers often intrinsically aim for a measurement time to be longer than the largest period in the signal this solution is very relevant in general measurement and simulation practice and forms the basis for all analysis techniques presented afterwards it should be noted that condition t t l is fulfilled in case of green noise and blue noise signals for these type of signals s m decays linearly with 1 t eq 9 however both white noise and red noise signals possess a different behaviour because always t t l for these type of signals s m decays with 1 t eq 7 2 3 spectral distribution having established the basic behaviour of standard deviation of mean s m for green noise signals the mathematics can be extended to more general random noise signals it is a small step to consider the contribution per frequency band which is called the uncertainty spectrum for mean this spectrum is useful when particular frequency bands can be deduced to originate from specific characteristics of a test set up with the uncertainty spectrum the contribution of those characteristics to the standard uncertainty can be properly quantified based on this information smart scientific and business decisions to alter the test set up can be made in the previous section it was shown that for green noise signals s m decays with the inverse of measurement length t as described by eq 9 when a signal has no measurable energy in the frequencies f below the inverse measurement length 1 t the signal can be thought of as a process with an arbitrary spectrum made by a superposition of multiple uncorrelated green noise signals with bandwidth b equal to the spectral resolution δf this is demonstrated in fig 3 if this is applicable to the measurement the standard deviation of mean can be approximated using taylor series method for the propagation of uncertainties coleman and steele 2009 10 s m i 1 n s m i 2 i 1 n σ i 2 f c i 2 1 4 b i 2 2 π t t 1 f l here i denotes the individual green noise component at the ith lag of the spectral density spectrum s xx with n components in total this equation can also be expressed as a function of the spectral density s the signal standard deviation per lag σ i is directly related to the square root of the integrated power spectrum per lag s i of the process this results in 11 σ i s i δ f s m i f i 1 2 π t s x x i δ f f i 2 1 4 δ f 2 t 1 f l all contributions per frequency band together construct a spectral distribution for s m in fig 4 a spectral distribution for s m is shown for a green noise signal with a signal length t of 50 s fig 1d the power density spectrum is shown as s xx f in blue the spectral distribution for s m is shown as s m i f i in red while s xx is constant over the range of frequencies that contain energy s m i f i shows a hyperbolic trend showing that lower frequency oscillations contribute more to standard deviation of mean than higher frequency oscillations this agrees with eq 11 showing that s m i f i decrease linearly with 1 f i 3 implementation techniques in order to exploit the theory behind the standard deviation of mean for stationary signals as presented in section 2 this section elaborates on implementation of it in three numerical techniques the first one considers an uncertainty estimator called random uncertainty of mean estimator rum the rum estimates the random uncertainty of mean from a single time series the second one is the transient scanning technique tst tst verifies whether a single signal can be regarded as being stationary or not the third one is the uncertainty spectrum technique ust the ust can be used to analyse which spectral components are related to the most important uncertainty contributions to the random uncertainty 3 1 random uncertainty of mean estimator random uncertainty of mean estimator rum uses the auto covariance method acm to estimate the standard random uncertainty of mean using eq 4 the output of the rum is the expanded uncertainty u m of mean for a level of confidence of 95 the uncertainty is evaluated according iso iec guide 98 3 2008 iso 2008 this estimator is verified in par 3 1 2 for green noise signals this verification is based on the analytical solution eq 6 3 1 1 auto covariance method the random standard uncertainty of mean u 1 is computed by eq 4 with u 1 s m the autocorrelation function c xx τ can be calculated using the fourier transform of the one sided auto spectral density function s xx f 12 c x x τ 0 s x x f cos 2 π f τ d f eq 12 is known as a wiener khinchine relation bendat and piersol 2010 the auto spectral density function s xx f is computed from the fourier transform x f of the time series x i t 13 s x x f 2 t x f 2 x f 0 t x i t m i e j 2 π f t d t bendat and piersol 2010 give a complete numerical procedure to compute the auto covariance function with eq 12 the latest step of their procedure is to compute the unbiased auto covariance function c xx unbiased τ from the biased estimate c xx biased τ according to 14 c x x u n b i a s e d τ t t τ c x x b i a s e d τ using this numerical approach a problem arises the standard approach is to find and to use unbiased estimators in general however fig 5 show the difference between an unbiased estimate of c xx τ a biased estimate of c xx τ and the analytical solution of c xx τ for a green noise signal the numerical noise of the unbiased estimate for large values of τ is caused by the diminishing number of correlations that can be constructed for larger τ using unbiased estimators this numerical noise is strongly amplified for large values of τ this will lead to unstable integration of eq 4 moffat 1982 suggests to utilize a cut off point after which the auto covariance is assumed zero but this may still result in numerical problems during integration the integral can even yield negative values for the variance of the mean u 1 2 resulting in complex values and non interpretable values for u 1 the approach in the acm is to use a biased estimator for c xx τ instead of an unbiased one as a consequence using a biased estimate of c xx τ returns a biased uncertainty of mean u 1 b i a s e d the bias error is equal to the difference between the biased estimation u 1 b i a s e d and the unbiased estimation u 1 u n b i a s e d the unbiased uncertainty of mean u 1 u n b i a s e d is equal to s m a n a l y t i c a l see eq 6 this bias error depends on the type of signal for green and blue noise signals the bias is found by rewriting eq 4 for biased definitions and substituting eq 14 15 u 1 b i a s e d 2 t 0 t 1 τ t c x x b i a s e d τ d τ 2 t 0 t 1 τ t 2 c x x u n b i a s e d τ d τ solving for block shaped processes with random phase spectrum the following analytical solution for eq 15 is found 16 u 1 b i a s e d σ x 2 b f l f h 2 π 3 t 3 2 f h f l π 2 t 2 s i 2 π f h t s i 2 π f l t 2 b 3 π t 8 b f c 2 π t 4 f c 2 b 2 sin π b t cos 2 π f c t sin 2 π f c t 2 π f c t 4 f c 2 b 2 sin π b t sin 2 π f c t b cos π b t 4 f c 2 b 2 π t cos 2 π f c t 4 f c sin 2 π f c t 1 2 it can be derived from eqs 16 and 6 that the ratio of the biased to the unbiased uncertainty of mean becomes 17 u 1 b i a s e d u 1 u n b i a s e d 2 for t 1 f l it is assumed that the signal length t is longer than the largest time scale t l with t l 1 f l combining this with eq 4 gives the standard random uncertainty of mean u 1 18 u 1 1 t 0 t 1 τ t c x x b i a s e d τ d τ the output of rum is the expanded random uncertainty u m of the mean u m is obtained by multiplying eq 18 by a coverage factor k based on a normal distribution 19 u m k u 1 for a confidence level of 95 the coverage factor k is equal to 2 0 iso 2008 3 1 2 verification of rum to verify the random uncertainty of mean estimator rum and to find the boundaries of its usage simulations were performed using artificially created green noise signals a master signal x master t was created by superposition of a large number of sinusoidal components with frequencies ranging between f l 0 25 hz and f h 0 75 hz with a constant amplitude and random phase similarly as shown in fig 1d the total signal length was 55 h the sampling frequency was 100 hz the master signal itself can be regarded as a virtually infinite non repeating signal from this master signal n sample records or realisations x i t were taken at random with n 1000 for each t sample records up to several minutes were picked and studied rum computes the standard uncertainty u 1 and the expanded uncertainty u m for each sample record the output were two series of n values one for u 1 and one for u m the reference for verification is the analytical solution of eq 6 a comparison of the uncertainty values u 1 computed by the rum with the analytical solution is shown in fig 6 the blue lines indicate the analytical solution the average value of u 1 m u1 is plotted as thick coloured lines as a function of t the inner 95 percentile is visualised with coloured patches for small t the uncertainty is underestimated u 1 values are underestimated for t is long enough t 1 f l the estimated values u 1 lie in the region of the analytical solution the predicted average uncertainty is acceptable with only a small underestimation of about 10 fig 7 shows the distribution of the estimated values u 1 for t 2000 s this distribution is clearly asymmetric it is assumed that this asymmetrical distribution is responsible for the small underestimation of the mean value m u1 relative to the analytical solution a second verification method is based on the statistical spreading of the uncertainty estimates u m in other words it is based on the uncertainty of the uncertainty estimates since the master signal is fully defined the confidence interval can be compared with the known mean value μ x according to 20 m i u m i μ x m i u m i μ x p o u t i 1 o t h e r w i s e p o u t i 0 the average percentage of outliers p out t per t is determined by 21 p o u t t 100 1 n i n p o u t i for an accurate 95 confidence interval the percentage of outliers p out should only be 5 the verification results are shown in fig 8 it is observed that p out for very short t t 1 f l is unacceptably large in all cases for increasing t a steep decline in the number of outliers is observed it is seen that for t 1 f l p out approaches the target value of 5 for the estimator in this region the results are still scattering between approximately 3 and 7 since the simulations are done with a limited number repeats per signal length t in conclusion the rum is a reliable estimator for the estimation of the random uncertainty of the mean value of a stationary green noise signal for a confidence level of 95 3 2 transient scanning technique the rum yields a reliable estimation of the random uncertainty if the signal is stationary the stationarity of a signal can be checked with the transient scanning technique tst it is a practical and simple tool to verify whether the time series is stationary a stationary time series has a constant mean value the tst checks the stationarity and locates trends and transients in measured signals at the beginning or at the end of time series these trends and transients are often too small to observe visually transients such as start up effects and end effects can be removed straightforward from the time series the residual part of the time series is stationary and can be used for further analysis this enables the test engineer or researcher to judge the optimum stable section selection e g during vibration induced motion vim measurements another application is cfd of stationary flows the tst can be used to determine whether the computation time needs to be extended to guarantee a stationary cfd solution brouwer et al 2015a 3 2 1 creating a tst result the tst combines the theoretic behaviour of the random uncertainty with the estimation of standard uncertainty of mean u 1 as function of the signal length t it is based on the auto covariance method acm see eq 18 22 u 1 t 1 t 0 t 1 τ t c x x b i a s e d τ d τ further it uses the numerical techniques implemented in the random uncertainty of mean estimator rum as described before the dependency of u 1 t on the signal length t is similar to the dependency of s m on t section 2 2 fig 2 shows that for stationary green and blue noise signals s m u 1 decays with the inverse of t the inverse relation between u 1 and t can be visualised in a graph where t is drawn on the x axis and u 1 on the y axis both axis are displayed with logarithmic scales for stationary signals this should result in a line with a slope of minus one would the slope be different the signal is said to be non stationary or unsteady the tst can be applied in two ways the tst can be applied forward tst a or backward tst b it depends on how the signal parts are selected the signal starts at t t begin and ends at t t end the tst a starts at the begin of the signal t begin tst a selects signal sections t begin t begin t for each section size t the tst b starts from the end the tst b selects sections t end t t end for each t the maximum value t max is equal to t end t begin the results are plotted in a double logarithmic graph with t plotted on the x axis and u 1 on the y axis once t is long enough the underlying statistics are converged both tst a and tst b will attain a slope of minus one u 1 1 t in case the slope is different the signal may have a trend a start up effect or an end effect another possibility is that the measurement or simulation time was too short and the signal cannot be considered as a green or blue noise like signal often start up effects and vice versa for end effects are artefacts originating from the finite nature of measurement laboratories available measurement time or available computation time the information in the tst plots can be used to identify these unwanted artefacts and remove them from the time series the tst provides a much higher level of fidelity compared to a visual inspection of the time series of a signal tst a is very strong in identifying significant end effects in the signal tst b identifies significant start up effects in the signal 3 2 2 visualization of tst to demonstrate the tst a realisation is selected from an artificially created stochastic green noise signal this simulated signal is virtually infinite in duration since it has a 55 h repeat time its mean is zero and it has no energy below 0 25 hz and above 0 75 hz the selected realisation has a duration of 100 s which is long enough to be stationary a second signal is created from the realisation which is made non stationary on purpose by adding a small start up effect in the first 20 s both signals and the disturbance are shown in fig 9 fig 10 and fig 11 it should be noted that the classic method of checking for stationarity by visual inspection fails for the signal in fig 11 this is due to the start up effect which has a much smaller amplitude than the oscillations present in the signal however using the tst b it becomes easy to spot the start up effect in fig 12 the tst b results for both the stationary and non stationary signal are presented in fig 12 both tst results show a large range where u 1 decays with the inverse of t the signal is stationary in this range the most interesting feature is the appearance of a steep incline in u 1 of the non stationary signal for t 90 s this rise is called a hockey stick since u 1 is calculated from the end of the signal the hockey stick identifies a significant start up transient for t t end 90 s 10 s it is noted that for small sections approximately t 14 s in this case the values of u 1 fall below the trend of the stationary range in this region the section lengths are too short relative to the longest oscillation periods 1 f l 4 s in the stochastic process which are equal to 4 s 1 f l this phenomena has been discussed in section 2 2 the different areas of the tst as discussed so far are indicated in the tst results in fig 13 the optimal section that provides the most accurate mean value of the stationary process is identified just left of the onset of the hockey stick in this case the last 90 s of the signal represent the optimal section see fig 14 the first 10 s of the signal should be excluded the detected start up transient of 10 s is smaller than the added start up disturbance of 20 s see fig 10 this shows the distinctiveness of tst for transients the rest of the added start up disturbance 10 s t 20 s has no significant contribution of the uncertainty relative to the signal noise fig 9 the tst detects only significant transients the cropped signal without the significant start up transient can be considered as a stationary signal the effect of removing the start up is directly visible in the uncertainty of the mean value of this example the mean value of the complete signal m is 0 031 rum yields an expanded uncertainty u m of 0 044 see eq 16 this yields a 95 confidence interval of 23 m 0 031 0 044 after removing the start up effect m of the optimal section is 0 0034 with u m is 0 021 summarized 24 m 0 003 0 021 the real mean of the process μ which is zero lies well within both estimated confidence intervals removing the start up transient has reduced the uncertainty of mean with a factor 2 the application of tst has increased the reliability or credibility of the measured mean value 3 3 uncertainty spectrum technique the rum outputs an estimated value for the random uncertainty this shows the size of the uncertainty region around the measured value it does not give information about the origin of the random uncertainty a method to get insight in the uncertainty sources is the uncertainty spectrum technique ust as introduced in section 2 3 an uncertainty spectrum shows the spectral contributions to the random uncertainty of mean the spectrum gives information about the possible important sources of random uncertainty parts of this section have previously been published by brouwer and klinkenberg 2016 the uncertainty spectrum technique ust is based on the auto covariance method acm see eq 11 25 u 1 i f 1 2 π t s i δ f f i 2 1 4 δ f 2 with u 1 i s m i it uses the same numerical techniques implemented in the random uncertainty of mean estimator rum rum outputs the total random uncertainty u 1 t o t a l which is an estimation for s m the relative uncertainty contribution to the total uncertainty is expressed in terms of the uncertainty percentage contribution upc the upc is constructed by taking the square of each individual uncertainty contribution and dividing by the overall uncertainty 26 u p c i u 1 i 2 u 1 t o t a l 2 100 the higher the upci for a frequency component the more useful it is to attempt to remove the uncertainty source from the measurement the upci s are plotted as function of the spectral frequency f in hz this is called the uncertainty spectrum for the lowest frequencies f i the calculation of the uncertainty spectra appears to be sensitive for numerical spectral noise due to the weighting factor 1 f i 2 1 4 δ f 2 this sensitivity on numerical noise is comparable to the noise sensitivity of the unbiased estimation of auto correlation c x x for large τ further the presence of numerical noise is visible in the summation of all upci s in theory the summation of all upci s is 100 of u 1 total 2 coleman and steele 2009 however due to the numerical noise this summation could mostly be larger to suppress the numerical noise the ust can be extended with a simple spectral filter 27 s x x f i 0 i f s x x f i s x x m e a n α s x x m e a n is the mean value of the power density spectral values s x x f i the filter parameter α has been selected based on the histogram of s x x f i s x x m e a n the implemented value for α is 0 1 the feasibility of this implementation on a broad range of signals will be a part of further research 4 application the presented tools have been applied on various experimental signals and simulation data here the application of them on a set of load measurements on a flat plate is described the objective of the flat plate research is to determine the frictional resistance of surfaces with varying roughness and coatings the measurements had been performed in the concept basin of marin the flat plate had a length of 6 3 m the plate was vertically mounted at an immersion of 1 m the tools tst rum and ust have been used to evaluate the measured load measurements the example demonstrated here considers the load force f x on the flat plate in the towing direction the towing speed is 5 m s start up and end distortions have removed from the signal by visual inspection the selected signal part with a length of 16 s is shown in fig 15 top this signal part looks like steady without a trend or start up or end effects the rum outputs the mean value with the corresponding random uncertainty u m 28 f x 584 3 8 1 n this signal part has been evaluated with the tst tool the results are shown in fig 15 the tst b shows a distinct increase of the random uncertainty of mean for signal length t longer than 6 s this indicates start up effects because tst b starts at the end of the signal therefore the first part with a length of 10 s has been removed the residual part with a length of 6 s has been analysed with tst again fig 16 below shows that both new tst a and tst b show a 1 t behaviour this indicates that this cropped signal part is stationary the rum yields a new 95 confidence interval around a new mean value 29 f x 603 7 1 6 n this mean value is more reliable than the mean of the total signal because the cropped signal part is stationary in this example the mean value of the cropped signal part is larger than the original determined mean this shift of mean value of 19 4 n is larger than the expanded uncertainty u m of 8 1 n this shows that removing the unsteady signal parts could give a significant shift of the mean value besides this cropping the signal gives a reduction of the random uncertainty with a factor of 5 in section 2 2 it was assumed that the measurement time t is longer than the largest time scale in a stationary signal this implies that the corresponding power density spectrum has no spectral energy for the lowest spectral component f 1 t this property is clearly visible in the power density spectra of the original signal and of the cropped signal in fig 17 in the original signal the power spectrum shows a distinct value of about 5000 n2 hz at the first spectral component f 0 063 hz the corresponding time scale is 16 s which is equal to the signal length t fig 15 top this indicates the presence of unsteady effects in the signal on the other hand the spectral components of the cropped signal for the lowest spectral components are very small these values are smaller than the numerical noise of the spectral estimator this numerical noise is smaller than 1000 n2 hz therefore these spectral values can be considered as zero values this agrees with the conclusion that the cropped signal part is stationary the power density spectrum s x x in fig 18 top shows two significant spectral areas one around f 6 hz and one around f 15 hz the spectral contribution of latter area to s x x is larger than the former area this suggests that the signal fluctuations around f 15 hz would contribute more to the random uncertainty of mean than the fluctuations around f 6 hz to check this the uncertainty spectrum has been computed with the ust tool fig 18 below shows that the uncertainty contributions around f 6 hz are larger than these around f 15 hz the relative uncertainty contribution upc around f 6 hz is 40 13 53 this is the most important contribution to the random uncertainty of mean the contribution around f 15 hz is only about 25 this is a factor of 2 lower besides this the uncertainty spectrum shows a third uncertainty contribution low frequencies around 1 hz contribute significantly to the random uncertainty its contribution is about equal to the contribution around f 15 hz this shows directly the added value of the uncertainty spectrum relative to the power density spectrum s x x in s x x the spectral contributions around f 1 hz are very small and are hardly visible however in this example these low frequencies attribute significantly to the random uncertainty of mean with this knowledge of the uncertainty contributions it can be evaluated how the measurement set up can be improved based on experience we know that the sources of the frequencies around 15 hz are the mechanical vibrations of the carriage the contributions around 6 hz are probably related to inertia forces of the vibrating flat plat it is assumed that the possible sources for the low frequency contributions around 1 hz are the flow around the flat plat and control system of the moving carriage all these information is input for further research in conclusion the uncertainty spectrum gives insight in the sources of the random uncertainty this can be used for an effective approach to suppress the uncertainty and to improve the measurement quality 5 discussion although not shown here the authors have studied systematically a wide range of artificially generated signals with spectra closer to the reality of measurements of physical processes these spectra include more smooth forms but can contain multiple areas where energy resides with various bandwidths as well these signals show very similar behaviour of s m σ x as that described in section 2 2 therefore the band pass noise signal is regarded as representative in describing the dominant phenomena and trends of real measurement signals in the theory chapter 2 the phase spectrum of the artificially created master signal is assumed to be fully uncorrelated according to the central limit theorem this gives signals with a normally distributed probability density functions if the spectral bandwidth b 0 hz in reality measured time series can contain bands of high probability and or skewed probability density functions and or coupled harmonics these phenomena may have a significant effect on the random uncertainty of mean therefore this needs to be further investigated furthermore experiments can be intended to have a very narrow spectrum b 0 hz e g regular wave experiments for sea keeping tests in these cases the amplitude and phase of the dominant frequency are of interest as well as the mean as shown in fig 2 case f c 5 0 hz and b 0 5 hz the actual s m is relatively low when t is an integer number of the central period t c the signal is dominated by periodic components in these cases it is advised to remove these periodic components bendat and piersol 2010 and analyse the remainder with rum tst and ust throughout this paper all data is assumed to be stationary in some cases an experiment itself is intended to be quasi steady in dang et al 2012 and brouwer et al 2015b a preliminary version of rum was used on these measurements to compare to the quality of quasi steady measurement methods because of an increasing interest in quasi steady tests further development verification and validation on estimators for uncertainty analysis of quasi steady or quasi stationary time series is desirable it should be noted that rum only give a quantification of the random or aleatory uncertainty the systematic or epistemic uncertainty needs to be quantified by other techniques in experimental fluid dynamics a signal or time series results from a measurement of a quantity representative for a physical process in other words a signal is a statistical realisation of a physical process a tst evaluation gives information whether the realised signal is stationary or non stationary it can be applied on a wide range of signals from an almost perfect sine wave to nearly white noise for pure white noise signals this technique does not work because their uncertainty of the mean decays with the square root of the number of samples see section 2 2 white noise signals are characterised by subsequent samples without any correlation between them this type of signals hardly occur in experimental fluid dynamics if the tst result of a realised signal indicates stationarity then it can be concluded that the corresponding physical process is stationary however if a signal is marked as non stationary according to the tst evaluation then the corresponding physical process could be stationary but the measurement length too short the solution is to increase the measurement length when the measurement length is sufficiently long the tst results may indicate the presence of trends or transients these transients can be removed to select the stationary signal part for final analyses a typical example is given in chapter 4 a load measurement of a flat plate test another experimental example of the benefits of tst can be found in brouwer et al 2015a regarding a towed ship in ice conditions that paper describes a successful application of tst on a cfd simulation as well this concerns a time dependent resistance calculation of a cylinder in a uniform flow 6 conclusions and recommendations this paper gives an overview of three corresponding signal analyse methods random uncertainty of mean estimator rum the transient scanning technique tst and the uncertainty spectrum technique ust the developed methods allow the experimenter to quantify the quality of measurement results and optimise the measurement process the random uncertainty of mean estimator rum has been developed this estimator computes the random uncertainty of mean u m for an uncertainty level of 95 rum has been verified successfully for green noise signals the quantification of the random uncertainty of the mean for a single measurement with rum is a big improvements of the measurement results a remarkable finding is that for stationary green and blue noise like signals s um decays with the inverse of the sample record length t only white and red noise like signals show a decay with inverse of the square root of t based on this behaviour the transient scanning technique tst has been developed to check effectively the stationarity of measured signals the tst can be applied in two ways based on selection of signal parts from the beginning of a signal called tst a based on selection of signal parts from the end of a signal called tst b the tst a is very strong in identifying end effects in the signal while the tst b is very strong in identifying start up effects in the signal showing tst results on logarithmic scales three cases can be discerned the data shows a linear decrease a 1 t behaviour till t t max then the signal is stationary the data shows no 1 t behaviour then the signal is not stationary the data shows 1 t behaviour for a limited range of t then start up and or end transients are present the uncertainty spectrum technique ust gives information about the spectral uncertainty contributions of separate frequency ranges the uncertainty spectrum allows to detect which frequency ranges contribute significantly to the random uncertainty of mean this can contribute to improve the measurement set up and hence the measurement result quality it has been demonstrated using actual tank test data ust can be used to identify the limits of accuracy of a facility or computational program with respect to the randomness in its signals or processes as well 6 1 recommendations it is advised to extend the validation of the random uncertainty of mean estimator rum for other types of measured time series using the repeat reference with simulated data special focus needs to be on time series with correlated phase spectra because the theory of rum is based on uncorrelated phase spectra future development is required for similar estimators for quasi stationary or quasi steady signals instead of stationary signals until now the presence of the 1 t behaviour in the tst plots has been detected visually the following step is to extend the tst with algorithms for automatic detection of the 1 t behaviour in the tst plots regarding ust it is advised to study in detail the effect of numerical noise on the uncertainty spectral values this may result a more effective noise filter feasible for a broad range of signals 
22818,in this paper a method of solving inverse kinematics based on fuzzy algorithm for hybrid system is presented this approach could compensate the wave disturbances when the hybrid mechanism is conducting a certain task such as transporting the repairmen into wind turbine platform by deriving the jacobian matrix of the hybrid mechanism the relationship between the angular and linear velocities of variables in joint space and gangway s end effector in task space can be obtained thereafter the numerical integral method is used to obtain the inverse kinematic solution structurally the hybrid mechanism consists of a 6 dofs stewart parallel platform and a 3 dofs gangway due to the kinematical redundant of the hybrid boarding system its inverse kinematic solutions are not unique thus a fuzzy strategy is put forward to plan the variable values reasonably moreover it can satisfy the requirement of variable constraints when conducting ocean wave compensation specifically the stewart parallel platform is used to compensate the wave disturbance in roll direction moreover it is efficient to compensate other disturbances by adjusting the joint angles of gangway the effectiveness and the robustness of the proposed method is demonstrated using numerical simulation when the wave disturbance is added into the hybrid boarding system keywords inverse kinematics 6 dofs stewart platform fuzzy algorithm wave compensate hybrid mechanism 1 introduction the development and usage of clean and green energies have attracted great attention with the rapid development of science and technology and the ever increasing living standard for civilians the off shore wind power generation station has become one of the largest electric power reserves along with the marine engineering techniques and the most potentials of development in the new energy fields aquila et al 2018 however the exploitation of wind power resources in the complex ocean environment also reveals some problems at present specifically off shore wind power stations are suffering long term and continuous influences of multiple loads from huge wind long wave and high tide the complex off shore environmental conditions make the off shore wind power stations more prone to failure when the off shore wind operation and maintenance vessel encounters huge waves it is more difficult for the repairmen to reach to the wind turbine platform therefore in order to maintain the stability of the boarding system and ensure the safety of the repairmen it is of great importance to study the real time and robustness characteristics of the ocean wave active compensation system there is other important application of stable surface platform support of auv operation oceanographic survey ecological and biological monitoring dulepov et al 2003 and marine reserve guarding are some of long term tasks periodically auv must to find out the dock unit and to approach it in automatic mode from the distance of few kilometers gornak et al 2006 then auv needs to perform the precise maneuvering near dock unit and to fulfill the docking operation kushnerik et al 2009 there are several actions in the dock stage connected with recharging of the auv batteries transferring of accumulated data and correction of current mission the stable surface platform with dock unit has to support auv navigation power and data transfer connection at present many scholars are focused on the research of parallel system due to the strong robustness and simple inverse kinematics of parallel mechanism the stewart platform is one example of a parallel connection robot manipulator stewart 1965 has then highlighted the interest of this mechanical architecture for flight simulators traditionally a 6 dofs stewart parallel platform is used independently for building the boarding system of offshore wind operation and maintenance vessel but with limited workspace and unmanageable control dasgupta and mruthyunjaya 2000 compared with the tandem mechanism this mechanism has more load bearing capacity high rigidity and stable structure therefore the hybrid boarding system is proposed to complete ocean wave compensation by scholars ampelmann http www ampelmann de en as shown in fig 1 the hybrid mechanism includes a 6 dofs stewart platform and a 3 dofs gangway serial manipulator which combines the advantages of tandem mechanism and parallel mechanism together zeng et al 2014 it provides the foundation for the active compensation of the ocean wave and is used to implement the active compensation of the ocean wave so as to ensure the safety of repairmen compared with traditional ocean wave compensation system the proposed hybrid mechanism presents a large stiffness high precision high load carrying capacity moreover the work space of boarding system is increased at the same time however it brings the difficulty to solve the inverse kinematics for the hybrid boarding system due to its kinematic redundancy some researchers focus on the direct kinematics of parallel manipulators wenger and chablat 1997 however it is complicated to solve the direct kinematics for parallel manipulator therefore in this paper the direct kinematics of 3 dofs serial manipulator and the inverse kinematics of the 6 dofs parallel stewart platform are analyzed thereafter the jacobian matrix from the gangway s end effector to the stewart platform s top frame is established by using the pseudo inverse of the jacobian matrix along with the inverse kinematic solution of stewart platform we can obtain the inverse kinematic solution of the hybrid mechanism the fuzzy algorithm is widely used to tuning the parameters such as the coefficient of proportion integral derivation adaptive factor and sliding switching function berstecher et al 1996 duan et al 2012 wong 2013 what s more it has high capacity of robustness which make disturbance and changed parameters have little effect on control system chen et al 2013 therefore in this paper to dealing with the kinematic redundant problems a fuzzy strategy is proposed to design the movement of variables in hybrid mechanism in case of ocean wave disturbances the rest of this paper is organized as follows section 2 describes the composition of the hybrid system the kinematical modeling of the hybrid board system is presented along with the jacobian matrix in section 3 in section 4 the inverse kinematics based fuzzy strategy is proposed and the numerical simulation with ocean wave compensation is conducted in section 5 finally section 6 gives the conclusions 2 system composition 2 1 6 dofs stewart parallel platform the detailed structure and mechanism analysis of the 6 dofs stewart platform is provided by wu 2012 fig 2 shows the diagram of the stewart parallel platform and demonstrates the location of two platforms and the hydraulic cylinder as shown in fig 2 the links of the 6 dofs stewart platform are all connected both the base and the mobile plate through joints in each link a prismatic actuator makes it possible to change the link length the six links numbered from 1 to 6 are articulated with a universal joint at the b points on the base and with ball and socket joints at the a points on the top plate 2 2 3 dofs tandem manipulator the hybrid boarding system in that designed above the stewart parallel platform is a 3 dofs tandem manipulator in a nutshell we can understand it as a 3 dofs connecting rod the upper platform is 3 dofs and it is a tandem mechanism consisting of a telescopic bridge tilting mechanism slewing mechanism and operating platform its structure from bottom to top is followed by slewing mechanism tilting mechanism and telescopic bridge the upper platform is mainly used for docking with the offshore platform further it compensates for the spatial displacements and heading angles of large waves that cannot be compensated by the 6 dofs stewart parallel platform in different seasons the slewing mechanism has a 360 degree rotation angle to compensate for the deviation of the bridge in heading angle and regards hydraulic motor as the actuating element the tilting mechanism can compensate the deviation of the bridge in pitch angle and the double hydraulic cylinder is used as the actuating element telescopic bridge can compensate the deviation of space displacement so we adopt the way of brushless dc motor plus bidirectional cable to control the expansion of the bridge 2 3 hybrid mechanism the specific composition of the hybrid mechanism is a combination of a 6 dofs stewart parallel platform and a 3 dofs tandem manipulator to form a 9 dofs hybrid mechanism 3 kinematic analysis 3 1 the establishment of coordinate system the coordinate system establishment of the static and dynamic platform is shown by mirza et al 2017 and the establishment situation of the connecting rod coordinate system is given by us so we can establish the coordinate system of hybrid mechanism as shown in fig 3 3 2 modeling in joint space b x b y b z b is a fixed reference coordinate system fixed in a static platform and a o x a y a z a is a dynamic reference coordinate system fixed in the center of a dynamic platform the coordinates of a with respect to b are b i x y z t and the transformation matrix of the moving platform relative to the static platform is r b a suppose euler angles of the platform around the three axes of x a y a z a are α β γ respectively the position and attitude of the dynamic platform is expressed as p x y z α β γ t then the rotation matrix of stewart parallel platform is 1 r b a r z γ r y β r x α c γ c β c γ s β s α s γ c α c γ s β c α s γ s α s γ c β s γ s β s α c γ c α s γ s β c α c γ s α s β c β s α c β c α homogeneous transformation matrix is termed as t b a the 3 dofs tandem mechanism is interpreted as a connecting rod so the d h parameter method singh et al 2015 is used to describe the coordinate direction and parameters between adjacent connecting rods in the solution process to establish the connecting rod coordinate system 2 t i 1 i c θ i s θ i 0 a i 1 s θ i c α i 1 c θ i c α i 1 s α i 1 s α i 1 d i s θ i s α i 1 c θ i s α i 1 c α i 1 c α i 1 d i 0 0 0 1 where c s are the abbreviation of the cosine and sine functions respectively as the 3 dofs tandem mechanism is embedded in a 6 dofs parallel mechanism it can be seen that a and o coincide with each other to obtain t a o i 4 4 we assume that the homogenous matrix form inertial frame to base frame of the hybrid mechanism is termed as t e b then the homogeneous transformation matrix of hybrid platform is 3 t e 3 t e b t b 3 t e b t b a t a 3 in eq 3 e is the inertial reference frame 3 3 jacobian matrix first let us define ζ as ζ υ 1 υ 2 q where q is the time derivative of the joint positions i e the joint velocities actually ζ x y z α β γ q 1 q 2 q 3 t s d x d y d z d α d β d γ d t yan and wu 2013 4 j p o s r a b q r a b s r 0 a η 0 e e 0 r a b j p o s m a n 5 j o r r a b q o 3 3 r a b j o r m a n finally the following compact expression is achieved 6 s d η e e 1 ω e e j r a b q ζ where j r a b q j p o s r a b q j o r r a b q r 6 9 where j p o s m a n j o r m a n are the jacobian matrix of the 3 dofs serial manipulator separately hence a complete jacobian matrix is derived 3 4 geometric parameters and range now we define the length vector of the six telescopic poles on the stewart platform as l i l 1 l 2 l 6 t the i th branched chain is used to analyze the spatial position relationships of the mechanism let a i be the position vector on the moving platform from the origin of the moving coordinate system to the i th hinge point a i r i is the position vector from the origin of the static coordinate system to the i th hinge point a i on the moving platform the position vector of c is from the origin of the static coordinate system to the origin of the dynamic coordinate system and l i is the vector from b i to a i in the static coordinate system the position relationship of each vector is shown in fig 4 fig 4 shows the spatial position relationship of the 6 dofs mechanism any vector in the dynamic coordinate system can be transformed into the static coordinate system through a coordinate transformation method 7 l i c r a b a i b i i 1 2 6 4 inverse kinematics solution based on fuzzy control as the fuzzy algorithm is high robust to variation of model and external disturbance sarkar 2018 wang et al 2016 it is efficient for disturbances compensation and parameters adjustment in this paper the fuzzy strategy is adopted to compensate the ocean wave for hybrid boarding system in the duration of working first the error between the gangway s end effector s e x e y e z e α e β e θ e t and wind platform s d x d y d z d α d β d θ d t is defined 8 e s d s e the inverse kinematics formula is 9 d ζ j r a b q s d k 1 e j a k 2 f 2 ζ among them j a i j r a b q j r a b q f 2 ζ is the function of variable ζ x y z α β γ q 1 q 2 q 3 t which is used to satisfy the requirement of variable constraints ζ is the position and attitude of the mobile plant in stewart platform and joint angle of 3 dofs serial manipulator 10 f 2 ζ 0 ζ max ζ δ ζ 0 ζ max ζ 0 ζ max i 1 2 6 the value of δ is the margin of ζ fuzzy controller input are e d max s d s e ζ max f 2 ζ and they are all six dimensional vectors we multiply e d with the adaptive factor k 1 to calculate the target pose correction δ s define 3 fuzzy sets for input e d p b z e n b the domain is e d 0 25 0 25 define 2 fuzzy sets for input e ζ p b z e the domain is e ζ 1 1 at the same time define 3 fuzzy sets corresponding to the adaptive factor k 1 k 2 p b z e n b the domains are k 1 50 100 k 2 10 20 the membership functions defined above are all triangular and the rules are as follows if e d is p b e ζ is p b then k 1 is p b k 2 is p b if e d is p b e ζ is z e then k 1 is p b k 2 is z e if e d is z e e ζ is p b then k 1 is z e k 2 is p b if e d is z e e ζ is z e then k 1 is z e k 2 is z e if e d is n b e ζ is p b then k 1 is n b k 2 is p b if e d is n b e ζ is z e then k 1 is n b k 2 is z e when designing the membership function curve e ζ is e c based on eq 9 by using numerical integral method we can obtain the value of ζ then the inverse kinematic solution for 6 dofs stewart platform that is l 1 l 2 l 3 l 4 l 5 l 6 can be obtained based on the value of x y z α β γ by using eq 7 5 simulation analysis 5 1 parameters of the hybrid mechanism l i l i l i t l i l i x 2 l i y 2 l i z 2 1 5 m i 1 2 6 the range of the dynamic platform in static coordinate system is determined by the range of the telescopic rod s length and the moving range of the dynamic platform can be known through calculations we can see that the position range of the dynamic platform x 0 5 0 5 m y 0 25 0 25 m z 2 75 3 25 m see table 1 5 2 ocean wave interference analysis it is impossible for a vessel to move at sea without being affected by the ocean waves for the ideal situation t e b is fixed as there is no external disturbance such as ocean wave however by taking the actual complex environment in ocean into consideration it is necessary to considering the ocean wave disturbance we assume that the ocean wave disturbance is d d x d y d z d α d β d θ t where d x d y d β d θ 0 d z 0 3 sin π 20 t d α 10 π 180 sin π 15 t by using euler angle method the homogenous matrix for disturbance can be obtained noted as t d e b t d e b is time varying after ocean wave interference introduced we cannot use the traditional algebraic method that is assume that the homogeneous transformation matrix of the target point with respect to the inertial coordinate system is t s and inverse kinematics is solved with t e 3 t e b t b a t a 3 t s and t b a t a 3 t 1 e b t s in this case the use of algebraic method will degrade the real time performance of the system and the amount of calculation is huge which is not conducive to solving taking into account the above shortcomings and drawbacks the traditional algebraic method is abandoned and instead by a fuzzy method to improve the system s real time performance and robustness while achieving the purpose of simple and convenient solution see fig 5 5 2 simulation results the numerical simulation is conducted considering the ocean wave disturbances the total simulation time is 120s the ocean wave disturbance occurs during 48s and 108s as shown in fig 6 in the simulation we added the ocean wave interference curve shown in fig 6 the positions and orientations of gangway s end effector and the wind platform are shown in fig 7 it is shown that the proposed method can compensate the wave disturbance fig 8 describes the system error e it shows that the gangway s end effector can maintain stable to wind platform without wave disturbances however in the case of wave disturbance the error e occurs although the error cannot be eliminated it is constraint in the range of 0 25 m for position error and 0 04 rad for orientation error which demonstrated the robustness of the proposed method the inverse kinematic solution for hybrid board system is shown in figs 8 and 9 the results show that the variables are within the constraint range which illustrated the effectiveness of the proposed method see fig 10 6 conclusions this paper proposed a new method of inverse kinematics for hybrid boarding system to perform a certain transportation task the external disturbance such as ocean wave was compensated to control the stability of the hybrid mechanism the effectiveness of the proposed method is verified using numerical simulation experiments moreover this research provides a method for inverse kinematics considering the variable constraints and ocean wave disturbance which is the basis for achieving a robust controller design for a variety of scientific industrial missions using hybrid boarding system finally the simulation results reveal the effectiveness and robustness of the proposed approach in the compensation of ocean wave disturbance therefore the proposed method has great potential for real time implementation because of its simple structure in the future research work appendix a supplementary data the following are the supplementary data to this article supplementary data supplementary data supplementary data supplementary data supplementary data supplementary data supplementary data supplementary data supplementary data supplementary data supplementary data supplementary data multimedia component 7 multimedia component 7 multimedia component 8 multimedia component 8 multimedia component 9 multimedia component 9 multimedia component 10 multimedia component 10 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 03 059 
22818,in this paper a method of solving inverse kinematics based on fuzzy algorithm for hybrid system is presented this approach could compensate the wave disturbances when the hybrid mechanism is conducting a certain task such as transporting the repairmen into wind turbine platform by deriving the jacobian matrix of the hybrid mechanism the relationship between the angular and linear velocities of variables in joint space and gangway s end effector in task space can be obtained thereafter the numerical integral method is used to obtain the inverse kinematic solution structurally the hybrid mechanism consists of a 6 dofs stewart parallel platform and a 3 dofs gangway due to the kinematical redundant of the hybrid boarding system its inverse kinematic solutions are not unique thus a fuzzy strategy is put forward to plan the variable values reasonably moreover it can satisfy the requirement of variable constraints when conducting ocean wave compensation specifically the stewart parallel platform is used to compensate the wave disturbance in roll direction moreover it is efficient to compensate other disturbances by adjusting the joint angles of gangway the effectiveness and the robustness of the proposed method is demonstrated using numerical simulation when the wave disturbance is added into the hybrid boarding system keywords inverse kinematics 6 dofs stewart platform fuzzy algorithm wave compensate hybrid mechanism 1 introduction the development and usage of clean and green energies have attracted great attention with the rapid development of science and technology and the ever increasing living standard for civilians the off shore wind power generation station has become one of the largest electric power reserves along with the marine engineering techniques and the most potentials of development in the new energy fields aquila et al 2018 however the exploitation of wind power resources in the complex ocean environment also reveals some problems at present specifically off shore wind power stations are suffering long term and continuous influences of multiple loads from huge wind long wave and high tide the complex off shore environmental conditions make the off shore wind power stations more prone to failure when the off shore wind operation and maintenance vessel encounters huge waves it is more difficult for the repairmen to reach to the wind turbine platform therefore in order to maintain the stability of the boarding system and ensure the safety of the repairmen it is of great importance to study the real time and robustness characteristics of the ocean wave active compensation system there is other important application of stable surface platform support of auv operation oceanographic survey ecological and biological monitoring dulepov et al 2003 and marine reserve guarding are some of long term tasks periodically auv must to find out the dock unit and to approach it in automatic mode from the distance of few kilometers gornak et al 2006 then auv needs to perform the precise maneuvering near dock unit and to fulfill the docking operation kushnerik et al 2009 there are several actions in the dock stage connected with recharging of the auv batteries transferring of accumulated data and correction of current mission the stable surface platform with dock unit has to support auv navigation power and data transfer connection at present many scholars are focused on the research of parallel system due to the strong robustness and simple inverse kinematics of parallel mechanism the stewart platform is one example of a parallel connection robot manipulator stewart 1965 has then highlighted the interest of this mechanical architecture for flight simulators traditionally a 6 dofs stewart parallel platform is used independently for building the boarding system of offshore wind operation and maintenance vessel but with limited workspace and unmanageable control dasgupta and mruthyunjaya 2000 compared with the tandem mechanism this mechanism has more load bearing capacity high rigidity and stable structure therefore the hybrid boarding system is proposed to complete ocean wave compensation by scholars ampelmann http www ampelmann de en as shown in fig 1 the hybrid mechanism includes a 6 dofs stewart platform and a 3 dofs gangway serial manipulator which combines the advantages of tandem mechanism and parallel mechanism together zeng et al 2014 it provides the foundation for the active compensation of the ocean wave and is used to implement the active compensation of the ocean wave so as to ensure the safety of repairmen compared with traditional ocean wave compensation system the proposed hybrid mechanism presents a large stiffness high precision high load carrying capacity moreover the work space of boarding system is increased at the same time however it brings the difficulty to solve the inverse kinematics for the hybrid boarding system due to its kinematic redundancy some researchers focus on the direct kinematics of parallel manipulators wenger and chablat 1997 however it is complicated to solve the direct kinematics for parallel manipulator therefore in this paper the direct kinematics of 3 dofs serial manipulator and the inverse kinematics of the 6 dofs parallel stewart platform are analyzed thereafter the jacobian matrix from the gangway s end effector to the stewart platform s top frame is established by using the pseudo inverse of the jacobian matrix along with the inverse kinematic solution of stewart platform we can obtain the inverse kinematic solution of the hybrid mechanism the fuzzy algorithm is widely used to tuning the parameters such as the coefficient of proportion integral derivation adaptive factor and sliding switching function berstecher et al 1996 duan et al 2012 wong 2013 what s more it has high capacity of robustness which make disturbance and changed parameters have little effect on control system chen et al 2013 therefore in this paper to dealing with the kinematic redundant problems a fuzzy strategy is proposed to design the movement of variables in hybrid mechanism in case of ocean wave disturbances the rest of this paper is organized as follows section 2 describes the composition of the hybrid system the kinematical modeling of the hybrid board system is presented along with the jacobian matrix in section 3 in section 4 the inverse kinematics based fuzzy strategy is proposed and the numerical simulation with ocean wave compensation is conducted in section 5 finally section 6 gives the conclusions 2 system composition 2 1 6 dofs stewart parallel platform the detailed structure and mechanism analysis of the 6 dofs stewart platform is provided by wu 2012 fig 2 shows the diagram of the stewart parallel platform and demonstrates the location of two platforms and the hydraulic cylinder as shown in fig 2 the links of the 6 dofs stewart platform are all connected both the base and the mobile plate through joints in each link a prismatic actuator makes it possible to change the link length the six links numbered from 1 to 6 are articulated with a universal joint at the b points on the base and with ball and socket joints at the a points on the top plate 2 2 3 dofs tandem manipulator the hybrid boarding system in that designed above the stewart parallel platform is a 3 dofs tandem manipulator in a nutshell we can understand it as a 3 dofs connecting rod the upper platform is 3 dofs and it is a tandem mechanism consisting of a telescopic bridge tilting mechanism slewing mechanism and operating platform its structure from bottom to top is followed by slewing mechanism tilting mechanism and telescopic bridge the upper platform is mainly used for docking with the offshore platform further it compensates for the spatial displacements and heading angles of large waves that cannot be compensated by the 6 dofs stewart parallel platform in different seasons the slewing mechanism has a 360 degree rotation angle to compensate for the deviation of the bridge in heading angle and regards hydraulic motor as the actuating element the tilting mechanism can compensate the deviation of the bridge in pitch angle and the double hydraulic cylinder is used as the actuating element telescopic bridge can compensate the deviation of space displacement so we adopt the way of brushless dc motor plus bidirectional cable to control the expansion of the bridge 2 3 hybrid mechanism the specific composition of the hybrid mechanism is a combination of a 6 dofs stewart parallel platform and a 3 dofs tandem manipulator to form a 9 dofs hybrid mechanism 3 kinematic analysis 3 1 the establishment of coordinate system the coordinate system establishment of the static and dynamic platform is shown by mirza et al 2017 and the establishment situation of the connecting rod coordinate system is given by us so we can establish the coordinate system of hybrid mechanism as shown in fig 3 3 2 modeling in joint space b x b y b z b is a fixed reference coordinate system fixed in a static platform and a o x a y a z a is a dynamic reference coordinate system fixed in the center of a dynamic platform the coordinates of a with respect to b are b i x y z t and the transformation matrix of the moving platform relative to the static platform is r b a suppose euler angles of the platform around the three axes of x a y a z a are α β γ respectively the position and attitude of the dynamic platform is expressed as p x y z α β γ t then the rotation matrix of stewart parallel platform is 1 r b a r z γ r y β r x α c γ c β c γ s β s α s γ c α c γ s β c α s γ s α s γ c β s γ s β s α c γ c α s γ s β c α c γ s α s β c β s α c β c α homogeneous transformation matrix is termed as t b a the 3 dofs tandem mechanism is interpreted as a connecting rod so the d h parameter method singh et al 2015 is used to describe the coordinate direction and parameters between adjacent connecting rods in the solution process to establish the connecting rod coordinate system 2 t i 1 i c θ i s θ i 0 a i 1 s θ i c α i 1 c θ i c α i 1 s α i 1 s α i 1 d i s θ i s α i 1 c θ i s α i 1 c α i 1 c α i 1 d i 0 0 0 1 where c s are the abbreviation of the cosine and sine functions respectively as the 3 dofs tandem mechanism is embedded in a 6 dofs parallel mechanism it can be seen that a and o coincide with each other to obtain t a o i 4 4 we assume that the homogenous matrix form inertial frame to base frame of the hybrid mechanism is termed as t e b then the homogeneous transformation matrix of hybrid platform is 3 t e 3 t e b t b 3 t e b t b a t a 3 in eq 3 e is the inertial reference frame 3 3 jacobian matrix first let us define ζ as ζ υ 1 υ 2 q where q is the time derivative of the joint positions i e the joint velocities actually ζ x y z α β γ q 1 q 2 q 3 t s d x d y d z d α d β d γ d t yan and wu 2013 4 j p o s r a b q r a b s r 0 a η 0 e e 0 r a b j p o s m a n 5 j o r r a b q o 3 3 r a b j o r m a n finally the following compact expression is achieved 6 s d η e e 1 ω e e j r a b q ζ where j r a b q j p o s r a b q j o r r a b q r 6 9 where j p o s m a n j o r m a n are the jacobian matrix of the 3 dofs serial manipulator separately hence a complete jacobian matrix is derived 3 4 geometric parameters and range now we define the length vector of the six telescopic poles on the stewart platform as l i l 1 l 2 l 6 t the i th branched chain is used to analyze the spatial position relationships of the mechanism let a i be the position vector on the moving platform from the origin of the moving coordinate system to the i th hinge point a i r i is the position vector from the origin of the static coordinate system to the i th hinge point a i on the moving platform the position vector of c is from the origin of the static coordinate system to the origin of the dynamic coordinate system and l i is the vector from b i to a i in the static coordinate system the position relationship of each vector is shown in fig 4 fig 4 shows the spatial position relationship of the 6 dofs mechanism any vector in the dynamic coordinate system can be transformed into the static coordinate system through a coordinate transformation method 7 l i c r a b a i b i i 1 2 6 4 inverse kinematics solution based on fuzzy control as the fuzzy algorithm is high robust to variation of model and external disturbance sarkar 2018 wang et al 2016 it is efficient for disturbances compensation and parameters adjustment in this paper the fuzzy strategy is adopted to compensate the ocean wave for hybrid boarding system in the duration of working first the error between the gangway s end effector s e x e y e z e α e β e θ e t and wind platform s d x d y d z d α d β d θ d t is defined 8 e s d s e the inverse kinematics formula is 9 d ζ j r a b q s d k 1 e j a k 2 f 2 ζ among them j a i j r a b q j r a b q f 2 ζ is the function of variable ζ x y z α β γ q 1 q 2 q 3 t which is used to satisfy the requirement of variable constraints ζ is the position and attitude of the mobile plant in stewart platform and joint angle of 3 dofs serial manipulator 10 f 2 ζ 0 ζ max ζ δ ζ 0 ζ max ζ 0 ζ max i 1 2 6 the value of δ is the margin of ζ fuzzy controller input are e d max s d s e ζ max f 2 ζ and they are all six dimensional vectors we multiply e d with the adaptive factor k 1 to calculate the target pose correction δ s define 3 fuzzy sets for input e d p b z e n b the domain is e d 0 25 0 25 define 2 fuzzy sets for input e ζ p b z e the domain is e ζ 1 1 at the same time define 3 fuzzy sets corresponding to the adaptive factor k 1 k 2 p b z e n b the domains are k 1 50 100 k 2 10 20 the membership functions defined above are all triangular and the rules are as follows if e d is p b e ζ is p b then k 1 is p b k 2 is p b if e d is p b e ζ is z e then k 1 is p b k 2 is z e if e d is z e e ζ is p b then k 1 is z e k 2 is p b if e d is z e e ζ is z e then k 1 is z e k 2 is z e if e d is n b e ζ is p b then k 1 is n b k 2 is p b if e d is n b e ζ is z e then k 1 is n b k 2 is z e when designing the membership function curve e ζ is e c based on eq 9 by using numerical integral method we can obtain the value of ζ then the inverse kinematic solution for 6 dofs stewart platform that is l 1 l 2 l 3 l 4 l 5 l 6 can be obtained based on the value of x y z α β γ by using eq 7 5 simulation analysis 5 1 parameters of the hybrid mechanism l i l i l i t l i l i x 2 l i y 2 l i z 2 1 5 m i 1 2 6 the range of the dynamic platform in static coordinate system is determined by the range of the telescopic rod s length and the moving range of the dynamic platform can be known through calculations we can see that the position range of the dynamic platform x 0 5 0 5 m y 0 25 0 25 m z 2 75 3 25 m see table 1 5 2 ocean wave interference analysis it is impossible for a vessel to move at sea without being affected by the ocean waves for the ideal situation t e b is fixed as there is no external disturbance such as ocean wave however by taking the actual complex environment in ocean into consideration it is necessary to considering the ocean wave disturbance we assume that the ocean wave disturbance is d d x d y d z d α d β d θ t where d x d y d β d θ 0 d z 0 3 sin π 20 t d α 10 π 180 sin π 15 t by using euler angle method the homogenous matrix for disturbance can be obtained noted as t d e b t d e b is time varying after ocean wave interference introduced we cannot use the traditional algebraic method that is assume that the homogeneous transformation matrix of the target point with respect to the inertial coordinate system is t s and inverse kinematics is solved with t e 3 t e b t b a t a 3 t s and t b a t a 3 t 1 e b t s in this case the use of algebraic method will degrade the real time performance of the system and the amount of calculation is huge which is not conducive to solving taking into account the above shortcomings and drawbacks the traditional algebraic method is abandoned and instead by a fuzzy method to improve the system s real time performance and robustness while achieving the purpose of simple and convenient solution see fig 5 5 2 simulation results the numerical simulation is conducted considering the ocean wave disturbances the total simulation time is 120s the ocean wave disturbance occurs during 48s and 108s as shown in fig 6 in the simulation we added the ocean wave interference curve shown in fig 6 the positions and orientations of gangway s end effector and the wind platform are shown in fig 7 it is shown that the proposed method can compensate the wave disturbance fig 8 describes the system error e it shows that the gangway s end effector can maintain stable to wind platform without wave disturbances however in the case of wave disturbance the error e occurs although the error cannot be eliminated it is constraint in the range of 0 25 m for position error and 0 04 rad for orientation error which demonstrated the robustness of the proposed method the inverse kinematic solution for hybrid board system is shown in figs 8 and 9 the results show that the variables are within the constraint range which illustrated the effectiveness of the proposed method see fig 10 6 conclusions this paper proposed a new method of inverse kinematics for hybrid boarding system to perform a certain transportation task the external disturbance such as ocean wave was compensated to control the stability of the hybrid mechanism the effectiveness of the proposed method is verified using numerical simulation experiments moreover this research provides a method for inverse kinematics considering the variable constraints and ocean wave disturbance which is the basis for achieving a robust controller design for a variety of scientific industrial missions using hybrid boarding system finally the simulation results reveal the effectiveness and robustness of the proposed approach in the compensation of ocean wave disturbance therefore the proposed method has great potential for real time implementation because of its simple structure in the future research work appendix a supplementary data the following are the supplementary data to this article supplementary data supplementary data supplementary data supplementary data supplementary data supplementary data supplementary data supplementary data supplementary data supplementary data supplementary data supplementary data multimedia component 7 multimedia component 7 multimedia component 8 multimedia component 8 multimedia component 9 multimedia component 9 multimedia component 10 multimedia component 10 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 03 059 
22819,in this paper the role nearly resonant components play in collinear steady state wave groups in finite water depth is investigated theoretically fully nonlinear water wave equations are solved when the resonance conditions are nearly satisfied convergent solutions are obtained for steady state wave groups with multiple near resonances spectra analysis shows that as water depth decreases from deep water to finite water depth the four wave nearly resonant interactions play a dominant role in nonlinear steady state wave groups meanwhile the dispersion relation changes with the water depth and some low and high frequency components appear in the spectrum due to the three wave nearly resonant interactions comparison between the linear and nonlinear wave groups are made in finite water depth when the mean rates of mass momentum and energy fluxes are almost conserved it is found that wave energy in nonlinear wave groups is redistributed as more components join the resonance when the nonlinearity increases besides both the wave group steepness and magnitude of water particle horizontal velocities near the crests and troughs in nonlinear wave groups increase more rapidly with the nonlinearity the significance of near resonances in finite water depth for collinear steady state wave groups is demonstrated keywords surface gravity waves near resonance steady state wave groups 1 introduction the accurate prediction of wave body interaction is one of the major scientific problems nowadays in ocean engineering characteristics of the sea wave fields change as the waves travel from deep water to shallower water depth so do the features of waves body interactions kristiansen and faltinsen 2017 considered higher harmonic wave loads on a vertical cylinder in finite water depth and found that the second and third order incident wave potentials which are zero in deep water give major contributions in finite water depths loukogeorgaki 2018 found that the water depth effects on the wave energy converters response and the wave farm s absorbed power are pronounced in case of irregular waves therefore to better predict the wave body interaction we need to deepen our understanding about the effects of water depth on the nonlinear wave evolution first for deterministic wave fields larsen 1978 found that soliton wave packets forces a long gravity wave when they move on waters of finite depth the long gravity wave affects the shape of the wave packet in factors that decay linearly with increasing depth shemer and kit 1998 conducted experiments on nonlinear wave groups in intermediate water depth it was confirmed that wave groups propagating over relatively shallow water undergo demodulation and their wave energy tends to spread more uniformly over the group in deeper water wave energy focusing leading to increase of the maximum wave height above its initial value is observed fernandez et al 2014 numerically studied the nonlinear wave dynamic in finite water depth by high order spectral method west et al 1987 dommermuth 1987 pan and yue 2014 2015 miao and liu 2015 qi et al 2018 when the plane wave is seeded with collinear perturbation fernandez et al 2014 found that modulational instability ceases quite suddenly at k 0 h 1 36 for oblique unstable perturbations modulational instability survives beyond this critical water depth and a significant amplification can be achieved for relative shallow water with k 0 h 1 36 for random wave fields hang and hudspeth 1985 numerically examined the behavior of the skewness kernel as a function of finite water depth and confirmed that the skewness measures are positive and increase as the water depth decreases laing 1986 developed the weakly nonlinear theory for a stationary and homogeneous field of random gravity waves in water of finite depth to the third order and considered the influence of directional distribution growth stage and water depth on the spectrum a second order solution for the wind generated waves was proposed by arena et al 2008 to consider the nonlinear structure of three dimensional random wave groups in intermediate water depth arena et al 2008 found that the nonlinearity increases as the water depth becomes smaller and by reducing the water depth second order effects become greater for short crested waves it is well known that third order nonlinearity produces a strong deviation from gaussian statistics in water of infinite depth provided the wave field is long crested narrow banded and sufficiently steep simulations conducted by toffoli et al 2009 shows the deviation from gaussian statistics of long crested deep water waves was gradually reduce besides the third order nonlinear dynamics of free waves produced a weak upshift of the spectral peak for k p h 1 36 instead of the downshift commonly observed in deep water dutykh 2014 found that statistical properties of quasi deterministic wave field may vary significantly when the water depth is decreased from deep to rather shallow waters actually not only the wave spectra but also the related wave profiles change with the water depth jang et al 2007 considered wave profile of wave wave interaction with a finite depth effect by fixed point approach components with higher order nonlinear frequencies for two interacting stokes waves were obtained by superposition of two linear potentials for uni directional transient wave groups ning et al 2009 found that the fully nonlinear wave wave interactions produce a steeper wave envelope in which the central wave crest is higher and narrower while the adjacent wave troughs are broader and less deep recently liu et al 2016 compared the free surface elevation of linear and nonlinear wave groups when the mass momentum and energy flux are conserved in deep water fully nonlinear water wave equations was solved by the homotopy analysis method ham liao 1992 2003 2012 zhong liao 2018 and nonlinear bi chromatic waves with the dimensionless frequency ε σ i ω i increased up to 1 010 were obtained liu et al 2017 found that amplitudes of two third order components liu et al 2016 obtained are extraordinarily larger than the amplitude of other non primary components and increase with the nonlinearity the extraordinarily large high order components suggests that resonant interactions among two primary components and other nontrivial ones may already happen in the bi chromatic waves resonances should be considered in the solution procedure of steady state wave groups as the nonlinearity further increases for certain combinations of frequencies and wave number vectors resonance may occur at third order singularities and small divisors that associated with the exactly and nearly resonant components are difficult to be removed by the perturbation theory as it breaks down due to singularities in the transfer functions madsen and fuhrman 2012 by applying ham to the fully nonlinear water wave equations liao 2011 resolved the singularity caused by single exact resonance and obtained a steady state quartet in deep water xu et al 2012 extended the work of liao 2011 from infinite water depth to finite water depth and liu and liao 2014 considered multiple resonant interactions in quartets and sextets the existence of such kind of steady state resonant waves was investigated experimentally in a basin at the state key laboratory of ocean engineering in shanghai liu et al 2015 for near resonances liao et al 2016 proposed a solution procedure in ham to resolve small divisor associated with single nearly resonant component liu et al 2018 further developed the solution procedure to resolve the small divisors associated with nearly resonant components and finite amplitude steady state wave groups with multiple near resonances were obtained in deep water the steady state resonant wave groups provide a new approach from the view points of boundary value problem to consider the resonant interactions in nonlinear wave groups here steady state resonant waves means all wave amplitudes a i wavenumbers k i and actual frequencies σ i in a wave spectrum are constant and no wave energy is exchanged among different wave components the steady state resonance corresponds to a special thermodynamic equilibrium spectrum zakharov et al 1992 for weakly nonlinear steady state resonant waves in finite water depth xu et al 2012 compared the results obtained from both ham and the zakharov s equation zakharov 1968 zakharov kharitonov 1970 lavrova 1983 and found that qualitatively identical conclusions can be obtained by using the zakharov s equation based on the solution procedure proposed by liu et al 2018 for steady state wave groups with multiple resonances liu et al 2017 obtained convergent series solutions for steady state wave groups in deep water with dimensionless frequency ε increased up to 1 018 it is found that as nonlinearity increases more wave components appear in the spectrum due to the nearly resonant interactions the nonlinear wave fields change from the initial bi chromatic waves that contain only two nontrivial primary components into the steady state resonant waves that contain both two primary components and other nearly resonant ones it should be noted that liu et al 2016 compared the elevation of linear and nonlinear wave groups in deep water while the effect of water depth on the elevation has not been considered besides the nonlinearity of bi chromatic waves liu et al 2016 considered is not high enough since multiple resonances were ignored liu et al 2017 obtained convergent solutions for steady state waves groups with multiple resonances and compared the spectrum and elevations of linear and nonlinear wave groups in deep water the effect of water depth on the nonlinear steady state wave groups needs further investigation the present paper generalizes the work of liu et al 2017 from deep water to finite water depth it should be noted that the extension from deep water to finite water depth is theoretically straightforward but practically difficult in deep water finite amplitude steady state resonant wave groups can be obtained as the small divisors caused by near resonances could be removed in the framework of ham by choosing a new auxiliary linear operator liu et al 2018 as the water depth decreases the convergence rate of series solution obtained by ham decreases and additional unpredictable components appear in the spectrum due to the three wave resonances it is hard to obtain convergent solutions for finite amplitude steady state resonant wave groups by ham in finite water depth in this paper we use the ham solutions in deep water as initial guesses and use the galerkin method okamura 2003 2010 to obtained convergent solutions as the water depth decreases the main advantage of galerkin method is the generality allowed in the spectral representation of the free surface ioualalen and kharif 1994 the combined solution procedure based on ham and galerkin method provides a robust and efficient way to obtain finite amplitude steady state resonant wave groups in finite water depth the main purpose of this paper is to investigate the role nearly resonant components play in collinear steady state wave groups in finite water depth steady state wave groups with multiple resonances are obtained in different water depths and the wave spectra are analyzed then in finite water depth linear and nonlinear steady state wave groups are compared when the mean rate of mass momentum and energy fluxes are conserved here it is assumed that the linear wave groups is combined by two primary travelling waves with nonlinear wave wave interactions neglected in nonlinear wave groups the nonlinear wave wave interactions are considered and assumed to change the amplitude of each component but not the frequency frequency of two primary components in linear wave groups equals to that in the nonlinear wave groups and keeps unchanged when water depth or nonlinearity changes the paper is organized as follows the governing equation is described in section 2 1 resonance conditions are analyzed in section 2 2 and solution procedure is described in section 2 3 conservation equations between the linear and nonlinear wave groups are introduced in section 2 4 nonlinear steady state wave groups is analyzed in section 3 1 conservation analysis and wave field comparisons are shown in section 3 2 and 3 3 detailed expressions of the jacobian matrix is given in appendix a 2 mathematical description 2 1 governing equation assume the fluid motion is irrotational a velocity potential φ x z t can be defined where z is measured vertically upwards and t indicates time for inviscid and incompressible fluid without surface tension the governing equations for two dimensional wave field read 1 2 φ 0 d z η x t 2 2 φ t 2 g φ z φ 2 t φ 1 2 φ 2 0 on z η x t 3 g η φ t 1 2 φ 2 0 on z η x t 4 φ z 0 on z d where η denotes the free surface elevation g is the gravity acceleration and d is the water depth consider a steady state wave group that consists of two primary progressive waves with the phase functions 5 ξ i k i x σ i t i 1 2 in the new coordinate system ξ 1 ξ 2 z the original initial boundary value problem 1 4 can be transformed into a boundary value problem governed by 6 2 i 1 2 j 1 k i k j 2 φ ξ i ξ j 2 φ z 2 0 d z η ξ 1 ξ 2 subject to the two boundary conditions on the unknown free surface z η ξ 1 ξ 2 7 n 1 φ 2 i 1 2 j 1 σ i σ j 2 φ ξ i ξ j g φ z 2 2 i 1 σ i f ξ i 2 i 1 2 j 1 k i k j φ ξ i f ξ j φ z f z 0 8 n 2 η φ η 1 g 2 i 1 σ i φ ξ i f 0 and also the bottom condition 9 φ z 0 on z d where n 1 and n 2 are the nonlinear differential operators and 10 f 1 2 2 i 1 2 j 1 k i k j φ ξ i φ ξ j φ z 2 the wave elevation η and velocity potential φ can be expressed as 11 η ξ 1 ξ 2 i j c i j η cos i ξ 1 j ξ 2 12 φ ξ 1 ξ 2 z i j c i j φ ψ i j ξ 1 ξ 2 z with the definition 13 ψ i j ξ 1 ξ 2 z sin i ξ 1 j ξ 2 cosh i k 1 j k 2 z d cosh i k 1 j k 2 d where c m n η and c m n φ are constants to be determined c m n η denotes the amplitude of wave component cos m ξ 1 n ξ 2 2 2 resonance condition analysis for collinear steady state wave groups liu et al 2016 solved the nonlinear water wave equations by ham and obtained convergent high order series solutions in finite water depth as multiple near resonances among different components were ignored by liu et al 2016 small divisors associated with nearly resonant components have not been removed therefore convergent solutions have been obtained as dimensionless frequency ε increases only up to 1 010 based on the work of liao et al 2016 for a small divisor caused by a single near resonance liu et al 2018 proposed a new kind of auxiliary linear operator to transform the small divisors associated with the non trivial nearly resonant components to singularities associated with the exactly resonant ones liu et al 2017 applied the solution procedure proposed by liu et al 2018 to the nonlinear water wave equations in deep water and successfully obtained two dimensional finite amplitude steady state wave groups with multiple resonances compared with the work of liu et al 2016 nonlinearity of wave groups was further increased since small divisors associated with nearly resonant components were removed in this paper we consider collinear steady state wave groups with multiple resonances in finite water depth for a wave system with l resonant components k 0 1 k 0 2 k 0 l that generated by two primary components k 1 and k 2 the resonance condition reads 14 m ι k 1 n ι k 2 k 0 ι m ι ω 1 n ι ω 2 ω 0 ι d ω ι ι 1 2 l where ω 0 ι denotes the linear angular frequency of the ιth resonant component and d ω ι is a small real number represents the angular frequency mismatch wave number k 0 ι and angular frequency mismatch d ω ι of the ιth resonant component can be determined once the nonlinear angular frequencies σ i and dimensionless frequency ε of two primary components are given table 1 shows the 10 resonant components with the smallest angular frequency mismatch log 10 d ω ι in case of σ 1 1 98386 rad s σ 2 2 21802 rad s and ε 1 010 in water depth d 20 m and d 3 m for case liu et al 2016 considered in deep water d 20 m k 1 d 7 9 the resonance criteria 14 can only be satisfied by nearly resonant components since no component with d ω ι 0 can be found actually no component with d ω ι 0 can be found even when the water depth decreases to d 3 k 1 d 1 3 as shown in table 1 components with small angular frequency mismatch are called nearly resonant components in this paper as water depth decreases nearly resonant components change slightly and the role they played on the wave fields will be analyzed in section 3 1 and 3 3 2 3 solution procedure to obtain convergent solutions for finite amplitude steady state resonant wave groups in finite water depth the difficulties associated with the slow convergence rate of series solution obtained by ham and the additional unpredictable components appearing in the spectrum have to be resolved in this work we used a combined solution procedure based on ham and galerkin method solutions of steady state wave groups in deep water obtained by ham liu et al 2017 is used as initial guess to obtain convergent numerical results by galerkin method as the water depth decreases the main advantage of galerkin method is the generality allowed in the spectral representation of the surface ioualalen and kharif 1994 thus this combined solution procedure provides a robust and efficient way for steady state resonant wave groups with high steepness different set of parameters including the water depth d and dimensionless frequency ε are considered initial guess for another solution at a slightly different set of parameters comes from the previous solution provided the values of the two sets of parameters are close enough for sake of simplicity the galerkin method is briefly described here the truncated series for wave elevation η and velocity potential φ are expressed as 15 η ξ 1 ξ 2 n i 1 n j n c i j η cos i ξ 1 j ξ 2 n j 0 c 0 j η cos j ξ 2 16 φ ξ 1 ξ 2 z n i 1 n j n c i j φ ψ i j ξ 1 ξ 2 z n j 1 c 0 j φ ψ 0 j ξ 1 ξ 2 z with 4 n n 1 1 number of unknowns c i j η and c i j φ the same number of independent equations are needed to solve the unknowns substituting 15 and 16 into 7 and 8 simultaneously we obtain the independent relations 17 p r s 0 2 π 0 2 π n 1 φ ξ 1 ξ 2 η ξ 1 ξ 2 sin r ξ 1 s ξ d ξ 1 d ξ 2 0 18 q r s 0 2 π 0 2 π n 2 η ξ 1 ξ 2 φ ξ 1 ξ 2 η ξ 1 ξ 2 cos r ξ 1 s ξ d ξ 1 d ξ 2 0 which are evaluated with an m point fourier transform set m 2 n 1 to evaluate the integral 17 and 18 accurately therefore we can obtain n 2 n 2 independent relations from 17 for 1 r n n s n and 1 s n with r 0 and n 2 n 2 1 independent relations from 18 for 1 r n n s n and 0 s n with r 0 the total number of unknowns in η and φ equals the total number of independent equations c i j η and c i j φ are obtained by newton s method detailed expressions of the jacobian matrixes which are necessary for newton s method are shown in appendix a the iteration is stopped after the maximum difference between the unknowns before an iteration and that after the iteration is smaller than 10 7 table 2 shows the amplitude of component c 0 1 η and wave height h for various values of n and m in case of σ 1 1 98386 rad s σ 2 2 21802 rad s water depth d 3 m and dimensionless frequency ε 1 019 for different truncation number n the values of c 0 1 η and h keep almost unchanged after m 91 besides the values of c 0 1 η and h converge as n increases from 11 to 31 n 31 and m 91 are used for the steepest wave groups in this work so four significant figure for the unknowns can be obtained 2 4 flux conservation equations following whitham 1962 and liu et al 2016 we define the mean rates of mass momentum and energy fluxes for steady state wave groups as 19 f q w w 1 4 π 2 0 2 π 0 2 π d η ρ φ x d z d ξ 1 d ξ 2 20 f m w w 1 4 π 2 0 2 π 0 2 π d η p ρ φ x 2 d z d ξ 1 d ξ 2 21 f e w w 1 4 π 2 0 2 π 0 2 π d η p ρ 2 φ x 2 φ z 2 ρ g z φ x d z d ξ 1 d ξ 2 in the ξ 1 ξ 2 z coordinate system here ρ is the density of water p ρ φ t ρ 2 φ x 2 φ z 2 ρ g z is the total pressure φ x k 1 φ ξ 1 k 2 φ ξ 2 and φ t σ 1 φ ξ 1 σ 2 φ ξ 2 the upper limit of integrals 19 20 and 21 contains the surface elevation η that depends on the variables ξ 1 and ξ 2 so the integrals f q w w f m w w and f e w w are periodic in the ξ 1 ξ 2 space instead of calculating these integrals directly we discrete the integrals in the ξ 1 ξ 2 space as 22 δ f q w w i j d η i δ ξ j δ ξ ρ φ x i δ ξ j δ ξ d z 23 δ f m w w i j d η i δ ξ j δ ξ p i δ ξ j δ ξ ρ φ x 2 i δ ξ j δ ξ d z 24 δ f e w w i j d η i δ ξ j δ ξ ρ φ t i δ ξ j δ ξ φ x i δ ξ j δ ξ d z to save the cpu time here δ ξ 2 π m is the interval in the ξ 1 ξ 2 space m denotes the number of discrete points and i j 0 1 m 1 due to the periodicity the integrals 19 20 and 21 can be calculated by the discrete fourier transform 25 f q w w 1 m 2 m 1 i 0 m 1 j 0 δ f q w w i j 26 f m w w 1 m 2 i 0 m 1 j 0 m 1 δ f m w w i j 27 f e w w 1 m 2 m 1 i 0 m 1 j 0 δ f m w w i j compared with the bi chromatic waves considered by liu et al 2016 liu et al 2017 found that additional nearly resonant components appear in the spectrum when nonlinearity increases to analyze the role that additional nearly resonant components play on the wave field in different water depths we establish the relationship between the linear and nonlinear wave groups the linear combined waves is superimposed by two primary travelling waves with nonlinear wave wave interactions neglected in nonlinear wave groups the nonlinear wave wave interactions are considered and assumed to change the amplitude of each wave component but not the frequency in this way the frequencies of two primary components in both linear and nonlinear wave groups are equal and kept the same conservation equations of mean rates of mass momentum and energy fluxes for linear and nonlinear wave groups read 28 f q w 1 f q w 2 f q w w f m w 1 f m w 2 f m w w f e w 1 f e w 2 f e w w due to the complex nonlinear interactions among different wave components it s hard to obtain the exact solution of the conservations equation 28 for nonlinear steady state wave groups following liu et al 2016 we define the standard deviation 29 s d f q w 1 f q w 2 f q w w 1 2 f m w 1 f m w 2 f m w w 1 2 f e w 1 f e w 2 f e w w 1 2 3 to quantify the degree of deviation from the exact conservation state s d 0 of the mean rates of mass momentum and energy fluxes 3 results and analysis 3 1 collinear steady state wave groups in finite water depth taking the case liu et al 2016 considered σ 1 1 98386 rad s σ 2 2 21802 rad s ε 1 010 and d 20 m as example the water depth is decreased from d 20 m k 1 d 7 9 in deep water to d 2 80 m k 1 d 1 3 in finite water depth until the steady state resonant waves degenerate into monochromatic wave fig 1 shows the amplitude spectra of steady state wave groups in different water depths d it can be found that the amplitude spectra change continuously and the multiple resonances disappear as the water depth decreases for given dimensionless frequency ε 1 010 to further investigate the effect of water depth on the spectra of steady state wave groups we increase the nonlinearity and compare the amplitude spectra at different water depths fig 2 shows the amplitude spectra in water depths d 12 m k 1 d 4 6 and d 3 m k 1 d 1 3 with dimensionless frequency ε increased up to 1 019 for wave groups in both two water depths majority of the wave energy is contained by components near the primary ones as water depth decreases amplitude of two primary components increases the number of nontrivial components around the primary ones decreases meanwhile more nontrivial components appear in the low and high frequency domain such as components c 1 1 η and c 1 1 η that shown in fig 2b it should be noted that these nontrivial components are generated by the three wave resonant interactions with the primary ones not the four wave resonant interactions that plays a dominant role for wave groups in deep water appearance of additional low and high frequency components in finite water depth indicates that the spectra of steady state wave groups changes with the water depth dispersion relation changes as the water depth decreases from deep water to finite water depth and significance of the three wave nearly resonances in finite water depth is revealed tables 3 and 4 show the amplitude of components with c i j η 0 01 for nonlinear wave groups in water depth d 12 m and d 3 m components are listed with the corresponding nonlinear angular frequency increases from left to right in each table in both two water depths amplitudes of most nontrivial components increase and more components with c i j η 0 01 appear in the spectra as the dimensionless frequency ε increases frequencies of most additional nontrivial components are higher than that of the original nontrivial ones except the low frequency ones c 1 1 η and c 2 2 η and high frequency ones c 2 0 η and c 1 1 η that generated by three wave nearly resonant interactions in finite water depth d 3 m majority of wave energy is contained by components joining the four wave resonance meanwhile the shallower water depth changes the dispersion relation and the three wave nearly resonant interactions becomes increasingly important 3 2 flux conservation analysis relationship between the linear and nonlinear wave groups is established by the conservation equations of mean rates of mass momentum and energy fluxes 28 the linear wave groups is superimposed by two monochromatic waves with the nonlinear wave wave interactions neglected frequencies of two primary components in both linear and nonlinear wave groups are given and kept the same amplitudes of components in nonlinear wave groups are obtained by solving the equations 17 and 18 for a given dimensionless frequency ε then amplitude nonlinearity of two monochromatic waves in the linear wave groups are determined so that the smallest deviation from the exact conservation state s d 0 could be obtained mean rates of mass momentum and energy fluxes of nonlinear wave groups in water depth d 3 m as dimensionless frequency ε increases are shown in table 5 the wave numbers k i is determined so the actual angular frequencies σ i keeps unchanged for different ε for each nonlinear wave group in table 5 we search the dimensionless frequencies ε 1 and ε 2 of two monochromatic waves in the linear wave groups with increment δ ε 0 0001 to get the smallest deviation s d 29 on the mean rates of mass momentum and energy fluxes as shown in table 6 wave numbers of monochromatic waves k i in table 6 is determined so the actual angular frequencies σ i of two monochromatic waves keeps unchanged for different ε for all cases considered the standard deviation s d is found to be less than 0 01 small standard deviations s d means that the mean rates of mass momentum and energy fluxes between the linear and nonlinear wave groups are almost conserved fig 3 shows the amplitude spectra of both linear and nonlinear wave groups when the mean rates of mass momentum and energy fluxes are almost conserved in water depth d 3 m for nonlinear wave groups fig 3a more components appear in the spectra due to the three wave and four wave nearly resonant interactions therefore the frequency band broadens as the dimensionless frequency ε increases and more peaks appear in the spectra for linear wave groups fig 3b nonlinear wave wave interactions is neglected so no additional component appears in the spectra and wave energy is mainly contained by two primary components comparison of spectra between the linear and nonlinear wave groups in finite water depth shows that the nearly resonant interactions changes the spectra of steady state wave groups significantly the amplitude of primary components changes and more components appear in the spectra 3 3 wave field analysis to investigate how the nearly resonant interactions affect the wave fields in finite water depth surface elevations and velocity distributions are compared between the linear and nonlinear wave groups when the mean rates of mass momentum and energy fluxes are almost conserved fig 4 shows the surface elevations for both linear and nonlinear wave groups in finite water depth d 3 m for dimensionless frequency ε 1 010 and ε 1 012 the linear and nonlinear surface elevations coincide with each other the nearly resonant components are weak enough to be neglected as ε increases the discrepancy between the linear and nonlinear surface elevations appears and becomes more and more remarkable especially near the crests and troughs at ε 1 019 the nonlinear free surfaces have more peaked crests and steeper troughs than the linear ones table 7 shows the extreme values of surface elevations for both linear and nonlinear wave groups in finite water depth d 3 m for linear wave groups the crests η m a x and troughs η m i n change little after ε reaches 1 016 while for nonlinear wave groups the crests η m a x and the troughs η m i n increase all the way with ε at ε 1 019 the wave steepness h s k 1 η m a x η m i n 2 reaches 0 27 in nonlinear wave groups which is 1 4 times larger than the wave steepness in linear ones 0 19 nearly resonant interactions redistributes wave energy among more components and increases the steepness of steady state wave groups fig 5 shows the water particle horizontal velocities profiles under the crests and troughs for both linear and nonlinear wave groups in finite water depth d 3 m the velocity profiles coincide with each other for dimensionless frequency ε 1 010 and 1 012 as ε increases the magnitude of velocities under the crests and troughs in nonlinear wave groups increases more rapidly than that in linear wave groups horizontal velocities under the crests decay rapidly with the water depth and reach almost the same values at the bottom for linear and nonlinear wave groups horizontal velocities under the troughs decay relatively slowly and magnitude of velocities in nonlinear wave groups keeps larger than that in linear wave groups even at the bottom extreme values of water particle horizontal velocity for both linear and nonlinear wave groups in finite water depth d 3 m are shown in table 7 at ε 1 019 the velocity in nonlinear wave groups reaches 2 27 m s at the crest and 1 08 m s at the trough meanwhile in linear wave groups it reaches only 1 24 m s at the crest and 0 79 m s at the trough that is the nearly resonant interactions enlarge 1 8 times the velocity at the crest and 1 4 times the velocity at the trough nearly resonant interactions changes the velocity distribution of steady state wave groups when the mean rates of mass momentum and energy fluxes are almost conserved for linear and nonlinear wave groups 4 conclusion collinear steady state wave groups with multiple near resonances are obtained in finite water depth when the resonance conditions are nearly satisfied the role nearly resonant components play on the steady state wave groups in finite water depth is analyzed by comparing both the spectra of nonlinear steady state wave groups in different water depths and the wave fields of linear and nonlinear wave groups convergent solutions are obtained for collinear steady state wave groups with multiple near resonances as the water depth decreases from deep water to finite water depth comparison of the spectra of steady state wave groups in different water depths shows that the four wave nearly resonant interactions play a dominant role in steady state wave groups meanwhile the dispersion relation changes with the water depth and some low and high frequency components start to appear in finite water depth due to the three wave nearly resonant interactions the significance of three wave nearly resonance is revealed for steady state wave groups in finite water depth relationship between the linear and nonlinear wave groups in finite water depth is established when the mean rates of mass momentum and energy fluxes are almost conserved comparison between the linear and nonlinear wave groups shows that nearly resonant interactions affect the steady state wave groups significantly in finite water depth in nonlinear wave groups wave energy is redistributed as more components join the resonance and the amplitude of primary components changes too wave group steepness is increased as the nonlinear free surfaces have more peaked crests and steeper troughs besides magnitude of water particle horizontal velocities near the crests and troughs increases more rapidly with the nonlinearity in nonlinear wave groups this paper shows that the nearly resonant interactions among different wave components especially the three wave and four wave nearly resonant interactions should be considered for steady state wave groups as the water depth decreases from deep water to finite water depth the existence of steady state resonant waves as the water depth further decreases from finite water depth to shallow water will be considered in the future stability analysis of the nonlinear steady state resonant waves in different water depths is also an interesting topic and deserves further investigation steady state wave groups have been considered when resonance conditions are nearly satisfied by multiple components in this paper it is hard to observe such a balanced state in practice since no wave energy transfers among different components and wind input and dissipation in real oceanic conditions are neglected in this wave system nevertheless the steady state resonant waves could be considered as a special case of the general non steady state resonant wave groups taking the weakly nonlinear wave groups as example xu et al 2012 found that there usually exist time dependent periodic exchanges of wave energy around the time independent energy spectrum therefore the conclusion in this work for steady state resonant waves may be applicable to the non steady state wave groups acknowledgments we thank the reviewers for their valuable comments and suggestions this work was partly supported by the national natural science foundation of china approval no 51609090 research project of state key laboratory of ocean engineering in shanghai jiao tong university approval no 1806 and science research project of huazhong university of science and technology approval no 0118140077 and 2006140115 appendix a detailed expressions of the jacobian matrix here we show the detailed expressions of the jacobian matrix p r s c i j φ p r s c i j η q r s c i j φ and q r s c i j η a 1 p r s c i j φ 0 2 π 0 2 π n 1 φ c i j φ sin r ξ 1 s ξ 2 d ξ 1 d ξ 2 a 2 p r s c i j η 0 2 π 0 2 π n 1 φ z cos i ξ 1 j ξ 2 sin r ξ 1 s ξ 2 d ξ 1 d ξ 2 a 3 q r s c i j φ 0 2 π 0 2 π n 2 η φ c i j φ cos r ξ 1 s ξ 2 d ξ 1 d ξ 2 a 4 q r s c i j η 0 2 π 0 2 π n 2 η φ z cos i ξ 1 j ξ 2 cos r ξ 1 s ξ 2 d ξ 1 d ξ 2 formulas within the jacobian matrix can be expressed as a 5 n 1 φ c i j φ f i j s c φ sin i ξ 1 j ξ 2 cosh i k 1 j k 2 z d cosh i k 1 j k 2 z f i j s s φ sin i ξ 1 j ξ 2 sinh i k 1 j k 2 z d cosh i k 1 j k 2 z f i j c c φ cos i ξ 1 j ξ 2 sinh i k 1 j k 2 z d cosh i k 1 j k 2 z f i j c s φ cos i ξ 1 j ξ 2 cosh i k 1 j k 2 z d cosh i k 1 j k 2 z a 6 n 1 φ z t f 2 φ ξ 1 ξ 1 z t s 2 φ ξ 2 ξ 2 z 2 t f t s φ ξ 1 ξ 2 z 2 t f φ z φ ξ 1 z z 2 t s φ z φ ξ 2 z z φ z 2 φ z z z 2 t f φ ξ 1 ξ 1 t s φ ξ 1 ξ 2 φ z φ ξ 1 z t f z 2 t s φ ξ 2 ξ 2 t f φ ξ 1 ξ 2 φ z φ ξ 2 z t s z g 2 t f φ ξ 1 z 2 t s φ ξ 2 z 2 φ z φ z z φ z z a 7 n 2 η φ c i j φ i t f j t s cos i ξ 1 j ξ 2 cosh i k 1 j k 2 z d cosh i k 1 j k 2 z φ z i k 1 j k 2 sin i ξ 1 j ξ 2 sinh i k 1 j k 2 z d cosh i k 1 j k 2 z a 8 n 2 η φ z g t f φ ξ 1 z t s φ ξ 2 z φ z φ z z where a 9 f i j s c φ i k 1 j k 2 2 φ z 2 i t f j t s 2 a 10 f i j s s φ g 2 t f φ ξ 1 z 2 t s φ ξ 2 z 2 φ z φ z z i k 1 j k 2 a 11 f i j c c φ 2 i t f j t s φ z i k 1 j k 2 a 12 f i j c s φ 2 t f φ ξ 1 ξ 1 2 t s φ ξ 1 ξ 2 2 φ z φ ξ 1 z i k 1 2 j k 1 k 2 2 t s φ ξ 2 ξ 2 2 t f φ ξ 1 ξ 2 2 φ z φ ξ 2 z j k 2 2 i k 1 k 2 a 13 t f k 1 2 φ ξ 1 k 1 k 2 φ ξ 2 σ 1 a 14 t s k 2 2 φ ξ 2 k 1 k 2 φ ξ 1 σ 2 a 15 t f z k 1 2 φ ξ 1 z k 1 k 2 φ ξ 2 z a 16 t s z k 2 2 φ ξ 2 z k 1 k 2 φ ξ 1 z 
22819,in this paper the role nearly resonant components play in collinear steady state wave groups in finite water depth is investigated theoretically fully nonlinear water wave equations are solved when the resonance conditions are nearly satisfied convergent solutions are obtained for steady state wave groups with multiple near resonances spectra analysis shows that as water depth decreases from deep water to finite water depth the four wave nearly resonant interactions play a dominant role in nonlinear steady state wave groups meanwhile the dispersion relation changes with the water depth and some low and high frequency components appear in the spectrum due to the three wave nearly resonant interactions comparison between the linear and nonlinear wave groups are made in finite water depth when the mean rates of mass momentum and energy fluxes are almost conserved it is found that wave energy in nonlinear wave groups is redistributed as more components join the resonance when the nonlinearity increases besides both the wave group steepness and magnitude of water particle horizontal velocities near the crests and troughs in nonlinear wave groups increase more rapidly with the nonlinearity the significance of near resonances in finite water depth for collinear steady state wave groups is demonstrated keywords surface gravity waves near resonance steady state wave groups 1 introduction the accurate prediction of wave body interaction is one of the major scientific problems nowadays in ocean engineering characteristics of the sea wave fields change as the waves travel from deep water to shallower water depth so do the features of waves body interactions kristiansen and faltinsen 2017 considered higher harmonic wave loads on a vertical cylinder in finite water depth and found that the second and third order incident wave potentials which are zero in deep water give major contributions in finite water depths loukogeorgaki 2018 found that the water depth effects on the wave energy converters response and the wave farm s absorbed power are pronounced in case of irregular waves therefore to better predict the wave body interaction we need to deepen our understanding about the effects of water depth on the nonlinear wave evolution first for deterministic wave fields larsen 1978 found that soliton wave packets forces a long gravity wave when they move on waters of finite depth the long gravity wave affects the shape of the wave packet in factors that decay linearly with increasing depth shemer and kit 1998 conducted experiments on nonlinear wave groups in intermediate water depth it was confirmed that wave groups propagating over relatively shallow water undergo demodulation and their wave energy tends to spread more uniformly over the group in deeper water wave energy focusing leading to increase of the maximum wave height above its initial value is observed fernandez et al 2014 numerically studied the nonlinear wave dynamic in finite water depth by high order spectral method west et al 1987 dommermuth 1987 pan and yue 2014 2015 miao and liu 2015 qi et al 2018 when the plane wave is seeded with collinear perturbation fernandez et al 2014 found that modulational instability ceases quite suddenly at k 0 h 1 36 for oblique unstable perturbations modulational instability survives beyond this critical water depth and a significant amplification can be achieved for relative shallow water with k 0 h 1 36 for random wave fields hang and hudspeth 1985 numerically examined the behavior of the skewness kernel as a function of finite water depth and confirmed that the skewness measures are positive and increase as the water depth decreases laing 1986 developed the weakly nonlinear theory for a stationary and homogeneous field of random gravity waves in water of finite depth to the third order and considered the influence of directional distribution growth stage and water depth on the spectrum a second order solution for the wind generated waves was proposed by arena et al 2008 to consider the nonlinear structure of three dimensional random wave groups in intermediate water depth arena et al 2008 found that the nonlinearity increases as the water depth becomes smaller and by reducing the water depth second order effects become greater for short crested waves it is well known that third order nonlinearity produces a strong deviation from gaussian statistics in water of infinite depth provided the wave field is long crested narrow banded and sufficiently steep simulations conducted by toffoli et al 2009 shows the deviation from gaussian statistics of long crested deep water waves was gradually reduce besides the third order nonlinear dynamics of free waves produced a weak upshift of the spectral peak for k p h 1 36 instead of the downshift commonly observed in deep water dutykh 2014 found that statistical properties of quasi deterministic wave field may vary significantly when the water depth is decreased from deep to rather shallow waters actually not only the wave spectra but also the related wave profiles change with the water depth jang et al 2007 considered wave profile of wave wave interaction with a finite depth effect by fixed point approach components with higher order nonlinear frequencies for two interacting stokes waves were obtained by superposition of two linear potentials for uni directional transient wave groups ning et al 2009 found that the fully nonlinear wave wave interactions produce a steeper wave envelope in which the central wave crest is higher and narrower while the adjacent wave troughs are broader and less deep recently liu et al 2016 compared the free surface elevation of linear and nonlinear wave groups when the mass momentum and energy flux are conserved in deep water fully nonlinear water wave equations was solved by the homotopy analysis method ham liao 1992 2003 2012 zhong liao 2018 and nonlinear bi chromatic waves with the dimensionless frequency ε σ i ω i increased up to 1 010 were obtained liu et al 2017 found that amplitudes of two third order components liu et al 2016 obtained are extraordinarily larger than the amplitude of other non primary components and increase with the nonlinearity the extraordinarily large high order components suggests that resonant interactions among two primary components and other nontrivial ones may already happen in the bi chromatic waves resonances should be considered in the solution procedure of steady state wave groups as the nonlinearity further increases for certain combinations of frequencies and wave number vectors resonance may occur at third order singularities and small divisors that associated with the exactly and nearly resonant components are difficult to be removed by the perturbation theory as it breaks down due to singularities in the transfer functions madsen and fuhrman 2012 by applying ham to the fully nonlinear water wave equations liao 2011 resolved the singularity caused by single exact resonance and obtained a steady state quartet in deep water xu et al 2012 extended the work of liao 2011 from infinite water depth to finite water depth and liu and liao 2014 considered multiple resonant interactions in quartets and sextets the existence of such kind of steady state resonant waves was investigated experimentally in a basin at the state key laboratory of ocean engineering in shanghai liu et al 2015 for near resonances liao et al 2016 proposed a solution procedure in ham to resolve small divisor associated with single nearly resonant component liu et al 2018 further developed the solution procedure to resolve the small divisors associated with nearly resonant components and finite amplitude steady state wave groups with multiple near resonances were obtained in deep water the steady state resonant wave groups provide a new approach from the view points of boundary value problem to consider the resonant interactions in nonlinear wave groups here steady state resonant waves means all wave amplitudes a i wavenumbers k i and actual frequencies σ i in a wave spectrum are constant and no wave energy is exchanged among different wave components the steady state resonance corresponds to a special thermodynamic equilibrium spectrum zakharov et al 1992 for weakly nonlinear steady state resonant waves in finite water depth xu et al 2012 compared the results obtained from both ham and the zakharov s equation zakharov 1968 zakharov kharitonov 1970 lavrova 1983 and found that qualitatively identical conclusions can be obtained by using the zakharov s equation based on the solution procedure proposed by liu et al 2018 for steady state wave groups with multiple resonances liu et al 2017 obtained convergent series solutions for steady state wave groups in deep water with dimensionless frequency ε increased up to 1 018 it is found that as nonlinearity increases more wave components appear in the spectrum due to the nearly resonant interactions the nonlinear wave fields change from the initial bi chromatic waves that contain only two nontrivial primary components into the steady state resonant waves that contain both two primary components and other nearly resonant ones it should be noted that liu et al 2016 compared the elevation of linear and nonlinear wave groups in deep water while the effect of water depth on the elevation has not been considered besides the nonlinearity of bi chromatic waves liu et al 2016 considered is not high enough since multiple resonances were ignored liu et al 2017 obtained convergent solutions for steady state waves groups with multiple resonances and compared the spectrum and elevations of linear and nonlinear wave groups in deep water the effect of water depth on the nonlinear steady state wave groups needs further investigation the present paper generalizes the work of liu et al 2017 from deep water to finite water depth it should be noted that the extension from deep water to finite water depth is theoretically straightforward but practically difficult in deep water finite amplitude steady state resonant wave groups can be obtained as the small divisors caused by near resonances could be removed in the framework of ham by choosing a new auxiliary linear operator liu et al 2018 as the water depth decreases the convergence rate of series solution obtained by ham decreases and additional unpredictable components appear in the spectrum due to the three wave resonances it is hard to obtain convergent solutions for finite amplitude steady state resonant wave groups by ham in finite water depth in this paper we use the ham solutions in deep water as initial guesses and use the galerkin method okamura 2003 2010 to obtained convergent solutions as the water depth decreases the main advantage of galerkin method is the generality allowed in the spectral representation of the free surface ioualalen and kharif 1994 the combined solution procedure based on ham and galerkin method provides a robust and efficient way to obtain finite amplitude steady state resonant wave groups in finite water depth the main purpose of this paper is to investigate the role nearly resonant components play in collinear steady state wave groups in finite water depth steady state wave groups with multiple resonances are obtained in different water depths and the wave spectra are analyzed then in finite water depth linear and nonlinear steady state wave groups are compared when the mean rate of mass momentum and energy fluxes are conserved here it is assumed that the linear wave groups is combined by two primary travelling waves with nonlinear wave wave interactions neglected in nonlinear wave groups the nonlinear wave wave interactions are considered and assumed to change the amplitude of each component but not the frequency frequency of two primary components in linear wave groups equals to that in the nonlinear wave groups and keeps unchanged when water depth or nonlinearity changes the paper is organized as follows the governing equation is described in section 2 1 resonance conditions are analyzed in section 2 2 and solution procedure is described in section 2 3 conservation equations between the linear and nonlinear wave groups are introduced in section 2 4 nonlinear steady state wave groups is analyzed in section 3 1 conservation analysis and wave field comparisons are shown in section 3 2 and 3 3 detailed expressions of the jacobian matrix is given in appendix a 2 mathematical description 2 1 governing equation assume the fluid motion is irrotational a velocity potential φ x z t can be defined where z is measured vertically upwards and t indicates time for inviscid and incompressible fluid without surface tension the governing equations for two dimensional wave field read 1 2 φ 0 d z η x t 2 2 φ t 2 g φ z φ 2 t φ 1 2 φ 2 0 on z η x t 3 g η φ t 1 2 φ 2 0 on z η x t 4 φ z 0 on z d where η denotes the free surface elevation g is the gravity acceleration and d is the water depth consider a steady state wave group that consists of two primary progressive waves with the phase functions 5 ξ i k i x σ i t i 1 2 in the new coordinate system ξ 1 ξ 2 z the original initial boundary value problem 1 4 can be transformed into a boundary value problem governed by 6 2 i 1 2 j 1 k i k j 2 φ ξ i ξ j 2 φ z 2 0 d z η ξ 1 ξ 2 subject to the two boundary conditions on the unknown free surface z η ξ 1 ξ 2 7 n 1 φ 2 i 1 2 j 1 σ i σ j 2 φ ξ i ξ j g φ z 2 2 i 1 σ i f ξ i 2 i 1 2 j 1 k i k j φ ξ i f ξ j φ z f z 0 8 n 2 η φ η 1 g 2 i 1 σ i φ ξ i f 0 and also the bottom condition 9 φ z 0 on z d where n 1 and n 2 are the nonlinear differential operators and 10 f 1 2 2 i 1 2 j 1 k i k j φ ξ i φ ξ j φ z 2 the wave elevation η and velocity potential φ can be expressed as 11 η ξ 1 ξ 2 i j c i j η cos i ξ 1 j ξ 2 12 φ ξ 1 ξ 2 z i j c i j φ ψ i j ξ 1 ξ 2 z with the definition 13 ψ i j ξ 1 ξ 2 z sin i ξ 1 j ξ 2 cosh i k 1 j k 2 z d cosh i k 1 j k 2 d where c m n η and c m n φ are constants to be determined c m n η denotes the amplitude of wave component cos m ξ 1 n ξ 2 2 2 resonance condition analysis for collinear steady state wave groups liu et al 2016 solved the nonlinear water wave equations by ham and obtained convergent high order series solutions in finite water depth as multiple near resonances among different components were ignored by liu et al 2016 small divisors associated with nearly resonant components have not been removed therefore convergent solutions have been obtained as dimensionless frequency ε increases only up to 1 010 based on the work of liao et al 2016 for a small divisor caused by a single near resonance liu et al 2018 proposed a new kind of auxiliary linear operator to transform the small divisors associated with the non trivial nearly resonant components to singularities associated with the exactly resonant ones liu et al 2017 applied the solution procedure proposed by liu et al 2018 to the nonlinear water wave equations in deep water and successfully obtained two dimensional finite amplitude steady state wave groups with multiple resonances compared with the work of liu et al 2016 nonlinearity of wave groups was further increased since small divisors associated with nearly resonant components were removed in this paper we consider collinear steady state wave groups with multiple resonances in finite water depth for a wave system with l resonant components k 0 1 k 0 2 k 0 l that generated by two primary components k 1 and k 2 the resonance condition reads 14 m ι k 1 n ι k 2 k 0 ι m ι ω 1 n ι ω 2 ω 0 ι d ω ι ι 1 2 l where ω 0 ι denotes the linear angular frequency of the ιth resonant component and d ω ι is a small real number represents the angular frequency mismatch wave number k 0 ι and angular frequency mismatch d ω ι of the ιth resonant component can be determined once the nonlinear angular frequencies σ i and dimensionless frequency ε of two primary components are given table 1 shows the 10 resonant components with the smallest angular frequency mismatch log 10 d ω ι in case of σ 1 1 98386 rad s σ 2 2 21802 rad s and ε 1 010 in water depth d 20 m and d 3 m for case liu et al 2016 considered in deep water d 20 m k 1 d 7 9 the resonance criteria 14 can only be satisfied by nearly resonant components since no component with d ω ι 0 can be found actually no component with d ω ι 0 can be found even when the water depth decreases to d 3 k 1 d 1 3 as shown in table 1 components with small angular frequency mismatch are called nearly resonant components in this paper as water depth decreases nearly resonant components change slightly and the role they played on the wave fields will be analyzed in section 3 1 and 3 3 2 3 solution procedure to obtain convergent solutions for finite amplitude steady state resonant wave groups in finite water depth the difficulties associated with the slow convergence rate of series solution obtained by ham and the additional unpredictable components appearing in the spectrum have to be resolved in this work we used a combined solution procedure based on ham and galerkin method solutions of steady state wave groups in deep water obtained by ham liu et al 2017 is used as initial guess to obtain convergent numerical results by galerkin method as the water depth decreases the main advantage of galerkin method is the generality allowed in the spectral representation of the surface ioualalen and kharif 1994 thus this combined solution procedure provides a robust and efficient way for steady state resonant wave groups with high steepness different set of parameters including the water depth d and dimensionless frequency ε are considered initial guess for another solution at a slightly different set of parameters comes from the previous solution provided the values of the two sets of parameters are close enough for sake of simplicity the galerkin method is briefly described here the truncated series for wave elevation η and velocity potential φ are expressed as 15 η ξ 1 ξ 2 n i 1 n j n c i j η cos i ξ 1 j ξ 2 n j 0 c 0 j η cos j ξ 2 16 φ ξ 1 ξ 2 z n i 1 n j n c i j φ ψ i j ξ 1 ξ 2 z n j 1 c 0 j φ ψ 0 j ξ 1 ξ 2 z with 4 n n 1 1 number of unknowns c i j η and c i j φ the same number of independent equations are needed to solve the unknowns substituting 15 and 16 into 7 and 8 simultaneously we obtain the independent relations 17 p r s 0 2 π 0 2 π n 1 φ ξ 1 ξ 2 η ξ 1 ξ 2 sin r ξ 1 s ξ d ξ 1 d ξ 2 0 18 q r s 0 2 π 0 2 π n 2 η ξ 1 ξ 2 φ ξ 1 ξ 2 η ξ 1 ξ 2 cos r ξ 1 s ξ d ξ 1 d ξ 2 0 which are evaluated with an m point fourier transform set m 2 n 1 to evaluate the integral 17 and 18 accurately therefore we can obtain n 2 n 2 independent relations from 17 for 1 r n n s n and 1 s n with r 0 and n 2 n 2 1 independent relations from 18 for 1 r n n s n and 0 s n with r 0 the total number of unknowns in η and φ equals the total number of independent equations c i j η and c i j φ are obtained by newton s method detailed expressions of the jacobian matrixes which are necessary for newton s method are shown in appendix a the iteration is stopped after the maximum difference between the unknowns before an iteration and that after the iteration is smaller than 10 7 table 2 shows the amplitude of component c 0 1 η and wave height h for various values of n and m in case of σ 1 1 98386 rad s σ 2 2 21802 rad s water depth d 3 m and dimensionless frequency ε 1 019 for different truncation number n the values of c 0 1 η and h keep almost unchanged after m 91 besides the values of c 0 1 η and h converge as n increases from 11 to 31 n 31 and m 91 are used for the steepest wave groups in this work so four significant figure for the unknowns can be obtained 2 4 flux conservation equations following whitham 1962 and liu et al 2016 we define the mean rates of mass momentum and energy fluxes for steady state wave groups as 19 f q w w 1 4 π 2 0 2 π 0 2 π d η ρ φ x d z d ξ 1 d ξ 2 20 f m w w 1 4 π 2 0 2 π 0 2 π d η p ρ φ x 2 d z d ξ 1 d ξ 2 21 f e w w 1 4 π 2 0 2 π 0 2 π d η p ρ 2 φ x 2 φ z 2 ρ g z φ x d z d ξ 1 d ξ 2 in the ξ 1 ξ 2 z coordinate system here ρ is the density of water p ρ φ t ρ 2 φ x 2 φ z 2 ρ g z is the total pressure φ x k 1 φ ξ 1 k 2 φ ξ 2 and φ t σ 1 φ ξ 1 σ 2 φ ξ 2 the upper limit of integrals 19 20 and 21 contains the surface elevation η that depends on the variables ξ 1 and ξ 2 so the integrals f q w w f m w w and f e w w are periodic in the ξ 1 ξ 2 space instead of calculating these integrals directly we discrete the integrals in the ξ 1 ξ 2 space as 22 δ f q w w i j d η i δ ξ j δ ξ ρ φ x i δ ξ j δ ξ d z 23 δ f m w w i j d η i δ ξ j δ ξ p i δ ξ j δ ξ ρ φ x 2 i δ ξ j δ ξ d z 24 δ f e w w i j d η i δ ξ j δ ξ ρ φ t i δ ξ j δ ξ φ x i δ ξ j δ ξ d z to save the cpu time here δ ξ 2 π m is the interval in the ξ 1 ξ 2 space m denotes the number of discrete points and i j 0 1 m 1 due to the periodicity the integrals 19 20 and 21 can be calculated by the discrete fourier transform 25 f q w w 1 m 2 m 1 i 0 m 1 j 0 δ f q w w i j 26 f m w w 1 m 2 i 0 m 1 j 0 m 1 δ f m w w i j 27 f e w w 1 m 2 m 1 i 0 m 1 j 0 δ f m w w i j compared with the bi chromatic waves considered by liu et al 2016 liu et al 2017 found that additional nearly resonant components appear in the spectrum when nonlinearity increases to analyze the role that additional nearly resonant components play on the wave field in different water depths we establish the relationship between the linear and nonlinear wave groups the linear combined waves is superimposed by two primary travelling waves with nonlinear wave wave interactions neglected in nonlinear wave groups the nonlinear wave wave interactions are considered and assumed to change the amplitude of each wave component but not the frequency in this way the frequencies of two primary components in both linear and nonlinear wave groups are equal and kept the same conservation equations of mean rates of mass momentum and energy fluxes for linear and nonlinear wave groups read 28 f q w 1 f q w 2 f q w w f m w 1 f m w 2 f m w w f e w 1 f e w 2 f e w w due to the complex nonlinear interactions among different wave components it s hard to obtain the exact solution of the conservations equation 28 for nonlinear steady state wave groups following liu et al 2016 we define the standard deviation 29 s d f q w 1 f q w 2 f q w w 1 2 f m w 1 f m w 2 f m w w 1 2 f e w 1 f e w 2 f e w w 1 2 3 to quantify the degree of deviation from the exact conservation state s d 0 of the mean rates of mass momentum and energy fluxes 3 results and analysis 3 1 collinear steady state wave groups in finite water depth taking the case liu et al 2016 considered σ 1 1 98386 rad s σ 2 2 21802 rad s ε 1 010 and d 20 m as example the water depth is decreased from d 20 m k 1 d 7 9 in deep water to d 2 80 m k 1 d 1 3 in finite water depth until the steady state resonant waves degenerate into monochromatic wave fig 1 shows the amplitude spectra of steady state wave groups in different water depths d it can be found that the amplitude spectra change continuously and the multiple resonances disappear as the water depth decreases for given dimensionless frequency ε 1 010 to further investigate the effect of water depth on the spectra of steady state wave groups we increase the nonlinearity and compare the amplitude spectra at different water depths fig 2 shows the amplitude spectra in water depths d 12 m k 1 d 4 6 and d 3 m k 1 d 1 3 with dimensionless frequency ε increased up to 1 019 for wave groups in both two water depths majority of the wave energy is contained by components near the primary ones as water depth decreases amplitude of two primary components increases the number of nontrivial components around the primary ones decreases meanwhile more nontrivial components appear in the low and high frequency domain such as components c 1 1 η and c 1 1 η that shown in fig 2b it should be noted that these nontrivial components are generated by the three wave resonant interactions with the primary ones not the four wave resonant interactions that plays a dominant role for wave groups in deep water appearance of additional low and high frequency components in finite water depth indicates that the spectra of steady state wave groups changes with the water depth dispersion relation changes as the water depth decreases from deep water to finite water depth and significance of the three wave nearly resonances in finite water depth is revealed tables 3 and 4 show the amplitude of components with c i j η 0 01 for nonlinear wave groups in water depth d 12 m and d 3 m components are listed with the corresponding nonlinear angular frequency increases from left to right in each table in both two water depths amplitudes of most nontrivial components increase and more components with c i j η 0 01 appear in the spectra as the dimensionless frequency ε increases frequencies of most additional nontrivial components are higher than that of the original nontrivial ones except the low frequency ones c 1 1 η and c 2 2 η and high frequency ones c 2 0 η and c 1 1 η that generated by three wave nearly resonant interactions in finite water depth d 3 m majority of wave energy is contained by components joining the four wave resonance meanwhile the shallower water depth changes the dispersion relation and the three wave nearly resonant interactions becomes increasingly important 3 2 flux conservation analysis relationship between the linear and nonlinear wave groups is established by the conservation equations of mean rates of mass momentum and energy fluxes 28 the linear wave groups is superimposed by two monochromatic waves with the nonlinear wave wave interactions neglected frequencies of two primary components in both linear and nonlinear wave groups are given and kept the same amplitudes of components in nonlinear wave groups are obtained by solving the equations 17 and 18 for a given dimensionless frequency ε then amplitude nonlinearity of two monochromatic waves in the linear wave groups are determined so that the smallest deviation from the exact conservation state s d 0 could be obtained mean rates of mass momentum and energy fluxes of nonlinear wave groups in water depth d 3 m as dimensionless frequency ε increases are shown in table 5 the wave numbers k i is determined so the actual angular frequencies σ i keeps unchanged for different ε for each nonlinear wave group in table 5 we search the dimensionless frequencies ε 1 and ε 2 of two monochromatic waves in the linear wave groups with increment δ ε 0 0001 to get the smallest deviation s d 29 on the mean rates of mass momentum and energy fluxes as shown in table 6 wave numbers of monochromatic waves k i in table 6 is determined so the actual angular frequencies σ i of two monochromatic waves keeps unchanged for different ε for all cases considered the standard deviation s d is found to be less than 0 01 small standard deviations s d means that the mean rates of mass momentum and energy fluxes between the linear and nonlinear wave groups are almost conserved fig 3 shows the amplitude spectra of both linear and nonlinear wave groups when the mean rates of mass momentum and energy fluxes are almost conserved in water depth d 3 m for nonlinear wave groups fig 3a more components appear in the spectra due to the three wave and four wave nearly resonant interactions therefore the frequency band broadens as the dimensionless frequency ε increases and more peaks appear in the spectra for linear wave groups fig 3b nonlinear wave wave interactions is neglected so no additional component appears in the spectra and wave energy is mainly contained by two primary components comparison of spectra between the linear and nonlinear wave groups in finite water depth shows that the nearly resonant interactions changes the spectra of steady state wave groups significantly the amplitude of primary components changes and more components appear in the spectra 3 3 wave field analysis to investigate how the nearly resonant interactions affect the wave fields in finite water depth surface elevations and velocity distributions are compared between the linear and nonlinear wave groups when the mean rates of mass momentum and energy fluxes are almost conserved fig 4 shows the surface elevations for both linear and nonlinear wave groups in finite water depth d 3 m for dimensionless frequency ε 1 010 and ε 1 012 the linear and nonlinear surface elevations coincide with each other the nearly resonant components are weak enough to be neglected as ε increases the discrepancy between the linear and nonlinear surface elevations appears and becomes more and more remarkable especially near the crests and troughs at ε 1 019 the nonlinear free surfaces have more peaked crests and steeper troughs than the linear ones table 7 shows the extreme values of surface elevations for both linear and nonlinear wave groups in finite water depth d 3 m for linear wave groups the crests η m a x and troughs η m i n change little after ε reaches 1 016 while for nonlinear wave groups the crests η m a x and the troughs η m i n increase all the way with ε at ε 1 019 the wave steepness h s k 1 η m a x η m i n 2 reaches 0 27 in nonlinear wave groups which is 1 4 times larger than the wave steepness in linear ones 0 19 nearly resonant interactions redistributes wave energy among more components and increases the steepness of steady state wave groups fig 5 shows the water particle horizontal velocities profiles under the crests and troughs for both linear and nonlinear wave groups in finite water depth d 3 m the velocity profiles coincide with each other for dimensionless frequency ε 1 010 and 1 012 as ε increases the magnitude of velocities under the crests and troughs in nonlinear wave groups increases more rapidly than that in linear wave groups horizontal velocities under the crests decay rapidly with the water depth and reach almost the same values at the bottom for linear and nonlinear wave groups horizontal velocities under the troughs decay relatively slowly and magnitude of velocities in nonlinear wave groups keeps larger than that in linear wave groups even at the bottom extreme values of water particle horizontal velocity for both linear and nonlinear wave groups in finite water depth d 3 m are shown in table 7 at ε 1 019 the velocity in nonlinear wave groups reaches 2 27 m s at the crest and 1 08 m s at the trough meanwhile in linear wave groups it reaches only 1 24 m s at the crest and 0 79 m s at the trough that is the nearly resonant interactions enlarge 1 8 times the velocity at the crest and 1 4 times the velocity at the trough nearly resonant interactions changes the velocity distribution of steady state wave groups when the mean rates of mass momentum and energy fluxes are almost conserved for linear and nonlinear wave groups 4 conclusion collinear steady state wave groups with multiple near resonances are obtained in finite water depth when the resonance conditions are nearly satisfied the role nearly resonant components play on the steady state wave groups in finite water depth is analyzed by comparing both the spectra of nonlinear steady state wave groups in different water depths and the wave fields of linear and nonlinear wave groups convergent solutions are obtained for collinear steady state wave groups with multiple near resonances as the water depth decreases from deep water to finite water depth comparison of the spectra of steady state wave groups in different water depths shows that the four wave nearly resonant interactions play a dominant role in steady state wave groups meanwhile the dispersion relation changes with the water depth and some low and high frequency components start to appear in finite water depth due to the three wave nearly resonant interactions the significance of three wave nearly resonance is revealed for steady state wave groups in finite water depth relationship between the linear and nonlinear wave groups in finite water depth is established when the mean rates of mass momentum and energy fluxes are almost conserved comparison between the linear and nonlinear wave groups shows that nearly resonant interactions affect the steady state wave groups significantly in finite water depth in nonlinear wave groups wave energy is redistributed as more components join the resonance and the amplitude of primary components changes too wave group steepness is increased as the nonlinear free surfaces have more peaked crests and steeper troughs besides magnitude of water particle horizontal velocities near the crests and troughs increases more rapidly with the nonlinearity in nonlinear wave groups this paper shows that the nearly resonant interactions among different wave components especially the three wave and four wave nearly resonant interactions should be considered for steady state wave groups as the water depth decreases from deep water to finite water depth the existence of steady state resonant waves as the water depth further decreases from finite water depth to shallow water will be considered in the future stability analysis of the nonlinear steady state resonant waves in different water depths is also an interesting topic and deserves further investigation steady state wave groups have been considered when resonance conditions are nearly satisfied by multiple components in this paper it is hard to observe such a balanced state in practice since no wave energy transfers among different components and wind input and dissipation in real oceanic conditions are neglected in this wave system nevertheless the steady state resonant waves could be considered as a special case of the general non steady state resonant wave groups taking the weakly nonlinear wave groups as example xu et al 2012 found that there usually exist time dependent periodic exchanges of wave energy around the time independent energy spectrum therefore the conclusion in this work for steady state resonant waves may be applicable to the non steady state wave groups acknowledgments we thank the reviewers for their valuable comments and suggestions this work was partly supported by the national natural science foundation of china approval no 51609090 research project of state key laboratory of ocean engineering in shanghai jiao tong university approval no 1806 and science research project of huazhong university of science and technology approval no 0118140077 and 2006140115 appendix a detailed expressions of the jacobian matrix here we show the detailed expressions of the jacobian matrix p r s c i j φ p r s c i j η q r s c i j φ and q r s c i j η a 1 p r s c i j φ 0 2 π 0 2 π n 1 φ c i j φ sin r ξ 1 s ξ 2 d ξ 1 d ξ 2 a 2 p r s c i j η 0 2 π 0 2 π n 1 φ z cos i ξ 1 j ξ 2 sin r ξ 1 s ξ 2 d ξ 1 d ξ 2 a 3 q r s c i j φ 0 2 π 0 2 π n 2 η φ c i j φ cos r ξ 1 s ξ 2 d ξ 1 d ξ 2 a 4 q r s c i j η 0 2 π 0 2 π n 2 η φ z cos i ξ 1 j ξ 2 cos r ξ 1 s ξ 2 d ξ 1 d ξ 2 formulas within the jacobian matrix can be expressed as a 5 n 1 φ c i j φ f i j s c φ sin i ξ 1 j ξ 2 cosh i k 1 j k 2 z d cosh i k 1 j k 2 z f i j s s φ sin i ξ 1 j ξ 2 sinh i k 1 j k 2 z d cosh i k 1 j k 2 z f i j c c φ cos i ξ 1 j ξ 2 sinh i k 1 j k 2 z d cosh i k 1 j k 2 z f i j c s φ cos i ξ 1 j ξ 2 cosh i k 1 j k 2 z d cosh i k 1 j k 2 z a 6 n 1 φ z t f 2 φ ξ 1 ξ 1 z t s 2 φ ξ 2 ξ 2 z 2 t f t s φ ξ 1 ξ 2 z 2 t f φ z φ ξ 1 z z 2 t s φ z φ ξ 2 z z φ z 2 φ z z z 2 t f φ ξ 1 ξ 1 t s φ ξ 1 ξ 2 φ z φ ξ 1 z t f z 2 t s φ ξ 2 ξ 2 t f φ ξ 1 ξ 2 φ z φ ξ 2 z t s z g 2 t f φ ξ 1 z 2 t s φ ξ 2 z 2 φ z φ z z φ z z a 7 n 2 η φ c i j φ i t f j t s cos i ξ 1 j ξ 2 cosh i k 1 j k 2 z d cosh i k 1 j k 2 z φ z i k 1 j k 2 sin i ξ 1 j ξ 2 sinh i k 1 j k 2 z d cosh i k 1 j k 2 z a 8 n 2 η φ z g t f φ ξ 1 z t s φ ξ 2 z φ z φ z z where a 9 f i j s c φ i k 1 j k 2 2 φ z 2 i t f j t s 2 a 10 f i j s s φ g 2 t f φ ξ 1 z 2 t s φ ξ 2 z 2 φ z φ z z i k 1 j k 2 a 11 f i j c c φ 2 i t f j t s φ z i k 1 j k 2 a 12 f i j c s φ 2 t f φ ξ 1 ξ 1 2 t s φ ξ 1 ξ 2 2 φ z φ ξ 1 z i k 1 2 j k 1 k 2 2 t s φ ξ 2 ξ 2 2 t f φ ξ 1 ξ 2 2 φ z φ ξ 2 z j k 2 2 i k 1 k 2 a 13 t f k 1 2 φ ξ 1 k 1 k 2 φ ξ 2 σ 1 a 14 t s k 2 2 φ ξ 2 k 1 k 2 φ ξ 1 σ 2 a 15 t f z k 1 2 φ ξ 1 z k 1 k 2 φ ξ 2 z a 16 t s z k 2 2 φ ξ 2 z k 1 k 2 φ ξ 1 z 
