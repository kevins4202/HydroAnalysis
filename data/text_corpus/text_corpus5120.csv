index,text
25600,wetlands strongly interact with groundwater and surface water influencing catchment hydrology and altering water quality meanwhile catchment scale models are typically unable to simulate groundwater wetland interactions despite the fact that quantifying groundwater wetland interactions can assist in better identifying locations for wetlands restoration creation we modified an integrated groundwater surface water model swat modflow rt3d to simulate water and nutrient exchange at the wetland interface several modifications were applied to the swat wetland module and a spatial linkage was established between the module and the modflow drain package to provide bidirectional water and nutrient exchange between groundwater and wetlands we applied the modified model smr w to a tropical catchment in northeast australia and quantified water and nitrate exchange between wetland groundwater and surface water for 28 potential locations this study demonstrates that when groundwater heads are perched above wetlands bed significant nitrate discharge from aquifers to wetlands occurs which should be considered during wetland restoration planning graphical abstract image 1 keywords wetland swat modflow rt3d groundwater nitrate great barrier reef smr w 1 introduction agricultural non point source pollution particularly nitrate no3 significantly degrades water quality resulting in various toxicological consequences for humans camargo and alonso 2006 herrero et al 2001 and harmful ecological impacts on aquatic ecosystems brodie et al 2011 fabricius et al 2010 rabalais et al 2002 to mitigate no3 transport to surface water sw and leaching to groundwater gw various nutrient management strategies have been investigated and applied to agricultural lands around the world cassman and dobermann 2022 among these practices the creation and restoration of wetlands have received particular attention hansen et al 2018 messer et al 2021 for instance in the united states to improve the deteriorated water quality of the everglades the state of florida launched a usd 11 billion restoration plan including usd 1 75 billion for purchasing sugarcane lands for conversion to wetlands richardson 2010 stokstad 2008 despite numerous reported benefits wetlands are not always the ideal solution for no3 reduction vymazal 2017 wetlands can intercept agricultural runoff and filter out no3 through biochemical processes primarily via denitrification up to 80 of removal and marginally via immobilization and plant uptake matheson and sukias 2010 vymazal et al 2020 however the effectiveness of wetlands in removing pollution depends on various factors lee et al 2009 a large body of research has investigated the major hydrological and environmental factors impacting the effectiveness of wetlands no3 removal land et al 2016 mander et al 2017 however while most research has focused on wetlands in field scale studies much remains unknown about the potential magnitude of wetland no3 removal for large scale implementation cheng et al 2020 wetland restoration creation planning at a large scale needs to deal with the heterogeneity of hydrogeochemical processes within catchment systems therefore in situ monitoring of individual wetlands may not provide a comprehensive picture necessary for successful large scale implementation under these circumstances hydrological models would be applied to quantify and evaluate wetlands effectiveness toward this end a few models can assess the hydrological processes and water quality in wetlands with different degrees of complexity and realism at the catchment scale including swat neitsch et al 2011 mike she abbott et al 1986 and modflow harbaugh 2005 here we are focused on the applications of wetlands in swat and modflow models as they have been widely used and their source codes are publicly available for modification and validation when dealing with overland flows in agricultural dominated catchments swat has been increasingly used to investigate wetlands impact on water quality and hydrological processes for instance swat was used to assess the potential role of wetlands in altering streamflow under various hydrodynamic conditions martinez martinez et al 2014 swat was also applied to understand the relationship between wetlands losses and increased soil erosion martinez martinez et al 2015 the model was further employed to explore the impact of geographically isolated wetlands on catchment hydrology yeo et al 2019 and to assess the impact of climate drivers on wetlands lee et al 2020 however the swat model has several structural flaws in simulating hydrology and water quality in wetlands specifically the model cannot simulate water and nutrient exchange between gw and wetlands neitsch et al 2011 previous studies have restructured swat internal mechanisms to incorporate some aspects of gw wetland interactions rahman et al 2016 hoang et al 2017 qi et al 2019 yeo et al 2019 nevertheless the modified models were limited to simulating water exchange between gw and wetlands within isolated homogenous units rahman et al 2016 or the interactions were only conceptualized based on the wetlands percolation and gw evaporation hoang et al 2017 furthermore among all the previous attempts none addressed the exchange of nutrient loads between gw and wetlands indeed a recurring obstacle was the absence of a comprehensive gw module capable of simulating gw flow systems that interact with wetlands modflow on the other hand was applied to evaluate gw wetland interactions however the modflow applications only addressed the hydrological processes between gw and wetlands in recent years swat and modflow have been integrated to provide the ability to simulate gw sw interactions at land and river interfaces bailey et al 2016 further on the integrated swat modflow has been incorporated with the rt3d model for simulating the fate and transport of nutrients in gw sw wei et al 2019 as of now the swat modflow rt3d model hereafter called smr can simulate water and nutrient exchange between gw and sw at the land and river interfaces in great detail wei and bailey 2021 rafiei et al 2022 however the smr model cannot simulate and quantify the interaction of gw and sw at the wetland interface or other water impoundments including flow and no3 exchange between these two systems this shortcoming in modeling as we will discuss in section 2 1 has been a subject of the previous studies in recent years and the necessity for further improvement can be supported by multiple lines of evidence indicating wetlands strong interaction with gw aquifers jolly et al 2008 van der kamp and hayashi 2009 based on the above discussion and the limitations of current modeling tools we aim to improve the simulation of sw gw and wetland interactions for catchment scale wetland implementation strategies the key novelty of this work is the adoption of a fully distributed physically based gw model in simulating water and no3 exchange between gw and wetland where these interactions are embedded in the local intermediate and regional gw flow systems in a heterogeneous environment this research is also novel as the new platform smr w provides the ability to comprehensively evaluate no3 fate and transport throughout large scale agricultural catchments including no3 exchange between gw and sw at land river and wetland interfaces in addition the smr w model helps better understand wetland performance dynamics in time and space this can be critical in the selection and placement of wetlands when developing catchment scale water quality management strategies to achieve our goal we modified the integrated smr code for simulating the flow and no3 exchange between wetlands sw and gw aquifers we applied the revised model smr w to a coastal tropical catchment in northeast australia where the gw and sw are closely interconnected therefore we hypothesized that the uncertainty level associated with the wetland no3 removal capacity is high and varies during the year this means that the wetlands can act as both sources and sinks of no3 then their implementations are only justified when the long term environmental benefit surpasses the associated costs another novel aspect of this research is that unlike previous studies that attempted to optimize no3 removal in wetlands by adjusting wetlands size or locations we carried out the optimization by regulating wetlands water inflow and outflow to our best knowledge this study presents the first catchment scale gw sw modeling that uses a physically based integrated approach for quantifying no3 and flow exchange between sw gw and wetlands 2 methodology 2 1 background and limitations in incorporating gw wetland interactions in swat swat is a semi distributed process based hydrological model neitsch et al 2011 the model has been developed and widely applied to simulate hydrological and water quality processes in agricultural dominated catchments swat divides a catchment into smaller sub catchments and lumps similar soil land use and topography into hydrologic response units hrus using hrus with climate inputs the model simulates nutrient cycling and water movement in the land and river phases the swat hrus are constructed as homogeneous spatially separated entities in which a gw storage is defined to play the role of a volume control unit for aquifers given the lack of water and mass exchange among hrus the model uses analytical lagging routines to add gw return flow from each hru to the sub catchment outlets as the model cannot simulate gw head distribution using hru structure the gw component in swat is an oversimplification of the system that overlooks the gw flow systems interacting with sw bodies on top of this modeling structure swat conceptualizes wetlands as a portion of hrus or sub catchments receiving water and nutrients from overland flows the wetlands water and no3 mass balance can be expressed and computed using equations 1 and 2 1 δ v i s t o r a g e v i i n f l o w v i r a i n f a l l v i o u t f l o w v i e t v i p e r c o l a t i o n 2 δ n i s t o r e d n i i n f l o w n i o u t f l o w n i d e n i where i denotes the time step δ v i s t o r a g e is the changes in the storage volume m3 v i i n f l o w is the river inflow to the reservoir m3 v i r a i n f a l l is the volume of rainfall added to the reservoir m3 v i e t is the volume of the water removed with evapotranspiration m3 v i p e r c o l a t i o n is the volume of water percolated to the gw m3 δ n i s t o r e d is the changes in the no3 stored in the reservoir kg n i i n f l o w is the amount of no3 entered a reservoir with inflow kg v i o u t f l o w is the mass of no3 discharged into the river n i d e n i is the mass of no3 removed by denitrification based on the aforementioned information swat has the following limitations for simulating gw wetland interactions limitation 1 swat simulates hrus as spatially separated units therefore the model cannot simulate the gw flow systems that interact with wetlands limitation 2 wetland in the swat model can be simulated as a portion of an hru or a part of a sub catchment however they do not have any explicit spatial units limitation 3 swat model simulates water percolation but the model does not track the percolated water and considers percolation as a loss limitation 4 swat only uses the hydraulic conductivity of the wetland bed material to determine the degree of percolation so even when the gw head is higher than the wetland bed elevation percolation can still occur limitation 5 swat does not simulate no3 percolation from wetlands to gw limitation 6 swat does not simulate gw water discharge to wetlands limitation 7 swat does not simulate gw no3 discharge to wetlands a few studies restructured swat internal mechanisms to incorporate certain aspects of gw wetlands interactions for example to address limitations 3 4 and 6 rahman et al 2016 introduced the swatrw model to simulate a bi directional water exchange between wetland and gw swatrw divides the total volume of water in hrus aquifer storage by its specific yield to obtain an equivalent gw head therefore the model simulates gw discharge to the wetland once the gw head sits above the wetland bed elevation nevertheless due to the swatrw model s inability to simulate gw flow systems water exchange between gw and wetlands was limited within isolated hrus and thus could not influence water storage in adjacent hrus in another attempt hoang et al 2017 introduced swat ls to simulate gw flow and nitrogen fluxes from upland areas to riparian zones to overcome limitation 2 they divided hrus into upland and riparian units using a landscape division approach the swat ls was capable of routing surface and lateral flow from the vadose zone to wetlands and gw flow from the upland areas to the gw beneath the wetland in the swat ls model the gw wetland interactions were conceptualized based on the percolation from wetlands to gw and evaporation from gw to wetlands therefore gw lateral flow including water and nutrients loads could not be routed to wetlands accordingly the swat ls model was capable of addressing limitations 3 4 and 5 furthermore even though a one way gw flow from upland areas to the gw beneath the wetlands was considered in the swat ls it was still unrealistic and could not fully satisfy gw interaction with wetlands limitation 1 in fact in the real world the irregular topography and heterogeneous hydraulic conductivities of aquifers result in multiple gw flow systems tóth 1970 these flow systems vary in scale and are hierarchical with distinct types of flow systems ranging from local to intermediate to regional patterns that can be superimposed on one another within a catchment sophocleous 2002 the flow systems also highly influence the advection and dispersion of mobile pollutants such as no3 anderson et al 2015 therefore a one directional flow scenario in gw is an oversimplification of the gw flow systems a few other studies such as qi et al 2019 and yeo et al 2019 also tried to address limitation 1 using different techniques however all of them were limited to water exchange between gw and geographically isolated wetlands where the interactions should be assumed negligible in summary the lack of a gw model to simulate the gw flow systems that interact with wetlands limitation 1 was one of the common structural problems in previous studies also none of these studies quantified no3 discharge from gw to wetlands limitation 7 further on previous gw wetland modeling studies were based on lumped parameter concepts and oversimplified gw algorithms they also partially represented the exchange of water or nutrients between gw and wetlands 2 2 modifications to address the limitations in simulating gw wetlands interactions to address the identified limitations in modeling gw wetlands interactions we replaced the swat gw module with a fully distributed gw model defined explicit spatial units for wetlands revised the swat internal mechanisms for simulating water and no3 percolation and modified the integrated model to simulate water and nutrient exchange between gw and wetlands these modifications are detailed below in four major steps 2 2 1 addressing limitation 1 limitation 1 in the swat model is overcome by employing the smr model in which modflow rt3d replaces the gw module of the swat model bailey et al 2016 wei et al 2019 the smr model has been developed to simulate water and nutrient exchange between gw and sw at the land and river interfaces however the smr model is bounded by limitations 2 to 7 for simulating gw wetland interactions hereafter we present the rest of the modifications to overcome these limitations 2 2 2 addressing limitation 2 the smr model should have spatial linking units slus for wetlands to route water and nutrient loads from the swat wetland module to the modflow rt3d model or vice versa due to the absence of spatial units for wetlands in the swat model we introduced a unique slu for wetlands in the smr model using a geoprocessing mapping scheme to create slus we intersect wetland boundaries with swat sub catchments and modflow grid cells the generated polygons represent the slus each slu has four indexes the swat sub catchment number encircling it the row and column numbers of the modflow grid cell it occupies and the area it shares with the modflow grid cell a schematic representation of wetlands in the catchment is presented in fig 1 accordingly the smr modeling algorithm is modified to read an input file containing the slus supplementary material s2 and fig s1 provide more information on configuring the smr w model and the slus input file 2 2 3 addressing limitations 3 4 and 5 we modified the swat wetland module to calculate water and no3 percolation from wetlands and route them as water and no3 recharge to the gw model via the new slus according to equations 3 and 4 these two equations also consider the gw head elevation beneath the wetland therefore the model halts percolation when the gw is above the wetland bed elevation wbe we applied these two modifications to the reservoir subroutine in the swat source code therefore a wetland in a sub catchment should be defined as a reservoir in the swat model the reservoir subroutine is more suitable since swat incorporates wetlands in the river routine network also ikenberry et al 2017 modified this subroutine recently to include a weir equation to estimate daily wetland outflow discharge more accurately the authors also modified the no3 removal mechanism in this subroutine by introducing an irreducible concentration and a temperature coefficient into the first order kinetic function wetlands in this approach receive river inflow however to represent the wetlands as geographically isolated or control the daily inflow rate we modified the subroutine and added a new parameter for regulating the water and no3 loads to wetlands according to equations 5 and 6 3 v i p e r c o l a t i o n k s a t s a i i f h e a d g w j w b e j 4 n i p e r c o l a t i o n w e t n c i v i p e r c o l a t i o n j 1 n c s a j s a i f h e a d g w j w b e j 5 r v i i n f l o w r i v f r a v i i n f l o w 6 r n i i n f l o w r i v f r a n i i n f l o w where i denotes the time step j denotes the modflow grid cell that the wetland is located on n is the total number of grid cells that a wetland has occupied k s a t is the saturated hydraulic conductivity of wetlands bed materials m day sa is the surface area of wetland m2 h e a d g w j is the gw head elevation m w b e stands for the wetland bed elevation m n i p e r c o l a t i o n is the amount of no3 percolation kg day w e t n c i is the concentration of no3 in wetland c s a j is the area of the jth grid cell that the wetland has occupied r v i i n f l o w is the regulated wetland water inflow from the river m3 day r n i i n f l o w is the regulated wetland no3 inflow from the river kg day and r i v f r a is the fraction of the river diverting to the wetland 2 2 4 addressing limitations 6 and 7 to simulate gw water and no3 discharge to wetlands we employed the modflow drain package harbaugh 2005 using the drain package we modified the smr modeling algorithm to link flow and no3 discharge from gw to the swat wetland via slus to compute water and no3 from drain package to the swat wetland module we introduced equations 7 and 8 to the smr model the slus defined in section 2 2 2 were used to determine the drain package s boundary conditions during modflow model construction it is worth noting that in modflow the interactions between impounding surface water bodies and gw can be simulated with a different degree of complexity using other packages such as the general head boundary ghb package e g mylopoulos et al 2007 the river package e g leblanc et al 2007 and the lake package e g el zehairy et al 2018 however the drain package is more suitable because unlike the gbh and river package it does not cause unrealistic and unlimited water input from its boundary condition to modflow cells jones et al 2017 the drain package also has more advantages than the lake package since it does not require adjustment for the vertical cell thicknesses which is primarily operatable for field scale studies serrano hidalgo et al 2021 7 v i g w j 1 n h e a d g w j w b e j h c j c s a j i f h e a d g w j w b e j 8 n i g w j 1 n g w n c j h e a d g w j w b e j h c j c s a j i f h e a d g w j w b e j where v i g w is the volume of gw water discharge to wetland m3 h c j is the hydraulic conductivity per unit area m2 m2 n i g w is the volume of gw no3 discharge to wetland kg g w n c j is the gw no3 concentration kg m3 according to the modifications described above the new water and mass balances in wetlands can be expressed as follows 9 δ v i s t o r a g e r v i i n f l o w v i r a i n f a l l v i g w v i o u t f l o w v i e t v i p e r c o l a t i o n 10 δ n i s t o r e d r n i i n f l o w n i g w n i o u t f l o w n i p e r c o l a t i o n n i d e n i fig 2 demonstrates the internal mechanisms in the new model smr w for simulating flow and no3 interactions between the swat wetland module and the modflow rt3d model in this approach once the swat model routed flow and no3 from river networks to wetlands the wetland module first computes water balance and then no3 mass balance if the gw head is lower than the wetland bed elevation the linking module distributes the water and no3 percolation to the modflow grid cells via slus per equations 3 and 4 once swat finishes the simulation and routings the modflow solves the governing gw s control volume and flow equations then the model calls rt3d as a subroutine to solve governing no3 fate and transport equations advection dispersion and no3 denitrification in the gw aquifer finally the model calls the drain package to pass no3 and flow from gw cells to the wetland via slus on the condition that the gw head is above the wetland bed elevation per equations 7 and 8 the technical details regarding the code modifications and the instruction for preparing the model input files are provided in supplementary materials s1 and s2 and fig s1 the model s source code is available for download and use please see the software and data availability section of this paper 2 3 study area the north johnstone river basin 1000 km2 is our study area and one of the highest no3 contributors to the great barrier reef gbr fig 3 a the gbr is the world s largest coral reef stretching from southeast to northeast australia the reef has been adversely affected by agricultural non point source pollution specifically dissolved inorganic nitrogen gbrmpa 2014 mallela et al 2013 griggs 2018 implementing wetlands restoration or creation has been spotlighted in the most recent gbr scientific consensus and has been evaluated to be a cost effective method of reducing pollution and meeting no3 reduction targets waltham et al 2021 waterhouse et al 2017 however there is still no study to quantify the impact of implementing wetlands at the catchment scale for any gbr catchment in the north johnstone catchment the coastal zone and the middle section have tropical climate conditions with an average annual rainfall of 3600 mm the upper section of the catchment the elevated areas in the west has a sub tropical climate condition receiving 2000 mm average annual rainfall in general the catchment has two seasons austral summer november to may and austral winter may to november the weather in austral summer is hot and humid with intensive rainfall while the austral winter is dry and temperate the major land uses in the coastal zone are rainfed fertilizer intensive sugarcane and banana farms which cover 3 5 and 2 5 of the catchment fig 3b the aquifers in the coastal zone consist of unconsolidated surficial sediments and partially basalt systems the grazing pasture covers 38 of the catchment and is mainly concentrated in the elevated areas in the west with basalt aquifer systems rainforests cover 50 of the catchment and are primarily on the middle section of the catchment on weathered granitic mountains 2 4 smr w model setup for the north johnstone catchment we established the smr w model for the north johnstone catchment with the swat model having 1295 hrus and 91 sub catchments and modflow having 16 482 active grid cells 250 250 m data from 1443 water bores across the catchment were accessed to estimate the elevation of the aquifer base based on the case study aquifers characteristics the gw model domain was divided into three geological sections each having three layers with unique hydraulic properties the aquifer depth and geological sections of the catchment are provided in fig s2 furthermore the estimated aquifer depth was discretized into three convertible layers the first layer was considered to be 33 percent of the depth the second layer to be 22 percent and the third layer 45 percent in addition we included the only natural wetland of the catchment bromfield swamp located in the upper section of the catchment in the model the artificial wetlands for our scenario analysis were added after model calibration validation the input data sources including climate dataset land use fig 3b soil fig s3 and topography are provided in table s1 further details regarding fertilization planting harvesting applications for sugarcane banana farms and grazing pasture are provided in table s2 the leaf area index parameters of plants and crops for the swat model of the north johnstone catchment is obtained from rafiei et al 2020 2 5 the smr w model calibration and validation procedure data from seven monitoring stations including three monitoring for gw head three for streamflow and one for no3 loads are accessed to calibrate and validate hydrogeochemical processes in the established smr w model the data sources are provided in table s1 the gw heads and streamflow data have been recorded daily and no3 data was recorded for 176 days from january 1 2012 to december 31 2017 we calibrated the model for three years from january 1 2012 to december 31 2014 with a three year warm up period against the daily gw heads streamflow baseflow filtered from streamflow hydrograph and no3 loads we then validated the model for three years from january 1 2015 to december 31 2017 with the same setting the periods for calibration and validation were selected based on the availability of gw head data recorded since 2012 and the no3 loads available up to december 31 2017 the calibration and validation periods include two dry years 2012 and 2016 with an annual rainfall below the 25th percentile of annual historical records 1988 2018 and the rest of the years between the 25th percentile and 75th percentile also the period has 33 rainy months with monthly rainfall above the 50th percentile monthly historical records 17 months above the 75th and five months above the 10th percentile fig s4 in addition 24 out of 33 rainy months were in the summer and 9 out of 33 rainy months were in the winter the statistical performance of the calibrated model including nash sutcliffe efficiency nse percent bias pbias mean square error mse for the six years simulation period 1 1 2012 31 12 2017 that we considered for the analysis in this study is provided in table 1 and the measures for objectively evaluating the goodness of fit are provided in table s3 further details regarding the calibration of these types of large scale gw sw models with the example of the smr model of the north johnstone catchment are provided by rafiei et al 2022 the calibrated hydraulic parameters including horizontal and vertical hydraulic conductivities horizontal anisotropy ratios specific storage and specific yield of the gw layers are provided in table s4 the calibrated model is available for downloading and further inspection in section 5 of this paper 2 6 defining wetlands in the smr w model 2 6 1 potential sites for implementing wetlands to determine suitable locations for implementing wetlands we first calculated the overland flow directions by applying the saga gis fill sinks algorithm wang and liu 2006 on a 30 m digital elevation model dem of the catchment fig s5a in the next step we calculated the slope degree of the dem cells fig s5b then we retained all dem cells with no flow direction and eliminated any dem cells with a slope steepness of more than 5 the 5 slope criterion was considered suitable because the resultant polygons following these steps could exactly match the size of the existing natural wetland in the catchment moreover we set buffer zones up to 50 m from roads and 100 m from buildings to prevent infrastructure flooding due to wetlands inundations fig s5c we also excluded the protected national park rainforest in the middle section of the catchment fig s5c finally we eliminated the resultant polygons with an area less than half of a modflow grid cell 3 25 ha overall 28 wetlands in 28 sub catchments were identified for adding to the model fig s5d the total size of these wetlands was 660 ha with a minimum size of 4 ha a maximum size of 80 ha an average size of 23 ha and a median size of 14 5 ha these wetlands occupy between 0 2 and 9 4 of their respective sub catchment with one wetland 27 ha occupying 15 of its sub catchment the details of the sub catchment with potential places for implementing wetlands are shown in table s5 these details include the sub catchments area the size of potential areas identified in each sub catchment the percentage of major land uses the maximum fraction of river inflow to potential wetland areas and saturated hydraulic conductivity of the wetland bed materials k s a t we grouped these potential wetland locations into three wetland types including 1 palustrine wetlands which mainly rely on gw discharge inflow or rainfall while receiving less than 20 sub catchment outflow 2 riverine wetlands located adjacent to rivers hyporheic zones and can receive up to 100 of the sub catchment outflow and 3 lacustrine wetlands are located at the end of the sub catchment drainage area and can receive up to 100 of the sub catchment river outflow finally each wetland has been assigned a unique id that indicates its size type and location table s5 the first letter in wetland id stands for the location of the wetland in the catchment upper section or lower section the second letter stands for the type of the wetland riverine palustrine or lacustrine and the digits signify the size of the wetland ha 2 6 2 wetlands parameters setting for stage area volume relationship wetlands in the swat model have two stages the principal spillway and the emergency spillway ikenberry et al 2017 the principal spillway is the stage above which a wetland releases water and no3 to the river while the emergency spillway is the stage above which a wetland cannot contain any more water or constituent loads herein we show the volume and area at the principal spillway by v p m3 and sa p m2 and the volume and area at the emergency spillway by v e m3 and sa e m2 respectively we set sa e for wetlands equal to 100 of the potential area detected for wetlands implementation v e was estimated by multiplying an average wetland depth of 1 5 m by sa e this average wetland depth was chosen because it matches the average depth of water in the natural wetland in the catchment burrows et al 2014 in the next step we considered sa p equal to 80 of the potential area detected for implementing wetlands we then estimated the v p by multiplying 1 25 m average wetland depth by sa p swat uses the following equations to calculate wetland daily surface area and wetland outflow first by solving equation 11 to estimate the water level in the wetland then using equations 12 and 13 to calculate surface area and outflow discharge ikenberry et al 2017 11 v i s t o r a g e v p 1 b s h a p e h c s h a p e h 2 12 s a i s a p 1 a s h a p e h 13 q i c w e i r k w e i r w w e i r h 1 5 f o r h 0 where i denotes time step h is the height of water above or below the principal spillway m v i s t o r a g e is the volume of water stored in the wetland a s h a p e b s h a p e and c s h a p e are the wetland shape coefficients c w e i r is the coefficient for weir discharge k w e i r is the coefficient for weir crest m0 5 day w w e i r is the weir s width m q is the daily discharge from the wetland for the wetland shape coefficients in equations 11 and 12 we selected the values a s h a p e 1 b s h a p e 1 75 and c s h a p e 1 as suggested by ikenberry et al 2017 we set the k s a t of the wetlands bed equal to the k s a t of the first layer of the soil which are provided in table s5 we selected the conductance per unit area hc as 1 m2 m2 day the selected value for hc results in a conductance rate within the range of river conductance of the calibrated validated model 2 6 3 wetlands denitrification parameters setting swat wetland module uses a first order kinetic function equation 14 which also takes into account the wetland water temperature and wetland surface area to compute daily denitrification in wetlands crumpton 2001 ikenberry et al 2017 14 n i d e n i s a w e t n c i c 0 k 20 θ t 20 where i denotes time step n i d e n i is the denitrification kg c 0 is the irreducible no3 concentration kg m3 k 20 is the denitrification rate at 20 c m year θ is a coefficient for adjusting temperature t is the water temperature c we used the k 20 equal to 20 m year for all wetlands the selected value for k 20 is equivalent to the denitrification rate of 0 05 m day in gw aquifers in the catchment that we determined during the model calibration validation the selected k 20 is also in the range reported and used by previous studies ikenberry et al 2017 we also selected the swat model default value 1 08 for θ and 0 for c 0 coefficients 2 7 wetland optimization 2 7 1 optimization of inflow and outflow in wetlands previous studies have shown that when a wetland s inflow outflow is unmanaged no3 removal is negligible especially in tropical regions like our case study where flushing events in the wet season can bring substantial water into wetlands mcjannet et al 2012 therefore wetlands inflow outflow should be managed to achieve sufficient no3 removal efficiency mitsch et al 2005 raisin et al 1997 for this purpose each wetland in the model has two coefficients that control inflow and outflow i the weir coefficients in equation 13 regulate wetland outflow discharge and ii the fraction of the river outflow diverting to the wetland r i v f r as given in equations 5 and 6 regarding the former we selected the k w e i r parameter for optimization although the other weir coefficients w w e i r or c w e i r could also be used however all these weir coefficients multiply each other in equation 13 so using one of them in this case k w e i r for optimization is adequate accordingly the optimization problem has 56 parameters and the objective function is to maximize denitrification in wetlands which can be expressed by equation 15 15 m a x i m i z e o f j n i m n i d e n i j where of is the objective function equal to the total amount of no3 removed by denitrification kg in wetlands i denotes simulation time step daily j denotes wetland number n is the total number of times steps and m is the total number of wetlands we set the upper bound of k w e i r equal to 180 000 m0 5 day and the lower bound was set to 10 000 m0 5 day the c w e i r and w w e i r were fixed at 1 and 5 m respectively given this setting for weir coefficients a k w e i r value of 180 000 results in 50 000 m3 day discharge and a k w e i r value of 1000 results in 250 m3 day discharge therefore the selected range for k w e i r coefficient was suitable because the largest wetland 80 ha has the capacity of 200 000 m3 of water over the principle spillway four times higher than the highest discharge rate and the smallest wetland 4 ha has 10 000 water storage over the principle spillway 40 times higher than the lowest discharge rate regarding the r i v f r parameter its maximum for each wetland is provided in table s5 and its minimum was considered 0 1 for solving the optimization problem we used the multi memory particle swarm optimization algorithm mmpso described in rafiei et al 2022 based on previous experience in the same study area a maximum of 220 iterations with 45 particles for the mmpso algorithm were considered if the improvement in the objective function is minimal less than 1 tonne no3 within the last 30 iterations it triggers termination of optimization 2 7 2 performance evaluation of wetlands no3 removal once the optimization is completed and the global solution is obtained we rank the performance of wetlands using four criteria 1 total denitrification 2 annual denitrification rate kg ha year 3 average daily denitrification rate mg m2 year and 4 denitrification ratio during rainy months relative to the entire period a wetland goes one rank up if its performance in any of these criteria can surpass the 75th of the performance of the other wetlands we selected these criteria because the total amount of denitrification should be considered to meet reduction targets however we incorporated the average annual and daily removal rates to consider a wetland s efficiency in terms of no3 removed per unit area we also considered the ratio of denitrification in rainy months to the entire simulation period since a higher rate of denitrification during the rainy months reduces the risk of eutrophication in the reef the optimization was undertaken using a high performance computer with 64 processor cores amd epyc 7452 with a clock speed of 3 3 ghz 400 gb ram and 1 tb storage the average time for 9000 model evaluations in 45 parallel workloads 200 iterations with 45 particles in the algorithm was 110 h 2 8 uncertainty analysis there are two parameters k 20 and hc for each wetland having an uncertain range that cannot be directly measured therefore the impact of these parameters on the results must be quantified the uncertainty regarding the range of k 20 parameters was considered between 15 m year and 25 m year for each wetland for hc we considered the range of 0 5 m2 m2 to 1 5 m2 m2 for each wetland we generated 5000 samples with latin hypercube sampling lhs for 58 parameters involved in the uncertainty analysis 2 parameters for each wetland then these samples were used for model evaluation to quantify the impact of these parameters on no3 removal in wetlands note that 5000 samples were sufficient as we could observe the regression to the mean after 3000 model evaluations 3 results and discussion 3 1 optimization results fig 4 illustrates the mmpso algorithm s progress in optimizing k w e i r and r i v f r parameters for achieving maximum denitrification within 210 iterations the algorithm progressed from 174 tonnes to 229 tonnes of denitrification in wetlands the global best solution indicates that the 28 wetlands with optimized inflow outflow can reduce 13 5 of annual no3 discharge from the catchment to the reef furthermore the optimized k w e i r for wetlands has a correlation coefficient r 2 of 0 47 with water inflow indicating that the algorithm partially selected higher values for k w e i r in wetlands receiving greater river inflow also a distinct pattern can be seen for the optimized r i v f r parameters the algorithm selected 80 100 of the maximum r i v f r for the wetlands that received less than 110 mcum water inflow per year and selected less than 20 of the maximum r i v f r for the wetlands receiving more than 110 mcum the wetlands with larger k w e i r and smaller r i v f r are mostly the riverine and lacustrine wetlands adjacent to the north johnstone river that receive a large volume of water during rainy months the optimized parameters for each wetland are available in table s6 hereafter we present the modeling result with optimized wetlands parameters 3 2 model improvement no3 and water percolations in wetland as stated in the methodology the smr w model aims to improve and advance the simulation of gw wetland interaction in terms of flow and no3 exchange between these two systems these interactions can be conceptualized primarily as water and no3 percolating from the wetland to the gw and water and no3 being discharged to wetland by gw flow systems in smr w model percolation is a function of both the wetland hydraulic conductivity and the water table elevation while percolation in the smr model is only a function of the hydraulic conductivity fig 5 a compares water percolation in the smr with the smr w model to show and quantify the differences between these two models most wetlands have significantly lower water percolation in the smr w model than in the simulation produced by the smr model for example the smr model calculated 55 mcum water percolation in the wetland l r 74 throughout the simulation period whereas the smr w model estimates negligible percolation in this wetland however the smr model s predictions are not feasible because the gw water table is perched above the wetland bed in this area thus percolation cannot occur furthermore as indicated in the methodology the smr wetland module does not simulate no3 loss by percolation in wetlands to compare the smr and smr w models we incorporated the no3 percolation equation into the smr model s wetland module the difference between no3 percolation in these two conditions is illustrated in fig 5b as with water percolation no3 percolation in the smr model was unconstrained throughout the year and hence the amount is much greater than the amount estimated by the smr w model for instance when compared to the smr w the smr model simulated roughly 15 tonnes more no3 percolation in the wetland l l 80 on the other hand because the smr w model is constrained by the relative height of the gw head to the wetlands bed it avoids unrealistic no3 percolation during the rainy season when the gw head is elevated above the wetland bed elevation 3 3 modeling advancement water and no3 exchange between gw and wetlands fig 6 shows the total volume of water and no3 exchanged between wetlands and gw over the simulated period the smr w modeling results show that 12 out of 28 wetlands only received gw discharge with no percolation and seven wetlands had no gw discharge and only remained a net source of no3 to the gw system the rest of the wetlands had bi directional flow and no3 interaction throughout the simulation fig 6 further on given the denitrification wetland outflow and percolation as the major no3 losses in wetlands our results show that only in two wetlands is the percolation a major mechanism of losing no3 25 and 15 of total no3 losses furthermore the no3 percolation losses to gw only in one wetland in the upper section resulted in a considerable increase in no3 concentration in the gw from an annual average of 0 5 mgno3 l to 1 9 mgno3 l while in the rest of the wetlands the gw no3 concentration decreased or was not changed over the simulation period in five wetlands gw discharge accounts for between 13 and 40 of total no3 input in six wetlands the gw discharge contributed between 2 and 6 of total no3 input meanwhile in other wetlands the gw no3 discharge contributed less than 1 of the total no3 input for further comparison between the no3 input from gw and river inflow we selected three wetlands to show river and gw no3 contribution the selected wetlands are located in the coastal zone but with different specifications the first one l l 50 fig 7 a is in a sub catchment with 184 ha sugarcane and 91 ha banana the second one l l 30 fig 7b is in a sub catchment with 302 ha sugarcane and 29 ha banana the r i v f r parameter for both wetlands is more than 0 9 the third wetland l r 32 fig 7c is located adjacent to the north johnstone river and receives water from more than 90 of the catchment but with r i v f r equal to 0 1 10 of the river outflow the first wetland received 27 kg no3 ha year from the gw discharge the second wetland received 3 kg no3 ha year from the gw and the third wetland received 18 kg no3 ha year in the first wetland gw no3 discharge is a major supplier of no3 for the wetland 40 of total no3 input in the second and third wetlands the gw no3 discharge consists of 1 and 2 of total no3 input this result shows that the gw water and no3 discharge to wetlands are highly associated with the location of the wetland for example even though the first and second wetlands are in sub catchments with similar land use and drainage areas gw no3 discharge to the first wetland is the primary source of no3 input while gw no3 discharge to the second wetland is negligible this is because in the second wetland the percolation is dominant to the gw discharge throughout the year as the gw water table in this location is below the wetland bed elevation also comparing the first wetland with the third one shows that although they have similar gw no3 discharge per unit area and the gw no3 dominant to the percolation the no3 loads from river inflow consist of 98 of the total no3 input to the third wetland while the river no3 loads to the second wetland are 60 of total no3 input 3 4 uncertainty analysis before examining wetland performances in reducing no3 loads we first provided the uncertainty results to demonstrate how the two unknown parameters hc and k 20 might influence denitrification in wetlands and gw flow and no3 inputs to wetlands the box plots in fig 8 show the 95 percentile uncertainty in computing denitrification gw no3 discharge to wetlands and gw water discharge to wetlands the total denitrification amount in 28 wetlands has a 95 percentile range from 186 tonnes to 240 tonnes of no3 for the six year simulation period in most wetlands the 25 changes in k20 resulted in a 15 25 deviation from the mean except in wetland l r 5 which showed higher uncertainty in gw no3 discharge nevertheless only in riverine wetlands the gw water discharge is associated with a higher level of uncertainty but with limited uncertainty in gw no3 discharge fig 8c generally the gw water discharge in riparian wetlands is higher than in others mainly because in riparian corridors the thickness of gw aquifers decreases resulting in minor seasonal fluctuation but more significant gw water discharge therefore the changes in conductance throughout the uncertainty analysis resulted in considerable changes in gw water discharge to these wetlands on the other hand the limited uncertainty in gw no3 discharge to these riparian wetlands fig 8b indicates that the stored no3 of aquifers in these locations were limited so changes in conductance did not result in significant changes in gw no3 input overall the uncertainty results show that 20 percent variability in denitrification amounts simulated by the optimized model should be expected fig 8a 3 5 ranking wetlands performance in removing no3 fig 9 shows the performance of wetlands in terms of the total amount of denitrification fig 9a the annual average removal rate fig 9b the average daily removal rate fig 9c and the ratio of denitrification in rainy months compare to the entire simulation period fig 9d given the criteria we defined in the methodology to rank the performance of wetlands one wetland met all four criteria 4th rank three wetlands met three criteria 3rd rank three wetlands met two criteria 2nd rank 11 wetlands met one criterion 1st rank fig 9 the average daily denitrification for the wetland in the 4th rank is 41 mg m2 year for the wetlands in the 3rd rank is 41 mg m2 year for the 2nd rank is 28 mg m2 year and for the rest of the wetland is 11 mg m2 day regarding the potential denitrification in the region adame et al 2019 reported a range between 33 and 72 mg m2 day for natural wetlands and kavehei et al 2021 reported a range between 24 and 288 mg m2 day in constructed wetlands given these baselines the daily removal rate in the majority of wetlands in our study is within the lower spectrum of the reported potential denitrification rate however it should be emphasized that the average daily removal rate shown here is for the entire period and cannot be directly compared to the reported potential rates for the region for example the average daily removal rate for the ranked 4th wetlands is 30 mg m2 day and the 95 percentile of daily removal rate of the wetland is 73 mg m2 day which is consistent with the reported potential denitrification rate thus a better comparison can be made with wallace and waltham 2021 that observed an average denitrification rate of 42 mg no3 m2 day in an individual constructed wetland in the wet tropics region which is consistent with our findings additionally wallace and waltham 2021 estimated the annual removal rate of no3 to be 104 kg ha year in comparison to our study wetlands average annual removal rate is 109 kg ha year 150 kg ha year 105 kg ha year and 45 kg ha for ranked 4th to 1st respectively 3 6 wetlands no3 removal in rainy months vs the entire year our results showed that the ratio of wetlands denitrification in rainy months compared to the year round is between 0 41 and 0 98 with an average of 0 58 and standard deviation of 0 1 fig 9d however our results show that in sub catchments with sugarcane land use in the coastal zone the ratio of denitrification in the normal months rainfall less than 50th of the historical average compared to the rainy months is relatively higher the higher denitrification in normal months of these sub catchments is due to the larger volume of water entering the wetlands and the fertilizer application period june november the modeling results show that the applied no3 fertilizer can be mobilized leached to gw or transported downstream by a moderate rainfall event for further investigation of the underlying reason we selected three wetlands the one in the 4th rank u l 46 in a sub catchment with 746 ha modified pasture 30 of the sub catchment and no sugarcane land use fig s6c one wetland from the 1st rank l l 80 located in a sub catchment with 888 ha sugarcane and 92ha banana land use 57 of the sub catchment fig s6b one wetland l r 32 from the 3rd rank located in the coastal zone having the highest average annual removal rate in a sub catchment with 426 ha sugarcane and 229 ha banana 36 of the sub catchment fig s6a for the wetlands located in sub catchments with sugarcane land use a large to a moderate event in the austral winter e g july 2015 and nov 2016 transported more no3 loads to the wetlands than any large event in rainy months in the summer however in the wetland in the 4th rank the pattern of increasing wetland no3 storage and denitrification is the same in the winter and summer seasons however the ideal time for large denitrification removal is at the end of the summer for all the wetlands this period is the onset of austral winter and the size of storm events is relatively smaller than the middle of the summer which mostly is the onset of monsoon season 3 7 major factors affecting wetlands performance in removing no3 the size of the wetlands and the amount of fertilizer intensive land use in the sub catchments where the wetlands are located are strongly correlated with no3 removal in wetlands regarding the former wetlands size significantly correlated with the quantity of denitrification with a pearson correlation coefficient of 0 82 and a p value of 10 7 similarly the size of the fertilizer intensive land use e g sugarcane banana and modified pasture also had a significant correlation with denitrification showing a pearson coefficient of 0 81 and a p value of 10 7 the correlation between fertilizer intensive land use and denitrification can be interpreted as a proxy for showing a correlation between no3 loading rate and denitrification therefore similar to jordan et al 2011 our modeling results with smr w show a strong correlation between the log10 transferred of monthly denitrification and monthly no3 loading rate for the wetlands with a pearson coefficient of more than 0 58 and p value less than 0 001 overall the smr w simulation for a wide range of monthly no3 loadings and wetland sizes demonstrated monthly denitrification being linear functions of monthly no3 loadings and the size of the wetlands fig 10 4 conclusion this study modified the smr model to simulate water and no3 exchange between gw and wetlands the revised model smr w can provide a comprehensive nutrient and flow exchange between gw and sw at land river and wetland interfaces in addition it is worth mentioning that the new model can be used to simulate hydrological processes between gw and any impounding surface water bodies including lakes and reservoirs the smr w portrays a more realistic simulation with limited epistemic uncertainty in quantifying no3 removal and no3 exchange between gw and wetlands using the smr w model we investigated the effectiveness of 28 potential places under various conditions for implementing wetlands there are some general conclusions to be drawn from our findings 1 the gw and wetland interactions can be significant in designing wetlands for no3 removal in the region where gw head elevation and gw no3 concentration are high 2 wetlands no3 percolation did not appear to be a high risk to gw water quality as the amount of no3 denitrification and wetlands no3 outflow were two orders of magnitude higher than no3 percolation in addition the gw no3 concentration only beneath one wetland increased considerably while in the rest of the locations the gw no3 concentration decreased or did not change 3 several factors need to be considered when developing a water quality improvement plan with wetlands implementation including the size of fertilizer intensive land use in sub catchments the gw head beneath the wetland drainage area the available land for converting to the wetland and the optimization of inflow outflow of wetlands according to the size of gw and river inputs to wetlands the results showed that the heterogeneity of the hydrological processes within a catchment is high and generalization from studying individual wetlands for use in catchment scale wetland implementation is not possible unless the entire process should be considered in a modeling study despite the new improvements in integrated wetland modeling smr w several areas still need improvement in future studies for example the model can simulate the fate and transport of no3 and soluble phosphorus in gw and sw including interactions between gw and wetlands however the model is not capable of simulating the interaction of other chemicals e g pesticides in the interface of gw and wetlands therefore future studies can improve the model to include other chemicals of concern in gw sw interactions in addition swat does not simulate the transformation of organic nitrogen into mineral pools or vice versa in wetlands hypothetically the conversion can be assumed to have a negligible impact however the model should be improved to have the capacity to simulate such transformation specifically for the region where the organic nitrogen data are available and can be incorporated into the model further on swat uses a first order kinetic based on the wetlands water temperature and surface area to compute the denitrification in wetlands this approach is beneficial for data scarce regions such as the north johnstone catchment however the model can be modified in future research to consider some constraining factors such as dissolved oxygen concentration dissolved carbon concentration and ph for the users having access to these data for their simulation 5 software and data availability the source code of the smr w model can be downloaded at https github com vahidr32 swat modflow rt3d wet sourcecode in addition the calibrated smr w model of the north johnstone catchment which contains one natural wetland is available for use and further inspection at https github com vahidr32 swat modflow rt3d wet declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the first author gratefully acknowledges the university of southern queensland usq for providing the fee and stipend scholarships for conducting his ph d research we thank the state of queensland department of environment and science for providing no3 monitoring data this research was undertaken using the usq fawkes high performance computer appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2022 105407 
25600,wetlands strongly interact with groundwater and surface water influencing catchment hydrology and altering water quality meanwhile catchment scale models are typically unable to simulate groundwater wetland interactions despite the fact that quantifying groundwater wetland interactions can assist in better identifying locations for wetlands restoration creation we modified an integrated groundwater surface water model swat modflow rt3d to simulate water and nutrient exchange at the wetland interface several modifications were applied to the swat wetland module and a spatial linkage was established between the module and the modflow drain package to provide bidirectional water and nutrient exchange between groundwater and wetlands we applied the modified model smr w to a tropical catchment in northeast australia and quantified water and nitrate exchange between wetland groundwater and surface water for 28 potential locations this study demonstrates that when groundwater heads are perched above wetlands bed significant nitrate discharge from aquifers to wetlands occurs which should be considered during wetland restoration planning graphical abstract image 1 keywords wetland swat modflow rt3d groundwater nitrate great barrier reef smr w 1 introduction agricultural non point source pollution particularly nitrate no3 significantly degrades water quality resulting in various toxicological consequences for humans camargo and alonso 2006 herrero et al 2001 and harmful ecological impacts on aquatic ecosystems brodie et al 2011 fabricius et al 2010 rabalais et al 2002 to mitigate no3 transport to surface water sw and leaching to groundwater gw various nutrient management strategies have been investigated and applied to agricultural lands around the world cassman and dobermann 2022 among these practices the creation and restoration of wetlands have received particular attention hansen et al 2018 messer et al 2021 for instance in the united states to improve the deteriorated water quality of the everglades the state of florida launched a usd 11 billion restoration plan including usd 1 75 billion for purchasing sugarcane lands for conversion to wetlands richardson 2010 stokstad 2008 despite numerous reported benefits wetlands are not always the ideal solution for no3 reduction vymazal 2017 wetlands can intercept agricultural runoff and filter out no3 through biochemical processes primarily via denitrification up to 80 of removal and marginally via immobilization and plant uptake matheson and sukias 2010 vymazal et al 2020 however the effectiveness of wetlands in removing pollution depends on various factors lee et al 2009 a large body of research has investigated the major hydrological and environmental factors impacting the effectiveness of wetlands no3 removal land et al 2016 mander et al 2017 however while most research has focused on wetlands in field scale studies much remains unknown about the potential magnitude of wetland no3 removal for large scale implementation cheng et al 2020 wetland restoration creation planning at a large scale needs to deal with the heterogeneity of hydrogeochemical processes within catchment systems therefore in situ monitoring of individual wetlands may not provide a comprehensive picture necessary for successful large scale implementation under these circumstances hydrological models would be applied to quantify and evaluate wetlands effectiveness toward this end a few models can assess the hydrological processes and water quality in wetlands with different degrees of complexity and realism at the catchment scale including swat neitsch et al 2011 mike she abbott et al 1986 and modflow harbaugh 2005 here we are focused on the applications of wetlands in swat and modflow models as they have been widely used and their source codes are publicly available for modification and validation when dealing with overland flows in agricultural dominated catchments swat has been increasingly used to investigate wetlands impact on water quality and hydrological processes for instance swat was used to assess the potential role of wetlands in altering streamflow under various hydrodynamic conditions martinez martinez et al 2014 swat was also applied to understand the relationship between wetlands losses and increased soil erosion martinez martinez et al 2015 the model was further employed to explore the impact of geographically isolated wetlands on catchment hydrology yeo et al 2019 and to assess the impact of climate drivers on wetlands lee et al 2020 however the swat model has several structural flaws in simulating hydrology and water quality in wetlands specifically the model cannot simulate water and nutrient exchange between gw and wetlands neitsch et al 2011 previous studies have restructured swat internal mechanisms to incorporate some aspects of gw wetland interactions rahman et al 2016 hoang et al 2017 qi et al 2019 yeo et al 2019 nevertheless the modified models were limited to simulating water exchange between gw and wetlands within isolated homogenous units rahman et al 2016 or the interactions were only conceptualized based on the wetlands percolation and gw evaporation hoang et al 2017 furthermore among all the previous attempts none addressed the exchange of nutrient loads between gw and wetlands indeed a recurring obstacle was the absence of a comprehensive gw module capable of simulating gw flow systems that interact with wetlands modflow on the other hand was applied to evaluate gw wetland interactions however the modflow applications only addressed the hydrological processes between gw and wetlands in recent years swat and modflow have been integrated to provide the ability to simulate gw sw interactions at land and river interfaces bailey et al 2016 further on the integrated swat modflow has been incorporated with the rt3d model for simulating the fate and transport of nutrients in gw sw wei et al 2019 as of now the swat modflow rt3d model hereafter called smr can simulate water and nutrient exchange between gw and sw at the land and river interfaces in great detail wei and bailey 2021 rafiei et al 2022 however the smr model cannot simulate and quantify the interaction of gw and sw at the wetland interface or other water impoundments including flow and no3 exchange between these two systems this shortcoming in modeling as we will discuss in section 2 1 has been a subject of the previous studies in recent years and the necessity for further improvement can be supported by multiple lines of evidence indicating wetlands strong interaction with gw aquifers jolly et al 2008 van der kamp and hayashi 2009 based on the above discussion and the limitations of current modeling tools we aim to improve the simulation of sw gw and wetland interactions for catchment scale wetland implementation strategies the key novelty of this work is the adoption of a fully distributed physically based gw model in simulating water and no3 exchange between gw and wetland where these interactions are embedded in the local intermediate and regional gw flow systems in a heterogeneous environment this research is also novel as the new platform smr w provides the ability to comprehensively evaluate no3 fate and transport throughout large scale agricultural catchments including no3 exchange between gw and sw at land river and wetland interfaces in addition the smr w model helps better understand wetland performance dynamics in time and space this can be critical in the selection and placement of wetlands when developing catchment scale water quality management strategies to achieve our goal we modified the integrated smr code for simulating the flow and no3 exchange between wetlands sw and gw aquifers we applied the revised model smr w to a coastal tropical catchment in northeast australia where the gw and sw are closely interconnected therefore we hypothesized that the uncertainty level associated with the wetland no3 removal capacity is high and varies during the year this means that the wetlands can act as both sources and sinks of no3 then their implementations are only justified when the long term environmental benefit surpasses the associated costs another novel aspect of this research is that unlike previous studies that attempted to optimize no3 removal in wetlands by adjusting wetlands size or locations we carried out the optimization by regulating wetlands water inflow and outflow to our best knowledge this study presents the first catchment scale gw sw modeling that uses a physically based integrated approach for quantifying no3 and flow exchange between sw gw and wetlands 2 methodology 2 1 background and limitations in incorporating gw wetland interactions in swat swat is a semi distributed process based hydrological model neitsch et al 2011 the model has been developed and widely applied to simulate hydrological and water quality processes in agricultural dominated catchments swat divides a catchment into smaller sub catchments and lumps similar soil land use and topography into hydrologic response units hrus using hrus with climate inputs the model simulates nutrient cycling and water movement in the land and river phases the swat hrus are constructed as homogeneous spatially separated entities in which a gw storage is defined to play the role of a volume control unit for aquifers given the lack of water and mass exchange among hrus the model uses analytical lagging routines to add gw return flow from each hru to the sub catchment outlets as the model cannot simulate gw head distribution using hru structure the gw component in swat is an oversimplification of the system that overlooks the gw flow systems interacting with sw bodies on top of this modeling structure swat conceptualizes wetlands as a portion of hrus or sub catchments receiving water and nutrients from overland flows the wetlands water and no3 mass balance can be expressed and computed using equations 1 and 2 1 δ v i s t o r a g e v i i n f l o w v i r a i n f a l l v i o u t f l o w v i e t v i p e r c o l a t i o n 2 δ n i s t o r e d n i i n f l o w n i o u t f l o w n i d e n i where i denotes the time step δ v i s t o r a g e is the changes in the storage volume m3 v i i n f l o w is the river inflow to the reservoir m3 v i r a i n f a l l is the volume of rainfall added to the reservoir m3 v i e t is the volume of the water removed with evapotranspiration m3 v i p e r c o l a t i o n is the volume of water percolated to the gw m3 δ n i s t o r e d is the changes in the no3 stored in the reservoir kg n i i n f l o w is the amount of no3 entered a reservoir with inflow kg v i o u t f l o w is the mass of no3 discharged into the river n i d e n i is the mass of no3 removed by denitrification based on the aforementioned information swat has the following limitations for simulating gw wetland interactions limitation 1 swat simulates hrus as spatially separated units therefore the model cannot simulate the gw flow systems that interact with wetlands limitation 2 wetland in the swat model can be simulated as a portion of an hru or a part of a sub catchment however they do not have any explicit spatial units limitation 3 swat model simulates water percolation but the model does not track the percolated water and considers percolation as a loss limitation 4 swat only uses the hydraulic conductivity of the wetland bed material to determine the degree of percolation so even when the gw head is higher than the wetland bed elevation percolation can still occur limitation 5 swat does not simulate no3 percolation from wetlands to gw limitation 6 swat does not simulate gw water discharge to wetlands limitation 7 swat does not simulate gw no3 discharge to wetlands a few studies restructured swat internal mechanisms to incorporate certain aspects of gw wetlands interactions for example to address limitations 3 4 and 6 rahman et al 2016 introduced the swatrw model to simulate a bi directional water exchange between wetland and gw swatrw divides the total volume of water in hrus aquifer storage by its specific yield to obtain an equivalent gw head therefore the model simulates gw discharge to the wetland once the gw head sits above the wetland bed elevation nevertheless due to the swatrw model s inability to simulate gw flow systems water exchange between gw and wetlands was limited within isolated hrus and thus could not influence water storage in adjacent hrus in another attempt hoang et al 2017 introduced swat ls to simulate gw flow and nitrogen fluxes from upland areas to riparian zones to overcome limitation 2 they divided hrus into upland and riparian units using a landscape division approach the swat ls was capable of routing surface and lateral flow from the vadose zone to wetlands and gw flow from the upland areas to the gw beneath the wetland in the swat ls model the gw wetland interactions were conceptualized based on the percolation from wetlands to gw and evaporation from gw to wetlands therefore gw lateral flow including water and nutrients loads could not be routed to wetlands accordingly the swat ls model was capable of addressing limitations 3 4 and 5 furthermore even though a one way gw flow from upland areas to the gw beneath the wetlands was considered in the swat ls it was still unrealistic and could not fully satisfy gw interaction with wetlands limitation 1 in fact in the real world the irregular topography and heterogeneous hydraulic conductivities of aquifers result in multiple gw flow systems tóth 1970 these flow systems vary in scale and are hierarchical with distinct types of flow systems ranging from local to intermediate to regional patterns that can be superimposed on one another within a catchment sophocleous 2002 the flow systems also highly influence the advection and dispersion of mobile pollutants such as no3 anderson et al 2015 therefore a one directional flow scenario in gw is an oversimplification of the gw flow systems a few other studies such as qi et al 2019 and yeo et al 2019 also tried to address limitation 1 using different techniques however all of them were limited to water exchange between gw and geographically isolated wetlands where the interactions should be assumed negligible in summary the lack of a gw model to simulate the gw flow systems that interact with wetlands limitation 1 was one of the common structural problems in previous studies also none of these studies quantified no3 discharge from gw to wetlands limitation 7 further on previous gw wetland modeling studies were based on lumped parameter concepts and oversimplified gw algorithms they also partially represented the exchange of water or nutrients between gw and wetlands 2 2 modifications to address the limitations in simulating gw wetlands interactions to address the identified limitations in modeling gw wetlands interactions we replaced the swat gw module with a fully distributed gw model defined explicit spatial units for wetlands revised the swat internal mechanisms for simulating water and no3 percolation and modified the integrated model to simulate water and nutrient exchange between gw and wetlands these modifications are detailed below in four major steps 2 2 1 addressing limitation 1 limitation 1 in the swat model is overcome by employing the smr model in which modflow rt3d replaces the gw module of the swat model bailey et al 2016 wei et al 2019 the smr model has been developed to simulate water and nutrient exchange between gw and sw at the land and river interfaces however the smr model is bounded by limitations 2 to 7 for simulating gw wetland interactions hereafter we present the rest of the modifications to overcome these limitations 2 2 2 addressing limitation 2 the smr model should have spatial linking units slus for wetlands to route water and nutrient loads from the swat wetland module to the modflow rt3d model or vice versa due to the absence of spatial units for wetlands in the swat model we introduced a unique slu for wetlands in the smr model using a geoprocessing mapping scheme to create slus we intersect wetland boundaries with swat sub catchments and modflow grid cells the generated polygons represent the slus each slu has four indexes the swat sub catchment number encircling it the row and column numbers of the modflow grid cell it occupies and the area it shares with the modflow grid cell a schematic representation of wetlands in the catchment is presented in fig 1 accordingly the smr modeling algorithm is modified to read an input file containing the slus supplementary material s2 and fig s1 provide more information on configuring the smr w model and the slus input file 2 2 3 addressing limitations 3 4 and 5 we modified the swat wetland module to calculate water and no3 percolation from wetlands and route them as water and no3 recharge to the gw model via the new slus according to equations 3 and 4 these two equations also consider the gw head elevation beneath the wetland therefore the model halts percolation when the gw is above the wetland bed elevation wbe we applied these two modifications to the reservoir subroutine in the swat source code therefore a wetland in a sub catchment should be defined as a reservoir in the swat model the reservoir subroutine is more suitable since swat incorporates wetlands in the river routine network also ikenberry et al 2017 modified this subroutine recently to include a weir equation to estimate daily wetland outflow discharge more accurately the authors also modified the no3 removal mechanism in this subroutine by introducing an irreducible concentration and a temperature coefficient into the first order kinetic function wetlands in this approach receive river inflow however to represent the wetlands as geographically isolated or control the daily inflow rate we modified the subroutine and added a new parameter for regulating the water and no3 loads to wetlands according to equations 5 and 6 3 v i p e r c o l a t i o n k s a t s a i i f h e a d g w j w b e j 4 n i p e r c o l a t i o n w e t n c i v i p e r c o l a t i o n j 1 n c s a j s a i f h e a d g w j w b e j 5 r v i i n f l o w r i v f r a v i i n f l o w 6 r n i i n f l o w r i v f r a n i i n f l o w where i denotes the time step j denotes the modflow grid cell that the wetland is located on n is the total number of grid cells that a wetland has occupied k s a t is the saturated hydraulic conductivity of wetlands bed materials m day sa is the surface area of wetland m2 h e a d g w j is the gw head elevation m w b e stands for the wetland bed elevation m n i p e r c o l a t i o n is the amount of no3 percolation kg day w e t n c i is the concentration of no3 in wetland c s a j is the area of the jth grid cell that the wetland has occupied r v i i n f l o w is the regulated wetland water inflow from the river m3 day r n i i n f l o w is the regulated wetland no3 inflow from the river kg day and r i v f r a is the fraction of the river diverting to the wetland 2 2 4 addressing limitations 6 and 7 to simulate gw water and no3 discharge to wetlands we employed the modflow drain package harbaugh 2005 using the drain package we modified the smr modeling algorithm to link flow and no3 discharge from gw to the swat wetland via slus to compute water and no3 from drain package to the swat wetland module we introduced equations 7 and 8 to the smr model the slus defined in section 2 2 2 were used to determine the drain package s boundary conditions during modflow model construction it is worth noting that in modflow the interactions between impounding surface water bodies and gw can be simulated with a different degree of complexity using other packages such as the general head boundary ghb package e g mylopoulos et al 2007 the river package e g leblanc et al 2007 and the lake package e g el zehairy et al 2018 however the drain package is more suitable because unlike the gbh and river package it does not cause unrealistic and unlimited water input from its boundary condition to modflow cells jones et al 2017 the drain package also has more advantages than the lake package since it does not require adjustment for the vertical cell thicknesses which is primarily operatable for field scale studies serrano hidalgo et al 2021 7 v i g w j 1 n h e a d g w j w b e j h c j c s a j i f h e a d g w j w b e j 8 n i g w j 1 n g w n c j h e a d g w j w b e j h c j c s a j i f h e a d g w j w b e j where v i g w is the volume of gw water discharge to wetland m3 h c j is the hydraulic conductivity per unit area m2 m2 n i g w is the volume of gw no3 discharge to wetland kg g w n c j is the gw no3 concentration kg m3 according to the modifications described above the new water and mass balances in wetlands can be expressed as follows 9 δ v i s t o r a g e r v i i n f l o w v i r a i n f a l l v i g w v i o u t f l o w v i e t v i p e r c o l a t i o n 10 δ n i s t o r e d r n i i n f l o w n i g w n i o u t f l o w n i p e r c o l a t i o n n i d e n i fig 2 demonstrates the internal mechanisms in the new model smr w for simulating flow and no3 interactions between the swat wetland module and the modflow rt3d model in this approach once the swat model routed flow and no3 from river networks to wetlands the wetland module first computes water balance and then no3 mass balance if the gw head is lower than the wetland bed elevation the linking module distributes the water and no3 percolation to the modflow grid cells via slus per equations 3 and 4 once swat finishes the simulation and routings the modflow solves the governing gw s control volume and flow equations then the model calls rt3d as a subroutine to solve governing no3 fate and transport equations advection dispersion and no3 denitrification in the gw aquifer finally the model calls the drain package to pass no3 and flow from gw cells to the wetland via slus on the condition that the gw head is above the wetland bed elevation per equations 7 and 8 the technical details regarding the code modifications and the instruction for preparing the model input files are provided in supplementary materials s1 and s2 and fig s1 the model s source code is available for download and use please see the software and data availability section of this paper 2 3 study area the north johnstone river basin 1000 km2 is our study area and one of the highest no3 contributors to the great barrier reef gbr fig 3 a the gbr is the world s largest coral reef stretching from southeast to northeast australia the reef has been adversely affected by agricultural non point source pollution specifically dissolved inorganic nitrogen gbrmpa 2014 mallela et al 2013 griggs 2018 implementing wetlands restoration or creation has been spotlighted in the most recent gbr scientific consensus and has been evaluated to be a cost effective method of reducing pollution and meeting no3 reduction targets waltham et al 2021 waterhouse et al 2017 however there is still no study to quantify the impact of implementing wetlands at the catchment scale for any gbr catchment in the north johnstone catchment the coastal zone and the middle section have tropical climate conditions with an average annual rainfall of 3600 mm the upper section of the catchment the elevated areas in the west has a sub tropical climate condition receiving 2000 mm average annual rainfall in general the catchment has two seasons austral summer november to may and austral winter may to november the weather in austral summer is hot and humid with intensive rainfall while the austral winter is dry and temperate the major land uses in the coastal zone are rainfed fertilizer intensive sugarcane and banana farms which cover 3 5 and 2 5 of the catchment fig 3b the aquifers in the coastal zone consist of unconsolidated surficial sediments and partially basalt systems the grazing pasture covers 38 of the catchment and is mainly concentrated in the elevated areas in the west with basalt aquifer systems rainforests cover 50 of the catchment and are primarily on the middle section of the catchment on weathered granitic mountains 2 4 smr w model setup for the north johnstone catchment we established the smr w model for the north johnstone catchment with the swat model having 1295 hrus and 91 sub catchments and modflow having 16 482 active grid cells 250 250 m data from 1443 water bores across the catchment were accessed to estimate the elevation of the aquifer base based on the case study aquifers characteristics the gw model domain was divided into three geological sections each having three layers with unique hydraulic properties the aquifer depth and geological sections of the catchment are provided in fig s2 furthermore the estimated aquifer depth was discretized into three convertible layers the first layer was considered to be 33 percent of the depth the second layer to be 22 percent and the third layer 45 percent in addition we included the only natural wetland of the catchment bromfield swamp located in the upper section of the catchment in the model the artificial wetlands for our scenario analysis were added after model calibration validation the input data sources including climate dataset land use fig 3b soil fig s3 and topography are provided in table s1 further details regarding fertilization planting harvesting applications for sugarcane banana farms and grazing pasture are provided in table s2 the leaf area index parameters of plants and crops for the swat model of the north johnstone catchment is obtained from rafiei et al 2020 2 5 the smr w model calibration and validation procedure data from seven monitoring stations including three monitoring for gw head three for streamflow and one for no3 loads are accessed to calibrate and validate hydrogeochemical processes in the established smr w model the data sources are provided in table s1 the gw heads and streamflow data have been recorded daily and no3 data was recorded for 176 days from january 1 2012 to december 31 2017 we calibrated the model for three years from january 1 2012 to december 31 2014 with a three year warm up period against the daily gw heads streamflow baseflow filtered from streamflow hydrograph and no3 loads we then validated the model for three years from january 1 2015 to december 31 2017 with the same setting the periods for calibration and validation were selected based on the availability of gw head data recorded since 2012 and the no3 loads available up to december 31 2017 the calibration and validation periods include two dry years 2012 and 2016 with an annual rainfall below the 25th percentile of annual historical records 1988 2018 and the rest of the years between the 25th percentile and 75th percentile also the period has 33 rainy months with monthly rainfall above the 50th percentile monthly historical records 17 months above the 75th and five months above the 10th percentile fig s4 in addition 24 out of 33 rainy months were in the summer and 9 out of 33 rainy months were in the winter the statistical performance of the calibrated model including nash sutcliffe efficiency nse percent bias pbias mean square error mse for the six years simulation period 1 1 2012 31 12 2017 that we considered for the analysis in this study is provided in table 1 and the measures for objectively evaluating the goodness of fit are provided in table s3 further details regarding the calibration of these types of large scale gw sw models with the example of the smr model of the north johnstone catchment are provided by rafiei et al 2022 the calibrated hydraulic parameters including horizontal and vertical hydraulic conductivities horizontal anisotropy ratios specific storage and specific yield of the gw layers are provided in table s4 the calibrated model is available for downloading and further inspection in section 5 of this paper 2 6 defining wetlands in the smr w model 2 6 1 potential sites for implementing wetlands to determine suitable locations for implementing wetlands we first calculated the overland flow directions by applying the saga gis fill sinks algorithm wang and liu 2006 on a 30 m digital elevation model dem of the catchment fig s5a in the next step we calculated the slope degree of the dem cells fig s5b then we retained all dem cells with no flow direction and eliminated any dem cells with a slope steepness of more than 5 the 5 slope criterion was considered suitable because the resultant polygons following these steps could exactly match the size of the existing natural wetland in the catchment moreover we set buffer zones up to 50 m from roads and 100 m from buildings to prevent infrastructure flooding due to wetlands inundations fig s5c we also excluded the protected national park rainforest in the middle section of the catchment fig s5c finally we eliminated the resultant polygons with an area less than half of a modflow grid cell 3 25 ha overall 28 wetlands in 28 sub catchments were identified for adding to the model fig s5d the total size of these wetlands was 660 ha with a minimum size of 4 ha a maximum size of 80 ha an average size of 23 ha and a median size of 14 5 ha these wetlands occupy between 0 2 and 9 4 of their respective sub catchment with one wetland 27 ha occupying 15 of its sub catchment the details of the sub catchment with potential places for implementing wetlands are shown in table s5 these details include the sub catchments area the size of potential areas identified in each sub catchment the percentage of major land uses the maximum fraction of river inflow to potential wetland areas and saturated hydraulic conductivity of the wetland bed materials k s a t we grouped these potential wetland locations into three wetland types including 1 palustrine wetlands which mainly rely on gw discharge inflow or rainfall while receiving less than 20 sub catchment outflow 2 riverine wetlands located adjacent to rivers hyporheic zones and can receive up to 100 of the sub catchment outflow and 3 lacustrine wetlands are located at the end of the sub catchment drainage area and can receive up to 100 of the sub catchment river outflow finally each wetland has been assigned a unique id that indicates its size type and location table s5 the first letter in wetland id stands for the location of the wetland in the catchment upper section or lower section the second letter stands for the type of the wetland riverine palustrine or lacustrine and the digits signify the size of the wetland ha 2 6 2 wetlands parameters setting for stage area volume relationship wetlands in the swat model have two stages the principal spillway and the emergency spillway ikenberry et al 2017 the principal spillway is the stage above which a wetland releases water and no3 to the river while the emergency spillway is the stage above which a wetland cannot contain any more water or constituent loads herein we show the volume and area at the principal spillway by v p m3 and sa p m2 and the volume and area at the emergency spillway by v e m3 and sa e m2 respectively we set sa e for wetlands equal to 100 of the potential area detected for wetlands implementation v e was estimated by multiplying an average wetland depth of 1 5 m by sa e this average wetland depth was chosen because it matches the average depth of water in the natural wetland in the catchment burrows et al 2014 in the next step we considered sa p equal to 80 of the potential area detected for implementing wetlands we then estimated the v p by multiplying 1 25 m average wetland depth by sa p swat uses the following equations to calculate wetland daily surface area and wetland outflow first by solving equation 11 to estimate the water level in the wetland then using equations 12 and 13 to calculate surface area and outflow discharge ikenberry et al 2017 11 v i s t o r a g e v p 1 b s h a p e h c s h a p e h 2 12 s a i s a p 1 a s h a p e h 13 q i c w e i r k w e i r w w e i r h 1 5 f o r h 0 where i denotes time step h is the height of water above or below the principal spillway m v i s t o r a g e is the volume of water stored in the wetland a s h a p e b s h a p e and c s h a p e are the wetland shape coefficients c w e i r is the coefficient for weir discharge k w e i r is the coefficient for weir crest m0 5 day w w e i r is the weir s width m q is the daily discharge from the wetland for the wetland shape coefficients in equations 11 and 12 we selected the values a s h a p e 1 b s h a p e 1 75 and c s h a p e 1 as suggested by ikenberry et al 2017 we set the k s a t of the wetlands bed equal to the k s a t of the first layer of the soil which are provided in table s5 we selected the conductance per unit area hc as 1 m2 m2 day the selected value for hc results in a conductance rate within the range of river conductance of the calibrated validated model 2 6 3 wetlands denitrification parameters setting swat wetland module uses a first order kinetic function equation 14 which also takes into account the wetland water temperature and wetland surface area to compute daily denitrification in wetlands crumpton 2001 ikenberry et al 2017 14 n i d e n i s a w e t n c i c 0 k 20 θ t 20 where i denotes time step n i d e n i is the denitrification kg c 0 is the irreducible no3 concentration kg m3 k 20 is the denitrification rate at 20 c m year θ is a coefficient for adjusting temperature t is the water temperature c we used the k 20 equal to 20 m year for all wetlands the selected value for k 20 is equivalent to the denitrification rate of 0 05 m day in gw aquifers in the catchment that we determined during the model calibration validation the selected k 20 is also in the range reported and used by previous studies ikenberry et al 2017 we also selected the swat model default value 1 08 for θ and 0 for c 0 coefficients 2 7 wetland optimization 2 7 1 optimization of inflow and outflow in wetlands previous studies have shown that when a wetland s inflow outflow is unmanaged no3 removal is negligible especially in tropical regions like our case study where flushing events in the wet season can bring substantial water into wetlands mcjannet et al 2012 therefore wetlands inflow outflow should be managed to achieve sufficient no3 removal efficiency mitsch et al 2005 raisin et al 1997 for this purpose each wetland in the model has two coefficients that control inflow and outflow i the weir coefficients in equation 13 regulate wetland outflow discharge and ii the fraction of the river outflow diverting to the wetland r i v f r as given in equations 5 and 6 regarding the former we selected the k w e i r parameter for optimization although the other weir coefficients w w e i r or c w e i r could also be used however all these weir coefficients multiply each other in equation 13 so using one of them in this case k w e i r for optimization is adequate accordingly the optimization problem has 56 parameters and the objective function is to maximize denitrification in wetlands which can be expressed by equation 15 15 m a x i m i z e o f j n i m n i d e n i j where of is the objective function equal to the total amount of no3 removed by denitrification kg in wetlands i denotes simulation time step daily j denotes wetland number n is the total number of times steps and m is the total number of wetlands we set the upper bound of k w e i r equal to 180 000 m0 5 day and the lower bound was set to 10 000 m0 5 day the c w e i r and w w e i r were fixed at 1 and 5 m respectively given this setting for weir coefficients a k w e i r value of 180 000 results in 50 000 m3 day discharge and a k w e i r value of 1000 results in 250 m3 day discharge therefore the selected range for k w e i r coefficient was suitable because the largest wetland 80 ha has the capacity of 200 000 m3 of water over the principle spillway four times higher than the highest discharge rate and the smallest wetland 4 ha has 10 000 water storage over the principle spillway 40 times higher than the lowest discharge rate regarding the r i v f r parameter its maximum for each wetland is provided in table s5 and its minimum was considered 0 1 for solving the optimization problem we used the multi memory particle swarm optimization algorithm mmpso described in rafiei et al 2022 based on previous experience in the same study area a maximum of 220 iterations with 45 particles for the mmpso algorithm were considered if the improvement in the objective function is minimal less than 1 tonne no3 within the last 30 iterations it triggers termination of optimization 2 7 2 performance evaluation of wetlands no3 removal once the optimization is completed and the global solution is obtained we rank the performance of wetlands using four criteria 1 total denitrification 2 annual denitrification rate kg ha year 3 average daily denitrification rate mg m2 year and 4 denitrification ratio during rainy months relative to the entire period a wetland goes one rank up if its performance in any of these criteria can surpass the 75th of the performance of the other wetlands we selected these criteria because the total amount of denitrification should be considered to meet reduction targets however we incorporated the average annual and daily removal rates to consider a wetland s efficiency in terms of no3 removed per unit area we also considered the ratio of denitrification in rainy months to the entire simulation period since a higher rate of denitrification during the rainy months reduces the risk of eutrophication in the reef the optimization was undertaken using a high performance computer with 64 processor cores amd epyc 7452 with a clock speed of 3 3 ghz 400 gb ram and 1 tb storage the average time for 9000 model evaluations in 45 parallel workloads 200 iterations with 45 particles in the algorithm was 110 h 2 8 uncertainty analysis there are two parameters k 20 and hc for each wetland having an uncertain range that cannot be directly measured therefore the impact of these parameters on the results must be quantified the uncertainty regarding the range of k 20 parameters was considered between 15 m year and 25 m year for each wetland for hc we considered the range of 0 5 m2 m2 to 1 5 m2 m2 for each wetland we generated 5000 samples with latin hypercube sampling lhs for 58 parameters involved in the uncertainty analysis 2 parameters for each wetland then these samples were used for model evaluation to quantify the impact of these parameters on no3 removal in wetlands note that 5000 samples were sufficient as we could observe the regression to the mean after 3000 model evaluations 3 results and discussion 3 1 optimization results fig 4 illustrates the mmpso algorithm s progress in optimizing k w e i r and r i v f r parameters for achieving maximum denitrification within 210 iterations the algorithm progressed from 174 tonnes to 229 tonnes of denitrification in wetlands the global best solution indicates that the 28 wetlands with optimized inflow outflow can reduce 13 5 of annual no3 discharge from the catchment to the reef furthermore the optimized k w e i r for wetlands has a correlation coefficient r 2 of 0 47 with water inflow indicating that the algorithm partially selected higher values for k w e i r in wetlands receiving greater river inflow also a distinct pattern can be seen for the optimized r i v f r parameters the algorithm selected 80 100 of the maximum r i v f r for the wetlands that received less than 110 mcum water inflow per year and selected less than 20 of the maximum r i v f r for the wetlands receiving more than 110 mcum the wetlands with larger k w e i r and smaller r i v f r are mostly the riverine and lacustrine wetlands adjacent to the north johnstone river that receive a large volume of water during rainy months the optimized parameters for each wetland are available in table s6 hereafter we present the modeling result with optimized wetlands parameters 3 2 model improvement no3 and water percolations in wetland as stated in the methodology the smr w model aims to improve and advance the simulation of gw wetland interaction in terms of flow and no3 exchange between these two systems these interactions can be conceptualized primarily as water and no3 percolating from the wetland to the gw and water and no3 being discharged to wetland by gw flow systems in smr w model percolation is a function of both the wetland hydraulic conductivity and the water table elevation while percolation in the smr model is only a function of the hydraulic conductivity fig 5 a compares water percolation in the smr with the smr w model to show and quantify the differences between these two models most wetlands have significantly lower water percolation in the smr w model than in the simulation produced by the smr model for example the smr model calculated 55 mcum water percolation in the wetland l r 74 throughout the simulation period whereas the smr w model estimates negligible percolation in this wetland however the smr model s predictions are not feasible because the gw water table is perched above the wetland bed in this area thus percolation cannot occur furthermore as indicated in the methodology the smr wetland module does not simulate no3 loss by percolation in wetlands to compare the smr and smr w models we incorporated the no3 percolation equation into the smr model s wetland module the difference between no3 percolation in these two conditions is illustrated in fig 5b as with water percolation no3 percolation in the smr model was unconstrained throughout the year and hence the amount is much greater than the amount estimated by the smr w model for instance when compared to the smr w the smr model simulated roughly 15 tonnes more no3 percolation in the wetland l l 80 on the other hand because the smr w model is constrained by the relative height of the gw head to the wetlands bed it avoids unrealistic no3 percolation during the rainy season when the gw head is elevated above the wetland bed elevation 3 3 modeling advancement water and no3 exchange between gw and wetlands fig 6 shows the total volume of water and no3 exchanged between wetlands and gw over the simulated period the smr w modeling results show that 12 out of 28 wetlands only received gw discharge with no percolation and seven wetlands had no gw discharge and only remained a net source of no3 to the gw system the rest of the wetlands had bi directional flow and no3 interaction throughout the simulation fig 6 further on given the denitrification wetland outflow and percolation as the major no3 losses in wetlands our results show that only in two wetlands is the percolation a major mechanism of losing no3 25 and 15 of total no3 losses furthermore the no3 percolation losses to gw only in one wetland in the upper section resulted in a considerable increase in no3 concentration in the gw from an annual average of 0 5 mgno3 l to 1 9 mgno3 l while in the rest of the wetlands the gw no3 concentration decreased or was not changed over the simulation period in five wetlands gw discharge accounts for between 13 and 40 of total no3 input in six wetlands the gw discharge contributed between 2 and 6 of total no3 input meanwhile in other wetlands the gw no3 discharge contributed less than 1 of the total no3 input for further comparison between the no3 input from gw and river inflow we selected three wetlands to show river and gw no3 contribution the selected wetlands are located in the coastal zone but with different specifications the first one l l 50 fig 7 a is in a sub catchment with 184 ha sugarcane and 91 ha banana the second one l l 30 fig 7b is in a sub catchment with 302 ha sugarcane and 29 ha banana the r i v f r parameter for both wetlands is more than 0 9 the third wetland l r 32 fig 7c is located adjacent to the north johnstone river and receives water from more than 90 of the catchment but with r i v f r equal to 0 1 10 of the river outflow the first wetland received 27 kg no3 ha year from the gw discharge the second wetland received 3 kg no3 ha year from the gw and the third wetland received 18 kg no3 ha year in the first wetland gw no3 discharge is a major supplier of no3 for the wetland 40 of total no3 input in the second and third wetlands the gw no3 discharge consists of 1 and 2 of total no3 input this result shows that the gw water and no3 discharge to wetlands are highly associated with the location of the wetland for example even though the first and second wetlands are in sub catchments with similar land use and drainage areas gw no3 discharge to the first wetland is the primary source of no3 input while gw no3 discharge to the second wetland is negligible this is because in the second wetland the percolation is dominant to the gw discharge throughout the year as the gw water table in this location is below the wetland bed elevation also comparing the first wetland with the third one shows that although they have similar gw no3 discharge per unit area and the gw no3 dominant to the percolation the no3 loads from river inflow consist of 98 of the total no3 input to the third wetland while the river no3 loads to the second wetland are 60 of total no3 input 3 4 uncertainty analysis before examining wetland performances in reducing no3 loads we first provided the uncertainty results to demonstrate how the two unknown parameters hc and k 20 might influence denitrification in wetlands and gw flow and no3 inputs to wetlands the box plots in fig 8 show the 95 percentile uncertainty in computing denitrification gw no3 discharge to wetlands and gw water discharge to wetlands the total denitrification amount in 28 wetlands has a 95 percentile range from 186 tonnes to 240 tonnes of no3 for the six year simulation period in most wetlands the 25 changes in k20 resulted in a 15 25 deviation from the mean except in wetland l r 5 which showed higher uncertainty in gw no3 discharge nevertheless only in riverine wetlands the gw water discharge is associated with a higher level of uncertainty but with limited uncertainty in gw no3 discharge fig 8c generally the gw water discharge in riparian wetlands is higher than in others mainly because in riparian corridors the thickness of gw aquifers decreases resulting in minor seasonal fluctuation but more significant gw water discharge therefore the changes in conductance throughout the uncertainty analysis resulted in considerable changes in gw water discharge to these wetlands on the other hand the limited uncertainty in gw no3 discharge to these riparian wetlands fig 8b indicates that the stored no3 of aquifers in these locations were limited so changes in conductance did not result in significant changes in gw no3 input overall the uncertainty results show that 20 percent variability in denitrification amounts simulated by the optimized model should be expected fig 8a 3 5 ranking wetlands performance in removing no3 fig 9 shows the performance of wetlands in terms of the total amount of denitrification fig 9a the annual average removal rate fig 9b the average daily removal rate fig 9c and the ratio of denitrification in rainy months compare to the entire simulation period fig 9d given the criteria we defined in the methodology to rank the performance of wetlands one wetland met all four criteria 4th rank three wetlands met three criteria 3rd rank three wetlands met two criteria 2nd rank 11 wetlands met one criterion 1st rank fig 9 the average daily denitrification for the wetland in the 4th rank is 41 mg m2 year for the wetlands in the 3rd rank is 41 mg m2 year for the 2nd rank is 28 mg m2 year and for the rest of the wetland is 11 mg m2 day regarding the potential denitrification in the region adame et al 2019 reported a range between 33 and 72 mg m2 day for natural wetlands and kavehei et al 2021 reported a range between 24 and 288 mg m2 day in constructed wetlands given these baselines the daily removal rate in the majority of wetlands in our study is within the lower spectrum of the reported potential denitrification rate however it should be emphasized that the average daily removal rate shown here is for the entire period and cannot be directly compared to the reported potential rates for the region for example the average daily removal rate for the ranked 4th wetlands is 30 mg m2 day and the 95 percentile of daily removal rate of the wetland is 73 mg m2 day which is consistent with the reported potential denitrification rate thus a better comparison can be made with wallace and waltham 2021 that observed an average denitrification rate of 42 mg no3 m2 day in an individual constructed wetland in the wet tropics region which is consistent with our findings additionally wallace and waltham 2021 estimated the annual removal rate of no3 to be 104 kg ha year in comparison to our study wetlands average annual removal rate is 109 kg ha year 150 kg ha year 105 kg ha year and 45 kg ha for ranked 4th to 1st respectively 3 6 wetlands no3 removal in rainy months vs the entire year our results showed that the ratio of wetlands denitrification in rainy months compared to the year round is between 0 41 and 0 98 with an average of 0 58 and standard deviation of 0 1 fig 9d however our results show that in sub catchments with sugarcane land use in the coastal zone the ratio of denitrification in the normal months rainfall less than 50th of the historical average compared to the rainy months is relatively higher the higher denitrification in normal months of these sub catchments is due to the larger volume of water entering the wetlands and the fertilizer application period june november the modeling results show that the applied no3 fertilizer can be mobilized leached to gw or transported downstream by a moderate rainfall event for further investigation of the underlying reason we selected three wetlands the one in the 4th rank u l 46 in a sub catchment with 746 ha modified pasture 30 of the sub catchment and no sugarcane land use fig s6c one wetland from the 1st rank l l 80 located in a sub catchment with 888 ha sugarcane and 92ha banana land use 57 of the sub catchment fig s6b one wetland l r 32 from the 3rd rank located in the coastal zone having the highest average annual removal rate in a sub catchment with 426 ha sugarcane and 229 ha banana 36 of the sub catchment fig s6a for the wetlands located in sub catchments with sugarcane land use a large to a moderate event in the austral winter e g july 2015 and nov 2016 transported more no3 loads to the wetlands than any large event in rainy months in the summer however in the wetland in the 4th rank the pattern of increasing wetland no3 storage and denitrification is the same in the winter and summer seasons however the ideal time for large denitrification removal is at the end of the summer for all the wetlands this period is the onset of austral winter and the size of storm events is relatively smaller than the middle of the summer which mostly is the onset of monsoon season 3 7 major factors affecting wetlands performance in removing no3 the size of the wetlands and the amount of fertilizer intensive land use in the sub catchments where the wetlands are located are strongly correlated with no3 removal in wetlands regarding the former wetlands size significantly correlated with the quantity of denitrification with a pearson correlation coefficient of 0 82 and a p value of 10 7 similarly the size of the fertilizer intensive land use e g sugarcane banana and modified pasture also had a significant correlation with denitrification showing a pearson coefficient of 0 81 and a p value of 10 7 the correlation between fertilizer intensive land use and denitrification can be interpreted as a proxy for showing a correlation between no3 loading rate and denitrification therefore similar to jordan et al 2011 our modeling results with smr w show a strong correlation between the log10 transferred of monthly denitrification and monthly no3 loading rate for the wetlands with a pearson coefficient of more than 0 58 and p value less than 0 001 overall the smr w simulation for a wide range of monthly no3 loadings and wetland sizes demonstrated monthly denitrification being linear functions of monthly no3 loadings and the size of the wetlands fig 10 4 conclusion this study modified the smr model to simulate water and no3 exchange between gw and wetlands the revised model smr w can provide a comprehensive nutrient and flow exchange between gw and sw at land river and wetland interfaces in addition it is worth mentioning that the new model can be used to simulate hydrological processes between gw and any impounding surface water bodies including lakes and reservoirs the smr w portrays a more realistic simulation with limited epistemic uncertainty in quantifying no3 removal and no3 exchange between gw and wetlands using the smr w model we investigated the effectiveness of 28 potential places under various conditions for implementing wetlands there are some general conclusions to be drawn from our findings 1 the gw and wetland interactions can be significant in designing wetlands for no3 removal in the region where gw head elevation and gw no3 concentration are high 2 wetlands no3 percolation did not appear to be a high risk to gw water quality as the amount of no3 denitrification and wetlands no3 outflow were two orders of magnitude higher than no3 percolation in addition the gw no3 concentration only beneath one wetland increased considerably while in the rest of the locations the gw no3 concentration decreased or did not change 3 several factors need to be considered when developing a water quality improvement plan with wetlands implementation including the size of fertilizer intensive land use in sub catchments the gw head beneath the wetland drainage area the available land for converting to the wetland and the optimization of inflow outflow of wetlands according to the size of gw and river inputs to wetlands the results showed that the heterogeneity of the hydrological processes within a catchment is high and generalization from studying individual wetlands for use in catchment scale wetland implementation is not possible unless the entire process should be considered in a modeling study despite the new improvements in integrated wetland modeling smr w several areas still need improvement in future studies for example the model can simulate the fate and transport of no3 and soluble phosphorus in gw and sw including interactions between gw and wetlands however the model is not capable of simulating the interaction of other chemicals e g pesticides in the interface of gw and wetlands therefore future studies can improve the model to include other chemicals of concern in gw sw interactions in addition swat does not simulate the transformation of organic nitrogen into mineral pools or vice versa in wetlands hypothetically the conversion can be assumed to have a negligible impact however the model should be improved to have the capacity to simulate such transformation specifically for the region where the organic nitrogen data are available and can be incorporated into the model further on swat uses a first order kinetic based on the wetlands water temperature and surface area to compute the denitrification in wetlands this approach is beneficial for data scarce regions such as the north johnstone catchment however the model can be modified in future research to consider some constraining factors such as dissolved oxygen concentration dissolved carbon concentration and ph for the users having access to these data for their simulation 5 software and data availability the source code of the smr w model can be downloaded at https github com vahidr32 swat modflow rt3d wet sourcecode in addition the calibrated smr w model of the north johnstone catchment which contains one natural wetland is available for use and further inspection at https github com vahidr32 swat modflow rt3d wet declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the first author gratefully acknowledges the university of southern queensland usq for providing the fee and stipend scholarships for conducting his ph d research we thank the state of queensland department of environment and science for providing no3 monitoring data this research was undertaken using the usq fawkes high performance computer appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2022 105407 
25601,in recent decades parallel computing has been increasingly applied to address the computational challenges of calibrating watershed hydrologic models the purpose of this paper is to review these parallelization studies to summarize their contributions identify knowledge gaps and propose future research directions these studies parallelized models based on either random sampling based algorithms or optimization algorithms and demonstrated considerable parallel speedup gain and parallel efficiency however the speedup gain efficiency decreases as the number of parallel processing units increases particularly after a threshold in future various combinations of hydrologic models optimization algorithms parallelization strategies parallelization architectures and communication modes need to be implemented to systematically evaluate a suite of parallelization scenarios for improving speedup gain efficiency and solution quality a standardized suite of performance evaluation metrics needs to be developed to evaluate these parallelization approaches interactive multi objective optimization algorithms and or integrated sensitivity analysis and calibration algorithms are potential future research fields as well keywords parallel computing hydrologic model calibration optimization algorithms parallel speedup parallel efficiency 1 introduction watershed hydrologic models have been increasingly developed to study landscape processes such as runoff sediment and nutrient processes and to support landscape management however these models need to be calibrated to fit into specific conditions in a study area calibration is an iterative parameter adjustment procedure with which by comparing observed data with simulated results model parameters are optimized to better characterize processes conditions of the hydrologic system under study humphrey et al 2012 in the 1960s and early 1970s automatic methods for calibrating watershed hydrologic models emerged dawdy and o donnell 1965 chapman 1970 nash and sutcliffe 1970 these methods optimize model parameters by using either a likelihood function and a pre defined likelihood threshold or an optimization algorithm since automatic model calibration is a simulation and sampling based procedure it needs to carry out an efficient and sufficient search of the parameter space by evaluating a large number of parameter sets to identify the optimal ones which causes a significant computational burden efstratiadis and koutsoyiannis 2010 furthermore the computational burden is compounded by the multi objective nature of hydrologic model calibration which adds considerable complexity to the process efstratiadis and koutsoyiannis 2010 kollat and reed 2006 generally speaking working with a large number of parameters and multiple objective functions are the main reasons for a computationally demanding calibration process therefore various studies have focused on either decreasing the number of parameters or the number of objective function calls in model calibration for reducing the number of parameters researchers have used sensitivity analysis before model calibration to identify and remove insensitive parameters from the calibration muleta and nicklow 2005 liu and sun 2010 wu et al 2012 song et al 2013 surrogate models or metamodels have also been developed to simplify hydrologic models with fewer parameters chen et al 2017 meert et al 2018 gong et al 2015 xi et al 2017 however working with a limited number of parameters may lead to loss of important parameters in model calibration and consequently degradation of model accuracy decreasing the number of objective function calls is a fitness approximation strategy the idea is to use nonlinear classification methods such as artificial neural networks anns or support vector machine svm to create a classifier for assigning approximated objective function values to parameter sets instead of using actual values of the objective functions okkan and kirdemir 2020 liu and khu 2007 liu et al 2005 the effectiveness of the fitness approximation strategy depends on accuracy of the approximated model a time consuming learning process is still needed to obtain a highly accurate model also the approximated model is sensitive to size of the training data jin 2005 in short for either strategy of decreasing the number of parameters or the number of objective function calls both approaches deteriorate quality of optimized solutions which is the ratio between achieved solutions by the optimization algorithm and by some approximation methods zhang et al 2014 this divergence of computational efficiency and solution quality in model calibration calls for research advancement to speed up the calibration process concurrent with increasing quality of optimized solutions harada and alba 2020 in recent decade an interdisciplinary research direction is to tap into growing computing power to support hydrologic model calibration by applying parallel computing which links multiple computers processors to deploy a distributed computing system tang et al 2007 parallel computing makes improved use of centralized or parallel execution systems to reduce total computing time in parallel calibration algorithms this reduction in computing time which is also called parallel speedup gain can be observed when we compare their runtimes with their sequential version in addition to speedup gain that can be achieved by running simultaneous model simulations parallel computing provides the opportunity to improve quality of optimized parameter sets when comparing the solution quality of parallel calibration algorithms with their sequential counterparts this solution quality improvement can be explained by enhanced exploration exploitation of the parameter space which is enabled by running extra model simulations compared to the sequential version of the calibration algorithms huo et al 2018 harada and alba 2020 gonçalves et al 2020 semiromi et al 2018 showed that parallel automatic calibration of the hydrologic engineering center hydrologic modeling systems hec hms is superior to calibrating metamodels in terms of both processing time and solution quality parallel computing has been applied widely to various fields a recently published paper extensively reviewed parallel computational optimizations in operations research including the assignment problem the facility location problem and others schryen 2019 although parallel computing has increasingly been applied in calibration of watershed hydrologic models harada and alba 2020 her et al 2015 a systematic survey of these applications is lacking this paper addresses this knowledge gap by conducting a comprehensive review of parallel computing applications for calibrating watershed hydrologic models this paper serves the hydrologists who are challenged by the computational aspect of hydrologic model calibration and would like to explore parallel computing as a promising approach to address the challenges this paper also benefits computer science researchers working in parallel computing and looking for potential applications including hydrologic model calibration we encourage continuing interdisciplinary collaboration to further improve parallel computing for calibrating watershed hydrologic models or hydrologic modelling in general in the next section a parallel computing framework for calibrating watershed hydrologic models is developed in section 3 the proposed framework is applied to examine two approaches of parallelizing hydrologic model calibration based on randomly generated parameter sets or optimization derived parameter sets in section 4 we reflect on parallel computing applications of hydrologic model calibration to identify knowledge gaps and propose future research directions the paper ends with the conclusion section to highlight the key points elaborated in the paper 2 the parallel framework for calibrating atershed hydrologic models automatic calibration of watershed hydrologic models searches the feasible parameter space through iterative model simulations abbaspour et al 2007 and by using the inverse modeling im approach it identifies a set of optimal values for the model parameters to minimize model prediction errors tolson and shoemaker 2007 the im procedure is a simulation and sampling based process and it includes 1 input and observed data identification 2 parameter selection 3 model simulation 4 calculation and comparison of predicted responses with the observed data 5 parameter correction and 6 initialization of a new simulation milivojević et al 2009 at each simulation by using a different parameter set which is either the output of a random sampling based or an optimization algorithm the hydrologic model runs to obtain simulated responses these simulated responses are compared with the observed responses using the objective likelihood functions by considering a predefined threshold for the values of objective functions some parameter sets are selected as inputs for the uncertainty analysis in random sampling based algorithms or evolution by optimization algorithms thus at the simulation or iteration level either random sampling based algorithms can be used to generate the initial subsequent parameter sets randomly or optimization algorithms can be used for evolving the obtained parameter sets to create a new generation for the next iteration according to the calibration algorithms introduced above there are two approaches in the parallelizing calibration of hydrologic models the first approach is based on populations of parameter sets generated by random sampling based algorithms rouholahnejad et al 2012 zhang et al 2016 and the second approach is based on populations of parameter sets generated by optimization algorithms mostly metaheuristic optimization algorithms her et al 2015 kan et al 2016 although the counterpart of random sampling is the guided sampling since the behavior of guided sampling could be observed in metaheuristic optimization algorithms blum and roli 2003 in these algorithms sampling focuses on the areas of interest and converges towards the optimum solution by using learning tools we used optimization algorithms as the counterpart of the random sampling based algorithms a parallelization framework is critical to transforming an existing sequential calibration algorithm into a parallel version or developing a new parallel calibration algorithm based on literature in this field a parallelization framework for calibrating watershed hydrologic models fig 1 is proposed in this paper this framework has three main components including objectives of parallelization parallelization design and parallelization performance evaluation which are elaborated in the following sub sections 2 1 the objectives of parallelization computational speed and quality of optimized solutions considering the two aforementioned approaches in the parallel calibration of hydrologic models computational speed has two different definitions in parallel computing with random sampling based algorithms the computational speed is defined as the total execution time of running a specific number of model simulations to achieve a pre defined confidence level in parallel computing with metaheuristic optimization algorithms the computational speed is measured by the total execution time of running a required number of model simulations to obtain a high quality archive of optimized solutions for multi objective or the best optimized solution for single objective calibrations kavetski et al 2018 a high quality archive of optimized solutions is defined as a sufficient number of nondominated solutions that are preferably evenly distributed in the archive and they well converge to the global optimum solutions or the pareto front li and yao 2019 the best optimized solution which is also called pareto optimal solution is a unique solution that has either minimum or maximum value for the objective function given the above definitions the objective s of applying parallel computing for calibrating hydrologic models can be the improvement of computational speed only or both computational speed and quality of optimized parameter sets the improvement of computational speed only can be achieved by parallelizing model simulations among parallel processors in addition to speedup gain the improvement of solution quality is due to enhanced exploration exploitation of the parameter space enabled by running extra model simulations compared to the sequential version of the calibration algorithms the enhanced exploration exploitation of the parameter space can be achieved by using either multiple initial populations of parameter sets for a single optimization algorithm or single or multiple initial populations of parameters sets for multiple optimization algorithms therefore when using multiple initial populations and or optimization algorithms for calibrating a hydrological model in a parallel system we aim at improving quality of optimized solutions in addition to improving computational speed 2 2 the parallelization design parallelization strategies parallelization architectures and communication modes the parallelization design includes parallel component detection and creation in parallel component detection the calibration approach is identified while in parallel component creation the sequential calibration algorithm is modified and the program is transformed into the parallel model to carry out both tasks we need to define a parallelization strategy a parallelization architecture and a parallel communication mode 2 2 1 the parallelization strategies functional multi search and integrated multi search functional the parallelization strategy defines how a computationally expensive problem can be transformed from a sequential version into a parallel version based on specific parallelization objective s in cases where the objective of parallelization focuses on improving the computational speed efficiency of calibration algorithms an inter algorithm parallelization strategy also known as the functional parallelism strategy can be utilized this strategy improves the computational speed of calibration algorithms by parallelizing the most computationally expensive step s inside the calibration algorithm without changing the sequential algorithm logic structure in the calibration of hydrologic models running a large number of hydrologic model simulations to ensure the accuracy of the final calibrated parameter sets is the computationally expensive step the functional parallelism strategy supports distributing individual parameter sets to parallel computing units to conduct independent and simultaneous model simulations harada and alba 2020 individual parameter sets are considered as the parallel components of the functional parallelism strategy and both the initial and subsequent parameter sets could be generated using either random sampling based or optimization algorithms in cases where the parallelization has the objective of improving the quality of optimized solutions in addition to computational speed efficiency a large number of additional model simulations needs to be conducted compared to sequential counterparts to enhance the exploration exploitation of the parameter space considering this requirement two parallelization strategies have been developed for this purpose one strategy which is called multi search parallelism strategy emphasizes more on improving the quality of optimized solutions rather than computational speed efficiency while the other which is called integrated multi search functional parallelism strategy aims to strike a balance between improving the quality of optimized solutions and computational speed efficiency vrugt et al 2006 liao et al 2017 in the multi search parallelism strategy the parallel components are the initial populations instead of exploring exploiting one region of the parameter space using one initial population this strategy explores exploits different regions simultaneously by using multiple initial populations the hydrologic model simulations and fitness evaluation of parameter sets in each population are carried out sequentially which may be a barrier for further improving computational speed calaor et al 2002 the multi search parallelism strategy could be either dependent or independent a dependent multi search parallelization strategy is used if the evaluation algorithms which work with different initial populations exchange information on their best optimal solutions while an independent multi search parallelization strategy is utilized if the algorithms do not exchange this information harada and alba 2020 schryen 2019 evolving from the multi search parallelism strategy which may have tradeoffs between solution quality and computational speed the integrated multi search functional parallelism strategy aims to improve both solution quality and computational speed in this strategy not only initial populations but also individual parameter sets hydrologic simulations inside each initial population are parallel components harada and alba 2020 this strategy is supported by technology advancement of distributed multi processor and multi computer systems in these systems parallel computing units are identified as processing cores in a computer cpu adeleye 2017 multi computer systems have multiple parallel computers cpus and on each of them there are multiple processing cores the multi search parallelism strategy is used to parallelize multiple initial populations among multiple computers cpus and the functional parallelism strategy is implemented to parallelize individual parameter sets in each initial population among different processing cores on each computer cpu 2 2 2 the parallelization architectures master slave parallel island and parallel hybrid the parallelization architecture defines 1 the arrangement of processing units and 2 the direction of communications to from these units in a parallel system there are three types of parallelization architectures which are master slave parallel island and parallel hybrid architectures fig 2 a 2b and 2c in the master slave architecture one parallel processing unit serves as the master node while the rest of the units are slave nodes the master node 1 distributes tasks jobs to slave nodes 2 receives the results of parallel tasks jobs back from all slave nodes and 3 constructs the final output for the global problem regarding the direction of communications there are only communications from to the master node to from the slave nodes and the slave nodes do not communicate with each other fig 2a crainic and toulouse 2010 the master slave architecture is mostly used when working with a single population search algorithm while the parallel island architecture is developed for managing multiple populations search algorithms in separate islands an island in a parallel system is a separate processing unit with a separate initial population search algorithm the controller node is responsible for assigning parallel tasks to islands and receiving the results when they have finished processing their assigned tasks islands can either have communications among themselves to distribute required information global optimum solutions for each initial population or only have communications with the controller node to receive parallel tasks and send back the results fig 2b the parallel hybrid architecture is a combination of the parallel island architecture and the master slave architecture implemented in each island fig 2c hadka and reed 2013 2 2 3 the parallel communication models synchronous and asynchronous the parallel communication mode which could be synchronous or asynchronous characterizes the information solution exchange among parallel processing units the synchronous communication mode which is called rigid synchronous rs happens in the master slave architecture or the parallel island architecture without information exchange among islands in this communication mode to move towards an optimum solution fulfilling the goal of parallelization all parallel processing units must finish their assigned parallel tasks before the communication happens in fact the master node or the controller node waits until all parallel processing units send their results back to evaluate the results based on the evaluation it defines new parallel tasks to move one step further towards optimum solutions and assigns new tasks again to the processing units this procedure happens until the optimum solutions are found the asynchronous communication mode also called knowledge collegial asynchronous kc happens only in the parallel island architecture with communications among islands in this communication mode the controller node does not wait to receive all islands results before assigning new parallel tasks to finished islands and all the islands communicate with each other throughout the calibration process to exchange their most optimum solutions in fact the controller node defines the improved parallel tasks concurrently for all parallel processing elements and asynchronously by communicating with the other processing units each parallel processing unit improves its own assigned task these communications guide all the parallel tasks towards the most optimum solutions in the parameter space at the end schryen 2019 2 3 the parallelization performance evaluation parallel speedup parallel efficiency and solution quality parallelization evaluation uses three metrics which are parallel speedup parallel efficiency and solution quality to evaluate the parallelization performance yero and henriques 2007 the parallel speedup as a dimensionless metric is represented by the ratio of execution times of the parallel version and the sequential version the parallel efficiency is the ratio of parallel speedup to the number of processing units calaor et al 2002 the solution quality specifically refers to pareto approximations from optimization algorithms which is defined by cardinality a sufficient number of nondominated solutions convergence a good closeness to the pareto front diversity a good spread over the pareto front and uniformity the solutions should evenly be distributed in the set audet et al 2020 there are two options to evaluate the quality of solutions achieved by parallel optimization algorithms the first option is to conduct an uncertainty analysis to acquire the confidence level for the optimal solutions the second option is to compare the optimal solutions achieved from parallel optimization algorithm s i e pareto approximations with the best known solutions obtained from the sequential implementation of the same algorithm s i e pareto front harada and alba 2020 schryen 2019 3 parallel computing applications in calibrating watershed hydrologic models this section applies the proposed parallel computing framework to evaluate representative application cases that utilize parallel computing for calibrating watershed hydrologic models based on the framework we classify the application cases into two categories which are parallelization of random sampling based algorithms and parallelization of optimization algorithms 3 1 model calibration with parallel random sampling based algorithms in studies focusing on improving computational speed of calibration algorithms researchers have utilized uncertainty analysis methods such as the generalized likelihood uncertainty estimation glue beven and binley 2014 or sequential uncertainty fitting2 sufi2 abbaspour et al 2004 to conduct both model calibration and uncertainty analysis the idea behind this research direction is to calibrate hydrologic models by evaluating the error likelihood levels of various parameter sets and selecting the low error ones for model parameterization zhang et al 2016 for example in the sequential implementation of the glue method with random sampling strategy for calibrating watershed hydrologic models the monte carlo based model simulations are carried out and an error likelihood value based on the comparison of predicted and observed responses is assigned to each parameter set yang et al 2008 in fact after identification of the hydrologic model feasible space for model parameters input datasets observed data for the model variable s suitability threshold and the number of simulations a random sampling method such as the latin hypercube sampling method lhs in glue randomly generates a number of parameter sets equal to the number of simulations then in each simulation the hydrologic model is executed using one of the randomly generated parameter sets and an objective likelihood function such as the nash sutcliffe model coefficient efficiency nsce is calculated using the model simulated outputs and the observed data the error likelihood values are compared with a predefined threshold and if they are less than the threshold the corresponding parameter set is considered as a behavioral parameter set in the final step the parameter sets for model parameterization which has the lowest error likelihood level are selected by comparing the error likelihood levels of all behavioral parameter sets kan et al 2020 tang et al 2007 in implementing the glue method with a random sampling strategy for calibrating watershed hydrologic models running a large number of model simulations is the most computationally expensive step since the model simulations are carried out independently from each other we can use the functional parallelism strategy to parallelize individual parameter sets which are derived using a random sampling strategy therefore in parallel implementation of the glue method using the master slave architecture the master node sends out a parameter set to a slave node where the parameter set is plugged in the hydrologic model to carry out a model simulation then the likelihood function uses the simulated result and the observed data to calculate an error likelihood measure for the parameter set if the error likelihood measure is within an acceptable range using a pre defined threshold the behavioral parameter set and the model simulated value are sent back to the master node and the slave nodes will be waiting for receiving a new parameter set to conduct further model simulations fig 3 referring to the parallelization framework in fig 1 the functional parallelism strategy master slave architecture and rigid synchronous rs communication mode are used to parallelize a random sampling based calibration algorithm such as the glue method table 1 summarizes the studies on the parallelizing calibration of watershed hydrologic models based on randomly generated parameter sets the summary includes the source author date the purpose of the study utilized hydrologic model and distributed system with master slave architecture and findings speedup efficiency these studies typically followed the implementation as shown in fig 3 and the main objective of these studies was to speed up the calibration execution on a distributed computing system thus increasing the quality of solutions with enhanced exploration exploitation of the parameter space was not the focus of these studies all six studies in table 1 demonstrated a wide range of speedup gain in calibrating watershed hydrologic models by using parallel computing bacu et al 2011 reported the average time of executing 100 150 200 and 250 swat model simulations on a distributed system with 20 30 40 50 and 60 processing units varied from approximately 2 min 6 min per simulation while the execution time on a single processing unit was around 7 min rodila et al 2011 reported that the execution time of swat model calibration sequentially on a single processing unit took approximately one day 11 h and 30 min while parallelly on 24 processing units took 4 h and 15 min 15 267 s rouholahnejad et al 2012 reported a 1 9 speedup gain in calibrating the swat model using two parallel processing units vs a single processing unit zhang and chen 2016b reported a speedup gain range of 7 01 7 85 when increasing the number of parallel processing units from 1 to 8 for calibrating the swat model kim and ryu 2019 reported reduction rates of total calibration time by 76 89 89 and 90 for four different calibration scenarios yin et al 2020 reported the speedup ratio of 345 82 when the number of parallel processing units reached 400 for calibrating the xinanjiang model the observed wide range of speedup gain in literature reveals that the speedup of model calibration is a function of the number of parallel processing units in a distributed system thus parallel efficiency has been used to standardize the speedup gain relative to the scale of the distributed system for comparison purposes various studies reported parallel efficiency of less than 1 0 due to communication overhead in the system zhang et al 2016 reported a parallel efficiency of less than 1 0 when increasing the parallel processing units from 1 to 8 in swat calibration yin et al 2020 reported a decrease in the parallel efficiency by increasing the number of processing units 0 90 at 200 processes and 0 87 at 400 processes these results show that the parallel efficiency of functional parallelism strategy with a master slave architecture decreases as the number of parallel tasks surpasses the number of parallel processing units because of the communication overhead between the master node and slave nodes the findings have implications on the scalability of a distributed computing system for calibrating complex hydrologic models which needs a large number of simulations most likely the number of simulations will well exceed the number of parallel computing nodes furthermore this type of parallelization doesn t focus on improving the quality of calibrated solutions the knowledge gap has motivated researchers e g tang and reed 2006 semiromi et al 2018 to develop the parallelization framework for optimization algorithms focusing on improving the quality of solutions in addition to parallel efficiency 3 2 model calibration with parallel optimization algorithms in parallelization of hydrologic model calibration based on optimization generated parameter sets most researchers have used global optimization algorithms particularly meta heuristic optimization algorithms these optimization algorithms use population based stochastic search algorithms to generate a population of parameter sets e g janga reddy and kumar 2020 after hydrologic model simulations the parameter sets with objective function values within a pre defined range are exposed to various collective learning processes which are called metaheuristic techniques to get evolved step by step to converge to the global optimum these algorithms have several advantages 1 they use prior information which makes them outperform those methods without utilizing prior information 2 they do not need continuous response surface or any specific constrained sets 3 they are robust and flexible to be adapted to a changing environment 4 they can find global or near global optimal solutions especially in large and complex parameter space 5 they can balance diversification and intensification to avoid trapping in local optima and also to converge quickly and 6 they can deal with multiple objectives simultaneously janga reddy and kumar 2020 parallel optimization algorithms for calibration of hydrologic models can be implemented with a focus on either improving computational speed or improving quality of optimized parameter sets in addition to computational speed since the former objective is the same as the objective of the parallel random sampling based algorithms both approaches have the same parallelization framework the functional parallelism strategy rigid synchronous rs communication and master slave architecture fig 1 and implementation fig 3 the only difference in the parallelization implementation lies in the population generation methods in parallel optimization algorithms for calibration of watershed hydrologic models an optimization algorithm can be used to generate and evolve an initial population throughout numerous iterations more advanced implementation includes using a single optimization to generate evolve multiple populations or using multiple optimization algorithms to generate evolve multiple populations thus parallel optimization algorithms working on multiple populations compared to the ones working on a single population can achieve the objective of improving solution quality by enhancing exploration exploitation of the parameter space in addition parallel optimization algorithms show an improved computational speed or convergence speed when compared with their sequential counterparts in this parallelization implementation either a multi search or integrated multi search functional parallelism strategy and either a rigid synchronous rs or asynchronous kc communication mode can be used schryen 2019 in the multi search parallelism strategy parallel island architecture and in the integrated multi search functional parallelism strategy parallel hybrid parallelization architecture can be used fig 1 fig 4 shows the parallelization implementation of the multi search and integrated multi search functional parallelism strategies with parallel island and parallel hybrid architectures note that dependent multi search parallelism strategy needs knowledge sharing throughout the execution of parallel tasks thus it uses only asynchronous kc communication mode while the independent multi search parallelism strategy uses a rigid synchronous rs communication mode since parallel tasks do not need to share their found knowledge table 2 outlines the parallelization studies on calibrating watershed hydrologic models based on optimization derived parameter sets and it includes source author date purpose of study optimization algorithm and hydrologic model parallelization strategy parallelization architecture communication mode programming environment tools and distributed system and findings further assessment of these parallelization studies is provided in the following three sub sections 3 2 1 hydrologic models and optimization algorithms most of reviewed parallelization studies were based on the swat a process based model sharma et al 2006 milivojević et al 2009 zhang et al 2012 2013 yen et al 2014 her et al 2015 li et al 2015 or conceptual hydrologic models hreiche et al 2002 kan et al 2016 2018 liao et al 2017 huo et al 2018 semiromi et al 2018 most of these studies used the shuffled complex evolution metropolis scem ua algorithm sharma et al 2006 vrugt et al 2006 yen et al 2014 seong et al 2015 kan et al 2016 2018 and genetic algorithm ga tang and reed 2006 tang et al 2007 he et al 2007 milivojević et al 2009 zhang et al 2016a liao et al 2017 li et al 2015 only tang and reed 2006 tang et al 2007 zhang et al 2012 and zhang et al 2013 worked on parallelization of a multi objective calibartion problem based upon the studies listed in table 2 we observed that the range of hydrologic models and or the optimization algorithms in parallelization studies were limited and the development of parallel multi objective optimization algorithms for calibration of hydrologic models was inadequate although the calibration of hydrologic models is a multi objective task 3 2 2 distributed systems parallelization strategies and parallelization architectures among the 21 reviewed parallelization studies 9 studies hreiche et al 2002 sharma et al 2006 tang et al 2007 milivojević et al 2009 zhang et al 2013 tolson et al 2014 yen et al 2014 her et al 2015 semiromi et al 2018 used distributed systems with multi computer setting and 12 of them vrugt et al 2006 tang and reed 2006 he et al 2007 zhang et al 2012 2016a seong et al 2015 li et al 2015 kan et al 2016 2018 liao et al 2017 huo et al 2018 liu and zhou 2019 used distributed systems with multi processor setting however the integration of distributed multi processor and multi computer systems for increasing the level of parallelization was lacking in the literature as the majority of these studies focused on parallel speedup gain the functional parallelism strategy was mostly used hreiche et al 2002 vrugt et al 2006 sharma et al 2006 he et al 2007 milivojević et al 2009 zhang et al 2012 2013 yen et al 2014 li et al 2015 her et al 2015 seong et al 2015 kan et al 2016 2018 liao et al 2017 semiromi et al 2018 among these studies 14 of them used the master slave architecture and 11 utilized rigid synchronous communication mode the other studies didn t report the utilized parallel architecture and communication mode several studies focused on not only parallel speedup gain but also improving solution quality by running extra model simulations to enhance exploration exploitation of the parameter space compared to the sequential version of the same optimization algorithm in these studies the multi search parallelism strategy either dependent or independent has been implemented and compared with the functional parallelism strategy tang and reed 2006 tang et al 2007 tolson et al 2014 tolson et al 2014 compared the independent multi search parallelism strategy with the functional parallelism strategy using master slave architecture and rigid synchronous communication for both strategies they reported that the independent multi search parallelism strategy led to quicker convergence to solutions with improved solution quality when compared to the solution quality from the functional parallelism strategy and this parallelization strategy showed a super linear parallel efficiency tang and reed 2006 and tang et al 2007 compared the dependent multi search parallelism strategy using a parallel island architecture with the functional parallelism strategy using a master slave architecture with knowledge collegial communication modes for both strategies the results showed that the dependent multi search parallelism strategy achieved a smaller speedup gain than the functional parallelism strategy but it improved the reliability of the search dramatically tang et al 2007 reported that the functional parallelism ran 2 3 times faster than the dependent multi search parallelism in a parallel system with 8 and 16 processing units these studies showed that the independent or dependent multi search parallelism strategy has improved solution quality than that of the functional parallelism strategy but the speedup gain maybe smaller however these studies are not sufficient for developing a solid understanding of the pros and cons of the multi search parallelism strategy and the functional parallelism strategy in addition no studies compared the independent and dependent multi search parallelism strategies although the integrated multi search functional parallelism strategy has the potential to strike a balance between improving quality of optimized solutions and computational speed efficiency vrugt et al 2006 liao et al 2017 only huo et al 2018 implmented integrated multi search functional parallelism strategy by combining the independent multi search with the functional parallelism strategy using parallel hybrid architecture and rigid synchronous communication the quality of optimized solutions was not compared while the authors reported considerable reduction of the execution time and improvement of the parallel efficiency compared to the sequential version of the algorithm there are limited studies on implementing integrated multi search functional parallelism strategy studies and no studies on comparing the multi search parallelism strategy with the integrated multi search functional parallelism strategy 3 2 3 parallel speedup parallel efficiency and quality of optimized solutions all the reviewed studies reported a speedup gain in parallel implementation of watershed hydrologic model calibration in comparison to the sequential implementation however the parallel efficiency had a mixed pattern some papers reported a close to linear parallel efficiency until the number of processors equals the number of parallel tasks while other papers reported a sub linear parallel efficiency due to the additional communication overhead where the number of parallel tasks is close or above the number of parallel processors for example li et al 2015 reported a parallel speedup of 8 0 and a parallel efficiency of 88 9 in a parallel system with 10 processing units yen et al 2014 reported that the parallel speedup increased up to 11 when increasing the number of processing units from 2 to 12 hreiche et al 2002 reported an increase in parallel speedup from 1 9 to 30 0 in a parallel system while increasing the processing units from 2 to 40 liu and zhou 2019 reported an average of 3 22 parallel speedup in a parallel system with 4 processing units liao et al 2017 reported a speedup ratio from 2 to 12 when increasing the number of processing units from 2 to 16 kan et al 2018 reported a parallel speedup between 4 and 12 4 in a parallel system with 4 16 processing units her et al 2015 reported a parallel speedup from 1 to 6 for a parallel system with processing units increased from 2 to 8 seong et al 2015 reported that a parallel system with 2 and 4 processing units achieved 47 and 66 speedup gain respectively several studies reported a significant decrease in parallel efficiency after a threshold in the number of parallel processing units zhang et al 2012 reported an increase in the speedup ratio to 7 when the number of processing units reached 16 and after that speedup ratio was less than 2 zhang et al 2013 reported that by increasing the number of cores to 20 40 and 60 a speedup ratio from 19 to 36 and 46 was achieved however the parallel speedup saturated at 60 processing units and declined after that zhang et al 2016 reported that the speedup ratio reached 4 3 with 22 processing units but no speedup gain beyond that kan et al 2016 reported a speedup ratio ranging from 3 72 to 15 93 for a parallel system with 4 16 processing units beyond 16 cores the speedup ratio increase was very limited most of these studies identified shared cache and i o saturation as the main reasons for the decreasing speedup gain with increasing processing units zhang et al 2012 2013 yen et al 2014 in contrast to the parallel speedup and parallel efficiency there were very limited studies on comparing quality of optimized solutions obtained from parallel and sequential implementation of calibration algorithms in a study by tang et al 2007 quality indicators qis were used to quantitatively compare the solution sets by mapping solutions to real numbers to indicate the solution set s quality this study showed that the quality of optimized solutions in parallel calibration using the dependent multi search parallelism strategy is better than that of the functional parallelism strategy the unary hypervolume metric for measuring the convergence 0 1 lower value means higher convergence was 0 8 with 8 processing units in the functional parallelism strategy while it was 0 2 in the dependent multi search parallelism strategy the ε indicator for measuring the diversity of solutions 0 1 higher value means more diversity was 0 7 in the functional parallelism strategy while it was 0 9 in the dependent multi search parallelism strategy this study demonstrated that the dependent multi search parallelism strategy was able to attain better metrics for quality of optimized solutions instead of comparing the quality of optimized solutions obtained by parallel optimization algorithms vs sequential versions a study by semiromi et al 2018 evaluated quality of optimized solutions obtained by parallel computing vs metamodeling metamodeling is the use of surrogate models instead of computationally expensive models to decrease computational costs by using visualization techniques to demonstrate the quality of optimized solutions this paper showed that parallel computing led to better global optimum solution compared to metamodeling 4 discussion and future research directions in recent decades parallel computing has been gradually applied to address computational challenges in calibrating complex watershed hydrology models these studies started with parallelizing parameter sets generated by random sampling based algorithms to improve the calibration speed later on the research direction moved towards parallelizing parameter sets generated by optimization algorithms to improve calibration speed and quality of optimized solutions jointly through both simultaneous simulations and enhanced exploration exploitation of the parameters space while celebrating considerable progress on achieving these objectives we now identify several knowledge gaps and also discuss future research directions in parallel computing for calibrating watershed hydrologic models 4 1 standardizing the reporting on parallelization framework implementation and performance evaluation metrics the reviewed studies showed a diverse range of documentation on the parallelization procedure and outcome most of the studies reported speedup gain and parallel efficiency in parallel vs sequential implementation of the same algorithms however only a few studies reported metrics for measuring the quality of optimized solutions we would like to advocate standardizing the reporting of parallelization framework strategies architectures and communication modes implementation programming languages apis libraries etc and performance evaluation metrics speedup gain efficiency and solution quality more structuralized reporting can help researchers continue improving parallelization frameworks and develop approaches to enhance parallel optimization algorithms such as adaptive search methods or adaptive population sizes semiromi et al 2018 4 2 developing parallelization strategies for improving parallel speedup and efficiency while most studies reported parallel speedup gain the parallel efficiency exhibited a downward trend when increasing the number of parallel processing units particularly beyond a threshold equal to the number of parallel tasks this pattern is logical as communication overhead significantly increases when adding more processing units to parallel systems while this pattern persists there is a potential to optimize the parallel computing system to achieve maximum speedup gain under the technology constraints zhang et al 2012 indicated that the shared caches and i o delay influenced the efficiency of parallel optimization algorithms and future studies should work on optimizing cache use and i o operations to improve the utilization of distributed systems under the multi processor setting zhang et al 2013 stated that future studies should work on how the input data for hydrologic models should be organized in a high performance computing friendly format to address the i o and shared cache problems kan et al 2016 suggested a need for high memory requirements in systems with multi processor architecture thus one future research direction is to improve optimize the cache use and i o operations in systems with multi processor architecture such as using collective i o in multi core cluster systems cha and maeng 2012 or boosting the efficiency of the distributed systems with multi computer architecture such as using efficient parallelism strategies with a low level of communication requirements 4 3 developing parallelization strategies for improving both parallel speedup and solution quality huo et al 2018 stated that in the population based optimization algorithms large population sizes or multiple populations could reinforce diversity reduce unpredictability and improve solution quality however tang et al 2007 reported that the independent multi search parallelism strategy without knowledge exchange had a lower speedup gain compared to the functional parallelism strategy these limited studies show that although parallel computing has the potential to improve both execution speed and quality of the optimized solutions in calibrating watershed hydrologic models there exist tradeoffs between the two objectives further implementation of multi search parallelization strategies needs to be conducted to gain a more in depth understanding of the tradeoffs for example an encouraging research direction is to implement the dependent multi search parallelism strategy with knowledge exchange to achieve high quality solutions with lower execution times furthermore the integrated multi search functional parallelism strategy showed promises on striking a balance between speedup gain efficiency and solution quality vrugt et al 2006 liao et al 2017 in this research direction parallelization can couple multiple populations with multiple optimization algorithms to provide a simultaneous exploration of different regions of the parameter space using various searching tools optimization algorithms schryen 2019 in this regard various combinations of hydrologic models optimization algorithms parallelization strategies architectures and communication modes should be implemented to systematically evaluate a suite of parallelization scenarios for improving the speedup gain parallel efficiency and quality of optimized solutions in calibrating watershed hydrologic models for example the potential parallelization combinations that have not been implemented so far are the combination of dependent and independent multi search parallelism with functional parallelism for multi objective calibration problems with independent objective functions using parallel hybrid architectures it worth noting that although the optimization algorithm and the parallelization strategy are two factors in determining the parallelization architecture and communication mode most studies utilized the master slave architecture in parallelization thus future research can evaluate the implementation of parallel island and parallel hybrid architectures 4 4 developing parallel interactive multi objective optimization algorithms developing a precise multiple objective parameter optimization of hydrologic models has two approaches distribution assuming and imprecision propagating multi objective evolutionary algorithms da moeas and ip moeas da moeas assume normal distributions of the objective functions but the assumption does not apply to all objective functions therefore the imprecision propagating approach without the assumption of normal distribution has gained much attention sun et al 2011 using this approach interactive methods with interval input parameters have been developed to approximate objective functions without assuming normal distributions limbourg and salazar aponte 2005 these methods are called interactive since the objective functions parameters e g mean or variance for each case study should be calculated using observation datasets since the observation datasets have errors we use interval parameters based on statistical measures instead of absolute values when working with intervals we do not have solution dominance and instead we have interval dominance sun et al 2011 the parallel version of the algorithm not only accounts for the inherent uncertainty in calibrating watershed hydrologic models but also provides fast convergence and better quality optimized solutions thus one of the potential research directions is to develop parallel interactive multi objective optimization algorithms for calibrating watershed hydrologic models 4 5 developing parallel integrated algorithms for concurrent sensitivity analysis and parameter optimization sensitivity analysis serves to reduce the execution time of hydrologic model calibration by focusing on critical parameters for model optimization sensitivity indices obtained before model calibration could help decrease the dimensionality of multi objective calibration problems and maximize information extracted from observed hydrologic response data rodila et al 2011 however this approach causes extensive model simulations duplicated to the large number of simulations required for the model calibration process to address the duplication problem sensitivity indices could be obtained during and used by the model calibration concurrently by giving a high probability to value change of those parameters with more impacts on the model responses the sensitivity indices help guide search operators such as a mutation in metaheuristic optimization algorithms to the optimum solution in the parameters space li et al 2016 integrated the strength pareto evolutionary algorithm spea and spearman rank correlation coefficient srcc method for conducting integrated sensitivity analysis and model calibration their results showed that the integrated algorithm effectively improved the survivability competence of sensitive variables by changing the evolutionary parameters they also reported low computational costs compared to conducting sensitivity analysis and parameter optimization separately therefore one of the potential research directions is to develop further parallel integrated algorithms to carry out sensitivity analysis and parameter optimization at the same time and guide the parameter calibration process to achieve better quality optimized solutions however the sensitivity analysis methods that could be used for this approach are limited morris s method sobol s method fourier amplitude sensitivity analysis and extended fourier amplitude sensitivity analysis could not be used directly in the optimization process li et al 2016 because the randomness and unbiasedness are two basic properties of the samples for traditional sensitivity analysis methods but in the optimization process these methods provide biased samples that are tending towards the optimal set therefore in future studies on integrating sensitivity analysis with optimization algorithms the sensitivity analysis methods whose results are not influenced by the distribution of sample parameter sets used in those methods should be taken into consideration hamby 1994 li et al 2016 5 conclusion in recent decades parallel computing has increasingly been being applied to address computational challenges in the automatic calibration of watershed hydrologic models this paper develops a framework to conceptualize parallelization processes of calibrating hydrologic models applies the framework to evaluate representative parallelization studies identifies knowledge gaps and proposes future research directions our assessment shows that the total number of parallelization studies was still limited and most of these studies focused on improving speedup gain however the literature revealed a growing trend to improve the quality of optimized solutions through enhanced exploration exploitation of parameter space which is enabled by running an extra number of model simulations compared to the sequential version of the same algorithm we argue that parallel computing for calibrating watershed hydrologic models needs to be developed further in not only scope such as research on various combinations of hydrologic models optimization algorithms parallelization strategies parallelization architectures and communication modes but also depth such as improving solution quality in addition to speedup gain and efficiency besides further developments should benefit from standardized reporting on parallelization framework implementation and performance evaluation metrics expanding the scope of parallelization studies can be empowered by significant technology advancements in multi processor and multi computer systems which support parallelization concurrently for both populations of parameter sets and individual parameters to improve parallel efficiency in terms of the depth of parallelization studies multi search and integrated multi search and functional parallelism strategies can be developed to conduct single population model calibration with multiple optimization algorithms or multi population model calibration with multiple optimization algorithms to improve jointly parallel efficiency and solution quality furthermore interactive multi objective optimization algorithms using the imprecision propagating approach can be parallelized to integrate uncertainty analysis with calibration of hydrologic models integrated sensitivity analysis and parameter optimization algorithms can be developed to use parameter sensitivity indices to guide the parameter calibration process which can improve quality of optimized solutions and also computational speedup gain through avoiding duplicate model simulations seen in cases where sensitivity analysis and model calibration are conducted separately declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
25601,in recent decades parallel computing has been increasingly applied to address the computational challenges of calibrating watershed hydrologic models the purpose of this paper is to review these parallelization studies to summarize their contributions identify knowledge gaps and propose future research directions these studies parallelized models based on either random sampling based algorithms or optimization algorithms and demonstrated considerable parallel speedup gain and parallel efficiency however the speedup gain efficiency decreases as the number of parallel processing units increases particularly after a threshold in future various combinations of hydrologic models optimization algorithms parallelization strategies parallelization architectures and communication modes need to be implemented to systematically evaluate a suite of parallelization scenarios for improving speedup gain efficiency and solution quality a standardized suite of performance evaluation metrics needs to be developed to evaluate these parallelization approaches interactive multi objective optimization algorithms and or integrated sensitivity analysis and calibration algorithms are potential future research fields as well keywords parallel computing hydrologic model calibration optimization algorithms parallel speedup parallel efficiency 1 introduction watershed hydrologic models have been increasingly developed to study landscape processes such as runoff sediment and nutrient processes and to support landscape management however these models need to be calibrated to fit into specific conditions in a study area calibration is an iterative parameter adjustment procedure with which by comparing observed data with simulated results model parameters are optimized to better characterize processes conditions of the hydrologic system under study humphrey et al 2012 in the 1960s and early 1970s automatic methods for calibrating watershed hydrologic models emerged dawdy and o donnell 1965 chapman 1970 nash and sutcliffe 1970 these methods optimize model parameters by using either a likelihood function and a pre defined likelihood threshold or an optimization algorithm since automatic model calibration is a simulation and sampling based procedure it needs to carry out an efficient and sufficient search of the parameter space by evaluating a large number of parameter sets to identify the optimal ones which causes a significant computational burden efstratiadis and koutsoyiannis 2010 furthermore the computational burden is compounded by the multi objective nature of hydrologic model calibration which adds considerable complexity to the process efstratiadis and koutsoyiannis 2010 kollat and reed 2006 generally speaking working with a large number of parameters and multiple objective functions are the main reasons for a computationally demanding calibration process therefore various studies have focused on either decreasing the number of parameters or the number of objective function calls in model calibration for reducing the number of parameters researchers have used sensitivity analysis before model calibration to identify and remove insensitive parameters from the calibration muleta and nicklow 2005 liu and sun 2010 wu et al 2012 song et al 2013 surrogate models or metamodels have also been developed to simplify hydrologic models with fewer parameters chen et al 2017 meert et al 2018 gong et al 2015 xi et al 2017 however working with a limited number of parameters may lead to loss of important parameters in model calibration and consequently degradation of model accuracy decreasing the number of objective function calls is a fitness approximation strategy the idea is to use nonlinear classification methods such as artificial neural networks anns or support vector machine svm to create a classifier for assigning approximated objective function values to parameter sets instead of using actual values of the objective functions okkan and kirdemir 2020 liu and khu 2007 liu et al 2005 the effectiveness of the fitness approximation strategy depends on accuracy of the approximated model a time consuming learning process is still needed to obtain a highly accurate model also the approximated model is sensitive to size of the training data jin 2005 in short for either strategy of decreasing the number of parameters or the number of objective function calls both approaches deteriorate quality of optimized solutions which is the ratio between achieved solutions by the optimization algorithm and by some approximation methods zhang et al 2014 this divergence of computational efficiency and solution quality in model calibration calls for research advancement to speed up the calibration process concurrent with increasing quality of optimized solutions harada and alba 2020 in recent decade an interdisciplinary research direction is to tap into growing computing power to support hydrologic model calibration by applying parallel computing which links multiple computers processors to deploy a distributed computing system tang et al 2007 parallel computing makes improved use of centralized or parallel execution systems to reduce total computing time in parallel calibration algorithms this reduction in computing time which is also called parallel speedup gain can be observed when we compare their runtimes with their sequential version in addition to speedup gain that can be achieved by running simultaneous model simulations parallel computing provides the opportunity to improve quality of optimized parameter sets when comparing the solution quality of parallel calibration algorithms with their sequential counterparts this solution quality improvement can be explained by enhanced exploration exploitation of the parameter space which is enabled by running extra model simulations compared to the sequential version of the calibration algorithms huo et al 2018 harada and alba 2020 gonçalves et al 2020 semiromi et al 2018 showed that parallel automatic calibration of the hydrologic engineering center hydrologic modeling systems hec hms is superior to calibrating metamodels in terms of both processing time and solution quality parallel computing has been applied widely to various fields a recently published paper extensively reviewed parallel computational optimizations in operations research including the assignment problem the facility location problem and others schryen 2019 although parallel computing has increasingly been applied in calibration of watershed hydrologic models harada and alba 2020 her et al 2015 a systematic survey of these applications is lacking this paper addresses this knowledge gap by conducting a comprehensive review of parallel computing applications for calibrating watershed hydrologic models this paper serves the hydrologists who are challenged by the computational aspect of hydrologic model calibration and would like to explore parallel computing as a promising approach to address the challenges this paper also benefits computer science researchers working in parallel computing and looking for potential applications including hydrologic model calibration we encourage continuing interdisciplinary collaboration to further improve parallel computing for calibrating watershed hydrologic models or hydrologic modelling in general in the next section a parallel computing framework for calibrating watershed hydrologic models is developed in section 3 the proposed framework is applied to examine two approaches of parallelizing hydrologic model calibration based on randomly generated parameter sets or optimization derived parameter sets in section 4 we reflect on parallel computing applications of hydrologic model calibration to identify knowledge gaps and propose future research directions the paper ends with the conclusion section to highlight the key points elaborated in the paper 2 the parallel framework for calibrating atershed hydrologic models automatic calibration of watershed hydrologic models searches the feasible parameter space through iterative model simulations abbaspour et al 2007 and by using the inverse modeling im approach it identifies a set of optimal values for the model parameters to minimize model prediction errors tolson and shoemaker 2007 the im procedure is a simulation and sampling based process and it includes 1 input and observed data identification 2 parameter selection 3 model simulation 4 calculation and comparison of predicted responses with the observed data 5 parameter correction and 6 initialization of a new simulation milivojević et al 2009 at each simulation by using a different parameter set which is either the output of a random sampling based or an optimization algorithm the hydrologic model runs to obtain simulated responses these simulated responses are compared with the observed responses using the objective likelihood functions by considering a predefined threshold for the values of objective functions some parameter sets are selected as inputs for the uncertainty analysis in random sampling based algorithms or evolution by optimization algorithms thus at the simulation or iteration level either random sampling based algorithms can be used to generate the initial subsequent parameter sets randomly or optimization algorithms can be used for evolving the obtained parameter sets to create a new generation for the next iteration according to the calibration algorithms introduced above there are two approaches in the parallelizing calibration of hydrologic models the first approach is based on populations of parameter sets generated by random sampling based algorithms rouholahnejad et al 2012 zhang et al 2016 and the second approach is based on populations of parameter sets generated by optimization algorithms mostly metaheuristic optimization algorithms her et al 2015 kan et al 2016 although the counterpart of random sampling is the guided sampling since the behavior of guided sampling could be observed in metaheuristic optimization algorithms blum and roli 2003 in these algorithms sampling focuses on the areas of interest and converges towards the optimum solution by using learning tools we used optimization algorithms as the counterpart of the random sampling based algorithms a parallelization framework is critical to transforming an existing sequential calibration algorithm into a parallel version or developing a new parallel calibration algorithm based on literature in this field a parallelization framework for calibrating watershed hydrologic models fig 1 is proposed in this paper this framework has three main components including objectives of parallelization parallelization design and parallelization performance evaluation which are elaborated in the following sub sections 2 1 the objectives of parallelization computational speed and quality of optimized solutions considering the two aforementioned approaches in the parallel calibration of hydrologic models computational speed has two different definitions in parallel computing with random sampling based algorithms the computational speed is defined as the total execution time of running a specific number of model simulations to achieve a pre defined confidence level in parallel computing with metaheuristic optimization algorithms the computational speed is measured by the total execution time of running a required number of model simulations to obtain a high quality archive of optimized solutions for multi objective or the best optimized solution for single objective calibrations kavetski et al 2018 a high quality archive of optimized solutions is defined as a sufficient number of nondominated solutions that are preferably evenly distributed in the archive and they well converge to the global optimum solutions or the pareto front li and yao 2019 the best optimized solution which is also called pareto optimal solution is a unique solution that has either minimum or maximum value for the objective function given the above definitions the objective s of applying parallel computing for calibrating hydrologic models can be the improvement of computational speed only or both computational speed and quality of optimized parameter sets the improvement of computational speed only can be achieved by parallelizing model simulations among parallel processors in addition to speedup gain the improvement of solution quality is due to enhanced exploration exploitation of the parameter space enabled by running extra model simulations compared to the sequential version of the calibration algorithms the enhanced exploration exploitation of the parameter space can be achieved by using either multiple initial populations of parameter sets for a single optimization algorithm or single or multiple initial populations of parameters sets for multiple optimization algorithms therefore when using multiple initial populations and or optimization algorithms for calibrating a hydrological model in a parallel system we aim at improving quality of optimized solutions in addition to improving computational speed 2 2 the parallelization design parallelization strategies parallelization architectures and communication modes the parallelization design includes parallel component detection and creation in parallel component detection the calibration approach is identified while in parallel component creation the sequential calibration algorithm is modified and the program is transformed into the parallel model to carry out both tasks we need to define a parallelization strategy a parallelization architecture and a parallel communication mode 2 2 1 the parallelization strategies functional multi search and integrated multi search functional the parallelization strategy defines how a computationally expensive problem can be transformed from a sequential version into a parallel version based on specific parallelization objective s in cases where the objective of parallelization focuses on improving the computational speed efficiency of calibration algorithms an inter algorithm parallelization strategy also known as the functional parallelism strategy can be utilized this strategy improves the computational speed of calibration algorithms by parallelizing the most computationally expensive step s inside the calibration algorithm without changing the sequential algorithm logic structure in the calibration of hydrologic models running a large number of hydrologic model simulations to ensure the accuracy of the final calibrated parameter sets is the computationally expensive step the functional parallelism strategy supports distributing individual parameter sets to parallel computing units to conduct independent and simultaneous model simulations harada and alba 2020 individual parameter sets are considered as the parallel components of the functional parallelism strategy and both the initial and subsequent parameter sets could be generated using either random sampling based or optimization algorithms in cases where the parallelization has the objective of improving the quality of optimized solutions in addition to computational speed efficiency a large number of additional model simulations needs to be conducted compared to sequential counterparts to enhance the exploration exploitation of the parameter space considering this requirement two parallelization strategies have been developed for this purpose one strategy which is called multi search parallelism strategy emphasizes more on improving the quality of optimized solutions rather than computational speed efficiency while the other which is called integrated multi search functional parallelism strategy aims to strike a balance between improving the quality of optimized solutions and computational speed efficiency vrugt et al 2006 liao et al 2017 in the multi search parallelism strategy the parallel components are the initial populations instead of exploring exploiting one region of the parameter space using one initial population this strategy explores exploits different regions simultaneously by using multiple initial populations the hydrologic model simulations and fitness evaluation of parameter sets in each population are carried out sequentially which may be a barrier for further improving computational speed calaor et al 2002 the multi search parallelism strategy could be either dependent or independent a dependent multi search parallelization strategy is used if the evaluation algorithms which work with different initial populations exchange information on their best optimal solutions while an independent multi search parallelization strategy is utilized if the algorithms do not exchange this information harada and alba 2020 schryen 2019 evolving from the multi search parallelism strategy which may have tradeoffs between solution quality and computational speed the integrated multi search functional parallelism strategy aims to improve both solution quality and computational speed in this strategy not only initial populations but also individual parameter sets hydrologic simulations inside each initial population are parallel components harada and alba 2020 this strategy is supported by technology advancement of distributed multi processor and multi computer systems in these systems parallel computing units are identified as processing cores in a computer cpu adeleye 2017 multi computer systems have multiple parallel computers cpus and on each of them there are multiple processing cores the multi search parallelism strategy is used to parallelize multiple initial populations among multiple computers cpus and the functional parallelism strategy is implemented to parallelize individual parameter sets in each initial population among different processing cores on each computer cpu 2 2 2 the parallelization architectures master slave parallel island and parallel hybrid the parallelization architecture defines 1 the arrangement of processing units and 2 the direction of communications to from these units in a parallel system there are three types of parallelization architectures which are master slave parallel island and parallel hybrid architectures fig 2 a 2b and 2c in the master slave architecture one parallel processing unit serves as the master node while the rest of the units are slave nodes the master node 1 distributes tasks jobs to slave nodes 2 receives the results of parallel tasks jobs back from all slave nodes and 3 constructs the final output for the global problem regarding the direction of communications there are only communications from to the master node to from the slave nodes and the slave nodes do not communicate with each other fig 2a crainic and toulouse 2010 the master slave architecture is mostly used when working with a single population search algorithm while the parallel island architecture is developed for managing multiple populations search algorithms in separate islands an island in a parallel system is a separate processing unit with a separate initial population search algorithm the controller node is responsible for assigning parallel tasks to islands and receiving the results when they have finished processing their assigned tasks islands can either have communications among themselves to distribute required information global optimum solutions for each initial population or only have communications with the controller node to receive parallel tasks and send back the results fig 2b the parallel hybrid architecture is a combination of the parallel island architecture and the master slave architecture implemented in each island fig 2c hadka and reed 2013 2 2 3 the parallel communication models synchronous and asynchronous the parallel communication mode which could be synchronous or asynchronous characterizes the information solution exchange among parallel processing units the synchronous communication mode which is called rigid synchronous rs happens in the master slave architecture or the parallel island architecture without information exchange among islands in this communication mode to move towards an optimum solution fulfilling the goal of parallelization all parallel processing units must finish their assigned parallel tasks before the communication happens in fact the master node or the controller node waits until all parallel processing units send their results back to evaluate the results based on the evaluation it defines new parallel tasks to move one step further towards optimum solutions and assigns new tasks again to the processing units this procedure happens until the optimum solutions are found the asynchronous communication mode also called knowledge collegial asynchronous kc happens only in the parallel island architecture with communications among islands in this communication mode the controller node does not wait to receive all islands results before assigning new parallel tasks to finished islands and all the islands communicate with each other throughout the calibration process to exchange their most optimum solutions in fact the controller node defines the improved parallel tasks concurrently for all parallel processing elements and asynchronously by communicating with the other processing units each parallel processing unit improves its own assigned task these communications guide all the parallel tasks towards the most optimum solutions in the parameter space at the end schryen 2019 2 3 the parallelization performance evaluation parallel speedup parallel efficiency and solution quality parallelization evaluation uses three metrics which are parallel speedup parallel efficiency and solution quality to evaluate the parallelization performance yero and henriques 2007 the parallel speedup as a dimensionless metric is represented by the ratio of execution times of the parallel version and the sequential version the parallel efficiency is the ratio of parallel speedup to the number of processing units calaor et al 2002 the solution quality specifically refers to pareto approximations from optimization algorithms which is defined by cardinality a sufficient number of nondominated solutions convergence a good closeness to the pareto front diversity a good spread over the pareto front and uniformity the solutions should evenly be distributed in the set audet et al 2020 there are two options to evaluate the quality of solutions achieved by parallel optimization algorithms the first option is to conduct an uncertainty analysis to acquire the confidence level for the optimal solutions the second option is to compare the optimal solutions achieved from parallel optimization algorithm s i e pareto approximations with the best known solutions obtained from the sequential implementation of the same algorithm s i e pareto front harada and alba 2020 schryen 2019 3 parallel computing applications in calibrating watershed hydrologic models this section applies the proposed parallel computing framework to evaluate representative application cases that utilize parallel computing for calibrating watershed hydrologic models based on the framework we classify the application cases into two categories which are parallelization of random sampling based algorithms and parallelization of optimization algorithms 3 1 model calibration with parallel random sampling based algorithms in studies focusing on improving computational speed of calibration algorithms researchers have utilized uncertainty analysis methods such as the generalized likelihood uncertainty estimation glue beven and binley 2014 or sequential uncertainty fitting2 sufi2 abbaspour et al 2004 to conduct both model calibration and uncertainty analysis the idea behind this research direction is to calibrate hydrologic models by evaluating the error likelihood levels of various parameter sets and selecting the low error ones for model parameterization zhang et al 2016 for example in the sequential implementation of the glue method with random sampling strategy for calibrating watershed hydrologic models the monte carlo based model simulations are carried out and an error likelihood value based on the comparison of predicted and observed responses is assigned to each parameter set yang et al 2008 in fact after identification of the hydrologic model feasible space for model parameters input datasets observed data for the model variable s suitability threshold and the number of simulations a random sampling method such as the latin hypercube sampling method lhs in glue randomly generates a number of parameter sets equal to the number of simulations then in each simulation the hydrologic model is executed using one of the randomly generated parameter sets and an objective likelihood function such as the nash sutcliffe model coefficient efficiency nsce is calculated using the model simulated outputs and the observed data the error likelihood values are compared with a predefined threshold and if they are less than the threshold the corresponding parameter set is considered as a behavioral parameter set in the final step the parameter sets for model parameterization which has the lowest error likelihood level are selected by comparing the error likelihood levels of all behavioral parameter sets kan et al 2020 tang et al 2007 in implementing the glue method with a random sampling strategy for calibrating watershed hydrologic models running a large number of model simulations is the most computationally expensive step since the model simulations are carried out independently from each other we can use the functional parallelism strategy to parallelize individual parameter sets which are derived using a random sampling strategy therefore in parallel implementation of the glue method using the master slave architecture the master node sends out a parameter set to a slave node where the parameter set is plugged in the hydrologic model to carry out a model simulation then the likelihood function uses the simulated result and the observed data to calculate an error likelihood measure for the parameter set if the error likelihood measure is within an acceptable range using a pre defined threshold the behavioral parameter set and the model simulated value are sent back to the master node and the slave nodes will be waiting for receiving a new parameter set to conduct further model simulations fig 3 referring to the parallelization framework in fig 1 the functional parallelism strategy master slave architecture and rigid synchronous rs communication mode are used to parallelize a random sampling based calibration algorithm such as the glue method table 1 summarizes the studies on the parallelizing calibration of watershed hydrologic models based on randomly generated parameter sets the summary includes the source author date the purpose of the study utilized hydrologic model and distributed system with master slave architecture and findings speedup efficiency these studies typically followed the implementation as shown in fig 3 and the main objective of these studies was to speed up the calibration execution on a distributed computing system thus increasing the quality of solutions with enhanced exploration exploitation of the parameter space was not the focus of these studies all six studies in table 1 demonstrated a wide range of speedup gain in calibrating watershed hydrologic models by using parallel computing bacu et al 2011 reported the average time of executing 100 150 200 and 250 swat model simulations on a distributed system with 20 30 40 50 and 60 processing units varied from approximately 2 min 6 min per simulation while the execution time on a single processing unit was around 7 min rodila et al 2011 reported that the execution time of swat model calibration sequentially on a single processing unit took approximately one day 11 h and 30 min while parallelly on 24 processing units took 4 h and 15 min 15 267 s rouholahnejad et al 2012 reported a 1 9 speedup gain in calibrating the swat model using two parallel processing units vs a single processing unit zhang and chen 2016b reported a speedup gain range of 7 01 7 85 when increasing the number of parallel processing units from 1 to 8 for calibrating the swat model kim and ryu 2019 reported reduction rates of total calibration time by 76 89 89 and 90 for four different calibration scenarios yin et al 2020 reported the speedup ratio of 345 82 when the number of parallel processing units reached 400 for calibrating the xinanjiang model the observed wide range of speedup gain in literature reveals that the speedup of model calibration is a function of the number of parallel processing units in a distributed system thus parallel efficiency has been used to standardize the speedup gain relative to the scale of the distributed system for comparison purposes various studies reported parallel efficiency of less than 1 0 due to communication overhead in the system zhang et al 2016 reported a parallel efficiency of less than 1 0 when increasing the parallel processing units from 1 to 8 in swat calibration yin et al 2020 reported a decrease in the parallel efficiency by increasing the number of processing units 0 90 at 200 processes and 0 87 at 400 processes these results show that the parallel efficiency of functional parallelism strategy with a master slave architecture decreases as the number of parallel tasks surpasses the number of parallel processing units because of the communication overhead between the master node and slave nodes the findings have implications on the scalability of a distributed computing system for calibrating complex hydrologic models which needs a large number of simulations most likely the number of simulations will well exceed the number of parallel computing nodes furthermore this type of parallelization doesn t focus on improving the quality of calibrated solutions the knowledge gap has motivated researchers e g tang and reed 2006 semiromi et al 2018 to develop the parallelization framework for optimization algorithms focusing on improving the quality of solutions in addition to parallel efficiency 3 2 model calibration with parallel optimization algorithms in parallelization of hydrologic model calibration based on optimization generated parameter sets most researchers have used global optimization algorithms particularly meta heuristic optimization algorithms these optimization algorithms use population based stochastic search algorithms to generate a population of parameter sets e g janga reddy and kumar 2020 after hydrologic model simulations the parameter sets with objective function values within a pre defined range are exposed to various collective learning processes which are called metaheuristic techniques to get evolved step by step to converge to the global optimum these algorithms have several advantages 1 they use prior information which makes them outperform those methods without utilizing prior information 2 they do not need continuous response surface or any specific constrained sets 3 they are robust and flexible to be adapted to a changing environment 4 they can find global or near global optimal solutions especially in large and complex parameter space 5 they can balance diversification and intensification to avoid trapping in local optima and also to converge quickly and 6 they can deal with multiple objectives simultaneously janga reddy and kumar 2020 parallel optimization algorithms for calibration of hydrologic models can be implemented with a focus on either improving computational speed or improving quality of optimized parameter sets in addition to computational speed since the former objective is the same as the objective of the parallel random sampling based algorithms both approaches have the same parallelization framework the functional parallelism strategy rigid synchronous rs communication and master slave architecture fig 1 and implementation fig 3 the only difference in the parallelization implementation lies in the population generation methods in parallel optimization algorithms for calibration of watershed hydrologic models an optimization algorithm can be used to generate and evolve an initial population throughout numerous iterations more advanced implementation includes using a single optimization to generate evolve multiple populations or using multiple optimization algorithms to generate evolve multiple populations thus parallel optimization algorithms working on multiple populations compared to the ones working on a single population can achieve the objective of improving solution quality by enhancing exploration exploitation of the parameter space in addition parallel optimization algorithms show an improved computational speed or convergence speed when compared with their sequential counterparts in this parallelization implementation either a multi search or integrated multi search functional parallelism strategy and either a rigid synchronous rs or asynchronous kc communication mode can be used schryen 2019 in the multi search parallelism strategy parallel island architecture and in the integrated multi search functional parallelism strategy parallel hybrid parallelization architecture can be used fig 1 fig 4 shows the parallelization implementation of the multi search and integrated multi search functional parallelism strategies with parallel island and parallel hybrid architectures note that dependent multi search parallelism strategy needs knowledge sharing throughout the execution of parallel tasks thus it uses only asynchronous kc communication mode while the independent multi search parallelism strategy uses a rigid synchronous rs communication mode since parallel tasks do not need to share their found knowledge table 2 outlines the parallelization studies on calibrating watershed hydrologic models based on optimization derived parameter sets and it includes source author date purpose of study optimization algorithm and hydrologic model parallelization strategy parallelization architecture communication mode programming environment tools and distributed system and findings further assessment of these parallelization studies is provided in the following three sub sections 3 2 1 hydrologic models and optimization algorithms most of reviewed parallelization studies were based on the swat a process based model sharma et al 2006 milivojević et al 2009 zhang et al 2012 2013 yen et al 2014 her et al 2015 li et al 2015 or conceptual hydrologic models hreiche et al 2002 kan et al 2016 2018 liao et al 2017 huo et al 2018 semiromi et al 2018 most of these studies used the shuffled complex evolution metropolis scem ua algorithm sharma et al 2006 vrugt et al 2006 yen et al 2014 seong et al 2015 kan et al 2016 2018 and genetic algorithm ga tang and reed 2006 tang et al 2007 he et al 2007 milivojević et al 2009 zhang et al 2016a liao et al 2017 li et al 2015 only tang and reed 2006 tang et al 2007 zhang et al 2012 and zhang et al 2013 worked on parallelization of a multi objective calibartion problem based upon the studies listed in table 2 we observed that the range of hydrologic models and or the optimization algorithms in parallelization studies were limited and the development of parallel multi objective optimization algorithms for calibration of hydrologic models was inadequate although the calibration of hydrologic models is a multi objective task 3 2 2 distributed systems parallelization strategies and parallelization architectures among the 21 reviewed parallelization studies 9 studies hreiche et al 2002 sharma et al 2006 tang et al 2007 milivojević et al 2009 zhang et al 2013 tolson et al 2014 yen et al 2014 her et al 2015 semiromi et al 2018 used distributed systems with multi computer setting and 12 of them vrugt et al 2006 tang and reed 2006 he et al 2007 zhang et al 2012 2016a seong et al 2015 li et al 2015 kan et al 2016 2018 liao et al 2017 huo et al 2018 liu and zhou 2019 used distributed systems with multi processor setting however the integration of distributed multi processor and multi computer systems for increasing the level of parallelization was lacking in the literature as the majority of these studies focused on parallel speedup gain the functional parallelism strategy was mostly used hreiche et al 2002 vrugt et al 2006 sharma et al 2006 he et al 2007 milivojević et al 2009 zhang et al 2012 2013 yen et al 2014 li et al 2015 her et al 2015 seong et al 2015 kan et al 2016 2018 liao et al 2017 semiromi et al 2018 among these studies 14 of them used the master slave architecture and 11 utilized rigid synchronous communication mode the other studies didn t report the utilized parallel architecture and communication mode several studies focused on not only parallel speedup gain but also improving solution quality by running extra model simulations to enhance exploration exploitation of the parameter space compared to the sequential version of the same optimization algorithm in these studies the multi search parallelism strategy either dependent or independent has been implemented and compared with the functional parallelism strategy tang and reed 2006 tang et al 2007 tolson et al 2014 tolson et al 2014 compared the independent multi search parallelism strategy with the functional parallelism strategy using master slave architecture and rigid synchronous communication for both strategies they reported that the independent multi search parallelism strategy led to quicker convergence to solutions with improved solution quality when compared to the solution quality from the functional parallelism strategy and this parallelization strategy showed a super linear parallel efficiency tang and reed 2006 and tang et al 2007 compared the dependent multi search parallelism strategy using a parallel island architecture with the functional parallelism strategy using a master slave architecture with knowledge collegial communication modes for both strategies the results showed that the dependent multi search parallelism strategy achieved a smaller speedup gain than the functional parallelism strategy but it improved the reliability of the search dramatically tang et al 2007 reported that the functional parallelism ran 2 3 times faster than the dependent multi search parallelism in a parallel system with 8 and 16 processing units these studies showed that the independent or dependent multi search parallelism strategy has improved solution quality than that of the functional parallelism strategy but the speedup gain maybe smaller however these studies are not sufficient for developing a solid understanding of the pros and cons of the multi search parallelism strategy and the functional parallelism strategy in addition no studies compared the independent and dependent multi search parallelism strategies although the integrated multi search functional parallelism strategy has the potential to strike a balance between improving quality of optimized solutions and computational speed efficiency vrugt et al 2006 liao et al 2017 only huo et al 2018 implmented integrated multi search functional parallelism strategy by combining the independent multi search with the functional parallelism strategy using parallel hybrid architecture and rigid synchronous communication the quality of optimized solutions was not compared while the authors reported considerable reduction of the execution time and improvement of the parallel efficiency compared to the sequential version of the algorithm there are limited studies on implementing integrated multi search functional parallelism strategy studies and no studies on comparing the multi search parallelism strategy with the integrated multi search functional parallelism strategy 3 2 3 parallel speedup parallel efficiency and quality of optimized solutions all the reviewed studies reported a speedup gain in parallel implementation of watershed hydrologic model calibration in comparison to the sequential implementation however the parallel efficiency had a mixed pattern some papers reported a close to linear parallel efficiency until the number of processors equals the number of parallel tasks while other papers reported a sub linear parallel efficiency due to the additional communication overhead where the number of parallel tasks is close or above the number of parallel processors for example li et al 2015 reported a parallel speedup of 8 0 and a parallel efficiency of 88 9 in a parallel system with 10 processing units yen et al 2014 reported that the parallel speedup increased up to 11 when increasing the number of processing units from 2 to 12 hreiche et al 2002 reported an increase in parallel speedup from 1 9 to 30 0 in a parallel system while increasing the processing units from 2 to 40 liu and zhou 2019 reported an average of 3 22 parallel speedup in a parallel system with 4 processing units liao et al 2017 reported a speedup ratio from 2 to 12 when increasing the number of processing units from 2 to 16 kan et al 2018 reported a parallel speedup between 4 and 12 4 in a parallel system with 4 16 processing units her et al 2015 reported a parallel speedup from 1 to 6 for a parallel system with processing units increased from 2 to 8 seong et al 2015 reported that a parallel system with 2 and 4 processing units achieved 47 and 66 speedup gain respectively several studies reported a significant decrease in parallel efficiency after a threshold in the number of parallel processing units zhang et al 2012 reported an increase in the speedup ratio to 7 when the number of processing units reached 16 and after that speedup ratio was less than 2 zhang et al 2013 reported that by increasing the number of cores to 20 40 and 60 a speedup ratio from 19 to 36 and 46 was achieved however the parallel speedup saturated at 60 processing units and declined after that zhang et al 2016 reported that the speedup ratio reached 4 3 with 22 processing units but no speedup gain beyond that kan et al 2016 reported a speedup ratio ranging from 3 72 to 15 93 for a parallel system with 4 16 processing units beyond 16 cores the speedup ratio increase was very limited most of these studies identified shared cache and i o saturation as the main reasons for the decreasing speedup gain with increasing processing units zhang et al 2012 2013 yen et al 2014 in contrast to the parallel speedup and parallel efficiency there were very limited studies on comparing quality of optimized solutions obtained from parallel and sequential implementation of calibration algorithms in a study by tang et al 2007 quality indicators qis were used to quantitatively compare the solution sets by mapping solutions to real numbers to indicate the solution set s quality this study showed that the quality of optimized solutions in parallel calibration using the dependent multi search parallelism strategy is better than that of the functional parallelism strategy the unary hypervolume metric for measuring the convergence 0 1 lower value means higher convergence was 0 8 with 8 processing units in the functional parallelism strategy while it was 0 2 in the dependent multi search parallelism strategy the ε indicator for measuring the diversity of solutions 0 1 higher value means more diversity was 0 7 in the functional parallelism strategy while it was 0 9 in the dependent multi search parallelism strategy this study demonstrated that the dependent multi search parallelism strategy was able to attain better metrics for quality of optimized solutions instead of comparing the quality of optimized solutions obtained by parallel optimization algorithms vs sequential versions a study by semiromi et al 2018 evaluated quality of optimized solutions obtained by parallel computing vs metamodeling metamodeling is the use of surrogate models instead of computationally expensive models to decrease computational costs by using visualization techniques to demonstrate the quality of optimized solutions this paper showed that parallel computing led to better global optimum solution compared to metamodeling 4 discussion and future research directions in recent decades parallel computing has been gradually applied to address computational challenges in calibrating complex watershed hydrology models these studies started with parallelizing parameter sets generated by random sampling based algorithms to improve the calibration speed later on the research direction moved towards parallelizing parameter sets generated by optimization algorithms to improve calibration speed and quality of optimized solutions jointly through both simultaneous simulations and enhanced exploration exploitation of the parameters space while celebrating considerable progress on achieving these objectives we now identify several knowledge gaps and also discuss future research directions in parallel computing for calibrating watershed hydrologic models 4 1 standardizing the reporting on parallelization framework implementation and performance evaluation metrics the reviewed studies showed a diverse range of documentation on the parallelization procedure and outcome most of the studies reported speedup gain and parallel efficiency in parallel vs sequential implementation of the same algorithms however only a few studies reported metrics for measuring the quality of optimized solutions we would like to advocate standardizing the reporting of parallelization framework strategies architectures and communication modes implementation programming languages apis libraries etc and performance evaluation metrics speedup gain efficiency and solution quality more structuralized reporting can help researchers continue improving parallelization frameworks and develop approaches to enhance parallel optimization algorithms such as adaptive search methods or adaptive population sizes semiromi et al 2018 4 2 developing parallelization strategies for improving parallel speedup and efficiency while most studies reported parallel speedup gain the parallel efficiency exhibited a downward trend when increasing the number of parallel processing units particularly beyond a threshold equal to the number of parallel tasks this pattern is logical as communication overhead significantly increases when adding more processing units to parallel systems while this pattern persists there is a potential to optimize the parallel computing system to achieve maximum speedup gain under the technology constraints zhang et al 2012 indicated that the shared caches and i o delay influenced the efficiency of parallel optimization algorithms and future studies should work on optimizing cache use and i o operations to improve the utilization of distributed systems under the multi processor setting zhang et al 2013 stated that future studies should work on how the input data for hydrologic models should be organized in a high performance computing friendly format to address the i o and shared cache problems kan et al 2016 suggested a need for high memory requirements in systems with multi processor architecture thus one future research direction is to improve optimize the cache use and i o operations in systems with multi processor architecture such as using collective i o in multi core cluster systems cha and maeng 2012 or boosting the efficiency of the distributed systems with multi computer architecture such as using efficient parallelism strategies with a low level of communication requirements 4 3 developing parallelization strategies for improving both parallel speedup and solution quality huo et al 2018 stated that in the population based optimization algorithms large population sizes or multiple populations could reinforce diversity reduce unpredictability and improve solution quality however tang et al 2007 reported that the independent multi search parallelism strategy without knowledge exchange had a lower speedup gain compared to the functional parallelism strategy these limited studies show that although parallel computing has the potential to improve both execution speed and quality of the optimized solutions in calibrating watershed hydrologic models there exist tradeoffs between the two objectives further implementation of multi search parallelization strategies needs to be conducted to gain a more in depth understanding of the tradeoffs for example an encouraging research direction is to implement the dependent multi search parallelism strategy with knowledge exchange to achieve high quality solutions with lower execution times furthermore the integrated multi search functional parallelism strategy showed promises on striking a balance between speedup gain efficiency and solution quality vrugt et al 2006 liao et al 2017 in this research direction parallelization can couple multiple populations with multiple optimization algorithms to provide a simultaneous exploration of different regions of the parameter space using various searching tools optimization algorithms schryen 2019 in this regard various combinations of hydrologic models optimization algorithms parallelization strategies architectures and communication modes should be implemented to systematically evaluate a suite of parallelization scenarios for improving the speedup gain parallel efficiency and quality of optimized solutions in calibrating watershed hydrologic models for example the potential parallelization combinations that have not been implemented so far are the combination of dependent and independent multi search parallelism with functional parallelism for multi objective calibration problems with independent objective functions using parallel hybrid architectures it worth noting that although the optimization algorithm and the parallelization strategy are two factors in determining the parallelization architecture and communication mode most studies utilized the master slave architecture in parallelization thus future research can evaluate the implementation of parallel island and parallel hybrid architectures 4 4 developing parallel interactive multi objective optimization algorithms developing a precise multiple objective parameter optimization of hydrologic models has two approaches distribution assuming and imprecision propagating multi objective evolutionary algorithms da moeas and ip moeas da moeas assume normal distributions of the objective functions but the assumption does not apply to all objective functions therefore the imprecision propagating approach without the assumption of normal distribution has gained much attention sun et al 2011 using this approach interactive methods with interval input parameters have been developed to approximate objective functions without assuming normal distributions limbourg and salazar aponte 2005 these methods are called interactive since the objective functions parameters e g mean or variance for each case study should be calculated using observation datasets since the observation datasets have errors we use interval parameters based on statistical measures instead of absolute values when working with intervals we do not have solution dominance and instead we have interval dominance sun et al 2011 the parallel version of the algorithm not only accounts for the inherent uncertainty in calibrating watershed hydrologic models but also provides fast convergence and better quality optimized solutions thus one of the potential research directions is to develop parallel interactive multi objective optimization algorithms for calibrating watershed hydrologic models 4 5 developing parallel integrated algorithms for concurrent sensitivity analysis and parameter optimization sensitivity analysis serves to reduce the execution time of hydrologic model calibration by focusing on critical parameters for model optimization sensitivity indices obtained before model calibration could help decrease the dimensionality of multi objective calibration problems and maximize information extracted from observed hydrologic response data rodila et al 2011 however this approach causes extensive model simulations duplicated to the large number of simulations required for the model calibration process to address the duplication problem sensitivity indices could be obtained during and used by the model calibration concurrently by giving a high probability to value change of those parameters with more impacts on the model responses the sensitivity indices help guide search operators such as a mutation in metaheuristic optimization algorithms to the optimum solution in the parameters space li et al 2016 integrated the strength pareto evolutionary algorithm spea and spearman rank correlation coefficient srcc method for conducting integrated sensitivity analysis and model calibration their results showed that the integrated algorithm effectively improved the survivability competence of sensitive variables by changing the evolutionary parameters they also reported low computational costs compared to conducting sensitivity analysis and parameter optimization separately therefore one of the potential research directions is to develop further parallel integrated algorithms to carry out sensitivity analysis and parameter optimization at the same time and guide the parameter calibration process to achieve better quality optimized solutions however the sensitivity analysis methods that could be used for this approach are limited morris s method sobol s method fourier amplitude sensitivity analysis and extended fourier amplitude sensitivity analysis could not be used directly in the optimization process li et al 2016 because the randomness and unbiasedness are two basic properties of the samples for traditional sensitivity analysis methods but in the optimization process these methods provide biased samples that are tending towards the optimal set therefore in future studies on integrating sensitivity analysis with optimization algorithms the sensitivity analysis methods whose results are not influenced by the distribution of sample parameter sets used in those methods should be taken into consideration hamby 1994 li et al 2016 5 conclusion in recent decades parallel computing has increasingly been being applied to address computational challenges in the automatic calibration of watershed hydrologic models this paper develops a framework to conceptualize parallelization processes of calibrating hydrologic models applies the framework to evaluate representative parallelization studies identifies knowledge gaps and proposes future research directions our assessment shows that the total number of parallelization studies was still limited and most of these studies focused on improving speedup gain however the literature revealed a growing trend to improve the quality of optimized solutions through enhanced exploration exploitation of parameter space which is enabled by running an extra number of model simulations compared to the sequential version of the same algorithm we argue that parallel computing for calibrating watershed hydrologic models needs to be developed further in not only scope such as research on various combinations of hydrologic models optimization algorithms parallelization strategies parallelization architectures and communication modes but also depth such as improving solution quality in addition to speedup gain and efficiency besides further developments should benefit from standardized reporting on parallelization framework implementation and performance evaluation metrics expanding the scope of parallelization studies can be empowered by significant technology advancements in multi processor and multi computer systems which support parallelization concurrently for both populations of parameter sets and individual parameters to improve parallel efficiency in terms of the depth of parallelization studies multi search and integrated multi search and functional parallelism strategies can be developed to conduct single population model calibration with multiple optimization algorithms or multi population model calibration with multiple optimization algorithms to improve jointly parallel efficiency and solution quality furthermore interactive multi objective optimization algorithms using the imprecision propagating approach can be parallelized to integrate uncertainty analysis with calibration of hydrologic models integrated sensitivity analysis and parameter optimization algorithms can be developed to use parameter sensitivity indices to guide the parameter calibration process which can improve quality of optimized solutions and also computational speedup gain through avoiding duplicate model simulations seen in cases where sensitivity analysis and model calibration are conducted separately declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
25602,a process based nitrogen model suitable for urban stormwater best management practices bmps when used as an extension to current stormwater models can assist decision making by predicting nitrogen removal performances while such a model has not been created process based nitrogen modules for agricultural fields have been developed and applied in this paper the nitrogen modules in six agricultural models are reviewed in the perspective of assisting the development of a process based nitrogen module for stormwater bmps the agricultural nitrogen modules have consistent structures and mathematical descriptions of biochemical reactions but show more variety in incorporating environmental factors the operational challenges strengths and weaknesses of simulating stormwater bmps nitrogen removal performances with current models are illustrated with a case study finally suggestions on developing the process based nitrogen module for stormwater bmps are offered based on the review the case study results and the differences between the stormwater bmps and agricultural fields keywords simulation nitrogen agriculture urban stormwater bmps 1 introduction high concentrations or loads of nitrogen in stormwater runoff can cause eutrophication in downstream water bodies and severely damage ecosystems application of fertilizers and atmospheric deposition are major sources of nitrogen in rural and urban areas respectively katz 2020 a variety of stormwater best management practices bmps have been developed to manage urban runoff and nitrogen loads while the nature of agriculture systems may require different bmps livingston 1998 referred to as agricultural bmps than those designed for urban systems novotny 2010 referred to as stormwater bmps the inherent nitrogen fate and transport processes within each system are the same extensive research has been aimed at water quality control in stormwater bmps with the goal of discovering more stable efficient and cost effective engineering design principles nevertheless the nitrogen removal efficiencies obtained from laboratory and field tests of stormwater bmps are highly variable for different types of stormwater bmps reported removal rate ranges of ammonium n h 4 nitrate n o 3 and total nitrogen t n are 70 100 110 100 and 5 80 respectively koch 2014 due to the complexity of physical chemical and biological processes in the water soil or media air plant system as well as the typically incomplete measurement of environmental conditions of the stormwater bmps gavrić et al 2019 it is difficult to identify the cause of variance in nitrogen removal performances and thus even more difficult to make accurate predictions nitrogen simulations in current stormwater models remain limited indirect and coarse elliott and trowsdale 2007 jayasooriya and ng 2014 the hec hms hydrologic modeling system hydrologic engineering ce 2021 and mouse urban drainage and sewer dhi inc 1999 models do not include nutrient simulations in the p8 urban catchment model program for predicting polluting particle passage through pits puddles and ponds walker and walker 2015 water quality components are defined by their weight distributions across particulate size and dissolved nutrients are not simulated the winslamm model source loading and management model pitt and voorhees 2004 simulates both dissolved and particulate nutrient loads but sediment settling is the only described pathway for nutrient removal bmps are not directly represented but estimated with hydraulic nodes or detention ponds in basins better assessment science integrating point and non point sources u s epa 2019 nitrogen simulation is limited to nitrogen concentrations in surface runoff and within the sewer systems other models including swmm storm water management model sustain system for urban stormwater treatment and analysis integration and music model for urban stormwater improvement conceptualization rossman and huber 2015 tech 2012 wong et al 2002 directly represent bmps and use percent reduction or 1st order kinetics to describe decay of dissolved nitrogen transformations among nitrogen forms are not considered none of these stormwater models involve process based nitrogen simulations some stormwater models are reported as process based tech 2012 wong et al 2002 liu et al 2014a but that is with respect to hydraulic processes and they do not involve biokinetics of nitrogen transformations a process based nitrogen module when used as an extension to current stormwater models can better assist decision making by predicting nitrogen removal performances according to bmp designs and environmental conditions such a module could support systematic design improvements for bmp water quality performance and may also help us understand the complex correlations among nitrogen transformation and transportation processes liu et al 2014b to our knowledge however such a model has not been reported the development of a process based nitrogen model for stormwater bmps will require 1 integrating the nitrogen cycling processes 2 mathematically representing nitrogen related processes in appropriate detail 3 determining parameter values and assessing their sensitivity simulation of nitrogen transportation and transformation in the agricultural systems is significantly more advanced than that in the urban systems as many processes based agricultural models have been developed and successfully applied thomas 2013 though these agricultural models should not be directly applied to stormwater bmps due to the differences in hydraulic conditions soil media properties artificial management spatial and temporal resolutions etc advances made in previous models of nitrogen related processes in the agriculture fields may be leveraged to guide the development of a nitrogen model for stormwater bmps 2 method and materials in this paper nitrogen modules in six agricultural models are reviewed and compared to the lid low impact development module of storm water management model swmm rossman 2015 swmm is selected as a representative for current stormwater models because a it is widely applied b it includes well developed lid modules to represent design features of a range of bmps c it clearly states its math equations in easily available user manuals and d it already includes rudimentary water quality routines the six agricultural models as noted in table 1 are selected for this review based on the availability of mathematical descriptions of their nitrogen modules the drainmod n ii hereafter referred to as drainmod model refines drainmod n s simulation of ammonium the extended soil and water assessment tool swat n was developed by adjusting the nitrogen module in the original soil and water assessment tool swat to that of the de nitrification and de composition dndc model as epic dndc and swat n are reviewed here it is deemed unnecessary to include the original drainmod n and swat models section 3 reviews the simulated processes basic assumptions and simplifications as well as the mathematical descriptions of the most relevant nitrogen related processes of the selected agricultural nitrogen modules to investigate the feasibility and potential problems of directly applying agricultural models to stormwater management bmps section 4 presents the results of a case study where drainmod and swmm are used to simulate the nitrogen removal rates from a study of stormwater bioretention finally the implications on developing the nitrogen model for stormwater bmps are discussed in section 5 it should be noted that the mathematical symbols used in this review might be different from the references unified symbolics are used for easier comprehension and comparison among models among references the same variable may be described in different units due to the variations of dimensions spatial resolutions and habits of developers given that the physical quantity described remains the same the units of physical quantities are not specified in this paper for the sake of simplicity 3 comparison of the nitrogen modules 3 1 general information table 1 presents general information about the agricultural models plus swmm the temporal and spatial resolutions differ among models there is a significant difference in time steps between the agricultural nitrogen modules and the swmm lid module dndc can take an hourly time step during wet periods while the other agricultural nitrogen modules use a daily time step agricultural models often simulate periods longer than a season or a year and accurate predictions of hourly nitrogen losses from agricultural fields are not required the time step in swmm can be as small as per second in terms of spatial resolution all reviewed modules can operate site scale simulation in which the vegetation management practices weather conditions and soil characteristics are homogeneous regional simulation on the other hand simulates sub catchments with different soil characteristics crops weather conditions and land management simultaneously all models include basic hydrological processes of precipitation and evaporation while the agricultural models include irrigation run on the addition of surface runoff to the site a critical process for a bmp model is included in iwss swat n and swmm when infiltration rates are smaller than precipitation or irrigation rates runoff surface water exiting a site would occur and can be represented in epic iwss drainmod and swmm for subsurface hydrology epic and swat n simulate both lateral and vertical flows of infiltrated water swmm can simulate lateral discharge of infiltrated water on a regional scale but within a bmp infiltrated water either leaches vertically into the subsoil below a bmp or into an underdrain the remaining four models calculate only vertical water flow most of the agricultural models represent leaching vertical water flow below the root zone among all agricultural models only drainmod simulates artificial subsurface drainage in agricultural models users divide the soil profile into horizontal layers of different thicknesses the description of soil stratification is both more detailed and more flexible than swmm to accommodate the wide diversity of agricultural soils and to allow the calculation of crop growth with root depth data and corresponding water deficits soil moisture and water fluxes are reported for each layer conversely in swmm hydraulic characteristics are assigned to different major stormwater bmp layers such as the soil media and gravel sumps moisture content is assumed to be uniformly distributed throughout the total media layer and reported as the average soil moisture of the total soil column precipitation surface run on flow through an underdrain subsequently referred to simply as drainage leaching into the soil below the bioretention system and surface runoff are reported for the simulated bmp system 3 2 nitrogen module structures 3 2 1 sources and sinks of nitrogen table 2 lists the reported sources and sinks of nitrogen in the 7 models various water flows precipitation runoff run on drainage and leaching may transport dissolved nitrogen species and in some models nitrogen associated with sediment transport can be simulated as epic dndc and drainmod only perform site scale simulations the simulated soil can t be divided into sub catchments and surface run on can t be calculated dndc does not consider surface runoff surface runoff and run on are not calculated by wnmm despite its ability to do regional simulation because the model was developed for the north china plain where the topography is flat in the reviewed models organic and inorganic fertilizers enter the soil in the form of large organic molecules urea and or ammonium n h 4 plant residues supplement the soil with fresh organic matter fom and fresh organic nitrogen fon through tillage where fom and fon are evenly mixed in the soil to a given depth nitrogen fixation which refers to the process in which nitrogen gas n2 is reduced to ammonia nh3 and enters the soil hanrahan and chan 2005 is only calculated to maintain nitrogen mass balance and its detailed biochemical processes are neglected wet deposition represents inorganic nitrogen inn input directly to the simulated soil during rainfall while dry deposition occurs between precipitation events inn input through wet and dry deposition is usually simulated in the form of nitrate n o 3 deposition rates are estimated with average rainwater concentrations and annual dry deposition the two nitrogen sources simulated by all agricultural models are plant residue and fertilization unlike agricultural fields fertilizers are rarely applied to stormwater bmps and plant residues are often removed as unwanted nitrogen sources thus swmm simulates only three sources surface run on the primary source for a bmp wet deposition and dry deposition nitrogen simulation in swmm is primarily tracked through the transport of water simulated water flows include surface run on precipitation leaching drainage and surface runoff time series of nitrogen concentrations in these water flows are reported within a bmp multiple nitrogen species can be simulated as independent contaminants but transformation among nitrogen species is not applicable for each nitrogen species a simple percent removal can be applied to a bmp where the nitrogen concentration exported through drainage and leaching is a constant percentage of the nitrogen concentration in well mixed inflows rossman and huber 2016 neither nitrogen mass balance nor biochemical mechanisms are considered for all agricultural models nitrogen plant uptake is simulated in detail as it directly affects crop yields ammonia volatilization is also carefully calculated in all agricultural models except for epic as it accounts for up to 60 of applied inorganic fertilizers sunet al 2020 epic assumes that ammonium in the soil is instantly oxidized to nitrate and thus ammonia volatilization is not simulated inn dissolved in the surface runoff and organic nitrogen orgn carried by sediments are often neglected dndc iwss and wnmm report nxoy emissions during both nitrification and denitrification processes while swat n only calculates nxoy emission during nitrification 3 2 2 nitrogen transportation and transformation fig 1 summarizes the nitrogen transportation and transformation processes in the reviewed agricultural models except for epic in each agricultural model nitrogen concentrations in its simulated water flows are reported as stated the structure of the epic nitrogen module is more unique as it omits ammonia agricultural models except for epic calculate nitrogen transformations among three pools organic nitrogen orgn ammonia nitrogen nh 4 n and nitrate nitrogen no 3 n to avoid confusion som in this paper refers to the sum of all organic substances in soil and the term organic carbon orgc refers to the organic carbon content in the soil with subscripts describing the form of organic compounds as shown in fig 1b decomposition immobilization nitrification denitrification and plant uptake are the key bio chemical nitrogen transformation processes to clarify decomposition refers to the process where organic matter is degraded resulting in the release of carbon dioxide and inn immobilization refers to inorganic carbon and inn uptake by microorganisms for cell growth support and is the general description of microbial uptake assimilation and resynthesis in summary agricultural models are very similar in terms of the simulated sources sinks and cycling of nitrogen in comparison swmm considers the nitrogen sources and sinks that are more suitable to stormwater bmps but does not include process based nitrogen cycling simulation in reality there are significant differences in soil hydraulic characteristics management objectives nitrogen sources and sinks soil nitrogen content and effluent total nitrogen tn concentrations between agricultural field and stormwater bmps sunet al 2020 tirpak et al 2021 while the key biochemical processes in the nitrogen cycle can be similar in the two soil systems gold et al 2019 thus to establish a process based nitrogen model suitable for stormwater bmps it is necessary to refer to the nitrogen pool division and nitrogen transformation processes in the agricultural models and also consider surface runoff surface run on sediment transport removal of plant residues along with the rare use of fertilizers in stormwater bmps in section 5 we provide specific recommendations regarding the structure of a suitable process based stormwater nitrogen module 3 3 simulating nitrogen transformation processes in this work mathematical expressions used to simulate nitrogen transformation processes in agricultural nitrogen modules are modified for easier comparison the swmm lid module is not included because none of the biochemical transformations are simulated and nitrogen removal is calculated with a percentage of removal see in section 3 2 1 equations for decomposition nitrification and denitrification are listed in table 3 detailed explanation of all math symbols used in this review are given in the appendix table a1 in short c p and n p refer to changes of carbon and nitrogen over time respectively with the subscript indicating the relevant process dec decomposition nit nitrification and den denitrification k p is an optimal rate constant which may be reduced by a comprehensive environmental factor f en due to deficient environmental conditions f en can be calculated with specific environmental factors including soil saturation rate soil temperature soil ph soil orgc content and c n ratio of organic matters the original environmental factor of clay content in dndc is not listed in table 3 but reformed to a factor of oc as detailed in the appendix as clay tends to slow down the decomposition process by absorbing organic matters zhao et al 2018 the equations used to calculate these factors are further discussed in section 3 5 nh 4 no 3 n a o b and tno are concentrations of ammonium nitrate species of nitrogen oxides and total nitrogen oxides in dndc and iwss the denitrification rate is influenced by the growth and abundance of denitrifying bacteria b d e n refers to the total denitrifying biomass μ y and m describes the growth and decay rate of denitrifying bacteria and vary with nitrogen oxide species 3 3 1 decomposition as biological transformations of carbon and nitrogen during decomposition are simultaneous and intertwined nitrogen transformations in these processes are often calculated based on the carbon cycle as is shown in table 3 in all agricultural models except for epic inorganic carbon released from decomposition c dec is first simulated with first order reaction dynamics the amount of released inn n dec is then calculated with carbon to nitrogen ratio of the decomposed organic matter cnr the value of optimum reaction rates and cnr are different among various som sub pools most agricultural models assume constant cnr values in each sub som pool with the only exception of drainmod which recalculates cnr in sub pools at each time step n dec is then added to the ammonia pool in epic inn is directly released in the form of nitrate as there is not an ammonia pool and the amount released is calculated based on organic nitrogen 3 3 2 nitrification and denitrification both nitrification and denitrification are general terms of a series of complex biochemical reactions nitrification refers to the process in which n h 4 is oxidized to n o 3 by aerobic bacteria shah 1978 and denitrification refers to the process in which denitrifying bacteria absorb n o 3 as the electron acceptor under hypoxic or anaerobic conditions and successively reduce the valence of nitrogen from positive five to zero products of denitrification include n o 2 no n 2 o and n 2 coyne et al 2008 nitrification and denitrification rates have been fitted with zero order reaction kinetics michaelis menten functions or first order reaction kinetics igielski 2019 halaburka et al 2017 in agricultural nitrogen modules nitrification and denitrification rates are described by either the first order equation or the michaelis menten function in the michalis mention function the described process behaves as a first order reaction when the substrate is limited and gradually changes to a zero order reaction with increasing substrate concentrations it is also shown in table 3 that environmental factors are integrated with optimal reaction rate k x in various ways for example the environmental factors f s f t and f p h are directly multiplied with k x in drainmod but are exponentially related to k nit in wnmm as these environmental factors are described with empirical functions in various forms discussed in detail in section 3 5 their impacts on nitrogen transformations can be complex and their sensitivity can only be analyzed with actual simulation results it is worth mentioning that agricultural nitrogen modules take different strategies to describe the significant impact of soil moisture on the denitrification rate dndc and iwss switch between a dry weather submodule where denitrification is not calculated and a wet weather submodule where denitrification is the only biochemical process simulated the wet weather submodule is switched on as the rain events start and is switched off when saturation rate in the top 20 cm soil drops below 40 or after 10 days since the rain event under the wet weather submodule the growth rate of denitrifying bacteria is calculated with the michaelis menten function with two substrates nitrogen oxide and organic matter and the denitrification rate is influenced by the denitrifying biomass the bacteria growth rates total biomass and reaction rates in each step of denitrification are calculated separately in epic denitrification only occurs when the saturation rate is over 90 and the real time reaction rate is not calculated with the soil moisture factor the wnmm model sets the threshold to 80 saturation and the denitrification rate increases exponentially with higher soil moisture content in drainmod the threshold of denitrification is expressed with the soil moisture factor f s which has a value of 0 0 when soil moisture drops below a user defined threshold this would result in a value of 0 0 for the denitrification rate in swat n the value of f s and denitrification rate changes significantly over the range of soil moisture content but does not drop to 0 0 3 3 3 immobilization immobilization is of great importance in the soil nitrogen cycle because it not only affects the mass balance of inn pools in the current time step but also influences the decomposition rate in the next time step by changing the availability of decomposable som similar to decomposition nitrogen flux of immobilization is generally calculated based on carbon transformations although the exact forms of mathematical equations can vary significantly due to the different divisions of sub som pools the basic procedures can be generalized as a calculate immobilized carbon c imm as a fraction of c dec b calculate immobilized nitrogen n imm according to cnr of the entering som sub pool and c imm c represent the restrictions of inn availability on immobilization the math equations used to calculate nitrogen immobilization are summarized in table 4 in this table n i m m fr refers to flat residues in the agricultural field np refers to nitrogen content in crop plant with subscripts indicating parts of plant fr in crop residues and simulation date day currently simulated day of the year day 1 the previous day e m i c r o is an empirical efficiency coefficient of microbial assimilating c d e c and α i m m is a mass fraction of immobilized carbon over c d e c in epic net nitrogen immobilization is directly proportional to n dec dndc and iwss divide som into 3 sub pools residues biomass and hummus and each of the sub pools is divided into two components the active and stable components c imm and n imm that enter each component are calculated with total c dec from all sub pools constant empirical fractions and constant cnr values c imm and n imm would drop to the available inn content when inn is insufficient the entire biomass sub pool is subject to decomposition it is worth mentioning that the aerobic biomass evolved in decomposition and immobilization is different from the denitrifying biomass b den and their mass balances and growth rates are calculated separately in the dry and wet weather submodules respectively wnmm has the same division of som as dndc but decomposition only occurs in the active hummus component and all immobilized carbon and nitrogen contribute to active biomass active living biomass decays to stable dead biomass and then degrades back to active hummus through first order kinetics as shown in table 4 nitrogen demand for immobilization is set to a constant fraction of decomposition derived carbon 0 048 this calculated amount is then compared to the actual inn released through the decomposition process as som in sub pools with different cnr values change over time n imm can be positive or negative representing net decrease or increase of the soil inn pool instead of immobilization swat n calculates ammonification ammonification can be taken as the reverse of the immobilization process and is the result of som decomposition from 3 organic litter pools very labile labile and stabile growth and decay of microbes from 2 microbes pools labile and stabile and decomposition of som from 2 humic pools labile and stabile nitrate is reduced to ammonium when ammonium is depleted the equation listed in table 4 for swat n is reformed and simplified further details on equations describing microbe growth and decay can be found in li et al li et al 1992 li 2000 in drainmod total som is divided into 8 sub pools including 4 litter pools describing plant residues and animal waste surface metabolic litters soil metabolic litters surface structural litters and soil structural litters 3 soil biomass pools active slow and passive and 1 surface biomass pool carbon and nitrogen flows from litter pools to and transform among the biomass pools as shown in table 4 the cnr values of organic matters synthesized into each sub pool change with inn availability c n r m a x and c n r m i n are the maximum and minimum cnr values entering a certain som sub pool i n n m a x is the inn content that is adequate for synthesized organic matter to enter the som sub pool with c n r m a x 3 3 4 plant uptake in all agricultural nitrogen modules plant uptake is a major sink of inorganic nitrogen in the soil in all reviewed agricultural models nitrogen plant uptake is simulated with a demand versus supply method available math equations describing plant nitrogen demand n p d e are summarized in table 4 n p o p t d a y n p o p t d a y 1 n p a c t d a y and n p a c t d a y 1 refer to optimal and actual nitrogen concentration in plants at currently simulated or the previous day of the year subscripts also indicate the part of plant grain shoot and root p b is the plant mass m a s s a r e a 1 y l d h i and r s r are crop yield m a s s a r e a 1 plant harvest index dimensionless and the root to shoot ratio of plant at maturity dimensionless respectively in dndc plant uptake is only considered in the dry weather module and is estimated based on average nitrogen uptake rate crop type and seeding date the crop growth module in iwss is adapted from epic epic wnmm and swat n use the same equation to calculate n p d e which is the difference between optimal nitrogen content in plant biomass at the current simulated day and the actual nitrogen content in plant biomass at the previous day drainmod adapts a slightly different approach where nitrogen contents in various parts of plant are considered inn supply is decided by inn content in soil layer plant water uptake and diffusion of inn and is further relevant to the growth of plant roots the equations for inn supply are further referred to earlier models and literature neitscharnold et al 2011 johnsson et al 1987 jones 1983 when the supply of inn is not sufficient to support plant uptake demand a nitrogen stress factor is calculated based on the ratio of actual plant nitrogen content to the optimal value the nitrogen stress factor decreases nonlinearly as inn availability decreases and will constrain plant growth rates fixation can occur if legumes are present the upper limit of the fixation rate is set to 2 0 kg n hectare 1 day 1 in epic swat n assumes that n o 3 is preferred to n h 4 by plants and inn is taken from the ammonium pool only when the nitrate pool is depleted dndc and drainmod assume equal preference by plant between n o 3 and n h 4 3 4 gas emissions nxoy are byproducts of nitrification and denitrification rassamee 2011 dndc and iwss report n2o and n2 emissions wnmm reports only n2o emission in swat n the partition between n2o and no is not calculated nxoy emission is not reported in other models as shown in table 5 nxoy emissions can be estimated with either empirical formulas or first order reaction kinetics n h 4 x and n h 3 x represent ammonium and ammonia content with subscript indicating the phases they are in a d and d are the adsorption and diffusion coefficients as noted earlier f are the environmental factor parameters with subscripts indicating the specific environmental factors and the relevant biochemical reactions the environmental factors are described in section 3 5 in wnmm dndc and swat n ammonia volatilization is calculated in each horizontal layer while in drainmod volatilization only happens in the soil surface layer ammonia volatilization is the result of multiple physio chemical equilibriums as shown in equations 1 3 1 n h 4 l n h 3 l h 2 n h 3 l n h 3 g 3 n h 4 l n h 4 s soil characteristics and environmental factors that impact these equilibriums include soil cation exchange capacity cec tortuosity soil temperature soil ph and wind speed despite the complexity of this three phase equilibrium system many of these listed parameters are neglected by the nitrogen modules as they are often constant over time as ammonia volatilization in an acidic environment is slow its simulation is designed as optional in drainmod when soil ph is higher than a user defined threshold default at 7 5 the gas diffusion is driven by the concentration gradient of ammonia between pores and the atmosphere when soil ph is below the threshold ammonia content is assumed to be 0 0 and ammonium partitions between the solid and aqueous phase wnmm was developed for fields with stable ph of around 8 5 and thus the impact of soil ph on ammonia volatilization is not considered 3 5 mathematical expressions for environmental factors the equations used to describe the impacts of environmental factors in the agricultural nitrogen modules are mostly empirical and take a variety of forms detailed equations are listed in table a2 in the appendix the value of each environmental factor is estimated under the assumption that other environmental conditions are optimum for the related biochemical reaction in reality multiple environmental conditions may change simultaneously and have a collective effect that can t be precisely calculated by simply multiplying the estimated factors this estimation approach however is still widely applied for simplicity soil temperature the soil temperature factor f t has a value of 1 0 at the optimum soil temperature or in the optimum soil temperature range and decreases linearly or exponentially when above or below this optimal value the optimum soil temperature varies with biochemical reactions user defined optimum soil temperature ranges are required by drainmod and swat n the soil temperature profile is determined based on the annual average soil temperature daily air temperature and the average depth of the soil layer according to williams et al 1984 saturation the impacts of soil water content on biochemical processes are more complex forms of equations applied include exponential equations first order second order and fourth order linear equations user defined optimum ranges of saturation rate for decomposition and nitrification together with a user defined threshold for denitrification are required by drainmod as previously discussed dndc and iwss switch between the wet and dry submodules denitrification is not simulated in the dry submodules and soil moisture is not a limiting factor in the wet submodules soil ph in drainmod reaction rates decrease exponentially with the increasing deviation of soil ph from the user defined optimum range in swat n the soil ph factor is fitted with a second order equation empirical linear equations are also adopted in dndc and wnmm soil ph changes with fertilizer application plant uptake and nitrification and is modified by soil buffering capacity cnr the carbon to nitrogen ratio of organic matters cnr can be an important environmental factor for decomposition as stated in section 3 1 most models set constant cnr values for their organic pools in drainmod cnr values change over time as a result of decomposition immobilization and additional supply of som when calculating the cnr factor f c n r dndc uses the ratio of inorganic carbon to inorganic nitrogen instead of cnr in organics organic carbon due to the complexity and variability of som chemical components this environmental factor is not directly calculated from orgc content instead it is implicitly estimated with soil bulk density clay content and soil depth in epic dndc iwss and drainmod respectively the vertical distribution of orgc is not described in the wnmm model but the developers acknowledge that this simplification may lead to errors 3 6 nitrogen transportation in all agricultural models nitrogen transport is solved with the assumption that partition and dispersion equilibriums are achieved instantly at the beginning or end of each time step nitrogen transformations are calculated using substrate concentrations either after or before transportation though actually transformation and transportation happen simultaneously the model developers deemed the error caused by this assumption acceptable for these agricultural models with daily time steps the concentrations of inn transported by water flows can be calculated with the advection dispersion reaction equation equation 4 this function is numerically solved for n h 4 and n o 3 in drainmod 4 t θ l c l θ g c g ρ b c s z θ l d l c l z θ g d g c g z v l c l z s o alternatively empirical formulas can be used in wnmm the calculation of n h 4 transportation through leaching n h 4 l o s s kg n ha 1 day 1 is simplified to an empirical equation equation 5 5 n h 4 l o s s w n h 4 1 exp q f c where wnh4 is the total weight content of n h 4 in the soil layer kg n ha 1 fc is field capacity and q is the total leached out water m day 1 epic uses a similar empirical equation for n o 3 transportation equation 6 6 n o 3 l o s s w n o 3 1 exp q u l where wno3 is the total weight content of n o 3 in the soil layer kg n ha 1 and ul is the upper limit of water storage on top of calculating inn concentrations in soil water swat n uses a constant fraction to divide each nitrogen pool into mobile and immobile fractions only mobile nitrogen can leave the system through surface runoff lateral subsurface flow and leaching into deep groundwater as shown in table 1 only epic calculates orgn losses with sediment transport it is calculated with an empirical equation regulated by sediment production and organic nitrogen concentration in the topmost soil layer 4 simulation case study to more directly compare the simulations of nitrogen related processes in stormwater bmps two bioretention systems of varying designs as reported by lopez ponnada et al lopez ponnada et al 2020 are simulated with drainmod and swmm drainmod is selected for this case study because it is the only reviewed agricultural model that simulates drainage through underdrains that are commonly used in bioretention systems furthermore this capability is critical for this case study since the volume of and nitrogen concentrations in the drainage water are the main objectives of model calibration the calibrated nitrogen removal rates are compared to illustrate differences in simulation accuracy between the two types of models other operational challenges in simulating bioretention systems with agricultural models and swmm are also summarized detailed information on bioretention design soil and media characteristics weather conditions and inflow contaminant concentrations are recorded in the published reference article lopez ponnada et al 2020 in short two experimental scale bioretention systems 122 cm length 45 7 cm width were created they each received and treated natural and artificial rainwater over the years of 2016 and 2017 this dataset is selected for the following reasons a it compares bioretention systems with and without an internal water storage iws zone of submerged media which may enhance denitrification lopez ponnada et al 2020 wang et al 2018 b it compares bioretention systems with and without plants c it studies real bioretention systems influenced by the environmental factors changing over time and d it reports event mean removal rates of n o 3 n h 4 and tn over a comparatively long period of time there is still a lack of information that can lead to inaccurate simulation results including the hydraulic characteristics of the bioretention systems and their layers the initial tn and som content in the bioretention systems the accurate date of artificial stormwater inflow and the nitrogen concentrations in water flows including surface run on wet deposition surface runoff and drainage of natural rain events the aim of this modeling work however is to compare the general performance of the two modeling tools rather than to accurately simulate and predict nitrogen removal rates of the specific bioretention systems the dataset is hence deemed appropriate 4 1 simulating contributing run on the structures of the conventional and modified bioretention systems are shown in fig 2 in each artificial rain event a known volume of artificial stormwater that contains 1 0 mg l n o 3 n 1 0 mg l n h 4 n and 1 0 mg l orgn is directly applied to the bioretention systems the artificial stormwater is made of tap water and added chemicals and contains no sediment all artificial stormwater infiltrates into the bioretention systems and flows out through the drainage pipe the sides and bottom of the bioretention systems are otherwise sealed nitrogen concentrations in the drainage were measured to calculate removal rates during natural rain events the bioretention systems receive rainwater from the nearby impervious contributing catchment the bioretention systems are assumed to occupy 5 of the catchment area stormwater quantity and the quality of natural rain events were not recorded thus for this case study natural rain events are simulated based on local weather records of precipitation and air temperature noaa national water info 2021 to simulate these systems in swmm stormwater generated from a contributing sub catchment is directed to a lid sub catchment that is 100 occupied by a bioretention cell time series of natural and artificial precipitation are applied to the two sub catchments as drainmod does not support the simulation of sub catchments with different soil profiles and weather conditions a drainmod model describing surface run off from the contributing catchment is needed a separate drainmod model is established for hydraulic simulations of the contributing catchment the reported surface runoff from this first drainmod model is used as the input time series of run on for the drainmod bioretention models 4 2 calibrating hydraulics of the conventional and modified bioretention systems swmm simulation as the detailed soil characteristics were not reported in the field study the conventional bioretention is simulated with parameter values suggested by the swmm help file the value of hydraulic conductivity of the sand layer is adjusted to the minimum value that avoids surface runoff from the bioretention system during artificial rain events the swmm lid module cannot directly describe the submerged layer in the modified bioretention although the elevation of the drainage pipe can be raised in swmm it is not clear from the reported data whether the stormwater flows down into the internal storage layer before being drained whether stormwater mixes with old water retained in the modified bioretention after the previous event would significantly influence the nitrogen concentrations in the drainage therefore to approximate the modified bioretention in swmm the drainage of the lid sub catchment is directed to a storage unit with the same volume as the maximum water content of the submerged layer the reported precipitation of the lid sub catchment and the drainage of the storage units are used to calculate the nitrogen removal rates for the modified bioretention drainmod simulation while drainmod simulates artificial subsurface drainage from agricultural fields the piping systems of bioretention systems may violate the drainage assumptions used in the agricultural system especially when the iws zone is used nevertheless simulation of the drainage from the conventional and modified bioretention systems with drainmod was achieved indirectly through calibration of the soil water characteristic curve green ampt infiltration curve and the water table volume drained upward flux curve based on available references todd and mays 2004 twitty and rice 2001 the bioretention systems are assumed to be homogeneous to simplify the calibration process the soil characteristic curves are calibrated to achieve complete infiltration of all artificial stormwater hydraulic performances of the conventional bioretention are approximated by keeping the simulated depth of the water table at the depth of the drainage pipe for the modified br hydraulic conditions are approximated by keeping the simulated total soil column saturation at around 68 after rain events which is the average saturation rate of the total column when the iws layer is saturated and the upper layer is at field capacity the daily infiltration and drainage volumes reported from drainmod are used to calculate nitrogen removal rates it is worth mentioning that the disadvantages of configuring drainmod to simulate the submerged layer are twofold a the calibrated soil characteristic parameters are no longer representative to the actual soil media thus there can be errors in drainmod calculated water contents even when precipitation and drainage volumes are calibrated and b even if the same soil were to be used in a system with a different depth to the submerged layer the soil water characteristic curve green ampt infiltration curve and the water table volume drained upward flux curve would need to be recalibrated thus as a calibrated approximation of a bioretention system drainmod model cannot make predictions for different designed depths of iws layers and thus would be limited as a design tool 4 3 simulating nitrogen transformation in two phases artificial storm events were applied to the conventional and modified bioretention systems in two phases both of the conventional and modified bioretention systems have bare soil surfaces during phase i january to july 2016 local plants are present during phase ii march to august 2017 swmm simulation swmm uses the parameter of average removal rate avr to estimate contaminant removal in the lid module when the conventional bioretention is simulated the parameter of avr is calibrated for ammonium nitrate and orgn in each of the two phases respectively these calibrated values of avr are directly applied when simulating the modified bioretention for the modified bioretention nitrogen removal in the storage unit is described with equation 7 where hrt is the hydraulic retention time calculated by swmm and k is calibrated for the two phases 7 c o u t c i n exp k h r t drainmod simulation when doing phase i simulation the growing season is set in drainmod in a way that no crops are grown due to late planting a total of 12 parameters describing the reaction rates of decomposition nitrification and denitrification are calibrated to simultaneously simulate removal rates of n o 3 and n h 4 orgn removal rates are not calibrated because orgn concentrations are not reported by drainmod when simulating phase ii the plant uptake process is included the same set of parameter values calibrated for phase i simulation can be directly applied and reproduce n o 3 and n h 4 removal rates well with the only adjustment of one empirical exponent describing the soil moisture factor for denitrification in each phase the conventional and modified bioretention systems share the same set of parameter values comparing calibration results for each nitrogen species the event mean concentrations reported from swmm and the daily average nitrogen concentrations reported from drainmod are used to calculate the simulated nitrogen removal rate of each event ri parameters are calibrated to minimize the relative error erel of the simulated average removal rates r s i m compared to the observed average removal rates r o b s better calibration results are also selected based on lower root mean square error rmse and similar standard deviation st dev with the observed data these evaluation parameters are calculated with equations 8 10 8 e r e l r s i m r o b s r o b s 100 9 r m s e i 1 n r s i m i r o b s i 2 n 10 s t d e v i 1 n r i r 2 n where subscripts sim and obs refer to simulated and observed results respectively and n is the number of artificial storm events 4 4 simulation results after calibration the relative errors of precipitation and drainage volumes of artificial rain events are less than 5 for both swmm and drainmod furthermore swmm and drainmod can accurately simulate the average removal rates r of n o 3 and n h 4 fig 3 with relative errors of less than 10 it is more difficult for the models to accurately reproduce the variability in nitrogen removal between storm events drainmod reproduces the st dev better for conventional bioretention while swmm does better for the modified bioretention for the conventional bioretention system the st dev values from swmm simulations are especially small this reveals a risk of underestimating the variation of nitrogen removal rates when using swmm as a deterministic model for the modified bioretention system r from swmm is influenced by hrt resulting in larger more realistic variations for drainmod the soil temperature factor is a major source of variation of r in the field study the values of st dev in both conventional and modified bioretention systems were significantly smaller in phase ii which suggests that plants may help stabilize nitrogen removal performances the similar st dev of drainmod simulated r between conventional and modified bioretention systems indicate that the plants influences on nitrogen cycling in bioretention systems are not fully described by the drainmod models while this case study does not involve validation of the calibrated swmm and drainmod models the limitations of these two models in predicting bioretention nitrogen removal performances are not hard to see in swmm the impact of temperature plant uptake and antecedent dry periods wang et al 2019 on nitrification and denitrification is not represented drainmod is not capable of directly simulating hydraulic performances of bmps the soil parameters need to be recalibrated for different thicknesses of iws layer and thus the performances of bioretention cannot be predicted at the time of design as stated many challenges arose while building models for the bioretention systems with both swmm and drainmod generally the strengths and weaknesses of simulating nitrogen transformations in bioretention systems are listed in table 6 these characteristics may also be applicable to simulating other stormwater bmps agricultural models and swmm both have their own strengths and weaknesses and neither of them can be directly applied as process based models to simulate nitrogen transportation and transformations in stormwater bmps agricultural models with large time steps are not suitable for urban stormwater simulations more importantly bmp design and structures are not directly represented in agricultural models and indirect representation of the iws layers can introduce errors for hydraulic analysis hydraulic analysis results from stormwater models are more suitable for process based nitrogen simulations in stormwater bmps but still need further enhancements in the vertical direction the soil columns need to be stratified into soil layers according to both bmp designs and the different biochemical reactions that take place within them in order to obtain time series of water contents and water flows as the basis of further process base nitrogen simulations we suggest that it is the most feasible and efficient to make necessary modifications to the hydraulic calculations of bmps in current stormwater models and then adapt math expressions of nitrogen related processes in agricultural models to develop a process based nitrogen module as an extension package to stormwater models 5 implications on establishing the stormwater nitrogen model based on the review and case study we make the following suggestions for establishing a process based stormwater bmp module with nitrogen transformations soil stratification as described in section 3 5 environmental factors can significantly influence nitrogen transformation and transportation detailed soil stratification and vertical profiles of these environmental factors can potentially increase accuracy of the stormwater nitrogen model on the other hand detailed soil stratification requires more boundary conditions and parameter values which are often limited in stormwater bmp field studies and would result in higher model complexity we suggest soil stratifications based on bmp designs such as internal water storage layer or possible soil amendments applied to a certain depth the surface layer can also be separated as its som content soil temperature and oxygen supply can be different from those in deeper soil simulation of thinner soil layers is deemed unnecessary for stormwater bmp for two reasons a media with distinct hydraulic characteristics are already used to fulfill design purposes of different structural layers thus media layers can naturally be divided accordingly b with high infiltration rates hydraulic conditions within each layer tend to be homogeneous in stormwater bmps simple stratifications based on stormwater bmp designs can meet the precision requirements of hydraulic calculations with higher computational efficiency time and spatial resolution simulating nitrogen transformations in stormwater bmps requires small time steps since rain events often complete within hours shorter time steps will also assist the adoption of automatic real time control of stormwater bmps persaud et al 2019 zhang et al 2018 in terms of the spatial resolution site scale simulation is sufficient for nitrogen transformations in each stormwater bmp given their small scale when mixed plant species are grown virginiaq stormwater 2011 virginiatormwater 2011 a single conceptual plant species can be used to approximate the average plant nitrogen uptake rate model structure fig 4 shows the suggested structure for the process based stormwater bmp nitrogen model where optional processes are marked with dashed lines surface run on surface overflow and deposition only occur in the top most soil layer leaching and effluent are only simulated for the bottom layer all three nitrogen species transport with waterflows between soil layers other biochemical processes should be simulated in each soil layer and influenced by environmental conditions through different values of environmental factors surface run on dry and wet deposition are the main nitrogen sources of stormwater bmps plant residuals may release a significant amount of orgn if they are not cleared promptly fertilizers are rarely used in stormwater bmps compared to agricultural land the main removal mechanisms of nitrogen include sediment transport of orgn transport of dissolved organic nitrogen don and inn via water flows leaching drainage and surface runoff plant uptake and release of nxoy gases in urban areas the quality and quantity of surface runoff drainage and leaching can have a significant impact on the pavement pipelines and groundwater of downstream catchments therefore these data are important indicators to measure the performances of stormwater bmps and need accurate simulation literature has reported that don concentrations in stormwater bmps effluent may be similar to nitrate concentrations mohtadi 2017 li and davis 2014 which means that don losses with water flows should not be overlooked in fig 4 the release of n2 is not included as it is neither influential to nitrogen mass balance nor of environmental interest ammonia volatilization is also not included since it is unlikely to happen given the low tn level in stormwater bmps media and the acidic to neutral soil ph environments kavehei et al 2021 some recent papers challenge the sole dominance of nitrification and denitrification in the nitrogen cycle in stormwater bmps and suggest that dissimilatory nitrate reduction to ammonium dnra anammox algae growth plant uptake and heterotrophic nitrogen fixing can all play important roles gold et al 2019 jahangir et al 2017 wen et al 2020 chang et al 2016 given that the quantitative data and math descriptions on these processes are currently limited gold et al 2019 we suggest the overall nitrogen transformation to be expressed only with processes included in fig 4 and the impacts of other processes to be expressed with empirical environmental factors fig 5 shows the suggested division of som sub pools sources of fresh organic matter fom include organic contaminants in deposition and surface run on dead biomass degradation and if applicable plant residuals the cnr of the fom pool should change with som supply over time in stormwater bmps the abundance and composition of the biomass community vary with hydraulic conditions vegetation oxygen supply carbon availability etc and influence biochemical reaction rates liu et al 2021 zuo et al 2019 2020 it is thus necessary to take biomass into consideration for stormwater nitrogen models but the sub pools should be carefully decided to avoid overparameterization or extra uncertainty we suggest that living aerobic and denitrifying biomass should be simulated separately as their requirements for oxygen supply or saturation rate are quite different the emission of carbon dioxide is also marked in fig 5 as a product of decomposition because reporting this data would help estimate the carbon footprints of stormwater bmps decomposition in the suggested model structure decomposition only occurs for the fom pool decomposition rates can be calculated with first order kinetics limited by the environmental factor and the released inn can then be calculated with the cnr of the fom pool nitrification and denitrification in stormwater bmps decomposition and nitrification are considered the main reason for net n o 3 export hsieh 2007 denitrification and the resulted n2 emission is believed to be the most important mechanism of tn removal igielski 2019 therefore the accurate simulation of nitrification and denitrification processes is crucial to the stormwater nitrogen model as listed in table 3 nitrification and denitrification are simulated with either first order kinetics or the michaelis menten function in the agricultural models while both forms are applicable the michaelis menten function does bring in one more parameter to calibrate which is the half saturation constant thus first order kinetics is suggested different from other biochemical reactions denitrification only happens when the soil saturation rate is above a threshold and there is a disagreement on the threshold value among agricultural nitrogen modules according to table 3 and table a2 here we suggest that the threshold value should be either calibrated with available data or user defined biomass growth decay and degradation the procedure of simulating immobilization in the agricultural nitrogen modules can be adopted here firstly immobilized carbon can be estimated as a fraction of decomposed carbon and the fraction varies with soil moisture soil temperature and biomass abundance secondly immobilized inn is calculated with the constant cnr values of the living biomass pools lastly immobilization rates are reduced to the allowed level when inn is insufficient given that fixation is not included biomass decay and degradation can also be estimated with fractions of living and dead biomass gas emissions accurate simulation of nxoy emission can be of great interest in the perspective of environmental protection leahey and hansen 1990 smith 2010 it has been reported that the amount of n2o released by urban soil is similar to that in corn farmland and reaches 0 24 g n m2 year kaye 2004 n2o emission from stormwater ponds may occupy 0 15 of tn in the ponds under the influence of environmental factors blaszczaket al 2018 therefore accurate prediction of n2o emission is among the aims of a process based stormwater nitrogen model among the gas emission equations listed in table 4 the set from wnmm can be more suitable for stormwater nitrogen modeling as it has simpler forms and has a smaller number of empirical parameters that need calibration plant uptake in agricultural models inn taken by crops are estimated with the mass of crop growth and nitrogen contents in plants this approach can be applied to the stormwater nitrogen model to estimate the plant uptake rate with easily obtained parameters even when the complex influences of plants on the nitrogen cycle in bmps are not yet fully understood when inn is insufficient plant growth should be limited skorobogatov et al 2020 summarized current research findings of the role of plants in bioretention systems aside from plant uptake potential impacts of plants may include hydraulic impact enhanced evapotranspiration and preferential flow and the effects on soil microorganisms such as increasing the oxygen content in the root zone increasing soil organic matter content in the root zone and simultaneous acceleration of decomposition nitrification and local denitrification wanget al 2017 morseet al 2018 as a simplification the complex influences of plants on biochemical reactions can be estimated with an empirical factor of f v e g indicating overall enhancement on biochemical reactions caused by plants with values larger than 1 0 and overall impairment with values between 0 0 and 1 0 nitrogen transportation equations 4 6 can be applied to stormwater nitrogen models to calculate inn and don transport through leaching drainage and surface runoff orgn transported with sediment can be roughly estimated with concentrations of sediment the content of fom that is not dissolved and the cnr of the fom pool amendments are commonly used in media in stormwater bmps to enhance the removal efficiency of pathogens n h 4 phosphates dissolved organic carbon doc and heavy metal ions mohtadi 2017 wium andersenet al 2012 van lienden et al 2010 smith 2011 through increased cation exchange capacity and specific surface area in a process based stormwater nitrogen model we suggest that a cec factor f c e c that has a value in the range of 0 0 1 0 can be applied to equations 5 and 6 to simulate the decrease of nitrogen transport with water flows environmental factors in stormwater bmps soil moisture soil temperature soil ph cnr and orgc availability can all impact biomass growth rates and biochemical reaction rates wang et al 2019 søberg et al 2021 f c e c and f v e g are also suggested all of these environmental factors except for f v e g should have values in the range of 0 0 1 0 taking the value of 1 0 under optimum conditions for the simulated biochemical reaction and 0 0 under extreme environmental conditions where the biochemical reactions cease when developing the stormwater nitrogen model to balance among simulation accuracy computational efficiency and user friendly operation of parameter calibration we suggest that the reactions rates of first order biochemical reactions in each time step should be simulated with equation 11 11 n p r o c e s s n s u b k p r o c e s s f e n where nprocess is the rate of biochemical reactions expressed by nitrogen nsub is the nitrogen content of the corresponding nitrogen pool kprocess is the optimum reaction rate under ideal environmental conditions without plants and f e n is the overall environmental factor taking a reference from drainmod we suggest that f e n can be calculated by multiplying two factors that have the largest deviation from 1 0 in this way the two most limiting environmental factors are taken into account in terms of the specific expressions of f t f s f p h f c n r and f o c we suggest that the equations from wnmm can be adopted see appendix as they are in simpler forms and involves fewer parameters to calibrate 6 summary in this review the structures and math bases of six agricultural nitrogen modules are summarized and compared the model build up and calibration results from drainmod and swmm on two bioretention systems are reported with a perspective of assisting the development of a process based stormwater nitrogen model lastly suggestions are offered for building a process based nitrogen model for stormwater bmps agricultural nitrogen modules are to some extent consistent in their model structures nitrogen cycle and mathematical descriptions of decomposition nitrification and denitrification processes but show more variation in the division of som sub pools and the description of environmental factors while many of these model structures basic assumptions simplifications and math equations are applicable to stormwater nitrogen models special attention should be given to the differences between agricultural fields and stormwater bmps important differences include time step requirements design of drainage systems soil hydraulic characteristics contributing surface run on the importance of different biochemical processes nitrogen sources and sinks and the influences of environmental factors the case study reveals that average nitrogen removal rates of field scale bioretention systems can be reproduced by both swmm and drainmod but there are still many challenges in simulating the nitrogen cycle and predicting nitrogen removal rates of bioretention systems with either of the two modeling tools lessons from this review and model comparison provide recommendations for the development of a more mechanistically accurate nitrogen model for bmps the establishment and application of such a model should improve understanding of nitrogen related processes in bmps and spur innovation of improved designs declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was funded as part of the national science foundation grant award 1737432 scc irg track 1 overcoming social and technical barriers for the broad adoption of smart stormwater systems and the university of virginia appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2022 105363 
25602,a process based nitrogen model suitable for urban stormwater best management practices bmps when used as an extension to current stormwater models can assist decision making by predicting nitrogen removal performances while such a model has not been created process based nitrogen modules for agricultural fields have been developed and applied in this paper the nitrogen modules in six agricultural models are reviewed in the perspective of assisting the development of a process based nitrogen module for stormwater bmps the agricultural nitrogen modules have consistent structures and mathematical descriptions of biochemical reactions but show more variety in incorporating environmental factors the operational challenges strengths and weaknesses of simulating stormwater bmps nitrogen removal performances with current models are illustrated with a case study finally suggestions on developing the process based nitrogen module for stormwater bmps are offered based on the review the case study results and the differences between the stormwater bmps and agricultural fields keywords simulation nitrogen agriculture urban stormwater bmps 1 introduction high concentrations or loads of nitrogen in stormwater runoff can cause eutrophication in downstream water bodies and severely damage ecosystems application of fertilizers and atmospheric deposition are major sources of nitrogen in rural and urban areas respectively katz 2020 a variety of stormwater best management practices bmps have been developed to manage urban runoff and nitrogen loads while the nature of agriculture systems may require different bmps livingston 1998 referred to as agricultural bmps than those designed for urban systems novotny 2010 referred to as stormwater bmps the inherent nitrogen fate and transport processes within each system are the same extensive research has been aimed at water quality control in stormwater bmps with the goal of discovering more stable efficient and cost effective engineering design principles nevertheless the nitrogen removal efficiencies obtained from laboratory and field tests of stormwater bmps are highly variable for different types of stormwater bmps reported removal rate ranges of ammonium n h 4 nitrate n o 3 and total nitrogen t n are 70 100 110 100 and 5 80 respectively koch 2014 due to the complexity of physical chemical and biological processes in the water soil or media air plant system as well as the typically incomplete measurement of environmental conditions of the stormwater bmps gavrić et al 2019 it is difficult to identify the cause of variance in nitrogen removal performances and thus even more difficult to make accurate predictions nitrogen simulations in current stormwater models remain limited indirect and coarse elliott and trowsdale 2007 jayasooriya and ng 2014 the hec hms hydrologic modeling system hydrologic engineering ce 2021 and mouse urban drainage and sewer dhi inc 1999 models do not include nutrient simulations in the p8 urban catchment model program for predicting polluting particle passage through pits puddles and ponds walker and walker 2015 water quality components are defined by their weight distributions across particulate size and dissolved nutrients are not simulated the winslamm model source loading and management model pitt and voorhees 2004 simulates both dissolved and particulate nutrient loads but sediment settling is the only described pathway for nutrient removal bmps are not directly represented but estimated with hydraulic nodes or detention ponds in basins better assessment science integrating point and non point sources u s epa 2019 nitrogen simulation is limited to nitrogen concentrations in surface runoff and within the sewer systems other models including swmm storm water management model sustain system for urban stormwater treatment and analysis integration and music model for urban stormwater improvement conceptualization rossman and huber 2015 tech 2012 wong et al 2002 directly represent bmps and use percent reduction or 1st order kinetics to describe decay of dissolved nitrogen transformations among nitrogen forms are not considered none of these stormwater models involve process based nitrogen simulations some stormwater models are reported as process based tech 2012 wong et al 2002 liu et al 2014a but that is with respect to hydraulic processes and they do not involve biokinetics of nitrogen transformations a process based nitrogen module when used as an extension to current stormwater models can better assist decision making by predicting nitrogen removal performances according to bmp designs and environmental conditions such a module could support systematic design improvements for bmp water quality performance and may also help us understand the complex correlations among nitrogen transformation and transportation processes liu et al 2014b to our knowledge however such a model has not been reported the development of a process based nitrogen model for stormwater bmps will require 1 integrating the nitrogen cycling processes 2 mathematically representing nitrogen related processes in appropriate detail 3 determining parameter values and assessing their sensitivity simulation of nitrogen transportation and transformation in the agricultural systems is significantly more advanced than that in the urban systems as many processes based agricultural models have been developed and successfully applied thomas 2013 though these agricultural models should not be directly applied to stormwater bmps due to the differences in hydraulic conditions soil media properties artificial management spatial and temporal resolutions etc advances made in previous models of nitrogen related processes in the agriculture fields may be leveraged to guide the development of a nitrogen model for stormwater bmps 2 method and materials in this paper nitrogen modules in six agricultural models are reviewed and compared to the lid low impact development module of storm water management model swmm rossman 2015 swmm is selected as a representative for current stormwater models because a it is widely applied b it includes well developed lid modules to represent design features of a range of bmps c it clearly states its math equations in easily available user manuals and d it already includes rudimentary water quality routines the six agricultural models as noted in table 1 are selected for this review based on the availability of mathematical descriptions of their nitrogen modules the drainmod n ii hereafter referred to as drainmod model refines drainmod n s simulation of ammonium the extended soil and water assessment tool swat n was developed by adjusting the nitrogen module in the original soil and water assessment tool swat to that of the de nitrification and de composition dndc model as epic dndc and swat n are reviewed here it is deemed unnecessary to include the original drainmod n and swat models section 3 reviews the simulated processes basic assumptions and simplifications as well as the mathematical descriptions of the most relevant nitrogen related processes of the selected agricultural nitrogen modules to investigate the feasibility and potential problems of directly applying agricultural models to stormwater management bmps section 4 presents the results of a case study where drainmod and swmm are used to simulate the nitrogen removal rates from a study of stormwater bioretention finally the implications on developing the nitrogen model for stormwater bmps are discussed in section 5 it should be noted that the mathematical symbols used in this review might be different from the references unified symbolics are used for easier comprehension and comparison among models among references the same variable may be described in different units due to the variations of dimensions spatial resolutions and habits of developers given that the physical quantity described remains the same the units of physical quantities are not specified in this paper for the sake of simplicity 3 comparison of the nitrogen modules 3 1 general information table 1 presents general information about the agricultural models plus swmm the temporal and spatial resolutions differ among models there is a significant difference in time steps between the agricultural nitrogen modules and the swmm lid module dndc can take an hourly time step during wet periods while the other agricultural nitrogen modules use a daily time step agricultural models often simulate periods longer than a season or a year and accurate predictions of hourly nitrogen losses from agricultural fields are not required the time step in swmm can be as small as per second in terms of spatial resolution all reviewed modules can operate site scale simulation in which the vegetation management practices weather conditions and soil characteristics are homogeneous regional simulation on the other hand simulates sub catchments with different soil characteristics crops weather conditions and land management simultaneously all models include basic hydrological processes of precipitation and evaporation while the agricultural models include irrigation run on the addition of surface runoff to the site a critical process for a bmp model is included in iwss swat n and swmm when infiltration rates are smaller than precipitation or irrigation rates runoff surface water exiting a site would occur and can be represented in epic iwss drainmod and swmm for subsurface hydrology epic and swat n simulate both lateral and vertical flows of infiltrated water swmm can simulate lateral discharge of infiltrated water on a regional scale but within a bmp infiltrated water either leaches vertically into the subsoil below a bmp or into an underdrain the remaining four models calculate only vertical water flow most of the agricultural models represent leaching vertical water flow below the root zone among all agricultural models only drainmod simulates artificial subsurface drainage in agricultural models users divide the soil profile into horizontal layers of different thicknesses the description of soil stratification is both more detailed and more flexible than swmm to accommodate the wide diversity of agricultural soils and to allow the calculation of crop growth with root depth data and corresponding water deficits soil moisture and water fluxes are reported for each layer conversely in swmm hydraulic characteristics are assigned to different major stormwater bmp layers such as the soil media and gravel sumps moisture content is assumed to be uniformly distributed throughout the total media layer and reported as the average soil moisture of the total soil column precipitation surface run on flow through an underdrain subsequently referred to simply as drainage leaching into the soil below the bioretention system and surface runoff are reported for the simulated bmp system 3 2 nitrogen module structures 3 2 1 sources and sinks of nitrogen table 2 lists the reported sources and sinks of nitrogen in the 7 models various water flows precipitation runoff run on drainage and leaching may transport dissolved nitrogen species and in some models nitrogen associated with sediment transport can be simulated as epic dndc and drainmod only perform site scale simulations the simulated soil can t be divided into sub catchments and surface run on can t be calculated dndc does not consider surface runoff surface runoff and run on are not calculated by wnmm despite its ability to do regional simulation because the model was developed for the north china plain where the topography is flat in the reviewed models organic and inorganic fertilizers enter the soil in the form of large organic molecules urea and or ammonium n h 4 plant residues supplement the soil with fresh organic matter fom and fresh organic nitrogen fon through tillage where fom and fon are evenly mixed in the soil to a given depth nitrogen fixation which refers to the process in which nitrogen gas n2 is reduced to ammonia nh3 and enters the soil hanrahan and chan 2005 is only calculated to maintain nitrogen mass balance and its detailed biochemical processes are neglected wet deposition represents inorganic nitrogen inn input directly to the simulated soil during rainfall while dry deposition occurs between precipitation events inn input through wet and dry deposition is usually simulated in the form of nitrate n o 3 deposition rates are estimated with average rainwater concentrations and annual dry deposition the two nitrogen sources simulated by all agricultural models are plant residue and fertilization unlike agricultural fields fertilizers are rarely applied to stormwater bmps and plant residues are often removed as unwanted nitrogen sources thus swmm simulates only three sources surface run on the primary source for a bmp wet deposition and dry deposition nitrogen simulation in swmm is primarily tracked through the transport of water simulated water flows include surface run on precipitation leaching drainage and surface runoff time series of nitrogen concentrations in these water flows are reported within a bmp multiple nitrogen species can be simulated as independent contaminants but transformation among nitrogen species is not applicable for each nitrogen species a simple percent removal can be applied to a bmp where the nitrogen concentration exported through drainage and leaching is a constant percentage of the nitrogen concentration in well mixed inflows rossman and huber 2016 neither nitrogen mass balance nor biochemical mechanisms are considered for all agricultural models nitrogen plant uptake is simulated in detail as it directly affects crop yields ammonia volatilization is also carefully calculated in all agricultural models except for epic as it accounts for up to 60 of applied inorganic fertilizers sunet al 2020 epic assumes that ammonium in the soil is instantly oxidized to nitrate and thus ammonia volatilization is not simulated inn dissolved in the surface runoff and organic nitrogen orgn carried by sediments are often neglected dndc iwss and wnmm report nxoy emissions during both nitrification and denitrification processes while swat n only calculates nxoy emission during nitrification 3 2 2 nitrogen transportation and transformation fig 1 summarizes the nitrogen transportation and transformation processes in the reviewed agricultural models except for epic in each agricultural model nitrogen concentrations in its simulated water flows are reported as stated the structure of the epic nitrogen module is more unique as it omits ammonia agricultural models except for epic calculate nitrogen transformations among three pools organic nitrogen orgn ammonia nitrogen nh 4 n and nitrate nitrogen no 3 n to avoid confusion som in this paper refers to the sum of all organic substances in soil and the term organic carbon orgc refers to the organic carbon content in the soil with subscripts describing the form of organic compounds as shown in fig 1b decomposition immobilization nitrification denitrification and plant uptake are the key bio chemical nitrogen transformation processes to clarify decomposition refers to the process where organic matter is degraded resulting in the release of carbon dioxide and inn immobilization refers to inorganic carbon and inn uptake by microorganisms for cell growth support and is the general description of microbial uptake assimilation and resynthesis in summary agricultural models are very similar in terms of the simulated sources sinks and cycling of nitrogen in comparison swmm considers the nitrogen sources and sinks that are more suitable to stormwater bmps but does not include process based nitrogen cycling simulation in reality there are significant differences in soil hydraulic characteristics management objectives nitrogen sources and sinks soil nitrogen content and effluent total nitrogen tn concentrations between agricultural field and stormwater bmps sunet al 2020 tirpak et al 2021 while the key biochemical processes in the nitrogen cycle can be similar in the two soil systems gold et al 2019 thus to establish a process based nitrogen model suitable for stormwater bmps it is necessary to refer to the nitrogen pool division and nitrogen transformation processes in the agricultural models and also consider surface runoff surface run on sediment transport removal of plant residues along with the rare use of fertilizers in stormwater bmps in section 5 we provide specific recommendations regarding the structure of a suitable process based stormwater nitrogen module 3 3 simulating nitrogen transformation processes in this work mathematical expressions used to simulate nitrogen transformation processes in agricultural nitrogen modules are modified for easier comparison the swmm lid module is not included because none of the biochemical transformations are simulated and nitrogen removal is calculated with a percentage of removal see in section 3 2 1 equations for decomposition nitrification and denitrification are listed in table 3 detailed explanation of all math symbols used in this review are given in the appendix table a1 in short c p and n p refer to changes of carbon and nitrogen over time respectively with the subscript indicating the relevant process dec decomposition nit nitrification and den denitrification k p is an optimal rate constant which may be reduced by a comprehensive environmental factor f en due to deficient environmental conditions f en can be calculated with specific environmental factors including soil saturation rate soil temperature soil ph soil orgc content and c n ratio of organic matters the original environmental factor of clay content in dndc is not listed in table 3 but reformed to a factor of oc as detailed in the appendix as clay tends to slow down the decomposition process by absorbing organic matters zhao et al 2018 the equations used to calculate these factors are further discussed in section 3 5 nh 4 no 3 n a o b and tno are concentrations of ammonium nitrate species of nitrogen oxides and total nitrogen oxides in dndc and iwss the denitrification rate is influenced by the growth and abundance of denitrifying bacteria b d e n refers to the total denitrifying biomass μ y and m describes the growth and decay rate of denitrifying bacteria and vary with nitrogen oxide species 3 3 1 decomposition as biological transformations of carbon and nitrogen during decomposition are simultaneous and intertwined nitrogen transformations in these processes are often calculated based on the carbon cycle as is shown in table 3 in all agricultural models except for epic inorganic carbon released from decomposition c dec is first simulated with first order reaction dynamics the amount of released inn n dec is then calculated with carbon to nitrogen ratio of the decomposed organic matter cnr the value of optimum reaction rates and cnr are different among various som sub pools most agricultural models assume constant cnr values in each sub som pool with the only exception of drainmod which recalculates cnr in sub pools at each time step n dec is then added to the ammonia pool in epic inn is directly released in the form of nitrate as there is not an ammonia pool and the amount released is calculated based on organic nitrogen 3 3 2 nitrification and denitrification both nitrification and denitrification are general terms of a series of complex biochemical reactions nitrification refers to the process in which n h 4 is oxidized to n o 3 by aerobic bacteria shah 1978 and denitrification refers to the process in which denitrifying bacteria absorb n o 3 as the electron acceptor under hypoxic or anaerobic conditions and successively reduce the valence of nitrogen from positive five to zero products of denitrification include n o 2 no n 2 o and n 2 coyne et al 2008 nitrification and denitrification rates have been fitted with zero order reaction kinetics michaelis menten functions or first order reaction kinetics igielski 2019 halaburka et al 2017 in agricultural nitrogen modules nitrification and denitrification rates are described by either the first order equation or the michaelis menten function in the michalis mention function the described process behaves as a first order reaction when the substrate is limited and gradually changes to a zero order reaction with increasing substrate concentrations it is also shown in table 3 that environmental factors are integrated with optimal reaction rate k x in various ways for example the environmental factors f s f t and f p h are directly multiplied with k x in drainmod but are exponentially related to k nit in wnmm as these environmental factors are described with empirical functions in various forms discussed in detail in section 3 5 their impacts on nitrogen transformations can be complex and their sensitivity can only be analyzed with actual simulation results it is worth mentioning that agricultural nitrogen modules take different strategies to describe the significant impact of soil moisture on the denitrification rate dndc and iwss switch between a dry weather submodule where denitrification is not calculated and a wet weather submodule where denitrification is the only biochemical process simulated the wet weather submodule is switched on as the rain events start and is switched off when saturation rate in the top 20 cm soil drops below 40 or after 10 days since the rain event under the wet weather submodule the growth rate of denitrifying bacteria is calculated with the michaelis menten function with two substrates nitrogen oxide and organic matter and the denitrification rate is influenced by the denitrifying biomass the bacteria growth rates total biomass and reaction rates in each step of denitrification are calculated separately in epic denitrification only occurs when the saturation rate is over 90 and the real time reaction rate is not calculated with the soil moisture factor the wnmm model sets the threshold to 80 saturation and the denitrification rate increases exponentially with higher soil moisture content in drainmod the threshold of denitrification is expressed with the soil moisture factor f s which has a value of 0 0 when soil moisture drops below a user defined threshold this would result in a value of 0 0 for the denitrification rate in swat n the value of f s and denitrification rate changes significantly over the range of soil moisture content but does not drop to 0 0 3 3 3 immobilization immobilization is of great importance in the soil nitrogen cycle because it not only affects the mass balance of inn pools in the current time step but also influences the decomposition rate in the next time step by changing the availability of decomposable som similar to decomposition nitrogen flux of immobilization is generally calculated based on carbon transformations although the exact forms of mathematical equations can vary significantly due to the different divisions of sub som pools the basic procedures can be generalized as a calculate immobilized carbon c imm as a fraction of c dec b calculate immobilized nitrogen n imm according to cnr of the entering som sub pool and c imm c represent the restrictions of inn availability on immobilization the math equations used to calculate nitrogen immobilization are summarized in table 4 in this table n i m m fr refers to flat residues in the agricultural field np refers to nitrogen content in crop plant with subscripts indicating parts of plant fr in crop residues and simulation date day currently simulated day of the year day 1 the previous day e m i c r o is an empirical efficiency coefficient of microbial assimilating c d e c and α i m m is a mass fraction of immobilized carbon over c d e c in epic net nitrogen immobilization is directly proportional to n dec dndc and iwss divide som into 3 sub pools residues biomass and hummus and each of the sub pools is divided into two components the active and stable components c imm and n imm that enter each component are calculated with total c dec from all sub pools constant empirical fractions and constant cnr values c imm and n imm would drop to the available inn content when inn is insufficient the entire biomass sub pool is subject to decomposition it is worth mentioning that the aerobic biomass evolved in decomposition and immobilization is different from the denitrifying biomass b den and their mass balances and growth rates are calculated separately in the dry and wet weather submodules respectively wnmm has the same division of som as dndc but decomposition only occurs in the active hummus component and all immobilized carbon and nitrogen contribute to active biomass active living biomass decays to stable dead biomass and then degrades back to active hummus through first order kinetics as shown in table 4 nitrogen demand for immobilization is set to a constant fraction of decomposition derived carbon 0 048 this calculated amount is then compared to the actual inn released through the decomposition process as som in sub pools with different cnr values change over time n imm can be positive or negative representing net decrease or increase of the soil inn pool instead of immobilization swat n calculates ammonification ammonification can be taken as the reverse of the immobilization process and is the result of som decomposition from 3 organic litter pools very labile labile and stabile growth and decay of microbes from 2 microbes pools labile and stabile and decomposition of som from 2 humic pools labile and stabile nitrate is reduced to ammonium when ammonium is depleted the equation listed in table 4 for swat n is reformed and simplified further details on equations describing microbe growth and decay can be found in li et al li et al 1992 li 2000 in drainmod total som is divided into 8 sub pools including 4 litter pools describing plant residues and animal waste surface metabolic litters soil metabolic litters surface structural litters and soil structural litters 3 soil biomass pools active slow and passive and 1 surface biomass pool carbon and nitrogen flows from litter pools to and transform among the biomass pools as shown in table 4 the cnr values of organic matters synthesized into each sub pool change with inn availability c n r m a x and c n r m i n are the maximum and minimum cnr values entering a certain som sub pool i n n m a x is the inn content that is adequate for synthesized organic matter to enter the som sub pool with c n r m a x 3 3 4 plant uptake in all agricultural nitrogen modules plant uptake is a major sink of inorganic nitrogen in the soil in all reviewed agricultural models nitrogen plant uptake is simulated with a demand versus supply method available math equations describing plant nitrogen demand n p d e are summarized in table 4 n p o p t d a y n p o p t d a y 1 n p a c t d a y and n p a c t d a y 1 refer to optimal and actual nitrogen concentration in plants at currently simulated or the previous day of the year subscripts also indicate the part of plant grain shoot and root p b is the plant mass m a s s a r e a 1 y l d h i and r s r are crop yield m a s s a r e a 1 plant harvest index dimensionless and the root to shoot ratio of plant at maturity dimensionless respectively in dndc plant uptake is only considered in the dry weather module and is estimated based on average nitrogen uptake rate crop type and seeding date the crop growth module in iwss is adapted from epic epic wnmm and swat n use the same equation to calculate n p d e which is the difference between optimal nitrogen content in plant biomass at the current simulated day and the actual nitrogen content in plant biomass at the previous day drainmod adapts a slightly different approach where nitrogen contents in various parts of plant are considered inn supply is decided by inn content in soil layer plant water uptake and diffusion of inn and is further relevant to the growth of plant roots the equations for inn supply are further referred to earlier models and literature neitscharnold et al 2011 johnsson et al 1987 jones 1983 when the supply of inn is not sufficient to support plant uptake demand a nitrogen stress factor is calculated based on the ratio of actual plant nitrogen content to the optimal value the nitrogen stress factor decreases nonlinearly as inn availability decreases and will constrain plant growth rates fixation can occur if legumes are present the upper limit of the fixation rate is set to 2 0 kg n hectare 1 day 1 in epic swat n assumes that n o 3 is preferred to n h 4 by plants and inn is taken from the ammonium pool only when the nitrate pool is depleted dndc and drainmod assume equal preference by plant between n o 3 and n h 4 3 4 gas emissions nxoy are byproducts of nitrification and denitrification rassamee 2011 dndc and iwss report n2o and n2 emissions wnmm reports only n2o emission in swat n the partition between n2o and no is not calculated nxoy emission is not reported in other models as shown in table 5 nxoy emissions can be estimated with either empirical formulas or first order reaction kinetics n h 4 x and n h 3 x represent ammonium and ammonia content with subscript indicating the phases they are in a d and d are the adsorption and diffusion coefficients as noted earlier f are the environmental factor parameters with subscripts indicating the specific environmental factors and the relevant biochemical reactions the environmental factors are described in section 3 5 in wnmm dndc and swat n ammonia volatilization is calculated in each horizontal layer while in drainmod volatilization only happens in the soil surface layer ammonia volatilization is the result of multiple physio chemical equilibriums as shown in equations 1 3 1 n h 4 l n h 3 l h 2 n h 3 l n h 3 g 3 n h 4 l n h 4 s soil characteristics and environmental factors that impact these equilibriums include soil cation exchange capacity cec tortuosity soil temperature soil ph and wind speed despite the complexity of this three phase equilibrium system many of these listed parameters are neglected by the nitrogen modules as they are often constant over time as ammonia volatilization in an acidic environment is slow its simulation is designed as optional in drainmod when soil ph is higher than a user defined threshold default at 7 5 the gas diffusion is driven by the concentration gradient of ammonia between pores and the atmosphere when soil ph is below the threshold ammonia content is assumed to be 0 0 and ammonium partitions between the solid and aqueous phase wnmm was developed for fields with stable ph of around 8 5 and thus the impact of soil ph on ammonia volatilization is not considered 3 5 mathematical expressions for environmental factors the equations used to describe the impacts of environmental factors in the agricultural nitrogen modules are mostly empirical and take a variety of forms detailed equations are listed in table a2 in the appendix the value of each environmental factor is estimated under the assumption that other environmental conditions are optimum for the related biochemical reaction in reality multiple environmental conditions may change simultaneously and have a collective effect that can t be precisely calculated by simply multiplying the estimated factors this estimation approach however is still widely applied for simplicity soil temperature the soil temperature factor f t has a value of 1 0 at the optimum soil temperature or in the optimum soil temperature range and decreases linearly or exponentially when above or below this optimal value the optimum soil temperature varies with biochemical reactions user defined optimum soil temperature ranges are required by drainmod and swat n the soil temperature profile is determined based on the annual average soil temperature daily air temperature and the average depth of the soil layer according to williams et al 1984 saturation the impacts of soil water content on biochemical processes are more complex forms of equations applied include exponential equations first order second order and fourth order linear equations user defined optimum ranges of saturation rate for decomposition and nitrification together with a user defined threshold for denitrification are required by drainmod as previously discussed dndc and iwss switch between the wet and dry submodules denitrification is not simulated in the dry submodules and soil moisture is not a limiting factor in the wet submodules soil ph in drainmod reaction rates decrease exponentially with the increasing deviation of soil ph from the user defined optimum range in swat n the soil ph factor is fitted with a second order equation empirical linear equations are also adopted in dndc and wnmm soil ph changes with fertilizer application plant uptake and nitrification and is modified by soil buffering capacity cnr the carbon to nitrogen ratio of organic matters cnr can be an important environmental factor for decomposition as stated in section 3 1 most models set constant cnr values for their organic pools in drainmod cnr values change over time as a result of decomposition immobilization and additional supply of som when calculating the cnr factor f c n r dndc uses the ratio of inorganic carbon to inorganic nitrogen instead of cnr in organics organic carbon due to the complexity and variability of som chemical components this environmental factor is not directly calculated from orgc content instead it is implicitly estimated with soil bulk density clay content and soil depth in epic dndc iwss and drainmod respectively the vertical distribution of orgc is not described in the wnmm model but the developers acknowledge that this simplification may lead to errors 3 6 nitrogen transportation in all agricultural models nitrogen transport is solved with the assumption that partition and dispersion equilibriums are achieved instantly at the beginning or end of each time step nitrogen transformations are calculated using substrate concentrations either after or before transportation though actually transformation and transportation happen simultaneously the model developers deemed the error caused by this assumption acceptable for these agricultural models with daily time steps the concentrations of inn transported by water flows can be calculated with the advection dispersion reaction equation equation 4 this function is numerically solved for n h 4 and n o 3 in drainmod 4 t θ l c l θ g c g ρ b c s z θ l d l c l z θ g d g c g z v l c l z s o alternatively empirical formulas can be used in wnmm the calculation of n h 4 transportation through leaching n h 4 l o s s kg n ha 1 day 1 is simplified to an empirical equation equation 5 5 n h 4 l o s s w n h 4 1 exp q f c where wnh4 is the total weight content of n h 4 in the soil layer kg n ha 1 fc is field capacity and q is the total leached out water m day 1 epic uses a similar empirical equation for n o 3 transportation equation 6 6 n o 3 l o s s w n o 3 1 exp q u l where wno3 is the total weight content of n o 3 in the soil layer kg n ha 1 and ul is the upper limit of water storage on top of calculating inn concentrations in soil water swat n uses a constant fraction to divide each nitrogen pool into mobile and immobile fractions only mobile nitrogen can leave the system through surface runoff lateral subsurface flow and leaching into deep groundwater as shown in table 1 only epic calculates orgn losses with sediment transport it is calculated with an empirical equation regulated by sediment production and organic nitrogen concentration in the topmost soil layer 4 simulation case study to more directly compare the simulations of nitrogen related processes in stormwater bmps two bioretention systems of varying designs as reported by lopez ponnada et al lopez ponnada et al 2020 are simulated with drainmod and swmm drainmod is selected for this case study because it is the only reviewed agricultural model that simulates drainage through underdrains that are commonly used in bioretention systems furthermore this capability is critical for this case study since the volume of and nitrogen concentrations in the drainage water are the main objectives of model calibration the calibrated nitrogen removal rates are compared to illustrate differences in simulation accuracy between the two types of models other operational challenges in simulating bioretention systems with agricultural models and swmm are also summarized detailed information on bioretention design soil and media characteristics weather conditions and inflow contaminant concentrations are recorded in the published reference article lopez ponnada et al 2020 in short two experimental scale bioretention systems 122 cm length 45 7 cm width were created they each received and treated natural and artificial rainwater over the years of 2016 and 2017 this dataset is selected for the following reasons a it compares bioretention systems with and without an internal water storage iws zone of submerged media which may enhance denitrification lopez ponnada et al 2020 wang et al 2018 b it compares bioretention systems with and without plants c it studies real bioretention systems influenced by the environmental factors changing over time and d it reports event mean removal rates of n o 3 n h 4 and tn over a comparatively long period of time there is still a lack of information that can lead to inaccurate simulation results including the hydraulic characteristics of the bioretention systems and their layers the initial tn and som content in the bioretention systems the accurate date of artificial stormwater inflow and the nitrogen concentrations in water flows including surface run on wet deposition surface runoff and drainage of natural rain events the aim of this modeling work however is to compare the general performance of the two modeling tools rather than to accurately simulate and predict nitrogen removal rates of the specific bioretention systems the dataset is hence deemed appropriate 4 1 simulating contributing run on the structures of the conventional and modified bioretention systems are shown in fig 2 in each artificial rain event a known volume of artificial stormwater that contains 1 0 mg l n o 3 n 1 0 mg l n h 4 n and 1 0 mg l orgn is directly applied to the bioretention systems the artificial stormwater is made of tap water and added chemicals and contains no sediment all artificial stormwater infiltrates into the bioretention systems and flows out through the drainage pipe the sides and bottom of the bioretention systems are otherwise sealed nitrogen concentrations in the drainage were measured to calculate removal rates during natural rain events the bioretention systems receive rainwater from the nearby impervious contributing catchment the bioretention systems are assumed to occupy 5 of the catchment area stormwater quantity and the quality of natural rain events were not recorded thus for this case study natural rain events are simulated based on local weather records of precipitation and air temperature noaa national water info 2021 to simulate these systems in swmm stormwater generated from a contributing sub catchment is directed to a lid sub catchment that is 100 occupied by a bioretention cell time series of natural and artificial precipitation are applied to the two sub catchments as drainmod does not support the simulation of sub catchments with different soil profiles and weather conditions a drainmod model describing surface run off from the contributing catchment is needed a separate drainmod model is established for hydraulic simulations of the contributing catchment the reported surface runoff from this first drainmod model is used as the input time series of run on for the drainmod bioretention models 4 2 calibrating hydraulics of the conventional and modified bioretention systems swmm simulation as the detailed soil characteristics were not reported in the field study the conventional bioretention is simulated with parameter values suggested by the swmm help file the value of hydraulic conductivity of the sand layer is adjusted to the minimum value that avoids surface runoff from the bioretention system during artificial rain events the swmm lid module cannot directly describe the submerged layer in the modified bioretention although the elevation of the drainage pipe can be raised in swmm it is not clear from the reported data whether the stormwater flows down into the internal storage layer before being drained whether stormwater mixes with old water retained in the modified bioretention after the previous event would significantly influence the nitrogen concentrations in the drainage therefore to approximate the modified bioretention in swmm the drainage of the lid sub catchment is directed to a storage unit with the same volume as the maximum water content of the submerged layer the reported precipitation of the lid sub catchment and the drainage of the storage units are used to calculate the nitrogen removal rates for the modified bioretention drainmod simulation while drainmod simulates artificial subsurface drainage from agricultural fields the piping systems of bioretention systems may violate the drainage assumptions used in the agricultural system especially when the iws zone is used nevertheless simulation of the drainage from the conventional and modified bioretention systems with drainmod was achieved indirectly through calibration of the soil water characteristic curve green ampt infiltration curve and the water table volume drained upward flux curve based on available references todd and mays 2004 twitty and rice 2001 the bioretention systems are assumed to be homogeneous to simplify the calibration process the soil characteristic curves are calibrated to achieve complete infiltration of all artificial stormwater hydraulic performances of the conventional bioretention are approximated by keeping the simulated depth of the water table at the depth of the drainage pipe for the modified br hydraulic conditions are approximated by keeping the simulated total soil column saturation at around 68 after rain events which is the average saturation rate of the total column when the iws layer is saturated and the upper layer is at field capacity the daily infiltration and drainage volumes reported from drainmod are used to calculate nitrogen removal rates it is worth mentioning that the disadvantages of configuring drainmod to simulate the submerged layer are twofold a the calibrated soil characteristic parameters are no longer representative to the actual soil media thus there can be errors in drainmod calculated water contents even when precipitation and drainage volumes are calibrated and b even if the same soil were to be used in a system with a different depth to the submerged layer the soil water characteristic curve green ampt infiltration curve and the water table volume drained upward flux curve would need to be recalibrated thus as a calibrated approximation of a bioretention system drainmod model cannot make predictions for different designed depths of iws layers and thus would be limited as a design tool 4 3 simulating nitrogen transformation in two phases artificial storm events were applied to the conventional and modified bioretention systems in two phases both of the conventional and modified bioretention systems have bare soil surfaces during phase i january to july 2016 local plants are present during phase ii march to august 2017 swmm simulation swmm uses the parameter of average removal rate avr to estimate contaminant removal in the lid module when the conventional bioretention is simulated the parameter of avr is calibrated for ammonium nitrate and orgn in each of the two phases respectively these calibrated values of avr are directly applied when simulating the modified bioretention for the modified bioretention nitrogen removal in the storage unit is described with equation 7 where hrt is the hydraulic retention time calculated by swmm and k is calibrated for the two phases 7 c o u t c i n exp k h r t drainmod simulation when doing phase i simulation the growing season is set in drainmod in a way that no crops are grown due to late planting a total of 12 parameters describing the reaction rates of decomposition nitrification and denitrification are calibrated to simultaneously simulate removal rates of n o 3 and n h 4 orgn removal rates are not calibrated because orgn concentrations are not reported by drainmod when simulating phase ii the plant uptake process is included the same set of parameter values calibrated for phase i simulation can be directly applied and reproduce n o 3 and n h 4 removal rates well with the only adjustment of one empirical exponent describing the soil moisture factor for denitrification in each phase the conventional and modified bioretention systems share the same set of parameter values comparing calibration results for each nitrogen species the event mean concentrations reported from swmm and the daily average nitrogen concentrations reported from drainmod are used to calculate the simulated nitrogen removal rate of each event ri parameters are calibrated to minimize the relative error erel of the simulated average removal rates r s i m compared to the observed average removal rates r o b s better calibration results are also selected based on lower root mean square error rmse and similar standard deviation st dev with the observed data these evaluation parameters are calculated with equations 8 10 8 e r e l r s i m r o b s r o b s 100 9 r m s e i 1 n r s i m i r o b s i 2 n 10 s t d e v i 1 n r i r 2 n where subscripts sim and obs refer to simulated and observed results respectively and n is the number of artificial storm events 4 4 simulation results after calibration the relative errors of precipitation and drainage volumes of artificial rain events are less than 5 for both swmm and drainmod furthermore swmm and drainmod can accurately simulate the average removal rates r of n o 3 and n h 4 fig 3 with relative errors of less than 10 it is more difficult for the models to accurately reproduce the variability in nitrogen removal between storm events drainmod reproduces the st dev better for conventional bioretention while swmm does better for the modified bioretention for the conventional bioretention system the st dev values from swmm simulations are especially small this reveals a risk of underestimating the variation of nitrogen removal rates when using swmm as a deterministic model for the modified bioretention system r from swmm is influenced by hrt resulting in larger more realistic variations for drainmod the soil temperature factor is a major source of variation of r in the field study the values of st dev in both conventional and modified bioretention systems were significantly smaller in phase ii which suggests that plants may help stabilize nitrogen removal performances the similar st dev of drainmod simulated r between conventional and modified bioretention systems indicate that the plants influences on nitrogen cycling in bioretention systems are not fully described by the drainmod models while this case study does not involve validation of the calibrated swmm and drainmod models the limitations of these two models in predicting bioretention nitrogen removal performances are not hard to see in swmm the impact of temperature plant uptake and antecedent dry periods wang et al 2019 on nitrification and denitrification is not represented drainmod is not capable of directly simulating hydraulic performances of bmps the soil parameters need to be recalibrated for different thicknesses of iws layer and thus the performances of bioretention cannot be predicted at the time of design as stated many challenges arose while building models for the bioretention systems with both swmm and drainmod generally the strengths and weaknesses of simulating nitrogen transformations in bioretention systems are listed in table 6 these characteristics may also be applicable to simulating other stormwater bmps agricultural models and swmm both have their own strengths and weaknesses and neither of them can be directly applied as process based models to simulate nitrogen transportation and transformations in stormwater bmps agricultural models with large time steps are not suitable for urban stormwater simulations more importantly bmp design and structures are not directly represented in agricultural models and indirect representation of the iws layers can introduce errors for hydraulic analysis hydraulic analysis results from stormwater models are more suitable for process based nitrogen simulations in stormwater bmps but still need further enhancements in the vertical direction the soil columns need to be stratified into soil layers according to both bmp designs and the different biochemical reactions that take place within them in order to obtain time series of water contents and water flows as the basis of further process base nitrogen simulations we suggest that it is the most feasible and efficient to make necessary modifications to the hydraulic calculations of bmps in current stormwater models and then adapt math expressions of nitrogen related processes in agricultural models to develop a process based nitrogen module as an extension package to stormwater models 5 implications on establishing the stormwater nitrogen model based on the review and case study we make the following suggestions for establishing a process based stormwater bmp module with nitrogen transformations soil stratification as described in section 3 5 environmental factors can significantly influence nitrogen transformation and transportation detailed soil stratification and vertical profiles of these environmental factors can potentially increase accuracy of the stormwater nitrogen model on the other hand detailed soil stratification requires more boundary conditions and parameter values which are often limited in stormwater bmp field studies and would result in higher model complexity we suggest soil stratifications based on bmp designs such as internal water storage layer or possible soil amendments applied to a certain depth the surface layer can also be separated as its som content soil temperature and oxygen supply can be different from those in deeper soil simulation of thinner soil layers is deemed unnecessary for stormwater bmp for two reasons a media with distinct hydraulic characteristics are already used to fulfill design purposes of different structural layers thus media layers can naturally be divided accordingly b with high infiltration rates hydraulic conditions within each layer tend to be homogeneous in stormwater bmps simple stratifications based on stormwater bmp designs can meet the precision requirements of hydraulic calculations with higher computational efficiency time and spatial resolution simulating nitrogen transformations in stormwater bmps requires small time steps since rain events often complete within hours shorter time steps will also assist the adoption of automatic real time control of stormwater bmps persaud et al 2019 zhang et al 2018 in terms of the spatial resolution site scale simulation is sufficient for nitrogen transformations in each stormwater bmp given their small scale when mixed plant species are grown virginiaq stormwater 2011 virginiatormwater 2011 a single conceptual plant species can be used to approximate the average plant nitrogen uptake rate model structure fig 4 shows the suggested structure for the process based stormwater bmp nitrogen model where optional processes are marked with dashed lines surface run on surface overflow and deposition only occur in the top most soil layer leaching and effluent are only simulated for the bottom layer all three nitrogen species transport with waterflows between soil layers other biochemical processes should be simulated in each soil layer and influenced by environmental conditions through different values of environmental factors surface run on dry and wet deposition are the main nitrogen sources of stormwater bmps plant residuals may release a significant amount of orgn if they are not cleared promptly fertilizers are rarely used in stormwater bmps compared to agricultural land the main removal mechanisms of nitrogen include sediment transport of orgn transport of dissolved organic nitrogen don and inn via water flows leaching drainage and surface runoff plant uptake and release of nxoy gases in urban areas the quality and quantity of surface runoff drainage and leaching can have a significant impact on the pavement pipelines and groundwater of downstream catchments therefore these data are important indicators to measure the performances of stormwater bmps and need accurate simulation literature has reported that don concentrations in stormwater bmps effluent may be similar to nitrate concentrations mohtadi 2017 li and davis 2014 which means that don losses with water flows should not be overlooked in fig 4 the release of n2 is not included as it is neither influential to nitrogen mass balance nor of environmental interest ammonia volatilization is also not included since it is unlikely to happen given the low tn level in stormwater bmps media and the acidic to neutral soil ph environments kavehei et al 2021 some recent papers challenge the sole dominance of nitrification and denitrification in the nitrogen cycle in stormwater bmps and suggest that dissimilatory nitrate reduction to ammonium dnra anammox algae growth plant uptake and heterotrophic nitrogen fixing can all play important roles gold et al 2019 jahangir et al 2017 wen et al 2020 chang et al 2016 given that the quantitative data and math descriptions on these processes are currently limited gold et al 2019 we suggest the overall nitrogen transformation to be expressed only with processes included in fig 4 and the impacts of other processes to be expressed with empirical environmental factors fig 5 shows the suggested division of som sub pools sources of fresh organic matter fom include organic contaminants in deposition and surface run on dead biomass degradation and if applicable plant residuals the cnr of the fom pool should change with som supply over time in stormwater bmps the abundance and composition of the biomass community vary with hydraulic conditions vegetation oxygen supply carbon availability etc and influence biochemical reaction rates liu et al 2021 zuo et al 2019 2020 it is thus necessary to take biomass into consideration for stormwater nitrogen models but the sub pools should be carefully decided to avoid overparameterization or extra uncertainty we suggest that living aerobic and denitrifying biomass should be simulated separately as their requirements for oxygen supply or saturation rate are quite different the emission of carbon dioxide is also marked in fig 5 as a product of decomposition because reporting this data would help estimate the carbon footprints of stormwater bmps decomposition in the suggested model structure decomposition only occurs for the fom pool decomposition rates can be calculated with first order kinetics limited by the environmental factor and the released inn can then be calculated with the cnr of the fom pool nitrification and denitrification in stormwater bmps decomposition and nitrification are considered the main reason for net n o 3 export hsieh 2007 denitrification and the resulted n2 emission is believed to be the most important mechanism of tn removal igielski 2019 therefore the accurate simulation of nitrification and denitrification processes is crucial to the stormwater nitrogen model as listed in table 3 nitrification and denitrification are simulated with either first order kinetics or the michaelis menten function in the agricultural models while both forms are applicable the michaelis menten function does bring in one more parameter to calibrate which is the half saturation constant thus first order kinetics is suggested different from other biochemical reactions denitrification only happens when the soil saturation rate is above a threshold and there is a disagreement on the threshold value among agricultural nitrogen modules according to table 3 and table a2 here we suggest that the threshold value should be either calibrated with available data or user defined biomass growth decay and degradation the procedure of simulating immobilization in the agricultural nitrogen modules can be adopted here firstly immobilized carbon can be estimated as a fraction of decomposed carbon and the fraction varies with soil moisture soil temperature and biomass abundance secondly immobilized inn is calculated with the constant cnr values of the living biomass pools lastly immobilization rates are reduced to the allowed level when inn is insufficient given that fixation is not included biomass decay and degradation can also be estimated with fractions of living and dead biomass gas emissions accurate simulation of nxoy emission can be of great interest in the perspective of environmental protection leahey and hansen 1990 smith 2010 it has been reported that the amount of n2o released by urban soil is similar to that in corn farmland and reaches 0 24 g n m2 year kaye 2004 n2o emission from stormwater ponds may occupy 0 15 of tn in the ponds under the influence of environmental factors blaszczaket al 2018 therefore accurate prediction of n2o emission is among the aims of a process based stormwater nitrogen model among the gas emission equations listed in table 4 the set from wnmm can be more suitable for stormwater nitrogen modeling as it has simpler forms and has a smaller number of empirical parameters that need calibration plant uptake in agricultural models inn taken by crops are estimated with the mass of crop growth and nitrogen contents in plants this approach can be applied to the stormwater nitrogen model to estimate the plant uptake rate with easily obtained parameters even when the complex influences of plants on the nitrogen cycle in bmps are not yet fully understood when inn is insufficient plant growth should be limited skorobogatov et al 2020 summarized current research findings of the role of plants in bioretention systems aside from plant uptake potential impacts of plants may include hydraulic impact enhanced evapotranspiration and preferential flow and the effects on soil microorganisms such as increasing the oxygen content in the root zone increasing soil organic matter content in the root zone and simultaneous acceleration of decomposition nitrification and local denitrification wanget al 2017 morseet al 2018 as a simplification the complex influences of plants on biochemical reactions can be estimated with an empirical factor of f v e g indicating overall enhancement on biochemical reactions caused by plants with values larger than 1 0 and overall impairment with values between 0 0 and 1 0 nitrogen transportation equations 4 6 can be applied to stormwater nitrogen models to calculate inn and don transport through leaching drainage and surface runoff orgn transported with sediment can be roughly estimated with concentrations of sediment the content of fom that is not dissolved and the cnr of the fom pool amendments are commonly used in media in stormwater bmps to enhance the removal efficiency of pathogens n h 4 phosphates dissolved organic carbon doc and heavy metal ions mohtadi 2017 wium andersenet al 2012 van lienden et al 2010 smith 2011 through increased cation exchange capacity and specific surface area in a process based stormwater nitrogen model we suggest that a cec factor f c e c that has a value in the range of 0 0 1 0 can be applied to equations 5 and 6 to simulate the decrease of nitrogen transport with water flows environmental factors in stormwater bmps soil moisture soil temperature soil ph cnr and orgc availability can all impact biomass growth rates and biochemical reaction rates wang et al 2019 søberg et al 2021 f c e c and f v e g are also suggested all of these environmental factors except for f v e g should have values in the range of 0 0 1 0 taking the value of 1 0 under optimum conditions for the simulated biochemical reaction and 0 0 under extreme environmental conditions where the biochemical reactions cease when developing the stormwater nitrogen model to balance among simulation accuracy computational efficiency and user friendly operation of parameter calibration we suggest that the reactions rates of first order biochemical reactions in each time step should be simulated with equation 11 11 n p r o c e s s n s u b k p r o c e s s f e n where nprocess is the rate of biochemical reactions expressed by nitrogen nsub is the nitrogen content of the corresponding nitrogen pool kprocess is the optimum reaction rate under ideal environmental conditions without plants and f e n is the overall environmental factor taking a reference from drainmod we suggest that f e n can be calculated by multiplying two factors that have the largest deviation from 1 0 in this way the two most limiting environmental factors are taken into account in terms of the specific expressions of f t f s f p h f c n r and f o c we suggest that the equations from wnmm can be adopted see appendix as they are in simpler forms and involves fewer parameters to calibrate 6 summary in this review the structures and math bases of six agricultural nitrogen modules are summarized and compared the model build up and calibration results from drainmod and swmm on two bioretention systems are reported with a perspective of assisting the development of a process based stormwater nitrogen model lastly suggestions are offered for building a process based nitrogen model for stormwater bmps agricultural nitrogen modules are to some extent consistent in their model structures nitrogen cycle and mathematical descriptions of decomposition nitrification and denitrification processes but show more variation in the division of som sub pools and the description of environmental factors while many of these model structures basic assumptions simplifications and math equations are applicable to stormwater nitrogen models special attention should be given to the differences between agricultural fields and stormwater bmps important differences include time step requirements design of drainage systems soil hydraulic characteristics contributing surface run on the importance of different biochemical processes nitrogen sources and sinks and the influences of environmental factors the case study reveals that average nitrogen removal rates of field scale bioretention systems can be reproduced by both swmm and drainmod but there are still many challenges in simulating the nitrogen cycle and predicting nitrogen removal rates of bioretention systems with either of the two modeling tools lessons from this review and model comparison provide recommendations for the development of a more mechanistically accurate nitrogen model for bmps the establishment and application of such a model should improve understanding of nitrogen related processes in bmps and spur innovation of improved designs declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was funded as part of the national science foundation grant award 1737432 scc irg track 1 overcoming social and technical barriers for the broad adoption of smart stormwater systems and the university of virginia appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2022 105363 
25603,we developed a decision support system dss coupled with a flood alert web application and evaluated in the prosa basin midwestern brazil to send early flood warning messages to ordinary people the hydrologic engineering center s hydrologic modeling system hec hms and river analysis system hec ras were used as the core of flood alert system as an input of the calibrated hec hms model we used the quantitative precipitation forecast qpf of weather research and forecasting wrf the application based on progressive web application pwa was developed to support the visualization of flood forecasted and to deliver early warning messages for mobile devices our findings show the proposed flood alert system is able to simulated flood events using qpf of wrf and with a 48 h lead time the dss developed here is an important information to decision making by the public authorities as well as to ordinary people for reducing flood disasters keywords flood alert flood prediction runoff stormwater 1 introduction flooding in urban areas due to extreme stormwater in short time has caused material economic environmental and human losses in several places worldwide it is probably the most devastating widespread and frequent natural disaster present in human society nkwunonwo et al 2020 teng et al 2017 according to wmo 2013 floods are among the most common natural disaster and have the greatest potential for damage of all natural disasters globally for example in brazil some metropolises have experienced unprecedented heavy rainfall events leading to deadly floods the city of sao paulo 12 3 million people received about 114 mm of rainfall on 10 february 2020 it was the second highest volume in 24 h in february in the last 77 years of rainfall records in january 2020 the city of belo horizonte 2 5 million people received the largest 24 h rainfall 171 8 mm according the last 110 years of rainfall records since floods represent a significant role in the number of natural disasters globally freer et al 2011 a great effort has been made to understand assess and predict flood events and their negative impacts sousa et al 2021 thus computational models have been developed to address this purpose for example in early alert system the development and application of flood models usually comprises three steps during simulation the conversion of rainfall to runoff flood hydrograph the propagation of flood wave across the river channel and mapping of flood areas dimitriadis et al 2016 models are widely used to map flooding and flood exposure in urban areas ramirez et al 2016 assessing the damage caused by extreme rainfall events silvestro et al 2016 quantification of flood economic risk garrote et al 2016 assessing the impact of urbanization campana and tucci 2001 miller and hess 2017 climate change on urban flood volumes mattos et al 2021 zhou et al 2018 and real time early flood forecasting neri et al 2020 nester et al 2016 early alert system is a fundamental part of the whole flood risk management because can enhance people preparedness against floods disasters neri et al 2020 plate 2002 establishing a flood warning system at risk requires the combination of data collection forecasting computational models warning and human resources wmo 2013 the major technological infrastructure required for the flood alert system is a data collection from gauging an operating system and hardware workstations software needed to process analyze and display observation data an application program to dissemination of flood warning and maintenance and backup program to ensure the data availability over time ucar 2010 in general the flood alert application programs have the following tasks azam et al 2017 real time processing and storing of collected data display streamflow forecasting and predicted water level information checking the predicted water level for exceedance of threshold value and determination of parameters using observed data flood alert systems can operate with decision support systems dss that has been developed by using models of flood management for example todini 1999 developed an integrated tool for planning and management that allows location of areas at risk and estimation of expected damages to forecast floods and inundation koussis et al 2003 proposed an operational system for forecasting flood risk using an integrated hydro meteorological model ahmad and simonovic 2006 created a dss by integrating the database topographic hydrologic and land use data model base and graphical tools to assist decision makers during different phases of food management qi and altinakar 2011 presented a geographical information system gis based dss for flood management using a framework based on a two dimensional 2d flood analysis model mure ravaud et al 2016 developed an operational real time flood forecasting system using data assimilation to provide hourly flood alerts in a flood alert system the warning lead time is critical because longer the lead time earlier the people will be aware about flood hence increasing this time improves the potential to limit possible loss of property and or human lives the developed numerical weather prediction nwp models in the past decades is a good form to provide a longer lead time quantitative precipitation forecast qpf li et al 2017 wmo 2011 there are many weather prediction models into operational use such as the european centre medium range weather forecasts ecmwf ensemble prediction system eps molteni et al 1996 ye et al 2014 the numerical forecast model of the china meteorological agency xue and liu 2007 the nwp model of the japan meteorological agency yamaguchi et al 2009 and the weather research and forecasting wrf model chu et al 2018 maussion et al 2011 in brazil short and medium range flow forecasts are used for the scheduling of hydropower reservoirs operation and flood forecasting in vulnerable locations the center for natural disaster monitoring and alert cemaden led by the ministry of science and technology mct was established for developing testing and implementing monitoring and forecast systems for natural disasters in addition most of the operational flood forecast systems in brazil are led by the geological survey of brazil cprm it operates forecast systems in vulnerable areas at some rivers using data based models for lead times usually less than 3 days fan et al 2016 however alert systems is still a challenge in brazil because early flood forecasting is deficient casagrande et al 2017 for instance the city of campo grande 906 000 people in the mato grosso do sul state has been subject to flooding despite the implementation of many conventional stormwater drainage systems against floods e g dams and detention basins particularly the prosa basin pb that is located in campo grande have experienced several floods the development of alert web application could be minimizing negative social and economic impacts due flooding in this area in this study we develop a flood alert web application for the residents of prosa basin and integrating it to a decision support system 2 material and methods 2 1 study area the prosa basin has an area of 32 km2 and it is in the municipality of campo grande mato grosso do sul state brazil fig 1 this basin is mainly flat with slope steepness of ranging from 3 8 to 8 0 the main rivers in the basin are prosa soter desbarrancado joaquim portugues revellion and pindare river pddu 2008 the annual mean rainfall during the hydrological year from october to september is 1 417 203 mm for the period between 1992 and 2016 the monthly minimum and maximum rainfall events were in winter 34 mm in july and summer 217 mm in january respectively the daily mean air temperature is 24 2 5 2 c according to the köppen climate classification the climate in the pb is aw type tropical with dry winter and rainy summer alvares et al 2013 the pb is characterized by large fraction of impervious surface mostly commercial and residential areas the land use can be classified into five categories grass 24 forests 19 bare soil 6 asphalt pavement 10 building area i e 41 of residential and commercial areas the predominant soil type is sandy clay loam texture and stable infiltration rate changes approximately from 10 mm h 1 to 50 mm h 1 planurb 1991 sobrinho 2015 the basin has recurrent flood events and the river regime is influenced by dams bridges holding basins power dissipation structures and channels with different wear layer nevertheless historical records of stormwater drainage and flood damage indicate that the region has experienced an increase in flood frequency and magnitude due to growth urbanization pddu 2008 3 decision support system components we developed a decision support system dss for flood management by an coupled computational modelling approach as follows ad hoc 1 qpf data acquisition fed by online network data transfer 2 the river flow is forecasted by a semi distributed hydrological model 3 routed by a 1d 2d unsteady river flow hydraulic model to generate flood maps and 4 the flood alert is sent to an application app developed for mobile devices fig 2 we used the hydrologic engineering center hec of u s army corps of engineers usace which has been developing computer software for hydrological engineering and water resource management since 1964 available at http www hec usace army mil hec was selected because it is peer reviewed user friendly and free of charge in the public domain for the application of rainfall runoff and river flood analysis hec hms hydrological modeling system and hec ras river analysis system were selected respectively the measured and forecast precipitation was used to combine observed precipitation data and future precipitation qpf into a single precipitation dataset that is inserted in the hec hms moreover the hec rts real time simulation program was used to link data and programs the framework uses the hec data storage system hec dss database file format to send data between hec hms and hec ras models hec rts is a public version of cwms the corps water management system used by the usace which provides support for operational decision making by forecast simulation modeling using hec models for instance rainfall runoff modeling with hec hms based on gaged or radar based precipitation and qpf or other precipitation forecasting the hec ras computes river stage and water level in the floodplain areas from the forecast precipitation charley 2010 3 1 hec hms hydrological model the hec hms is a conceptual hydrological model designed to simulate the rainfall runoff process of dendritic watershed systems and can be applied to analyze urban flooding flood frequency flood loss reduction and flood warning system planning usace hec 2015 several studies have used hec hms as a part of dss to flood forecasting events reichel et al 2009 proposed a framework to assess real time flood forecast integrating radar rainfall data gis hec hms and a short term precipitation nowcasting system fakhruddin 2015 presented a flood forecasting model by assimilating the satellite and hydrological gauge rainfall data into hec hms şensoy et al 2018 developed a dss for real time flood management using integrated models i e hec hms and hec ras the hec hms contains four main components usace hec 2016 a an analytical model to calculate overland flow runoff and river channel routing flood wave propagation b a graphical user interface illustrating hydrologic system components c a system for storing and managing data and d a display for reporting the model outputs the model includes hydrological components such as runoff loss transformation baseflow and river flow routing in this study the pb was discretized into 16 subcatchments fig 1 and the hec hms simulation was performed for individual rainfall events the model components include computing runoff depth soil conservation service curve number method scs cn runoff and interflow transformation clark s unit hydrograph method baseflow recession method and river flow routing scheme muskingum cunge method the datasets used in catchment delineation land cover classification transformation method were obtained from remote sensing whereas baseflow routing and loss method parameters were derived from observed and remote sensing data and literature usda nrcs 1986 3 2 hec ras hydraulic model we used hec ras model in the dss to compute river stages and eventual floodplain areas using the forecasted hydrographs hec ras simulations was performed by combining 1d and 2d within a single unsteady river flow model that is 1d modeling in the main river channel and 2d modeling on the floodplain areas here hec ras simulations was conducted by combining 1d and 2d modeling in the river channel and floodplain of the main river hec ras is an integrated system of software designed for interactive use in a multi tasking multi user network environment the system is comprised of a graphical user interface gui separate hydraulic analysis components data storage and management capabilities graphics and reporting facilities the hec ras system contains four one dimensional river analysis components and the current version of hec ras supports steady and unsteady flow water surface profile calculations combined 1d and 2d hydrodynamics spatial mapping of many computed parameters depth water surface stage river flow and velocity water temperature analysis water quality analyses and solves the 1d and 2d full saint venant equations for an unsteady open channel flow brunner 2016 3 3 flood model calibration and validation the hec hms and hec ras models were calibrated and validated using discharge measured data between april 2015 and november 2017 the permeable area information was used according to the land cover study over the 2016 year the hec hms parameters of calibration were the time of concentration tc of the prosa basin storage coefficient r and curve number cn table s1 whereas hec ras parameter of calibration was f the manning s roughness coefficient n table s2 the initial values of parameters needed for the calibration are required to start an optimization process and were calculated mostly by using the mathematical methods available from hydrologic textbooks the time of concentration was calculated using technical report 55 tr 55 method which is computed by accumulating runoff travel times for consecutive components of the drainage conveyance system sheet flow shallow concentrated flow and open channel flow usda nrcs 1986 the initial values of the storage coefficient were estimated by nash model yoo et al 2014 and the cn was estimated as a function of land use and soil type according to tr 55 usda nrcs 1986 the initial value of the manning s roughness coefficient was selected by field campaigns photographs and literature values brunner 2016 the flood model was calibrated using two individual rainfall events and validated against six other events to evaluate the performance of model calibration and validation the coefficient of determination r2 the rmse observations standard deviation ratio rsr nash sutcliffe efficiency nse index and the kling gupta efficiency kge was used against measured discharge data in the pb outlet 3 4 weather research and forecasting the quantitative precipitation forecast qpf of weather research and forecasting wrf is provide by weather forecasting and climate research cptec in brazil the qpf is available at with five lead times 24 36 48 60 and 72 h temporal resolution of 1 h and grid spatial resolution of 5 km 5 km the effort to develop wrf has begun in the later 1990 s as a collaborative partnership of the national center for atmospheric research ncar with several institutions in the united states of america powers et al 2017 since august 1 2018 the data are available at the centro de previsão de tempo e estudos climáticos cptec website http ftp cptec inpe br modelos tempo wrf ams 05km several studies have evaluated wrf qpfs kumar et al 2008 showed that the wrf model could reproduce the heavy rainfall event and its dynamical and thermodynamical characteristics givati et al 2012 verified that the daily precipitation amount estimated by wrf showed good agreement against measured rainfall jabbari et al 2018 investigated the forecasted precipitation and the observed precipitation and concluded that the wrf model underestimated precipitation at the point and catchment scale it performed better at the catchment scale rogelis and werner 2018 assessed the potential of numerical weather prediction models for flood early warning and verified that post processed wrf precipitation adds value to the flood early warning system although it showed little added value when compared to climatology 3 5 development of flood alert system the flood alert web application was developed to provide information for flood potential risk so that early effective practices could be taken the application s front end was developed with progressive web application pwa standards a web application that has more access to the hardware features such as native applications it can be executed by the most varied devices through html 5 javascript and css technologies and also can be installed as an application on mobile biørn hansen et al 2017 thus the application becomes more widespread for the users moreover because it run depends on few hardware requirements vuejs and vuetify are javascript frameworks the second is also a css framework which were chosen to build the pwa these technologies have great performance complete definitions and tools for a responsive design that adapts to different screen sizes for handling application routes data persistence and other features required by the application pšenák and tibenský 2020 the front end gets data from a flooding event through an api that fetches information from a database thus it presents the flood spot the water level and details of certain sections of the basin drawn on the city map using the google maps api it is also able to send flood risk alerts to points in the basin via google cloud messaging the back end of the application is only responsible for hosting the application the database and also for sending notifications this is the reason for choosing google firebase service platform the platform has a free modality with functions for prototyping which does not need the implementation of an infrastructure capable to operate it application hosting required the firebase hosting function a non relational database for storing lightweight and textual information capable of moving them at high speed required the firebase real time database function chatterjee et al 2018 to storage of large files such as figures we used the fire storage function google cloud messaging was the service needed to create and send notifications to the application in addition to these operators another computer application was developed in python code it is responsible for populating google firebase databases through its api this application processes and filters the data generated in the simulation contained in two products a dss and sqlite database the first has information on water level flow and precipitation while the second has images of the simulation of the flooded surface it also fills up with the database with information from sections of the basin 4 results and discussion 4 1 calibration and validation of hec model the calibrated parameters of hec hms model table s1 and hec ras model table s2 were used to generate hydrographs for prosa basin using the dss fig 2 the assessment of the model performance is summarized in table 1 the results show that the flood model has a good performance for both calibration and validation periods the mean rsr value of 0 38 r2 and nse values both exceeds 0 80 further we found value of kge 0 50 indicating that the model can simulate the rainfall runoff process satisfactorily in the prosa basin fig 3 shows the flood hydrographs performance for two calibration and validation events 4 2 flood alert application structure to obtain the river stage and floodplain simulations graphically as a map dss output we used the calibrated hec model it should be emphasized that wfr qpf was used as input in the calibrated hec model to generate dss output then the dss output was used as input data into flood alert application to send warning messages to end users fig s4 presents the two main steps for the flood alert running between the two main steps there is an intermediate stage that represents the data traffic carried out by the google firebase services and that allows communication between the data management application and the web application 4 2 1 data management fig s5 represents the procedures performed by the data management application the first step to be performed is the register of information about the sections from where the water height precipitation and flow data should be collected inside the dss file after the flood simulation fig 4 b shows the form for filling in the section data only two fields are not texts or numbers these are the image field which must be filled with a cover image and the csv field which must be filled with the directory of a csv file with the heights and lengths of the section s shape these data are compiled into a structure represented in fig s1 which is sent to the real time database after registering all the desired sections the dss and db sqlite files resulting from the simulation must have their directories inserted in their respective fields fig 4a represents the screen where it should be done all sections stored in the database are downloaded via the google firebase api the dss name and dss code attributes of the sessions allow to access the routes and identify the session in the dss file to obtain precipitation flow and water level data although it is possible to get this information for each session rainfall and flow are only obtained from a specific session the reason is that the precipitation used for the simulation is uniform throughout the region therefore it is the same found in all sessions and the flow whose study is essential occurs only in one of them after having each session s forecast simulated data obtained from the dss file it is possible to send them to the real time database through its api the object is added to the flood data attribute of the sessions to prevent data incompatibility before the new data are sent to the server the availability of images for this simulation in the indicated db sqlite file is checked these images are blocks called tiles that together represent the complete flood area while this process takes place the values of the water level and the session s threshold of each session are compared if the water level exceeds the session s threshold a notification log is sent to google cloud messaging li et al 2013 after sending the flood data of each session the images of the flood area must be sent to fire storage in addition the data about these image blocks must also be sent to the real time database through sqlite queries to the db file a structure is built by data taken see fig s2 some attributes that can be obtained are the limits in all directions the maximum zoom to where images are available and the center of the simulation area information about the image blocks tile is also obtained such as the position of that tile in the full image described by the position in the rows and columns of the matrix the zoom of the map that this image corresponds to and the download address of the tile in the fire storage to facilitate the relationship of this information with the image tiles stored in fire storage a pattern for the directories and files have been adopted the forecast date is the directory name and the tile information is the file name it simplifies the download urls which this way is terminated as shown in fig s3 4 2 2 interface and features of the web application to demonstrate the application s interface and features we simulated the rainfall event of november 18 2020 using wrf qpf of 48 h lead time fig 5 overall the flow simulated ranged from 0 41 to 21 m3 s 1 for an event rainfall of 25 8 mm after the water stage and flood inundation map data are processed and sent to the database the progressive web application pwa searches for the information and shows them to the user fig 6 a and fig 6c presents the home screen of the application on smaller displays e g mobile devices the bottom of this screen has a tab selector while on larger displays there is a tollbar on the top of the screen with two destination buttons the default screen consists of a map with the flood surface area highlighted in blue and colored markers represent the predicted state of the water level at that point the green color means that the area is safe the yellow color means it is in a warning state and the red color means it is a dangerous area for the event of 18 november 2020 all markers were green indicating that the predicted level is less than the threshold of the selected time 20 00 on the top left corner of the screen there is a date picker box the initial selected date is the next available date forecasted on the top right corner of the screen there is a floating button that expands and shows options like information about the application and report bugs on largest displays this function is on the left side of the toolbar on larger screens on the left side of the screen there are two graphs one graph showing precipitation and the other the flow by time for the selected day the main tool used in this pwa tab is the google maps api for the presentation of the flood area and the position of the sections of interest to plot the session markers the coord attribute is used which are its coordinates and to analyze the threshold situation the height of its limit limit attribute is compared with the water level height attribute of the flood data item which has timestamp equal to the one selected in the date picker the prec and flow attributes of any flood data item are used for the presentation of precipitation and flow graphs while date options in the date picker are obtained through the timestamps in the tiles items the plotting of the tiles images that together represent the flood area on the map is possible through the google maps api overlaymaptypes method which is responsible for assembling the image matrix using the information of the row column and applied zoom level when the user clicks on the markers they show information about the selected river section see fig 6 as shown in fig 6b the first tab shows an image of the area its description the water level and the state of the river on the date furthermore there are two other tabs with more information about the chosen section the second tab fig 7 a presents an illustration of the river cross section in black and the forecasted water level in blue where the horizontal axis represents its width and the vertical axis represents its depth in meters in this option there is a slider picker on the bottom side of the screen in which the user can select the hour to be presented in the illustration it changes the water level and the state of the river section according to the chosen hour the third tab fig 7b shows the forecasted water level according to the time of simulation the water level is on the vertical axis and the time on the horizontal axis there is a black dot that marks the hour and water level on the previously selected date in the homepage 5 conclusions flood alert systems are vital as a management tool to mitigate flood risk disasters here we focused on the development of a flood alert application app to send warning message to population the prosa basin 32 km2 in campo grande city brazil was selected as a case study because it is a recurrent flooding area we used as core of flood alert system is the hydrological hec hms and hydraulic hec ras models as an important aspect the hydrological hydraulic models were calibrated and validated using different rainfall events then a flood alert web application was developed to provide information for flood potential risk and can be run in the most electronic devices such as mobile devices for the data storage it was chosen a non relational database that is hosted by google firebase platform the advantage of this platform is that it can provide updated data in real time we also used the google maps api to show flooding areas the river stage and hydrological and hydraulics details of any choose section of the main river channel in addition the application is able to send flood risk alerts to points in the basin via google cloud messaging the hec hms and hec ras models have good performances for both calibration and validation periods nse 0 80 kge 0 55 r2 0 80 and rsr 0 70 indicating that the models can simulate the rainfall runoff process satisfactorily in the prosa basin furthermore the proposed flood alert system is able to simulated flood events using quantitative precipitation forecast qpf of weather research and forecasting wrf with a 48 h lead time this flood alert application has potential to facilitate the widespread of the warning messages quickly among population ultimately this software has potential to be used in other catchments thus this flood alert system will be useful to policy makers as well as to residents for reducing flood risk in the study area in future flood alert application expected to incorporate new forecast data particularly quantitative precipitation estimation qpe of weather radar data availability the data management software and the flood alert progressive web application were developed by the hydrology and water security research group federal university of mato grosso do sul hws ufms and are available at www github com leocrivels flood alert datamanagement and www github com leocrivels flood alert both are distributed under the gnu general public license v3 0 the data management software is written in python 3 8 and requires the packages numpy tkinter pyre base json sys cdv date time requests google cloud pydsstools and sqlite3 it has been built and tested in the visual studio code editor as included in the open source python distribution platform anaconda www anaconda com the flood alert application is written in html javascript and css using vuejs 2 6 having package dependencies such as axios chart js firebase vue google maps and vuetify all dependencies are handled by npm and node js 16 0 declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study was supported by grants from the ministry of science technology innovation and communication mctic and national council for scientific and technological development cnpq grants422947 2018 0 and 309752 2020 5 and coordenação de aperfeiçoamento de pessoal de nível superior brasil capes finance code 001 and capes print appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2022 105367 
25603,we developed a decision support system dss coupled with a flood alert web application and evaluated in the prosa basin midwestern brazil to send early flood warning messages to ordinary people the hydrologic engineering center s hydrologic modeling system hec hms and river analysis system hec ras were used as the core of flood alert system as an input of the calibrated hec hms model we used the quantitative precipitation forecast qpf of weather research and forecasting wrf the application based on progressive web application pwa was developed to support the visualization of flood forecasted and to deliver early warning messages for mobile devices our findings show the proposed flood alert system is able to simulated flood events using qpf of wrf and with a 48 h lead time the dss developed here is an important information to decision making by the public authorities as well as to ordinary people for reducing flood disasters keywords flood alert flood prediction runoff stormwater 1 introduction flooding in urban areas due to extreme stormwater in short time has caused material economic environmental and human losses in several places worldwide it is probably the most devastating widespread and frequent natural disaster present in human society nkwunonwo et al 2020 teng et al 2017 according to wmo 2013 floods are among the most common natural disaster and have the greatest potential for damage of all natural disasters globally for example in brazil some metropolises have experienced unprecedented heavy rainfall events leading to deadly floods the city of sao paulo 12 3 million people received about 114 mm of rainfall on 10 february 2020 it was the second highest volume in 24 h in february in the last 77 years of rainfall records in january 2020 the city of belo horizonte 2 5 million people received the largest 24 h rainfall 171 8 mm according the last 110 years of rainfall records since floods represent a significant role in the number of natural disasters globally freer et al 2011 a great effort has been made to understand assess and predict flood events and their negative impacts sousa et al 2021 thus computational models have been developed to address this purpose for example in early alert system the development and application of flood models usually comprises three steps during simulation the conversion of rainfall to runoff flood hydrograph the propagation of flood wave across the river channel and mapping of flood areas dimitriadis et al 2016 models are widely used to map flooding and flood exposure in urban areas ramirez et al 2016 assessing the damage caused by extreme rainfall events silvestro et al 2016 quantification of flood economic risk garrote et al 2016 assessing the impact of urbanization campana and tucci 2001 miller and hess 2017 climate change on urban flood volumes mattos et al 2021 zhou et al 2018 and real time early flood forecasting neri et al 2020 nester et al 2016 early alert system is a fundamental part of the whole flood risk management because can enhance people preparedness against floods disasters neri et al 2020 plate 2002 establishing a flood warning system at risk requires the combination of data collection forecasting computational models warning and human resources wmo 2013 the major technological infrastructure required for the flood alert system is a data collection from gauging an operating system and hardware workstations software needed to process analyze and display observation data an application program to dissemination of flood warning and maintenance and backup program to ensure the data availability over time ucar 2010 in general the flood alert application programs have the following tasks azam et al 2017 real time processing and storing of collected data display streamflow forecasting and predicted water level information checking the predicted water level for exceedance of threshold value and determination of parameters using observed data flood alert systems can operate with decision support systems dss that has been developed by using models of flood management for example todini 1999 developed an integrated tool for planning and management that allows location of areas at risk and estimation of expected damages to forecast floods and inundation koussis et al 2003 proposed an operational system for forecasting flood risk using an integrated hydro meteorological model ahmad and simonovic 2006 created a dss by integrating the database topographic hydrologic and land use data model base and graphical tools to assist decision makers during different phases of food management qi and altinakar 2011 presented a geographical information system gis based dss for flood management using a framework based on a two dimensional 2d flood analysis model mure ravaud et al 2016 developed an operational real time flood forecasting system using data assimilation to provide hourly flood alerts in a flood alert system the warning lead time is critical because longer the lead time earlier the people will be aware about flood hence increasing this time improves the potential to limit possible loss of property and or human lives the developed numerical weather prediction nwp models in the past decades is a good form to provide a longer lead time quantitative precipitation forecast qpf li et al 2017 wmo 2011 there are many weather prediction models into operational use such as the european centre medium range weather forecasts ecmwf ensemble prediction system eps molteni et al 1996 ye et al 2014 the numerical forecast model of the china meteorological agency xue and liu 2007 the nwp model of the japan meteorological agency yamaguchi et al 2009 and the weather research and forecasting wrf model chu et al 2018 maussion et al 2011 in brazil short and medium range flow forecasts are used for the scheduling of hydropower reservoirs operation and flood forecasting in vulnerable locations the center for natural disaster monitoring and alert cemaden led by the ministry of science and technology mct was established for developing testing and implementing monitoring and forecast systems for natural disasters in addition most of the operational flood forecast systems in brazil are led by the geological survey of brazil cprm it operates forecast systems in vulnerable areas at some rivers using data based models for lead times usually less than 3 days fan et al 2016 however alert systems is still a challenge in brazil because early flood forecasting is deficient casagrande et al 2017 for instance the city of campo grande 906 000 people in the mato grosso do sul state has been subject to flooding despite the implementation of many conventional stormwater drainage systems against floods e g dams and detention basins particularly the prosa basin pb that is located in campo grande have experienced several floods the development of alert web application could be minimizing negative social and economic impacts due flooding in this area in this study we develop a flood alert web application for the residents of prosa basin and integrating it to a decision support system 2 material and methods 2 1 study area the prosa basin has an area of 32 km2 and it is in the municipality of campo grande mato grosso do sul state brazil fig 1 this basin is mainly flat with slope steepness of ranging from 3 8 to 8 0 the main rivers in the basin are prosa soter desbarrancado joaquim portugues revellion and pindare river pddu 2008 the annual mean rainfall during the hydrological year from october to september is 1 417 203 mm for the period between 1992 and 2016 the monthly minimum and maximum rainfall events were in winter 34 mm in july and summer 217 mm in january respectively the daily mean air temperature is 24 2 5 2 c according to the köppen climate classification the climate in the pb is aw type tropical with dry winter and rainy summer alvares et al 2013 the pb is characterized by large fraction of impervious surface mostly commercial and residential areas the land use can be classified into five categories grass 24 forests 19 bare soil 6 asphalt pavement 10 building area i e 41 of residential and commercial areas the predominant soil type is sandy clay loam texture and stable infiltration rate changes approximately from 10 mm h 1 to 50 mm h 1 planurb 1991 sobrinho 2015 the basin has recurrent flood events and the river regime is influenced by dams bridges holding basins power dissipation structures and channels with different wear layer nevertheless historical records of stormwater drainage and flood damage indicate that the region has experienced an increase in flood frequency and magnitude due to growth urbanization pddu 2008 3 decision support system components we developed a decision support system dss for flood management by an coupled computational modelling approach as follows ad hoc 1 qpf data acquisition fed by online network data transfer 2 the river flow is forecasted by a semi distributed hydrological model 3 routed by a 1d 2d unsteady river flow hydraulic model to generate flood maps and 4 the flood alert is sent to an application app developed for mobile devices fig 2 we used the hydrologic engineering center hec of u s army corps of engineers usace which has been developing computer software for hydrological engineering and water resource management since 1964 available at http www hec usace army mil hec was selected because it is peer reviewed user friendly and free of charge in the public domain for the application of rainfall runoff and river flood analysis hec hms hydrological modeling system and hec ras river analysis system were selected respectively the measured and forecast precipitation was used to combine observed precipitation data and future precipitation qpf into a single precipitation dataset that is inserted in the hec hms moreover the hec rts real time simulation program was used to link data and programs the framework uses the hec data storage system hec dss database file format to send data between hec hms and hec ras models hec rts is a public version of cwms the corps water management system used by the usace which provides support for operational decision making by forecast simulation modeling using hec models for instance rainfall runoff modeling with hec hms based on gaged or radar based precipitation and qpf or other precipitation forecasting the hec ras computes river stage and water level in the floodplain areas from the forecast precipitation charley 2010 3 1 hec hms hydrological model the hec hms is a conceptual hydrological model designed to simulate the rainfall runoff process of dendritic watershed systems and can be applied to analyze urban flooding flood frequency flood loss reduction and flood warning system planning usace hec 2015 several studies have used hec hms as a part of dss to flood forecasting events reichel et al 2009 proposed a framework to assess real time flood forecast integrating radar rainfall data gis hec hms and a short term precipitation nowcasting system fakhruddin 2015 presented a flood forecasting model by assimilating the satellite and hydrological gauge rainfall data into hec hms şensoy et al 2018 developed a dss for real time flood management using integrated models i e hec hms and hec ras the hec hms contains four main components usace hec 2016 a an analytical model to calculate overland flow runoff and river channel routing flood wave propagation b a graphical user interface illustrating hydrologic system components c a system for storing and managing data and d a display for reporting the model outputs the model includes hydrological components such as runoff loss transformation baseflow and river flow routing in this study the pb was discretized into 16 subcatchments fig 1 and the hec hms simulation was performed for individual rainfall events the model components include computing runoff depth soil conservation service curve number method scs cn runoff and interflow transformation clark s unit hydrograph method baseflow recession method and river flow routing scheme muskingum cunge method the datasets used in catchment delineation land cover classification transformation method were obtained from remote sensing whereas baseflow routing and loss method parameters were derived from observed and remote sensing data and literature usda nrcs 1986 3 2 hec ras hydraulic model we used hec ras model in the dss to compute river stages and eventual floodplain areas using the forecasted hydrographs hec ras simulations was performed by combining 1d and 2d within a single unsteady river flow model that is 1d modeling in the main river channel and 2d modeling on the floodplain areas here hec ras simulations was conducted by combining 1d and 2d modeling in the river channel and floodplain of the main river hec ras is an integrated system of software designed for interactive use in a multi tasking multi user network environment the system is comprised of a graphical user interface gui separate hydraulic analysis components data storage and management capabilities graphics and reporting facilities the hec ras system contains four one dimensional river analysis components and the current version of hec ras supports steady and unsteady flow water surface profile calculations combined 1d and 2d hydrodynamics spatial mapping of many computed parameters depth water surface stage river flow and velocity water temperature analysis water quality analyses and solves the 1d and 2d full saint venant equations for an unsteady open channel flow brunner 2016 3 3 flood model calibration and validation the hec hms and hec ras models were calibrated and validated using discharge measured data between april 2015 and november 2017 the permeable area information was used according to the land cover study over the 2016 year the hec hms parameters of calibration were the time of concentration tc of the prosa basin storage coefficient r and curve number cn table s1 whereas hec ras parameter of calibration was f the manning s roughness coefficient n table s2 the initial values of parameters needed for the calibration are required to start an optimization process and were calculated mostly by using the mathematical methods available from hydrologic textbooks the time of concentration was calculated using technical report 55 tr 55 method which is computed by accumulating runoff travel times for consecutive components of the drainage conveyance system sheet flow shallow concentrated flow and open channel flow usda nrcs 1986 the initial values of the storage coefficient were estimated by nash model yoo et al 2014 and the cn was estimated as a function of land use and soil type according to tr 55 usda nrcs 1986 the initial value of the manning s roughness coefficient was selected by field campaigns photographs and literature values brunner 2016 the flood model was calibrated using two individual rainfall events and validated against six other events to evaluate the performance of model calibration and validation the coefficient of determination r2 the rmse observations standard deviation ratio rsr nash sutcliffe efficiency nse index and the kling gupta efficiency kge was used against measured discharge data in the pb outlet 3 4 weather research and forecasting the quantitative precipitation forecast qpf of weather research and forecasting wrf is provide by weather forecasting and climate research cptec in brazil the qpf is available at with five lead times 24 36 48 60 and 72 h temporal resolution of 1 h and grid spatial resolution of 5 km 5 km the effort to develop wrf has begun in the later 1990 s as a collaborative partnership of the national center for atmospheric research ncar with several institutions in the united states of america powers et al 2017 since august 1 2018 the data are available at the centro de previsão de tempo e estudos climáticos cptec website http ftp cptec inpe br modelos tempo wrf ams 05km several studies have evaluated wrf qpfs kumar et al 2008 showed that the wrf model could reproduce the heavy rainfall event and its dynamical and thermodynamical characteristics givati et al 2012 verified that the daily precipitation amount estimated by wrf showed good agreement against measured rainfall jabbari et al 2018 investigated the forecasted precipitation and the observed precipitation and concluded that the wrf model underestimated precipitation at the point and catchment scale it performed better at the catchment scale rogelis and werner 2018 assessed the potential of numerical weather prediction models for flood early warning and verified that post processed wrf precipitation adds value to the flood early warning system although it showed little added value when compared to climatology 3 5 development of flood alert system the flood alert web application was developed to provide information for flood potential risk so that early effective practices could be taken the application s front end was developed with progressive web application pwa standards a web application that has more access to the hardware features such as native applications it can be executed by the most varied devices through html 5 javascript and css technologies and also can be installed as an application on mobile biørn hansen et al 2017 thus the application becomes more widespread for the users moreover because it run depends on few hardware requirements vuejs and vuetify are javascript frameworks the second is also a css framework which were chosen to build the pwa these technologies have great performance complete definitions and tools for a responsive design that adapts to different screen sizes for handling application routes data persistence and other features required by the application pšenák and tibenský 2020 the front end gets data from a flooding event through an api that fetches information from a database thus it presents the flood spot the water level and details of certain sections of the basin drawn on the city map using the google maps api it is also able to send flood risk alerts to points in the basin via google cloud messaging the back end of the application is only responsible for hosting the application the database and also for sending notifications this is the reason for choosing google firebase service platform the platform has a free modality with functions for prototyping which does not need the implementation of an infrastructure capable to operate it application hosting required the firebase hosting function a non relational database for storing lightweight and textual information capable of moving them at high speed required the firebase real time database function chatterjee et al 2018 to storage of large files such as figures we used the fire storage function google cloud messaging was the service needed to create and send notifications to the application in addition to these operators another computer application was developed in python code it is responsible for populating google firebase databases through its api this application processes and filters the data generated in the simulation contained in two products a dss and sqlite database the first has information on water level flow and precipitation while the second has images of the simulation of the flooded surface it also fills up with the database with information from sections of the basin 4 results and discussion 4 1 calibration and validation of hec model the calibrated parameters of hec hms model table s1 and hec ras model table s2 were used to generate hydrographs for prosa basin using the dss fig 2 the assessment of the model performance is summarized in table 1 the results show that the flood model has a good performance for both calibration and validation periods the mean rsr value of 0 38 r2 and nse values both exceeds 0 80 further we found value of kge 0 50 indicating that the model can simulate the rainfall runoff process satisfactorily in the prosa basin fig 3 shows the flood hydrographs performance for two calibration and validation events 4 2 flood alert application structure to obtain the river stage and floodplain simulations graphically as a map dss output we used the calibrated hec model it should be emphasized that wfr qpf was used as input in the calibrated hec model to generate dss output then the dss output was used as input data into flood alert application to send warning messages to end users fig s4 presents the two main steps for the flood alert running between the two main steps there is an intermediate stage that represents the data traffic carried out by the google firebase services and that allows communication between the data management application and the web application 4 2 1 data management fig s5 represents the procedures performed by the data management application the first step to be performed is the register of information about the sections from where the water height precipitation and flow data should be collected inside the dss file after the flood simulation fig 4 b shows the form for filling in the section data only two fields are not texts or numbers these are the image field which must be filled with a cover image and the csv field which must be filled with the directory of a csv file with the heights and lengths of the section s shape these data are compiled into a structure represented in fig s1 which is sent to the real time database after registering all the desired sections the dss and db sqlite files resulting from the simulation must have their directories inserted in their respective fields fig 4a represents the screen where it should be done all sections stored in the database are downloaded via the google firebase api the dss name and dss code attributes of the sessions allow to access the routes and identify the session in the dss file to obtain precipitation flow and water level data although it is possible to get this information for each session rainfall and flow are only obtained from a specific session the reason is that the precipitation used for the simulation is uniform throughout the region therefore it is the same found in all sessions and the flow whose study is essential occurs only in one of them after having each session s forecast simulated data obtained from the dss file it is possible to send them to the real time database through its api the object is added to the flood data attribute of the sessions to prevent data incompatibility before the new data are sent to the server the availability of images for this simulation in the indicated db sqlite file is checked these images are blocks called tiles that together represent the complete flood area while this process takes place the values of the water level and the session s threshold of each session are compared if the water level exceeds the session s threshold a notification log is sent to google cloud messaging li et al 2013 after sending the flood data of each session the images of the flood area must be sent to fire storage in addition the data about these image blocks must also be sent to the real time database through sqlite queries to the db file a structure is built by data taken see fig s2 some attributes that can be obtained are the limits in all directions the maximum zoom to where images are available and the center of the simulation area information about the image blocks tile is also obtained such as the position of that tile in the full image described by the position in the rows and columns of the matrix the zoom of the map that this image corresponds to and the download address of the tile in the fire storage to facilitate the relationship of this information with the image tiles stored in fire storage a pattern for the directories and files have been adopted the forecast date is the directory name and the tile information is the file name it simplifies the download urls which this way is terminated as shown in fig s3 4 2 2 interface and features of the web application to demonstrate the application s interface and features we simulated the rainfall event of november 18 2020 using wrf qpf of 48 h lead time fig 5 overall the flow simulated ranged from 0 41 to 21 m3 s 1 for an event rainfall of 25 8 mm after the water stage and flood inundation map data are processed and sent to the database the progressive web application pwa searches for the information and shows them to the user fig 6 a and fig 6c presents the home screen of the application on smaller displays e g mobile devices the bottom of this screen has a tab selector while on larger displays there is a tollbar on the top of the screen with two destination buttons the default screen consists of a map with the flood surface area highlighted in blue and colored markers represent the predicted state of the water level at that point the green color means that the area is safe the yellow color means it is in a warning state and the red color means it is a dangerous area for the event of 18 november 2020 all markers were green indicating that the predicted level is less than the threshold of the selected time 20 00 on the top left corner of the screen there is a date picker box the initial selected date is the next available date forecasted on the top right corner of the screen there is a floating button that expands and shows options like information about the application and report bugs on largest displays this function is on the left side of the toolbar on larger screens on the left side of the screen there are two graphs one graph showing precipitation and the other the flow by time for the selected day the main tool used in this pwa tab is the google maps api for the presentation of the flood area and the position of the sections of interest to plot the session markers the coord attribute is used which are its coordinates and to analyze the threshold situation the height of its limit limit attribute is compared with the water level height attribute of the flood data item which has timestamp equal to the one selected in the date picker the prec and flow attributes of any flood data item are used for the presentation of precipitation and flow graphs while date options in the date picker are obtained through the timestamps in the tiles items the plotting of the tiles images that together represent the flood area on the map is possible through the google maps api overlaymaptypes method which is responsible for assembling the image matrix using the information of the row column and applied zoom level when the user clicks on the markers they show information about the selected river section see fig 6 as shown in fig 6b the first tab shows an image of the area its description the water level and the state of the river on the date furthermore there are two other tabs with more information about the chosen section the second tab fig 7 a presents an illustration of the river cross section in black and the forecasted water level in blue where the horizontal axis represents its width and the vertical axis represents its depth in meters in this option there is a slider picker on the bottom side of the screen in which the user can select the hour to be presented in the illustration it changes the water level and the state of the river section according to the chosen hour the third tab fig 7b shows the forecasted water level according to the time of simulation the water level is on the vertical axis and the time on the horizontal axis there is a black dot that marks the hour and water level on the previously selected date in the homepage 5 conclusions flood alert systems are vital as a management tool to mitigate flood risk disasters here we focused on the development of a flood alert application app to send warning message to population the prosa basin 32 km2 in campo grande city brazil was selected as a case study because it is a recurrent flooding area we used as core of flood alert system is the hydrological hec hms and hydraulic hec ras models as an important aspect the hydrological hydraulic models were calibrated and validated using different rainfall events then a flood alert web application was developed to provide information for flood potential risk and can be run in the most electronic devices such as mobile devices for the data storage it was chosen a non relational database that is hosted by google firebase platform the advantage of this platform is that it can provide updated data in real time we also used the google maps api to show flooding areas the river stage and hydrological and hydraulics details of any choose section of the main river channel in addition the application is able to send flood risk alerts to points in the basin via google cloud messaging the hec hms and hec ras models have good performances for both calibration and validation periods nse 0 80 kge 0 55 r2 0 80 and rsr 0 70 indicating that the models can simulate the rainfall runoff process satisfactorily in the prosa basin furthermore the proposed flood alert system is able to simulated flood events using quantitative precipitation forecast qpf of weather research and forecasting wrf with a 48 h lead time this flood alert application has potential to facilitate the widespread of the warning messages quickly among population ultimately this software has potential to be used in other catchments thus this flood alert system will be useful to policy makers as well as to residents for reducing flood risk in the study area in future flood alert application expected to incorporate new forecast data particularly quantitative precipitation estimation qpe of weather radar data availability the data management software and the flood alert progressive web application were developed by the hydrology and water security research group federal university of mato grosso do sul hws ufms and are available at www github com leocrivels flood alert datamanagement and www github com leocrivels flood alert both are distributed under the gnu general public license v3 0 the data management software is written in python 3 8 and requires the packages numpy tkinter pyre base json sys cdv date time requests google cloud pydsstools and sqlite3 it has been built and tested in the visual studio code editor as included in the open source python distribution platform anaconda www anaconda com the flood alert application is written in html javascript and css using vuejs 2 6 having package dependencies such as axios chart js firebase vue google maps and vuetify all dependencies are handled by npm and node js 16 0 declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study was supported by grants from the ministry of science technology innovation and communication mctic and national council for scientific and technological development cnpq grants422947 2018 0 and 309752 2020 5 and coordenação de aperfeiçoamento de pessoal de nível superior brasil capes finance code 001 and capes print appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2022 105367 
25604,complex simulation models are a valuable tool to inform nutrient management decisions aimed at reducing hypoxia in the northern gulf of mexico yet simulated hypoxia response to reduced nutrients varies greatly between models we compared two biogeochemical models driven by the same hydrodynamics the coastal generalized ecosystem model cgem and gulf of mexico dissolved oxygen model gomdom to investigate how they differ in simulating hypoxia and their response to reduced nutrients different phytoplankton nutrient kinetics produced 2 3 times more hypoxic area and volume on the western shelf in cgem compared to gomdom reductions in hypoxic area were greatest in the western shelf comprising 72 4 200 km2 of the total shelfwide hypoxia response the range of hypoxia responses from multiple models suggests a 60 load reduction may result in a 33 reduction in hypoxic area leaving an annual hypoxic area of 9 000 km2 based on the latest 5 yr average 13 928 km2 keywords inter model comparison hypoxia primary production and respiration nutrient load reduction gulf of mexico 1 introduction bottom water hypoxia do 62 5 mmol m 3 in the northern gulf of mexico is a seasonal occurrence driven by persistent density stratification and anthropogenic nutrient enrichment from the mississippi atchafalaya river basin marb as one of the largest hypoxic zones in the world diaz and rosenberg 2008 the northern gulf of mexico is a well studied coastal system with a multi decadal observational record dating back to 1985 lumcon 2021 interannual variability in the size and distribution of hypoxia across the shelf is significant due to differences in river discharge spring nutrient loads and weather conditions fennel and testa 2019 rabalais et al 2007 ongoing efforts by the hypoxia task force have established a goal to reduce the average area of hypoxia to less than 5 000 km2 mississippi river gulf of mexico watershed nutrient task force 2017 however uncertainties remain in how hypoxia would respond to nutrient load reduction targets and evidence suggests hypoxia is not decreasing with the most recent 5 year average exceeding 13 900 km2 lumcon 2021 in order to improve our understanding of gulf hypoxia and inform nutrient management decisions numerous mathematical models including empirically based eldridge and roelke 2010 giudice et al 2020 greene et al 2009 obenour et al 2015 scavia et al 2017 and mechanistic simulation models feist et al 2016 fennel et al 2011 hetland and dimarco 2008b have been developed in particular spatially explicit mechanistic models are uniquely capable of simulating the underlying drivers of spatial and temporal hypoxia dynamics providing an improved understanding of the mechanisms of hypoxia formation and maintenance model proficiency is demonstrated through model data comparisons and calculation of performance metrics for select water quality variables such as bottom water do primary production and or chlorophyll a water column and sediment respiration and nutrient gradients in space and time however existing mechanistic models for the gulf vary in complexity including those with empirically driven oxygen exchange and consumption processes fennel et al 2016 hetland and dimarco 2008a obenour et al 2015 as well as full carbon or nitrogen based biogeochemical models feist et al 2016 fennel et al 2011 jarvis et al 2020 justic et al 2002 laurent and fennel 2013 lehrter et al 2017 while each of these models demonstrated its capability to simulate hypoxic area on an annual or interannual basis with reasonable predictive power in relating hypoxic area to relevant forcing conditions their differences in process formulations boundary conditions and varying degrees of calibration and skill contribute to differences in how the models respond to varying river nutrient loads for example modeled estimates of nutrient reductions necessary to achieve the 5 000 km2 hypoxic area goal ranged between 57 and 90 for mechanistic models feist et al 2016 fennel and laurent 2018 comparable to 45 88 provided by their empirical counterparts giudice et al 2020 greene et al 2009 obenour et al 2015 scavia et al 2017 these predictions are further complicated by changing climatic conditions giudice et al 2020 combined nitrogen and phosphorus load reductions fennel and laurent 2018 and considerations for long term reductions in benthic oxygen demand obenour et al 2015 understanding how model structure and formulation options affect model skill as well as predictive response remain critical to improving model confidence and mitigating risk when applied to management decisions moreover existing prediction of hypoxia response to reduced nutrient scenarios remain consistently limited to the broad area of shelfwide hypoxia as a whole given the heterogenous nature of hypoxia across the shelf jarvis et al 2020 it is possible that models with varying process formulations may result in different spatial patterns of hypoxia response to nutrient load reductions though the predicted total area of reductions can be similar the very few attempts in addressing hypoxia reduction effects in different regions of the shelf have identified contradictory longitudinal gradients in hypoxic area between the eastern and western shelf in response to nutrient load reductions probabilistic modeling of east and west shelf hypoxia by obenour et al 2015 identified a 12 greater response of hypoxic area to nutrient load reductions in the east shelf than in the west shelf in contrast laurent and fennel 2017 determined an approximate 15 greater reduction in hypoxia duration in the west shelf versus east shelf in response to load reductions furthermore it has been recognized that hypoxic volume may be a more appropriate metric than hypoxic area in integrating the effects of hypoxia on ecological processes relevant to marine fish and fisheries scavia et al 2019 to our knowledge no mechanistic modeling studies have described how nutrient reductions may also affect hypoxic volume spatially across the shelf therefore a comparison between spatial variation of both hypoxic area and volume across the shelf may allow for a better understanding of the effects of different process formulations in models on simulated hypoxia response to reduced nutrient load reductions in this work we compare two three dimensional mechanistic biogeochemical models developed for the northern gulf of mexico to investigate how they differ in simulation of hypoxia response to reduced nutrient load scenarios we hypothesized that simulations using more realistic biogeochemical formulations i e droop versus monod nutrient kinetics would result in a more accurate representation of the biogeochemistry controlling hypoxic area and volume we further hypothesized that these different formulations would result in dissimilar simulations of hypoxia response to reduced nutrient loads our rationale was that the highly dynamic river plume environment on the louisiana shelf may be better represented in a model using more realistic nutrient uptake kinetics and organic matter processing to link nutrients with phytoplankton production and hypoxia we evaluate how each model differs in the dominant processes controlling bottom water oxygen dynamics focusing principally on primary production and respiration we also examine the spatial variation of both hypoxia area and volume in response to varying nutrient load reduction scenarios implemented in these models our analysis provides valuable perspective on the differences in oxygen dynamics and nutrient reduction response between models with similar skill these results also inform policy decisions and nutrient management strategies predicated on information provided by simulation models 2 methods 2 1 ecosystem model description we compared simulation results from two biogeochemical models developed for the northern gulf of mexico the coastal generalized ecosystem model cgem jarvis et al 2020 lehrter et al 2017 and the gulf of mexico dissolved oxygen model gomdom feist et al 2016 pauer et al 2020 both models use a regional implementation of the navy coastal ocean model ncom martin 2000 for hydrodynamic forcing u v w kh s t and cover a similar geographic range encompassing the northern gulf hypoxic zone fig 1 some similarities and differences between the models are highlighted in table 1 an overview of different model boundary conditions and seasonal boundary values are provided in supplemental information supplemental text s1 and table s1 along with a detailed description of modifications to ncom hydrodynamics in gomdom supplemental text s2 gomdom is a three dimensional biogeochemical model with 19 state variables including two phytoplankton classes diatoms and non diatoms and one zooplankton grazer the implementation of gomdom applied here includes a 6 km 6 km grid with 20 vertical sigma layers representing the water column feist et al 2016 gomdom uses a monod 1949 formulation to quantify phytoplankton nutrient nitrogen and phosphorus limitation based on external nutrient concentrations and represents sediment nutrient and oxygen fluxes using an instant remineralization approach based on fennel et al 2011 as implemented in feist et al 2016 the hydrodynamic transport scheme is based on a quickest solution and includes a scaled implementation of horizontal and vertical dispersion to improve simulation of salinity and dissolved oxygen profiles at depths less than 30 m additional detail provided in supplemental text s2 open ocean boundary conditions in gomdom were applied using observations of chlorophyll a nutrients and particulate and dissolved carbon additional detail provided in supplemental text s1 cgem is an ecosystem model comparable to gomdom in its complexity and formulations and included 21 state variables with two phytoplankton classes diatoms and dinoflagellates and two zooplankton grazers representing micro size 200 μm and macrozooplankton size 200 μm cgem has a horizontal grid resolution of 2 km 2 km and includes 20 vertical sigma layers cgem utilized an upwind hydrodynamic transport scheme supplied by ncom and did not include horizontal dispersion or scaling of vertical dispersion in the nearshore as was done in gomdom phytoplankton nutrient dependent growth is modeled using a droop cell quota formulation droop 1974 which modulates phytoplankton growth based internal cell nutrient gradients rather than external nutrient concentrations cgem also utilized a slightly lower optimum growth temperature and higher temperature response variable compared to gomdom table 2 resulting in a steeper temperature growth curve response for both phytoplankton classes the previously published implementation of cgem applied here jarvis et al 2020 lehrter et al 2017 does not explicitly model sediment water exchanges and instead utilizes the bottom sigma layer layer 20 as a pseudo sediment where deposited organic matter om is subject to aerobic decay and may be horizontally and vertically advected to further compare simulation results between the two models we tested cgem using an instant remineralization sediment formulation hereafter referred to as cgem ir whereby om reaching the bottom sigma layer is instantly remineralized and is not subject to advection we also applied an increased phytoplankton settling rate 42 increase matching gomdom s published settling rate feist et al 2016 hereafter referred to as cgem set resulting in more rapid deposition of phytoplankton carbon to the bottom open ocean boundary conditions in cgem are based on regression relationships of salinity and depth with observations reported in lehrter et al 2013 2 2 model analysis model analysis focused on estimates of hypoxic area and volume simulated by cgem and gomdom we evaluated changes in hypoxia from the base model existing river nutrient load with model runs representing a 20 increase and 10 20 40 and 60 reduction of the existing nutrient loads we further evaluated primary production and respiration pathways associated with phytoplankton growth mortality and decay using model outputs to calculate water column integrated primary production ipp integrated respiration iwr and sediment oxygen consumption soc additional om sources available for respiration in the models included zooplankton detritus riverine om and boundary condition om all of which contributed to soc we also calculated total respiration tr as the sum of water column and sediment respiration for each model grid cell results presented include model simulations for 2006 the same period in which each of the originally published models was calibrated four sub regions encompassing the gulf hypoxic zone were used to evaluate model performance in different regions of the shelf fig 1 sub regions were limited to depths between 10 and 50 m and were divided longitudinally based on proximity to the mississippi and atchafalaya rivers as well as the location of cross shelf sampling transects to facilitate direct model comparison simulation results from gomdom s 6 km 6 km horizontal grid were interpolated to cgem s finer resolution 2 km 2 km grid although both models use the same ncom hydrodynamic output differences in the transport scheme and model grid structure necessitate a comparison of hydrodynamics between the two models in addition to evaluating temporal and spatial gradients in salinity and temperature distributions we calculated the depth and strength of the pycnocline to directly compare physical mechanisms limiting bottom water ventilation stratification strength n was calculated using the brunt väisälä frequency as 1 n g ρ ρ z where g is gravitational acceleration m s 2 ρ is potential density kg m 3 and z is depth m pond and pickard 1983 2 3 comparing model performance observations applied to evaluate model performance were collected by the united states environmental protection agency lehrter et al 2011 2013 murrell and lehrter 2011 murrell et al 2013 and the louisiana universities marine consortium lumcon 2021 and include vertical profiles of temperature salinity do primary production and water column respiration model output were compared to observations by calculating model root mean square error rmse according to stow et al 2009 and model skill according to wilmott 1981 as 2 r m s e o i m i 2 n 3 s k i l l 1 m i o i 2 m i o o i o 2 where o i is an observed value m i the modeled value n is the number of observations and ō is the mean of observed data although interpretation of adequate model skill can vary we consider skill as excellent skill 0 65 very good 0 5 0 65 good 0 2 0 5 and poor 0 2 based on guidance from marechal 2004 3 results 3 1 hydrodynamics cgem and gomdom used identical ncom hydrodynamic forcing applied over different grid dimensions and using different transport solutions table 1 we observed relatively small differences in salinity temperature and stratification gradients between models notably sub pycnocline volume greater than the critical stratification threshold of n 40 cycles h 1 was extremely similar between models fig s4 we are therefore confident that differences in hydrodynamics do not significantly bias comparison of hypoxia and relevant rate processes between the biogeochemical models a detailed comparison of hydrodynamic simulations between the models is provided in supplemental text s3 3 2 hypoxic area and volume both models demonstrate comparable skill in simulating bottom layer oxygen dynamics skill metrics for all sub regions ranged between 0 64 and 0 84 for cgem and 0 47 0 67 for gomdom table 2 closer examination of the regional distribution of bottom layer oxygen indicates that cgem under predicts hypoxia in the mr plume by as much as 19 and over predicts hypoxia on the west shelf by as much as 21 fig 2 conversely gomdom underpredicts hypoxia on the west shelf and ar plume regions where hypoxia was present in approximately 20 and 4 of observations respectively fig 2 while accurately simulating low oxygen in the mr plume gomdom further underestimates hypoxia on the east shelf by as much as 23 compared to observations fig 2 simulated mid summer hypoxic area fig 3 was 22 376 km2 by cgem and 15 720 km2 by gomdom reasonably close to the lumcon measured area of 16 560 km2 lumcon 2021 obenour et al 2013 onset of hypoxia occurred earlier in the spring in gomdom than in cgem in part due to cgem s steeper phytoplankton temperature growth response curve despite similar hypoxic area hypoxic volume predicted by gomdom was approximately 60 km3 75 less than cgem and 40 km3 66 less than measured hypoxic volume obenour et al 2013 when the 62 5 mmol m 3 hypoxia threshold is applied because hypoxic areas were similar between gomdom and cgem we further investigated hypoxic volume using do thresholds of 70 3 and 78 1 mmol m 3 to designate hypoxia at nominally higher thresholds including cells with do less than 70 3 and 78 1 mmol m 3 resulted in an increased hypoxic volume of 42 km3 110 increase and 86 km3 330 respectively fig 3 cgem predicted significantly more hypoxia on the western shelf than gomdom by both volume and area fig 4 this disparate hypoxia production on the western shelf resulted in less shelfwide hypoxic volume from gomdom conversely gomdom generally simulated greater hypoxia in the mr plume and east shelf regions a majority of which was positioned south of terrebonne bay figs 4 and 5 timeseries of cumulative hypoxic area and volume indicate cgem predicted greater hypoxia on the western shelf in late spring early summer may early july with hypoxia on the eastern portion of the shelf persisting later in the summer july september gomdom displayed the opposite seasonal trend with early onset of hypoxia closer to the mississippi river lasting throughout the summer and comparatively less hypoxia on the western shelf peaking within a narrow mid summer timeframe between june through early august fig 4 cgem simulations using instant remineralization cgem ir and increased settling rate cgem set resulted in variable hypoxia response compared to the original cgem simulation in both space and time instant sediment remineralization resulted in increased hypoxia across the shelf and earlier onset of hypoxia beginning in late may fig 5 the increase in hypoxic area was primarily offshore in the ar plume and west shelf whereas hypoxia increased in the nearshore mr plume and south of terrebonne bay in the east shelf the impact of instant remineralization on increased simulation of hypoxia was greatest in late april through august after which decreasing hypoxic areas were similar to the original cgem increasing the phytoplankton settling rate resulted in reduced hypoxic area largely in the east shelf south of terrebonne bay extending offshore to depths approaching 50 m fig 5 increased settling did not shift the timing of hypoxia onset or dissipation although hypoxia on the east shelf was more limited in may july compared to other regions of the shelf 3 3 water column and sediment rate processes modeled biological rate processes varied between models and across the shelf due to the different nutrient uptake and phytoplankton growth formulations applied gomdom water column production and respiration rates were heavily concentrated near the mississippi and atchafalaya rivers dissipating rapidly outside of the immediate plume regions fig 6 in comparison shelfwide production and respiration from cgem generally exhibited a nearshore offshore gradient that was more widely dispersed across the shelf than gomdom with higher water column respiration on the western shelf sediment oxygen consumption soc rates which are in part dependent on carbon delivered to the sediments via primary production were greatest within the mississippi river plume and offshore of the atchafalaya shelf for cgem gomdom sediment consumption rates were generally small at depths 10 m highest rates were in atchafalaya bay and the shallow near coastal area fig 6 cumulative ipp and tr from both models were similar in the mr plume and east shelf cgem displayed greater summer temperature response of production and respiration compared to gomdom resulting in higher production rates in summer compared to more sustained annual rates from gomdom fig 4 seasonality of production and respiration was more pronounced in the ar plume and west shelf regions where cgem displayed higher production and respiration rates than gomdom alternate cgem formulations also induced changes to ipp and tr rates that were consistent across the shelf increasing with instant remineralization and decreasing with increased settling fig s4 changes to ipp and tr with alternative formulations are also consistent with increased or decreased hypoxic area fig 5 3 4 nutrient reduction response gomdom s shelfwide production and respiration rates were more responsive to nutrient reductions than cgem with integrated spring summer april to september production decreasing approximately 35 5 8 kmol compared to 12 2 2 kmol for cgem under a 60 nutrient load reduction fig 7 gomdom was also the only model simulating significant reductions of production 10 kmol 43 and respiration 9 3 kmol 41 in the mr plume a similar effect was observed in the ar plume region where primary production decreased 42 26 kmol cgem and its altered settling rate and remineralization scheme demonstrated a lesser and more uniform reduction in ipp and tr across the shelf ranging between 7 and 18 for all subregions fig 7 shelfwide response of hypoxic area to reduced nutrient load scenarios varied by model although all simulations produced a linear response in reduced hypoxic area following nutrient reductions the ratio of the percent change in hypoxic area to percent river load reduction was less than one in all simulations fig 8 a greater response of hypoxic volume than hypoxic area to nutrient load reductions was also observed with ratios of the change in hypoxic volume to hypoxic area δv δa between 1 1 and 1 75 fig 8b peak shelfwide hypoxic area simulated by gomdom was approximately 15 more responsive to nutrient load reductions than by cgem combined the mean of all models cgem gomdom cgem ir and cgem set suggests a 60 reduction in nutrient loads may result in a 32 reduction in peak mid summer hypoxic area ci 26 35 and a 43 reduction in hypoxic volume ci 33 53 each model demonstrated unique spatial variability in peak summer hypoxia response to a 60 reduced nutrient load gomdom simulated the greatest hypoxic area response in the ar plume and west shelf which decreased by 3 500 km2 73 and 2 350 km2 84 respectively fig 9 gomdom also demonstrated a large volumetric loss of hypoxia in the east shelf where simulated hypoxia was greatest cgem s greatest hypoxic area reductions were in the east shelf 1 900 km2 35 and ar plume 2 550 km2 64 however the greatest reductions in hypoxic volume were concentrated in the west shelf 11 800 km3 25 and ar plume 10 000 km3 45 increasing cgem s settling rate amplified hypoxia reduction in the western shelf as well as in the east shelf where hypoxia was reduced by 85 800 km2 cgem with instant remineralization concentrated reductions in hypoxic area in the east shelf and mr plume while decreasing nutrient reduction effects in the ar plume and west shelf fig 9 combined simulation results from all models fig 10 a indicate the greatest reduction in maximum hypoxic area is most likely to occur in the ar plume 2 398 km2 ci 1 758 to 2 670 and west shelf 1 833 km2 ci 1 481 to 2 091 in contrast hypoxia in the mr plume may only be expected to decline between 262 and 574 km2 all model subregions demonstrated a greater response in reduced hypoxic volume versus area fig 10b with the greatest δv δa ratio in the mr plume δv δa 1 49 the east shelf exhibited the highest percent decrease in hypoxic area and volume by 60 and 78 respectively 4 discussion 4 1 primary production and respiration dynamics affecting hypoxia bottom water hypoxia in the northern gulf is closely coupled to om respiration derived from primary production making it the principal metabolic pathway for converting river derived nutrients into om available for respiration rabalais and turner 2019 the spatiotemporal orientation of hypoxia is therefore highly dependent on when and where carbon is produced as well as how quickly it settles and is transported across the shelf these dynamics present unique challenges to simulating hypoxia as models must produce carbon at realistic rates while also accounting for mortality settling and lability to dictate respiration rates controlling oxygen consumption in both space and time primary production formulations in cgem and gomdom are principally a function of light intensity temperature and nutrient concentrations and are therefore closely tied to observed plume dynamics influencing light penetration and inorganic nutrient supplies that control primary production bianchi et al 2010 lohrenz et al 2008 a principle controlling factor in phytoplankton productivity between the models is the utilization of monod versus droop kinetics in gomdom and cgem respectively although monod nutrient kinetics provide a straight forward and effective method for simulating phytoplankton growth rapid nutrient uptake may overestimate production during periods of high external nutrient concentrations and may alternatively lead to low productivity during periods of reduced nutrients although more complex droop nutrient kinetics allow for internal nutrient storage buffering productivity during periods of low ambient nutrient concentrations droop 1983 droop nutrient uptake kinetics used by cgem resulted in more broadly dispersed spring summer phytoplankton production than gomdom s monod formulation which were isolated to the near plume regions of the mississippi and atchafalaya outflow fig 6 these results are consistent with previous studies comparing droop and monod nutrient formulations in the northern gulf pauer et al 2020 and chesapeake bay cerco and noel 2004 westward and offshore currents near the atchafalaya shelf in spring and summer allahdadi et al 2013 further amplify nutrient and carbon dispersal available for respiration outside of the atchafalaya river plume jarvis et al 2020 application of droop kinetics produced a more spatially accurate simulation of carbon production when compared with measured primary production rates murrell et al 2013 and satellite chlorophyll observations boesch et al 2009 le et al 2014 across the nearshore louisiana shelf although monod uptake kinetics are commonly applied in simulating phytoplankton production in varying aquatic ecosystems application in the northern gulf of mexico may impede realistic simulation of phytoplankton growth rates due to highly localized river nutrient effects resulting in underestimated carbon production and respiration across much of the shelf fig 2 total respiration rates simulated by cgem and gomdom mirrored spatial and temporal carbon production rates both models underestimated water column respiration in the immediate mississippi plume fig 2 although cgem performed better than gomdom in model data comparisons in the ar plume and west shelf fig 2 where gomdom s iwr rates remained below 150 and 90 mmol m 2 d 1 respectively limited respiration from gomdom in this region of the shelf results from a combination of forcing mechanisms including high phytoplankton production near the atchafalaya river using monod kinetics entrained phytoplankton production within atchafalaya bay and limited offshore carbon flux to the shelf beyond atchafalaya bay due to instant remineralization gomdom s river focused production and instant remineralization approach resulted in heightened water column and sediment respiration rates across the shallow atchafalaya shelf compared to cgem s elevated offshore rates fig 6 spatial displacement of carbon production and respiration between models resulted in opposing spatial patterns of hypoxia formation across the shelf gomdom s enhanced production near the mississippi river plume concentrated hypoxia in the mr plume and east shelf regions that persisted between april and september hypoxia on the western shelf was less pervasive being limited to mid summer june august and approximately half the cumulative area simulated in the eastern shelf fig 4 nonetheless hypoxia generated by gomdom in the ar plume and west shelf contributed a significant portion of the total hypoxic area during peak mid summer hypoxia albeit for a shorter duration than the eastern shelf cgem demonstrated an opposite pattern where hypoxic area and volume on the western reaches of the shelf were between 2 and 3 times greater than the eastern shelf although both models simulate comparable maximum shelfwide hypoxic areas spatial and temporal variance between models has implications for how simulated hypoxia responds to changes in physical and biological forcing mechanisms as well as reduced nutrient loads while monod kinetics produced stronger hypoxia in the commonly hypoxic region of the eastern shelf the lack of widespread carbon dispersal may inhibit the model s ability to simulate interannual variability in the size and distribution of hypoxia particularly in years with strong winds or above average freshwater flow 4 2 sensitivity of hypoxia to settling and instant remineralization while monod and droop nutrient uptake formulations regulate the timing and spatial displacement of carbon production we further identified differences in phytoplankton settling rates and sediment formulations as important controls of carbon dynamics respiration and hypoxia separate application of instant sediment remineralization and increased phytoplankton settling rate resulted in opposite effects on simulated hypoxia instant remineralization increased hypoxic area across all four subregions of the shelf with the greatest increase occurring at mid depths of the east shelf and at depths approaching 50 m on the western shelf fig 5 increased settling decreased hypoxic area with the greatest effect on the east shelf at depths extending from 5 to 50 m offshore these results are inconsistent with findings of pauer et al 2020 who instead identified an increase in hypoxic area with increased settling rates presumably due to the elimination of om with use of instant remineralization and higher settling rates the effects of both model formulations were concentrated offshore of terrebonne bay near lumcon monitoring station c6 a commonly observed hypoxic region of the shelf rabalais and turner 2019 sensitivity of simulated hypoxia in this region is likely due to enhanced carbon flux from the nearshore and mississippi river plume jarvis et al 2020 that may be altered by changing sediment respiration pathways and displacement of advected carbon resulting from different phytoplankton settling rates in the case of increased settling enhanced phytoplankton removal from the water column reduced water column respiration above and below the pycnocline while also failing to stimulate sediment remineralization due to colder bottom temperatures mean difference between surface and bottom during june august 3 6 c and advection of bottom om in contrast instant remineralization results in direct increases in respiration rates and enhanced offshore hypoxia where despite lower primary production rates om is respired instantaneously regardless of colder bottom water temperatures that may otherwise inhibit sediment respiration wilson et al 2013 the effects of instant remineralization rather than protracted bottom water decay are also apparent in the timing of hypoxia formation which increased hypoxic area much earlier in the season than the baseline cgem model fig 5 4 3 shelfwide hypoxia response to reduced nutrient loads the multiple models and alternate formulations evaluated in this study lead to varying response of hypoxic area to reduced nutrient loading scenarios fig 7 the magnitude of load reduction responses from all models were similar to nutrient reduction response from justic and wang 2014 but were less responsive than scavia et al 2003 of all the models evaluated here gomdom s predicted hypoxic area was most sensitive to nutrient reductions this may be due to a number of factors including the instantaneous response of phytoplankton production to decreased external nutrient concentrations pauer et al 2020 as well as the coarser grid size which may aggregate load reductions from more spatially heterogenous hypoxic regions of the shelf the instant remineralization formulation of cgem was least responsive of all of the models fig 7 likely due to enhanced localized respiration of the available om supply relative to models which use a natural decay order and allow for advection of bottom layer om reduced respiration rates and horizontal advection of settled om facilitates broader dissemination of om to offshore reaches of the shelf where external carbon sources are required to fuel hypoxia fry et al 2014 jarvis et al 2020 although the hypoxia task force has most recently established a 20 load reduction aimed at meeting the 5 000 km2 hypoxic area goal mississippi river gulf of mexico watershed nutrient task force 2017 hypoxic volume and its response to load reduction is recently being recognized as an important hypoxia management endpoint scavia et al 2019 few modeling studies have addressed the response of hypoxic volume to reduced nutrient loads despite the ecological relevance to many motile marine species scavia et al 2019 compared hypoxic volume response from a complex simulation model justic and wang 2014 and geostatistical model scavia et al 2013 and found that hypoxic volume was more sensitive than hypoxic area to reduced nutrient loads by a factor of between 1 06 and 1 50 our simulations also indicated greater percent reductions in hypoxic volume than hypoxic area fig 8b with comparable change in volume to area ratios δv δa between 1 1 and 1 39 for a 20 load reduction and between 1 09 and 1 25 for a 60 load reduction gomdom s hypoxic volume response was greater than cgem in part due to its lower estimated volume in the base model resulting in δv δa ratios as high as 1 73 for a 60 load reduction gomdom s suppressed hypoxic volume during reasonable peak mid summer hypoxic area suggests less sub pycnocline hypoxia may be present above the bottom model layer a reasonable assumption given gomdom s larger grid dimensions however a closer look at the 62 5 mmol m 3 hypoxia threshold applied to our simulation results indicate that gomdom s oxygen concentrations across much of the model domain remained very close but not below the hypoxic threshold for much of the summer increasing the hypoxia threshold applied to our analysis by 7 8 mmol m 3 70 3 mmol m 3 resulted in a 75 increase in hypoxic area and a 300 increase in hypoxic volume that is closer to the measured hypoxic volume fig 3 although the 62 5 mmol m 3 hypoxia threshold similarly excludes portions of the shelf that remain slightly above this cutoff calibrating models to this specific criterion may result in over parameterization in an effort to induce additional oxygen depletion we therefore believe it is more important to quantify model accuracy with context from important biological rate processes such as primary production respiration and sediment oxygen consumption rather than hypoxic area or volume alone 4 4 spatial variability in hypoxia response to reduced nutrient loads assessments of hypoxia response to reduced nutrient loads have typically emphasized a shelfwide approach rather than spatial variability of hypoxia dynamics the few studies that have addressed spatial heterogeneity in hypoxia response to reduced nutrients have identified distinct longitudinal gradients in hypoxia response for example probabilistic modeling by obenour et al 2015 determined that western shelf hypoxia may respond 12 less than eastern shelf hypoxia with nutrient reductions alone nutrient load experiments using a complex simulation model by laurent and fennel 2014 alternatively resulted in a 18 decrease in hypoxia duration in the western shelf compared to an approximate 4 decrease in duration on the eastern shelf following a 50 reduction of both nitrogen and phosphorus laurent and fennel 2017 the simulation models applied here suggest a similar longitudinal trend in hypoxia response to laurent and fennel 2017 as more hypoxic area was eliminated on the western shelf ar plume and west shelf than on the eastern shelf mr plume and east shelf the mean hypoxia response from all models in the ar plume and west shelf regions comprised 72 of the total shelfwide reduction in hypoxic area fig 10 for 4 200 km2 ci 3 240 4 761 km2 however as a percent reduction of hypoxia the east shelf eliminated a greater percentage of both hypoxic area and volume from the base model runs fig 10b we attribute this localized hypoxia effect to enhanced primary production rates of the nearshore east shelf observed here fig 6 and in numerous other studies fry et al 2014 murrell et al 2013 in addition to high in situ rates of settled organic carbon redalje et al 1994 this region of the inner shelf also receives an estimated 1 1010 mol carbon yr 1 jarvis et al 2020 from the adjacent mississippi river plume and thus reduced phytoplankton production and om advection in this region will have a significant effect on simulated respiration rates and hypoxia an important conclusion from this inter model comparison is different model formulations play a key role in determining how hypoxia responds to nutrient reductions across the shelf for instance while most models demonstrated a greater aerial and volumetric hypoxia reduction on the western shelf versus eastern shelf in response to reduced nutrients application of instant remineralization in cgem concentrated the load reduction response in the east shelf south of terrebonne bay fig 9 this heightened hypoxia response is also spatially coincident with the greatest increase in hypoxia using instant remineralization compared to the original cgem model fig 5 gomdom s elevated hypoxia response on the western shelf provides another example of the impact of model formulations on spatial variability gomdom s reduction of total respiration in the west shelf and ar plume was 2 4 times greater than the other models fig 7 as was its reduction of phytoplankton production in the near river regions mr plume and ar plume combined with its higher settling rate and instant remineralization a 60 reduction of nutrients in gomdom significantly limited offshore export of om produced within atchafalaya bay eliminating the influx of nearshore carbon necessary to sustain offshore respiration rates therefore resulted in an 81 91 reduction in hypoxia fig 9 disparate simulation results suggest model formulations can significantly alter spatial gradients of persistent versus intermittent hypoxia that may respond with varying degrees of sensitivity to reduced nutrient loads for example cgem generated more hypoxia on the western shelf that was proportionally less responsive to load reductions than the eastern shelf an area where interannual hypoxia is considered to be most persistent rabalais and turner 2019 gomdom instead favored hypoxia on the eastern shelf that was proportionally less responsive to hypoxia on the western shelf where hypoxia was nearly eliminated following load reductions these differences cannot be accounted for in simplistic analyses of hypoxic area that are commonly applied to complex simulation models in the northern gulf unfortunately the consequences of failing to adequately constrain model uncertainty resulting from different formulation options can lead to significant ambiguity in load reduction estimates and potentially misinform guidance on nutrient management policies 4 5 implications for guiding nutrient management complex simulation models offer valuable insight into spatial and temporal dynamics of hypoxia that may not be apparent in monitoring data alone unlike some systems where physical stratification processes exert a 1st order influence on seasonal oxygen dynamics irby 2016 simulation of hypoxia in the northern gulf of mexico is highly dependent on the biogeochemical parameterization driving carbon and oxygen gradients across the shelf our inter model comparison exhibits highly variable spatial displacement of hypoxia using different nutrient uptake settling and respiration including sediment remineralization formulations given the dynamic nature of hypoxia in both space and time the spatial orientation of simulated hypoxia can significantly alter estimates of hypoxic area and volume in response to physical forcing events for example summer wind patterns may affect stratification oppositely between the western and eastern shelf obenour et al 2015 and upwelling favorable winds can force hypoxia inshore at varying spatial scales thereby reducing hypoxic area but increasing hypoxic volume feng et al 2014 jarvis et al 2021 failure to realistically simulate spatial orientation of hypoxia can therefore result in erroneous estimates of hypoxic area and volume in response to varying forcing conditions additional uncertainty introduced by the hydrodynamic model linkage should also be considered when evaluating water quality simulations although both models in this study were independently calibrated and validated using similar ncom hydrodynamics their different model formulations may yield distinct results under similar hydrodynamic gradients for example gomdom s combination of higher settling rates and instant remineralization limit om advection relative to cgems broader shelf wide production and slower bottom layer remineralization cgem is consequently more strongly influenced by hydrodynamic circulation gradients resulting in greater om accumulation and respiration rates near shoals of the atchafalaya shelf jarvis et al 2020 the effects of model physics on water quality simulations are multi faceted and may include differences in sub pycnocline volume fennel et al 2016 altered nutrient and organic matter distributions jiang et al 2015 xia and jiang 2015 and variable stratification and vertical mixing gradients xia et al 2010 xia and jiang 2016 formulation options affecting biogeochemical dynamics have further implications in controlling how complex simulations models respond to reduced nutrient loads all models demonstrated a greater response in hypoxic volume than hypoxic area fig 8 agreeing with conclusions from scavia et al 2013 and scavia et al 2019 however the ratio of hypoxic area to volume reductions varied greatly between cgem and gomdom fig 8 as well as in different regions of the shelf fig 10 understanding how hypoxic volume responds to load reductions has important implications for marine taxa and gulf fisheries which are impacted to varying extents by the size and distribution of the seasonal hypoxic plume scavia et al 2019 our analysis indicates that the greatest percent reductions in hypoxic area and volume following nutrient load reductions occurred in the east shelf region this commonly hypoxic region south of terrebonne bay is noted for distinct spatial shifts in brown shrimp populations craig 2012 craig and bosman 2013 and subsequent low effort shrimping efforts purcell et al 2017 although less impactful to shelfwide hypoxia incremental nutrient load reductions below those needed to achieve the 5000 km2 goal may yield improved habitat suitability in this region of the shelf the multiple models and formulations evaluated here further varied in simulating spatial patterns of hypoxia response to reduced nutrients adding additional uncertainty to the predicted shelfwide load reduction response we identified a 24 difference in the size of the shelfwide hypoxic area between models using a 60 load reduction scenario fig 8 applying the range of responses from all models to the current 5 year average hypoxic area 2017 2021 13 928 km2 suggests a reduced hypoxic area between 7 938 11 003 km2 22 difference is possible following a 60 load reduction we can further constrain the estimated hypoxia response by applying the mean response from all models fig 8 which predicts a 9 332 km2 ci 9 053 10 306 km2 hypoxic area given the numerous models implemented in the northern gulf of mexico and the variance between their predictions resource managers have a choice between utilizing the best model based on model data comparisons and evaluating a range of predictions from multiple models however selecting the best model is rarely definitive as both cgem and gomdom demonstrate strengths and weaknesses in simulating carbon production and hypoxia in different regions of the shelf although some models may perform better than others in demonstrating model skill there is no single metric that can unambiguously define what the best model may be when compared to observations this is particularly relevant when considering the varying complexity with which models derive estimates of hypoxia as added complexity leads to additional risk of over parameterization in an attempt to mimic real world processes denman 2003 nossent and bauwens 2012 in these instances models may obtain the right answer for the wrong reasons and without an assessment of model parameterization effects this may further produce unrealistic responses to changes in forcing conditions beck et al 2017 such as reduced nutrient loads comparison of multiple models in this study suggests that significant uncertainties exist in spatiotemporal modeling of hypoxia response to nutrient load reductions quantifying the range of uncertainty in a single complex model may carry certain limitations whereas evaluation of multiple models applied in a similar context can bound uncertainty inherent to individual simulation models we therefore believe it is imperative that complex simulation models be considered in a multi model comparison context to constrain uncertainty in application of mechanistic formulations much the same as how geostatistical models have been applied in the last decade in doing so complex models may be used to more effectively communicate the range of expected results to resource managers to guide or inform policy development 5 conclusions this work identified significant spatiotemporal variability in simulation of hypoxia dynamics between complex biogeochemical models developed for the northern gulf of mexico differences in model formulations controlling phytoplankton and organic matter rate processes resulted in disparate spatial patterns of hypoxia formation throughout the spring and summer these differences further affected simulated response of hypoxic area to nutrient load reductions which varied as much as 24 between models our results indicate that uncertainty derived from the selection of model formulations can alter the predictive outcomes of complex simulation models thus presenting risk of misinforming management decisions when such information is used in a vacuum this study highlights the importance of multiple model evaluation in the context of reducing ambiguity and increasing confidence in process based model simulations for environmental management decision making declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we thank the many contributions of usepa staff for their efforts in supporting modeling efforts through the production of quality data spanning years of research cruises we also acknowledge mark rowe for his valuable review and comments this research was supported by the u s environmental protection agency office of research and development center for environmental measurement and modeling and by u s epa s safe and sustainable water resources research program development of ncom was supported by the u s naval research laboratory and by an interagency agreement between the u s epa and the u s naval research laboratory the views expressed in this article are those of the authors and do not necessarily reflect the views or policies of the u s environmental protection agency the mention of trade names or commercial products does not constitute endorsement or recommendation for use data presented in this manuscript are available at data gov as well as usepa s environmental dataset gateway https doi org 10 23719 1523052 appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2022 105365 
25604,complex simulation models are a valuable tool to inform nutrient management decisions aimed at reducing hypoxia in the northern gulf of mexico yet simulated hypoxia response to reduced nutrients varies greatly between models we compared two biogeochemical models driven by the same hydrodynamics the coastal generalized ecosystem model cgem and gulf of mexico dissolved oxygen model gomdom to investigate how they differ in simulating hypoxia and their response to reduced nutrients different phytoplankton nutrient kinetics produced 2 3 times more hypoxic area and volume on the western shelf in cgem compared to gomdom reductions in hypoxic area were greatest in the western shelf comprising 72 4 200 km2 of the total shelfwide hypoxia response the range of hypoxia responses from multiple models suggests a 60 load reduction may result in a 33 reduction in hypoxic area leaving an annual hypoxic area of 9 000 km2 based on the latest 5 yr average 13 928 km2 keywords inter model comparison hypoxia primary production and respiration nutrient load reduction gulf of mexico 1 introduction bottom water hypoxia do 62 5 mmol m 3 in the northern gulf of mexico is a seasonal occurrence driven by persistent density stratification and anthropogenic nutrient enrichment from the mississippi atchafalaya river basin marb as one of the largest hypoxic zones in the world diaz and rosenberg 2008 the northern gulf of mexico is a well studied coastal system with a multi decadal observational record dating back to 1985 lumcon 2021 interannual variability in the size and distribution of hypoxia across the shelf is significant due to differences in river discharge spring nutrient loads and weather conditions fennel and testa 2019 rabalais et al 2007 ongoing efforts by the hypoxia task force have established a goal to reduce the average area of hypoxia to less than 5 000 km2 mississippi river gulf of mexico watershed nutrient task force 2017 however uncertainties remain in how hypoxia would respond to nutrient load reduction targets and evidence suggests hypoxia is not decreasing with the most recent 5 year average exceeding 13 900 km2 lumcon 2021 in order to improve our understanding of gulf hypoxia and inform nutrient management decisions numerous mathematical models including empirically based eldridge and roelke 2010 giudice et al 2020 greene et al 2009 obenour et al 2015 scavia et al 2017 and mechanistic simulation models feist et al 2016 fennel et al 2011 hetland and dimarco 2008b have been developed in particular spatially explicit mechanistic models are uniquely capable of simulating the underlying drivers of spatial and temporal hypoxia dynamics providing an improved understanding of the mechanisms of hypoxia formation and maintenance model proficiency is demonstrated through model data comparisons and calculation of performance metrics for select water quality variables such as bottom water do primary production and or chlorophyll a water column and sediment respiration and nutrient gradients in space and time however existing mechanistic models for the gulf vary in complexity including those with empirically driven oxygen exchange and consumption processes fennel et al 2016 hetland and dimarco 2008a obenour et al 2015 as well as full carbon or nitrogen based biogeochemical models feist et al 2016 fennel et al 2011 jarvis et al 2020 justic et al 2002 laurent and fennel 2013 lehrter et al 2017 while each of these models demonstrated its capability to simulate hypoxic area on an annual or interannual basis with reasonable predictive power in relating hypoxic area to relevant forcing conditions their differences in process formulations boundary conditions and varying degrees of calibration and skill contribute to differences in how the models respond to varying river nutrient loads for example modeled estimates of nutrient reductions necessary to achieve the 5 000 km2 hypoxic area goal ranged between 57 and 90 for mechanistic models feist et al 2016 fennel and laurent 2018 comparable to 45 88 provided by their empirical counterparts giudice et al 2020 greene et al 2009 obenour et al 2015 scavia et al 2017 these predictions are further complicated by changing climatic conditions giudice et al 2020 combined nitrogen and phosphorus load reductions fennel and laurent 2018 and considerations for long term reductions in benthic oxygen demand obenour et al 2015 understanding how model structure and formulation options affect model skill as well as predictive response remain critical to improving model confidence and mitigating risk when applied to management decisions moreover existing prediction of hypoxia response to reduced nutrient scenarios remain consistently limited to the broad area of shelfwide hypoxia as a whole given the heterogenous nature of hypoxia across the shelf jarvis et al 2020 it is possible that models with varying process formulations may result in different spatial patterns of hypoxia response to nutrient load reductions though the predicted total area of reductions can be similar the very few attempts in addressing hypoxia reduction effects in different regions of the shelf have identified contradictory longitudinal gradients in hypoxic area between the eastern and western shelf in response to nutrient load reductions probabilistic modeling of east and west shelf hypoxia by obenour et al 2015 identified a 12 greater response of hypoxic area to nutrient load reductions in the east shelf than in the west shelf in contrast laurent and fennel 2017 determined an approximate 15 greater reduction in hypoxia duration in the west shelf versus east shelf in response to load reductions furthermore it has been recognized that hypoxic volume may be a more appropriate metric than hypoxic area in integrating the effects of hypoxia on ecological processes relevant to marine fish and fisheries scavia et al 2019 to our knowledge no mechanistic modeling studies have described how nutrient reductions may also affect hypoxic volume spatially across the shelf therefore a comparison between spatial variation of both hypoxic area and volume across the shelf may allow for a better understanding of the effects of different process formulations in models on simulated hypoxia response to reduced nutrient load reductions in this work we compare two three dimensional mechanistic biogeochemical models developed for the northern gulf of mexico to investigate how they differ in simulation of hypoxia response to reduced nutrient load scenarios we hypothesized that simulations using more realistic biogeochemical formulations i e droop versus monod nutrient kinetics would result in a more accurate representation of the biogeochemistry controlling hypoxic area and volume we further hypothesized that these different formulations would result in dissimilar simulations of hypoxia response to reduced nutrient loads our rationale was that the highly dynamic river plume environment on the louisiana shelf may be better represented in a model using more realistic nutrient uptake kinetics and organic matter processing to link nutrients with phytoplankton production and hypoxia we evaluate how each model differs in the dominant processes controlling bottom water oxygen dynamics focusing principally on primary production and respiration we also examine the spatial variation of both hypoxia area and volume in response to varying nutrient load reduction scenarios implemented in these models our analysis provides valuable perspective on the differences in oxygen dynamics and nutrient reduction response between models with similar skill these results also inform policy decisions and nutrient management strategies predicated on information provided by simulation models 2 methods 2 1 ecosystem model description we compared simulation results from two biogeochemical models developed for the northern gulf of mexico the coastal generalized ecosystem model cgem jarvis et al 2020 lehrter et al 2017 and the gulf of mexico dissolved oxygen model gomdom feist et al 2016 pauer et al 2020 both models use a regional implementation of the navy coastal ocean model ncom martin 2000 for hydrodynamic forcing u v w kh s t and cover a similar geographic range encompassing the northern gulf hypoxic zone fig 1 some similarities and differences between the models are highlighted in table 1 an overview of different model boundary conditions and seasonal boundary values are provided in supplemental information supplemental text s1 and table s1 along with a detailed description of modifications to ncom hydrodynamics in gomdom supplemental text s2 gomdom is a three dimensional biogeochemical model with 19 state variables including two phytoplankton classes diatoms and non diatoms and one zooplankton grazer the implementation of gomdom applied here includes a 6 km 6 km grid with 20 vertical sigma layers representing the water column feist et al 2016 gomdom uses a monod 1949 formulation to quantify phytoplankton nutrient nitrogen and phosphorus limitation based on external nutrient concentrations and represents sediment nutrient and oxygen fluxes using an instant remineralization approach based on fennel et al 2011 as implemented in feist et al 2016 the hydrodynamic transport scheme is based on a quickest solution and includes a scaled implementation of horizontal and vertical dispersion to improve simulation of salinity and dissolved oxygen profiles at depths less than 30 m additional detail provided in supplemental text s2 open ocean boundary conditions in gomdom were applied using observations of chlorophyll a nutrients and particulate and dissolved carbon additional detail provided in supplemental text s1 cgem is an ecosystem model comparable to gomdom in its complexity and formulations and included 21 state variables with two phytoplankton classes diatoms and dinoflagellates and two zooplankton grazers representing micro size 200 μm and macrozooplankton size 200 μm cgem has a horizontal grid resolution of 2 km 2 km and includes 20 vertical sigma layers cgem utilized an upwind hydrodynamic transport scheme supplied by ncom and did not include horizontal dispersion or scaling of vertical dispersion in the nearshore as was done in gomdom phytoplankton nutrient dependent growth is modeled using a droop cell quota formulation droop 1974 which modulates phytoplankton growth based internal cell nutrient gradients rather than external nutrient concentrations cgem also utilized a slightly lower optimum growth temperature and higher temperature response variable compared to gomdom table 2 resulting in a steeper temperature growth curve response for both phytoplankton classes the previously published implementation of cgem applied here jarvis et al 2020 lehrter et al 2017 does not explicitly model sediment water exchanges and instead utilizes the bottom sigma layer layer 20 as a pseudo sediment where deposited organic matter om is subject to aerobic decay and may be horizontally and vertically advected to further compare simulation results between the two models we tested cgem using an instant remineralization sediment formulation hereafter referred to as cgem ir whereby om reaching the bottom sigma layer is instantly remineralized and is not subject to advection we also applied an increased phytoplankton settling rate 42 increase matching gomdom s published settling rate feist et al 2016 hereafter referred to as cgem set resulting in more rapid deposition of phytoplankton carbon to the bottom open ocean boundary conditions in cgem are based on regression relationships of salinity and depth with observations reported in lehrter et al 2013 2 2 model analysis model analysis focused on estimates of hypoxic area and volume simulated by cgem and gomdom we evaluated changes in hypoxia from the base model existing river nutrient load with model runs representing a 20 increase and 10 20 40 and 60 reduction of the existing nutrient loads we further evaluated primary production and respiration pathways associated with phytoplankton growth mortality and decay using model outputs to calculate water column integrated primary production ipp integrated respiration iwr and sediment oxygen consumption soc additional om sources available for respiration in the models included zooplankton detritus riverine om and boundary condition om all of which contributed to soc we also calculated total respiration tr as the sum of water column and sediment respiration for each model grid cell results presented include model simulations for 2006 the same period in which each of the originally published models was calibrated four sub regions encompassing the gulf hypoxic zone were used to evaluate model performance in different regions of the shelf fig 1 sub regions were limited to depths between 10 and 50 m and were divided longitudinally based on proximity to the mississippi and atchafalaya rivers as well as the location of cross shelf sampling transects to facilitate direct model comparison simulation results from gomdom s 6 km 6 km horizontal grid were interpolated to cgem s finer resolution 2 km 2 km grid although both models use the same ncom hydrodynamic output differences in the transport scheme and model grid structure necessitate a comparison of hydrodynamics between the two models in addition to evaluating temporal and spatial gradients in salinity and temperature distributions we calculated the depth and strength of the pycnocline to directly compare physical mechanisms limiting bottom water ventilation stratification strength n was calculated using the brunt väisälä frequency as 1 n g ρ ρ z where g is gravitational acceleration m s 2 ρ is potential density kg m 3 and z is depth m pond and pickard 1983 2 3 comparing model performance observations applied to evaluate model performance were collected by the united states environmental protection agency lehrter et al 2011 2013 murrell and lehrter 2011 murrell et al 2013 and the louisiana universities marine consortium lumcon 2021 and include vertical profiles of temperature salinity do primary production and water column respiration model output were compared to observations by calculating model root mean square error rmse according to stow et al 2009 and model skill according to wilmott 1981 as 2 r m s e o i m i 2 n 3 s k i l l 1 m i o i 2 m i o o i o 2 where o i is an observed value m i the modeled value n is the number of observations and ō is the mean of observed data although interpretation of adequate model skill can vary we consider skill as excellent skill 0 65 very good 0 5 0 65 good 0 2 0 5 and poor 0 2 based on guidance from marechal 2004 3 results 3 1 hydrodynamics cgem and gomdom used identical ncom hydrodynamic forcing applied over different grid dimensions and using different transport solutions table 1 we observed relatively small differences in salinity temperature and stratification gradients between models notably sub pycnocline volume greater than the critical stratification threshold of n 40 cycles h 1 was extremely similar between models fig s4 we are therefore confident that differences in hydrodynamics do not significantly bias comparison of hypoxia and relevant rate processes between the biogeochemical models a detailed comparison of hydrodynamic simulations between the models is provided in supplemental text s3 3 2 hypoxic area and volume both models demonstrate comparable skill in simulating bottom layer oxygen dynamics skill metrics for all sub regions ranged between 0 64 and 0 84 for cgem and 0 47 0 67 for gomdom table 2 closer examination of the regional distribution of bottom layer oxygen indicates that cgem under predicts hypoxia in the mr plume by as much as 19 and over predicts hypoxia on the west shelf by as much as 21 fig 2 conversely gomdom underpredicts hypoxia on the west shelf and ar plume regions where hypoxia was present in approximately 20 and 4 of observations respectively fig 2 while accurately simulating low oxygen in the mr plume gomdom further underestimates hypoxia on the east shelf by as much as 23 compared to observations fig 2 simulated mid summer hypoxic area fig 3 was 22 376 km2 by cgem and 15 720 km2 by gomdom reasonably close to the lumcon measured area of 16 560 km2 lumcon 2021 obenour et al 2013 onset of hypoxia occurred earlier in the spring in gomdom than in cgem in part due to cgem s steeper phytoplankton temperature growth response curve despite similar hypoxic area hypoxic volume predicted by gomdom was approximately 60 km3 75 less than cgem and 40 km3 66 less than measured hypoxic volume obenour et al 2013 when the 62 5 mmol m 3 hypoxia threshold is applied because hypoxic areas were similar between gomdom and cgem we further investigated hypoxic volume using do thresholds of 70 3 and 78 1 mmol m 3 to designate hypoxia at nominally higher thresholds including cells with do less than 70 3 and 78 1 mmol m 3 resulted in an increased hypoxic volume of 42 km3 110 increase and 86 km3 330 respectively fig 3 cgem predicted significantly more hypoxia on the western shelf than gomdom by both volume and area fig 4 this disparate hypoxia production on the western shelf resulted in less shelfwide hypoxic volume from gomdom conversely gomdom generally simulated greater hypoxia in the mr plume and east shelf regions a majority of which was positioned south of terrebonne bay figs 4 and 5 timeseries of cumulative hypoxic area and volume indicate cgem predicted greater hypoxia on the western shelf in late spring early summer may early july with hypoxia on the eastern portion of the shelf persisting later in the summer july september gomdom displayed the opposite seasonal trend with early onset of hypoxia closer to the mississippi river lasting throughout the summer and comparatively less hypoxia on the western shelf peaking within a narrow mid summer timeframe between june through early august fig 4 cgem simulations using instant remineralization cgem ir and increased settling rate cgem set resulted in variable hypoxia response compared to the original cgem simulation in both space and time instant sediment remineralization resulted in increased hypoxia across the shelf and earlier onset of hypoxia beginning in late may fig 5 the increase in hypoxic area was primarily offshore in the ar plume and west shelf whereas hypoxia increased in the nearshore mr plume and south of terrebonne bay in the east shelf the impact of instant remineralization on increased simulation of hypoxia was greatest in late april through august after which decreasing hypoxic areas were similar to the original cgem increasing the phytoplankton settling rate resulted in reduced hypoxic area largely in the east shelf south of terrebonne bay extending offshore to depths approaching 50 m fig 5 increased settling did not shift the timing of hypoxia onset or dissipation although hypoxia on the east shelf was more limited in may july compared to other regions of the shelf 3 3 water column and sediment rate processes modeled biological rate processes varied between models and across the shelf due to the different nutrient uptake and phytoplankton growth formulations applied gomdom water column production and respiration rates were heavily concentrated near the mississippi and atchafalaya rivers dissipating rapidly outside of the immediate plume regions fig 6 in comparison shelfwide production and respiration from cgem generally exhibited a nearshore offshore gradient that was more widely dispersed across the shelf than gomdom with higher water column respiration on the western shelf sediment oxygen consumption soc rates which are in part dependent on carbon delivered to the sediments via primary production were greatest within the mississippi river plume and offshore of the atchafalaya shelf for cgem gomdom sediment consumption rates were generally small at depths 10 m highest rates were in atchafalaya bay and the shallow near coastal area fig 6 cumulative ipp and tr from both models were similar in the mr plume and east shelf cgem displayed greater summer temperature response of production and respiration compared to gomdom resulting in higher production rates in summer compared to more sustained annual rates from gomdom fig 4 seasonality of production and respiration was more pronounced in the ar plume and west shelf regions where cgem displayed higher production and respiration rates than gomdom alternate cgem formulations also induced changes to ipp and tr rates that were consistent across the shelf increasing with instant remineralization and decreasing with increased settling fig s4 changes to ipp and tr with alternative formulations are also consistent with increased or decreased hypoxic area fig 5 3 4 nutrient reduction response gomdom s shelfwide production and respiration rates were more responsive to nutrient reductions than cgem with integrated spring summer april to september production decreasing approximately 35 5 8 kmol compared to 12 2 2 kmol for cgem under a 60 nutrient load reduction fig 7 gomdom was also the only model simulating significant reductions of production 10 kmol 43 and respiration 9 3 kmol 41 in the mr plume a similar effect was observed in the ar plume region where primary production decreased 42 26 kmol cgem and its altered settling rate and remineralization scheme demonstrated a lesser and more uniform reduction in ipp and tr across the shelf ranging between 7 and 18 for all subregions fig 7 shelfwide response of hypoxic area to reduced nutrient load scenarios varied by model although all simulations produced a linear response in reduced hypoxic area following nutrient reductions the ratio of the percent change in hypoxic area to percent river load reduction was less than one in all simulations fig 8 a greater response of hypoxic volume than hypoxic area to nutrient load reductions was also observed with ratios of the change in hypoxic volume to hypoxic area δv δa between 1 1 and 1 75 fig 8b peak shelfwide hypoxic area simulated by gomdom was approximately 15 more responsive to nutrient load reductions than by cgem combined the mean of all models cgem gomdom cgem ir and cgem set suggests a 60 reduction in nutrient loads may result in a 32 reduction in peak mid summer hypoxic area ci 26 35 and a 43 reduction in hypoxic volume ci 33 53 each model demonstrated unique spatial variability in peak summer hypoxia response to a 60 reduced nutrient load gomdom simulated the greatest hypoxic area response in the ar plume and west shelf which decreased by 3 500 km2 73 and 2 350 km2 84 respectively fig 9 gomdom also demonstrated a large volumetric loss of hypoxia in the east shelf where simulated hypoxia was greatest cgem s greatest hypoxic area reductions were in the east shelf 1 900 km2 35 and ar plume 2 550 km2 64 however the greatest reductions in hypoxic volume were concentrated in the west shelf 11 800 km3 25 and ar plume 10 000 km3 45 increasing cgem s settling rate amplified hypoxia reduction in the western shelf as well as in the east shelf where hypoxia was reduced by 85 800 km2 cgem with instant remineralization concentrated reductions in hypoxic area in the east shelf and mr plume while decreasing nutrient reduction effects in the ar plume and west shelf fig 9 combined simulation results from all models fig 10 a indicate the greatest reduction in maximum hypoxic area is most likely to occur in the ar plume 2 398 km2 ci 1 758 to 2 670 and west shelf 1 833 km2 ci 1 481 to 2 091 in contrast hypoxia in the mr plume may only be expected to decline between 262 and 574 km2 all model subregions demonstrated a greater response in reduced hypoxic volume versus area fig 10b with the greatest δv δa ratio in the mr plume δv δa 1 49 the east shelf exhibited the highest percent decrease in hypoxic area and volume by 60 and 78 respectively 4 discussion 4 1 primary production and respiration dynamics affecting hypoxia bottom water hypoxia in the northern gulf is closely coupled to om respiration derived from primary production making it the principal metabolic pathway for converting river derived nutrients into om available for respiration rabalais and turner 2019 the spatiotemporal orientation of hypoxia is therefore highly dependent on when and where carbon is produced as well as how quickly it settles and is transported across the shelf these dynamics present unique challenges to simulating hypoxia as models must produce carbon at realistic rates while also accounting for mortality settling and lability to dictate respiration rates controlling oxygen consumption in both space and time primary production formulations in cgem and gomdom are principally a function of light intensity temperature and nutrient concentrations and are therefore closely tied to observed plume dynamics influencing light penetration and inorganic nutrient supplies that control primary production bianchi et al 2010 lohrenz et al 2008 a principle controlling factor in phytoplankton productivity between the models is the utilization of monod versus droop kinetics in gomdom and cgem respectively although monod nutrient kinetics provide a straight forward and effective method for simulating phytoplankton growth rapid nutrient uptake may overestimate production during periods of high external nutrient concentrations and may alternatively lead to low productivity during periods of reduced nutrients although more complex droop nutrient kinetics allow for internal nutrient storage buffering productivity during periods of low ambient nutrient concentrations droop 1983 droop nutrient uptake kinetics used by cgem resulted in more broadly dispersed spring summer phytoplankton production than gomdom s monod formulation which were isolated to the near plume regions of the mississippi and atchafalaya outflow fig 6 these results are consistent with previous studies comparing droop and monod nutrient formulations in the northern gulf pauer et al 2020 and chesapeake bay cerco and noel 2004 westward and offshore currents near the atchafalaya shelf in spring and summer allahdadi et al 2013 further amplify nutrient and carbon dispersal available for respiration outside of the atchafalaya river plume jarvis et al 2020 application of droop kinetics produced a more spatially accurate simulation of carbon production when compared with measured primary production rates murrell et al 2013 and satellite chlorophyll observations boesch et al 2009 le et al 2014 across the nearshore louisiana shelf although monod uptake kinetics are commonly applied in simulating phytoplankton production in varying aquatic ecosystems application in the northern gulf of mexico may impede realistic simulation of phytoplankton growth rates due to highly localized river nutrient effects resulting in underestimated carbon production and respiration across much of the shelf fig 2 total respiration rates simulated by cgem and gomdom mirrored spatial and temporal carbon production rates both models underestimated water column respiration in the immediate mississippi plume fig 2 although cgem performed better than gomdom in model data comparisons in the ar plume and west shelf fig 2 where gomdom s iwr rates remained below 150 and 90 mmol m 2 d 1 respectively limited respiration from gomdom in this region of the shelf results from a combination of forcing mechanisms including high phytoplankton production near the atchafalaya river using monod kinetics entrained phytoplankton production within atchafalaya bay and limited offshore carbon flux to the shelf beyond atchafalaya bay due to instant remineralization gomdom s river focused production and instant remineralization approach resulted in heightened water column and sediment respiration rates across the shallow atchafalaya shelf compared to cgem s elevated offshore rates fig 6 spatial displacement of carbon production and respiration between models resulted in opposing spatial patterns of hypoxia formation across the shelf gomdom s enhanced production near the mississippi river plume concentrated hypoxia in the mr plume and east shelf regions that persisted between april and september hypoxia on the western shelf was less pervasive being limited to mid summer june august and approximately half the cumulative area simulated in the eastern shelf fig 4 nonetheless hypoxia generated by gomdom in the ar plume and west shelf contributed a significant portion of the total hypoxic area during peak mid summer hypoxia albeit for a shorter duration than the eastern shelf cgem demonstrated an opposite pattern where hypoxic area and volume on the western reaches of the shelf were between 2 and 3 times greater than the eastern shelf although both models simulate comparable maximum shelfwide hypoxic areas spatial and temporal variance between models has implications for how simulated hypoxia responds to changes in physical and biological forcing mechanisms as well as reduced nutrient loads while monod kinetics produced stronger hypoxia in the commonly hypoxic region of the eastern shelf the lack of widespread carbon dispersal may inhibit the model s ability to simulate interannual variability in the size and distribution of hypoxia particularly in years with strong winds or above average freshwater flow 4 2 sensitivity of hypoxia to settling and instant remineralization while monod and droop nutrient uptake formulations regulate the timing and spatial displacement of carbon production we further identified differences in phytoplankton settling rates and sediment formulations as important controls of carbon dynamics respiration and hypoxia separate application of instant sediment remineralization and increased phytoplankton settling rate resulted in opposite effects on simulated hypoxia instant remineralization increased hypoxic area across all four subregions of the shelf with the greatest increase occurring at mid depths of the east shelf and at depths approaching 50 m on the western shelf fig 5 increased settling decreased hypoxic area with the greatest effect on the east shelf at depths extending from 5 to 50 m offshore these results are inconsistent with findings of pauer et al 2020 who instead identified an increase in hypoxic area with increased settling rates presumably due to the elimination of om with use of instant remineralization and higher settling rates the effects of both model formulations were concentrated offshore of terrebonne bay near lumcon monitoring station c6 a commonly observed hypoxic region of the shelf rabalais and turner 2019 sensitivity of simulated hypoxia in this region is likely due to enhanced carbon flux from the nearshore and mississippi river plume jarvis et al 2020 that may be altered by changing sediment respiration pathways and displacement of advected carbon resulting from different phytoplankton settling rates in the case of increased settling enhanced phytoplankton removal from the water column reduced water column respiration above and below the pycnocline while also failing to stimulate sediment remineralization due to colder bottom temperatures mean difference between surface and bottom during june august 3 6 c and advection of bottom om in contrast instant remineralization results in direct increases in respiration rates and enhanced offshore hypoxia where despite lower primary production rates om is respired instantaneously regardless of colder bottom water temperatures that may otherwise inhibit sediment respiration wilson et al 2013 the effects of instant remineralization rather than protracted bottom water decay are also apparent in the timing of hypoxia formation which increased hypoxic area much earlier in the season than the baseline cgem model fig 5 4 3 shelfwide hypoxia response to reduced nutrient loads the multiple models and alternate formulations evaluated in this study lead to varying response of hypoxic area to reduced nutrient loading scenarios fig 7 the magnitude of load reduction responses from all models were similar to nutrient reduction response from justic and wang 2014 but were less responsive than scavia et al 2003 of all the models evaluated here gomdom s predicted hypoxic area was most sensitive to nutrient reductions this may be due to a number of factors including the instantaneous response of phytoplankton production to decreased external nutrient concentrations pauer et al 2020 as well as the coarser grid size which may aggregate load reductions from more spatially heterogenous hypoxic regions of the shelf the instant remineralization formulation of cgem was least responsive of all of the models fig 7 likely due to enhanced localized respiration of the available om supply relative to models which use a natural decay order and allow for advection of bottom layer om reduced respiration rates and horizontal advection of settled om facilitates broader dissemination of om to offshore reaches of the shelf where external carbon sources are required to fuel hypoxia fry et al 2014 jarvis et al 2020 although the hypoxia task force has most recently established a 20 load reduction aimed at meeting the 5 000 km2 hypoxic area goal mississippi river gulf of mexico watershed nutrient task force 2017 hypoxic volume and its response to load reduction is recently being recognized as an important hypoxia management endpoint scavia et al 2019 few modeling studies have addressed the response of hypoxic volume to reduced nutrient loads despite the ecological relevance to many motile marine species scavia et al 2019 compared hypoxic volume response from a complex simulation model justic and wang 2014 and geostatistical model scavia et al 2013 and found that hypoxic volume was more sensitive than hypoxic area to reduced nutrient loads by a factor of between 1 06 and 1 50 our simulations also indicated greater percent reductions in hypoxic volume than hypoxic area fig 8b with comparable change in volume to area ratios δv δa between 1 1 and 1 39 for a 20 load reduction and between 1 09 and 1 25 for a 60 load reduction gomdom s hypoxic volume response was greater than cgem in part due to its lower estimated volume in the base model resulting in δv δa ratios as high as 1 73 for a 60 load reduction gomdom s suppressed hypoxic volume during reasonable peak mid summer hypoxic area suggests less sub pycnocline hypoxia may be present above the bottom model layer a reasonable assumption given gomdom s larger grid dimensions however a closer look at the 62 5 mmol m 3 hypoxia threshold applied to our simulation results indicate that gomdom s oxygen concentrations across much of the model domain remained very close but not below the hypoxic threshold for much of the summer increasing the hypoxia threshold applied to our analysis by 7 8 mmol m 3 70 3 mmol m 3 resulted in a 75 increase in hypoxic area and a 300 increase in hypoxic volume that is closer to the measured hypoxic volume fig 3 although the 62 5 mmol m 3 hypoxia threshold similarly excludes portions of the shelf that remain slightly above this cutoff calibrating models to this specific criterion may result in over parameterization in an effort to induce additional oxygen depletion we therefore believe it is more important to quantify model accuracy with context from important biological rate processes such as primary production respiration and sediment oxygen consumption rather than hypoxic area or volume alone 4 4 spatial variability in hypoxia response to reduced nutrient loads assessments of hypoxia response to reduced nutrient loads have typically emphasized a shelfwide approach rather than spatial variability of hypoxia dynamics the few studies that have addressed spatial heterogeneity in hypoxia response to reduced nutrients have identified distinct longitudinal gradients in hypoxia response for example probabilistic modeling by obenour et al 2015 determined that western shelf hypoxia may respond 12 less than eastern shelf hypoxia with nutrient reductions alone nutrient load experiments using a complex simulation model by laurent and fennel 2014 alternatively resulted in a 18 decrease in hypoxia duration in the western shelf compared to an approximate 4 decrease in duration on the eastern shelf following a 50 reduction of both nitrogen and phosphorus laurent and fennel 2017 the simulation models applied here suggest a similar longitudinal trend in hypoxia response to laurent and fennel 2017 as more hypoxic area was eliminated on the western shelf ar plume and west shelf than on the eastern shelf mr plume and east shelf the mean hypoxia response from all models in the ar plume and west shelf regions comprised 72 of the total shelfwide reduction in hypoxic area fig 10 for 4 200 km2 ci 3 240 4 761 km2 however as a percent reduction of hypoxia the east shelf eliminated a greater percentage of both hypoxic area and volume from the base model runs fig 10b we attribute this localized hypoxia effect to enhanced primary production rates of the nearshore east shelf observed here fig 6 and in numerous other studies fry et al 2014 murrell et al 2013 in addition to high in situ rates of settled organic carbon redalje et al 1994 this region of the inner shelf also receives an estimated 1 1010 mol carbon yr 1 jarvis et al 2020 from the adjacent mississippi river plume and thus reduced phytoplankton production and om advection in this region will have a significant effect on simulated respiration rates and hypoxia an important conclusion from this inter model comparison is different model formulations play a key role in determining how hypoxia responds to nutrient reductions across the shelf for instance while most models demonstrated a greater aerial and volumetric hypoxia reduction on the western shelf versus eastern shelf in response to reduced nutrients application of instant remineralization in cgem concentrated the load reduction response in the east shelf south of terrebonne bay fig 9 this heightened hypoxia response is also spatially coincident with the greatest increase in hypoxia using instant remineralization compared to the original cgem model fig 5 gomdom s elevated hypoxia response on the western shelf provides another example of the impact of model formulations on spatial variability gomdom s reduction of total respiration in the west shelf and ar plume was 2 4 times greater than the other models fig 7 as was its reduction of phytoplankton production in the near river regions mr plume and ar plume combined with its higher settling rate and instant remineralization a 60 reduction of nutrients in gomdom significantly limited offshore export of om produced within atchafalaya bay eliminating the influx of nearshore carbon necessary to sustain offshore respiration rates therefore resulted in an 81 91 reduction in hypoxia fig 9 disparate simulation results suggest model formulations can significantly alter spatial gradients of persistent versus intermittent hypoxia that may respond with varying degrees of sensitivity to reduced nutrient loads for example cgem generated more hypoxia on the western shelf that was proportionally less responsive to load reductions than the eastern shelf an area where interannual hypoxia is considered to be most persistent rabalais and turner 2019 gomdom instead favored hypoxia on the eastern shelf that was proportionally less responsive to hypoxia on the western shelf where hypoxia was nearly eliminated following load reductions these differences cannot be accounted for in simplistic analyses of hypoxic area that are commonly applied to complex simulation models in the northern gulf unfortunately the consequences of failing to adequately constrain model uncertainty resulting from different formulation options can lead to significant ambiguity in load reduction estimates and potentially misinform guidance on nutrient management policies 4 5 implications for guiding nutrient management complex simulation models offer valuable insight into spatial and temporal dynamics of hypoxia that may not be apparent in monitoring data alone unlike some systems where physical stratification processes exert a 1st order influence on seasonal oxygen dynamics irby 2016 simulation of hypoxia in the northern gulf of mexico is highly dependent on the biogeochemical parameterization driving carbon and oxygen gradients across the shelf our inter model comparison exhibits highly variable spatial displacement of hypoxia using different nutrient uptake settling and respiration including sediment remineralization formulations given the dynamic nature of hypoxia in both space and time the spatial orientation of simulated hypoxia can significantly alter estimates of hypoxic area and volume in response to physical forcing events for example summer wind patterns may affect stratification oppositely between the western and eastern shelf obenour et al 2015 and upwelling favorable winds can force hypoxia inshore at varying spatial scales thereby reducing hypoxic area but increasing hypoxic volume feng et al 2014 jarvis et al 2021 failure to realistically simulate spatial orientation of hypoxia can therefore result in erroneous estimates of hypoxic area and volume in response to varying forcing conditions additional uncertainty introduced by the hydrodynamic model linkage should also be considered when evaluating water quality simulations although both models in this study were independently calibrated and validated using similar ncom hydrodynamics their different model formulations may yield distinct results under similar hydrodynamic gradients for example gomdom s combination of higher settling rates and instant remineralization limit om advection relative to cgems broader shelf wide production and slower bottom layer remineralization cgem is consequently more strongly influenced by hydrodynamic circulation gradients resulting in greater om accumulation and respiration rates near shoals of the atchafalaya shelf jarvis et al 2020 the effects of model physics on water quality simulations are multi faceted and may include differences in sub pycnocline volume fennel et al 2016 altered nutrient and organic matter distributions jiang et al 2015 xia and jiang 2015 and variable stratification and vertical mixing gradients xia et al 2010 xia and jiang 2016 formulation options affecting biogeochemical dynamics have further implications in controlling how complex simulations models respond to reduced nutrient loads all models demonstrated a greater response in hypoxic volume than hypoxic area fig 8 agreeing with conclusions from scavia et al 2013 and scavia et al 2019 however the ratio of hypoxic area to volume reductions varied greatly between cgem and gomdom fig 8 as well as in different regions of the shelf fig 10 understanding how hypoxic volume responds to load reductions has important implications for marine taxa and gulf fisheries which are impacted to varying extents by the size and distribution of the seasonal hypoxic plume scavia et al 2019 our analysis indicates that the greatest percent reductions in hypoxic area and volume following nutrient load reductions occurred in the east shelf region this commonly hypoxic region south of terrebonne bay is noted for distinct spatial shifts in brown shrimp populations craig 2012 craig and bosman 2013 and subsequent low effort shrimping efforts purcell et al 2017 although less impactful to shelfwide hypoxia incremental nutrient load reductions below those needed to achieve the 5000 km2 goal may yield improved habitat suitability in this region of the shelf the multiple models and formulations evaluated here further varied in simulating spatial patterns of hypoxia response to reduced nutrients adding additional uncertainty to the predicted shelfwide load reduction response we identified a 24 difference in the size of the shelfwide hypoxic area between models using a 60 load reduction scenario fig 8 applying the range of responses from all models to the current 5 year average hypoxic area 2017 2021 13 928 km2 suggests a reduced hypoxic area between 7 938 11 003 km2 22 difference is possible following a 60 load reduction we can further constrain the estimated hypoxia response by applying the mean response from all models fig 8 which predicts a 9 332 km2 ci 9 053 10 306 km2 hypoxic area given the numerous models implemented in the northern gulf of mexico and the variance between their predictions resource managers have a choice between utilizing the best model based on model data comparisons and evaluating a range of predictions from multiple models however selecting the best model is rarely definitive as both cgem and gomdom demonstrate strengths and weaknesses in simulating carbon production and hypoxia in different regions of the shelf although some models may perform better than others in demonstrating model skill there is no single metric that can unambiguously define what the best model may be when compared to observations this is particularly relevant when considering the varying complexity with which models derive estimates of hypoxia as added complexity leads to additional risk of over parameterization in an attempt to mimic real world processes denman 2003 nossent and bauwens 2012 in these instances models may obtain the right answer for the wrong reasons and without an assessment of model parameterization effects this may further produce unrealistic responses to changes in forcing conditions beck et al 2017 such as reduced nutrient loads comparison of multiple models in this study suggests that significant uncertainties exist in spatiotemporal modeling of hypoxia response to nutrient load reductions quantifying the range of uncertainty in a single complex model may carry certain limitations whereas evaluation of multiple models applied in a similar context can bound uncertainty inherent to individual simulation models we therefore believe it is imperative that complex simulation models be considered in a multi model comparison context to constrain uncertainty in application of mechanistic formulations much the same as how geostatistical models have been applied in the last decade in doing so complex models may be used to more effectively communicate the range of expected results to resource managers to guide or inform policy development 5 conclusions this work identified significant spatiotemporal variability in simulation of hypoxia dynamics between complex biogeochemical models developed for the northern gulf of mexico differences in model formulations controlling phytoplankton and organic matter rate processes resulted in disparate spatial patterns of hypoxia formation throughout the spring and summer these differences further affected simulated response of hypoxic area to nutrient load reductions which varied as much as 24 between models our results indicate that uncertainty derived from the selection of model formulations can alter the predictive outcomes of complex simulation models thus presenting risk of misinforming management decisions when such information is used in a vacuum this study highlights the importance of multiple model evaluation in the context of reducing ambiguity and increasing confidence in process based model simulations for environmental management decision making declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we thank the many contributions of usepa staff for their efforts in supporting modeling efforts through the production of quality data spanning years of research cruises we also acknowledge mark rowe for his valuable review and comments this research was supported by the u s environmental protection agency office of research and development center for environmental measurement and modeling and by u s epa s safe and sustainable water resources research program development of ncom was supported by the u s naval research laboratory and by an interagency agreement between the u s epa and the u s naval research laboratory the views expressed in this article are those of the authors and do not necessarily reflect the views or policies of the u s environmental protection agency the mention of trade names or commercial products does not constitute endorsement or recommendation for use data presented in this manuscript are available at data gov as well as usepa s environmental dataset gateway https doi org 10 23719 1523052 appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2022 105365 
