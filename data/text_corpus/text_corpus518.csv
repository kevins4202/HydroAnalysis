index,text
2590,the ensemble forecasts from numerical weather prediction nwp models are considered as essential elements for operational hydrologic forecasting however these forecasts are burdened with significant inherent biases and cannot be used directly for hydrologic forecasting therefore the present study examines the capability of ensemble precipitation forecasts obtained from two nwp models i e a 20 member ensemble from the national center for environmental prediction ncep and a 50 member ensemble from the european center for medium term weather forecasts ecmwf the skill of 70 member multi model grand ensemble mme generated from the ncep and ecmwf forecasts is also verified in this study furthermore post processing of the raw ensemble members was carried out using two methods quantile mapping qm and quantile regression forests qrf in order to minimize the inherent biases the analysis was performed over subbasins of an indian river basin namely the godavari river basin here a set of deterministic and probabilistic verification measures forecast error box plots correlation coefficient relative mean error mean continuous ranked probability score spread skill relationship rank histograms reliability diagram area under relative operating characteristic curve were employed to assess various quality attributes of the forecasts the findings from the study suggests that qrf post processed ncep and mme forecasts are comparatively better than other forecasts in terms of all employed verification measures over all subbasins the qrf post processed forecasts were found to be superior than qm post processed and raw forecasts over all subbasins the adopted post processing methods resulted in improved forecasts at shorter lead times however the skill of both raw and post processed forecasts declines at higher lead times over all subbasins keywords ensemble forecasts numerical weather prediction statistical post processing forecast verification precipitation data availability data will be made available on request 1 introduction reliable and skillful ensemble hydrologic forecasts are needed for reservoir operations hydropower and forecasting of hydrological extremes such as droughts and floods cloke and pappenberger 2009 das et al 2022 madadgar et al 2014 however the accuracy of hydrologic forecasts usually depends upon the uncertainties associated with meteorological and hydrological models cloke and pappenberger 2009 cloke and schaake 2018 precipitation is the key variable of interest in hydrologic forecasting as it is the driving force in the hydrological cycle the uncertainty associated with the precipitation forecasts is a major contributor to the uncertainties in the hydrologic forecasts wu et al 2020 accurate precipitation forecasts are pivotal for generation of reliable and skillful hydrologic forecasts hence the hydrological community is shifting towards adoption of ensemble forecasts to quantify the uncertainties in forecasting systems ensemble weather forecasts for meteorological variables such as precipitation and temperature are simulated by different numerical weather prediction nwp models for the lead times ranging from short 0 3 days to medium range 3 15 days the obtained ensemble forecasts are then inputs to the calibrated hydrological models to generate ensemble streamflow forecasts despite the progressive efforts in evolution of nwps by understanding the underlying the atmospheric physics accurate prediction of precipitation along with storm intensity and location still remains a critical challenge novak et al 2014 siddique et al 2015 however a systematic forecast verification framework is quintessential to monitor verify and quantify the skill of ensemble forecasts obtained from nwps the quality of the forecasts from nwps is generally assessed by reconstructing retrospective forecasts for the previous period also known as hindcasts ratri et al 2019 the degree of correspondence between the hindcasts and the observations is assessed through various deterministic and probabilistic verification measures hence a systematic forecast verification framework assists the policy makers researchers and various forecast users to understand the inherent errors and biases of the forecasts sharma et al 2017 multitudes of verification studies spanning across the globe were reported so far for various forecasting systems such as national centers for environmental prediction ncep global ensemble forecast system reforecast gefsrv2 baxter et al 2014 brown et al 2014 kim et al 2018 siddique et al 2015 and the short range ensemble forecast sref brown et al 2012 siddique et al 2015 european centre for medium range weather forecasts ecmwf hamill 2012 leonardo and colle 2017 medina et al 2019 united kingdom met office unified model ukmo anderson et al 2019 leonardo and colle 2017 ran et al 2018 apart from the advantages of ensemble precipitation forecasts liu et al 2012 park et al 2008 the raw ensemble forecasts are not suitable as direct input for hydrological applications due to their inherent biases hence various statistical post processing methods are generally employed for spatial downscaling and correction of forecast biases in terms of mean and ensemble spread hamill et al 2004 despite of the adoption of ensemble weather prediction system in india since 2018 the existing flood forecasting systems are still deterministic and unable to address the uncertainties in flood forecasts nanditha and mishra 2021 teja and umamahesh 2020 no studies have been reported so far in india that look into the ensemble flood forecasts in a catchment with a regional outlook the primary objective of this study is to verify and quantify the skill of raw and post processed ensemble precipitation forecasts from two nwp models in the godavari river basin grb india the main motive behind this verification study is to assist the hydrological community in choosing the best suitable forecasts and post processing method to develop a reliable ensemble flood forecasting system it is also important to verify the forecasts as grb is often prone to floods that can cause devastating damage garg and mishra 2019 rakhecha and singh 2017 limited studies were documented so far verifying the skill of ensemble precipitation forecasts for grb chakraborty et al 2021 dube et al 2017 durai and bhardwaj 2014 and no studies were reported so far comparing the skill of raw and post processed forecasts in this context the following questions are explored and addressed how to compare the skillfulness of various forecasting systems how does the predictive skill of the ensemble precipitation forecasts fluctuate among and within various forecasting systems and quality attributes how does the quality of ensemble forecasts differ over varying lead times does statistical post processing of precipitation forecasts lead to enhanced forecasts for this purpose the quantitative ensemble precipitation forecasts from two nwp models i e 50 member european centre for medium range weather forecasts ecmwf 20 member national centers for environmental prediction ncep forecasts and 70 member multi model grand ensemble mme were verified the skill of raw and post processed ncep ecmwf and mme forecasts were verified against the observations as a preliminary analysis for hydrologic forecasting 2 study area and datasets 2 1 study area the godavari river basin grb is one of the largest river basins in the indian subcontinent with a catchment area of 3 13 000 km2 which is about 10 of india s geographical area cwc 2018 grb lies between 73 24 to 83 40 east longitudes and 16 19 to 22 34 north latitudes cwc and nrsc 2014 the major subbasins are manjira wardha weinganga godavari upper godavari middle godavari lower indravati and pranahita the average annual rainfall of this basin is about 1100 mm cwc 2018 however the grb receives 85 of its annual rainfall during the south west monsoon june to september kulkarni et al 2010 the location map of the grb along with its subbasins is shown in fig 1 2 2 datasets precipitation ensembles from two nwp models were obtained at a spatial resolution of 0 250 0 250 from the observing system research and predictability experiment thorpex interactive grand global ensemble tigge database over the study area the skill of ensemble precipitation forecasts of two nwp models i e ncep a 20 member ensemble and ecmwf a 50 member ensemble were verified in this study against precipitation records the above nwp models generates forecasts up to 15 day lead time at 6 hourly accumulations generated or initiated 4 times a day at 0 6 12 18 hr time steps in this study the retrospective precipitation forecasts initiated at 0th hour are considered for forecast verification at varying lead times 1 to 15 days for 24 hr accumulations in order to assess the performance of a multi model grand ensemble mme a 70 member ensemble forecasts by integrating ncep and ecmwf forecasts has also been used in this study the ncep ecmwf and mme forecasts are collected from the period between 2009 and 2020 for 1 day to 15 day lead times the selected nwp ensemble forecasts were verified against the observed daily precipitation data available from indian meteorological department imd at 0 250 0 250 spatial resolution pai et al 2014 this data set is at present the highest quality collection of observations on the indian sub continent 3 methodology 3 1 verification measures a mixed pool of verification measures that includes deterministic and probabilistic metrics is used in this study for forecast verification deterministic metrics assess the quality of the ensemble mean whereas probabilistic metrics evaluate the errors in the forecast probabilities 3 1 1 deterministic metrics the linear correlation coefficient and relative mean error rme are used in this study as the deterministic metrics to measure the match with the observed temporal dynamics and under overestimation biases respectively sharma et al 2017 siddique et al 2015 the equation of rme is given in eq 1 r m e i 1 n e i o i i 1 n o i where 1 e i 1 m k 1 m e i k where m is the number of ensemble members e i k is the forecast for k th member at time i o i denotes the corresponding observation at time i and n represents the total number of pairs of observed and forecast values 3 1 2 probabilistic metrics as per murphy and winkler 1987 the quality of ensemble forecasts is determined by analyzing the following attributes reliability sharpness resolution discrimination bias accuracy and skill probabilistic measures are generally employed to analyze the aforementioned attributes in the forecasts 3 1 2 1 mean continuous ranked probability score crps the continuous ranked probability score crps is a widely used probabilistic performance measure of ensemble forecasts wilks 2011 crps is a quadratic measure that evaluates the difference between the cumulative distribution functions cdf of probabilistic forecasts and observed values zamo and naveau 2018 crps is similar to mean absolute error mae of deterministic forecasts thereby it can be easily interpreted the equation of crps is given in eq 2 2 crps f e h f o h 2 d h where f e and f o are the forecast and observed cdfs respectively and h represents every possible threshold crps is averaged over the total pairs of forecast and observed values to verify a set of forecasts the lower the mean crps the better the forecasts are 3 1 2 2 spread skill relationship in the case of an ideal ensemble forecast the mean of the ensemble spread should be equal to the skill score e g root mean square error rmse over the same period wang et al 2013 whitaker and louche 1998 zhu and toth 2008 in order to assess this feature the relationship between ensemble spread and skill is often investigated in this study rmse is used as the skill score and standard deviation of ensemble members is used to represent the ensemble spread both rmse and standard deviation are normalized with observed standard deviation to compare the skill of forecasts with respect to a climatological value when the skill score rmse line is above and far from the spread line the ensemble is considered over confident i e under dispersive if rmse is lower than ensemble spread it indicates an under confident over dispersive forecast ideally rmse should be equal to ensemble spread for a forecast to be consistent and reliable 3 1 2 3 rank histograms equiprobability of ensemble members is an ideal quality of ensemble forecasts the ensemble members should be equally probable in principle as all perturbed initial conditions varying physics and model structures could possibly be true bellier et al 2017 hamill 2001 to check the equiprobability of ensemble members rank histograms are used they are generated by repeatedly accumulating the rank of the observed values with respect to the ensemble forecasts sorted from lowest to highest a uniform histogram is desirable representing equal likelihood of each ensemble member since rank histograms do not assess the resolution of forecasts they are used in conjunction with other evaluation measures such as crps and area under relative operating characteristic roc curve to understand more about the quality of ensemble forecasts hamill 2001 3 1 2 4 reliability diagrams reliability diagrams are frequently used graphical tools to visualize joint distribution of forecasts and dichotomous events observations to assess the reliability of probabilistic forecasts casati et al 2008 dube et al 2017 ratri et al 2019 quantitative precipitation forecasts are converted to probabilistic forecasts based on an exceedance threshold h and segregated into k bins the average probability of the forecasts corresponding to the k th bin b k is given by 3 f e k h 1 i k i k f e i h w h e r e i k i i b k the corresponding average probability of the observations is given by 4 f o k h 1 i k i k f o i h w h e r e f o i h 1 o i h 0 o t h e r w i s e the forecast probabilities f e k h of an event are plotted against the corresponding observed frequencies given forecast probability f o k h for a total number of forecasts i k in each bin b k in this study an exceedance threshold of 1 mm is chosen to plot reliability diagrams to assess the reliability of nwps in forecasting precipitation events 3 1 2 5 area under roc curve auc relative operating characteristic roc curves are graphical representation of trade off between the fraction of hits true alarm and fraction of false alarms to measure event discrimination casati et al 2008 gill and buchanan 2014 wilks 2011 for a given threshold h the hit rate and false alarm rate are given by 5 hit r a t e i 1 n i e i f e i h d o i h i 1 n i o i o i h 6 false alarm rate i 1 n i e i f e i h d o i h i 1 n i o i o i h where d is the probability threshold at which the event causes some action i e the forecast is considered an occurrence and i is the indicator function the roc curve plots false alarm rate against the hit rate using a set of decreasing forecast probability threshold decreases for possible values of d 0 1 ideally with decreasing forecast probability thresholds the hit rate should increase faster than the false alarm rate area under the roc curve auc is a scalar entity that summarizes discrimination between events and non events an auc of 0 5 indicates random forecasts while an auc value of 1 reflects perfect forecasts the value of auc of a probabilistic forecast greater than 0 7 is considered as useful whereas the auc above 0 8 is regarded as a good prediction ben bouallègue and theis 2014 mullen and buizza 2002 a threshold of 1 mm is chosen in this study to compute the auc values 3 2 statistical post processing methods two statistical post processing techniques were used in this study to post process the raw ensemble forecasts obtained from ncep and ecmwf the forecast data from the period 2009 to 2015 is used as the training dataset for post processing models the fitted models are used to post process the raw daily forecasts from the period 2016 to 2020 it should be noted that the forecast verification is performed from the period 2016 to 2020 a brief description about the selected post processing methods is given in the succeeding sections 3 2 1 quantile mapping the ensemble precipitation forecasts obtained from the nwp models comprise of inherent biases due to the chaotic nature of atmospheric circulation and their regulating dynamic feedbacks christensen et al 2001 these biases should be corrected in order to improve the quality of the forecasts quantile mapping also known as histogram equalization is a simple and most widely used bias correction method acharya et al 2013 in this method the distribution function of modelled variable is transformed such that it matches the distribution of observed variable based on the assumption that the internal errors in the nwp models and scale relationship are time invariant the correction factor obtained during calibration period is valid for future period gudmundsson et al 2012 reported that nonparametric quantile mapping has the best performance among different bias correction methods the bias correction has been performed on each ensemble member of the raw ensemble forecasts at each grid point using eq 7 by considering 2009 2015 as the calibration period then the obtained correction factor from the calibration period is used for correcting the bias during validation period 7 p o f o 1 f m p m where p o and p m are observed and forecasted precipitation f m represents the cumulative distribution function cdf of p m and f o 1 is the inverse cdf corresponds to p o for performing non parametric quantile mapping qmap package in r has been used that can be downloaded from https cran r project org web packages qmap index html 3 2 2 quantile regression forests quantile regression forests qrf is a nonparametric postprocessing method developed by meinshausen 2006 qrf provides a nonparametric way to evaluate conditional quantiles for high dimensional predictors of variables this technique has been used for meteorological data such as precipitation by bhuiyan et al 2018 and taillardat et al 2016 given a set of predictors quantile regression technique helps to estimate the conditional median and any quantile values of the response variable whereas the classical regression techniques are helpful in estimating the conditional mean of a response variable the conditional distribution function f y x x is expressed as given in eq 8 8 f y x x p y y x x e 1 y y x x where x y represents the covariate and the observations of the response variable respectively and e represents the conditional mean e 1 y y x x in qrf random forests are generated from binary regression trees called classification and regression trees cart that provide robust estimates of conditional quantiles after building the random forests a new vector of predictors and its associated leaf in each tree will be determined using binary splitting this iterative binary splitting on predictors aggregates the observations according to their forecasts therefore for every precipitation event an ensemble of observations is restored to create an empirical cumulative distribution function cdf the weighted average of the cdfs from all the trees is the final forecast which can be used to obtain the predictive quantiles the weighted mean over the observation of 1 y y 1 y y is a step function with a value of 1 when y y and with a value of 0 when y y is used to estimate the conditional mean in eq 9 then the conditional distribution function in eq 9 can be defined as 9 f y x x i 1 n w i x 1 y y 10 w i x k 1 t 1 k w i x θ t where w i x is the weight vector estimating using random forest regression k represents the number of trees and θ is an independent and identically distributed random parameter vector that determines the growth of the tree e g variables that determine the split points at each node the major advantage of qrf is that it not only retains the mean but also keeps all the observation values in the nodes to calculate the conditional distribution the final cdf obtained from weighted average cdf of all trees is bounded between the lowest and highest value of the learning sample and can forecast only the quantiles within these limits the algorithm for computing the estimate of the conditional distribution function f y x x can be summarized as step 1 grow k trees as in random forests the corresponding tree is denoted by t θ t t 1 k all the observations should be retained for every leaf of every tree step 2 for a given x x drop down all trees compute weight w i x for every observation i 1 n as an average over w i x θ t t 1 k as in eq 10 step 3 compute the estimate of the conditional distribution function as in eq 9 for all y r using the weights from step 2 for a quantile of order α the probability of the random variable to be less than y is α i e cdf value for y thus the quantiles are estimated by eq 11 11 q α p y y x x α instead of using the raw ensemble forecasts this method can potentially use other predictors and has the advantage of maintaining non linearity for instance bhuiyan et al 2018 used global reanalysis precipitation and air temperature datasets along with satellite near surface soil moisture and elevation datasets as predictors to post process multiple global precipitation datasets however qrf needs a large training dataset which is a major drawback in this study all the ensemble members 20 members for ncep forecasts and 50 members for ecmwf forecasts were used as predictors for post processing the tree size is set to 1000 with maximum size of terminal nodes as 20 in this study the post processing of raw forecasts using quantile regression forests was performed using quantregforest package in r meinshausen 2017 4 results and discussion the mean areal precipitation of ensemble forecasts both raw and post processed ncep and ecmwf and observed precipitation from imd over each sub basin of godavari river basin is computed the skill of basin averaged forecasts was verified against basin averaged imd precipitation records using a pool of deterministic and probabilistic evaluation measures 4 1 rank histograms rank histograms measures the frequency of observation to fall between each pair in an ordered set of ensemble values the under dispersiveness in the ensemble forecasts leads to higher frequencies of the extreme ranks asymmetric histograms represent the bias in the forecasts and the histograms should be uniform for ideal forecasts the rank histograms of the ncep and ecmwf forecasts at 1 day lead time are plotted in fig 2 for brevity of plots the rank histograms of mme forecasts were not plotted in this section it can be noticed that both ncep and ecmwf raw forecasts overpopulate the bins on the very left at all subbasins indicating biased and under dispersive forecasts however it should be noted that ecmwf forecasts are highly biased in comparison to ncep forecasts the higher frequencies in the very left side of the histograms of raw ncep and ecmwf forecasts are decreasing with increasing lead time and the frequencies on the very right side of the histograms were found to be increasing with increasing in lead time leading to u shaped distribution refer to figs s1 and s2 this shows that the raw forecasts are becoming more under dispersive with respect to lead time statistical post processing has alleviated the problem of bias in the raw forecasts to some extent the rank histograms of qrf post processed forecasts were found to be comparatively uniform than qm post processed forecasts the u shaped distribution of qm post processed forecasts denote that the forecasts are still under dispersive it should be noted that the rank histograms of ncep qrf forecasts are slightly biased at lower godavari and indravati whereas ecmwf qrf are biased at lower godavari upper godavari indravati and pranahita subbasins 4 2 boxplots of forecast error in this section the performance evaluation measures described in the preceding section were used to assess the skill of raw and post processed ensemble precipitation forecasts the forecast error boxplots of basin averaged 24 hourly accumulations of raw and post processed qm and qrf forecasts of ncep and ecmwf are plotted against increasing amount of observed precipitation in figs 3 and 4 respectively for 1 day short lead time for brevity of plots forecast boxplots of mme were excluded in this subsection similarly the forecast error boxplots for higher lead times 5 day and 15 day lead times were also provided in figs s3 to s6 it can be observed from figs 3 and 4 that both ncep and ecmwf forecasts raw and post processed constantly underestimates the extreme precipitation events in all subbasins whereas light to moderate precipitation events below 20 mm and above 1 mm day are slightly overestimated however qrf post processed forecasts is slightly better when compared to that of raw forecasts at all lead times for light to moderate precipitation events in agreement with the results of previous studies siddique et al 2015 the raw forecasts from nwps tend to underestimate extreme precipitation events as a result of conditional biases i e the forecast error is correlated to the observed precipitation the forecast boxplots at higher lead times figs s3 to s6 show that the inter quartile range iqr of boxplot of forecast errors is decreasing from 1 to 15 day lead times and is approximately equal to that of the magnitude of observed precipitation indicating the inability of nwps to forecast extreme events at higher lead times this shows that the ensemble spread is smaller at longer lead times indicating an over confident forecast this is plausibly due to nudging of nwps towards climatological values wilks 2006 this analysis suggests that further research is necessary with a target to improve the ability of nwps in simulating extreme precipitation events the ecmwf forecast errors raw and post processed in lower godavari indravati manjira and weinganga are higher at larger precipitation events when compared to other subbasins at all lead times the error associated with ncep forecasts raw and post processed also follows similar pattern as that of ecmwf to summarize both qm and qrf methods are effective at removing the inherent biases in raw forecasts however they differ in their abilities to correct forecast spread and provide reliable forecasts it is evident that the forecast error boxplots of qm postprocessed ncep forecasts are overly narrow at higher precipitation amounts indicating smaller ensemble spread 4 3 performance evaluation of ensemble mean the ability of ensemble mean to capture the temporal dynamics of observed precipitation events is assessed by computing correlation coefficient fig 5 shows the correlation coefficient between ensemble mean of forecasted precipitation and observed precipitation for lead times varying from 1 to 15 days it can be noticed that the correlation coefficient is high at lead time of 1 day and tends to decrease with increase in lead time denoting that forecasts are unable to capture the observed events at higher lead times despite the fact that the correlation tends to decrease with forecast lead time an increase in the correlation can be observed in ncep forecasts raw and post processed can be observed after a lead time of 6 days in middle godavari upper godavari indravati wardha and weinganga subbasins similar correlation patterns were observed in the study of sharma et al 2017 where the correlation is found to be increasing at higher lead times as the basin size increases furthermore the basin averaging of precipitation plausibly alleviates the spatial forecast errors leading to improved correlation the correlation of raw mme forecasts is found to be higher than that of raw forecasts from individual nwp models and is found to be as skillful as the post processed forecasts it is worth mentioning that the qrf post processed forecasts were found to be better than that of their corresponding raw forecasts in terms of correlation coefficient in all the subbasins however qrf post processed ncep and mme forecasts are outperforming the remaining forecasts in all the subbasins the mean of qm post processed forecasts were found to be less correlated with the observed precipitation when compared with their corresponding raw forecasts qm method can produce both positively for ecmwf and mme and negatively for ncep skillful forecasts on the grounds that it neglects the association between the observations and raw forecasts the skill of ncep forecasts is found to be good in indravati and weinganga subbasins with a correlation greater than 0 4 event at a higher lead times 7 days similarly the correlation of ensemble mean except qrf post processed forecasts and observed values is low at lower godavari manjira and pranahita at higher lead times to understand the under over estimation bias of the forecasts rme between mean of the ensemble forecasts and observed precipitation is computed for varying lead times ranging from 1 day to 15 days fig 6 it can be observed that the raw forecasts are being overestimated in upper godavari and wardha subbasins at almost all lead times due to the inherent biases with increasing lead times the post processed ecmwf forecasts were underestimated in all subbasins the ncep qrf forecasts were found to be less biased in all subbasins except middle godavari and wardha subbasins the performance of raw and post processed mme forecasts were found to be satisfactory in terms of rme at all the sub basins indicating the mulit model ensembling alleviates the biases the skill of post processed ecmwf forecasts is found to be superior in terms of rme in wardha subbasin the verification results in terms of correlation coefficient and rme were found to be in line with the findings of siddique et al 2015 and sharma et al 2017 4 4 spread skill relationship the spread skill relationship of the ncep ecmwf and mme forecasts are evaluated and plotted in fig 7 for lead times ranging from 1 to 15 days the skill score rmse in this study should be equal to the mean of ensemble spread for consistent and reliable ensemble forecast rmse values higher than the spread indicates under dispersive over confident forecasts and vice versa from fig 7 it can be noticed that ncep ecmwf and mme forecasts raw and post processed are under dispersive at all subbasins at all lead times the ensemble spread of raw forecasts is low at smaller lead times and is increasing with increasing lead time the ensemble spread of post processed forecasts is higher than that of raw forecasts at smaller lead times alleviating the under dispersion of raw forecasts however the spread of both raw and post processed forecasts converges at lead times from 11 to 15 days it should be noted that the rmse at upper godavari pranahita and wardha subbasins are considerably greater 1 than that of rmse at remaining subbasins it can also be observed that rmse of qm post processed forecasts are high indicating poor skill in comparison to qrf post processed forecasts a good linear relation is observed between rmse and spread of qrf post processed forecasts in comparison to other forecasts it shows the ability of qrf post processed forecasts in preserving the spread skill relationship 4 5 continuous ranked probability score crps crps generalizes the mean absolute error mae to case of probabilistic forecasts lesser the mean crps value the more accurate the forecasts are the mean crps value of ensemble forecasts for various lead times ranging from 1 day to 15 days is plotted in fig 8 the general tendency of the mean crps to increase with resepect to lead time the mean crps value of the raw and qm post processed forecasts is high at shorter lead times 1 to 3 days at most of the subbasins however the mean crps values are low in all subbasins except lower godavari indravati and weinganga the higher values of mean crps and correlation coefficient in indravati and weinganga subbasins indicates that the ensemble spread is comparatively higher in comparison to the ensemble spread in other basins however the good correlation between ensemble mean and observations shows the skill of ensemble spread in capturing the observed events this problem of high low ensemble spread leading to under over confident forecasts can be alleviated by employing post processing methods raftery et al 2005 it can be noticed from the figure that the performance efficiency in terms of crps has increased with the application of qrf to ncep ecmwf and mme forecasts in all subbasins however the mme forecasts are comparatively better than the forecasts from individual nwps in all subbasins the qrf post processed mme and ncep forecasts were found to be more skillful in all sub basins at all lead times 4 6 reliability diagrams with the intent to evaluate the reliability of ncep and ecmwf forecasts reliability diagrams are plotted for 1 day fig 9 5 day fig s7 and 15 day fig s8 lead times in an ideal case the curve of observed frequency for given forecast probabilities should be close to the diagonal the log transformed curves in the inset of reliability plot indicates the sharpness of the forecast i e how frequently each probability was issued from fig 9 it can be noticed that the raw ncep ecmwf and mme forecast are under dispersive over confident for forecast probabilities greater than 0 4 over all subbasins at 1 day lead time however it can be clearly observed that the reliability has increased in the post processed forecasts at 1 day lead time it is also important to notice that qm post processed forecasts are slightly more reliable closer to the diagonal line in comparison to qrf post processed forecasts however the qm post processed forecasts were found to be under confident for forecast probabilities less than 0 8 for middle godavari indravati manjira wardha and weinganga the qrf post processed forecasts are slightly over confident for forecast probabilities less than 0 8 in most of the subbasins and are more reliable than qm post processed forecasts for higher forecast probabilities 0 8 no significant difference has been observed between the performance of ncep ecmwf and mme forecasts post processed with qrf method however it can be noticed form figs s7 and s8 that the reliability of both raw and post processed forecasts declines with increasing lead times 4 7 area under roc curve auc area under the roc curve auc is a scalar measure that quantifies the discrimination ability of forecasts between occurrences and non occurrences the ability of event discrimination of ncep ecmwf and mme forecasts in term of area under roc curve auc is plotted for different lead times across all subbasins in fig 10 from the figure it can be observed that auc at all subbasins at all lead times is greater than 0 75 indicating that the forecasts are useful as mentioned in the methodology section it can also be observed that the value of auc is decreasing with increasing lead time at all subbasins this indicates that the discrimination ability of forecasts declines with lead time suggesting an increased false alarm rate the auc values of raw ncep forecasts at 3 days to 5 days lead time are deteriorating at middle godavari manjira and wardha subbasins which is efficiently alleviated by post processing the overall performance of post processed forecasts is better than raw forecasts highlighting the potential of post processing qrf post processed ncep and mme forecasts are outperforming other forecasts at all subbasins for all lead times it should also be noticed that the auc values at manjira and pranahita are lower in comparison to other subbasins 5 summary and conclusions in this article the skill of ensemble precipitation forecasts from european centre for medium range weather forecasts ecmwf national centers for environmental prediction ncep from the observing system research and predictability experiment thorpex interactive grand global ensemble tigge database is evaluated over the eight subbasins of godavari river basin india these two forecasting systems are preferred as they are operational have multiyear datasets and or capture scenarios that forecasters are interested in sharma et al 2017 along with them the skill of the multi model grand ensemble mme generated by integrating ncep and ecmwf forecasts is also verified in this study two statistical post processing methods are employed in order to emphasize the ability of post processing methods to alleviate the conditional biases in the raw forecasts the verification was conducted for daily accumulations for different lead times 1 to 15 days in hindcast mode the deterministic and probabilistic measures forecast error box plots correlation coefficient rme mean crps spread skill relationship rank histograms reliability diagram auc are employed to verify the skill of basin averaged raw and post processed forecasts in comparison to the observed data during the period from 2016 to 2020 the key findings of this verification study are mentioned below the skill of both ncep and ecmwf raw forecasts in capturing the observed extreme precipitation events is poor across all lead times and statistical post processing also could not alleviate this problem this highlights the need to develop the underlying physics of nwps to accurately forecast extreme precipitation events the correlation between ensemble mean and observed precipitation declines with increasing lead time whereas rme does not depend upon lead time the ensemble mean of qrf post processed ncep and mme forecasts are outperforming other forecasts in all subbasins in terms of correlation coefficient and rme at all lead times the ensemble spread error relationship in the post processed forecasts is improved in comparison to raw forecasts it is also found that qrf outperforms qm in preserving the ensemble spread error relation the rank histograms suggest that both ncep and ecmwf raw forecasts are under dispersive and biased at all subbasins however post processing of raw forecasts has alleviated the problem of bias based on the analysis of reliability diagrams the raw ncep and ecmwf forecasts tend to be overconfident whereas the post processed forecasts are performing well at 1 day lead time however the reliability declines with increasing lead times due to overconfident forecasts the auc values are found to be greater than 0 75 at all lead times and all subbasins showing that the forecasts are useful the discrimination ability of forecasts in terms of auc is found to be decreasing with lead time indicating a higher false alarm rate the results of the analysis suggest that the performance of raw mme is comparatively better than raw ncep and ecmwf forecasts in terms of the employed verification measures however the qrf post processed ncep and mme are performing equally well hence keeping in mind of the computational cost 20 member qrf post processed ncep forecasts are suggested for hydrologic forecasting applications over the present study area the overall performance of ncep and mme forecasts is found to be better than ecmwf forecasts the performance of qrf post processed forecasts is found to be outperforming qm post processed and raw forecasts the underperformance of qm is due to the fact that it does not account for the under over spread in the raw forecasts and it does not consider the correlation between raw forecasts and observations leading to unreliable forecasts the performance of post processed forecasts in lower godavari middle godavari indravati manjira and weinganga is found to be satisfactory in terms of both deterministic and probabilistic measures the performance of qrf post processed ncep and mme forecasts was found to be satisfactory at most of the subbasins for all verification measures even though the aforementioned verification results provide diagnostic information about the skill of ensemble precipitation forecasts they do not provide any information on how to improve the nwp models more weather factors than only precipitation are needed to properly understand the physical and environmental factors linked to forecast errors and skill moore et al 2015 in future we plan to explore and evaluate various forecasting scenarios to assess the benefits of integrating the outputs from different precipitation forecasting systems different hydrologic model structures and hydrological post processing techniques to potentially improve flood forecasting across spatiotemporal scales credit authorship contribution statement velpuri manikanta conceptualization methodology writing original draft k nikhil teja visualization investigation writing review editing jew das visualization writing review editing n v umamahesh visualization investigation supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work has been funded by the indian institute of tropical meteorology under monsoon mission phase ii project no iitm mm ii nit 2018 ind 6 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128794 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2590,the ensemble forecasts from numerical weather prediction nwp models are considered as essential elements for operational hydrologic forecasting however these forecasts are burdened with significant inherent biases and cannot be used directly for hydrologic forecasting therefore the present study examines the capability of ensemble precipitation forecasts obtained from two nwp models i e a 20 member ensemble from the national center for environmental prediction ncep and a 50 member ensemble from the european center for medium term weather forecasts ecmwf the skill of 70 member multi model grand ensemble mme generated from the ncep and ecmwf forecasts is also verified in this study furthermore post processing of the raw ensemble members was carried out using two methods quantile mapping qm and quantile regression forests qrf in order to minimize the inherent biases the analysis was performed over subbasins of an indian river basin namely the godavari river basin here a set of deterministic and probabilistic verification measures forecast error box plots correlation coefficient relative mean error mean continuous ranked probability score spread skill relationship rank histograms reliability diagram area under relative operating characteristic curve were employed to assess various quality attributes of the forecasts the findings from the study suggests that qrf post processed ncep and mme forecasts are comparatively better than other forecasts in terms of all employed verification measures over all subbasins the qrf post processed forecasts were found to be superior than qm post processed and raw forecasts over all subbasins the adopted post processing methods resulted in improved forecasts at shorter lead times however the skill of both raw and post processed forecasts declines at higher lead times over all subbasins keywords ensemble forecasts numerical weather prediction statistical post processing forecast verification precipitation data availability data will be made available on request 1 introduction reliable and skillful ensemble hydrologic forecasts are needed for reservoir operations hydropower and forecasting of hydrological extremes such as droughts and floods cloke and pappenberger 2009 das et al 2022 madadgar et al 2014 however the accuracy of hydrologic forecasts usually depends upon the uncertainties associated with meteorological and hydrological models cloke and pappenberger 2009 cloke and schaake 2018 precipitation is the key variable of interest in hydrologic forecasting as it is the driving force in the hydrological cycle the uncertainty associated with the precipitation forecasts is a major contributor to the uncertainties in the hydrologic forecasts wu et al 2020 accurate precipitation forecasts are pivotal for generation of reliable and skillful hydrologic forecasts hence the hydrological community is shifting towards adoption of ensemble forecasts to quantify the uncertainties in forecasting systems ensemble weather forecasts for meteorological variables such as precipitation and temperature are simulated by different numerical weather prediction nwp models for the lead times ranging from short 0 3 days to medium range 3 15 days the obtained ensemble forecasts are then inputs to the calibrated hydrological models to generate ensemble streamflow forecasts despite the progressive efforts in evolution of nwps by understanding the underlying the atmospheric physics accurate prediction of precipitation along with storm intensity and location still remains a critical challenge novak et al 2014 siddique et al 2015 however a systematic forecast verification framework is quintessential to monitor verify and quantify the skill of ensemble forecasts obtained from nwps the quality of the forecasts from nwps is generally assessed by reconstructing retrospective forecasts for the previous period also known as hindcasts ratri et al 2019 the degree of correspondence between the hindcasts and the observations is assessed through various deterministic and probabilistic verification measures hence a systematic forecast verification framework assists the policy makers researchers and various forecast users to understand the inherent errors and biases of the forecasts sharma et al 2017 multitudes of verification studies spanning across the globe were reported so far for various forecasting systems such as national centers for environmental prediction ncep global ensemble forecast system reforecast gefsrv2 baxter et al 2014 brown et al 2014 kim et al 2018 siddique et al 2015 and the short range ensemble forecast sref brown et al 2012 siddique et al 2015 european centre for medium range weather forecasts ecmwf hamill 2012 leonardo and colle 2017 medina et al 2019 united kingdom met office unified model ukmo anderson et al 2019 leonardo and colle 2017 ran et al 2018 apart from the advantages of ensemble precipitation forecasts liu et al 2012 park et al 2008 the raw ensemble forecasts are not suitable as direct input for hydrological applications due to their inherent biases hence various statistical post processing methods are generally employed for spatial downscaling and correction of forecast biases in terms of mean and ensemble spread hamill et al 2004 despite of the adoption of ensemble weather prediction system in india since 2018 the existing flood forecasting systems are still deterministic and unable to address the uncertainties in flood forecasts nanditha and mishra 2021 teja and umamahesh 2020 no studies have been reported so far in india that look into the ensemble flood forecasts in a catchment with a regional outlook the primary objective of this study is to verify and quantify the skill of raw and post processed ensemble precipitation forecasts from two nwp models in the godavari river basin grb india the main motive behind this verification study is to assist the hydrological community in choosing the best suitable forecasts and post processing method to develop a reliable ensemble flood forecasting system it is also important to verify the forecasts as grb is often prone to floods that can cause devastating damage garg and mishra 2019 rakhecha and singh 2017 limited studies were documented so far verifying the skill of ensemble precipitation forecasts for grb chakraborty et al 2021 dube et al 2017 durai and bhardwaj 2014 and no studies were reported so far comparing the skill of raw and post processed forecasts in this context the following questions are explored and addressed how to compare the skillfulness of various forecasting systems how does the predictive skill of the ensemble precipitation forecasts fluctuate among and within various forecasting systems and quality attributes how does the quality of ensemble forecasts differ over varying lead times does statistical post processing of precipitation forecasts lead to enhanced forecasts for this purpose the quantitative ensemble precipitation forecasts from two nwp models i e 50 member european centre for medium range weather forecasts ecmwf 20 member national centers for environmental prediction ncep forecasts and 70 member multi model grand ensemble mme were verified the skill of raw and post processed ncep ecmwf and mme forecasts were verified against the observations as a preliminary analysis for hydrologic forecasting 2 study area and datasets 2 1 study area the godavari river basin grb is one of the largest river basins in the indian subcontinent with a catchment area of 3 13 000 km2 which is about 10 of india s geographical area cwc 2018 grb lies between 73 24 to 83 40 east longitudes and 16 19 to 22 34 north latitudes cwc and nrsc 2014 the major subbasins are manjira wardha weinganga godavari upper godavari middle godavari lower indravati and pranahita the average annual rainfall of this basin is about 1100 mm cwc 2018 however the grb receives 85 of its annual rainfall during the south west monsoon june to september kulkarni et al 2010 the location map of the grb along with its subbasins is shown in fig 1 2 2 datasets precipitation ensembles from two nwp models were obtained at a spatial resolution of 0 250 0 250 from the observing system research and predictability experiment thorpex interactive grand global ensemble tigge database over the study area the skill of ensemble precipitation forecasts of two nwp models i e ncep a 20 member ensemble and ecmwf a 50 member ensemble were verified in this study against precipitation records the above nwp models generates forecasts up to 15 day lead time at 6 hourly accumulations generated or initiated 4 times a day at 0 6 12 18 hr time steps in this study the retrospective precipitation forecasts initiated at 0th hour are considered for forecast verification at varying lead times 1 to 15 days for 24 hr accumulations in order to assess the performance of a multi model grand ensemble mme a 70 member ensemble forecasts by integrating ncep and ecmwf forecasts has also been used in this study the ncep ecmwf and mme forecasts are collected from the period between 2009 and 2020 for 1 day to 15 day lead times the selected nwp ensemble forecasts were verified against the observed daily precipitation data available from indian meteorological department imd at 0 250 0 250 spatial resolution pai et al 2014 this data set is at present the highest quality collection of observations on the indian sub continent 3 methodology 3 1 verification measures a mixed pool of verification measures that includes deterministic and probabilistic metrics is used in this study for forecast verification deterministic metrics assess the quality of the ensemble mean whereas probabilistic metrics evaluate the errors in the forecast probabilities 3 1 1 deterministic metrics the linear correlation coefficient and relative mean error rme are used in this study as the deterministic metrics to measure the match with the observed temporal dynamics and under overestimation biases respectively sharma et al 2017 siddique et al 2015 the equation of rme is given in eq 1 r m e i 1 n e i o i i 1 n o i where 1 e i 1 m k 1 m e i k where m is the number of ensemble members e i k is the forecast for k th member at time i o i denotes the corresponding observation at time i and n represents the total number of pairs of observed and forecast values 3 1 2 probabilistic metrics as per murphy and winkler 1987 the quality of ensemble forecasts is determined by analyzing the following attributes reliability sharpness resolution discrimination bias accuracy and skill probabilistic measures are generally employed to analyze the aforementioned attributes in the forecasts 3 1 2 1 mean continuous ranked probability score crps the continuous ranked probability score crps is a widely used probabilistic performance measure of ensemble forecasts wilks 2011 crps is a quadratic measure that evaluates the difference between the cumulative distribution functions cdf of probabilistic forecasts and observed values zamo and naveau 2018 crps is similar to mean absolute error mae of deterministic forecasts thereby it can be easily interpreted the equation of crps is given in eq 2 2 crps f e h f o h 2 d h where f e and f o are the forecast and observed cdfs respectively and h represents every possible threshold crps is averaged over the total pairs of forecast and observed values to verify a set of forecasts the lower the mean crps the better the forecasts are 3 1 2 2 spread skill relationship in the case of an ideal ensemble forecast the mean of the ensemble spread should be equal to the skill score e g root mean square error rmse over the same period wang et al 2013 whitaker and louche 1998 zhu and toth 2008 in order to assess this feature the relationship between ensemble spread and skill is often investigated in this study rmse is used as the skill score and standard deviation of ensemble members is used to represent the ensemble spread both rmse and standard deviation are normalized with observed standard deviation to compare the skill of forecasts with respect to a climatological value when the skill score rmse line is above and far from the spread line the ensemble is considered over confident i e under dispersive if rmse is lower than ensemble spread it indicates an under confident over dispersive forecast ideally rmse should be equal to ensemble spread for a forecast to be consistent and reliable 3 1 2 3 rank histograms equiprobability of ensemble members is an ideal quality of ensemble forecasts the ensemble members should be equally probable in principle as all perturbed initial conditions varying physics and model structures could possibly be true bellier et al 2017 hamill 2001 to check the equiprobability of ensemble members rank histograms are used they are generated by repeatedly accumulating the rank of the observed values with respect to the ensemble forecasts sorted from lowest to highest a uniform histogram is desirable representing equal likelihood of each ensemble member since rank histograms do not assess the resolution of forecasts they are used in conjunction with other evaluation measures such as crps and area under relative operating characteristic roc curve to understand more about the quality of ensemble forecasts hamill 2001 3 1 2 4 reliability diagrams reliability diagrams are frequently used graphical tools to visualize joint distribution of forecasts and dichotomous events observations to assess the reliability of probabilistic forecasts casati et al 2008 dube et al 2017 ratri et al 2019 quantitative precipitation forecasts are converted to probabilistic forecasts based on an exceedance threshold h and segregated into k bins the average probability of the forecasts corresponding to the k th bin b k is given by 3 f e k h 1 i k i k f e i h w h e r e i k i i b k the corresponding average probability of the observations is given by 4 f o k h 1 i k i k f o i h w h e r e f o i h 1 o i h 0 o t h e r w i s e the forecast probabilities f e k h of an event are plotted against the corresponding observed frequencies given forecast probability f o k h for a total number of forecasts i k in each bin b k in this study an exceedance threshold of 1 mm is chosen to plot reliability diagrams to assess the reliability of nwps in forecasting precipitation events 3 1 2 5 area under roc curve auc relative operating characteristic roc curves are graphical representation of trade off between the fraction of hits true alarm and fraction of false alarms to measure event discrimination casati et al 2008 gill and buchanan 2014 wilks 2011 for a given threshold h the hit rate and false alarm rate are given by 5 hit r a t e i 1 n i e i f e i h d o i h i 1 n i o i o i h 6 false alarm rate i 1 n i e i f e i h d o i h i 1 n i o i o i h where d is the probability threshold at which the event causes some action i e the forecast is considered an occurrence and i is the indicator function the roc curve plots false alarm rate against the hit rate using a set of decreasing forecast probability threshold decreases for possible values of d 0 1 ideally with decreasing forecast probability thresholds the hit rate should increase faster than the false alarm rate area under the roc curve auc is a scalar entity that summarizes discrimination between events and non events an auc of 0 5 indicates random forecasts while an auc value of 1 reflects perfect forecasts the value of auc of a probabilistic forecast greater than 0 7 is considered as useful whereas the auc above 0 8 is regarded as a good prediction ben bouallègue and theis 2014 mullen and buizza 2002 a threshold of 1 mm is chosen in this study to compute the auc values 3 2 statistical post processing methods two statistical post processing techniques were used in this study to post process the raw ensemble forecasts obtained from ncep and ecmwf the forecast data from the period 2009 to 2015 is used as the training dataset for post processing models the fitted models are used to post process the raw daily forecasts from the period 2016 to 2020 it should be noted that the forecast verification is performed from the period 2016 to 2020 a brief description about the selected post processing methods is given in the succeeding sections 3 2 1 quantile mapping the ensemble precipitation forecasts obtained from the nwp models comprise of inherent biases due to the chaotic nature of atmospheric circulation and their regulating dynamic feedbacks christensen et al 2001 these biases should be corrected in order to improve the quality of the forecasts quantile mapping also known as histogram equalization is a simple and most widely used bias correction method acharya et al 2013 in this method the distribution function of modelled variable is transformed such that it matches the distribution of observed variable based on the assumption that the internal errors in the nwp models and scale relationship are time invariant the correction factor obtained during calibration period is valid for future period gudmundsson et al 2012 reported that nonparametric quantile mapping has the best performance among different bias correction methods the bias correction has been performed on each ensemble member of the raw ensemble forecasts at each grid point using eq 7 by considering 2009 2015 as the calibration period then the obtained correction factor from the calibration period is used for correcting the bias during validation period 7 p o f o 1 f m p m where p o and p m are observed and forecasted precipitation f m represents the cumulative distribution function cdf of p m and f o 1 is the inverse cdf corresponds to p o for performing non parametric quantile mapping qmap package in r has been used that can be downloaded from https cran r project org web packages qmap index html 3 2 2 quantile regression forests quantile regression forests qrf is a nonparametric postprocessing method developed by meinshausen 2006 qrf provides a nonparametric way to evaluate conditional quantiles for high dimensional predictors of variables this technique has been used for meteorological data such as precipitation by bhuiyan et al 2018 and taillardat et al 2016 given a set of predictors quantile regression technique helps to estimate the conditional median and any quantile values of the response variable whereas the classical regression techniques are helpful in estimating the conditional mean of a response variable the conditional distribution function f y x x is expressed as given in eq 8 8 f y x x p y y x x e 1 y y x x where x y represents the covariate and the observations of the response variable respectively and e represents the conditional mean e 1 y y x x in qrf random forests are generated from binary regression trees called classification and regression trees cart that provide robust estimates of conditional quantiles after building the random forests a new vector of predictors and its associated leaf in each tree will be determined using binary splitting this iterative binary splitting on predictors aggregates the observations according to their forecasts therefore for every precipitation event an ensemble of observations is restored to create an empirical cumulative distribution function cdf the weighted average of the cdfs from all the trees is the final forecast which can be used to obtain the predictive quantiles the weighted mean over the observation of 1 y y 1 y y is a step function with a value of 1 when y y and with a value of 0 when y y is used to estimate the conditional mean in eq 9 then the conditional distribution function in eq 9 can be defined as 9 f y x x i 1 n w i x 1 y y 10 w i x k 1 t 1 k w i x θ t where w i x is the weight vector estimating using random forest regression k represents the number of trees and θ is an independent and identically distributed random parameter vector that determines the growth of the tree e g variables that determine the split points at each node the major advantage of qrf is that it not only retains the mean but also keeps all the observation values in the nodes to calculate the conditional distribution the final cdf obtained from weighted average cdf of all trees is bounded between the lowest and highest value of the learning sample and can forecast only the quantiles within these limits the algorithm for computing the estimate of the conditional distribution function f y x x can be summarized as step 1 grow k trees as in random forests the corresponding tree is denoted by t θ t t 1 k all the observations should be retained for every leaf of every tree step 2 for a given x x drop down all trees compute weight w i x for every observation i 1 n as an average over w i x θ t t 1 k as in eq 10 step 3 compute the estimate of the conditional distribution function as in eq 9 for all y r using the weights from step 2 for a quantile of order α the probability of the random variable to be less than y is α i e cdf value for y thus the quantiles are estimated by eq 11 11 q α p y y x x α instead of using the raw ensemble forecasts this method can potentially use other predictors and has the advantage of maintaining non linearity for instance bhuiyan et al 2018 used global reanalysis precipitation and air temperature datasets along with satellite near surface soil moisture and elevation datasets as predictors to post process multiple global precipitation datasets however qrf needs a large training dataset which is a major drawback in this study all the ensemble members 20 members for ncep forecasts and 50 members for ecmwf forecasts were used as predictors for post processing the tree size is set to 1000 with maximum size of terminal nodes as 20 in this study the post processing of raw forecasts using quantile regression forests was performed using quantregforest package in r meinshausen 2017 4 results and discussion the mean areal precipitation of ensemble forecasts both raw and post processed ncep and ecmwf and observed precipitation from imd over each sub basin of godavari river basin is computed the skill of basin averaged forecasts was verified against basin averaged imd precipitation records using a pool of deterministic and probabilistic evaluation measures 4 1 rank histograms rank histograms measures the frequency of observation to fall between each pair in an ordered set of ensemble values the under dispersiveness in the ensemble forecasts leads to higher frequencies of the extreme ranks asymmetric histograms represent the bias in the forecasts and the histograms should be uniform for ideal forecasts the rank histograms of the ncep and ecmwf forecasts at 1 day lead time are plotted in fig 2 for brevity of plots the rank histograms of mme forecasts were not plotted in this section it can be noticed that both ncep and ecmwf raw forecasts overpopulate the bins on the very left at all subbasins indicating biased and under dispersive forecasts however it should be noted that ecmwf forecasts are highly biased in comparison to ncep forecasts the higher frequencies in the very left side of the histograms of raw ncep and ecmwf forecasts are decreasing with increasing lead time and the frequencies on the very right side of the histograms were found to be increasing with increasing in lead time leading to u shaped distribution refer to figs s1 and s2 this shows that the raw forecasts are becoming more under dispersive with respect to lead time statistical post processing has alleviated the problem of bias in the raw forecasts to some extent the rank histograms of qrf post processed forecasts were found to be comparatively uniform than qm post processed forecasts the u shaped distribution of qm post processed forecasts denote that the forecasts are still under dispersive it should be noted that the rank histograms of ncep qrf forecasts are slightly biased at lower godavari and indravati whereas ecmwf qrf are biased at lower godavari upper godavari indravati and pranahita subbasins 4 2 boxplots of forecast error in this section the performance evaluation measures described in the preceding section were used to assess the skill of raw and post processed ensemble precipitation forecasts the forecast error boxplots of basin averaged 24 hourly accumulations of raw and post processed qm and qrf forecasts of ncep and ecmwf are plotted against increasing amount of observed precipitation in figs 3 and 4 respectively for 1 day short lead time for brevity of plots forecast boxplots of mme were excluded in this subsection similarly the forecast error boxplots for higher lead times 5 day and 15 day lead times were also provided in figs s3 to s6 it can be observed from figs 3 and 4 that both ncep and ecmwf forecasts raw and post processed constantly underestimates the extreme precipitation events in all subbasins whereas light to moderate precipitation events below 20 mm and above 1 mm day are slightly overestimated however qrf post processed forecasts is slightly better when compared to that of raw forecasts at all lead times for light to moderate precipitation events in agreement with the results of previous studies siddique et al 2015 the raw forecasts from nwps tend to underestimate extreme precipitation events as a result of conditional biases i e the forecast error is correlated to the observed precipitation the forecast boxplots at higher lead times figs s3 to s6 show that the inter quartile range iqr of boxplot of forecast errors is decreasing from 1 to 15 day lead times and is approximately equal to that of the magnitude of observed precipitation indicating the inability of nwps to forecast extreme events at higher lead times this shows that the ensemble spread is smaller at longer lead times indicating an over confident forecast this is plausibly due to nudging of nwps towards climatological values wilks 2006 this analysis suggests that further research is necessary with a target to improve the ability of nwps in simulating extreme precipitation events the ecmwf forecast errors raw and post processed in lower godavari indravati manjira and weinganga are higher at larger precipitation events when compared to other subbasins at all lead times the error associated with ncep forecasts raw and post processed also follows similar pattern as that of ecmwf to summarize both qm and qrf methods are effective at removing the inherent biases in raw forecasts however they differ in their abilities to correct forecast spread and provide reliable forecasts it is evident that the forecast error boxplots of qm postprocessed ncep forecasts are overly narrow at higher precipitation amounts indicating smaller ensemble spread 4 3 performance evaluation of ensemble mean the ability of ensemble mean to capture the temporal dynamics of observed precipitation events is assessed by computing correlation coefficient fig 5 shows the correlation coefficient between ensemble mean of forecasted precipitation and observed precipitation for lead times varying from 1 to 15 days it can be noticed that the correlation coefficient is high at lead time of 1 day and tends to decrease with increase in lead time denoting that forecasts are unable to capture the observed events at higher lead times despite the fact that the correlation tends to decrease with forecast lead time an increase in the correlation can be observed in ncep forecasts raw and post processed can be observed after a lead time of 6 days in middle godavari upper godavari indravati wardha and weinganga subbasins similar correlation patterns were observed in the study of sharma et al 2017 where the correlation is found to be increasing at higher lead times as the basin size increases furthermore the basin averaging of precipitation plausibly alleviates the spatial forecast errors leading to improved correlation the correlation of raw mme forecasts is found to be higher than that of raw forecasts from individual nwp models and is found to be as skillful as the post processed forecasts it is worth mentioning that the qrf post processed forecasts were found to be better than that of their corresponding raw forecasts in terms of correlation coefficient in all the subbasins however qrf post processed ncep and mme forecasts are outperforming the remaining forecasts in all the subbasins the mean of qm post processed forecasts were found to be less correlated with the observed precipitation when compared with their corresponding raw forecasts qm method can produce both positively for ecmwf and mme and negatively for ncep skillful forecasts on the grounds that it neglects the association between the observations and raw forecasts the skill of ncep forecasts is found to be good in indravati and weinganga subbasins with a correlation greater than 0 4 event at a higher lead times 7 days similarly the correlation of ensemble mean except qrf post processed forecasts and observed values is low at lower godavari manjira and pranahita at higher lead times to understand the under over estimation bias of the forecasts rme between mean of the ensemble forecasts and observed precipitation is computed for varying lead times ranging from 1 day to 15 days fig 6 it can be observed that the raw forecasts are being overestimated in upper godavari and wardha subbasins at almost all lead times due to the inherent biases with increasing lead times the post processed ecmwf forecasts were underestimated in all subbasins the ncep qrf forecasts were found to be less biased in all subbasins except middle godavari and wardha subbasins the performance of raw and post processed mme forecasts were found to be satisfactory in terms of rme at all the sub basins indicating the mulit model ensembling alleviates the biases the skill of post processed ecmwf forecasts is found to be superior in terms of rme in wardha subbasin the verification results in terms of correlation coefficient and rme were found to be in line with the findings of siddique et al 2015 and sharma et al 2017 4 4 spread skill relationship the spread skill relationship of the ncep ecmwf and mme forecasts are evaluated and plotted in fig 7 for lead times ranging from 1 to 15 days the skill score rmse in this study should be equal to the mean of ensemble spread for consistent and reliable ensemble forecast rmse values higher than the spread indicates under dispersive over confident forecasts and vice versa from fig 7 it can be noticed that ncep ecmwf and mme forecasts raw and post processed are under dispersive at all subbasins at all lead times the ensemble spread of raw forecasts is low at smaller lead times and is increasing with increasing lead time the ensemble spread of post processed forecasts is higher than that of raw forecasts at smaller lead times alleviating the under dispersion of raw forecasts however the spread of both raw and post processed forecasts converges at lead times from 11 to 15 days it should be noted that the rmse at upper godavari pranahita and wardha subbasins are considerably greater 1 than that of rmse at remaining subbasins it can also be observed that rmse of qm post processed forecasts are high indicating poor skill in comparison to qrf post processed forecasts a good linear relation is observed between rmse and spread of qrf post processed forecasts in comparison to other forecasts it shows the ability of qrf post processed forecasts in preserving the spread skill relationship 4 5 continuous ranked probability score crps crps generalizes the mean absolute error mae to case of probabilistic forecasts lesser the mean crps value the more accurate the forecasts are the mean crps value of ensemble forecasts for various lead times ranging from 1 day to 15 days is plotted in fig 8 the general tendency of the mean crps to increase with resepect to lead time the mean crps value of the raw and qm post processed forecasts is high at shorter lead times 1 to 3 days at most of the subbasins however the mean crps values are low in all subbasins except lower godavari indravati and weinganga the higher values of mean crps and correlation coefficient in indravati and weinganga subbasins indicates that the ensemble spread is comparatively higher in comparison to the ensemble spread in other basins however the good correlation between ensemble mean and observations shows the skill of ensemble spread in capturing the observed events this problem of high low ensemble spread leading to under over confident forecasts can be alleviated by employing post processing methods raftery et al 2005 it can be noticed from the figure that the performance efficiency in terms of crps has increased with the application of qrf to ncep ecmwf and mme forecasts in all subbasins however the mme forecasts are comparatively better than the forecasts from individual nwps in all subbasins the qrf post processed mme and ncep forecasts were found to be more skillful in all sub basins at all lead times 4 6 reliability diagrams with the intent to evaluate the reliability of ncep and ecmwf forecasts reliability diagrams are plotted for 1 day fig 9 5 day fig s7 and 15 day fig s8 lead times in an ideal case the curve of observed frequency for given forecast probabilities should be close to the diagonal the log transformed curves in the inset of reliability plot indicates the sharpness of the forecast i e how frequently each probability was issued from fig 9 it can be noticed that the raw ncep ecmwf and mme forecast are under dispersive over confident for forecast probabilities greater than 0 4 over all subbasins at 1 day lead time however it can be clearly observed that the reliability has increased in the post processed forecasts at 1 day lead time it is also important to notice that qm post processed forecasts are slightly more reliable closer to the diagonal line in comparison to qrf post processed forecasts however the qm post processed forecasts were found to be under confident for forecast probabilities less than 0 8 for middle godavari indravati manjira wardha and weinganga the qrf post processed forecasts are slightly over confident for forecast probabilities less than 0 8 in most of the subbasins and are more reliable than qm post processed forecasts for higher forecast probabilities 0 8 no significant difference has been observed between the performance of ncep ecmwf and mme forecasts post processed with qrf method however it can be noticed form figs s7 and s8 that the reliability of both raw and post processed forecasts declines with increasing lead times 4 7 area under roc curve auc area under the roc curve auc is a scalar measure that quantifies the discrimination ability of forecasts between occurrences and non occurrences the ability of event discrimination of ncep ecmwf and mme forecasts in term of area under roc curve auc is plotted for different lead times across all subbasins in fig 10 from the figure it can be observed that auc at all subbasins at all lead times is greater than 0 75 indicating that the forecasts are useful as mentioned in the methodology section it can also be observed that the value of auc is decreasing with increasing lead time at all subbasins this indicates that the discrimination ability of forecasts declines with lead time suggesting an increased false alarm rate the auc values of raw ncep forecasts at 3 days to 5 days lead time are deteriorating at middle godavari manjira and wardha subbasins which is efficiently alleviated by post processing the overall performance of post processed forecasts is better than raw forecasts highlighting the potential of post processing qrf post processed ncep and mme forecasts are outperforming other forecasts at all subbasins for all lead times it should also be noticed that the auc values at manjira and pranahita are lower in comparison to other subbasins 5 summary and conclusions in this article the skill of ensemble precipitation forecasts from european centre for medium range weather forecasts ecmwf national centers for environmental prediction ncep from the observing system research and predictability experiment thorpex interactive grand global ensemble tigge database is evaluated over the eight subbasins of godavari river basin india these two forecasting systems are preferred as they are operational have multiyear datasets and or capture scenarios that forecasters are interested in sharma et al 2017 along with them the skill of the multi model grand ensemble mme generated by integrating ncep and ecmwf forecasts is also verified in this study two statistical post processing methods are employed in order to emphasize the ability of post processing methods to alleviate the conditional biases in the raw forecasts the verification was conducted for daily accumulations for different lead times 1 to 15 days in hindcast mode the deterministic and probabilistic measures forecast error box plots correlation coefficient rme mean crps spread skill relationship rank histograms reliability diagram auc are employed to verify the skill of basin averaged raw and post processed forecasts in comparison to the observed data during the period from 2016 to 2020 the key findings of this verification study are mentioned below the skill of both ncep and ecmwf raw forecasts in capturing the observed extreme precipitation events is poor across all lead times and statistical post processing also could not alleviate this problem this highlights the need to develop the underlying physics of nwps to accurately forecast extreme precipitation events the correlation between ensemble mean and observed precipitation declines with increasing lead time whereas rme does not depend upon lead time the ensemble mean of qrf post processed ncep and mme forecasts are outperforming other forecasts in all subbasins in terms of correlation coefficient and rme at all lead times the ensemble spread error relationship in the post processed forecasts is improved in comparison to raw forecasts it is also found that qrf outperforms qm in preserving the ensemble spread error relation the rank histograms suggest that both ncep and ecmwf raw forecasts are under dispersive and biased at all subbasins however post processing of raw forecasts has alleviated the problem of bias based on the analysis of reliability diagrams the raw ncep and ecmwf forecasts tend to be overconfident whereas the post processed forecasts are performing well at 1 day lead time however the reliability declines with increasing lead times due to overconfident forecasts the auc values are found to be greater than 0 75 at all lead times and all subbasins showing that the forecasts are useful the discrimination ability of forecasts in terms of auc is found to be decreasing with lead time indicating a higher false alarm rate the results of the analysis suggest that the performance of raw mme is comparatively better than raw ncep and ecmwf forecasts in terms of the employed verification measures however the qrf post processed ncep and mme are performing equally well hence keeping in mind of the computational cost 20 member qrf post processed ncep forecasts are suggested for hydrologic forecasting applications over the present study area the overall performance of ncep and mme forecasts is found to be better than ecmwf forecasts the performance of qrf post processed forecasts is found to be outperforming qm post processed and raw forecasts the underperformance of qm is due to the fact that it does not account for the under over spread in the raw forecasts and it does not consider the correlation between raw forecasts and observations leading to unreliable forecasts the performance of post processed forecasts in lower godavari middle godavari indravati manjira and weinganga is found to be satisfactory in terms of both deterministic and probabilistic measures the performance of qrf post processed ncep and mme forecasts was found to be satisfactory at most of the subbasins for all verification measures even though the aforementioned verification results provide diagnostic information about the skill of ensemble precipitation forecasts they do not provide any information on how to improve the nwp models more weather factors than only precipitation are needed to properly understand the physical and environmental factors linked to forecast errors and skill moore et al 2015 in future we plan to explore and evaluate various forecasting scenarios to assess the benefits of integrating the outputs from different precipitation forecasting systems different hydrologic model structures and hydrological post processing techniques to potentially improve flood forecasting across spatiotemporal scales credit authorship contribution statement velpuri manikanta conceptualization methodology writing original draft k nikhil teja visualization investigation writing review editing jew das visualization writing review editing n v umamahesh visualization investigation supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work has been funded by the indian institute of tropical meteorology under monsoon mission phase ii project no iitm mm ii nit 2018 ind 6 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128794 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2591,rainfall runoff modeling is a complex nonlinear spatiotemporal prediction problem however few studies have considered the spatial characteristics of rainfall runoff relationship in runoff forecasts based on machine learning with the emergence of high resolution satellite based precipitation products spps and the continuous improvement of rainfall estimation accuracy the shortcoming of sparse spatial information for in situ rainfall monitoring has been made up therefore this study developed a large scale spatiotemporal deep learning rainfall runoff sdlrr forecasting model for hydrological stations in the upper yangtze river and evaluated the positive impact of utilizing spatial information of three spps on reducing errors of runoff forecasts the adopted remote sensing precipitation products are bias corrected climate hazards group infrared precipitation with station data chirps integrated multi satellite retrievals for global precipitation measurement data imerg and tropical rainfall measuring mission multi satellite precipitation analysis data tmpa for runoff forecasting at the luoduxi ldx hydrological station compared to regular long short term memory network lstm model the proposed sdlrr model that utilizing imerg data as precipitation input imerg sdlrr improved 15 in terms of coefficient of determination r2 and improved 25 in terms of root mean squared error rmse compared to the best performance model among models using area averaged precipitation as input imerg sdlrr improved 5 in terms of r2 and 11 in terms of rmse good performance was also acquired in the other hydrological stations for extreme flood forecasts imerg sdlrr decreased mean relative error mre by 0 29 and increased qualified rate qr by 53 compared to lstm and decreased mre by 0 08 and increased qr by 6 compared to the best performance model using area averaged precipitation as input the utilization of imerg or tmpa spatial information improved the accuracy of runoff forecasting the accuracy evaluation of spps based on the results of spatiotemporal rainfall runoff forecasts method was also demonstrated the research is of great significance for developing runoff forecasting methods and optimizing water resources management keywords runoff forecasts satellite precipitation products deep learning spatiotemporal characteristics accuracy assessment the yangtze river data availability data will be made available on request 1 introduction flood is one of the natural disasters that have a great impact on the world with complex characteristics such as rapid occurrence strong randomness high frequency and uneven spatial distribution therefore improving the forecast accuracy of runoff or flood forecasting models has always been a challenge in hydrological researches speight et al 2021 in the rainfall induced runoff forecasting work the key content is to simulate the future runoff process by using the runoff forecasting model and rainfall information however the lack of historically measured rainfall data and real time rainfall information in data deficient areas puts the work of runoff forecasting in a difficult situation dou et al 2021 with the development of remote sensing technology satellite based precipitation products spps have gradually become an effective supplement and substitute for the measured data typical spps include tropical rainfall measuring mission trmm multi satellite precipitation analysis tmpa precipitation estimation from remotely sensed information using artificial neural networks persiann global satellite mapping precipitation gsmap and the integrated multi satellite retrievals for global precipitation measurement imerg nguyen et al 2018 kubota et al 2020 yin et al 2021 at present the accuracy assessment of important satellite remote sensing products is carried out in australia the united states europe india and other research areas speight et al 2021 compared the matching degree of several products persiann tmpa imerg and gsmap and optimally combined spps with rain gauge precipitation for accurate rainfall estimation the adequate and proper use of satellite remote sensing data is of great significance for improving regional runoff forecasts nowadays spps are widely applied to large and medium scale regional flood forecasting and the hydrological model method is also an important way to evaluate the accuracy of the spps tong et al 2014 evaluated trmm 3b42 noaa climate prediction center morphing technique cmorph tmpa 3b42rt persiann against gauge observations over the tibetan plateau in streamflow simulations using the variable infiltration capacity macroscale hydrologic model vic and found that the trmm 3b42 and cmorph performed better than the tmpa 3b42rt and persiann at both plateau and basin scales llauca et al 2021 investigated the applicability of imerg gsmap cmorph in near real time for the simulation of sub daily runoff in the vilcanota river basin and these spps were used as meteorological inputs for the hourly hydrological modeling using the génie rural à 4 paramétres horaires gr4h hydrology model the bias corrected climate hazards group infrared precipitation with station data chirps were utilized as the inputs to simulate discharge and peak value and the result indicated a good performance of the proposed bias correction approach in reducing the chirps satellite estimations errors mokhtari et al 2022 zhu et al 2021 assessed the suitability of imerg early imerg late imerg final and tmpa in flood simulation over a humid region of china by using hydrologiska byrans vattenbalansavdeling hbv hydrology model and the statistical assessment showed imerg final outperformed the other spps spps have been widely combined with lumped or distributed hydrological models to carry out spps assessment and hydrological modelling the application effect of the model used in current studies mainly depends on the hydrological law of the basin the quality of the input data and the model s yield and confluence mechanism girons lopez et al 2021 in the past decades data driven hydrological models have received great attention because of their strong fitting ability and flexible input data early data driven techniques are linear regression lr autoregressive moving average arma and their variations valipour 2015 afterwards artificial neural network ann adaptive neuro fuzzy inference system anfis gaussian process regression gpr genetic programming gp support vector machine svm extreme learning machine elm have been successfully developed for daily and seasonal runoff forecasting mekanik et al 2016 xing et al 2016 with the development of deep learning technology in dealing with the temporal dependence of hydrological series researchers creatively introduced various kinds of deep learning for runoff forecasting and obtained promising performances zhang et al 2018 he et al 2019 bai et al 2021 liu et al 2019 extended a deep learning method into the bayesian framework and got the uncertainty evaluation of runoff forecasting long short term memory network lstm is an improved recurrent neural network that can solve the problem of long distance dependencies that rnns cannot handle due to the vanishing and exploding gradients it is currently one of the more popular time series forecasting models bai et al 2021 zhu et al 2020 combined lstm network and gaussian process regression gpr to develop a reliable daily runoff forecasting model chu et al 2020 demonstrated that deep learning performed better than the traditional ann runoff forecasting models kao et al 2020 explored multi step runoff forecasting using deep learning network and encoder decoder framework han and morrison 2021 developed deep learning approaches for runoff prediction using distributed meteorological data however in the traditional data driven model for runoff forecasting hydrological data is processed into a one dimensional time series resulting in the loss of spatial information therefore it is significant to establish a data driven model capable of considering the spatial heterogeneity of meteorological and hydrological processes chen et al 2016 nijzink et al 2016 elsaadani et al 2021 li et al 2021 convolutional neural network cnn algorithm is well suited for capturing and learning spatial patterns a mixture model called convolutional long short term memory convlstm is designed to solve the spatiotemporal prediction problem which has the advantage of spatial feature extraction and temporal sequence dependent learning it was firstly used for video prediction shi et al 2015 and then introduced into precipitation broadcasting having achieved great success sadeghi et al 2019 recently ha et al 2021 developed a convlstm model to predict the monthly streamflow of the yangtze river in three flood years however the input data of the convlstm in their study are one dimensional enso and the monthly streamflow both of which lack spatial features worth learning furthermore the convlstm was developed and applied in predicting satellite soil moisture elsaadani et al 2021 li et al 2021 moishin et al 2021 built a convlstm flood forecasting model to forecast the future occurrence of flood events these studies demonstrated excellent predictive performance of convlstm in forecasting meteorological and hydrological maps nevertheless the adopted model structures are similar to the previous video prediction and precipitation broadcasting collectively known as the image prediction problem for rainfall runoff forecasts both one dimensional time series and 3d spatial hydrological data are involved in model input and output and some improvements are expected to be made in the model architecture to solve this problem schmidt et al 2020 trained convlstm models on daily temperature and precipitation maps of the catchment area to predict the streamflow of the elbe river thus gaining spatial insight into the hydrological system chen et al 2022 divided the study area into grids developed convlstm model to extract spatiotemporal features of hydrological information and achieved excellent flood prediction however their study areas of interest were focused on small counties where spatial characteristics of rainfall and runoff are still relatively uniform and the model structures are relatively small in scale what s more the spps described above which are important providers of large scale rainfall spatial distribution and magnitude information are not utilized and discussed it is a great loss to build spatiotemporal rainfall runoff prediction without utilization of spps besides it would be beneficial to further assess the accuracy of spps estimates using spatiotemporal deep learning model capturing and learning spatial patterns in rainfall runoff modeling is very meaningful for improving the runoff forecasting accuracy based on the above discussion it is found that the existing researches have not yet accurately involved the large scale spatiotemporal rainfall runoff forecasting based on the architecture of deep learning in addition the spps that providing large scale rainfall spatial information were not utilized and discussed in these researches the lack of spps specific spatial information is a major loss therefore for the complex nonlinear runoff forecasting problem there is still room for improvement different with traditional hydrological model like hbv vic etc and regular machine learning model like ann svm lstm etc this study will develop a large scale spatiotemporal deep learning rainfall runoff sdlrr forecasting model in the upper yangtze river uyr and evaluated the positive impact of utilizing the spatial information of three satellite based precipitation products spps on reducing errors of runoff forecasts which is rarely studied and discussed in runoff forecasting based on deep learning the advantages of adopting spatiotemporal deep learning rainfall runoff forecasting model lie in capturing and learning spatial patterns in rainfall runoff modeling for improving the runoff forecasting accuracy rainfall data comes from three remote sensing precipitation products chirps imerg and tmpa with spatial resolutions of 0 1 0 05 and 0 25 respectively chirps imerg and tmpa have satisfactory rainfall estimation accuracy in the yangtze river basin and using spps with different resolutions helps to study the effects of resolution on the runoff forecasts the advantages of sdlrr are demonstrated with controlled experiments runoff forecast performance enables incidental assessment of the accuracy of remote sensing rainfall estimates the main contributions of this paper are as follows a spatiotemporal sdlrr model is developed for large basins and sub basins of uyr spatial features of three regional spps are extracted and used based on stacked convlstm topological and geomorphic features are added to distinguish different catchment specific rainfall runoff behaviors sdlrr improves the accuracy of runoff forecasting compared with benchmark models spps can be incidentally assessed based on the model performance of runoff forecasting the rest of this paper is organized as follows section 2 describes the study area and data collection section 3 illustrates the approaches for spatiotemporal rainfall runoff forecasting and the experimental results are presented in section 4 discussion and conclusion are given in section 5 and section 6 respectively 2 study area and data descriptions 2 1 study area the yangtze river is the third largest river in the world and the largest in china it originates from the main peak of the tanggula mountain on the qinghai tibet plateau the main stream is more than 6 300 km long and the drainage area is about 1 8 million km2 accounting for about 18 8 of china s land area the yangtze river with its huge river lake system unique and complete natural ecosystem and powerful functions of water conservation biological reproduction oxygen release and carbon fixation and environmental purification ensures the national water supply security food security and energy security the length of the upper reaches of the main stream of the yangtze river accounts for 70 4 of the total length of the yangtze river the locations of the upper reaches of the yangtze river main tributaries and the gauging stations are shown in fig 1 the river section above pingshan county is called the jinsha river with a length of 3464 km and a drop of about 5100 m and the main tributary added is the yalong river the length of the river between pingshan county and yichang city is 1040 km the main tributaries added are the minjiang river and the jialing river on the north bank and the wujiang river on the south bank the jialing river is the largest river in the tributaries of the yangtze river the jialing river originates from the southern foot of the western section of the qinling mountains and flows into the yangtze river in chongqing city the basin area is 160 000 km2 the main stream is 1120 km long the average annual flow is 2120 m3 s and the total drop is 2300 m continuous heavy rainfall is the main factor for flooding in jialing river according to the analysis of more than 50 flood peaks at the outlet of the upper reach of yangtze river uyr 43 of flood volume comes from the jialing river and heavy rainfall in the jialing river is the main source of floods the utilization of spatial precipitation information plays a more important role in improving runoff forecasting in the jialing river the watershed shape is squarer which is adequate for spatiotemporal information extraction furthermore the historical runoff data of the jialing river is recorded completely and there is also no continuous data missing problem in sub watersheds considering these factors this study chooses the jialing river as the study area the beibei bb hydrological station is located in the downstream outlet of the jialing river the entire jialing river basin jrb can be divided into three sub basins namely the main stream basin the qu river basin and the fu river basin wusheng ws luoduxi ldx and xiaoheba xhb are the outlet hydrological stations of the three sub basins therefore bb ws ldx and xhb hydrological stations are adequately choices for the study of spatiotemporal deep learning rainfall runoff forecasting in the jrb 2 2 runoff data daily rainfall runoff forecasting is implemented for bb ws ldx and xhb hydrological stations the quality checked daily runoff series observed at bb ws ldx and xhb hydrological stations come from china s yangtze river waterway bureau http www cjw gov cn the time span is from 2001 1 1 to 2015 12 31 the runoff series and the descriptive statistics are shown in fig 2 it can be seen that the runoff series of bb ws ldx and xhb hydrological stations show seasonal fluctuations and the randomness and nonlinearity of runoff are prominent the runoff data of beibei has a particularly large mean and standard deviation sd with values of mean 1905 m3 s and sd 3072 m3 s the length in the descriptive statistics means the number of runoff observations beibei hydrological station has a complete runoff observation with a length of 5478 in the 15 years ws ldx and xhb hydrological stations missed a small set of records in the early years and the days of missing data existing were excluded and not used for model training and runoff forecasting 2 3 bias corrected climate hazards group infrared precipitation with station data chirps was created in collaboration with scientists at the usgs earth resources observation and science eros center to provide complete reliable up to date datasets for many early warning goals funk et al 2015 it is a 35 year quasi global rainfall data set which spans the area 50 s 50 n and all longitudes and encompasses the data from 1981 to near present and chirps incorporates in house climatology chpclim 0 05 resolution satellite imagery and in situ station data to create gridded rainfall time series for trend analysis and seasonal drought monitoring it has a high spatial resolution of 0 05 and temporal resolutions of daily monthly and seasonal scales the data version used in this study is v2 0 which can be obtained from https www chc ucsb edu data chirps 2 4 integrated multi satellite retrievals for global precipitation measurement data global precipitation program gpm inherits the successful experience and achievements of trmm and improves the precipitation retrieval algorithm imerg is the latest generation of multi satellite fusion inversion of precipitation data specially created for gpm and the latest version is version 6 with a temporal resolution of 30 min a spatial resolution of 0 1 0 1 and a coverage of 60 n 60 s later extended to 90 n 90 s it makes full use of the data provided by all satellite sensors on the gpm platform and also fully draws on various satellite precipitation inversion algorithms that were basically mature in the previous trmm era for fusion imerg currently provides three types of satellite precipitation data namely early late and final versions in the processing of version final more sensor data sources were introduced including the introduction of global rainfall stations for correction and it has broad application prospects in the fields of hydrological simulation and environmental management huang et al 2018 imerg final daily precipitation dataset is adopted in this study 2 5 tropical rainfall measuring mission multi satellite precipitation analysis data tmpa is a quasi global 60 s 60 n precipitation dataset it is one of the best multi satellite precipitation products in trmm huffman et al 2007 and it is a new dataset that continues the trend toward routine computation and distribution of finer scale precipitation estimates its spatial resolution is 0 25 and temporal resolution is three hours the tmpa is designed to combine precipitation estimates from various satellite systems as well as land surface precipitation gauge analyses when possible this study uses the latest version of tmpa v7 which can be obtained from https pmm nasa gov data access studies have shown that the error adjusted data of tmpa 3b42v7 perform well in rainfall estimation and hydrological forecasting 3 methodology 3 1 problem description the object of this study is to develop a generic sdlrr forecasting model for multiple basins which is capable of exacting spatial features of regional spps and improving the accuracy of runoff forecasting suppose xt is the regional spp estimate at the time of t let yt 1 represent outlet runoff at the time of t 1 ai represent the i th catchment attribute which is related to different catchment specific rainfall runoff behaviors the rainfall runoff forecasting problem in this paper is to learn the complicated behaviors from 3d rainfall series to 2d runoff series the above problem can be described as 1 y t 1 f s d l r r x t x t 1 x t l 1 1 y t y t 1 y t l 2 1 a 1 a 2 a i θ where xt is an m n matrix m is the number of horizontal grids of the adopted regional spp and n is the number of vertical grids l 1 is the number of rainfall type predictors l 2 is the number of runoff type predictors it means that the daily rainfall of l 1 days before the forecast day and daily runoff of l 2 days before the forecast day are included as the predictors f s d l r r is the spatiotemporal rainfall runoff forecasting model developed based on training samples x y a θ is the model parameter and y t 1 is the runoff to be predicted 3 2 model architecture the input and output of convlstm video prediction are data matrix in order to process and learn high dimensional spatial features the data types of rainfall runoff forecasts include grid type rainfall data as well as one dimensional runoff data combining convlstm with additional units is needed to fit the new problem the architecture of the proposed spatiotemporal rainfall runoff forecasting is illustrated in fig 3 spp in previous l 1 days are main input and runoff series in previous l 2 days are auxiliary input the developed model outputs one step ahead runoff forecasts written as yt 1 convlstm is used to extract the time dependence as well as the spatial features from the adjacent meteorological grids batch normalization forces the distribution of input values of each layer back to a standard normal distribution with a mean of 0 and a variance of 1 through a certain normalization method which can avoid the problem of gradient disappearance and improve the training speed dropout is to randomly drop some hidden or visible units in a neural network and these units are not allowed to participate in forward reasoning and backward propagation due to the random dropout the training independence is higher which can effectively avoid model overfitting after a convolution operation the output data are flattened that is 3d data are compressed into a one dimensional array and then connected to the full connection layer topological and geomorphic catchment attributes mean elevation catchment area vegetation covered area are included as predictors here since they help to improve model performance and distinguish different basin catchment specific rainfall runoff behaviors kratzert et al 2019 we used static catchment attributes that aggregated from gridded data products as the study area is located in a mountainous region with high altitude and relatively backward economic development the static catchment attributes were also used in the existing studies kratzert et al 2019 lstm model has shown great promise in dealing with runoff time series prediction problems xiang et al 2020 and is used in the auxiliary modelling module then lstm modelling data are concatenated with the output of the transferred compressed and flattened spp to form the new one dimensional data after that traditional lstm layer and fully connected layer are used to further learn the temporal dependence in the new one dimensional data to make final forecasts details are given below 3 3 model units 3 3 1 long short term memory lstm is an improved recurrent neuro network rnn which has received great attention in dealing with sequential data hochreiter schmidhuber 1997 different from standard recurrent neuro network special gate structures in the memory block of lstm enable it to extract dependency relationship of time series and significantly avoid the vanishing gradients problem an lstm cell has a forget gate input gate and output gate to decide whether the information will be output or stored the gate mechanism of an lstm can be written as 2 f t w f h t 1 x t b f i t w i h t 1 x t b i c t tanh w c h t 1 x t b c c t f t c t 1 i t c t o t w o h t 1 x t b o h t o t tanh c t where σ is the sigmoid function w f w i w c w o are weights b f b i b c b o are bias vectors f t i t o t are the outputs of forget gate input gate and output gate x t and c t are the input and cell state h t is hidden state and are the matrix vector multiplication and hadamard product respectively 3 3 2 convolutional long short term memory this paper utilizes convlstm to make full use of spatial features of rainfall for runoff time series forecasts convlstm was first proposed by shi et al 2015 to solve the problem of precipitation forecasting and widely used in recent studies elsaadani et al 2021 li et al 2021 chen et al 2022 the problem of precipitation forecasting is usually regarded as a time series problem so it is usually considered using lstm to solve it but pure lstm cannot use the spatial data features so the spatial distribution features of rainfall are not fully utilized in the lstm method the convlstm structure can not only establish a time series relationship similar to lstm but also have a spatial feature extraction capability similar to cnn which has a better effect than lstm in obtaining the spatiotemporal relationship therefore the model architecture proposed in this paper uses convlstm as one of the basic units to solve the rainfall runoff prediction problem different from lstm convolutional structure is introduced to replace the fully connected operators in the transition of input to state and state to state thus the input data is high dimensional and suitable for spatial sequence data convlstm can be formulated as 3 f t w xf x t w hf h t 1 w cf c t 1 b f i t w xi x t w hi h t 1 w ci c t 1 b i c t f t c t 1 i t tanh w xc x t w hc h t 1 b c o t w xo x t w ho h t 1 w co c t b o h t o t tanh c t where is the convolutional operator 3 4 implementation steps 3 4 1 data process the input sets of the proposed sdlrr model contain a main input set and an auxiliary input set spatial spp is served as main input taking the imerg data as an example we grid the studied watershed according to satellite longitude and latitude trajectories spatial resolution of imerg is 0 1 and the studied watershed can be divided into 65 51 small grids as the basin shape is not a regular rectangle the rainfall values in the pixels outside the basin boundary are set to zero the number of predictors l1 is set to 15 it means the predictors in the main input set are the daily spatial rainfall in the previous 15 days therefore the size of the main input data is n 15 65 51 1 and n is the sample length in this paper catchment attribute features are considered to distinguish different catchment specific rainfall runoff behaviors a single sdlrr model is developed and used for all of sub basins and the whole basin the model is trained on the combined calibration data from all sub basins so n is equal to the total sample number of bb ldx ws and xhb as for the auxiliary input set the number of predictors l2 is set to 30 it means the daily runoff in previous 30 days is the predictor using catchment attribute features as predictors helps to distinguish catchment specific rainfall runoff behaviors in different basins and improve model performance mean precipitation aridity area mean elevation high precipitation duration mean slope etc are catchment attributes among them topological features mean elevation and catchment area and geomorphic features are considered as the most sensitive catchment attributes kratzert et al 2019 therefore three topological and geomorphic catchment attribute features are also adopted as predictors in this paper including mean elevation catchment area and vegetation covered area the size of auxiliary input data is n 33 the output of the model is the runoff to be forecasted the size of output data is n 1 all of the above data are normalized to the range of 0 to 1 to eliminate the skewing effect of variables 3 4 2 model preparation 1 cell stacking the stacked convlstm is used as the basic building block for spatial spp feature extraction the stacked convlstm extracts highly abstract features layer by layer and then makes predictions by mapping them to the pixel value space in the stacked architecture the hidden state within each convlstm layer is restricted to horizontal updates input information is passed up through the hidden state and the stacked lstm is used as the basic building block for temporal feature extraction the details of stacking multiple layers also can be found in xiang and demir 2020 xu et al 2022 2 flatten and concatenate as the mapping of convlstm layers is based on 3d tensors flattening and concatenating are essential to achieve one dimensional runoff forecasts modelling data of lstm layers are concatenated with the transferred compressed and flattened modelling data of convlstm layers to form the new one dimensional data then lstm layers and fully connected layer are used to further learn the temporal dependence in the new one dimensional data and achieve the final runoff forecasts 3 4 3 model training this study collected and processed imerg chirps and tmpa daily rainfall data of the jialing river basin from the year 2001 to 2015 daily runoff data of the entire basin outlet bb sub basin outlets ldx ws and xhb hydrologic stations in the same time period were also obtained the collected spatial data and time series data are divided into two parts the data of the last 1500 days in the 15 years were used as the model validation dataset and the early remaining data were used as the model training dataset for the model training process the loss functions commonly used in regression tasks have mean absolute error mae and mean squared error mse compared with mse which pays more attention to the effect of large error value mae can better reflect the actual situation of the predicted value error mae of forecasts and observations over all sub basins is used as the training objective adam algorithm is adopted to search the weights in the parameter space daily runoff data of the previous 30 days and daily rainfall data of the previous 15 days are preselected input factors the stacking layers of convlstm and lstm modules are not randomly determined but are optimally determined based on the trial and error method according to the common parameter value range of deep learning model in the field of runoff forecasting this study tried stacking layers from 1 to 7 layers and the stop epoch was set up to 200 cross validation method and early stop strategy are used to determine the suspension time of model training so as to avoid over fitting and under fitting then a series of experiments were carried out and the results show that the optimal number of stacked layers is 3 and when the epoch is set to 98 batch size is set to 32 the model can be trained enough and unnecessary time consumption is avoided 3 5 evaluation metric system 3 5 1 assessment of runoff forecasts root mean squared error rmse makes an excellent general purpose error metric for numerical predictions rmse amplifies and severely punishes large errors due to the squared term of the error in the formula the smaller the values of rmse the more accurate the predictions are r2 known as the coefficient of determination represents how well the model fits the data an r2 close to 1 0 means the model fits the data well while close to 0 means the model is not so good mean absolute error mae is a popular evaluation metrics for regression problems it measures the average of absolute errors of all samples reflecting the mean absolute distance between predicted values and true values relative absolute error rae is to sum the absolute errors and then divide it by the sum of the difference between the actual value and the mean thus it removes the effect of variable units as too many metrics add redundant information and make it difficult to understand the main results it is better to reduce the number of evaluation criteria to least possible which can demonstrate the sufficient information about the results generally in the similar studies one metric such as rmse is used for single station comparison and a dimensionless metric such as r2 is used for comparison between predictions for two stations or two non homogeneous variables rmse and r2 are both adopted as accuracy evaluation metrics of runoff forecasts in this study rmse is used for single station comparison and r2 is suitable for comparison between predictions for two stations 4 rmse i 1 n y i y i 2 n 5 r 2 1 i 1 n y i y i 2 i 1 n y y i 2 where y i is the forecasted runoff value of sample i y i is the observed runoff value at the sample i y is the average value of the observed runoff series and n is the size of the samples 3 5 2 assessment of spp estimates a series of indicators such as rmse mae bias correlation coefficient r accuracy can be used to evaluate rainfall estimation by remote sensing this study chose the most commonly used bias and r to evaluate the difference between the spp estimates and the ground gauges precipitation datasets bias describes the gap between the predicted value and the true value the larger the deviation the more the estimate deviates from the true data the value of r ranges from 1 to 1 the closer the value is to 1 the stronger the positive correlation between the two variables is the closer to 1 the stronger the negative correlation is and when it is 0 there is no correlation between the two variables 6 bias i 1 n y i y i n 7 r i 1 n y i y y i y i 1 n y i y 2 i 1 n y i y 2 where y i is the forecasted runoff value at the sample i y i is the observed runoff value at the sample i y is the average value of observed runoff series y i is the average value of forecasted runoff series and n is the size of the samples bias and r are used to evaluate the overall difference and correlation between the spp estimates and the ground gauges precipitation datasets this study also classified cumulative daily precipitation data into light rain moderate rain heavy rain and extremely heavy rain events to further evaluate whether the spp is accurate in estimating rainfall events indicators such as the probability of detection pod false alarm rate far and deviation rate dr which are the most appropriate metrics for evaluating such classification tasks are selected in the analysis the national meteorological center defines the threshold of precipitation classification criteria according to the cumulative value of daily precipitation the cumulative daily rainfall of more than 0 1 mm is called light rain more than 10 mm is called moderate rain more than 25 mm is called heavy rain and more than 50 mm is called extremely heavy rain the pod represents the probability that the precipitation classification is correctly detected by satellite precipitation which reflects the accuracy of the satellite precipitation estimates for different precipitation levels the calculation method is as follows 8 pod h h m far refers to the probability that the actual measurement does not exceed the threshold and the satellite observation exceeds the threshold which reflects the error rate of satellite detection the calculation method is as follows 9 far f h f dr reflects whether spps overestimate or underestimate precipitation events the range is 0 when its value is less than 1 it means that the spp underestimates the frequency of precipitation events when it is greater than 1 it means that the spp overestimates the frequency of precipitation events when it is equal to 1 it means that the estimation of the precipitation event by the satellite product is in good agreement with the actual measurement 10 dr h f h m table 1 is the parameters of pod far and dr 4 results this paper established a sdlrr model for jialing river basin to benchmark the performance of the proposed model comparative models with different model structures and model inputs are considered the models developed in this paper and their input sets are shown in table 2 imerg sdlrr chirps sdlrr and tmpa sdlrr are models proposed in this paper the model inputs include spatial daily imerg chirps or tmpa spp of the previous 15 days three static catchment attributes and daily runoff data of previous 30 days total input dimensions include the data dimension of main input and auxiliary input spatial resolutions of imerg chirps and tmpa are 0 1 0 05 and 0 25 respectively therefore the dimensions of the main input covering the study area are n 15 65 51 1 n 15 129 102 1 and n 15 26 20 1 the dimensions of auxiliary input are n 33 all the other models in table 2 are adopted as benchmarks they have no spatiotemporal structure and lstm is the only core algorithm the series of baseline lstm models were tested with the average spps of the whole area considered namely the baseline models have the same rainfall input but without the spatial information they were the direct baseline to compare with the proposed deep learning model sdlrr in order to better evaluate the influence of the spps and the addition of catchment attribute features on the accuracy of runoff forecasting the comparison models also contain different input combinations among them imerg lstm i chirps lstm i tmpa lstm i models ignore catchment attributes while imerg lstm ii chirps lstm ii tmpa lstm ii models consider catchment attributes the remaining lstm is a baseline model without using spps and the daily runoff data of the previous 30 days are the only input based on these models the forecast accuracy was studied and the estimate accuracy of spps was also evaluated through the analysis of the error statistics of the listed models the characteristics and advantages of the models proposed in this paper can be discussed fully and comprehensively 4 1 runoff forecasting results fig 4 shows the runoff forecast results of the four stations of ldx ws xhb and bb in the jialing river basin fig 5 a is for ldx b is for ws c is for xhb and d is for bb each sub figure shows ten forecasted runoff series and one measured runoff series the abscissa represents the runoff value and the ordinate represents the date from november 23 2011 to december 31 2015 covering about 4 flood seasons and 5 dry seasons it can be seen from the figure that in the four hydrological stations floods of ldx ws and bb are intensive while runoff series of xhb have lower flood frequency and smaller flood peak there is a strong correlation between the predicted runoff and the actual runoff for all of the ten models the fluctuation characteristic and runoff peak of the predicted runoff series are very close to the measured runoff series the developed comparative models as well as the sdlrr model can effectively predict the daily runoff 4 2 error statistics on runoff forecasts in this part the accuracy evaluation indicators of rmse and r2 are used to quantitatively analyze the runoff prediction performance of the sdlrr model rmse can evaluate the runoff prediction performance in the same hydrological station and r2 can evaluate the model prediction performance of different stations table 3 shows the statistical errors of forecast results including r2 r2 improvement rmse rmse improvement and rank among them r2 improvement and rmse improvement refer to the improvement percentage of the prediction of the concerned model in the r2 and rmse statistics compared to the benchmark model lstm rank means the rank of models according to r2 and rmse and the model with the highest r2 and lowest rmse is set ① for ldx the best three models are imerg sdlrr imerg lstm ii and tmpa lstm ii compared to lstm benchmark imerg sdlrr improved 15 in terms of r2 and improved 25 in terms of rmse imerg lstm ii improved 10 and 15 in terms of r2 and rmse tmpa lstm ii improved 9 and 9 respectively compared to imerg lstm ii the best performance model among models using average spp as rainfall input merg sdlrr improved 5 in terms of r2 and improved 11 in terms of rmse for ws the best three models are imerg sdlrr chirps sdlrr and chirps lstm ii compared to lstm benchmark imerg sdlrr improved 9 in terms of r2 and improved 16 in terms of rmse chirps sdlrr improved 2 and 5 in terms of r2 and rmse chirps lstm ii improved 2 and 4 respectively compared to chirps lstm ii the best performance model among models using average spp as rainfall input merg sdlrr improved 7 in terms of r2 and improved 12 in terms of rmse for xhb the best three models are chirps lstm i chirps lstm ii and chirps sdlrr compared to lstm benchmark chirps lstm i improved 1 in terms of r2 and improved 3 in terms of rmse chirps lstm ii improved 1 in both r2 and rmse chirps sdlrr improved 2 in terms of r2 compared to ldx and ws runoff forecasts the improvement of xhb runoff forecasts is not obvious there are several reasons for this phenomenon on the one hand from the statistics of the runoff sequence the average runoff of the xhb is the smallest among the four stations and the variance is also the smallest the runoff does not have the characteristic of severe fluctuations therefore there may be less heavy rain in this area the model proposed in this paper mainly improves the forecast accuracy by excavating the spatiotemporal characteristics of rainfall and runoff so the effect is limited in areas with little rainfall on the other hand the watershed of xhb has a narrow and elongated shape which differs greatly from the rectangular shape of other watersheds the input of the proposed model is matrix data so it is more suitable for mining rectangular space the mismatch between the watershed shape and matrix input is the reason why the proposed model does not improve the xhb runoff forecasts as much as other watersheds for bb the best three models are imerg sdlrr tmpa lstm ii and tmpa lstm i compared to lstm benchmark imerg sdlrr improved 7 in terms of r2 and improved 30 in terms of rmse tmpa lstm ii improved 6 and 24 in terms of r2 and rmse tmpa lstm i improved 5 and 22 in r2 and rmse compared to tmpa lstm ii the best performance model among models using average spp as rainfall input merg sdlrr improved 1 in terms of r2 and improved 8 in terms of rmse it indicates that the developed sdlrr model with spatial imerg spp achieves excellent performance in runoff forecasts utilization of imerg tmpa and chirps contributes to rainfall runoff forecasts and imerg has a better spatial representation than tmpa or chirps the models include catchment attributes in predictors are better than those without catchment attributes 4 3 error statistics on extreme flood forecasts in this part the relative forecasting errors of extreme flood events are further analyzed to evaluate the performance of the developed models in extreme runoff ranges the top five flood events in each hydrological station were extracted and analyzed as shown in fig 5 fig 5 a b c and d illustrated the relative error histogram of extreme flood forecasts for ldx ws xhb and bb respectively for ldx the top five flood events are on 2014 9 14 2012 9 3 2013 7 21 2015 6 25 and 2012 7 6 it shows that imerg sdlrr imerg sdlrr tmpa lstm ii imerg sdlrr and imerg sdlrr are the best models for the above five flood events respectively on average imerg sdlrr is the best model for ldx extreme flood forecasting for ws the top five flood events are floods on the day of 2013 7 19 2013 7 23 2012 9 2 2012 7 10 and 2012 7 9 it shows that imerg lstm i imerg lstm i imerg lstm i imerg lstm ii and tmpa lstm ii are the best models for the above five flood events respectively on average imerg lstm i is the best model for ws extreme flood forecasting for xhb the forecast errors of extreme floods are all large showing the shortcomings of several models in forecasting extreme floods in this area for bb the top five flood events are on 2012 7 6 2012 9 3 2012 7 10 2013 7 20 and 2013 7 21 it shows that imerg sdlrr tmpa lstm ii tmpa lstm i imerg sdlrr and tmpa lstm i are the best models for the above five flood events respectively on average imerg sdlrr is the best model for extreme flood forecasting the addition of spps contributes to the improvement of extreme flood forecasts two metrics the mean relative error mre and the qualified rate qr are used to further demonstrate the superiority of the developed sdlrr model in extreme flood forecasts as shown in table 4 mre is the mean of the relative errors of the five extreme floods for each model qr indicates the proportion of qualified flood forecasts when the relative error of a flood forecast is less than 30 it is considered a qualified forecast for ldx imerg sdlrr achieved the lowest mre of 0 05 and the highest qr of 100 for ws imerg lstm i achieved the lowest mre of 0 11 and the highest qr of 100 for xhb the lowest mre is 0 57 and the highest qr is 40 for bb imerg sdlrr achieved the lowest mre of 0 12 and the highest qr of 93 for ldx imerg sdlrr greatly improved the performance compared to the benchmark lstm by decreasing mre by 0 28 and increasing qr by 40 compared to the best model using averaged spps as rainfall input namely tmpa lstm ii imerg sdlrr improved the performance by decreasing mre by 0 14 and increasing qr by 20 for bb imerg sdlrr greatly improved the performance compared to benchmark lstm by decreasing mre by 0 27 and increasing qr by 60 compared to the best performance model using averaged spps as rainfall input namely tmpa lstm ii imerg sdlrr improved the performance by increasing qr by 20 on average for four hydrological stations imerg sdlrr achieved the lowest mre of 0 12 and the largest qr of 93 it decreased mre by 0 29 and increased qr by 53 compared to lstm and decreased mre by 0 08 and increased qr by 6 compared to the best performance model using averaged spps as rainfall input namely imerg lstm i 5 discussion 5 1 consistency analysis of spps estimates error statistics of runoff forecasts in the entire basin show that the best three models are imerg sdlrr tmpa lstm ii and tmpa lstm i it reflects that imerg and tmpa provide better estimates of regional precipitation the accuracy of regional spps was evaluated to verify the performance and benefit of spps in runoff forecasts here bias was used for the point to point comparison of estimated daily satellite precipitation estimation data and rain gauge data during the evaluation period of 15 years from 2001 to 2015 fig 6 shows the spatial bias distribution of imerg tmpa and chiprs imerg and tmpa estimates are better than chirps estimates for lower absolute bias on average chirps underestimates the rain gauge precipitation in the east and overestimates the rain gauge precipitation in the west and north in general the accuracy evaluation of spps based on bias method is consistent with the results of spatiotemporal rainfall runoff forecasting method fig 7 shows the error statistics of tmpa data in different magnitudes and altitudes precipitation intensity is divided into light rain 0 1 mm 10 mm moderate rain 10 mm 25 mm heavy rain 25 mm 50 mm and extremely heavy rain 50 mm altitudes are classified into low altitude 0 1000 m moderate altitude 1000 m 2000 m and high altitude greater than 2000 m it can be seen that the pod shows a downward trend with the increase of precipitation intensity the far values fluctuate with the increase of precipitation intensity judging from the dr with the increase of precipitation intensity the value of the dr gradually decreases from dr 1 to dr 1 which means that the tmpa data mainly overestimate low intensity precipitation and underestimate heavy rain and extremely heavy rain it is found that the accuracy of spps estimates is mainly affected by precipitation intensity rather than altitude for runoff forecasts accuracy r2 of the runoff forecasts is also not affected by average altitudes as dem of ldx ws and xhd sub basins are 730 m 1626 m and 1025 m and accuracy r2 of ldx and ws are better than that of xhd the shape of the jialing river basin ldx sub basin and ws sub basin tend to be fan shaped while the shape of the xhb sub basin is small and narrow it is hard to utilize spatial precipitation and provide useful information for runoff forecasts in a small and narrow area 5 2 uncertainty of spps estimates rainfall is affected by various factors such as basin topography geographic location and atmospheric movement and has spatial and temporal variability the premise of using spps for hydrological research such as runoff forecasting is that the data product has a high accuracy however despite the fine spatial and temporal resolution the current global spps are subject to a certain degree of error worqlul et al 2018 in particular real time precipitation products without ground data correction and post processing can have relative systematic deviations of more than 100 percent abera et al 2016 when these satellite precipitation products are used as the initial input to drive the rainfall runoff process the input uncertainty caused by the error will seriously affect the accuracy of hydrological simulation even for the latest generation of gpm satellite precipitation grade 3 products imerg the errors contained in it are generally higher than the corresponding surface station errors xu et al 2017 therefore in order to overcome the disadvantage of large systematic error of the original spe it is necessary to preprocess the original satellite remote sensing precipitation products such as correcting the bias or error to improve the accuracy of the precipitation data and its driven hydrological simulation for the spps adopted in this paper chirps incorporates in house climatology chpclim 0 05 resolution satellite imagery and in situ station data to create gridded rainfall time series in the processing of imerg final more sensor data sources were introduced including the introduction of global rainfall stations for correction the tmpa is designed to combine precipitation estimates from various satellite systems and where possible land surface precipitation gauge analyses chirps imerg f tmpa are bias corrected spps although the uncertainty cannot be completely eliminated the runoff forecasting results show that the utilization of imerg tmpa and chirps contributes to rainfall runoff forecasts and imerg has a better spatial representation in the jrb than tmpa or chirps 5 3 comparison with previous studies developing reliable hydrological prediction models remains a challenging task in water resource management kaya et al 2017 there is much recent literature on case studies of machine learning ml techniques for hydrological forecasting hybridization data decomposition algorithm ensemble and model optimization are reported as the most effective strategies and the major trends for the improvement of ml methods mosavi et al 2018 ① hybrid models generalized structure group method of data handling gs gmdh adaptive neuro fuzzy inference system with fuzzy c means anfis fcm ebtehaj et al 2021 were proposed to predict the daily runoff and water level hybrid models outperformed the standalone models in these studies ② data decomposition or data preprocessing moving average ma singular spectrum analysis ssa and preprocessing methods were used to divide the training data into three crisp subsets of low medium and high level wu chau 2013 ③ algorithm ensemble or prediction interval pi estimation traditional techniques for ann based pi estimation lower upper bound estimation lube methods and multi objective optimization algorithms were proposed for the estimation of prediction intervals pis taormina chau 2015 ④ the last but the most important model optimization problem analysis data collection and preprocessing data driven model selection and evaluation of the selected models are the fundamental steps of ml based hydrological prediction models the most important of these steps is data driven model identification as this is where the learning process is performed and features are extracted researchers aim at discovering more accurate and efficient prediction models mosavi et al 2018 through introducing novel ml methods lstm is considered to be one of the best models for streamflow prediction using historical data in recent years lstm model showed good ability to capture data features in the rapidly fluctuant streamflow data in the previous study fu et al 2020 this paper challenges this most important and difficult task by constructing a new large scale spatiotemporal deep learning rainfall runoff model compared to the state of the art lstm developed for runoff forecasting in the jrb the performance of the proposed model improved 15 in terms of r2 and improved 25 in terms of rmse in ldx station in addition the model prediction results show that the proposed model is more reliable in extreme flood prediction the spatiotemporal feature extraction and learning of the proposed model directly improve the rainfall runoff prediction accuracy 6 conclusion the capture and learning of spatial patterns in rainfall runoff modeling is of great significance to improve the runoff forecasting accuracy the existing researches have not yet accurately involved the spatiotemporal rainfall runoff forecasting based on the architecture of deep learning in addition the lack of spatial information specific to spps is a major loss in spatiotemporal rainfall runoff forecasting studies therefore this study developed a large scale sdlrr forecasting model in the uyr and evaluated the positive impact of utilizing the spatial information of three spps on reducing errors of runoff forecasts which is rarely studied and discussed in runoff prediction based on deep learning it was demonstrated that sdlrr improves the accuracy of runoff forecasting compared with benchmark models that are incapable of capturing and learning spatial patterns in rainfall runoff modeling the sdlrr model developed using spatial imerg spp achieved the best performance in runoff forecasts taking ldx as an example compared to the best performance model among models that cannot capture spatial information in rainfall runoff modeling the proposed imerg sdlrr model improved 5 in terms of r2 and improved 11 in terms of rmse sdlrr has also achieved good performance at the other hydrological stations it also proves the superiority of the proposed sdlrr model in extreme flood forecasts on average for the four hydrological stations imerg sdlrr achieved the lowest mre of 0 12 and the largest qr of 93 for extreme flood forecasts it decreased mre by 0 29 and increased qr by 53 compared to lstm and decreased mre by 0 08 and increased qr by 6 compared to the best performance model that cannot capture spatial information in rainfall runoff modeling the advantage of the proposed sdlrr model lies in capturing and learning spatial patterns in rainfall runoff modeling for improving the runoff forecasting accuracy it uses spps and deep learning architecture to solve previously undiscussed spatiotemporal rainfall runoff prediction problems as for the limitation of the proposed sdlrr model the performance improvement in long and narrow watersheds is not as good as watersheds tend to be rectangular due to the mismatch between the watershed shape and matrix input because of the difficulty in improving the model suitable for the irregular watershed it should be further studied in the future work funding sources this work was supported by the hubei key laboratory of intelligent yangtze and hydroelectric science grant no zh20020001 credit authorship contribution statement shuang zhu conceptualization methodology writing original draft jianan wei data curation hairong zhang validation investigation yang xu supervision hui qin writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
2591,rainfall runoff modeling is a complex nonlinear spatiotemporal prediction problem however few studies have considered the spatial characteristics of rainfall runoff relationship in runoff forecasts based on machine learning with the emergence of high resolution satellite based precipitation products spps and the continuous improvement of rainfall estimation accuracy the shortcoming of sparse spatial information for in situ rainfall monitoring has been made up therefore this study developed a large scale spatiotemporal deep learning rainfall runoff sdlrr forecasting model for hydrological stations in the upper yangtze river and evaluated the positive impact of utilizing spatial information of three spps on reducing errors of runoff forecasts the adopted remote sensing precipitation products are bias corrected climate hazards group infrared precipitation with station data chirps integrated multi satellite retrievals for global precipitation measurement data imerg and tropical rainfall measuring mission multi satellite precipitation analysis data tmpa for runoff forecasting at the luoduxi ldx hydrological station compared to regular long short term memory network lstm model the proposed sdlrr model that utilizing imerg data as precipitation input imerg sdlrr improved 15 in terms of coefficient of determination r2 and improved 25 in terms of root mean squared error rmse compared to the best performance model among models using area averaged precipitation as input imerg sdlrr improved 5 in terms of r2 and 11 in terms of rmse good performance was also acquired in the other hydrological stations for extreme flood forecasts imerg sdlrr decreased mean relative error mre by 0 29 and increased qualified rate qr by 53 compared to lstm and decreased mre by 0 08 and increased qr by 6 compared to the best performance model using area averaged precipitation as input the utilization of imerg or tmpa spatial information improved the accuracy of runoff forecasting the accuracy evaluation of spps based on the results of spatiotemporal rainfall runoff forecasts method was also demonstrated the research is of great significance for developing runoff forecasting methods and optimizing water resources management keywords runoff forecasts satellite precipitation products deep learning spatiotemporal characteristics accuracy assessment the yangtze river data availability data will be made available on request 1 introduction flood is one of the natural disasters that have a great impact on the world with complex characteristics such as rapid occurrence strong randomness high frequency and uneven spatial distribution therefore improving the forecast accuracy of runoff or flood forecasting models has always been a challenge in hydrological researches speight et al 2021 in the rainfall induced runoff forecasting work the key content is to simulate the future runoff process by using the runoff forecasting model and rainfall information however the lack of historically measured rainfall data and real time rainfall information in data deficient areas puts the work of runoff forecasting in a difficult situation dou et al 2021 with the development of remote sensing technology satellite based precipitation products spps have gradually become an effective supplement and substitute for the measured data typical spps include tropical rainfall measuring mission trmm multi satellite precipitation analysis tmpa precipitation estimation from remotely sensed information using artificial neural networks persiann global satellite mapping precipitation gsmap and the integrated multi satellite retrievals for global precipitation measurement imerg nguyen et al 2018 kubota et al 2020 yin et al 2021 at present the accuracy assessment of important satellite remote sensing products is carried out in australia the united states europe india and other research areas speight et al 2021 compared the matching degree of several products persiann tmpa imerg and gsmap and optimally combined spps with rain gauge precipitation for accurate rainfall estimation the adequate and proper use of satellite remote sensing data is of great significance for improving regional runoff forecasts nowadays spps are widely applied to large and medium scale regional flood forecasting and the hydrological model method is also an important way to evaluate the accuracy of the spps tong et al 2014 evaluated trmm 3b42 noaa climate prediction center morphing technique cmorph tmpa 3b42rt persiann against gauge observations over the tibetan plateau in streamflow simulations using the variable infiltration capacity macroscale hydrologic model vic and found that the trmm 3b42 and cmorph performed better than the tmpa 3b42rt and persiann at both plateau and basin scales llauca et al 2021 investigated the applicability of imerg gsmap cmorph in near real time for the simulation of sub daily runoff in the vilcanota river basin and these spps were used as meteorological inputs for the hourly hydrological modeling using the génie rural à 4 paramétres horaires gr4h hydrology model the bias corrected climate hazards group infrared precipitation with station data chirps were utilized as the inputs to simulate discharge and peak value and the result indicated a good performance of the proposed bias correction approach in reducing the chirps satellite estimations errors mokhtari et al 2022 zhu et al 2021 assessed the suitability of imerg early imerg late imerg final and tmpa in flood simulation over a humid region of china by using hydrologiska byrans vattenbalansavdeling hbv hydrology model and the statistical assessment showed imerg final outperformed the other spps spps have been widely combined with lumped or distributed hydrological models to carry out spps assessment and hydrological modelling the application effect of the model used in current studies mainly depends on the hydrological law of the basin the quality of the input data and the model s yield and confluence mechanism girons lopez et al 2021 in the past decades data driven hydrological models have received great attention because of their strong fitting ability and flexible input data early data driven techniques are linear regression lr autoregressive moving average arma and their variations valipour 2015 afterwards artificial neural network ann adaptive neuro fuzzy inference system anfis gaussian process regression gpr genetic programming gp support vector machine svm extreme learning machine elm have been successfully developed for daily and seasonal runoff forecasting mekanik et al 2016 xing et al 2016 with the development of deep learning technology in dealing with the temporal dependence of hydrological series researchers creatively introduced various kinds of deep learning for runoff forecasting and obtained promising performances zhang et al 2018 he et al 2019 bai et al 2021 liu et al 2019 extended a deep learning method into the bayesian framework and got the uncertainty evaluation of runoff forecasting long short term memory network lstm is an improved recurrent neural network that can solve the problem of long distance dependencies that rnns cannot handle due to the vanishing and exploding gradients it is currently one of the more popular time series forecasting models bai et al 2021 zhu et al 2020 combined lstm network and gaussian process regression gpr to develop a reliable daily runoff forecasting model chu et al 2020 demonstrated that deep learning performed better than the traditional ann runoff forecasting models kao et al 2020 explored multi step runoff forecasting using deep learning network and encoder decoder framework han and morrison 2021 developed deep learning approaches for runoff prediction using distributed meteorological data however in the traditional data driven model for runoff forecasting hydrological data is processed into a one dimensional time series resulting in the loss of spatial information therefore it is significant to establish a data driven model capable of considering the spatial heterogeneity of meteorological and hydrological processes chen et al 2016 nijzink et al 2016 elsaadani et al 2021 li et al 2021 convolutional neural network cnn algorithm is well suited for capturing and learning spatial patterns a mixture model called convolutional long short term memory convlstm is designed to solve the spatiotemporal prediction problem which has the advantage of spatial feature extraction and temporal sequence dependent learning it was firstly used for video prediction shi et al 2015 and then introduced into precipitation broadcasting having achieved great success sadeghi et al 2019 recently ha et al 2021 developed a convlstm model to predict the monthly streamflow of the yangtze river in three flood years however the input data of the convlstm in their study are one dimensional enso and the monthly streamflow both of which lack spatial features worth learning furthermore the convlstm was developed and applied in predicting satellite soil moisture elsaadani et al 2021 li et al 2021 moishin et al 2021 built a convlstm flood forecasting model to forecast the future occurrence of flood events these studies demonstrated excellent predictive performance of convlstm in forecasting meteorological and hydrological maps nevertheless the adopted model structures are similar to the previous video prediction and precipitation broadcasting collectively known as the image prediction problem for rainfall runoff forecasts both one dimensional time series and 3d spatial hydrological data are involved in model input and output and some improvements are expected to be made in the model architecture to solve this problem schmidt et al 2020 trained convlstm models on daily temperature and precipitation maps of the catchment area to predict the streamflow of the elbe river thus gaining spatial insight into the hydrological system chen et al 2022 divided the study area into grids developed convlstm model to extract spatiotemporal features of hydrological information and achieved excellent flood prediction however their study areas of interest were focused on small counties where spatial characteristics of rainfall and runoff are still relatively uniform and the model structures are relatively small in scale what s more the spps described above which are important providers of large scale rainfall spatial distribution and magnitude information are not utilized and discussed it is a great loss to build spatiotemporal rainfall runoff prediction without utilization of spps besides it would be beneficial to further assess the accuracy of spps estimates using spatiotemporal deep learning model capturing and learning spatial patterns in rainfall runoff modeling is very meaningful for improving the runoff forecasting accuracy based on the above discussion it is found that the existing researches have not yet accurately involved the large scale spatiotemporal rainfall runoff forecasting based on the architecture of deep learning in addition the spps that providing large scale rainfall spatial information were not utilized and discussed in these researches the lack of spps specific spatial information is a major loss therefore for the complex nonlinear runoff forecasting problem there is still room for improvement different with traditional hydrological model like hbv vic etc and regular machine learning model like ann svm lstm etc this study will develop a large scale spatiotemporal deep learning rainfall runoff sdlrr forecasting model in the upper yangtze river uyr and evaluated the positive impact of utilizing the spatial information of three satellite based precipitation products spps on reducing errors of runoff forecasts which is rarely studied and discussed in runoff forecasting based on deep learning the advantages of adopting spatiotemporal deep learning rainfall runoff forecasting model lie in capturing and learning spatial patterns in rainfall runoff modeling for improving the runoff forecasting accuracy rainfall data comes from three remote sensing precipitation products chirps imerg and tmpa with spatial resolutions of 0 1 0 05 and 0 25 respectively chirps imerg and tmpa have satisfactory rainfall estimation accuracy in the yangtze river basin and using spps with different resolutions helps to study the effects of resolution on the runoff forecasts the advantages of sdlrr are demonstrated with controlled experiments runoff forecast performance enables incidental assessment of the accuracy of remote sensing rainfall estimates the main contributions of this paper are as follows a spatiotemporal sdlrr model is developed for large basins and sub basins of uyr spatial features of three regional spps are extracted and used based on stacked convlstm topological and geomorphic features are added to distinguish different catchment specific rainfall runoff behaviors sdlrr improves the accuracy of runoff forecasting compared with benchmark models spps can be incidentally assessed based on the model performance of runoff forecasting the rest of this paper is organized as follows section 2 describes the study area and data collection section 3 illustrates the approaches for spatiotemporal rainfall runoff forecasting and the experimental results are presented in section 4 discussion and conclusion are given in section 5 and section 6 respectively 2 study area and data descriptions 2 1 study area the yangtze river is the third largest river in the world and the largest in china it originates from the main peak of the tanggula mountain on the qinghai tibet plateau the main stream is more than 6 300 km long and the drainage area is about 1 8 million km2 accounting for about 18 8 of china s land area the yangtze river with its huge river lake system unique and complete natural ecosystem and powerful functions of water conservation biological reproduction oxygen release and carbon fixation and environmental purification ensures the national water supply security food security and energy security the length of the upper reaches of the main stream of the yangtze river accounts for 70 4 of the total length of the yangtze river the locations of the upper reaches of the yangtze river main tributaries and the gauging stations are shown in fig 1 the river section above pingshan county is called the jinsha river with a length of 3464 km and a drop of about 5100 m and the main tributary added is the yalong river the length of the river between pingshan county and yichang city is 1040 km the main tributaries added are the minjiang river and the jialing river on the north bank and the wujiang river on the south bank the jialing river is the largest river in the tributaries of the yangtze river the jialing river originates from the southern foot of the western section of the qinling mountains and flows into the yangtze river in chongqing city the basin area is 160 000 km2 the main stream is 1120 km long the average annual flow is 2120 m3 s and the total drop is 2300 m continuous heavy rainfall is the main factor for flooding in jialing river according to the analysis of more than 50 flood peaks at the outlet of the upper reach of yangtze river uyr 43 of flood volume comes from the jialing river and heavy rainfall in the jialing river is the main source of floods the utilization of spatial precipitation information plays a more important role in improving runoff forecasting in the jialing river the watershed shape is squarer which is adequate for spatiotemporal information extraction furthermore the historical runoff data of the jialing river is recorded completely and there is also no continuous data missing problem in sub watersheds considering these factors this study chooses the jialing river as the study area the beibei bb hydrological station is located in the downstream outlet of the jialing river the entire jialing river basin jrb can be divided into three sub basins namely the main stream basin the qu river basin and the fu river basin wusheng ws luoduxi ldx and xiaoheba xhb are the outlet hydrological stations of the three sub basins therefore bb ws ldx and xhb hydrological stations are adequately choices for the study of spatiotemporal deep learning rainfall runoff forecasting in the jrb 2 2 runoff data daily rainfall runoff forecasting is implemented for bb ws ldx and xhb hydrological stations the quality checked daily runoff series observed at bb ws ldx and xhb hydrological stations come from china s yangtze river waterway bureau http www cjw gov cn the time span is from 2001 1 1 to 2015 12 31 the runoff series and the descriptive statistics are shown in fig 2 it can be seen that the runoff series of bb ws ldx and xhb hydrological stations show seasonal fluctuations and the randomness and nonlinearity of runoff are prominent the runoff data of beibei has a particularly large mean and standard deviation sd with values of mean 1905 m3 s and sd 3072 m3 s the length in the descriptive statistics means the number of runoff observations beibei hydrological station has a complete runoff observation with a length of 5478 in the 15 years ws ldx and xhb hydrological stations missed a small set of records in the early years and the days of missing data existing were excluded and not used for model training and runoff forecasting 2 3 bias corrected climate hazards group infrared precipitation with station data chirps was created in collaboration with scientists at the usgs earth resources observation and science eros center to provide complete reliable up to date datasets for many early warning goals funk et al 2015 it is a 35 year quasi global rainfall data set which spans the area 50 s 50 n and all longitudes and encompasses the data from 1981 to near present and chirps incorporates in house climatology chpclim 0 05 resolution satellite imagery and in situ station data to create gridded rainfall time series for trend analysis and seasonal drought monitoring it has a high spatial resolution of 0 05 and temporal resolutions of daily monthly and seasonal scales the data version used in this study is v2 0 which can be obtained from https www chc ucsb edu data chirps 2 4 integrated multi satellite retrievals for global precipitation measurement data global precipitation program gpm inherits the successful experience and achievements of trmm and improves the precipitation retrieval algorithm imerg is the latest generation of multi satellite fusion inversion of precipitation data specially created for gpm and the latest version is version 6 with a temporal resolution of 30 min a spatial resolution of 0 1 0 1 and a coverage of 60 n 60 s later extended to 90 n 90 s it makes full use of the data provided by all satellite sensors on the gpm platform and also fully draws on various satellite precipitation inversion algorithms that were basically mature in the previous trmm era for fusion imerg currently provides three types of satellite precipitation data namely early late and final versions in the processing of version final more sensor data sources were introduced including the introduction of global rainfall stations for correction and it has broad application prospects in the fields of hydrological simulation and environmental management huang et al 2018 imerg final daily precipitation dataset is adopted in this study 2 5 tropical rainfall measuring mission multi satellite precipitation analysis data tmpa is a quasi global 60 s 60 n precipitation dataset it is one of the best multi satellite precipitation products in trmm huffman et al 2007 and it is a new dataset that continues the trend toward routine computation and distribution of finer scale precipitation estimates its spatial resolution is 0 25 and temporal resolution is three hours the tmpa is designed to combine precipitation estimates from various satellite systems as well as land surface precipitation gauge analyses when possible this study uses the latest version of tmpa v7 which can be obtained from https pmm nasa gov data access studies have shown that the error adjusted data of tmpa 3b42v7 perform well in rainfall estimation and hydrological forecasting 3 methodology 3 1 problem description the object of this study is to develop a generic sdlrr forecasting model for multiple basins which is capable of exacting spatial features of regional spps and improving the accuracy of runoff forecasting suppose xt is the regional spp estimate at the time of t let yt 1 represent outlet runoff at the time of t 1 ai represent the i th catchment attribute which is related to different catchment specific rainfall runoff behaviors the rainfall runoff forecasting problem in this paper is to learn the complicated behaviors from 3d rainfall series to 2d runoff series the above problem can be described as 1 y t 1 f s d l r r x t x t 1 x t l 1 1 y t y t 1 y t l 2 1 a 1 a 2 a i θ where xt is an m n matrix m is the number of horizontal grids of the adopted regional spp and n is the number of vertical grids l 1 is the number of rainfall type predictors l 2 is the number of runoff type predictors it means that the daily rainfall of l 1 days before the forecast day and daily runoff of l 2 days before the forecast day are included as the predictors f s d l r r is the spatiotemporal rainfall runoff forecasting model developed based on training samples x y a θ is the model parameter and y t 1 is the runoff to be predicted 3 2 model architecture the input and output of convlstm video prediction are data matrix in order to process and learn high dimensional spatial features the data types of rainfall runoff forecasts include grid type rainfall data as well as one dimensional runoff data combining convlstm with additional units is needed to fit the new problem the architecture of the proposed spatiotemporal rainfall runoff forecasting is illustrated in fig 3 spp in previous l 1 days are main input and runoff series in previous l 2 days are auxiliary input the developed model outputs one step ahead runoff forecasts written as yt 1 convlstm is used to extract the time dependence as well as the spatial features from the adjacent meteorological grids batch normalization forces the distribution of input values of each layer back to a standard normal distribution with a mean of 0 and a variance of 1 through a certain normalization method which can avoid the problem of gradient disappearance and improve the training speed dropout is to randomly drop some hidden or visible units in a neural network and these units are not allowed to participate in forward reasoning and backward propagation due to the random dropout the training independence is higher which can effectively avoid model overfitting after a convolution operation the output data are flattened that is 3d data are compressed into a one dimensional array and then connected to the full connection layer topological and geomorphic catchment attributes mean elevation catchment area vegetation covered area are included as predictors here since they help to improve model performance and distinguish different basin catchment specific rainfall runoff behaviors kratzert et al 2019 we used static catchment attributes that aggregated from gridded data products as the study area is located in a mountainous region with high altitude and relatively backward economic development the static catchment attributes were also used in the existing studies kratzert et al 2019 lstm model has shown great promise in dealing with runoff time series prediction problems xiang et al 2020 and is used in the auxiliary modelling module then lstm modelling data are concatenated with the output of the transferred compressed and flattened spp to form the new one dimensional data after that traditional lstm layer and fully connected layer are used to further learn the temporal dependence in the new one dimensional data to make final forecasts details are given below 3 3 model units 3 3 1 long short term memory lstm is an improved recurrent neuro network rnn which has received great attention in dealing with sequential data hochreiter schmidhuber 1997 different from standard recurrent neuro network special gate structures in the memory block of lstm enable it to extract dependency relationship of time series and significantly avoid the vanishing gradients problem an lstm cell has a forget gate input gate and output gate to decide whether the information will be output or stored the gate mechanism of an lstm can be written as 2 f t w f h t 1 x t b f i t w i h t 1 x t b i c t tanh w c h t 1 x t b c c t f t c t 1 i t c t o t w o h t 1 x t b o h t o t tanh c t where σ is the sigmoid function w f w i w c w o are weights b f b i b c b o are bias vectors f t i t o t are the outputs of forget gate input gate and output gate x t and c t are the input and cell state h t is hidden state and are the matrix vector multiplication and hadamard product respectively 3 3 2 convolutional long short term memory this paper utilizes convlstm to make full use of spatial features of rainfall for runoff time series forecasts convlstm was first proposed by shi et al 2015 to solve the problem of precipitation forecasting and widely used in recent studies elsaadani et al 2021 li et al 2021 chen et al 2022 the problem of precipitation forecasting is usually regarded as a time series problem so it is usually considered using lstm to solve it but pure lstm cannot use the spatial data features so the spatial distribution features of rainfall are not fully utilized in the lstm method the convlstm structure can not only establish a time series relationship similar to lstm but also have a spatial feature extraction capability similar to cnn which has a better effect than lstm in obtaining the spatiotemporal relationship therefore the model architecture proposed in this paper uses convlstm as one of the basic units to solve the rainfall runoff prediction problem different from lstm convolutional structure is introduced to replace the fully connected operators in the transition of input to state and state to state thus the input data is high dimensional and suitable for spatial sequence data convlstm can be formulated as 3 f t w xf x t w hf h t 1 w cf c t 1 b f i t w xi x t w hi h t 1 w ci c t 1 b i c t f t c t 1 i t tanh w xc x t w hc h t 1 b c o t w xo x t w ho h t 1 w co c t b o h t o t tanh c t where is the convolutional operator 3 4 implementation steps 3 4 1 data process the input sets of the proposed sdlrr model contain a main input set and an auxiliary input set spatial spp is served as main input taking the imerg data as an example we grid the studied watershed according to satellite longitude and latitude trajectories spatial resolution of imerg is 0 1 and the studied watershed can be divided into 65 51 small grids as the basin shape is not a regular rectangle the rainfall values in the pixels outside the basin boundary are set to zero the number of predictors l1 is set to 15 it means the predictors in the main input set are the daily spatial rainfall in the previous 15 days therefore the size of the main input data is n 15 65 51 1 and n is the sample length in this paper catchment attribute features are considered to distinguish different catchment specific rainfall runoff behaviors a single sdlrr model is developed and used for all of sub basins and the whole basin the model is trained on the combined calibration data from all sub basins so n is equal to the total sample number of bb ldx ws and xhb as for the auxiliary input set the number of predictors l2 is set to 30 it means the daily runoff in previous 30 days is the predictor using catchment attribute features as predictors helps to distinguish catchment specific rainfall runoff behaviors in different basins and improve model performance mean precipitation aridity area mean elevation high precipitation duration mean slope etc are catchment attributes among them topological features mean elevation and catchment area and geomorphic features are considered as the most sensitive catchment attributes kratzert et al 2019 therefore three topological and geomorphic catchment attribute features are also adopted as predictors in this paper including mean elevation catchment area and vegetation covered area the size of auxiliary input data is n 33 the output of the model is the runoff to be forecasted the size of output data is n 1 all of the above data are normalized to the range of 0 to 1 to eliminate the skewing effect of variables 3 4 2 model preparation 1 cell stacking the stacked convlstm is used as the basic building block for spatial spp feature extraction the stacked convlstm extracts highly abstract features layer by layer and then makes predictions by mapping them to the pixel value space in the stacked architecture the hidden state within each convlstm layer is restricted to horizontal updates input information is passed up through the hidden state and the stacked lstm is used as the basic building block for temporal feature extraction the details of stacking multiple layers also can be found in xiang and demir 2020 xu et al 2022 2 flatten and concatenate as the mapping of convlstm layers is based on 3d tensors flattening and concatenating are essential to achieve one dimensional runoff forecasts modelling data of lstm layers are concatenated with the transferred compressed and flattened modelling data of convlstm layers to form the new one dimensional data then lstm layers and fully connected layer are used to further learn the temporal dependence in the new one dimensional data and achieve the final runoff forecasts 3 4 3 model training this study collected and processed imerg chirps and tmpa daily rainfall data of the jialing river basin from the year 2001 to 2015 daily runoff data of the entire basin outlet bb sub basin outlets ldx ws and xhb hydrologic stations in the same time period were also obtained the collected spatial data and time series data are divided into two parts the data of the last 1500 days in the 15 years were used as the model validation dataset and the early remaining data were used as the model training dataset for the model training process the loss functions commonly used in regression tasks have mean absolute error mae and mean squared error mse compared with mse which pays more attention to the effect of large error value mae can better reflect the actual situation of the predicted value error mae of forecasts and observations over all sub basins is used as the training objective adam algorithm is adopted to search the weights in the parameter space daily runoff data of the previous 30 days and daily rainfall data of the previous 15 days are preselected input factors the stacking layers of convlstm and lstm modules are not randomly determined but are optimally determined based on the trial and error method according to the common parameter value range of deep learning model in the field of runoff forecasting this study tried stacking layers from 1 to 7 layers and the stop epoch was set up to 200 cross validation method and early stop strategy are used to determine the suspension time of model training so as to avoid over fitting and under fitting then a series of experiments were carried out and the results show that the optimal number of stacked layers is 3 and when the epoch is set to 98 batch size is set to 32 the model can be trained enough and unnecessary time consumption is avoided 3 5 evaluation metric system 3 5 1 assessment of runoff forecasts root mean squared error rmse makes an excellent general purpose error metric for numerical predictions rmse amplifies and severely punishes large errors due to the squared term of the error in the formula the smaller the values of rmse the more accurate the predictions are r2 known as the coefficient of determination represents how well the model fits the data an r2 close to 1 0 means the model fits the data well while close to 0 means the model is not so good mean absolute error mae is a popular evaluation metrics for regression problems it measures the average of absolute errors of all samples reflecting the mean absolute distance between predicted values and true values relative absolute error rae is to sum the absolute errors and then divide it by the sum of the difference between the actual value and the mean thus it removes the effect of variable units as too many metrics add redundant information and make it difficult to understand the main results it is better to reduce the number of evaluation criteria to least possible which can demonstrate the sufficient information about the results generally in the similar studies one metric such as rmse is used for single station comparison and a dimensionless metric such as r2 is used for comparison between predictions for two stations or two non homogeneous variables rmse and r2 are both adopted as accuracy evaluation metrics of runoff forecasts in this study rmse is used for single station comparison and r2 is suitable for comparison between predictions for two stations 4 rmse i 1 n y i y i 2 n 5 r 2 1 i 1 n y i y i 2 i 1 n y y i 2 where y i is the forecasted runoff value of sample i y i is the observed runoff value at the sample i y is the average value of the observed runoff series and n is the size of the samples 3 5 2 assessment of spp estimates a series of indicators such as rmse mae bias correlation coefficient r accuracy can be used to evaluate rainfall estimation by remote sensing this study chose the most commonly used bias and r to evaluate the difference between the spp estimates and the ground gauges precipitation datasets bias describes the gap between the predicted value and the true value the larger the deviation the more the estimate deviates from the true data the value of r ranges from 1 to 1 the closer the value is to 1 the stronger the positive correlation between the two variables is the closer to 1 the stronger the negative correlation is and when it is 0 there is no correlation between the two variables 6 bias i 1 n y i y i n 7 r i 1 n y i y y i y i 1 n y i y 2 i 1 n y i y 2 where y i is the forecasted runoff value at the sample i y i is the observed runoff value at the sample i y is the average value of observed runoff series y i is the average value of forecasted runoff series and n is the size of the samples bias and r are used to evaluate the overall difference and correlation between the spp estimates and the ground gauges precipitation datasets this study also classified cumulative daily precipitation data into light rain moderate rain heavy rain and extremely heavy rain events to further evaluate whether the spp is accurate in estimating rainfall events indicators such as the probability of detection pod false alarm rate far and deviation rate dr which are the most appropriate metrics for evaluating such classification tasks are selected in the analysis the national meteorological center defines the threshold of precipitation classification criteria according to the cumulative value of daily precipitation the cumulative daily rainfall of more than 0 1 mm is called light rain more than 10 mm is called moderate rain more than 25 mm is called heavy rain and more than 50 mm is called extremely heavy rain the pod represents the probability that the precipitation classification is correctly detected by satellite precipitation which reflects the accuracy of the satellite precipitation estimates for different precipitation levels the calculation method is as follows 8 pod h h m far refers to the probability that the actual measurement does not exceed the threshold and the satellite observation exceeds the threshold which reflects the error rate of satellite detection the calculation method is as follows 9 far f h f dr reflects whether spps overestimate or underestimate precipitation events the range is 0 when its value is less than 1 it means that the spp underestimates the frequency of precipitation events when it is greater than 1 it means that the spp overestimates the frequency of precipitation events when it is equal to 1 it means that the estimation of the precipitation event by the satellite product is in good agreement with the actual measurement 10 dr h f h m table 1 is the parameters of pod far and dr 4 results this paper established a sdlrr model for jialing river basin to benchmark the performance of the proposed model comparative models with different model structures and model inputs are considered the models developed in this paper and their input sets are shown in table 2 imerg sdlrr chirps sdlrr and tmpa sdlrr are models proposed in this paper the model inputs include spatial daily imerg chirps or tmpa spp of the previous 15 days three static catchment attributes and daily runoff data of previous 30 days total input dimensions include the data dimension of main input and auxiliary input spatial resolutions of imerg chirps and tmpa are 0 1 0 05 and 0 25 respectively therefore the dimensions of the main input covering the study area are n 15 65 51 1 n 15 129 102 1 and n 15 26 20 1 the dimensions of auxiliary input are n 33 all the other models in table 2 are adopted as benchmarks they have no spatiotemporal structure and lstm is the only core algorithm the series of baseline lstm models were tested with the average spps of the whole area considered namely the baseline models have the same rainfall input but without the spatial information they were the direct baseline to compare with the proposed deep learning model sdlrr in order to better evaluate the influence of the spps and the addition of catchment attribute features on the accuracy of runoff forecasting the comparison models also contain different input combinations among them imerg lstm i chirps lstm i tmpa lstm i models ignore catchment attributes while imerg lstm ii chirps lstm ii tmpa lstm ii models consider catchment attributes the remaining lstm is a baseline model without using spps and the daily runoff data of the previous 30 days are the only input based on these models the forecast accuracy was studied and the estimate accuracy of spps was also evaluated through the analysis of the error statistics of the listed models the characteristics and advantages of the models proposed in this paper can be discussed fully and comprehensively 4 1 runoff forecasting results fig 4 shows the runoff forecast results of the four stations of ldx ws xhb and bb in the jialing river basin fig 5 a is for ldx b is for ws c is for xhb and d is for bb each sub figure shows ten forecasted runoff series and one measured runoff series the abscissa represents the runoff value and the ordinate represents the date from november 23 2011 to december 31 2015 covering about 4 flood seasons and 5 dry seasons it can be seen from the figure that in the four hydrological stations floods of ldx ws and bb are intensive while runoff series of xhb have lower flood frequency and smaller flood peak there is a strong correlation between the predicted runoff and the actual runoff for all of the ten models the fluctuation characteristic and runoff peak of the predicted runoff series are very close to the measured runoff series the developed comparative models as well as the sdlrr model can effectively predict the daily runoff 4 2 error statistics on runoff forecasts in this part the accuracy evaluation indicators of rmse and r2 are used to quantitatively analyze the runoff prediction performance of the sdlrr model rmse can evaluate the runoff prediction performance in the same hydrological station and r2 can evaluate the model prediction performance of different stations table 3 shows the statistical errors of forecast results including r2 r2 improvement rmse rmse improvement and rank among them r2 improvement and rmse improvement refer to the improvement percentage of the prediction of the concerned model in the r2 and rmse statistics compared to the benchmark model lstm rank means the rank of models according to r2 and rmse and the model with the highest r2 and lowest rmse is set ① for ldx the best three models are imerg sdlrr imerg lstm ii and tmpa lstm ii compared to lstm benchmark imerg sdlrr improved 15 in terms of r2 and improved 25 in terms of rmse imerg lstm ii improved 10 and 15 in terms of r2 and rmse tmpa lstm ii improved 9 and 9 respectively compared to imerg lstm ii the best performance model among models using average spp as rainfall input merg sdlrr improved 5 in terms of r2 and improved 11 in terms of rmse for ws the best three models are imerg sdlrr chirps sdlrr and chirps lstm ii compared to lstm benchmark imerg sdlrr improved 9 in terms of r2 and improved 16 in terms of rmse chirps sdlrr improved 2 and 5 in terms of r2 and rmse chirps lstm ii improved 2 and 4 respectively compared to chirps lstm ii the best performance model among models using average spp as rainfall input merg sdlrr improved 7 in terms of r2 and improved 12 in terms of rmse for xhb the best three models are chirps lstm i chirps lstm ii and chirps sdlrr compared to lstm benchmark chirps lstm i improved 1 in terms of r2 and improved 3 in terms of rmse chirps lstm ii improved 1 in both r2 and rmse chirps sdlrr improved 2 in terms of r2 compared to ldx and ws runoff forecasts the improvement of xhb runoff forecasts is not obvious there are several reasons for this phenomenon on the one hand from the statistics of the runoff sequence the average runoff of the xhb is the smallest among the four stations and the variance is also the smallest the runoff does not have the characteristic of severe fluctuations therefore there may be less heavy rain in this area the model proposed in this paper mainly improves the forecast accuracy by excavating the spatiotemporal characteristics of rainfall and runoff so the effect is limited in areas with little rainfall on the other hand the watershed of xhb has a narrow and elongated shape which differs greatly from the rectangular shape of other watersheds the input of the proposed model is matrix data so it is more suitable for mining rectangular space the mismatch between the watershed shape and matrix input is the reason why the proposed model does not improve the xhb runoff forecasts as much as other watersheds for bb the best three models are imerg sdlrr tmpa lstm ii and tmpa lstm i compared to lstm benchmark imerg sdlrr improved 7 in terms of r2 and improved 30 in terms of rmse tmpa lstm ii improved 6 and 24 in terms of r2 and rmse tmpa lstm i improved 5 and 22 in r2 and rmse compared to tmpa lstm ii the best performance model among models using average spp as rainfall input merg sdlrr improved 1 in terms of r2 and improved 8 in terms of rmse it indicates that the developed sdlrr model with spatial imerg spp achieves excellent performance in runoff forecasts utilization of imerg tmpa and chirps contributes to rainfall runoff forecasts and imerg has a better spatial representation than tmpa or chirps the models include catchment attributes in predictors are better than those without catchment attributes 4 3 error statistics on extreme flood forecasts in this part the relative forecasting errors of extreme flood events are further analyzed to evaluate the performance of the developed models in extreme runoff ranges the top five flood events in each hydrological station were extracted and analyzed as shown in fig 5 fig 5 a b c and d illustrated the relative error histogram of extreme flood forecasts for ldx ws xhb and bb respectively for ldx the top five flood events are on 2014 9 14 2012 9 3 2013 7 21 2015 6 25 and 2012 7 6 it shows that imerg sdlrr imerg sdlrr tmpa lstm ii imerg sdlrr and imerg sdlrr are the best models for the above five flood events respectively on average imerg sdlrr is the best model for ldx extreme flood forecasting for ws the top five flood events are floods on the day of 2013 7 19 2013 7 23 2012 9 2 2012 7 10 and 2012 7 9 it shows that imerg lstm i imerg lstm i imerg lstm i imerg lstm ii and tmpa lstm ii are the best models for the above five flood events respectively on average imerg lstm i is the best model for ws extreme flood forecasting for xhb the forecast errors of extreme floods are all large showing the shortcomings of several models in forecasting extreme floods in this area for bb the top five flood events are on 2012 7 6 2012 9 3 2012 7 10 2013 7 20 and 2013 7 21 it shows that imerg sdlrr tmpa lstm ii tmpa lstm i imerg sdlrr and tmpa lstm i are the best models for the above five flood events respectively on average imerg sdlrr is the best model for extreme flood forecasting the addition of spps contributes to the improvement of extreme flood forecasts two metrics the mean relative error mre and the qualified rate qr are used to further demonstrate the superiority of the developed sdlrr model in extreme flood forecasts as shown in table 4 mre is the mean of the relative errors of the five extreme floods for each model qr indicates the proportion of qualified flood forecasts when the relative error of a flood forecast is less than 30 it is considered a qualified forecast for ldx imerg sdlrr achieved the lowest mre of 0 05 and the highest qr of 100 for ws imerg lstm i achieved the lowest mre of 0 11 and the highest qr of 100 for xhb the lowest mre is 0 57 and the highest qr is 40 for bb imerg sdlrr achieved the lowest mre of 0 12 and the highest qr of 93 for ldx imerg sdlrr greatly improved the performance compared to the benchmark lstm by decreasing mre by 0 28 and increasing qr by 40 compared to the best model using averaged spps as rainfall input namely tmpa lstm ii imerg sdlrr improved the performance by decreasing mre by 0 14 and increasing qr by 20 for bb imerg sdlrr greatly improved the performance compared to benchmark lstm by decreasing mre by 0 27 and increasing qr by 60 compared to the best performance model using averaged spps as rainfall input namely tmpa lstm ii imerg sdlrr improved the performance by increasing qr by 20 on average for four hydrological stations imerg sdlrr achieved the lowest mre of 0 12 and the largest qr of 93 it decreased mre by 0 29 and increased qr by 53 compared to lstm and decreased mre by 0 08 and increased qr by 6 compared to the best performance model using averaged spps as rainfall input namely imerg lstm i 5 discussion 5 1 consistency analysis of spps estimates error statistics of runoff forecasts in the entire basin show that the best three models are imerg sdlrr tmpa lstm ii and tmpa lstm i it reflects that imerg and tmpa provide better estimates of regional precipitation the accuracy of regional spps was evaluated to verify the performance and benefit of spps in runoff forecasts here bias was used for the point to point comparison of estimated daily satellite precipitation estimation data and rain gauge data during the evaluation period of 15 years from 2001 to 2015 fig 6 shows the spatial bias distribution of imerg tmpa and chiprs imerg and tmpa estimates are better than chirps estimates for lower absolute bias on average chirps underestimates the rain gauge precipitation in the east and overestimates the rain gauge precipitation in the west and north in general the accuracy evaluation of spps based on bias method is consistent with the results of spatiotemporal rainfall runoff forecasting method fig 7 shows the error statistics of tmpa data in different magnitudes and altitudes precipitation intensity is divided into light rain 0 1 mm 10 mm moderate rain 10 mm 25 mm heavy rain 25 mm 50 mm and extremely heavy rain 50 mm altitudes are classified into low altitude 0 1000 m moderate altitude 1000 m 2000 m and high altitude greater than 2000 m it can be seen that the pod shows a downward trend with the increase of precipitation intensity the far values fluctuate with the increase of precipitation intensity judging from the dr with the increase of precipitation intensity the value of the dr gradually decreases from dr 1 to dr 1 which means that the tmpa data mainly overestimate low intensity precipitation and underestimate heavy rain and extremely heavy rain it is found that the accuracy of spps estimates is mainly affected by precipitation intensity rather than altitude for runoff forecasts accuracy r2 of the runoff forecasts is also not affected by average altitudes as dem of ldx ws and xhd sub basins are 730 m 1626 m and 1025 m and accuracy r2 of ldx and ws are better than that of xhd the shape of the jialing river basin ldx sub basin and ws sub basin tend to be fan shaped while the shape of the xhb sub basin is small and narrow it is hard to utilize spatial precipitation and provide useful information for runoff forecasts in a small and narrow area 5 2 uncertainty of spps estimates rainfall is affected by various factors such as basin topography geographic location and atmospheric movement and has spatial and temporal variability the premise of using spps for hydrological research such as runoff forecasting is that the data product has a high accuracy however despite the fine spatial and temporal resolution the current global spps are subject to a certain degree of error worqlul et al 2018 in particular real time precipitation products without ground data correction and post processing can have relative systematic deviations of more than 100 percent abera et al 2016 when these satellite precipitation products are used as the initial input to drive the rainfall runoff process the input uncertainty caused by the error will seriously affect the accuracy of hydrological simulation even for the latest generation of gpm satellite precipitation grade 3 products imerg the errors contained in it are generally higher than the corresponding surface station errors xu et al 2017 therefore in order to overcome the disadvantage of large systematic error of the original spe it is necessary to preprocess the original satellite remote sensing precipitation products such as correcting the bias or error to improve the accuracy of the precipitation data and its driven hydrological simulation for the spps adopted in this paper chirps incorporates in house climatology chpclim 0 05 resolution satellite imagery and in situ station data to create gridded rainfall time series in the processing of imerg final more sensor data sources were introduced including the introduction of global rainfall stations for correction the tmpa is designed to combine precipitation estimates from various satellite systems and where possible land surface precipitation gauge analyses chirps imerg f tmpa are bias corrected spps although the uncertainty cannot be completely eliminated the runoff forecasting results show that the utilization of imerg tmpa and chirps contributes to rainfall runoff forecasts and imerg has a better spatial representation in the jrb than tmpa or chirps 5 3 comparison with previous studies developing reliable hydrological prediction models remains a challenging task in water resource management kaya et al 2017 there is much recent literature on case studies of machine learning ml techniques for hydrological forecasting hybridization data decomposition algorithm ensemble and model optimization are reported as the most effective strategies and the major trends for the improvement of ml methods mosavi et al 2018 ① hybrid models generalized structure group method of data handling gs gmdh adaptive neuro fuzzy inference system with fuzzy c means anfis fcm ebtehaj et al 2021 were proposed to predict the daily runoff and water level hybrid models outperformed the standalone models in these studies ② data decomposition or data preprocessing moving average ma singular spectrum analysis ssa and preprocessing methods were used to divide the training data into three crisp subsets of low medium and high level wu chau 2013 ③ algorithm ensemble or prediction interval pi estimation traditional techniques for ann based pi estimation lower upper bound estimation lube methods and multi objective optimization algorithms were proposed for the estimation of prediction intervals pis taormina chau 2015 ④ the last but the most important model optimization problem analysis data collection and preprocessing data driven model selection and evaluation of the selected models are the fundamental steps of ml based hydrological prediction models the most important of these steps is data driven model identification as this is where the learning process is performed and features are extracted researchers aim at discovering more accurate and efficient prediction models mosavi et al 2018 through introducing novel ml methods lstm is considered to be one of the best models for streamflow prediction using historical data in recent years lstm model showed good ability to capture data features in the rapidly fluctuant streamflow data in the previous study fu et al 2020 this paper challenges this most important and difficult task by constructing a new large scale spatiotemporal deep learning rainfall runoff model compared to the state of the art lstm developed for runoff forecasting in the jrb the performance of the proposed model improved 15 in terms of r2 and improved 25 in terms of rmse in ldx station in addition the model prediction results show that the proposed model is more reliable in extreme flood prediction the spatiotemporal feature extraction and learning of the proposed model directly improve the rainfall runoff prediction accuracy 6 conclusion the capture and learning of spatial patterns in rainfall runoff modeling is of great significance to improve the runoff forecasting accuracy the existing researches have not yet accurately involved the spatiotemporal rainfall runoff forecasting based on the architecture of deep learning in addition the lack of spatial information specific to spps is a major loss in spatiotemporal rainfall runoff forecasting studies therefore this study developed a large scale sdlrr forecasting model in the uyr and evaluated the positive impact of utilizing the spatial information of three spps on reducing errors of runoff forecasts which is rarely studied and discussed in runoff prediction based on deep learning it was demonstrated that sdlrr improves the accuracy of runoff forecasting compared with benchmark models that are incapable of capturing and learning spatial patterns in rainfall runoff modeling the sdlrr model developed using spatial imerg spp achieved the best performance in runoff forecasts taking ldx as an example compared to the best performance model among models that cannot capture spatial information in rainfall runoff modeling the proposed imerg sdlrr model improved 5 in terms of r2 and improved 11 in terms of rmse sdlrr has also achieved good performance at the other hydrological stations it also proves the superiority of the proposed sdlrr model in extreme flood forecasts on average for the four hydrological stations imerg sdlrr achieved the lowest mre of 0 12 and the largest qr of 93 for extreme flood forecasts it decreased mre by 0 29 and increased qr by 53 compared to lstm and decreased mre by 0 08 and increased qr by 6 compared to the best performance model that cannot capture spatial information in rainfall runoff modeling the advantage of the proposed sdlrr model lies in capturing and learning spatial patterns in rainfall runoff modeling for improving the runoff forecasting accuracy it uses spps and deep learning architecture to solve previously undiscussed spatiotemporal rainfall runoff prediction problems as for the limitation of the proposed sdlrr model the performance improvement in long and narrow watersheds is not as good as watersheds tend to be rectangular due to the mismatch between the watershed shape and matrix input because of the difficulty in improving the model suitable for the irregular watershed it should be further studied in the future work funding sources this work was supported by the hubei key laboratory of intelligent yangtze and hydroelectric science grant no zh20020001 credit authorship contribution statement shuang zhu conceptualization methodology writing original draft jianan wei data curation hairong zhang validation investigation yang xu supervision hui qin writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
2592,groundwater contamination at the site has become a very serious problem a clear understanding of the hydrogeochemical characteristics of groundwater is indispensable for pollution remediation it requires taking a number of samples and continuous monitoring however it is challenging to interpret hydrogeochemical datasets with diverse compositions and wide range of concentration by linear method in this work combination of self organizing map som and k means clustering was applied to investigate the hydrogeochemical characteristics at a contaminated site the results showed that shallow groundwater hydrogeochemical characteristics were performed by 42 neurons and were classified into 5 clusters the no3 in cluster 1 widely distributed in the site the application of fertilizers led to high no3 concentration in groundwater cluster 2 was dominated by ca2 mg2 cr ⅵ and no2 and cluster 3 was characterized by tds na cl hco3 and so4 2 pollutants were mainly from the migration of components at the chromium slag heap under the effect of convection and dispersion cluster 4 was dominated by ph as and co3 2 furthermore the ph with the minimum of 8 3 and the presence of co3 2 in groundwater provided a favorable opportunity for arsenic enrichment pollutants in cluster 4 originated from rainfall leaching on the chromium slag moreover the migration of components from cluster 4 to cluster 2 was also observed by som and numerical simulation cluster 5 was mainly dominated by mn and fe reduced environment and anthropogenic activities caused fe and mn to exceed standards the deep groundwater characteristics were performed using 20 neurons and were identified into 4 clusters its contamination was due to the leakage of shallow groundwater finally the gibbs diagram and the saturation index method performed the chemistry control mechanisms of different clusters this study demonstrated that som could be used to interpret nonlinear and complex contamination datasets keywords self organizing map contaminated sites hydrogeochemical groups k means clustering pollution source identification data availability the authors do not have permission to share data 1 introduction groundwater is an indispensable freshwater resource for industrial activities agriculture and domestic drinking water due to its generally good quality and widespread occurrence cao et al 2013 gorelick and zheng 2015 however the sustainable use of groundwater is threatened by natural contamination and anthropogenic contamination especially with the development of large scale industrial activities and the adjustment of industrial structure the waste residues produced by chemical plants can be piled in the open and are drenched by rainwater and a large number of enterprises in china have been shut down or relocated which results in the number of industrial contamination sites exceeding 500 000 mengfang 2014 among them there are now nearly 26 abandoned chromate production plant sites and more than 40 chromium slag dumping ground wang et al 2020 it has become a constraint on the safe use of groundwater resources in many cities long term poor environmental safety management irregular discharge of industrial wastewater and metal slag deposits have led to a huge amount of contaminated sites and the groundwater in and around the sites is highly contaminated khosravi et al 2021 with leaky recharge being one of the contamination pathways miao et al 2020 it has become a serious problem affecting human health and lives in many countries and regions gil díaz et al 2019 therefore it is urgent to carry out contaminated sites survey and assess the hydrogeochemical status of groundwater and the effects of anthropogenic contamination choi et al 2014 conducting investigation and assessment in a contaminated site often require preliminary and detailed investigation work spatially dense and frequent sampling and automatic monitoring will yield a large amount of groundwater contamination datasets with abundant samples multiple compositions and complex data structure which implies a lot of complicated relationships and poses challenges to linear hydrogeological evaluation method and visualization techniques choi et al 2014 hydrogeochemical evaluation strongly require methods that can analyze multidimensional groundwater quality datasets and perform distinct visualization for decision making haselbeck et al 2019 therefore multivariate analysis methods such as dimensionality reduction clustering supervised and unsupervised learning are widely used in the evaluation and classification of complex hydrogeochemical data among multivariate analysis methods principal component analysis pca factor analysis fa and hierarchical cluster analysis hca are widely used dimensionality reduction methods in water quality studies gómez et al 2008 güler et al 2002 kim et al 2017 kim et al 2020 kim et al 2009 laaksoharju et al 2008 lee et al 2019 tanasković et al 2012 these methods can reduce dimensionality and visualize the results into a low dimensional space however due to the inherent complexity of contaminated data linear data analysis methods have major limitations in application for example pca cannot handle nonlinear and complicated datasets and large numbers of contaminated samples may not meet the prerequisites kaiser meyer olkin metrics and bartlett sphericity inspection for using the method text s1 meanwhile pca is not well suited for classifying and monitoring similar groups in the data structure astel et al 2007 haselbeck et al 2019 unglert et al 2016 furthermore fa and pca can lead to misinterpretation when dealing with massive data with non linear relationships among variables choi et al 2014 giraudel and lek 2001 lee et al 2019 it is well known that the piper diagram is a traditional method of hydrogeochemical faces analysis the piper diagram piper 1944 shows the data distribution of eight major ions and provides a powerful tool for the classification of hydrogeochemical data haselbeck et al 2019 based on the groundwater samples hydrogeochemical faces can be derived and visualized in addition water mixing processes and groundwater chemistry evaluation can be determined such as ion exchange carbonate dissolution and redox processes haselbeck et al 2019 however it has obvious defects that there are no clear boundaries between different classifications haselbeck et al 2019 moreover piper diagram does not clearly distinguish between different hydrogeochemical faces haselbeck et al 2019 in piper diagram cations of na and k as well as anions of hco3 and co3 2 are plotted as their sum values rather than treated separately nguyen et al 2015a in our earlier studies the hydrogeochemical characteristics of groundwater in the shallow and deep aquifers were investigated by analyzing the physiochemical data using piper diagram chen et al 2021 it also demonstrated that na and no3 were major contamination factors and that co3 2 had a spatial heterogeneity in aquifer so the piper diagram was not a robust tool for hydrogeochemical assessment in the contaminated site with the improvement of computing power artificial neural networks have been used to dig up the internal connections of various kinds of data and are considered to be reliable and inexpensive methods of data interpretation and prediction olawoyin et al 2013 it has generated a great deal of interest in water quality assessment som is an example of neural networks that can be applied to cluster and visualize complex and nonlinear datasets with different characteristics lischeid 2009 nourani et al 2017 wu and chow 2004 in recent years som has been gradually implemented in the processing of multivariate data generated from various environmental monitoring projects such as prediction of hydrological processes assessment of surface water quality and groundwater quality regionalization of hydrological model parameters and the study of ecological communities chen et al 2017 dai et al 2018 garcia and gonzalez 2004 jampani et al 2018 kalteh et al 2008 lee et al 2019 melo et al 2019 nguyen et al 2015a nguyen et al 2015b shieh and liao 2012 underwood et al 2017 wunsch et al 2018 by integrating ecotoxicological variables it can help to identify spatial patterns and pollution sources in contaminated areas and distinguish different characteristics olawoyin et al 2013 however there are few applications in the classification and analysis of groundwater quality datasets at site scale by som this appears to be a good opportunity to analyze hydrogeochemical characteristics because the site groundwater environment is altered by soil environment and rainfall leaching in the contaminated site in addition the use of som can provide comprehensive explanations for assessing contamination levels and analyzing the migration process of pollutants which are essential for prioritizing management measures needed for site remediation melo et al 2019 olawoyin et al 2013 som has become a clustering method however similar units of som should be grouped in order to facilitate the quantitative analysis of mapping relationships haselbeck et al 2019 the k means clustering method is a common method in pattern recognition which can be applied to perform transition boundary and appropriate number of classifications for som results nguyen et al 2015a zhu et al 2020 to investigate the hydrogeochemical characteristics of groundwater it is significant for a robust classification scheme to cluster groundwater samples into homogeneous groups by chemical similarities nguyen et al 2015b in this paper we used som combined with the k means clustering algorithm to identify the pollution sources and assess the groundwater quality at a contaminated site the site was a legacy chromium salt chemical plant in xinxiang city henan province and deep groundwater pollution by leaky recharge from shallow groundwater has been found at the site meanwhile the hydrogeochemical processes of each cluster were investigated the hydrogeochemical characteristics of different clusters were elucidated by gibbs diagram and saturation index method the results of this study demonstrated that the som method was an effective tool for processing hydrogeochemical data from contaminated sites furthermore som could help managers to develop better groundwater remediation measures and conservation policies at sites 2 materials and methods 2 1 study area the study area is located at the northwestern part of xinxiang city henan province xinxiang is located in the middle and lower reaches of the yellow river with 170 km of the yellow river in its territory and has a watershed area of 4 558 square kilometers the plain area of xinxiang city accounts for 78 of the total area the regional landform is divided into three types including alluvial valley alluvial sloping plains and alluvial plains the geomorphological type of the study area is alluvial sloping plain the average annual temperature is approximate 14 and the annual average precipitation is 586 32 mm the annual average evaporation is 1772 62 mm which is three to four times more than precipitation and the strongest evaporation is in june chen et al 2021 according to the property of the aquifer media the groundwater is divided into three types including carbonate rock fracture karst water clastic rock fracture pore water and loose rock pore water this study mainly focuses on loose rock pore water the aquifer is mainly recharged by atmospheric precipitation and lateral inflow and groundwater discharge includes evaporation and lateral outflow according to the cross section fig 2 it can be seen that the lithology from the depth of 56 m to 49 m is silty clay and silt this is followed by a shallow aquifer with a thickness of 3 m however the thickness of aquifer increases significantly at borehole s22 the lithology from 46 m to 36 m is mainly silty clay chen et al 2021 the bottom lithology is fine sand and powdered sand meanwhile the pollution conceptual model illustrates the sources of contaminants in and around the site and the migration process of pollutants chen et al 2021 it includes the contamination process of chromium sludge under rainfall leaching and the contamination pathway of chemical fertilizers in agricultural fields the chromate production plant was established in 1993 and was completely shut down in 1995 its main products include sodium dichromate chromic anhydride and chrome aluminum tanning agent this plant adopts calcium roasting method fig s3 to produce sodium dichromate including the sodium chromate production and the transformation of sodium dichromate as a result chromium slag was left at the site the chromium slags generated during the production process have been removed and subjected to stabilization from 2004 to 2011 chromium slag causes serious contamination to the soil and groundwater in the site chen et al 2021 inhalation ingestion and dermal exposure to hexavalent chromium can lead to severe adverse health effects to humans and animals inclusive of respiratory and non respiratory cancers guo et al 2020 hausladen et al 2018 the results show that the mean concentration of total chromium in the soil was 12 100 mg kg and projection has been carried out to remediate the site soil and groundwater in 2017 permeable reactive barrier prb technology was applied to remediate contaminated groundwater 2 2 samples collection and analysis in december 2020 field investigation and sampling were conducted in the study area 104 sets of groundwater samples were collected including 73 sets of shallow groundwater samples and 31 sets of deep groundwater samples and the locations of the sampling sites were shown in fig 1 samples were collected using a peristaltic pump and were filtered through 0 45 um membrane into high density polypropylene bottles samples used for cation analysis were acidified with nitric acid reagent the ec orp do temperature and ph values were measured in the field using a multiparameter tester all samples were stored in a thermostat at a temperature of 4 c and placed in a refrigerator immediately upon returning to the laboratory the samples were determined in the laboratory of the henan province rock and mineral testing center the major anions so4 2 cl no3 were analyzed by ion chromatography ics 2000 the alkalinity was measured using the titrimetric method cations were performed by inductively coupled plasma mass spectrometry the sample collection storage and analysis procedures were strictly in accordance with the national standards recommended by the ministry of ecology and environment of china parallel samples analysis was used to control the accuracy of samples the charge balance error of all samples was within 5 which meant that the accuracy of each index met the quality requirements 2 3 self organizing map and k means clustering algorithms 2 3 1 self organizing map som som is a competitive learning type of unsupervised artificial neural network model proposed by kohonen a finnish scholar kohonen 2012 it uses unsupervised training to map high dimensional input data to a low dimensional space preserving the topology of the input data in the high dimensional space during the training process as shown in fig 3 in other words som can simultaneously perform two functions of data downscaling and displaying similarity nguyen et al 2015b therefore it is widely used in data visualization and exploration of data properties the output layer neurons in the som network are arranged in a matrix in a two dimensional space and each neuron has a weight vector connected to it after receiving a training sample each output layer neuron calculates the distance between that sample and the weight vector it carried and the neuron with the closest distance becomes the competition winner which is called the best matching unit bmu the quantization error qe and topographic error te are used to control the quality of the som zhu et al 2020 the qe represents the mean distance between each input vector and the bmu the te indicates the ratio of input vectors for which the first and second bmus are not adjacent dai et al 2018 then the weight vectors of the bmu and its neighboring neurons will be readjusted to reduce the distance between the weight vectors and the current sample and this process is iterated until convergence vesanto and alhoniemi 2000 som toolkits are available in matlab melo et al 2019 r haselbeck et al 2019 and python hao et al 2021 in this study the som toolbox in matlab was used to analyze the hydrogeochemical data 2 3 2 k means clustering algorithms the k means algorithm which belongs to the partitional clustering methods is commonly used method for the som when using the k means algorithm the optimal number of clusters is determined by the davies bouldin index dbi which takes values between 2 and the total number of nodes nguyen et al 2015a dbi calculation is based on the similarity within a cluster and dissimilarity between clusters thus the number of clusters showing the minimum dbi is optimal for the som the k means clustering is a popular clustering algorithm in the field of data mining likas et al 2002 the step is to preselect k objects randomly as the initial cluster centers and then calculates the distance between each object and each cluster center next assign each object to the nearest cluster center the cluster center and its assigned objects represent a cluster once all objects are assigned the center of each cluster is recalculated based on the existing objects in the cluster this process is repeated until the cluster centers no longer change nguyen et al 2015a 2 4 groundwater movement modules modflow is used to describe the groundwater movement process it is a three dimensional block centered finite difference groundwater model developed by usgs and is the most widely used computer code for groundwater modeling layers can be simulated as confined or unconfined flow associated with external stresses such as wells areal recharge evapotranspiration drains and river also can be simulated the three dimensional movement of groundwater of constant density through porous earth material may be described by the partial differential equation x k xx h x y k yy h y z k zz h z w s s h t where k xx k yy k zz are values of hydraulic conductivity along the x y and z coordinate axes which are assumed to be parallel to the major axes of hydraulic conductivity l t h is the potentiometric head l w is a volumetric flux per unit volume representing sources and or sinks of water with w 0 for flow out of the groundwater system and w 0 for flow into the system t 1 s s is the specific storage of the porous material l 1 and t is time t 2 5 saturation index saturation index si is significant for assessing the equilibrium and reactivity between minerals and groundwater in si calculations the ratio of activity product to solubility product is used to assess the hydrogeochemical state and reaction process of groundwater a given mineral with si 0 indicates oversaturation where precipitation will occur in groundwater while si 0 indicates unsaturation and that dissolution of the mineral will occur in this study phreeqc was used to calculate and evaluate the si values of the minerals in the aquifer 3 results and discussion 3 1 som and clustering results using component planes by applying the som to normalized hydrogeochemical datasets 42 output neurons were obtained for shallow groundwater and the architecture with 7 6 neurons was considered to be the most informative and yielded the best distribution of the data for deep groundwater the architecture of 5 4 neurons were considered to be the most informative and yielded the best distribution of the data the main contaminants in shallow groundwater and deep groundwater of the area were cr vi so4 2 cl no2 no3 nh4 na fe and mn according to the class iii water standard of the groundwater quality standard as and pb exceeded the class iii water standard in shallow groundwater and did not exceed the class iii water standard in deep groundwater fig 4 shows the mapping plots of the som for different components obtained after training each plot represents the component values of the reference vector of the som nodes nodes representing high values were in yellow and low values were in blue the som maps were sorted by similarity each component corresponded to one map where the color gradient could be used to identify the correlation between pollution components the same or similar color indicated a positive correlation and the higher the similarity the stronger the correlation through the visualization of som mapping from shallow groundwater there were good correlations among tds na hco3 so4 2 and cl it exhibited good correlations among cr vi total hardness th ca2 mg2 and no2 it presented good correlations among fe mn pb nh4 and k there were good correlations among ph as and co3 2 it was worth noting that no3 existed independently and was not related to any ions see fig 4 through the visualization of som mapping from deep groundwater there were good correlations among tds na cr vi hco3 so4 2 nh4 and k it showed good correlations among th ca2 mg2 no2 and no3 fe and mn had a certain correlation finally ph could be classified into one cluster see fig 5 to select the best number of clusters the dbi value was used to make the determination by k means clustering algorithm the dbi was calculated for the number of clusters and the dbi was relatively low when the number of clusters was 5 for shallow groundwater the dbi was relatively low when the number of clusters was 4 for deep groundwater according to the mapping diagram the clustering results could be corresponded to the specific pollution components each cluster contained at least one pollution component with much higher ion concentration than the others from the results it was clear that each cluster at the site included contamination components the considerable positive correlation indicated that pollutants might have similar source characteristics 3 2 basic characteristics of each cluster 3 2 1 basic characteristics of each cluster of shallow groundwater to characterize the features of the categorical data box plots of the main ions were drawn as shown in fig 6 the concentration of mn fe nh4 pb and k in the fifth cluster was significantly higher than the first cluster meanwhile the first cluster had similarities with the fifth cluster the concentration of na and so4 2 was lower than those of the other three clusters and the concentration of no3 was higher than the other three clusters on one hand the main reason was that the site was closed for management after 2000 and agricultural activities were not allowed in the site while agricultural cultivation existed around the site and the application of fertilizers and pesticides led to higher no3 concentration on the other hand groundwater seepage in the site was slow and the high so4 2 and na concentration of groundwater below the chromium slag pile had relatively little impact on the groundwater around the site in the second third and fourth clusters the concentration of so4 2 and na was higher while the concentration distributions of ca2 mg2 fe and mn were similar in particular in the second cluster the mean value of so4 2 concentration was the largest with a value of 1158 6 mg l meanwhile the cr vi concentration was the highest with a mean value of 150 6 mg l and the mean concentration of ca2 and mg2 was the highest in the third cluster the mean concentration of cl was the largest with a value of 265 7 mg l in the fourth cluster the concentration of co3 2 and as was significantly high table s5 3 2 2 basic characteristics of each cluster of deep groundwater the characterization in deep groundwater is shown in the following table 1 in the first cluster the mean concentration of fe and mn was the highest and the mean concentration of tds so4 2 cr vi no3 ca2 and mg2 was the lowest the mean concentration of so4 2 na tds and cr vi in the second cluster was significantly higher than those in the other clusters the mean concentration of no3 no2 ca2 and mg2 was the highest in the third cluster in the fourth cluster the concentration of na was the lowest 3 3 analysis of contamination compositions for each cluster 3 3 1 analysis of pollution compositions of shallow groundwater by characterizing the dominant components of each group the origins and migration processes of the contaminants in each cluster were investigated fig 7 for shallow groundwater the distribution of sampling points in each cluster is shown in fig 1 the first cluster brown was dominated by no3 and the occurrence was not restricted to one individual area the cluster appeared to be widely distributed over the entire area furthermore the correlation with other ions was low indicating that the source of no3 was different from the source of other contaminants during the hydrogeological survey it was found that there was a large area of agricultural land around the site fig s4 the application of pesticides and fertilizers led to high no3 concentration in groundwater of the whole area the second cluster pink contained th ca2 mg2 cr vi and no2 the value of th all exceeded 450 mg l on one hand gypsum was constantly dissolving according to saturation index on the other hand it was clear that the main chemical composition of the chromium slag contained 2 to 35 calcium oxide and 15 to 33 magnesium oxide from the test results table s6 ions entered the groundwater under rainfall leaching and migrated downstream along groundwater flow paths therefore pollutants were mainly from the migration of components at the chromium slag heap under the effect of convection and dispersion the third cluster purple was characterized by high tds na cl hco3 and so4 2 and the correlation among tds na cl and so4 2 was very high compositions migrated downstream under the effect of convection and dispersion as shown in the distribution map of sampling points fig 1 the samples contained in the second third and fourth clusters were distributed around the former chromium slag pile and production plant the concentration of na and so4 2 in groundwater below the chromium slag pile was high due to anthropogenic activities and na and so4 2 have strong mobility therefore the concentration of na and so4 2 in these samples was high and far exceeded the class iii groundwater quality standards the fourth cluster blue contained as co3 2 and ph these sample points were mainly from the aquifer beneath the chromium slag heap therefore pollutants originated from rainfall leaching on the chromium slag the ph of these samples was greater than 8 3 which represented an alkaline environment moreover this was reinforced by the presence of co3 2 in groundwater more noteworthy was the relatively high concentration of as in these samples it was well known that high arsenic groundwater posed potential health risk to hundreds of millions of people due to its chronic poisoning effects guo et al 2019 guo et al 2016 qiao et al 2020 the chemical characteristics of as in groundwater were different from those of other heavy metals when the ph was high arsenic existed mostly in the form of arsenious acid and was not easily adsorbed by sediment meanwhile high ph reduced the positive charge of the sediment and promoted the desorption of arsenic from sediment to groundwater transitions of one cluster to another could be tracked using the som clustering approach in this research we also developed a three dimensional numerical model of groundwater using modflow software the inputs and outputs of the model are shown in the supplementary files text s4 and the average annual migration distance of pollutants by particle tracking was 17 5 m under convection through the distribution of the current pollution and numerical simulation this could demonstrate the migration of components from cluster 4 to cluster 2 such as na so4 2 and cr vi the mean concentration of na so4 2 and cr vi was higher in the cluster 2 than in the cluster 4 but the sampling points in the fourth cluster mainly distributed in the aquifer under the chromium slag pile the components in the groundwater beneath the chromium slag pile continuously migrated downstream with the groundwater flow in 2017 the state carried out the remediation of groundwater contamination at the site using prb technology the local permeability coefficient was changed and the more migratory components tended to accumulate at the second cluster the fifth cluster green was dominated by mn nh4 k fe and pb the high values of fe and mn mainly distributed in the downstream of the site with small hydraulic gradient it tended to form a reducing environment which was a good opportunity to lead to the enrichment of fe and mn in the downstream the concentration of pb in only two sampling points exceeded the drinking water standard and both points s34 and s42 were assigned to the fifth group which might be the result of anthropogenic activities the exceedance rate of fe and mn in shallow groundwater reached 70 and 74 respectively the main reasons were as follows firstly the water level of the site was high and the seepage conditions were poor thus the sediments were in a relatively anoxic conditions for a long time which provided a favorable environment for the enrichment of fe and mn secondly the input of anthropogenic contaminants led to changes in the acid base environment of groundwater it prompted the decomposition of organic matter under the action of microorganisms to produce reducing substances such as carbon dioxide and hydrogen sulfide which could reduce the high valent iron and manganese oxides to low valent iron and manganese soluble salts eventually leading to an increase in the iron and manganese content in groundwater 3 3 2 analysis of pollution compositions of deep groundwater for deep groundwater the distribution of sampling points in each cluster is shown in fig 1 the first cluster orange contained most of the sample points and the relevant components were fe and mn fig 8 the exceedance rates of fe and mn were 71 and 84 respectively the main reason was that fe and mn became reduced to more soluble and mobile form fe ii and mn ii under reducing conditions the content of fe and mn in deep groundwater was lower than that in shallow groundwater which demonstrated that anthropogenic contamination had less impact on deep groundwater the second cluster pink contained compositions such as tds na so4 2 and cr vi for the sampling points in the second cluster from deep groundwater samples for shallow groundwater were also taken at the same locations the analysis found that the content of each component in deep groundwater was significantly lower than that in shallow groundwater which suggested that leakage could occur in the aquifer the third cluster blue was dominated by th ca2 mg2 and no3 we also sampled in shallow groundwater at the same location the results showed that the concentration of each component in shallow groundwater was higher than that in deep groundwater the main reason was that the contamination of deep groundwater was caused by the leakage of shallow groundwater and regional flow the fourth cluster green was characterized by ph the ph was significantly higher than the samples in the rest of the clusters 3 4 groundwater chemistry control mechanisms gibbs diagram can be used to illustrate the genesis mechanism of the hydrogeochemical composition gibbs 1970 from the fig 9 it could be seen that the hydrogeochemical composition of the study area was mainly dominated by water rock interaction and evaporative crystallization the sampling points in the cluster 1 and cluster 5 were located in the water rock interaction region the sampling points in the cluster 2 cluster 3 and cluster 4 were located in the evaporation region it could be visualized that the value of na na ca2 in the groundwater of the study area was greater than 0 2 and the value of na na ca2 in cluster 4 was the highest the sampling points falling in the evaporation crystallization area were all from the aquifer around the chromium slag pile and the main chemical principles involved in the production of chromium salts were as follows 2na2cro4 h2so4 na2cr2o7 na2so4 h2o so the values of na na ca2 was high which also responded to the results that the concentration of tds and na was higher in these three clusters however the presence of evaporative crystallization was uncertain due to the influence of contamination the further analysis of the groundwater isotope data showed that evaporative crystallization existed zhihong et al 2017 3 5 saturation index analysis the saturation index si plays an important role in evaluating the equilibrium and reaction between minerals and groundwater zhu et al 2020 with the increase of tds the saturation index of gypsum tended to be more and more close to 0 which indicated that gypsum was continuously dissolving but the potential of dissolution was decreasing this was mainly due to the so4 2 in the aquifer below the chromium slag pile continuously migrating downstream from cluster 4 to cluster 2 moreover the prb remediation work was carried out at the site in 2017 which increased the permeability coefficient of the aquifer so the compositions migrated and accumulated in the second cluster this eventually led to the gypsum in cluster 2 gradually being in a saturated state the samples in cluster 1 and cluster 5 were less affected by the chromium slag pile therefore the solubility of gypsum was greater as tds rose the saturation index of halite gradually increased then tended to the steady state but dissolution was still occurring the concentration of na was high in cluster 2 due to anthropogenic activities therefore the si of cluster 2 was large the si results indicated the solubility of gypsum and halite in the cluster 2 cluster 3 and cluster 4 was less than the cluster 1 and cluster 5 the saturation index of calcite and dolomite showed the same trend and the saturation index of both did not change significantly with the increase of tds fig 10 4 conclusion in this study combination of som and k means clustering analysis was used to downscale and cluster the hydrogeochemical data of the chromium contaminated site the hydrogeochemical characteristics and pollution sources of the site were investigated in addition the hydrogeochemical characteristics of each cluster were elucidated by gibbs plot and saturation index method the main conclusions drawn from this study were as follows the som provided clear and concise overview of the classification of hydrogeochemical data here the som was proven to be a robust and straightforward method to condense the information content of datasets at the contaminated site therefore som was an effective tool for groundwater quality evaluation at site scale in terms of the hydrogeochemical characteristics the som clustering approach succeeded in assigning the groundwater samples according to their chemical compositions together with hydrogeological information five clusters could be conclusively identified for shallow groundwater the first cluster was dominated by no3 and the range of spatial distribution was the most extensive it was found that the site was surrounded by large areas of farmland and the use of pesticides and fertilizers led to high nitrate concentration in the groundwater of the whole area from the distribution map of sampling points it could be seen that the samples contained in the second third and fourth clusters were distributed around the chromium slag pile the concentration of na and so4 2 in these samples was high due to anthropogenic activities especially for the second cluster the average concentration of cr vi ca2 and mg2 was the highest pollutants were mainly from the migration of components at the chromium slag heap under the effect of convection and dispersion the third cluster was characterized by tds na cl hco3 and so4 2 and these components migrated downstream under the effect of convection and dispersion the fourth cluster was dominated by as and co3 2 and sampling points were mainly from the aquifer beneath the chromium slag heap therefore pollutants originated from rainfall leaching on the chromium slag the ph of these samples was all greater than 8 3 which represented an alkaline environment this was reinforced by the presence of co3 2 in groundwater arsenic was more easily enriched under alkaline conditions meanwhile it could be found that na so4 2 and cr ⅵ migrated from cluster 4 to cluster 2 by som and numerical simulation the fifth cluster was dominated by mn and fe the long term anoxic groundwater conditions and the input of anthropogenic contamination led to the elevated fe and mn content in groundwater the deep groundwater samples could be grouped into four clusters and the hydrogeochemical characteristics of the corresponding clusters were similar to those of the shallow groundwater moreover the deep groundwater contamination was caused by the leakage of shallow groundwater the sampling points in the cluster 1 and cluster 5 were located in the water rock interaction region the sampling points in the cluster 2 cluster 3 and cluster 4 were located in the evaporation region and the value of na na ca2 in cluster 4 was the highest which also responded to the results that the concentration of tds and na was higher in these three clusters due to anthropogenic activities further combined with the isotopic data evaporative crystallization was present with the increase of tds the gypsum was nearly saturated and the potential of dissolution of halite was decreasing as influenced by anthropogenic activities in particular the si of gypsum and halite in cluster 2 was high the si results indicated the solubility of gypsum and halite in the cluster 2 cluster 3 and cluster 4 was less than the cluster 1 and cluster 5 the saturation index of calcite and dolomite showed the same trend and the saturation index of both did not change significantly with the increase of tds 5 implications the concentration of so4 2 and no3 in the groundwater of the site is high by investigation it has demonstrated that so4 2 and no3 have an inhibitory effect on hexavalent chromium removal dong et al 2018 therefore the specific relationship between hexavalent chromium removal and the concentration of so4 2 and no3 in groundwater should be mastered when removing hexavalent chromium by reduction method xinxiang 7 19 extreme rainstorms flood the contaminated site the heaviest rain intensity in 1 h is 149 9 mm this can be an extreme rainstorm that only happens in a few hundred years it is suggested that the hydrogeochemical characteristics of soil and groundwater after continuous heavy rainfall should be studied this may be a gap for the variation of the hydrogeochemical characteristics of soil and groundwater following extreme rainstorm around the world it will be helpful to improve the soil and groundwater remediation measures at the site credit authorship contribution statement yaobin zhang writing original draft writing review editing qiulan zhang formal analysis writing review editing supervision wenfang chen investigation weiwei shi investigation yali cui formal analysis supervision leilei chen investigation jingli shao formal analysis supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research is supported by science and technology research project of henan provincial department of natural resources yu natural resources letter 2019 no 373 8 and national key r d program of china no 2019yfc1804801 furthermore we thank the reviewers for their helpful comments appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128839 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2592,groundwater contamination at the site has become a very serious problem a clear understanding of the hydrogeochemical characteristics of groundwater is indispensable for pollution remediation it requires taking a number of samples and continuous monitoring however it is challenging to interpret hydrogeochemical datasets with diverse compositions and wide range of concentration by linear method in this work combination of self organizing map som and k means clustering was applied to investigate the hydrogeochemical characteristics at a contaminated site the results showed that shallow groundwater hydrogeochemical characteristics were performed by 42 neurons and were classified into 5 clusters the no3 in cluster 1 widely distributed in the site the application of fertilizers led to high no3 concentration in groundwater cluster 2 was dominated by ca2 mg2 cr ⅵ and no2 and cluster 3 was characterized by tds na cl hco3 and so4 2 pollutants were mainly from the migration of components at the chromium slag heap under the effect of convection and dispersion cluster 4 was dominated by ph as and co3 2 furthermore the ph with the minimum of 8 3 and the presence of co3 2 in groundwater provided a favorable opportunity for arsenic enrichment pollutants in cluster 4 originated from rainfall leaching on the chromium slag moreover the migration of components from cluster 4 to cluster 2 was also observed by som and numerical simulation cluster 5 was mainly dominated by mn and fe reduced environment and anthropogenic activities caused fe and mn to exceed standards the deep groundwater characteristics were performed using 20 neurons and were identified into 4 clusters its contamination was due to the leakage of shallow groundwater finally the gibbs diagram and the saturation index method performed the chemistry control mechanisms of different clusters this study demonstrated that som could be used to interpret nonlinear and complex contamination datasets keywords self organizing map contaminated sites hydrogeochemical groups k means clustering pollution source identification data availability the authors do not have permission to share data 1 introduction groundwater is an indispensable freshwater resource for industrial activities agriculture and domestic drinking water due to its generally good quality and widespread occurrence cao et al 2013 gorelick and zheng 2015 however the sustainable use of groundwater is threatened by natural contamination and anthropogenic contamination especially with the development of large scale industrial activities and the adjustment of industrial structure the waste residues produced by chemical plants can be piled in the open and are drenched by rainwater and a large number of enterprises in china have been shut down or relocated which results in the number of industrial contamination sites exceeding 500 000 mengfang 2014 among them there are now nearly 26 abandoned chromate production plant sites and more than 40 chromium slag dumping ground wang et al 2020 it has become a constraint on the safe use of groundwater resources in many cities long term poor environmental safety management irregular discharge of industrial wastewater and metal slag deposits have led to a huge amount of contaminated sites and the groundwater in and around the sites is highly contaminated khosravi et al 2021 with leaky recharge being one of the contamination pathways miao et al 2020 it has become a serious problem affecting human health and lives in many countries and regions gil díaz et al 2019 therefore it is urgent to carry out contaminated sites survey and assess the hydrogeochemical status of groundwater and the effects of anthropogenic contamination choi et al 2014 conducting investigation and assessment in a contaminated site often require preliminary and detailed investigation work spatially dense and frequent sampling and automatic monitoring will yield a large amount of groundwater contamination datasets with abundant samples multiple compositions and complex data structure which implies a lot of complicated relationships and poses challenges to linear hydrogeological evaluation method and visualization techniques choi et al 2014 hydrogeochemical evaluation strongly require methods that can analyze multidimensional groundwater quality datasets and perform distinct visualization for decision making haselbeck et al 2019 therefore multivariate analysis methods such as dimensionality reduction clustering supervised and unsupervised learning are widely used in the evaluation and classification of complex hydrogeochemical data among multivariate analysis methods principal component analysis pca factor analysis fa and hierarchical cluster analysis hca are widely used dimensionality reduction methods in water quality studies gómez et al 2008 güler et al 2002 kim et al 2017 kim et al 2020 kim et al 2009 laaksoharju et al 2008 lee et al 2019 tanasković et al 2012 these methods can reduce dimensionality and visualize the results into a low dimensional space however due to the inherent complexity of contaminated data linear data analysis methods have major limitations in application for example pca cannot handle nonlinear and complicated datasets and large numbers of contaminated samples may not meet the prerequisites kaiser meyer olkin metrics and bartlett sphericity inspection for using the method text s1 meanwhile pca is not well suited for classifying and monitoring similar groups in the data structure astel et al 2007 haselbeck et al 2019 unglert et al 2016 furthermore fa and pca can lead to misinterpretation when dealing with massive data with non linear relationships among variables choi et al 2014 giraudel and lek 2001 lee et al 2019 it is well known that the piper diagram is a traditional method of hydrogeochemical faces analysis the piper diagram piper 1944 shows the data distribution of eight major ions and provides a powerful tool for the classification of hydrogeochemical data haselbeck et al 2019 based on the groundwater samples hydrogeochemical faces can be derived and visualized in addition water mixing processes and groundwater chemistry evaluation can be determined such as ion exchange carbonate dissolution and redox processes haselbeck et al 2019 however it has obvious defects that there are no clear boundaries between different classifications haselbeck et al 2019 moreover piper diagram does not clearly distinguish between different hydrogeochemical faces haselbeck et al 2019 in piper diagram cations of na and k as well as anions of hco3 and co3 2 are plotted as their sum values rather than treated separately nguyen et al 2015a in our earlier studies the hydrogeochemical characteristics of groundwater in the shallow and deep aquifers were investigated by analyzing the physiochemical data using piper diagram chen et al 2021 it also demonstrated that na and no3 were major contamination factors and that co3 2 had a spatial heterogeneity in aquifer so the piper diagram was not a robust tool for hydrogeochemical assessment in the contaminated site with the improvement of computing power artificial neural networks have been used to dig up the internal connections of various kinds of data and are considered to be reliable and inexpensive methods of data interpretation and prediction olawoyin et al 2013 it has generated a great deal of interest in water quality assessment som is an example of neural networks that can be applied to cluster and visualize complex and nonlinear datasets with different characteristics lischeid 2009 nourani et al 2017 wu and chow 2004 in recent years som has been gradually implemented in the processing of multivariate data generated from various environmental monitoring projects such as prediction of hydrological processes assessment of surface water quality and groundwater quality regionalization of hydrological model parameters and the study of ecological communities chen et al 2017 dai et al 2018 garcia and gonzalez 2004 jampani et al 2018 kalteh et al 2008 lee et al 2019 melo et al 2019 nguyen et al 2015a nguyen et al 2015b shieh and liao 2012 underwood et al 2017 wunsch et al 2018 by integrating ecotoxicological variables it can help to identify spatial patterns and pollution sources in contaminated areas and distinguish different characteristics olawoyin et al 2013 however there are few applications in the classification and analysis of groundwater quality datasets at site scale by som this appears to be a good opportunity to analyze hydrogeochemical characteristics because the site groundwater environment is altered by soil environment and rainfall leaching in the contaminated site in addition the use of som can provide comprehensive explanations for assessing contamination levels and analyzing the migration process of pollutants which are essential for prioritizing management measures needed for site remediation melo et al 2019 olawoyin et al 2013 som has become a clustering method however similar units of som should be grouped in order to facilitate the quantitative analysis of mapping relationships haselbeck et al 2019 the k means clustering method is a common method in pattern recognition which can be applied to perform transition boundary and appropriate number of classifications for som results nguyen et al 2015a zhu et al 2020 to investigate the hydrogeochemical characteristics of groundwater it is significant for a robust classification scheme to cluster groundwater samples into homogeneous groups by chemical similarities nguyen et al 2015b in this paper we used som combined with the k means clustering algorithm to identify the pollution sources and assess the groundwater quality at a contaminated site the site was a legacy chromium salt chemical plant in xinxiang city henan province and deep groundwater pollution by leaky recharge from shallow groundwater has been found at the site meanwhile the hydrogeochemical processes of each cluster were investigated the hydrogeochemical characteristics of different clusters were elucidated by gibbs diagram and saturation index method the results of this study demonstrated that the som method was an effective tool for processing hydrogeochemical data from contaminated sites furthermore som could help managers to develop better groundwater remediation measures and conservation policies at sites 2 materials and methods 2 1 study area the study area is located at the northwestern part of xinxiang city henan province xinxiang is located in the middle and lower reaches of the yellow river with 170 km of the yellow river in its territory and has a watershed area of 4 558 square kilometers the plain area of xinxiang city accounts for 78 of the total area the regional landform is divided into three types including alluvial valley alluvial sloping plains and alluvial plains the geomorphological type of the study area is alluvial sloping plain the average annual temperature is approximate 14 and the annual average precipitation is 586 32 mm the annual average evaporation is 1772 62 mm which is three to four times more than precipitation and the strongest evaporation is in june chen et al 2021 according to the property of the aquifer media the groundwater is divided into three types including carbonate rock fracture karst water clastic rock fracture pore water and loose rock pore water this study mainly focuses on loose rock pore water the aquifer is mainly recharged by atmospheric precipitation and lateral inflow and groundwater discharge includes evaporation and lateral outflow according to the cross section fig 2 it can be seen that the lithology from the depth of 56 m to 49 m is silty clay and silt this is followed by a shallow aquifer with a thickness of 3 m however the thickness of aquifer increases significantly at borehole s22 the lithology from 46 m to 36 m is mainly silty clay chen et al 2021 the bottom lithology is fine sand and powdered sand meanwhile the pollution conceptual model illustrates the sources of contaminants in and around the site and the migration process of pollutants chen et al 2021 it includes the contamination process of chromium sludge under rainfall leaching and the contamination pathway of chemical fertilizers in agricultural fields the chromate production plant was established in 1993 and was completely shut down in 1995 its main products include sodium dichromate chromic anhydride and chrome aluminum tanning agent this plant adopts calcium roasting method fig s3 to produce sodium dichromate including the sodium chromate production and the transformation of sodium dichromate as a result chromium slag was left at the site the chromium slags generated during the production process have been removed and subjected to stabilization from 2004 to 2011 chromium slag causes serious contamination to the soil and groundwater in the site chen et al 2021 inhalation ingestion and dermal exposure to hexavalent chromium can lead to severe adverse health effects to humans and animals inclusive of respiratory and non respiratory cancers guo et al 2020 hausladen et al 2018 the results show that the mean concentration of total chromium in the soil was 12 100 mg kg and projection has been carried out to remediate the site soil and groundwater in 2017 permeable reactive barrier prb technology was applied to remediate contaminated groundwater 2 2 samples collection and analysis in december 2020 field investigation and sampling were conducted in the study area 104 sets of groundwater samples were collected including 73 sets of shallow groundwater samples and 31 sets of deep groundwater samples and the locations of the sampling sites were shown in fig 1 samples were collected using a peristaltic pump and were filtered through 0 45 um membrane into high density polypropylene bottles samples used for cation analysis were acidified with nitric acid reagent the ec orp do temperature and ph values were measured in the field using a multiparameter tester all samples were stored in a thermostat at a temperature of 4 c and placed in a refrigerator immediately upon returning to the laboratory the samples were determined in the laboratory of the henan province rock and mineral testing center the major anions so4 2 cl no3 were analyzed by ion chromatography ics 2000 the alkalinity was measured using the titrimetric method cations were performed by inductively coupled plasma mass spectrometry the sample collection storage and analysis procedures were strictly in accordance with the national standards recommended by the ministry of ecology and environment of china parallel samples analysis was used to control the accuracy of samples the charge balance error of all samples was within 5 which meant that the accuracy of each index met the quality requirements 2 3 self organizing map and k means clustering algorithms 2 3 1 self organizing map som som is a competitive learning type of unsupervised artificial neural network model proposed by kohonen a finnish scholar kohonen 2012 it uses unsupervised training to map high dimensional input data to a low dimensional space preserving the topology of the input data in the high dimensional space during the training process as shown in fig 3 in other words som can simultaneously perform two functions of data downscaling and displaying similarity nguyen et al 2015b therefore it is widely used in data visualization and exploration of data properties the output layer neurons in the som network are arranged in a matrix in a two dimensional space and each neuron has a weight vector connected to it after receiving a training sample each output layer neuron calculates the distance between that sample and the weight vector it carried and the neuron with the closest distance becomes the competition winner which is called the best matching unit bmu the quantization error qe and topographic error te are used to control the quality of the som zhu et al 2020 the qe represents the mean distance between each input vector and the bmu the te indicates the ratio of input vectors for which the first and second bmus are not adjacent dai et al 2018 then the weight vectors of the bmu and its neighboring neurons will be readjusted to reduce the distance between the weight vectors and the current sample and this process is iterated until convergence vesanto and alhoniemi 2000 som toolkits are available in matlab melo et al 2019 r haselbeck et al 2019 and python hao et al 2021 in this study the som toolbox in matlab was used to analyze the hydrogeochemical data 2 3 2 k means clustering algorithms the k means algorithm which belongs to the partitional clustering methods is commonly used method for the som when using the k means algorithm the optimal number of clusters is determined by the davies bouldin index dbi which takes values between 2 and the total number of nodes nguyen et al 2015a dbi calculation is based on the similarity within a cluster and dissimilarity between clusters thus the number of clusters showing the minimum dbi is optimal for the som the k means clustering is a popular clustering algorithm in the field of data mining likas et al 2002 the step is to preselect k objects randomly as the initial cluster centers and then calculates the distance between each object and each cluster center next assign each object to the nearest cluster center the cluster center and its assigned objects represent a cluster once all objects are assigned the center of each cluster is recalculated based on the existing objects in the cluster this process is repeated until the cluster centers no longer change nguyen et al 2015a 2 4 groundwater movement modules modflow is used to describe the groundwater movement process it is a three dimensional block centered finite difference groundwater model developed by usgs and is the most widely used computer code for groundwater modeling layers can be simulated as confined or unconfined flow associated with external stresses such as wells areal recharge evapotranspiration drains and river also can be simulated the three dimensional movement of groundwater of constant density through porous earth material may be described by the partial differential equation x k xx h x y k yy h y z k zz h z w s s h t where k xx k yy k zz are values of hydraulic conductivity along the x y and z coordinate axes which are assumed to be parallel to the major axes of hydraulic conductivity l t h is the potentiometric head l w is a volumetric flux per unit volume representing sources and or sinks of water with w 0 for flow out of the groundwater system and w 0 for flow into the system t 1 s s is the specific storage of the porous material l 1 and t is time t 2 5 saturation index saturation index si is significant for assessing the equilibrium and reactivity between minerals and groundwater in si calculations the ratio of activity product to solubility product is used to assess the hydrogeochemical state and reaction process of groundwater a given mineral with si 0 indicates oversaturation where precipitation will occur in groundwater while si 0 indicates unsaturation and that dissolution of the mineral will occur in this study phreeqc was used to calculate and evaluate the si values of the minerals in the aquifer 3 results and discussion 3 1 som and clustering results using component planes by applying the som to normalized hydrogeochemical datasets 42 output neurons were obtained for shallow groundwater and the architecture with 7 6 neurons was considered to be the most informative and yielded the best distribution of the data for deep groundwater the architecture of 5 4 neurons were considered to be the most informative and yielded the best distribution of the data the main contaminants in shallow groundwater and deep groundwater of the area were cr vi so4 2 cl no2 no3 nh4 na fe and mn according to the class iii water standard of the groundwater quality standard as and pb exceeded the class iii water standard in shallow groundwater and did not exceed the class iii water standard in deep groundwater fig 4 shows the mapping plots of the som for different components obtained after training each plot represents the component values of the reference vector of the som nodes nodes representing high values were in yellow and low values were in blue the som maps were sorted by similarity each component corresponded to one map where the color gradient could be used to identify the correlation between pollution components the same or similar color indicated a positive correlation and the higher the similarity the stronger the correlation through the visualization of som mapping from shallow groundwater there were good correlations among tds na hco3 so4 2 and cl it exhibited good correlations among cr vi total hardness th ca2 mg2 and no2 it presented good correlations among fe mn pb nh4 and k there were good correlations among ph as and co3 2 it was worth noting that no3 existed independently and was not related to any ions see fig 4 through the visualization of som mapping from deep groundwater there were good correlations among tds na cr vi hco3 so4 2 nh4 and k it showed good correlations among th ca2 mg2 no2 and no3 fe and mn had a certain correlation finally ph could be classified into one cluster see fig 5 to select the best number of clusters the dbi value was used to make the determination by k means clustering algorithm the dbi was calculated for the number of clusters and the dbi was relatively low when the number of clusters was 5 for shallow groundwater the dbi was relatively low when the number of clusters was 4 for deep groundwater according to the mapping diagram the clustering results could be corresponded to the specific pollution components each cluster contained at least one pollution component with much higher ion concentration than the others from the results it was clear that each cluster at the site included contamination components the considerable positive correlation indicated that pollutants might have similar source characteristics 3 2 basic characteristics of each cluster 3 2 1 basic characteristics of each cluster of shallow groundwater to characterize the features of the categorical data box plots of the main ions were drawn as shown in fig 6 the concentration of mn fe nh4 pb and k in the fifth cluster was significantly higher than the first cluster meanwhile the first cluster had similarities with the fifth cluster the concentration of na and so4 2 was lower than those of the other three clusters and the concentration of no3 was higher than the other three clusters on one hand the main reason was that the site was closed for management after 2000 and agricultural activities were not allowed in the site while agricultural cultivation existed around the site and the application of fertilizers and pesticides led to higher no3 concentration on the other hand groundwater seepage in the site was slow and the high so4 2 and na concentration of groundwater below the chromium slag pile had relatively little impact on the groundwater around the site in the second third and fourth clusters the concentration of so4 2 and na was higher while the concentration distributions of ca2 mg2 fe and mn were similar in particular in the second cluster the mean value of so4 2 concentration was the largest with a value of 1158 6 mg l meanwhile the cr vi concentration was the highest with a mean value of 150 6 mg l and the mean concentration of ca2 and mg2 was the highest in the third cluster the mean concentration of cl was the largest with a value of 265 7 mg l in the fourth cluster the concentration of co3 2 and as was significantly high table s5 3 2 2 basic characteristics of each cluster of deep groundwater the characterization in deep groundwater is shown in the following table 1 in the first cluster the mean concentration of fe and mn was the highest and the mean concentration of tds so4 2 cr vi no3 ca2 and mg2 was the lowest the mean concentration of so4 2 na tds and cr vi in the second cluster was significantly higher than those in the other clusters the mean concentration of no3 no2 ca2 and mg2 was the highest in the third cluster in the fourth cluster the concentration of na was the lowest 3 3 analysis of contamination compositions for each cluster 3 3 1 analysis of pollution compositions of shallow groundwater by characterizing the dominant components of each group the origins and migration processes of the contaminants in each cluster were investigated fig 7 for shallow groundwater the distribution of sampling points in each cluster is shown in fig 1 the first cluster brown was dominated by no3 and the occurrence was not restricted to one individual area the cluster appeared to be widely distributed over the entire area furthermore the correlation with other ions was low indicating that the source of no3 was different from the source of other contaminants during the hydrogeological survey it was found that there was a large area of agricultural land around the site fig s4 the application of pesticides and fertilizers led to high no3 concentration in groundwater of the whole area the second cluster pink contained th ca2 mg2 cr vi and no2 the value of th all exceeded 450 mg l on one hand gypsum was constantly dissolving according to saturation index on the other hand it was clear that the main chemical composition of the chromium slag contained 2 to 35 calcium oxide and 15 to 33 magnesium oxide from the test results table s6 ions entered the groundwater under rainfall leaching and migrated downstream along groundwater flow paths therefore pollutants were mainly from the migration of components at the chromium slag heap under the effect of convection and dispersion the third cluster purple was characterized by high tds na cl hco3 and so4 2 and the correlation among tds na cl and so4 2 was very high compositions migrated downstream under the effect of convection and dispersion as shown in the distribution map of sampling points fig 1 the samples contained in the second third and fourth clusters were distributed around the former chromium slag pile and production plant the concentration of na and so4 2 in groundwater below the chromium slag pile was high due to anthropogenic activities and na and so4 2 have strong mobility therefore the concentration of na and so4 2 in these samples was high and far exceeded the class iii groundwater quality standards the fourth cluster blue contained as co3 2 and ph these sample points were mainly from the aquifer beneath the chromium slag heap therefore pollutants originated from rainfall leaching on the chromium slag the ph of these samples was greater than 8 3 which represented an alkaline environment moreover this was reinforced by the presence of co3 2 in groundwater more noteworthy was the relatively high concentration of as in these samples it was well known that high arsenic groundwater posed potential health risk to hundreds of millions of people due to its chronic poisoning effects guo et al 2019 guo et al 2016 qiao et al 2020 the chemical characteristics of as in groundwater were different from those of other heavy metals when the ph was high arsenic existed mostly in the form of arsenious acid and was not easily adsorbed by sediment meanwhile high ph reduced the positive charge of the sediment and promoted the desorption of arsenic from sediment to groundwater transitions of one cluster to another could be tracked using the som clustering approach in this research we also developed a three dimensional numerical model of groundwater using modflow software the inputs and outputs of the model are shown in the supplementary files text s4 and the average annual migration distance of pollutants by particle tracking was 17 5 m under convection through the distribution of the current pollution and numerical simulation this could demonstrate the migration of components from cluster 4 to cluster 2 such as na so4 2 and cr vi the mean concentration of na so4 2 and cr vi was higher in the cluster 2 than in the cluster 4 but the sampling points in the fourth cluster mainly distributed in the aquifer under the chromium slag pile the components in the groundwater beneath the chromium slag pile continuously migrated downstream with the groundwater flow in 2017 the state carried out the remediation of groundwater contamination at the site using prb technology the local permeability coefficient was changed and the more migratory components tended to accumulate at the second cluster the fifth cluster green was dominated by mn nh4 k fe and pb the high values of fe and mn mainly distributed in the downstream of the site with small hydraulic gradient it tended to form a reducing environment which was a good opportunity to lead to the enrichment of fe and mn in the downstream the concentration of pb in only two sampling points exceeded the drinking water standard and both points s34 and s42 were assigned to the fifth group which might be the result of anthropogenic activities the exceedance rate of fe and mn in shallow groundwater reached 70 and 74 respectively the main reasons were as follows firstly the water level of the site was high and the seepage conditions were poor thus the sediments were in a relatively anoxic conditions for a long time which provided a favorable environment for the enrichment of fe and mn secondly the input of anthropogenic contaminants led to changes in the acid base environment of groundwater it prompted the decomposition of organic matter under the action of microorganisms to produce reducing substances such as carbon dioxide and hydrogen sulfide which could reduce the high valent iron and manganese oxides to low valent iron and manganese soluble salts eventually leading to an increase in the iron and manganese content in groundwater 3 3 2 analysis of pollution compositions of deep groundwater for deep groundwater the distribution of sampling points in each cluster is shown in fig 1 the first cluster orange contained most of the sample points and the relevant components were fe and mn fig 8 the exceedance rates of fe and mn were 71 and 84 respectively the main reason was that fe and mn became reduced to more soluble and mobile form fe ii and mn ii under reducing conditions the content of fe and mn in deep groundwater was lower than that in shallow groundwater which demonstrated that anthropogenic contamination had less impact on deep groundwater the second cluster pink contained compositions such as tds na so4 2 and cr vi for the sampling points in the second cluster from deep groundwater samples for shallow groundwater were also taken at the same locations the analysis found that the content of each component in deep groundwater was significantly lower than that in shallow groundwater which suggested that leakage could occur in the aquifer the third cluster blue was dominated by th ca2 mg2 and no3 we also sampled in shallow groundwater at the same location the results showed that the concentration of each component in shallow groundwater was higher than that in deep groundwater the main reason was that the contamination of deep groundwater was caused by the leakage of shallow groundwater and regional flow the fourth cluster green was characterized by ph the ph was significantly higher than the samples in the rest of the clusters 3 4 groundwater chemistry control mechanisms gibbs diagram can be used to illustrate the genesis mechanism of the hydrogeochemical composition gibbs 1970 from the fig 9 it could be seen that the hydrogeochemical composition of the study area was mainly dominated by water rock interaction and evaporative crystallization the sampling points in the cluster 1 and cluster 5 were located in the water rock interaction region the sampling points in the cluster 2 cluster 3 and cluster 4 were located in the evaporation region it could be visualized that the value of na na ca2 in the groundwater of the study area was greater than 0 2 and the value of na na ca2 in cluster 4 was the highest the sampling points falling in the evaporation crystallization area were all from the aquifer around the chromium slag pile and the main chemical principles involved in the production of chromium salts were as follows 2na2cro4 h2so4 na2cr2o7 na2so4 h2o so the values of na na ca2 was high which also responded to the results that the concentration of tds and na was higher in these three clusters however the presence of evaporative crystallization was uncertain due to the influence of contamination the further analysis of the groundwater isotope data showed that evaporative crystallization existed zhihong et al 2017 3 5 saturation index analysis the saturation index si plays an important role in evaluating the equilibrium and reaction between minerals and groundwater zhu et al 2020 with the increase of tds the saturation index of gypsum tended to be more and more close to 0 which indicated that gypsum was continuously dissolving but the potential of dissolution was decreasing this was mainly due to the so4 2 in the aquifer below the chromium slag pile continuously migrating downstream from cluster 4 to cluster 2 moreover the prb remediation work was carried out at the site in 2017 which increased the permeability coefficient of the aquifer so the compositions migrated and accumulated in the second cluster this eventually led to the gypsum in cluster 2 gradually being in a saturated state the samples in cluster 1 and cluster 5 were less affected by the chromium slag pile therefore the solubility of gypsum was greater as tds rose the saturation index of halite gradually increased then tended to the steady state but dissolution was still occurring the concentration of na was high in cluster 2 due to anthropogenic activities therefore the si of cluster 2 was large the si results indicated the solubility of gypsum and halite in the cluster 2 cluster 3 and cluster 4 was less than the cluster 1 and cluster 5 the saturation index of calcite and dolomite showed the same trend and the saturation index of both did not change significantly with the increase of tds fig 10 4 conclusion in this study combination of som and k means clustering analysis was used to downscale and cluster the hydrogeochemical data of the chromium contaminated site the hydrogeochemical characteristics and pollution sources of the site were investigated in addition the hydrogeochemical characteristics of each cluster were elucidated by gibbs plot and saturation index method the main conclusions drawn from this study were as follows the som provided clear and concise overview of the classification of hydrogeochemical data here the som was proven to be a robust and straightforward method to condense the information content of datasets at the contaminated site therefore som was an effective tool for groundwater quality evaluation at site scale in terms of the hydrogeochemical characteristics the som clustering approach succeeded in assigning the groundwater samples according to their chemical compositions together with hydrogeological information five clusters could be conclusively identified for shallow groundwater the first cluster was dominated by no3 and the range of spatial distribution was the most extensive it was found that the site was surrounded by large areas of farmland and the use of pesticides and fertilizers led to high nitrate concentration in the groundwater of the whole area from the distribution map of sampling points it could be seen that the samples contained in the second third and fourth clusters were distributed around the chromium slag pile the concentration of na and so4 2 in these samples was high due to anthropogenic activities especially for the second cluster the average concentration of cr vi ca2 and mg2 was the highest pollutants were mainly from the migration of components at the chromium slag heap under the effect of convection and dispersion the third cluster was characterized by tds na cl hco3 and so4 2 and these components migrated downstream under the effect of convection and dispersion the fourth cluster was dominated by as and co3 2 and sampling points were mainly from the aquifer beneath the chromium slag heap therefore pollutants originated from rainfall leaching on the chromium slag the ph of these samples was all greater than 8 3 which represented an alkaline environment this was reinforced by the presence of co3 2 in groundwater arsenic was more easily enriched under alkaline conditions meanwhile it could be found that na so4 2 and cr ⅵ migrated from cluster 4 to cluster 2 by som and numerical simulation the fifth cluster was dominated by mn and fe the long term anoxic groundwater conditions and the input of anthropogenic contamination led to the elevated fe and mn content in groundwater the deep groundwater samples could be grouped into four clusters and the hydrogeochemical characteristics of the corresponding clusters were similar to those of the shallow groundwater moreover the deep groundwater contamination was caused by the leakage of shallow groundwater the sampling points in the cluster 1 and cluster 5 were located in the water rock interaction region the sampling points in the cluster 2 cluster 3 and cluster 4 were located in the evaporation region and the value of na na ca2 in cluster 4 was the highest which also responded to the results that the concentration of tds and na was higher in these three clusters due to anthropogenic activities further combined with the isotopic data evaporative crystallization was present with the increase of tds the gypsum was nearly saturated and the potential of dissolution of halite was decreasing as influenced by anthropogenic activities in particular the si of gypsum and halite in cluster 2 was high the si results indicated the solubility of gypsum and halite in the cluster 2 cluster 3 and cluster 4 was less than the cluster 1 and cluster 5 the saturation index of calcite and dolomite showed the same trend and the saturation index of both did not change significantly with the increase of tds 5 implications the concentration of so4 2 and no3 in the groundwater of the site is high by investigation it has demonstrated that so4 2 and no3 have an inhibitory effect on hexavalent chromium removal dong et al 2018 therefore the specific relationship between hexavalent chromium removal and the concentration of so4 2 and no3 in groundwater should be mastered when removing hexavalent chromium by reduction method xinxiang 7 19 extreme rainstorms flood the contaminated site the heaviest rain intensity in 1 h is 149 9 mm this can be an extreme rainstorm that only happens in a few hundred years it is suggested that the hydrogeochemical characteristics of soil and groundwater after continuous heavy rainfall should be studied this may be a gap for the variation of the hydrogeochemical characteristics of soil and groundwater following extreme rainstorm around the world it will be helpful to improve the soil and groundwater remediation measures at the site credit authorship contribution statement yaobin zhang writing original draft writing review editing qiulan zhang formal analysis writing review editing supervision wenfang chen investigation weiwei shi investigation yali cui formal analysis supervision leilei chen investigation jingli shao formal analysis supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research is supported by science and technology research project of henan provincial department of natural resources yu natural resources letter 2019 no 373 8 and national key r d program of china no 2019yfc1804801 furthermore we thank the reviewers for their helpful comments appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128839 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2593,mountainous gravel bed stream characterized by large scale roughness generally goes through the seasonal flow including flood and interevent periods recent studies suggest the effect of the interevent period termed stress history is significant for the bedload incipient motion and bed topography evolution however the research on bedload transport fluctuation and protruding microtopography a fundamental element in the riverbed under the effect of stress history is limited especially for quantitative description as such this study evaluated experimentally the effect of stress history on bedload transport and bed topography in gravel bed streams the long duration interevent period restrains the variation of bedload transport fluctuation by decreasing the microtopography spatial density while the large magnitude interevent period enhances the variation of bedload transport fluctuation through the increasing spatial density meanwhile the grain distribution of transported bedload is significantly affected by the magnitude of the interevent period rather than the duration bed topography becomes smoother through an intermittent adjustment of structure scale bed topography in the interevent period moreover the decreasing bedload cumulative transport rate and lower variation coefficient of bedload transport fluctuation after short duration and small magnitude interevent period are attributed to the stable riverbed with the decreasing microtopography spatial density of less flow drag an assumption of the larger rate and higher fluctuation after the long duration and middle large magnitude interevent period is proved that the magnitude of the interevent period can promote the microtopography spatial density to generate large flow drag and carry coarse particles of microtopography to randomly hit the bed to generate abundant sediment ejection and transport additionally the relations among microtopography spatial density characteristic grain sizes and statistical parameters of bed topography at the different scales are further explored indicating bed topography at the grain scale has more relation with bed topography keywords stress history bedload transport fluctuation bed topography microtopography gravel bed streams data availability data will be made available on request 1 introduction gravel bed stream characterized by large scale roughness composed of a wide distribution of sediment particles is a significant vital part of the water cycle system on the earth comiti and mao 2012 ferro 2003 ghilardi et al 2014a luo et al 2022b yager et al 2007 bedload transport through these gravel bed streams plays an important role in pre warning of mountain torrent disasters brenna et al 2021 restoration of aquatic habitats hauer et al 2016 junker et al 2014 liu and shan 2022 and sink to source processes on the earth s surface deng et al 2019 however bedload transport is highly intermittent with several orders of magnitude even for a steady flow condition and is notoriously challenging to predict within one to two orders of magnitude due to the complex interaction between bed topography and the flow condition of channels hassan et al 2020b rickenmann 2018 rickenmann 2020 schneider et al 2015 the main reasons for bedload transport variability in flood periods have been attributed 1 the critical shields stress threshold condition of bedload transport is varied by flow strength due to armor layer configuration liu et al 2020 mueller et al 2005 2 bed surface texture and structure develop gradually in response to the low magnitude flow conditions haynes and pender 2007 ockelford and haynes 2013 3 sediment supply is a key control on riverbed evolution hassan et al 2020a wang et al 2021 indeed most researches focus on the bedload transport variations in high magnitude flow conditions neglecting the effect of low magnitude flow ghilardi et al 2014a recking et al 2009 yet virtually a special feature of mountain gravel bed streams that cannot be ignored is that the hydrograph is often characterized by a large fluctuation of flow discharges including short time flash floods and long time low magnitude flow conditions an et al 2021 related to the effect of antecedent low magnitude flow periods on the subsequent flood the stress history effect is introduced to highlight the retained memory of riverbed originating from the low magnitude period monteith and pender 2005 reid et al 1985 in recent years stress history has been reported that it can influence the bed topography and bedload transport in flume and field investigations an et al 2021 mao 2018 masteller et al 2019 ockelford et al 2019 perret et al 2020 rainato et al 2020 turowski et al 2011 paphitis and collins 2005 through the yalin criterion of bedload incipient motion in flume experiments found that the stress history can rearrange the grains to enhance the observed critical shear velocity by as much as 27 under certain circumstances and further corrected the exposure correction factor corresponding to bedload transport monteith and pender 2005 conducted a series of flume experiments with different stress history conditions of magnitude and duration revealing that the stability of a graded sediment bed was dependent not only on the magnitude of the interevent but also on the duration furthermore haynes and pender 2007 revealed firstly the detailed examination of the dependence of graded bed stability on stress history through the competing effects of particle rearrangement and selective entrainment ockelford and haynes 2013 used statistical analysis and a two dimensional 2d semi variogram to evaluate quantitatively the impact of stress history on gravel bed topography indicating the variation of vertical settlement bed roughness and particle repositioning perret et al 2018 and perret et al 2020 conducted flume experiments at low bed shear stress to reveal how the bed surface impacted bedload transport in different bed configurations an et al 2021 demonstrated that the implementation of stress history could result in a reduction of sediment transport rate during the subsequent flood event but the effect orientated from low magnitude flow condition only last a relatively short time about 10 min at the beginning of the flood event the above mentioned research related to stress history mainly focus on the threshold of incipient bedload motion the varying total amount of bedload transport and the processing of bed topography evolution the fluctuation of bedload transport rate under the effect of the stress history however has never been taken into account the effect truly happens and is important for these especially at the event scale in gravel bed streams recking et al 2012 hence it s significantly meaningful to explore the bedload transport fluctuation in gravel bed streams which has received increasing attention in terms of microscale mechanisms and statistical characterization ancey 2020a b more recently a fundamental element in the riverbed grain protrusion of so called microtopography has been also noticed and confirmed that it is a proxy for flow structure and bedload transport in gravel bed streams including the co effect of low magnitude flow condition carollo and ferro 2021 ghilardi et al 2014b luo et al 2020 nativ et al 2022 yager et al 2007 the highest protruding particles arising from the mean bed surface are organized to constitute the so called microtopography with the highest flow drag and the lowest grain friction angles strom and papanicolaou 2007 compared with the specific effect of microtopography in sand bed rivers e g ripples dunes antidunes however the effect of microtopography in gravel bed is equivocal and still needs to quantify perret et al 2020 protruding microtopography is not only relatively more mobile but also destabilizes adjacent fine sediments altering flow structure and bedload transport in gravel bed streams luo et al 2022b masteller and finnegan 2017 nonetheless few studies have characterized the protrusion variation of microtopography and bedload transport in these grave bed streams for example yager et al 2007 performed steep flume experiments of isolated relatively immobile protruding microtopography with the same height and then partitioned effective shear stress corresponding to bedload transport afterward yager et al 2012 found that the protruding height of microtopography increased exponentially with greater time in the low magnitude flow period in the erlenbach river which provided plausibly a new method to improve bedload transport predictions masteller and finnegan 2017 conducted a series of flume experiments to link microtopography protrusion bedload transport and the duration of low magnitude flow conditions demonstrating the protrusion density defined as the number of protruding grains per square meter varies logarithmically with time and the critical shields stress increase with time furthermore the fundamental relationships between microtopography protrusion and bedload fluctuation under the effect of stress history have not been examined up to now aiming at the gaps of the current research only by taking the total bedload transport as the main responding parameter corresponding to the seasonal effect and the vital role of microtopography on the top of the riverbed this research will focus on quantitatively the relations between features of the bedload transport fluctuations and microtopography affected by stress history in a typical gravel bed channel the high resolution bed topography of the gravel bed can be generated by the structure from motion sfm method to determine a digital elevation model dem of the gravel bed specifically we exploit these statistical characteristics of bed topography at different scales and protruding microtopography extracted from dem to explore the effect of stress history subsequently the interplay between sediment transport and stress history and relations among microtopography spatial density characteristic grain sizes and statistical parameters of bed topography at different scales are discussed contributing more possible parameters for the optimization evaluation of flow resistance and bedload transport rate 2 methods 2 1 experimental setup the flume experiments were conducted in a rectangular flume with 8 5 m in length 0 4 m in width 0 4 m in height and a bed slope of sb 4 2 in the state key lab of hydraulics and mountain river engineering at sichuan university as illustrated in fig 1 a the flow was regulated by a rectangular weir with a wide top at the inlet generating a steady uniform flow in the open channel many plastic honeycomb tubes were spaced closely at the inlet section of a flume paralleling the flow direction for stabilizing flow the sediment was paved on a conveyor belt along the flume width and fed into the flume atop the starting of the patched rough reach using a conveyor belt feeder at a calibrated speed in the case of the splashdown of feeding particles from the belt to the riverbed an inclined plane with the top end near the belt and bottom close to the water surface was located underneath the exit of the conveyor the patched rough reach set as 6 5 m in length and 20 cm in depth was 1 0 m away from the inlet which was constituted by natural gravel and cobble ranging from 2 64 mm the grain size distribution curve was illustrated in fig 1b d 50 13 9 mm and d 84 27 0 mm in which the subscript denoted the percentile of finer grains the transitional reach with about 1 0 m length was composed of larger immobile cobbles of averaged size was 100 mm in case of scouring gravel bed and stabilizing flow to rough reach the outlet of rough reach was placed by a pvc vertical plate weir to stabilize the bed substratum a filtering basket with a 1 mm grid suspended from a tension sensor dyly 103 produced by bengbu da yang sensing system engineering co ltd weighted the carrying sediments at the outlet of rough reach and the sampling interval was set as 1 min in the case of the effect of the basket vibration inside and the water flow motion an approximate static water area was built to cover the basket under the current experimental configuration two limitations should be considered carefully to conduct the settings of flow condition and measurement firstly in the case of the effect of the flume wall boundary the ratio between flume width and water depth should be larger than 5 0 therefore the maximum flow depth in experiments was set to less than 0 08 m secondly for the full development of flow the measurement location of flow conditions should be set at more than 30 times the maximum flow depth from the entrance of the paved reach the starting measurement location of bed topography in experiments herein was set more than 3 0 m away from the entrance of the flume inlet and the ending location was set 1 5 m from the end of paved reach in case of the effect of the flume outlet so the final analyzing area of bed topography was 4 00 0 35 m2 by varying the magnitude and duration of flow discharge the experimental flow condition contained four periods including a the conditioning period b the first flood period c the interevent period and d the second flood period as illustrated in fig 2 the magnitude of flow discharge in the conditioning period was 5 0 l s 0 1 and the duration time lasted 1 0 h to avoid transient adjustment of the artificial paved gravel bed induced by the varying hydraulic condition and to remove any pores unstable particles and suspended sand during bed flattening subsequently the first flood was simulated by a steady discharge of 25 0 l s 0 1 and a non uniform sediment feeding rate qs in of 2 0 kg min 0 01 with the same size distribution of gravel bed for 0 5 h after the drastic change of bed topography the flow discharge was then decreased to generate a long duration low magnitude condition in the interevent period with a range from 5 0 l s to 7 0 l s for 1 0 h and 3 0 h during this period no sediment feeding upstream and transporting along the reach happened in all experiments subsequently the second flood period with the same flow and sediment configuration as the first flood period was operated again the detail of the experimental conditions was summarized in table 1 to get more information on the flow hydraulics bedload transport and bed topography the experiments were stopped frequently every 10 min in the flood period and every 0 5 or 1 h in the interevent period during each stop the water pump was turned off quickly and the water inside the flume was drained through several holes in the pvc vertical plate weir after finishing the following measurements the water was just drained with a slow flow rate and then increased flow discharge until the necessary flow was reached due to the large variation of bed topography and bedload transport no equilibrium state was reached through the experiments during the flood periods the bedload collected in the fliting basket at the channel outlet was weighted in real time with a 1 min sampling interval after the water flow was stopped with 10 min sampling interval the bedload was dried and then sieved to estimate the transported bedload size distribution characterized by the percentile values d16m d50m d84m before closing the pump water levels at 1 m intervals along the flow direction were measured by an ultrasonic sensor installed on the top platform above the flume with a precision of 0 001 m the water depths were calculated from the height difference between the water level and the riverbed at each stop a 2 mm high resolution digital elevation model dem of the bed topography along the analyzing area was determined by the structure from motion sfm photogrammetry method masteller and finnegan 2017 wang et al 2021 each bed configuration contained more than 500 overhead photos to ensure high coverage of the bed for analyzing the area of the channel bed the same photos were used to determine the grain size distribution gsd in the bed surface using basegrain 2 0 software for the so called photo sieving technique detert and weitbrecht 2012 the above experimental characteristics of flow and bedload size were set according to nyang river which was the largest tributary on the right bank of yarlung zangbo river in the qinghai tibet plateau the following statistical parameters of the nyang river could be found in national tibetan plateau data center luo et al 2022a the w d 50 of nyang river was about 29 68 which was very close to the flume experiment with a value of 28 78 the flow in the flood period was supercritical with fr larger than 1 0 similar to flume experiments with about 1 15 the relative water depth in the interevent period was about 2 23 similar to flume experiments with about 2 15 which belonged to the moderate scale roughness according to the discharge hydrograph measured at jiangzi hydrologic station in the upper of nyang river meanwhile the ratios of flow discharge and duration between flood period and interevent period were respectively 1 3 5 times and 1 3 times similar to 2 7 5 times and 1 3 times of flume experiments in this study above all all the experimental settings in this study were in line with the relevant conditions of flow and bedload transport in the nyang river 2 2 processing method of bed topography the gravel bed topography is extremely complex and necessary to be decomposed based on the scale magnitudes such as grain scale structure scale and large form scale perret et al 2020 structure scale bed topography is mainly composed of microtopography gathered by gravel particles while large form scale bed topography is made up of different kinds of microtopography to form step pools clusters and so on therefore it is vital to select a reasonable method to decompose bed topography for the whole characteristics of the riverbed and microtopography bertin et al 2017 the dem of the original bed topography with the resolution of 2 2 mm2 is fitted by the least square method to remove the original riverbed slope resulting in a detrended dem with the resolution of 2 2 mm2 seeing fig 3 a then a regular grid of the analyzing area with a point spacing of 1 25d 90 is determined and the elevations of grid points are averaged by the dem data points within a circle with a diameter of 2 5d 90 centered on the grid point due to the lower resolution ratio of this grid than the detrended dem the bedform dem is interpolated by the bicubic spline interpolation method from the above grid points seeing fig 3b finally the grain dem is achieved by the detrended dem minus the bedform dem seeing fig 3c to facilitate the following distinction subsequent parameters of statistical characteristics based on the grain dem and bedform dem are subscripted by grain and bedform respectively the holistic characteristics of riverbed elevation can be quantified by the coefficient of inclined ix standard deviation sd skewness sk kurtosis ku and dimensionless 2d variogram γ as illustrated in table 2 perret et al 2020 following the definition of microtopography microtopography could be extracted from high resolution dem including the distribution and spatial density with different protruding heights seeing a distribution case in fig 4 the extraction results show that the greater the protruding height above the mean riverbed of the microtopography the smaller the number of microtopography in the riverbed the microtopography spatial density λ could be quantified by the ratio between the fraction of the solid volume occupied by the microtopography and the total volume of the roughness layer assumed as the same height of microtopography luo et al 2022b hence the computation expression of λ is following 1 λ v g v 0 n p π p 3 n t π p 3 n p n t where v g is the solid volume occupied by the microtopography v 0 is the total volume of roughness layer n p is the grid number of microtopography higher than the average bed height of p n t is the total grid number of roughness layer it is reasonable to find that λ decreases nonlinearly as p increases due to the decrease of n p besides the distribution characteristic of microtopography is quantified by modified ripley s k function proposed by johnson 2017 which is a spatial statistic widely used in varying disciplines the modified ripley s k function is used to quantify the degree of microtopography in point data as follows 2 a k r a n p 2 i 1 n t i j j 1 n t i s i s j r 2 b j r k r π r where r is a lag distance a is the analyzing bed surface area s i s j is the euclidian distance between two different microtopography locations s i and s j dimensionless indicator i is 1 when s i s j r and zero when s i s j r for a complete spatial random csr distribution pattern k r increases as πr 2 and j r should equal 1 j r 1 for clustering distribution pattern while 0 j r 1 for inhibition distribution pattern 3 results 3 1 flow hydraulics the time series of water surface slope sw flow averaged depth h and flow averaged velocity u over the q 1 q inter and q 2 periods are presented in fig 5 during the first flood period sw increases overall by 1 despite some fluctuating between 0 027 and 0 041 m m with a mean value of 0 033 m m there is a small damping change with a mean value of 0 036 m m in the interevent period the values of sw in the second period are more fluctuated than in the first flood period but declines overall by 1 with a mean value of 0 036 m m in two flood periods there are both small varying in h and u with the differences of which are less than 1 0 cm and 0 05 m s respectively during the interevent period the differences of h and u are measured at less than 0 6 m and 0 03 m s respectively the results of flow hydraulics represent that the flow conditions through all experiments are similar besides it is noted that h and u have changed very little before and after the interevent period except for fluctuating sw 3 2 bedload transport before representing the bedload transport characteristics the measured precision of the tension sensor should be tested the comparison between the 10 min total weight generated by the sensor and the real weight measured by a calibrated balance is illustrated in fig 6 all scatters are within the 10 error lines with a mean error of 4 13 indicating good accuracy for measuring the following bedload transport rate fig 7 shows the time series of bedload transport rate over a 1 min window qs out 1 in the q 1 and q 2 periods suggesting large fluctuation with the unimodal bimodal and tri modal distribution the maximum rate is 0 15 kg s m and the occurrence time of the maximum transport rate is not sure sometimes at the beginning of 10 min or the end of 10 min through the experiments it s noted that the bedload transport rate is generally less than the upstream feeding rate in the first flood period while the number of the peak transport rate and the magnitude of transport rate both increased in the second flood period close to or more than the upstream feeding rate to further quantify the characteristics of bedload transport fluctuation the variation coefficient cv is used to analyze the effect of different flood interevent periods cv is defined as the ratio between standard error and mean value the larger cv value is the larger the dispersion degree between scatter values and the averaged value is and vice versa therefore the bedload transport fluctuation in the flood period can be quantified by the variation coefficient of bedload transport rate c v as follows 3 a s d q si q s 2 n 3 b c v s d q s where sd is the standard deviation of bedload transport rate overtime qsi is the bedload transport rate per the i th minute kg s m q s is the averaged bedload transport rate in the flood period kg s m n is the number of minutes during the flood period fig 8 shows the varying differences before and after the interevent period with different durations and discharges all positive values of cv represent the coefficient of the first flood period is slightly larger than that of the second flood period meaning the bedload transport fluctuation of the first flood is higher than that of the second flood what s vital experimental results find that the long duration of the interevent period with low cv coefficient restrains the variation of bedload transport fluctuation while the large magnitude of the interevent period with high cv coefficient enhances the variation of bedload transport fluctuation the reason for this fluctuation phenomenon is also tried to be interpreted in combination with varying protruding microtopography in section 4 1 the representative diameters of transport bedload over time per 10 min in the flood periods are illustrated in fig 9 e g d 16m d 50m d 84m d geom d 16m d 50m and d geom have represented a decreasing trend shown in fig 9 a b and d respectively no matter how long and what magnitude the interevent period goes the reduction magnitude of small and middle sizes in the first flood period is larger than that in the second flood period the main reason is that the bed surface at the beginning of the first flood period does not experience coarsening artificial paved bed surface while the riverbed in the second flood period has a rough layer with river structures induced by the flow it is worth noting the large size d 84m of transport bedload keeps relatively constant in fig 9 c 3 3 bed topography fig 10 a d show the statistical parameters results of grain scale bed topography the values of ix grain are positive in fig 10 a indicating that the gravel particles are arranged in an imbricate downstream pattern in the first flood period all values of ix grain increase over time because the artificial bed is arranged by the flood flow to form microtopography at the beginning of the flow in the second flood period most ix grain tend to decrease over time due to the riverbed compaction induced by the flood interevent period the variation of sd grain in fig 10 b is small whatever in the flood and interevent periods with the range between 0 006 and 0 008 the values of sk grain in fig 10 c are larger than zero stating the right skewed probability distribution of riverbed elevation in the first flood period the values of ku grain decrease by about 0 2 meaning the increasing mean elevation of riverbed or decreasing peak elevation of microtopography the values of ku grain in the interevent period have a little change in the subsequent flood period most values rise due to the enhancing height of the microtopography induced by upstream inflow and sediment supply the values of ku grain in fig 10 d are about 4 0 belonging to sharp and thick tailed distribution after the first flood the probability distribution of elevation in the interevent period approaches normal distribution with the ku grain value of about 3 0 the values of ku grain generally also rise due to the increasing protruding microtopography for the moment these statistical parameters of grain scale bed topography are not correlated with the magnitude and duration of the interval period but are mainly related to the inflow and sediment supply in the flood period fig 10 e h show the statistical parameters results of structure scale bed topography there are positive and negative values of ixbedform in the riverbed in fig 10 e this is due to the depositional tendency in the riverbed owing to cumulative microtopography where many small particles gather in front forming a positive slope s the back of microtopography is erosional to form deep pools and the downstream scouring distance is significantly smaller than the upstream depositional distance of the particles as the consequence the number of s is less than that of s so the value of ix bedform is positive however the microtopography is constantly disappearing and recombining the reason for negative ix bedform is the increasing number of s or decreasing number of s this generally corresponds to the compaction of discrete microtopography failing to form step pool structures in the riverbed and the total amount of s decreases fig 10 f h reveal that the statistical parameters of structure scale bed topography e g sd bedform sk bedform ku bedform have more variation than grain scale bed topography the change of structure scale bed topography in the flood period is mainly related to the inflow and water supply but in the flood interval the overall trend is to increase first and then decrease tending to be a smoother riverbed through an intermittent adjustment fig 11 a c demonstrate the isoline of dimensionless 2d variogram of diverse scale bed topography in the flood period the maximum sampling interval l x l y along the x direction and y direction are 2000 mm and 175 mm respectively which are greatly larger than the maximum sediment particle size of 64 mm the isoline mapping of γ is the benefit for identifying the isotropy and anisotropy of riverbed elevation the γ isoline of the undecomposed bed topography is not very smooth in fig 11 a showing winding contours γ isoline of bedform dem is significantly smooth and most of the corresponding isoline arise in the same position especially for γ 0 4 however the γ isoline of grain dem within the maximum particle size range 64 mm is close to the circular contour the circular contour gradually transits to the elliptic contours when the sampling interval further increases to 2 times the maximum particle size once the sampling interval is increased there are lots of irregular isoline due to the increasing probability of random elevations in the bed topography it s noted that the overall trend of the riverbed surface is determined by the riverbed structure while sediment particles only affect the fluctuation of the overall trend besides the γ isoline of undecomposed bed topography cannot estimate the flow direction well the γ isoline of grain dem can estimate the flow direction according to the major axis and minor axis of the isoline e g the major axis is the flow direction this method to estimate the flow direction is significantly improved compared with the method of directly using undecomposed bed topography aberle and nikora 2006 the i x value of γ 0 4 isoline at diverse scale bed topography is varied along x direction over time as illustrated in fig 12 a c the expanding of γ 0 4 isoline in the flood period demonstrates that the bed becomes coarsening due to washed fine sediment which is also verified by aberle and nikora 2006 the declining trend of γ 0 4 isoline in the interevent period shows that the bed becomes smoother mainly due to buried microtopography or adjusted bedforms according to the decomposing method of bed topography the bed surface topography in the interevent period becomes smooth because the bed bedform and bed surface particles are gradually adjusted however there is no deflection of 2d variogram isoline owing to coarse bedload size distribution in this study the flow capacity of transported bedload in the interevent period is not enough to shake the perturbation or deflection of coarse particles of microtopography but it is enough to shake fine particles shaded by microtopography generating the change of riverbed structure 3 4 protruding microtopography fig 13 a b shows the microtopography spatial density evaluated by eq 1 based on the different protruding heights p 5 15 25 mm varies with the duration of the interevent period it can be found that the spatial density in the cases of all protruding heights decreases with the increase of interevent duration and the microtopography with higher protruding heights has the greatest impact the decreasing trend suggests that the increased duration of the interevent period smooths the bed surface topography owing to buried microtopography or adjusted bedforms which is the same as the above results from the bed topography the relationships between the magnitude of the interevent period with the same duration and the microtopography spatial density based on the different protruding heights are as illustrated in fig 13 e p 5 mm f p 15 mm and g p 25 mm with the increase of flood magnitude in the interevent period the overall trend of the microtopography spatial density in all protruding heights rises and has the greatest impact on the coarse sediments it s noted that the interevent period with a longer duration and larger magnitude has the largest varying magnitude of the growth reaching 2 times this indicates that the large discharge in the interevent period provides kinetic energy for the coarsening of the bed surface although the interevent flow cannot initialize the coarse particles it is enough to further perturb the fine particles into the pores of bed material when the bed surface topography becomes smooth the higher protruding particles in the microtopography are further highlighted according to the experimental conditions the range of lag distance r is set to 25 500 mm when analyzing the distribution of microtopography to obtain statistically significant results the monte carlo method is used to generate random points by repeating 1000 times in the analysis area generating 97 5 and 2 5 percent confidence bounds on csr the correcting method for edge effect and other setting conditions are originated from johnson 2017 the distribution results evaluated by eq 2 with the protruding height of p 25 mm are illustrated in fig 14 in the small lag distance range e g generally within the width of the flume r 350 mm the microtopography represents a trend of clustering distribution with jagged curves j 1 with the increase in the lag distance j is close to the statistical characteristics of csr distribution in the large lag distance range with smooth curves 350 mm r 500 mm meanwhile the values of j increase over time indicating microtopography aggregation during the flood period in the second flood period the values of j reach the maximum at 20 min and then become smaller this is because the surrounding particles of the microtopography become unstable to move and reproduce new microtopography generating the decrease of j the whole values of j in the interevent period have no change especially in the small magnitude and short duration interevent periods seeing run 1 1 in fig 13 with the growth of magnitude and duration there is only the same trend in j with slight fluctuation in short it indicates that the microtopography in this experiment does not show obvious spatial distribution changes but only changes in spatial density seeing the comparison between fig 13 and fig 14 4 discussion 4 1 interplay between bedload transport and stress history after experiencing the interevent period the 10 min cumulative bedload transport rate qs out 10 has either increased or decreased compared with the 10 min cumulative value before the interevent period as illustrated in fig 15 a meanwhile the bedload transport fluctuation results show the strength of fluctuation has relation to the magnitude and duration of the interevent period as illustrated in fig 8 in the small magnitude of the interevent period the bed becomes more stable with the increasing duration of the interevent period resulting in the decreasing q s out 10 after the interevent period in the middle and large magnitudes of the interevent period however q s out 10 decreases after the short duration interevent period while increasing after the long duration interevent period the reason for decreasing q s out 10 and lower variation coefficient of bedload transport might be contributed to the more stable bed due to less flow drag induced by decreasing the microtopography spatial density but what accounts for the increase of q s out 10 and variation coefficient according to the investigation of experiments an assumption has been proposed plausibly that the increase in total bedload rate and bedload transport fluctuation after the long duration and middle large magnitude interevent period has a relationship with the unstable coarse particles of microtopography the magnitude of the interevent period can promote the microtopography spatial density generating large flow drag and unstable bed especially for middle large magnitude interevent as illustrated in fig 13d f the coarse particles of microtopography become unstable on the bed surface and are carried by flow to hit the bed surface randomly to generate abundant sediment ejection and transport increasing calculative bedload transport rate and higher bedload transport fluctuation after the interevent period to further prove the above assumption the relations of correlation and significant coefficients between fraction sizes in transported bedload and the first 10 min cumulative increasing bedload transport rates in the second flood period after the interevent are shown as illustrated in fig 15b the correlation between the fraction in bedload transport rate and the total bedload transport rate in the calculative 10 min firstly increases then decreases and subsequently increases and then decreases which represents a trend of the bimodal curve in other words except for the well known strong correlation between the median size bedload transport rate 17 mm and the total bedload transport rate the correlation coefficient reaches more than 0 85 while the correlation coefficient of coarse transported particles 35 mm also reaches 0 82 the strong correlation proves that coarse particles have also controlled the total bedload transport rate responding to the increasing value in this period what s more all fraction sizes in bedload are analyzed by statistical significance level the p value of coarse particles less than 0 01 is even lower than middle size particles demonstrating that there is a significant effect between the fraction bedload transport rate of coarse particles and the total value which also verifies the previous assumption in practice if the varying microtopography spatial density can be monitored and reconstructed by underwater cameras in real time it has the potential to interpolate bedload transport fluctuation in the gravel bed streams 4 2 relations between microtopography spatial density with different protruding heights and statistical parameters of bed topography at different scales the microtopography spatial density of different protruding heights in the riverbed is a fundamental element controlling flow and bedload movement which has been achieving more attention yet high resolution dem for detecting microtopography is not easily acquired and how to quantify the microtopography is ambiguous in this study the new index microtopography spatial density λ has the potential for evaluating the relation of microtopography in the riverbed the correlation relations between microtopography spatial density and statistical parameters of bed topography at different scales can be explored to replace them as illustrated in fig 16 fig 16 a demonstrates the varying trend of the correlation coefficient between statistical parameters of detrended dem and microtopography spatial density with different protruding heights it can be noted that there is a strong positive correlation between λ and sb the sb of gravel bed streams and rivers in mountainous regions is generally larger than that of plain rivers and the existence of a strong correlation indicates the rationality of the new index λ meanwhile most of the statistical parameters of bed topography are related to the protruding height of microtopography except for j r 25 400 mm the smaller the protruding height is the more information reflects the bed topography with the greater the correlation fig 16 b and c demonstrate the decreasing trend of correlation coefficients about bedform dem and grain dem with increasing protruding height with the maximum values of standard error respectively besides the correlation coefficients of grain dem are mostly larger than that of bedform dem it can be interpolated that the identification of microtopography is based on the grain scale in river topography the microtopography might be collected to form large scale structures on top of the riverbed for example step pools clusters and so on what s more it might also protrude a discrete microtopography with surrounding fine sediments which is neglected when calculating the statistical parameters of bedform dem nevertheless the microtopography spatial density is taken from all protruding microtopography whether discrete or collective subsequently resulting in a smaller correlation about bedform dem than grain dem 4 3 relations between characteristic grain sizes and statistical parameters of bed topography at different scales previous works have invested that relations between flow resistance or bedload transport rate and bed roughness of gravel bed streams are generally related to characteristic grain sizes e g k s 3 5d 84 chen et al 2020 powell 2018 wong and parker 2006 however a single parameter from characteristic grain size has not behaved the whole trend of bed roughness and may send misleading information it s a potential method to explore more relations with statistical parameters of bed topography at the different scales from the above high resolution dems based on the flume experiments data and processing methods of bed topography therefore the relations between characteristic grain sizes and statistical parameters of bed topography at the different scales are illustrated in fig 17 for microtopography spatial density with different protruding heights in fig 17 a c there are positive trends between small middle grain size and λ p 5 mm with the maximum correlation coefficient of 0 42 about small size grain next middle size grain however the maximum correlation coefficients corresponding to λ p 15 mm and p 25 mm have relations with middle size grain the above results demonstrate that λ in small protruding height is mainly related to the small and medium sized representative particle size and the larger the particle size is the larger value of λ is the reason may be that the coarse particles control the mean elevation of the bed surface after removing the trend when the small particle size becomes larger the threshold of the protruding height of the microtopography is closer to grain size hence the smaller the protruding height is the larger value of λ is for the standard error of bed surface elevation at different scales in fig 17 d f all characteristic grain sizes present positive relation to standard error the correlation coefficient between sd grain and d 50 is the largest with a value of 0 60 which is consistent with the previous study invested by bertin et al 2017 the remaining statistical parameters of skewness coefficient and kurtosis coefficient in fig 17 g l also have the maximum relation at the grain scale furthermore correlation analysis between characteristic grain sizes and statistical parameters of bed topography at the different scales can contribute to the optimization of parameters from the derivation evaluation of flow resistance and bedload transport rate while the physical mechanism of what s going on isn t exactly clear hence it is necessary to use the physical mechanism or numerical modelling to explain the rationality of the selection of riverbed statistical parameters from the perspective of the force balance of sediment particles affected by microtopography limited by laborious flume experiments and collection frequency in this study a numerical simulation method with lower cost and less time consuming can potentially configure either different discharge magnitudes or duration of the interevent period in varying gravel bed channels resulting in abundant experimental real time data with a higher resolution to further explore the detailed relationship between the fluctuation of bedload transport rate and bed topography what s more more field investigations using state of the art instrumentations with high resolution should be investigated to explore the intricate relations including bedload transport rate flow resistance and bed topography in the meandering bifurcated and compound gravel bed streams 5 conclusions this study conducts a series of flume experiments to quantify the relations between features of the bedload transport fluctuations and bed topography affected by different stress histories in a typical gravel bed channel the high resolution dem at different scales gained by the structure from motion sfm method is applied for the statistic parameters of overall bed topography and extracted to analyze the spatial density and distribution characteristics of protruding microtopography the experimental results show that the variation coefficient of bedload transport fluctuation in the first flood period is larger than the coefficient in the second flood period due to an artificial paved riverbed moreover the long duration of the interevent period restrains the variation of bedload transport fluctuation while the large magnitude of the interevent period enhances the variation of bedload transport fluctuation the bedload transport distribution is significantly affected by the magnitude of the interevent period rather than the duration for bed topography at different scales statistical parameters of grain scale bed topography are not correlated with the magnitude and duration of the interval period but the overall trends of structure scale bed topography increase first and then decrease in the interevent period indicating smoother riverbed through an intermittent adjustment according to the micromorphology spatial density and distribution under different protruding heights the spatial density in the flood period has higher variation than that in the interevent period besides the duration of the interevent period could decrease the spatial density while the magnitude of the interevent period could increase the spatial density and has the greatest impact on the coarse sediments what s more the reason for decreasing bedload cumulative transport rate and lower bedload transport fluctuation after short duration and small magnitude interevent period might be contributed to the stable bed owing to less flow drag induced by decreasing the microtopography spatial density however the assumption about the increasing rate and higher fluctuation after the long duration and middle large magnitude interevent period is verified that the magnitude of the interevent period can promote the microtopography spatial density to generate large flow drag hence the coarse particles of microtopography on the bed surface become unstable and are carried to randomly hit the bed surface generating abundant sediment ejection and transport in addition the relations among microtopography spatial density characteristic grain sizes and statistical parameters of bed topography at the different scales are explored by correlation analysis indicating bed topography at the grain scale has more relation with bed topography these relations can contribute to more potential parameters for the optimization evaluation of flow resistance and bedload transport rate above all the study of complex relationships among seasonal flow bedload transport and microtopography in mountainous gravel bed streams has important scientific significance and practical value for fluvial geomorphology evolution flood disaster prevention and ecological restoration which is also urgent to study and advance the mechanics of sediment motion credit authorship contribution statement ming luo conceptualization formal analysis investigation methodology writing original draft writing review editing yurun jiang data curation methodology sen wang data curation validation xingnian liu funding acquisition supervision er huang funding acquisition supervision validation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research is supported by the second tibetan plateau scientific expedition and research program grant no 2019qzkk020401 the surface grain size distribution of the nyang river dataset can be found in national tibetan plateau data center http data tpdc ac cn thanks to anonymous reviewers and editors for their useful and careful critiques for improving this research the authors also want to thank xiaokang wu and wenqi li to assist in conducting flume experiments and useful discussions 
2593,mountainous gravel bed stream characterized by large scale roughness generally goes through the seasonal flow including flood and interevent periods recent studies suggest the effect of the interevent period termed stress history is significant for the bedload incipient motion and bed topography evolution however the research on bedload transport fluctuation and protruding microtopography a fundamental element in the riverbed under the effect of stress history is limited especially for quantitative description as such this study evaluated experimentally the effect of stress history on bedload transport and bed topography in gravel bed streams the long duration interevent period restrains the variation of bedload transport fluctuation by decreasing the microtopography spatial density while the large magnitude interevent period enhances the variation of bedload transport fluctuation through the increasing spatial density meanwhile the grain distribution of transported bedload is significantly affected by the magnitude of the interevent period rather than the duration bed topography becomes smoother through an intermittent adjustment of structure scale bed topography in the interevent period moreover the decreasing bedload cumulative transport rate and lower variation coefficient of bedload transport fluctuation after short duration and small magnitude interevent period are attributed to the stable riverbed with the decreasing microtopography spatial density of less flow drag an assumption of the larger rate and higher fluctuation after the long duration and middle large magnitude interevent period is proved that the magnitude of the interevent period can promote the microtopography spatial density to generate large flow drag and carry coarse particles of microtopography to randomly hit the bed to generate abundant sediment ejection and transport additionally the relations among microtopography spatial density characteristic grain sizes and statistical parameters of bed topography at the different scales are further explored indicating bed topography at the grain scale has more relation with bed topography keywords stress history bedload transport fluctuation bed topography microtopography gravel bed streams data availability data will be made available on request 1 introduction gravel bed stream characterized by large scale roughness composed of a wide distribution of sediment particles is a significant vital part of the water cycle system on the earth comiti and mao 2012 ferro 2003 ghilardi et al 2014a luo et al 2022b yager et al 2007 bedload transport through these gravel bed streams plays an important role in pre warning of mountain torrent disasters brenna et al 2021 restoration of aquatic habitats hauer et al 2016 junker et al 2014 liu and shan 2022 and sink to source processes on the earth s surface deng et al 2019 however bedload transport is highly intermittent with several orders of magnitude even for a steady flow condition and is notoriously challenging to predict within one to two orders of magnitude due to the complex interaction between bed topography and the flow condition of channels hassan et al 2020b rickenmann 2018 rickenmann 2020 schneider et al 2015 the main reasons for bedload transport variability in flood periods have been attributed 1 the critical shields stress threshold condition of bedload transport is varied by flow strength due to armor layer configuration liu et al 2020 mueller et al 2005 2 bed surface texture and structure develop gradually in response to the low magnitude flow conditions haynes and pender 2007 ockelford and haynes 2013 3 sediment supply is a key control on riverbed evolution hassan et al 2020a wang et al 2021 indeed most researches focus on the bedload transport variations in high magnitude flow conditions neglecting the effect of low magnitude flow ghilardi et al 2014a recking et al 2009 yet virtually a special feature of mountain gravel bed streams that cannot be ignored is that the hydrograph is often characterized by a large fluctuation of flow discharges including short time flash floods and long time low magnitude flow conditions an et al 2021 related to the effect of antecedent low magnitude flow periods on the subsequent flood the stress history effect is introduced to highlight the retained memory of riverbed originating from the low magnitude period monteith and pender 2005 reid et al 1985 in recent years stress history has been reported that it can influence the bed topography and bedload transport in flume and field investigations an et al 2021 mao 2018 masteller et al 2019 ockelford et al 2019 perret et al 2020 rainato et al 2020 turowski et al 2011 paphitis and collins 2005 through the yalin criterion of bedload incipient motion in flume experiments found that the stress history can rearrange the grains to enhance the observed critical shear velocity by as much as 27 under certain circumstances and further corrected the exposure correction factor corresponding to bedload transport monteith and pender 2005 conducted a series of flume experiments with different stress history conditions of magnitude and duration revealing that the stability of a graded sediment bed was dependent not only on the magnitude of the interevent but also on the duration furthermore haynes and pender 2007 revealed firstly the detailed examination of the dependence of graded bed stability on stress history through the competing effects of particle rearrangement and selective entrainment ockelford and haynes 2013 used statistical analysis and a two dimensional 2d semi variogram to evaluate quantitatively the impact of stress history on gravel bed topography indicating the variation of vertical settlement bed roughness and particle repositioning perret et al 2018 and perret et al 2020 conducted flume experiments at low bed shear stress to reveal how the bed surface impacted bedload transport in different bed configurations an et al 2021 demonstrated that the implementation of stress history could result in a reduction of sediment transport rate during the subsequent flood event but the effect orientated from low magnitude flow condition only last a relatively short time about 10 min at the beginning of the flood event the above mentioned research related to stress history mainly focus on the threshold of incipient bedload motion the varying total amount of bedload transport and the processing of bed topography evolution the fluctuation of bedload transport rate under the effect of the stress history however has never been taken into account the effect truly happens and is important for these especially at the event scale in gravel bed streams recking et al 2012 hence it s significantly meaningful to explore the bedload transport fluctuation in gravel bed streams which has received increasing attention in terms of microscale mechanisms and statistical characterization ancey 2020a b more recently a fundamental element in the riverbed grain protrusion of so called microtopography has been also noticed and confirmed that it is a proxy for flow structure and bedload transport in gravel bed streams including the co effect of low magnitude flow condition carollo and ferro 2021 ghilardi et al 2014b luo et al 2020 nativ et al 2022 yager et al 2007 the highest protruding particles arising from the mean bed surface are organized to constitute the so called microtopography with the highest flow drag and the lowest grain friction angles strom and papanicolaou 2007 compared with the specific effect of microtopography in sand bed rivers e g ripples dunes antidunes however the effect of microtopography in gravel bed is equivocal and still needs to quantify perret et al 2020 protruding microtopography is not only relatively more mobile but also destabilizes adjacent fine sediments altering flow structure and bedload transport in gravel bed streams luo et al 2022b masteller and finnegan 2017 nonetheless few studies have characterized the protrusion variation of microtopography and bedload transport in these grave bed streams for example yager et al 2007 performed steep flume experiments of isolated relatively immobile protruding microtopography with the same height and then partitioned effective shear stress corresponding to bedload transport afterward yager et al 2012 found that the protruding height of microtopography increased exponentially with greater time in the low magnitude flow period in the erlenbach river which provided plausibly a new method to improve bedload transport predictions masteller and finnegan 2017 conducted a series of flume experiments to link microtopography protrusion bedload transport and the duration of low magnitude flow conditions demonstrating the protrusion density defined as the number of protruding grains per square meter varies logarithmically with time and the critical shields stress increase with time furthermore the fundamental relationships between microtopography protrusion and bedload fluctuation under the effect of stress history have not been examined up to now aiming at the gaps of the current research only by taking the total bedload transport as the main responding parameter corresponding to the seasonal effect and the vital role of microtopography on the top of the riverbed this research will focus on quantitatively the relations between features of the bedload transport fluctuations and microtopography affected by stress history in a typical gravel bed channel the high resolution bed topography of the gravel bed can be generated by the structure from motion sfm method to determine a digital elevation model dem of the gravel bed specifically we exploit these statistical characteristics of bed topography at different scales and protruding microtopography extracted from dem to explore the effect of stress history subsequently the interplay between sediment transport and stress history and relations among microtopography spatial density characteristic grain sizes and statistical parameters of bed topography at different scales are discussed contributing more possible parameters for the optimization evaluation of flow resistance and bedload transport rate 2 methods 2 1 experimental setup the flume experiments were conducted in a rectangular flume with 8 5 m in length 0 4 m in width 0 4 m in height and a bed slope of sb 4 2 in the state key lab of hydraulics and mountain river engineering at sichuan university as illustrated in fig 1 a the flow was regulated by a rectangular weir with a wide top at the inlet generating a steady uniform flow in the open channel many plastic honeycomb tubes were spaced closely at the inlet section of a flume paralleling the flow direction for stabilizing flow the sediment was paved on a conveyor belt along the flume width and fed into the flume atop the starting of the patched rough reach using a conveyor belt feeder at a calibrated speed in the case of the splashdown of feeding particles from the belt to the riverbed an inclined plane with the top end near the belt and bottom close to the water surface was located underneath the exit of the conveyor the patched rough reach set as 6 5 m in length and 20 cm in depth was 1 0 m away from the inlet which was constituted by natural gravel and cobble ranging from 2 64 mm the grain size distribution curve was illustrated in fig 1b d 50 13 9 mm and d 84 27 0 mm in which the subscript denoted the percentile of finer grains the transitional reach with about 1 0 m length was composed of larger immobile cobbles of averaged size was 100 mm in case of scouring gravel bed and stabilizing flow to rough reach the outlet of rough reach was placed by a pvc vertical plate weir to stabilize the bed substratum a filtering basket with a 1 mm grid suspended from a tension sensor dyly 103 produced by bengbu da yang sensing system engineering co ltd weighted the carrying sediments at the outlet of rough reach and the sampling interval was set as 1 min in the case of the effect of the basket vibration inside and the water flow motion an approximate static water area was built to cover the basket under the current experimental configuration two limitations should be considered carefully to conduct the settings of flow condition and measurement firstly in the case of the effect of the flume wall boundary the ratio between flume width and water depth should be larger than 5 0 therefore the maximum flow depth in experiments was set to less than 0 08 m secondly for the full development of flow the measurement location of flow conditions should be set at more than 30 times the maximum flow depth from the entrance of the paved reach the starting measurement location of bed topography in experiments herein was set more than 3 0 m away from the entrance of the flume inlet and the ending location was set 1 5 m from the end of paved reach in case of the effect of the flume outlet so the final analyzing area of bed topography was 4 00 0 35 m2 by varying the magnitude and duration of flow discharge the experimental flow condition contained four periods including a the conditioning period b the first flood period c the interevent period and d the second flood period as illustrated in fig 2 the magnitude of flow discharge in the conditioning period was 5 0 l s 0 1 and the duration time lasted 1 0 h to avoid transient adjustment of the artificial paved gravel bed induced by the varying hydraulic condition and to remove any pores unstable particles and suspended sand during bed flattening subsequently the first flood was simulated by a steady discharge of 25 0 l s 0 1 and a non uniform sediment feeding rate qs in of 2 0 kg min 0 01 with the same size distribution of gravel bed for 0 5 h after the drastic change of bed topography the flow discharge was then decreased to generate a long duration low magnitude condition in the interevent period with a range from 5 0 l s to 7 0 l s for 1 0 h and 3 0 h during this period no sediment feeding upstream and transporting along the reach happened in all experiments subsequently the second flood period with the same flow and sediment configuration as the first flood period was operated again the detail of the experimental conditions was summarized in table 1 to get more information on the flow hydraulics bedload transport and bed topography the experiments were stopped frequently every 10 min in the flood period and every 0 5 or 1 h in the interevent period during each stop the water pump was turned off quickly and the water inside the flume was drained through several holes in the pvc vertical plate weir after finishing the following measurements the water was just drained with a slow flow rate and then increased flow discharge until the necessary flow was reached due to the large variation of bed topography and bedload transport no equilibrium state was reached through the experiments during the flood periods the bedload collected in the fliting basket at the channel outlet was weighted in real time with a 1 min sampling interval after the water flow was stopped with 10 min sampling interval the bedload was dried and then sieved to estimate the transported bedload size distribution characterized by the percentile values d16m d50m d84m before closing the pump water levels at 1 m intervals along the flow direction were measured by an ultrasonic sensor installed on the top platform above the flume with a precision of 0 001 m the water depths were calculated from the height difference between the water level and the riverbed at each stop a 2 mm high resolution digital elevation model dem of the bed topography along the analyzing area was determined by the structure from motion sfm photogrammetry method masteller and finnegan 2017 wang et al 2021 each bed configuration contained more than 500 overhead photos to ensure high coverage of the bed for analyzing the area of the channel bed the same photos were used to determine the grain size distribution gsd in the bed surface using basegrain 2 0 software for the so called photo sieving technique detert and weitbrecht 2012 the above experimental characteristics of flow and bedload size were set according to nyang river which was the largest tributary on the right bank of yarlung zangbo river in the qinghai tibet plateau the following statistical parameters of the nyang river could be found in national tibetan plateau data center luo et al 2022a the w d 50 of nyang river was about 29 68 which was very close to the flume experiment with a value of 28 78 the flow in the flood period was supercritical with fr larger than 1 0 similar to flume experiments with about 1 15 the relative water depth in the interevent period was about 2 23 similar to flume experiments with about 2 15 which belonged to the moderate scale roughness according to the discharge hydrograph measured at jiangzi hydrologic station in the upper of nyang river meanwhile the ratios of flow discharge and duration between flood period and interevent period were respectively 1 3 5 times and 1 3 times similar to 2 7 5 times and 1 3 times of flume experiments in this study above all all the experimental settings in this study were in line with the relevant conditions of flow and bedload transport in the nyang river 2 2 processing method of bed topography the gravel bed topography is extremely complex and necessary to be decomposed based on the scale magnitudes such as grain scale structure scale and large form scale perret et al 2020 structure scale bed topography is mainly composed of microtopography gathered by gravel particles while large form scale bed topography is made up of different kinds of microtopography to form step pools clusters and so on therefore it is vital to select a reasonable method to decompose bed topography for the whole characteristics of the riverbed and microtopography bertin et al 2017 the dem of the original bed topography with the resolution of 2 2 mm2 is fitted by the least square method to remove the original riverbed slope resulting in a detrended dem with the resolution of 2 2 mm2 seeing fig 3 a then a regular grid of the analyzing area with a point spacing of 1 25d 90 is determined and the elevations of grid points are averaged by the dem data points within a circle with a diameter of 2 5d 90 centered on the grid point due to the lower resolution ratio of this grid than the detrended dem the bedform dem is interpolated by the bicubic spline interpolation method from the above grid points seeing fig 3b finally the grain dem is achieved by the detrended dem minus the bedform dem seeing fig 3c to facilitate the following distinction subsequent parameters of statistical characteristics based on the grain dem and bedform dem are subscripted by grain and bedform respectively the holistic characteristics of riverbed elevation can be quantified by the coefficient of inclined ix standard deviation sd skewness sk kurtosis ku and dimensionless 2d variogram γ as illustrated in table 2 perret et al 2020 following the definition of microtopography microtopography could be extracted from high resolution dem including the distribution and spatial density with different protruding heights seeing a distribution case in fig 4 the extraction results show that the greater the protruding height above the mean riverbed of the microtopography the smaller the number of microtopography in the riverbed the microtopography spatial density λ could be quantified by the ratio between the fraction of the solid volume occupied by the microtopography and the total volume of the roughness layer assumed as the same height of microtopography luo et al 2022b hence the computation expression of λ is following 1 λ v g v 0 n p π p 3 n t π p 3 n p n t where v g is the solid volume occupied by the microtopography v 0 is the total volume of roughness layer n p is the grid number of microtopography higher than the average bed height of p n t is the total grid number of roughness layer it is reasonable to find that λ decreases nonlinearly as p increases due to the decrease of n p besides the distribution characteristic of microtopography is quantified by modified ripley s k function proposed by johnson 2017 which is a spatial statistic widely used in varying disciplines the modified ripley s k function is used to quantify the degree of microtopography in point data as follows 2 a k r a n p 2 i 1 n t i j j 1 n t i s i s j r 2 b j r k r π r where r is a lag distance a is the analyzing bed surface area s i s j is the euclidian distance between two different microtopography locations s i and s j dimensionless indicator i is 1 when s i s j r and zero when s i s j r for a complete spatial random csr distribution pattern k r increases as πr 2 and j r should equal 1 j r 1 for clustering distribution pattern while 0 j r 1 for inhibition distribution pattern 3 results 3 1 flow hydraulics the time series of water surface slope sw flow averaged depth h and flow averaged velocity u over the q 1 q inter and q 2 periods are presented in fig 5 during the first flood period sw increases overall by 1 despite some fluctuating between 0 027 and 0 041 m m with a mean value of 0 033 m m there is a small damping change with a mean value of 0 036 m m in the interevent period the values of sw in the second period are more fluctuated than in the first flood period but declines overall by 1 with a mean value of 0 036 m m in two flood periods there are both small varying in h and u with the differences of which are less than 1 0 cm and 0 05 m s respectively during the interevent period the differences of h and u are measured at less than 0 6 m and 0 03 m s respectively the results of flow hydraulics represent that the flow conditions through all experiments are similar besides it is noted that h and u have changed very little before and after the interevent period except for fluctuating sw 3 2 bedload transport before representing the bedload transport characteristics the measured precision of the tension sensor should be tested the comparison between the 10 min total weight generated by the sensor and the real weight measured by a calibrated balance is illustrated in fig 6 all scatters are within the 10 error lines with a mean error of 4 13 indicating good accuracy for measuring the following bedload transport rate fig 7 shows the time series of bedload transport rate over a 1 min window qs out 1 in the q 1 and q 2 periods suggesting large fluctuation with the unimodal bimodal and tri modal distribution the maximum rate is 0 15 kg s m and the occurrence time of the maximum transport rate is not sure sometimes at the beginning of 10 min or the end of 10 min through the experiments it s noted that the bedload transport rate is generally less than the upstream feeding rate in the first flood period while the number of the peak transport rate and the magnitude of transport rate both increased in the second flood period close to or more than the upstream feeding rate to further quantify the characteristics of bedload transport fluctuation the variation coefficient cv is used to analyze the effect of different flood interevent periods cv is defined as the ratio between standard error and mean value the larger cv value is the larger the dispersion degree between scatter values and the averaged value is and vice versa therefore the bedload transport fluctuation in the flood period can be quantified by the variation coefficient of bedload transport rate c v as follows 3 a s d q si q s 2 n 3 b c v s d q s where sd is the standard deviation of bedload transport rate overtime qsi is the bedload transport rate per the i th minute kg s m q s is the averaged bedload transport rate in the flood period kg s m n is the number of minutes during the flood period fig 8 shows the varying differences before and after the interevent period with different durations and discharges all positive values of cv represent the coefficient of the first flood period is slightly larger than that of the second flood period meaning the bedload transport fluctuation of the first flood is higher than that of the second flood what s vital experimental results find that the long duration of the interevent period with low cv coefficient restrains the variation of bedload transport fluctuation while the large magnitude of the interevent period with high cv coefficient enhances the variation of bedload transport fluctuation the reason for this fluctuation phenomenon is also tried to be interpreted in combination with varying protruding microtopography in section 4 1 the representative diameters of transport bedload over time per 10 min in the flood periods are illustrated in fig 9 e g d 16m d 50m d 84m d geom d 16m d 50m and d geom have represented a decreasing trend shown in fig 9 a b and d respectively no matter how long and what magnitude the interevent period goes the reduction magnitude of small and middle sizes in the first flood period is larger than that in the second flood period the main reason is that the bed surface at the beginning of the first flood period does not experience coarsening artificial paved bed surface while the riverbed in the second flood period has a rough layer with river structures induced by the flow it is worth noting the large size d 84m of transport bedload keeps relatively constant in fig 9 c 3 3 bed topography fig 10 a d show the statistical parameters results of grain scale bed topography the values of ix grain are positive in fig 10 a indicating that the gravel particles are arranged in an imbricate downstream pattern in the first flood period all values of ix grain increase over time because the artificial bed is arranged by the flood flow to form microtopography at the beginning of the flow in the second flood period most ix grain tend to decrease over time due to the riverbed compaction induced by the flood interevent period the variation of sd grain in fig 10 b is small whatever in the flood and interevent periods with the range between 0 006 and 0 008 the values of sk grain in fig 10 c are larger than zero stating the right skewed probability distribution of riverbed elevation in the first flood period the values of ku grain decrease by about 0 2 meaning the increasing mean elevation of riverbed or decreasing peak elevation of microtopography the values of ku grain in the interevent period have a little change in the subsequent flood period most values rise due to the enhancing height of the microtopography induced by upstream inflow and sediment supply the values of ku grain in fig 10 d are about 4 0 belonging to sharp and thick tailed distribution after the first flood the probability distribution of elevation in the interevent period approaches normal distribution with the ku grain value of about 3 0 the values of ku grain generally also rise due to the increasing protruding microtopography for the moment these statistical parameters of grain scale bed topography are not correlated with the magnitude and duration of the interval period but are mainly related to the inflow and sediment supply in the flood period fig 10 e h show the statistical parameters results of structure scale bed topography there are positive and negative values of ixbedform in the riverbed in fig 10 e this is due to the depositional tendency in the riverbed owing to cumulative microtopography where many small particles gather in front forming a positive slope s the back of microtopography is erosional to form deep pools and the downstream scouring distance is significantly smaller than the upstream depositional distance of the particles as the consequence the number of s is less than that of s so the value of ix bedform is positive however the microtopography is constantly disappearing and recombining the reason for negative ix bedform is the increasing number of s or decreasing number of s this generally corresponds to the compaction of discrete microtopography failing to form step pool structures in the riverbed and the total amount of s decreases fig 10 f h reveal that the statistical parameters of structure scale bed topography e g sd bedform sk bedform ku bedform have more variation than grain scale bed topography the change of structure scale bed topography in the flood period is mainly related to the inflow and water supply but in the flood interval the overall trend is to increase first and then decrease tending to be a smoother riverbed through an intermittent adjustment fig 11 a c demonstrate the isoline of dimensionless 2d variogram of diverse scale bed topography in the flood period the maximum sampling interval l x l y along the x direction and y direction are 2000 mm and 175 mm respectively which are greatly larger than the maximum sediment particle size of 64 mm the isoline mapping of γ is the benefit for identifying the isotropy and anisotropy of riverbed elevation the γ isoline of the undecomposed bed topography is not very smooth in fig 11 a showing winding contours γ isoline of bedform dem is significantly smooth and most of the corresponding isoline arise in the same position especially for γ 0 4 however the γ isoline of grain dem within the maximum particle size range 64 mm is close to the circular contour the circular contour gradually transits to the elliptic contours when the sampling interval further increases to 2 times the maximum particle size once the sampling interval is increased there are lots of irregular isoline due to the increasing probability of random elevations in the bed topography it s noted that the overall trend of the riverbed surface is determined by the riverbed structure while sediment particles only affect the fluctuation of the overall trend besides the γ isoline of undecomposed bed topography cannot estimate the flow direction well the γ isoline of grain dem can estimate the flow direction according to the major axis and minor axis of the isoline e g the major axis is the flow direction this method to estimate the flow direction is significantly improved compared with the method of directly using undecomposed bed topography aberle and nikora 2006 the i x value of γ 0 4 isoline at diverse scale bed topography is varied along x direction over time as illustrated in fig 12 a c the expanding of γ 0 4 isoline in the flood period demonstrates that the bed becomes coarsening due to washed fine sediment which is also verified by aberle and nikora 2006 the declining trend of γ 0 4 isoline in the interevent period shows that the bed becomes smoother mainly due to buried microtopography or adjusted bedforms according to the decomposing method of bed topography the bed surface topography in the interevent period becomes smooth because the bed bedform and bed surface particles are gradually adjusted however there is no deflection of 2d variogram isoline owing to coarse bedload size distribution in this study the flow capacity of transported bedload in the interevent period is not enough to shake the perturbation or deflection of coarse particles of microtopography but it is enough to shake fine particles shaded by microtopography generating the change of riverbed structure 3 4 protruding microtopography fig 13 a b shows the microtopography spatial density evaluated by eq 1 based on the different protruding heights p 5 15 25 mm varies with the duration of the interevent period it can be found that the spatial density in the cases of all protruding heights decreases with the increase of interevent duration and the microtopography with higher protruding heights has the greatest impact the decreasing trend suggests that the increased duration of the interevent period smooths the bed surface topography owing to buried microtopography or adjusted bedforms which is the same as the above results from the bed topography the relationships between the magnitude of the interevent period with the same duration and the microtopography spatial density based on the different protruding heights are as illustrated in fig 13 e p 5 mm f p 15 mm and g p 25 mm with the increase of flood magnitude in the interevent period the overall trend of the microtopography spatial density in all protruding heights rises and has the greatest impact on the coarse sediments it s noted that the interevent period with a longer duration and larger magnitude has the largest varying magnitude of the growth reaching 2 times this indicates that the large discharge in the interevent period provides kinetic energy for the coarsening of the bed surface although the interevent flow cannot initialize the coarse particles it is enough to further perturb the fine particles into the pores of bed material when the bed surface topography becomes smooth the higher protruding particles in the microtopography are further highlighted according to the experimental conditions the range of lag distance r is set to 25 500 mm when analyzing the distribution of microtopography to obtain statistically significant results the monte carlo method is used to generate random points by repeating 1000 times in the analysis area generating 97 5 and 2 5 percent confidence bounds on csr the correcting method for edge effect and other setting conditions are originated from johnson 2017 the distribution results evaluated by eq 2 with the protruding height of p 25 mm are illustrated in fig 14 in the small lag distance range e g generally within the width of the flume r 350 mm the microtopography represents a trend of clustering distribution with jagged curves j 1 with the increase in the lag distance j is close to the statistical characteristics of csr distribution in the large lag distance range with smooth curves 350 mm r 500 mm meanwhile the values of j increase over time indicating microtopography aggregation during the flood period in the second flood period the values of j reach the maximum at 20 min and then become smaller this is because the surrounding particles of the microtopography become unstable to move and reproduce new microtopography generating the decrease of j the whole values of j in the interevent period have no change especially in the small magnitude and short duration interevent periods seeing run 1 1 in fig 13 with the growth of magnitude and duration there is only the same trend in j with slight fluctuation in short it indicates that the microtopography in this experiment does not show obvious spatial distribution changes but only changes in spatial density seeing the comparison between fig 13 and fig 14 4 discussion 4 1 interplay between bedload transport and stress history after experiencing the interevent period the 10 min cumulative bedload transport rate qs out 10 has either increased or decreased compared with the 10 min cumulative value before the interevent period as illustrated in fig 15 a meanwhile the bedload transport fluctuation results show the strength of fluctuation has relation to the magnitude and duration of the interevent period as illustrated in fig 8 in the small magnitude of the interevent period the bed becomes more stable with the increasing duration of the interevent period resulting in the decreasing q s out 10 after the interevent period in the middle and large magnitudes of the interevent period however q s out 10 decreases after the short duration interevent period while increasing after the long duration interevent period the reason for decreasing q s out 10 and lower variation coefficient of bedload transport might be contributed to the more stable bed due to less flow drag induced by decreasing the microtopography spatial density but what accounts for the increase of q s out 10 and variation coefficient according to the investigation of experiments an assumption has been proposed plausibly that the increase in total bedload rate and bedload transport fluctuation after the long duration and middle large magnitude interevent period has a relationship with the unstable coarse particles of microtopography the magnitude of the interevent period can promote the microtopography spatial density generating large flow drag and unstable bed especially for middle large magnitude interevent as illustrated in fig 13d f the coarse particles of microtopography become unstable on the bed surface and are carried by flow to hit the bed surface randomly to generate abundant sediment ejection and transport increasing calculative bedload transport rate and higher bedload transport fluctuation after the interevent period to further prove the above assumption the relations of correlation and significant coefficients between fraction sizes in transported bedload and the first 10 min cumulative increasing bedload transport rates in the second flood period after the interevent are shown as illustrated in fig 15b the correlation between the fraction in bedload transport rate and the total bedload transport rate in the calculative 10 min firstly increases then decreases and subsequently increases and then decreases which represents a trend of the bimodal curve in other words except for the well known strong correlation between the median size bedload transport rate 17 mm and the total bedload transport rate the correlation coefficient reaches more than 0 85 while the correlation coefficient of coarse transported particles 35 mm also reaches 0 82 the strong correlation proves that coarse particles have also controlled the total bedload transport rate responding to the increasing value in this period what s more all fraction sizes in bedload are analyzed by statistical significance level the p value of coarse particles less than 0 01 is even lower than middle size particles demonstrating that there is a significant effect between the fraction bedload transport rate of coarse particles and the total value which also verifies the previous assumption in practice if the varying microtopography spatial density can be monitored and reconstructed by underwater cameras in real time it has the potential to interpolate bedload transport fluctuation in the gravel bed streams 4 2 relations between microtopography spatial density with different protruding heights and statistical parameters of bed topography at different scales the microtopography spatial density of different protruding heights in the riverbed is a fundamental element controlling flow and bedload movement which has been achieving more attention yet high resolution dem for detecting microtopography is not easily acquired and how to quantify the microtopography is ambiguous in this study the new index microtopography spatial density λ has the potential for evaluating the relation of microtopography in the riverbed the correlation relations between microtopography spatial density and statistical parameters of bed topography at different scales can be explored to replace them as illustrated in fig 16 fig 16 a demonstrates the varying trend of the correlation coefficient between statistical parameters of detrended dem and microtopography spatial density with different protruding heights it can be noted that there is a strong positive correlation between λ and sb the sb of gravel bed streams and rivers in mountainous regions is generally larger than that of plain rivers and the existence of a strong correlation indicates the rationality of the new index λ meanwhile most of the statistical parameters of bed topography are related to the protruding height of microtopography except for j r 25 400 mm the smaller the protruding height is the more information reflects the bed topography with the greater the correlation fig 16 b and c demonstrate the decreasing trend of correlation coefficients about bedform dem and grain dem with increasing protruding height with the maximum values of standard error respectively besides the correlation coefficients of grain dem are mostly larger than that of bedform dem it can be interpolated that the identification of microtopography is based on the grain scale in river topography the microtopography might be collected to form large scale structures on top of the riverbed for example step pools clusters and so on what s more it might also protrude a discrete microtopography with surrounding fine sediments which is neglected when calculating the statistical parameters of bedform dem nevertheless the microtopography spatial density is taken from all protruding microtopography whether discrete or collective subsequently resulting in a smaller correlation about bedform dem than grain dem 4 3 relations between characteristic grain sizes and statistical parameters of bed topography at different scales previous works have invested that relations between flow resistance or bedload transport rate and bed roughness of gravel bed streams are generally related to characteristic grain sizes e g k s 3 5d 84 chen et al 2020 powell 2018 wong and parker 2006 however a single parameter from characteristic grain size has not behaved the whole trend of bed roughness and may send misleading information it s a potential method to explore more relations with statistical parameters of bed topography at the different scales from the above high resolution dems based on the flume experiments data and processing methods of bed topography therefore the relations between characteristic grain sizes and statistical parameters of bed topography at the different scales are illustrated in fig 17 for microtopography spatial density with different protruding heights in fig 17 a c there are positive trends between small middle grain size and λ p 5 mm with the maximum correlation coefficient of 0 42 about small size grain next middle size grain however the maximum correlation coefficients corresponding to λ p 15 mm and p 25 mm have relations with middle size grain the above results demonstrate that λ in small protruding height is mainly related to the small and medium sized representative particle size and the larger the particle size is the larger value of λ is the reason may be that the coarse particles control the mean elevation of the bed surface after removing the trend when the small particle size becomes larger the threshold of the protruding height of the microtopography is closer to grain size hence the smaller the protruding height is the larger value of λ is for the standard error of bed surface elevation at different scales in fig 17 d f all characteristic grain sizes present positive relation to standard error the correlation coefficient between sd grain and d 50 is the largest with a value of 0 60 which is consistent with the previous study invested by bertin et al 2017 the remaining statistical parameters of skewness coefficient and kurtosis coefficient in fig 17 g l also have the maximum relation at the grain scale furthermore correlation analysis between characteristic grain sizes and statistical parameters of bed topography at the different scales can contribute to the optimization of parameters from the derivation evaluation of flow resistance and bedload transport rate while the physical mechanism of what s going on isn t exactly clear hence it is necessary to use the physical mechanism or numerical modelling to explain the rationality of the selection of riverbed statistical parameters from the perspective of the force balance of sediment particles affected by microtopography limited by laborious flume experiments and collection frequency in this study a numerical simulation method with lower cost and less time consuming can potentially configure either different discharge magnitudes or duration of the interevent period in varying gravel bed channels resulting in abundant experimental real time data with a higher resolution to further explore the detailed relationship between the fluctuation of bedload transport rate and bed topography what s more more field investigations using state of the art instrumentations with high resolution should be investigated to explore the intricate relations including bedload transport rate flow resistance and bed topography in the meandering bifurcated and compound gravel bed streams 5 conclusions this study conducts a series of flume experiments to quantify the relations between features of the bedload transport fluctuations and bed topography affected by different stress histories in a typical gravel bed channel the high resolution dem at different scales gained by the structure from motion sfm method is applied for the statistic parameters of overall bed topography and extracted to analyze the spatial density and distribution characteristics of protruding microtopography the experimental results show that the variation coefficient of bedload transport fluctuation in the first flood period is larger than the coefficient in the second flood period due to an artificial paved riverbed moreover the long duration of the interevent period restrains the variation of bedload transport fluctuation while the large magnitude of the interevent period enhances the variation of bedload transport fluctuation the bedload transport distribution is significantly affected by the magnitude of the interevent period rather than the duration for bed topography at different scales statistical parameters of grain scale bed topography are not correlated with the magnitude and duration of the interval period but the overall trends of structure scale bed topography increase first and then decrease in the interevent period indicating smoother riverbed through an intermittent adjustment according to the micromorphology spatial density and distribution under different protruding heights the spatial density in the flood period has higher variation than that in the interevent period besides the duration of the interevent period could decrease the spatial density while the magnitude of the interevent period could increase the spatial density and has the greatest impact on the coarse sediments what s more the reason for decreasing bedload cumulative transport rate and lower bedload transport fluctuation after short duration and small magnitude interevent period might be contributed to the stable bed owing to less flow drag induced by decreasing the microtopography spatial density however the assumption about the increasing rate and higher fluctuation after the long duration and middle large magnitude interevent period is verified that the magnitude of the interevent period can promote the microtopography spatial density to generate large flow drag hence the coarse particles of microtopography on the bed surface become unstable and are carried to randomly hit the bed surface generating abundant sediment ejection and transport in addition the relations among microtopography spatial density characteristic grain sizes and statistical parameters of bed topography at the different scales are explored by correlation analysis indicating bed topography at the grain scale has more relation with bed topography these relations can contribute to more potential parameters for the optimization evaluation of flow resistance and bedload transport rate above all the study of complex relationships among seasonal flow bedload transport and microtopography in mountainous gravel bed streams has important scientific significance and practical value for fluvial geomorphology evolution flood disaster prevention and ecological restoration which is also urgent to study and advance the mechanics of sediment motion credit authorship contribution statement ming luo conceptualization formal analysis investigation methodology writing original draft writing review editing yurun jiang data curation methodology sen wang data curation validation xingnian liu funding acquisition supervision er huang funding acquisition supervision validation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research is supported by the second tibetan plateau scientific expedition and research program grant no 2019qzkk020401 the surface grain size distribution of the nyang river dataset can be found in national tibetan plateau data center http data tpdc ac cn thanks to anonymous reviewers and editors for their useful and careful critiques for improving this research the authors also want to thank xiaokang wu and wenqi li to assist in conducting flume experiments and useful discussions 
2594,low lying coastal areas are susceptible to multiple types of flooding from marine subsurface and surface sources the co occurrence of a rainfall event with high sea level which raises coastal groundwater tables conjointly may result in a compound flooding event which could be much more widespread and dangerous than that of an individual flooding source focusing on imperial beach as a low elevation coastal community in california this paper provides a generalized methodology to determine the vulnerability of coastal stormdrain systems to compound seawater groundwater and stormwater flooding under a changing climate although marine inundation by itself is expected to flood only 7 of the study area by 2100 under the most pessimistic scenario i e 2 m rise our results show that more than 20 of the study area s subterranean stormdrain system is already at the risk of subsurface flooding at current sea levels while marine inundation is a concern near the coastline as sea level rises the results show that seawater intrusion into the stormdrain system can impact areas kilometers away from the coastline the consequences of sea level rise slr can be exacerbated by an under resourced stormdrain system caused by groundwater infiltration through system defects as such by a 2 m rise in current sea level the flooding volume may double in an ideal system i e no defects while this ratio can increase six fold in a slightly defective stormdrain system with 0 25 porosity systemwide the continuous simulations of the stormdrain system performance indicate that flood events will be more destructive and frequent under these circumstances abbreviations aeff effective area of a conduit for groundwater infiltration m2 c1 c2 c3 and c4 abbreviations used for specifying conduits cd discharge coefficient of a circular orifice d circular conduit diameter m d circular defect diameter m eld rim elevation of the downstream node of a conduit m elu rim elevation of the upstream node of a conduit m gwi groundwater infiltration m3 s gwii gwi in the presence of swi m3 s gwij gwi in the absence of swi m3 s gwik gwi in the absence of swi when gwt sea level m3 s gwt groundwater table m gwtave average gwt on a conduit m g gravity acceleration 9 81 m s2 hg groundwater head on a conduit m k hydraulic conductivity m day l conduit length m leff effective length of a conduit for groundwater infiltration m lecz low elevation coastal zone mi marine inundation n number of defects p system porosity qd groundwater infiltration rate through a single defect m3 s r hydraulic radius of a non circular conduit m slr sea level rise m swi seawater intrusion m3 s ε soil void ratio keywords climate change sea level rise coastal areas compound flooding groundwater infiltration stormdrain system data availability data will be made available on request 1 introduction global warming attributed to greenhouse gas emissions is changing the natural water cycle on the earth in the wake of melting glaciers and ice sheets as well as thermal expansion of ocean water the global mean sea level has increased at a rate of 3 1 mm year since the mid 1990s sweet et al 2022 which is faster than any equivalent period over at least the last 2700 years kopp et al 2016 depending on future emissions the continental us coastline is projected to see 0 6 2 2 m of sea level rise slr at the end of the century sweet et al 2022 climate projections also raise concerns about how precipitation will respond in a warming world while longer droughts are expected in most regions due to rising temperatures attributed to higher surface evaporation global models project a 16 24 increase in heavy precipitation intensity by 2100 associated with larger water holding capacity of the warmer air fischer et al 2014 trenberth 2011 as shown in fig 1 due to the interactions of oceanographic hydrological and meteorological processes low lying coastal areas are susceptible to different sources of marine subsurface and surface inundation especially after considering climate change effects on water resources befus et al 2020 bevacqua et al 2019 thus efficient management of coastal drainage systems requires new information about the current and future role of seawater and groundwater sources along with the typical stormwater source in urban flooding currently over 20 million people of the world s population are permanently exposed to marine inundation while more than 200 million people are vulnerable to marine flooding during temporary extreme high sea level events nicholls 2011 slr will enhance coastal marine inundation zone i in fig 1 which has been projected to impact 13 million people directly in the united states by 2100 assuming 1 8 m of slr hauer et al 2016 slr also will magnify the impacts of extreme sea level events as their frequency and magnitude follow a sharply escalating pattern thompson et al 2021 vitousek et al 2017 according to kirezci et al 2020 for a 1 meter slr scenario at the end of the current century there will be a 50 increase in the global population assets and land area at risk of seawater flooding the projected slr will dramatically threaten coastal communities and ecosystems such that it may shift the coastline landward accelerate cliff failure and beach erosion degrade coastal habitats and aquifers and potentially damage coastal infrastructure arkema et al 2013 dawson et al 2009 nicholls and cazenave 2010 rotzoll and fletcher 2013 while flood control measures typically are designed to protect coastal communities from seawater flooding there is growing recognition that low elevation coastal zones lecz coastal areas below 10 m of elevation above sea level also are vulnerable to subsurface flooding zone ii in fig 1 befus et al 2020 coastal groundwater tables are dynamically connected to sea levels and thus their inland responses to slr known as groundwater emergence and shoaling may pose a further threat to terrestrial infrastructure and natural resources hoover et al 2017 sukop et al 2018 by modeling groundwater flow in a dense urban site along the hudson river estuary in new jersey su et al 2022 predicted that for slr up to 1 m one third of the study area would be impacted by subsurface flooding across urbanized coastal zones shallow groundwater i e 2 m depth also may immerse subterranean infrastructures e g drainage and sewer networks electric and gas substations building foundations and cause serious disruptions to their operation maintenance and development habel et al 2020 rotzoll and fletcher 2013 besides intensifying chemical corrosion and deterioration high level groundwater can intrude into water conveyance networks through their defects e g holes cracks and misaligned joints and increase their hydraulic loading dirckx et al 2016 karpf and krebs 2011 su et al 2022 previous studies indicate that groundwater infiltration into sewer systems ranges from 30 to 72 of total sewage flow zhao et al 2020 which may triple in leczs with 1 m slr fung and babcock 2020 compared to soil type and sewer pipe characteristics the groundwater table is the most important parameter affecting groundwater infiltration in leczs liu et al 2021 considering rainfall events and subsequent stormwater runoff as a key source of inundation zone iii in fig 1 leczs are critically exposed to compound flooding where multiple flooding pathways co occur jang and chang 2022 rahimi et al 2020 through compound events when heavy precipitation coincides with an extreme sea level event the flooding extent substantially increases compared to that of either in isolation moftakhari et al 2019 saharia et al 2021 wahl et al 2015 for example by coupling heavy rainfall and high sea level events around 80 of the city of new orleans in the united states was inundated for several weeks in 2005 moghimi et al 2021 the vulnerability of coastal communities to compound flooding is expected to critically exacerbate over the century due to slr and climate change effects on heavy rainfall patterns which lead to further reductions in terrestrial infiltration ponding and drainage capacity davtalab et al 2020 karamouz et al 2015 in recent years enhanced awareness of the potentially catastrophic impacts of compound flooding on human lives and property has motivated new assessments of the multiple and interconnected drivers of compound flooding in different natural and urbanized areas table 1 presents a summary of recent selected studies on compound flooding using mike urban 1d model and focusing on the number of flooded junctions and flood frequency laster grip et al 2021 simulated the performance of a coastal stormdrain system under coupled events of slr storm surge and rainfall while the model was neither calibrated nor validated their comparative studies reported that although the impact of slr is not evident today a tipping point will occur in 2075 2100 after which storm surges become a major driver for stormdrain system failure while rainfall induced stormwater flooding was not included in the studies of gold et al 2022 and habel et al 2020 their evaluation of stormdrain system performance under high tides showed that the system may flood due to seawater backflow even in the absence of precipitation by studying coupled storm surge and rainfall events tahvildari et al 2022 and khanam et al 2021 quantified the flooding extent as a measure of the potential threat to roadway networks and electric infrastructure during compound events davtalab et al 2020 and rahimi et al 2020 reported higher risks of flooding in retention ponds and riverine streams during slr induced groundwater rise associated with the reduction in their infiltration and discharge capacity respectively although the previous studies listed in table 1 confirm the vulnerability of coastal communities to compound flooding events due to the multiplicity and complexity of involved mechanisms additional research is needed to quantify compound flooding risk and subsequently establish efficient adaptation strategies for mitigating climate change stresses on water infrastructures this study develops a novel and general framework to assess the vulnerability of coastal stormdrain systems to compound mechanisms of seawater groundwater and stormwater flooding under emerging climate change scenarios we focus on a case study of imperial beach ib which is a coastal community in california surrounded by water bodies on three sides and vulnerable to compound flooding fig 2 a different sources of marine subsurface and surface inundations shown in fig 1 are evaluated using a bathtub approach the modflow groundwater model developed by befus et al 2020 and the integrated hydrology hydraulic pcswwm model developed for this study arcgis is utilized for geospatial analysis and flood mapping the principal objectives of this study are to identify the extent and volume of seawater intrusion and groundwater infiltration into coastal stormdrain systems by studying different scenarios for slr hydraulic conductivity and system defects advance knowledge on the vulnerability of coastal drainage infrastructure to coupled oceanographic hydrological and meteorological stressors and examine climate change impacts i e slr groundwater rise and more intense rainfall on the performance of coastal stormdrain systems through estimating the extent and frequency of flood events 2 material and methods 2 1 study area imperial beach ib is the southwestern most city in the continental united states with 30 thousand population 5 5 km2 area 2 5 km coastline and 2 10 m elevation gallien 2016 as a lecz the residential area of this underserved community is surrounded by water bodies from three sides the pacific ocean on the west san diego bay on the north and tijuana estuary on the south fig 2 a due to its unique setting and aged water infrastructure ib is vulnerable to compound flooding particularly when a rainfall event occurs while the stormdrain system is significantly occupied by seawater intrusion swi and or groundwater infiltration gwi 2 2 primary datasets table 2 describes the main datasets obtained and utilized in this study topographic data is acquired from a high resolution digital elevation model dem with 0 762 m 0 762 m resolution provided by the san diego association of governments sandag the sea level records are obtained from the national oceanic and atmospheric administration noaa for the san diego bay station id 9410170 which is the closest tide station to the study area located 20 km north of ib with over a 100 year record following noaa s regional slr scenarios we examine slr 0 1 and 2 m the scenario of slr 0 m refers to the present day sea level at mean higher high water mhhw 1 658 m referenced to the north american vertical datum of 1988 navd88 while 1 and 2 m represent intermediate and high scenarios of slr by 2100 associated with moderate and high greenhouse gas emission scenarios over the century sweet et al 2022 mhhw is obtained for the most recent 19 years 2002 2021 providing an estimation of high water levels that are persistently and frequently reached in the region hoover et al 2017 groundwater flow is generally described by darcy s law which can be combined with conservation of mass to obtain a partial differential equation describing the distribution of hydraulic head as the target parameter langevin et al 2017 in this research groundwater table gwt data is acquired and analyzed from the modflow model developed by befus et al 2020 these researchers assessed the steady state and three dimensional responses of gwt to various slr scenarios across the california coast including ib for three values of hydraulic conductivity k 0 1 1 and 10 m day to validate the applicability of modflow results for ib we have compared the modeled gwt at local mean sea level lmsl with temporal mean values of the observed gwt in nearby groundwater sites available on the united states geological survey usgs website the best agreement between modeled and observed time averaged gwt within 20 is found for k 1 m d fig 2 thus to obtain the spatial distribution of gwt across ib the present study has utilized the modflow data for k 1 m day and the mentioned slr scenarios in table 2 the primary input parameters for the stormwater model pcswmm described below in section 2 3 3 stormwater modeling include stormdrain system specifications rainfall and evaporation data soil properties and land use characteristics the spatial and geometric specifications of the stormdrain system elements i e conduits junctions and outfalls are available at the data warehouse of the city of ib www imperialbeachca gov stormwater gaps in the data have been filled through contacting the environmental natural resources department in ib and conducting in situ and virtual field visits by our research team and google street view the hydrological package of sd hydro tools developed by the county of san diego is utilized to generate 24 hr nested design storms having 1 year 2 year and 100 year return periods from noaa s precipitation frequency data the design storms with 1 year and 2 year return periods represent heavy rainfall events while extreme rainfall events are represented by 100 year return period occurring on average once in a century in addition 38 years of rainfall data with a 1 hour interval are obtained from project clean water www projectcleanwater org to perform a continuous simulation of the stormdrain system performance from fig 3 the time interval of 1983 1986 water years with the maximum yearly monthly daily and hourly values of 531 198 76 and 28 mm is considered as the representative wet period and imported in the model other involved parameters in stormwater modeling i e subcatchment roughness imperviousness and infiltration in addition to conduit roughness and energy loss are set by referring to local sources covering the study area e g the city of san diego stormwater standards 2021 and county of san diego hydrology manual 2003 these parameters are described in the section 2 3 3 2 3 methods 2 3 1 marine and subsurface inundations fig 4 presents the workflow carried out in the present study steps the first studied component is marin inundation mi which represents the passive flooding from seawater across the coastline at mhhw level as shown in fig 5 a and described in section 3 1 other sea related flooding sources like storm surge and wave runup are not included in mi due to the focus of this research on the inland drainage system the vulnerable locations to mi are identified using a bathtub approach in arcgis which subtracts the sea level elevation in a given scenario from the dem to identify the areas that host elevations below that of the seawater surface habel et al 2020 due to topographic obstructions the identified areas without a surficial connection to the marine source are excluded from mi although the subsurface inundation still threatens these areas by flooding from underneath rotzoll and fletcher 2013 through subtracting gwt elevation from the dem a similar method is applied to identify the areas potentially vulnerable to groundwater emergence and shoaling as shown in fig 5 b and described in section 3 1 2 3 2 seawater intrusion and groundwater infiltration flow conveyed through the stormwater network ultimately discharges through the outfalls represented by red filled circles in fig 5 by generating a reverse flow swi through the outfalls may limit the discharge capacity of the system at high sea level conditions this oceanographic stressor is considered in the stormdrain model simply by setting a fixed water elevation in the outfalls corresponding to the sea level elevation for a given scenario generally stormdrain system elements are susceptible to swi if their elevations are lower than sea level as drainage pipes age high level groundwater may infiltrate into the system through the defects on the pipe walls and result in an increased hydraulic loading see fig 6 a thus in the case of having a defective system stormdrain system elements are susceptible to gwi if their elevations are lower than local gwt this study considers groundwater head hg and system porosity p to estimate gwi rate into the stormdrain system considering the small variations of gwt 5 cm changes over 95 of conduits its average value above each conduit gwtave was used for gwi determination see fig 6 b having a uniform value for the whole system p is defined as the ratio of defect to conduit surface area in percent results independency from defect position and size due to the lack of stormdrain monitoring data three scenarios of p 0 000 0 125 and 0 250 are defined in this study to evaluate the effects of system defects on its performance understanding the differences between stormwater and sewer networks these scenarios are defined based on the cctv sewer inspection dataset conducted in ib in 2014 courtesy of the city of ib to simplify the gwi calculation non circular conduits consisting of 5 of total conduits are approximated by equivalent circles d 4r where d and r are the equivalent circle diameter and the hydraulic radius of non circular conduits respectively the following assumptions are made to simplify the problem making it suitable for city scale long term simulations i the surrounding soil is homogeneous and isotropic ii all system defects are in a regular circular form in the order of cm and uniformly distributed on the conduits the results are independent of defect position and size and iii possible groundwater flow effects in terms of washing the surrounding soil can be neglected consequently a modified form of the head discharge equation for a circular orifice guo and zhu 2017 is used to determine the amount of gwi into the system 1 gwi q d n p a eff 25 π ε c d g h g q d ε c d d 2 g h g n p a e f f 100 a d where qd infiltration rate through a single defect n number of defects ε void ratio of the surrounding soil 0 2 cd discharge coefficient of a circular orifice 0 6 d circular defect diameter g gravity acceleration and aeff effective area for receiving gwi conduit surface area under gwt as shown in fig 6 c hg and aeff are estimated for each conduit based on its situation with respect to gwtave elevation in addition in the case of swi into a conduit the amount of gwi is determined through the presented superposition in fig 6 d the calculated amount of gwi for each conduit is subsequently assigned as a constant flow rate to its upstream junction in the pcswmm model 2 3 3 stormwater modeling to simulate the stormdrain system performance an integrated hydrology hydraulic model is developed using pcswmm version 7 4 3240 with swmm5 engine to estimate surface runoff produced by rainfall over urban subcatchments a nonlinear reservoir model is used along with manning equation eqs 2 and 3 flow routing within conduits is governed by the conservation of mass and momentum eqs 4 and 5 known as 1d saint venant equations rossman 2015 the complete form of these equations which refers to an unsteady and non uniform flow in the system is solved using the finite difference method 2 c h a n g e i n d e p t h o v e r t i m e d t i e f q i r a t e o f r a i n f a l l s n o w m e l t a n d r u n o n e e v a p o r a t i o n r a t e f i n f i l t r a t i o n r a t e q r u n o f f r a t e p e r u n i t s u r f a c e a r e a 3 q q a 1 n r 2 3 s f 1 2 q r u n o f f v o l u m e t r i c f l o w r a t e a f l o w a r e a w d d s n m a n n i n g r o u g h n e s s c o e f f i c i e n t d s d e p r e s s i o n s t o r a g e w s u b c a t c h m e n t w i d t h r h y d r a u l i c r a d i u s d d s s f f r i c t i o n s l o p e b e d s l o p e s 0 i n u n i f o r m f l o w 4 q t q 2 a x g a h x g a s f 0 q v o l u m e t r i c f l o w r a t e a v a f l o w a r e a v f l o w v e l o c i t y h h y d r a u l i c h e a d z y z e l e v a t i o n y f l o w d e p t h g g r a v i t y a c c e l e r a t i o n 5 a t q x 0 as shown in fig 7 the study area consisting of 20 major drainage basins is divided into 122 fine resolution subcatchments to provide a precise rainfall to runoff modeling in the study area in addition the stormdrain system is described in a substantially high resolution by having 263 conduits in the model linked to 200 open and 63 close junctions referring to the san diego s stormwater standards 2017 the green ampt method is selected for infiltration modeling while manning roughness coefficients for subcatchments and conduits are determined in the ranges of 0 024 0 200 and 0 013 0 030 respectively the energy loss coefficients at the entrance and exit conduits range from 0 1 1 0 based on their relative diameters to the neighboring junctions frost 2006 to calibrate and verify the model wet weather field monitoring data courtesy of john wood group plc is obtained with a 1 min interval at the specified location in fig 7 in the vicinity of ib s public library where the system is free of swi and gwi in current conditions see fig 5 b satisfying the recommended ranges by the san diego s hydrology manual 2003 for different land uses the subcatchment imperviousness is set as the target parameter for calibration ranging 25 80 according to fig 8 there is an outstanding agreement between the modeled and measured data for both calibration and verification periods the modeled flow characteristics i e stormdrain inflow and depth match well with the measurements in terms of both the timing and magnitude of peak flow 20 difference twenty scenarios are studied in this research table 3 to comprehensively evaluate the effects of slr system porosity and rainfall properties on the performance of coastal stormdrain systems according to fischer et al 2014 a 25 increase in heavy rainfalls could be expected in southern california by 2100 in table 3 the nested storm with a 2 year return period corresponds to that increase in the intensity of the nested storm with a 1 year return period thus this magnitude of rainfall could be expected to happen every year instead of every other year in the region by the end of the century however no significant change in the annual mean precipitation is expected in the region fischer et al 2014 3 results and discussion 3 1 extent of marine and subsurface inundations to improve the understanding of the vulnerability of coastal water infrastructure and resources to slr the first step is to assess the inundation potential slr driven marine and subsurface inundation extents are shown in fig 5 and table 4 summarizes the estimates of the impacted urbanized areas under no moderate and high slr scenarios the baseline year for the present day condition slr 0 m scenarios is 2021 from fig 2 a and fig 5 a tijuana estuary and its natural ecosystem will be extensively and directly impacted by marine inundation as sea level rises however marine inundation is predicted to have minimal impacts on the urbanized populated region where the present study focuses on for slr 0 1 2 m scenarios 0 00 0 44 and 6 74 of the urbanized area is under marine inundation respectively table 4 the urban area inundation is limited to the san diego bay shoreline and the ocean facing coast particularly along the thin strip between the ocean and estuary from fig 5 b and table 4 groundwater emergence and shoaling pose a more widespread threat than marine inundation for all slr scenarios in the current sea level conditions groundwater shoaling with a depth 2 m threaten subsurface urban infrastructure in 8 5 of the populated region including areas far from the coastline the slr induced groundwater rise will increase this number to 16 98 and 23 01 for 1 and 2 m slr therefore for the high slr scenario it is expected that around 30 of the city will be permanently threatened by marine inundation and shallow gwt at the end of the century it is worth noting that both marine and subsurface inundations can be more widespread during dynamic ocean conditions i e storm surge and wave action which are excluded in the present study because of its focus on the long term performance of the inland drainage system in terms of spatial distribution it is expected that the regions closer to the sea will be heavily impacted during dynamic sea level events laster grip et al 2021 from the studies of gallien 2016 and merrifield et al 2021 on ib the ocean shoreline will be particularly vulnerable to wave driven impacts anderson et al 2018 showed that the flooded area mapped in three hawaiian islands can be increased up to 50 by adding wave inundation to the passive flooding in addition a king tide can temporarily raise inland gwt while its fluctuations attenuate at a distance in the order of 1 km from the shoreline rotzoll and fletcher 2013 3 2 extent of seawater intrusion and groundwater infiltration a substantial portion of the ib s stormdrain conduits is at risk of swi and gwi through outfalls and system defects respectively fig 5 b from table 4 about 11 and 60 of the conduits with an invert elevation lower than sea level at mhhw may experience some amount of swi at the current and high sea level conditions respectively in addition the stormdrain conduits located in the emergent to shallow groundwater regions fig 5 b are the most sensitive to gwi enlarging by slr induced groundwater rise at the high slr scenario 67 of the stormdrain length will be susceptible to gwi this number is more than twice the above mentioned percentage for the city area experiencing shallow gwt with a depth of 2 m which is the typical depth for stormdrain systems this difference is because a water drainage system with gravity driven flow is typically located in low lying regions of an urbanized area where the risk of emergent to shallow groundwater is the highest therefore water drainage systems are one of the most vulnerable coastal infrastructures to slr impacts the estimations of gwi for different scenarios are plotted by the red line graphs in fig 6 e as expected this parameter increases by rising sea level and spreading system defects while it grows about four times by a 2 m slr gwi and p change with the same factor for a given sea level due to assuming a uniform distribution of defects on the system to have a better sense of the extent of this additional stressor gwi is also normalized by the maximum total inflow during a 24 hr rainfall with a 1 year return period as shown by the blue line data in fig 6 e gwi can consist of 20 of the maximum total inflow at slr 1 m however gwi may form a smaller part of the total inflow at higher slr because of an increase in swi contribution it should be noted that the slr induced groundwater lift in leczs can cause some additional issues like exposing the public to sewage effluent contamination and degrading groundwater quality through saltwater intrusion into coastal aquifers as shown in fig 1 and failure of immersed cesspool systems befus et al 2020 habel et al 2020 habel et al 2017 these topics merit more research beyond the present study scope 3 3 compound flooding the main effects of slr rainfall intensity and stormdrain system porosity on its performance are presented in fig 9 a as these parameters increase which is expected to happen due to climate change effects and lack of maintenance in underserved areas a higher percentage of inland junctions will flood shown by the blue line graphs in the top left chart the red line graphs in other charts show that the stormdrain compound flooding is projected to increase in total area depth volume and time over the century we note that the junctions located in marine inundation areas are excluded from the stormdrain flooding analysis this point may explain why the number of flooding junctions shown by the red line graphs in the top left chart is not a monotonic increasing function of slr at p 0 unlike their total values the average values of the flood properties shown by the blue line graphs in other charts do not have a monotonic increasing trend with the rainfall return period this is because although total flooding values increase during a 2 year rainfall event more stormwater inflow the increase in the number of flooding junctions may be larger as a result the average value may decrease i e average value total value number of flooding junctions interaction between different parameters implies that the effect produced by changing one parameter depends on the level of other parameters sangsefidi et al 2017 fig 9 b indicates the interactive effects of the three studied parameters on the total flooding volume the vertical axis titles of the graphs are described in the figure caption as shown a more defective system will be impacted by slr to a greater extent such that under a 1 year rainfall event the flooding volume will grow up to 6 times by a 2 m rise in seal level when p 0 25 however this ratio may decrease to less than a third by avoiding gwi into the system p 0 moreover since the stormwater contribution to compound flooding increases by an increase in rainfall return period the flooding extent is less sensitive to swi and gwi under more extreme rainfall events fig 10 shows today s observations of frequently flooded locations courtesy of the city of ib and fig 11 presents the flooding extent maps obtained from the developed stormwater model for five selective scenarios in current and future conditions defined in table 3 as a ground truth fig 10 reveals that even for the current sea level conditions there are still serious problems across the city for draining stormwater from low intensity rainfalls this point also can be found from the presented flooding maps for s0 p0 000 r1 and s0 p0 250 r1 scenarios in fig 11 on which the nine frequently flooded locations are pinpointed considering the small extents of swi and gwi at slr 0 m fig 5 b the main driver of these floods should be rainfall induced stormwater from the comparisons of the two mentioned scenarios in fig 11 it can be found that the effects of system porosity are not significant in the current sea level conditions i e low gwt values in the region by sea level rising over the century swi may have a significant contribution in the stormdrain inflow and flooding s2 p0 000 r1 scenario however comparison of the s2 p0 000 r1 and s2 p0 250 r1 scenarios indicates that the slr impacts are considerably more severe for higher p values because gwi leads to a further increase in the hydraulic loadings on the system in these circumstances as a result the flooding hotspots during more frequent design storms i e 1 year return period generally correspond to the shallow gwt regions depicted in fig 5 b comparing the s0 p0 000 r1 and s2 p0 250 r1 scenarios fig 11 the most important insight is that adverse impacts of slr are not limited to marine inundation and a potential landward shift in the shoreline slr also can impact regions kilometers from the coastline through contributions to compound flooding events the expected 25 increase in the heavy rainfall intensities by climate change effects over the century annual occurrence of the current 2 year rainfall in 2100 may cause additional stress on the system and enlarge the compound flooding extend even more s2 p0 250 r2 scenario based on the performed continuous simulations for the 4 year representative wet period the long term performance of the stormdrain system as opposed to a single design storm is analyzed by focusing on the selective junctions specified on the legend and bottom left map in fig 11 as shown the selected junction on each stormdrain line has a critical flooding condition compared to other junctions on that specific line in addition these junctions are selected from eight major stormdrain lines to inform us about various conditions of the system referring to fig 5 b some selective junctions may be invulnerable to swi and gwi while other ones can be susceptible to either swi gwi or both fig 12 a presents the frequency and number of flood events with a separation time of 6 h as shown some parts of the system i e k 629 and s 583 junctions may experience similar flooding events in different scenarios because they receive neither swi nor gwi previously depicted in fig 5 b however for those parts susceptible to either swi or gwi the flood events are expected to happen more frequently depending on the amount of these additional stressors for example since junction e 592 is at the risk of both swi and gwi at slr 2 m a higher number of flooding events is expected for this area compared to the current conditions jumps in the data for s2 p0 000 continuous and s2 p0 250 continuous scenarios in fig 12 a more challenging some parts of the system may be always flooding at the end of the century i e a 982 f 614 and h 610 junctions with a flood event frequency of 1 attributed to the high amount of swi and gwi fig 5 b shows the 11 sunny day flooding junctions across the study area for slr 2 m and p 0 25 which are generally located in low lying areas with emergent to shallow groundwater fig 12 b demonstrates the flood frequency volume plots for some of the selective junctions as expected larger floods happen less frequently in the region and vice versa due to the contribution of swi and gwi into stormdrain inflow a flood with a given frequency will have a larger extent or conversely a given flood is expected to happen more frequently in the future the effects of the slr induced stressors are more significant in more frequent floods especially in the sunny day flooding areas however the difference between the data for s0 p0 000 continuous and s2 p0 250 continuous scenarios diminishes at lower values of flood frequency and they eventually converge to each other for very extreme floods in these circumstances the contributions of seawater and groundwater sources in compound flooding are insignificant compared to that of the stormwater source as a result the flooding extent is highly dependent on the typical drainage characteristics of subcatchments rather than swi and gwi to improve our understanding of compound flooding extent and to develop adaptation strategies we intend to pursue the following future research through installation of four groundwater wells inside imperial beach the research team is collecting gwt data and estimating k in different areas of the city these data will be utilized to develop a high resolution 3d groundwater model to understand the spatial and temporal connection of sea level events with groundwater flow and contaminant transport while rainfall is the main contributor to urban flooding in today s climate storm waves may become the dominant stressor in the future especially in downstream areas closer to the sea in terms of temporal distribution there also might be a shift in the dominant period from spring autumn rain induced flooding to winter sea induced flooding due to energetic storm wave events originating in the north pacific kunkel and champion 2019 laster grip et al 2021 by adding storm wave action and local wind driven surge to coastal stressors and including more site specific conditions a new 2d stormwater model will be developed and coupled with the groundwater model to determine emerging compound floodplains which will be helpful for slr mitigation and adaptation besides exposure to flood events socioeconomic factors e g race income public health and education level also should be taken into account for assessing the overall vulnerability of a community bathi and das 2016 in fact identifying vulnerable population groups can be beneficial for prioritizing resources for underserved people through conducting extensive social studies and understanding the community barriers and motivations adaption solutions will consist of environmentally friendly engineered designs to protect the community against coastal climate change in a resilient and sustainable manner 4 conclusion and future works this paper evaluates the vulnerability of the coastal stormdrain system at imperial beach to compound flooding of seawater groundwater and stormwater sources under climate change effects and possible impacts of lack maintenance due to resource limitations the main conclusions are based on estimates of slr driven marine and subsurface inundations we find that about two thirds of the stormdrain length could be susceptible to swi and gwi under the high slr scenario of 2 m in these conditions gwi is estimated to increase up to 4 times and consist of twenty percent of the system hydraulic loads during annual rainfall events with the contribution of swi and gwi the compound flooding extent will significantly increase in all forms of flooding depth area and time and it can impact some areas kilometers away from the coastline for a defective system p 0 25 working under a 1 year rainfall event the flooding volume increases up to 6 times by a 2 m increase in current sea level however the flooding volume can be reduced to less than a third by repairing system defects and avoiding gwi into the system when slr 2 m the oceanographic and hydrological stressors of swi and gwi can also increase the frequency of flooding events in the region while some low lying areas with emergent to shallow groundwater may suffer sunny day flooding during extreme rainfall events e g 100 year return period the stormwater source dominates swi and gwi i e the system may fail solely by stormwater regardless of the other coastal stressors credit authorship contribution statement yousef sangsefidi conceptualization methodology software validation formal analysis investigation data curation writing original draft writing review editing visualization kian bagheri methodology software writing review editing hassan davani conceptualization methodology resources writing review editing supervision project administration funding acquisition mark merrifield methodology resources writing review editing project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research has been supported by the national science foundation under grants no 2113987 and 2113984 we appreciate the support of computational hydraulics int chi the city of imperial beach particularly mr chris helmer and john wood group plc for providing us with access to the pcswmm license stormdrain geometric data and stormwater measurements respectively 
2594,low lying coastal areas are susceptible to multiple types of flooding from marine subsurface and surface sources the co occurrence of a rainfall event with high sea level which raises coastal groundwater tables conjointly may result in a compound flooding event which could be much more widespread and dangerous than that of an individual flooding source focusing on imperial beach as a low elevation coastal community in california this paper provides a generalized methodology to determine the vulnerability of coastal stormdrain systems to compound seawater groundwater and stormwater flooding under a changing climate although marine inundation by itself is expected to flood only 7 of the study area by 2100 under the most pessimistic scenario i e 2 m rise our results show that more than 20 of the study area s subterranean stormdrain system is already at the risk of subsurface flooding at current sea levels while marine inundation is a concern near the coastline as sea level rises the results show that seawater intrusion into the stormdrain system can impact areas kilometers away from the coastline the consequences of sea level rise slr can be exacerbated by an under resourced stormdrain system caused by groundwater infiltration through system defects as such by a 2 m rise in current sea level the flooding volume may double in an ideal system i e no defects while this ratio can increase six fold in a slightly defective stormdrain system with 0 25 porosity systemwide the continuous simulations of the stormdrain system performance indicate that flood events will be more destructive and frequent under these circumstances abbreviations aeff effective area of a conduit for groundwater infiltration m2 c1 c2 c3 and c4 abbreviations used for specifying conduits cd discharge coefficient of a circular orifice d circular conduit diameter m d circular defect diameter m eld rim elevation of the downstream node of a conduit m elu rim elevation of the upstream node of a conduit m gwi groundwater infiltration m3 s gwii gwi in the presence of swi m3 s gwij gwi in the absence of swi m3 s gwik gwi in the absence of swi when gwt sea level m3 s gwt groundwater table m gwtave average gwt on a conduit m g gravity acceleration 9 81 m s2 hg groundwater head on a conduit m k hydraulic conductivity m day l conduit length m leff effective length of a conduit for groundwater infiltration m lecz low elevation coastal zone mi marine inundation n number of defects p system porosity qd groundwater infiltration rate through a single defect m3 s r hydraulic radius of a non circular conduit m slr sea level rise m swi seawater intrusion m3 s ε soil void ratio keywords climate change sea level rise coastal areas compound flooding groundwater infiltration stormdrain system data availability data will be made available on request 1 introduction global warming attributed to greenhouse gas emissions is changing the natural water cycle on the earth in the wake of melting glaciers and ice sheets as well as thermal expansion of ocean water the global mean sea level has increased at a rate of 3 1 mm year since the mid 1990s sweet et al 2022 which is faster than any equivalent period over at least the last 2700 years kopp et al 2016 depending on future emissions the continental us coastline is projected to see 0 6 2 2 m of sea level rise slr at the end of the century sweet et al 2022 climate projections also raise concerns about how precipitation will respond in a warming world while longer droughts are expected in most regions due to rising temperatures attributed to higher surface evaporation global models project a 16 24 increase in heavy precipitation intensity by 2100 associated with larger water holding capacity of the warmer air fischer et al 2014 trenberth 2011 as shown in fig 1 due to the interactions of oceanographic hydrological and meteorological processes low lying coastal areas are susceptible to different sources of marine subsurface and surface inundation especially after considering climate change effects on water resources befus et al 2020 bevacqua et al 2019 thus efficient management of coastal drainage systems requires new information about the current and future role of seawater and groundwater sources along with the typical stormwater source in urban flooding currently over 20 million people of the world s population are permanently exposed to marine inundation while more than 200 million people are vulnerable to marine flooding during temporary extreme high sea level events nicholls 2011 slr will enhance coastal marine inundation zone i in fig 1 which has been projected to impact 13 million people directly in the united states by 2100 assuming 1 8 m of slr hauer et al 2016 slr also will magnify the impacts of extreme sea level events as their frequency and magnitude follow a sharply escalating pattern thompson et al 2021 vitousek et al 2017 according to kirezci et al 2020 for a 1 meter slr scenario at the end of the current century there will be a 50 increase in the global population assets and land area at risk of seawater flooding the projected slr will dramatically threaten coastal communities and ecosystems such that it may shift the coastline landward accelerate cliff failure and beach erosion degrade coastal habitats and aquifers and potentially damage coastal infrastructure arkema et al 2013 dawson et al 2009 nicholls and cazenave 2010 rotzoll and fletcher 2013 while flood control measures typically are designed to protect coastal communities from seawater flooding there is growing recognition that low elevation coastal zones lecz coastal areas below 10 m of elevation above sea level also are vulnerable to subsurface flooding zone ii in fig 1 befus et al 2020 coastal groundwater tables are dynamically connected to sea levels and thus their inland responses to slr known as groundwater emergence and shoaling may pose a further threat to terrestrial infrastructure and natural resources hoover et al 2017 sukop et al 2018 by modeling groundwater flow in a dense urban site along the hudson river estuary in new jersey su et al 2022 predicted that for slr up to 1 m one third of the study area would be impacted by subsurface flooding across urbanized coastal zones shallow groundwater i e 2 m depth also may immerse subterranean infrastructures e g drainage and sewer networks electric and gas substations building foundations and cause serious disruptions to their operation maintenance and development habel et al 2020 rotzoll and fletcher 2013 besides intensifying chemical corrosion and deterioration high level groundwater can intrude into water conveyance networks through their defects e g holes cracks and misaligned joints and increase their hydraulic loading dirckx et al 2016 karpf and krebs 2011 su et al 2022 previous studies indicate that groundwater infiltration into sewer systems ranges from 30 to 72 of total sewage flow zhao et al 2020 which may triple in leczs with 1 m slr fung and babcock 2020 compared to soil type and sewer pipe characteristics the groundwater table is the most important parameter affecting groundwater infiltration in leczs liu et al 2021 considering rainfall events and subsequent stormwater runoff as a key source of inundation zone iii in fig 1 leczs are critically exposed to compound flooding where multiple flooding pathways co occur jang and chang 2022 rahimi et al 2020 through compound events when heavy precipitation coincides with an extreme sea level event the flooding extent substantially increases compared to that of either in isolation moftakhari et al 2019 saharia et al 2021 wahl et al 2015 for example by coupling heavy rainfall and high sea level events around 80 of the city of new orleans in the united states was inundated for several weeks in 2005 moghimi et al 2021 the vulnerability of coastal communities to compound flooding is expected to critically exacerbate over the century due to slr and climate change effects on heavy rainfall patterns which lead to further reductions in terrestrial infiltration ponding and drainage capacity davtalab et al 2020 karamouz et al 2015 in recent years enhanced awareness of the potentially catastrophic impacts of compound flooding on human lives and property has motivated new assessments of the multiple and interconnected drivers of compound flooding in different natural and urbanized areas table 1 presents a summary of recent selected studies on compound flooding using mike urban 1d model and focusing on the number of flooded junctions and flood frequency laster grip et al 2021 simulated the performance of a coastal stormdrain system under coupled events of slr storm surge and rainfall while the model was neither calibrated nor validated their comparative studies reported that although the impact of slr is not evident today a tipping point will occur in 2075 2100 after which storm surges become a major driver for stormdrain system failure while rainfall induced stormwater flooding was not included in the studies of gold et al 2022 and habel et al 2020 their evaluation of stormdrain system performance under high tides showed that the system may flood due to seawater backflow even in the absence of precipitation by studying coupled storm surge and rainfall events tahvildari et al 2022 and khanam et al 2021 quantified the flooding extent as a measure of the potential threat to roadway networks and electric infrastructure during compound events davtalab et al 2020 and rahimi et al 2020 reported higher risks of flooding in retention ponds and riverine streams during slr induced groundwater rise associated with the reduction in their infiltration and discharge capacity respectively although the previous studies listed in table 1 confirm the vulnerability of coastal communities to compound flooding events due to the multiplicity and complexity of involved mechanisms additional research is needed to quantify compound flooding risk and subsequently establish efficient adaptation strategies for mitigating climate change stresses on water infrastructures this study develops a novel and general framework to assess the vulnerability of coastal stormdrain systems to compound mechanisms of seawater groundwater and stormwater flooding under emerging climate change scenarios we focus on a case study of imperial beach ib which is a coastal community in california surrounded by water bodies on three sides and vulnerable to compound flooding fig 2 a different sources of marine subsurface and surface inundations shown in fig 1 are evaluated using a bathtub approach the modflow groundwater model developed by befus et al 2020 and the integrated hydrology hydraulic pcswwm model developed for this study arcgis is utilized for geospatial analysis and flood mapping the principal objectives of this study are to identify the extent and volume of seawater intrusion and groundwater infiltration into coastal stormdrain systems by studying different scenarios for slr hydraulic conductivity and system defects advance knowledge on the vulnerability of coastal drainage infrastructure to coupled oceanographic hydrological and meteorological stressors and examine climate change impacts i e slr groundwater rise and more intense rainfall on the performance of coastal stormdrain systems through estimating the extent and frequency of flood events 2 material and methods 2 1 study area imperial beach ib is the southwestern most city in the continental united states with 30 thousand population 5 5 km2 area 2 5 km coastline and 2 10 m elevation gallien 2016 as a lecz the residential area of this underserved community is surrounded by water bodies from three sides the pacific ocean on the west san diego bay on the north and tijuana estuary on the south fig 2 a due to its unique setting and aged water infrastructure ib is vulnerable to compound flooding particularly when a rainfall event occurs while the stormdrain system is significantly occupied by seawater intrusion swi and or groundwater infiltration gwi 2 2 primary datasets table 2 describes the main datasets obtained and utilized in this study topographic data is acquired from a high resolution digital elevation model dem with 0 762 m 0 762 m resolution provided by the san diego association of governments sandag the sea level records are obtained from the national oceanic and atmospheric administration noaa for the san diego bay station id 9410170 which is the closest tide station to the study area located 20 km north of ib with over a 100 year record following noaa s regional slr scenarios we examine slr 0 1 and 2 m the scenario of slr 0 m refers to the present day sea level at mean higher high water mhhw 1 658 m referenced to the north american vertical datum of 1988 navd88 while 1 and 2 m represent intermediate and high scenarios of slr by 2100 associated with moderate and high greenhouse gas emission scenarios over the century sweet et al 2022 mhhw is obtained for the most recent 19 years 2002 2021 providing an estimation of high water levels that are persistently and frequently reached in the region hoover et al 2017 groundwater flow is generally described by darcy s law which can be combined with conservation of mass to obtain a partial differential equation describing the distribution of hydraulic head as the target parameter langevin et al 2017 in this research groundwater table gwt data is acquired and analyzed from the modflow model developed by befus et al 2020 these researchers assessed the steady state and three dimensional responses of gwt to various slr scenarios across the california coast including ib for three values of hydraulic conductivity k 0 1 1 and 10 m day to validate the applicability of modflow results for ib we have compared the modeled gwt at local mean sea level lmsl with temporal mean values of the observed gwt in nearby groundwater sites available on the united states geological survey usgs website the best agreement between modeled and observed time averaged gwt within 20 is found for k 1 m d fig 2 thus to obtain the spatial distribution of gwt across ib the present study has utilized the modflow data for k 1 m day and the mentioned slr scenarios in table 2 the primary input parameters for the stormwater model pcswmm described below in section 2 3 3 stormwater modeling include stormdrain system specifications rainfall and evaporation data soil properties and land use characteristics the spatial and geometric specifications of the stormdrain system elements i e conduits junctions and outfalls are available at the data warehouse of the city of ib www imperialbeachca gov stormwater gaps in the data have been filled through contacting the environmental natural resources department in ib and conducting in situ and virtual field visits by our research team and google street view the hydrological package of sd hydro tools developed by the county of san diego is utilized to generate 24 hr nested design storms having 1 year 2 year and 100 year return periods from noaa s precipitation frequency data the design storms with 1 year and 2 year return periods represent heavy rainfall events while extreme rainfall events are represented by 100 year return period occurring on average once in a century in addition 38 years of rainfall data with a 1 hour interval are obtained from project clean water www projectcleanwater org to perform a continuous simulation of the stormdrain system performance from fig 3 the time interval of 1983 1986 water years with the maximum yearly monthly daily and hourly values of 531 198 76 and 28 mm is considered as the representative wet period and imported in the model other involved parameters in stormwater modeling i e subcatchment roughness imperviousness and infiltration in addition to conduit roughness and energy loss are set by referring to local sources covering the study area e g the city of san diego stormwater standards 2021 and county of san diego hydrology manual 2003 these parameters are described in the section 2 3 3 2 3 methods 2 3 1 marine and subsurface inundations fig 4 presents the workflow carried out in the present study steps the first studied component is marin inundation mi which represents the passive flooding from seawater across the coastline at mhhw level as shown in fig 5 a and described in section 3 1 other sea related flooding sources like storm surge and wave runup are not included in mi due to the focus of this research on the inland drainage system the vulnerable locations to mi are identified using a bathtub approach in arcgis which subtracts the sea level elevation in a given scenario from the dem to identify the areas that host elevations below that of the seawater surface habel et al 2020 due to topographic obstructions the identified areas without a surficial connection to the marine source are excluded from mi although the subsurface inundation still threatens these areas by flooding from underneath rotzoll and fletcher 2013 through subtracting gwt elevation from the dem a similar method is applied to identify the areas potentially vulnerable to groundwater emergence and shoaling as shown in fig 5 b and described in section 3 1 2 3 2 seawater intrusion and groundwater infiltration flow conveyed through the stormwater network ultimately discharges through the outfalls represented by red filled circles in fig 5 by generating a reverse flow swi through the outfalls may limit the discharge capacity of the system at high sea level conditions this oceanographic stressor is considered in the stormdrain model simply by setting a fixed water elevation in the outfalls corresponding to the sea level elevation for a given scenario generally stormdrain system elements are susceptible to swi if their elevations are lower than sea level as drainage pipes age high level groundwater may infiltrate into the system through the defects on the pipe walls and result in an increased hydraulic loading see fig 6 a thus in the case of having a defective system stormdrain system elements are susceptible to gwi if their elevations are lower than local gwt this study considers groundwater head hg and system porosity p to estimate gwi rate into the stormdrain system considering the small variations of gwt 5 cm changes over 95 of conduits its average value above each conduit gwtave was used for gwi determination see fig 6 b having a uniform value for the whole system p is defined as the ratio of defect to conduit surface area in percent results independency from defect position and size due to the lack of stormdrain monitoring data three scenarios of p 0 000 0 125 and 0 250 are defined in this study to evaluate the effects of system defects on its performance understanding the differences between stormwater and sewer networks these scenarios are defined based on the cctv sewer inspection dataset conducted in ib in 2014 courtesy of the city of ib to simplify the gwi calculation non circular conduits consisting of 5 of total conduits are approximated by equivalent circles d 4r where d and r are the equivalent circle diameter and the hydraulic radius of non circular conduits respectively the following assumptions are made to simplify the problem making it suitable for city scale long term simulations i the surrounding soil is homogeneous and isotropic ii all system defects are in a regular circular form in the order of cm and uniformly distributed on the conduits the results are independent of defect position and size and iii possible groundwater flow effects in terms of washing the surrounding soil can be neglected consequently a modified form of the head discharge equation for a circular orifice guo and zhu 2017 is used to determine the amount of gwi into the system 1 gwi q d n p a eff 25 π ε c d g h g q d ε c d d 2 g h g n p a e f f 100 a d where qd infiltration rate through a single defect n number of defects ε void ratio of the surrounding soil 0 2 cd discharge coefficient of a circular orifice 0 6 d circular defect diameter g gravity acceleration and aeff effective area for receiving gwi conduit surface area under gwt as shown in fig 6 c hg and aeff are estimated for each conduit based on its situation with respect to gwtave elevation in addition in the case of swi into a conduit the amount of gwi is determined through the presented superposition in fig 6 d the calculated amount of gwi for each conduit is subsequently assigned as a constant flow rate to its upstream junction in the pcswmm model 2 3 3 stormwater modeling to simulate the stormdrain system performance an integrated hydrology hydraulic model is developed using pcswmm version 7 4 3240 with swmm5 engine to estimate surface runoff produced by rainfall over urban subcatchments a nonlinear reservoir model is used along with manning equation eqs 2 and 3 flow routing within conduits is governed by the conservation of mass and momentum eqs 4 and 5 known as 1d saint venant equations rossman 2015 the complete form of these equations which refers to an unsteady and non uniform flow in the system is solved using the finite difference method 2 c h a n g e i n d e p t h o v e r t i m e d t i e f q i r a t e o f r a i n f a l l s n o w m e l t a n d r u n o n e e v a p o r a t i o n r a t e f i n f i l t r a t i o n r a t e q r u n o f f r a t e p e r u n i t s u r f a c e a r e a 3 q q a 1 n r 2 3 s f 1 2 q r u n o f f v o l u m e t r i c f l o w r a t e a f l o w a r e a w d d s n m a n n i n g r o u g h n e s s c o e f f i c i e n t d s d e p r e s s i o n s t o r a g e w s u b c a t c h m e n t w i d t h r h y d r a u l i c r a d i u s d d s s f f r i c t i o n s l o p e b e d s l o p e s 0 i n u n i f o r m f l o w 4 q t q 2 a x g a h x g a s f 0 q v o l u m e t r i c f l o w r a t e a v a f l o w a r e a v f l o w v e l o c i t y h h y d r a u l i c h e a d z y z e l e v a t i o n y f l o w d e p t h g g r a v i t y a c c e l e r a t i o n 5 a t q x 0 as shown in fig 7 the study area consisting of 20 major drainage basins is divided into 122 fine resolution subcatchments to provide a precise rainfall to runoff modeling in the study area in addition the stormdrain system is described in a substantially high resolution by having 263 conduits in the model linked to 200 open and 63 close junctions referring to the san diego s stormwater standards 2017 the green ampt method is selected for infiltration modeling while manning roughness coefficients for subcatchments and conduits are determined in the ranges of 0 024 0 200 and 0 013 0 030 respectively the energy loss coefficients at the entrance and exit conduits range from 0 1 1 0 based on their relative diameters to the neighboring junctions frost 2006 to calibrate and verify the model wet weather field monitoring data courtesy of john wood group plc is obtained with a 1 min interval at the specified location in fig 7 in the vicinity of ib s public library where the system is free of swi and gwi in current conditions see fig 5 b satisfying the recommended ranges by the san diego s hydrology manual 2003 for different land uses the subcatchment imperviousness is set as the target parameter for calibration ranging 25 80 according to fig 8 there is an outstanding agreement between the modeled and measured data for both calibration and verification periods the modeled flow characteristics i e stormdrain inflow and depth match well with the measurements in terms of both the timing and magnitude of peak flow 20 difference twenty scenarios are studied in this research table 3 to comprehensively evaluate the effects of slr system porosity and rainfall properties on the performance of coastal stormdrain systems according to fischer et al 2014 a 25 increase in heavy rainfalls could be expected in southern california by 2100 in table 3 the nested storm with a 2 year return period corresponds to that increase in the intensity of the nested storm with a 1 year return period thus this magnitude of rainfall could be expected to happen every year instead of every other year in the region by the end of the century however no significant change in the annual mean precipitation is expected in the region fischer et al 2014 3 results and discussion 3 1 extent of marine and subsurface inundations to improve the understanding of the vulnerability of coastal water infrastructure and resources to slr the first step is to assess the inundation potential slr driven marine and subsurface inundation extents are shown in fig 5 and table 4 summarizes the estimates of the impacted urbanized areas under no moderate and high slr scenarios the baseline year for the present day condition slr 0 m scenarios is 2021 from fig 2 a and fig 5 a tijuana estuary and its natural ecosystem will be extensively and directly impacted by marine inundation as sea level rises however marine inundation is predicted to have minimal impacts on the urbanized populated region where the present study focuses on for slr 0 1 2 m scenarios 0 00 0 44 and 6 74 of the urbanized area is under marine inundation respectively table 4 the urban area inundation is limited to the san diego bay shoreline and the ocean facing coast particularly along the thin strip between the ocean and estuary from fig 5 b and table 4 groundwater emergence and shoaling pose a more widespread threat than marine inundation for all slr scenarios in the current sea level conditions groundwater shoaling with a depth 2 m threaten subsurface urban infrastructure in 8 5 of the populated region including areas far from the coastline the slr induced groundwater rise will increase this number to 16 98 and 23 01 for 1 and 2 m slr therefore for the high slr scenario it is expected that around 30 of the city will be permanently threatened by marine inundation and shallow gwt at the end of the century it is worth noting that both marine and subsurface inundations can be more widespread during dynamic ocean conditions i e storm surge and wave action which are excluded in the present study because of its focus on the long term performance of the inland drainage system in terms of spatial distribution it is expected that the regions closer to the sea will be heavily impacted during dynamic sea level events laster grip et al 2021 from the studies of gallien 2016 and merrifield et al 2021 on ib the ocean shoreline will be particularly vulnerable to wave driven impacts anderson et al 2018 showed that the flooded area mapped in three hawaiian islands can be increased up to 50 by adding wave inundation to the passive flooding in addition a king tide can temporarily raise inland gwt while its fluctuations attenuate at a distance in the order of 1 km from the shoreline rotzoll and fletcher 2013 3 2 extent of seawater intrusion and groundwater infiltration a substantial portion of the ib s stormdrain conduits is at risk of swi and gwi through outfalls and system defects respectively fig 5 b from table 4 about 11 and 60 of the conduits with an invert elevation lower than sea level at mhhw may experience some amount of swi at the current and high sea level conditions respectively in addition the stormdrain conduits located in the emergent to shallow groundwater regions fig 5 b are the most sensitive to gwi enlarging by slr induced groundwater rise at the high slr scenario 67 of the stormdrain length will be susceptible to gwi this number is more than twice the above mentioned percentage for the city area experiencing shallow gwt with a depth of 2 m which is the typical depth for stormdrain systems this difference is because a water drainage system with gravity driven flow is typically located in low lying regions of an urbanized area where the risk of emergent to shallow groundwater is the highest therefore water drainage systems are one of the most vulnerable coastal infrastructures to slr impacts the estimations of gwi for different scenarios are plotted by the red line graphs in fig 6 e as expected this parameter increases by rising sea level and spreading system defects while it grows about four times by a 2 m slr gwi and p change with the same factor for a given sea level due to assuming a uniform distribution of defects on the system to have a better sense of the extent of this additional stressor gwi is also normalized by the maximum total inflow during a 24 hr rainfall with a 1 year return period as shown by the blue line data in fig 6 e gwi can consist of 20 of the maximum total inflow at slr 1 m however gwi may form a smaller part of the total inflow at higher slr because of an increase in swi contribution it should be noted that the slr induced groundwater lift in leczs can cause some additional issues like exposing the public to sewage effluent contamination and degrading groundwater quality through saltwater intrusion into coastal aquifers as shown in fig 1 and failure of immersed cesspool systems befus et al 2020 habel et al 2020 habel et al 2017 these topics merit more research beyond the present study scope 3 3 compound flooding the main effects of slr rainfall intensity and stormdrain system porosity on its performance are presented in fig 9 a as these parameters increase which is expected to happen due to climate change effects and lack of maintenance in underserved areas a higher percentage of inland junctions will flood shown by the blue line graphs in the top left chart the red line graphs in other charts show that the stormdrain compound flooding is projected to increase in total area depth volume and time over the century we note that the junctions located in marine inundation areas are excluded from the stormdrain flooding analysis this point may explain why the number of flooding junctions shown by the red line graphs in the top left chart is not a monotonic increasing function of slr at p 0 unlike their total values the average values of the flood properties shown by the blue line graphs in other charts do not have a monotonic increasing trend with the rainfall return period this is because although total flooding values increase during a 2 year rainfall event more stormwater inflow the increase in the number of flooding junctions may be larger as a result the average value may decrease i e average value total value number of flooding junctions interaction between different parameters implies that the effect produced by changing one parameter depends on the level of other parameters sangsefidi et al 2017 fig 9 b indicates the interactive effects of the three studied parameters on the total flooding volume the vertical axis titles of the graphs are described in the figure caption as shown a more defective system will be impacted by slr to a greater extent such that under a 1 year rainfall event the flooding volume will grow up to 6 times by a 2 m rise in seal level when p 0 25 however this ratio may decrease to less than a third by avoiding gwi into the system p 0 moreover since the stormwater contribution to compound flooding increases by an increase in rainfall return period the flooding extent is less sensitive to swi and gwi under more extreme rainfall events fig 10 shows today s observations of frequently flooded locations courtesy of the city of ib and fig 11 presents the flooding extent maps obtained from the developed stormwater model for five selective scenarios in current and future conditions defined in table 3 as a ground truth fig 10 reveals that even for the current sea level conditions there are still serious problems across the city for draining stormwater from low intensity rainfalls this point also can be found from the presented flooding maps for s0 p0 000 r1 and s0 p0 250 r1 scenarios in fig 11 on which the nine frequently flooded locations are pinpointed considering the small extents of swi and gwi at slr 0 m fig 5 b the main driver of these floods should be rainfall induced stormwater from the comparisons of the two mentioned scenarios in fig 11 it can be found that the effects of system porosity are not significant in the current sea level conditions i e low gwt values in the region by sea level rising over the century swi may have a significant contribution in the stormdrain inflow and flooding s2 p0 000 r1 scenario however comparison of the s2 p0 000 r1 and s2 p0 250 r1 scenarios indicates that the slr impacts are considerably more severe for higher p values because gwi leads to a further increase in the hydraulic loadings on the system in these circumstances as a result the flooding hotspots during more frequent design storms i e 1 year return period generally correspond to the shallow gwt regions depicted in fig 5 b comparing the s0 p0 000 r1 and s2 p0 250 r1 scenarios fig 11 the most important insight is that adverse impacts of slr are not limited to marine inundation and a potential landward shift in the shoreline slr also can impact regions kilometers from the coastline through contributions to compound flooding events the expected 25 increase in the heavy rainfall intensities by climate change effects over the century annual occurrence of the current 2 year rainfall in 2100 may cause additional stress on the system and enlarge the compound flooding extend even more s2 p0 250 r2 scenario based on the performed continuous simulations for the 4 year representative wet period the long term performance of the stormdrain system as opposed to a single design storm is analyzed by focusing on the selective junctions specified on the legend and bottom left map in fig 11 as shown the selected junction on each stormdrain line has a critical flooding condition compared to other junctions on that specific line in addition these junctions are selected from eight major stormdrain lines to inform us about various conditions of the system referring to fig 5 b some selective junctions may be invulnerable to swi and gwi while other ones can be susceptible to either swi gwi or both fig 12 a presents the frequency and number of flood events with a separation time of 6 h as shown some parts of the system i e k 629 and s 583 junctions may experience similar flooding events in different scenarios because they receive neither swi nor gwi previously depicted in fig 5 b however for those parts susceptible to either swi or gwi the flood events are expected to happen more frequently depending on the amount of these additional stressors for example since junction e 592 is at the risk of both swi and gwi at slr 2 m a higher number of flooding events is expected for this area compared to the current conditions jumps in the data for s2 p0 000 continuous and s2 p0 250 continuous scenarios in fig 12 a more challenging some parts of the system may be always flooding at the end of the century i e a 982 f 614 and h 610 junctions with a flood event frequency of 1 attributed to the high amount of swi and gwi fig 5 b shows the 11 sunny day flooding junctions across the study area for slr 2 m and p 0 25 which are generally located in low lying areas with emergent to shallow groundwater fig 12 b demonstrates the flood frequency volume plots for some of the selective junctions as expected larger floods happen less frequently in the region and vice versa due to the contribution of swi and gwi into stormdrain inflow a flood with a given frequency will have a larger extent or conversely a given flood is expected to happen more frequently in the future the effects of the slr induced stressors are more significant in more frequent floods especially in the sunny day flooding areas however the difference between the data for s0 p0 000 continuous and s2 p0 250 continuous scenarios diminishes at lower values of flood frequency and they eventually converge to each other for very extreme floods in these circumstances the contributions of seawater and groundwater sources in compound flooding are insignificant compared to that of the stormwater source as a result the flooding extent is highly dependent on the typical drainage characteristics of subcatchments rather than swi and gwi to improve our understanding of compound flooding extent and to develop adaptation strategies we intend to pursue the following future research through installation of four groundwater wells inside imperial beach the research team is collecting gwt data and estimating k in different areas of the city these data will be utilized to develop a high resolution 3d groundwater model to understand the spatial and temporal connection of sea level events with groundwater flow and contaminant transport while rainfall is the main contributor to urban flooding in today s climate storm waves may become the dominant stressor in the future especially in downstream areas closer to the sea in terms of temporal distribution there also might be a shift in the dominant period from spring autumn rain induced flooding to winter sea induced flooding due to energetic storm wave events originating in the north pacific kunkel and champion 2019 laster grip et al 2021 by adding storm wave action and local wind driven surge to coastal stressors and including more site specific conditions a new 2d stormwater model will be developed and coupled with the groundwater model to determine emerging compound floodplains which will be helpful for slr mitigation and adaptation besides exposure to flood events socioeconomic factors e g race income public health and education level also should be taken into account for assessing the overall vulnerability of a community bathi and das 2016 in fact identifying vulnerable population groups can be beneficial for prioritizing resources for underserved people through conducting extensive social studies and understanding the community barriers and motivations adaption solutions will consist of environmentally friendly engineered designs to protect the community against coastal climate change in a resilient and sustainable manner 4 conclusion and future works this paper evaluates the vulnerability of the coastal stormdrain system at imperial beach to compound flooding of seawater groundwater and stormwater sources under climate change effects and possible impacts of lack maintenance due to resource limitations the main conclusions are based on estimates of slr driven marine and subsurface inundations we find that about two thirds of the stormdrain length could be susceptible to swi and gwi under the high slr scenario of 2 m in these conditions gwi is estimated to increase up to 4 times and consist of twenty percent of the system hydraulic loads during annual rainfall events with the contribution of swi and gwi the compound flooding extent will significantly increase in all forms of flooding depth area and time and it can impact some areas kilometers away from the coastline for a defective system p 0 25 working under a 1 year rainfall event the flooding volume increases up to 6 times by a 2 m increase in current sea level however the flooding volume can be reduced to less than a third by repairing system defects and avoiding gwi into the system when slr 2 m the oceanographic and hydrological stressors of swi and gwi can also increase the frequency of flooding events in the region while some low lying areas with emergent to shallow groundwater may suffer sunny day flooding during extreme rainfall events e g 100 year return period the stormwater source dominates swi and gwi i e the system may fail solely by stormwater regardless of the other coastal stressors credit authorship contribution statement yousef sangsefidi conceptualization methodology software validation formal analysis investigation data curation writing original draft writing review editing visualization kian bagheri methodology software writing review editing hassan davani conceptualization methodology resources writing review editing supervision project administration funding acquisition mark merrifield methodology resources writing review editing project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research has been supported by the national science foundation under grants no 2113987 and 2113984 we appreciate the support of computational hydraulics int chi the city of imperial beach particularly mr chris helmer and john wood group plc for providing us with access to the pcswmm license stormdrain geometric data and stormwater measurements respectively 
