index,text
5610,understanding solute transport in heterogeneous porous media is a challenging problem due to the degree of complexities coming from the spatial variations of petrophysical properties the developments of theoretical formulations are powerful tools used to obtain insights regarding the phenomenology involved in the transport process when analyzing large scale systems in this context and within the framework of the volume averaging method in this work we present an effective one equation model and its validity conditions for the solute transport in heterogeneous reservoirs characterized by two lithology arrangements for this purpose the hypothesis of local mass equilibrium was assumed valid and what follows included the determination of physical constraints supporting such a hypothesis in a previous work aguilar madera et al 2019 the closure problems to calculate the effective coefficients of the two equation model were presented and with this base we present here the numerical estimation of the effective velocity vector and the mass dispersion tensor included in the one equation model as one application the numerical solution of the one equation model was carried out for different lithology arrangements and the breakthrough curves for two permeability ratio scenarios were analyzed the results confirm that the permeability ratio dramatically impact not only the tracer dispersion but also the arrival time at observation points which is strongly correlated to the velocity vector field and its spatial deviations we found that the local mass equilibrium is met more easily in lenticular reservoirs provided that the boundary and initial conditions have no long term effects finally the dispersion coefficient was compared against reported reservoir field data finding similarities in the orders of magnitude for certain geologies keywords solute transport reservoir scale volume averaging method two facies one equation effective model 1 introduction in our previous work aguilar madera et al 2019 we used the method of volume averaging to upscale the darcy scale mass transport equations in order to obtain the corresponding large scale equations for two facies heterogeneous reservoirs in that work we solved the closure problems for lenticular and layered systems see fig 1 and the several effective coefficients for various permeability ratios were evaluated the two equation upscaled model was then solved and compared against the computationally expensive direct numerical simulations finding reasonably good agreement between both results the upscaling process of heterogeneous porous media is required when large scale systems such as oil reservoirs or aquifers need to be modeled as accurate as possible for a reservoir management perspective during its exploitation and production and considering that the solution of pore scale governing equations are not a feasible option instead of using the pore scale equations it is preferred using the volume averaged transport equations which are numerically more tractable and their coefficients have apparent physical meaning which can be evaluated directly from the solution of intrinsic closure problems that incorporate information from lower scales in that sense the two equation model ahmadi et al 1998 cherblanc et al 2007 chastanet and wood 2008 davit et al 2012 porta et al 2012 or the one equation model aguilar madera et al 2011 espinosa paredes et al 2013 are well supported options as they comes from a rigorous procedure based on the volume averaging method certainly there exist other approaches to the upscaling problem in heterogeneous porous media that have been developed alternatively to the volume averaging method for mentioning some of them the stochastic and homogenization methods have demonstrated to be useful when modeling transport in complex porous system in the work of dagan and lessoff 2001 and zarlenga and fiori 2015 they analyze the transport process in multimodal or bimodal media where medium properties conductivity contrast relative volume fraction and the anisotropy ratio governs the entire dynamics also in the same line of stochastic approaches the continuous time random walk ctrw theory has been used to quantify transport in heterogeneous media where the key factor is the attribution of probability density functions pdf to the walkers berkowitz et al 2006 such pdf are consistent with the physical structure regarding the homogenization technique arbogast et al 1990 upscaled the darcy scale flow equation with highly discontinuous properties by using a scaling physical preserving parameter which in the limit when such parameter goes to zero gives the homogenized macroscopic governing equations within the volume averaging method plumb and whitaker 1988 studied the diffusion and dispersion in large scale two phase porous media by using the volume averaging method they proposed a large scale averaging to incorporate the local heterogeneities in the two equation resulting model and they found that time dependent additional terms appear which are absent when such equation comes from the local volume average method under certain conditions the two equation model originally proposed by zanotti and carbonell 1984 for upscaling the advection diffusion transport equations from pore scale to darcy s scale can be simplified to the one equation model this was stated in the work of quintard and whitaker 1993 who later quintard and whitaker 1995 1998 although for heat transfer surveyed and validated the hypothesis of local thermal equilibrium in transient heat conduction in a two region porous medium they explicitly developed the constraints that must be fulfilled in order for such a hypothesis to be valid later ahmadi et al 1998 and quintard et al 2001 provided additional theoretical developments on this topic in their works on the equivalence between the equilibrium one equation model non equilibrium one equation model and the two equation model for one side the non equilibrium one equation model is developed departing from position dependent properties assumption as in the work of quintard et al 2001 where both dispersion tensor and effective velocity depend on position accordingly on the other side the petrophysical properties can be assumed constant as in the work of ahmadi et al 1998 and as in our previous work for which the dispersion tensor and the velocity vector remain constant as well quintard et al 2001 found that the non equilibrium one equation model can be derived even when the average concentrations for each region are different and there is one equivalency with the two equation model only asymptotically as shown previously by zanotti and carbonell 1984 in addition these authors determine a large scale mass equilibrium one equation model by imposing a constraint on the concentration deviation in the averaged equation these findings were later theoretically and experimentally confirmed by cherblanc et al 2007 golfier et al 2007 and davit et al 2012 who studied the solute transport in heterogeneous porous media by large scale averaged two equation model they found that the two equation model converges asymptotically to the non equilibrium one equation model furthermore they provide insights regarding the transport regimes where the transport equations resulting from the application of the volume average method are valid i e the two equation model the one equation local mass equilibrium model and the non equilibrium one equation model aguilar madera et al 2011 analyzed and compared the one equation equilibrium model with the non equilibrium one equation model for a heat transport process in fluid porous medium inter region they found that even when the local thermal equilibrium conditions are met in the bulk at the fluid porous media inter region such conditions may not be valid espinosa paredes et al 2013 used the hypothesis of local thermal equilibrium to derive the heat transport one equation model for a three phase flow in heterogeneous porous medium the one equation model is the most used model regarding applications in large scale systems it is preferable over the two equation model and over other treatments for different reasons i this model is mathematically more tractable since analytical solutions may be derived for some cases ii it requires only two effective parameters and iii it is easy to apply in engineering problems to interpret field tests this mathematical model is commonly used to interpret field tracer tests e g maloszewski et al 1999 d√≠az goebes and younger 2004 goldscheider 2008 morales et al 2018 and pressure tests e g bogatkov and babadagli 2010 escobar et al 2007 zou et al 2013 carried out in oil reservoirs geothermal reservoirs and aquifers with the aim of characterizing dynamically such porous media in this regard the application of the one equation model is not complemented with the definitions of the effective coefficients in terms of information at lower level in the porous microstructure instead the model coefficients frequently are estimated through the inverse problem solution of the field data due to its common usage in modeling solute transport in reservoirs the one equation model encourages the formal derivation that encompasses details of physics at several length scales as mentioned above it has significant advantages over the two equation model and other treatments this motived the extension of our previous work aguilar madera et al 2019 nevertheless we should point out here the following the difference of this work regarding already published works mainly in relation to the ahmadi et al 1998 and cherblanc et al 2007 formulations is that our effective one equation model comes from a more general formulation where the boundary conditions imposed at the boundary between the two regions lithologies are related to the continuity of the total mass flux instead of only the dispersive mass flux as in ahmadi et al and cherblanc et al works in this manner the formulation presented in this paper encompasses the formulations previously mentioned even though the one equation model reported in this work has the same mathematical structure as others reported in the literature our formulation contains additional terms that do not exist on other works such terms arose from the initial physics governing at darcy scale which is different to other works such differences are clarified and discussed later another remarkable difference is that our formulation is valid for both liquids and gases whereas the cited works depart from a condition valid just for liquids incompressibility our work has a significant value and contribution with respect to previous works because the closed mathematical model obtained extends to applications of earth sciences in general where the theoretical results can be applied to general fluid reservoirs containing water oil or and gas i e our results are not restricted only for single phase fluid reservoirs but also multiphase reservoirs can be considered we recognize that the assessment of local mass equilibrium is not an easy task as it depends on multiple factors however we clearly identified relationships of length scale ratios where the concentration differences in both equilibrium and non equilibrium provide elements to meet our departing hypothesis thus in this work by using the local mass equilibrium assumption we derive the one equation model underlying the two equation model that we developed in a previous work aguilar madera et al 2019 in order to demonstrate the validity of such an assumption we analyzed the characteristic length scales in heterogeneous porous media of two lithology arrangements and we determine the necessary and sufficient physical constraints we calculate the effective velocity vector and the dispersion tensor included in the one equation model and as application the breakthrough curves for two scenarios of facies permeabilities and the various types of facies arrangements are analyzed also we compare the concentration profiles at different times for lenticular reservoirs finding that they met the local mass equilibrium condition since the solute concentrations are practically the same in each facies a proper comparison of dispersion coefficient against reported field data is presented in the last part of this work 2 the one equation model the initial point to derive the one equation model is from the statement of the mass transport governing equations for each facies following the two equation approach recently published aguilar madera et al 2019 in our analysis we consider one heterogeneous reservoir composed by two homogeneous facies called the œâ and Œ∑ regions rocks as depicted in fig 1 following the two equation approach the mass transport equation for solute inside the œâ facies is 1 Œµ œâ c œâ œâ t u œâ c œâ œâ d œâ œâ c œâ œâ d œâ Œ∑ c Œ∑ Œ∑ w œâ c œâ œâ w Œ∑ c Œ∑ Œ∑ œÇ œâ c œâ œâ œÇ Œ∑ c Œ∑ Œ∑ v œâ œâ c œâ œâ v œâ Œ∑ c Œ∑ Œ∑ k l œâ c œâ œâ c Œ∑ Œ∑ a v k l c œâ œâ c Œ∑ Œ∑ while the analogous governing equation for Œ∑ facies is 2 …õ Œ∑ c Œ∑ Œ∑ t u Œ∑ c Œ∑ Œ∑ d Œ∑ œâ c œâ œâ d Œ∑ Œ∑ c Œ∑ Œ∑ w œâ c œâ œâ w Œ∑ c Œ∑ Œ∑ œÇ œâ c œâ œâ œÇ Œ∑ c Œ∑ Œ∑ v Œ∑ œâ c œâ œâ v Œ∑ Œ∑ c Œ∑ Œ∑ k l Œ∑ c œâ œâ c Œ∑ Œ∑ a v k l c œâ œâ c Œ∑ Œ∑ here c œâ œâ and c Œ∑ Œ∑ are the intrinsic average concentrations for the œâ and Œ∑ facies respectively these average concentrations gather the concentrations at darcy scale whose governing equations are valid within individual facies depicted in fig 1 the two equation formulation contains several mass dispersion tensors d œâ œâ d œâ Œ∑ d Œ∑ œâ d Œ∑ Œ∑ pseudo convective terms w œâ w œâ v œâ œâ v œâ Œ∑ v Œ∑ œâ v Œ∑ Œ∑ pseudo absorption terms œÇ œâ œÇ Œ∑ and inter facies mass transfer coefficients k l œâ k l Œ∑ a v k l the definitions of all these coefficients are reported elsewhere see eqs 48 62 in aguilar madera et al 2019 and they were computed from the solution of the associated closure problems for lenticular and layered arrangements of facies whilst varying the facies permeability in this work as a complementary part the closure problems were numerically solved for the estimation of the effective coefficients for flaser wave and pin stripes arrangements of facies the results are summarized in the appendix a these types of geological arrangements have been formed from sedimentary processes they are of engineering interest for economical and or environmental purposes several geological reservoirs encompass one or more of such arrangements within the same reservoir body at the end the theoretical results can be used with the previous knowledge of the static model of the reservoir to be studied and with this the correct values of effective parameters should be selected commonly such a static model includes the spatial correlation of petrophysics major arrangement of lithofacies lateral continuity and vertical net pay thus the unique stage where the facies arrangement must be employed is when the numerical solution of closure problems is performed to consequently estimate the effective parameters as observed in the introduction of this work and in our previous one aguilar madera et al 2019 a number of researchers have developed theory for understanding mass transport in heterogeneous porous media at large scale in that sense the way we are tackling the problem using the volume averaging method is not novel and it constitutes the rigorous basis of this work our work represents one effort to bring the advances in fundamentals of porous media to the language and direct applications in the earth sciences thus some assumptions handled in previous works might fail or at least there is no necessity to impose them at this stage limiting the scope of the present work the following table 1 resumes the main differences of our work with respect to the physics handled by ahmadi et al 1998 subsequent works of ahmadi and or coworkers cherblanc et al 2003 2007 davit et al 2012 quintard et al 2001 provided additional numerical estimations of coefficients or extended theoretical analysis based nearly on the darcy scale physics considered by ahmadi the equations presented in table 1 represent some of the initial physics governing at darcy scale and from there the upscaling is performed up to the reservoir scale one of the most significant differences is related to the continuity equation employed while ahmadi and coworkers assumed incompressible fluid we do not specify any equation during our development and furthermore the theoretical results can be applied to general fluid reservoirs containing water oil or and gas in fact our results are not restricted only for single phase fluid reservoirs and multiphase reservoirs can be considered although the analysis of multiphase systems lies beyond the scope of the present work the theory developed here and previously aguilar madera et al 2019 is valid for cases when the solute is miscible only in one phase i e the form of the upscaled equation the closure problems and the definitions of effective coefficients remain unchanged for situations where the solute can be dissolved and or transported into the surrounding phases interphase mass terms need to be included within the primal governing equations this will lead to additional terms in the upscaled equation changing its structure and the closure problems to estimate the effective coefficients and surely other effective coefficients will appear in addition the conditions that we analyze further validating the local mass equilibrium assumption could be modified according to the multiphase physics added another important difference with respect to ahmadi s work is about the assumption that at boundaries between rocks the normal fluid velocity is preserved i e 3 at a œâ Œ∑ n œâ Œ∑ u œâ n œâ Œ∑ u Œ∑ if one accepts this equation then the boundary condition we used is simplified to be continuity of mass flux dispersion written in table 1 in that case our work can be straightforwardly reduced to yield the same closure problems effective coefficients and upscaled equations derived as in previous works ahmadi et al 1998 although the eq 3 was mentioned in our previous work aguilar madera et al 2019 it was not implemented during the upscaling process and development of closure problems in our theoretical development we understood that the upscaling of flow problem in two facies reservoirs deserves other extensive analysis and furthermore we did not impose any condition on velocity leaving that situation for further studies in fact instead of imposing continuity of velocity it seems more plausible to use the continuity of average fluid thermodynamic pressure 4 at a œâ Œ∑ p œâ p Œ∑ which eventually leads to a discontinuity of fluid velocity this can be easily drawn from the single phase darcy s law at darcy scale other approaches will lead to the same conclusion 5 u œâ k œâ k r œâ …õ œâ Œº Œ≤ p œâ œÅ g u Œ∑ k Œ∑ k r Œ∑ …õ Œ∑ Œº Œ≤ p Œ∑ œÅ g where equaling the terms p œâ œÅ g and p Œ∑ œÅ g according to eq 4 we obtain 6 u œâ k œâ k Œ∑ 1 k r œâ k r Œ∑ …õ Œ∑ …õ œâ u Œ∑ in short the usage of eq 3 could be questionable for situations where two rocks have very contrasting petrophysical properties i e permeability k porosity …õ and relative permeability k r as a matter of fact the equality of pressures can be also questionable for porous rocks under multiphase flow and whose pore sizes can yield large and contrasting capillary pressures when the fluid passes from one rock to the other thus we state that it is not easy to elucidate the correct boundary condition for the fluid velocity at this stage for the problem of species mass transport there is not necessity to define it yet now continuing with the original line of our work if we assume a priori that the mass transport in the whole two facies reservoir is well modeled with a unique average concentration large scale mass equilibrium then we can write that 7 c œâ œâ c Œ∑ Œ∑ c thus adding eqs 1 and 2 yields 8 c t u œâ u Œ∑ v œâ œâ v œâ Œ∑ v Œ∑ œâ v Œ∑ Œ∑ c d œâ œâ d œâ Œ∑ d Œ∑ œâ d Œ∑ Œ∑ c here we observed that the sum of volume fractions equals 1 i e 9 …õ œâ …õ Œ∑ 1 besides defining the unique mass dispersion tensor 10 d d œâ œâ d œâ Œ∑ d Œ∑ œâ d Œ∑ Œ∑ the total velocity 11 u u œâ u Œ∑ and the velocity correction term 12 v v œâ œâ v œâ Œ∑ v Œ∑ œâ v Œ∑ Œ∑ then the eq 8 can be re written as the one equation model 13 c t u v c d c up to this point the validity and implications of eq 7 are unknown and they will be analyzed in detail in the appendix b which is fundamentally related with the validity of reservoir scale local mass equilibrium the homogenized domain of the one equation model is represented in fig 1 note that such domain is the same for the two equation model being that the one equation model is derived from the local mass equilibrium imposed on the two equation model the effective parameters correction velocity and cross dispersion can be interpreted in terms of their definitions based on the solution of the associated closure problems which were presented in eqs 48 55 of aguilar madera et al 2019 on one hand the mass dispersion tensor is the contribution of dispersion coefficients resulting from spatial gradients in a porous region that produces dispersion on the other porous region on the other hand the velocity correction is the contribution to the effective velocity produced by variations in local velocities in one porous region that affect local velocities in the other porous region for instance the cross dispersion components describe the solute dispersion in one medium Œ∑ region as a result of solute spatial gradients in the other porous zone œâ region in the same manner the velocity correction in the Œ∑ region results from local variations in the velocity of the œâ region the eq 13 has a fundamental difference with that ones commonly used in geosciences for modeling tracer injection sarris et al 2018 component transport in reservoirs jia and deng 2018 or the contaminant plume in aquifers paladino et al 2018 this difference is related with the effective velocity at reservoir scale u v in our case u is the upscaled darcy velocity and here a fundamental question raises what permeability should be used to estimate u it is common that one effective permeability one for the vertical and other for the horizontal directions be used see for instance sarris et al 2018 but its relation with the facies distribution is not clear and it deserves deeper theoretical and experimental investigations in a similar manner as the upscaling of mass dispersion in this work the issue about the effective permeability will be explored in detail in an ongoing work the estimation of velocity correction v is hard to carry out and the numerical scheme for its computation has been recently reported for the case where the facies distribution is known previously aguilar madera et al 2019 however the geological uncertainty associated with the types of rocks and their accommodations inside the reservoir invariably impact on the correct computation of this parameter despite of this inconvenience the theoretical inference from measurable data in wells for instance breakthrough curves for tracer injection tests could help to build the static model of the reservoir if we think of this problem as one inverse modeled problem and consequently the arrangement of facies could be inferred under the same line of reasoning the theoretical breakthrough curves presented later serve as complements to other information as for instance seismic surveys well logging pressure transient tests and direct inspection of cores in order to integrate a complete reservoir model and for elucidating the arrangement of rocks inside the reservoir it is important to emphasize that in ahmadi et al 1998 the velocity correction v does not exist and the dispersion tensor is a weighted sum of volume averaged dispersion tensor of each medium this is a direct consequence of the initial assumptions made at the darcy scale i e no spatial variation of velocity and fluid incompressibility condition just as presented in table 1 and eq 3 3 numerical estimation of the velocity correction and the total dispersion tensor on the basis of definitions given by eqs 10 and 12 we can estimate the velocity correction v and the dispersion tensor d if the two equation model coefficients are available with this purpose we have numerically computed the relevant coefficients and they are summarized in the appendix a for all the facies arrangements depicted in fig 1 while varying the permeability of facies which are constant in this case we remark that the volume averaging method has similarities with the stochastic approach dagan and lessoff 2001 zarlenga and fiori 2015 when binary and non dilute media are considered however we must emphasize that such characteristics are not intrinsic restrictions of the averaging method and other manners to define properties of media may be used for instance we can employ stochastic realizations of properties following geostatistical approximations but in this case some care must be taken as the correlation length associated with a given stochastic property must be large enough than the rev size in order to get smooth spatial fluctuations of properties other requirement is the assumption of stationary random properties to avoid non local upscaled equations when the volume averaging method is employed the horizontal xx component and vertical yy component elements of the dispersion tensor are plotted in fig 2 those results indicate that flaser and layered reservoirs are more influenced by the permeability differences in the facies at low values of permeability ratio k Œ∑ k œâ 1 the dispersion coefficient varies almost two orders of magnitude for both layered and flaser whereas for high value of permeability ratio k Œ∑ k œâ 1 such variation does not remain for layered system that is characterized by a constant value whilst for flaser system a dramatic reduction is observed we can think for flaser systems as one repetitive sequence of small layered systems and in this sense the dispersion components behave qualitatively similar mainly for low values of permeability ratio the dispersion components for wavy structure exhibits a small but continuous increment for k Œ∑ k œâ 1 whereas for k Œ∑ k œâ 1 a small reduction is observed until they reach constant values for very high permeability ratio values the pin stripe arrangement presents the weakest dependency with the permeability ratio the dispersion coefficient components seem not to depend on the permeability difference in this case if we observe the dispersion tensor behavior for k Œ∑ k œâ and k Œ∑ k œâ it is apparent that it is different for each case when the permeability of the œâ region is greater than the permeability of the Œ∑ region k Œ∑ k œâ 1 the variations on the dispersion tensor are more relevant than for k Œ∑ k œâ 1 furthermore in this last case it does not matter the arrangement of the facies since the dispersion tensor tends to a constant value when k Œ∑ k œâ 1 thus we elucidate that as long as the dispersed facies tends to be smaller the characteristics of continuous facies tends to be predominant note that the dispersion tensor in fig 2 is divided by the Œ∑ facies darcy dispersion coefficient and hence d d Œ∑ for some cases in fig 3 we plotted the vertical against horizontal components of d with the aim to highlight the anisotropy in this regarding the main aspects found is twofold there is a marked anisotropy for lenticular and layered geological systems and the degree of anisotropy increases when the dispersed facies are more permeable than the continuous ones viz k œâ k Œ∑ the numerical computation of x and y components of the velocity correction vector v is plotted in fig 4 for all the facies arrangements of fig 1 while varying the facies permeability in this case we noted that v is practically isotropic for all the cases there is no regularity of the velocity correction as function of permeability however it is clear the following the darcy velocity u needs to be corrected importantly for cases of lenticular reservoirs and to a lesser extent for layered ones for facies completely surrounded by other the error of using only the darcy velocity for advection of chemical components take relevancy by other hand we noted that these errors increase when the permeability ratio ranges 10 3 k Œ∑ k œâ 10 1 approximately clearly some deviations appear for all the facies arrangements and for any permeability ratio however they are stronger at lower values of permeability ratio k Œ∑ k œâ which unveils the fact that the œâ region induces a higher level of deviations than the Œ∑ region this is apparent in fig 4 where the largest values of the velocity correction are observed for cases where one facies is embedded into the other one since the mass dispersion is influenced by the local velocity and the hydrodynamic dispersion the velocity correction and the dispersion tensor components play an essential role when quantifying the solute transport in heterogeneous porous media in this regard the results of this work suggest that it is not enough to use the averaged darcy s scale velocity when modeling two facies large scale permeable systems but the velocity needs to be properly adjusted according to the facies configuration 4 analysis of breakthrough curves in this part we numerically solve the one equation mathematical model given by eq 13 using the dispersion tensor d and the velocity correction v calculated in the previous section the aim of this procedure is to illustrate the characteristic that each facies arrangement yields over breakthrough curves which may have especial utility for the interpretation of tracer tests at large reservoir scale with two lithologies the numerical simulations here presented are also applicable for cases when the solute is practically immiscible in another fluid different to the one in which it is injected if more than one fluid coexists in the reservoir int his work we named as breakthrough curves to the transient concentrations observed at discrete points inside the reservoir the observation point and the center of observation well in fig 5 this differs from the actual breakthrough curve measured in field pumping wells where really a mixed cup solute concentration is evaluated as it takes into account the local mass flux along with the well completion i e a flux averaged concentration is observed as defined by parker and van genuchten 1984 within the comsol multiphysics 5 2a software environment we simulated the injection of one slug of inert solute through a 2d 100 200 m reservoir as depicted in fig 5 the solute is injected through the injection well and its concentration is monitored at the observation point located at x 10 and y 20 m from the bottom left corner and in the center of the observation well the solute concentration injected was c inj 2000 mg l during 2 h the permeability of œâ facies is 10 md while its porosity is 8 the porosity for Œ∑ facies was kept at 1 we analyze two different scenarios a the œâ facies is more permeable and b the Œ∑ facies is more permeable for the first case we fixed k Œ∑ k œâ 0 00518 while for the second case k Œ∑ k œâ 193 07 because in one case the solute is transported slowly the concentration is observed close to the injection well viz at the observation point depicted in fig 5 in the other case the concentration was monitored at the observation well in fig 6 the different breakthrough curves for flaser layered lenticular wavy and pin stripes facies arrangements are plotted while the advance of the solute plume is plotted in fig 7 comparing the two analyzed scenarios we noticed that the order of solute arriving is as follows when the œâ facies is more permeable the solute travels faster through layered wavy and flaser reservoirs ordered from the fastest to lowest transport more solute dispersion is observed for lenticular reservoirs conversely when the Œ∑ facies is more permeable the solute transports faster through pin stripes and lenticular reservoirs the flaser lenticular and pin stripes reservoirs spread more the solute the maximum concentrations vary according to the facies arrangements and more significant differences are encountered for flaser and wavy reservoirs this indicates that the concentration plumes have different shapes according to the geology of reservoir and permeability of continuous facies and furthermore these cannot be generalized for all the types of reservoirs the breakthrough curves indicate that for more permeable œâ facies k Œ∑ k œâ 0 00518 the tracer is scattered in the following order lenticular pin stripes flaser layered and wavy the tracer moves in a compact form in wavy reservoirs and completely dispersed in lenticular ones if one associates the tracer breakthrough curve with the original configuration of lithologies having in mind that in the homogenized large scale system we do not distinguish between facies it is possible to identify the physical reason causing determined transport behavior when the œâ facies is more permeable than the Œ∑ facies i e k Œ∑ k œâ 1 the tracer particles tend to move faster within the œâ facies than in Œ∑ facies the opposite occurs when k Œ∑ k œâ 1 one can think about the two facies porous system like a route with low and high velocity zones being the former the less permeable zone and the later the more permeable zone as the tracer particles moves in the first zone they can be trapped longer than in the second case this phenomenon is translated to the effective coefficients in the one equation model and the results shape the breakthrough curve as exposed in fig 6 the arrival time depends on the facies arrangement and in this case the order from the lower to the larger time is layered flaser wavy lenticular and pin stripe reservoirs on the other hand when the Œ∑ facies is more permeable k Œ∑ k œâ 193 07 the tracer dispersion and the arrival time are quite similar for all the facies arrangements 5 verification of theory now we move on to describe some manners to assess the various implications behind the equilibrium model given by eq 13 in the appendix b we present the necessary physical constraints to model the solute transport with a unique average concentration some of those constraints involve coefficients of the nonequilibrium upscaled model eqs b 43 which needs to satisfy certain requirements so that the ratio in eq b 43 be very small two of the most relevant constraints are b 41 …õ Œ∑ d œâ œâ d œâ Œ∑ …õ œâ d Œ∑ œâ d Œ∑ Œ∑ b 42 …õ Œ∑ v œâ œâ v œâ Œ∑ u œâ …õ œâ v Œ∑ œâ v Œ∑ Œ∑ u Œ∑ which basically state that the dispersion coefficients between facies are equals and that the sum of pseudo velocities equal the darcy velocity in each facies assuming that the volume fraction of facies are equals the above requirements are seriously restrictive and may they will never be fulfilled in practice however in the literature there are numerous reports where the equilibrium model is able to simulate and predict the transport of substances through the subsurface the most essential constraint to satisfy within certain accepted tolerance is related to the ratio of concentrations b 10 c œâ œâ c Œ∑ Œ≥ c 1 it is obvious that as long as this constraint is satisfied then the one equation model is valid on the basis of eq 7 in this tenor in this section we present two manners to assess the accuracy of the one equation model and the numerical computations of the mass dispersion coefficient summarized in the appendix a these are i comparison of the average concentrations from numerical simulations at darcy scale with the objective to test eq b 10 and ii comparison of the dispersion coefficient computed in this work with coefficients calculated from practical tracer tests in various lithologies 5 1 comparison of average concentrations at darcy scale we performed direct numerical simulations at darcy scale with the objective to evaluate if the average concentrations fulfill the requirements for local mass equilibrium following a similar computational domain as that used to get the breakthrough curves presented in section 4 we simulated the injection of one slug of solute at 2 g l during 2 h in this case the facies distribution is drawn explicitly as shown in fig 8 and it increases noticeably the grid mesh employed and furthermore the computational efforts such comsol model allows for the computation of the average concentrations c Œ∑ Œ∑ c œâ œâ and c evaluated within each rev identified in fig 8 we simulated a case when the permeability ratio is k Œ∑ k œâ 10 permeability of œâ facies 10 md porosity of œâ facies 8 and porosity of Œ∑ facies 1 other basic parameters are gradient pressure in the x direction 0 5 psi m and longitudinal dispersivity 5 m the average concentrations along the central row of rev s depicted in fig 8 following the x direction and the ratio of difference concentrations c œâ œâ c Œ∑ Œ∑ c are plotted in fig 9 as function of time we underline that in general the three average concentrations are quite similar and practically we can write that c œâ œâ c Œ∑ Œ∑ c at sufficiently large times observe that the tendency of the curve for difference concentrations approaches to zero as the time increases these asseverations were also observed at other permeability ratios but those results are omitted here for the sake of brevity in addition three important remarks are abstracted from the fig 9 the major concentration differences take place at early times and they are provoked by the boundary conditions employed at the injection boundary in this case we simulated the injection of solute just inside the continuous facies Œ∑ facies and furthermore there is a strong discontinuity between concentrations c œâ œâ and c Œ∑ Œ∑ and with respect to the initial concentrations inside the reservoir the finding of significant concentrations difference at the injection boundary agrees well with the theoretically developed governing equation for concentration difference in the appendix b see eq b 17 where it is stated that in absence of homogenous sources then the manners to yield deviations from the mass equilibrium are through the initial and boundary conditions slight differences of concentration appear at the maximum concentrations zone it is a mobile zone where the initial deviations of the local mass equilibrium remain and travel through the reservoir and also such deviations spreads out behind and ahead of the maximum concentration zone eventually as the solute travels and it is dispersed into the porous media the difference of concentrations is diminished and it practically disappears in the adjacent zones of the maximum concentration region as the time advances the concentrations restriction c œâ œâ c Œ∑ Œ∑ c 1 the absolute value is satisfied and furthermore the local mass equilibrium assumption is valid 5 2 comparison of dispersion coefficients with reported field data and application of the one equation model for solute injection field tests to finalize this section we include a comparison of dispersion coefficients calculated from tracer tests in aquifers and hydrocarbon reservoirs and additionally we provide guidelines to use the one equation model to interpret injection tracer tests in 1d and 2d geometrical configurations we stress that a strict comparison should be carried out attending similar facies arrangements and also in an important manner must be matched the dispersion coefficients at darcy scale for each facies and the flow velocity spite of these dissimilarities we think that these preliminary comparisons will shed light into the consistency and accuracy of numerical predictions of the dispersion tensor d our results do not come from one inverse problem solution instead they are result of a direct problem using the effective coefficients obtained from the spatial smoothing in the upscaling process through the volume averaging method in the fig 10 we plot various dispersion coefficients estimated from breakthrough curves obtained when solutes travel through sandstone shale silts poorly consolidated sand fracture carbonate vuggy gravel compost and karstic rocks such a variety of lithologies yields that the mass dispersion coefficient ranges up to 3 orders of magnitude this evidences the level of uncertainty when modeling heterogeneous large scale geological structures which have spatial variations in their petrophysical properties at different observation scales to address such uncertainties the natural approach is to characterize them by their statistical properties and hence carry out stochastic modeling this issue lies beyond the scope of this work from fig 10 we observe that layered units of silt and sand and compost with limestone gravel have the smaller dispersion coefficients meanwhile the karstic rocks present the largest dispersion values this general behavior agrees qualitatively with our numerical results the models of facies employed to compute the effective dispersion tensor did not include any representative geometry for karstic reservoirs and conversely the geometries of facies used were representative for layered and alternated facies for these reasons it is interestingly coincident that the most of numerical estimations of dispersion coefficients agree well for consecutive layers of compost and a layer of limestone gravel sand and gravel aquifer with laminated or lensed clay and layered units silt sand highly weathered and fresh bedrocks now regarding the use of the one equation model in practical engineering problems we recall that from an inverse problem standpoint the model developed in this work contains just two effective parameters one tensor d and one vector v while the two equation model contains more than twenty parameters depending on the problem dimensionality see eqs 46 and 47 in our previous work aguilar madera et al 2019 in this way the one equation model results much more useful to exemplify this part let us write the one equation model for a 2d injection tracer test problem 14 c t x u x v x c y u y v y c x d l c x y d t c y here it is clear that the longitudinal d l d xx and transverse d t d yy components of tensor d take relevancy additionally to the two components of the velocity correction vector v x and v y nevertheless as demonstrated in this work the velocity correction v could be smaller than the dispersion coefficient depending on the ratio of permeability and the arrangement of lithofacies see fig 4 for higher flow problems for instance through fracture rocks or gas reservoirs the advection clearly predominates over the velocity correction and in those cases only the two dispersion coefficients d l and d t need to be estimated by implementation of inverse problems in that case the eq 14 reduces to 15 c t x u x c y u y c x d l c x y d t c y additionally if the reservoir and wells are configured to outcomes a 1d transport problem the equation to be solved reduces to 16 c t x u x c x d l c x and only the longitudinal coefficient d l needs to be calculated however we must not put aside that the velocity correction has a clear physical meaning as demonstrated in the present work and its usage is recommended for particular cases depending on the permeability ratio and the geometrical configuration of media 6 concluding remarks within the framework of the volume averaging method we presented the theoretical development of the one equation model eq 9 and the physical restrictions of its validity eqs b 38 b 39 and b 43 for the solute transport in two facies reservoirs the one equation model results of using the local mass equilibrium condition i e assuming equality of solute concentration of each facies on the two equation model which is the outcome of upscaling the darcy scale equations to the entire reservoir scale the solution of closure problems associated to the upscaling process allowed us to compute the effective coefficients of the two equation model reported in tables a1 a16 for different arrangements of reservoir lithologies and several permeability ratios and in turn these lasts permit to calculate the two effective coefficients involved in the one equation model the total mass dispersion tensor and the velocity correction vector for the solution of closure problems we considered facies with constant properties which is equivalent to the binary media assumption employed in stochastic approaches with the effective coefficients available the one equation model was numerically solved and we present characteristic breakthrough curves for lenticular pin stripes layered wavy and flaser two facies reservoirs for scenarios when one facies is more permeable than the other we found that the local mass equilibrium condition remains provided the initial and boundary conditions effects propagate softly in each region of the porous medium this is mostly satisfied when the permeability ratio is close to unity a proper comparison of the dispersion coefficient against those estimated from tracer injection test data indicates that the theory predicts acceptable estimations providing adequate facies distribution and darcy scale petrophysical properties finally we provided guidelines to apply the one equation model to simulate 1d and 2d solute transport in real heterogeneous reservoirs when the velocity correction can be justifiably neglected the one equation model reduces to the classical advection dispersion equation widely used in literature in those cases only the traverse and longitudinal dispersive coefficients are required in 2d configurations while only the longitudinal coefficient is needed in 1d problems from the standpoint of the inverse problem solution the one equation model may involve the determination from one up to six effective parameters leading to a hard task in the searching process of the optimal set in this manner the reported parameters tables a1 a16 could be used as starting guesses to map the searching space during the parameters inference author contributions carlos g aguilar madera performed the algebraic efforts to obtain the one equation model supported on the volume averaging method he also contributed to write the manuscript including the revision of previous works e c herrera hern√°ndez performed the numerical computation of all the effective coefficients of the one equation model using a finite element commercial software and he also carried out the comparison of results against darcy scale cfd computations and comparison with field data g espinosa paredes performed the analytical requirements supporting the assumption of local mass equilibrium he also contributed to build logically the entire manuscript declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements echh appreciates the support provided by the fct uanl at linares during this investigation appendix a summary of computed effective coefficients the various coefficients involved in the upscaled two equation model eqs 1 2 were estimated for each facies distribution depicted in fig 1 the coefficient estimation was carried out after numerically solving the several associated closure problems reported recently see eqs b 1 b 20 in aguilar madera et al 2019 for this purpose the software comsol multiphysics 5 2a was employed attending criteria of numerical stability mesh independency and average and periodic condition restrictions as stated in the closure problems the closure problems were solved in the synthetic cells presented in fig a1 in tables a1 a16 we have summarized the numerical estimation of horizontal and vertical components of tensors d œâ œâ d œâ Œ∑ d Œ∑ œâ and d Œ∑ Œ∑ and the pseudo vectors v œâ œâ v œâ Œ∑ v Œ∑ œâ and v Œ∑ Œ∑ as function of facies permeability and their spatial distributions from this information the total dispersion tensor d and the velocity correction v can be straightforwardly computed appendix b validity of reservoir scale local mass equilibrium we begin the analysis observing that one average concentration using a rev which may include Œ∑ or œâ facies can be written in terms of facies average concentrations as follows b 1 c 1 v v cdv 1 v v œâ c œâ d v 1 v v Œ∑ c Œ∑ d v …õ œâ c œâ œâ …õ Œ∑ c Œ∑ Œ∑ the local mass equilibrium assumption states that b 2 c œâ œâ c Œ∑ Œ∑ c one immediate consequence is that the governing equations for œâ and Œ∑ facies eqs 1 and 2 can be added to obtain the one equation model given by eq 13 however up to this point the implications of eq b 2 are not evident in two facies systems subjected to dispersive and advective transport in this regarding we follow systematic procedures to find those conditions for validity of local thermal equilibrium at darcy scale quintard and whitaker 1993 1995 and mass transport with adsorption at large scale quintard and whitaker 1998 which are analogous transport problems the analysis begins writing a less restrictive relation between average concentrations as follows b 3 c œâ œâ c c œâ deviation from equilibrium c Œ∑ Œ∑ c c Œ∑ deviation from equilibrium here c œâ and c Œ∑ quantify the deviation in each facies from reservoir scale local mass equilibrium these variables depend on position and time the next step involves developing the governing equation for c in the light of eq b 3 this is made by adding eqs 1 and 2 and then introduce the eqs b 3 to obtain b 4 c t u v c d c …õ œâ c œâ t …õ Œ∑ c Œ∑ t d œâ œâ d Œ∑ œâ c œâ d œâ Œ∑ d Œ∑ Œ∑ c Œ∑ u œâ v œâ œâ v Œ∑ œâ k l œâ k l Œ∑ c œâ u Œ∑ v œâ Œ∑ v Œ∑ Œ∑ k l œâ k l Œ∑ c Œ∑ here it is clear that while all the terms of the right hand side be much smaller than any of the terms of the right hand side then the one equation model eq 13 is recovered it is common in natural resources reservoirs that advective transport dominates the dispersive transport in the most of cases and considering that this theory is also valid for steady state conditions then it is convenient to compare the terms of right hand side of eq b 4 against the total dispersive term viz b 5 …õ œâ c œâ t d c b 6 …õ Œ∑ c Œ∑ t d c b 7 d œâ œâ d Œ∑ œâ c œâ d œâ Œ∑ d Œ∑ Œ∑ c Œ∑ d c b 8 u œâ v œâ œâ v Œ∑ œâ k l œâ k l Œ∑ c œâ d c b 9 u Œ∑ v œâ Œ∑ v Œ∑ Œ∑ k l œâ k l Œ∑ c Œ∑ d c at this point the magnitude of equilibrium deviations c œâ and c Œ∑ remains unknown and we can employ the eqs b 1 and b 3 to write the deviations as follows b 10 c œâ …õ Œ∑ c œâ œâ c Œ∑ Œ∑ c Œ∑ …õ œâ c œâ œâ c Œ∑ Œ∑ indeed these expressions can be substituted into eqs b 5 b 9 to get b 11 …õ œâ …õ Œ∑ c œâ œâ c Œ∑ Œ∑ t d c b 12 …õ Œ∑ d œâ œâ d Œ∑ œâ …õ œâ d œâ Œ∑ d Œ∑ Œ∑ c œâ œâ c Œ∑ Œ∑ d c b 13 …õ Œ∑ u œâ v œâ œâ v Œ∑ œâ k l œâ k l Œ∑ c œâ œâ c Œ∑ Œ∑ d c b 14 …õ œâ u Œ∑ v œâ Œ∑ v Œ∑ Œ∑ k l œâ k l Œ∑ c œâ œâ c Œ∑ Œ∑ d c following the procedure outlined by quintard and whitaker 1998 the next step involves the development of the governing equation for the difference concentrations c œâ œâ c Œ∑ Œ∑ this equation can be obtained by dividing eq 2 by …õ Œ∑ and then subtracting the result to eq 1 previously divided by …õ œâ this algebraic operation yields the equation b 15 …õ œâ …õ Œ∑ c œâ œâ c Œ∑ Œ∑ t …õ Œ∑ u œâ c œâ œâ …õ œâ u Œ∑ c Œ∑ Œ∑ …õ Œ∑ d œâ œâ …õ œâ d Œ∑ œâ c œâ œâ …õ Œ∑ d œâ Œ∑ …õ œâ d Œ∑ Œ∑ c Œ∑ Œ∑ …õ Œ∑ v œâ œâ …õ œâ v Œ∑ œâ c œâ œâ …õ Œ∑ v œâ Œ∑ …õ œâ v Œ∑ Œ∑ c Œ∑ Œ∑ w œâ c œâ œâ w Œ∑ c Œ∑ Œ∑ œÇ œâ c œâ œâ œÇ Œ∑ c Œ∑ Œ∑ …õ Œ∑ k l œâ …õ œâ k l Œ∑ c œâ œâ c Œ∑ Œ∑ a v k l c œâ œâ c Œ∑ Œ∑ now we can make use of eq b 3 in order to write the intrinsic average concentrations in terms of deviations from equilibrium to get b 16 …õ œâ …õ Œ∑ c œâ œâ c Œ∑ Œ∑ t …õ Œ∑ u œâ …õ œâ u Œ∑ c …õ Œ∑ u œâ c œâ …õ œâ u Œ∑ c Œ∑ …õ Œ∑ d œâ œâ d œâ Œ∑ …õ œâ d Œ∑ œâ d Œ∑ Œ∑ c …õ Œ∑ d œâ œâ …õ œâ d Œ∑ œâ c œâ …õ Œ∑ d œâ Œ∑ …õ œâ d Œ∑ Œ∑ c Œ∑ …õ Œ∑ v œâ œâ v œâ Œ∑ …õ œâ v Œ∑ œâ v Œ∑ Œ∑ c …õ Œ∑ v œâ œâ …õ œâ v Œ∑ œâ c œâ …õ Œ∑ v œâ Œ∑ …õ œâ v Œ∑ Œ∑ c Œ∑ w œâ c œâ w Œ∑ c Œ∑ œÇ œâ c œâ œÇ Œ∑ c Œ∑ w œâ w Œ∑ c œÇ œâ œÇ Œ∑ c …õ Œ∑ k l œâ …õ œâ k l Œ∑ c œâ œâ c Œ∑ Œ∑ a v k l c œâ œâ c Œ∑ Œ∑ after substitution of deviations in terms of intrinsic averages following eq b 10 we obtain now b 17 …õ œâ …õ Œ∑ c œâ œâ c Œ∑ Œ∑ t …õ Œ∑ …õ Œ∑ u œâ …õ œâ …õ œâ u Œ∑ c œâ œâ c Œ∑ Œ∑ …õ Œ∑ …õ Œ∑ d œâ œâ …õ œâ d Œ∑ œâ c œâ œâ c Œ∑ Œ∑ …õ Œ∑ …õ Œ∑ v œâ œâ …õ œâ v Œ∑ œâ c œâ œâ c Œ∑ Œ∑ …õ œâ …õ Œ∑ v œâ Œ∑ …õ œâ v Œ∑ Œ∑ c œâ œâ c Œ∑ Œ∑ …õ Œ∑ k l œâ …õ œâ k l Œ∑ c œâ œâ c Œ∑ Œ∑ …õ œâ …õ Œ∑ d œâ Œ∑ …õ œâ d Œ∑ Œ∑ c œâ œâ c Œ∑ Œ∑ …õ Œ∑ w œâ …õ œâ w Œ∑ c œâ œâ c Œ∑ Œ∑ a v k l …õ Œ∑ œÇ œâ …õ œâ œÇ Œ∑ c œâ œâ c Œ∑ Œ∑ …õ Œ∑ d œâ œâ d œâ Œ∑ …õ œâ d Œ∑ œâ d Œ∑ Œ∑ c source w œâ w Œ∑ c source œÇ œâ œÇ Œ∑ c source …õ Œ∑ v œâ œâ v œâ Œ∑ u œâ …õ œâ v Œ∑ œâ v Œ∑ Œ∑ u Œ∑ c source it is the governing equation for concentration difference at reservoir scale where some sources associated to the equilibrium average concentration c are identified for particular cases where the addition of effective properties be zero i e b 18 …õ Œ∑ d œâ œâ d œâ Œ∑ …õ œâ d Œ∑ œâ d Œ∑ Œ∑ 0 …õ Œ∑ v œâ œâ v œâ Œ∑ u œâ …õ œâ v Œ∑ œâ v Œ∑ Œ∑ u Œ∑ 0 w œâ w Œ∑ 0 œÇ œâ œÇ Œ∑ 0 then eq b 17 becomes homogeneous and the unique sources for concentration difference would appear from initial and external boundaries conditions in the reservoir it is one important conclusion as it states that even for reservoirs whose intrinsic characteristics allow the conditions for equilibrium concentrations between facies some deviations from equilibrium may originate from the initial distribution of solute inside the reservoir or by the way that solute is injected or removed at the external boundaries of the reservoir or even through wells located into the bulk of reservoir proposing the following estimates of magnitude orders for derivatives of the concentrations difference and the equilibrium concentration b 19 c œâ œâ c Œ∑ Œ∑ t o c œâ œâ c Œ∑ Œ∑ t diff b 20 c œâ œâ c Œ∑ Œ∑ o c œâ œâ c Œ∑ Œ∑ l diff b 21 c œâ œâ c Œ∑ Œ∑ o c œâ œâ c Œ∑ Œ∑ l diff c l diff b 22 c o c l eq b 23 c o c l eq c l eq then eq b 17 can be written after some algebraic effort as follows b 24 o c œâ œâ c Œ∑ Œ∑ c a b c d e f g h i j k l m l diff c l diff l eq c l eq where b 25 a …õ Œ∑ d œâ œâ d œâ Œ∑ …õ œâ d Œ∑ œâ d Œ∑ Œ∑ b 26 b l eq c …õ Œ∑ v œâ œâ v œâ Œ∑ u œâ …õ œâ v Œ∑ œâ v Œ∑ Œ∑ u Œ∑ b 27 c l eq c w œâ w Œ∑ b 28 d l eq c l eq œÇ œâ œÇ Œ∑ b 29 e l diff c l diff …õ œâ …õ Œ∑ t diff b 30 f l diff c …õ Œ∑ …õ Œ∑ u œâ …õ œâ …õ œâ u Œ∑ b 31 g …õ Œ∑ l diff c …õ Œ∑ v œâ œâ …õ œâ v Œ∑ œâ b 32 h …õ œâ l diff c …õ Œ∑ v œâ Œ∑ …õ œâ v Œ∑ Œ∑ b 33 i l diff c …õ œâ k l Œ∑ …õ Œ∑ k l œâ b 34 j l diff c …õ œâ w Œ∑ …õ Œ∑ w œâ b 35 k l diff c l diff …õ œâ œÇ Œ∑ …õ Œ∑ œÇ œâ b 36 l l diff c l diff a v k l b 37 m …õ œâ …õ Œ∑ d œâ Œ∑ …õ œâ d Œ∑ Œ∑ …õ Œ∑ …õ Œ∑ d œâ œâ …õ œâ d Œ∑ œâ in eq b 24 l diff l diff c l eq and l eq c are the characteristic length scales for the concentrations difference and its gradient as well as for the equilibrium concentration and its gradient respectively such length scales may be the whole size of the reservoir or even larger for the case of gradients of concentrations on the basis of eq b 24 the assumption of reservoir scale local mass equilibrium validity is subject to satisfy b 38 o c œâ œâ c Œ∑ Œ∑ c 1 one first reasoning about the ratio of length scales presented in the left hand side of eq b 24 is that b 39 l diff c l diff l eq c l eq 1 and furthermore the manner in that the local mass equilibrium be valid is that the numerator be smaller than the denominator such conditions are hard to identify as there may be various combinations of terms a b c and d yielding a sum close to zero nevertheless on the basis of numerical predictions of the effective coefficients summarized in the appendix a we can approximate that b 40 c d a b thus an additional inspection of terms a and b allows to conclude that the mass equilibrium validity is approximated when b 41 …õ Œ∑ d œâ œâ d œâ Œ∑ …õ œâ d Œ∑ œâ d Œ∑ Œ∑ b 42 …õ Œ∑ v œâ œâ v œâ Œ∑ u œâ …õ œâ v Œ∑ œâ v Œ∑ Œ∑ u Œ∑ i e as long as the intrinsic transport properties of facies be similar then the usage of the one equation model is sufficient to model the transport of solute in practice this condition of similitude of petrophysical properties may be very difficult to encounter for reservoirs with high geostatistical variations however some exceptions may be found for reservoirs where each one of the lithofacies identified lie within the same sedimentation environment we state that a deeper study involving the theoretical developments presented in this work along the spatial distributions of properties with geostatistics is beyond the original scopes but it deserves major theoretical efforts in future works one additional manner to satisfy the condition of local mass equilibrium is ensuring that the denominator of eq b 24 has a larger value than its numerator i e b 43 a b c d e f g h i j k l m 1 however once again this condition is hard to glimpse as the denominator is a sum of negative and positive quantities the term e l diff c l diff …õ œâ …õ Œ∑ t diff may perform a larger value for cases when the characteristic time for steady state conditions of concentrations difference presents a small value it would be achieved for relatively small reservoirs with good transport properties permeability mass dispersion and inter facies mass transfer coefficients however this statement deserves a deeper analysis where the characteristic time be compared against the properties of reservoir rocks finally we note that those reservoir rocks with high permeability would lead also to larger values of the term f eq b 30 or other reservoirs with high flow velocity for instance gas reservoirs and naturally artificially fractured reservoirs which would help to satisfy the local mass equilibrium condition 
5610,understanding solute transport in heterogeneous porous media is a challenging problem due to the degree of complexities coming from the spatial variations of petrophysical properties the developments of theoretical formulations are powerful tools used to obtain insights regarding the phenomenology involved in the transport process when analyzing large scale systems in this context and within the framework of the volume averaging method in this work we present an effective one equation model and its validity conditions for the solute transport in heterogeneous reservoirs characterized by two lithology arrangements for this purpose the hypothesis of local mass equilibrium was assumed valid and what follows included the determination of physical constraints supporting such a hypothesis in a previous work aguilar madera et al 2019 the closure problems to calculate the effective coefficients of the two equation model were presented and with this base we present here the numerical estimation of the effective velocity vector and the mass dispersion tensor included in the one equation model as one application the numerical solution of the one equation model was carried out for different lithology arrangements and the breakthrough curves for two permeability ratio scenarios were analyzed the results confirm that the permeability ratio dramatically impact not only the tracer dispersion but also the arrival time at observation points which is strongly correlated to the velocity vector field and its spatial deviations we found that the local mass equilibrium is met more easily in lenticular reservoirs provided that the boundary and initial conditions have no long term effects finally the dispersion coefficient was compared against reported reservoir field data finding similarities in the orders of magnitude for certain geologies keywords solute transport reservoir scale volume averaging method two facies one equation effective model 1 introduction in our previous work aguilar madera et al 2019 we used the method of volume averaging to upscale the darcy scale mass transport equations in order to obtain the corresponding large scale equations for two facies heterogeneous reservoirs in that work we solved the closure problems for lenticular and layered systems see fig 1 and the several effective coefficients for various permeability ratios were evaluated the two equation upscaled model was then solved and compared against the computationally expensive direct numerical simulations finding reasonably good agreement between both results the upscaling process of heterogeneous porous media is required when large scale systems such as oil reservoirs or aquifers need to be modeled as accurate as possible for a reservoir management perspective during its exploitation and production and considering that the solution of pore scale governing equations are not a feasible option instead of using the pore scale equations it is preferred using the volume averaged transport equations which are numerically more tractable and their coefficients have apparent physical meaning which can be evaluated directly from the solution of intrinsic closure problems that incorporate information from lower scales in that sense the two equation model ahmadi et al 1998 cherblanc et al 2007 chastanet and wood 2008 davit et al 2012 porta et al 2012 or the one equation model aguilar madera et al 2011 espinosa paredes et al 2013 are well supported options as they comes from a rigorous procedure based on the volume averaging method certainly there exist other approaches to the upscaling problem in heterogeneous porous media that have been developed alternatively to the volume averaging method for mentioning some of them the stochastic and homogenization methods have demonstrated to be useful when modeling transport in complex porous system in the work of dagan and lessoff 2001 and zarlenga and fiori 2015 they analyze the transport process in multimodal or bimodal media where medium properties conductivity contrast relative volume fraction and the anisotropy ratio governs the entire dynamics also in the same line of stochastic approaches the continuous time random walk ctrw theory has been used to quantify transport in heterogeneous media where the key factor is the attribution of probability density functions pdf to the walkers berkowitz et al 2006 such pdf are consistent with the physical structure regarding the homogenization technique arbogast et al 1990 upscaled the darcy scale flow equation with highly discontinuous properties by using a scaling physical preserving parameter which in the limit when such parameter goes to zero gives the homogenized macroscopic governing equations within the volume averaging method plumb and whitaker 1988 studied the diffusion and dispersion in large scale two phase porous media by using the volume averaging method they proposed a large scale averaging to incorporate the local heterogeneities in the two equation resulting model and they found that time dependent additional terms appear which are absent when such equation comes from the local volume average method under certain conditions the two equation model originally proposed by zanotti and carbonell 1984 for upscaling the advection diffusion transport equations from pore scale to darcy s scale can be simplified to the one equation model this was stated in the work of quintard and whitaker 1993 who later quintard and whitaker 1995 1998 although for heat transfer surveyed and validated the hypothesis of local thermal equilibrium in transient heat conduction in a two region porous medium they explicitly developed the constraints that must be fulfilled in order for such a hypothesis to be valid later ahmadi et al 1998 and quintard et al 2001 provided additional theoretical developments on this topic in their works on the equivalence between the equilibrium one equation model non equilibrium one equation model and the two equation model for one side the non equilibrium one equation model is developed departing from position dependent properties assumption as in the work of quintard et al 2001 where both dispersion tensor and effective velocity depend on position accordingly on the other side the petrophysical properties can be assumed constant as in the work of ahmadi et al 1998 and as in our previous work for which the dispersion tensor and the velocity vector remain constant as well quintard et al 2001 found that the non equilibrium one equation model can be derived even when the average concentrations for each region are different and there is one equivalency with the two equation model only asymptotically as shown previously by zanotti and carbonell 1984 in addition these authors determine a large scale mass equilibrium one equation model by imposing a constraint on the concentration deviation in the averaged equation these findings were later theoretically and experimentally confirmed by cherblanc et al 2007 golfier et al 2007 and davit et al 2012 who studied the solute transport in heterogeneous porous media by large scale averaged two equation model they found that the two equation model converges asymptotically to the non equilibrium one equation model furthermore they provide insights regarding the transport regimes where the transport equations resulting from the application of the volume average method are valid i e the two equation model the one equation local mass equilibrium model and the non equilibrium one equation model aguilar madera et al 2011 analyzed and compared the one equation equilibrium model with the non equilibrium one equation model for a heat transport process in fluid porous medium inter region they found that even when the local thermal equilibrium conditions are met in the bulk at the fluid porous media inter region such conditions may not be valid espinosa paredes et al 2013 used the hypothesis of local thermal equilibrium to derive the heat transport one equation model for a three phase flow in heterogeneous porous medium the one equation model is the most used model regarding applications in large scale systems it is preferable over the two equation model and over other treatments for different reasons i this model is mathematically more tractable since analytical solutions may be derived for some cases ii it requires only two effective parameters and iii it is easy to apply in engineering problems to interpret field tests this mathematical model is commonly used to interpret field tracer tests e g maloszewski et al 1999 d√≠az goebes and younger 2004 goldscheider 2008 morales et al 2018 and pressure tests e g bogatkov and babadagli 2010 escobar et al 2007 zou et al 2013 carried out in oil reservoirs geothermal reservoirs and aquifers with the aim of characterizing dynamically such porous media in this regard the application of the one equation model is not complemented with the definitions of the effective coefficients in terms of information at lower level in the porous microstructure instead the model coefficients frequently are estimated through the inverse problem solution of the field data due to its common usage in modeling solute transport in reservoirs the one equation model encourages the formal derivation that encompasses details of physics at several length scales as mentioned above it has significant advantages over the two equation model and other treatments this motived the extension of our previous work aguilar madera et al 2019 nevertheless we should point out here the following the difference of this work regarding already published works mainly in relation to the ahmadi et al 1998 and cherblanc et al 2007 formulations is that our effective one equation model comes from a more general formulation where the boundary conditions imposed at the boundary between the two regions lithologies are related to the continuity of the total mass flux instead of only the dispersive mass flux as in ahmadi et al and cherblanc et al works in this manner the formulation presented in this paper encompasses the formulations previously mentioned even though the one equation model reported in this work has the same mathematical structure as others reported in the literature our formulation contains additional terms that do not exist on other works such terms arose from the initial physics governing at darcy scale which is different to other works such differences are clarified and discussed later another remarkable difference is that our formulation is valid for both liquids and gases whereas the cited works depart from a condition valid just for liquids incompressibility our work has a significant value and contribution with respect to previous works because the closed mathematical model obtained extends to applications of earth sciences in general where the theoretical results can be applied to general fluid reservoirs containing water oil or and gas i e our results are not restricted only for single phase fluid reservoirs but also multiphase reservoirs can be considered we recognize that the assessment of local mass equilibrium is not an easy task as it depends on multiple factors however we clearly identified relationships of length scale ratios where the concentration differences in both equilibrium and non equilibrium provide elements to meet our departing hypothesis thus in this work by using the local mass equilibrium assumption we derive the one equation model underlying the two equation model that we developed in a previous work aguilar madera et al 2019 in order to demonstrate the validity of such an assumption we analyzed the characteristic length scales in heterogeneous porous media of two lithology arrangements and we determine the necessary and sufficient physical constraints we calculate the effective velocity vector and the dispersion tensor included in the one equation model and as application the breakthrough curves for two scenarios of facies permeabilities and the various types of facies arrangements are analyzed also we compare the concentration profiles at different times for lenticular reservoirs finding that they met the local mass equilibrium condition since the solute concentrations are practically the same in each facies a proper comparison of dispersion coefficient against reported field data is presented in the last part of this work 2 the one equation model the initial point to derive the one equation model is from the statement of the mass transport governing equations for each facies following the two equation approach recently published aguilar madera et al 2019 in our analysis we consider one heterogeneous reservoir composed by two homogeneous facies called the œâ and Œ∑ regions rocks as depicted in fig 1 following the two equation approach the mass transport equation for solute inside the œâ facies is 1 Œµ œâ c œâ œâ t u œâ c œâ œâ d œâ œâ c œâ œâ d œâ Œ∑ c Œ∑ Œ∑ w œâ c œâ œâ w Œ∑ c Œ∑ Œ∑ œÇ œâ c œâ œâ œÇ Œ∑ c Œ∑ Œ∑ v œâ œâ c œâ œâ v œâ Œ∑ c Œ∑ Œ∑ k l œâ c œâ œâ c Œ∑ Œ∑ a v k l c œâ œâ c Œ∑ Œ∑ while the analogous governing equation for Œ∑ facies is 2 …õ Œ∑ c Œ∑ Œ∑ t u Œ∑ c Œ∑ Œ∑ d Œ∑ œâ c œâ œâ d Œ∑ Œ∑ c Œ∑ Œ∑ w œâ c œâ œâ w Œ∑ c Œ∑ Œ∑ œÇ œâ c œâ œâ œÇ Œ∑ c Œ∑ Œ∑ v Œ∑ œâ c œâ œâ v Œ∑ Œ∑ c Œ∑ Œ∑ k l Œ∑ c œâ œâ c Œ∑ Œ∑ a v k l c œâ œâ c Œ∑ Œ∑ here c œâ œâ and c Œ∑ Œ∑ are the intrinsic average concentrations for the œâ and Œ∑ facies respectively these average concentrations gather the concentrations at darcy scale whose governing equations are valid within individual facies depicted in fig 1 the two equation formulation contains several mass dispersion tensors d œâ œâ d œâ Œ∑ d Œ∑ œâ d Œ∑ Œ∑ pseudo convective terms w œâ w œâ v œâ œâ v œâ Œ∑ v Œ∑ œâ v Œ∑ Œ∑ pseudo absorption terms œÇ œâ œÇ Œ∑ and inter facies mass transfer coefficients k l œâ k l Œ∑ a v k l the definitions of all these coefficients are reported elsewhere see eqs 48 62 in aguilar madera et al 2019 and they were computed from the solution of the associated closure problems for lenticular and layered arrangements of facies whilst varying the facies permeability in this work as a complementary part the closure problems were numerically solved for the estimation of the effective coefficients for flaser wave and pin stripes arrangements of facies the results are summarized in the appendix a these types of geological arrangements have been formed from sedimentary processes they are of engineering interest for economical and or environmental purposes several geological reservoirs encompass one or more of such arrangements within the same reservoir body at the end the theoretical results can be used with the previous knowledge of the static model of the reservoir to be studied and with this the correct values of effective parameters should be selected commonly such a static model includes the spatial correlation of petrophysics major arrangement of lithofacies lateral continuity and vertical net pay thus the unique stage where the facies arrangement must be employed is when the numerical solution of closure problems is performed to consequently estimate the effective parameters as observed in the introduction of this work and in our previous one aguilar madera et al 2019 a number of researchers have developed theory for understanding mass transport in heterogeneous porous media at large scale in that sense the way we are tackling the problem using the volume averaging method is not novel and it constitutes the rigorous basis of this work our work represents one effort to bring the advances in fundamentals of porous media to the language and direct applications in the earth sciences thus some assumptions handled in previous works might fail or at least there is no necessity to impose them at this stage limiting the scope of the present work the following table 1 resumes the main differences of our work with respect to the physics handled by ahmadi et al 1998 subsequent works of ahmadi and or coworkers cherblanc et al 2003 2007 davit et al 2012 quintard et al 2001 provided additional numerical estimations of coefficients or extended theoretical analysis based nearly on the darcy scale physics considered by ahmadi the equations presented in table 1 represent some of the initial physics governing at darcy scale and from there the upscaling is performed up to the reservoir scale one of the most significant differences is related to the continuity equation employed while ahmadi and coworkers assumed incompressible fluid we do not specify any equation during our development and furthermore the theoretical results can be applied to general fluid reservoirs containing water oil or and gas in fact our results are not restricted only for single phase fluid reservoirs and multiphase reservoirs can be considered although the analysis of multiphase systems lies beyond the scope of the present work the theory developed here and previously aguilar madera et al 2019 is valid for cases when the solute is miscible only in one phase i e the form of the upscaled equation the closure problems and the definitions of effective coefficients remain unchanged for situations where the solute can be dissolved and or transported into the surrounding phases interphase mass terms need to be included within the primal governing equations this will lead to additional terms in the upscaled equation changing its structure and the closure problems to estimate the effective coefficients and surely other effective coefficients will appear in addition the conditions that we analyze further validating the local mass equilibrium assumption could be modified according to the multiphase physics added another important difference with respect to ahmadi s work is about the assumption that at boundaries between rocks the normal fluid velocity is preserved i e 3 at a œâ Œ∑ n œâ Œ∑ u œâ n œâ Œ∑ u Œ∑ if one accepts this equation then the boundary condition we used is simplified to be continuity of mass flux dispersion written in table 1 in that case our work can be straightforwardly reduced to yield the same closure problems effective coefficients and upscaled equations derived as in previous works ahmadi et al 1998 although the eq 3 was mentioned in our previous work aguilar madera et al 2019 it was not implemented during the upscaling process and development of closure problems in our theoretical development we understood that the upscaling of flow problem in two facies reservoirs deserves other extensive analysis and furthermore we did not impose any condition on velocity leaving that situation for further studies in fact instead of imposing continuity of velocity it seems more plausible to use the continuity of average fluid thermodynamic pressure 4 at a œâ Œ∑ p œâ p Œ∑ which eventually leads to a discontinuity of fluid velocity this can be easily drawn from the single phase darcy s law at darcy scale other approaches will lead to the same conclusion 5 u œâ k œâ k r œâ …õ œâ Œº Œ≤ p œâ œÅ g u Œ∑ k Œ∑ k r Œ∑ …õ Œ∑ Œº Œ≤ p Œ∑ œÅ g where equaling the terms p œâ œÅ g and p Œ∑ œÅ g according to eq 4 we obtain 6 u œâ k œâ k Œ∑ 1 k r œâ k r Œ∑ …õ Œ∑ …õ œâ u Œ∑ in short the usage of eq 3 could be questionable for situations where two rocks have very contrasting petrophysical properties i e permeability k porosity …õ and relative permeability k r as a matter of fact the equality of pressures can be also questionable for porous rocks under multiphase flow and whose pore sizes can yield large and contrasting capillary pressures when the fluid passes from one rock to the other thus we state that it is not easy to elucidate the correct boundary condition for the fluid velocity at this stage for the problem of species mass transport there is not necessity to define it yet now continuing with the original line of our work if we assume a priori that the mass transport in the whole two facies reservoir is well modeled with a unique average concentration large scale mass equilibrium then we can write that 7 c œâ œâ c Œ∑ Œ∑ c thus adding eqs 1 and 2 yields 8 c t u œâ u Œ∑ v œâ œâ v œâ Œ∑ v Œ∑ œâ v Œ∑ Œ∑ c d œâ œâ d œâ Œ∑ d Œ∑ œâ d Œ∑ Œ∑ c here we observed that the sum of volume fractions equals 1 i e 9 …õ œâ …õ Œ∑ 1 besides defining the unique mass dispersion tensor 10 d d œâ œâ d œâ Œ∑ d Œ∑ œâ d Œ∑ Œ∑ the total velocity 11 u u œâ u Œ∑ and the velocity correction term 12 v v œâ œâ v œâ Œ∑ v Œ∑ œâ v Œ∑ Œ∑ then the eq 8 can be re written as the one equation model 13 c t u v c d c up to this point the validity and implications of eq 7 are unknown and they will be analyzed in detail in the appendix b which is fundamentally related with the validity of reservoir scale local mass equilibrium the homogenized domain of the one equation model is represented in fig 1 note that such domain is the same for the two equation model being that the one equation model is derived from the local mass equilibrium imposed on the two equation model the effective parameters correction velocity and cross dispersion can be interpreted in terms of their definitions based on the solution of the associated closure problems which were presented in eqs 48 55 of aguilar madera et al 2019 on one hand the mass dispersion tensor is the contribution of dispersion coefficients resulting from spatial gradients in a porous region that produces dispersion on the other porous region on the other hand the velocity correction is the contribution to the effective velocity produced by variations in local velocities in one porous region that affect local velocities in the other porous region for instance the cross dispersion components describe the solute dispersion in one medium Œ∑ region as a result of solute spatial gradients in the other porous zone œâ region in the same manner the velocity correction in the Œ∑ region results from local variations in the velocity of the œâ region the eq 13 has a fundamental difference with that ones commonly used in geosciences for modeling tracer injection sarris et al 2018 component transport in reservoirs jia and deng 2018 or the contaminant plume in aquifers paladino et al 2018 this difference is related with the effective velocity at reservoir scale u v in our case u is the upscaled darcy velocity and here a fundamental question raises what permeability should be used to estimate u it is common that one effective permeability one for the vertical and other for the horizontal directions be used see for instance sarris et al 2018 but its relation with the facies distribution is not clear and it deserves deeper theoretical and experimental investigations in a similar manner as the upscaling of mass dispersion in this work the issue about the effective permeability will be explored in detail in an ongoing work the estimation of velocity correction v is hard to carry out and the numerical scheme for its computation has been recently reported for the case where the facies distribution is known previously aguilar madera et al 2019 however the geological uncertainty associated with the types of rocks and their accommodations inside the reservoir invariably impact on the correct computation of this parameter despite of this inconvenience the theoretical inference from measurable data in wells for instance breakthrough curves for tracer injection tests could help to build the static model of the reservoir if we think of this problem as one inverse modeled problem and consequently the arrangement of facies could be inferred under the same line of reasoning the theoretical breakthrough curves presented later serve as complements to other information as for instance seismic surveys well logging pressure transient tests and direct inspection of cores in order to integrate a complete reservoir model and for elucidating the arrangement of rocks inside the reservoir it is important to emphasize that in ahmadi et al 1998 the velocity correction v does not exist and the dispersion tensor is a weighted sum of volume averaged dispersion tensor of each medium this is a direct consequence of the initial assumptions made at the darcy scale i e no spatial variation of velocity and fluid incompressibility condition just as presented in table 1 and eq 3 3 numerical estimation of the velocity correction and the total dispersion tensor on the basis of definitions given by eqs 10 and 12 we can estimate the velocity correction v and the dispersion tensor d if the two equation model coefficients are available with this purpose we have numerically computed the relevant coefficients and they are summarized in the appendix a for all the facies arrangements depicted in fig 1 while varying the permeability of facies which are constant in this case we remark that the volume averaging method has similarities with the stochastic approach dagan and lessoff 2001 zarlenga and fiori 2015 when binary and non dilute media are considered however we must emphasize that such characteristics are not intrinsic restrictions of the averaging method and other manners to define properties of media may be used for instance we can employ stochastic realizations of properties following geostatistical approximations but in this case some care must be taken as the correlation length associated with a given stochastic property must be large enough than the rev size in order to get smooth spatial fluctuations of properties other requirement is the assumption of stationary random properties to avoid non local upscaled equations when the volume averaging method is employed the horizontal xx component and vertical yy component elements of the dispersion tensor are plotted in fig 2 those results indicate that flaser and layered reservoirs are more influenced by the permeability differences in the facies at low values of permeability ratio k Œ∑ k œâ 1 the dispersion coefficient varies almost two orders of magnitude for both layered and flaser whereas for high value of permeability ratio k Œ∑ k œâ 1 such variation does not remain for layered system that is characterized by a constant value whilst for flaser system a dramatic reduction is observed we can think for flaser systems as one repetitive sequence of small layered systems and in this sense the dispersion components behave qualitatively similar mainly for low values of permeability ratio the dispersion components for wavy structure exhibits a small but continuous increment for k Œ∑ k œâ 1 whereas for k Œ∑ k œâ 1 a small reduction is observed until they reach constant values for very high permeability ratio values the pin stripe arrangement presents the weakest dependency with the permeability ratio the dispersion coefficient components seem not to depend on the permeability difference in this case if we observe the dispersion tensor behavior for k Œ∑ k œâ and k Œ∑ k œâ it is apparent that it is different for each case when the permeability of the œâ region is greater than the permeability of the Œ∑ region k Œ∑ k œâ 1 the variations on the dispersion tensor are more relevant than for k Œ∑ k œâ 1 furthermore in this last case it does not matter the arrangement of the facies since the dispersion tensor tends to a constant value when k Œ∑ k œâ 1 thus we elucidate that as long as the dispersed facies tends to be smaller the characteristics of continuous facies tends to be predominant note that the dispersion tensor in fig 2 is divided by the Œ∑ facies darcy dispersion coefficient and hence d d Œ∑ for some cases in fig 3 we plotted the vertical against horizontal components of d with the aim to highlight the anisotropy in this regarding the main aspects found is twofold there is a marked anisotropy for lenticular and layered geological systems and the degree of anisotropy increases when the dispersed facies are more permeable than the continuous ones viz k œâ k Œ∑ the numerical computation of x and y components of the velocity correction vector v is plotted in fig 4 for all the facies arrangements of fig 1 while varying the facies permeability in this case we noted that v is practically isotropic for all the cases there is no regularity of the velocity correction as function of permeability however it is clear the following the darcy velocity u needs to be corrected importantly for cases of lenticular reservoirs and to a lesser extent for layered ones for facies completely surrounded by other the error of using only the darcy velocity for advection of chemical components take relevancy by other hand we noted that these errors increase when the permeability ratio ranges 10 3 k Œ∑ k œâ 10 1 approximately clearly some deviations appear for all the facies arrangements and for any permeability ratio however they are stronger at lower values of permeability ratio k Œ∑ k œâ which unveils the fact that the œâ region induces a higher level of deviations than the Œ∑ region this is apparent in fig 4 where the largest values of the velocity correction are observed for cases where one facies is embedded into the other one since the mass dispersion is influenced by the local velocity and the hydrodynamic dispersion the velocity correction and the dispersion tensor components play an essential role when quantifying the solute transport in heterogeneous porous media in this regard the results of this work suggest that it is not enough to use the averaged darcy s scale velocity when modeling two facies large scale permeable systems but the velocity needs to be properly adjusted according to the facies configuration 4 analysis of breakthrough curves in this part we numerically solve the one equation mathematical model given by eq 13 using the dispersion tensor d and the velocity correction v calculated in the previous section the aim of this procedure is to illustrate the characteristic that each facies arrangement yields over breakthrough curves which may have especial utility for the interpretation of tracer tests at large reservoir scale with two lithologies the numerical simulations here presented are also applicable for cases when the solute is practically immiscible in another fluid different to the one in which it is injected if more than one fluid coexists in the reservoir int his work we named as breakthrough curves to the transient concentrations observed at discrete points inside the reservoir the observation point and the center of observation well in fig 5 this differs from the actual breakthrough curve measured in field pumping wells where really a mixed cup solute concentration is evaluated as it takes into account the local mass flux along with the well completion i e a flux averaged concentration is observed as defined by parker and van genuchten 1984 within the comsol multiphysics 5 2a software environment we simulated the injection of one slug of inert solute through a 2d 100 200 m reservoir as depicted in fig 5 the solute is injected through the injection well and its concentration is monitored at the observation point located at x 10 and y 20 m from the bottom left corner and in the center of the observation well the solute concentration injected was c inj 2000 mg l during 2 h the permeability of œâ facies is 10 md while its porosity is 8 the porosity for Œ∑ facies was kept at 1 we analyze two different scenarios a the œâ facies is more permeable and b the Œ∑ facies is more permeable for the first case we fixed k Œ∑ k œâ 0 00518 while for the second case k Œ∑ k œâ 193 07 because in one case the solute is transported slowly the concentration is observed close to the injection well viz at the observation point depicted in fig 5 in the other case the concentration was monitored at the observation well in fig 6 the different breakthrough curves for flaser layered lenticular wavy and pin stripes facies arrangements are plotted while the advance of the solute plume is plotted in fig 7 comparing the two analyzed scenarios we noticed that the order of solute arriving is as follows when the œâ facies is more permeable the solute travels faster through layered wavy and flaser reservoirs ordered from the fastest to lowest transport more solute dispersion is observed for lenticular reservoirs conversely when the Œ∑ facies is more permeable the solute transports faster through pin stripes and lenticular reservoirs the flaser lenticular and pin stripes reservoirs spread more the solute the maximum concentrations vary according to the facies arrangements and more significant differences are encountered for flaser and wavy reservoirs this indicates that the concentration plumes have different shapes according to the geology of reservoir and permeability of continuous facies and furthermore these cannot be generalized for all the types of reservoirs the breakthrough curves indicate that for more permeable œâ facies k Œ∑ k œâ 0 00518 the tracer is scattered in the following order lenticular pin stripes flaser layered and wavy the tracer moves in a compact form in wavy reservoirs and completely dispersed in lenticular ones if one associates the tracer breakthrough curve with the original configuration of lithologies having in mind that in the homogenized large scale system we do not distinguish between facies it is possible to identify the physical reason causing determined transport behavior when the œâ facies is more permeable than the Œ∑ facies i e k Œ∑ k œâ 1 the tracer particles tend to move faster within the œâ facies than in Œ∑ facies the opposite occurs when k Œ∑ k œâ 1 one can think about the two facies porous system like a route with low and high velocity zones being the former the less permeable zone and the later the more permeable zone as the tracer particles moves in the first zone they can be trapped longer than in the second case this phenomenon is translated to the effective coefficients in the one equation model and the results shape the breakthrough curve as exposed in fig 6 the arrival time depends on the facies arrangement and in this case the order from the lower to the larger time is layered flaser wavy lenticular and pin stripe reservoirs on the other hand when the Œ∑ facies is more permeable k Œ∑ k œâ 193 07 the tracer dispersion and the arrival time are quite similar for all the facies arrangements 5 verification of theory now we move on to describe some manners to assess the various implications behind the equilibrium model given by eq 13 in the appendix b we present the necessary physical constraints to model the solute transport with a unique average concentration some of those constraints involve coefficients of the nonequilibrium upscaled model eqs b 43 which needs to satisfy certain requirements so that the ratio in eq b 43 be very small two of the most relevant constraints are b 41 …õ Œ∑ d œâ œâ d œâ Œ∑ …õ œâ d Œ∑ œâ d Œ∑ Œ∑ b 42 …õ Œ∑ v œâ œâ v œâ Œ∑ u œâ …õ œâ v Œ∑ œâ v Œ∑ Œ∑ u Œ∑ which basically state that the dispersion coefficients between facies are equals and that the sum of pseudo velocities equal the darcy velocity in each facies assuming that the volume fraction of facies are equals the above requirements are seriously restrictive and may they will never be fulfilled in practice however in the literature there are numerous reports where the equilibrium model is able to simulate and predict the transport of substances through the subsurface the most essential constraint to satisfy within certain accepted tolerance is related to the ratio of concentrations b 10 c œâ œâ c Œ∑ Œ≥ c 1 it is obvious that as long as this constraint is satisfied then the one equation model is valid on the basis of eq 7 in this tenor in this section we present two manners to assess the accuracy of the one equation model and the numerical computations of the mass dispersion coefficient summarized in the appendix a these are i comparison of the average concentrations from numerical simulations at darcy scale with the objective to test eq b 10 and ii comparison of the dispersion coefficient computed in this work with coefficients calculated from practical tracer tests in various lithologies 5 1 comparison of average concentrations at darcy scale we performed direct numerical simulations at darcy scale with the objective to evaluate if the average concentrations fulfill the requirements for local mass equilibrium following a similar computational domain as that used to get the breakthrough curves presented in section 4 we simulated the injection of one slug of solute at 2 g l during 2 h in this case the facies distribution is drawn explicitly as shown in fig 8 and it increases noticeably the grid mesh employed and furthermore the computational efforts such comsol model allows for the computation of the average concentrations c Œ∑ Œ∑ c œâ œâ and c evaluated within each rev identified in fig 8 we simulated a case when the permeability ratio is k Œ∑ k œâ 10 permeability of œâ facies 10 md porosity of œâ facies 8 and porosity of Œ∑ facies 1 other basic parameters are gradient pressure in the x direction 0 5 psi m and longitudinal dispersivity 5 m the average concentrations along the central row of rev s depicted in fig 8 following the x direction and the ratio of difference concentrations c œâ œâ c Œ∑ Œ∑ c are plotted in fig 9 as function of time we underline that in general the three average concentrations are quite similar and practically we can write that c œâ œâ c Œ∑ Œ∑ c at sufficiently large times observe that the tendency of the curve for difference concentrations approaches to zero as the time increases these asseverations were also observed at other permeability ratios but those results are omitted here for the sake of brevity in addition three important remarks are abstracted from the fig 9 the major concentration differences take place at early times and they are provoked by the boundary conditions employed at the injection boundary in this case we simulated the injection of solute just inside the continuous facies Œ∑ facies and furthermore there is a strong discontinuity between concentrations c œâ œâ and c Œ∑ Œ∑ and with respect to the initial concentrations inside the reservoir the finding of significant concentrations difference at the injection boundary agrees well with the theoretically developed governing equation for concentration difference in the appendix b see eq b 17 where it is stated that in absence of homogenous sources then the manners to yield deviations from the mass equilibrium are through the initial and boundary conditions slight differences of concentration appear at the maximum concentrations zone it is a mobile zone where the initial deviations of the local mass equilibrium remain and travel through the reservoir and also such deviations spreads out behind and ahead of the maximum concentration zone eventually as the solute travels and it is dispersed into the porous media the difference of concentrations is diminished and it practically disappears in the adjacent zones of the maximum concentration region as the time advances the concentrations restriction c œâ œâ c Œ∑ Œ∑ c 1 the absolute value is satisfied and furthermore the local mass equilibrium assumption is valid 5 2 comparison of dispersion coefficients with reported field data and application of the one equation model for solute injection field tests to finalize this section we include a comparison of dispersion coefficients calculated from tracer tests in aquifers and hydrocarbon reservoirs and additionally we provide guidelines to use the one equation model to interpret injection tracer tests in 1d and 2d geometrical configurations we stress that a strict comparison should be carried out attending similar facies arrangements and also in an important manner must be matched the dispersion coefficients at darcy scale for each facies and the flow velocity spite of these dissimilarities we think that these preliminary comparisons will shed light into the consistency and accuracy of numerical predictions of the dispersion tensor d our results do not come from one inverse problem solution instead they are result of a direct problem using the effective coefficients obtained from the spatial smoothing in the upscaling process through the volume averaging method in the fig 10 we plot various dispersion coefficients estimated from breakthrough curves obtained when solutes travel through sandstone shale silts poorly consolidated sand fracture carbonate vuggy gravel compost and karstic rocks such a variety of lithologies yields that the mass dispersion coefficient ranges up to 3 orders of magnitude this evidences the level of uncertainty when modeling heterogeneous large scale geological structures which have spatial variations in their petrophysical properties at different observation scales to address such uncertainties the natural approach is to characterize them by their statistical properties and hence carry out stochastic modeling this issue lies beyond the scope of this work from fig 10 we observe that layered units of silt and sand and compost with limestone gravel have the smaller dispersion coefficients meanwhile the karstic rocks present the largest dispersion values this general behavior agrees qualitatively with our numerical results the models of facies employed to compute the effective dispersion tensor did not include any representative geometry for karstic reservoirs and conversely the geometries of facies used were representative for layered and alternated facies for these reasons it is interestingly coincident that the most of numerical estimations of dispersion coefficients agree well for consecutive layers of compost and a layer of limestone gravel sand and gravel aquifer with laminated or lensed clay and layered units silt sand highly weathered and fresh bedrocks now regarding the use of the one equation model in practical engineering problems we recall that from an inverse problem standpoint the model developed in this work contains just two effective parameters one tensor d and one vector v while the two equation model contains more than twenty parameters depending on the problem dimensionality see eqs 46 and 47 in our previous work aguilar madera et al 2019 in this way the one equation model results much more useful to exemplify this part let us write the one equation model for a 2d injection tracer test problem 14 c t x u x v x c y u y v y c x d l c x y d t c y here it is clear that the longitudinal d l d xx and transverse d t d yy components of tensor d take relevancy additionally to the two components of the velocity correction vector v x and v y nevertheless as demonstrated in this work the velocity correction v could be smaller than the dispersion coefficient depending on the ratio of permeability and the arrangement of lithofacies see fig 4 for higher flow problems for instance through fracture rocks or gas reservoirs the advection clearly predominates over the velocity correction and in those cases only the two dispersion coefficients d l and d t need to be estimated by implementation of inverse problems in that case the eq 14 reduces to 15 c t x u x c y u y c x d l c x y d t c y additionally if the reservoir and wells are configured to outcomes a 1d transport problem the equation to be solved reduces to 16 c t x u x c x d l c x and only the longitudinal coefficient d l needs to be calculated however we must not put aside that the velocity correction has a clear physical meaning as demonstrated in the present work and its usage is recommended for particular cases depending on the permeability ratio and the geometrical configuration of media 6 concluding remarks within the framework of the volume averaging method we presented the theoretical development of the one equation model eq 9 and the physical restrictions of its validity eqs b 38 b 39 and b 43 for the solute transport in two facies reservoirs the one equation model results of using the local mass equilibrium condition i e assuming equality of solute concentration of each facies on the two equation model which is the outcome of upscaling the darcy scale equations to the entire reservoir scale the solution of closure problems associated to the upscaling process allowed us to compute the effective coefficients of the two equation model reported in tables a1 a16 for different arrangements of reservoir lithologies and several permeability ratios and in turn these lasts permit to calculate the two effective coefficients involved in the one equation model the total mass dispersion tensor and the velocity correction vector for the solution of closure problems we considered facies with constant properties which is equivalent to the binary media assumption employed in stochastic approaches with the effective coefficients available the one equation model was numerically solved and we present characteristic breakthrough curves for lenticular pin stripes layered wavy and flaser two facies reservoirs for scenarios when one facies is more permeable than the other we found that the local mass equilibrium condition remains provided the initial and boundary conditions effects propagate softly in each region of the porous medium this is mostly satisfied when the permeability ratio is close to unity a proper comparison of the dispersion coefficient against those estimated from tracer injection test data indicates that the theory predicts acceptable estimations providing adequate facies distribution and darcy scale petrophysical properties finally we provided guidelines to apply the one equation model to simulate 1d and 2d solute transport in real heterogeneous reservoirs when the velocity correction can be justifiably neglected the one equation model reduces to the classical advection dispersion equation widely used in literature in those cases only the traverse and longitudinal dispersive coefficients are required in 2d configurations while only the longitudinal coefficient is needed in 1d problems from the standpoint of the inverse problem solution the one equation model may involve the determination from one up to six effective parameters leading to a hard task in the searching process of the optimal set in this manner the reported parameters tables a1 a16 could be used as starting guesses to map the searching space during the parameters inference author contributions carlos g aguilar madera performed the algebraic efforts to obtain the one equation model supported on the volume averaging method he also contributed to write the manuscript including the revision of previous works e c herrera hern√°ndez performed the numerical computation of all the effective coefficients of the one equation model using a finite element commercial software and he also carried out the comparison of results against darcy scale cfd computations and comparison with field data g espinosa paredes performed the analytical requirements supporting the assumption of local mass equilibrium he also contributed to build logically the entire manuscript declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements echh appreciates the support provided by the fct uanl at linares during this investigation appendix a summary of computed effective coefficients the various coefficients involved in the upscaled two equation model eqs 1 2 were estimated for each facies distribution depicted in fig 1 the coefficient estimation was carried out after numerically solving the several associated closure problems reported recently see eqs b 1 b 20 in aguilar madera et al 2019 for this purpose the software comsol multiphysics 5 2a was employed attending criteria of numerical stability mesh independency and average and periodic condition restrictions as stated in the closure problems the closure problems were solved in the synthetic cells presented in fig a1 in tables a1 a16 we have summarized the numerical estimation of horizontal and vertical components of tensors d œâ œâ d œâ Œ∑ d Œ∑ œâ and d Œ∑ Œ∑ and the pseudo vectors v œâ œâ v œâ Œ∑ v Œ∑ œâ and v Œ∑ Œ∑ as function of facies permeability and their spatial distributions from this information the total dispersion tensor d and the velocity correction v can be straightforwardly computed appendix b validity of reservoir scale local mass equilibrium we begin the analysis observing that one average concentration using a rev which may include Œ∑ or œâ facies can be written in terms of facies average concentrations as follows b 1 c 1 v v cdv 1 v v œâ c œâ d v 1 v v Œ∑ c Œ∑ d v …õ œâ c œâ œâ …õ Œ∑ c Œ∑ Œ∑ the local mass equilibrium assumption states that b 2 c œâ œâ c Œ∑ Œ∑ c one immediate consequence is that the governing equations for œâ and Œ∑ facies eqs 1 and 2 can be added to obtain the one equation model given by eq 13 however up to this point the implications of eq b 2 are not evident in two facies systems subjected to dispersive and advective transport in this regarding we follow systematic procedures to find those conditions for validity of local thermal equilibrium at darcy scale quintard and whitaker 1993 1995 and mass transport with adsorption at large scale quintard and whitaker 1998 which are analogous transport problems the analysis begins writing a less restrictive relation between average concentrations as follows b 3 c œâ œâ c c œâ deviation from equilibrium c Œ∑ Œ∑ c c Œ∑ deviation from equilibrium here c œâ and c Œ∑ quantify the deviation in each facies from reservoir scale local mass equilibrium these variables depend on position and time the next step involves developing the governing equation for c in the light of eq b 3 this is made by adding eqs 1 and 2 and then introduce the eqs b 3 to obtain b 4 c t u v c d c …õ œâ c œâ t …õ Œ∑ c Œ∑ t d œâ œâ d Œ∑ œâ c œâ d œâ Œ∑ d Œ∑ Œ∑ c Œ∑ u œâ v œâ œâ v Œ∑ œâ k l œâ k l Œ∑ c œâ u Œ∑ v œâ Œ∑ v Œ∑ Œ∑ k l œâ k l Œ∑ c Œ∑ here it is clear that while all the terms of the right hand side be much smaller than any of the terms of the right hand side then the one equation model eq 13 is recovered it is common in natural resources reservoirs that advective transport dominates the dispersive transport in the most of cases and considering that this theory is also valid for steady state conditions then it is convenient to compare the terms of right hand side of eq b 4 against the total dispersive term viz b 5 …õ œâ c œâ t d c b 6 …õ Œ∑ c Œ∑ t d c b 7 d œâ œâ d Œ∑ œâ c œâ d œâ Œ∑ d Œ∑ Œ∑ c Œ∑ d c b 8 u œâ v œâ œâ v Œ∑ œâ k l œâ k l Œ∑ c œâ d c b 9 u Œ∑ v œâ Œ∑ v Œ∑ Œ∑ k l œâ k l Œ∑ c Œ∑ d c at this point the magnitude of equilibrium deviations c œâ and c Œ∑ remains unknown and we can employ the eqs b 1 and b 3 to write the deviations as follows b 10 c œâ …õ Œ∑ c œâ œâ c Œ∑ Œ∑ c Œ∑ …õ œâ c œâ œâ c Œ∑ Œ∑ indeed these expressions can be substituted into eqs b 5 b 9 to get b 11 …õ œâ …õ Œ∑ c œâ œâ c Œ∑ Œ∑ t d c b 12 …õ Œ∑ d œâ œâ d Œ∑ œâ …õ œâ d œâ Œ∑ d Œ∑ Œ∑ c œâ œâ c Œ∑ Œ∑ d c b 13 …õ Œ∑ u œâ v œâ œâ v Œ∑ œâ k l œâ k l Œ∑ c œâ œâ c Œ∑ Œ∑ d c b 14 …õ œâ u Œ∑ v œâ Œ∑ v Œ∑ Œ∑ k l œâ k l Œ∑ c œâ œâ c Œ∑ Œ∑ d c following the procedure outlined by quintard and whitaker 1998 the next step involves the development of the governing equation for the difference concentrations c œâ œâ c Œ∑ Œ∑ this equation can be obtained by dividing eq 2 by …õ Œ∑ and then subtracting the result to eq 1 previously divided by …õ œâ this algebraic operation yields the equation b 15 …õ œâ …õ Œ∑ c œâ œâ c Œ∑ Œ∑ t …õ Œ∑ u œâ c œâ œâ …õ œâ u Œ∑ c Œ∑ Œ∑ …õ Œ∑ d œâ œâ …õ œâ d Œ∑ œâ c œâ œâ …õ Œ∑ d œâ Œ∑ …õ œâ d Œ∑ Œ∑ c Œ∑ Œ∑ …õ Œ∑ v œâ œâ …õ œâ v Œ∑ œâ c œâ œâ …õ Œ∑ v œâ Œ∑ …õ œâ v Œ∑ Œ∑ c Œ∑ Œ∑ w œâ c œâ œâ w Œ∑ c Œ∑ Œ∑ œÇ œâ c œâ œâ œÇ Œ∑ c Œ∑ Œ∑ …õ Œ∑ k l œâ …õ œâ k l Œ∑ c œâ œâ c Œ∑ Œ∑ a v k l c œâ œâ c Œ∑ Œ∑ now we can make use of eq b 3 in order to write the intrinsic average concentrations in terms of deviations from equilibrium to get b 16 …õ œâ …õ Œ∑ c œâ œâ c Œ∑ Œ∑ t …õ Œ∑ u œâ …õ œâ u Œ∑ c …õ Œ∑ u œâ c œâ …õ œâ u Œ∑ c Œ∑ …õ Œ∑ d œâ œâ d œâ Œ∑ …õ œâ d Œ∑ œâ d Œ∑ Œ∑ c …õ Œ∑ d œâ œâ …õ œâ d Œ∑ œâ c œâ …õ Œ∑ d œâ Œ∑ …õ œâ d Œ∑ Œ∑ c Œ∑ …õ Œ∑ v œâ œâ v œâ Œ∑ …õ œâ v Œ∑ œâ v Œ∑ Œ∑ c …õ Œ∑ v œâ œâ …õ œâ v Œ∑ œâ c œâ …õ Œ∑ v œâ Œ∑ …õ œâ v Œ∑ Œ∑ c Œ∑ w œâ c œâ w Œ∑ c Œ∑ œÇ œâ c œâ œÇ Œ∑ c Œ∑ w œâ w Œ∑ c œÇ œâ œÇ Œ∑ c …õ Œ∑ k l œâ …õ œâ k l Œ∑ c œâ œâ c Œ∑ Œ∑ a v k l c œâ œâ c Œ∑ Œ∑ after substitution of deviations in terms of intrinsic averages following eq b 10 we obtain now b 17 …õ œâ …õ Œ∑ c œâ œâ c Œ∑ Œ∑ t …õ Œ∑ …õ Œ∑ u œâ …õ œâ …õ œâ u Œ∑ c œâ œâ c Œ∑ Œ∑ …õ Œ∑ …õ Œ∑ d œâ œâ …õ œâ d Œ∑ œâ c œâ œâ c Œ∑ Œ∑ …õ Œ∑ …õ Œ∑ v œâ œâ …õ œâ v Œ∑ œâ c œâ œâ c Œ∑ Œ∑ …õ œâ …õ Œ∑ v œâ Œ∑ …õ œâ v Œ∑ Œ∑ c œâ œâ c Œ∑ Œ∑ …õ Œ∑ k l œâ …õ œâ k l Œ∑ c œâ œâ c Œ∑ Œ∑ …õ œâ …õ Œ∑ d œâ Œ∑ …õ œâ d Œ∑ Œ∑ c œâ œâ c Œ∑ Œ∑ …õ Œ∑ w œâ …õ œâ w Œ∑ c œâ œâ c Œ∑ Œ∑ a v k l …õ Œ∑ œÇ œâ …õ œâ œÇ Œ∑ c œâ œâ c Œ∑ Œ∑ …õ Œ∑ d œâ œâ d œâ Œ∑ …õ œâ d Œ∑ œâ d Œ∑ Œ∑ c source w œâ w Œ∑ c source œÇ œâ œÇ Œ∑ c source …õ Œ∑ v œâ œâ v œâ Œ∑ u œâ …õ œâ v Œ∑ œâ v Œ∑ Œ∑ u Œ∑ c source it is the governing equation for concentration difference at reservoir scale where some sources associated to the equilibrium average concentration c are identified for particular cases where the addition of effective properties be zero i e b 18 …õ Œ∑ d œâ œâ d œâ Œ∑ …õ œâ d Œ∑ œâ d Œ∑ Œ∑ 0 …õ Œ∑ v œâ œâ v œâ Œ∑ u œâ …õ œâ v Œ∑ œâ v Œ∑ Œ∑ u Œ∑ 0 w œâ w Œ∑ 0 œÇ œâ œÇ Œ∑ 0 then eq b 17 becomes homogeneous and the unique sources for concentration difference would appear from initial and external boundaries conditions in the reservoir it is one important conclusion as it states that even for reservoirs whose intrinsic characteristics allow the conditions for equilibrium concentrations between facies some deviations from equilibrium may originate from the initial distribution of solute inside the reservoir or by the way that solute is injected or removed at the external boundaries of the reservoir or even through wells located into the bulk of reservoir proposing the following estimates of magnitude orders for derivatives of the concentrations difference and the equilibrium concentration b 19 c œâ œâ c Œ∑ Œ∑ t o c œâ œâ c Œ∑ Œ∑ t diff b 20 c œâ œâ c Œ∑ Œ∑ o c œâ œâ c Œ∑ Œ∑ l diff b 21 c œâ œâ c Œ∑ Œ∑ o c œâ œâ c Œ∑ Œ∑ l diff c l diff b 22 c o c l eq b 23 c o c l eq c l eq then eq b 17 can be written after some algebraic effort as follows b 24 o c œâ œâ c Œ∑ Œ∑ c a b c d e f g h i j k l m l diff c l diff l eq c l eq where b 25 a …õ Œ∑ d œâ œâ d œâ Œ∑ …õ œâ d Œ∑ œâ d Œ∑ Œ∑ b 26 b l eq c …õ Œ∑ v œâ œâ v œâ Œ∑ u œâ …õ œâ v Œ∑ œâ v Œ∑ Œ∑ u Œ∑ b 27 c l eq c w œâ w Œ∑ b 28 d l eq c l eq œÇ œâ œÇ Œ∑ b 29 e l diff c l diff …õ œâ …õ Œ∑ t diff b 30 f l diff c …õ Œ∑ …õ Œ∑ u œâ …õ œâ …õ œâ u Œ∑ b 31 g …õ Œ∑ l diff c …õ Œ∑ v œâ œâ …õ œâ v Œ∑ œâ b 32 h …õ œâ l diff c …õ Œ∑ v œâ Œ∑ …õ œâ v Œ∑ Œ∑ b 33 i l diff c …õ œâ k l Œ∑ …õ Œ∑ k l œâ b 34 j l diff c …õ œâ w Œ∑ …õ Œ∑ w œâ b 35 k l diff c l diff …õ œâ œÇ Œ∑ …õ Œ∑ œÇ œâ b 36 l l diff c l diff a v k l b 37 m …õ œâ …õ Œ∑ d œâ Œ∑ …õ œâ d Œ∑ Œ∑ …õ Œ∑ …õ Œ∑ d œâ œâ …õ œâ d Œ∑ œâ in eq b 24 l diff l diff c l eq and l eq c are the characteristic length scales for the concentrations difference and its gradient as well as for the equilibrium concentration and its gradient respectively such length scales may be the whole size of the reservoir or even larger for the case of gradients of concentrations on the basis of eq b 24 the assumption of reservoir scale local mass equilibrium validity is subject to satisfy b 38 o c œâ œâ c Œ∑ Œ∑ c 1 one first reasoning about the ratio of length scales presented in the left hand side of eq b 24 is that b 39 l diff c l diff l eq c l eq 1 and furthermore the manner in that the local mass equilibrium be valid is that the numerator be smaller than the denominator such conditions are hard to identify as there may be various combinations of terms a b c and d yielding a sum close to zero nevertheless on the basis of numerical predictions of the effective coefficients summarized in the appendix a we can approximate that b 40 c d a b thus an additional inspection of terms a and b allows to conclude that the mass equilibrium validity is approximated when b 41 …õ Œ∑ d œâ œâ d œâ Œ∑ …õ œâ d Œ∑ œâ d Œ∑ Œ∑ b 42 …õ Œ∑ v œâ œâ v œâ Œ∑ u œâ …õ œâ v Œ∑ œâ v Œ∑ Œ∑ u Œ∑ i e as long as the intrinsic transport properties of facies be similar then the usage of the one equation model is sufficient to model the transport of solute in practice this condition of similitude of petrophysical properties may be very difficult to encounter for reservoirs with high geostatistical variations however some exceptions may be found for reservoirs where each one of the lithofacies identified lie within the same sedimentation environment we state that a deeper study involving the theoretical developments presented in this work along the spatial distributions of properties with geostatistics is beyond the original scopes but it deserves major theoretical efforts in future works one additional manner to satisfy the condition of local mass equilibrium is ensuring that the denominator of eq b 24 has a larger value than its numerator i e b 43 a b c d e f g h i j k l m 1 however once again this condition is hard to glimpse as the denominator is a sum of negative and positive quantities the term e l diff c l diff …õ œâ …õ Œ∑ t diff may perform a larger value for cases when the characteristic time for steady state conditions of concentrations difference presents a small value it would be achieved for relatively small reservoirs with good transport properties permeability mass dispersion and inter facies mass transfer coefficients however this statement deserves a deeper analysis where the characteristic time be compared against the properties of reservoir rocks finally we note that those reservoir rocks with high permeability would lead also to larger values of the term f eq b 30 or other reservoirs with high flow velocity for instance gas reservoirs and naturally artificially fractured reservoirs which would help to satisfy the local mass equilibrium condition 
5611,diffuse recharge is vital in determining the availability of renewable groundwater estimating diffuse recharge however is a great challenge plagued with uncertainty due to limitations in direct observation and process understanding hydrological model is functional for diffuse recharge estimation at catchment scale it can be used independently or in combination with flow recession analysis to estimate recharge but it is accompanied with uncertainties owing to model structures and parameterization schemes confronting the uncertainties in hydrological modelling in this paper we used three models gr4j simhyd and ihacres together with nine parameterization schemes to investigate the effectiveness and uncertainties in the estimates of diffuse recharge for unregulated headwater catchments the parameterization schemes were configured by three objective functions and three calibration periods conditioned on climate it was found that the capability of hydrological model in yielding more reasonable groundwater recharge estimates largely depended on the objective function used and the calibration period configured model calibrated using inverse nse nseinv was judged to be more likely to yield better recharge estimates the uncertainties due to the choice of parameterization scheme were found to be comparable with those from model structures the use of different models objective functions and calibration periods allowed reflection on the level of uncertainties one can minimally expect in estimating catchment scale recharge keywords groundwater recharge hydrological modelling rora approach murrumbidgee catchment uncertainty 1 introduction water stress is being intensified due to population and economic growth and exacerbated by global climate change groundwater plays an important role in buffering climate change impacts on water resources but has been over exploited in many regions around the world gleeson et al 2012 taylor et al 2013 russo and lall 2017 the renewable part of groundwater highly depends on diffuse recharge which represents a widespread movement of water from the land surface to the water table as a result of rainfall over large areas infiltrating and percolating through the unsaturated zone diffuse recharge is crucial for sustainable water resources management but also influenced by climate and land use change crosbie et al 2013 hartmann et al 2017 it has been reported cuthbert et al 2019 that globally nearly half of global groundwater fluxes could equilibrate with recharge variations due to climate change on human timescales 100 years diffuse groundwater recharge has been under considerable investigation in the literature of hydrology and hydrogeology with different methods developed to estimate the magnitude of the recharge scanlon et al 2005 asoka et al 2017 currently available methods for recharge estimation are either physical e g owor et al 2009 nimmo et al 2015 chemical e g scanlon et al 2012 mensah et al 2014 mathematical e g andermann et al 2012 crosbie et al 2013 hartmann et al 2017 or a combination of these e g guggenmos et al 2011 delottier et al 2018 nevertheless it is challenging to choose an appropriate estimation technique because of the limitations in the inherent assumptions of each method and the availability of the appropriate data the choice becomes more complicated when heterogeneity and scale issues need to be considered scanlon et al 2002 walker et al 2018 in general chemical and physical methods are relatively expensive and their feasibility is often limited to point scales owing to the spatial heterogeneity of hydrological hydrogeological properties barthel and banzhaf 2016 numerical modelling is widely considered as an effective alternative for recharge estimation especially because of its potential in predicting recharge rates for large spatial and temporal domains sanford 2002 the use of hydrological models is one of the numerical approaches having the potential to estimate the diffuse groundwater recharge at regional scale arnold et al 2000 healy 2010 such models which are purposely designed to predict streamflow can also provide a direct estimate of the diffuse recharge when the models explicitly include representation of the recharge process for hydrological models without direct recharge output the recharge can be estimated by combining the models with recession analysis methods like rora rorabaugh 1964 the combination approach has been found successful in extending the capability of the hydrological models in estimating water flux components like groundwater recharge and discharge for example by combining hydrological modelling with flow recession analysis millares et al 2009 have illustrated the evolution of baseflow in fractured mountain basin areas in the mediterranean region similarly andermann et al 2012 have assessed the contribution of transient groundwater storage to discharge of the himalayan river estimation of diffuse groundwater recharge directly or indirectly by using a hydrological model however inherits the uncertainties from the model structure model parameters and model inputs d√∂ll et al 2016 pianosi and wagener 2016 for hydrological models the parameters are calibrated to reproduce the observed streamflow with model performance measured by specific objective functions the calibrated parameters therefore vary considerably depending on the objective functions and subsequently may lead to substantial differences in the simulated hydrographs e g moussa and chahinian 2009 garcia et al 2017 fowler et al 2018 in addition calibrated parameter values can be affected by the selected calibration period because of hydrological non stationarity which implies that the behaviour of the hydrological system could be different due to climate variation or land cover change for instance coron et al 2012 found that the optimal parameter sets strongly relate to rainfall magnitude over the calibration period for 216 australian catchments similar results were found at catchments elsewhere such as in france brigode et al 2013 and germany wallner and haberlandt 2015 it has also been observed that uncertainty arising from the hydrological model structure could be considerably larger than that from the model parameter values e g bastola et al 2011 poulin et al 2011 for providing reliable recharge estimation therefore it is imperative to reflect and quantify the source effects of uncertainty and if possible to reduce it to a desirable level goderniaux et al 2011 moeck et al 2016 pianosi and wagener 2016 in this study we aim to investigate the effectiveness and uncertainties of diffuse recharge estimation by combining the existing conceptual hydrological models with the rora approach proposed by rorabaugh 1964 three hydrological models i e gr4j simhyd and ihacres together with nine parameterization schemes are used to illustrate the level of uncertainties in the recharge estimations where the parameterization schemes are configured by three objective functions and calibration periods conditioned on three different climate status 2 study area and data in this study 17 unregulated catchments in the upper and mid murrumbidgee river basin mrb in australia are used the mrb constitutes the second largest river in the murray darling system and has great environmental value for both local rivers floodplains and riparian areas downstream in the system fig 1 it has an area of 84000 km2 with the murrumbidgee river being approximately 1600 km long the climate is extremely diverse ranging from alpine conditions in the headwaters in the snowy mountains to the semi arid conditions of the riverina plains in the west average annual potential evaporation is about 1000 to 1900 mm while annual rainfall is between 300 and 1700 mm rainfall is fairly uniform throughout the year and runoff is highest in winter and early spring the area of the selected catchments ranges from 130 km2 to 2650 km2 see table 1 for the 17 selected catchments the time series 1976 2010 of daily rainfall and potential evapotranspiration at a 0 05 0 05 resolution were retrieved from the silo data drill jeffrey et al 2001 www longpaddock qld gov au silo gridded silo data is constructed from observational data obtained from australia bureau of meteorology and hosted by the queensland department of environment and science des the potential evapotranspiration available in the silo data drill product is calculated using the morton formulation for wet environments mcmahon et al 2013 the gridded climate data retrieved from silo data is further processed to provide area mean rainfall and potential evapotranspiration time series for all the studied catchments the daily streamflow data were collected from the new south wales department of primary industry australia the rainfall and streamflow time series of an example catchment 410026 are shown in fig s1 in the supplementary material 3 methodology 3 1 rora approach recharge can be estimated on the basis of observed daily streamflow by using flow recession analysis e g risser et al 2005 smith and schwartz 2016 recession analysis methods like rora are relatively simple and convenient for recharge estimation when streamflow data are available rutledge 2007a since its development the rora method has been shown by a number of studies to be capable of providing reasonable recharge estimates when compared against the other hydrogeological methods e g coes et al 2007 delin et al 2007 von freyberg et al 2015 for instance arnold and allen 1999 found the estimated annual recharge using the rora method was in good agreement the nash sutcliffe efficiency i e nse defined in eq 4 is 0 71 with the estimate based on field water balance measurements in the upper mississippi river basin at the catchment scale methods like rora could provide a reference estimate of groundwater recharge and even be used to estimate aquifer properties like transmissivity huang et al 2011 gan and luo 2013 the rora method is based on the derived analytical equations for instantaneous one dimensional groundwater discharge to a fully penetrating stream in an idealized homogenous aquifer rorabaugh 1964 glover 1964 these equations showed that the total potential groundwater discharge to the stream at a specific critical time t c after the peak streamflow is equal to about one half the volume of groundwater recharged during the peak as seen from fig 2 combined with the principle of superposition total recharge can then be calculated as glover 1964 rutledge 2007a 1 r c 2 q 2 q 1 l n k where r c is the total volume of recharge due to the event q 1 is the groundwater discharge at critical time t c extrapolated from the pre event recession curve q 2 is the groundwater discharge at critical time extrapolated from the post event recession curve t c is the critical time where the recession curve becomes nearly linear on a semi log hydrograph hydrograph falling time it is closely related to the recession constant k which can be expressed as 2 t c 0 4937 l n k the recession constant k can be manually graphical method or automatically derived by the master recession curve method e g rutledge 2007a zhu et al 2010 where the recession of streamflow after a recharge event is assumed to follow an exponential relationship 3 q t q 0 k t where q 0 is the initial discharge of the recession curve q t is the discharge at time t after q 0 the rora method is intended for analysis of flow systems that are characterized by diffuse recharge events which are assumed to be roughly concurrent with peaks in streamflow it also assumes that all or most groundwater in the basin will discharge to the stream with a single outlet at the downstream gauge aside from this recharge to the water table and the subsequent discharge to the stream there are no other gains or losses of water to or from the system the method is hence appropriate if all or nearly all the groundwater in the basin discharges into the stream except for that which is lost by evapotranspiration and if a stream flow gauging station at the downstream end of the basin measures the total outflow from both the groundwater and surface water system since the method is based on the daily streamflow it is important to note that it implies the contributing area for the groundwater system is identical to the surface drainage area more importantly river regulation or water diversion may alter the natural flow regime and violate the assumptions of the method therefore the groundwater recharge could be poorly estimated halford and mayer 2000 which means that there could be bias in the estimated recharge with magnitude depending on the strength of the river regulation and water extraction for such cases it is therefore important to reproduce the natural streamflow before the method can be used 3 2 hydrological models flow recession analysis methods such as rora are observation based approaches and are impractical for catchments with limited streamflow observations or for exploring the underlying drivers of recharge hydrological models instead have advantages in describing the dynamics of the hydrological cycle and have capabilities to explore hydrological responses to climatic forcing through model inputs or to land use and land cover change through model parameters however hydrological models can have substantially different structures and may or may not explicitly include the process of groundwater recharge nevertheless given the simulated streamflow and its combination with the rora approach hydrological models can be used to estimate diffuse groundwater recharge in this study three hydrological models are used to produce competing estimates of groundwater recharge including gr4j perrin et al 2003 ihacres jakeman and hornberger 1993 croke and jakeman 2004 and simhyd chiew et al 2002 the number of tunable parameters in the three models is 4 6 and 9 respectively see table 2 and appendix figs a1 a3 all these models require daily rainfall and potential evapotranspiration as inputs among the three models the gr4j and the ihacres models have no explicit expression of the recharge process in the model structures resulting in no direct recharge estimation as model output on the other hand the simhyd model computes interception loss soil moisture and recharge into the groundwater store whereby the water into the groundwater store is considered as groundwater recharge more details about the three models can be referred to the original publications by perrin et al 2003 jakeman and hornberger 1993 croke and jakeman 2004 and chiew et al 2002 3 3 hydrological model parameterization objective functions hydrological model parameters need to be calibrated to ensure that observed values of flux or state variable are adequately simulated molina navarro et al 2017 the calibrated parameters would not be the same when different objective functions are used for model calibration and this can in turn lead to discrepancy in the simulated streamflow and the estimated recharge wallner and haberlandt 2015 to investigate the impacts of model parameterization on diffuse groundwater recharge estimation three objective functions are selected for test in this study these are the nash sutcliffe efficiency nash and sutcliffe 1970 calculated on daily streamflow nse logarithmic transformed daily streamflow nselog and inverse daily streamflow nseinv these are defined as 4 nse 1 i 1 n qobs i qsim i 2 i 1 n qobs i qobs 2 5 nselog 1 i 1 n l n qobs i l n qsim i 2 i 1 n l n qobs i ln q o b s 2 6 nseinv 1 i 1 n 1 qobs i 1 1 qsim i 1 2 i 1 n 1 qobs i 1 1 q o b s 1 2 where qobs i and q s i m i are observed and simulated runoff at time i respectively q ln q o b s and 1 q o b s 1 are the mean of the observed runoff log transformed runoff and the inverse runoff for the entire evaluation period and i 1 2 n for the calculation of the nselog the zero flow records are discarded while for the calculation of nseinv 1 0 is added to all streamflow records to avoid extremely high values after transformation and significantly reduce the sensitivity of the criterion to flows much less than 1 the larger nse and nselog o r n s e i n v the better the model performance is comparatively the nse is known to be biased towards peak flows nselog and nseinv indicate model efficiency in reproducing transformed discharges giving more emphasis to low flows le moine 2008 pushpalatha et al 2012 split sample calibration conditioned on climate hydrological non stationarity implies that the calibrated hydrological model parameters could be different if the calibration period is configured differently coron et al 2012 brigode et al 2013 with this concern for model parameterization in this study in addition to the calibration using all available streamflow observations the models are also calibrated using observations from sub periods corresponding to three different climate conditions classified as wet dry and normal conditions the climate conditions are characterised according to the aridity index which is the ratio of annual potential evapotranspiration to annual rainfall the threshold values for the classification are the 33th aiw and 66th aid percentiles of the aridity index time series which means the years with aridity index smaller than aiw are defined as wet years while those years with aridity index higher than aid are dry years and the other years are classified as normal years for model calibration against the different climate conditions the model runs continuously for the entire period 1976 2010 but only those years for the specific climate conditions are used to calculate the objective functions the hydrological models are all calibrated using the sce ua algorithm duan et al 1994 for each selected catchment all of the three hydrological models are calibrated separately using the above three objective functions for the three split samples conditioned on climate meanwhile as a calibration benchmark the models are also calibrated over the entire period 1976 2010 again separately for all three objective functions for the studied catchments altogether there are 12 parameter sets calibrated for each hydrological model resulting in 12 simulations of streamflow for the entire period the individual simulated streamflows are then used to estimate diffuse groundwater recharge by using the rora method and the performances of the simulations are all evaluated for the entire period 3 4 uncertainty assessment two indicators are used to gain an empirical appreciation of the uncertainty in the estimated groundwater recharge due to model structure and parameterization scheme the measures include the uncertainty interval ui and the coverage probability cp as proposed by shrestha and solomatine 2006 the uncertainty interval ui and coverage probability cp are expressed as 7 ui 1 n t 1 n u t l t 8 cp 1 n t 1 n h t h t 1 l t r obs t u t 0 o t h e r w i s e where u t and l t are the upper and lower bounds of spread in recharge predictions respectively r obs t is the estimated recharge based on observed streamflow using rora as can be seen from eq 7 and eq 8 the uncertainty interval computes the average width of the uncertainty band which is the difference between the upper and lower bounds the uncertainty interval is a simple indicator showing the distribution sharpness of the recharge estimation the larger the ui the higher the uncertainty is while smaller values of ui mean recharge predictions are more consistent the coverage probability cp is the percentage of observations in this study it means estimated recharge based on observed streamflow with rora contained in the ui spread ideally the cp value should be close to 100 indicating that all observations lie in the spread determined by the uncertainty interval conversely a significant departure from 100 would indicate that the uncertainty interval is underestimated and the ensemble predictions could all or mostly have positive or negative bias 4 results and discussion 4 1 benchmark estimates of recharge based on observed streamflow fig 3 shows the estimated mean annual groundwater recharge and the recharge coefficient i e ratio of recharge to rainfall using the rora method on the basis of observed streamflow only for the 17 catchments it is worth noting that the estimated recharge herein represents the net recharge which is diffuse recharge to the water table minus losses e g ground water evapotranspiration leakage to a deeper aquifer rutledge 2007b as shown in fig 3b the estimated mean annual recharge of the studied catchments ranges from 6 4 to 321 mm the recharge coefficients vary substantially in space ranging from 0 01 to 0 26 across the 17 catchments a strong non linear relationship nse 0 79 is found between annual rainfall and annual recharge implying that rainfall plays a dominant role in the diffuse recharge process in the region the nonlinear relationship between recharge and rainfall can be expressed by a power function as illustrated at fig 3d according to the nonlinear relationship it is easy to calculate the elasticity r c r c p p of annual recharge to annual rainfall as around 2 25 for the study area which suggests that a 10 change in annual rainfall could cause a 22 5 change in annual diffuse groundwater recharge the estimated values of recharge within the murrumbidgee river basin obtained using the rora method are comparable with that estimated using the waves model csiro and skm 2010 barron et al 2011 based on the simulated diffuse groundwater recharge from the waves model a power relationship between recharge and rainfall has also been reported by crosbie et al 2010 and the elasticity of annual recharge to annual rainfall in the region was around 2 0 4 0 barron et al 2012 it therefore suggests that when daily streamflow records are available and of good quality the rora approach can be used independently to provide reasonable estimates of groundwater recharge albeit with its associated limitation due to the underlying empirical assumptions arnold et al 2000 rutledge 2007a smith and schwartz 2016 the rora approach shows advantage in terms of the data required and is good for diffuse groundwater recharge estimation at the catchment scale the estimated diffuse recharge on the basis of the observed streamflow by using rora is therefore considered as the benchmark estimate in the following sections to assess the performance of the hydrological modelling and the associated uncertainties 4 2 recharge estimation using different models hydrological models may or may not include explicitly the recharge process in their representation for hydrological models without representation of the recharge process e g gr4j and ihacres there is no simulated recharge output however if the model can provide satisfactory simulation of daily streamflow the groundwater recharge can be estimated by using the rora approach on the basis of the simulated daily streamflow in such a way it is important to ensure that the calibrated model can reproduce the daily streamflow satisfactorily fig 4 shows the performance of the gr4j ihacres and simhyd in simulating daily streamflow for the 17 catchments when they are calibrated over the period 1976 2010 using nse as the objective function when calibrated against nse the three models in general can reproduce the daily streamflow quite well in most of the 17 studied catchments where the median nse for gr4j simhyd and ihacres is 0 74 0 65 and 0 56 respectively also the gr4j ihacres and simhyd models tend to overestimate streamflow with mean bias the relative difference between streamflow observations and simulations of 3 5 15 2 and 11 8 respectively as can be seen in fig 5 lower triangle the simulated annual runoff from all three hydrological models are highly consistent with the observations where the coefficients of determination between observed and simulated annual runoff across all catchments are 0 92 0 93 and 0 90 for gr4j ihacres and simhyd respectively with particularly higher agreement between the gr4j and ihacres models further slope of the linear regression relationship between observations and simulations are 0 97 0 94 and 1 07 for gr4j ihacres and simhyd respectively given the simulated streamflow from the three hydrological models calibrated against nse over the period of 1976 2010 annual diffuse groundwater recharge is estimated with the assistance of the rora approach and compared to the benchmark estimation based on observed streamflow as summarized at upper triangle of fig 5 it is found that the estimated recharge from all three hydrological models whose simulated flows feed rora are highly correlated with the estimation based on the observed streamflow where the coefficients of determination r2 between the benchmark and the simulations are 0 90 0 88 and 0 87 for gr4j ihacres and simhyd respectively these values are lower than the coefficients of determination for annual runoff reflecting the larger scatter seen in the annual recharge plots in fig 5 further the slope of the relationship between benchmark and simulations gives the scale error for each model these are 0 94 1 06 and 0 84 for gr4j ihacres and simhyd respectively note that in the calculation of these slopes the observations are dependent variables as seen in the top row of fig 5 the results suggest that although the hydrological models have vastly different model assumptions when used together with the rora method they can produce quite consistent recharge estimates when the models are well calibrated to reproduce the daily streamflow hydrograph however bias exists in the model based recharge estimation as summarized in fig 5 the gr4j and simhyd models tend to overestimate the recharge rate with a relative bias of 20 6 and 2 6 respectively while ihacres underestimates the recharge rate with a relative bias of 13 4 recharge estimated by gr4j and simhyd agree strongly with each other r2 0 87 slope 0 84 but gr4j tends to overestimate the lower recharge reflected in the high relative bias which is the opposite of what is observed in simhyd it is interesting to notice that the direct recharge output from simhyd matches pretty well with the rora estimate based on simulated streamflow generated using simhyd r2 0 94 slope is 1 though with higher scatter than that seen with gr4j and ihacres for years with higher annual benchmark recharge the results are quite similar to the findings of arnold et al 2000 which demonstrated that rora estimated recharge and recharge estimated using the swat model arnold et al 2011 are in general agreement average absolute difference is 28 for 4 basins in the upper mississippi river basin with a relative bias of 13 4 3 recharge estimation using different parameterization schemes as demonstrated in fig 6 the hydrological models perform differently when their parameterization schemes are configured by different objective functions or calibration periods and hence lead to discrepancy in recharge estimation it can be found that for all three models in general the estimation on the basis of the hydrological model calibrated using either nseinv or nselog outperforms that using nse in most cases except for the schemes using information from the dry periods only this is because the parameter schemes using nseinv and nselog tend to better capture the characteristics of the low flow parts of the hydrograph le moine 2008 pushpalatha et al 2012 which is highly related to the recharge process and the underlying information for recharge estimation using rora in other words the parameterization schemes with better prediction of the low flows could generally lead to better diffuse recharge estimation as shown in fig 6 however there is no conclusive evidence illustrating a consistent effect of climate sequence on model calibration in terms of bias across the 17 catchments considered here the best sub period for model calibration varies among the models and the selection of the objective functions for gr4j for the dry years it is slightly better to calibrate the model using nse as the objective function while it is better to calibrate the model against wet or normal years using nselog or nseinv as the objective function meanwhile for ihacres calibration on the normal years performs better when nse or nseinv is the objective function but the wet year sub period is more suitable for calibration based on nseinv for simhyd the best parameterization scheme is that using nseinv as the objective function and calibrating the model for the sub period with relatively wet climate conditions for all three climate sets if the simhyd model is calibrated using nse it tends to underestimate the recharge overall the results suggest that nselog and nseinv are in general better objective function options than nse for all three different climate conditions in most catchments except for the case when simhyd is calibrated against the dry period a better defined objective function has the potential to improve the model performance significantly however it is more challenging to define the calibration period because the effects of the calibration period configuration are heavily model dependent and subject to the objective functions the results also suggest that for better recharge estimation improvements in parameterization scheme could be as important as a better model structure yet there is currently no specific parameterization scheme outperforming all the others across all the studied catchments it is therefore important that future studies further explore the impact of parameterization schemes e g additional objective functions and different climate conditions meanwhile it is also critical to assess the uncertainty caused by the different parameterization schemes 4 4 uncertainties in recharge estimation on the basis of the estimations of recharge from the 12 parameterization schemes 3 objective functions by 4 calibration periods for each model the uncertainty interval ui and the coverage probability cp are calculated for the studied catchments as shown in table 3 the uncertainty intervals ui s of mean annual recharge for 17 catchments are 54 4 mm 72 7 mm and 108 6 mm respectively for gr4j ihacres and simhyd with coverage probability cp of 100 94 1 and 88 2 for the models with high cp the parameterization schemes used in this study are shown to be sufficient to describe the uncertainties of recharge estimates while the models with low cp would need other parameterization schemes fig 7 further illustrates that the uncertainties of the estimated recharge in term of spread are found to be wider for the catchments with relative higher annual recharge rate it implicates that for catchments with smaller annual recharge the uncertainty of the recharge estimation tends to be lower smaller ui but higher cp as seen from fig 7 three models produce different uncertainties in the recharge estimation comparatively in terms of median estimates gr4j outperforms the other two models with relatively lower bias and higher r2 it is clear that there is no best model that outperforms the others in all performance metrics shown in table 3 generally table 3 among the three models the model showing lower ui tends to have higher cp and vice versa as also shown in fig 7 the spread of recharge estimates is found to be asymmetrical for all three models where the distribution of the estimates is skewed either towards the lower or upper bound of the spreads as indicated by the median estimate the results imply that the parameterization schemes for a specific model could collectively underestimate or overestimate the diffuse recharge the underlying reason of which could be the systematic bias inherited from the model structures or the limited parameterization schemes explored in this study to better address the uncertainties by narrowing down the spread intervals and increasing coverage probability concurrently it would be therefore worthwhile to further improve the parameterization schemes and conduct multi model ensemble simulation to produce more credible recharge estimation and the associated uncertainties fig 7 and table 3 5 conclusions groundwater recharge estimation is a great challenge plagued with uncertainties from limitations in observation and process understanding hydrological model in combination with the rora approach is found having the potentials to estimate the diffuse groundwater recharge even though the model itself has no direct recharge output the approach can therefore be used to predict the diffuse groundwater recharge at catchment scale and to assess the climatic impacts on recharge when the hydrological model is well calibrated the estimates of recharge inherit uncertainties from hydrological model structure and model parameterization schemes to confront the uncertainties it is essential to explore the range of hydrological simulations confined jointly by different models objective functions and calibration datasets conditioned on climate our findings suggest objective functions focusing more on low flows e g selog nseinv can constitute better choices for more credible recharge estimation the improvements of model performance resulted from a well defined objective function can be strengthened by deliberate selection of the calibration period conditioned on climate yet there is no specific parameterization scheme configured jointly by objective function and calibration period found generally outperforming all the other options the uncertainties of recharge estimation arising from parameterization are comparable with that from model structure but the parameterization scheme alone cannot compensate for structural uncertainties it is worthwhile to use multi model ensemble simulation from different model structures and parameterization schemes to produce more credible diffuse recharge prediction the use of different models objective functions and calibration periods allows reflection on the level of uncertainties one can minimally expect in estimating catchment scale recharge credit authorship contribution statement ruirui zhu conceptualization methodology writing original draft barry f w croke investigation writing review editing anthony j jakeman writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research of the first author is supported by the australian government research training program agrtp appendix a the structure of hydrological models used gr4j model the gr4j model proposed by perrin et al 2003 is a catchment water balance model a schematic of the model is shown in fig a1 the inputs of the model are rainfall and potential evapotranspiration and the four free parameters to be calibrated are x1 x2 x3 and x4 the production store x1 represents storage in soil surface and is dependent on catchment soil type it is assumed that the lower the soil porosity the larger the production store groundwater exchange coefficient x2 is a function of groundwater storage a negative value of x2 indicates water seepage into the depth aquifer while a positive value indicates water flow from aquifer to routing storage the routing storage x3 is the maximum amount of water that can be stored in soil porous depending on soil type and soil water content the time base of the unit hydrograph x4 represents the time from rainfall to peak flow ihacres model ihacres model is a continuous rainfall runoff model which is used to generate estimates of runoff from rainfall and potential evapotranspiration data jakeman and hornberger 1993 croke and jakeman 2004 the conceptual layout of the model is shown in fig a2 the box on the left represents a non linear loss module that converts rainfall into effective rainfall and evapotranspiration and changes in catchment moisture effective rainfall is the portion of rainfall that will eventually leave the catchments as runoff effective rainfall is routed through two parallel linear stores to produce streamflow in the linear routing module instantaneous unit hydrograph theory is used to describe both quick flow and slow flow the sum of quick flow and slow flow hydrographs gives total streamflow simhyd model the simhyd model is a lumped conceptual daily rainfall runoff model chiew et al 2002 fig a3 shows the structure of the simhyd model and the algorithms governing water moving from rainfall to streamflow through several stores it requires daily rainfall and potential evapotranspiration as input data and 9 tunable parameters as described in the fig a3 as shown in fig a3 daily rainfall in the simhyd model first fills the interception store which is drained by evaporation every day excess rainfall occurs if rainfall exceeds the maximum daily interception then excess rainfall is subjected to an infiltration function which determines the infiltration capacity the excess rainfall that exceeds the infiltration capacity becomes infiltration excess runoff infiltration water is subjected to a soil moisture function which diverts water into the river as saturation excess runoff interflow groundwater store as recharge and soil moisture store the saturation excess runoff interflow is first estimated as a linear function of the soil wetness soil moisture level divided by soil moisture capacity the equation used to simulate interflow therefore attempts to mimic both the interflow and saturation excess runoff processes with soil wetness used to reflect those parts of the catchment that are saturated and from which saturation excess runoff can occur groundwater recharge is then estimated also as a linear function of the soil wetness the remaining moisture flows into the soil moisture store evapotranspiration from the soil moisture store is estimated as a linear function of the soil wetness but cannot exceed the potential rate pet minus intercepted water the soil moisture store has a finite capacity and overflows into the groundwater store baseflow from which is simulated as a linear recession from the groundwater store runoff from three source infiltration excess runoff interflow and baseflow are altogether routed by using muskingum routing method to give total streamflow appendix b supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2020 124642 appendix b supplementary data the following are the supplementary data to this article supplementary data 1 supplementary data 2 
5611,diffuse recharge is vital in determining the availability of renewable groundwater estimating diffuse recharge however is a great challenge plagued with uncertainty due to limitations in direct observation and process understanding hydrological model is functional for diffuse recharge estimation at catchment scale it can be used independently or in combination with flow recession analysis to estimate recharge but it is accompanied with uncertainties owing to model structures and parameterization schemes confronting the uncertainties in hydrological modelling in this paper we used three models gr4j simhyd and ihacres together with nine parameterization schemes to investigate the effectiveness and uncertainties in the estimates of diffuse recharge for unregulated headwater catchments the parameterization schemes were configured by three objective functions and three calibration periods conditioned on climate it was found that the capability of hydrological model in yielding more reasonable groundwater recharge estimates largely depended on the objective function used and the calibration period configured model calibrated using inverse nse nseinv was judged to be more likely to yield better recharge estimates the uncertainties due to the choice of parameterization scheme were found to be comparable with those from model structures the use of different models objective functions and calibration periods allowed reflection on the level of uncertainties one can minimally expect in estimating catchment scale recharge keywords groundwater recharge hydrological modelling rora approach murrumbidgee catchment uncertainty 1 introduction water stress is being intensified due to population and economic growth and exacerbated by global climate change groundwater plays an important role in buffering climate change impacts on water resources but has been over exploited in many regions around the world gleeson et al 2012 taylor et al 2013 russo and lall 2017 the renewable part of groundwater highly depends on diffuse recharge which represents a widespread movement of water from the land surface to the water table as a result of rainfall over large areas infiltrating and percolating through the unsaturated zone diffuse recharge is crucial for sustainable water resources management but also influenced by climate and land use change crosbie et al 2013 hartmann et al 2017 it has been reported cuthbert et al 2019 that globally nearly half of global groundwater fluxes could equilibrate with recharge variations due to climate change on human timescales 100 years diffuse groundwater recharge has been under considerable investigation in the literature of hydrology and hydrogeology with different methods developed to estimate the magnitude of the recharge scanlon et al 2005 asoka et al 2017 currently available methods for recharge estimation are either physical e g owor et al 2009 nimmo et al 2015 chemical e g scanlon et al 2012 mensah et al 2014 mathematical e g andermann et al 2012 crosbie et al 2013 hartmann et al 2017 or a combination of these e g guggenmos et al 2011 delottier et al 2018 nevertheless it is challenging to choose an appropriate estimation technique because of the limitations in the inherent assumptions of each method and the availability of the appropriate data the choice becomes more complicated when heterogeneity and scale issues need to be considered scanlon et al 2002 walker et al 2018 in general chemical and physical methods are relatively expensive and their feasibility is often limited to point scales owing to the spatial heterogeneity of hydrological hydrogeological properties barthel and banzhaf 2016 numerical modelling is widely considered as an effective alternative for recharge estimation especially because of its potential in predicting recharge rates for large spatial and temporal domains sanford 2002 the use of hydrological models is one of the numerical approaches having the potential to estimate the diffuse groundwater recharge at regional scale arnold et al 2000 healy 2010 such models which are purposely designed to predict streamflow can also provide a direct estimate of the diffuse recharge when the models explicitly include representation of the recharge process for hydrological models without direct recharge output the recharge can be estimated by combining the models with recession analysis methods like rora rorabaugh 1964 the combination approach has been found successful in extending the capability of the hydrological models in estimating water flux components like groundwater recharge and discharge for example by combining hydrological modelling with flow recession analysis millares et al 2009 have illustrated the evolution of baseflow in fractured mountain basin areas in the mediterranean region similarly andermann et al 2012 have assessed the contribution of transient groundwater storage to discharge of the himalayan river estimation of diffuse groundwater recharge directly or indirectly by using a hydrological model however inherits the uncertainties from the model structure model parameters and model inputs d√∂ll et al 2016 pianosi and wagener 2016 for hydrological models the parameters are calibrated to reproduce the observed streamflow with model performance measured by specific objective functions the calibrated parameters therefore vary considerably depending on the objective functions and subsequently may lead to substantial differences in the simulated hydrographs e g moussa and chahinian 2009 garcia et al 2017 fowler et al 2018 in addition calibrated parameter values can be affected by the selected calibration period because of hydrological non stationarity which implies that the behaviour of the hydrological system could be different due to climate variation or land cover change for instance coron et al 2012 found that the optimal parameter sets strongly relate to rainfall magnitude over the calibration period for 216 australian catchments similar results were found at catchments elsewhere such as in france brigode et al 2013 and germany wallner and haberlandt 2015 it has also been observed that uncertainty arising from the hydrological model structure could be considerably larger than that from the model parameter values e g bastola et al 2011 poulin et al 2011 for providing reliable recharge estimation therefore it is imperative to reflect and quantify the source effects of uncertainty and if possible to reduce it to a desirable level goderniaux et al 2011 moeck et al 2016 pianosi and wagener 2016 in this study we aim to investigate the effectiveness and uncertainties of diffuse recharge estimation by combining the existing conceptual hydrological models with the rora approach proposed by rorabaugh 1964 three hydrological models i e gr4j simhyd and ihacres together with nine parameterization schemes are used to illustrate the level of uncertainties in the recharge estimations where the parameterization schemes are configured by three objective functions and calibration periods conditioned on three different climate status 2 study area and data in this study 17 unregulated catchments in the upper and mid murrumbidgee river basin mrb in australia are used the mrb constitutes the second largest river in the murray darling system and has great environmental value for both local rivers floodplains and riparian areas downstream in the system fig 1 it has an area of 84000 km2 with the murrumbidgee river being approximately 1600 km long the climate is extremely diverse ranging from alpine conditions in the headwaters in the snowy mountains to the semi arid conditions of the riverina plains in the west average annual potential evaporation is about 1000 to 1900 mm while annual rainfall is between 300 and 1700 mm rainfall is fairly uniform throughout the year and runoff is highest in winter and early spring the area of the selected catchments ranges from 130 km2 to 2650 km2 see table 1 for the 17 selected catchments the time series 1976 2010 of daily rainfall and potential evapotranspiration at a 0 05 0 05 resolution were retrieved from the silo data drill jeffrey et al 2001 www longpaddock qld gov au silo gridded silo data is constructed from observational data obtained from australia bureau of meteorology and hosted by the queensland department of environment and science des the potential evapotranspiration available in the silo data drill product is calculated using the morton formulation for wet environments mcmahon et al 2013 the gridded climate data retrieved from silo data is further processed to provide area mean rainfall and potential evapotranspiration time series for all the studied catchments the daily streamflow data were collected from the new south wales department of primary industry australia the rainfall and streamflow time series of an example catchment 410026 are shown in fig s1 in the supplementary material 3 methodology 3 1 rora approach recharge can be estimated on the basis of observed daily streamflow by using flow recession analysis e g risser et al 2005 smith and schwartz 2016 recession analysis methods like rora are relatively simple and convenient for recharge estimation when streamflow data are available rutledge 2007a since its development the rora method has been shown by a number of studies to be capable of providing reasonable recharge estimates when compared against the other hydrogeological methods e g coes et al 2007 delin et al 2007 von freyberg et al 2015 for instance arnold and allen 1999 found the estimated annual recharge using the rora method was in good agreement the nash sutcliffe efficiency i e nse defined in eq 4 is 0 71 with the estimate based on field water balance measurements in the upper mississippi river basin at the catchment scale methods like rora could provide a reference estimate of groundwater recharge and even be used to estimate aquifer properties like transmissivity huang et al 2011 gan and luo 2013 the rora method is based on the derived analytical equations for instantaneous one dimensional groundwater discharge to a fully penetrating stream in an idealized homogenous aquifer rorabaugh 1964 glover 1964 these equations showed that the total potential groundwater discharge to the stream at a specific critical time t c after the peak streamflow is equal to about one half the volume of groundwater recharged during the peak as seen from fig 2 combined with the principle of superposition total recharge can then be calculated as glover 1964 rutledge 2007a 1 r c 2 q 2 q 1 l n k where r c is the total volume of recharge due to the event q 1 is the groundwater discharge at critical time t c extrapolated from the pre event recession curve q 2 is the groundwater discharge at critical time extrapolated from the post event recession curve t c is the critical time where the recession curve becomes nearly linear on a semi log hydrograph hydrograph falling time it is closely related to the recession constant k which can be expressed as 2 t c 0 4937 l n k the recession constant k can be manually graphical method or automatically derived by the master recession curve method e g rutledge 2007a zhu et al 2010 where the recession of streamflow after a recharge event is assumed to follow an exponential relationship 3 q t q 0 k t where q 0 is the initial discharge of the recession curve q t is the discharge at time t after q 0 the rora method is intended for analysis of flow systems that are characterized by diffuse recharge events which are assumed to be roughly concurrent with peaks in streamflow it also assumes that all or most groundwater in the basin will discharge to the stream with a single outlet at the downstream gauge aside from this recharge to the water table and the subsequent discharge to the stream there are no other gains or losses of water to or from the system the method is hence appropriate if all or nearly all the groundwater in the basin discharges into the stream except for that which is lost by evapotranspiration and if a stream flow gauging station at the downstream end of the basin measures the total outflow from both the groundwater and surface water system since the method is based on the daily streamflow it is important to note that it implies the contributing area for the groundwater system is identical to the surface drainage area more importantly river regulation or water diversion may alter the natural flow regime and violate the assumptions of the method therefore the groundwater recharge could be poorly estimated halford and mayer 2000 which means that there could be bias in the estimated recharge with magnitude depending on the strength of the river regulation and water extraction for such cases it is therefore important to reproduce the natural streamflow before the method can be used 3 2 hydrological models flow recession analysis methods such as rora are observation based approaches and are impractical for catchments with limited streamflow observations or for exploring the underlying drivers of recharge hydrological models instead have advantages in describing the dynamics of the hydrological cycle and have capabilities to explore hydrological responses to climatic forcing through model inputs or to land use and land cover change through model parameters however hydrological models can have substantially different structures and may or may not explicitly include the process of groundwater recharge nevertheless given the simulated streamflow and its combination with the rora approach hydrological models can be used to estimate diffuse groundwater recharge in this study three hydrological models are used to produce competing estimates of groundwater recharge including gr4j perrin et al 2003 ihacres jakeman and hornberger 1993 croke and jakeman 2004 and simhyd chiew et al 2002 the number of tunable parameters in the three models is 4 6 and 9 respectively see table 2 and appendix figs a1 a3 all these models require daily rainfall and potential evapotranspiration as inputs among the three models the gr4j and the ihacres models have no explicit expression of the recharge process in the model structures resulting in no direct recharge estimation as model output on the other hand the simhyd model computes interception loss soil moisture and recharge into the groundwater store whereby the water into the groundwater store is considered as groundwater recharge more details about the three models can be referred to the original publications by perrin et al 2003 jakeman and hornberger 1993 croke and jakeman 2004 and chiew et al 2002 3 3 hydrological model parameterization objective functions hydrological model parameters need to be calibrated to ensure that observed values of flux or state variable are adequately simulated molina navarro et al 2017 the calibrated parameters would not be the same when different objective functions are used for model calibration and this can in turn lead to discrepancy in the simulated streamflow and the estimated recharge wallner and haberlandt 2015 to investigate the impacts of model parameterization on diffuse groundwater recharge estimation three objective functions are selected for test in this study these are the nash sutcliffe efficiency nash and sutcliffe 1970 calculated on daily streamflow nse logarithmic transformed daily streamflow nselog and inverse daily streamflow nseinv these are defined as 4 nse 1 i 1 n qobs i qsim i 2 i 1 n qobs i qobs 2 5 nselog 1 i 1 n l n qobs i l n qsim i 2 i 1 n l n qobs i ln q o b s 2 6 nseinv 1 i 1 n 1 qobs i 1 1 qsim i 1 2 i 1 n 1 qobs i 1 1 q o b s 1 2 where qobs i and q s i m i are observed and simulated runoff at time i respectively q ln q o b s and 1 q o b s 1 are the mean of the observed runoff log transformed runoff and the inverse runoff for the entire evaluation period and i 1 2 n for the calculation of the nselog the zero flow records are discarded while for the calculation of nseinv 1 0 is added to all streamflow records to avoid extremely high values after transformation and significantly reduce the sensitivity of the criterion to flows much less than 1 the larger nse and nselog o r n s e i n v the better the model performance is comparatively the nse is known to be biased towards peak flows nselog and nseinv indicate model efficiency in reproducing transformed discharges giving more emphasis to low flows le moine 2008 pushpalatha et al 2012 split sample calibration conditioned on climate hydrological non stationarity implies that the calibrated hydrological model parameters could be different if the calibration period is configured differently coron et al 2012 brigode et al 2013 with this concern for model parameterization in this study in addition to the calibration using all available streamflow observations the models are also calibrated using observations from sub periods corresponding to three different climate conditions classified as wet dry and normal conditions the climate conditions are characterised according to the aridity index which is the ratio of annual potential evapotranspiration to annual rainfall the threshold values for the classification are the 33th aiw and 66th aid percentiles of the aridity index time series which means the years with aridity index smaller than aiw are defined as wet years while those years with aridity index higher than aid are dry years and the other years are classified as normal years for model calibration against the different climate conditions the model runs continuously for the entire period 1976 2010 but only those years for the specific climate conditions are used to calculate the objective functions the hydrological models are all calibrated using the sce ua algorithm duan et al 1994 for each selected catchment all of the three hydrological models are calibrated separately using the above three objective functions for the three split samples conditioned on climate meanwhile as a calibration benchmark the models are also calibrated over the entire period 1976 2010 again separately for all three objective functions for the studied catchments altogether there are 12 parameter sets calibrated for each hydrological model resulting in 12 simulations of streamflow for the entire period the individual simulated streamflows are then used to estimate diffuse groundwater recharge by using the rora method and the performances of the simulations are all evaluated for the entire period 3 4 uncertainty assessment two indicators are used to gain an empirical appreciation of the uncertainty in the estimated groundwater recharge due to model structure and parameterization scheme the measures include the uncertainty interval ui and the coverage probability cp as proposed by shrestha and solomatine 2006 the uncertainty interval ui and coverage probability cp are expressed as 7 ui 1 n t 1 n u t l t 8 cp 1 n t 1 n h t h t 1 l t r obs t u t 0 o t h e r w i s e where u t and l t are the upper and lower bounds of spread in recharge predictions respectively r obs t is the estimated recharge based on observed streamflow using rora as can be seen from eq 7 and eq 8 the uncertainty interval computes the average width of the uncertainty band which is the difference between the upper and lower bounds the uncertainty interval is a simple indicator showing the distribution sharpness of the recharge estimation the larger the ui the higher the uncertainty is while smaller values of ui mean recharge predictions are more consistent the coverage probability cp is the percentage of observations in this study it means estimated recharge based on observed streamflow with rora contained in the ui spread ideally the cp value should be close to 100 indicating that all observations lie in the spread determined by the uncertainty interval conversely a significant departure from 100 would indicate that the uncertainty interval is underestimated and the ensemble predictions could all or mostly have positive or negative bias 4 results and discussion 4 1 benchmark estimates of recharge based on observed streamflow fig 3 shows the estimated mean annual groundwater recharge and the recharge coefficient i e ratio of recharge to rainfall using the rora method on the basis of observed streamflow only for the 17 catchments it is worth noting that the estimated recharge herein represents the net recharge which is diffuse recharge to the water table minus losses e g ground water evapotranspiration leakage to a deeper aquifer rutledge 2007b as shown in fig 3b the estimated mean annual recharge of the studied catchments ranges from 6 4 to 321 mm the recharge coefficients vary substantially in space ranging from 0 01 to 0 26 across the 17 catchments a strong non linear relationship nse 0 79 is found between annual rainfall and annual recharge implying that rainfall plays a dominant role in the diffuse recharge process in the region the nonlinear relationship between recharge and rainfall can be expressed by a power function as illustrated at fig 3d according to the nonlinear relationship it is easy to calculate the elasticity r c r c p p of annual recharge to annual rainfall as around 2 25 for the study area which suggests that a 10 change in annual rainfall could cause a 22 5 change in annual diffuse groundwater recharge the estimated values of recharge within the murrumbidgee river basin obtained using the rora method are comparable with that estimated using the waves model csiro and skm 2010 barron et al 2011 based on the simulated diffuse groundwater recharge from the waves model a power relationship between recharge and rainfall has also been reported by crosbie et al 2010 and the elasticity of annual recharge to annual rainfall in the region was around 2 0 4 0 barron et al 2012 it therefore suggests that when daily streamflow records are available and of good quality the rora approach can be used independently to provide reasonable estimates of groundwater recharge albeit with its associated limitation due to the underlying empirical assumptions arnold et al 2000 rutledge 2007a smith and schwartz 2016 the rora approach shows advantage in terms of the data required and is good for diffuse groundwater recharge estimation at the catchment scale the estimated diffuse recharge on the basis of the observed streamflow by using rora is therefore considered as the benchmark estimate in the following sections to assess the performance of the hydrological modelling and the associated uncertainties 4 2 recharge estimation using different models hydrological models may or may not include explicitly the recharge process in their representation for hydrological models without representation of the recharge process e g gr4j and ihacres there is no simulated recharge output however if the model can provide satisfactory simulation of daily streamflow the groundwater recharge can be estimated by using the rora approach on the basis of the simulated daily streamflow in such a way it is important to ensure that the calibrated model can reproduce the daily streamflow satisfactorily fig 4 shows the performance of the gr4j ihacres and simhyd in simulating daily streamflow for the 17 catchments when they are calibrated over the period 1976 2010 using nse as the objective function when calibrated against nse the three models in general can reproduce the daily streamflow quite well in most of the 17 studied catchments where the median nse for gr4j simhyd and ihacres is 0 74 0 65 and 0 56 respectively also the gr4j ihacres and simhyd models tend to overestimate streamflow with mean bias the relative difference between streamflow observations and simulations of 3 5 15 2 and 11 8 respectively as can be seen in fig 5 lower triangle the simulated annual runoff from all three hydrological models are highly consistent with the observations where the coefficients of determination between observed and simulated annual runoff across all catchments are 0 92 0 93 and 0 90 for gr4j ihacres and simhyd respectively with particularly higher agreement between the gr4j and ihacres models further slope of the linear regression relationship between observations and simulations are 0 97 0 94 and 1 07 for gr4j ihacres and simhyd respectively given the simulated streamflow from the three hydrological models calibrated against nse over the period of 1976 2010 annual diffuse groundwater recharge is estimated with the assistance of the rora approach and compared to the benchmark estimation based on observed streamflow as summarized at upper triangle of fig 5 it is found that the estimated recharge from all three hydrological models whose simulated flows feed rora are highly correlated with the estimation based on the observed streamflow where the coefficients of determination r2 between the benchmark and the simulations are 0 90 0 88 and 0 87 for gr4j ihacres and simhyd respectively these values are lower than the coefficients of determination for annual runoff reflecting the larger scatter seen in the annual recharge plots in fig 5 further the slope of the relationship between benchmark and simulations gives the scale error for each model these are 0 94 1 06 and 0 84 for gr4j ihacres and simhyd respectively note that in the calculation of these slopes the observations are dependent variables as seen in the top row of fig 5 the results suggest that although the hydrological models have vastly different model assumptions when used together with the rora method they can produce quite consistent recharge estimates when the models are well calibrated to reproduce the daily streamflow hydrograph however bias exists in the model based recharge estimation as summarized in fig 5 the gr4j and simhyd models tend to overestimate the recharge rate with a relative bias of 20 6 and 2 6 respectively while ihacres underestimates the recharge rate with a relative bias of 13 4 recharge estimated by gr4j and simhyd agree strongly with each other r2 0 87 slope 0 84 but gr4j tends to overestimate the lower recharge reflected in the high relative bias which is the opposite of what is observed in simhyd it is interesting to notice that the direct recharge output from simhyd matches pretty well with the rora estimate based on simulated streamflow generated using simhyd r2 0 94 slope is 1 though with higher scatter than that seen with gr4j and ihacres for years with higher annual benchmark recharge the results are quite similar to the findings of arnold et al 2000 which demonstrated that rora estimated recharge and recharge estimated using the swat model arnold et al 2011 are in general agreement average absolute difference is 28 for 4 basins in the upper mississippi river basin with a relative bias of 13 4 3 recharge estimation using different parameterization schemes as demonstrated in fig 6 the hydrological models perform differently when their parameterization schemes are configured by different objective functions or calibration periods and hence lead to discrepancy in recharge estimation it can be found that for all three models in general the estimation on the basis of the hydrological model calibrated using either nseinv or nselog outperforms that using nse in most cases except for the schemes using information from the dry periods only this is because the parameter schemes using nseinv and nselog tend to better capture the characteristics of the low flow parts of the hydrograph le moine 2008 pushpalatha et al 2012 which is highly related to the recharge process and the underlying information for recharge estimation using rora in other words the parameterization schemes with better prediction of the low flows could generally lead to better diffuse recharge estimation as shown in fig 6 however there is no conclusive evidence illustrating a consistent effect of climate sequence on model calibration in terms of bias across the 17 catchments considered here the best sub period for model calibration varies among the models and the selection of the objective functions for gr4j for the dry years it is slightly better to calibrate the model using nse as the objective function while it is better to calibrate the model against wet or normal years using nselog or nseinv as the objective function meanwhile for ihacres calibration on the normal years performs better when nse or nseinv is the objective function but the wet year sub period is more suitable for calibration based on nseinv for simhyd the best parameterization scheme is that using nseinv as the objective function and calibrating the model for the sub period with relatively wet climate conditions for all three climate sets if the simhyd model is calibrated using nse it tends to underestimate the recharge overall the results suggest that nselog and nseinv are in general better objective function options than nse for all three different climate conditions in most catchments except for the case when simhyd is calibrated against the dry period a better defined objective function has the potential to improve the model performance significantly however it is more challenging to define the calibration period because the effects of the calibration period configuration are heavily model dependent and subject to the objective functions the results also suggest that for better recharge estimation improvements in parameterization scheme could be as important as a better model structure yet there is currently no specific parameterization scheme outperforming all the others across all the studied catchments it is therefore important that future studies further explore the impact of parameterization schemes e g additional objective functions and different climate conditions meanwhile it is also critical to assess the uncertainty caused by the different parameterization schemes 4 4 uncertainties in recharge estimation on the basis of the estimations of recharge from the 12 parameterization schemes 3 objective functions by 4 calibration periods for each model the uncertainty interval ui and the coverage probability cp are calculated for the studied catchments as shown in table 3 the uncertainty intervals ui s of mean annual recharge for 17 catchments are 54 4 mm 72 7 mm and 108 6 mm respectively for gr4j ihacres and simhyd with coverage probability cp of 100 94 1 and 88 2 for the models with high cp the parameterization schemes used in this study are shown to be sufficient to describe the uncertainties of recharge estimates while the models with low cp would need other parameterization schemes fig 7 further illustrates that the uncertainties of the estimated recharge in term of spread are found to be wider for the catchments with relative higher annual recharge rate it implicates that for catchments with smaller annual recharge the uncertainty of the recharge estimation tends to be lower smaller ui but higher cp as seen from fig 7 three models produce different uncertainties in the recharge estimation comparatively in terms of median estimates gr4j outperforms the other two models with relatively lower bias and higher r2 it is clear that there is no best model that outperforms the others in all performance metrics shown in table 3 generally table 3 among the three models the model showing lower ui tends to have higher cp and vice versa as also shown in fig 7 the spread of recharge estimates is found to be asymmetrical for all three models where the distribution of the estimates is skewed either towards the lower or upper bound of the spreads as indicated by the median estimate the results imply that the parameterization schemes for a specific model could collectively underestimate or overestimate the diffuse recharge the underlying reason of which could be the systematic bias inherited from the model structures or the limited parameterization schemes explored in this study to better address the uncertainties by narrowing down the spread intervals and increasing coverage probability concurrently it would be therefore worthwhile to further improve the parameterization schemes and conduct multi model ensemble simulation to produce more credible recharge estimation and the associated uncertainties fig 7 and table 3 5 conclusions groundwater recharge estimation is a great challenge plagued with uncertainties from limitations in observation and process understanding hydrological model in combination with the rora approach is found having the potentials to estimate the diffuse groundwater recharge even though the model itself has no direct recharge output the approach can therefore be used to predict the diffuse groundwater recharge at catchment scale and to assess the climatic impacts on recharge when the hydrological model is well calibrated the estimates of recharge inherit uncertainties from hydrological model structure and model parameterization schemes to confront the uncertainties it is essential to explore the range of hydrological simulations confined jointly by different models objective functions and calibration datasets conditioned on climate our findings suggest objective functions focusing more on low flows e g selog nseinv can constitute better choices for more credible recharge estimation the improvements of model performance resulted from a well defined objective function can be strengthened by deliberate selection of the calibration period conditioned on climate yet there is no specific parameterization scheme configured jointly by objective function and calibration period found generally outperforming all the other options the uncertainties of recharge estimation arising from parameterization are comparable with that from model structure but the parameterization scheme alone cannot compensate for structural uncertainties it is worthwhile to use multi model ensemble simulation from different model structures and parameterization schemes to produce more credible diffuse recharge prediction the use of different models objective functions and calibration periods allows reflection on the level of uncertainties one can minimally expect in estimating catchment scale recharge credit authorship contribution statement ruirui zhu conceptualization methodology writing original draft barry f w croke investigation writing review editing anthony j jakeman writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research of the first author is supported by the australian government research training program agrtp appendix a the structure of hydrological models used gr4j model the gr4j model proposed by perrin et al 2003 is a catchment water balance model a schematic of the model is shown in fig a1 the inputs of the model are rainfall and potential evapotranspiration and the four free parameters to be calibrated are x1 x2 x3 and x4 the production store x1 represents storage in soil surface and is dependent on catchment soil type it is assumed that the lower the soil porosity the larger the production store groundwater exchange coefficient x2 is a function of groundwater storage a negative value of x2 indicates water seepage into the depth aquifer while a positive value indicates water flow from aquifer to routing storage the routing storage x3 is the maximum amount of water that can be stored in soil porous depending on soil type and soil water content the time base of the unit hydrograph x4 represents the time from rainfall to peak flow ihacres model ihacres model is a continuous rainfall runoff model which is used to generate estimates of runoff from rainfall and potential evapotranspiration data jakeman and hornberger 1993 croke and jakeman 2004 the conceptual layout of the model is shown in fig a2 the box on the left represents a non linear loss module that converts rainfall into effective rainfall and evapotranspiration and changes in catchment moisture effective rainfall is the portion of rainfall that will eventually leave the catchments as runoff effective rainfall is routed through two parallel linear stores to produce streamflow in the linear routing module instantaneous unit hydrograph theory is used to describe both quick flow and slow flow the sum of quick flow and slow flow hydrographs gives total streamflow simhyd model the simhyd model is a lumped conceptual daily rainfall runoff model chiew et al 2002 fig a3 shows the structure of the simhyd model and the algorithms governing water moving from rainfall to streamflow through several stores it requires daily rainfall and potential evapotranspiration as input data and 9 tunable parameters as described in the fig a3 as shown in fig a3 daily rainfall in the simhyd model first fills the interception store which is drained by evaporation every day excess rainfall occurs if rainfall exceeds the maximum daily interception then excess rainfall is subjected to an infiltration function which determines the infiltration capacity the excess rainfall that exceeds the infiltration capacity becomes infiltration excess runoff infiltration water is subjected to a soil moisture function which diverts water into the river as saturation excess runoff interflow groundwater store as recharge and soil moisture store the saturation excess runoff interflow is first estimated as a linear function of the soil wetness soil moisture level divided by soil moisture capacity the equation used to simulate interflow therefore attempts to mimic both the interflow and saturation excess runoff processes with soil wetness used to reflect those parts of the catchment that are saturated and from which saturation excess runoff can occur groundwater recharge is then estimated also as a linear function of the soil wetness the remaining moisture flows into the soil moisture store evapotranspiration from the soil moisture store is estimated as a linear function of the soil wetness but cannot exceed the potential rate pet minus intercepted water the soil moisture store has a finite capacity and overflows into the groundwater store baseflow from which is simulated as a linear recession from the groundwater store runoff from three source infiltration excess runoff interflow and baseflow are altogether routed by using muskingum routing method to give total streamflow appendix b supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2020 124642 appendix b supplementary data the following are the supplementary data to this article supplementary data 1 supplementary data 2 
5612,in a rapidly changing environment analysis of risks associated with non stationary hydroclimatic extremes has many important implications for resilient and sustainable water resources management including the evaluation of risk for existing systems and the design of new infrastructure this study develops a new risk based analytical framework called the non stationary monte carlo nsmc to better address various problems associated with non stationarity of hydrologic extremes current approaches in the literature evaluating non stationary probability distribution functions pdfs of extremes events commonly use trend extension or multivariate analysis based on observed data which often fail to account for larger changes in the future to avoid these problems nsmc explicitly accounts for the projected changes in hydroclimatic extremes by analyzing the changing pdfs of extremes for each future year based on statistically downscaled climate projections and hydrologic simulations using monte carlo techniques nsmc generates a super ensemble se of extremes the statistics of which can be readily applied to various problems in non stationary flood frequency analysis for example we show that the estimation of design standards based on design life level dll or average risk of failure arf metrics can be reduced to a simple look up process of quantiles in the se of extremes a case study analyzing extreme high streamflow and a hypothetical levee design for the wabash basin in usa demonstrates the applicability of nsmc to real world flood risk problems furthermore this study also shows an example case of using nsmc to identify cost effective design standards for new infrastructure combining future changing risk of failure project design lifespan and present value of future replacement costs keywords non stationary hydrologic extremes non stationary monte carlo risk of failure of hydrologic infrastructure design standards for hydrologic infrastructure total expected lifecycle costs of infrastructure climate change impacts on hydrologic design 1 introduction the problem of analyzing non stationary biogeophysical systems has received increasing attention from the research community in the last decade or so ipcc 2013 milly et al 2008 sheffield and wood 2008 razavi et al 2015 wolkovich et al 2014 in particular addressing non stationarity in hydroclimatic systems has important implications for human water management infrastructure evaluation design and the assessment of ecosystem impacts poff et al 2016 quinn et al 2018 thompson et al 2013 wagener et al 2010 for example non stationarity of hydrologic extremes under a changing climate present formidable challenges to the design of sustainable water management policies robust design of hydrologic infrastructure such as river flood and sea walls urban stormwater systems etc buchanan et al 2016 mudersbach and jensen 2010 oddo et al 2017 read and vogel 2016 rosner et al 2014 vousdoukas et al 2018 wahl et al 2015 xiong et al 2015 zhang et al 2018 in many previous studies non stationary problems in frequency analysis of hydrologic extremes have been addressed using statistical approaches as reviewed by bayazit 2015 and salas et al 2018 non stationary analysis of extremes typically begins with the generation of time varying probability distribution functions pdfs of extremes and most previous studies have been based on parameter informed approaches which condition the parameters of the extreme value distribution on a time varying covariate these types of approaches are further classified into two categories one is trend informed approach which extrapolates historical trends in distribution parameters with a time covariate and applies them in future periods e g du et al 2015 razmi et al 2017 rosner et al 2014 serago and vogel 2018 although these approaches are based on observations it is questionable whether the historical trends in parameters will be preserved in the future especially when significant long term changes in climate are larger than those experienced so far in the historical record clarke 2013 luke et al 2017 serinaldi and kilsby 2015 yan et al 2017 in later sections of the paper we will show some specific examples of this problem the other approach which has been increasingly supported in the literature is a climate informed approach using large scale climate fields as covariates for deriving time varying distribution parameters of floods e g condon et al 2015 delgado et al 2012 2014 schlef et al 2018 rather than relying on a historical trends these approaches use explicit climate projections deriving from global or regional scale climate model simulations in most cases however downscaling is required because coarse grid resolution of climate models may not successfully capture fine scale variability of extremes for flood applications downscaled climate projections are typically used as inputs to hydrology models to estimate daily or hourly streamflows and the changing flood risk over time e g tohver et al 2014 byun et al 2019 although the fundamental concept of a changing pdf through time is a common element of many studies the analysis and interpretation of these changes for evaluating the risk of system failure or suggesting design standards for new infrastructure is often different in different studies for instance some are based on a representative return period which represents expected waiting time until an exceedance occurs olsen et al 1998 or expected number of exceedance within a given period cooley 2013 parey et al 2007 2010 both of these approaches however fail to consider the design lifespan of structures this is a crucial element in the design process because the risk of failure and therefore also design cost is directly related to the time that the structure must remain in place this element of the design process has been better addressed in some recent studies read and vogel 2015 rootz√©n and katz 2013 which take into account design lifespan by assessing the overall risk of failure or no failure reliability over the entire design lifespan although a number of different methods have been proposed in the literature for addressing these issues there is currently little consensus on which approach to use in practice yan et al 2017 for example compared four different approaches for analyzing non stationarity extremes but did not make specific recommendations about which approach to use furthermore many existing methods are very difficult for most professional engineers to implement in a cost effective manner which highlights the need to develop improved analytical approaches that are flexible i e capable of addressing a wide range of problems and are relatively straight forward to implement and interpret in practice hu et al 2018 rootz√©n and katz 2013 taken together the issues discussed above point to a number of desirable features that should be incorporated in the design of a new analytical framework for the analysis of non stationary extremes in the context of a changing climate 1 explicitly incorporate the changing nature of the probability distributions through time 2 avoid trend extension approaches and instead explicitly account for projected changes in future climate from downscaled climate change projections 3 incorporate design lifespan as an integral part of the analysis 4 improve flexibility ease of use and ease of interpretation this study aims to develop a new approach that incorporates these desirable features in a single approach specifically we develop a new analytical framework for the analysis of extremes based on monte carlo approaches and the concept of analyzing risk using super ensemble se statistics this new approach which we call the non stationary monte carlo nsmc approach directly and explicitly models changing pdfs of future extremes using numerical models i e hydrologic simulations driven by climate change scenarios effectively avoiding the use of trend extension by analyzing each of these unique pdfs over a specified design horizon and estimating the overall risk of a design failure we explicitly incorporate design lifespan as a central component of the analysis the approach which is straight forwardly applied to a wide range of problems can be implemented using computer resources available to most researchers and professional practitioners and is relatively easy to interpret we demonstrate this capability by applying the nsmc approach for a case study of the flood frequency analysis in the wabash river basin in the midwestern u s for which future flood risk is projected to increase substantially based on our previous analysis using numerical simulations byun et al 2019 we apply the nsmc approach to several important problems including a evaluating the risk of failure for existing infrastructure b producing design standards for new infrastructure for a specific level of risk and design lifespan and c evaluating the construction replacement cost of infrastructure as a function of risk of failure design lifespan and concepts relating to the present value of future replacement costs 2 methods 2 1 synopsis fig 1 shows a schematic diagram of the data processing and modeling steps used in the analytical framework which we will describe in order in the sections below having described the technical aspects of the analytical framework in detail we then outline a case study analyzing high flow extremes in the wabash river basin which we use to illustrate the approach also we examine some of the implications of the present value of future replacement costs and the sequential evolution of risk on these analytical problems these are followed by a brief description of evaluation of techniques by a comparison with pre existing methods please note that supporting information appendix c provides important details on the validation work and some other applications of our approach although we use specific examples to illustrate these new techniques it should be carefully noted that the central topic of this paper is the analytical framework itself which should not be confused with specific components of our example case studies such as choice of downscaling method and hydrologic model that we use to simulate future flood risk instead we demonstrate that this analytical framework can be flexibly applied to different kinds of hydrological hydrodynamic or meteorological extremes geographic regions infrastructure types climate models downscaling methods hydrologic or hydrodynamic models etc thus the choice of methods employed in our case study examples although certainly intended to be illustrative are essentially arbitrary and do not imply a loss of generality for the overall approach 2 2 data sources and hydrologic modeling 2 2 1 macro scale hydrologic model hydrologic simulations were carried out using the physically based macro scale variable infiltration capacity vic model version 4 1 2 implemented at 1 16 liang et al 1994 1996 the model has been widely used in many past climate change impacts assessment studies at a range of spatial scales chin et al 2018 hamlet et al 2013 livneh et al 2013 naz et al 2016 tohver et al 2014 vano et al 2015 the historical baseline simulation is based on observed meteorological data for the entire historical period 1915 2016 and each future simulation which has the same sample size as history is based on downscaled global climate model gcm simulation data from a 30 yr time window in the future by using simple streamflow routing model gridded daily runoff and baseflow outputs are then routed as daily streamflow to a specific outlet point of the wabash watershed usgs 03377500 at mt carmel il removing two initial years for model spin up results in 100 water years of simulated daily data 1917 2016 from which we extract 100 peak daily streamflow annual maximum daily streamflow values validation of the vic model in terms of reproducing observed variability of monthly and peak daily streamflow at a watershed for our case study the wabash river basin described in section 2 4 are given in supporting information s 1 validation of hydrologic model which shows good validation statistics and demonstrates the applicability of our hydrologic model for illustrating the concept of our framework for the non stationary flood analysis presented below 2 2 2 observed meteorological data gridded meteorological forcing data for the hydrologic model from 1915 to 2016 include daily precipitation mm maximum and minimum temperature c and wind speed m s at 1 16 latitude longitude resolution 5 7 km these data sets for the midwest region include precipitation gauge undercatch corrections chiu et al in personnel communication there are currently two different versions of this adjusted meteorological data set using different strategies for undercatch corrections this study uses version two v2 of the data set which accounts explicitly for different snow measurement techniques and shows best performance in our case study watershed more detailed information on this data set can be found in byun and hamlet 2018 2 2 3 future climate projections based on statistical downscaling for the future climate projections this study makes use of statistically downscaled gcm data as summarized in table 1 six different gcm projections from the coupled model intercomparison project phase 5 cmip5 based on the highest greenhouse gas ghg emission scenario representative concentration pathway rcp 8 5 are used these are selected based on two criteria a their performance in simulating historical climate and b ability to capture the full range of future temperature and precipitation projections from an ensemble of all available gcms over the midwest and great lakes region byun and hamlet 2018 temperature t and precipitation p simulations from each gcm are statistically downscaled by using the hybrid delta hd downscaling approach byun and hamlet 2018 hamlet et al 2013 tohver et al 2014 the hd combines observed variability from a long historical record with altered monthly statistics from gcm simulations the technique retains key advantages of both the classic delta method dm and the well known bias correction and spatial disaggregation bcsd downscaling approach wood et al 2004 important advantages of the hd for this study include a large common sample size for the historical baseline and future projections daily time series behavior derived from history in each future period and realistic representation of hydrometeorological extremes in particular having a consistently long time series associated with each future period ensures ample sample size for the analysis of extremes with long return intervals e g the 100 year flood see byun and hamlet 2018 for additional details on the downscaling approach and selected gcms projections for the midwest region to validate the hd approach and its ability to reproduce daily extremes byun and hamlet 2018 use split sample tests on the historical record to confirm that daily extremes extracted from a historical 30 year window are comparable to statistically downscaled extremes for the same period of time when the downscaling is trained on an independent period see byun and hamlet 2018 for additional details on the hd downscaling approach selected gcms projections for the midwest region and validation of extremes produced by the hd approach 2 3 non stationary monte carlo nsmc method for hydrologic extreme analysis in this section we introduce a new analytical framework for non stationary analysis of hydrologic extremes this new approach hereafter referred to as the non stationary monte carlo nsmc extends well established techniques for climate downscaling and hydrologic modeling and combines them with stochastic resampling techniques monte carlo to generate a so called super ensemble se of hydrologic extremes we then show how the statistics of this se can be used to evaluate risk of failure of existing infrastructure based on existing design standards or to estimate design standards for new infrastructure under a changing climate the first two subsections 2 3 1 and 2 3 2 describe the fundamental steps in the nsmc framework and the last subsection 2 3 3 describes several applications of the technique for the analysis of extremes as a concrete case study we analyze a hypothetical flood protection levee in the wabash river basin using traditional methods stationary statistics non stationary techniques based on trend extension approaches and the new nsmc framework developed in this paper 2 3 1 deriving time varying cumulative distribution functions cdfs of hydrologic extremes as shown in fig 2 a the nsmc technique includes downscaling of gcm data modeling of extreme streamflow by hydrologic simulation and fitting of the parameters of probability distribution to estimate the cdf and inverse cdf of daily peak streamflow to characterize the changing statistics through time we duplicate this process for a 30 yr window centered on each individual year t i during the design lifespan dl of structure specifically the nsmc generates 100 hydrologic extremes see discussion of hd downscaling technique above associated with a 30 yr window centered on each year of a specified future design lifespan represented by t i in fig 2a these simulated extreme values are then used to generate a unique cdf of extreme high flows for each future year in the design lifespan for example the cdf for future year 2035 is generated using the 100 peak flow values associated with a 30 year window from 2020 to 2049 note also that for some future years in the early part of the design lifespan the 30 year window also includes some historical years for example the year 2017 is associated with the 30 year window 2002 2031 although any start year can be used in practice for consistency in subsequent discussion we will assume 2016 is the current year of the analysis and 2017 is the first year of the proposed design lifespan there are two main reasons behind the use of moving 30 yr window centered on each year firstly our statistical downscaling method does not use daily scale gcm information instead it incorporates the changes in monthly scale distributions which are then used to rescale observed daily values and extremes thus the approach avoids shortcomings of daily climate simulation e g sequence or frequency of occurrence of events secondly despite the independent generation of downscaled data to fit a probability distribution for each year moving 30 year windows centered on individual year share lots of overlapped information between adjacent years thus it prevents unrealistic radical shifts in the probability distributions in a short period of time although we acknowledge that a different length of time window could be chosen for this kind of analysis we have found in past studies that 30 year windows provide adequate sample size for the hd approach byun et al 2019 hamlet et al 2013 tohver et al 2014 while also providing reasonable specificity i e not too much temporal smoothing for each year in the design lifespan that is choosing shorter windows would create problems with inadequate sample size in the statistical downscaling whereas longer windows reduce specificity of the results for each year in the dl and increase the number of overlapping years between adjacent time windows thus the rate of change in the probability distributions is reduced for longer time windows also it should be noted that gcm projections are only available up until 2100 thus longer time windows would effectively reduce the maximum design lifespans that can be considered lastly 30 year windows are a common time scale used in calculating climate statistics which further informs our choice of this window size it is important to note that the special features of the hd statistical downscaling technique serve two distinct purposes here by a converting monthly gcm values for a given 30 year window into realistic daily values including extremes and b extending the sample size to 100 years which reduces uncertainty in fitting probability distributions to the simulated extremes although we argue that the hd has some specific advantages for this application in practice any downscaling technique that produces a transient simulation of daily values could be substituted in the nsmc process thus there is no loss of generality in using the hd to explore the effectiveness of these methods downscaled gcm projections are used as inputs to the hydrologic model to generate a set of extreme streamflow events associated with a 30 yr window centered on a year in the dl to fit a probability distribution to the 100 extreme streamflow values for each year in the dl this study uses the generalized extreme value gev distribution which has a set Œ∏ t i of three parameters including location Œæ t i scale œÉ t i and shape Œ∫ t i for a given parameter set Œ∏ t i the cdf of the gev distribution can be written as follows hosking and wallis 2005 1 cdf t i x e x p 1 Œ∫ t i x Œæ t i œÉ t i 1 Œ∫ t i Œ∫ t i 0 i 1 2 n where t i represents an arbitrary year in the dl starting with t 1 2017 where t i represents an arbitrary year in the dl starting with t 1 2017 this study estimates the three parameters of gev based on l moment methods hosking and wallis 2005 for each individual year in a proposed future design lifespan our approach is similar in concept to that proposed by bender et al 2014 who applied l moment fitting techniques for a moving historical window but the key difference is that rather than analyzing windows in the historical record and then applying trend extension techniques to individual parameters our method explicitly parameterizes the gev distribution for future periods based on transient climate change projections validation of the performance of the nsmc approach in generating time varying cdfs of peak daily streamflow are presented in supporting information s 2 validation of cdfs of downscaled peak streamflow using the hybrid delta basically we use a split window test in the same way as byun and hamlet 2018 for independently generating downscaled data for 30 yr validation window 1987 2016 by using fine scale observed data in training period 1916 1986 then a cdf from hydrologic simulation based on this downscaled data is compared with that from original hydrologic simulation extracted for the validation period the result in fig s 2 shows that the nsmc successfully reproduces the cdf of the extreme values from first principles please see supporting information s 2 for further details on this validation work 2 3 2 monte carlo techniques for generating a super ensemble se of extreme values the result of the previous steps in the data processing sequence is a unique gev parameter set and cdf for each future year in the design lifespan the next step is to create a mixture matrix of extremes which includes all the information from each future design year s cdf using monte carlo mc techniques with a large number of realizations k 10 000 samples specifically we randomly sample percentiles p i from the uniform distribution u 0 1 and then use the inverse cdf cdf 1 for a year in the dl to calculate each extreme value x fig 2b extending this procedure for all years in the dl n and repeating this with a large number of realization k we create a se of extreme values which has dimension of n k using this procedure we effectively analyze multiple cdfs over time in a collective manner the se reflects a mixture of distributions through time which characterize both the non stationarity and randomness of occurrence of extremes we show some different applications of the se in analyzing extremes in the next subsection it should be also noted that our choice of 10 000 realizations k was made based on our preceding analysis which showed that convergence of mc simulation occurred when the number of monte carlo samples was greater than 5 000 to provide a margin of safety we increased the sample size to 10 000 2 3 3 application of the super ensemble se 2 3 3 1 analyzing the risk of failure of infrastructure over the design lifespan in this first application we evaluate the risk of failure of infrastructure over some arbitrary design lifespan based on a particular design standard for this we use the concept of a design life level dll proposed by rootz√©n and katz 2013 and salas and obeysekera 2014 although discussed in these recent papers dll is based on classical concepts of risk or reliability introduced by several introductory hydrology text books bras 1990 chow 1964 and it evaluates risk r t 1 t n dll over a specified dl n t n t 1 1 for a given design standard ds which explicitly represents the probability of occurrence of one or more extremes that exceed the design standard of the infrastructure during its lifespan dll for the non stationary case can be written rootz√©n and katz 2013 salas and obeysekera 2014 2 dll t 1 t n d s r t 1 t n dll 1 i 1 n 1 q t i 1 i 1 n c d f ds Œ∏ t i where q t i is the probability of exceedance of a fixed ds for each year in the dl t i note also that dll for the stationary case is easily constructed by specifying a constant value of q t i through time based on the ds of interest first of all we note that for this application q t i can be analytically estimated using eq 1 for each year in the design lifespan alternately we can use the se to count fig 2b the number elements that are equal to or greater than the ds and estimate the probability of failure by dividing by the total number of realizations k this can be done for a single year in the design lifespan or alternately can be applied to the entire se to produce a summary statistic reflecting the overall probability of failure for the entire design lifespan we show in the appendix a that having specified a ds the associated probability of exceedance value extracted from the se is equivalent to the so called average risk of failure arf and a similar approach can be used to estimate dll based on a simple scaling relationship between arf and dll this process can also be inverted having specified a value of risk based on arf or dll an estimate of ds can easily be obtained from the se by looking up the appropriate quantile the nsmc approach is also useful for analyzing the sequence of risk over time which is particularly important information for evaluating the economic impacts of future design failures these economic impacts are investigated in this study based on the present value of future replacement costs described in section 2 3 3 3 below 2 3 3 2 estimating non stationary design standards for infrastructure using dll in this application given a design lifespan and a changing risk structure through time i e a unique cdf for extreme values for each future design year we wish to calculate a ds i e a particular extreme value that will result in a specified overall risk of failure r t 1 t n dll during the design lifespan that is given an overall risk of failure over the design lifespan we wish to invert eq 2 to calculate a ds we were unable to analytically solve for ds in closed form because eq 2 expresses the overall risk of failure as a product of the unique probability of non exceedance for each year in the design lifespan however this problem can be straight forwardly solved numerically by using an iterative approach that is an initial guess of the ds can be used to calculate q t i for each year in the design lifespan and an associated value of r t 1 t n dll which is compared to a target value based on the error in r t 1 t n dll an updated estimate of the ds is produced this process is repeated until the error in r t 1 t n dll is acceptable an alternative approach which may be more convenient or intuitive is to solve for the ds using the se generated by the nsmc process this alternate approach is advantageous because it can substantially simplify the search process for the non stationary ds into a simple lookup from an ordered list this is accomplished by relating a specific probability of exceedance within the se to a certain level of risk of failure i e r t 1 t n dll in the alternative approach we begin by ranking all elements of the se from largest to smallest and then fitting an unbiased quantile estimator eq 3 cunnane 1989 to the ranked data set as follows 3 f se i q se i i 0 4 n 0 2 where i is the rank position of each se member and n is the total number of elements of the se using this intermediate product we can then estimate the probability of exceedance q se i for any individual member of the se se i we found in investigating this quantity that q se i is essentially equal to dll t 1 t n se i divided by the dl n that is 4 q se i dll t 1 t n se i n thus by setting dll t 1 t n se i equal to the desired target value r t 1 t n dll and applying eq 4 we reduce the process of finding an appropriate ds to a simple lookup from an ordered list that is 5 ds dll t 1 t n 1 r t 1 t n dll f 1 r t 1 t n dll n where the function f is the cdf constructed from the se appendix a and b derives and validates eqs 4 and 5 to give a concrete example of this procedure if a ds needs to be calculated according to a specified 10 risk of failure over a 50 yr lifespan i e r 2017 2066 dll 0 1 we can simply find the unique se i that has the probability of exceedance of 0 002 q se i 0 1 50 or non exceedance probability of 0 998 99 8th percentile it is straight forward to validate this approach by comparing the se value of ds to the value of the ds obtained by the iterative approach described above see section 3 2 2 below 2 3 3 3 estimating total expected lifecycle costs of infrastructure as mentioned in 2 3 3 1 accounting for the dl of infrastructure in a risk based analysis is one of the most important elements botto et al 2014 qi 2017 moreover given that the design of infrastructure is often constrained by available financial resources coupling economic factors with risk based assessments is imperative in particular in the case where risks are increasing through time minimizing risk of failure over the dl may not be equivalent to minimizing total expected lifecycle costs telc this is because failures become increasingly likely at the end of the dl in an increasing risk sequence while the present value costs of replacing infrastructure due to potential failure typically decline through time thus it may actually be more cost effective to underdesign for future conditions rather than attempt to minimize the risk of failure by making the original design more robust to quantify the tradeoffs between a choice of ds and associated construction costs and telc we use the se produced by nsmc to evaluate the sequential risk of failure over the dl and the expected costs of initial construction and potential future replacement costs to quantify the telc for a given dl we first choose a ds which directly determines initial and future infrastructure construction costs ic d s the evolving risk structure through time i e a set of q t i for the entire dl note that ds also determines r t 1 t n dll as discussed above since the present value of money at any future time typically decreases with time from the present the present cost to reconstruct infrastructure at some point in the future will also generally decrease with time to account for this we use the concept of present value pv of money which represents the present value of the future unit cost 1 as shown in eq 6 6 pv i 1 1 c i 1 i 1 2 n where i is the number of compounding years from a reference starting year t 1 2017 and c is defined as the real rate of return which accounts for annual percentage realized on an investment adjusted by other external effects such as increased cost of construction due to inflation etc for our purpose pv is the amount of money that should be invested at an assumed rate of return c to meet a unit cost 1 for reconstruction in t i 1 year of the future for simplicity it is also assumed that the cost to rebuild the infrastructure in year t i 1 will be the same as that of initial construction cost that is the design standard is not adjusted when the infrastructure is rebuilt we note that c in eq 6 can be adjusted to reflect changing real costs through time so there is no loss of generality in this simplifying assumption finally we can evaluate the telc of the infrastructure design by combining the initial cost on construction with the probability weighted average of the cost of replacement over the dl eq 7 7 t e l c d s d l i c d s i c d s i 1 dl q t i pv i i c d s where telc a function of ds dl and ic ds is the total expected lifecycle cost in present dollars ic ds is the cost of infrastructure construction a function of ds q t i is the probability of infrastructure failure for each future year a function of ds and the changes in hydrologic extremes and pv i is the present value of a future expenditure of 1 in year i of the dl so the infrastructure is initially built at the beginning of 2017 at a cost of ic ds the infrastructure can potentially fail in any future year including the first year 2017 and the total risk of failure in each future year is given by q t i over each future year the present value of money is given by pv i the summation term of right hand side of eq 7 can be defined as the expected replacement cost erc in present dollars our objective in this section of the paper is not to present a sophisticated application for designing specific kinds of water infrastructure but rather to explore the tradeoff between risks of failure of infrastructure and associated costs in an explicit manner thus in order to model ic ds in a way that accounts for construction costs directly associated with the geometry of infrastructure as a function of the ds this study uses a simple idealized conceptual channel with a single levee fig s3 as similarly illustrated in hui et al 2016 we describe the derivation of ic ds for this case in supporting information see s 3 derivation of the cost of single sided levee construction as a function of streamflow design standard ic ds which specifies ic ds for a single levee with unit length 1 m along the river bank as follows 8 i c d s 53 3 0 55 ds 0 36 9 92 2 0 55 ds 0 36 9 92 2 using eq 8 simplifies telc in eq 7 which then solely depends on ds and dl 2 4 overview of the wabash river basin case study our case study focuses on the wabash river watershed basin area 74160 km2 in indiana illinois and ohio in the united states u s fig 3 we selected the wabash watershed in part because it is in the hydro climatic data network hcdn defined by u s geological survey usgs slack and landwehr 1992 which implies minimal human influence on flows byun et al 2019 also showed a strong signal of intensifying flood risk in the wabash watershed in the future hydrologic simulations based on downscaled gcm projections which further informs our choice of this watershed as a case study for non stationary flood frequency analysis this study analyzes observed daily streamflow data collected from a usgs gage station at carmel illinois usgs 03377500 and simulated streamflow data from the vic hydrologic model the streamflow gauging location and contributing basin area for the wabash are shown in fig 3 2 5 intercomparison of nsmc results with stationary and existing non stationary techniques to compare with the results by nsmc we also use two different baseline methods for generating the future cdfs for each year in the dl one is the stationary case for which we assume that all of the cdfs for future years are identical and derived from hydrologic simulations of the historical baseline period 1917 2016 this method is a common approach that fits a set of distribution parameters to historically observed or simulated historical extremes for a retrospective time period the other case is a non stationary case which considers a linear trend in the gev location parameter with time i e Œæ t i Œ≤ 0 Œ≤ 1 t i while the other two gev parameters œÉ 0 a n d Œ∫ 0 are held fixed although there are several variants used in different studies this is the overall approach used in current non stationary flood frequency analyses in the literature hereafter we refer to this method as the non stationary linear trend nslt approach applying a maximum likelihood estimation mle for the historical simulation in the wabash river case study described above yields the following estimates of these parameters coles 2001 cooley 2009 katz et al 2002 Œ≤ 0 2 57 1 32 10 4 Œ≤ 1 14 8 6 71 œÉ 0 1 55 0 13 10 3 a n d Œ∫ 0 0 038 0 08 stationary and nslt future cdfs are then applied using eqs 2 and 5 to evaluate dll or estimate ds finally we compare the results with those based on nsmc 3 results and discussions 3 1 intercomparison of time varying distribution of extremes from nsmc stationary and nslt approaches in this section using the wabash river case study for illustration we compare the time varying probability distribution of daily peak streamflow produced by nsmc with those from the stationary case for a historical baseline period 1917 2016 and nslt approach discussed above based on differently derived time varying distribution fig 4 a shows snapshots of pdfs of daily peak streamflow for four different future years showing how the pdf of extremes for each method shifts over time as shown in the result for early future periods i e 2020 the pdf based on the nsmc method is a fairly close match with the stationary distribution derived from a historical baseline period note however that there are some minor changes in the pdf which are mostly associated with climate change signal between the historical baseline period 1917 2016 and the 30 yr window for 2020 2005 2034 however the pdf by nslt is very different from the stationary distribution for this early future period which demonstrates that there are some substantial problems in estimating all three parameters assuming a simple linear trend in the location parameter both non stationary approaches nsmc and nslt produce shifting pdfs towards increasing extremes over time however more substantial shifts are shown by nsmc at later periods which is mostly associated with the strong climate change signal in downscaled projections at the end of 21st century we also found that changes in the pdfs estimated using the nsmc method were not monotonic instead they show small variations back and forth between some adjacent future years these variations from year to year are probably more realistic than the strictly monotonic increases modeled by the nslt approach fig 4b shows 100 yr reoccurrence peak daily streamflow over time for each approach as in fig 4a discussed above the difference between the historical baseline stationary case and nsmc shown at initial future year is mainly due to different evaluation periods for each method i e a historical baseline period 1917 2016 versus a 30 yr window 2002 2031 centered on 2017 most importantly 100 yr extremes derived using the nsmc approach are much greater than the other two approaches especially in later years of the future period this substantial difference in extremes is because the shift of the probability distribution of future extremes from gcm based modeling experiments is much larger for the later periods although future uncertainties in gcm projections are acknowledged especially in light of ghg concentration uncertainties it is important to note that gcm based trajectories are generally nonlinear especially for high end scenarios like rcp8 5 thus it is difficult to argue that trend extension is a reasonable approach over the long time horizons we consider here gcm projections also represent the best available science and this informs our decision to use these projections as the basis for our case study this substantial difference in extremes illustrates some critical issues associated with the nslt approach for example nslt underestimates extreme events at early periods until about the 2040s when compared to the stationary case these artifacts of the nslt approach relate to the questionable assumption of a linear trend in the location parameter this implies that trend analysis only focusing on the location parameter may not be able to properly characterize the changing nature of tails in future years most importantly the nslt approach that assumes a constant trend over time cannot capture the relatively large changes in extremes as shown in latter periods fig 4b this is especially true in this particular case study for which the projected impacts of climate change on flooding are substantial 3 2 application of the nsmc se of extremes to quantify risk of failure and choose design standards 3 2 1 quantifying risk of failure of infrastructure over its lifespan using dll fig 5 shows the risk of failure dll of infrastructure i e a levee or flood wall in our case over varying dl calculated using eq 2 regardless of approach used to construct the time varying cdfs dll increases as the dl of the structure increases note also that dll will systematically increase if the ds is lowered however the dll calculated using the time varying cdfs of nsmc is substantially greater than the results from the other two approaches especially for the cases with greater initial design level e g compare fig 5a and d this result highlights the systematic errors that are introduced when we evaluate the performance of infrastructure based on stationary assumptions or historical linear trends when future flood risks continue to grow through time that is the difference between nsmc and stationary nslt approaches intensifies as the ds increases and the risk of failure declines the level of risk used in establishing a test ds has a substantial effect on the relationship between stationary and nslt results for a relatively low level of ds fig 5a and 5b risk of failure evaluated by the nslt approach is greater than the stationary case however this relationship is reversed by considering high design standard cases fig 5c and 5d this result is likely due to characteristic underestimation of high quantiles by the nslt approach fig 4b 3 2 2 design standards for infrastructure based on dll design standards for infrastructure based on the dll metric are calculated according to different combinations of given risk of failure and lifespan as discussed in section 2 3 3 2 for nsmc we compared two methods of calculating the ds a numerically solving for the ds using a non linear solver and eq 2 and b directly looking up the ds from an ordered list constructed from the se based on the quantile identified using eq 4 fig 6 compares the two approaches which closely agree results for other gcm projections not shown were similar which further demonstrates the validity of the mathematical derivation of eqs 4 and 5 presented in appendix a and b this strong agreement is preserved for the lower risk of failure less than 20 as shown in fig 6 however it should also be noted that discrepancy between the results by numerical solution and those by looking up from the se grows with greater risk of failure for example looking up method of the se for 50 of risk of failure for 70 years of dl i e r 2017 2066 dll 0 5 results in about 7 overestimation than numerical solution this is because the approximation of eq 4 and eq b 12 more likely holds true for the tail of the distribution nonetheless this approximation works reasonably well in general given that in many cases flood frequency analysis focuses on the tail of the distribution and thus a relatively low risk of failure for infrastructure also the discrepancy between the two methods for a higher risk of failure is probably acceptable for many practical uses where more accuracy is required however the numerical solution may be preferred over the se lookup procedure when considering a high risk of failure fig 7 shows ds as a function of different levels of risk of failure dll and dl note that the ds increases for a given risk of failure as we extend the dl of structure however the change of ds is non linear with respect to both dll and dl as shown in fig 7a for example changes in design standard with lifespan longer than 50 years are more substantial which is likely due to more significant projected changes in climate and flood risk at later periods in this region of the u s byun et al 2019 byun and hamlet 2018 as expected based on results from the previous section ds values estimated by nsmc are much higher than either the stationary or nslt approaches fig 7 for example if we compare design standards with a dl of 70 years the ensemble mean of nsmc ds based on different gcms is almost as twice much as the ds estimated by the other two approaches see fig 7a 3 2 3 total estimated lifecycle costs over the design lifespan in order to combine non stationary risk assessments with a simple economic analysis of the total expected lifecycle costs telc we first evaluate the sequential risk of failure over time in a changing climate fig 8 a shows an example case of the sequential risk of failure for infrastructure with a dl of 70 years and a ds selected so that dll 10 using the se analysis presented in section 3 2 2 in the first several decades the risk of failure for this ds in an individual year does not substantially change despite some variation from year to year however as time goes on it starts to shift more substantially and the risk of failure is greatest at the end of the dl for example the risk of failure at the end of the dl is almost five times as great as that in the initial years fig 8b illustrates the present value of 1 in each future year which accounts for changing value of money as the real rate of return which we assume includes the effects of interest rates inflation and the changing cost of infrastructure over time we can clearly see the exponential relationship between future year and present value thus there will be dramatic changes according to different rates of return likewise positive and negative rates of return behave quite differently telc in eq 7 combines the changing risk with the changing value of money as a function of infrastructure construction ic and expected reconstruction costs erc eq 7 fig 9 shows the expected costs in present dollars as a function of dll for an assumed dl of 70 years fig 9a shows the results for a positive rate of return while the fig 9b shows the results for a negative rate of return for positive rate of return telc generally decreases with lower ds and higher dll because ic rather than erc dominates the estimate of telc this is an interesting result demonstrating that initial construction cost will likely override expected future replacement costs despite significant increases in risk projected for the future fig 8a on the other hand for the negative rate of return fig 9b erc becomes more significant since sequential risk over dl and present value of the money in erc are in the same direction i e greater risk and present value through time erc predominately intensifies over time in such a way that its increasing rate overrides decreasing rate of ic minimum telc in this case occurs at about 10 risk of failure this is a good example that highlights the effects of a worst case scenario when increasing flood risks and negative economic factors are coupled together in the future the analysis shows that lowest costs for positive rates of return are associated with underdesigning for the future because for positive rates of return the present value of money reduces future costs it is important to note however that other economic and societal losses when infrastructure fails should also be considered in actual applications fig 9a shows that for positive return rates telc decreases rapidly until dll approaches about 10 after which telc is relatively constant with increasing risk fig 9b also shows a minimum cost at about dll 10 this suggests that this level of risk of failure might be a robust choice from an economic perspective while also protecting against unacceptably frequent infrastructure failures property damage loss of life or other impacts by comparison designing for the 100 year flood using stationary statistics has a risk of one or more failures of about 50 for a dl of 70 years fig 5c thus dll 10 represents a very conservative design standard in the context of current societal norms in the u s it is also worth noting that even for the positive rate of return fig 9a adding a higher margin of safety may not dramatically increase costs for example the difference in telc for a 50 risk of failure is only 14 2 lower than the telc for a 20 risk of failure aside from the cost effective perspective however it should also be noted that overdesigning infrastructure may result in negative environmental impacts for instance overdesigned earthen levees which have a much larger footprint would likely adversely impact riparian habitat and ecosystems dramatically increasing levee size in upstream areas can also result in increasing flood risk and sediment transport to downstream locations oversizing flood control reservoirs and spillways would likewise have adverse environmental impacts thus tradeoffs between telc risk of infrastructure failure property damange and loss of life and environmental impacts should be considered in design decisions 4 conclusions this study presents a new analytical framework nsmc that can be used for non stationary frequency analysis of hydrologic extremes under a changing climate nsmc has several important advantages 1 nsmc generates explicit time varying cdfs of extremes for each future year by fitting the parameters of the gev probability distribution to hydrologic simulations based on downscaled gcm data 2 time varying cdfs based explicitly on gcm projections are shown in our case study to be substantially different from those based on stationary assumptions or historical trends in distribution parameters nslt both of which show significant under estimation of risks in the latter part of the 21st century similarly estimating ds for new infrastructure using historical records alone stationary or nslt is expected to underpredict the appropriate ds for a given level of risk in cases where flood risk is projected to shift substantially towards higher values in the future 3 the se of extremes produced by nsmc can be used to analyze the non stationary risk of extremes in a straight forward manner the approach is both flexible and versatile and can be successfully applied to any probability distribution of interest for example we can readily use the se of extremes produced by nsmc combined with a simple look up process to select new ds or analyze the changing risk of failure over time 4 we also developed a straight forward procedure for calculating the total expected lifecycle costs telc of infrastructure by combining the risk of failure from nsmc for each future year with estimates of the changing present value of future investments through time this approach allows us to explicitly explore the tradeoffs between telc and overall risk of failure r t 1 t n dll in a very direct manner although it is clear that conventional methods relying on historically observed data e g the nslt approach will not always result in erroneous outcomes we show that analysis based on historical trends may not be able to capture systematic changes in extremes under substantial changes projected for later periods in the 21st century this is simply because the changes that have been experienced so far that determine the observed trends are relatively small in comparison with projected long term changes thus in the context of infrastructure with long dl we show that use of future projections is an essential component of the analysis providing better insights into the non stationary statistics of extremes nonetheless it should be noted that the uncertainty in gcm projections can be considerable and should be taken into account as we do here relatively coarse resolution gcms may also fail to account properly for small scale convective processes e g thunderstorms in summer and thus more physically based regional climate models should also be used if our target extremes are related to small scale storms e g in the case of urban stormwater management although we have focused here on the use of the nsmc approach to analyze extreme high streamflow in rivers the approach can embrace various types of extremes analysis in a straight forward manner for example extreme low streamflow can be analyzed by considering probability of non exceedance as risks of failure similarly a storm surge model can replace the hydrologic model used in this study in order to generate extreme storm surge estimates needed for designing coastal infrastructure furthermore regardless of methods or probability distributions used for constructing time varying cdfs one can generate the se of extremes by our non stationary monte carlo approach fig 2b for example the nslt approach also can be used to construct a se of extremes the approach developed in this paper provides a broad framework for the analysis of non stationary hydrologic extremes in cases where flood risk is projected to increase over time the use of these new techniques is expected to result in the design of more robust infrastructure and possibly also more cost effective design practice with the analysis of the telc needed to cope with non stationary hydrologic extremes under a changing environment while acknowledging that gcm based hydrologic projections may incorrectly characterize changing flood risks in some cases our approach provides a clearly defined way to increase the robustness of infrastructure based on the best available science while avoiding trend analysis arbitrary increases in the factor of safety such as designing to the 500 yr flood or other approaches that are likely to lead to inadvertent underdesign or overdesign of infrastructure in cases where flood risks are declining over time more cost effective infrastructure can potentially be designed for a given level of risk future research should include more extended applications of nsmc for different contexts as discussed above also more sophisticated analysis coupling risk of failure and cost of specific infrastructure types should be explored in support of practical applications other refinements are also possible for example it may be possible to incorporate additional information obtained in the beginning of the dl into redesigning replacement infrastructure that fails at some point in the future or even anticipate failures before they happen based on ongoing monitoring and evolving future projections in cases where the science behind future projections is rapidly evolving e g in the case of sea level rise projections updates during the dl of infrastructure may be especially important thus past failures or projected high risk of future failure can motivate improvements in existing designs or more intense monitoring protocols combining these approaches with flexible infrastructure designs that can be upgraded through time may provide effective ways to deal with uncertainties in long term future projections declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research in this paper was supported by the department of civil and environmental engineering and earth sciences and the environmental change initiative at the university of notre dame appendix a relationship between the se statistics and average risk of failure the basic concept of an annual average reliability aar was introduced by read and vogel 2015 as a measure of performance associated with a particular design standard ds over a specified design lifespan dl yan et al 2017 made use of this metric and concept to express average reliability as a function of ds and dl which they call average design life level adll see eq 9 in yan et al 2017 adll is written in terms of reliability but we extend this concept to write an expression for the average probability of failure as a function of a particular ds over a specified dl n which we call the average risk of failure arf arf can be written as follows a1 arf t 1 t n d s r t 1 t n arf 1 1 n i 1 n 1 q t i 1 1 n i 1 n c d f ds Œ∏ t i note that the expression 1 n i 1 n 1 q t i is simply the adll and therefore arf t 1 t n d s 1 adll t 1 t n d s in eq a 1 the arf represents the annual average of risk of failure over the design lifespan r t 1 t n arf associated with a particular ds thus arf as a function of ds and dl is a mixture of time varying probabilities of failure which are averaged with equal weight for each year we now show that arf can be related to the probability of exceedance values from the entire super ensemble se generated by monte carlo analysis the probability distribution of the se is determined by a mixture of elements uniformly extracted from a set of time varying cdfs because the sample size extracted from each yearly distribution is identical the elements of the se are equally influenced by each year s distribution thus we argue that the probability of exceedance q se i associated with a given value se i extracted from the se should be approximately the same as the averaged probability of exceedance from multiple cdfs over the dl that is the probability of exceedance q se i should be approximately equivalent to a r f se i a2 q se i arf t 1 t n se i to demonstrate the validity of eq a 2 first we calculate the average risk of failure during the design lifespan arf t 1 t n se i for each individual member of the se se i using eq a 1 then we also generate the probability exceedance q se i for each se i by ranking all elements of the se from largest to smallest and fitting an unbiased quantile estimator eq 3 cunnane 1989 finally we compare each pair of q se i and the corresponding value of arf t 1 t n se i fig a1 shows the results based on the comparison between calculated q se i and arf t 1 t n se i and suggests that there is a very strong relationship between two results specifically the probability of exceedance of individual member of the se is almost identical with the results of r t 1 t n arf using eq a 1 although fig a1 represents some specific cases of lifespans and data from specific gcm projections we found that other cases show essentially the same results as shown in this figure thus we can conclude that the statistical distribution of the se is approximately identical with that of arf and it also confirms the validity of eq a 2 this also suggests that we can directly apply the se from nsmc for arf to estimate ds for any given r t 1 t n arf using eq a 2 reduces the inverse forms of eq a 1 to a simple look up process as following a3 ds arf t 1 t n 1 r t 1 t n arf f 1 r t 1 t n arf where f 1 is inverse cunnane formula eq 3 to find ds at the plotting position of q se to illustrate the lookup process if we need to calculate a ds for a 1 level of averaged risk of failure over its 50 yr lifespan r 2017 2066 arf 0 01 we can simply find the quantile of se that has the probability of exceedance of 0 01 q se 0 01 or non exceedance probability of 0 99 99th percentile we also show the application of the se for selecting appropriate ds using arf in the supporting information appendix b statistical relationship between arf and dll having confirmed that the statistical distributions of the se and arf are very close to each other we need to explore the statistical relationship between arf and dll so that we can also apply the se from nsmc to estimate dll or provide an appropriate ds with a specified value of dll yan et al 2017 showed the mathematical relationship between adll 1 a r f and dll based on the representative return period concept see eq 15 in yan et al 2017 however the lack of detailed mathematical derivation may impede an understanding of the relationship between the two different concepts thus here we derive the relationship between arf and dll and then use this relationship to relate the statistics of the se to dll to relate two different risk of failures from arf and dll r t 1 t n arf and r t 1 t n dll respectively for the same level of ds first we can rearrange equations for arf and dll eqs a 1 and 2 respectively as following b1 1 r t 1 t n arf 1 n i 1 n c d f ds Œ∏ t i b2 1 r t 1 t n dll i 1 n c d f ds Œ∏ t i then we apply a taylor expansion series for the left terms in eq b1 and b2 as following b3 e r t 1 t n arf 1 r t 1 t n arf 1 2 r t 1 t n arf 2 1 6 r t 1 t n arf 3 1 24 r t 1 t n arf 4 b4 e r t 1 t n dll 1 r t 1 t n dll 1 2 r t 1 t n dll 2 1 6 r t 1 t n dll 3 1 24 r t 1 t n dll 4 since r t 1 t n arf and r t 1 t n dll are less than 1 usually small in flood frequency analysis we would expect higher order terms following the first order in eq b 3 and b 4 to be relatively small neglecting these higher order terms leaves only an exponential term in the left hand sides of eq b 1 and b 2 as follows b5 e r t 1 t n arf 1 n i 1 n c d f ds Œ∏ t i b6 e r t 1 t n dll i 1 n c d f ds Œ∏ t i also we can compare the right hand side terms in eq b 5 and b 6 based on the relationship between arithmetic and geometric means b7 1 n i 1 n c d f ds Œ∏ t i i 1 n c d f ds Œ∏ t i n most values of c d f ds Œ∏ t i are close to 1 and they are similar to each other in most cases of flood frequency analysis for which dss are typically extreme values selected from the tales of the distribution in this case the inequality in eq b 7 can be rewritten as an approximate equation b8 1 n i 1 n c d f ds Œ∏ t i i 1 n c d f ds Œ∏ t i n using eq b 8 we can rearrange the right term of eq b 5 and it gives b9 e r t 1 t n arf i 1 n c d f ds Œ∏ t i n now we can combine eq b 9 with eq b 6 which results in the following equation b10 e r t 1 t n arf e r t 1 t n dll 1 n taking the natural log of both sides we can finally define the relationship between r t 1 t n arf and r t 1 t n dll for a given ds as follows b11 r t 1 t n arf r t 1 t n dll n we can use this relationship for the application of the se for estimating dll because we confirmed that the distribution of the se is the same as that of arf eq a 2 combining eq 2 a 1 a 2 and b 11 thus results in the following equation b12 q se i arf t 1 t n se i dll t 1 t n se i n eq b12 confirms the validity of eqs 4 and 5 presented in the main body of the paper appendix c supporting information supporting information to this article can be found online at https doi org 10 1016 j jhydrol 2020 124575 appendix c supporting information the following are the supporting information to this article supplementary data 1 
5612,in a rapidly changing environment analysis of risks associated with non stationary hydroclimatic extremes has many important implications for resilient and sustainable water resources management including the evaluation of risk for existing systems and the design of new infrastructure this study develops a new risk based analytical framework called the non stationary monte carlo nsmc to better address various problems associated with non stationarity of hydrologic extremes current approaches in the literature evaluating non stationary probability distribution functions pdfs of extremes events commonly use trend extension or multivariate analysis based on observed data which often fail to account for larger changes in the future to avoid these problems nsmc explicitly accounts for the projected changes in hydroclimatic extremes by analyzing the changing pdfs of extremes for each future year based on statistically downscaled climate projections and hydrologic simulations using monte carlo techniques nsmc generates a super ensemble se of extremes the statistics of which can be readily applied to various problems in non stationary flood frequency analysis for example we show that the estimation of design standards based on design life level dll or average risk of failure arf metrics can be reduced to a simple look up process of quantiles in the se of extremes a case study analyzing extreme high streamflow and a hypothetical levee design for the wabash basin in usa demonstrates the applicability of nsmc to real world flood risk problems furthermore this study also shows an example case of using nsmc to identify cost effective design standards for new infrastructure combining future changing risk of failure project design lifespan and present value of future replacement costs keywords non stationary hydrologic extremes non stationary monte carlo risk of failure of hydrologic infrastructure design standards for hydrologic infrastructure total expected lifecycle costs of infrastructure climate change impacts on hydrologic design 1 introduction the problem of analyzing non stationary biogeophysical systems has received increasing attention from the research community in the last decade or so ipcc 2013 milly et al 2008 sheffield and wood 2008 razavi et al 2015 wolkovich et al 2014 in particular addressing non stationarity in hydroclimatic systems has important implications for human water management infrastructure evaluation design and the assessment of ecosystem impacts poff et al 2016 quinn et al 2018 thompson et al 2013 wagener et al 2010 for example non stationarity of hydrologic extremes under a changing climate present formidable challenges to the design of sustainable water management policies robust design of hydrologic infrastructure such as river flood and sea walls urban stormwater systems etc buchanan et al 2016 mudersbach and jensen 2010 oddo et al 2017 read and vogel 2016 rosner et al 2014 vousdoukas et al 2018 wahl et al 2015 xiong et al 2015 zhang et al 2018 in many previous studies non stationary problems in frequency analysis of hydrologic extremes have been addressed using statistical approaches as reviewed by bayazit 2015 and salas et al 2018 non stationary analysis of extremes typically begins with the generation of time varying probability distribution functions pdfs of extremes and most previous studies have been based on parameter informed approaches which condition the parameters of the extreme value distribution on a time varying covariate these types of approaches are further classified into two categories one is trend informed approach which extrapolates historical trends in distribution parameters with a time covariate and applies them in future periods e g du et al 2015 razmi et al 2017 rosner et al 2014 serago and vogel 2018 although these approaches are based on observations it is questionable whether the historical trends in parameters will be preserved in the future especially when significant long term changes in climate are larger than those experienced so far in the historical record clarke 2013 luke et al 2017 serinaldi and kilsby 2015 yan et al 2017 in later sections of the paper we will show some specific examples of this problem the other approach which has been increasingly supported in the literature is a climate informed approach using large scale climate fields as covariates for deriving time varying distribution parameters of floods e g condon et al 2015 delgado et al 2012 2014 schlef et al 2018 rather than relying on a historical trends these approaches use explicit climate projections deriving from global or regional scale climate model simulations in most cases however downscaling is required because coarse grid resolution of climate models may not successfully capture fine scale variability of extremes for flood applications downscaled climate projections are typically used as inputs to hydrology models to estimate daily or hourly streamflows and the changing flood risk over time e g tohver et al 2014 byun et al 2019 although the fundamental concept of a changing pdf through time is a common element of many studies the analysis and interpretation of these changes for evaluating the risk of system failure or suggesting design standards for new infrastructure is often different in different studies for instance some are based on a representative return period which represents expected waiting time until an exceedance occurs olsen et al 1998 or expected number of exceedance within a given period cooley 2013 parey et al 2007 2010 both of these approaches however fail to consider the design lifespan of structures this is a crucial element in the design process because the risk of failure and therefore also design cost is directly related to the time that the structure must remain in place this element of the design process has been better addressed in some recent studies read and vogel 2015 rootz√©n and katz 2013 which take into account design lifespan by assessing the overall risk of failure or no failure reliability over the entire design lifespan although a number of different methods have been proposed in the literature for addressing these issues there is currently little consensus on which approach to use in practice yan et al 2017 for example compared four different approaches for analyzing non stationarity extremes but did not make specific recommendations about which approach to use furthermore many existing methods are very difficult for most professional engineers to implement in a cost effective manner which highlights the need to develop improved analytical approaches that are flexible i e capable of addressing a wide range of problems and are relatively straight forward to implement and interpret in practice hu et al 2018 rootz√©n and katz 2013 taken together the issues discussed above point to a number of desirable features that should be incorporated in the design of a new analytical framework for the analysis of non stationary extremes in the context of a changing climate 1 explicitly incorporate the changing nature of the probability distributions through time 2 avoid trend extension approaches and instead explicitly account for projected changes in future climate from downscaled climate change projections 3 incorporate design lifespan as an integral part of the analysis 4 improve flexibility ease of use and ease of interpretation this study aims to develop a new approach that incorporates these desirable features in a single approach specifically we develop a new analytical framework for the analysis of extremes based on monte carlo approaches and the concept of analyzing risk using super ensemble se statistics this new approach which we call the non stationary monte carlo nsmc approach directly and explicitly models changing pdfs of future extremes using numerical models i e hydrologic simulations driven by climate change scenarios effectively avoiding the use of trend extension by analyzing each of these unique pdfs over a specified design horizon and estimating the overall risk of a design failure we explicitly incorporate design lifespan as a central component of the analysis the approach which is straight forwardly applied to a wide range of problems can be implemented using computer resources available to most researchers and professional practitioners and is relatively easy to interpret we demonstrate this capability by applying the nsmc approach for a case study of the flood frequency analysis in the wabash river basin in the midwestern u s for which future flood risk is projected to increase substantially based on our previous analysis using numerical simulations byun et al 2019 we apply the nsmc approach to several important problems including a evaluating the risk of failure for existing infrastructure b producing design standards for new infrastructure for a specific level of risk and design lifespan and c evaluating the construction replacement cost of infrastructure as a function of risk of failure design lifespan and concepts relating to the present value of future replacement costs 2 methods 2 1 synopsis fig 1 shows a schematic diagram of the data processing and modeling steps used in the analytical framework which we will describe in order in the sections below having described the technical aspects of the analytical framework in detail we then outline a case study analyzing high flow extremes in the wabash river basin which we use to illustrate the approach also we examine some of the implications of the present value of future replacement costs and the sequential evolution of risk on these analytical problems these are followed by a brief description of evaluation of techniques by a comparison with pre existing methods please note that supporting information appendix c provides important details on the validation work and some other applications of our approach although we use specific examples to illustrate these new techniques it should be carefully noted that the central topic of this paper is the analytical framework itself which should not be confused with specific components of our example case studies such as choice of downscaling method and hydrologic model that we use to simulate future flood risk instead we demonstrate that this analytical framework can be flexibly applied to different kinds of hydrological hydrodynamic or meteorological extremes geographic regions infrastructure types climate models downscaling methods hydrologic or hydrodynamic models etc thus the choice of methods employed in our case study examples although certainly intended to be illustrative are essentially arbitrary and do not imply a loss of generality for the overall approach 2 2 data sources and hydrologic modeling 2 2 1 macro scale hydrologic model hydrologic simulations were carried out using the physically based macro scale variable infiltration capacity vic model version 4 1 2 implemented at 1 16 liang et al 1994 1996 the model has been widely used in many past climate change impacts assessment studies at a range of spatial scales chin et al 2018 hamlet et al 2013 livneh et al 2013 naz et al 2016 tohver et al 2014 vano et al 2015 the historical baseline simulation is based on observed meteorological data for the entire historical period 1915 2016 and each future simulation which has the same sample size as history is based on downscaled global climate model gcm simulation data from a 30 yr time window in the future by using simple streamflow routing model gridded daily runoff and baseflow outputs are then routed as daily streamflow to a specific outlet point of the wabash watershed usgs 03377500 at mt carmel il removing two initial years for model spin up results in 100 water years of simulated daily data 1917 2016 from which we extract 100 peak daily streamflow annual maximum daily streamflow values validation of the vic model in terms of reproducing observed variability of monthly and peak daily streamflow at a watershed for our case study the wabash river basin described in section 2 4 are given in supporting information s 1 validation of hydrologic model which shows good validation statistics and demonstrates the applicability of our hydrologic model for illustrating the concept of our framework for the non stationary flood analysis presented below 2 2 2 observed meteorological data gridded meteorological forcing data for the hydrologic model from 1915 to 2016 include daily precipitation mm maximum and minimum temperature c and wind speed m s at 1 16 latitude longitude resolution 5 7 km these data sets for the midwest region include precipitation gauge undercatch corrections chiu et al in personnel communication there are currently two different versions of this adjusted meteorological data set using different strategies for undercatch corrections this study uses version two v2 of the data set which accounts explicitly for different snow measurement techniques and shows best performance in our case study watershed more detailed information on this data set can be found in byun and hamlet 2018 2 2 3 future climate projections based on statistical downscaling for the future climate projections this study makes use of statistically downscaled gcm data as summarized in table 1 six different gcm projections from the coupled model intercomparison project phase 5 cmip5 based on the highest greenhouse gas ghg emission scenario representative concentration pathway rcp 8 5 are used these are selected based on two criteria a their performance in simulating historical climate and b ability to capture the full range of future temperature and precipitation projections from an ensemble of all available gcms over the midwest and great lakes region byun and hamlet 2018 temperature t and precipitation p simulations from each gcm are statistically downscaled by using the hybrid delta hd downscaling approach byun and hamlet 2018 hamlet et al 2013 tohver et al 2014 the hd combines observed variability from a long historical record with altered monthly statistics from gcm simulations the technique retains key advantages of both the classic delta method dm and the well known bias correction and spatial disaggregation bcsd downscaling approach wood et al 2004 important advantages of the hd for this study include a large common sample size for the historical baseline and future projections daily time series behavior derived from history in each future period and realistic representation of hydrometeorological extremes in particular having a consistently long time series associated with each future period ensures ample sample size for the analysis of extremes with long return intervals e g the 100 year flood see byun and hamlet 2018 for additional details on the downscaling approach and selected gcms projections for the midwest region to validate the hd approach and its ability to reproduce daily extremes byun and hamlet 2018 use split sample tests on the historical record to confirm that daily extremes extracted from a historical 30 year window are comparable to statistically downscaled extremes for the same period of time when the downscaling is trained on an independent period see byun and hamlet 2018 for additional details on the hd downscaling approach selected gcms projections for the midwest region and validation of extremes produced by the hd approach 2 3 non stationary monte carlo nsmc method for hydrologic extreme analysis in this section we introduce a new analytical framework for non stationary analysis of hydrologic extremes this new approach hereafter referred to as the non stationary monte carlo nsmc extends well established techniques for climate downscaling and hydrologic modeling and combines them with stochastic resampling techniques monte carlo to generate a so called super ensemble se of hydrologic extremes we then show how the statistics of this se can be used to evaluate risk of failure of existing infrastructure based on existing design standards or to estimate design standards for new infrastructure under a changing climate the first two subsections 2 3 1 and 2 3 2 describe the fundamental steps in the nsmc framework and the last subsection 2 3 3 describes several applications of the technique for the analysis of extremes as a concrete case study we analyze a hypothetical flood protection levee in the wabash river basin using traditional methods stationary statistics non stationary techniques based on trend extension approaches and the new nsmc framework developed in this paper 2 3 1 deriving time varying cumulative distribution functions cdfs of hydrologic extremes as shown in fig 2 a the nsmc technique includes downscaling of gcm data modeling of extreme streamflow by hydrologic simulation and fitting of the parameters of probability distribution to estimate the cdf and inverse cdf of daily peak streamflow to characterize the changing statistics through time we duplicate this process for a 30 yr window centered on each individual year t i during the design lifespan dl of structure specifically the nsmc generates 100 hydrologic extremes see discussion of hd downscaling technique above associated with a 30 yr window centered on each year of a specified future design lifespan represented by t i in fig 2a these simulated extreme values are then used to generate a unique cdf of extreme high flows for each future year in the design lifespan for example the cdf for future year 2035 is generated using the 100 peak flow values associated with a 30 year window from 2020 to 2049 note also that for some future years in the early part of the design lifespan the 30 year window also includes some historical years for example the year 2017 is associated with the 30 year window 2002 2031 although any start year can be used in practice for consistency in subsequent discussion we will assume 2016 is the current year of the analysis and 2017 is the first year of the proposed design lifespan there are two main reasons behind the use of moving 30 yr window centered on each year firstly our statistical downscaling method does not use daily scale gcm information instead it incorporates the changes in monthly scale distributions which are then used to rescale observed daily values and extremes thus the approach avoids shortcomings of daily climate simulation e g sequence or frequency of occurrence of events secondly despite the independent generation of downscaled data to fit a probability distribution for each year moving 30 year windows centered on individual year share lots of overlapped information between adjacent years thus it prevents unrealistic radical shifts in the probability distributions in a short period of time although we acknowledge that a different length of time window could be chosen for this kind of analysis we have found in past studies that 30 year windows provide adequate sample size for the hd approach byun et al 2019 hamlet et al 2013 tohver et al 2014 while also providing reasonable specificity i e not too much temporal smoothing for each year in the design lifespan that is choosing shorter windows would create problems with inadequate sample size in the statistical downscaling whereas longer windows reduce specificity of the results for each year in the dl and increase the number of overlapping years between adjacent time windows thus the rate of change in the probability distributions is reduced for longer time windows also it should be noted that gcm projections are only available up until 2100 thus longer time windows would effectively reduce the maximum design lifespans that can be considered lastly 30 year windows are a common time scale used in calculating climate statistics which further informs our choice of this window size it is important to note that the special features of the hd statistical downscaling technique serve two distinct purposes here by a converting monthly gcm values for a given 30 year window into realistic daily values including extremes and b extending the sample size to 100 years which reduces uncertainty in fitting probability distributions to the simulated extremes although we argue that the hd has some specific advantages for this application in practice any downscaling technique that produces a transient simulation of daily values could be substituted in the nsmc process thus there is no loss of generality in using the hd to explore the effectiveness of these methods downscaled gcm projections are used as inputs to the hydrologic model to generate a set of extreme streamflow events associated with a 30 yr window centered on a year in the dl to fit a probability distribution to the 100 extreme streamflow values for each year in the dl this study uses the generalized extreme value gev distribution which has a set Œ∏ t i of three parameters including location Œæ t i scale œÉ t i and shape Œ∫ t i for a given parameter set Œ∏ t i the cdf of the gev distribution can be written as follows hosking and wallis 2005 1 cdf t i x e x p 1 Œ∫ t i x Œæ t i œÉ t i 1 Œ∫ t i Œ∫ t i 0 i 1 2 n where t i represents an arbitrary year in the dl starting with t 1 2017 where t i represents an arbitrary year in the dl starting with t 1 2017 this study estimates the three parameters of gev based on l moment methods hosking and wallis 2005 for each individual year in a proposed future design lifespan our approach is similar in concept to that proposed by bender et al 2014 who applied l moment fitting techniques for a moving historical window but the key difference is that rather than analyzing windows in the historical record and then applying trend extension techniques to individual parameters our method explicitly parameterizes the gev distribution for future periods based on transient climate change projections validation of the performance of the nsmc approach in generating time varying cdfs of peak daily streamflow are presented in supporting information s 2 validation of cdfs of downscaled peak streamflow using the hybrid delta basically we use a split window test in the same way as byun and hamlet 2018 for independently generating downscaled data for 30 yr validation window 1987 2016 by using fine scale observed data in training period 1916 1986 then a cdf from hydrologic simulation based on this downscaled data is compared with that from original hydrologic simulation extracted for the validation period the result in fig s 2 shows that the nsmc successfully reproduces the cdf of the extreme values from first principles please see supporting information s 2 for further details on this validation work 2 3 2 monte carlo techniques for generating a super ensemble se of extreme values the result of the previous steps in the data processing sequence is a unique gev parameter set and cdf for each future year in the design lifespan the next step is to create a mixture matrix of extremes which includes all the information from each future design year s cdf using monte carlo mc techniques with a large number of realizations k 10 000 samples specifically we randomly sample percentiles p i from the uniform distribution u 0 1 and then use the inverse cdf cdf 1 for a year in the dl to calculate each extreme value x fig 2b extending this procedure for all years in the dl n and repeating this with a large number of realization k we create a se of extreme values which has dimension of n k using this procedure we effectively analyze multiple cdfs over time in a collective manner the se reflects a mixture of distributions through time which characterize both the non stationarity and randomness of occurrence of extremes we show some different applications of the se in analyzing extremes in the next subsection it should be also noted that our choice of 10 000 realizations k was made based on our preceding analysis which showed that convergence of mc simulation occurred when the number of monte carlo samples was greater than 5 000 to provide a margin of safety we increased the sample size to 10 000 2 3 3 application of the super ensemble se 2 3 3 1 analyzing the risk of failure of infrastructure over the design lifespan in this first application we evaluate the risk of failure of infrastructure over some arbitrary design lifespan based on a particular design standard for this we use the concept of a design life level dll proposed by rootz√©n and katz 2013 and salas and obeysekera 2014 although discussed in these recent papers dll is based on classical concepts of risk or reliability introduced by several introductory hydrology text books bras 1990 chow 1964 and it evaluates risk r t 1 t n dll over a specified dl n t n t 1 1 for a given design standard ds which explicitly represents the probability of occurrence of one or more extremes that exceed the design standard of the infrastructure during its lifespan dll for the non stationary case can be written rootz√©n and katz 2013 salas and obeysekera 2014 2 dll t 1 t n d s r t 1 t n dll 1 i 1 n 1 q t i 1 i 1 n c d f ds Œ∏ t i where q t i is the probability of exceedance of a fixed ds for each year in the dl t i note also that dll for the stationary case is easily constructed by specifying a constant value of q t i through time based on the ds of interest first of all we note that for this application q t i can be analytically estimated using eq 1 for each year in the design lifespan alternately we can use the se to count fig 2b the number elements that are equal to or greater than the ds and estimate the probability of failure by dividing by the total number of realizations k this can be done for a single year in the design lifespan or alternately can be applied to the entire se to produce a summary statistic reflecting the overall probability of failure for the entire design lifespan we show in the appendix a that having specified a ds the associated probability of exceedance value extracted from the se is equivalent to the so called average risk of failure arf and a similar approach can be used to estimate dll based on a simple scaling relationship between arf and dll this process can also be inverted having specified a value of risk based on arf or dll an estimate of ds can easily be obtained from the se by looking up the appropriate quantile the nsmc approach is also useful for analyzing the sequence of risk over time which is particularly important information for evaluating the economic impacts of future design failures these economic impacts are investigated in this study based on the present value of future replacement costs described in section 2 3 3 3 below 2 3 3 2 estimating non stationary design standards for infrastructure using dll in this application given a design lifespan and a changing risk structure through time i e a unique cdf for extreme values for each future design year we wish to calculate a ds i e a particular extreme value that will result in a specified overall risk of failure r t 1 t n dll during the design lifespan that is given an overall risk of failure over the design lifespan we wish to invert eq 2 to calculate a ds we were unable to analytically solve for ds in closed form because eq 2 expresses the overall risk of failure as a product of the unique probability of non exceedance for each year in the design lifespan however this problem can be straight forwardly solved numerically by using an iterative approach that is an initial guess of the ds can be used to calculate q t i for each year in the design lifespan and an associated value of r t 1 t n dll which is compared to a target value based on the error in r t 1 t n dll an updated estimate of the ds is produced this process is repeated until the error in r t 1 t n dll is acceptable an alternative approach which may be more convenient or intuitive is to solve for the ds using the se generated by the nsmc process this alternate approach is advantageous because it can substantially simplify the search process for the non stationary ds into a simple lookup from an ordered list this is accomplished by relating a specific probability of exceedance within the se to a certain level of risk of failure i e r t 1 t n dll in the alternative approach we begin by ranking all elements of the se from largest to smallest and then fitting an unbiased quantile estimator eq 3 cunnane 1989 to the ranked data set as follows 3 f se i q se i i 0 4 n 0 2 where i is the rank position of each se member and n is the total number of elements of the se using this intermediate product we can then estimate the probability of exceedance q se i for any individual member of the se se i we found in investigating this quantity that q se i is essentially equal to dll t 1 t n se i divided by the dl n that is 4 q se i dll t 1 t n se i n thus by setting dll t 1 t n se i equal to the desired target value r t 1 t n dll and applying eq 4 we reduce the process of finding an appropriate ds to a simple lookup from an ordered list that is 5 ds dll t 1 t n 1 r t 1 t n dll f 1 r t 1 t n dll n where the function f is the cdf constructed from the se appendix a and b derives and validates eqs 4 and 5 to give a concrete example of this procedure if a ds needs to be calculated according to a specified 10 risk of failure over a 50 yr lifespan i e r 2017 2066 dll 0 1 we can simply find the unique se i that has the probability of exceedance of 0 002 q se i 0 1 50 or non exceedance probability of 0 998 99 8th percentile it is straight forward to validate this approach by comparing the se value of ds to the value of the ds obtained by the iterative approach described above see section 3 2 2 below 2 3 3 3 estimating total expected lifecycle costs of infrastructure as mentioned in 2 3 3 1 accounting for the dl of infrastructure in a risk based analysis is one of the most important elements botto et al 2014 qi 2017 moreover given that the design of infrastructure is often constrained by available financial resources coupling economic factors with risk based assessments is imperative in particular in the case where risks are increasing through time minimizing risk of failure over the dl may not be equivalent to minimizing total expected lifecycle costs telc this is because failures become increasingly likely at the end of the dl in an increasing risk sequence while the present value costs of replacing infrastructure due to potential failure typically decline through time thus it may actually be more cost effective to underdesign for future conditions rather than attempt to minimize the risk of failure by making the original design more robust to quantify the tradeoffs between a choice of ds and associated construction costs and telc we use the se produced by nsmc to evaluate the sequential risk of failure over the dl and the expected costs of initial construction and potential future replacement costs to quantify the telc for a given dl we first choose a ds which directly determines initial and future infrastructure construction costs ic d s the evolving risk structure through time i e a set of q t i for the entire dl note that ds also determines r t 1 t n dll as discussed above since the present value of money at any future time typically decreases with time from the present the present cost to reconstruct infrastructure at some point in the future will also generally decrease with time to account for this we use the concept of present value pv of money which represents the present value of the future unit cost 1 as shown in eq 6 6 pv i 1 1 c i 1 i 1 2 n where i is the number of compounding years from a reference starting year t 1 2017 and c is defined as the real rate of return which accounts for annual percentage realized on an investment adjusted by other external effects such as increased cost of construction due to inflation etc for our purpose pv is the amount of money that should be invested at an assumed rate of return c to meet a unit cost 1 for reconstruction in t i 1 year of the future for simplicity it is also assumed that the cost to rebuild the infrastructure in year t i 1 will be the same as that of initial construction cost that is the design standard is not adjusted when the infrastructure is rebuilt we note that c in eq 6 can be adjusted to reflect changing real costs through time so there is no loss of generality in this simplifying assumption finally we can evaluate the telc of the infrastructure design by combining the initial cost on construction with the probability weighted average of the cost of replacement over the dl eq 7 7 t e l c d s d l i c d s i c d s i 1 dl q t i pv i i c d s where telc a function of ds dl and ic ds is the total expected lifecycle cost in present dollars ic ds is the cost of infrastructure construction a function of ds q t i is the probability of infrastructure failure for each future year a function of ds and the changes in hydrologic extremes and pv i is the present value of a future expenditure of 1 in year i of the dl so the infrastructure is initially built at the beginning of 2017 at a cost of ic ds the infrastructure can potentially fail in any future year including the first year 2017 and the total risk of failure in each future year is given by q t i over each future year the present value of money is given by pv i the summation term of right hand side of eq 7 can be defined as the expected replacement cost erc in present dollars our objective in this section of the paper is not to present a sophisticated application for designing specific kinds of water infrastructure but rather to explore the tradeoff between risks of failure of infrastructure and associated costs in an explicit manner thus in order to model ic ds in a way that accounts for construction costs directly associated with the geometry of infrastructure as a function of the ds this study uses a simple idealized conceptual channel with a single levee fig s3 as similarly illustrated in hui et al 2016 we describe the derivation of ic ds for this case in supporting information see s 3 derivation of the cost of single sided levee construction as a function of streamflow design standard ic ds which specifies ic ds for a single levee with unit length 1 m along the river bank as follows 8 i c d s 53 3 0 55 ds 0 36 9 92 2 0 55 ds 0 36 9 92 2 using eq 8 simplifies telc in eq 7 which then solely depends on ds and dl 2 4 overview of the wabash river basin case study our case study focuses on the wabash river watershed basin area 74160 km2 in indiana illinois and ohio in the united states u s fig 3 we selected the wabash watershed in part because it is in the hydro climatic data network hcdn defined by u s geological survey usgs slack and landwehr 1992 which implies minimal human influence on flows byun et al 2019 also showed a strong signal of intensifying flood risk in the wabash watershed in the future hydrologic simulations based on downscaled gcm projections which further informs our choice of this watershed as a case study for non stationary flood frequency analysis this study analyzes observed daily streamflow data collected from a usgs gage station at carmel illinois usgs 03377500 and simulated streamflow data from the vic hydrologic model the streamflow gauging location and contributing basin area for the wabash are shown in fig 3 2 5 intercomparison of nsmc results with stationary and existing non stationary techniques to compare with the results by nsmc we also use two different baseline methods for generating the future cdfs for each year in the dl one is the stationary case for which we assume that all of the cdfs for future years are identical and derived from hydrologic simulations of the historical baseline period 1917 2016 this method is a common approach that fits a set of distribution parameters to historically observed or simulated historical extremes for a retrospective time period the other case is a non stationary case which considers a linear trend in the gev location parameter with time i e Œæ t i Œ≤ 0 Œ≤ 1 t i while the other two gev parameters œÉ 0 a n d Œ∫ 0 are held fixed although there are several variants used in different studies this is the overall approach used in current non stationary flood frequency analyses in the literature hereafter we refer to this method as the non stationary linear trend nslt approach applying a maximum likelihood estimation mle for the historical simulation in the wabash river case study described above yields the following estimates of these parameters coles 2001 cooley 2009 katz et al 2002 Œ≤ 0 2 57 1 32 10 4 Œ≤ 1 14 8 6 71 œÉ 0 1 55 0 13 10 3 a n d Œ∫ 0 0 038 0 08 stationary and nslt future cdfs are then applied using eqs 2 and 5 to evaluate dll or estimate ds finally we compare the results with those based on nsmc 3 results and discussions 3 1 intercomparison of time varying distribution of extremes from nsmc stationary and nslt approaches in this section using the wabash river case study for illustration we compare the time varying probability distribution of daily peak streamflow produced by nsmc with those from the stationary case for a historical baseline period 1917 2016 and nslt approach discussed above based on differently derived time varying distribution fig 4 a shows snapshots of pdfs of daily peak streamflow for four different future years showing how the pdf of extremes for each method shifts over time as shown in the result for early future periods i e 2020 the pdf based on the nsmc method is a fairly close match with the stationary distribution derived from a historical baseline period note however that there are some minor changes in the pdf which are mostly associated with climate change signal between the historical baseline period 1917 2016 and the 30 yr window for 2020 2005 2034 however the pdf by nslt is very different from the stationary distribution for this early future period which demonstrates that there are some substantial problems in estimating all three parameters assuming a simple linear trend in the location parameter both non stationary approaches nsmc and nslt produce shifting pdfs towards increasing extremes over time however more substantial shifts are shown by nsmc at later periods which is mostly associated with the strong climate change signal in downscaled projections at the end of 21st century we also found that changes in the pdfs estimated using the nsmc method were not monotonic instead they show small variations back and forth between some adjacent future years these variations from year to year are probably more realistic than the strictly monotonic increases modeled by the nslt approach fig 4b shows 100 yr reoccurrence peak daily streamflow over time for each approach as in fig 4a discussed above the difference between the historical baseline stationary case and nsmc shown at initial future year is mainly due to different evaluation periods for each method i e a historical baseline period 1917 2016 versus a 30 yr window 2002 2031 centered on 2017 most importantly 100 yr extremes derived using the nsmc approach are much greater than the other two approaches especially in later years of the future period this substantial difference in extremes is because the shift of the probability distribution of future extremes from gcm based modeling experiments is much larger for the later periods although future uncertainties in gcm projections are acknowledged especially in light of ghg concentration uncertainties it is important to note that gcm based trajectories are generally nonlinear especially for high end scenarios like rcp8 5 thus it is difficult to argue that trend extension is a reasonable approach over the long time horizons we consider here gcm projections also represent the best available science and this informs our decision to use these projections as the basis for our case study this substantial difference in extremes illustrates some critical issues associated with the nslt approach for example nslt underestimates extreme events at early periods until about the 2040s when compared to the stationary case these artifacts of the nslt approach relate to the questionable assumption of a linear trend in the location parameter this implies that trend analysis only focusing on the location parameter may not be able to properly characterize the changing nature of tails in future years most importantly the nslt approach that assumes a constant trend over time cannot capture the relatively large changes in extremes as shown in latter periods fig 4b this is especially true in this particular case study for which the projected impacts of climate change on flooding are substantial 3 2 application of the nsmc se of extremes to quantify risk of failure and choose design standards 3 2 1 quantifying risk of failure of infrastructure over its lifespan using dll fig 5 shows the risk of failure dll of infrastructure i e a levee or flood wall in our case over varying dl calculated using eq 2 regardless of approach used to construct the time varying cdfs dll increases as the dl of the structure increases note also that dll will systematically increase if the ds is lowered however the dll calculated using the time varying cdfs of nsmc is substantially greater than the results from the other two approaches especially for the cases with greater initial design level e g compare fig 5a and d this result highlights the systematic errors that are introduced when we evaluate the performance of infrastructure based on stationary assumptions or historical linear trends when future flood risks continue to grow through time that is the difference between nsmc and stationary nslt approaches intensifies as the ds increases and the risk of failure declines the level of risk used in establishing a test ds has a substantial effect on the relationship between stationary and nslt results for a relatively low level of ds fig 5a and 5b risk of failure evaluated by the nslt approach is greater than the stationary case however this relationship is reversed by considering high design standard cases fig 5c and 5d this result is likely due to characteristic underestimation of high quantiles by the nslt approach fig 4b 3 2 2 design standards for infrastructure based on dll design standards for infrastructure based on the dll metric are calculated according to different combinations of given risk of failure and lifespan as discussed in section 2 3 3 2 for nsmc we compared two methods of calculating the ds a numerically solving for the ds using a non linear solver and eq 2 and b directly looking up the ds from an ordered list constructed from the se based on the quantile identified using eq 4 fig 6 compares the two approaches which closely agree results for other gcm projections not shown were similar which further demonstrates the validity of the mathematical derivation of eqs 4 and 5 presented in appendix a and b this strong agreement is preserved for the lower risk of failure less than 20 as shown in fig 6 however it should also be noted that discrepancy between the results by numerical solution and those by looking up from the se grows with greater risk of failure for example looking up method of the se for 50 of risk of failure for 70 years of dl i e r 2017 2066 dll 0 5 results in about 7 overestimation than numerical solution this is because the approximation of eq 4 and eq b 12 more likely holds true for the tail of the distribution nonetheless this approximation works reasonably well in general given that in many cases flood frequency analysis focuses on the tail of the distribution and thus a relatively low risk of failure for infrastructure also the discrepancy between the two methods for a higher risk of failure is probably acceptable for many practical uses where more accuracy is required however the numerical solution may be preferred over the se lookup procedure when considering a high risk of failure fig 7 shows ds as a function of different levels of risk of failure dll and dl note that the ds increases for a given risk of failure as we extend the dl of structure however the change of ds is non linear with respect to both dll and dl as shown in fig 7a for example changes in design standard with lifespan longer than 50 years are more substantial which is likely due to more significant projected changes in climate and flood risk at later periods in this region of the u s byun et al 2019 byun and hamlet 2018 as expected based on results from the previous section ds values estimated by nsmc are much higher than either the stationary or nslt approaches fig 7 for example if we compare design standards with a dl of 70 years the ensemble mean of nsmc ds based on different gcms is almost as twice much as the ds estimated by the other two approaches see fig 7a 3 2 3 total estimated lifecycle costs over the design lifespan in order to combine non stationary risk assessments with a simple economic analysis of the total expected lifecycle costs telc we first evaluate the sequential risk of failure over time in a changing climate fig 8 a shows an example case of the sequential risk of failure for infrastructure with a dl of 70 years and a ds selected so that dll 10 using the se analysis presented in section 3 2 2 in the first several decades the risk of failure for this ds in an individual year does not substantially change despite some variation from year to year however as time goes on it starts to shift more substantially and the risk of failure is greatest at the end of the dl for example the risk of failure at the end of the dl is almost five times as great as that in the initial years fig 8b illustrates the present value of 1 in each future year which accounts for changing value of money as the real rate of return which we assume includes the effects of interest rates inflation and the changing cost of infrastructure over time we can clearly see the exponential relationship between future year and present value thus there will be dramatic changes according to different rates of return likewise positive and negative rates of return behave quite differently telc in eq 7 combines the changing risk with the changing value of money as a function of infrastructure construction ic and expected reconstruction costs erc eq 7 fig 9 shows the expected costs in present dollars as a function of dll for an assumed dl of 70 years fig 9a shows the results for a positive rate of return while the fig 9b shows the results for a negative rate of return for positive rate of return telc generally decreases with lower ds and higher dll because ic rather than erc dominates the estimate of telc this is an interesting result demonstrating that initial construction cost will likely override expected future replacement costs despite significant increases in risk projected for the future fig 8a on the other hand for the negative rate of return fig 9b erc becomes more significant since sequential risk over dl and present value of the money in erc are in the same direction i e greater risk and present value through time erc predominately intensifies over time in such a way that its increasing rate overrides decreasing rate of ic minimum telc in this case occurs at about 10 risk of failure this is a good example that highlights the effects of a worst case scenario when increasing flood risks and negative economic factors are coupled together in the future the analysis shows that lowest costs for positive rates of return are associated with underdesigning for the future because for positive rates of return the present value of money reduces future costs it is important to note however that other economic and societal losses when infrastructure fails should also be considered in actual applications fig 9a shows that for positive return rates telc decreases rapidly until dll approaches about 10 after which telc is relatively constant with increasing risk fig 9b also shows a minimum cost at about dll 10 this suggests that this level of risk of failure might be a robust choice from an economic perspective while also protecting against unacceptably frequent infrastructure failures property damage loss of life or other impacts by comparison designing for the 100 year flood using stationary statistics has a risk of one or more failures of about 50 for a dl of 70 years fig 5c thus dll 10 represents a very conservative design standard in the context of current societal norms in the u s it is also worth noting that even for the positive rate of return fig 9a adding a higher margin of safety may not dramatically increase costs for example the difference in telc for a 50 risk of failure is only 14 2 lower than the telc for a 20 risk of failure aside from the cost effective perspective however it should also be noted that overdesigning infrastructure may result in negative environmental impacts for instance overdesigned earthen levees which have a much larger footprint would likely adversely impact riparian habitat and ecosystems dramatically increasing levee size in upstream areas can also result in increasing flood risk and sediment transport to downstream locations oversizing flood control reservoirs and spillways would likewise have adverse environmental impacts thus tradeoffs between telc risk of infrastructure failure property damange and loss of life and environmental impacts should be considered in design decisions 4 conclusions this study presents a new analytical framework nsmc that can be used for non stationary frequency analysis of hydrologic extremes under a changing climate nsmc has several important advantages 1 nsmc generates explicit time varying cdfs of extremes for each future year by fitting the parameters of the gev probability distribution to hydrologic simulations based on downscaled gcm data 2 time varying cdfs based explicitly on gcm projections are shown in our case study to be substantially different from those based on stationary assumptions or historical trends in distribution parameters nslt both of which show significant under estimation of risks in the latter part of the 21st century similarly estimating ds for new infrastructure using historical records alone stationary or nslt is expected to underpredict the appropriate ds for a given level of risk in cases where flood risk is projected to shift substantially towards higher values in the future 3 the se of extremes produced by nsmc can be used to analyze the non stationary risk of extremes in a straight forward manner the approach is both flexible and versatile and can be successfully applied to any probability distribution of interest for example we can readily use the se of extremes produced by nsmc combined with a simple look up process to select new ds or analyze the changing risk of failure over time 4 we also developed a straight forward procedure for calculating the total expected lifecycle costs telc of infrastructure by combining the risk of failure from nsmc for each future year with estimates of the changing present value of future investments through time this approach allows us to explicitly explore the tradeoffs between telc and overall risk of failure r t 1 t n dll in a very direct manner although it is clear that conventional methods relying on historically observed data e g the nslt approach will not always result in erroneous outcomes we show that analysis based on historical trends may not be able to capture systematic changes in extremes under substantial changes projected for later periods in the 21st century this is simply because the changes that have been experienced so far that determine the observed trends are relatively small in comparison with projected long term changes thus in the context of infrastructure with long dl we show that use of future projections is an essential component of the analysis providing better insights into the non stationary statistics of extremes nonetheless it should be noted that the uncertainty in gcm projections can be considerable and should be taken into account as we do here relatively coarse resolution gcms may also fail to account properly for small scale convective processes e g thunderstorms in summer and thus more physically based regional climate models should also be used if our target extremes are related to small scale storms e g in the case of urban stormwater management although we have focused here on the use of the nsmc approach to analyze extreme high streamflow in rivers the approach can embrace various types of extremes analysis in a straight forward manner for example extreme low streamflow can be analyzed by considering probability of non exceedance as risks of failure similarly a storm surge model can replace the hydrologic model used in this study in order to generate extreme storm surge estimates needed for designing coastal infrastructure furthermore regardless of methods or probability distributions used for constructing time varying cdfs one can generate the se of extremes by our non stationary monte carlo approach fig 2b for example the nslt approach also can be used to construct a se of extremes the approach developed in this paper provides a broad framework for the analysis of non stationary hydrologic extremes in cases where flood risk is projected to increase over time the use of these new techniques is expected to result in the design of more robust infrastructure and possibly also more cost effective design practice with the analysis of the telc needed to cope with non stationary hydrologic extremes under a changing environment while acknowledging that gcm based hydrologic projections may incorrectly characterize changing flood risks in some cases our approach provides a clearly defined way to increase the robustness of infrastructure based on the best available science while avoiding trend analysis arbitrary increases in the factor of safety such as designing to the 500 yr flood or other approaches that are likely to lead to inadvertent underdesign or overdesign of infrastructure in cases where flood risks are declining over time more cost effective infrastructure can potentially be designed for a given level of risk future research should include more extended applications of nsmc for different contexts as discussed above also more sophisticated analysis coupling risk of failure and cost of specific infrastructure types should be explored in support of practical applications other refinements are also possible for example it may be possible to incorporate additional information obtained in the beginning of the dl into redesigning replacement infrastructure that fails at some point in the future or even anticipate failures before they happen based on ongoing monitoring and evolving future projections in cases where the science behind future projections is rapidly evolving e g in the case of sea level rise projections updates during the dl of infrastructure may be especially important thus past failures or projected high risk of future failure can motivate improvements in existing designs or more intense monitoring protocols combining these approaches with flexible infrastructure designs that can be upgraded through time may provide effective ways to deal with uncertainties in long term future projections declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research in this paper was supported by the department of civil and environmental engineering and earth sciences and the environmental change initiative at the university of notre dame appendix a relationship between the se statistics and average risk of failure the basic concept of an annual average reliability aar was introduced by read and vogel 2015 as a measure of performance associated with a particular design standard ds over a specified design lifespan dl yan et al 2017 made use of this metric and concept to express average reliability as a function of ds and dl which they call average design life level adll see eq 9 in yan et al 2017 adll is written in terms of reliability but we extend this concept to write an expression for the average probability of failure as a function of a particular ds over a specified dl n which we call the average risk of failure arf arf can be written as follows a1 arf t 1 t n d s r t 1 t n arf 1 1 n i 1 n 1 q t i 1 1 n i 1 n c d f ds Œ∏ t i note that the expression 1 n i 1 n 1 q t i is simply the adll and therefore arf t 1 t n d s 1 adll t 1 t n d s in eq a 1 the arf represents the annual average of risk of failure over the design lifespan r t 1 t n arf associated with a particular ds thus arf as a function of ds and dl is a mixture of time varying probabilities of failure which are averaged with equal weight for each year we now show that arf can be related to the probability of exceedance values from the entire super ensemble se generated by monte carlo analysis the probability distribution of the se is determined by a mixture of elements uniformly extracted from a set of time varying cdfs because the sample size extracted from each yearly distribution is identical the elements of the se are equally influenced by each year s distribution thus we argue that the probability of exceedance q se i associated with a given value se i extracted from the se should be approximately the same as the averaged probability of exceedance from multiple cdfs over the dl that is the probability of exceedance q se i should be approximately equivalent to a r f se i a2 q se i arf t 1 t n se i to demonstrate the validity of eq a 2 first we calculate the average risk of failure during the design lifespan arf t 1 t n se i for each individual member of the se se i using eq a 1 then we also generate the probability exceedance q se i for each se i by ranking all elements of the se from largest to smallest and fitting an unbiased quantile estimator eq 3 cunnane 1989 finally we compare each pair of q se i and the corresponding value of arf t 1 t n se i fig a1 shows the results based on the comparison between calculated q se i and arf t 1 t n se i and suggests that there is a very strong relationship between two results specifically the probability of exceedance of individual member of the se is almost identical with the results of r t 1 t n arf using eq a 1 although fig a1 represents some specific cases of lifespans and data from specific gcm projections we found that other cases show essentially the same results as shown in this figure thus we can conclude that the statistical distribution of the se is approximately identical with that of arf and it also confirms the validity of eq a 2 this also suggests that we can directly apply the se from nsmc for arf to estimate ds for any given r t 1 t n arf using eq a 2 reduces the inverse forms of eq a 1 to a simple look up process as following a3 ds arf t 1 t n 1 r t 1 t n arf f 1 r t 1 t n arf where f 1 is inverse cunnane formula eq 3 to find ds at the plotting position of q se to illustrate the lookup process if we need to calculate a ds for a 1 level of averaged risk of failure over its 50 yr lifespan r 2017 2066 arf 0 01 we can simply find the quantile of se that has the probability of exceedance of 0 01 q se 0 01 or non exceedance probability of 0 99 99th percentile we also show the application of the se for selecting appropriate ds using arf in the supporting information appendix b statistical relationship between arf and dll having confirmed that the statistical distributions of the se and arf are very close to each other we need to explore the statistical relationship between arf and dll so that we can also apply the se from nsmc to estimate dll or provide an appropriate ds with a specified value of dll yan et al 2017 showed the mathematical relationship between adll 1 a r f and dll based on the representative return period concept see eq 15 in yan et al 2017 however the lack of detailed mathematical derivation may impede an understanding of the relationship between the two different concepts thus here we derive the relationship between arf and dll and then use this relationship to relate the statistics of the se to dll to relate two different risk of failures from arf and dll r t 1 t n arf and r t 1 t n dll respectively for the same level of ds first we can rearrange equations for arf and dll eqs a 1 and 2 respectively as following b1 1 r t 1 t n arf 1 n i 1 n c d f ds Œ∏ t i b2 1 r t 1 t n dll i 1 n c d f ds Œ∏ t i then we apply a taylor expansion series for the left terms in eq b1 and b2 as following b3 e r t 1 t n arf 1 r t 1 t n arf 1 2 r t 1 t n arf 2 1 6 r t 1 t n arf 3 1 24 r t 1 t n arf 4 b4 e r t 1 t n dll 1 r t 1 t n dll 1 2 r t 1 t n dll 2 1 6 r t 1 t n dll 3 1 24 r t 1 t n dll 4 since r t 1 t n arf and r t 1 t n dll are less than 1 usually small in flood frequency analysis we would expect higher order terms following the first order in eq b 3 and b 4 to be relatively small neglecting these higher order terms leaves only an exponential term in the left hand sides of eq b 1 and b 2 as follows b5 e r t 1 t n arf 1 n i 1 n c d f ds Œ∏ t i b6 e r t 1 t n dll i 1 n c d f ds Œ∏ t i also we can compare the right hand side terms in eq b 5 and b 6 based on the relationship between arithmetic and geometric means b7 1 n i 1 n c d f ds Œ∏ t i i 1 n c d f ds Œ∏ t i n most values of c d f ds Œ∏ t i are close to 1 and they are similar to each other in most cases of flood frequency analysis for which dss are typically extreme values selected from the tales of the distribution in this case the inequality in eq b 7 can be rewritten as an approximate equation b8 1 n i 1 n c d f ds Œ∏ t i i 1 n c d f ds Œ∏ t i n using eq b 8 we can rearrange the right term of eq b 5 and it gives b9 e r t 1 t n arf i 1 n c d f ds Œ∏ t i n now we can combine eq b 9 with eq b 6 which results in the following equation b10 e r t 1 t n arf e r t 1 t n dll 1 n taking the natural log of both sides we can finally define the relationship between r t 1 t n arf and r t 1 t n dll for a given ds as follows b11 r t 1 t n arf r t 1 t n dll n we can use this relationship for the application of the se for estimating dll because we confirmed that the distribution of the se is the same as that of arf eq a 2 combining eq 2 a 1 a 2 and b 11 thus results in the following equation b12 q se i arf t 1 t n se i dll t 1 t n se i n eq b12 confirms the validity of eqs 4 and 5 presented in the main body of the paper appendix c supporting information supporting information to this article can be found online at https doi org 10 1016 j jhydrol 2020 124575 appendix c supporting information the following are the supporting information to this article supplementary data 1 
5613,rainfall runoff simulations are increasingly being performed with physically based and spatially distributed solvers the current computational and numerical technology enables the use of full shallow water equations solvers to be applied for these type of flow problems nonetheless zero inertia diffusive wave solvers have been historically favoured due to their conceptual and mathematical simplicity in comparison to shallow water solvers with the working assumption that the simplifications introduced by zero inertia will have some assumable impact on accuracy but will also allow for computational efficiency since both types of solvers have been primarily developed benchmarked and compared to each other for fluvial and floodplain simulations it is relevant to assess t he relative performance for rainfall runoff problems in this work both solvers are applied to a set of six well known test cases with reference solutions the performance of the solvers is assessed in terms of global signatures such as hydrographs and flooded areas but also in terms of spatial distributions of depth and velocity as well as computational cost furthermore the comparisons are performed across different spatial resolutions the results show that for rainfall runoff problems explicit finite volumes solvers for both equations provide a similar accuracy but the shallow water solver requires less computational time the zero inertia solver was found to be less sensitive to mesh refining than the full shallow water solver keywords surface runoff runoff generation pluvial flooding zero inertia equation shallow water equations diffusive wave equation 1 introduction overland flow generated by rainfall events is a key process in hydrology in the classical hydrological approach at a catchment scale runoff is obtained by transforming the precipitation signal through a number of processes finally resulting in a hydrograph a runoff signal this approach is typically lumped or spatially semi distributed and often based on simplified non physical equations it is arguable that to better understand and predict the complex phenomena in rainfall generated runoff spatially distributed and physically based models are necessary costabile et al 2013 costabile et al 2015 paniconi and putti 2015 thompson et al 2010 thompson et al 2011 in such way the underlying range of physical processes their interaction with spatial heterogeneity of topography soil and land use and the multiscale nature of them are explicitly represented and solved for in the model the physically based simulation of spatially distributed and time dependent surface flow processes in the hydrological context has been often addressed with different levels of simplification or lack thereof of the shallow water equations swe one of the extended approaches is to model surface flow process with the zero inertia zi equation often inaccurately termed diffusive wave equation yen and tsai 2001 a non linear diffusion equation based on the assumption that the flow is driven by the gradient of the water surface and friction only i e neglecting all inertial forces the full range of formulations proposed and used ranging from complex to simple as concisely summarised by aric√≤ and nasello 2018 and including alternative namings is the full swe full dynamic wave local inertia inertial zero convective inertia simplified inertial gravity wave zi diffusive wave and kinematic wave the latter is widely used in hydrology due to its extreme simplicity but has been shown to be inapplicable for complex hydrological modelling bout and jetten 2018 the 2d zi equation has been favoured for this purpose as a good trade off between accuracy and applicability zi has been extensively reported caviedes voulli√®me et al 2018 in flood modelling literature e g aric√≤ et al 2011 2018 2000 2017 2012 2005 2014 2016 2011 and rainfall runoff simulation aric√≤ and nasello 2018 cea et al 2010 feng and molz 1997 fern√°ndez pato and garc√≠a navarro 2016 hsu et al 2000 jahanbazi et al 2017 mendicino et al 2015 savant et al 2019 su et al 2017 weill et al 2009 conceptually the most rigorous approach to rainfall runoff simulation from the physical and mathematical perspectives is to solve the 2d shallow water equations swe the application of swe coupled with infiltration laws solved by means of explicit finite volume fv schemes to rainfall runoff simulation is a growing trend aric√≤ and nasello 2018 bernet et al 2018 cea et al 2010 caviedes voulli√®me et al 2012 costabile et al 2013 fern√°ndez pato et al 2016 kim and seo 2013 √∂zgen et al 2015 simons et al 2014 singh et al 2015 liang et al 2015 most of the reported swe solvers originate from fluvial flood modelling where they have been thoroughly tested and are increasingly being applied in rainfall runoff modelling one of the main issues concerning swe models has been computational cost in particular for large domains typical of hydrological problems garc√≠a navarro 2016 this issue is currently being addressed through the development of advanced numerical strategies and the use parallel and gpu computing garc√≠a navarro et al 2019 hinkelmann et al 2015 kesserwani et al 2016 the new field of application poses new challenges to the methods arising from discretization caviedes voulli√®me et al 2012 scale issues relating to microtopography and roughness √∂zgen et al 2015 √∂zgen et al 2015 infiltration fern√°ndez pato and garc√≠a navarro 2016 and computational speed up lacasta et al 2015 liang et al 2016 many studies in hydrology and earth sciences related fields are based on fv zi approaches mainly because of the convenient simplicity of the equation and its numerical solution and because many apparently simpler approaches such as cellular automata models have converged into the same zi solution caviedes voulli√®me et al 2018 however it has been pointed out that such simplicity comes with a price in computational efficiency i e the fv zi approach can often be computationally more expensive than swe solvers cea et al 2010 fern√°ndez pato and garc√≠a navarro 2016 lopez barrera et al 2012 wang et al 2011 which is linked to the stability properties of the explicit time integration of the non linear parabolic zi equation mendicino et al 2015 adopting implicit fv zi or finite element solved zi approaches avoids this issue by exploiting unconditional stability of such schemes but does not necessarily increase efficiency over swe solvers fern√°ndez pato and garc√≠a navarro 2016 and introduces new issues in the choice of the time step size it has been suggested that the higher cost of the zi solution is inherent wang et al 2011 nonetheless the literature shows that zi schemes can and have been validated and that they are indeed accurate under some conditions researchers have independently proposed and studied ways to reduce the high computational cost of the zi approximation by addressing the underlying stability issues some of the reasoning is obtained by following ideas from the stability of hyperbolic systems i e the courant friedrich lewy cfl condition lopez barrera et al 2012 wang et al 2011 dottori and todini 2011 and von neumann stability analysis hunter et al 2005 which is similar and consistent to stability analysis of parabolic elliptic equations such as the richards equation caviedes voulli√®me et al 2013 mendicino et al 2015 which shows a similar non linear behaviour as the zi approach interestingly it has also been pointed out that keeping an additional inertial in the zi equation without reverting to the full swe also reduces stability constrains i e falling back into the local inertia formulation bates et al 2010 de almeida et al 2012 martins et al 2015 hydrological models considering shallow surface flows explicitly have traditionally favoured zi or even simpler solvers caviedes voulli√®me et al 2018 paniconi and putti 2015 sustained partially by persistent assumptions that swe solvers are i mathematically complex and difficult to implement ii computationally more expensive than zi solvers e g very recently savant et al 2019 iii more accurate due to the inherent simplifications of the physics in zi these are not unfounded assumptions zi is a single scalar parabolic pde whereas swe involves three scalar hyperbolic pdes thus it is to be expected that the operations per time step and cell are at least thrice as much in swe because of the parabolic nature zi models have often made use of implicit time integration feng and molz 1997 fern√°ndez pato and garc√≠a navarro 2016 panday et al 2004 savant et al 2019 weill et al 2009 as implicit schemes are well suited for parabolic pdes this allows for time steps significantly larger than for swe solvers typically explicit because of their hyperbolic nature in the context of river and floodplain flows for which both models have been classically developed and applied to the long time scales and pseudo steady flows favour implicit zi solvers however although the arbitrary choice of large time steps size may seem as an advantage the lack of well founded criteria to choose it for a non linear parabolic pde can result in inaccuracies especially under highly transient rainfall runoff problems fern√°ndez pato and garc√≠a navarro 2016 alternatively explicit zi solvers have also been used e g bates and roo 2000 caviedes voulli√®me et al 2018 cea et al 2010 fern√°ndez pato and garc√≠a navarro 2016 mendicino et al 2015 which require a stability governed time step which guarantees stability and accuracy but which enforce small time steps thus raising computational effort the time step size trade off in favour of implicit solvers has to be put also in the context of parallelisation implicit zi solvers require assembling and inverting large matrix systems a task which does not scale well in current parallel computational approaches whereas explicit solvers scale much better and are easier to implement especially for hpc environments moreover it must be highlighted that it is also well established that highly inertial and strongly hyperbolic flows such as dam break waves flows with interacting traveling waves etc cannot be accurately solved by the zi model and therefore require the full swe e g aric√≤ and nasello 2018 costabile et al 2017 prestininzi 2008 savant et al 2019 yeh et al 2011 in the last decade swe solvers have received significant attention and have developed significantly into robust and efficient solvers garc√≠a navarro et al 2019 hinkelmann et al 2015 thus shifting their limits of applicability it is now feasible to perform large rainfall runoff simulations with swe solvers and naturally the aforementioned assumptions need to be critically re assessed and re tested this is an ongoing effort and a few comparisons between zi and swe are available in recent literature prestininzi 2008 tested a zi solver on a dam break experiment concluding that zi was capable of reproducing the main features of the solution cea et al 2010 compared swe and zi solvers against experimental rainfall simulations finding that swe outperforms both in accuracy and computational efficiency an explicit zi solver neal et al 2012 benchmarked zi and swe solvers for fluvial type problems finding some boundaries to the applicability of zi solvers fern√°ndez pato and garc√≠a navarro 2016 compared explicit and implicit zi solvers on a fluvial flood to a commercial swe solver highlighting that the implicit solver can be as accurate and efficient as the swe solver if an optimal time step for the problem is found costabile et al 2011 found that zi can provide solutions of comparable accuracy to swe under very simple problems of rainfall over planes but question the validity for real flash flood events costabile et al 2017 performed a benchmarking study and showed that zi is unsuitable for dam break simulation compared to swe solvers jahanbazi et al 2017 compared a zi solver to a second order swe solver for different types of problems finding acceptable accuracy aric√≤ and nasello 2018 also performed a benchmark test of a zi and swe solvers with implicit schemes showing different ranges of applicability their results lead to question the validity of implicit triangular meshed zi solvers for general rainfall runoff problems highlighting particular conditions under which they may perform accurately savant et al 2019 compared implicit swe and zi solvers concluding that zi is computationally more efficient and that zi solutions are valid except for dam break problems the comparably higher efficiency of implicit zi over implicit swe has also been reported by fern√°ndez pato et al 2018 in a somewhat broader context performance comparisons for power law rheology fluids have been performed cristo et al 2018 and zi swe coupled with sewage models have been found to been comparable martins et al 2017 however many of the conclusions obtained in these studies mostly performed on fluvial flood problem may not hold on rainfall runoff problems some results cea et al 2010 aric√≤ and nasello 2018 are of particular relevance for rainfall runoff but are limited to a set of laboratory scale problems furthermore the variety of applications numerical scheme formulations computational implementations together with the changes in numerical and computational technology and mesh selection keep the applicability and relative efficiency of zi vs swe rather unclear teng et al 2017 despite the existence of analytical arguments for the range of applicability tsai 2003 it must be strongly highlighted that some of the results and observations in terms of performance in the literature may seem contradictory but they are very likely related to the specific formulations and implementations used and cannot be blindly extrapolated to all solvers the historical and continued parallel trends in use of explicit zi and swe solvers for rainfall runoff simulation as well as for flood modelling call to critically assess and contrast both approaches in the spirit of finding the best way forward to address physically based and spatially distributed rainfall runoff modelling it is therefore the purpose of this work to compare the performance and study the advantages and disadvantages of both methods by comparing simulated results of a set of benchmark cases of increasing complexity computed both with the zi and swe solvers seeking to answer several research questions i does an explicit fv zi solver provide similar accuracy to an explicit fv swe solver in rainfall runoff problems ii is an explicit fv zi computationally cheaper or more expensive than an explicit fv swe solver iii are there any other advantages to choose fv zi over swe solvers we highlight that the scope of this paper is exclusively on rainfall runoff simulation in which topography and friction are likely dominant on the thin water layer and we do not assess other more inertial flows with a stronger hyperbolic behaviour the paper is organized as follows section 2 presents the mathematical formulation of both methods and 3 presents the numerical scheme to solve the mathematical models section 4 presents results on a set of numerical experiments and quantitative benchmarking analysis section 5 presents a discussion of the computational performance of the numerical schemes and section 6 summarizes key conclusions 2 mathematical models the 2d shallow water equations in conservation form are 1 u t e u g u s u where u is the vector of conserved variables 2 u h q x q y with water depth h l and unit discharge momentum q x and q y in the x and y directions l 2 t note that 3 q x hu q y hv where u un x and v un y are the cartesian components of the velocity vector u l t the fluxes in eq 1 are 4 e u q x q x 2 h gh 2 2 q x q y h 5 g u q y q x q y h q y 2 h gh 2 2 where g is the acceleration of gravity l t 2 the source term s u can include a number of different physical phenomena so that 6 s u b u h u i u r where b u is the bed source term 7 b u 0 gh z x gh z y where z is bed elevation l h u accounts for friction 8 h u 0 gh œÉ x gh œÉ y in terms of friction slopes œÉ x and œÉ y friction slopes are typically approximated using manning s law 9 œÉ x n 2 u u 2 v 2 h 4 3 œÉ y n 2 v u 2 v 2 h 4 3 with roughness parametrised through manning s coefficient n t l 1 3 the source term i u accounts for infiltration exfiltration phenomena 10 i u i u 0 0 where i is the infiltration rate if negative or exfiltration rate if positive l t note that conceptually the infiltration rate depends on depth but that dependency can be modelled with different levels of complexity and rigorousity at the very least the infiltration model must enforce that infiltration can only occur for h 0 source term r accounts for rain 11 r r 0 0 where r is the rain rate l t note that this source term is independent of the conserved variables 2 1 zero inertia equation from the full swe system 1 it is possible to derive the zero inertia zi simplification to do so consider the momentum equations 12 q x t x q x 2 h 1 2 gh 2 y q x q y h gh z x œÉ x 13 q y t x q x q y h y q y 2 h 1 2 gh 2 gh z y œÉ y assuming that the inertial terms can be neglected so that flow is driven only by the hydrostatic and friction forces reduces the momentum equations to 14 h x z x œÉ x 15 h y z y œÉ y note that the result of neglecting inertial terms also implies that the momentum equations becomes steady eqs 14 and 15 can be summarized as 16 h z œÉ eq 16 allows to express the unit discharge q l 2 t directly in terms of the water surface slope z h z 17 q Œ± h z z where Œ± h is a non linear coefficient which depends on the friction formulation of choice to maintain generality santillana and dawson 2010 for manning s friction with a manning s roughness coefficient n tl 1 3 the coefficient Œ± is 18 Œ± h h 5 3 n for the darcy weisbach friction law with friction coefficient f 19 Œ± h h 3 2 8 g f 1 2 and for the ch√©zy equation with ch√©zy roughness coefficient c l 1 2 t 20 Œ± h ch 3 2 the standard approach in the literature for the zi equation relies on manning s formulation thus substituting eqs 18 and 17 in the mass conservation equation depth equation in system 1 yields the classical 2d zi equation based on manning s friction 21 h t h 5 3 n z z r i 3 numerical model in this work two numerical models are compared the first one solves the shallow water system 1 and the second one the zi eq 21 both are based on a finite volumes framework and are discretised explicitly in time the fv swe solver has been thoroughly presented in the literature and is therefore not presented here the core numerical scheme was introduced by murillo and garc√≠a navarro 2010 and its high performance computing implementation was reported by lacasta et al 2013 2015 for the purposes of this work it suffices to point out that such implementation is an explicit finite volume solver based on the hyperbolic properties of the system making use of an augmented roe solver to compute local edge wise riemann problems murillo and garc√≠a navarro 2010 accounting for the effects of the source terms the scheme is first order accurate both in space and time in order to fairly compare the numerical solution of both eqs 1 and 21 the zi solver was implemented also as a first order explicit finite volume solver to do so eq 21 is first integrated in a finite control volume a 22 a h t da a h 5 3 n z z da a r i da invoking gauss theorem yields 23 a h t da s h 5 3 n z z dl a r i da where s is the surface enclosing the volume a finally choosing polygonal cells comprised of n œâ sides as control volumes and choosing a piece wise constant representation of functions in the cells the semi discretization is achieved 24 h t r i 1 a i œâ 1 n œâ h œâ 5 3 n œâ z œâ z œâ l œâ where œâ denotes the edge between cells i and j h œâ is the estimated depth at the cell edge œâ a i is the area of cell i l œâ is the length of the edge œâ and z œâ is the water surface gradient across the edge note that z œâ is well defined at the edge but h œâ is not and must be estimated to cope with its bi valuated nature at such edge it has been shown that the na√Øve arithmetic mean between neighboring cells is computationally inefficient due to numerical stability issues in particular in the presence of complex topography dottori and todini 2011 mendicino et al 2015 hunter et al 2005 therefore a stable estimation proposed by hunter et al 2005 is implemented here 25 h œâ max h i z i h j z j max z i z j where i is the current cell and j the neighboring cell which shares edge œâ with cell i the semi discretization in eq 24 still requires to integrate in time in this work an explicit time discretization approach is adopted by using the standard forward euler approximation the complete numerical scheme reads 26 h i n 1 h i n Œ¥ t r i n i i n Œ¥ t a i œâ 1 n œâ h œâ n 5 3 n œâ z œâ n z œâ n l œâ eq 26 is the explicit finite volume solution to the zi equation fv zi analogous to other schemes reported in the literature cea et al 2010 fern√°ndez pato and garc√≠a navarro 2016 leandro et al 2014 wang et al 2011 the scheme is first order accurate in both space and time notice that 26 does not require any particular shape or arrangement for the computational cells but allows for fully unstructured meshes with convex polygonal cells a particular case of this is of course a structured mesh of squared cells herein we keep to this structured mesh only for the purposes of providing computational evidence comparable for most of the reported implementations of fv zi solvers and those termed as cellular automata zi which are usually restricted to structured cartesian grids the stability of the numerical scheme in eq 26 is formally governed by a von neumann vn stability condition since the zi equation is a non linear diffusion equation a modified vn condition was proposed by hunter et al 2005 to ensure stability avoid checkerboarding behaviour and prevent the time step to reduce excessively under near horizontal water surfaces 27 Œ¥ t Œ¥ x 2 4 min 2 n h œâ 5 3 h 1 2 where the water depth gradient h is 28 h h Œ¥ x h Œ¥ y if z h z h z Œ¥ x h z Œ¥ y if z h z where h z 0 is an ad hoc threshold value small enough to prevent checkerboarding and instabilities but large enough that it avoids extremely small time steps alternatives to the linearisation in eq 27 are for example to set an ad hoc minimum time step Œ¥ t min leandro et al 2014 or through an entropy fix deriving from hyperbolic theory and requiring a flux splitting approach lopez barrera et al 2012 however eq 27 though formal has been found to be too conservative dottori and todini 2011 wang et al 2011 probably due to the linearisation assumptions in the linear von neumann analysis wang et al 2011 proposed to use a cfl condition set in the order of 0 05 0 1 whereas dottori and todini 2011 identified that the time step values could be up to 10 larger than those computed with eq 27 without affecting the accuracy and stability of the solution therefore herein we also consider the cfl condition recalling that velocity at a computational edge is v q œâ h œâ 29 Œ¥ t cfl min œâ Œ¥ x h œâ q œâ 4 numerical experiments to benchmark and compare the applicability and efficiency of both models in rainfall runoff modelling problems both solvers are tested on a set of six test cases with incrementally increasing complexity the first two test cases are simple analytical solutions of rain over a constant slope with roughness the third is an experimental rain simulation over a sloping plane these tests allow to assess the basic capabilities of the models in terms of reproducing the basic phenomena in rainfall runoff the fourth and fifth cases are a laboratory experiment over an idealised urban catchment and a rainfall simulation experiment in a field plot both test cases introduce significant topographical complexity and allow to assess the capabilities of the models to handle complex topography and complex flow structures that develop because of it finally the last test case is one of rain on a real urban area all simulations reported here were performed only on structured cartesian meshes are studied since it the most frequent approach in the literature when numerically solving the zi equation caviedes voulli√®me et al 2018 all cases have dry initial conditions results are analysed with rmse 30 rmse k 1 n k Œ± k Œ≤ k 2 n k where Œ± and Œ≤ are the simulated and reference results respectively this is done for hydrographs and for depth and or velocity if reference results are available additionally in some cases the nash sutcliffe efficiency is also used for hydrographs since it is increasingly more clear that hydrograph metrics may not be sufficient to properly assess rainfall runoff results the evolution of the wet or flooded surface is also studied as they have been suggested to be more sensitive to model inaccuracies lim and brandt 2019 stephens et al 2013 wet or flooded areas are determined by thresholding the water depth fields areas with water depth larger than 0 0001 m are considered wet and otherwise dry in order to analyse spatial distributions of wet surfaces the flood critical success index œï bates and roo 2000 bernet et al 2018 hoch et al 2018 sampson et al 2015 is used 31 œï a swe a zi a swe a zi where a swe and a zi represent the flooded areas computed by the swe and zi models respectively a complementary indicator œà measuring to which model the differences in wet area are weighted towards is also defined 32 œà a swe a zi a swe a zi where a swe is the area predicted as wet by the swe model but dry by the zi model and vice versa for a zi the critical success index œï can vary in œï 0 1 where null means no match between models and 1 means a perfect match intermediate values represent different degrees of matching flooded regions not only in terms of surface area but also location and shape this metric penalises both underprediction and overprediction of flooded area sampson et al 2015 the second indicator can take values œà 1 1 where negative values indicate that the zi model predicts more flooded areas than swe and vice versa for positive values a value of zero may indicate both perfect match of flooded areas or simply an equivalent under and overprediction 4 1 constant rainfall on a plane the runoff generation on a sloping plane with constant rainfall is the simplest case that can be set up for a rainfall runoff simulation and therefore a good starting point to study and compare both solvers a so called na√Øve analytical solution for the discharge hydrograph was developed by delestre et al 2008 and is used here as a reference solution and has been used as a benchmarking solution rousseau et al 2015 the plane has a slope of 0 05 and a length of 4 m rainfall intensity was set to 50 mm h 1 friction is modelled by the darcy weisbach law with a friction coefficient of 0 25 the boundary conditions are all closed boundaries except the lowest boundary of the channel which is transmissive free outfall simulation time was set to 125 s the computational mesh was set to a structured square mesh with Œ¥ x Œ¥ y 0 040 m resulting in 3000 computational cells 100 along the length of the channel stability was governed by cfl 0 9 for both the swe and zi solvers fig 1 shows both the swe and the zi solutions h scheme for this case is clear that both solutions approximate well the reference solution the solution from the zi h scheme is accurate and stable for a cfl value of 0 9 rmse relative to the exact solutions is similar for both models 4 47 10 6 and 4 03 10 6 m 2 s 1 for zi and swe respectively both models slightly underestimate the rising limb of the hydrograph but they do so equally the recession limb is somewhat faster in the swe model which is to be expected as inertia plays a role in draining the channel downstream it is interesting that during rainfall both hydrographs are closer together suggesting that the inertial terms play a lesser role in the outlet runoff 4 2 variable rainfall on a plane a step up in complexity from the first test is time dependent rainfall on a sloping plane an obviously relevant issue in rainfall runoff simulation for which an analytical solution for the resulting hydrograph was proposed by govindaraju et al 1990 this case has been used for benchmarking by several authors gottardi and venutelli 2008 liang et al 2015 singh et al 2015 the plane has a length of 21 945 m and slope of 0 04 friction is modeled with ch√©zy s equation with a coefficient of 1 767 m 1 2 s 1 following the original setup of case b as termed by govindaraju et al 1990 the boundary condition at the outlet was set to as transmissive a free outfall the computational mesh was a structured square mesh with cell edge length of Œ¥ x Œ¥ y 0 109725 m resulting in 2000 computational cells 200 along the length of the channel simulation time was set to 4800 s and stability was governed by cfl 0 9 for the swe solver and for the zi cfl solver fig 2 shows the rain distribution and the resulting hydrographs computed with both solvers both solvers approximate well the shape and magnitude of the hydrograph peak discharge and time to peak are well captured slight differences exist in the shapes of the hydrographs but the overall properties are well kept a quantitative assessment of the errors is presented in table 1 time to peak is underestimated by all solvers but by less than 0 2 peak discharge is slightly overestimated by the zi solver and somewhat underestimated by the swe solver the rmse for discharge normalized by the reference peak discharge is quite low for all solvers as well altogether it is clear that both zi solutions with vn and cfl stability criteria eqs 27 and 29 respectively and the swe solver yield accurate results 4 3 experimental rainfall in a flume this test case is similar to the first but introducing experimental results kirstetter et al 2016 performed three rain experiments on a sloping flume with the goal of studying friction the flume was 4 04 m long 11 5 cm wide three cases with different rain and slopes were set up and summarised in table 2 kirstetter et al 2016 found it necessary to slightly adjust the rain intensity for numerical simulations to match the experimental results herein such calibrated values are also used the rain duration was 600 s after which the flume was left to drain the reported optimum manning s coefficient is 0 025 s m 1 3 and the friction factor for the darcy weisbach equation is 0 50 simulations were performed with the zi and swe with both manning and darcy weisbach friction laws and for zi both cfl and von neumann stability criteria were used all numerical solutions were computed with a mesh comprised of 300 square cells with a resolution of 4 cm all boundaries were closed except for the downstream end of the flume which was transmissive free outfall fig 3 shows the resulting hydrographs all simulations approximate the hydrographs reasonably well zi produces somewhat higher steady outflow than swe the difference in steady outflows produced by zi and swe is explained by the inherent differences in the equations when setting the temporal derivative to zero both in eqs 1 and 21 moreover it must be noted that the solutions with zi required a re calibration of both the manning roughness coefficient and the darcy weisbach friction factor to 0 033 s m 1 3 and 1 0 respectively this was done by trial and error on case a and then applied to the other two this is not unreasonable since the values reported by kirstetter et al 2016 were originally calibrated with a swe solver both friction laws produce nearly identical hydrographs regardless of the solver the initial rise of the hydrograph is faster in all simulations than the experimental data the reasons for this are unclear it is also unclear why there is no experimental discharge registered in the first 50 s case c shows a better agreement of the rising limb than a and b some differences are observed between the two stability criteria for zi in the rising limb and near the end of drainage but rather minor and maximal in case a in case b all zi hydrographs practically overlap as do the swe results for case c the match among hydrographs is better finally the decreasing limb of the hydrograph is better represented by zi in cases a and b but swe fits better in case c altogether the hydrographs suggest that both solvers both friction laws and both stability criteria are adequate fig 4 shows the comparison of predicted and experimental velocities and depths at steady state for all simulations quantitative errors from these results are shown in fig 5 in fig 4 for case a the swe appears to approximate both depth and velocity better than zi but with similar trends in cases a and b zi depths are lower than swe depth and vice versa for velocity case b shows the largest disagreement between zi and swe although it is hard to conclude which one is better from the profile itself in case c there is a better match between models and to the experiments but depth is lower for zi than swe in the upstream part and vice versa in the downstream part interestingly in contrast to how close discharge results are depth and velocity profiles show a larger variability in the results in response to the solver and friction laws which leads into the need of exploring several complementary metrics to assess the models the stability condition selected for zi appears to play no role in the accuracy of the zi solver it is interesting that without re calibrating roughness coefficients for case b and c in the former there are much larger differences compared to swe than in the latter fig 5 shows a summary and comparison of three quantitative indicators for several variables indicated by different symbols relative error rmse for depth and velocity and a modified nash sutcliffe efficiency for the discharge hydrograph i e 1 nse meaning that results are better when the indicator is near zero computed for zi were performed with both cfl and vn stability criteria results corresponding to vn are shown with small symbols the three cases proposed by kirstetter et al 2016 are differentiated in the figure by colors finally filled symbols represent manning s friction whereas empty symbols represent simulations computed with darcy weisbach in this way we intend to compare all errors as a set depth and velocity rmse errors were computed for the steady state t 599 s following the same procedure as reported by kirstetter et al 2016 the figure shows that the depth and velocity rmse in all three cases and for both friction laws and both stability conditions are higher for zi than for swe above the 1 1 line the discharge hydrograph modified nse shows that results are marginally better for swe and marginally better in case c case b appears to be the one in which in terms of velocity and discharge both models perform more similarly the friction law comparing filled against empty symbols produces differences in the quantitative assessment in general going from darcy weisbach to manning decreases the depth error for zi and vice versa for swe velocity errors decrease for both zi and swe when using manning s law except for case b the quality of discharge prediction is also changed but without clear structure changing from cfl to vn stability in the zi models results in negligible differences i e in the figure small symbols are practically always coinciding with the larger symbols furthermore 5 clearly shows that assessing results in terms of hydrograph signatures suggests that both models perform very similarly however the assessment of water depth and velocity errors shows larger errors for zi which nonetheless do not compromise the generation of hydrographs together with fig 4 they further suggest that it is likely that zi underestimates depth and correspondingly overestimates velocity in comparison to swe 4 4 rainfall experiment in an idealised urban catchment cea et al 2010 presented experimental and numerical results for a range of laboratory scale rainfall runoff experiments on an impervious surface with different arrangements of buildings the experimental catchment has dimensions of 2 2 5 m in this study a case with 12 buildings with no particular arrangement named a12 by cea et al 2010 has been selected the a12 case has also been used for benchmarking diffusive wave models by fern√°ndez pato and garc√≠a navarro 2016 and other cases have also been used for benchmarking numerical models su et al 2017 fig 6 shows the topography for the medium resolution mesh including the buildings for the test case the buildings are 20 cm high cea et al 2010 evaluated the effects of including the buildings as topographical features or alternatively removing them from the computational mesh finding no significant differences in the simulated outflow herein the buildings are kept as topographical features since portraying them as holes in the mesh would ideally require unstructured meshes which are not used here as previously explained all boundaries are closed except for the lower boundary which was set as transmissive computations were performed with four mesh resolutions summarized in table 3 the selected rain event has a constant rainfall of 300 mm h 1 during the first 20 s of the simulation after which no precipitation occurs the simulation was run up to t 160 s friction was modelled by manning s equation with a constant roughness coefficient of 0 016 s m 1 3 as suggested by cea et al 2010 fig 7 summarises results for this test case the results show that both the zi and swe models are capable of approximating the experimental hydrograph fig 7 a suggesting that both models are applicable and capable of solving this type of problems the accuracy to reproduce the hydrograph is clearly dependent on mesh resolution the behaviour of the vc mesh for zi is clearly poor with a strong overestimation of peak flow this is an indication that under this mesh is too coarse for an accurate zi solution in general the initiation of outflow is faster in all models than in the experimental data just short of t 10 s fig 7 b shows rmse for discharge normalised by the rain flow rate and is always below 0 01 the results are in general slightly better for swe than for zi peak discharge can be seen to depend on both the model and the mesh the peak discharge error is in the order 1 to 24 of the experimental peak discharge time to peak shows errors of up to 12 relative to the experimental time to peak as fig 7 b shows most of the error metrics are somewhat higher for zi cases than for swe but very similar to each other the exception is the time to peak with the coarse mesh in which swe resulted in a near zero error whereas for zi it is around 8 the worst results are obtained for zi with the vc mesh overestimates by 24 the peak discharge with a faster initial runoff and a faster drainage and with the fine mesh solved with zi with underestimation of peak discharge by 16 with a slower drainage the best overall results are obtained with the fine swe solution followed by both the medium zi and swe fig 7 a the errors confirm that the models perform most similar to each other for the medium mesh the different error indicators also show that the quality assessment of the models can be strongly dependant on the selected metric the coarse mesh serves as an obvious example as the rmse discharge error is practically identical the peak discharge error higher for swe but the time to peak is higher for zi in terms of the flooded fraction of domain fig 7 c the results show that swe results in persistently flooded domains whereas the zi solutions drain out faster this is consistent with what is observed in general terms in the receding hydrograph limbs the maximum flood extent varies depending on mesh and model although it is more consistent for swe mesh resolution appears to have similar effects on both models the vc mesh results in lingering flooded areas whereas the fine mesh shows the fastest decreasing flooded areas during drainage the lingering wet areas in the vc mesh are explained by the piece wise nature of the solvers the vc cells are comparatively very large which means that a given volume of water in that cell translates into a smaller depth than in finer meshes this results in a smoothing of water surface gradients even if the same volume of water is present in the domain which is suggested by the similarity of the swe hydrographs for example zi seems less sensitive in terms of flood extension to mesh changes f m c than swe during the drainage phase fig 7 d shows the flood geometry comparison indicator œï eq 31 flooded areas are most similar between both models during the rain as is to be expected since most of the domain remains wet at such time during the drainage phase œï decreases at approximately the same rate for all meshes however the finer meshes show that the match in flood geometry recovers quickly for the coarsest vc mesh the recovery occurs later that is for the finer meshes the flood areas match more during larger durations of the simulation than for the coarser ones interestingly for the vc mesh the final wet areas match better than for the finer ones this is explained by the standing water upstream of buildings which in the coarser meshes has less chance to flow this is clearly observed in the flood areas shown in fig 8 during the rain t 10 s differences in wet areas only occur around the building and are very minor however during the drainage phase t 40 s very clearly the zi solver results in a more concentrated water volume near the center of the domain whereas the swe allows for thin layers of water to remain extended this is also seen at later stages of drainage as flow stops and water remains ponded upstream of two buildings both models predict very similar flooded surfaces finally it is relevant to highlight that both the hydrograph and the error indicators do not show large differences in the general performance of both models and only medium variance among meshes flood extension and flood geometry are indeed different across models and meshes this suggests that domain integrated metrics such as the hydrograph are not enough to evaluate the differences in model performance and that spatial metrics are necessary to identify the different features of the solutions 4 5 thies runoff experiment tatard et al 2008 reported a rainfall simulation experiment held in a field in thies senegal it was later simulated by m√ºgler et al 2011 to study the effect of friction formulations this test has also used been used for benchmarking chang et al 2016 park et al 2019 simons et al 2014 weill 2007 the domain was a field plot of 10 4 m with a mean slope of 1 the experiment had a simulated constant rainfall of 70 mm h 1 during the first 180 s of the experiment after which the rain was stopped all boundaries are set as closed except the boundary at the bottom which is transmissive simulation time was set to 800 s allowing for a hydrograph with distinctive rising steady and drainage phases friction was modelled with manning s equation with a constant roughness coefficient of 0 02 s m 1 3 m√ºgler et al 2011 infiltration was set to a constant rate of 0 0041667 mm s 1 m√ºgler et al 2011 to test the performance of the numerical models four computational meshes with varying resolution were designed which are summarized in table 4 fig 9 shows the dem mapped at the finest mesh resolution along with the locations of 62 velocity sampling locations where steady state velocity was experimentally measured stability of the swe solver was controlled by cfl 0 9 and for zi by cfl 0 1 fig 10 summarises results for the thies test case 10 a shows the outflow hydrographs for both the zi and swe models and all meshes experimental hydrographs are not available the overall behaviour of the eight simulations is very similar all cases achieve the same maximum steady discharge the zi model with the vc mesh exhibits a noisy behaviour which is due to mesh coarseness in particular near the outlet boundary in general terms fig 10 a shows that the transformation of rainfall into runoff including infiltration runoff partitioning is similar for both models and across meshes in turn suggesting that all are valid for hydrological rainfall runoff simulation fig 10 b shows the flooded area fraction of the domain and fig 10 c shows the œï indicator for the match of flooded areas both indicators show that during rain practically the entire domain is the same as the rain stops the zi model predicts less area flooded than the swe e g t 200 s and only around 75 of the wet areas are predicted as such by both models there is a subtle trend across mesh resolutions the flooded area from both models is during most of the simulation inversely proportional to resolution the differences in flooded area during the rain are larger for zi than for swe but this trend inverts during the drainage phase in terms of the match in flooded areas among both models fig 10 c suggests that all meshes perform similarly with less differences observed for finer meshes to better asses the quality of the models fig 11 compares steady state velocities computed with both numerical models against the reference results of tatard et al 2008 and m√ºgler et al 2011 including linear fits both models show accurate performance in the lower velocities while systematically underestimating higher velocities there is some variability related to the mesh for zi fig 11a the linear fits show practically the same slope with a very small bias among them that is all four meshes predict similarly well the velocities the swe model fig 11b shows a wider spread of the linear fits with slightly different slopes with the fine mesh providing best results complementary fig 11d shows the comparison between both models showing that the zi model consistently produces steady state velocities slightly higher than swe across all velocity ranges the figure also shows that the predicted velocities are in better agreement among the two solvers for finer meshes in order to quantify the performance the coefficient of determination r 2 and rmse of velocities are shown in 5 the range of r 2 between zi and the experimental results is similar to the range of r 2 for swe within each model the variations of r 2 across resolution are relatively small roughly 4 and 5 respectively relative to the mean r 2 across meshes the tendency for the zi model is that r 2 decreases with increasing resolution whilst for swe r 2 increases with resolution except for the coarse mesh which shows a slight decrease the latter is the expected behaviour according to numerical schemes theory but the former is unusual for zi the r 2 suggest that the best steady solutions are obtained with coarser meshes this may be explained by the nature of the discretisation error of the first order schemes for swe hyperbolic advection equation the discretisation error is of order o Œ¥ x 2 non centered first order whereas for the zi parabolic equation it is of order o Œ¥ x 4 centered first order anderson et al 1984 this makes zi less sensitive to mesh coarsening as suggested by ponce 1986 in a 1d context see table 6 the coefficient of determination was also computed between both models to quantitatively compare how similar the results are r 2 between both models steadily grows with resolution and they show that both models better predict each other than the experimental results this suggests that the main sources of error relative to experimental results come from spatial discretization mesh size choice of the friction model m√ºgler et al 2011 and parametrisation but not really from either the simplification inherent to zi or the numerics of either model the rmse values also show that for zi marginally better results are obtained for the coarsest mesh all four meshes produce very similar rmse with zi with a range of 2 8 of the mean across meshes swe however is considerably more sensitive to the mesh with a range of 27 relative to the mean of all meshes that is both rmse and r 2 suggest a stronger dependency of the quality of the solution based on the mesh finally both indicators confirm that the models predict each other better than the experimental results fig 12 shows the relative error in velocity at the experimental gauge points at their locations in the domain experimental velocity is compared against zi fig 12 a d and against swe fig 12 e h results zi and swe are compared to each other in fig 12 i l note that the color scale shows a wide range of relative errors the most accurate velocities for both zi and swe are observed in the main drainage channel of the domain the highest differences in velocities overestimating experimental results occur at the top of the experimental catchment swe appears to achieve better results than zi on the gauges located near the south west corner of the domain where zi also overestimates velocities there a few gauges in which there are consistently large underestimations notably one at the center of the channel near the outlet different mesh resolutions do not significantly alter the structure of the spatial distribution of errors comparing the simulated velocities of zi against those from swe there is a clear trend along mesh resolution as already shown in fig 11c similar to the comparison against experimental velocities both models agree better on their predicted velocities at the main channel where more water is available the largest disagreements occur where there are thin layers near the top regions of the domain fig 13 shows depth fields for both the zi and swe solvers at two times during the steady state t 150 s and during the drainage phase t 235 s during steady flow t 150 s only very small differences can be appreciated loss of details does occur for the coarser meshes but the overall flow features and structures are still present even in the coarsest mesh in contrast during the drainer phase 235 s the depth field shows a larger sensitivity to mesh coarsening in particular for the vc mesh the c mesh does not significantly smear the flow features in the zi case in contrast mesh coarsening introduces larger differences in the depth field are observed for swe than for zi zi also results in a faster drainage of the surface except for the fine mesh where both zi and swe result in similar wet areas at t 235 s this is further explored in fig 14 which compares flooded areas for both models regions predicted as flooded by both models are shown in green blue regions are those wet in swe simulations but not zi and vice versa for orange regions white areas are predicted as dry by both models it can be clearly seen that for all meshes very shallow layers linger longer in the swe solution whereas the zi solution favors a more concentrated drainage as suggested already by fig 10 the matching flooded areas green regions are qualitatively very similar across meshes but the areas flooded only in the swe are somewhat more sensitive 4 6 urban area test case this test is of rainfall on an urban area in glasgow scotland and is included as one of the uk environmental agency benchmarking tests n√©elz and pender 2010 the domain size is 400 960 m the topography is shown in fig 15 at 2 m resolution this test is often used for benchmarking courty et al 2017 hu et al 2018 savant et al 2019 the original dtm has a resolution of 0 5 m in the test case there are two sources of water one is a single pulse of rain with intensity of 400 mm h 1 during 60 t 240 s the second is a point source indicated as s in fig 15 with a time dependent flow rate n√©elz and pender 2010 for 1380 t 3300 s with a flow rate peak of 5 m 3 s at t 2220 s all domain boundaries are closed therefore no outflow hydrograph can be computed the roughness coefficient is somewhat heterogeneous roads and pavements have a manning s coefficient of 0 02 s m 1 3 and everywhere else has a coefficient of 0 05 s m 1 3 nine probes shown also in fig 15 are also included for result comparisons simulation time was set to 18000 s fig 16 shows indicators for the flooded area evolution during the simulation for post processing purposes cells are considered flooded if the water depth is larger than 1 mm in all cases fig 16a shows that all simulations predict similar flooded fractions of the domain and similar evolution of the flood zi predicts smaller flooded areas for t 3000 s and overpredicts the flooded fraction afterwards towards the end of the simulation both models predict very similar flooded areas at such time zi predicts a flooded area between 0 6 fine and 1 coarsest larger than the corresponding swe solution to further examine differences in the model the evolution of the flood overlap indicator 31 is shown in fig 16b the figure shows that the three coarser meshes vc c m behave similarly and show similar values throughout the entire simulation time with the m mesh producing the best match between models the fine mesh however behaves differently and shows that for this mesh the models predict different flood distributions initially œï for all meshes starts at 1 since the domain is completely dry as the domain floods differences between zi and swe appear the largest differences in flooded areas occur lowest values of œï during the rain 60 t 240 s and shortly thereafter as the water redistributes over the surface the flooded areas of both zi and swe become more and more similar with over 0 9 for the coarser meshes and around 0 5 for the fine mesh this means that for the fine mesh although the size of the flooded area is only 1 different between zi and swe roughly only 52 of the flooded areas are predicted to be flooded by both models at the end of the simulation it is surprising that for coarser meshes this values is between 91 and 95 complementary fig 16 c shows that œà is mostly positive for t 3000 s clearly showing that swe predicts larger flooded areas during this initial time after such time œà becomes negative showing the larger flooded areas estimated by zi furthermore œà 0 5 by the end of the simulation for vc c and m but close to zero for the fine mesh this means that for the coarser meshes roughly zi only flooded areas are around 50 larger than swe only areas in the case of the fine mesh the areas are approximately equal altogether the results in fig 16 show in general a good agreement between the models but a higher discrepancy in the spatial distribution of water for the finest mesh these differences can be explicitly observed in fig 17 which compares the differences in flooded areas for selected times white and green areas are those where both models predict dry and flooded surfaces respectively orange areas are those in which zi predicts a flooded surface and swe does not blue areas are where swe predicts a flooded surface and zi does not from the figure it is clear that a majority of the flooded surface and in particular all large clusters of flooded surfaces are captured by both models large green areas regardless of resolution in the early times of the simulation t 900 s the high regions of the domain are draining fig 17 shows how the swe model predicts lingering wet surfaces which continue to drain after longer than predicted by the zi model blue areas explaining the larger flooded areas in fig 16a as the water redistribution continues it can be seen that orange and blue areas remain i e areas in which one or the other model but not both predicts flooding for the coarse resolution more orange than blue areas are visible as suggested by the behaviour of œà in fig 16 c for the fine resolution a large number of isolated orange and blue regions shows ponded water in many places throughout the domain which are the cause of the low value of œï this suggests that under higher resolution the runoff trajectories predicted by zi and swe are less prone to match although it is not possible to ascertain which of the two fine mesh solutions is better the clearly larger differences produces suggest that at higher resolution and perhaps smaller flow scales inertial terms play a higher role finally fig 18 shows water elevation results at three of the probes shown in fig 15 probe 2 and 7 lie near the northern slopes whereas probe 5 lies in the middle of the domain the figure shows results for both models and all four meshes as well as the envelope of the numerical results from a variety of models reported by n√©elz and pender 2010 additionally the terrain elevation at the probe point for each mesh resolution is also represented as a dotted line firstly the figure shows that most of the numerical results computed with either zi and swe are within the envelope of results reported by n√©elz and pender 2010 of more interest to this work are the differences between zi and swe across the different resolutions all three probes in fig 18 show a reasonable agreement between the zi and swe solutions at each resolution although larger differences are clear among resolutions these differences are partially explained by the different terrain elevations represented in the different mesh resolutions introducing a bias in the water surface elevation interestingly the largest differences between zi and swe solutions are observed for the fine mesh consistently with previous indicators there is no clear comparative trend between zi and swe water surface elevation results at these probes in probe 2 zi predicts lower water elevations than swe the opposite happens at probe 5 and probe 7 shows a mix although mostly shows higher surfaces from zi 5 computational performance computational performance was measured for two test cases performance was measured in simulation runs in which no output was written to disk to ensure that only computational time is compared furthermore in the spirit of fair comparison for real large scale applications all the tests were performed with different number of processors on a desktop computer from 1 to 6 to briefly assess the benefits of shared memory parallelisation openmp for these models and applications all computations were performed on a desktop computer with an intel i7 3930 k cpu 3 20 ghz with 6 cores it is relevant to highlight that the computational implementation of both numerical models is similar the structure is analogous i e both models first solve for edge based flux computations and later update cells memory structures and algorithms are overall analogous albeit not identical for obvious reasons the goal of this is that the numerical models can be fairly compared in terms of computational efficiency evidently implementations can always be improved but nonetheless both implementations used in this study are expected to be highly comparable computational times for test cases 4 1 4 2 and 4 3 are for both zi and swe below 1 s since the computational meshes have a low cell count and the duration of the problems is very short the differences in cpu time for these cases is strongly affected by initialisation time and writing times which makes comparisons for these cases rather non significant computational time for test case 4 6 computed with 6 cores is reported in table 7 it is clear in the table that the zi solver can compute up to five times faster than swe for the coarsest meshes but up to five times slower for the finer meshes computational time for the rainfall experiment over an idealised catchment section 4 4 and for the thies experiment section 4 5 are shown in fig 19 note that the vertical axis is logarithmic to appreciate the wide range of magnitudes the figure shows as expected that with more cpus computational time decreases for both solvers and all meshes except the vc and c meshes in fig 19 a this can also be clearly appreciated in speed up shown in fig 21 the swe solver is faster than the zi solver in both test cases this is true across resolutions and number of processors this observation is consistent with previous ones cea et al 2010 costabile et al 2017 wang et al 2011 who concluded that explicit zi solvers were computationally inefficient fig 20 shows the zi to swe ratio of cpu time controlling for each mesh i e values larger than unity indicate that the zi solver takes longer than the swe solver for the same mesh the figure shows a very clear trend coarser meshes show a smaller ratio i e the zi solver is comparatively less inefficient than the swe solver for coarser meshes from a practical point of view this means that the zi solver might be competitive at very coarse resolutions assuming such resolution is enough for the whatever the purposes of the simulation may be and assuming that results are accurate enough this can be explained following that the stability of the zi solution is proportional to Œ¥ x 2 while for the swe solver it is proportional to Œ¥ x cea et al 2010 leandro et al 2014 therefore time step size can grow faster for the zi solver as the mesh is coarsened in practice it also means that for a particular mesh resolution time step size is smaller for the zi solver as a corollary it must be pointed out that if there is a requirement for high spatial resolution for whatever reason may it be accurate topographical representation or that high resolution results are required then the zi solver will not be competitive despite the fact it may be accurate enough for the intended purposes additionally the figure shows that for increasing number of processors the ratio is rather constant although there is a very weak trend for the ratio to increase somewhat with a growing number of processors this suggests that the implementations are scaling in similar way which in turn is a symptom that the implementations are comparable note that the range of ratio values is very different depending on the test case in the idealised urban rainfall test the fine mesh shows a ratio of around 5 times larger than for the very coarse mesh and the medium and coarse meshes result in similar ratios however for the thies experiment all meshes result in different ratios with the fine mesh producing ratios around 10 times larger than the coarse mesh this means that for the idealised urban rainfall zi is less computationally inefficient compared to swe than in the thies case this is likely to be related to the particular dynamics of the flow fields and possibly strongly related to the drainage pattern as drying cells impose a strong computational time step constraint parallelisation speed up is shown in fig 21 the trends for the swe and the zi solvers are similar suggesting that both implementations are comparable the relatively small size of the problem generates that the vc and c meshes in 21 a have a decrease in speed up for 6 processors the speed up trends show slopes smaller than unity showing that for the simulations reported in this work there is still a significant number of non parallelised operations this may be for a number of reasons firstly there are indeed non parallelisable parts of the code second speed up tends to be better as the problem has a larger number of cells since it is precisely the sheer size of the numerical system which governs the cost it may be that the tests computed here are somewhat small thirdly rainfall runoff simulation entails a frequent occurrence of wetting and drying of cells thus introducing time step restrictions which cannot be solved by parallelisation this is likely also to contribute strongly to not achieving higher speed ups as reported for example in fluvial modelling interestingly although the idealised urban rainfall case shows similar speed up trends for both models the thies case shows a much better speed up for swe than for zi this difference is likely to be related to particular flow dynamics together with fig 20 it suggests that the higher topographic complexity and likely its impact on wetting drying interfaces generates a higher penalty for zi resulting in a higher cpu time ratio and lower parallel speed up moreover cpus which may be at times operating mostly on dry cells over which computations are not performed can become an inefficiency 6 conclusions this paper presents and extensive comparative assessment of swe and zi solvers for rainfall runoff simulations the numerical experiments show that rainfall runoff simulation is feasible and reasonably accurate using both explicit zero inertia solvers as well as explicit swe solvers the accuracy assessment shows that as expected the swe model performs overall better than the zi model however the individual assessment of metrics is more complex hydrological signals hydrographs are similarly accurate and the overall behaviour of model results is similar comparisons of water depths and velocities mostly under steady states usually show a somewhat poorer fit of zi results in some cases a larger agreement between the two models than agreement of the models to experimental measurements is found showing a higher uncertainty related to calibration than to the simplification between the models there are differences between the hydrodynamic fields but not critical for hydrological results to become compromised larger differences are observed when assessing spatial distributions for instance in terms of flooded area or the rate at which a surface dries out or the fact that larger differences seem to occur where the thinest water layers are present however spatially distributed reference data is often unavailable this prompts a corollary to properly assess rainfall runoff model performance hydrographs are not enough and spatial information must be considered this is in fact a growing concern in hydrological modelling bernet et al 2018 savage et al 2016 stephens et al 2013 yu and coulthard 2015 the similar flow fields and the differences relative to experimental data obtained by both models suggest also that further work is necessary to improve the representation of friction of thin water layers over natural terrains grismer 2016 and the possible interaction with numerical viscosity and model calibration efforts caviedes voulli√®me et al 2012 this highlights the need to perform multi criteria assessments to find where model inaccuracies might manifest the results here also evidence a rather low sensitivity of zi to the mesh supporting previous observations yu and coulthard 2015 the comparison shows that the zi model can be less sensitive to the mesh than the swe model which in turn implies it might perform better than swe when coarse meshes yet not too coarse are used this seems related to mesh induced diffusivity or viscosity which is larger for coarser meshes this has grounds in the theory of numerical viscosity and because swe are advective hyperbolic equations are more prone to this artifact producing an overestimation of friction forces and underestimation of velocity in the swe model decreasing mesh resolution appear to affect more the simulated swe velocities than the zi velocities signaling that the discrete solution of the diffusion dominated zi may be less affected by numerical viscosity than swe as can be derived from theory that is coarse meshes do not allow to fully exploit the higher capabilities of the swe model appropriately it must be stated nonetheless that other authors have reported zi solutions to be very sensitive to resolution yu and lane 2006 although this is often related to poor channel geometry representation savage et al 2016 this discrepancy is most likely problem dependent in terms of computational efficiency the results lead to the conclusion that the explicit zi solver is less efficient than the swe solver this observation is consistent with other results in the literature strongly suggesting that this is the general behaviour for such models and that the conclusions are quite independent of reasonably mature implementations the main reason for the high computational cost of zi is the number of time steps required to complete the simulations that is the number of time steps is substantially larger than in the fv swe solver it must be substantial since the cost per time step in the fv swe solver is greater than in fv zi simply because there are more equations variables and overall operations per time step the increased number of time steps comes from a very reduced time step size due to a highly constraining stability requirement in fact it appears that the stability restriction imposed on zi solvers is much worse than for swe solvers due to the parabolicity of the equation in contrast to the hyperbolicity of swe the observations in this study are further evidence of this and agree with previously reported results cea et al 2010 costabile et al 2017 wang et al 2011 they also suggest that the somewhat more advective nature of local inertia formulations bates et al 2010 de almeida et al 2012 is a reasonable approach to alleviate this issue in all these results suggest that in order to speed up fv zi solvers it is necessary to explore some other directions i to improve the stability restrictions perhaps by reverting to local inertia formulations bates et al 2010 de almeida et al 2012 ii to pursue some kind of local time stepping solution dottori and todini 2011 since there is a high variability in global time step size throughout the simulation together with a very large spatial variability of cell wise time step restrictions one of the key reasons are drying cells which represent the strongest restriction for time step size this issue is particularly aggravated for rainfall runoff simulations contrary to for example river flood simulation since the likelihood of a cell becoming dry and wet again and dry again etc is particularly high due both to the variable and even intermittent nature of rain and the very small depths that develop during rainfall runoff processes iii attempting to formulate optimal implicit time step sizes fern√°ndez pato and garc√≠a navarro 2016 although parallelisation may not be as efficient the results also suggest that the gap in computational efficiency between both models is reduced for very coarse meshes therefore if the modelling application requires for whatever reason a high spatial resolution not only will the swe model be marginally more accurate it may be significantly faster to execute conversely if coarse resolution is acceptable for example because there is only coarse resolution topographical data the zi model can result in accuracy not far from the swe model and the added cost may not be not critical this is however often not the case since stream channel geometry is often lost at coarser resolutions savage et al 2016 and highlights that locally refined unstructured meshes caviedes voulli√®me et al 2012 fern√°ndez pato and garc√≠a navarro 2016 may play a relevant role in the applicability of zi solvers in other words zi solvers are comparably efficient and perhaps less prone to accuracy loss than swe solvers in the presence of coarser meshes this can be highlighted as a key result from the comparison presented here one key advantage of explicit fv zi solvers over fv swe solvers is that the former are theoretically and mathematically simpler and easier to understand significantly simpler from a numerical point of view and their implementation is much less demanding than for swe solvers it naturally follows that if computational efficiency is a relevant concern fv swe should be favoured although the development process is longer and more complex alternatively the fv zi should be favoured when it is necessary to quickly develop a model from scratch and or if the applications will only require or allow coarse discretisations the context of our results observations and conclusions is strictly within rainfall runoff problems we must highlight that the evidence presented here and the derived conclusions may not hold in general for other types of free surface flows in particular as has been pointed out in previous literature aric√≤ and nasello 2018 costabile et al 2017 savant et al 2019 yeh et al 2011 strongly hyperbolic flows with moving shock waves for example cannot be accurately solved by the zi approximation moreover even within the context of rainfall runoff simulations increasingly hyperbolic flows will likely lead to further reduce the accuracy of zi it is likely that high slopes and dense drainage networks bout and jetten 2018 under very intense rainfall events i e leading to flash floods huang et al 2015 lead to such conditions in the broader context of hydrological modelling based on zi models exploring which geomorphic properties of catchments and under which rainfall conditions such inertial and hyperbolic flows would produce inaccurate zi simulations still remains to be explored this may be particularly relevant for erosion sediment transport and geomorphic processes wohl 2018 the analysis of which may be one more argument in favour of swe solvers finally the general applicability of our conclusions is limited by assessments mostly performed at steady state in particular for hydrodynamic fields it is possible that larger differences between swe and zi may be found for transient states with increased implications to erosion and sediment processes which clearly calls for further experimental evidence during transient rainfall runoff flows credit authorship contribution statement daniel caviedes voulli√®me conceptualization methodology software validation investigation formal analysis writing review editing javier fern√°ndez pato methodology software validation investigation writing review editing christoph hinz conceptualization writing review editing supervision project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the first author would like to thank dr luis cea for facilitating the data required for the idealized urban catchment case and prof dr pilar garc√≠a navarro for facilitating the use of the swe solver the second author acknowledges financial support for this work through research grant di 14 06987 from the spanish ministry of economy mineco 
5613,rainfall runoff simulations are increasingly being performed with physically based and spatially distributed solvers the current computational and numerical technology enables the use of full shallow water equations solvers to be applied for these type of flow problems nonetheless zero inertia diffusive wave solvers have been historically favoured due to their conceptual and mathematical simplicity in comparison to shallow water solvers with the working assumption that the simplifications introduced by zero inertia will have some assumable impact on accuracy but will also allow for computational efficiency since both types of solvers have been primarily developed benchmarked and compared to each other for fluvial and floodplain simulations it is relevant to assess t he relative performance for rainfall runoff problems in this work both solvers are applied to a set of six well known test cases with reference solutions the performance of the solvers is assessed in terms of global signatures such as hydrographs and flooded areas but also in terms of spatial distributions of depth and velocity as well as computational cost furthermore the comparisons are performed across different spatial resolutions the results show that for rainfall runoff problems explicit finite volumes solvers for both equations provide a similar accuracy but the shallow water solver requires less computational time the zero inertia solver was found to be less sensitive to mesh refining than the full shallow water solver keywords surface runoff runoff generation pluvial flooding zero inertia equation shallow water equations diffusive wave equation 1 introduction overland flow generated by rainfall events is a key process in hydrology in the classical hydrological approach at a catchment scale runoff is obtained by transforming the precipitation signal through a number of processes finally resulting in a hydrograph a runoff signal this approach is typically lumped or spatially semi distributed and often based on simplified non physical equations it is arguable that to better understand and predict the complex phenomena in rainfall generated runoff spatially distributed and physically based models are necessary costabile et al 2013 costabile et al 2015 paniconi and putti 2015 thompson et al 2010 thompson et al 2011 in such way the underlying range of physical processes their interaction with spatial heterogeneity of topography soil and land use and the multiscale nature of them are explicitly represented and solved for in the model the physically based simulation of spatially distributed and time dependent surface flow processes in the hydrological context has been often addressed with different levels of simplification or lack thereof of the shallow water equations swe one of the extended approaches is to model surface flow process with the zero inertia zi equation often inaccurately termed diffusive wave equation yen and tsai 2001 a non linear diffusion equation based on the assumption that the flow is driven by the gradient of the water surface and friction only i e neglecting all inertial forces the full range of formulations proposed and used ranging from complex to simple as concisely summarised by aric√≤ and nasello 2018 and including alternative namings is the full swe full dynamic wave local inertia inertial zero convective inertia simplified inertial gravity wave zi diffusive wave and kinematic wave the latter is widely used in hydrology due to its extreme simplicity but has been shown to be inapplicable for complex hydrological modelling bout and jetten 2018 the 2d zi equation has been favoured for this purpose as a good trade off between accuracy and applicability zi has been extensively reported caviedes voulli√®me et al 2018 in flood modelling literature e g aric√≤ et al 2011 2018 2000 2017 2012 2005 2014 2016 2011 and rainfall runoff simulation aric√≤ and nasello 2018 cea et al 2010 feng and molz 1997 fern√°ndez pato and garc√≠a navarro 2016 hsu et al 2000 jahanbazi et al 2017 mendicino et al 2015 savant et al 2019 su et al 2017 weill et al 2009 conceptually the most rigorous approach to rainfall runoff simulation from the physical and mathematical perspectives is to solve the 2d shallow water equations swe the application of swe coupled with infiltration laws solved by means of explicit finite volume fv schemes to rainfall runoff simulation is a growing trend aric√≤ and nasello 2018 bernet et al 2018 cea et al 2010 caviedes voulli√®me et al 2012 costabile et al 2013 fern√°ndez pato et al 2016 kim and seo 2013 √∂zgen et al 2015 simons et al 2014 singh et al 2015 liang et al 2015 most of the reported swe solvers originate from fluvial flood modelling where they have been thoroughly tested and are increasingly being applied in rainfall runoff modelling one of the main issues concerning swe models has been computational cost in particular for large domains typical of hydrological problems garc√≠a navarro 2016 this issue is currently being addressed through the development of advanced numerical strategies and the use parallel and gpu computing garc√≠a navarro et al 2019 hinkelmann et al 2015 kesserwani et al 2016 the new field of application poses new challenges to the methods arising from discretization caviedes voulli√®me et al 2012 scale issues relating to microtopography and roughness √∂zgen et al 2015 √∂zgen et al 2015 infiltration fern√°ndez pato and garc√≠a navarro 2016 and computational speed up lacasta et al 2015 liang et al 2016 many studies in hydrology and earth sciences related fields are based on fv zi approaches mainly because of the convenient simplicity of the equation and its numerical solution and because many apparently simpler approaches such as cellular automata models have converged into the same zi solution caviedes voulli√®me et al 2018 however it has been pointed out that such simplicity comes with a price in computational efficiency i e the fv zi approach can often be computationally more expensive than swe solvers cea et al 2010 fern√°ndez pato and garc√≠a navarro 2016 lopez barrera et al 2012 wang et al 2011 which is linked to the stability properties of the explicit time integration of the non linear parabolic zi equation mendicino et al 2015 adopting implicit fv zi or finite element solved zi approaches avoids this issue by exploiting unconditional stability of such schemes but does not necessarily increase efficiency over swe solvers fern√°ndez pato and garc√≠a navarro 2016 and introduces new issues in the choice of the time step size it has been suggested that the higher cost of the zi solution is inherent wang et al 2011 nonetheless the literature shows that zi schemes can and have been validated and that they are indeed accurate under some conditions researchers have independently proposed and studied ways to reduce the high computational cost of the zi approximation by addressing the underlying stability issues some of the reasoning is obtained by following ideas from the stability of hyperbolic systems i e the courant friedrich lewy cfl condition lopez barrera et al 2012 wang et al 2011 dottori and todini 2011 and von neumann stability analysis hunter et al 2005 which is similar and consistent to stability analysis of parabolic elliptic equations such as the richards equation caviedes voulli√®me et al 2013 mendicino et al 2015 which shows a similar non linear behaviour as the zi approach interestingly it has also been pointed out that keeping an additional inertial in the zi equation without reverting to the full swe also reduces stability constrains i e falling back into the local inertia formulation bates et al 2010 de almeida et al 2012 martins et al 2015 hydrological models considering shallow surface flows explicitly have traditionally favoured zi or even simpler solvers caviedes voulli√®me et al 2018 paniconi and putti 2015 sustained partially by persistent assumptions that swe solvers are i mathematically complex and difficult to implement ii computationally more expensive than zi solvers e g very recently savant et al 2019 iii more accurate due to the inherent simplifications of the physics in zi these are not unfounded assumptions zi is a single scalar parabolic pde whereas swe involves three scalar hyperbolic pdes thus it is to be expected that the operations per time step and cell are at least thrice as much in swe because of the parabolic nature zi models have often made use of implicit time integration feng and molz 1997 fern√°ndez pato and garc√≠a navarro 2016 panday et al 2004 savant et al 2019 weill et al 2009 as implicit schemes are well suited for parabolic pdes this allows for time steps significantly larger than for swe solvers typically explicit because of their hyperbolic nature in the context of river and floodplain flows for which both models have been classically developed and applied to the long time scales and pseudo steady flows favour implicit zi solvers however although the arbitrary choice of large time steps size may seem as an advantage the lack of well founded criteria to choose it for a non linear parabolic pde can result in inaccuracies especially under highly transient rainfall runoff problems fern√°ndez pato and garc√≠a navarro 2016 alternatively explicit zi solvers have also been used e g bates and roo 2000 caviedes voulli√®me et al 2018 cea et al 2010 fern√°ndez pato and garc√≠a navarro 2016 mendicino et al 2015 which require a stability governed time step which guarantees stability and accuracy but which enforce small time steps thus raising computational effort the time step size trade off in favour of implicit solvers has to be put also in the context of parallelisation implicit zi solvers require assembling and inverting large matrix systems a task which does not scale well in current parallel computational approaches whereas explicit solvers scale much better and are easier to implement especially for hpc environments moreover it must be highlighted that it is also well established that highly inertial and strongly hyperbolic flows such as dam break waves flows with interacting traveling waves etc cannot be accurately solved by the zi model and therefore require the full swe e g aric√≤ and nasello 2018 costabile et al 2017 prestininzi 2008 savant et al 2019 yeh et al 2011 in the last decade swe solvers have received significant attention and have developed significantly into robust and efficient solvers garc√≠a navarro et al 2019 hinkelmann et al 2015 thus shifting their limits of applicability it is now feasible to perform large rainfall runoff simulations with swe solvers and naturally the aforementioned assumptions need to be critically re assessed and re tested this is an ongoing effort and a few comparisons between zi and swe are available in recent literature prestininzi 2008 tested a zi solver on a dam break experiment concluding that zi was capable of reproducing the main features of the solution cea et al 2010 compared swe and zi solvers against experimental rainfall simulations finding that swe outperforms both in accuracy and computational efficiency an explicit zi solver neal et al 2012 benchmarked zi and swe solvers for fluvial type problems finding some boundaries to the applicability of zi solvers fern√°ndez pato and garc√≠a navarro 2016 compared explicit and implicit zi solvers on a fluvial flood to a commercial swe solver highlighting that the implicit solver can be as accurate and efficient as the swe solver if an optimal time step for the problem is found costabile et al 2011 found that zi can provide solutions of comparable accuracy to swe under very simple problems of rainfall over planes but question the validity for real flash flood events costabile et al 2017 performed a benchmarking study and showed that zi is unsuitable for dam break simulation compared to swe solvers jahanbazi et al 2017 compared a zi solver to a second order swe solver for different types of problems finding acceptable accuracy aric√≤ and nasello 2018 also performed a benchmark test of a zi and swe solvers with implicit schemes showing different ranges of applicability their results lead to question the validity of implicit triangular meshed zi solvers for general rainfall runoff problems highlighting particular conditions under which they may perform accurately savant et al 2019 compared implicit swe and zi solvers concluding that zi is computationally more efficient and that zi solutions are valid except for dam break problems the comparably higher efficiency of implicit zi over implicit swe has also been reported by fern√°ndez pato et al 2018 in a somewhat broader context performance comparisons for power law rheology fluids have been performed cristo et al 2018 and zi swe coupled with sewage models have been found to been comparable martins et al 2017 however many of the conclusions obtained in these studies mostly performed on fluvial flood problem may not hold on rainfall runoff problems some results cea et al 2010 aric√≤ and nasello 2018 are of particular relevance for rainfall runoff but are limited to a set of laboratory scale problems furthermore the variety of applications numerical scheme formulations computational implementations together with the changes in numerical and computational technology and mesh selection keep the applicability and relative efficiency of zi vs swe rather unclear teng et al 2017 despite the existence of analytical arguments for the range of applicability tsai 2003 it must be strongly highlighted that some of the results and observations in terms of performance in the literature may seem contradictory but they are very likely related to the specific formulations and implementations used and cannot be blindly extrapolated to all solvers the historical and continued parallel trends in use of explicit zi and swe solvers for rainfall runoff simulation as well as for flood modelling call to critically assess and contrast both approaches in the spirit of finding the best way forward to address physically based and spatially distributed rainfall runoff modelling it is therefore the purpose of this work to compare the performance and study the advantages and disadvantages of both methods by comparing simulated results of a set of benchmark cases of increasing complexity computed both with the zi and swe solvers seeking to answer several research questions i does an explicit fv zi solver provide similar accuracy to an explicit fv swe solver in rainfall runoff problems ii is an explicit fv zi computationally cheaper or more expensive than an explicit fv swe solver iii are there any other advantages to choose fv zi over swe solvers we highlight that the scope of this paper is exclusively on rainfall runoff simulation in which topography and friction are likely dominant on the thin water layer and we do not assess other more inertial flows with a stronger hyperbolic behaviour the paper is organized as follows section 2 presents the mathematical formulation of both methods and 3 presents the numerical scheme to solve the mathematical models section 4 presents results on a set of numerical experiments and quantitative benchmarking analysis section 5 presents a discussion of the computational performance of the numerical schemes and section 6 summarizes key conclusions 2 mathematical models the 2d shallow water equations in conservation form are 1 u t e u g u s u where u is the vector of conserved variables 2 u h q x q y with water depth h l and unit discharge momentum q x and q y in the x and y directions l 2 t note that 3 q x hu q y hv where u un x and v un y are the cartesian components of the velocity vector u l t the fluxes in eq 1 are 4 e u q x q x 2 h gh 2 2 q x q y h 5 g u q y q x q y h q y 2 h gh 2 2 where g is the acceleration of gravity l t 2 the source term s u can include a number of different physical phenomena so that 6 s u b u h u i u r where b u is the bed source term 7 b u 0 gh z x gh z y where z is bed elevation l h u accounts for friction 8 h u 0 gh œÉ x gh œÉ y in terms of friction slopes œÉ x and œÉ y friction slopes are typically approximated using manning s law 9 œÉ x n 2 u u 2 v 2 h 4 3 œÉ y n 2 v u 2 v 2 h 4 3 with roughness parametrised through manning s coefficient n t l 1 3 the source term i u accounts for infiltration exfiltration phenomena 10 i u i u 0 0 where i is the infiltration rate if negative or exfiltration rate if positive l t note that conceptually the infiltration rate depends on depth but that dependency can be modelled with different levels of complexity and rigorousity at the very least the infiltration model must enforce that infiltration can only occur for h 0 source term r accounts for rain 11 r r 0 0 where r is the rain rate l t note that this source term is independent of the conserved variables 2 1 zero inertia equation from the full swe system 1 it is possible to derive the zero inertia zi simplification to do so consider the momentum equations 12 q x t x q x 2 h 1 2 gh 2 y q x q y h gh z x œÉ x 13 q y t x q x q y h y q y 2 h 1 2 gh 2 gh z y œÉ y assuming that the inertial terms can be neglected so that flow is driven only by the hydrostatic and friction forces reduces the momentum equations to 14 h x z x œÉ x 15 h y z y œÉ y note that the result of neglecting inertial terms also implies that the momentum equations becomes steady eqs 14 and 15 can be summarized as 16 h z œÉ eq 16 allows to express the unit discharge q l 2 t directly in terms of the water surface slope z h z 17 q Œ± h z z where Œ± h is a non linear coefficient which depends on the friction formulation of choice to maintain generality santillana and dawson 2010 for manning s friction with a manning s roughness coefficient n tl 1 3 the coefficient Œ± is 18 Œ± h h 5 3 n for the darcy weisbach friction law with friction coefficient f 19 Œ± h h 3 2 8 g f 1 2 and for the ch√©zy equation with ch√©zy roughness coefficient c l 1 2 t 20 Œ± h ch 3 2 the standard approach in the literature for the zi equation relies on manning s formulation thus substituting eqs 18 and 17 in the mass conservation equation depth equation in system 1 yields the classical 2d zi equation based on manning s friction 21 h t h 5 3 n z z r i 3 numerical model in this work two numerical models are compared the first one solves the shallow water system 1 and the second one the zi eq 21 both are based on a finite volumes framework and are discretised explicitly in time the fv swe solver has been thoroughly presented in the literature and is therefore not presented here the core numerical scheme was introduced by murillo and garc√≠a navarro 2010 and its high performance computing implementation was reported by lacasta et al 2013 2015 for the purposes of this work it suffices to point out that such implementation is an explicit finite volume solver based on the hyperbolic properties of the system making use of an augmented roe solver to compute local edge wise riemann problems murillo and garc√≠a navarro 2010 accounting for the effects of the source terms the scheme is first order accurate both in space and time in order to fairly compare the numerical solution of both eqs 1 and 21 the zi solver was implemented also as a first order explicit finite volume solver to do so eq 21 is first integrated in a finite control volume a 22 a h t da a h 5 3 n z z da a r i da invoking gauss theorem yields 23 a h t da s h 5 3 n z z dl a r i da where s is the surface enclosing the volume a finally choosing polygonal cells comprised of n œâ sides as control volumes and choosing a piece wise constant representation of functions in the cells the semi discretization is achieved 24 h t r i 1 a i œâ 1 n œâ h œâ 5 3 n œâ z œâ z œâ l œâ where œâ denotes the edge between cells i and j h œâ is the estimated depth at the cell edge œâ a i is the area of cell i l œâ is the length of the edge œâ and z œâ is the water surface gradient across the edge note that z œâ is well defined at the edge but h œâ is not and must be estimated to cope with its bi valuated nature at such edge it has been shown that the na√Øve arithmetic mean between neighboring cells is computationally inefficient due to numerical stability issues in particular in the presence of complex topography dottori and todini 2011 mendicino et al 2015 hunter et al 2005 therefore a stable estimation proposed by hunter et al 2005 is implemented here 25 h œâ max h i z i h j z j max z i z j where i is the current cell and j the neighboring cell which shares edge œâ with cell i the semi discretization in eq 24 still requires to integrate in time in this work an explicit time discretization approach is adopted by using the standard forward euler approximation the complete numerical scheme reads 26 h i n 1 h i n Œ¥ t r i n i i n Œ¥ t a i œâ 1 n œâ h œâ n 5 3 n œâ z œâ n z œâ n l œâ eq 26 is the explicit finite volume solution to the zi equation fv zi analogous to other schemes reported in the literature cea et al 2010 fern√°ndez pato and garc√≠a navarro 2016 leandro et al 2014 wang et al 2011 the scheme is first order accurate in both space and time notice that 26 does not require any particular shape or arrangement for the computational cells but allows for fully unstructured meshes with convex polygonal cells a particular case of this is of course a structured mesh of squared cells herein we keep to this structured mesh only for the purposes of providing computational evidence comparable for most of the reported implementations of fv zi solvers and those termed as cellular automata zi which are usually restricted to structured cartesian grids the stability of the numerical scheme in eq 26 is formally governed by a von neumann vn stability condition since the zi equation is a non linear diffusion equation a modified vn condition was proposed by hunter et al 2005 to ensure stability avoid checkerboarding behaviour and prevent the time step to reduce excessively under near horizontal water surfaces 27 Œ¥ t Œ¥ x 2 4 min 2 n h œâ 5 3 h 1 2 where the water depth gradient h is 28 h h Œ¥ x h Œ¥ y if z h z h z Œ¥ x h z Œ¥ y if z h z where h z 0 is an ad hoc threshold value small enough to prevent checkerboarding and instabilities but large enough that it avoids extremely small time steps alternatives to the linearisation in eq 27 are for example to set an ad hoc minimum time step Œ¥ t min leandro et al 2014 or through an entropy fix deriving from hyperbolic theory and requiring a flux splitting approach lopez barrera et al 2012 however eq 27 though formal has been found to be too conservative dottori and todini 2011 wang et al 2011 probably due to the linearisation assumptions in the linear von neumann analysis wang et al 2011 proposed to use a cfl condition set in the order of 0 05 0 1 whereas dottori and todini 2011 identified that the time step values could be up to 10 larger than those computed with eq 27 without affecting the accuracy and stability of the solution therefore herein we also consider the cfl condition recalling that velocity at a computational edge is v q œâ h œâ 29 Œ¥ t cfl min œâ Œ¥ x h œâ q œâ 4 numerical experiments to benchmark and compare the applicability and efficiency of both models in rainfall runoff modelling problems both solvers are tested on a set of six test cases with incrementally increasing complexity the first two test cases are simple analytical solutions of rain over a constant slope with roughness the third is an experimental rain simulation over a sloping plane these tests allow to assess the basic capabilities of the models in terms of reproducing the basic phenomena in rainfall runoff the fourth and fifth cases are a laboratory experiment over an idealised urban catchment and a rainfall simulation experiment in a field plot both test cases introduce significant topographical complexity and allow to assess the capabilities of the models to handle complex topography and complex flow structures that develop because of it finally the last test case is one of rain on a real urban area all simulations reported here were performed only on structured cartesian meshes are studied since it the most frequent approach in the literature when numerically solving the zi equation caviedes voulli√®me et al 2018 all cases have dry initial conditions results are analysed with rmse 30 rmse k 1 n k Œ± k Œ≤ k 2 n k where Œ± and Œ≤ are the simulated and reference results respectively this is done for hydrographs and for depth and or velocity if reference results are available additionally in some cases the nash sutcliffe efficiency is also used for hydrographs since it is increasingly more clear that hydrograph metrics may not be sufficient to properly assess rainfall runoff results the evolution of the wet or flooded surface is also studied as they have been suggested to be more sensitive to model inaccuracies lim and brandt 2019 stephens et al 2013 wet or flooded areas are determined by thresholding the water depth fields areas with water depth larger than 0 0001 m are considered wet and otherwise dry in order to analyse spatial distributions of wet surfaces the flood critical success index œï bates and roo 2000 bernet et al 2018 hoch et al 2018 sampson et al 2015 is used 31 œï a swe a zi a swe a zi where a swe and a zi represent the flooded areas computed by the swe and zi models respectively a complementary indicator œà measuring to which model the differences in wet area are weighted towards is also defined 32 œà a swe a zi a swe a zi where a swe is the area predicted as wet by the swe model but dry by the zi model and vice versa for a zi the critical success index œï can vary in œï 0 1 where null means no match between models and 1 means a perfect match intermediate values represent different degrees of matching flooded regions not only in terms of surface area but also location and shape this metric penalises both underprediction and overprediction of flooded area sampson et al 2015 the second indicator can take values œà 1 1 where negative values indicate that the zi model predicts more flooded areas than swe and vice versa for positive values a value of zero may indicate both perfect match of flooded areas or simply an equivalent under and overprediction 4 1 constant rainfall on a plane the runoff generation on a sloping plane with constant rainfall is the simplest case that can be set up for a rainfall runoff simulation and therefore a good starting point to study and compare both solvers a so called na√Øve analytical solution for the discharge hydrograph was developed by delestre et al 2008 and is used here as a reference solution and has been used as a benchmarking solution rousseau et al 2015 the plane has a slope of 0 05 and a length of 4 m rainfall intensity was set to 50 mm h 1 friction is modelled by the darcy weisbach law with a friction coefficient of 0 25 the boundary conditions are all closed boundaries except the lowest boundary of the channel which is transmissive free outfall simulation time was set to 125 s the computational mesh was set to a structured square mesh with Œ¥ x Œ¥ y 0 040 m resulting in 3000 computational cells 100 along the length of the channel stability was governed by cfl 0 9 for both the swe and zi solvers fig 1 shows both the swe and the zi solutions h scheme for this case is clear that both solutions approximate well the reference solution the solution from the zi h scheme is accurate and stable for a cfl value of 0 9 rmse relative to the exact solutions is similar for both models 4 47 10 6 and 4 03 10 6 m 2 s 1 for zi and swe respectively both models slightly underestimate the rising limb of the hydrograph but they do so equally the recession limb is somewhat faster in the swe model which is to be expected as inertia plays a role in draining the channel downstream it is interesting that during rainfall both hydrographs are closer together suggesting that the inertial terms play a lesser role in the outlet runoff 4 2 variable rainfall on a plane a step up in complexity from the first test is time dependent rainfall on a sloping plane an obviously relevant issue in rainfall runoff simulation for which an analytical solution for the resulting hydrograph was proposed by govindaraju et al 1990 this case has been used for benchmarking by several authors gottardi and venutelli 2008 liang et al 2015 singh et al 2015 the plane has a length of 21 945 m and slope of 0 04 friction is modeled with ch√©zy s equation with a coefficient of 1 767 m 1 2 s 1 following the original setup of case b as termed by govindaraju et al 1990 the boundary condition at the outlet was set to as transmissive a free outfall the computational mesh was a structured square mesh with cell edge length of Œ¥ x Œ¥ y 0 109725 m resulting in 2000 computational cells 200 along the length of the channel simulation time was set to 4800 s and stability was governed by cfl 0 9 for the swe solver and for the zi cfl solver fig 2 shows the rain distribution and the resulting hydrographs computed with both solvers both solvers approximate well the shape and magnitude of the hydrograph peak discharge and time to peak are well captured slight differences exist in the shapes of the hydrographs but the overall properties are well kept a quantitative assessment of the errors is presented in table 1 time to peak is underestimated by all solvers but by less than 0 2 peak discharge is slightly overestimated by the zi solver and somewhat underestimated by the swe solver the rmse for discharge normalized by the reference peak discharge is quite low for all solvers as well altogether it is clear that both zi solutions with vn and cfl stability criteria eqs 27 and 29 respectively and the swe solver yield accurate results 4 3 experimental rainfall in a flume this test case is similar to the first but introducing experimental results kirstetter et al 2016 performed three rain experiments on a sloping flume with the goal of studying friction the flume was 4 04 m long 11 5 cm wide three cases with different rain and slopes were set up and summarised in table 2 kirstetter et al 2016 found it necessary to slightly adjust the rain intensity for numerical simulations to match the experimental results herein such calibrated values are also used the rain duration was 600 s after which the flume was left to drain the reported optimum manning s coefficient is 0 025 s m 1 3 and the friction factor for the darcy weisbach equation is 0 50 simulations were performed with the zi and swe with both manning and darcy weisbach friction laws and for zi both cfl and von neumann stability criteria were used all numerical solutions were computed with a mesh comprised of 300 square cells with a resolution of 4 cm all boundaries were closed except for the downstream end of the flume which was transmissive free outfall fig 3 shows the resulting hydrographs all simulations approximate the hydrographs reasonably well zi produces somewhat higher steady outflow than swe the difference in steady outflows produced by zi and swe is explained by the inherent differences in the equations when setting the temporal derivative to zero both in eqs 1 and 21 moreover it must be noted that the solutions with zi required a re calibration of both the manning roughness coefficient and the darcy weisbach friction factor to 0 033 s m 1 3 and 1 0 respectively this was done by trial and error on case a and then applied to the other two this is not unreasonable since the values reported by kirstetter et al 2016 were originally calibrated with a swe solver both friction laws produce nearly identical hydrographs regardless of the solver the initial rise of the hydrograph is faster in all simulations than the experimental data the reasons for this are unclear it is also unclear why there is no experimental discharge registered in the first 50 s case c shows a better agreement of the rising limb than a and b some differences are observed between the two stability criteria for zi in the rising limb and near the end of drainage but rather minor and maximal in case a in case b all zi hydrographs practically overlap as do the swe results for case c the match among hydrographs is better finally the decreasing limb of the hydrograph is better represented by zi in cases a and b but swe fits better in case c altogether the hydrographs suggest that both solvers both friction laws and both stability criteria are adequate fig 4 shows the comparison of predicted and experimental velocities and depths at steady state for all simulations quantitative errors from these results are shown in fig 5 in fig 4 for case a the swe appears to approximate both depth and velocity better than zi but with similar trends in cases a and b zi depths are lower than swe depth and vice versa for velocity case b shows the largest disagreement between zi and swe although it is hard to conclude which one is better from the profile itself in case c there is a better match between models and to the experiments but depth is lower for zi than swe in the upstream part and vice versa in the downstream part interestingly in contrast to how close discharge results are depth and velocity profiles show a larger variability in the results in response to the solver and friction laws which leads into the need of exploring several complementary metrics to assess the models the stability condition selected for zi appears to play no role in the accuracy of the zi solver it is interesting that without re calibrating roughness coefficients for case b and c in the former there are much larger differences compared to swe than in the latter fig 5 shows a summary and comparison of three quantitative indicators for several variables indicated by different symbols relative error rmse for depth and velocity and a modified nash sutcliffe efficiency for the discharge hydrograph i e 1 nse meaning that results are better when the indicator is near zero computed for zi were performed with both cfl and vn stability criteria results corresponding to vn are shown with small symbols the three cases proposed by kirstetter et al 2016 are differentiated in the figure by colors finally filled symbols represent manning s friction whereas empty symbols represent simulations computed with darcy weisbach in this way we intend to compare all errors as a set depth and velocity rmse errors were computed for the steady state t 599 s following the same procedure as reported by kirstetter et al 2016 the figure shows that the depth and velocity rmse in all three cases and for both friction laws and both stability conditions are higher for zi than for swe above the 1 1 line the discharge hydrograph modified nse shows that results are marginally better for swe and marginally better in case c case b appears to be the one in which in terms of velocity and discharge both models perform more similarly the friction law comparing filled against empty symbols produces differences in the quantitative assessment in general going from darcy weisbach to manning decreases the depth error for zi and vice versa for swe velocity errors decrease for both zi and swe when using manning s law except for case b the quality of discharge prediction is also changed but without clear structure changing from cfl to vn stability in the zi models results in negligible differences i e in the figure small symbols are practically always coinciding with the larger symbols furthermore 5 clearly shows that assessing results in terms of hydrograph signatures suggests that both models perform very similarly however the assessment of water depth and velocity errors shows larger errors for zi which nonetheless do not compromise the generation of hydrographs together with fig 4 they further suggest that it is likely that zi underestimates depth and correspondingly overestimates velocity in comparison to swe 4 4 rainfall experiment in an idealised urban catchment cea et al 2010 presented experimental and numerical results for a range of laboratory scale rainfall runoff experiments on an impervious surface with different arrangements of buildings the experimental catchment has dimensions of 2 2 5 m in this study a case with 12 buildings with no particular arrangement named a12 by cea et al 2010 has been selected the a12 case has also been used for benchmarking diffusive wave models by fern√°ndez pato and garc√≠a navarro 2016 and other cases have also been used for benchmarking numerical models su et al 2017 fig 6 shows the topography for the medium resolution mesh including the buildings for the test case the buildings are 20 cm high cea et al 2010 evaluated the effects of including the buildings as topographical features or alternatively removing them from the computational mesh finding no significant differences in the simulated outflow herein the buildings are kept as topographical features since portraying them as holes in the mesh would ideally require unstructured meshes which are not used here as previously explained all boundaries are closed except for the lower boundary which was set as transmissive computations were performed with four mesh resolutions summarized in table 3 the selected rain event has a constant rainfall of 300 mm h 1 during the first 20 s of the simulation after which no precipitation occurs the simulation was run up to t 160 s friction was modelled by manning s equation with a constant roughness coefficient of 0 016 s m 1 3 as suggested by cea et al 2010 fig 7 summarises results for this test case the results show that both the zi and swe models are capable of approximating the experimental hydrograph fig 7 a suggesting that both models are applicable and capable of solving this type of problems the accuracy to reproduce the hydrograph is clearly dependent on mesh resolution the behaviour of the vc mesh for zi is clearly poor with a strong overestimation of peak flow this is an indication that under this mesh is too coarse for an accurate zi solution in general the initiation of outflow is faster in all models than in the experimental data just short of t 10 s fig 7 b shows rmse for discharge normalised by the rain flow rate and is always below 0 01 the results are in general slightly better for swe than for zi peak discharge can be seen to depend on both the model and the mesh the peak discharge error is in the order 1 to 24 of the experimental peak discharge time to peak shows errors of up to 12 relative to the experimental time to peak as fig 7 b shows most of the error metrics are somewhat higher for zi cases than for swe but very similar to each other the exception is the time to peak with the coarse mesh in which swe resulted in a near zero error whereas for zi it is around 8 the worst results are obtained for zi with the vc mesh overestimates by 24 the peak discharge with a faster initial runoff and a faster drainage and with the fine mesh solved with zi with underestimation of peak discharge by 16 with a slower drainage the best overall results are obtained with the fine swe solution followed by both the medium zi and swe fig 7 a the errors confirm that the models perform most similar to each other for the medium mesh the different error indicators also show that the quality assessment of the models can be strongly dependant on the selected metric the coarse mesh serves as an obvious example as the rmse discharge error is practically identical the peak discharge error higher for swe but the time to peak is higher for zi in terms of the flooded fraction of domain fig 7 c the results show that swe results in persistently flooded domains whereas the zi solutions drain out faster this is consistent with what is observed in general terms in the receding hydrograph limbs the maximum flood extent varies depending on mesh and model although it is more consistent for swe mesh resolution appears to have similar effects on both models the vc mesh results in lingering flooded areas whereas the fine mesh shows the fastest decreasing flooded areas during drainage the lingering wet areas in the vc mesh are explained by the piece wise nature of the solvers the vc cells are comparatively very large which means that a given volume of water in that cell translates into a smaller depth than in finer meshes this results in a smoothing of water surface gradients even if the same volume of water is present in the domain which is suggested by the similarity of the swe hydrographs for example zi seems less sensitive in terms of flood extension to mesh changes f m c than swe during the drainage phase fig 7 d shows the flood geometry comparison indicator œï eq 31 flooded areas are most similar between both models during the rain as is to be expected since most of the domain remains wet at such time during the drainage phase œï decreases at approximately the same rate for all meshes however the finer meshes show that the match in flood geometry recovers quickly for the coarsest vc mesh the recovery occurs later that is for the finer meshes the flood areas match more during larger durations of the simulation than for the coarser ones interestingly for the vc mesh the final wet areas match better than for the finer ones this is explained by the standing water upstream of buildings which in the coarser meshes has less chance to flow this is clearly observed in the flood areas shown in fig 8 during the rain t 10 s differences in wet areas only occur around the building and are very minor however during the drainage phase t 40 s very clearly the zi solver results in a more concentrated water volume near the center of the domain whereas the swe allows for thin layers of water to remain extended this is also seen at later stages of drainage as flow stops and water remains ponded upstream of two buildings both models predict very similar flooded surfaces finally it is relevant to highlight that both the hydrograph and the error indicators do not show large differences in the general performance of both models and only medium variance among meshes flood extension and flood geometry are indeed different across models and meshes this suggests that domain integrated metrics such as the hydrograph are not enough to evaluate the differences in model performance and that spatial metrics are necessary to identify the different features of the solutions 4 5 thies runoff experiment tatard et al 2008 reported a rainfall simulation experiment held in a field in thies senegal it was later simulated by m√ºgler et al 2011 to study the effect of friction formulations this test has also used been used for benchmarking chang et al 2016 park et al 2019 simons et al 2014 weill 2007 the domain was a field plot of 10 4 m with a mean slope of 1 the experiment had a simulated constant rainfall of 70 mm h 1 during the first 180 s of the experiment after which the rain was stopped all boundaries are set as closed except the boundary at the bottom which is transmissive simulation time was set to 800 s allowing for a hydrograph with distinctive rising steady and drainage phases friction was modelled with manning s equation with a constant roughness coefficient of 0 02 s m 1 3 m√ºgler et al 2011 infiltration was set to a constant rate of 0 0041667 mm s 1 m√ºgler et al 2011 to test the performance of the numerical models four computational meshes with varying resolution were designed which are summarized in table 4 fig 9 shows the dem mapped at the finest mesh resolution along with the locations of 62 velocity sampling locations where steady state velocity was experimentally measured stability of the swe solver was controlled by cfl 0 9 and for zi by cfl 0 1 fig 10 summarises results for the thies test case 10 a shows the outflow hydrographs for both the zi and swe models and all meshes experimental hydrographs are not available the overall behaviour of the eight simulations is very similar all cases achieve the same maximum steady discharge the zi model with the vc mesh exhibits a noisy behaviour which is due to mesh coarseness in particular near the outlet boundary in general terms fig 10 a shows that the transformation of rainfall into runoff including infiltration runoff partitioning is similar for both models and across meshes in turn suggesting that all are valid for hydrological rainfall runoff simulation fig 10 b shows the flooded area fraction of the domain and fig 10 c shows the œï indicator for the match of flooded areas both indicators show that during rain practically the entire domain is the same as the rain stops the zi model predicts less area flooded than the swe e g t 200 s and only around 75 of the wet areas are predicted as such by both models there is a subtle trend across mesh resolutions the flooded area from both models is during most of the simulation inversely proportional to resolution the differences in flooded area during the rain are larger for zi than for swe but this trend inverts during the drainage phase in terms of the match in flooded areas among both models fig 10 c suggests that all meshes perform similarly with less differences observed for finer meshes to better asses the quality of the models fig 11 compares steady state velocities computed with both numerical models against the reference results of tatard et al 2008 and m√ºgler et al 2011 including linear fits both models show accurate performance in the lower velocities while systematically underestimating higher velocities there is some variability related to the mesh for zi fig 11a the linear fits show practically the same slope with a very small bias among them that is all four meshes predict similarly well the velocities the swe model fig 11b shows a wider spread of the linear fits with slightly different slopes with the fine mesh providing best results complementary fig 11d shows the comparison between both models showing that the zi model consistently produces steady state velocities slightly higher than swe across all velocity ranges the figure also shows that the predicted velocities are in better agreement among the two solvers for finer meshes in order to quantify the performance the coefficient of determination r 2 and rmse of velocities are shown in 5 the range of r 2 between zi and the experimental results is similar to the range of r 2 for swe within each model the variations of r 2 across resolution are relatively small roughly 4 and 5 respectively relative to the mean r 2 across meshes the tendency for the zi model is that r 2 decreases with increasing resolution whilst for swe r 2 increases with resolution except for the coarse mesh which shows a slight decrease the latter is the expected behaviour according to numerical schemes theory but the former is unusual for zi the r 2 suggest that the best steady solutions are obtained with coarser meshes this may be explained by the nature of the discretisation error of the first order schemes for swe hyperbolic advection equation the discretisation error is of order o Œ¥ x 2 non centered first order whereas for the zi parabolic equation it is of order o Œ¥ x 4 centered first order anderson et al 1984 this makes zi less sensitive to mesh coarsening as suggested by ponce 1986 in a 1d context see table 6 the coefficient of determination was also computed between both models to quantitatively compare how similar the results are r 2 between both models steadily grows with resolution and they show that both models better predict each other than the experimental results this suggests that the main sources of error relative to experimental results come from spatial discretization mesh size choice of the friction model m√ºgler et al 2011 and parametrisation but not really from either the simplification inherent to zi or the numerics of either model the rmse values also show that for zi marginally better results are obtained for the coarsest mesh all four meshes produce very similar rmse with zi with a range of 2 8 of the mean across meshes swe however is considerably more sensitive to the mesh with a range of 27 relative to the mean of all meshes that is both rmse and r 2 suggest a stronger dependency of the quality of the solution based on the mesh finally both indicators confirm that the models predict each other better than the experimental results fig 12 shows the relative error in velocity at the experimental gauge points at their locations in the domain experimental velocity is compared against zi fig 12 a d and against swe fig 12 e h results zi and swe are compared to each other in fig 12 i l note that the color scale shows a wide range of relative errors the most accurate velocities for both zi and swe are observed in the main drainage channel of the domain the highest differences in velocities overestimating experimental results occur at the top of the experimental catchment swe appears to achieve better results than zi on the gauges located near the south west corner of the domain where zi also overestimates velocities there a few gauges in which there are consistently large underestimations notably one at the center of the channel near the outlet different mesh resolutions do not significantly alter the structure of the spatial distribution of errors comparing the simulated velocities of zi against those from swe there is a clear trend along mesh resolution as already shown in fig 11c similar to the comparison against experimental velocities both models agree better on their predicted velocities at the main channel where more water is available the largest disagreements occur where there are thin layers near the top regions of the domain fig 13 shows depth fields for both the zi and swe solvers at two times during the steady state t 150 s and during the drainage phase t 235 s during steady flow t 150 s only very small differences can be appreciated loss of details does occur for the coarser meshes but the overall flow features and structures are still present even in the coarsest mesh in contrast during the drainer phase 235 s the depth field shows a larger sensitivity to mesh coarsening in particular for the vc mesh the c mesh does not significantly smear the flow features in the zi case in contrast mesh coarsening introduces larger differences in the depth field are observed for swe than for zi zi also results in a faster drainage of the surface except for the fine mesh where both zi and swe result in similar wet areas at t 235 s this is further explored in fig 14 which compares flooded areas for both models regions predicted as flooded by both models are shown in green blue regions are those wet in swe simulations but not zi and vice versa for orange regions white areas are predicted as dry by both models it can be clearly seen that for all meshes very shallow layers linger longer in the swe solution whereas the zi solution favors a more concentrated drainage as suggested already by fig 10 the matching flooded areas green regions are qualitatively very similar across meshes but the areas flooded only in the swe are somewhat more sensitive 4 6 urban area test case this test is of rainfall on an urban area in glasgow scotland and is included as one of the uk environmental agency benchmarking tests n√©elz and pender 2010 the domain size is 400 960 m the topography is shown in fig 15 at 2 m resolution this test is often used for benchmarking courty et al 2017 hu et al 2018 savant et al 2019 the original dtm has a resolution of 0 5 m in the test case there are two sources of water one is a single pulse of rain with intensity of 400 mm h 1 during 60 t 240 s the second is a point source indicated as s in fig 15 with a time dependent flow rate n√©elz and pender 2010 for 1380 t 3300 s with a flow rate peak of 5 m 3 s at t 2220 s all domain boundaries are closed therefore no outflow hydrograph can be computed the roughness coefficient is somewhat heterogeneous roads and pavements have a manning s coefficient of 0 02 s m 1 3 and everywhere else has a coefficient of 0 05 s m 1 3 nine probes shown also in fig 15 are also included for result comparisons simulation time was set to 18000 s fig 16 shows indicators for the flooded area evolution during the simulation for post processing purposes cells are considered flooded if the water depth is larger than 1 mm in all cases fig 16a shows that all simulations predict similar flooded fractions of the domain and similar evolution of the flood zi predicts smaller flooded areas for t 3000 s and overpredicts the flooded fraction afterwards towards the end of the simulation both models predict very similar flooded areas at such time zi predicts a flooded area between 0 6 fine and 1 coarsest larger than the corresponding swe solution to further examine differences in the model the evolution of the flood overlap indicator 31 is shown in fig 16b the figure shows that the three coarser meshes vc c m behave similarly and show similar values throughout the entire simulation time with the m mesh producing the best match between models the fine mesh however behaves differently and shows that for this mesh the models predict different flood distributions initially œï for all meshes starts at 1 since the domain is completely dry as the domain floods differences between zi and swe appear the largest differences in flooded areas occur lowest values of œï during the rain 60 t 240 s and shortly thereafter as the water redistributes over the surface the flooded areas of both zi and swe become more and more similar with over 0 9 for the coarser meshes and around 0 5 for the fine mesh this means that for the fine mesh although the size of the flooded area is only 1 different between zi and swe roughly only 52 of the flooded areas are predicted to be flooded by both models at the end of the simulation it is surprising that for coarser meshes this values is between 91 and 95 complementary fig 16 c shows that œà is mostly positive for t 3000 s clearly showing that swe predicts larger flooded areas during this initial time after such time œà becomes negative showing the larger flooded areas estimated by zi furthermore œà 0 5 by the end of the simulation for vc c and m but close to zero for the fine mesh this means that for the coarser meshes roughly zi only flooded areas are around 50 larger than swe only areas in the case of the fine mesh the areas are approximately equal altogether the results in fig 16 show in general a good agreement between the models but a higher discrepancy in the spatial distribution of water for the finest mesh these differences can be explicitly observed in fig 17 which compares the differences in flooded areas for selected times white and green areas are those where both models predict dry and flooded surfaces respectively orange areas are those in which zi predicts a flooded surface and swe does not blue areas are where swe predicts a flooded surface and zi does not from the figure it is clear that a majority of the flooded surface and in particular all large clusters of flooded surfaces are captured by both models large green areas regardless of resolution in the early times of the simulation t 900 s the high regions of the domain are draining fig 17 shows how the swe model predicts lingering wet surfaces which continue to drain after longer than predicted by the zi model blue areas explaining the larger flooded areas in fig 16a as the water redistribution continues it can be seen that orange and blue areas remain i e areas in which one or the other model but not both predicts flooding for the coarse resolution more orange than blue areas are visible as suggested by the behaviour of œà in fig 16 c for the fine resolution a large number of isolated orange and blue regions shows ponded water in many places throughout the domain which are the cause of the low value of œï this suggests that under higher resolution the runoff trajectories predicted by zi and swe are less prone to match although it is not possible to ascertain which of the two fine mesh solutions is better the clearly larger differences produces suggest that at higher resolution and perhaps smaller flow scales inertial terms play a higher role finally fig 18 shows water elevation results at three of the probes shown in fig 15 probe 2 and 7 lie near the northern slopes whereas probe 5 lies in the middle of the domain the figure shows results for both models and all four meshes as well as the envelope of the numerical results from a variety of models reported by n√©elz and pender 2010 additionally the terrain elevation at the probe point for each mesh resolution is also represented as a dotted line firstly the figure shows that most of the numerical results computed with either zi and swe are within the envelope of results reported by n√©elz and pender 2010 of more interest to this work are the differences between zi and swe across the different resolutions all three probes in fig 18 show a reasonable agreement between the zi and swe solutions at each resolution although larger differences are clear among resolutions these differences are partially explained by the different terrain elevations represented in the different mesh resolutions introducing a bias in the water surface elevation interestingly the largest differences between zi and swe solutions are observed for the fine mesh consistently with previous indicators there is no clear comparative trend between zi and swe water surface elevation results at these probes in probe 2 zi predicts lower water elevations than swe the opposite happens at probe 5 and probe 7 shows a mix although mostly shows higher surfaces from zi 5 computational performance computational performance was measured for two test cases performance was measured in simulation runs in which no output was written to disk to ensure that only computational time is compared furthermore in the spirit of fair comparison for real large scale applications all the tests were performed with different number of processors on a desktop computer from 1 to 6 to briefly assess the benefits of shared memory parallelisation openmp for these models and applications all computations were performed on a desktop computer with an intel i7 3930 k cpu 3 20 ghz with 6 cores it is relevant to highlight that the computational implementation of both numerical models is similar the structure is analogous i e both models first solve for edge based flux computations and later update cells memory structures and algorithms are overall analogous albeit not identical for obvious reasons the goal of this is that the numerical models can be fairly compared in terms of computational efficiency evidently implementations can always be improved but nonetheless both implementations used in this study are expected to be highly comparable computational times for test cases 4 1 4 2 and 4 3 are for both zi and swe below 1 s since the computational meshes have a low cell count and the duration of the problems is very short the differences in cpu time for these cases is strongly affected by initialisation time and writing times which makes comparisons for these cases rather non significant computational time for test case 4 6 computed with 6 cores is reported in table 7 it is clear in the table that the zi solver can compute up to five times faster than swe for the coarsest meshes but up to five times slower for the finer meshes computational time for the rainfall experiment over an idealised catchment section 4 4 and for the thies experiment section 4 5 are shown in fig 19 note that the vertical axis is logarithmic to appreciate the wide range of magnitudes the figure shows as expected that with more cpus computational time decreases for both solvers and all meshes except the vc and c meshes in fig 19 a this can also be clearly appreciated in speed up shown in fig 21 the swe solver is faster than the zi solver in both test cases this is true across resolutions and number of processors this observation is consistent with previous ones cea et al 2010 costabile et al 2017 wang et al 2011 who concluded that explicit zi solvers were computationally inefficient fig 20 shows the zi to swe ratio of cpu time controlling for each mesh i e values larger than unity indicate that the zi solver takes longer than the swe solver for the same mesh the figure shows a very clear trend coarser meshes show a smaller ratio i e the zi solver is comparatively less inefficient than the swe solver for coarser meshes from a practical point of view this means that the zi solver might be competitive at very coarse resolutions assuming such resolution is enough for the whatever the purposes of the simulation may be and assuming that results are accurate enough this can be explained following that the stability of the zi solution is proportional to Œ¥ x 2 while for the swe solver it is proportional to Œ¥ x cea et al 2010 leandro et al 2014 therefore time step size can grow faster for the zi solver as the mesh is coarsened in practice it also means that for a particular mesh resolution time step size is smaller for the zi solver as a corollary it must be pointed out that if there is a requirement for high spatial resolution for whatever reason may it be accurate topographical representation or that high resolution results are required then the zi solver will not be competitive despite the fact it may be accurate enough for the intended purposes additionally the figure shows that for increasing number of processors the ratio is rather constant although there is a very weak trend for the ratio to increase somewhat with a growing number of processors this suggests that the implementations are scaling in similar way which in turn is a symptom that the implementations are comparable note that the range of ratio values is very different depending on the test case in the idealised urban rainfall test the fine mesh shows a ratio of around 5 times larger than for the very coarse mesh and the medium and coarse meshes result in similar ratios however for the thies experiment all meshes result in different ratios with the fine mesh producing ratios around 10 times larger than the coarse mesh this means that for the idealised urban rainfall zi is less computationally inefficient compared to swe than in the thies case this is likely to be related to the particular dynamics of the flow fields and possibly strongly related to the drainage pattern as drying cells impose a strong computational time step constraint parallelisation speed up is shown in fig 21 the trends for the swe and the zi solvers are similar suggesting that both implementations are comparable the relatively small size of the problem generates that the vc and c meshes in 21 a have a decrease in speed up for 6 processors the speed up trends show slopes smaller than unity showing that for the simulations reported in this work there is still a significant number of non parallelised operations this may be for a number of reasons firstly there are indeed non parallelisable parts of the code second speed up tends to be better as the problem has a larger number of cells since it is precisely the sheer size of the numerical system which governs the cost it may be that the tests computed here are somewhat small thirdly rainfall runoff simulation entails a frequent occurrence of wetting and drying of cells thus introducing time step restrictions which cannot be solved by parallelisation this is likely also to contribute strongly to not achieving higher speed ups as reported for example in fluvial modelling interestingly although the idealised urban rainfall case shows similar speed up trends for both models the thies case shows a much better speed up for swe than for zi this difference is likely to be related to particular flow dynamics together with fig 20 it suggests that the higher topographic complexity and likely its impact on wetting drying interfaces generates a higher penalty for zi resulting in a higher cpu time ratio and lower parallel speed up moreover cpus which may be at times operating mostly on dry cells over which computations are not performed can become an inefficiency 6 conclusions this paper presents and extensive comparative assessment of swe and zi solvers for rainfall runoff simulations the numerical experiments show that rainfall runoff simulation is feasible and reasonably accurate using both explicit zero inertia solvers as well as explicit swe solvers the accuracy assessment shows that as expected the swe model performs overall better than the zi model however the individual assessment of metrics is more complex hydrological signals hydrographs are similarly accurate and the overall behaviour of model results is similar comparisons of water depths and velocities mostly under steady states usually show a somewhat poorer fit of zi results in some cases a larger agreement between the two models than agreement of the models to experimental measurements is found showing a higher uncertainty related to calibration than to the simplification between the models there are differences between the hydrodynamic fields but not critical for hydrological results to become compromised larger differences are observed when assessing spatial distributions for instance in terms of flooded area or the rate at which a surface dries out or the fact that larger differences seem to occur where the thinest water layers are present however spatially distributed reference data is often unavailable this prompts a corollary to properly assess rainfall runoff model performance hydrographs are not enough and spatial information must be considered this is in fact a growing concern in hydrological modelling bernet et al 2018 savage et al 2016 stephens et al 2013 yu and coulthard 2015 the similar flow fields and the differences relative to experimental data obtained by both models suggest also that further work is necessary to improve the representation of friction of thin water layers over natural terrains grismer 2016 and the possible interaction with numerical viscosity and model calibration efforts caviedes voulli√®me et al 2012 this highlights the need to perform multi criteria assessments to find where model inaccuracies might manifest the results here also evidence a rather low sensitivity of zi to the mesh supporting previous observations yu and coulthard 2015 the comparison shows that the zi model can be less sensitive to the mesh than the swe model which in turn implies it might perform better than swe when coarse meshes yet not too coarse are used this seems related to mesh induced diffusivity or viscosity which is larger for coarser meshes this has grounds in the theory of numerical viscosity and because swe are advective hyperbolic equations are more prone to this artifact producing an overestimation of friction forces and underestimation of velocity in the swe model decreasing mesh resolution appear to affect more the simulated swe velocities than the zi velocities signaling that the discrete solution of the diffusion dominated zi may be less affected by numerical viscosity than swe as can be derived from theory that is coarse meshes do not allow to fully exploit the higher capabilities of the swe model appropriately it must be stated nonetheless that other authors have reported zi solutions to be very sensitive to resolution yu and lane 2006 although this is often related to poor channel geometry representation savage et al 2016 this discrepancy is most likely problem dependent in terms of computational efficiency the results lead to the conclusion that the explicit zi solver is less efficient than the swe solver this observation is consistent with other results in the literature strongly suggesting that this is the general behaviour for such models and that the conclusions are quite independent of reasonably mature implementations the main reason for the high computational cost of zi is the number of time steps required to complete the simulations that is the number of time steps is substantially larger than in the fv swe solver it must be substantial since the cost per time step in the fv swe solver is greater than in fv zi simply because there are more equations variables and overall operations per time step the increased number of time steps comes from a very reduced time step size due to a highly constraining stability requirement in fact it appears that the stability restriction imposed on zi solvers is much worse than for swe solvers due to the parabolicity of the equation in contrast to the hyperbolicity of swe the observations in this study are further evidence of this and agree with previously reported results cea et al 2010 costabile et al 2017 wang et al 2011 they also suggest that the somewhat more advective nature of local inertia formulations bates et al 2010 de almeida et al 2012 is a reasonable approach to alleviate this issue in all these results suggest that in order to speed up fv zi solvers it is necessary to explore some other directions i to improve the stability restrictions perhaps by reverting to local inertia formulations bates et al 2010 de almeida et al 2012 ii to pursue some kind of local time stepping solution dottori and todini 2011 since there is a high variability in global time step size throughout the simulation together with a very large spatial variability of cell wise time step restrictions one of the key reasons are drying cells which represent the strongest restriction for time step size this issue is particularly aggravated for rainfall runoff simulations contrary to for example river flood simulation since the likelihood of a cell becoming dry and wet again and dry again etc is particularly high due both to the variable and even intermittent nature of rain and the very small depths that develop during rainfall runoff processes iii attempting to formulate optimal implicit time step sizes fern√°ndez pato and garc√≠a navarro 2016 although parallelisation may not be as efficient the results also suggest that the gap in computational efficiency between both models is reduced for very coarse meshes therefore if the modelling application requires for whatever reason a high spatial resolution not only will the swe model be marginally more accurate it may be significantly faster to execute conversely if coarse resolution is acceptable for example because there is only coarse resolution topographical data the zi model can result in accuracy not far from the swe model and the added cost may not be not critical this is however often not the case since stream channel geometry is often lost at coarser resolutions savage et al 2016 and highlights that locally refined unstructured meshes caviedes voulli√®me et al 2012 fern√°ndez pato and garc√≠a navarro 2016 may play a relevant role in the applicability of zi solvers in other words zi solvers are comparably efficient and perhaps less prone to accuracy loss than swe solvers in the presence of coarser meshes this can be highlighted as a key result from the comparison presented here one key advantage of explicit fv zi solvers over fv swe solvers is that the former are theoretically and mathematically simpler and easier to understand significantly simpler from a numerical point of view and their implementation is much less demanding than for swe solvers it naturally follows that if computational efficiency is a relevant concern fv swe should be favoured although the development process is longer and more complex alternatively the fv zi should be favoured when it is necessary to quickly develop a model from scratch and or if the applications will only require or allow coarse discretisations the context of our results observations and conclusions is strictly within rainfall runoff problems we must highlight that the evidence presented here and the derived conclusions may not hold in general for other types of free surface flows in particular as has been pointed out in previous literature aric√≤ and nasello 2018 costabile et al 2017 savant et al 2019 yeh et al 2011 strongly hyperbolic flows with moving shock waves for example cannot be accurately solved by the zi approximation moreover even within the context of rainfall runoff simulations increasingly hyperbolic flows will likely lead to further reduce the accuracy of zi it is likely that high slopes and dense drainage networks bout and jetten 2018 under very intense rainfall events i e leading to flash floods huang et al 2015 lead to such conditions in the broader context of hydrological modelling based on zi models exploring which geomorphic properties of catchments and under which rainfall conditions such inertial and hyperbolic flows would produce inaccurate zi simulations still remains to be explored this may be particularly relevant for erosion sediment transport and geomorphic processes wohl 2018 the analysis of which may be one more argument in favour of swe solvers finally the general applicability of our conclusions is limited by assessments mostly performed at steady state in particular for hydrodynamic fields it is possible that larger differences between swe and zi may be found for transient states with increased implications to erosion and sediment processes which clearly calls for further experimental evidence during transient rainfall runoff flows credit authorship contribution statement daniel caviedes voulli√®me conceptualization methodology software validation investigation formal analysis writing review editing javier fern√°ndez pato methodology software validation investigation writing review editing christoph hinz conceptualization writing review editing supervision project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the first author would like to thank dr luis cea for facilitating the data required for the idealized urban catchment case and prof dr pilar garc√≠a navarro for facilitating the use of the swe solver the second author acknowledges financial support for this work through research grant di 14 06987 from the spanish ministry of economy mineco 
5614,to understand the influence of aquatic vegetation on flow structures and sediment deposition field experiments were conducted in a floodplain with water movement dominated by unidirectional current flow velocity suspended sediment concentration and sediment deposition were measured within and without vegetation at four sites covered by phragmites communis reed artemisia selengensis carex cinerascens and a mix of them results show that the presence of vegetation reduced the time averaged velocity and turbulent kinetic energy tke and altered vertical distributions of the time averaged velocity and tke for emergent conditions both the time averaged velocity and the tke were uniformly distributed through the entire water column two layers were separated at the top of vegetation for submerged conditions within vegetation both the time averaged velocity and tke were decreased and uniformly distributed similar to observations under emergent conditions the discontinuity of drag force at the top of vegetation generated a region with rapidly increased velocity near the vegetation interface tke reached its maximum near the top of vegetation and decreased gradually toward both bed bottom and water surface in present study canopy with larger frontal area caused bigger reduction of time averaged velocity and tke within vegetation by reducing the mean and turbulent velocities the presence of vegetation decreased the depth averaged suspended sediment concentration by 30 50 and increased the thickness of sediment deposited over one flood season by as high as 190 when compared with bare bed keywords aquatic vegetation turbulence sediment transport floodplain evolution dongting lake 1 introduction aquatic vegetation av commonly distributed in rivers lakes and coastal regions provides a wide range of ecosystem services as the primary producer they are the foundation of food web and create various habitats e g kemp et al 2000 green and short 2003 av can also stabilize the seabed othman 1994 protect shorelines fonseca and fisher 1986 lorenz et al 2015 and enhance local water quality moore 2004 larkum et al 2006 according to the economic evaluation of these ecosystem services the global value of av has been estimated to be 6 8 trillion dollars per year costanza et al 2014 some of the ecosystem services mentioned above arise because the presence of av changes the local flow conditions especially the turbulent flow structure by directly controlling the circulation of mass and momentum in water flow turbulence is the basic power for mass transport in water body of rivers lakes and coastal regions for example the rate of nutrient uptake and cycling is mediated by the mass transfer between plants and surrounding water and thus strongly depends on the characteristics of water flow and turbulence csanady 1973 koch and gust 1999 turbulence near the bed also determines the initiation of sediment motion and sediment resuspension yang et al 2016 zhang and nepf 2019 av exerts resistance on water movement which makes the mean and turbulent flow structures different from canonical open channel flow based on laboratory experiments employing model vegetation nepf and vivoni 2000 showed that the velocity within canopy had a range of behavior depending on the depth ratio defined as the ratio of water depth h to canopy height hv as the limitation of light penetration most aquatic vegetation occurs in the shallow submergence with h hv 5 e g chambers and kalff 1985 duarte 1991 for emergent conditions h hv 1 the velocity is determined by the variation in vegetative drag which is proportional to the frontal area of canopy e g nepf and vivoni 2000 lightbody and nepf 2006 eddies within the emergent canopy are dissipated to the scale of stem diameter or the average distance to the nearest neighboring stem and the turbulent kinetic energy tke is a function of time averaged velocity stem density and plant morphology parameters tanino and nepf 2008 for dense submerged vegetation 1 h hv 5 with the roughness density Œªf ahv with a representing the frontal area per canopy volume 0 1 under unidirectional current a canopy scale turbulence is produced near the top of canopy dominating the momentum transfer between streams within vegetation and its overlying region e g nepf et al 2007 ghisalberti and nepf 2002 2004 2006 specifically both the reynolds stress and tke reach their maximums at the top of vegetation e g nepf and vivoni 2000 pang et al 2014 zhang et al 2016 whereas they are reduced near the bed by the canopy drag e g ghisalberti and nepf 2002 if the canopy is sparse Œªf 0 1 the velocity profile exhibits a turbulent boundary layer form and the reynolds stress and tke remain elevated close to the bed e g luhar et al 2008 besides the vegetation morphology has great effect on the mean and turbulent flow structures and its impact on flow structures can be ultimately attributed to the factor of canopy frontal area e g leonard and luther 1995 leonard and croft 2006 zhang et al 2016 the alteration of flow structure by av influences the pattern of sediment transport a series of flume experiments using artificial vegetation and sediment particles were conducted in nepf lab at mit major findings showed that particle deposition was enhanced within and directly behind the vegetation patch in which both the mean and turbulent velocities were diminished e g chen et al 2012 schoelynck et al 2012 follett and nepf 2012 ortiz et al 2013 de lima et al 2015 liu et al 2018 most findings on vegetated flow and sediment transport were concluded from idealized flume experiments field measurements that mainly conducted in coastal regions with salt marshes also provided new insights about flow structures within canopy for example leonard and luther 1995 found that the mean flow velocity and turbulent intensity within salt marsh canopy were inversely related to stem density and distance from the leading edge of canopy leonard and croft 2006 found that the vertical component of mean velocity and turbulent intensity were reduced more strongly than the horizontal within canopy suggesting that turbulence contributes more to lateral advection than to vertical mixing within vegetation neumeier and amos 2006 also measured the suspended sediment concentration profiles within canopy and reduced sediment diffusion due to lower turbulent intensity compared with bare bed was observed however to our knowledge few field studies concentrate on both flow structures and sediment transport under the influence of av in this study field experiments were conducted in a floodplain to investigate the influence of vegetation on the mean and turbulent flow structures and sediment deposition under unidirectional current three vegetation species i e phragmites communis artemisia selengensis carex cinerascens under emergent and submerged conditions were considered section 1 above has reviewed previous studies about the flow structure and sediment deposition within vegetation section 2 gives a brief description of the flow sediment conditions of the study area locations of the four study sites selected for measurement and the vegetation distribution for each site the experimental setup and methods are described in section 3 section 4 discusses the flow structures i e vertical distributions of the time averaged and turbulent velocities suspended sediment concentration profiles and sediment deposition patterns in regions with and without vegetation 2 study areas dongting lake the second largest fresh water lake in china is located in the middle reach of yangtze river it has a water surface area of 2625 km2 and mean water depth of 6 39 m xie et al 2014 the lake consists of three parts which are called east dongting lake south dongting lake and west dongting lake respectively fig 1 a dongting lake receives water inflows from yangtze river through three channels i e songzi taiping and ouchi and also inflows from the south which covers almost the entire drainage of hunan province via four rivers i e xiang zi yuan and li the water of the lake system is finally discharged into yangtze river at chenglingji with its location marked as the black triangle in fig 1a the seasonal changes in precipitation and inflows from yangtze and four tributary rivers result in the annual variation in water level and thus the formation of inundated areas in the dry season the lake area is normally less than 500 km2 whereas it increases to more than 2500 km2 in the flood season the drastic fluctuation in water level and lake area provides the basic hydrological regime for maintaining large areas of beach wetland the most dynamic landscape within the dongting lake area the floodplains in dongting lake are rich of av with more than 1000 species of vegetation found to be distributed in the high medium and low level of the floodplain olson and dinerstein 1998 fang et al 2006 dongting lake is also a lake enduring severe sediment deposition there is approximate 1 18 108 m3 multi years averaged sediment which comprises 82 of the total sediment influx in dongting lake carried into dongting lake each year flow vegetation and sediment interact with one another making the floodplain an ideal place for studying the vegetated flow and sediment transport the study area was chosen at a floodplain formed at the estuary of ouchi river flowing into east dongting lake fig 1a the floodplain is dominated by phragmites communis reed grown in the higher land in the lower elevation of the floodplain many other types of vegetation including the carex cinerascens phalaris arundinacea and artemisia selengensis are also distributed influenced by the annual variation of inflow from yangtze river the hydrodynamic conditions e g water level flow velocity in the floodplain vary through the entire year fig 2 a in the dry season with low water level the water areas are retreated to the mainstream of the river and the floodplain is exposed to the air the water level increases in the wet season and the floodplain is flooded with the fluctuation of water level av in the floodplain is under different submergence conditions four sites named 1 2 3 and 4 from downstream to upstream along the channel were chosen at the relatively flat bank of ouchi river fig 1b the dominant vegetations in these four sites were different from sites 1 to 4 the dominant vegetations were reeds a selengensis mixed with reeds c cinerascens and a selengensis respectively table 1 measurements of velocity and suspended sediment concentration in sites 1 2 3 and 4 were conducted in july 14 june 27 26 and 25 respectively in the year of 2016 with these four sites located in east donting lake the nearest control hydrological station was chenglingji station see fig 1a assuming the water level processes in these four sites same with that of chenglingji station the water level through 24 h varied within 0 08 in jun 25 fig 2b 0 32 in jun 26 fig 2c 0 40 in jun 27 fig 2d and 0 23 in jul 14 fig 2e 3 methods and materials to compare the flow structures and sediment deposition in regions with and without vegetation the original vegetation on the upstream half part of each site was removed before the site was flooded fig 3 dimensions of both the unvegetated and vegetated regions for each site are presented in table 1 after the removal of vegetation the stem density m stems per bed area for each site was estimated by randomly choosing three 1 m 1 m quadrats in vegetated region recall that the site 2 was dominated by a selengensis mixed with reeds stem densities of these two types of vegetation were both measured five strains of plant were chosen from each quadrat and the vegetation height hv stem diameter d and the maximum blade width wmax were measured to describe the plant morphology the stem density and plant geometry parameters for each site are listed in table 1 the phragmites communis reed has rigid erect and cylinder like stem fig 4 a several knots where flexible blades grow are distributed on the stem in lacustrine and riverine wetlands the tall stem of reed makes it usually under emergent condition h hv 1 as the blades can rot and fall off on the bed when they are under water for a long time reed blades are usually distributed above the water surface and only stems without blades are underwater artemisia selengensis also has rigid and cylinder like stems and flexible lanceolate blades fig 4b generally several stems are grown for each individual plant of a selengensis and these stems are divided at the base of plant therefore the number of stems not individual plants per unit area was recorded as the stem density with 3 4 blades bundled together the blades are uniformly distributed from top to bottom for each stem in present study the a selengensis was distributed in sites 2 and 4 table 1 with different heights of vegetation and water depth a selengensis was under emergent and submerged conditions in sites 2 and 4 respectively carex cinerascens has thin and erect stem with small height fig 4c which makes the c cinerascens always under submerged conditions when flooded the blades of c cinerascens are lanceolate and mainly distributed in the upper part of the stem in order to measure the sediment deposition 10 steel cylinders with 1 m in length and 1 5 cm in diameter for each were inserted into the sediment at each site before the region was flooded fig 3 when inserted into the sediment the cylinders extended at least 0 5 m above the bed for each site the steel cylinders were aligned longitudinally in 4 m increments and 4 and 6 cylinders were inserted in the unvegetated and vegetated regions respectively positions for all cylinders at each site were x 14 10 6 2 2 6 10 14 18 and 22 m with x 0 representing the leading edge of canopy before the sites were flooded the height of cylinder left above the bed was measured and represented as ts 1 after flooding with the water receding out of site the cylinders height represented as ts 2 was measured again thickness of the sediment layer deposited over the entire flood season ts at a specific position can be expressed as 1 t s t s 1 t s 2 with ts greater and less than zero representing sediment deposition and erosion respectively the flooding duration fd days of inundation for each site was estimated by counting the days with the water level larger than the elevation of site surface which can be calculated by subtracting water depth from the water level when measuring assuming the water level of floodplain equal to that of chenglingji station the fd for each site was estimated and presented in table 1 instantaneous velocities ue un uu corresponding to the east north and up directions respectively were measured using a 3 d acoustic doppler velocimeter adv nortek vector with enu coordinated system as adv measures flow velocity at a specific point i e 15 cm downward the probe tip the measurement of velocity profile needs to move adv vertically in this study a self made field observation system fos fig 5 was used the fos consisted of four parts i e the detachable ti alloy support a motor 24 v batteries and the control panel the ti alloy support was a cubic frame with 1 2 m long 1 2 m wide and 3 m high the motor powered by the 24 v batteries drove the chains at two opposite sides of the support moving circularly through the gear connected to the chains a sliding board can move up and down and the movement was controlled by a button on the control panel adv was fixed at the middle of sliding board the nearest distance between the adv probe and the support frame was 0 6 m which was sufficient to keep the probe from being disturbed by the frame a rotary encoder was installed inside the motor to record the rotational arc length of the gear which was equal to the moving distance of the sliding board and shown on the grating digital display meter on the control panel considering the number of the measurement points required for each velocity profile and the variation of hydrodynamic conditions i e water level and flow velocity during measurements velocity was recorded for 2 min at each measurement point with sampling frequency of 16 hz for each site two vertical distributions of velocity located at x 10 m in unvegetated region and x 10 m in vegetated region midway along the site width were measured according to the model proposed by chen et al 2013 uniform flow conditions can be reached at x 8 5 m for all test sites in this study thus x 10 m was chosen as an appropriate sampling point representative of fully developed conditions within the vegetated region as the minimum width of these four sites was 8 m table 1 the minimum distance of the velocity measurement position to the flow parallel edge of vegetated region was 4 m this ensured that the measurement of velocity profile in the vegetated region was also not affected by the lateral shear layer generated at the channel vegetated area interface as the maximum depth that the lateral horizontal shear layer can penetrate into the vegetation was 0 8 m for this study white and nepf 2007 velocity profiles were measured starting from 5 cm above the bed i e z 5 cm with z 0 representing the bed bottom at 5 cm vertical increments to eliminate the interference of too many blades blocking adv beams the instantaneous velocity records with beam correlation less than 70 were excluding from analysis similar to the method described in abdolahpour et al 2017 besides spikes in the velocity record were removed using the acceleration threshold method described in goring and nikora 2002 the water movement at these four sites was dominated by the unidirectional flow which was indicated by the velocity records and energy spectra for example no obvious periodical fluctuation was shown in the time series of the instantaneous velocity measured near the water surface i e z 100 cm for the unvegetated case of 4 1 fig 6 a the spectrum analysis for this measurement point showed that the velocity spectra in three directions all followed the 5 3 dissipation rate and no spikes were existed in the spectra fig 6b indicating that the effect of waves was not significant and the water movement was dominated by unidirectional flow the flow direction in these four sites was consistent with ouchi river flow directions were different between sites as they were located at different positions along the river fig 1b for unidirectional flow the instantaneous velocity was decomposed into two components taking ue as example the instantaneous velocity can be expressed as 2 u e u e u e in which ue and ue were the time averaged velocity and turbulent velocity fluctuation respectively in the east direction and similar for un and uu the time averaged velocity was defined as the velocity averaged over the entire time series of instantaneous velocity i e 3 u e 1 t 0 t u e t d t in which t was the time duration for each measurement point and similar for un and uu as the flow directions were not the same for all sites the time averaged horizontal velocity uhori was used for comparison between different sites the uhori can be calculated as 4 u hori u e 2 u n 2 and the time averaged vertical velocity uvert uu the turbulent velocity fluctuation was the deviation of instantaneous velocity from the time averaged velocity the rms fluctuations œÉe œÉn œÉu calculated as the root mean square of the fluctuating velocity or the standard deviation of the instantaneous velocity was used to estimate the turbulent intensities the time averaged tke considering the turbulent intensity in three directions can be expressed as 5 tke 1 2 œÉ e 2 œÉ n 2 œÉ u 2 the suspended sediment concentration was measured using the optical backscatter sensor obs 3 compbell scientific inc which detects scattered light from suspended particles within a sensing volume extending 5 cm from the sensor window the turbidity sensor was connected to the analog input of the adv and 0 2 5 v voltage was output the sensor was calibrated in the field by choosing 27 sites distributed along the ouchi river and east dongting lake at each site the turbidity sensor was inserted into the water and recorded the water turbidity at 1 hz for 1 min meanwhile 500 ml water sample was taken at the same position with turbidity sensor and brought to laboratory to measure the sediment concentration using the filtrating and weighing method the calibration showed the linear relationship between sediment concentration c and 1 min averaged sensor output v voltage with the calibration slope of 167 8 4 6 mg l v 95 confidence limits fig 7 to measure the sediment concentration and flow velocity simultaneously the turbidity sensor was also fixed on the sliding board of the fos and located at the same height above the bed with the adv probe fig 5 the horizontal distance between the obs sensor and adv probe was 0 4 m to avoid any disturbance to the adv probe vertical distributions of the sediment concentration were measured starting from z 5 cm with 5 cm vertical intervals which was same with measurements of velocity profile for each measurement point the obs sampling frequency was 16 hz and the measurement duration was 2 min as the sensor integrated over a volume extending 5 cm below the sensor the measurement was considered to represent a concentration at the middle of the volume that is 2 5 cm below the probe 4 results and discussion 4 1 time averaged velocity to set a base line conditions without vegetation were considered first for the four sites the vertical distributions of time averaged horizontal velocity uhori measured in unvegetated regions exhibited logarithmic profiles with uhori increasing rapidly near the bottom and uniform near the water surface fig 8 a c e and g this was consistent with the velocity profile of canonical open channel flows within the emergent vegetation h hv 1 uhori was reduced through the entire water column cases 1 2 and 2 2 in fig 8b and d respectively compared with bare bed conditions the presence of vegetation decreased the depth averaged velocity by 60 and 34 in sites 1 and 2 respectively according to a theoretical model eq 8 in nepf 2012 developed in a steady and uniform flow the time averaged velocity within emergent vegetation was proportional to a 1 with a representing the frontal area of canopy in present study the canopy frontal area determined by a md for the vegetated region in the sites 1 and 2 was a 1 1 1 m 1 and a 2 0 7 m 1 respectively leading to a 1 a 2 1 3 this was consistent with the ratio of the relative depth averaged velocity u the depth averaged velocity in vegetated region normalized by bare bed of site 2 u 2 to site 1 u 1 i e u 2 u 1 1 5 under the influence of emergent vegetation the uhori was also uniformly distributed through the entire water column except a decrease of uhori occurred near the bed bottom as described in lightbody and nepf 2006 the time averaged velocity within emergent vegetation varied inversely with the frontal area of canopy under fully developed unidirectional flow indicating that the time averaged velocity was constant over the entire water depth when the vertical distribution of frontal area was uniform as the submerged part of reed was only stems see section 3 the frontal area of reed was evenly distributed over depth a selengensis had both the stem and blades underwater during measurement with the blades uniformly distributed from top to bottom for each stem fig 4b the frontal area of a selengensis did not vary with height occurrence of the gradually decreased uhori toward bed near the bottom can be attributed to the bed fraction and the complex community structure in the wild there were numerous dead standing stalks as well as debris and many other types of vegetation with small size existing near the bed this could increase the canopy frontal area and thus decrease the time averaged velocity just close to bed two layers separated at the top of vegetation were present in the velocity profile when the vegetation was under submerged conditions h hv 1 in sites 3 and 4 fig 8f and h within the vegetation z hv uhori was reduced compared with that measured at the same height in unvegetated region and uniformly distributed similar to the velocity profile under the influence of emergent vegetation specifically the depth averaged velocity within canopy of cases 3 2 and 4 2 was decreased by 78 and 76 respectively compared with bare bed the velocity reduction in these two sites was larger than the emergent cases of 1 2 60 and 2 2 34 which can be attributed to two reasons first the canopy frontal area of cases 3 2 and 4 2 was 4 6 m 1 and 1 5 m 1 respectively larger than that in sites 1 1 1 m 1 and 2 0 7 m 1 second under submerged conditions i e cases 3 2 and 4 2 in present study velocity within canopy was reduced as flow was forced to divert above the top of canopy when encountering vegetation near the top of vegetation z hv the time averaged velocity increased rapidly and a great velocity gradient occurred similar to the flow structure of mixing layer described by ghisalberti and nepf 2002 for canopy with ahv 0 1 with a 4 6 m 1 and 1 5 m 1 for cases 3 2 and 4 2 ahv for these two cases were 1 6 and 1 1 respectively larger than the threshold of ahv 0 1 above the top of vegetation z hv a skimming flow with the velocity comparable case 4 2 or larger case 3 2 than bare bed was present which was consistent with observations by previous studies e g nepf and vivoni 2000 neumeier and amos 2006 zhang et al 2016 4 2 turbulent kinetic energy the existence of vegetation also altered the vertical distribution of the turbulent kinetic energy tke for the unvegetated regions in all sites tke reached its maximum near the bottom and decreased gradually toward the water surface fig 9 a c e and g similar to the observations of bare bed in the lab under unidirectional flow e g zhang et al 2016 within the emergent vegetation tke was reduced and uniformly distributed through the entire water column fig 9b and d compared with bare bed the depth averaged tke with the presence of vegetation was decreased by 93 2 and 59 4 for the sites 1 and 2 respectively as a 1 1 m 1 and 0 7 m 1 for the vegetated region in sites 1 and 2 respectively this study demonstrated that larger canopy frontal area produced greater tke reduction which was consistent with the description about the variation of turbulence with stem density given by nepf 1999 a reduced and uniformly distributed tke was also present within the lower part of submerged vegetation fig 9f and h which corresponded to the longitudinal exchange zone described by nepf and vivoni 2000 tke within this region of the cases 3 2 and 4 2 was reduced by 98 and 81 respectively and this can also be attributed to the difference of canopy frontal area between these two cases that larger frontal area can cause greater tke reduction above the longitudinal exchange zone was the vertical exchange zone nepf and vivoni 2000 for the cases 3 2 and 4 2 the thickness of the vertical exchange zone Œ¥ was 0 1 m and 0 3 m respectively consistent with prediction by the model i e Œ¥ 0 23 0 6 cda from nepf et al 2007 assuming the drag coefficient cd 1 near the top of vegetation the tke reached its maximum and decreased toward both water surface and bed bottom recall that a great mean velocity gradient induced by the discontinuity in drag force was present near the top of canopy fig 8f and h and this great velocity gradient can generate a region with strong shear stress and thus high turbulent intensity ghisalberti and nepf 2004 the decreasing tendency of tke from vegetation interface to water surface was similar to the studies conducted in the lab zhang et al 2016 nepf and vivoni 2000 ghisalberti and nepf 2002 2004 2006 but different from previous field studies leonard and luther 1995 leonard and croft 2006 neumeier and amos 2006 in which tke increased gradually from bottom to water surface when the vegetation was under submerged condition field measurements were mainly set at coastal regions where the water surface can be influenced by the wind or boat induced waves this could lead to the strong fluctuation of velocity and thus elevated turbulence near the water surface in this study the test regions were chosen at lower land banks of the river and the water movement was dominated by unidirectional current fig 6 in summary the mean and turbulent flow structures within vegetation varied with the variation of submergence conditions within emergent vegetation i e h hv 1 the time averaged velocity and tke were reduced compared with bare bed through the entire water column and distributed uniformly from bottom to water surface for conditions with submerged vegetation i e h hv 1 the time averaged velocity and tke within vegetation z hv were uniformly distributed and diminished compared with that measured at the same height in bare bed which was similar to the flow structures within emergent vegetation above the top of vegetation z hv a skimming flow with comparable or even larger flow velocity was present the discontinuity in drag force at the top of vegetation z hv generated a region with great velocity gradient near the vegetation interface leading to an occurrence of large tke near the top of vegetation by influencing canopy frontal area factors of stem density vegetation species and morphology have great impact on flow structures that canopy with larger frontal area produced greater reduction of time averaged velocity and tke furthermore variations of both the submergence condition and canopy frontal area could influence the sediment transport which was detailed discussed as below 4 3 suspended sediment concentration and sediment deposition for the unvegetated regions in all sites the time averaged suspended sediment concentration c decreased with the increase of height above the bed white circles in fig 10 the presence of vegetation had little effect on the shape of concentration profile and the sediment concentration decreased with increasing height in regions with both emergent grey circles in fig 10a and b and submerged grey circles in fig 10c and d vegetations the mean sediment concentration cmean averaged over the entire water column in bare bed and vegetated region was comparable within 15 difference for the sites 1 and 2 whereas the cmean was decreased by 51 and 31 in sites 3 and 4 respectively compared with bare bed table 1 this can be attributed to the larger reduction of time averaged velocity and tke in sites 3 and 4 than sites 1 and 2 besides the relative locations of these four sites along the river did effects as the sites 1 and 2 were located at the downstream of sites 3 and 4 fig 1b more sediment carried by flow would settle down in sites 3 and 4 this could be demonstrated by the cmean of bare bed for these four sites that the cmean 72 8 102 7 131 2 and 139 0 mg l for sites 1 2 3 and 4 respectively table 1 therefore with smaller sediment concentration the influence of vegetation on sediment transport in sites 1 and 2 was not obvious compared with that observed in sites 3 and 4 for the sites 3 and 4 the sediment concentration within the vegetation z hv was reduced by 57 and 35 respectively which was larger than the decrease of sediment concentration above the top of vegetation i e 44 and 20 for sites 3 and 4 respectively recall that a skimming flow with increased time averaged velocity and tke was generated above the vegetation interface figs 8 and 9 the presence of vegetation was more beneficial to the deposition of suspended sediment within vegetation in which the mean velocity and tke were reduced compared with bare bed the thickness of sediment deposited red columns and eroded green columns over one flood season for each site is shown in fig 11 for all sites both the bare bed x 0 and vegetated regions x 0 were dominated by sediment deposition and only 4 positions with sediment erosion occurred in the bare bed of sites 1 2 and 4 without considering the positions of sediment erosion i e x 10 m in site 1 x 6 m in site 2 and x 2 m in site 4 the mean thickness of sediment deposition tsmean in bare bed x 0 increased gradually from the site 1 to 4 this can be attributed to two reasons first the days of flood inundation increased from sites 1 to 4 table 1 leading to the time for sediment deposition increased from sites 1 to 4 second the relative locations of the site with sites 1 2 3 and 4 located from downstream to upstream along the river mattered with the sediment concentration increasing from downstream to upstream table 1 the amount of sediment settled down in unit time increased from site 1 to 4 besides for all sites except 1 the tsmean in vegetated regions was larger than that in unvegetated regions of the same site specifically compared with the bare bed the tsmean in vegetated regions was increased by 190 40 and 21 for the sites 2 3 and 4 respectively the exception of site 1 that the tsmean in bare bed and vegetated region was comparable was also due to the location of this site located at the downstream end of ouchi river the sediment concentration in site 1 was so small that the influence of vegetation on sediment deposition was not obvious finally within the vegetated region x 0 the amount of sediment deposited over one flood season decreased with increasing distance to the leading edge of canopy e g deposition thickness of the measurement points with x 0 in fig 11b this can be attributed to that as the sediment particles entered the vegetation and travelled downstream some sediment were deposited so that the water column sediment concentration diminished with distance from the leading edge of canopy by decreasing the time averaged velocity and tke figs 8 and 9 the presence of av reduces the suspended sediment concentration or water turbidity and promotes sediment deposition figs 10 and 11 this has great ecological implications for the floodplain evolution in dongting lake and the lake ecological restorations in china av grown in the floodplain can increase the bed elevation by increasing sediment deposition meanwhile the sediment particles containing abundant organic materials provide nutrients for the growth of vegetation clarke and wharton 2001 larsen et al 2009 which in turn can accelerate the elevation of floodplain by decreasing suspended sediment concentration av in shallow lakes increases water transparency and light penetration which creates a positive feedback for continued vegetation growth and thus a stable state with clear water scheffer et al 2001 scheffer and carpenter 2003 vander heide et al 2007 5 conclusions field experiments were conducted in a floodplain of dongting lake china to study the influence of aquatic vegetation on flow structure and sediment deposition under unidirectional flow the presence of vegetation altered the mean and turbulent flow structures and the flow structures within vegetation varied between emergent and submerged conditions for emergent conditions h hv 1 the time averaged velocity uhori and tke were reduced compared with bare bed at the same height above bed with the frontal area of vegetation constant over water depth the uhori and tke were uniformly distributed through the entire water column for submerged conditions h hv 1 flow structures with reduced and uniformly distributed velocity and tke were also present within the vegetation z hv the discontinuity in drag force at the top of vegetation z hv generated a region with the great velocity gradient near the vegetation interface leading to tke reach its maximum near the top of vegetation without vegetated resistance on flow a skimming flow with comparable or larger flow velocity than bare bed was present above the vegetation interface z hv stem density vegetation species and morphology also had impact on flow structures by influencing canopy frontal area in present study canopy with larger frontal area can cause greater reduction of time averaged velocity and tke within vegetation the reduced mean velocity and tke within vegetation decreased the suspended sediment concentration by 30 50 and increased the sediment deposition by as high as 190 compared with bare bed at the same test region credit authorship contribution statement yinghao zhang conceptualization methodology writing original draft formal analysis investigation xijun lai conceptualization methodology writing review editing supervision funding acquisition lin zhang formal analysis kaishan song writing review editing xin yao writing review editing luhua gu investigation cuichao pang investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study received support from the national science foundation of china 41901120 51609143 strategic priority research program of chinese academy of sciences xda23040203 natural science foundation of shandong province zr2019bd052 doctoral research foundation of liaocheng university 318051838 and students innovation and entrepreneurship training program of liaocheng university 201910447044 cxcy2019y067 we sincerely thank the anonymous reviewers for providing insightful comments that have significantly improved our paper all data necessary to evaluate and build upon the research in this paper are provided in the cited references tables and figures 
5614,to understand the influence of aquatic vegetation on flow structures and sediment deposition field experiments were conducted in a floodplain with water movement dominated by unidirectional current flow velocity suspended sediment concentration and sediment deposition were measured within and without vegetation at four sites covered by phragmites communis reed artemisia selengensis carex cinerascens and a mix of them results show that the presence of vegetation reduced the time averaged velocity and turbulent kinetic energy tke and altered vertical distributions of the time averaged velocity and tke for emergent conditions both the time averaged velocity and the tke were uniformly distributed through the entire water column two layers were separated at the top of vegetation for submerged conditions within vegetation both the time averaged velocity and tke were decreased and uniformly distributed similar to observations under emergent conditions the discontinuity of drag force at the top of vegetation generated a region with rapidly increased velocity near the vegetation interface tke reached its maximum near the top of vegetation and decreased gradually toward both bed bottom and water surface in present study canopy with larger frontal area caused bigger reduction of time averaged velocity and tke within vegetation by reducing the mean and turbulent velocities the presence of vegetation decreased the depth averaged suspended sediment concentration by 30 50 and increased the thickness of sediment deposited over one flood season by as high as 190 when compared with bare bed keywords aquatic vegetation turbulence sediment transport floodplain evolution dongting lake 1 introduction aquatic vegetation av commonly distributed in rivers lakes and coastal regions provides a wide range of ecosystem services as the primary producer they are the foundation of food web and create various habitats e g kemp et al 2000 green and short 2003 av can also stabilize the seabed othman 1994 protect shorelines fonseca and fisher 1986 lorenz et al 2015 and enhance local water quality moore 2004 larkum et al 2006 according to the economic evaluation of these ecosystem services the global value of av has been estimated to be 6 8 trillion dollars per year costanza et al 2014 some of the ecosystem services mentioned above arise because the presence of av changes the local flow conditions especially the turbulent flow structure by directly controlling the circulation of mass and momentum in water flow turbulence is the basic power for mass transport in water body of rivers lakes and coastal regions for example the rate of nutrient uptake and cycling is mediated by the mass transfer between plants and surrounding water and thus strongly depends on the characteristics of water flow and turbulence csanady 1973 koch and gust 1999 turbulence near the bed also determines the initiation of sediment motion and sediment resuspension yang et al 2016 zhang and nepf 2019 av exerts resistance on water movement which makes the mean and turbulent flow structures different from canonical open channel flow based on laboratory experiments employing model vegetation nepf and vivoni 2000 showed that the velocity within canopy had a range of behavior depending on the depth ratio defined as the ratio of water depth h to canopy height hv as the limitation of light penetration most aquatic vegetation occurs in the shallow submergence with h hv 5 e g chambers and kalff 1985 duarte 1991 for emergent conditions h hv 1 the velocity is determined by the variation in vegetative drag which is proportional to the frontal area of canopy e g nepf and vivoni 2000 lightbody and nepf 2006 eddies within the emergent canopy are dissipated to the scale of stem diameter or the average distance to the nearest neighboring stem and the turbulent kinetic energy tke is a function of time averaged velocity stem density and plant morphology parameters tanino and nepf 2008 for dense submerged vegetation 1 h hv 5 with the roughness density Œªf ahv with a representing the frontal area per canopy volume 0 1 under unidirectional current a canopy scale turbulence is produced near the top of canopy dominating the momentum transfer between streams within vegetation and its overlying region e g nepf et al 2007 ghisalberti and nepf 2002 2004 2006 specifically both the reynolds stress and tke reach their maximums at the top of vegetation e g nepf and vivoni 2000 pang et al 2014 zhang et al 2016 whereas they are reduced near the bed by the canopy drag e g ghisalberti and nepf 2002 if the canopy is sparse Œªf 0 1 the velocity profile exhibits a turbulent boundary layer form and the reynolds stress and tke remain elevated close to the bed e g luhar et al 2008 besides the vegetation morphology has great effect on the mean and turbulent flow structures and its impact on flow structures can be ultimately attributed to the factor of canopy frontal area e g leonard and luther 1995 leonard and croft 2006 zhang et al 2016 the alteration of flow structure by av influences the pattern of sediment transport a series of flume experiments using artificial vegetation and sediment particles were conducted in nepf lab at mit major findings showed that particle deposition was enhanced within and directly behind the vegetation patch in which both the mean and turbulent velocities were diminished e g chen et al 2012 schoelynck et al 2012 follett and nepf 2012 ortiz et al 2013 de lima et al 2015 liu et al 2018 most findings on vegetated flow and sediment transport were concluded from idealized flume experiments field measurements that mainly conducted in coastal regions with salt marshes also provided new insights about flow structures within canopy for example leonard and luther 1995 found that the mean flow velocity and turbulent intensity within salt marsh canopy were inversely related to stem density and distance from the leading edge of canopy leonard and croft 2006 found that the vertical component of mean velocity and turbulent intensity were reduced more strongly than the horizontal within canopy suggesting that turbulence contributes more to lateral advection than to vertical mixing within vegetation neumeier and amos 2006 also measured the suspended sediment concentration profiles within canopy and reduced sediment diffusion due to lower turbulent intensity compared with bare bed was observed however to our knowledge few field studies concentrate on both flow structures and sediment transport under the influence of av in this study field experiments were conducted in a floodplain to investigate the influence of vegetation on the mean and turbulent flow structures and sediment deposition under unidirectional current three vegetation species i e phragmites communis artemisia selengensis carex cinerascens under emergent and submerged conditions were considered section 1 above has reviewed previous studies about the flow structure and sediment deposition within vegetation section 2 gives a brief description of the flow sediment conditions of the study area locations of the four study sites selected for measurement and the vegetation distribution for each site the experimental setup and methods are described in section 3 section 4 discusses the flow structures i e vertical distributions of the time averaged and turbulent velocities suspended sediment concentration profiles and sediment deposition patterns in regions with and without vegetation 2 study areas dongting lake the second largest fresh water lake in china is located in the middle reach of yangtze river it has a water surface area of 2625 km2 and mean water depth of 6 39 m xie et al 2014 the lake consists of three parts which are called east dongting lake south dongting lake and west dongting lake respectively fig 1 a dongting lake receives water inflows from yangtze river through three channels i e songzi taiping and ouchi and also inflows from the south which covers almost the entire drainage of hunan province via four rivers i e xiang zi yuan and li the water of the lake system is finally discharged into yangtze river at chenglingji with its location marked as the black triangle in fig 1a the seasonal changes in precipitation and inflows from yangtze and four tributary rivers result in the annual variation in water level and thus the formation of inundated areas in the dry season the lake area is normally less than 500 km2 whereas it increases to more than 2500 km2 in the flood season the drastic fluctuation in water level and lake area provides the basic hydrological regime for maintaining large areas of beach wetland the most dynamic landscape within the dongting lake area the floodplains in dongting lake are rich of av with more than 1000 species of vegetation found to be distributed in the high medium and low level of the floodplain olson and dinerstein 1998 fang et al 2006 dongting lake is also a lake enduring severe sediment deposition there is approximate 1 18 108 m3 multi years averaged sediment which comprises 82 of the total sediment influx in dongting lake carried into dongting lake each year flow vegetation and sediment interact with one another making the floodplain an ideal place for studying the vegetated flow and sediment transport the study area was chosen at a floodplain formed at the estuary of ouchi river flowing into east dongting lake fig 1a the floodplain is dominated by phragmites communis reed grown in the higher land in the lower elevation of the floodplain many other types of vegetation including the carex cinerascens phalaris arundinacea and artemisia selengensis are also distributed influenced by the annual variation of inflow from yangtze river the hydrodynamic conditions e g water level flow velocity in the floodplain vary through the entire year fig 2 a in the dry season with low water level the water areas are retreated to the mainstream of the river and the floodplain is exposed to the air the water level increases in the wet season and the floodplain is flooded with the fluctuation of water level av in the floodplain is under different submergence conditions four sites named 1 2 3 and 4 from downstream to upstream along the channel were chosen at the relatively flat bank of ouchi river fig 1b the dominant vegetations in these four sites were different from sites 1 to 4 the dominant vegetations were reeds a selengensis mixed with reeds c cinerascens and a selengensis respectively table 1 measurements of velocity and suspended sediment concentration in sites 1 2 3 and 4 were conducted in july 14 june 27 26 and 25 respectively in the year of 2016 with these four sites located in east donting lake the nearest control hydrological station was chenglingji station see fig 1a assuming the water level processes in these four sites same with that of chenglingji station the water level through 24 h varied within 0 08 in jun 25 fig 2b 0 32 in jun 26 fig 2c 0 40 in jun 27 fig 2d and 0 23 in jul 14 fig 2e 3 methods and materials to compare the flow structures and sediment deposition in regions with and without vegetation the original vegetation on the upstream half part of each site was removed before the site was flooded fig 3 dimensions of both the unvegetated and vegetated regions for each site are presented in table 1 after the removal of vegetation the stem density m stems per bed area for each site was estimated by randomly choosing three 1 m 1 m quadrats in vegetated region recall that the site 2 was dominated by a selengensis mixed with reeds stem densities of these two types of vegetation were both measured five strains of plant were chosen from each quadrat and the vegetation height hv stem diameter d and the maximum blade width wmax were measured to describe the plant morphology the stem density and plant geometry parameters for each site are listed in table 1 the phragmites communis reed has rigid erect and cylinder like stem fig 4 a several knots where flexible blades grow are distributed on the stem in lacustrine and riverine wetlands the tall stem of reed makes it usually under emergent condition h hv 1 as the blades can rot and fall off on the bed when they are under water for a long time reed blades are usually distributed above the water surface and only stems without blades are underwater artemisia selengensis also has rigid and cylinder like stems and flexible lanceolate blades fig 4b generally several stems are grown for each individual plant of a selengensis and these stems are divided at the base of plant therefore the number of stems not individual plants per unit area was recorded as the stem density with 3 4 blades bundled together the blades are uniformly distributed from top to bottom for each stem in present study the a selengensis was distributed in sites 2 and 4 table 1 with different heights of vegetation and water depth a selengensis was under emergent and submerged conditions in sites 2 and 4 respectively carex cinerascens has thin and erect stem with small height fig 4c which makes the c cinerascens always under submerged conditions when flooded the blades of c cinerascens are lanceolate and mainly distributed in the upper part of the stem in order to measure the sediment deposition 10 steel cylinders with 1 m in length and 1 5 cm in diameter for each were inserted into the sediment at each site before the region was flooded fig 3 when inserted into the sediment the cylinders extended at least 0 5 m above the bed for each site the steel cylinders were aligned longitudinally in 4 m increments and 4 and 6 cylinders were inserted in the unvegetated and vegetated regions respectively positions for all cylinders at each site were x 14 10 6 2 2 6 10 14 18 and 22 m with x 0 representing the leading edge of canopy before the sites were flooded the height of cylinder left above the bed was measured and represented as ts 1 after flooding with the water receding out of site the cylinders height represented as ts 2 was measured again thickness of the sediment layer deposited over the entire flood season ts at a specific position can be expressed as 1 t s t s 1 t s 2 with ts greater and less than zero representing sediment deposition and erosion respectively the flooding duration fd days of inundation for each site was estimated by counting the days with the water level larger than the elevation of site surface which can be calculated by subtracting water depth from the water level when measuring assuming the water level of floodplain equal to that of chenglingji station the fd for each site was estimated and presented in table 1 instantaneous velocities ue un uu corresponding to the east north and up directions respectively were measured using a 3 d acoustic doppler velocimeter adv nortek vector with enu coordinated system as adv measures flow velocity at a specific point i e 15 cm downward the probe tip the measurement of velocity profile needs to move adv vertically in this study a self made field observation system fos fig 5 was used the fos consisted of four parts i e the detachable ti alloy support a motor 24 v batteries and the control panel the ti alloy support was a cubic frame with 1 2 m long 1 2 m wide and 3 m high the motor powered by the 24 v batteries drove the chains at two opposite sides of the support moving circularly through the gear connected to the chains a sliding board can move up and down and the movement was controlled by a button on the control panel adv was fixed at the middle of sliding board the nearest distance between the adv probe and the support frame was 0 6 m which was sufficient to keep the probe from being disturbed by the frame a rotary encoder was installed inside the motor to record the rotational arc length of the gear which was equal to the moving distance of the sliding board and shown on the grating digital display meter on the control panel considering the number of the measurement points required for each velocity profile and the variation of hydrodynamic conditions i e water level and flow velocity during measurements velocity was recorded for 2 min at each measurement point with sampling frequency of 16 hz for each site two vertical distributions of velocity located at x 10 m in unvegetated region and x 10 m in vegetated region midway along the site width were measured according to the model proposed by chen et al 2013 uniform flow conditions can be reached at x 8 5 m for all test sites in this study thus x 10 m was chosen as an appropriate sampling point representative of fully developed conditions within the vegetated region as the minimum width of these four sites was 8 m table 1 the minimum distance of the velocity measurement position to the flow parallel edge of vegetated region was 4 m this ensured that the measurement of velocity profile in the vegetated region was also not affected by the lateral shear layer generated at the channel vegetated area interface as the maximum depth that the lateral horizontal shear layer can penetrate into the vegetation was 0 8 m for this study white and nepf 2007 velocity profiles were measured starting from 5 cm above the bed i e z 5 cm with z 0 representing the bed bottom at 5 cm vertical increments to eliminate the interference of too many blades blocking adv beams the instantaneous velocity records with beam correlation less than 70 were excluding from analysis similar to the method described in abdolahpour et al 2017 besides spikes in the velocity record were removed using the acceleration threshold method described in goring and nikora 2002 the water movement at these four sites was dominated by the unidirectional flow which was indicated by the velocity records and energy spectra for example no obvious periodical fluctuation was shown in the time series of the instantaneous velocity measured near the water surface i e z 100 cm for the unvegetated case of 4 1 fig 6 a the spectrum analysis for this measurement point showed that the velocity spectra in three directions all followed the 5 3 dissipation rate and no spikes were existed in the spectra fig 6b indicating that the effect of waves was not significant and the water movement was dominated by unidirectional flow the flow direction in these four sites was consistent with ouchi river flow directions were different between sites as they were located at different positions along the river fig 1b for unidirectional flow the instantaneous velocity was decomposed into two components taking ue as example the instantaneous velocity can be expressed as 2 u e u e u e in which ue and ue were the time averaged velocity and turbulent velocity fluctuation respectively in the east direction and similar for un and uu the time averaged velocity was defined as the velocity averaged over the entire time series of instantaneous velocity i e 3 u e 1 t 0 t u e t d t in which t was the time duration for each measurement point and similar for un and uu as the flow directions were not the same for all sites the time averaged horizontal velocity uhori was used for comparison between different sites the uhori can be calculated as 4 u hori u e 2 u n 2 and the time averaged vertical velocity uvert uu the turbulent velocity fluctuation was the deviation of instantaneous velocity from the time averaged velocity the rms fluctuations œÉe œÉn œÉu calculated as the root mean square of the fluctuating velocity or the standard deviation of the instantaneous velocity was used to estimate the turbulent intensities the time averaged tke considering the turbulent intensity in three directions can be expressed as 5 tke 1 2 œÉ e 2 œÉ n 2 œÉ u 2 the suspended sediment concentration was measured using the optical backscatter sensor obs 3 compbell scientific inc which detects scattered light from suspended particles within a sensing volume extending 5 cm from the sensor window the turbidity sensor was connected to the analog input of the adv and 0 2 5 v voltage was output the sensor was calibrated in the field by choosing 27 sites distributed along the ouchi river and east dongting lake at each site the turbidity sensor was inserted into the water and recorded the water turbidity at 1 hz for 1 min meanwhile 500 ml water sample was taken at the same position with turbidity sensor and brought to laboratory to measure the sediment concentration using the filtrating and weighing method the calibration showed the linear relationship between sediment concentration c and 1 min averaged sensor output v voltage with the calibration slope of 167 8 4 6 mg l v 95 confidence limits fig 7 to measure the sediment concentration and flow velocity simultaneously the turbidity sensor was also fixed on the sliding board of the fos and located at the same height above the bed with the adv probe fig 5 the horizontal distance between the obs sensor and adv probe was 0 4 m to avoid any disturbance to the adv probe vertical distributions of the sediment concentration were measured starting from z 5 cm with 5 cm vertical intervals which was same with measurements of velocity profile for each measurement point the obs sampling frequency was 16 hz and the measurement duration was 2 min as the sensor integrated over a volume extending 5 cm below the sensor the measurement was considered to represent a concentration at the middle of the volume that is 2 5 cm below the probe 4 results and discussion 4 1 time averaged velocity to set a base line conditions without vegetation were considered first for the four sites the vertical distributions of time averaged horizontal velocity uhori measured in unvegetated regions exhibited logarithmic profiles with uhori increasing rapidly near the bottom and uniform near the water surface fig 8 a c e and g this was consistent with the velocity profile of canonical open channel flows within the emergent vegetation h hv 1 uhori was reduced through the entire water column cases 1 2 and 2 2 in fig 8b and d respectively compared with bare bed conditions the presence of vegetation decreased the depth averaged velocity by 60 and 34 in sites 1 and 2 respectively according to a theoretical model eq 8 in nepf 2012 developed in a steady and uniform flow the time averaged velocity within emergent vegetation was proportional to a 1 with a representing the frontal area of canopy in present study the canopy frontal area determined by a md for the vegetated region in the sites 1 and 2 was a 1 1 1 m 1 and a 2 0 7 m 1 respectively leading to a 1 a 2 1 3 this was consistent with the ratio of the relative depth averaged velocity u the depth averaged velocity in vegetated region normalized by bare bed of site 2 u 2 to site 1 u 1 i e u 2 u 1 1 5 under the influence of emergent vegetation the uhori was also uniformly distributed through the entire water column except a decrease of uhori occurred near the bed bottom as described in lightbody and nepf 2006 the time averaged velocity within emergent vegetation varied inversely with the frontal area of canopy under fully developed unidirectional flow indicating that the time averaged velocity was constant over the entire water depth when the vertical distribution of frontal area was uniform as the submerged part of reed was only stems see section 3 the frontal area of reed was evenly distributed over depth a selengensis had both the stem and blades underwater during measurement with the blades uniformly distributed from top to bottom for each stem fig 4b the frontal area of a selengensis did not vary with height occurrence of the gradually decreased uhori toward bed near the bottom can be attributed to the bed fraction and the complex community structure in the wild there were numerous dead standing stalks as well as debris and many other types of vegetation with small size existing near the bed this could increase the canopy frontal area and thus decrease the time averaged velocity just close to bed two layers separated at the top of vegetation were present in the velocity profile when the vegetation was under submerged conditions h hv 1 in sites 3 and 4 fig 8f and h within the vegetation z hv uhori was reduced compared with that measured at the same height in unvegetated region and uniformly distributed similar to the velocity profile under the influence of emergent vegetation specifically the depth averaged velocity within canopy of cases 3 2 and 4 2 was decreased by 78 and 76 respectively compared with bare bed the velocity reduction in these two sites was larger than the emergent cases of 1 2 60 and 2 2 34 which can be attributed to two reasons first the canopy frontal area of cases 3 2 and 4 2 was 4 6 m 1 and 1 5 m 1 respectively larger than that in sites 1 1 1 m 1 and 2 0 7 m 1 second under submerged conditions i e cases 3 2 and 4 2 in present study velocity within canopy was reduced as flow was forced to divert above the top of canopy when encountering vegetation near the top of vegetation z hv the time averaged velocity increased rapidly and a great velocity gradient occurred similar to the flow structure of mixing layer described by ghisalberti and nepf 2002 for canopy with ahv 0 1 with a 4 6 m 1 and 1 5 m 1 for cases 3 2 and 4 2 ahv for these two cases were 1 6 and 1 1 respectively larger than the threshold of ahv 0 1 above the top of vegetation z hv a skimming flow with the velocity comparable case 4 2 or larger case 3 2 than bare bed was present which was consistent with observations by previous studies e g nepf and vivoni 2000 neumeier and amos 2006 zhang et al 2016 4 2 turbulent kinetic energy the existence of vegetation also altered the vertical distribution of the turbulent kinetic energy tke for the unvegetated regions in all sites tke reached its maximum near the bottom and decreased gradually toward the water surface fig 9 a c e and g similar to the observations of bare bed in the lab under unidirectional flow e g zhang et al 2016 within the emergent vegetation tke was reduced and uniformly distributed through the entire water column fig 9b and d compared with bare bed the depth averaged tke with the presence of vegetation was decreased by 93 2 and 59 4 for the sites 1 and 2 respectively as a 1 1 m 1 and 0 7 m 1 for the vegetated region in sites 1 and 2 respectively this study demonstrated that larger canopy frontal area produced greater tke reduction which was consistent with the description about the variation of turbulence with stem density given by nepf 1999 a reduced and uniformly distributed tke was also present within the lower part of submerged vegetation fig 9f and h which corresponded to the longitudinal exchange zone described by nepf and vivoni 2000 tke within this region of the cases 3 2 and 4 2 was reduced by 98 and 81 respectively and this can also be attributed to the difference of canopy frontal area between these two cases that larger frontal area can cause greater tke reduction above the longitudinal exchange zone was the vertical exchange zone nepf and vivoni 2000 for the cases 3 2 and 4 2 the thickness of the vertical exchange zone Œ¥ was 0 1 m and 0 3 m respectively consistent with prediction by the model i e Œ¥ 0 23 0 6 cda from nepf et al 2007 assuming the drag coefficient cd 1 near the top of vegetation the tke reached its maximum and decreased toward both water surface and bed bottom recall that a great mean velocity gradient induced by the discontinuity in drag force was present near the top of canopy fig 8f and h and this great velocity gradient can generate a region with strong shear stress and thus high turbulent intensity ghisalberti and nepf 2004 the decreasing tendency of tke from vegetation interface to water surface was similar to the studies conducted in the lab zhang et al 2016 nepf and vivoni 2000 ghisalberti and nepf 2002 2004 2006 but different from previous field studies leonard and luther 1995 leonard and croft 2006 neumeier and amos 2006 in which tke increased gradually from bottom to water surface when the vegetation was under submerged condition field measurements were mainly set at coastal regions where the water surface can be influenced by the wind or boat induced waves this could lead to the strong fluctuation of velocity and thus elevated turbulence near the water surface in this study the test regions were chosen at lower land banks of the river and the water movement was dominated by unidirectional current fig 6 in summary the mean and turbulent flow structures within vegetation varied with the variation of submergence conditions within emergent vegetation i e h hv 1 the time averaged velocity and tke were reduced compared with bare bed through the entire water column and distributed uniformly from bottom to water surface for conditions with submerged vegetation i e h hv 1 the time averaged velocity and tke within vegetation z hv were uniformly distributed and diminished compared with that measured at the same height in bare bed which was similar to the flow structures within emergent vegetation above the top of vegetation z hv a skimming flow with comparable or even larger flow velocity was present the discontinuity in drag force at the top of vegetation z hv generated a region with great velocity gradient near the vegetation interface leading to an occurrence of large tke near the top of vegetation by influencing canopy frontal area factors of stem density vegetation species and morphology have great impact on flow structures that canopy with larger frontal area produced greater reduction of time averaged velocity and tke furthermore variations of both the submergence condition and canopy frontal area could influence the sediment transport which was detailed discussed as below 4 3 suspended sediment concentration and sediment deposition for the unvegetated regions in all sites the time averaged suspended sediment concentration c decreased with the increase of height above the bed white circles in fig 10 the presence of vegetation had little effect on the shape of concentration profile and the sediment concentration decreased with increasing height in regions with both emergent grey circles in fig 10a and b and submerged grey circles in fig 10c and d vegetations the mean sediment concentration cmean averaged over the entire water column in bare bed and vegetated region was comparable within 15 difference for the sites 1 and 2 whereas the cmean was decreased by 51 and 31 in sites 3 and 4 respectively compared with bare bed table 1 this can be attributed to the larger reduction of time averaged velocity and tke in sites 3 and 4 than sites 1 and 2 besides the relative locations of these four sites along the river did effects as the sites 1 and 2 were located at the downstream of sites 3 and 4 fig 1b more sediment carried by flow would settle down in sites 3 and 4 this could be demonstrated by the cmean of bare bed for these four sites that the cmean 72 8 102 7 131 2 and 139 0 mg l for sites 1 2 3 and 4 respectively table 1 therefore with smaller sediment concentration the influence of vegetation on sediment transport in sites 1 and 2 was not obvious compared with that observed in sites 3 and 4 for the sites 3 and 4 the sediment concentration within the vegetation z hv was reduced by 57 and 35 respectively which was larger than the decrease of sediment concentration above the top of vegetation i e 44 and 20 for sites 3 and 4 respectively recall that a skimming flow with increased time averaged velocity and tke was generated above the vegetation interface figs 8 and 9 the presence of vegetation was more beneficial to the deposition of suspended sediment within vegetation in which the mean velocity and tke were reduced compared with bare bed the thickness of sediment deposited red columns and eroded green columns over one flood season for each site is shown in fig 11 for all sites both the bare bed x 0 and vegetated regions x 0 were dominated by sediment deposition and only 4 positions with sediment erosion occurred in the bare bed of sites 1 2 and 4 without considering the positions of sediment erosion i e x 10 m in site 1 x 6 m in site 2 and x 2 m in site 4 the mean thickness of sediment deposition tsmean in bare bed x 0 increased gradually from the site 1 to 4 this can be attributed to two reasons first the days of flood inundation increased from sites 1 to 4 table 1 leading to the time for sediment deposition increased from sites 1 to 4 second the relative locations of the site with sites 1 2 3 and 4 located from downstream to upstream along the river mattered with the sediment concentration increasing from downstream to upstream table 1 the amount of sediment settled down in unit time increased from site 1 to 4 besides for all sites except 1 the tsmean in vegetated regions was larger than that in unvegetated regions of the same site specifically compared with the bare bed the tsmean in vegetated regions was increased by 190 40 and 21 for the sites 2 3 and 4 respectively the exception of site 1 that the tsmean in bare bed and vegetated region was comparable was also due to the location of this site located at the downstream end of ouchi river the sediment concentration in site 1 was so small that the influence of vegetation on sediment deposition was not obvious finally within the vegetated region x 0 the amount of sediment deposited over one flood season decreased with increasing distance to the leading edge of canopy e g deposition thickness of the measurement points with x 0 in fig 11b this can be attributed to that as the sediment particles entered the vegetation and travelled downstream some sediment were deposited so that the water column sediment concentration diminished with distance from the leading edge of canopy by decreasing the time averaged velocity and tke figs 8 and 9 the presence of av reduces the suspended sediment concentration or water turbidity and promotes sediment deposition figs 10 and 11 this has great ecological implications for the floodplain evolution in dongting lake and the lake ecological restorations in china av grown in the floodplain can increase the bed elevation by increasing sediment deposition meanwhile the sediment particles containing abundant organic materials provide nutrients for the growth of vegetation clarke and wharton 2001 larsen et al 2009 which in turn can accelerate the elevation of floodplain by decreasing suspended sediment concentration av in shallow lakes increases water transparency and light penetration which creates a positive feedback for continued vegetation growth and thus a stable state with clear water scheffer et al 2001 scheffer and carpenter 2003 vander heide et al 2007 5 conclusions field experiments were conducted in a floodplain of dongting lake china to study the influence of aquatic vegetation on flow structure and sediment deposition under unidirectional flow the presence of vegetation altered the mean and turbulent flow structures and the flow structures within vegetation varied between emergent and submerged conditions for emergent conditions h hv 1 the time averaged velocity uhori and tke were reduced compared with bare bed at the same height above bed with the frontal area of vegetation constant over water depth the uhori and tke were uniformly distributed through the entire water column for submerged conditions h hv 1 flow structures with reduced and uniformly distributed velocity and tke were also present within the vegetation z hv the discontinuity in drag force at the top of vegetation z hv generated a region with the great velocity gradient near the vegetation interface leading to tke reach its maximum near the top of vegetation without vegetated resistance on flow a skimming flow with comparable or larger flow velocity than bare bed was present above the vegetation interface z hv stem density vegetation species and morphology also had impact on flow structures by influencing canopy frontal area in present study canopy with larger frontal area can cause greater reduction of time averaged velocity and tke within vegetation the reduced mean velocity and tke within vegetation decreased the suspended sediment concentration by 30 50 and increased the sediment deposition by as high as 190 compared with bare bed at the same test region credit authorship contribution statement yinghao zhang conceptualization methodology writing original draft formal analysis investigation xijun lai conceptualization methodology writing review editing supervision funding acquisition lin zhang formal analysis kaishan song writing review editing xin yao writing review editing luhua gu investigation cuichao pang investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study received support from the national science foundation of china 41901120 51609143 strategic priority research program of chinese academy of sciences xda23040203 natural science foundation of shandong province zr2019bd052 doctoral research foundation of liaocheng university 318051838 and students innovation and entrepreneurship training program of liaocheng university 201910447044 cxcy2019y067 we sincerely thank the anonymous reviewers for providing insightful comments that have significantly improved our paper all data necessary to evaluate and build upon the research in this paper are provided in the cited references tables and figures 
