index,text
105,coastal forcing including waves lead to complex and dynamic mixing between discharging groundwater and recirculating coastal water in permeable unconfined nearshore aquifers this mixing can drive biogeochemical transformations that affect the fate of pollutants in nearshore aquifers and their ultimate discharge to coastal waters the objective of this study was to examine the effect of time varying wave conditions on the fate of nitrogen in a freshwater unconfined nearshore aquifer this was achieved by conducting numerical groundwater flow and reactive transport simulations using modflow nwt 2005 with a new modified wave pbc package together with pht3d v2 10 the simulations demonstrate that time varying wave conditions enhance mixing in the nearshore aquifer compared to simulations that only consider constant wave conditions and in doing so impact nitrogen transformations for the conditions and reaction network simulated time varying wave conditions resulted in up to 99 of nitrogen removal in the nearshore aquifer due to the intensified mixing and increased delivery of organic matter into the mixing zone sensitivity analysis shows that the abundance and reactivity of coastal derived organic matter plays a key role in nitrogen removal in aquifers along wave influenced shorelines the simulations highlight the importance of considering time varying wave conditions when designing field investigations and analysing field data the findings have implications for prediction and estimation of chemical fluxes to the coastal waters and also suggest that increasingly frequent storm events and higher wave conditions as the climate changes may modify pollutant fluxes from nearshore aquifers to coastal waters keywords groundwater coastal water interactions waves coastal aquifer reactive transport model submarine groundwater discharge data availability the wave pbc package is available from the corresponding author 1 introduction protection of coastal water resources is a major environmental challenge due to increasing population growth and development in coastal areas combined with climate change permeable unconfined aquifers are an important hydrogeological feature connecting terrestrial groundwater systems with coastal waters in this study the term coastal waters includes marine as well as inland coastal waters such as laurentian great lakes it is well established that the flux of water from aquifers to the marine coastal waters termed submarine groundwater discharge sgd can be an important source of freshwater and chemical constituents to oceans beck et al 2007 burnett et al 2003 charette et al 2005 moore 2010 1999 oehler et al 2021 similarly studies have highlighted the importance of lacustrine groundwater discharge lgd in delivering groundwater and associated chemicals to inland coastal waters lewandowski et al 2015 robinson 2015 for example lgd was recently found to contribute between 9 and 85 of total p load and between 18 and 67 of total n load to 13 measured lakes meinikmann 2016 in spite of the recognition of the importance of sgd and lgd predicting water and chemical flux from permeable unconfined aquifers to marine and inland coastal waters remains a challenge due to the complexity of the subsurface flow transport and reaction processes that occur in the nearshore aquifer close to the aquifer coastal water interface unconfined nearshore aquifers are exposed to dynamic hydrological forcings that act on a wide range of spatial and temporal scales including seasonal and interannual changes in the landward hydraulic gradient and coastal water level varying recharge patterns and coastal forcing including waves and tides conant et al 2019 santos et al 2012 these dynamic hydrological forcings as well as variable density effects in marine environments lead to the recirculation of large quantities of coastal water across the aquifer coastal water interface robinson et al 2018 santos et al 2012 as coastal water recirculates through the nearshore aquifer it mixes with the discharging terrestrial groundwater due to the distinct chemical compositions of groundwater and coastal water this mixing can considerably modify the flux of terrestrial groundwater derived chemicals discharging into coastal waters as well as affect the fate of coastal derived chemicals recirculating through the nearshore aquifer in the marine environment the seawater freshwater mixing zone is commonly referred to as a subterranean estuary the mixing and reaction processes occurring in subterranean estuaries have been shown to regulate the concentrations of a wide range of chemicals including terrestrially derived nutrients liu et al 2017a loveless and oldham 2010a oehler et al 2021 carbon cai et al 2003 goni and gardner 2003 and metals and trace metals beck et al 2010 charette and sholkovitz 2006 and their flux to coastal waters moore 1999 robinson et al 2018 an analogous less studied reaction zone also exists in nearshore aquifers in inland coastal environments and has been shown to affect the behaviour of pollutants including phosphorus and arsenic lee et al 2014 rakhimbekova et al 2021b 2021 the extent and intensity of groundwater coastal water mixing in nearshore aquifers is influenced by the various dynamic hydrological forces acting on the system that affect the flow and solute transport processes waves are an important forcing along most marine and inland coastlines worldwide and have been shown to considerably modify the flow and mixing dynamics in nearshore aquifers cartwright et al 2004 geng et al 2014 malott et al 2017 2016 rau et al 2018 robinson et al 2014a compared to tides and landward hydraulic gradient variations waves are a more irregular forcing with both wave height and wave period continuously varying over time this makes it challenging to evaluate the impact of waves on groundwater flows mixing and reactive processes in nearshore aquifers through field investigations alone numerical groundwater flow and solute transport modelling has therefore been shown to be a valuable approach for conceptually investigating the effect of waves on groundwater flows and salt transport in nearshore aquifers in marine environments geng et al 2014 geng and boufadel 2015 robinson et al 2014b xin et al 2015 2010 individual high frequency e g sub seconds to seconds wave motion drives rapid infiltration exfiltration across the aquifer coastal water interface i e beach face due to their high frequency the effect of individual waves is rapidly diminished with distance from the shoreline and with depth below the aquifer coastal water interface heiss et al 2014 li and barry 2000 malott et al 2017 taking this into account xin et al 2010 showed numerically that the main effects of waves on nearshore groundwater flows and transport can be captured by considering only wave set up i e the phase averaged effect of waves longuet higgins 1983 rather than instantaneous wave action wave set up which is the upward tilt in the mean surface water that extends from the wave breaking point to the wave run up limit drives a groundwater flow recirculation through permeable nearshore aquifers fig 1 li and barry 2000 longuet higgins 1983 considering the phase averaged wave set up only rather than instantaneous wave action greatly reduces the computational demand of simulating the effect of waves as otherwise small time steps 0 1 s are required robinson et al 2014b used the phase averaged approach to illustrate numerically that variable wave conditions i e changing wave height over time can lead to large perturbations in groundwater flow patterns and have a long lasting impact order of weeks to months on the salt distribution and mixing conditions in a nearshore subterranean estuary malott et al 2016 later provided the first field validation of using this phase averaged numerical approach to simulate the influence of variable wave heights on groundwater flow and transport in a nearshore aquifer in this study malott et al 2016 simulated field data collected at a freshwater beach on lake huron such that wave effects could be identified without complicating effects from tides and density that also co exist in marine beaches few studies have examined the influence of waves on the fate and transport of reactive chemicals in nearshore aquifers and subsequent chemical fluxes to coastal waters this is in spite of our understanding that waves particularly variable wave conditions considerably affect the flow transport and mixing processes in nearshore aquifers and that these processes can in turn affect the production attenuation and discharge of chemicals across the aquifer coastal water interface liu et al 2018 luo and jiao 2016 slomp and van cappellen 2004 to our knowledge rakhimbekova et al 2018 is the only prior field study to examine the impact of variable wave conditions on geochemical conditions and chemical fate in a nearshore aquifer this study was conducted in a nearshore freshwater aquifer and demonstrated that high wave conditions may lead to the episodic release of arsenic from the nearshore aquifer to coastal waters in the marine environment there are several field studies that have examined nitrogen transport in wave influenced nearshore aquifers while these field studies have shown that nitrate in wave influenced aquifers may be attenuated via denitrification or alternatively produced due to organic matter mineralization they were not able disentangle the effects of waves compared to other forcing e g tides density effects due to the complexity of the processes in the field couturier et al 2017 liu et al 2017b loveless and oldham 2010b oehler et al 2021 due to the complexity of untangling processes from field data alone numerical modelling studies have been used to explore the factors controlling the fate of nitrogen in nearshore aquifers with and without tides and waves spiteri et al 2008a simulated nitrogen cycling in a nearshore aquifer not exposed to tides and waves and showed that the extent of seawater freshwater mixing and the rate of denitrification depend on the groundwater velocity and organic matter mineralization rate more recently heiss et al 2017a considered mixing dependent and mixing independent reactions within a groundwater flow and reactive transport model to identify the conditions that promote attenuation of terrestrially derived nitrate in a nearshore aquifer exposed to tides they found that nitrate attenuation was greatest in a nearshore aquifer exposed to tides of intermediate tidal amplitude 0 75 m and with high sediment hydraulic conductivity high terrestrial groundwater flux steeper beach face and high hydraulic dispersion however heiss et al 2017a only considered tidal effects and not also the effects of waves anwar et al 2014 simulated the effects of tides and steady wave conditions i e wave height constant over time on nitrogen nitrate and ammonium transport in a nearshore aquifer they showed that nitrate discharge was higher from a nearshore aquifer exposed to tides amplitude 0 5 m compared with steady waves root mean square wave height hrms 1 m this was because for the conditions simulated there was greater seawater freshwater mixing leading to more decomposition of marine derived organic matter and nitrate production via nitrification of ammonium in the nearshore aquifer exposed to tides compared to the nearshore aquifer exposed to steady waves overall the reactivity of nitrogen was found to be smaller in a nearshore aquifer exposed to steady waves compared to an aquifer exposed to tides as consideration of steady wave conditions only not variable waves resulted in less seawater infiltration into the aquifer and limited seawater freshwater mixing in the nearshore aquifer compared to consideration of tidal effects anwar et al 2014 in reality wave heights are highly variable over time and as shown by robinson et al 2014b varying wave height is expected to lead to more intense seawater freshwater mixing in nearshore aquifer compared to tides alone the influence of these variable wave conditions on the fate of nitrogen in nearshore aquifers has not previously been examined numerically nor has it been observed in the field mainly due to the complexity of multiple forcing e g tides density effects acting on the aquifer coastal water interface the objective of this study was to evaluate the effect of variable wave conditions on the fate and transport of nitrogen in a nearshore aquifer and its flux to coastal waters this was achieved by extending the capabilities of the periodic boundary conditions pbc package previously developed by post 2011 for simulating tides acting on a sloping beach face in modflow and seawat to also enable simulation of variable wave conditions considering varying wave set up in modflow nwt 2005 niswonger et al 2011 reactive transport simulations that considered denitrification nitrification and organic matter mineralization were then conducted using pht3d v2 10 prommer and post 2010 simulations without waves with steady waves and with variable wave conditions were conducted to explore the influence of steady and variable wave conditions on nitrogen fate in a nearshore aquifer sensitivity analyses were then performed to examine the influence of the availability and reactivity of the terrestrial and marine organic matter on nitrogen fate in wave influenced nearshore aquifers the findings of this study are required to determine the need to consider variable wave conditions in the design of field monitoring programs and interpretation of field data and also in the estimation of nitrogen loads delivered to coastal waters via groundwater discharge along open high energy shorelines 2 methods groundwater flow and reactive multi species transport simulations were conducted using modflow nwt 2005 niswonger et al 2011 combined with pht3d v2 10 prommer and post 2010 modflow nwt only considers constant density groundwater flow and therefore variable density flow which is important in marine nearshore aquifers was not considered in the simulations the numerical simulations were based on ipperwash beach a wave influenced freshwater beach located on the southeastern shore of lake huron ontario canada 43 12 46 6 n 81 58 6 0 w 2 1 groundwater flow model modflow nwt was used to simulate two dimensional constant density groundwater flow in an unconfined permeable nearshore aquifer exposed to waves acting on a sloping beach face the model domain and model parameterization were based on the groundwater model of ipperwash beach developed and validated by malott et al 2016 the simulated nearshore aquifer was 115 m long and 11 m deep at the shoreline location fig 1b the slope of the aquifer coastal water interface beach face boundary bc in fig 1 was 0 05 the simulated nearshore aquifer had a horizontal and vertical hydraulic conductivity k of 10 m d porosity n of 0 3 longitudinal dispersivity αl of 0 2 m and transverse dispersivity αt of 0 02 m malott et al 2016 rakhimbekova et al 2021a terrestrial groundwater flow was simulated using a constant flux of 0 5 m2 d along the vertical landward boundary ae in fig 1b based on an average measured groundwater hydraulic gradient of 0 014 at the site malott et al 2016 finally no flow conditions were set along the bottom boundary ed in fig 1b and vertical offshore boundary cd in fig 1b of the model domain the effect of waves acting on a sloping beach face was simulated by considering the phase averaged effect of waves as described by wave setup fig 1a the capabilities of the pbc package developed by post 2011 were expanded to enable time varying wave setup to be simulated in modflow nwt using time series data of offshore root mean square wave height hrms as input herein referred to as wave pbc package similar to the original pbc package post 2011 the sediment water i e aquifer coastal water and sediment air interfaces are defined using the centroids of the model grid cells using the wave pbc package the surface water elevation along the aquifer coastal water interface is represented as a head boundary condition with the head at any time t calculated using the following empirical formula describing the wave setup η m 1 η t 0 4 h r m s t 1 10 d η t h r m s t where d is the still water depth at location x nielsen 2009 the wave pbc package currently does not consider the development of a seepage face along the aquifer coastal water interface the wave pbc package was developed and incorporated for use with modflow nwt the original pbc package post 2011 was developed for use with seawat and modflow the wave pbc package was only developed for modflow nwt as numerical errors associated with the discrete drying rewetting approach were observed when it was used with other versions of modflow including seawat in these versions the discrete drying rewetting approach led to delayed onshore propagation of the wave setup point during periods of increasing wave height as an increase in the water table can only occur via flow upwards or horizontally through the saturated zone rather than via infiltration into dry inactive cells this numerical error was avoided by using modflow nwt because in this modflow version a continuous function of groundwater head is used and the grid cells remain active even if dewatered this numerical error was not as severe an issue in simulating tidal fluctuations using the original pbc package mulligan et al 2011 as tidal water level increases are often more gradual compared to the rapid movement of the shoreline landward in response to episodic high wave conditions the wave pbc package was developed such that the hrms value is able to vary for each model stress period this value may either be input by the user e g as time series data obtained from an offshore wave buoy or alternatively it may be generated by specifying a synthetic period of high wave height i e wave event of a given duration and intensity 2 h r m s t h r m s s s h r m s i n c e x p t t m a x f 2 where tmax is the time at which the maximum wave height occurs f controls the duration of the wave event i e wave event period is equal to approximately 5f h r m s s s is the initial steady state wave height and h r m s i n c is the maximum increase in wave height above h r m s s s in this current study a two year hrms time series from an offshore wave buoy c45149 southern lake huron department of fisheries and oceans canada buoy 2014 in lake huron was used as input for the wave pbc package supplementary material sm fig s1 finally detailed testing was conducted to ensure the wave pbc was working correctly and to ensure that the numerical solutions converged and were independent of the mesh size 2 2 reactive transport model microbially mediated reactions affecting the fate of nitrogen in wave influenced nearshore aquifers were simulated using a reaction network that considered five reactive species nitrate no3 ammonium nh4 oxygen o2 terrestrial dissolved organic matter dom t and coastal dissolved organic matter dom c the reaction network kinetic rate expressions and parameter values used were adopted from spiteri et al 2008b and are provided in tables 1 and 2 spiteri et al 2008b developed and validated this reaction network to simulate nutrient fate in a nearshore aquifer not exposed to tides or waves more recently this reaction network was adopted by anwar et al 2014 who simulated nutrient fate in a nearshore marine aquifer exposed to tides and steady wave conditions the simplified reaction network adopted in our study is appropriate as the objective of the study was to conceptually explore the extent to which varying wave conditions compared to no waves or steady wave conditions impact the fate of reactive species such as nitrogen species in nearshore aquifers the limitations of this simplified reaction network are discussed in section 3 4 the concentrations applied along the model boundaries are provided in table 3 the dom t and dom c concentrations correspond to the anoxic groundwater and oxic seawater concentrations used by spiteri et al 2008b the no3 nh4 and o2 concentrations were based on average measured concentrations in the groundwater and coastal water at ipperwash beach rakhimbekova et al 2021a no3 is present in the top 5 5 m of aquifer at the landward boundary ae nh4 is assumed to be negligible in the coastal water and landward groundwater but is produced as the dom t and dom c degrade constant concentrations for dom c and dom t were set at the coastal bc and landward ae boundaries respectively and the dom c was set to be more reactive than dom t for the base case simulations tables 1 and 2 degradation rate for dom c kfox2 3 0 10 7 s 1 and degradation rate for dom t kfox1 3 0 10 11 s 1 anwar et al 2014 spiteri et al 2008b conservative and reactive transport simulations were conducted for three wave height hrms scenarios no waves i e hrms 0 steady wave height hrms 0 3 m and variable wave height over time average hrms 0 3 m maximum hrms 1 0 m fig 2 a for all scenarios the model was first run for 1200 days with no waves to ensure that steady state with respect to hydraulic heads and solute concentrations was reached the final solute concentrations from this simulation were then set as the initial concentrations for the conservative and reactive transport simulations which considered no waves steady waves and variable wave conditions for each of the scenarios the simulations were run for 350 days as preliminary simulations showed that this duration was sufficient for the concentrations of the reactive species to reach steady state for the steady wave simulation the mass flux was calculated at each time step and the average mass flux over the last 50 days of the simulation 300 350 days is reported in comparing the simulation results in addition to the base case simulations sensitivity simulations were performed to quantify the influence of the wave height on the fate of nitrogen in the nearshore aquifer here steady and variable wave height simulations were run with hrms and average hrms respectively set to low wave height 0 1 m and high wave height 0 7 m in addition due to the importance of the dom t and dom c availability and reactivity on nitrogen fate in nearshore aquifers sensitivity simulations were conducted with the concentration and reactivity kfox2 of dom c varied from 0 to 0 4 mmol l and 0 to 10 5 s 1 respectively and the concentration and reactivity kfox1 of dom t varied from 0 to 1 25 mmol l and 0 to 10 7 s 1 respectively the reasons for the upper and lower values considered for these sensitivity simulations are outlined in sections 3 3 2 and 3 3 3 for each simulation the net consumption of species in the nearshore aquifer was calculated by 3 p e r c e n t a g e c o n s u m p t i o n i i e i i i 100 where ii is the total moles per day per unit width of aquifer of species i entering the aquifer via the landward ae and aquifer coastal water bc boundaries and ei is the moles per day per unit width of aquifer of species i discharging from the aquifer to the coastal water 3 results and discussion 3 1 groundwater flow patterns the groundwater flow patterns in the nearshore aquifer vary between the simulations with no waves steady wave conditions and variable wave conditions considered fig 3 a c the average daily water influx and efflux across the aquifer coastal water interface over the simulation period from 300 to 350 days are provided in table 4 as variable density flow was not considered there is negligible influx of coastal water into the aquifer for the simulation with no waves and the outflux was equal to the terrestrial groundwater flux 0 5 m3 d m malott et al 2016 as shown previously by xin et al 2010 and robinson et al 2014 wave setup causes flow recirculations through the nearshore aquifer as observed for the steady and variable wave simulations fig 3b and c these recirculations extend from the onshore wave set up point to offshore this average daily coastal water influx is higher for the variable wave simulation 0 9 m3 d m compared with the steady wave simulation 0 35 m3 d m despite the average wave height over the 50 day period from 300 to 350 days being the same hrms 0 3 m for the two simulations the coastal water influx and efflux changes over time in the variable wave model with the influx varying from 0 1 to 4 0 m3 d m and the efflux varying from 0 8 to 2 0 m3 d m over the period from 300 to 350 days fig 2b as shown previously by xin et al 2014 there is a rapid response of the coastal water influxes and a more damped and delayed response of the effluxes across the aquifer coastal water interface in response to the variable wave conditions 3 2 chemical species distributions and fluxes for base case simulations 3 2 1 oxygen the different flow patterns in the nearshore aquifer between the simulations with no waves steady waves and variable waves lead to distinct distributions of chemical constituents in the nearshore aquifer as can be seen for the o2 distributions shown in fig 3a f for final simulation time of 350 d for the conservative simulations o2 acts as a tracer for the recirculating coastal water in the aquifer as the terrestrial groundwater has negligible o2 concentration there is negligible o2 in the nearshore aquifer for the no wave simulation as there is no influx of coastal water into the aquifer fig 3a for the conservative steady wave fig 3b and variable wave fig 3c simulations wave induced recirculations lead to a zone of high o2 concentrations below the aquifer coastal water interface the extent of the recirculation zone is greater for the variable wave simulation compared to steady wave simulation both in vertical and horizontal directions as evident by the width of the o2 concentration gradients the zone of mixing between the discharging terrestrial groundwater and recirculating coastal water was also greater for the variable wave simulation this is due to transient variations in the groundwater flow paths as the wave height changes robinson et al 2014 consistent with this the size and configuration of the recirculation zone varies slightly over time in response to the changing wave height sm fig s2 for the reactive simulations o2 is rapidly consumed along the recirculation flow path as o2 acts as the main electron acceptor for dom degradation fig 3e i for both the steady and variable wave simulations all the o2 infiltrating into the aquifer was rapidly consumed along the recirculation flow paths with only a small zone of more oxic conditions existing close to the upper infiltration region of the recirculation zone fig 3 h i this zone of more oxic conditions is slightly larger for the variable wave simulation compared to the steady wave simulation fig 3 e f this is due to higher average influx of o2 into the aquifer for the variable wave simulation 0 27 mol d m over the period of 300 to 350 days compared to the steady wave simulation 0 12 mol d m table 4 combined with the rate limited consumption of o2 via dom degradation and nitrification 3 2 2 nitrate and ammonium no3 distributions in the nearshore aquifer at 350 d for the conservative and reactive simulations without waves with steady waves and with variable waves are shown in fig 4 a f the conservative simulations illustrate the effect of steady wave conditions and variable wave conditions on the discharge pathway for terrestrially derived chemicals for the simulation without waves the terrestrially derived no3 is transported horizontally across the upper aquifer and discharges close to the shoreline fig 4a in contrast for the steady and variable wave simulations the terrestrially derived no3 migrates downwards around the wave induced recirculation zone and discharges further offshore at the offshore extent of the recirculation zone rather than close to the mean shoreline position fig 4 b c enhanced wave induced mixing of the terrestrially derived no3 with recirculating coastal water is evident around the boundaries of the recirculation zone with the extent of mixing greater for the variable wave simulation compared to the steady wave simulation even without considering reactive processes dilution associated with this enhanced mixing decreases the exit concentrations for no3 discharging across the aquifer coastal water interface fig 4b c it is important to note that for marine coastal waters the zone of discharge for the terrestrial no3 may be narrower than observed in these simulations as the discharge zone will be pinched between the wave induced recirculation zone and the saltwater wedge anwar et al 2014 in the reactive transport simulations terrestrially derived no3 is denitrified as it is transported horizontally in the upper aquifer towards the aquifer coastal water interface due to the availability of dom t and absence of o2 fig 4d f for the simulation with no waves denitrification in the aquifer is by dom t only as there is negligible dom c in the aquifer for this case 21 of no3 is denitrified before it reaches the aquifer coastal water interface the stoichiometric imbalance of c n 1 84 and smaller supply of dom t 0 75 mm compared to no3 1 13 mm results in limited denitrification and thus no3 removal in contrast no3 removal is considerably higher for the steady and variable wave simulations with 76 and 94 of no3 respectively attenuated in the nearshore aquifer for these simulations no3 is also denitrified by dom c in the mixing zone as terrestrial groundwater mixes with recirculating coastal water this is illustrated in fig 4e and 4f which shows high denitrification occurring in the zone of mixing between the discharging groundwater and recirculating coastal water variable waves led to the formation of a wider mixing zone higher dom c influx fig 2c and thus a larger zone of denitrification compared to steady waves fig 4c 4f and 4i the overall simulated no3 distributions and zone of denitrification are conceptually similar to the simulation results of heiss et al 2017a and field observations of charbonnier et al 2013 and kim et al 2017 for tidally influenced nearshore aquifers for the conditions simulated the zone of denitrification associated with the wave induced mixing leads to nh4 production as dom degraded fig 5 e f due to the absence of o2 in the mixing zone nh4 is transported to the aquifer coastal water interface with negligible nitrification occurring fig 5e f there is no terrestrial or coastal source of nh4 and therefore nh4 observed in the nearshore aquifer is solely a product of dom degradation via denitrification or oxic degradation nh4 production in the aquifer is higher for the variable wave case efflux 0 054 mol d m compared with the steady wave case efflux 0 036 mol d m due to higher denitrification and dom c degradation table 4 no3 and nh4 influxes and effluxes over the last 50 days of the simulation period for the variable wave base case with reactive transport are shown in fig 2d as expected no3 influx across the aquifer coastal water interface varies directly with the water influx fig 2b and the no3 influx is considerably higher than the no3 efflux due to no3 removal in the aquifer table 4 further the efflux of nh4 is higher compared to the efflux of no3 due to nh4 production in the nearshore aquifer importantly no3 and nh4 effluxes are relatively stable over time despite the variable wave conditions 3 3 sensitivity analyses 3 3 1 influence of magnitude of wave forcing the magnitude of the wave height alters the influx of coastal water and associated chemicals e g o2 dom c into the aquifer the spatial extent of the wave induced recirculation zone and the intensity of mixing between the groundwater and coastal water robinson et al 2014b as expected the simulations conducted with hrms 0 1 m low wave case and hrms 0 7 m high wave case show that the coastal water influx is greater for the simulation with higher compared with lower steady wave height 1 4 m3 d m compared with 0 6 m3 d m sm table s1 further due to increased delivery of dom c into the aquifer and higher denitrification in the mixing zone the percentage of no3 removal in the aquifer increases from 33 to 99 as the steady hrms increases from 0 1 to 0 7 m fig 6 a sm table s1 sm fig s3 similarly there is greater influx of coastal water and associated dom c into the aquifer a larger wave induced recirculation zone and more intense mixing between the groundwater and coastal water as the wave height increases for the variable wave simulations sm table s1 sm fig s3 the percentage of no3 removal in the aquifer increases from 76 to 99 for the variable wave simulations respectively as the average wave height increases from 0 1 to 0 7 m considering the simulation results the impact of steady versus variable wave conditions on no3 removal is more important for lower wave height where there is overall less no3 removal in the aquifer fig 6a sm fig s3 nh4 production increases four fold and two fold for the steady and variable wave simulations respectively as wave height increases from 0 1 to 0 7 m sm table s1 this is due to greater dom c degradation in the nearshore aquifer due to the increased delivery of dom c and o2 into the aquifer as the wave height increases 3 3 2 influence of coastal dom dom c to evaluate the importance of dom c reactivity on no3 removal in the nearshore aquifer the dom c degradation rate constant kfox2 was varied from 0 and 3 10 5 s 1 the higher bound of kfox2 considered 3 10 5 s 1 is based on the rate used in similar studies heiss et al 2017b the lower bound of kfox2 considered 0 was selected to be able to distinguish the importance of dom c versus dom t on no3 removal in the nearshore aquifer as for this case dom t is the only electron donor available for denitrification sensitivity simulations were also performed with varying dom c concentrations from 0 to 0 4 mmol l with the concentration range considered based on prior modelling studies heiss et al 2020 2017b spiteri et al 2008b the stoichiometry of dom degradation dom o2 1 106 means that o2 is rapidly consumed by dom as observed in fig 3d f once o2 is depleted no3 is the next thermodynamically favourable terminal electron acceptor for dom degradation leading to removal of no3 via denitrification in the mixing zone consistent with the findings of desimone and howes 1996 that carbon limitation is one of the main controlling factor for denitrification the simulations show that no3 removal via denitrification increases with increasing dom c concentration and reactivity for the steady and variable wave scenarios fig 6b and c sm tables s2 and s3 sm fig s4 note that for the conditions simulated in our study the dom c concentration and reactivity do not influence the net no3 removal for the no wave case 21 removal as there was negligible coastal water influx and thus dom c input into aquifer in the absence of waves fig 6b and c sm fig s4 while there is net removal of no3 in the aquifer for high kox2 10 7 s and dom c availability 0 2 m net no3 production is observed for the simulations with low kox2 10 9 and negligible dom c supply for both the constant and variable wave scenarios fig 6b and c sm fig s4 for our simulations o2 is present in stoichiometric excess for the case with dom c 0 and therefore o2 infiltrating the nearshore aquifer is not consumed via dom c degradation this leads to oxic conditions in the mixing zone which promotes nitrification and thus leads to net no3 production figs 6b s4 similarly when the dom c degradation rate is low kfox1 10 9 s 1 o2 is not consumed via dom c degradation leading to oxic conditions and nitrification in the mixing zone and net no3 production fig 6c sm fig s4 the influence of the reactivity and availability of dom c on no3 removal in the nearshore aquifer is consistent with prior field studies that have shown temporal variations in no3 distributions in nearshore aquifers and no3 flux to coastal waters via groundwater discharge for example charbonnier et al 2013 observed from field monitoring that higher input of doc due to high chlorophyll a concentrations during spring and summer intensified respiration processes leading to o2 depletion anoxia and higher denitrification in the nearshore aquifer o2 depletion in the nearshore aquifer was observed to be considerably less in the winter when doc input was lower charbonnier et al 2013 also observed variations in o2 saturation ranging from 3 to 72 and attributed these variations to dynamic changes in beach morphology and flow recirculation residence times due to tides while the effect of variable wave conditions was not considered by charbonnier et al 2013 their findings similarly suggest that time varying chemical fluxes due to transient coastal forcing e g waves tides affect the o2 doc and no3 distributions in nearshore aquifers finally the effect of the dom c concentration and reactivity on the extent of no3 removal was greater for the simulations with variable waves compared to only steady waves ranged from 31 production to 100 no3 removal for variable waves compared with 7 production to 86 no3 removal for steady waves fig 6b and c sm fig s4 this is due to the increased coastal water influx and increased mixing in the simulations with variable waves compared to steady wave conditions 3 3 3 influence of terrestrial dom dom t while permeable nearshore aquifers are often considered organic carbon poor with coastal water being the main source of o2 and om desimone and howes 1996 rocha 2008 the availability and reactivity of terrestrial dom varies widely between aquifers and may also change in the future in response to increasing temperature and precipitation mcdonough et al 2020 simulations were conducted with the dom t concentration ranging from 0 to 1 25 mm the higher dom t concentration considered takes into account the potential predicted increase in dom in groundwater systems by 45 to 55 by 2050 mcdonough et al 2020 the lower dom t concentration dom t 0 was used to distinguish the roles of dom c and dom t on no3 removal in the nearshore aquifer as for this case dom c is the only electron donor available for denitrification additional simulations were also performed to evaluate the impact of the rate of dom t degradation on no3 removal for these simulations kfox1 was varied from 0 to 10 7 s 1 importantly for the simulations with no dom t degradation concentration 0 or kfox1 0 all no3 removal in the aquifer is being driven by denitrification by dom c in the mixing zone rather than by denitrification by dom t for these cases the extent of no3 removal is much greater with variable waves 89 considered compared to steady waves 69 due to the greater mixing between the terrestrial groundwater and recirculating coastal water additionally for all wave scenarios no waves steady waves variable waves the extent of no3 removal is greater as the concentration and reactivity of dom t increases due to increased denitrification as the terrestrial groundwater is transported through the aquifer towards the aquifer coastal water interface it should also be noted that the extent of denitrification is also a function of the distance between the landward model boundary and aquifer coastal water interface with no3 removal expected to increase as this travel distance increases for the variable wave simulations with high dom t concentration dom t 1 25 mm and reactivity kfox1 10 9 s 1 net removal of no3 is greater than 98 figs 6d and e s5 due to increased denitrification by dom t and negligible nitrification because o2 infiltrating across the aquifer coastal water interface is consumed by dom c overall variable wave conditions result in greater no3 removal for different dom t availability and reactivity scenarios compared to no wave or steady wave conditions 3 4 model limitations this study simulated groundwater flow and nitrogen transport in a constant density freshwater nearshore aquifer as occurs in inland coastal water settings in this system the wave induced flow recirculations through the nearshore aquifer are driven only by advection convective density driven forces which are important in marine nearshore aquifers are not considered the spatial extent of the simulated wave induced flow recirculations are expected to be slightly larger in a freshwater nearshore aquifer compared to if density driven flow was considered this is because the wave induced flow recirculations are not restricted by the presence of the lower density driven recirculation cell and thus saltwater wedge the absence of the saltwater wedge in freshwater nearshore aquifers also means that no mixing between discharging groundwater and recirculating seawater occurs along the dispersion zone of the saltwater wedge this additional mixing zone may enhance the reactivity of nitrogen in a marine nearshore aquifer anwar et al 2014 also note that the model used neglects seepage face formation which may impact water and chemical exchange rates across the aquifer coastal water interface and nearshore groundwater flow patterns particularly for settings where the interface beach slope is less than 0 1 boufadel et al 2011 a simplified reaction network was adopted in this study as the main objective was to conceptualize the impact of variable wave conditions on the groundwater flow dynamics and reactivity of nitrogen in a nearshore aquifer the reaction network adopted was originally developed and validated for a marine nearshore aquifer spiteri et al 2008b where denitrification rates have been found to be higher compared to freshwater sediments seitzinger 1988 therefore it is expected that our base case model results likely overestimate no3 removal for freshwater environments as denitrification rates vary based on specific site environmental conditions additional simulations were conducted to evaluate the role of dom which is the common limiting factor for denitrification desimone and howes 1996 the simplified reaction network also neglects the effects of ph ionic strength and additional redox species including sulphate and iron although these factors are known to influence n fate in nearshore aquifers appelo and postma 2005 beck et al 2017 hantush 2007 kim et al 2019 torrentó et al 2010 further while the study findings show the importance of terrestrial and coastal derived dom on n transformations in a nearshore aquifer the simplified reaction network did not consider particulate organic matter nor complex biotic and abiotic dom processing including distinguishing between bioavailable labile and less reactive biorefractory dom ibánhez and rocha 2017 seidel et al 2015 finally the chemical species concentrations at the model boundaries and rate parameters were constant with time and therefore the model neglects any transient including seasonal changes that may affect n fate in a nearshore aquifer e g ahrens et al 2020 o connor et al 2018 despite these model limitations the study results provide an important foundation for conceptualizing the potential influence of variable wave conditions of groundwater flow and nitrogen transport in nearshore aquifers and provides new insights that require further exploration in future studies 4 conclusion the numerical simulations conducted highlight the importance of variable wave conditions on the physical flow processes and fate and transport of nitrogen in freshwater nearshore aquifers and subsequent fluxes to coastal waters the modified wave pbc package developed facilitates user input and reduces the effort required to define and simulate wave setup in modflow the package is currently limited to constant density simulations using modflow nwt it is envisaged that wave setup could be incorporated into modflow 6 which has support for variable density flow however reactive transport simulations are currently not possible in combination with modflow 6 because the code does not currently support multi species transport for the conditions considered the simulations show that variable wave conditions intensify mixing in nearshore aquifers and enhance no3 removal compared to simulations with no waves or steady wave conditions for the base conditions considered no3 removal was driven primarily by denitrification by dom c for both the steady wave and variable wave simulations the sensitivity simulations indicated that dom c plays a key role in no3 removal with the absence of dom c or its low reactivity resulting in limited denitrification and more oxic conditions which then favoured nitrification and led to net no3 production in the nearshore aquifer the large influence of dom quantity and quality on the fate of nitrogen in nearshore aquifers is important considering the different dom compositions in nearshore terrestrial groundwater systems and coastal waters and potential changes in dom abundance and reactivity in the future as temperatures increase and precipitation rates change the findings of our study that variable wave conditions may result in greater transformation of nitrogen in nearshore aquifer should be considered for studies aiming to predict nitrogen fluxes to coastal water and for interpreting field data especially considering that a high percentage of the world s inland and marine shorelines are exposed to highly variable wave conditions while this study provides important conceptual understanding of the impact of variable wave conditions on the fate of nitrogen in freshwater nearshore aquifers the findings also provide an important foundation for studies exploring these impacts in marine nearshore aquifers it is recommended that further work focus on exploring the way in which multiple interacting hydrological forces e g waves and tides variable landward hydraulic gradient density effects may impact flow dynamics and nitrogen fate in nearshore aquifers and subsequent nitrogen fluxes to coastal waters numerical investigation of combined impact of waves and tides should also consider variable density flow which as discussed above may alter some of the chemical spatial patterns and the extent of chemical transformations observed in this study as the main objective of this study was to examine the impact of variable wave conditions on nitrogen reactivity the reaction network was simplified it is recommended that future studies expand the reaction network as appropriate to include other factors that may affect nitrogen transformations in nearshore aquifers including ph sulphur iron and particulate organic matter and also temporal variability in nitrogen and om sources and reactivity finally the influence of aquifer heterogeneity and temporal changes in beach morphology should also be evaluated to provide more comprehensive understanding of the effects of waves on the flows mixing and reactive transport in nearshore aquifers credit authorship contribution statement sabina rakhimbekova writing original draft investigation formal analysis visualization ming zhi wu methodology formal analysis writing original draft vincent post methodology writing review editing clare e robinson conceptualization resources funding acquisition writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2022 104273 appendix supplementary materials image application 1 
105,coastal forcing including waves lead to complex and dynamic mixing between discharging groundwater and recirculating coastal water in permeable unconfined nearshore aquifers this mixing can drive biogeochemical transformations that affect the fate of pollutants in nearshore aquifers and their ultimate discharge to coastal waters the objective of this study was to examine the effect of time varying wave conditions on the fate of nitrogen in a freshwater unconfined nearshore aquifer this was achieved by conducting numerical groundwater flow and reactive transport simulations using modflow nwt 2005 with a new modified wave pbc package together with pht3d v2 10 the simulations demonstrate that time varying wave conditions enhance mixing in the nearshore aquifer compared to simulations that only consider constant wave conditions and in doing so impact nitrogen transformations for the conditions and reaction network simulated time varying wave conditions resulted in up to 99 of nitrogen removal in the nearshore aquifer due to the intensified mixing and increased delivery of organic matter into the mixing zone sensitivity analysis shows that the abundance and reactivity of coastal derived organic matter plays a key role in nitrogen removal in aquifers along wave influenced shorelines the simulations highlight the importance of considering time varying wave conditions when designing field investigations and analysing field data the findings have implications for prediction and estimation of chemical fluxes to the coastal waters and also suggest that increasingly frequent storm events and higher wave conditions as the climate changes may modify pollutant fluxes from nearshore aquifers to coastal waters keywords groundwater coastal water interactions waves coastal aquifer reactive transport model submarine groundwater discharge data availability the wave pbc package is available from the corresponding author 1 introduction protection of coastal water resources is a major environmental challenge due to increasing population growth and development in coastal areas combined with climate change permeable unconfined aquifers are an important hydrogeological feature connecting terrestrial groundwater systems with coastal waters in this study the term coastal waters includes marine as well as inland coastal waters such as laurentian great lakes it is well established that the flux of water from aquifers to the marine coastal waters termed submarine groundwater discharge sgd can be an important source of freshwater and chemical constituents to oceans beck et al 2007 burnett et al 2003 charette et al 2005 moore 2010 1999 oehler et al 2021 similarly studies have highlighted the importance of lacustrine groundwater discharge lgd in delivering groundwater and associated chemicals to inland coastal waters lewandowski et al 2015 robinson 2015 for example lgd was recently found to contribute between 9 and 85 of total p load and between 18 and 67 of total n load to 13 measured lakes meinikmann 2016 in spite of the recognition of the importance of sgd and lgd predicting water and chemical flux from permeable unconfined aquifers to marine and inland coastal waters remains a challenge due to the complexity of the subsurface flow transport and reaction processes that occur in the nearshore aquifer close to the aquifer coastal water interface unconfined nearshore aquifers are exposed to dynamic hydrological forcings that act on a wide range of spatial and temporal scales including seasonal and interannual changes in the landward hydraulic gradient and coastal water level varying recharge patterns and coastal forcing including waves and tides conant et al 2019 santos et al 2012 these dynamic hydrological forcings as well as variable density effects in marine environments lead to the recirculation of large quantities of coastal water across the aquifer coastal water interface robinson et al 2018 santos et al 2012 as coastal water recirculates through the nearshore aquifer it mixes with the discharging terrestrial groundwater due to the distinct chemical compositions of groundwater and coastal water this mixing can considerably modify the flux of terrestrial groundwater derived chemicals discharging into coastal waters as well as affect the fate of coastal derived chemicals recirculating through the nearshore aquifer in the marine environment the seawater freshwater mixing zone is commonly referred to as a subterranean estuary the mixing and reaction processes occurring in subterranean estuaries have been shown to regulate the concentrations of a wide range of chemicals including terrestrially derived nutrients liu et al 2017a loveless and oldham 2010a oehler et al 2021 carbon cai et al 2003 goni and gardner 2003 and metals and trace metals beck et al 2010 charette and sholkovitz 2006 and their flux to coastal waters moore 1999 robinson et al 2018 an analogous less studied reaction zone also exists in nearshore aquifers in inland coastal environments and has been shown to affect the behaviour of pollutants including phosphorus and arsenic lee et al 2014 rakhimbekova et al 2021b 2021 the extent and intensity of groundwater coastal water mixing in nearshore aquifers is influenced by the various dynamic hydrological forces acting on the system that affect the flow and solute transport processes waves are an important forcing along most marine and inland coastlines worldwide and have been shown to considerably modify the flow and mixing dynamics in nearshore aquifers cartwright et al 2004 geng et al 2014 malott et al 2017 2016 rau et al 2018 robinson et al 2014a compared to tides and landward hydraulic gradient variations waves are a more irregular forcing with both wave height and wave period continuously varying over time this makes it challenging to evaluate the impact of waves on groundwater flows mixing and reactive processes in nearshore aquifers through field investigations alone numerical groundwater flow and solute transport modelling has therefore been shown to be a valuable approach for conceptually investigating the effect of waves on groundwater flows and salt transport in nearshore aquifers in marine environments geng et al 2014 geng and boufadel 2015 robinson et al 2014b xin et al 2015 2010 individual high frequency e g sub seconds to seconds wave motion drives rapid infiltration exfiltration across the aquifer coastal water interface i e beach face due to their high frequency the effect of individual waves is rapidly diminished with distance from the shoreline and with depth below the aquifer coastal water interface heiss et al 2014 li and barry 2000 malott et al 2017 taking this into account xin et al 2010 showed numerically that the main effects of waves on nearshore groundwater flows and transport can be captured by considering only wave set up i e the phase averaged effect of waves longuet higgins 1983 rather than instantaneous wave action wave set up which is the upward tilt in the mean surface water that extends from the wave breaking point to the wave run up limit drives a groundwater flow recirculation through permeable nearshore aquifers fig 1 li and barry 2000 longuet higgins 1983 considering the phase averaged wave set up only rather than instantaneous wave action greatly reduces the computational demand of simulating the effect of waves as otherwise small time steps 0 1 s are required robinson et al 2014b used the phase averaged approach to illustrate numerically that variable wave conditions i e changing wave height over time can lead to large perturbations in groundwater flow patterns and have a long lasting impact order of weeks to months on the salt distribution and mixing conditions in a nearshore subterranean estuary malott et al 2016 later provided the first field validation of using this phase averaged numerical approach to simulate the influence of variable wave heights on groundwater flow and transport in a nearshore aquifer in this study malott et al 2016 simulated field data collected at a freshwater beach on lake huron such that wave effects could be identified without complicating effects from tides and density that also co exist in marine beaches few studies have examined the influence of waves on the fate and transport of reactive chemicals in nearshore aquifers and subsequent chemical fluxes to coastal waters this is in spite of our understanding that waves particularly variable wave conditions considerably affect the flow transport and mixing processes in nearshore aquifers and that these processes can in turn affect the production attenuation and discharge of chemicals across the aquifer coastal water interface liu et al 2018 luo and jiao 2016 slomp and van cappellen 2004 to our knowledge rakhimbekova et al 2018 is the only prior field study to examine the impact of variable wave conditions on geochemical conditions and chemical fate in a nearshore aquifer this study was conducted in a nearshore freshwater aquifer and demonstrated that high wave conditions may lead to the episodic release of arsenic from the nearshore aquifer to coastal waters in the marine environment there are several field studies that have examined nitrogen transport in wave influenced nearshore aquifers while these field studies have shown that nitrate in wave influenced aquifers may be attenuated via denitrification or alternatively produced due to organic matter mineralization they were not able disentangle the effects of waves compared to other forcing e g tides density effects due to the complexity of the processes in the field couturier et al 2017 liu et al 2017b loveless and oldham 2010b oehler et al 2021 due to the complexity of untangling processes from field data alone numerical modelling studies have been used to explore the factors controlling the fate of nitrogen in nearshore aquifers with and without tides and waves spiteri et al 2008a simulated nitrogen cycling in a nearshore aquifer not exposed to tides and waves and showed that the extent of seawater freshwater mixing and the rate of denitrification depend on the groundwater velocity and organic matter mineralization rate more recently heiss et al 2017a considered mixing dependent and mixing independent reactions within a groundwater flow and reactive transport model to identify the conditions that promote attenuation of terrestrially derived nitrate in a nearshore aquifer exposed to tides they found that nitrate attenuation was greatest in a nearshore aquifer exposed to tides of intermediate tidal amplitude 0 75 m and with high sediment hydraulic conductivity high terrestrial groundwater flux steeper beach face and high hydraulic dispersion however heiss et al 2017a only considered tidal effects and not also the effects of waves anwar et al 2014 simulated the effects of tides and steady wave conditions i e wave height constant over time on nitrogen nitrate and ammonium transport in a nearshore aquifer they showed that nitrate discharge was higher from a nearshore aquifer exposed to tides amplitude 0 5 m compared with steady waves root mean square wave height hrms 1 m this was because for the conditions simulated there was greater seawater freshwater mixing leading to more decomposition of marine derived organic matter and nitrate production via nitrification of ammonium in the nearshore aquifer exposed to tides compared to the nearshore aquifer exposed to steady waves overall the reactivity of nitrogen was found to be smaller in a nearshore aquifer exposed to steady waves compared to an aquifer exposed to tides as consideration of steady wave conditions only not variable waves resulted in less seawater infiltration into the aquifer and limited seawater freshwater mixing in the nearshore aquifer compared to consideration of tidal effects anwar et al 2014 in reality wave heights are highly variable over time and as shown by robinson et al 2014b varying wave height is expected to lead to more intense seawater freshwater mixing in nearshore aquifer compared to tides alone the influence of these variable wave conditions on the fate of nitrogen in nearshore aquifers has not previously been examined numerically nor has it been observed in the field mainly due to the complexity of multiple forcing e g tides density effects acting on the aquifer coastal water interface the objective of this study was to evaluate the effect of variable wave conditions on the fate and transport of nitrogen in a nearshore aquifer and its flux to coastal waters this was achieved by extending the capabilities of the periodic boundary conditions pbc package previously developed by post 2011 for simulating tides acting on a sloping beach face in modflow and seawat to also enable simulation of variable wave conditions considering varying wave set up in modflow nwt 2005 niswonger et al 2011 reactive transport simulations that considered denitrification nitrification and organic matter mineralization were then conducted using pht3d v2 10 prommer and post 2010 simulations without waves with steady waves and with variable wave conditions were conducted to explore the influence of steady and variable wave conditions on nitrogen fate in a nearshore aquifer sensitivity analyses were then performed to examine the influence of the availability and reactivity of the terrestrial and marine organic matter on nitrogen fate in wave influenced nearshore aquifers the findings of this study are required to determine the need to consider variable wave conditions in the design of field monitoring programs and interpretation of field data and also in the estimation of nitrogen loads delivered to coastal waters via groundwater discharge along open high energy shorelines 2 methods groundwater flow and reactive multi species transport simulations were conducted using modflow nwt 2005 niswonger et al 2011 combined with pht3d v2 10 prommer and post 2010 modflow nwt only considers constant density groundwater flow and therefore variable density flow which is important in marine nearshore aquifers was not considered in the simulations the numerical simulations were based on ipperwash beach a wave influenced freshwater beach located on the southeastern shore of lake huron ontario canada 43 12 46 6 n 81 58 6 0 w 2 1 groundwater flow model modflow nwt was used to simulate two dimensional constant density groundwater flow in an unconfined permeable nearshore aquifer exposed to waves acting on a sloping beach face the model domain and model parameterization were based on the groundwater model of ipperwash beach developed and validated by malott et al 2016 the simulated nearshore aquifer was 115 m long and 11 m deep at the shoreline location fig 1b the slope of the aquifer coastal water interface beach face boundary bc in fig 1 was 0 05 the simulated nearshore aquifer had a horizontal and vertical hydraulic conductivity k of 10 m d porosity n of 0 3 longitudinal dispersivity αl of 0 2 m and transverse dispersivity αt of 0 02 m malott et al 2016 rakhimbekova et al 2021a terrestrial groundwater flow was simulated using a constant flux of 0 5 m2 d along the vertical landward boundary ae in fig 1b based on an average measured groundwater hydraulic gradient of 0 014 at the site malott et al 2016 finally no flow conditions were set along the bottom boundary ed in fig 1b and vertical offshore boundary cd in fig 1b of the model domain the effect of waves acting on a sloping beach face was simulated by considering the phase averaged effect of waves as described by wave setup fig 1a the capabilities of the pbc package developed by post 2011 were expanded to enable time varying wave setup to be simulated in modflow nwt using time series data of offshore root mean square wave height hrms as input herein referred to as wave pbc package similar to the original pbc package post 2011 the sediment water i e aquifer coastal water and sediment air interfaces are defined using the centroids of the model grid cells using the wave pbc package the surface water elevation along the aquifer coastal water interface is represented as a head boundary condition with the head at any time t calculated using the following empirical formula describing the wave setup η m 1 η t 0 4 h r m s t 1 10 d η t h r m s t where d is the still water depth at location x nielsen 2009 the wave pbc package currently does not consider the development of a seepage face along the aquifer coastal water interface the wave pbc package was developed and incorporated for use with modflow nwt the original pbc package post 2011 was developed for use with seawat and modflow the wave pbc package was only developed for modflow nwt as numerical errors associated with the discrete drying rewetting approach were observed when it was used with other versions of modflow including seawat in these versions the discrete drying rewetting approach led to delayed onshore propagation of the wave setup point during periods of increasing wave height as an increase in the water table can only occur via flow upwards or horizontally through the saturated zone rather than via infiltration into dry inactive cells this numerical error was avoided by using modflow nwt because in this modflow version a continuous function of groundwater head is used and the grid cells remain active even if dewatered this numerical error was not as severe an issue in simulating tidal fluctuations using the original pbc package mulligan et al 2011 as tidal water level increases are often more gradual compared to the rapid movement of the shoreline landward in response to episodic high wave conditions the wave pbc package was developed such that the hrms value is able to vary for each model stress period this value may either be input by the user e g as time series data obtained from an offshore wave buoy or alternatively it may be generated by specifying a synthetic period of high wave height i e wave event of a given duration and intensity 2 h r m s t h r m s s s h r m s i n c e x p t t m a x f 2 where tmax is the time at which the maximum wave height occurs f controls the duration of the wave event i e wave event period is equal to approximately 5f h r m s s s is the initial steady state wave height and h r m s i n c is the maximum increase in wave height above h r m s s s in this current study a two year hrms time series from an offshore wave buoy c45149 southern lake huron department of fisheries and oceans canada buoy 2014 in lake huron was used as input for the wave pbc package supplementary material sm fig s1 finally detailed testing was conducted to ensure the wave pbc was working correctly and to ensure that the numerical solutions converged and were independent of the mesh size 2 2 reactive transport model microbially mediated reactions affecting the fate of nitrogen in wave influenced nearshore aquifers were simulated using a reaction network that considered five reactive species nitrate no3 ammonium nh4 oxygen o2 terrestrial dissolved organic matter dom t and coastal dissolved organic matter dom c the reaction network kinetic rate expressions and parameter values used were adopted from spiteri et al 2008b and are provided in tables 1 and 2 spiteri et al 2008b developed and validated this reaction network to simulate nutrient fate in a nearshore aquifer not exposed to tides or waves more recently this reaction network was adopted by anwar et al 2014 who simulated nutrient fate in a nearshore marine aquifer exposed to tides and steady wave conditions the simplified reaction network adopted in our study is appropriate as the objective of the study was to conceptually explore the extent to which varying wave conditions compared to no waves or steady wave conditions impact the fate of reactive species such as nitrogen species in nearshore aquifers the limitations of this simplified reaction network are discussed in section 3 4 the concentrations applied along the model boundaries are provided in table 3 the dom t and dom c concentrations correspond to the anoxic groundwater and oxic seawater concentrations used by spiteri et al 2008b the no3 nh4 and o2 concentrations were based on average measured concentrations in the groundwater and coastal water at ipperwash beach rakhimbekova et al 2021a no3 is present in the top 5 5 m of aquifer at the landward boundary ae nh4 is assumed to be negligible in the coastal water and landward groundwater but is produced as the dom t and dom c degrade constant concentrations for dom c and dom t were set at the coastal bc and landward ae boundaries respectively and the dom c was set to be more reactive than dom t for the base case simulations tables 1 and 2 degradation rate for dom c kfox2 3 0 10 7 s 1 and degradation rate for dom t kfox1 3 0 10 11 s 1 anwar et al 2014 spiteri et al 2008b conservative and reactive transport simulations were conducted for three wave height hrms scenarios no waves i e hrms 0 steady wave height hrms 0 3 m and variable wave height over time average hrms 0 3 m maximum hrms 1 0 m fig 2 a for all scenarios the model was first run for 1200 days with no waves to ensure that steady state with respect to hydraulic heads and solute concentrations was reached the final solute concentrations from this simulation were then set as the initial concentrations for the conservative and reactive transport simulations which considered no waves steady waves and variable wave conditions for each of the scenarios the simulations were run for 350 days as preliminary simulations showed that this duration was sufficient for the concentrations of the reactive species to reach steady state for the steady wave simulation the mass flux was calculated at each time step and the average mass flux over the last 50 days of the simulation 300 350 days is reported in comparing the simulation results in addition to the base case simulations sensitivity simulations were performed to quantify the influence of the wave height on the fate of nitrogen in the nearshore aquifer here steady and variable wave height simulations were run with hrms and average hrms respectively set to low wave height 0 1 m and high wave height 0 7 m in addition due to the importance of the dom t and dom c availability and reactivity on nitrogen fate in nearshore aquifers sensitivity simulations were conducted with the concentration and reactivity kfox2 of dom c varied from 0 to 0 4 mmol l and 0 to 10 5 s 1 respectively and the concentration and reactivity kfox1 of dom t varied from 0 to 1 25 mmol l and 0 to 10 7 s 1 respectively the reasons for the upper and lower values considered for these sensitivity simulations are outlined in sections 3 3 2 and 3 3 3 for each simulation the net consumption of species in the nearshore aquifer was calculated by 3 p e r c e n t a g e c o n s u m p t i o n i i e i i i 100 where ii is the total moles per day per unit width of aquifer of species i entering the aquifer via the landward ae and aquifer coastal water bc boundaries and ei is the moles per day per unit width of aquifer of species i discharging from the aquifer to the coastal water 3 results and discussion 3 1 groundwater flow patterns the groundwater flow patterns in the nearshore aquifer vary between the simulations with no waves steady wave conditions and variable wave conditions considered fig 3 a c the average daily water influx and efflux across the aquifer coastal water interface over the simulation period from 300 to 350 days are provided in table 4 as variable density flow was not considered there is negligible influx of coastal water into the aquifer for the simulation with no waves and the outflux was equal to the terrestrial groundwater flux 0 5 m3 d m malott et al 2016 as shown previously by xin et al 2010 and robinson et al 2014 wave setup causes flow recirculations through the nearshore aquifer as observed for the steady and variable wave simulations fig 3b and c these recirculations extend from the onshore wave set up point to offshore this average daily coastal water influx is higher for the variable wave simulation 0 9 m3 d m compared with the steady wave simulation 0 35 m3 d m despite the average wave height over the 50 day period from 300 to 350 days being the same hrms 0 3 m for the two simulations the coastal water influx and efflux changes over time in the variable wave model with the influx varying from 0 1 to 4 0 m3 d m and the efflux varying from 0 8 to 2 0 m3 d m over the period from 300 to 350 days fig 2b as shown previously by xin et al 2014 there is a rapid response of the coastal water influxes and a more damped and delayed response of the effluxes across the aquifer coastal water interface in response to the variable wave conditions 3 2 chemical species distributions and fluxes for base case simulations 3 2 1 oxygen the different flow patterns in the nearshore aquifer between the simulations with no waves steady waves and variable waves lead to distinct distributions of chemical constituents in the nearshore aquifer as can be seen for the o2 distributions shown in fig 3a f for final simulation time of 350 d for the conservative simulations o2 acts as a tracer for the recirculating coastal water in the aquifer as the terrestrial groundwater has negligible o2 concentration there is negligible o2 in the nearshore aquifer for the no wave simulation as there is no influx of coastal water into the aquifer fig 3a for the conservative steady wave fig 3b and variable wave fig 3c simulations wave induced recirculations lead to a zone of high o2 concentrations below the aquifer coastal water interface the extent of the recirculation zone is greater for the variable wave simulation compared to steady wave simulation both in vertical and horizontal directions as evident by the width of the o2 concentration gradients the zone of mixing between the discharging terrestrial groundwater and recirculating coastal water was also greater for the variable wave simulation this is due to transient variations in the groundwater flow paths as the wave height changes robinson et al 2014 consistent with this the size and configuration of the recirculation zone varies slightly over time in response to the changing wave height sm fig s2 for the reactive simulations o2 is rapidly consumed along the recirculation flow path as o2 acts as the main electron acceptor for dom degradation fig 3e i for both the steady and variable wave simulations all the o2 infiltrating into the aquifer was rapidly consumed along the recirculation flow paths with only a small zone of more oxic conditions existing close to the upper infiltration region of the recirculation zone fig 3 h i this zone of more oxic conditions is slightly larger for the variable wave simulation compared to the steady wave simulation fig 3 e f this is due to higher average influx of o2 into the aquifer for the variable wave simulation 0 27 mol d m over the period of 300 to 350 days compared to the steady wave simulation 0 12 mol d m table 4 combined with the rate limited consumption of o2 via dom degradation and nitrification 3 2 2 nitrate and ammonium no3 distributions in the nearshore aquifer at 350 d for the conservative and reactive simulations without waves with steady waves and with variable waves are shown in fig 4 a f the conservative simulations illustrate the effect of steady wave conditions and variable wave conditions on the discharge pathway for terrestrially derived chemicals for the simulation without waves the terrestrially derived no3 is transported horizontally across the upper aquifer and discharges close to the shoreline fig 4a in contrast for the steady and variable wave simulations the terrestrially derived no3 migrates downwards around the wave induced recirculation zone and discharges further offshore at the offshore extent of the recirculation zone rather than close to the mean shoreline position fig 4 b c enhanced wave induced mixing of the terrestrially derived no3 with recirculating coastal water is evident around the boundaries of the recirculation zone with the extent of mixing greater for the variable wave simulation compared to the steady wave simulation even without considering reactive processes dilution associated with this enhanced mixing decreases the exit concentrations for no3 discharging across the aquifer coastal water interface fig 4b c it is important to note that for marine coastal waters the zone of discharge for the terrestrial no3 may be narrower than observed in these simulations as the discharge zone will be pinched between the wave induced recirculation zone and the saltwater wedge anwar et al 2014 in the reactive transport simulations terrestrially derived no3 is denitrified as it is transported horizontally in the upper aquifer towards the aquifer coastal water interface due to the availability of dom t and absence of o2 fig 4d f for the simulation with no waves denitrification in the aquifer is by dom t only as there is negligible dom c in the aquifer for this case 21 of no3 is denitrified before it reaches the aquifer coastal water interface the stoichiometric imbalance of c n 1 84 and smaller supply of dom t 0 75 mm compared to no3 1 13 mm results in limited denitrification and thus no3 removal in contrast no3 removal is considerably higher for the steady and variable wave simulations with 76 and 94 of no3 respectively attenuated in the nearshore aquifer for these simulations no3 is also denitrified by dom c in the mixing zone as terrestrial groundwater mixes with recirculating coastal water this is illustrated in fig 4e and 4f which shows high denitrification occurring in the zone of mixing between the discharging groundwater and recirculating coastal water variable waves led to the formation of a wider mixing zone higher dom c influx fig 2c and thus a larger zone of denitrification compared to steady waves fig 4c 4f and 4i the overall simulated no3 distributions and zone of denitrification are conceptually similar to the simulation results of heiss et al 2017a and field observations of charbonnier et al 2013 and kim et al 2017 for tidally influenced nearshore aquifers for the conditions simulated the zone of denitrification associated with the wave induced mixing leads to nh4 production as dom degraded fig 5 e f due to the absence of o2 in the mixing zone nh4 is transported to the aquifer coastal water interface with negligible nitrification occurring fig 5e f there is no terrestrial or coastal source of nh4 and therefore nh4 observed in the nearshore aquifer is solely a product of dom degradation via denitrification or oxic degradation nh4 production in the aquifer is higher for the variable wave case efflux 0 054 mol d m compared with the steady wave case efflux 0 036 mol d m due to higher denitrification and dom c degradation table 4 no3 and nh4 influxes and effluxes over the last 50 days of the simulation period for the variable wave base case with reactive transport are shown in fig 2d as expected no3 influx across the aquifer coastal water interface varies directly with the water influx fig 2b and the no3 influx is considerably higher than the no3 efflux due to no3 removal in the aquifer table 4 further the efflux of nh4 is higher compared to the efflux of no3 due to nh4 production in the nearshore aquifer importantly no3 and nh4 effluxes are relatively stable over time despite the variable wave conditions 3 3 sensitivity analyses 3 3 1 influence of magnitude of wave forcing the magnitude of the wave height alters the influx of coastal water and associated chemicals e g o2 dom c into the aquifer the spatial extent of the wave induced recirculation zone and the intensity of mixing between the groundwater and coastal water robinson et al 2014b as expected the simulations conducted with hrms 0 1 m low wave case and hrms 0 7 m high wave case show that the coastal water influx is greater for the simulation with higher compared with lower steady wave height 1 4 m3 d m compared with 0 6 m3 d m sm table s1 further due to increased delivery of dom c into the aquifer and higher denitrification in the mixing zone the percentage of no3 removal in the aquifer increases from 33 to 99 as the steady hrms increases from 0 1 to 0 7 m fig 6 a sm table s1 sm fig s3 similarly there is greater influx of coastal water and associated dom c into the aquifer a larger wave induced recirculation zone and more intense mixing between the groundwater and coastal water as the wave height increases for the variable wave simulations sm table s1 sm fig s3 the percentage of no3 removal in the aquifer increases from 76 to 99 for the variable wave simulations respectively as the average wave height increases from 0 1 to 0 7 m considering the simulation results the impact of steady versus variable wave conditions on no3 removal is more important for lower wave height where there is overall less no3 removal in the aquifer fig 6a sm fig s3 nh4 production increases four fold and two fold for the steady and variable wave simulations respectively as wave height increases from 0 1 to 0 7 m sm table s1 this is due to greater dom c degradation in the nearshore aquifer due to the increased delivery of dom c and o2 into the aquifer as the wave height increases 3 3 2 influence of coastal dom dom c to evaluate the importance of dom c reactivity on no3 removal in the nearshore aquifer the dom c degradation rate constant kfox2 was varied from 0 and 3 10 5 s 1 the higher bound of kfox2 considered 3 10 5 s 1 is based on the rate used in similar studies heiss et al 2017b the lower bound of kfox2 considered 0 was selected to be able to distinguish the importance of dom c versus dom t on no3 removal in the nearshore aquifer as for this case dom t is the only electron donor available for denitrification sensitivity simulations were also performed with varying dom c concentrations from 0 to 0 4 mmol l with the concentration range considered based on prior modelling studies heiss et al 2020 2017b spiteri et al 2008b the stoichiometry of dom degradation dom o2 1 106 means that o2 is rapidly consumed by dom as observed in fig 3d f once o2 is depleted no3 is the next thermodynamically favourable terminal electron acceptor for dom degradation leading to removal of no3 via denitrification in the mixing zone consistent with the findings of desimone and howes 1996 that carbon limitation is one of the main controlling factor for denitrification the simulations show that no3 removal via denitrification increases with increasing dom c concentration and reactivity for the steady and variable wave scenarios fig 6b and c sm tables s2 and s3 sm fig s4 note that for the conditions simulated in our study the dom c concentration and reactivity do not influence the net no3 removal for the no wave case 21 removal as there was negligible coastal water influx and thus dom c input into aquifer in the absence of waves fig 6b and c sm fig s4 while there is net removal of no3 in the aquifer for high kox2 10 7 s and dom c availability 0 2 m net no3 production is observed for the simulations with low kox2 10 9 and negligible dom c supply for both the constant and variable wave scenarios fig 6b and c sm fig s4 for our simulations o2 is present in stoichiometric excess for the case with dom c 0 and therefore o2 infiltrating the nearshore aquifer is not consumed via dom c degradation this leads to oxic conditions in the mixing zone which promotes nitrification and thus leads to net no3 production figs 6b s4 similarly when the dom c degradation rate is low kfox1 10 9 s 1 o2 is not consumed via dom c degradation leading to oxic conditions and nitrification in the mixing zone and net no3 production fig 6c sm fig s4 the influence of the reactivity and availability of dom c on no3 removal in the nearshore aquifer is consistent with prior field studies that have shown temporal variations in no3 distributions in nearshore aquifers and no3 flux to coastal waters via groundwater discharge for example charbonnier et al 2013 observed from field monitoring that higher input of doc due to high chlorophyll a concentrations during spring and summer intensified respiration processes leading to o2 depletion anoxia and higher denitrification in the nearshore aquifer o2 depletion in the nearshore aquifer was observed to be considerably less in the winter when doc input was lower charbonnier et al 2013 also observed variations in o2 saturation ranging from 3 to 72 and attributed these variations to dynamic changes in beach morphology and flow recirculation residence times due to tides while the effect of variable wave conditions was not considered by charbonnier et al 2013 their findings similarly suggest that time varying chemical fluxes due to transient coastal forcing e g waves tides affect the o2 doc and no3 distributions in nearshore aquifers finally the effect of the dom c concentration and reactivity on the extent of no3 removal was greater for the simulations with variable waves compared to only steady waves ranged from 31 production to 100 no3 removal for variable waves compared with 7 production to 86 no3 removal for steady waves fig 6b and c sm fig s4 this is due to the increased coastal water influx and increased mixing in the simulations with variable waves compared to steady wave conditions 3 3 3 influence of terrestrial dom dom t while permeable nearshore aquifers are often considered organic carbon poor with coastal water being the main source of o2 and om desimone and howes 1996 rocha 2008 the availability and reactivity of terrestrial dom varies widely between aquifers and may also change in the future in response to increasing temperature and precipitation mcdonough et al 2020 simulations were conducted with the dom t concentration ranging from 0 to 1 25 mm the higher dom t concentration considered takes into account the potential predicted increase in dom in groundwater systems by 45 to 55 by 2050 mcdonough et al 2020 the lower dom t concentration dom t 0 was used to distinguish the roles of dom c and dom t on no3 removal in the nearshore aquifer as for this case dom c is the only electron donor available for denitrification additional simulations were also performed to evaluate the impact of the rate of dom t degradation on no3 removal for these simulations kfox1 was varied from 0 to 10 7 s 1 importantly for the simulations with no dom t degradation concentration 0 or kfox1 0 all no3 removal in the aquifer is being driven by denitrification by dom c in the mixing zone rather than by denitrification by dom t for these cases the extent of no3 removal is much greater with variable waves 89 considered compared to steady waves 69 due to the greater mixing between the terrestrial groundwater and recirculating coastal water additionally for all wave scenarios no waves steady waves variable waves the extent of no3 removal is greater as the concentration and reactivity of dom t increases due to increased denitrification as the terrestrial groundwater is transported through the aquifer towards the aquifer coastal water interface it should also be noted that the extent of denitrification is also a function of the distance between the landward model boundary and aquifer coastal water interface with no3 removal expected to increase as this travel distance increases for the variable wave simulations with high dom t concentration dom t 1 25 mm and reactivity kfox1 10 9 s 1 net removal of no3 is greater than 98 figs 6d and e s5 due to increased denitrification by dom t and negligible nitrification because o2 infiltrating across the aquifer coastal water interface is consumed by dom c overall variable wave conditions result in greater no3 removal for different dom t availability and reactivity scenarios compared to no wave or steady wave conditions 3 4 model limitations this study simulated groundwater flow and nitrogen transport in a constant density freshwater nearshore aquifer as occurs in inland coastal water settings in this system the wave induced flow recirculations through the nearshore aquifer are driven only by advection convective density driven forces which are important in marine nearshore aquifers are not considered the spatial extent of the simulated wave induced flow recirculations are expected to be slightly larger in a freshwater nearshore aquifer compared to if density driven flow was considered this is because the wave induced flow recirculations are not restricted by the presence of the lower density driven recirculation cell and thus saltwater wedge the absence of the saltwater wedge in freshwater nearshore aquifers also means that no mixing between discharging groundwater and recirculating seawater occurs along the dispersion zone of the saltwater wedge this additional mixing zone may enhance the reactivity of nitrogen in a marine nearshore aquifer anwar et al 2014 also note that the model used neglects seepage face formation which may impact water and chemical exchange rates across the aquifer coastal water interface and nearshore groundwater flow patterns particularly for settings where the interface beach slope is less than 0 1 boufadel et al 2011 a simplified reaction network was adopted in this study as the main objective was to conceptualize the impact of variable wave conditions on the groundwater flow dynamics and reactivity of nitrogen in a nearshore aquifer the reaction network adopted was originally developed and validated for a marine nearshore aquifer spiteri et al 2008b where denitrification rates have been found to be higher compared to freshwater sediments seitzinger 1988 therefore it is expected that our base case model results likely overestimate no3 removal for freshwater environments as denitrification rates vary based on specific site environmental conditions additional simulations were conducted to evaluate the role of dom which is the common limiting factor for denitrification desimone and howes 1996 the simplified reaction network also neglects the effects of ph ionic strength and additional redox species including sulphate and iron although these factors are known to influence n fate in nearshore aquifers appelo and postma 2005 beck et al 2017 hantush 2007 kim et al 2019 torrentó et al 2010 further while the study findings show the importance of terrestrial and coastal derived dom on n transformations in a nearshore aquifer the simplified reaction network did not consider particulate organic matter nor complex biotic and abiotic dom processing including distinguishing between bioavailable labile and less reactive biorefractory dom ibánhez and rocha 2017 seidel et al 2015 finally the chemical species concentrations at the model boundaries and rate parameters were constant with time and therefore the model neglects any transient including seasonal changes that may affect n fate in a nearshore aquifer e g ahrens et al 2020 o connor et al 2018 despite these model limitations the study results provide an important foundation for conceptualizing the potential influence of variable wave conditions of groundwater flow and nitrogen transport in nearshore aquifers and provides new insights that require further exploration in future studies 4 conclusion the numerical simulations conducted highlight the importance of variable wave conditions on the physical flow processes and fate and transport of nitrogen in freshwater nearshore aquifers and subsequent fluxes to coastal waters the modified wave pbc package developed facilitates user input and reduces the effort required to define and simulate wave setup in modflow the package is currently limited to constant density simulations using modflow nwt it is envisaged that wave setup could be incorporated into modflow 6 which has support for variable density flow however reactive transport simulations are currently not possible in combination with modflow 6 because the code does not currently support multi species transport for the conditions considered the simulations show that variable wave conditions intensify mixing in nearshore aquifers and enhance no3 removal compared to simulations with no waves or steady wave conditions for the base conditions considered no3 removal was driven primarily by denitrification by dom c for both the steady wave and variable wave simulations the sensitivity simulations indicated that dom c plays a key role in no3 removal with the absence of dom c or its low reactivity resulting in limited denitrification and more oxic conditions which then favoured nitrification and led to net no3 production in the nearshore aquifer the large influence of dom quantity and quality on the fate of nitrogen in nearshore aquifers is important considering the different dom compositions in nearshore terrestrial groundwater systems and coastal waters and potential changes in dom abundance and reactivity in the future as temperatures increase and precipitation rates change the findings of our study that variable wave conditions may result in greater transformation of nitrogen in nearshore aquifer should be considered for studies aiming to predict nitrogen fluxes to coastal water and for interpreting field data especially considering that a high percentage of the world s inland and marine shorelines are exposed to highly variable wave conditions while this study provides important conceptual understanding of the impact of variable wave conditions on the fate of nitrogen in freshwater nearshore aquifers the findings also provide an important foundation for studies exploring these impacts in marine nearshore aquifers it is recommended that further work focus on exploring the way in which multiple interacting hydrological forces e g waves and tides variable landward hydraulic gradient density effects may impact flow dynamics and nitrogen fate in nearshore aquifers and subsequent nitrogen fluxes to coastal waters numerical investigation of combined impact of waves and tides should also consider variable density flow which as discussed above may alter some of the chemical spatial patterns and the extent of chemical transformations observed in this study as the main objective of this study was to examine the impact of variable wave conditions on nitrogen reactivity the reaction network was simplified it is recommended that future studies expand the reaction network as appropriate to include other factors that may affect nitrogen transformations in nearshore aquifers including ph sulphur iron and particulate organic matter and also temporal variability in nitrogen and om sources and reactivity finally the influence of aquifer heterogeneity and temporal changes in beach morphology should also be evaluated to provide more comprehensive understanding of the effects of waves on the flows mixing and reactive transport in nearshore aquifers credit authorship contribution statement sabina rakhimbekova writing original draft investigation formal analysis visualization ming zhi wu methodology formal analysis writing original draft vincent post methodology writing review editing clare e robinson conceptualization resources funding acquisition writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2022 104273 appendix supplementary materials image application 1 
106,this study presents a generic data driven reservoir operation model gdrom the hidden markov decision tree hm dt is applied to deriving representative operation modules for a reservoir a classification and regression tree cart algorithm is used to identify the application and transition conditions for the operation modules these two procedures result in the gdrom that is featured by 1 using a few input variables inflow storage doy and pdsi 2 inheriting merits of decision trees but dramatically reducing model complexity 3 adopting a consistent and transparent structure i e better interpretability than other machine learning models and 4 showing a better performance than traditional decision tree models especially in storage simulation gdrom is developed for 467 reservoirs with diverse operation purposes in different regions of the contiguous united states conus and the testing procedure shows comparable accuracy in release simulation to other ml models among these reservoirs 15 are selected for detailed analysis with diverse operational purposes and regulation capacities from different usgs water regions gdrom presents a ready to use reservoir operation model that can be incorporated into a watershed hydrological simulation model keywords reservoir simulation machine learning data driven models hidden markov decision tree model 1 introduction reservoirs are operated for water supply flood control hydropower generation navigation ecosystem protection and recreation simonovic et al 1992 lehner et al 2011 the realization of these diverse purposes requires scientifically based operation rules numerous modeling efforts have been made to explore and optimize reservoir operation rules this paper aims to develop a generic data driven reservoir operation model gdrom existing data driven reservoir operation models in the literature were developed case by case for particular individual reservoirs however a data driven model with a relatively transparent structure instead of a black box is still needed for wide and efficient applications of such models for reservoir operation with the various purposes we address this issue using some cutting edge machine learning ml techniques traditional mathematical models for reservoir operations are formulated with physical relationships i e mass balance engineering characteristics e g storage capacity as well as the rule curves that delineate the relationship between the release decision and water availability depending on inflow and storage loucks et al 1981 yeh 1985 labadie 2004 alternatively data driven models extract real world reservoir operation rules from historical operation records which may involve prescribed operation rules experiences empirical knowledge of reservoir operators and emergent responses e g regulations to extreme events in recent years ml techniques including artificial neural network ann support vector machine and regression svm and svr and decision trees dts have been used to build data driven models e g jain et al 1999 lin et al 2006 aboutalebi et al 2015 yang et al 2017 coerver et al 2018 rahnamay naeini et al 2020 zhao and cai 2020 meanwhile researchers coupled ml models with other artificial intelligence algorithms to improve model accuracy for example chaves and chang 2008 applied a genetic algorithm to optimize the parameters of an ann model in addition deep neural networks with the hierarchy of increasing feature extraction capability have also been applied to modeling reservoir operations examples include zhang et al 2019 employed recurrent neural network rnn long short term memory lstm and gated recurrent unit gru to simulate the outflow of xiluodu reservoir yang et al 2019 used three rnns nonlinear autoregressive models with exogenous input narx long short term memory lstm and genetic algorithm based naxr ga naxr to simulate the operation of three multipurpose reservoirs in thailand and verified the applicability of rnns among the ml models dt methods have been widely used in reservoir operation simulation because of their transparency simplicity and interpretability e g kumar et al 2013 yang et al 2016 rahnamay naeini et al 2020 yang et al 2021 especially dt methods follow the true or false conditional boolean logic in recursive partitioning process which is similar to the multi stage decision making process of real world reservoir operation yang et al 2020 although existing ml based studies show acceptable accuracy in reservoir operation simulation there exist several shortcomings first it is difficult to understand the decision making processes embedded with most ml models due to their black box nature second most existing studies test their ml models with one or a small number of reservoirs usually located in a single river basin it is unknown whether the models are applicable to other reservoirs especially those in other basins with diverse operational purposes third existing ml models usually derive static operation rules which can hardly mimic the operation behaviors typically affected by dynamic processes characterized by changing climate conditions time varying water demands and policies zhao and cai 2020 to address the limitations stated above several recent studies attempted to develop more general and transparent reservoir operation models yassin et al 2019 proposed a dynamically zoned target release dztr model where piecewise linear functions are fitted to approximate the release rules within different reservoir zones e g normal flood emergency storage zones turner et al 2021 presented a storage targets and release function inference tool starfit which uses 19 parameters to depict reservoir operation rules comprising weekly storage targets these studies verify the applicability of their models with a large number of reservoirs and show improvement of both release and storage simulation compared to traditional reservoir operation methods used in large scale hydrological and water resource models lhms nevertheless the identified operation rules by these models are largely simplified through simple linear regression furthermore these models are unable to capture the dynamic operation behaviors zhao and cai 2020 developed a hidden markov decision tree hm dt model to derive representative operation rules for 61 reservoirs in the upper colorado river basin the representative operation modules are represented in the form of decision trees that provide model transparency and interpretability the transition of modules from one to another is assumed to follow a markov process that quantifies the internal dependencies over time furthermore hm dt is advantageous in its capacity for describing the dynamic operation patterns through the transitions between different types of modules that present different operation schemes under different conditions such as high and low inflows and transitions between them moreover the operation rule extracted by a regular dt is usually complicated with its depth making it difficult to understand the release decision making conditions by comparison representative modules derived by the hm dt model with distinct characteristics and relatively low complexity improve the interpretability of reservoir operation rules hm dt is adopted in this paper to derive representative modules for individual reservoirs a fundamental extension of hm dt for building the gdrom is to identify the application conditions for using a specific module and the conditions for switching one module to another in simulating operation transition and dynamics this study couples hm dt with a classification model that determines which module derived from hm dt to apply under a given hydroclimatic condition the goal is to present gdrom a data driven model that will be generic for reservoirs of various operation functions capacities and locations specifically the application conditions for the representative modules derived from hm dt will be identified through a classification tree the applications of the modules under the various conditions and the releases calculated by selected modules will be simulated over the modeling period thus the hm dt derived representative modules and the classification tree will jointly form a standalone data based dynamic model for a given reservoir the gdrom is developed for totally 467 reservoirs crossing the contiguous united states conus with various operation purposes among which 15 are chosen in this paper for detailed analysis regarding the gdrom performance issues that make the proposed gdrom not applicable will be discussed proposing future studies to make data driven models more applicable to reservoirs in any place with any operation purpose in the rest of this paper the methods including the gdrom framework the hm dt model and the classification tree to determine the application conditions of operation modules are introduced in section 2 followed by the selected reservoirs and data preprocessing steps in section 3 the derived representative operation modules for individual reservoirs application conditions of modules and the simulation results from gdroms are provided in section 4 discussion on gdrom applications and limitations is presented in section 5 specifically conditions that make the gdrom not applicable will be discussed proposing future studies to make data driven models more generic finally the findings and conclusions are provided in section 6 2 methods the gdrom is derived from a two step method including extraction of representative modules and determination of module application conditions as illustrated in fig 1 for a single reservoir a set of representative operation modules are firstly extracted by hm dt note that this application of hm dt is different from what was presented by zhao and cai 2020 who applied hm dt to deriving a common model for a group of reservoirs after that a classification tree model is trained to identify module application conditions based on the decoded historical module sequence from hm dt zhao and cai 2020 finally gdrom combines the identified operation modules and the module application conditions to simulate reservoir releases in this way gdrom enables the simulation of dynamic reservoir operations with acceptable accuracy as shown in the results and model transparency due to its tree based nature input data for hm dt are the same as those used in zhao and cai 2020 i e historical inflow storage and release for training and validation while for release prediction using a trained model only inflow and initial storage are required inputs input data for the classification tree model to decide module application conditions add palmer drought severity index pdsi for drought conditions and day of the year doy for seasonality besides the hm dt inputs compared to many existing data driven models that require meteorological information reservoir operational constraints downstream river stage and water delivery data yang et al 2016 zhang et al 2019 yang et al 2019 the data required for gdroms is not heavy which will enable easy adoption of the models 2 1 extraction of representative operation modules in the first step the hm dt model developed by zhao and cai 2020 is used to derive representative operation modules from historical records hm dt assumes that the operation of a reservoir can be characterized as a limited number of operation modules with each consisting of a set of operation rules and the transitions from one module to another follow a markov process the extracted operation modules are in the form of decision trees taking inflow and initial storage as primary inputs to predict daily release decisions note that storage will still be a source variable which is determined internally details of the hm dt model can be found in the original paper zhao and cai 2020 in the model training phase for the gdrom 80 of the operation data is used for model training and the remaining 20 of the data is held out for the final testing however the training data is further split into training and validation sets following the same 80 20 principle thus the final train validation test ratio becomes 64 16 20 this follows a procedure to train validate a complex ml based model hastie et al 2009 for gdrom the hm dt model that derives the representative modules is based on two important hyperparameters the number of hidden states k and the minimum decrease in impurity for the decision tree to stop growth during training itsmin which is a parameter that is used to control the overfitting of a decision tree by avoiding node splits with the minimal increase in predictive accuracy in the training stage 30 different combinations of the two hyperparameters are designed each of which results in one set of representative operation modules regarding the model performance a larger k and a smaller itsmin will always yield the better performance zhao and cai 2020 however there can be an overfitting issue which is similar to the case of a polynomial regression with a large number of items to resolve this problem the 30 sets of representative operation modules are tested on the validation data and the one with the best performance nse pbias is chosen for final testing stage in this study the nash sutcliffe efficiency coefficient nse is chosen to evaluate the simulation performance of release for each reservoir which allows comparison across reservoirs the formula of nse is as follows 1 n s e 1 i n r s i m i r o b s i 2 i n r o b s i r o b s i 2 where r sim i and r obs i are the simulated and observed release of a reservoir at time step i respectively and n is the total number of time steps the closer the value of nse to 1 the better the prediction performance of the model negative nse means unacceptable performance for a given reservoir the selected hm dt model that passes the validation and testing generates a small number of modules and the application sequence of the modules during the historical period each derived module is characterized by application frequency the decoded hidden state sequence during the historical period i e the operation module application sequence can be obtained from the hm dt model based on observed operation records zhao and cai 2020 with the operation module application sequence we can compute the application frequency for each of the derived modules during the training periods which is computed as 2 f r e q u e n c y o f d a y s t h a t a m o d u l e i s a p p l i e d t o t a l o f d a y s d u r i n g t h e t r a i n i n g p e r i o d 2 2 determination of application conditions for representative modules to use the representative modules for reservoir operation simulation the hydroclimatic conditions for each of the modules need to be explicitly specified a tree based classification approach is used to achieve this using the classification and regression tree cart algorithm implemented in the scikit learn library pedregosa et al 2011 as a type of decision tree algorithms cart was firstly introduced by breiman et al 1984 and since then it has been widely used in data mining because of its simplicity and intelligibility e g prasad et al 2006 bessler et al 2003 kumar et al 2013 this study uses the classification tree to map the input variables i e hydroclimatic conditions to the output classes i e operation modules the core mechanism of the classification tree algorithm is the recursive partitioning process which starts with the entire input variable space i e root node and uses a binary tree to recursively split the node into more homogeneous child nodes until each node has all the same class or the improvement of deeper splitting is less than the preset threshold chipman et al 1998 several metrics can be used to measure the best split for each partition such as the gini index measuring node impurity and the entropy based index the gini index takes less computational time than the entropy based index while both achieve equivalent performance thus the gini index is broadly adopted by cart algorithms in particular the gini index has been used in the previous data driven reservoir simulation models via dt approaches e g wei 2012 yang et al 2016 in this study the gini index is employed and can be formulated in eq 3 where i 1 2 c is the index of the class pi is the conditional probability of class i in the given branch 3 g i n i 1 i 1 c p i 2 inflow and storage that are included in hm dt are chosen as inputs to cart previous studies show that the backward or forward information of storage and inflow i e storage and inflow in the past and future time periods with a certain length influence the release decision in the current time period hejazi et al 2008 for this study we designed multiple input combinations including storage and inflow in backward and or forward periods and tested those with a number of reservoirs the results showed that overall the backward or forward information does not yield a big difference in the release simulation performance by the gdrom actually the simulation accuracy decreases due to the rising variance of inputs with many reservoirs therefore only the current inflow and storage information is selected as model input additionally zhao and cai 2020 demonstrated that the wet dry conditions could call for particular reservoir operation modules that reflect the real world emergent reservoir operation plan for floods or droughts furthermore the seasonality of historical operation was also observed by zhao and cai 2020 to account for these conditions we include pdsi and doy as input variables and the sensitivity analysis of these two variables is provided in the supplementary material d admittedly other potential variables may influence reservoir operations while not considered in this study such as snow depth in the upstream areas of a reservoir and water demand part of the reason is that the importance of those variables is less than that of current input variables which may not bring significant performance improvement and thus not included to reduce model complexity in addition the difficulty in collecting data of those variables may limit the general applicability of gdrom in summary the input variables of the module classification model are inflow storage pdsi and doy for each reservoir the operation modules derived by the hm dt model are numbered from 0 to k 1 referred to as module id moreover the module id is the target variable i e the output of the module classification model the module id sequence decoded by hm dt for the training dataset will be used to train the classification tree to ensure the best performance we implemented the 5 fold cross validation technique in the training process to determine the hyper parameters 2 3 procedures to run a gdrom the gdrom for a particular reservoir comprises a set of operation modules derived from hm dt and an associated module classification model for the application conditions of each module derived from the cart thus running a gdrom is to run cart with pre derived modules from hm dt the gdrom determines daily release in three steps first the module id for a day is determined by the classification model based on inflow storage pdsi and doy second the selected module with an identification number id is invoked to determine the release following which the storage at the end of this day i e the beginning storage for the next day is computed based on water balance third the storage capacity constraints are examined to check if the computed reservoir storage lies between the minimum and maximum storage smin smax if a storage capacity constraint is violated with the predicted release the release decision and the computed storage will be adjusted based on water balance since the measured storage is not available for prediction the computed storage will be used as model inputs to a gdrom that is given the initial storage of the reservoir the storage at the end of a time period is obtained according to the water balance relationship embedded in the gdrom the estimated storage at the end of period t is used as an input to the gdrom at period t 1 see fig a1 in the supplementary material a it should be mentioned that when only one representative operation module k 1 is derived by the hm dt model for a reservoir a single dt model can predict the release with acceptable accuracy and thus the module classification model is not required nash sutcliffe model efficiency nse and percent bias pbias are chosen as statistical metrics to evaluate the model performance wu et al 2020 moriasi et al 2007 the formula for calculating nse is provided in eq 1 and the formula for pbias is 4 p b i a s i n r o b s i r s i m i i n r o b s i 100 where r sim i and r obs i are the simulated and observed release of a reservoir in time step i respectively and n is the total number of days of the observed records 3 data and data processing 3 1 basic data for the selected reservoirs we collect historical operation records of reservoirs in the conus including daily ending storage and release decisions from several public data sets managed by usbr 2021a b c usace 2021 and california data exchange center 2021 additionally we obtain some data from resopsus a recently published us historical reservoir operations dataset staeyert et al 2022 using these data sources we test the gdrom with 467 reservoirs following that we select 15 reservoirs for detailed analysis from different water regions in the conus with different operation purposes different sizes and sufficiently long data records 15 years fig 2 shows the location of the selected reservoirs and table 1 displays the attributes of the selected reservoirs in addition the pdsi series at the locations of these reservoirs are retrieved from noaa 2021 3 2 data preprocessing the quality of data is crucial to data driven studies and data preprocessing is usually needed for machine learning models to produce reliable results zhang et al 2003 crone et al 2006 general data preprocessing methods include data cleaning e g treating missing values and noises data editing e g checking outliers and validity data reduction e g dimensionality reduction feature selection and data transformation e g encoding categorical data feature scaling garcía et al 2015 data preprocessing often requires knowledge based approaches to understand and identify some issues related to research questions felix and lee 2019 for reservoir operation studies the water balance relationship must be satisfied i e 5 s t 1 s t n e t i t r t 6 n e t i t i t p t e p t o g t o l t where s i r p ep og and ol represent storage inflow release precipitation surface evaporation other water gains and other water losses respectively for real world reservoir operations it is difficult to measure the actual inflow to a reservoir because of seepage loss and recharge and discharge between a reservoir and the surrounding aquifer instead of the observed inflow the computed net inflow net it based on water balance is often used for example usbr provides the computed inflow time series based on storage release and evaporation of reservoirs usbr 2021a in this study it is assumed that the possible error involved in the release and storage data obtained from usbr or usace is ignorable and thus the net inflow is calculated by eq 6 the computed net inflows are used to replace the measured inflow and for simplicity they are referred to as inflows in the rest of this paper note that the storage data retrieved from usbr and usace at storages at the end of day we thus convert them into the initial storages for next time period by shifting the storage time series by one time step i e one day in this way we obtain the initial storages which are involved in the release decision making in each time period raman and chandramouli 1996 yang et al 2016 it is also essential to ensure that the modeled reservoir storage lies between the minimum storage e g dead storage and the maximum storage e g the capacity observed in the real world these storage bounds are extracted from the historical reservoir operation records which are used in the model to check and correct the outliers of the simulated storage further the input variables including inflow storage and release are normalized by the maximum historical storage of the corresponding reservoir which makes it easier to compare the identified operation modules and the simulation performance between different reservoirs zhao and cai 2020 in addition since the hidden markov model requires continuity of the data sequences the historical operation records are divided into continuous segments if missing data points exist moreover continuous records whose lengths are shorter than 100 days are discarded because the inherent dependencies cannot be sufficiently represented by those short records as zhao and cai 2020 elaborated the processed records are treated as independent samples for training the hm dt model and the classification model 4 results the gdrom model is applied to each of the selected reservoirs the results include some typical types of operation modules derived from hm dt the operation conditions for a particular module derived from cart the combination of both stated above to form a gdrom and release simulation and accuracy assessment for each of the selected reservoirs 4 1 representative operation modules the two hyper parameters of the hm dt model i e the number of hidden states k i e the minimum number of modules that reaches a high and stable nse value and the minimum decrease in impurity in the decision tree itsmin are tested and initially determined with the validation data based on the hm dt model performance evaluated by nse as a demonstration example the model prediction accuracy with the american falls reservoir is plotted in fig 3 a under three levels of itsmin the nse values rise rapidly with k at first but the increase diminishes when k becomes large the impact of itsmin is significant when k is small a similar pattern is observed for most of the selected reservoirs in this study however for surry mountain lake and wilson lake the nse values do not change significantly with k e g surry mountain lake fig 3b indicating that one operation module can describe the major operation rules for these two reservoirs the values of k and itsmin are determined during the hm dt validation step for each study reservoir these values might need some refinement for running a gdrom this is because the actual performance of the gdrom is also impacted by the application conditions of modules determined by the cart in addition to the accuracy of the modules derived from the hm dt the final values of k and itsmin are listed in table 2 showing that 1 to 5 representative modules can describe the various operation rules for these reservoirs with sufficiently high nse the derived operation modules m classification types t and application frequencies of the modules eq 2 are listed in table 2 although different representative operation modules are derived for different reservoirs these modules in the form of decision trees share similar structures five typical types of the operation modules are discussed as below type 1 operation modules for low flow periods reservoirs usually maintain a small release during low flow periods for storage filling while satisfying essential water supply or environmental flow requirements type 1 t1 modules fit within this operation condition under most t1 modules the release is constant regardless of inflow and storage and the release is smaller than the average inflow leading to storage filling among the selected reservoirs those with a primary purpose of irrigation echo reservoir american falls reservoir adopt t1 modules during the non irrigation season however operations under t1 modules do not necessarily build up storage depending on the purpose s for particular reservoirs for example the aquilla lake with flooding control as the primary operating purpose and water supply as the secondary adopts two t1 modules with constant releases for different water supply requirements during non flooding periods it turns out that the storage decreases when t1 modules are applied while the conservation pool will be filled with the high inflows during flooding periods under m2 t2 in addition not all t1 modules adopt a constant release for example with m3 t1 the pathfinder reservoir releases vary with inflows ending with storage filling during low flow periods type 2 operation modules for high flow periods for many of the fifteen reservoirs there exists a separate module that is applied to high flow periods for flooding control or high demand water supply under which the releases are the highest among the operation modules these modules are classified as type 2 t2 under which the release decisions are jointly controlled by inflow and storage with multilayer hierarchical tree structures see details in supplementary material b and the average releases are higher than the average inflows ending with decreased storage in particular t2 modules are applied during the irrigation season during which releases are high e g echo reservoir american falls reservoir type 3 operation modules with inflow as dominant control type 3 t3 modules are applied for inflow dominated release decisions by which the inflow and release have a nearly linear relationship for example only one representative module t3 is derived for the wilson lake fig 4 this reservoir is operated mainly for hydropower generation with a small s in ratio 0 033 due to the limited regulation capacity the releases were almost identical to inflows for most of the time type 4 operation modules with a constant release besides t1 modules under which the release is usually constant for low flow periods constant release modules type 4 t4 are also identified with large reservoirs especially when the actual operation schemes are not much affected by inflow and storage for example module 0 for the lake berryessa in california with a large capacity is characterized by a small constant release applied during the period of november to march for municipal water supply in the region where the reservoir locates due to the mediterranean climate major precipitation falls between december and march i e the high flow period when module 0 is applied since the constant release is lower than the average inflow during this period the storage is filled underlying module 0 type 5 transitional operations modules between t1 for low flow periods and t2 for high flow periods modules there are some transitional operation modules type 5 t5 for some reservoirs compared to t1 and t2 modules t5 modules have a medium level release and even monthly application frequency due to varying water demands fluctuating inflow conditions and different operation objectives the controlling variables and their relationships are diverse for different reservoirs under t5 modules the release decisions are controlled by a single variable inflow or storage e g under m4 of bighorn lake or jointly controlled by two variables inflow and storage with multilayer tree structures e g m2 of carlyle lake and m1 of echo reservoir as an example the relationship between inflow and release under each of the derived modules for echo reservoir is shown in fig 5 where three modules are derived m0 m1 and m2 belonging to t2 t5 and t1 respectively with the same inflow the releases are the highest under m0 overall the inflows are also the highest under m0 showing that this module is mainly applied during high flow periods i e m0 is a t2 module in contrast under m2 the releases are the smallest and maintain constant regardless of inflow levels which are usually low indicating that m2 belongs to t1 m1 is a typical t5 module with medium level releases where inflow and storage jointly determine the release as demonstrated with the if then rules fig 5 for all the selected reservoirs in this study the detailed operation modules in the form of decision trees are provided in supplementary material b 4 2 application conditions for representative modules the cart algorithm identifies the application conditions of the various operation modules including diverse operation objectives fluctuating inflows and different water regulation capacities under these conditions the relative importance of the input variables to the module classification models varies cart provides a measure of the importance as shown in fig 6 for the selected reservoirs in particular doy dominates the classification for american falls reservoir and lake berryessa while inflow becomes the critical input for carlyle lake and jordan lake this difference is due to complex factors including the reservoir storage capacity inflow water demand policies as well as operation purposes lake berryessa is mainly operated for irrigation and municipal water supply to solano county california these water demands vary by season and thus doy plays the major role in determining the module to satisfy different levels of demands while for aquilla lake with the primary purpose of flood control the conservation storage capacity only accounts for one third of the total capacity once the reservoir storage is above the top of the conservation pool a module for flooding control t2 module will be used consequently the storage dominates the module classification the module classification tree of the american falls reservoir is shown in fig 7 as a demonstration example the module classification trees for other selected reservoirs are provided in supplementary material c the module classification tree illustrates the application conditions for each of the derived modules with explicit if then rules for example the leftmost branch of the tree in fig 7 shows the following condition when doy 0 33 i e before may 1 of a year and storage 0 66 module 0 t1 release 380 cfs is applied to determine releases according to american falls resources management plan 1995 and olenichak 2020 if american falls reservoir is not completely filled before the beginning of the irrigation season april to october the reservoir has the priority to refill before may 1 with a required minimum release at 300 cfs that is to say when the storage is relatively low i e storage 0 66 before may 1 i e doy 0 33 american falls reservoir releases a constant and small amount of water i e using module 1 to facilitate the storage filling thus the derived representative modules and application conditions are consistent with the real world reservoir operation policies similar observations are found for carlyle lake the derived model for this reservoir shows that module 0 t2 plays a major role in high level release determination during the flood season under which storage and inflow jointly control release decisions while storage poses a larger impact the simplified primary application conditions for module 0 are inflow 0 001 doy 0 34 or 0 94 i e before may 4 or after december 9 of a year these conditions are consistent with the operation policies stated in the carlyle lake water 2007 which states that a larger flood control pool is needed between december 1 and may 1 and the release is highly correlated with elevation storage during the period 4 3 using gdroms for release prediction gdrom is designed to simulate reservoir release given inflow transformed into net inflow doy pdsi and the initial storage of the simulation period in which the storage in the following time steps is obtained through the water balance equation eq 5 with the simulated release gdroms are tested with 467 reservoirs in conus fig 8 presents the release simulation performance of these reservoirs during the testing periods measured by nse and pbias as can be seen the nses of release simulations are higher than 0 8 for 28 0 5 for 63 and 0 3 for 80 of the selected conus reservoirs while most pbiass are lower than 5 with a zero mean normal distribution such nse based performance is comparable to other ml studies on reservoir operation yang et al 2016 zhang et al 2019 yang et al 2021 among the selected 15 reservoirs the operations of wilson lake and surry mountain lake are controlled by inflow with the nearly linear relationship between inflow and release hence the derived operation module a dt model can predict release with very high nses 0 88 american falls reservoir and lake berryessa for which doy controls the module classification also show high nses 0 8 however for about 5 of the 467 reservoirs gdroms fail in estimating the release with very low nses nse 0 1 besides it is found that the simulated release of several reservoirs cannot capture the daily fluctuation despite a positive nse e g lake powell see supplementary material e the possible failure reasons for gdroms are explained in section 5 4 with dworshak reservoir and lake powell as examples additionally it is observed that for some reservoirs the error propagation of the simulated storage will not significantly affect the release prediction accuracy of a gdrom because with the simulated storage as an input the long term operation simulation via the gdrom may automatically adjust some bias due to the feedback mechanism of the storage release relationship that is to say if the simulated release is significantly larger than the observed at time t then the simulated storage at time t 1 may be smaller than the observed value because of water balance and capacity constraints following that with smaller simulated storage release decisions in the next time step will be adjusted to a smaller value which in turn controls the deviation of the release and storage simulation from the observation as a result the prediction is robust to demonstrate the use of gdrom for reservoir operation prediction within a certain time horizon e g month or year the pathfinder reservoir is chosen during the hydrological year 2016 a re analysis assuming perfect daily inflow forecast given inflow pdsi data for that year and the initial storage on october 1 2015 the nse of the predicted daily release over a year is 0 75 and the nse of the predicted storage is 0 90 fig 9 although the predicted releases in june july 2016 are lower than the actual values the annual release variation especially the high and low release period transition are predicted by the gdrom meanwhile the projected storage trajectory shows the same trend as the observation indicating that the gdrom can simulate water storage change reasonably the real world model application for prediction is challenged by inflow forecast uncertainty zhao et al 2020 even though operators often use a reservoir simulation model to project reservoir releases under different inflow conditions for example usbr makes three annual operation plans with the minimum most probable and maximum inflow forecast for reservoirs managed by the agency usbr 2021d 5 discussions 5 1 understanding real world reservoir operation patterns through gdrom the gdrom of a reservoir comprises the representative operation modules in the form of if then operation rules and the module classification tree representing application conditions hence the gdrom can be used to support real world reservoir operations using interpretable operation rules in particular the operation rule changes in response to varying operating conditions i e the transitions between different operation modules can inform the patterns of reservoir operation dynamics fig 10 shows the simulated module sequence of echo reservoir from 1990 to 2014 as an example with irrigation as the primary purpose it is found that for most years module 2 t1 is applied for storage filling during the low flow periods fig 11 a module 0 t2 is mainly applied for irrigation and flooding control during the high flow periods fig 11b module 1 t5 serves as a transition between module 0 t1 and module 2 t2 a cyclic annual operation pattern t1 t5 t2 t5 t1 is observed from fig 10 this pattern is also observed with the american falls reservoir another reservoir primarily operated for irrigation furthermore for most of the selected reservoirs it is observed that the operation patterns are influenced by wet and dry conditions characterized by pdsi when a drought event occurs the operation rules are adjusted to mitigate the drought impact hejazi and cai 2011 for example bighorn lake adopted different operation patterns in response to a severe drought event during 2001 to 2005 pdsi 2 fig 12 for the high flow periods module 0 was applied replacing module 1 commonly used for this reservoir for the low flow periods module 2 was adopted with a low constant release only for drought events specifically the module classification tree identifies the operation conditions for module 2 as net inflow 0 storage 0 66 and doy 0 33 day 120 or doy 0 77 day 281 these conditions indicate a drought event and the reservoir operators adopted a drought management plan for the operation during the drought event zhao and cai 2020 demonstrated that the hm dt model could capture long term reservoir operation rule changes by applying different modules in the same season of early and recent years e g moon lake in utah the underlying operation conditions that trigger operational changes such as changing climate water demand and or operation policies are treated as unknown hidden states in hm dt model thus the gdrom based on hm dt can simulate the release and storage changes due to climate variability and policy changes in the simulation of historical operations this is demonstrated by the gdrom simulation of the pathfinder reservoir operation fig 13 the pathfinder reservoir had fluctuating daily release during the low flow periods before 2001 while in later years the release in low flow periods remained a constant value the gdrom successfully catches this operational change by the transition from module 3 to module 0 for operations in low flow periods in this case the changing climate condition plays the major role in operation changes which is represented by pdsi in the gdrom when the gdrom is used for a prediction purpose any policy change should be given as an external input to the model and the model can be used to simulate the release response to the given policy change in addition gdrom which is a simulation model can be coupled with an optimization program to seek optimal policy changes the results of the gdroms for the selected 15 reservoirs also show reservoir operation patterns relevant to the role of reservoir operation purposes it is found that irrigation reservoirs usually have three or four modules common types t1 t2 t5 with a clear seasonal module transition e g echo reservoir american falls reservoir pathfinder reservoir for reservoirs mainly used for flood control and water supply the derived modules are either t1 for water supply in low flow periods or t2 for flood control during high flow periods e g aquilla lake jordan lake clinton lake when reservoirs are primarily used for flood control but also for hydropower generation t5 modules are frequently used to generate more electricity during transition periods between high and low flow seasons e g detroit lake 5 2 using gdroms for storage simulation gdroms conduct release prediction along with storage simulation for the selected 15 reservoirs the performance of the storage simulation during the testing periods measured by nse is shown in fig 14 a although an accurate multi year storage simulation is challenging due to storage error accumulation the simulation results are reasonable under gdroms with nse higher than 0 6 for 11 of the 15 reservoirs the reservoirs with low nses for storage prediction include dworshak reservoir wilson lake and bighorn lake the poor storage simulation for dworshak reservoirs is due to the error accumulation caused by poor release prediction for wilson lake the release simulation ends with nse 0 998 while the storage simulation ends with nse 0 07 this is because wilson lake is a relatively small reservoir with s in ratio 0 033 and the accumulation of release simulation error in a few days can have a large effect on the storage in addition the release has an approximately linear relationship with inflow as shown in fig 4 and thus the release simulation is not affected by the storage simulation similarly gdrom for bighorn lake yields acceptable release simulation but poor storage simulation fig 14b where the storage also plays a minor role in determining daily release despite of a larger relative storage capacity s in ratio 0 530 in general the storage simulation performance of gdroms is affected by release simulation accuracy relative storage capacity and the relevance of storage to daily release decision 5 3 comparison with other decision tree based models in this section we compare the prediction performance of gdrom to two popular dt based models cart used as a regression tree model and random forest to compare their prediction performance with gdrom note that cart is a part of gdrom and it is used as a classification model in this study to identify the module application conditions however numerous studies have used cart an early and classical dt based model as a regression model similar to the formulation of gdroms the same inputs inflow storage pdsi and doy and some external constraints to ensure water balance and storage bounds are used for regression trees and random forest the results show that these three models have similar performance in release prediction for most of the fifteen selected reservoirs the gdroms have slightly better performance for six reservoirs than random forest and regression trees fig 15 a among the selected reservoirs the release simulation accuracy is particularly low for lake powell pow and dworshak reservoir dwo under all three models and the details are explained in section 5 4 additionally other ml models used in reservoir operation such as ann svm and lstm e g lin et al 2006 aboutalebi et al 2015 zhang et al 2018 also demonstrated acceptable accuracy in release simulation although gdroms may not significantly improve prediction accuracy they show better interpretability due to the transparency of decision trees and the typical operation schemes from a small number of representative modules gdroms reveal the dynamic operation patterns in the transitions of these modules apart from the failure cases with lake powell and dworshak reservoir it is found that overall gdroms produce stable and better storage simulation performance than random forest and regression trees fig 15b especially for echo reservoir ech pathfinder reservoir pat and lake mcconaughy mcc gdroms perform much better than the other two models one of the reasons can be overfitting which is more likely to occur with regression trees and random forest overfitting causes some extreme deviations of release prediction and associated storage prediction with gdroms the two layer model structure i e choosing a module under particular conditions and predicting releases using the chosen module can provide some flexibility in prediction to mitigate the effect of overfitting specifically when the simulated release largely deviates from the observation at time t the computed storage based on water balance at time t 1 will also deviate from the observed value which first affects the module determination and then the release decision under the selected module at time t 1 due to the feedback mechanism of the release storage relationship gdroms with the two layer structure can adjust some bias period by period and reduce cumulative storage deviation 5 4 issues that affect gdrom performance as mentioned above gdroms perform well in release simulation for most reservoirs with diverse operation functions and different capacities but the performance is unacceptable for lake powell and dworshak reservoir the lake powell with the glen canyon dam is a multipurpose reservoir with the second largest storage capacity in the us the release decision making of lake powell is based on complex factors including water demand electricity demand environment protection and policies rather than simply using current inflow and storage levels usbr 2021e for example lake powell releases low and steady flow for the ecological flow requirements while it has much higher releases during high flow periods for sediment flushing usbr 2021f 2021g in addition with an installed capacity of 1320 mv lake powell is also operated to regulate electric peak load usbr 2021e which leads to the fluctuation of daily releases similarly the daily releases fluctuate largely during the high flow periods with the dworshak reservoir the high daily variability during high flow periods and the demand driven operation policy with these reservoirs are not represented by the input variables of current gdroms consequently the derived operation modules and application conditions deviate from real world operations and the prediction accuracy of gdroms is low similarly the poor performance of random forest and regression trees for these two reservoirs is also due to the inadequate information of current model inputs to make gdroms applicable to those reservoirs with complex operations it is suggested to consider new input variables or constraints on the various factors such as water demand environmental flow constraints inflow prediction etc nevertheless the current gdrom is applicable to most of the reservoirs since the operation of only very few reservoirs is dominated by variables other than inflow and storage another limitation of gdrom is that only the fixed storage bounds extracted from the historical operation records are considered in the real world operations however the flood control pool and conservation pool usually vary with seasons indicating that the upper bound of storage is not fixed throughout the year besides storage limits there can be maximum release constraints for downstream flood mitigation considering that the reservoir specific varying flood and conservation pools are highly complicated to collect and organize the gdrom does not involve varying storage limits or other engineering constraints admittedly the simulated release and storage by gdrom may sometimes violate the usace flood control requirements without adding these constraints but the overall simulation performance remains reasonable as these constraints are embedded in observations if a user applies gdrom for one single reservoir it is recommended to add specific constraints for performance improvement 6 conclusions this study couples the hidden markov decision tree hm dt model developed by zhao and cai 2020 with a classification tree algorithm and build a generic data driven reservoir operation model gdrom the gdrom for a particular reservoir combines a small set of representative operation modules derived by the hm dt model and application conditions of the modules extracted from cart model compared with many existing data driven models gdrom is generic in terms of 1 common uncumbersome inputs i e inflow storage pdsi doy 2 consistent model structure i e a small number of representative operation modules and their application conditions 3 acceptable performance with any reservoirs of various operation functions capacities or locations the gdrom is developed for 467 reservoirs with diverse operation purposes in different regions of the contiguous united states conus and the testing procedure shows comparable accuracy in release simulation to other ml models detailed analysis is conducted for 15 selected reservoirs the results show that 1 to 5 operation modules can represent the operation rules for each of the reservoirs the gdroms achieve equivalent accuracy to the random forest in release simulation tests and for 13 of the 15 reservoirs nse 0 3 which verifies the applicability of the gdroms to reservoirs with various operation purposes locations and capacities in particular the models achieve better accuracy in storage predictions for most of the 15 reservoirs than random forest and regression trees overall the gdroms show multiple advantages including easily satisfied data requirements transparent model structure and improved storage simulation performance compared to existing data driven models especially existing models usually derive static operation rules while gdrom can simulate the dynamic operation patterns through choosing an appropriate module in response to specific operation conditions with acceptable prediction accuracy the gdrom can be applied to simulating and predicting daily reservoir releases and storages and help make reservoir operation plans for a certain time horizon e g season or year furthermore the gdrom can be used to explore reservoir operation understanding and improvement the transparent tree based structure i e if then rules of the gdrom representing reservoir operation modules and application conditions will help understand operation rules and operation patterns additionally as a standalone reservoir simulation model with light computing requirement the gdrom can serve as a reservoir component in watershed hydrological simulation models zhao and cai 2020 wu et al 2020 however the proposed gdrom method is subject to some limitations not all the derived operation modules can be interpreted using realistic reservoir operation rules this is because under some modules there can be multiple release decisions that are applicable to different conditions which are probably caused by numerical randomness of the hidden states besides when the daily releases of reservoirs largely fluctuate and the fluctuation cannot be simply explained by current inflow and storage the gdrom fails in predicting the operationsof those reservoirs future studies can explore the performance improvement of such reservoirs e g lake powell dworshak reservoir by adding new input variables such as inflow forecast in next couple of days for reservoirs mainly used for flooding control hejazi and cai 2011 zhao et al 2019 nevertheless the proposed gdrom has acceptable performance for most of the testing reservoirs located in different regions in the u s implying that it can be applied to many other reservoirs in the u s and likely in other countries where sufficient data for gdrom training and validation are available credit authorship contribution statement yanan chen conceptualization methodology software formal analysis writing original draft donghui li conceptualization methodology software formal analysis writing review editing qiankun zhao conceptualization methodology writing review editing ximing cai conceptualization supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the first author yanan chen is supported by the scholarship from china scholarship council no 201906060183 the authors would like to express their thanks to all reviewers and editors for their helpful comments and suggestions supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2022 104274 appendix supplementary materials image application 1 
106,this study presents a generic data driven reservoir operation model gdrom the hidden markov decision tree hm dt is applied to deriving representative operation modules for a reservoir a classification and regression tree cart algorithm is used to identify the application and transition conditions for the operation modules these two procedures result in the gdrom that is featured by 1 using a few input variables inflow storage doy and pdsi 2 inheriting merits of decision trees but dramatically reducing model complexity 3 adopting a consistent and transparent structure i e better interpretability than other machine learning models and 4 showing a better performance than traditional decision tree models especially in storage simulation gdrom is developed for 467 reservoirs with diverse operation purposes in different regions of the contiguous united states conus and the testing procedure shows comparable accuracy in release simulation to other ml models among these reservoirs 15 are selected for detailed analysis with diverse operational purposes and regulation capacities from different usgs water regions gdrom presents a ready to use reservoir operation model that can be incorporated into a watershed hydrological simulation model keywords reservoir simulation machine learning data driven models hidden markov decision tree model 1 introduction reservoirs are operated for water supply flood control hydropower generation navigation ecosystem protection and recreation simonovic et al 1992 lehner et al 2011 the realization of these diverse purposes requires scientifically based operation rules numerous modeling efforts have been made to explore and optimize reservoir operation rules this paper aims to develop a generic data driven reservoir operation model gdrom existing data driven reservoir operation models in the literature were developed case by case for particular individual reservoirs however a data driven model with a relatively transparent structure instead of a black box is still needed for wide and efficient applications of such models for reservoir operation with the various purposes we address this issue using some cutting edge machine learning ml techniques traditional mathematical models for reservoir operations are formulated with physical relationships i e mass balance engineering characteristics e g storage capacity as well as the rule curves that delineate the relationship between the release decision and water availability depending on inflow and storage loucks et al 1981 yeh 1985 labadie 2004 alternatively data driven models extract real world reservoir operation rules from historical operation records which may involve prescribed operation rules experiences empirical knowledge of reservoir operators and emergent responses e g regulations to extreme events in recent years ml techniques including artificial neural network ann support vector machine and regression svm and svr and decision trees dts have been used to build data driven models e g jain et al 1999 lin et al 2006 aboutalebi et al 2015 yang et al 2017 coerver et al 2018 rahnamay naeini et al 2020 zhao and cai 2020 meanwhile researchers coupled ml models with other artificial intelligence algorithms to improve model accuracy for example chaves and chang 2008 applied a genetic algorithm to optimize the parameters of an ann model in addition deep neural networks with the hierarchy of increasing feature extraction capability have also been applied to modeling reservoir operations examples include zhang et al 2019 employed recurrent neural network rnn long short term memory lstm and gated recurrent unit gru to simulate the outflow of xiluodu reservoir yang et al 2019 used three rnns nonlinear autoregressive models with exogenous input narx long short term memory lstm and genetic algorithm based naxr ga naxr to simulate the operation of three multipurpose reservoirs in thailand and verified the applicability of rnns among the ml models dt methods have been widely used in reservoir operation simulation because of their transparency simplicity and interpretability e g kumar et al 2013 yang et al 2016 rahnamay naeini et al 2020 yang et al 2021 especially dt methods follow the true or false conditional boolean logic in recursive partitioning process which is similar to the multi stage decision making process of real world reservoir operation yang et al 2020 although existing ml based studies show acceptable accuracy in reservoir operation simulation there exist several shortcomings first it is difficult to understand the decision making processes embedded with most ml models due to their black box nature second most existing studies test their ml models with one or a small number of reservoirs usually located in a single river basin it is unknown whether the models are applicable to other reservoirs especially those in other basins with diverse operational purposes third existing ml models usually derive static operation rules which can hardly mimic the operation behaviors typically affected by dynamic processes characterized by changing climate conditions time varying water demands and policies zhao and cai 2020 to address the limitations stated above several recent studies attempted to develop more general and transparent reservoir operation models yassin et al 2019 proposed a dynamically zoned target release dztr model where piecewise linear functions are fitted to approximate the release rules within different reservoir zones e g normal flood emergency storage zones turner et al 2021 presented a storage targets and release function inference tool starfit which uses 19 parameters to depict reservoir operation rules comprising weekly storage targets these studies verify the applicability of their models with a large number of reservoirs and show improvement of both release and storage simulation compared to traditional reservoir operation methods used in large scale hydrological and water resource models lhms nevertheless the identified operation rules by these models are largely simplified through simple linear regression furthermore these models are unable to capture the dynamic operation behaviors zhao and cai 2020 developed a hidden markov decision tree hm dt model to derive representative operation rules for 61 reservoirs in the upper colorado river basin the representative operation modules are represented in the form of decision trees that provide model transparency and interpretability the transition of modules from one to another is assumed to follow a markov process that quantifies the internal dependencies over time furthermore hm dt is advantageous in its capacity for describing the dynamic operation patterns through the transitions between different types of modules that present different operation schemes under different conditions such as high and low inflows and transitions between them moreover the operation rule extracted by a regular dt is usually complicated with its depth making it difficult to understand the release decision making conditions by comparison representative modules derived by the hm dt model with distinct characteristics and relatively low complexity improve the interpretability of reservoir operation rules hm dt is adopted in this paper to derive representative modules for individual reservoirs a fundamental extension of hm dt for building the gdrom is to identify the application conditions for using a specific module and the conditions for switching one module to another in simulating operation transition and dynamics this study couples hm dt with a classification model that determines which module derived from hm dt to apply under a given hydroclimatic condition the goal is to present gdrom a data driven model that will be generic for reservoirs of various operation functions capacities and locations specifically the application conditions for the representative modules derived from hm dt will be identified through a classification tree the applications of the modules under the various conditions and the releases calculated by selected modules will be simulated over the modeling period thus the hm dt derived representative modules and the classification tree will jointly form a standalone data based dynamic model for a given reservoir the gdrom is developed for totally 467 reservoirs crossing the contiguous united states conus with various operation purposes among which 15 are chosen in this paper for detailed analysis regarding the gdrom performance issues that make the proposed gdrom not applicable will be discussed proposing future studies to make data driven models more applicable to reservoirs in any place with any operation purpose in the rest of this paper the methods including the gdrom framework the hm dt model and the classification tree to determine the application conditions of operation modules are introduced in section 2 followed by the selected reservoirs and data preprocessing steps in section 3 the derived representative operation modules for individual reservoirs application conditions of modules and the simulation results from gdroms are provided in section 4 discussion on gdrom applications and limitations is presented in section 5 specifically conditions that make the gdrom not applicable will be discussed proposing future studies to make data driven models more generic finally the findings and conclusions are provided in section 6 2 methods the gdrom is derived from a two step method including extraction of representative modules and determination of module application conditions as illustrated in fig 1 for a single reservoir a set of representative operation modules are firstly extracted by hm dt note that this application of hm dt is different from what was presented by zhao and cai 2020 who applied hm dt to deriving a common model for a group of reservoirs after that a classification tree model is trained to identify module application conditions based on the decoded historical module sequence from hm dt zhao and cai 2020 finally gdrom combines the identified operation modules and the module application conditions to simulate reservoir releases in this way gdrom enables the simulation of dynamic reservoir operations with acceptable accuracy as shown in the results and model transparency due to its tree based nature input data for hm dt are the same as those used in zhao and cai 2020 i e historical inflow storage and release for training and validation while for release prediction using a trained model only inflow and initial storage are required inputs input data for the classification tree model to decide module application conditions add palmer drought severity index pdsi for drought conditions and day of the year doy for seasonality besides the hm dt inputs compared to many existing data driven models that require meteorological information reservoir operational constraints downstream river stage and water delivery data yang et al 2016 zhang et al 2019 yang et al 2019 the data required for gdroms is not heavy which will enable easy adoption of the models 2 1 extraction of representative operation modules in the first step the hm dt model developed by zhao and cai 2020 is used to derive representative operation modules from historical records hm dt assumes that the operation of a reservoir can be characterized as a limited number of operation modules with each consisting of a set of operation rules and the transitions from one module to another follow a markov process the extracted operation modules are in the form of decision trees taking inflow and initial storage as primary inputs to predict daily release decisions note that storage will still be a source variable which is determined internally details of the hm dt model can be found in the original paper zhao and cai 2020 in the model training phase for the gdrom 80 of the operation data is used for model training and the remaining 20 of the data is held out for the final testing however the training data is further split into training and validation sets following the same 80 20 principle thus the final train validation test ratio becomes 64 16 20 this follows a procedure to train validate a complex ml based model hastie et al 2009 for gdrom the hm dt model that derives the representative modules is based on two important hyperparameters the number of hidden states k and the minimum decrease in impurity for the decision tree to stop growth during training itsmin which is a parameter that is used to control the overfitting of a decision tree by avoiding node splits with the minimal increase in predictive accuracy in the training stage 30 different combinations of the two hyperparameters are designed each of which results in one set of representative operation modules regarding the model performance a larger k and a smaller itsmin will always yield the better performance zhao and cai 2020 however there can be an overfitting issue which is similar to the case of a polynomial regression with a large number of items to resolve this problem the 30 sets of representative operation modules are tested on the validation data and the one with the best performance nse pbias is chosen for final testing stage in this study the nash sutcliffe efficiency coefficient nse is chosen to evaluate the simulation performance of release for each reservoir which allows comparison across reservoirs the formula of nse is as follows 1 n s e 1 i n r s i m i r o b s i 2 i n r o b s i r o b s i 2 where r sim i and r obs i are the simulated and observed release of a reservoir at time step i respectively and n is the total number of time steps the closer the value of nse to 1 the better the prediction performance of the model negative nse means unacceptable performance for a given reservoir the selected hm dt model that passes the validation and testing generates a small number of modules and the application sequence of the modules during the historical period each derived module is characterized by application frequency the decoded hidden state sequence during the historical period i e the operation module application sequence can be obtained from the hm dt model based on observed operation records zhao and cai 2020 with the operation module application sequence we can compute the application frequency for each of the derived modules during the training periods which is computed as 2 f r e q u e n c y o f d a y s t h a t a m o d u l e i s a p p l i e d t o t a l o f d a y s d u r i n g t h e t r a i n i n g p e r i o d 2 2 determination of application conditions for representative modules to use the representative modules for reservoir operation simulation the hydroclimatic conditions for each of the modules need to be explicitly specified a tree based classification approach is used to achieve this using the classification and regression tree cart algorithm implemented in the scikit learn library pedregosa et al 2011 as a type of decision tree algorithms cart was firstly introduced by breiman et al 1984 and since then it has been widely used in data mining because of its simplicity and intelligibility e g prasad et al 2006 bessler et al 2003 kumar et al 2013 this study uses the classification tree to map the input variables i e hydroclimatic conditions to the output classes i e operation modules the core mechanism of the classification tree algorithm is the recursive partitioning process which starts with the entire input variable space i e root node and uses a binary tree to recursively split the node into more homogeneous child nodes until each node has all the same class or the improvement of deeper splitting is less than the preset threshold chipman et al 1998 several metrics can be used to measure the best split for each partition such as the gini index measuring node impurity and the entropy based index the gini index takes less computational time than the entropy based index while both achieve equivalent performance thus the gini index is broadly adopted by cart algorithms in particular the gini index has been used in the previous data driven reservoir simulation models via dt approaches e g wei 2012 yang et al 2016 in this study the gini index is employed and can be formulated in eq 3 where i 1 2 c is the index of the class pi is the conditional probability of class i in the given branch 3 g i n i 1 i 1 c p i 2 inflow and storage that are included in hm dt are chosen as inputs to cart previous studies show that the backward or forward information of storage and inflow i e storage and inflow in the past and future time periods with a certain length influence the release decision in the current time period hejazi et al 2008 for this study we designed multiple input combinations including storage and inflow in backward and or forward periods and tested those with a number of reservoirs the results showed that overall the backward or forward information does not yield a big difference in the release simulation performance by the gdrom actually the simulation accuracy decreases due to the rising variance of inputs with many reservoirs therefore only the current inflow and storage information is selected as model input additionally zhao and cai 2020 demonstrated that the wet dry conditions could call for particular reservoir operation modules that reflect the real world emergent reservoir operation plan for floods or droughts furthermore the seasonality of historical operation was also observed by zhao and cai 2020 to account for these conditions we include pdsi and doy as input variables and the sensitivity analysis of these two variables is provided in the supplementary material d admittedly other potential variables may influence reservoir operations while not considered in this study such as snow depth in the upstream areas of a reservoir and water demand part of the reason is that the importance of those variables is less than that of current input variables which may not bring significant performance improvement and thus not included to reduce model complexity in addition the difficulty in collecting data of those variables may limit the general applicability of gdrom in summary the input variables of the module classification model are inflow storage pdsi and doy for each reservoir the operation modules derived by the hm dt model are numbered from 0 to k 1 referred to as module id moreover the module id is the target variable i e the output of the module classification model the module id sequence decoded by hm dt for the training dataset will be used to train the classification tree to ensure the best performance we implemented the 5 fold cross validation technique in the training process to determine the hyper parameters 2 3 procedures to run a gdrom the gdrom for a particular reservoir comprises a set of operation modules derived from hm dt and an associated module classification model for the application conditions of each module derived from the cart thus running a gdrom is to run cart with pre derived modules from hm dt the gdrom determines daily release in three steps first the module id for a day is determined by the classification model based on inflow storage pdsi and doy second the selected module with an identification number id is invoked to determine the release following which the storage at the end of this day i e the beginning storage for the next day is computed based on water balance third the storage capacity constraints are examined to check if the computed reservoir storage lies between the minimum and maximum storage smin smax if a storage capacity constraint is violated with the predicted release the release decision and the computed storage will be adjusted based on water balance since the measured storage is not available for prediction the computed storage will be used as model inputs to a gdrom that is given the initial storage of the reservoir the storage at the end of a time period is obtained according to the water balance relationship embedded in the gdrom the estimated storage at the end of period t is used as an input to the gdrom at period t 1 see fig a1 in the supplementary material a it should be mentioned that when only one representative operation module k 1 is derived by the hm dt model for a reservoir a single dt model can predict the release with acceptable accuracy and thus the module classification model is not required nash sutcliffe model efficiency nse and percent bias pbias are chosen as statistical metrics to evaluate the model performance wu et al 2020 moriasi et al 2007 the formula for calculating nse is provided in eq 1 and the formula for pbias is 4 p b i a s i n r o b s i r s i m i i n r o b s i 100 where r sim i and r obs i are the simulated and observed release of a reservoir in time step i respectively and n is the total number of days of the observed records 3 data and data processing 3 1 basic data for the selected reservoirs we collect historical operation records of reservoirs in the conus including daily ending storage and release decisions from several public data sets managed by usbr 2021a b c usace 2021 and california data exchange center 2021 additionally we obtain some data from resopsus a recently published us historical reservoir operations dataset staeyert et al 2022 using these data sources we test the gdrom with 467 reservoirs following that we select 15 reservoirs for detailed analysis from different water regions in the conus with different operation purposes different sizes and sufficiently long data records 15 years fig 2 shows the location of the selected reservoirs and table 1 displays the attributes of the selected reservoirs in addition the pdsi series at the locations of these reservoirs are retrieved from noaa 2021 3 2 data preprocessing the quality of data is crucial to data driven studies and data preprocessing is usually needed for machine learning models to produce reliable results zhang et al 2003 crone et al 2006 general data preprocessing methods include data cleaning e g treating missing values and noises data editing e g checking outliers and validity data reduction e g dimensionality reduction feature selection and data transformation e g encoding categorical data feature scaling garcía et al 2015 data preprocessing often requires knowledge based approaches to understand and identify some issues related to research questions felix and lee 2019 for reservoir operation studies the water balance relationship must be satisfied i e 5 s t 1 s t n e t i t r t 6 n e t i t i t p t e p t o g t o l t where s i r p ep og and ol represent storage inflow release precipitation surface evaporation other water gains and other water losses respectively for real world reservoir operations it is difficult to measure the actual inflow to a reservoir because of seepage loss and recharge and discharge between a reservoir and the surrounding aquifer instead of the observed inflow the computed net inflow net it based on water balance is often used for example usbr provides the computed inflow time series based on storage release and evaporation of reservoirs usbr 2021a in this study it is assumed that the possible error involved in the release and storage data obtained from usbr or usace is ignorable and thus the net inflow is calculated by eq 6 the computed net inflows are used to replace the measured inflow and for simplicity they are referred to as inflows in the rest of this paper note that the storage data retrieved from usbr and usace at storages at the end of day we thus convert them into the initial storages for next time period by shifting the storage time series by one time step i e one day in this way we obtain the initial storages which are involved in the release decision making in each time period raman and chandramouli 1996 yang et al 2016 it is also essential to ensure that the modeled reservoir storage lies between the minimum storage e g dead storage and the maximum storage e g the capacity observed in the real world these storage bounds are extracted from the historical reservoir operation records which are used in the model to check and correct the outliers of the simulated storage further the input variables including inflow storage and release are normalized by the maximum historical storage of the corresponding reservoir which makes it easier to compare the identified operation modules and the simulation performance between different reservoirs zhao and cai 2020 in addition since the hidden markov model requires continuity of the data sequences the historical operation records are divided into continuous segments if missing data points exist moreover continuous records whose lengths are shorter than 100 days are discarded because the inherent dependencies cannot be sufficiently represented by those short records as zhao and cai 2020 elaborated the processed records are treated as independent samples for training the hm dt model and the classification model 4 results the gdrom model is applied to each of the selected reservoirs the results include some typical types of operation modules derived from hm dt the operation conditions for a particular module derived from cart the combination of both stated above to form a gdrom and release simulation and accuracy assessment for each of the selected reservoirs 4 1 representative operation modules the two hyper parameters of the hm dt model i e the number of hidden states k i e the minimum number of modules that reaches a high and stable nse value and the minimum decrease in impurity in the decision tree itsmin are tested and initially determined with the validation data based on the hm dt model performance evaluated by nse as a demonstration example the model prediction accuracy with the american falls reservoir is plotted in fig 3 a under three levels of itsmin the nse values rise rapidly with k at first but the increase diminishes when k becomes large the impact of itsmin is significant when k is small a similar pattern is observed for most of the selected reservoirs in this study however for surry mountain lake and wilson lake the nse values do not change significantly with k e g surry mountain lake fig 3b indicating that one operation module can describe the major operation rules for these two reservoirs the values of k and itsmin are determined during the hm dt validation step for each study reservoir these values might need some refinement for running a gdrom this is because the actual performance of the gdrom is also impacted by the application conditions of modules determined by the cart in addition to the accuracy of the modules derived from the hm dt the final values of k and itsmin are listed in table 2 showing that 1 to 5 representative modules can describe the various operation rules for these reservoirs with sufficiently high nse the derived operation modules m classification types t and application frequencies of the modules eq 2 are listed in table 2 although different representative operation modules are derived for different reservoirs these modules in the form of decision trees share similar structures five typical types of the operation modules are discussed as below type 1 operation modules for low flow periods reservoirs usually maintain a small release during low flow periods for storage filling while satisfying essential water supply or environmental flow requirements type 1 t1 modules fit within this operation condition under most t1 modules the release is constant regardless of inflow and storage and the release is smaller than the average inflow leading to storage filling among the selected reservoirs those with a primary purpose of irrigation echo reservoir american falls reservoir adopt t1 modules during the non irrigation season however operations under t1 modules do not necessarily build up storage depending on the purpose s for particular reservoirs for example the aquilla lake with flooding control as the primary operating purpose and water supply as the secondary adopts two t1 modules with constant releases for different water supply requirements during non flooding periods it turns out that the storage decreases when t1 modules are applied while the conservation pool will be filled with the high inflows during flooding periods under m2 t2 in addition not all t1 modules adopt a constant release for example with m3 t1 the pathfinder reservoir releases vary with inflows ending with storage filling during low flow periods type 2 operation modules for high flow periods for many of the fifteen reservoirs there exists a separate module that is applied to high flow periods for flooding control or high demand water supply under which the releases are the highest among the operation modules these modules are classified as type 2 t2 under which the release decisions are jointly controlled by inflow and storage with multilayer hierarchical tree structures see details in supplementary material b and the average releases are higher than the average inflows ending with decreased storage in particular t2 modules are applied during the irrigation season during which releases are high e g echo reservoir american falls reservoir type 3 operation modules with inflow as dominant control type 3 t3 modules are applied for inflow dominated release decisions by which the inflow and release have a nearly linear relationship for example only one representative module t3 is derived for the wilson lake fig 4 this reservoir is operated mainly for hydropower generation with a small s in ratio 0 033 due to the limited regulation capacity the releases were almost identical to inflows for most of the time type 4 operation modules with a constant release besides t1 modules under which the release is usually constant for low flow periods constant release modules type 4 t4 are also identified with large reservoirs especially when the actual operation schemes are not much affected by inflow and storage for example module 0 for the lake berryessa in california with a large capacity is characterized by a small constant release applied during the period of november to march for municipal water supply in the region where the reservoir locates due to the mediterranean climate major precipitation falls between december and march i e the high flow period when module 0 is applied since the constant release is lower than the average inflow during this period the storage is filled underlying module 0 type 5 transitional operations modules between t1 for low flow periods and t2 for high flow periods modules there are some transitional operation modules type 5 t5 for some reservoirs compared to t1 and t2 modules t5 modules have a medium level release and even monthly application frequency due to varying water demands fluctuating inflow conditions and different operation objectives the controlling variables and their relationships are diverse for different reservoirs under t5 modules the release decisions are controlled by a single variable inflow or storage e g under m4 of bighorn lake or jointly controlled by two variables inflow and storage with multilayer tree structures e g m2 of carlyle lake and m1 of echo reservoir as an example the relationship between inflow and release under each of the derived modules for echo reservoir is shown in fig 5 where three modules are derived m0 m1 and m2 belonging to t2 t5 and t1 respectively with the same inflow the releases are the highest under m0 overall the inflows are also the highest under m0 showing that this module is mainly applied during high flow periods i e m0 is a t2 module in contrast under m2 the releases are the smallest and maintain constant regardless of inflow levels which are usually low indicating that m2 belongs to t1 m1 is a typical t5 module with medium level releases where inflow and storage jointly determine the release as demonstrated with the if then rules fig 5 for all the selected reservoirs in this study the detailed operation modules in the form of decision trees are provided in supplementary material b 4 2 application conditions for representative modules the cart algorithm identifies the application conditions of the various operation modules including diverse operation objectives fluctuating inflows and different water regulation capacities under these conditions the relative importance of the input variables to the module classification models varies cart provides a measure of the importance as shown in fig 6 for the selected reservoirs in particular doy dominates the classification for american falls reservoir and lake berryessa while inflow becomes the critical input for carlyle lake and jordan lake this difference is due to complex factors including the reservoir storage capacity inflow water demand policies as well as operation purposes lake berryessa is mainly operated for irrigation and municipal water supply to solano county california these water demands vary by season and thus doy plays the major role in determining the module to satisfy different levels of demands while for aquilla lake with the primary purpose of flood control the conservation storage capacity only accounts for one third of the total capacity once the reservoir storage is above the top of the conservation pool a module for flooding control t2 module will be used consequently the storage dominates the module classification the module classification tree of the american falls reservoir is shown in fig 7 as a demonstration example the module classification trees for other selected reservoirs are provided in supplementary material c the module classification tree illustrates the application conditions for each of the derived modules with explicit if then rules for example the leftmost branch of the tree in fig 7 shows the following condition when doy 0 33 i e before may 1 of a year and storage 0 66 module 0 t1 release 380 cfs is applied to determine releases according to american falls resources management plan 1995 and olenichak 2020 if american falls reservoir is not completely filled before the beginning of the irrigation season april to october the reservoir has the priority to refill before may 1 with a required minimum release at 300 cfs that is to say when the storage is relatively low i e storage 0 66 before may 1 i e doy 0 33 american falls reservoir releases a constant and small amount of water i e using module 1 to facilitate the storage filling thus the derived representative modules and application conditions are consistent with the real world reservoir operation policies similar observations are found for carlyle lake the derived model for this reservoir shows that module 0 t2 plays a major role in high level release determination during the flood season under which storage and inflow jointly control release decisions while storage poses a larger impact the simplified primary application conditions for module 0 are inflow 0 001 doy 0 34 or 0 94 i e before may 4 or after december 9 of a year these conditions are consistent with the operation policies stated in the carlyle lake water 2007 which states that a larger flood control pool is needed between december 1 and may 1 and the release is highly correlated with elevation storage during the period 4 3 using gdroms for release prediction gdrom is designed to simulate reservoir release given inflow transformed into net inflow doy pdsi and the initial storage of the simulation period in which the storage in the following time steps is obtained through the water balance equation eq 5 with the simulated release gdroms are tested with 467 reservoirs in conus fig 8 presents the release simulation performance of these reservoirs during the testing periods measured by nse and pbias as can be seen the nses of release simulations are higher than 0 8 for 28 0 5 for 63 and 0 3 for 80 of the selected conus reservoirs while most pbiass are lower than 5 with a zero mean normal distribution such nse based performance is comparable to other ml studies on reservoir operation yang et al 2016 zhang et al 2019 yang et al 2021 among the selected 15 reservoirs the operations of wilson lake and surry mountain lake are controlled by inflow with the nearly linear relationship between inflow and release hence the derived operation module a dt model can predict release with very high nses 0 88 american falls reservoir and lake berryessa for which doy controls the module classification also show high nses 0 8 however for about 5 of the 467 reservoirs gdroms fail in estimating the release with very low nses nse 0 1 besides it is found that the simulated release of several reservoirs cannot capture the daily fluctuation despite a positive nse e g lake powell see supplementary material e the possible failure reasons for gdroms are explained in section 5 4 with dworshak reservoir and lake powell as examples additionally it is observed that for some reservoirs the error propagation of the simulated storage will not significantly affect the release prediction accuracy of a gdrom because with the simulated storage as an input the long term operation simulation via the gdrom may automatically adjust some bias due to the feedback mechanism of the storage release relationship that is to say if the simulated release is significantly larger than the observed at time t then the simulated storage at time t 1 may be smaller than the observed value because of water balance and capacity constraints following that with smaller simulated storage release decisions in the next time step will be adjusted to a smaller value which in turn controls the deviation of the release and storage simulation from the observation as a result the prediction is robust to demonstrate the use of gdrom for reservoir operation prediction within a certain time horizon e g month or year the pathfinder reservoir is chosen during the hydrological year 2016 a re analysis assuming perfect daily inflow forecast given inflow pdsi data for that year and the initial storage on october 1 2015 the nse of the predicted daily release over a year is 0 75 and the nse of the predicted storage is 0 90 fig 9 although the predicted releases in june july 2016 are lower than the actual values the annual release variation especially the high and low release period transition are predicted by the gdrom meanwhile the projected storage trajectory shows the same trend as the observation indicating that the gdrom can simulate water storage change reasonably the real world model application for prediction is challenged by inflow forecast uncertainty zhao et al 2020 even though operators often use a reservoir simulation model to project reservoir releases under different inflow conditions for example usbr makes three annual operation plans with the minimum most probable and maximum inflow forecast for reservoirs managed by the agency usbr 2021d 5 discussions 5 1 understanding real world reservoir operation patterns through gdrom the gdrom of a reservoir comprises the representative operation modules in the form of if then operation rules and the module classification tree representing application conditions hence the gdrom can be used to support real world reservoir operations using interpretable operation rules in particular the operation rule changes in response to varying operating conditions i e the transitions between different operation modules can inform the patterns of reservoir operation dynamics fig 10 shows the simulated module sequence of echo reservoir from 1990 to 2014 as an example with irrigation as the primary purpose it is found that for most years module 2 t1 is applied for storage filling during the low flow periods fig 11 a module 0 t2 is mainly applied for irrigation and flooding control during the high flow periods fig 11b module 1 t5 serves as a transition between module 0 t1 and module 2 t2 a cyclic annual operation pattern t1 t5 t2 t5 t1 is observed from fig 10 this pattern is also observed with the american falls reservoir another reservoir primarily operated for irrigation furthermore for most of the selected reservoirs it is observed that the operation patterns are influenced by wet and dry conditions characterized by pdsi when a drought event occurs the operation rules are adjusted to mitigate the drought impact hejazi and cai 2011 for example bighorn lake adopted different operation patterns in response to a severe drought event during 2001 to 2005 pdsi 2 fig 12 for the high flow periods module 0 was applied replacing module 1 commonly used for this reservoir for the low flow periods module 2 was adopted with a low constant release only for drought events specifically the module classification tree identifies the operation conditions for module 2 as net inflow 0 storage 0 66 and doy 0 33 day 120 or doy 0 77 day 281 these conditions indicate a drought event and the reservoir operators adopted a drought management plan for the operation during the drought event zhao and cai 2020 demonstrated that the hm dt model could capture long term reservoir operation rule changes by applying different modules in the same season of early and recent years e g moon lake in utah the underlying operation conditions that trigger operational changes such as changing climate water demand and or operation policies are treated as unknown hidden states in hm dt model thus the gdrom based on hm dt can simulate the release and storage changes due to climate variability and policy changes in the simulation of historical operations this is demonstrated by the gdrom simulation of the pathfinder reservoir operation fig 13 the pathfinder reservoir had fluctuating daily release during the low flow periods before 2001 while in later years the release in low flow periods remained a constant value the gdrom successfully catches this operational change by the transition from module 3 to module 0 for operations in low flow periods in this case the changing climate condition plays the major role in operation changes which is represented by pdsi in the gdrom when the gdrom is used for a prediction purpose any policy change should be given as an external input to the model and the model can be used to simulate the release response to the given policy change in addition gdrom which is a simulation model can be coupled with an optimization program to seek optimal policy changes the results of the gdroms for the selected 15 reservoirs also show reservoir operation patterns relevant to the role of reservoir operation purposes it is found that irrigation reservoirs usually have three or four modules common types t1 t2 t5 with a clear seasonal module transition e g echo reservoir american falls reservoir pathfinder reservoir for reservoirs mainly used for flood control and water supply the derived modules are either t1 for water supply in low flow periods or t2 for flood control during high flow periods e g aquilla lake jordan lake clinton lake when reservoirs are primarily used for flood control but also for hydropower generation t5 modules are frequently used to generate more electricity during transition periods between high and low flow seasons e g detroit lake 5 2 using gdroms for storage simulation gdroms conduct release prediction along with storage simulation for the selected 15 reservoirs the performance of the storage simulation during the testing periods measured by nse is shown in fig 14 a although an accurate multi year storage simulation is challenging due to storage error accumulation the simulation results are reasonable under gdroms with nse higher than 0 6 for 11 of the 15 reservoirs the reservoirs with low nses for storage prediction include dworshak reservoir wilson lake and bighorn lake the poor storage simulation for dworshak reservoirs is due to the error accumulation caused by poor release prediction for wilson lake the release simulation ends with nse 0 998 while the storage simulation ends with nse 0 07 this is because wilson lake is a relatively small reservoir with s in ratio 0 033 and the accumulation of release simulation error in a few days can have a large effect on the storage in addition the release has an approximately linear relationship with inflow as shown in fig 4 and thus the release simulation is not affected by the storage simulation similarly gdrom for bighorn lake yields acceptable release simulation but poor storage simulation fig 14b where the storage also plays a minor role in determining daily release despite of a larger relative storage capacity s in ratio 0 530 in general the storage simulation performance of gdroms is affected by release simulation accuracy relative storage capacity and the relevance of storage to daily release decision 5 3 comparison with other decision tree based models in this section we compare the prediction performance of gdrom to two popular dt based models cart used as a regression tree model and random forest to compare their prediction performance with gdrom note that cart is a part of gdrom and it is used as a classification model in this study to identify the module application conditions however numerous studies have used cart an early and classical dt based model as a regression model similar to the formulation of gdroms the same inputs inflow storage pdsi and doy and some external constraints to ensure water balance and storage bounds are used for regression trees and random forest the results show that these three models have similar performance in release prediction for most of the fifteen selected reservoirs the gdroms have slightly better performance for six reservoirs than random forest and regression trees fig 15 a among the selected reservoirs the release simulation accuracy is particularly low for lake powell pow and dworshak reservoir dwo under all three models and the details are explained in section 5 4 additionally other ml models used in reservoir operation such as ann svm and lstm e g lin et al 2006 aboutalebi et al 2015 zhang et al 2018 also demonstrated acceptable accuracy in release simulation although gdroms may not significantly improve prediction accuracy they show better interpretability due to the transparency of decision trees and the typical operation schemes from a small number of representative modules gdroms reveal the dynamic operation patterns in the transitions of these modules apart from the failure cases with lake powell and dworshak reservoir it is found that overall gdroms produce stable and better storage simulation performance than random forest and regression trees fig 15b especially for echo reservoir ech pathfinder reservoir pat and lake mcconaughy mcc gdroms perform much better than the other two models one of the reasons can be overfitting which is more likely to occur with regression trees and random forest overfitting causes some extreme deviations of release prediction and associated storage prediction with gdroms the two layer model structure i e choosing a module under particular conditions and predicting releases using the chosen module can provide some flexibility in prediction to mitigate the effect of overfitting specifically when the simulated release largely deviates from the observation at time t the computed storage based on water balance at time t 1 will also deviate from the observed value which first affects the module determination and then the release decision under the selected module at time t 1 due to the feedback mechanism of the release storage relationship gdroms with the two layer structure can adjust some bias period by period and reduce cumulative storage deviation 5 4 issues that affect gdrom performance as mentioned above gdroms perform well in release simulation for most reservoirs with diverse operation functions and different capacities but the performance is unacceptable for lake powell and dworshak reservoir the lake powell with the glen canyon dam is a multipurpose reservoir with the second largest storage capacity in the us the release decision making of lake powell is based on complex factors including water demand electricity demand environment protection and policies rather than simply using current inflow and storage levels usbr 2021e for example lake powell releases low and steady flow for the ecological flow requirements while it has much higher releases during high flow periods for sediment flushing usbr 2021f 2021g in addition with an installed capacity of 1320 mv lake powell is also operated to regulate electric peak load usbr 2021e which leads to the fluctuation of daily releases similarly the daily releases fluctuate largely during the high flow periods with the dworshak reservoir the high daily variability during high flow periods and the demand driven operation policy with these reservoirs are not represented by the input variables of current gdroms consequently the derived operation modules and application conditions deviate from real world operations and the prediction accuracy of gdroms is low similarly the poor performance of random forest and regression trees for these two reservoirs is also due to the inadequate information of current model inputs to make gdroms applicable to those reservoirs with complex operations it is suggested to consider new input variables or constraints on the various factors such as water demand environmental flow constraints inflow prediction etc nevertheless the current gdrom is applicable to most of the reservoirs since the operation of only very few reservoirs is dominated by variables other than inflow and storage another limitation of gdrom is that only the fixed storage bounds extracted from the historical operation records are considered in the real world operations however the flood control pool and conservation pool usually vary with seasons indicating that the upper bound of storage is not fixed throughout the year besides storage limits there can be maximum release constraints for downstream flood mitigation considering that the reservoir specific varying flood and conservation pools are highly complicated to collect and organize the gdrom does not involve varying storage limits or other engineering constraints admittedly the simulated release and storage by gdrom may sometimes violate the usace flood control requirements without adding these constraints but the overall simulation performance remains reasonable as these constraints are embedded in observations if a user applies gdrom for one single reservoir it is recommended to add specific constraints for performance improvement 6 conclusions this study couples the hidden markov decision tree hm dt model developed by zhao and cai 2020 with a classification tree algorithm and build a generic data driven reservoir operation model gdrom the gdrom for a particular reservoir combines a small set of representative operation modules derived by the hm dt model and application conditions of the modules extracted from cart model compared with many existing data driven models gdrom is generic in terms of 1 common uncumbersome inputs i e inflow storage pdsi doy 2 consistent model structure i e a small number of representative operation modules and their application conditions 3 acceptable performance with any reservoirs of various operation functions capacities or locations the gdrom is developed for 467 reservoirs with diverse operation purposes in different regions of the contiguous united states conus and the testing procedure shows comparable accuracy in release simulation to other ml models detailed analysis is conducted for 15 selected reservoirs the results show that 1 to 5 operation modules can represent the operation rules for each of the reservoirs the gdroms achieve equivalent accuracy to the random forest in release simulation tests and for 13 of the 15 reservoirs nse 0 3 which verifies the applicability of the gdroms to reservoirs with various operation purposes locations and capacities in particular the models achieve better accuracy in storage predictions for most of the 15 reservoirs than random forest and regression trees overall the gdroms show multiple advantages including easily satisfied data requirements transparent model structure and improved storage simulation performance compared to existing data driven models especially existing models usually derive static operation rules while gdrom can simulate the dynamic operation patterns through choosing an appropriate module in response to specific operation conditions with acceptable prediction accuracy the gdrom can be applied to simulating and predicting daily reservoir releases and storages and help make reservoir operation plans for a certain time horizon e g season or year furthermore the gdrom can be used to explore reservoir operation understanding and improvement the transparent tree based structure i e if then rules of the gdrom representing reservoir operation modules and application conditions will help understand operation rules and operation patterns additionally as a standalone reservoir simulation model with light computing requirement the gdrom can serve as a reservoir component in watershed hydrological simulation models zhao and cai 2020 wu et al 2020 however the proposed gdrom method is subject to some limitations not all the derived operation modules can be interpreted using realistic reservoir operation rules this is because under some modules there can be multiple release decisions that are applicable to different conditions which are probably caused by numerical randomness of the hidden states besides when the daily releases of reservoirs largely fluctuate and the fluctuation cannot be simply explained by current inflow and storage the gdrom fails in predicting the operationsof those reservoirs future studies can explore the performance improvement of such reservoirs e g lake powell dworshak reservoir by adding new input variables such as inflow forecast in next couple of days for reservoirs mainly used for flooding control hejazi and cai 2011 zhao et al 2019 nevertheless the proposed gdrom has acceptable performance for most of the testing reservoirs located in different regions in the u s implying that it can be applied to many other reservoirs in the u s and likely in other countries where sufficient data for gdrom training and validation are available credit authorship contribution statement yanan chen conceptualization methodology software formal analysis writing original draft donghui li conceptualization methodology software formal analysis writing review editing qiankun zhao conceptualization methodology writing review editing ximing cai conceptualization supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the first author yanan chen is supported by the scholarship from china scholarship council no 201906060183 the authors would like to express their thanks to all reviewers and editors for their helpful comments and suggestions supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2022 104274 appendix supplementary materials image application 1 
107,solute transport through radial advection dispersion is a common phenomenon in many applications such as aquifer decontamination heat exchange for geothermal exploration and tracer testing numerous analytical solutions to the problem of tracer testing in a radially divergent flow field are available for fitting breakthrough curves however all of these analytical solutions assume non uniform flow velocity based on thiem s solution which varies only spatially not temporally although an injection well with a constant injection rate in a tracer test causes both spatial and temporal variability of the radial flow field previous analytical studies have employed a steady state groundwater flow solution i e thiem s solution to derive analytical solutions for breakthrough curves or spatial concentration distribution curves to the best of our knowledge no analytical solution to the radial advection dispersion equation under spatially and temporally variable flow conditions driven by injection at a constant rate is currently available here we propose a novel semi analytical solution for describing solute transport in spatially and temporally variable flow induced by an injection well with a constant injection rate we find that above certain threshold values of dimensionless parameters related to aquifer flow properties solute transport parameters and the injection rate the differences between previous analytical strategies our proposed semi analytical solution are negligible these threshold values tend to increase more sharply with an instantaneous injection source than a continuous injection source in other words it is more difficult for an instantaneous injection source to reach the condition where the difference between our approach and previous ones is negligible than for a continuous injection source type our findings clarify when existing analytical solutions can be reasonably used for parameter estimation through fitting of the breakthrough curve to field data and when the proposed semi analytical solution is a better alternative keywords divergent radial flow new semi analytical solution tracer test transient flow data availability i have shared the link to my data code at the attach file step nomenclature b aquifer thickness l c concentration m l 3 d dispersion coefficient l2 t 1 d dimensionless dispersion coefficient en transformed head associated with the n th eigenvalue h hydraulic head l h transformed hydraulic head h h 0 j 0 bessel function of the first kind with order zero j 1 bessel function of the first kind with order one l domain length of interest l m instantaneously injected mass m m injected mass flux m t 1 mf truncation number of series in the inversion transform of head mt truncation number of series in the inversion transform of concentration nn norm associated with n th eigenvalue q injection rate l3 t 1 r radial distance from the well l r retardation factor dimensionless s storativity dimensionless t time t t transmissivity l2 t 1 tn transformed concentration associated with n th eigenvalue v pore velocity l t 1 v dimensionless pore velocity greek letters α l longitudinal dispersivity l α l transport dimensionless parameter α l l β flow dimensionless parameter tπθb sq δ r dirac delta function l 1 θ porosity dimensionless λ n n th eigenvalue μ n n th zero value of bessel function of the first kind with zero order j 0 φ n n th eigenfunction of the transport equation ψn n th eigenfunction of the flow equation subscripts 0 initial boundary condition d dimensionless 1 introduction inaccurate prediction of solute transport can lead to unreliable risk analysis or inefficient design of groundwater remediation programs as well as inaccurate estimation of physical transport parameters in tracer tests analysis of solute transport in groundwater often occurs in situations involving convergent or divergent plane radial dispersion especially when tracer testing is performed in a radial flow field associated with a well numerous analytical solutions to the problem of tracer dispersion in radially convergent or divergent flow are available becker and charbeneau 2000 ogata 1958 lau et al 1959 hoopes and harleman 1967 tang and babu 1979 moench and ogata 1981 valocchi 1986 hsieh 1986 huang and goltz 2006 chen 1985 1986 1987 tang and peaceman 1987 chen and woodside 1988 novakowski 1992 moench 1989 1995 zlotnik and logan 1996 chen et al 1996 2002 2003a 2003b 2007 2012b lai et al 2016 wang and crampon 1995 wang and zhan 2013 wang et al 2020 welty and gelhar 1994 all of these solutions consider solute transport in a non uniform flow field with radial flow where the flow velocity is inversely proportional to the radial distance from the well based on the thiem equation thiem 1906 however the flow velocity obtained from the thiem equation varies only spatially not temporally at steady state despite strong field evidence that transient flow is ubiquitous previous analytical studies have assumed steady state groundwater flow dejam et al 2014 in convergent or divergent tracer tests prior to the introduction of a tracer into an injection well a well located in the aquifer is generally pumped or injected until it can be safely assumed that a steady horizontal radially convergent or divergent flow field is established however it is very difficult to determine whether a steady state has been reached under field conditions hours to days are often needed to reach steady state depending on aquifer characteristics and pumping or injection rates to reduce the waiting time prior to injection of the tracer from an injection well in the field a quasi steady state condition obtained after an insufficient amount of time is commonly used as the steady state condition such an incautious steady state flow assumption invariably leads to errors in the breakthrough curves obtained from the tracer test and these errors may be small or large therefore an analytical solution that considers transient flow effects is essential to accurately determine solute transport parameters in analyses of breakthrough curves from tracer tests regardless of flow conditions to the best of our knowledge no analytical solution to the radial advection dispersion equation in transient flow is currently available although a few analytical solutions have been reported for evaluation of solute transport in transient flow carlier 2008 chen et al 2012a these previous analytical solutions assume piecewise steady state flow for each pumping rate and thus the transitional period between two pumping rates is neglected therefore under the assumption of piecewise steady state flow these solutions can be used to analytically evaluate solute transport in a radial flow field with a multistep injection flow rate and arbitrary input concentration history however the assumption of piecewise steady state flow may not reflect or correctly approximate true transient flow state the application of analytical solutions is not limited to estimation of transport parameters in the tracer tests discussed above but can extend to verification or benchmarking of numerical codes today many sophisticated numerical algorithms such as the eulerian lagrangian localized adjoint method ellam the mixed hybrid finite element method the lagrangian eulerian decoupling method with an adaptive zooming and peak valley capturing scheme lezoompc and the discontinuous galerkin dg method appear to overcome the inherent numerical errors associated with spurious oscillation numerical dispersion grid orientation phase error peak clipping and valley elevation in particular numerical errors tend to occur in highly heterogeneous media and under strongly transient situations however very few analytical solutions are available to verify numerical results in these complex situations tabrizinejadas et al 2020 thus the proposed semi analytical solution describing solute transport in spatially and temporally variable radial flows will be useful for numerical code verification and benchmarking as well as estimation of transport parameters here we propose a new mathematical solution for solute transport in spatially and temporally variable radial flow induced by an injection well with a constant injection rate as shown in fig 1 although an injection well with a constant injection rate in tracer testing causes both spatial and temporal variability of the radial flow field previous analytical solutions employ only the steady state groundwater flow solution i e thiem s solution for derivation of the analytical solutions for breakthrough curves or spatial concentration distribution curves in contrast we adopt a newly derived analytical solution describing both spatial and temporal radial flow variability induced by an injection well with a constant injection rate the semi analytical solution proposed here better explains the effect of transient features of radial flow induced by an injection well with a constant flow rate on the concentration distribution or breakthrough curve than previous solutions which cannot account for transient features of radial flow this paper consists of five steps first the spatially and temporally variable flow induced by an injection well with a constant injection rate is solved using partial differential equations combining darcy s law with the conservation of mass in a radial coordinate system the partial differential equation describes the one dimensional radial flow of groundwater that is both spatially and temporally variable from an injection well with a constant injection rate here an analytical solution to the transient groundwater flow equation was derived through expansion of the generalized fourier series using the eigenfunction from a homogeneous helmholtz equation and assuming orthogonality of the eigenfunctions second the flow velocity is directly derived through application of darcy s law from the analytical solution of groundwater head described above third to solve the problem of solute transport in divergent radial flow in a transient state driven by a constant injection rate the derived analytical solution for flow velocity is directly substituted into the radially divergent advection dispersion equation our proposed solution is obtained using the generalized integral transform technique gitt from the radially divergent advection dispersion equation under unsteady divergent radial flow driven by a constant injection rate here two source types are considered namely continuous and instantaneous injection sources fourth our method is verified against previous analytical solutions including those of chen 1987 chen et al 2007 theis theis 1935 and thiem thiem 1906 as well as the numerical solution obtained from the two dimensional subsurface flow fate and transport of microbes and chemicals model 2dfatmic which is commercially available yeh and cheng 1997 finally we investigate the effects of flow parameters and solute transport parameters on the spatial concentration distribution and breakthrough curves for both continuous and instantaneous injection sources moreover through comparisons of our method to previous ones we identify the conditions of β dimensionless flow parameter and α l dimensionless transport parameter under which it may be reasonable to use existing analytical solutions such as those of chen 1987 and chen et al 2007 which are based on the thiem equation as fitting curves for parameter estimation despite unsteady flow as the breakthrough curve of the existing analytical solution and that of the proposed semi analytical solution are nearly identical 2 mathematical formulation 2 1 analytical solution for groundwater flow under transient flow conditions for calculating transient axisymmetric groundwater flow from an injection well in a homogeneous and isotropic confined aquifer system the following governing equation can be expressed in polar coordinate form chan et al 1976 yeh and chang 2006 samani and sedghi 2015 sedghi and zhan 2018 1 t 2 h r 2 1 r h r s h t δ r q 2 π r where s is storativity t is transmissivity h is hydraulic head t is time r is the radial distance from the injection well q is the injection rate and δ is the dirac delta function notably the well can be expressed as a boundary condition hantush and jacob 1955 neuman and witherspoon 1969 neuman 1972 malama et al 2007 loáiciga 2010 perina 2010 mishra et al 2012 sedghi and samani 2015 feng and zhan 2016 wen et al 2017 but is also represented by the properties of the dirac δ function without introduction of a boundary condition chan et al 1976 zlotnik and zhan 2005 yeh and chang 2006 samani and sedghi 2015 sedghi and zhan 2018 here the boundary condition is mass balance based on darcy s law at the interface between a well of infinitesimal radius and an aquifer loáiciga 2010 perina 2010 in mathematics an infinitesimal or infinitesimal number is a quantity that is closer to zero than any standard real number but that is not zero https en wikipedia org wiki infinitesimal chan et al 1976 demonstrated that eq 1 is mathematically equivalent to the boundary condition therefore eq 1 can be used to determine the head at any point around the well except at the well itself r 0 use of the dirac δ function allows the injection well to be included in the governing equation without explicitly introducing a boundary condition the initial and boundary conditions are 2a h r 0 h 0 0 r l 2b h l t h 0 t 0 where l is the domain length of interest and h 0 is the initial and boundary heads a limitation of this study is the assumption that the injection rate is constant thus this solution does not account for temporally variability of the injection rate moreover the injection well is assumed to fully penetrate a horizontal homogeneous and isotropic confined aquifer of constant thickness by introducing the new variable h h h 0 eqs 1 and 2 can be rewritten as eqs 3 and 4 respectively 3 t 2 h r 2 1 r h r s h t δ r q 2 π r 4a h r 0 0 0 r l 4b h l t 0 t 0 by defining the following dimensionless quantities 5 r d r l t d t t a t a π θ b l 2 q h d h b β t s 1 l 2 t a t s π θ b q where b is aquifer thickness and θ is a porosity eqs 3 and 4a 4b can be rewritten as follows 6 h d t d β 2 h d r d 2 1 r d h d r d δ r d 1 2 r d θ s 7 h d r d 0 0 0 r d 1 8 h d 1 t d 0 t d 0 solution of eq 6 with the boundary condition 8 and initial condition 7 requires expansion of the eigenfunction from a homogenous helmholtz equation in a generalized fourier series hayek 2001 details of the derivation are presented in appendix a finally using eqs 5 and a3 together with h h h 0 eq a9 in appendix a can be rewritten as 9 h r t q π t n 1 m f 1 j 1 2 μ n 1 μ n 2 j 0 μ n l r 1 exp t s 1 l 2 μ n 2 t h 0 eq 9 is an alternative semi analytical solution to the theis solution the derived solution is expressed as a spatially and temporally separable form and is better suited for gitt than the theis solution in terms of mathematical manipulation 2 2 semi analytical solution for solute transport under transient flow conditions the advection dispersion equation in cylindrical coordinates which describes the transport of a solute in a transient radially divergent flow field can be written as haddad et al 2015 10 θ r c t 1 r r r θ d r t c r r θ v r t c δ r m 2 π r b where c is concentration r is the retardation factor v is pore velocity d is the dispersion coefficient and m is the injected mass flux m q c 0 for continuous injection and m m δ t for slug injection c 0 is the injected concentration and m is the instantaneously injected mass a limitation of this study is that it does not account for skin effects around the well or the effects of mixing within the injection well in eq 10 molecular diffusion is assumed to be negligible relative to mechanical dispersion and the dispersion coefficient is assumed to be linearly dependent on the pore velocity 11 d r t α l v r t where α l is the longitudinal dispersivity initial and boundary conditions are expressed as 12a c r 0 0 0 r l 12b c l t 0 t 0 it is assumed that the initial concentration across the aquifer is zero and that the boundary is sufficiently distant for solute not to reach it the analytical solution used for hydraulic head presented in eq 9 and described in section 2 1 is an analytical alternative to the theis solution the main difference between the two is that eq 9 is a spatially and temporally separable form while theis solution is not the separable form of the analytical solution is used rather than theis solution because it is better suited to mathematical manipulation for gitt which is employed in this study to solve the solute transport equation here v r t with separable time and space are obtained from the head distributions calculated from eq 9 using darcy s law as follows 13a v r t v 0 k 1 m f j 1 μ k l r 1 j 1 2 μ k 1 μ k 1 exp t s μ k 2 l 2 t where 13b v 0 q π θ b l furthermore using eqs 11 and 13a d r t can be obtained as follows 14 d r t α l v 0 k 1 m f j 1 μ k l r 1 j 1 2 μ k 1 μ k 1 exp t s μ k 2 l 2 t by defining the dimensionless quantities α l α l l and c d c c i where ci c 0 under continuous injection conditions and c i m π θ b l 2 under instantaneous injection conditions and then substituting eqs 13a and 14 into eq 10 eq 10 can be rewritten as eq 15 15a c d t d 1 r d r d r d d r d t d c d r d r d v r d t d c d q d where 15b v r d t d 1 r k 1 m f j 1 μ k r d 1 j 1 2 μ k μ k 1 exp β μ k 2 t d 15c d r d t d α l r k 1 m f j 1 μ k r d 1 j 1 2 μ k μ k 1 exp β μ k 2 t d here q d 1 2 r r d δ r d is used for continuous injection and q d 1 2 r r d δ r d δ t d for instantaneous injection furthermore the initial and boundary conditions of eqs 12a 12b can be rewritten as follows using dimensionless quantities 16a c d r d 0 0 0 r d 1 16b c d 1 t d 0 t d 0 to solve eq 15a with the boundary condition of eq 16b and initial condition of eq 16a gitt is employed gitt establishes a pair of transforms such as an integral and an inversion transform almeida and cotta 1995 cotta 1993 liu et al 1998 2000 suk 2013 2016 2017 in gitt the following auxiliary equation is employed for construction of the pair of transforms 17 d 2 φ r d d r d 2 1 r d d φ r d d r d λ 2 φ r d 0 with the following boundary condition 18 φ 1 0 where λ and φ are the eigenvalue and corresponding eigenfunction respectively the auxiliary equation eq 17 with the boundary condition of eq 18 has the following eigenvalue λ eigenfunction φ and norm n 19 λ n μ n φ n r d j 0 μ n r d n n 1 2 j 1 2 μ n the forward transform and corresponding inverse transform can now be constructed using the eigenfunctions t n t d 1 n n 0 1 r d φ n r d c d r d t d d r d 1 n n 0 1 r d j 0 μ n r d c d r d t d d r d 20a n 1 2 20b c d r d t d n 1 φ n r d t n t d n 1 j 0 μ n r d t n t d n 1 m t j 0 μ n r d t n t d where tn is the transformed concentration associated with the n th eigenvalue and mt is set to a sufficiently large value to achieve the desired level of accuracy in the concentration distribution the detailed procedure used for obtaining t td in gitt is provided in appendix b once the set of coupled first order differential equations for t td is solved the inverse formula of gitt expressed in eq 20b can be calculated to obtain cd rd td 21a c d r d t d n 1 m t j 0 μ n r d t n t d finally using cd c ci concentration c can be obtained as 21b c r t c i n 1 m t j 0 μ n l r t n q π θ b l 2 t 3 verification to solve the radial advection dispersion equation for solute transport under divergent radial flow in a transient state transient axisymmetric groundwater flow from an injection well in a homogeneous and isotropic confined aquifer system is first solved to obtain an analytical solution for eq 9 as defined in section 2 1 then using the analytical solution obtained for flow the advection dispersion equation in cylindrical coordinates describing the transport of solute in a transient radially divergent flow field with instantaneous or continuous tracer input is readily solved to obtain semi analytical solution for eq 21b accordingly to validate the new semi analytical solution the analytical solution for flow should be verified first then the semi analytical solution for solute transport can be verified in this section two verification tests were performed first the derived analytical solutions for flow were compared to theis and thiem s solutions for verification as described in section 3 1 second the new semi analytical solutions for solute transport were compared to numerical solutions obtained using 2dfatmic as no analytical solutions for solute transport under transient divergent radial flow were available 3 1 comparison of the proposed analytical solution of flow with the theis solution to verify the proposed analytical solution of eq 9 defined in section 2 1 we assume values in an isotropic homogeneous confined aquifer of transmissivity t 0 01 m 2 day aquifer thickness b 10 m and injection rate q 1 m 3 day storativity values of 0 000002 0 0002 0 002 0 004 0 02 0 04 and 0 2 are assumed to illustrate various transient flow regimes the simulation domain was 30 m analytical results for hydraulic head obtained using the proposed analytical eq 9 are compared to the theis solution at a simulation time of 0 0628 days and thiem s steady state solution as shown in fig 2 the two align well in particular as storativity decreases the hydraulic head distribution approaches that of the steady state thiem solution 3 2 comparison of the proposed semi analytical solution for solute transport with numerical solutions to verify the proposed semi analytical solution against numerical solutions 2dfatmic was used to simulate two dimensional 2d flow and transport in a transient state a verification example was designed to describe solute transport in a radially divergent flow field with transient axisymmetric groundwater flow from an injection well in a homogeneous and isotropic confined aquifer system under conditions of both instantaneous and continuous tracer input at the injection well input parameters for the verification example are listed in table 1 for numerical simulation in 2dfatmic the input parameters for flow and transport as well as spatial and temporal discretization well information and initial and boundary conditions are shown in fig s1 and table s1 in the supplementary material as shown in fig 3 a analytical solutions for hydraulic head obtained using eq 9 aligned well with the numerical solutions from 2dfatmic at various times correspondingly as for groundwater flow the semi analytical solutions of solute concentration with continuous injection obtained using eq 21b were in accordance with the numerical solutions from 2dfatmic as shown in fig 3b thus we can confirm that the proposed semi analytical method provides correct solutions as shown in fig 3b contaminant concentrations around the injection well in the proposed and numerical models of 2dfatmic increased consistently over time due to the continuous injection of contaminants into the injection well in fig 3b the reason that the concentration peaks near the injection well in the proposed semi analytical solution are always higher than those of chen 1987 under the steady state flow can be explained by the temporal pattern of flow velocity around the well in transient flow the head near the well does not rise instantaneously unlike steady state flow but rises slowly over time to reach a steady state therefore in a transient flow at the early time the flow velocity near the well is always lower than the steady state flow until a steady state flow is reached thus under transient flow the peak of concentration around the well is higher than in steady state flow as shown in fig 3b similar to our results for continuous injection semi analytical solutions of solute concentrations for instantaneous injection were obtained using eq 21b and compared to the numerical solutions of 2dfatmic as shown in fig 4 this comparison indicates a very small difference between the analytical and numerical solutions around concentration peaks which might be due to numerical diffusion error in fig 4 as clean water is continuously injected after the contaminant mass is instantaneously injected from the injection well the clean water flowing into the injection well pushes the contaminant mass away from the injection well therefore the peak concentration moves away from the injection well over time in the numerical concentration distribution obtained from 2dfatmic the concentration peak moves away from the injection well over time in addition the semi analytical solutions and numerical solutions of 2dfatmic presented in figs 3a 3b and 4 were compared in tables 2 3 and 4 respectively by using normalized root mean square error nrmse values and l2 norm according to shaikh et al 2018 here the nrmse of head is defined as i 1 n h i h i 2 n h m a x n is the total number of data points hi is the semi analytical solution of head for the ith datum h i is the numerical solution of 2dfatmic for head at the ith datum and hmax is the maximum value of hi in addition the l2 norm provides average distance between analytical and numerical solutions average distance l2 norm between the proposed analytical values hana and the numerical values hnum over the spatial domain is defined as 1 l h n u m h a n a 1 l 0 l h n u m x t h a n a x t 2 d x 1 2 shaikh et al 2018 similarly the nrmse of concentration is defined as i 1 n c i c i 2 n c m a x ci is the semi analytical solution for concentration at the ith datum c i is the numerical solution of 2dfatmic for concentration at the ith datum and cmax is the maximum value of ci l2 norm of concentration is defined as 1 l c n u m c a n a 1 l 0 l c n u m x t c a n a x t 2 d x 1 2 where cana is the proposed semi analytical solution and cnum is the numerical solution of 2dfatmic the trapezoidal method is used for the calculation of the definite integral in l2 norm tables 2 3 and 4 show that the nrmse range is approximately 1 2 10 4 to 2 3 10 2 indicating that the differences between the new semi analytical solutions and numerical solutions obtained from 2dfatmic are very small l2 norms are in the range 3 79 10 4 1 33 the l2 norm error in table 4 looks large but corresponds to an error of about 1 relative to the peak concentration 4 results 4 1 comparison of the proposed semi analytical solution with previous analytical solutions based on the steady state thiem flow equation to analyze radial transport behavior through advection and dispersion in a radial flow field that diverges or converges in a transient state many researchers have previously applied divergent or convergent groundwater flow fields described by the simplified steady state thiem equation in advection dispersion equations in practice however determining whether flow has reached steady state conditions in the field is difficult accordingly the pseudo steady state condition is often assumed to represent steady state flow without caution in particular when determining the transport parameters in a tracer test through fitting of the theoretical breakthrough curve calculated under the assumption of steady state flow to field data as flow transients are common in the field errors may arise in the estimated transport parameters for practical reasons analysis of transport parameters while regarding the pseudo steady state flow condition as a true steady state flow condition has become customary as the long wait time required to achieve true steady state flow under field conditions would be expensive therefore in this study we investigated how transient flow affects transport behavior compared to steady state flow for this investigation the verification example described in section 3 1 was used to simulate radial dispersion in transient radially divergent flow from an injection well continuously injecting a concentration of 1 ppm in this example longitudinal dispersivity and porosity were assumed to be 1 m and 0 4 respectively the injection well radius was assumed to be zero and thus well mixing was not considered for steady state flow the analytical solution of chen 1987 was applied to obtain a concentration distribution with radial distance from the injection well at time t 0 0628 days results obtained using the analytical solution of chen 1987 were compared to those of the proposed semi analytical solution using various storage coefficients as shown in fig 5 in addition the numerical results of 2dfatmic were used to validate the proposed semi analytical solution under transient flow at various storage coefficients fig 5 the input parameters used for 2dfatmic are listed in table s1 of the supplementary material at storativity of less than 0 0002 the results of the analytical solution of chen 1987 and proposed semi analytical solutions showed strong agreement however as the storage coefficient increased the discrepancy between these methods expanded this result indicates that as the storage coefficient decreases flow approaches steady state thus the proposed semi analytical solution shows better agreement with the analytical solution of chen 1987 which describes solute transport in steady state radial flow conversely as the storage coefficient increases greater deviation from steady state occurs and the proposed semi analytical solution and numerical solution of 2dfatmic both diverge from the analytical solution of chen 1987 interestingly although the hydraulic head distribution at s 0 0002 has not yet reached steady state as shown in fig 2 the concentration distribution of the proposed semi analytical solution calculated using the flow velocity obtained from the hydraulic head distribution at s 0 0002 agrees well with that obtained using the analytical solution of chen 1987 for solute transport in steady state radial flow as shown in fig 5 in section 4 2 we provide a detailed discussion of the specific conditions under which good agreement can be achieved between concentration distributions obtained under steady state and transient flow to determine the extent to which transient flow affects the concentration distribution compared to steady state flow two examples are described in section 3 2 with a continuous source and instantaneous source these examples were used for comparison of the analytical solutions of chen 1987 and chen et al 2007 which are based on the steady state thiem equation with the proposed semi analytical method and the numerical solution obtained from 2dfatmic under transient flow as shown in figs 3b and 4 chen et al 2007 presented analytical solutions describing solute transport in a divergent flow tracer test with an instantaneous source while chen 1987 proposed an analytical solution for radial dispersion from the injection well with a continuous source as shown in figs 3b and 4 the analytical solutions of chen 1987 and chen et al 2007 which were developed using the steady state thiem equation showed significant discrepancies relative to the proposed semi analytical solutions and the numerical solution of 2dfatmic subsequently similar to our analysis of the effect of flow transiency on the spatially continuous concentration distribution the effect of transient flow on transport behavior in radially divergent flow was analyzed using the breakthrough curve for an observation point away from the injection well to obtain the breakthrough curve we assumed that the hydraulic conductivity of the aquifer is 8 64 10 3 m day corresponding to silty sand the thickness of the aquifer is 10 m porosity is 0 4 and the injection rate is 1 m3 day to achieve steady state flow a sufficiently small s 4 10 7 is used while s 0 28 is employed for simulating transient flow longitudinal dispersivities of α 0 025 0 05 0 1 0 25 0 5 0 75 and 1 m are assigned to represent various transport characteristics reflecting various peclet numbers finally the observation point is assumed to be located 5 m from the injection well under these conditions a continuous injection source with a concentration of 1 ppm and an instantaneous injection source with a mass of 78 5 g are separately applied at the injection well breakthrough curves of solute transport for the continuous injection source in the steady state were calculated for various longitudinal dispersivities using the analytical solution of chen 1987 while those for the instantaneous injection source were obtained for various longitudinal dispersivities using the analytical solution of chen et al 2007 similarly breakthrough curves were obtained for various longitudinal dispersivities using the proposed semi analytical solution with a sufficiently small value of s 4 10 7 and with s 0 28 for the continuous injection source the semi analytical solutions obtained using s 4 10 7 and s 0 28 were compared to the analytical solutions of chen 1987 as shown in fig 6 the proposed semi analytical solutions obtained with s 4 10 7 for all longitudinal dispersivities agree perfectly with those of chen 1987 on the other hand the proposed semi analytical solutions with the large value of s 0 28 for all longitudinal dispersivities show profound discrepancies with the results of chen 1987 as illustrated in fig 6 specifically as α r decreases these discrepancies tend to increase similarly for an instantaneous source the analytical solutions of chen et al 2007 were compared to the proposed semi analytical solutions with sufficiently small s 4 10 7 and s 0 28 as shown in fig 7 the proposed semi analytical solutions with s 4 10 7 for all longitudinal dispersivities aligned well with those of chen et al 2007 however the proposed semi analytical solutions with the large value of s 0 28 for all longitudinal dispersivities show profound discrepancies with the results of chen et al 2007 as shown in fig 7 similar to the case for a continuous source as α r shrinks the discrepancies tend to grow based on the aforementioned analytical studies of both instantaneous and continuous sources the effect of flow transients compared to steady state flows causes large discrepancies between breakthrough curves representing steady state and transient flows especially when α r is small these results suggest that the use of incorrect breakthrough curves obtained from previous analytical solutions including those of chen 1987 and chen et al 2007 based on the steady state flow assumption for determining parameters through curve fitting to field data obtained from tracer tests performed under conditions that deviate from steady state flow may lead to significant errors in the parameter estimates 4 2 influence of flow and solute transport parameters on the breakthrough curve and spatial concentration distribution to investigate the effects of flow parameter β and solute transport parameter α l on discrepancies between analytical solutions using the thiem equation and proposed semi analytical solution for transient flow various scenarios were designed by setting different ranges for the various parameters specifically to determine whether the proposed semi analytical solution is similar to the solutions of chen 1987 and chen et al 2007 in a given range of parameter values the similarity of the proposed semi analytical solution to the solutions of chen 1987 and chen et al 2007 was evaluated based on the ranges of various parameters to perform this analysis the characteristic values of various aquifer media from the available literature were summarized table 5 to determine a reasonable range for each parameter additionally assuming that the injection rates were 1 10 m 3 d a y β could be estimated from 0 003 to 5 000 here five or six values of β were chosen for each analysis as shown in table 6 values of 0 01 and 0 1 were selected for α l with the selected parameter values for β and α l the effects of β and α l on the spatial concentration distribution and breakthrough curve were assessed for a continuous injection source and instantaneous injection source for systematic analysis of the effects of various parameters several scenarios were assessed using the values of selected parameters listed in table 6 according to table 6 the effects of β and α l were analyzed based on discrepancies in the spatial concentration distribution or breakthrough curve between steady state and transient flow with a continuous injection source and instantaneous injection source respectively to increase the reliability of the proposed method we compared the results to the numerical solutions of 2dfatmic especially for β of 1 5 all input parameters of 2dfatmic are summarized in table s1 of the supplementary material fig 8 shows the effects of β on the spatial concentration distributions at two time points td 0 01 and 0 1 for two values of α l 0 01 and 0 1 with a continuous injection source as shown in fig 8 as β decreases the peak of the concentration distribution becomes higher while plumes migrate less in the flow direction small β indicates low transmissivity small aquifer thickness low porosity large storativity and a high injection rate while a large β has the opposite tendencies these trends are amplified as α l decreases as shown in fig 8b the differences between the semi analytical solutions and those of chen 1987 decrease with increasing β when α l is large these differences decrease further specifically we can determine a threshold of β above which the difference between the concentration distributions from the proposed semi analytical solution and those from chen 1987 s analytical solution are negligible i e within 1 in other words it is possible to determine a critical value of β with a well matched spatial concentration distribution under both steady and transient flow in the case of α l 0 1 the spatial concentration distributions under steady state and transient flow with β values above 15 and 8 nearly coincide at the times of td 0 01 and 0 1 as shown in in fig 8a while for α l 0 01 the spatial concentration distributions under steady state and transient flow with β values above 15 and 13 nearly coincide at td 0 01 and 0 1 as shown in in fig 8b according to fig 8 the concentration in the transient state is higher than in the steady state flow in particular the difference in concentration in the transient state and the steady state increases as the dispersivity decreases the reason can be explained by the fact that lower dispersivity cause less dispersion along the flow direction and more mass accumulation occurs which cause peak concentration more increase specially in the case of very small dispersivity α l such as less than 0 01 in this study the peak concentration can be increased to more than source concentration assuming that molecular diffusion is negligible to be zero however in real situation since the molecular diffusion is never zero peak concentration cannot exceed the source concentration similarly fig 9 shows the effects of α l on the spatial concentration distribution at two time points for each of five values of β with a continuous injection source as shown in fig 9 as α l increases the peak concentration decreases and plumes migrate farther in the flow direction this trend is subdued as β increases as shown in fig 9 the differences between the semi analytical solutions and those of chen 1987 decrease with increasing α l these differences decrease further with increasing β therefore the spatial concentration distribution obtained under transient flow approaches the concentration distribution under steady state flow as the transmissivity aquifer thickness porosity and longitudinal dispersivity increase but as the storativity and injection rate decrease in the same manner as the concentration distribution the effects of β on the breakthrough curve observed at the domain center with a continuous injection source were evaluated for two values of α l similar to the pattern shown in fig 8 fig 10 illustrates that decreasing β causes the peak of the breakthrough curve to become higher while plumes migrate more slowly in the flow direction similar to that shown in fig 8b this trend is amplified as α l decreases as shown in fig 10b the difference between the semi analytical solutions and those of chen 1987 are reduced with increasing β when α l is large this difference decreases further in accordance with the results presented above for the spatial concentration distributions in the cases of α l 0 1 and 0 01 the threshold values of β above which the difference between breakthrough curves obtained with the proposed semi analytical solution and that of chen 1987 are negligible i e within 1 are 6 and 14 respectively as shown in fig 10 similar to the results for the spatial concentration distribution presented in fig 9 fig 11 shows the effects of α l on the breakthrough curve observed at the domain center for each of five values of β with a continuous injection source as shown in fig 11 as α l increases the peak concentration decreases and plumes reach the observation point earlier similar to that shown in fig 9 this trend is subdued as β increases as shown in fig 11 the difference between the semi analytical solutions and those of chen 1987 decreases with increasing α l when β is large this difference decreases further accordingly as discussed above for the spatial concentration distribution in fig 9 we can conclude that the breakthrough curves obtained using the proposed semi analytical solutions for transient flow approached those obtained from chen 1987 s analytical solution under steady state flow when the transmissivity aquifer thickness porosity and longitudinal dispersivity are large but storativity and the injection rate are small in addition to the case with a continuous injection source the effects of β and α l on the spatial concentration distribution and breakthrough curve were assessed with an instantaneous injection source similar to our findings with a continuous injection source shown in fig 8 effects of β on the spatial concentration distribution at two time points td 0 01 and 0 1 are shown in fig s2 of the supplementary material for two values of α l 0 01 and 0 1 with an instantaneous injection source the characteristic behaviors of the concentration distribution depending on β and α l in fig s2 are similar to those in fig 8 specifically from fig s2 we can determine the threshold value of β above which the difference between the concentration distributions obtained from the proposed semi analytical solution and that of chen et al 2007 are negligible i e within 1 for α l 0 1 the thresholds of β are 150 and 60 at td 0 01 and 0 1 respectively while for α l 0 01 the thresholds of β are 150 and 125 at td 0 01 and 0 1 respectively similar to the results obtained with a continuous injection source shown in fig 9 the effects of α l on the spatial concentration distribution at two time points are shown in fig s3 of the supplementary material for each of five values of β with an instantaneous injection source according to the characteristic concentration distributions as β and α l as α l increase the concentration peak shrinks and plumes migrate farther in the flow direction this trend is subdued as β increases as shown in fig s3 of the supplementary material moreover the difference between the semi analytical solutions and those of chen et al 2007 decreases with increasing α l this difference shrinks further with increasing β similar inferences can be made from the characteristic concentration distribution with a continuous injection source as shown in fig 9 lastly the effects of β and α l on the breakthrough curve observed at the domain center with an instantaneous injection source were evaluated the effects of β and α l on the breakthrough curve for an instantaneous injection source are shown in fig s4 of the supplementary material which are similar to the results obtained for a continuous injection source as shown in fig 10 for α l 0 1 and 0 01 the thresholds of β above which the difference in the breakthrough curves between the proposed semi analytical solution and that of chen et al 2007 s is negligible within 1 are 90 and 150 respectively as shown in fig s4 of the supplementary material finally the effects of α l on the breakthrough curve observed at the domain center are shown in fig s5 of the supplementary material for five values of β with an instantaneous injection source the characteristic behaviors of the breakthrough curve related to β and α l with an instantaneous injection source are similar to those with a continuous injection source as shown in fig 11 these results regarding the influences of various parameters on the discrepancies between existing analytical solutions based on the thiem equation and the proposed semi analytical solution considering transient flow shown in figs 8 11 and figs s2 s5 of the supplementary material indicate that for both continuous and instantaneous injection sources the spatial concentration distribution and breakthrough curve obtained from the proposed semi analytical solutions with transient flow approach those obtained using the solutions of chen 1987 and chen et al 2007 with steady flow as the transmissivity aquifer thickness porosity and longitudinal dispersivity increase but as storativity and the injection rate decrease i e as both β and α l become larger 4 3 model application any data of tracer test in a transient divergent radial flow is not available and not existed in previous literatures since typical standard tracer test has been performed until now hoehn and roberts 1982 welty and gelhar 1994 novakowski 1992 chen et al 2007 ptak et al 2004 gutierrez et al 2013 as an alternative to new tracer test under a transient radial flow we found out previous field data obtained through the typical standard tracer test in literatures hoehn and roberts 1982 and we applied to estimate aquifer dispersivity using the new analytical solution proposed in this study a diverging radial flow tracer test for the assessment of aquifer dispersivity was performed in a sand and gravel aquifer over a 1 2m depth in palo alto baylands california hoehn and roberts 1982 a constant flow rate of 2 5 m3 hour was applied in this tracer test to establish divergent flow field hoehn and roberts 1982 after the flow field reached a steady state condition a slug of tracer mass 3h was instantaneously introduced into an injection well and tracer s concentration data were collected at an observation well located at 16 8 m from the injection well the average hydraulic conductivity was estimated to be 0 4 m hour and the effective porosity was measured as 0 22 in a core sample the small storage coefficient of 1ⅹ10 5 was estimated welty and gelhar 1994 and chen et al 2007 used this field data and estimated aquifer dispersivity by a curve matching technique using their proposed developed analytical solutions for estimation of aquifer dispersivity dimensionless type curves are useful welty and gelhar 1994 chen et al 2007 the dimensionless type curves are prepared by plotting normalized concentration c cpeak against dimensionless time t tm on logarithmic paper where cpeak is the peak concentration of the breakthrough curve tm πbθr 2 q and r is distance to the observation point from the injection well the parameter estimation employs the curve matching technique where the dimensionless breakthrough curves are prepared using the proposed semi analytical solution following procedure of welty and gelhar 1994 and chen et al 2007 for estimating the dispersivity we employed curve matching technique to estimate the dispersivity for the curve matching technique we prepared dimensionless breakthrough curves plotted in log log scale using our proposed semi analytical solutions on the curve matching technique the field data plotted on log log paper is superimposed on the calculated breakthrough curves with the axes sets kept parallel so that the most field data match calculated breakthrough curve in this study the value of longitudinal dispersivity is determined with 0 233 m that match most field data as shown in fig 12 this estimated dispersivity value is same as that determined in chen et al 2007 also the root mean square error between the proposed breakthrough data and the measured data was small to be 0 129 5 discussion through comparison of the proposed semi analytical solution with the existing analytical solutions of chen 1987 and chen et al 2007 as described in section 4 we determined that under specific conditions of β and α l the concentration distribution and breakthrough curve obtained from the proposed semi analytical solutions for transient groundwater flow deviated from those obtained from existing analytical solutions that assume steady groundwater flow with continuous and instantaneous injection sources respectively we determined that above certain threshold values of β the differences between the concentration distribution or breakthrough curve obtained from the proposed semi analytical solution and those resulting from existing analytical solutions are negligible i e within 1 here for the spatial concentration distribution the thresholds of β decrease as dimensionless time and α l increase as shown in figs 8 and s2 of the supplementary material regardless of the injection source type for the breakthrough curve the thresholds of β decrease as α l increases as shown in figs 10 and s4 of the supplementary material regardless of the injection source type furthermore regardless of the spatial concentration distribution and breakthrough curve an instantaneous injection source has larger thresholds of β than a continuous injection source as shown in figs 8 10 s2 and s4 in the supplementary material specifically for a continuous injection source the thresholds of β are 6 to 15 at the dimensionless time points and α l values considered in this study but increase to 60 and 150 respectively for an instantaneous injection source at the same dimensionless time points and α l values accordingly we can infer that it is more difficult for an instantaneous injection source to reach the condition where the difference in the concentration distribution or breakthrough curve between the proposed semi analytical and existing analytical solutions are negligible i e within 1 than for a continuous injection source given the same aquifer properties such as transmissivity aquifer thickness porosity and storativity and transport parameters such as longitudinal dispersivity based on these findings we can conclude that tracer tests conducted under the conditions of β and α l described above can reasonably use existing analytical solutions for curve fitting during parameter estimation rather than the proposed semi analytical solution in other cases parameter values should be estimated carefully with existing analytical solutions to ensure accurate values are selected in such cases the proposed semi analytical solution may be a better alternative for fitting field breakthrough curve data than existing analytical solutions especially when transient effects are significant notably although the difference between the proposed semi analytical solution and existing analytical solutions decreases with increasing values of both β and α l regardless of source type crucial differences were observed between the effects of β and α l on the similarity of the proposed semi analytical solution to existing analytical solutions when β is sufficiently large the proposed semi analytical solution and existing solutions provided nearly identical results regardless of α l however no matter how large α l becomes a discernable difference remains between the semi analytical solution and existing analytical solutions when β is not sufficiently large summarizing the limitations and advantages of this study this study is limited to analysis of a constant injection rate that is temporally varying injection rates are not considered moreover the injection well is assumed to fully penetrate a horizontal homogeneous and isotropic confined aquifer of constant thickness accordingly heterogeneous and anisotropic aquifers and partial penetrating wells cannot be considered in this study a further limitation is that we do not account for skin effects around the well or the effects of mixing within the injection well on the other hand a major strength of this study is that the proposed semi analytical method can consider spatially and temporally varying radial flow induced by an injection well at a constant rate while previous studies have considered only steady state groundwater flow using thiem s solution as eq 9 describing transient flow is analytically solved using the fourier series expansion for space and the eigenfunction of the helmholtz equation for time to obtain an analytical expression of head as a function of time and radial distance the corresponding velocity can be obtained using darcy s law and then directly applied to the velocity and dispersion coefficient terms in the transport equation ultimately a semi analytical solution for the derived transport equation is obtained using gitt our semi analytical solution better explains the effects of transient features of radial flow induced by injection at a constant rate on the concentration distribution or breakthrough curve than previous methods previous analytical studies could not consider such transient features of radial flow finally the proposed semi analytical solution is an important tool for developing new tracer tests where time efficiency is important as an alternative to traditional tracer testing in the traditional tracer test prior to introducing the tracer into the injection well a period of a few hours to a few days is needed depending on the aquifer properties and injection rate before establishment of a steady horizontal and radially divergent flow field can be assumed in contrast without waiting for the slow establishment of a steady horizontal and radially divergent flow field a new tracer test method could be developed wherein the tracer is injected simultaneous with the start of injection using the proposed semi analytical solution for curve fitting during parameter estimation moreover as the new method would not require steady state flow conditions for estimation of transport parameters no error in the breakthrough curve would be caused by transient flow effects 6 summary and conclusion a new semi analytical solution to the radial advection dispersion equation in cylindrical coordinates for solute transport during transient divergent radial flow was derived for continuous and instantaneous injection inputs into the injection well using the gitt method the main findings of this study are as follows the novelty of this study is the adoption of a new analytical solution for hydraulic head describing both spatially and temporally varying radial flow induced by an injection well rather than thiem s solution the corresponding velocity can be obtained using darcy s law and then directly used for the velocity and dispersion coefficient terms in the transport equation ultimately the semi analytical solution of the derived transport equation described above is obtained using gitt to account for the effect of transient radial flow features induced by the injection well at a constant rate on the concentration distribution or breakthrough curve an analytical solution to the transient groundwater flow equation was obtained by expanding the generalized fourier series using the eigenfunction of a homogeneous helmholtz equation and assuming orthogonality of eigenfunctions here the main difference between the derived analytical solution of eq 9 and theis solution is that eq 9 is separable in space and time while theis solution is not the solution derived in eq 9 is expressed as a separable form for space and time to better suit application to gitt in terms of mathematical manipulation verification of the proposed analytical solution for hydraulic head was performed through comparison with theis analytical solution and thiem s steady state solution while the spatial concentration distributions and breakthrough curves obtained from the new semi analytical solution were verified through comparison with the numerical solutions of 2dfatmic and analytical solutions of chen 1987 and chen et al 2007 depending on the aquifer flow properties solute transport parameters and injection rate selected profound discrepancies or perfect agreement between the spatial concentration distribution and breakthrough curve between existing analytical solutions and the proposed semi analytical solution were obtained as described in sections 3 and 4 in particular investigation of the influences of flow and solute transport parameters on the spatial concentration distribution and breakthrough curve described in section 4 showed that as the dimensionless parameters β and α l increase the spatial concentration distribution and breakthrough curve under transient flow approach those under steady flow meanwhile as β and α l decrease larger discrepancies arise furthermore regardless of the spatial concentration distribution and breakthrough curve the thresholds of β for an instantaneous injection source are larger than the corresponding values for a continuous injection source as shown in figs 8 10 s2 and s4 in the supplementary material specifically for a continuous injection source the thresholds of β are 6 15 at the dimensionless time points and α l values considered in this study while these thresholds are 60 150 for an instantaneous injection source at the same dimensionless time points and α l values the major advantage of our method is allowing for simulation of solute transport in new tracer test where tracer mass injection can be performed simultaneously with the start of water injection into the injection well without waiting for establishment of steady horizontal and radially divergent flow accordingly it can support the development of new tracer testing methods that are more effective in terms of time and cost than traditional tracer tests that require long wait times a few hours to a few days to achieve steady horizontal and radially divergent flow moreover our method could serve as a benchmark for testing numerical solutions credit author statement heejun suk conceptualization methodology software roles writing original draft funding acquisition visualization jui sheng chen conceptualization methodology validation weon shik han writing review editing formal analysis eungyu park supervision formal analysis declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the basic research project 22 3411 of the korea institute of geoscience and mineral resources kigam funded by the ministry of science and ict supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2022 104283 appendix e supplementary materials image application 1 image application 2 appendix a detailed derivation of the analytical solution to groundwater flow under transient flow conditions here the following homogeneous helmholtz equation is solved to obtain an eigenfunction set a1 d 2 ψ r d d r d 2 1 r d d ψ r d d r d λ 2 ψ r d 0 with the following boundary condition a2 ψ 1 0 where λ and ψ rd are the eigenvalue and corresponding eigenfunction respectively the helmholtz equation expressed in eq a1 with the boundary condition a2 and continuous bounded condition of hydraulic head at the injection well has the following eigenvalue eigenfunction and norm a3 λ n μ n ψ n r d j 0 μ n r d n n 1 2 j 1 2 μ n where j 0 and j 1 are the bessel functions of the first kind with order zero and order one respectively and μ n is the nth zero value of j 0 the forward transform and corresponding inverse transform can now be constructed using the eigenfunctions e n t d 1 n n 0 1 r d ψ n r d h d r d t d d r d 1 n n 0 1 r d j 0 μ n r d h d r d t d d r d a4a n 1 2 a4b h d r d t d n 1 ψ n r d e n t d n 1 j 0 μ n r d e n t d n 1 m f j 0 μ n r d e n t d where mf is set to a value sufficiently large to produce the desired level of accuracy for hydraulic head by substituting eqs a1 a3 and a4b into eq 6 eq 6 can be rewritten as follows a5 n 1 m f ψ n r d d e n t d d t d β n 1 m f μ n 2 ψ n r d e n t d δ r d 1 2 r d θ s to derive en td n 1 2 mf we apply the operator 0 1 r d ψ m r d d r d to eq a5 and use ψm 0 j 0 0 1 with the following orthogonality conditions a6 ψ m ψ n 0 1 r d ψ m r d ψ n r d d r d 0 m n n m m n then eq a5 can be rewritten as eq a7 a7 d e m t d d t d β μ m 2 e m t d θ 2 s 1 n m eq a7 is then solved using e m 0 1 n m 0 1 r d j 0 μ m r d h d r d t d 0 d r d 0 a8 e m t d θ 2 s 1 n m 1 β μ m 2 1 exp β μ m 2 t d from eq a4b hd rd td can be obtained using eq a8 as follows a9 h d r d t d n 1 m f θ 2 s 1 n n 1 β μ n 2 j 0 μ n r d 1 exp β μ n 2 t d appendix b detailed procedure of obtaining t t d in gitt to derive tn td n 1 2 mt we apply the operator 0 1 r d φ m r d d r d to eq 15a as 0 1 r d j 0 μ m r d c d t d d r d 0 1 r d j 0 μ m r d 1 r d r d r d d r d t d c d r d d r d 0 1 r d j 0 μ m r d 1 r d r d r d v r d t d c d d r d 0 1 r d j 0 μ m r d q d d r d b1 m 1 2 m t by applying the green theorem eq b1 can be written as follows 0 1 r d j 0 μ m r d c d t d d r d j 0 μ m r d r d d r d t d c d r d 0 1 0 1 j 0 μ m r d r d d r d t d c d r d d r d j 0 μ m r d r d v r d t d c d 0 1 0 1 j 0 μ m r d r d v r d t d c d d r d 0 1 r d j 0 μ m r d q d d r d b2 m 1 2 m t as j 0 μ m 0 eq b2 can be rewritten as follows 0 1 r d j 0 μ m r d c d t d d r d 0 1 j 0 μ m r d r d d r d t d c d r d d r d 0 1 j 0 μ m r d r d v r d t d c d d r d 0 1 r d j 0 μ m r d q d d r d b3 m 1 2 m t the inverse transform of eq 20b is substituted into eq b3 as follows n 1 m t 0 1 r d j 0 μ m r d j 0 μ n r d d r d d t n t d d t d n 1 m t 0 1 j 0 μ m r d r d d r d t d j 0 μ n r d d r d t n t d n 1 m t 0 1 j 0 μ m r d r d v r d t d j 0 μ n r d d r d t n t d 0 1 r d j 0 μ m r d q d d r d b4 m 1 2 m t j 0 μ n r d μ n j 1 μ n r d is then applied and v r d t d and d r d t d of eqs 15b and 15c respectively are substituted into eq b4 n 1 m t 0 1 r d j 0 μ m r d j 0 μ n r d d r d d t n t d d t d α l r n 1 m t k 1 m f μ m μ n j 1 2 μ k μ k 0 1 r d j 1 μ m r d j 1 μ n r d j 1 μ k r d d r d 1 e x p β μ k 2 t d t n t d 1 r n 1 m t k 1 m f μ m j 1 2 μ k μ k 0 1 r d j 1 μ m r d j 0 μ n r d j 1 μ k r d d r d 1 exp β μ k 2 t d t n t d 0 1 r d j 0 μ m r d q d d r d b5 m 1 2 m t then an orthogonality condition is applied to eq b5 n m d t m t d d t d α l r n 1 m t k 1 m f μ m μ n j 1 2 μ k μ k 0 1 r d j 1 μ m r d j 1 μ n r d j 1 μ k r d d r d 1 e x p β μ k 2 t d t n t d 1 r n 1 m t k 1 m f μ m j 1 2 μ k μ k 0 1 r d j 1 μ m r d j 0 μ n r d j 1 μ k r d d r d 1 exp β μ k 2 t d t n t d 0 1 r d j 0 μ m r d q d d r d b6 m 1 2 m t where nm is m th norm if we rearrange eq b6 then eq b6 can be shortened to yield the following denumerable system of coupled linear ordinary differential equations in terms of time b7 d t m t d d t d n 1 m t a m n t d t n t d f m t d m 1 2 m t where a m n t d α l r μ m μ n n m k 1 m f 1 j 1 2 μ k μ k 0 1 r d j 1 μ m r d j 1 μ n r d j 1 μ k r d d r d 1 exp β μ k 2 t d b8a 1 r μ m n m k 1 m f 1 j 1 2 μ k μ k 0 1 r d j 1 μ m r d j 0 μ n r d j 1 μ k r d d r d 1 exp β μ k 2 t d b8b f m t d 1 2 r 1 n m for continuous injection 1 2 r 1 n m δ t d for instantaneous injection here mf is set to a value sufficiently large to produce accurate velocity and dispersion coefficients and may differ from mt equation b8a can be rewritten as follows b9 a m n t d k 1 m f b m n k b k t d where b10a b m n k 1 r 1 n m 1 j 1 2 μ k μ k α l μ m μ n 0 1 r d j 1 μ m r d j 1 μ n r d j 1 μ k r d d r d μ m 0 1 r d j 1 μ m r d j 0 μ n r d j 1 μ k r d d r d b10b b k t d 1 exp β μ k 2 t d in this case the solution is derived according to linear system theory rugh 1996 the analytical solution for tm td becomes b11 t t d exp 0 t d a σ d σ t 0 0 t d exp τ t d a σ d σ f τ d τ where b12 t m 0 1 n m 0 1 r d j 0 μ m r d c d r d t d 0 d r d m 1 2 m t in eq b11 a σ d σ can be calculated using the properties of the constant matrix b as follows b13a a σ d σ b b σ d σ b b σ where b13b b k σ σ 1 β μ k 2 exp β μ k 2 σ substituting eq b13a into eq b11 eq b11 can be rewritten as follows b14 t t d exp b b t d b 0 t 0 0 t d exp b b t d b τ f τ d τ here the integrals of the triple products of the bessel functions in eq b10a were determined using the integral function in matlab 7 which employs adaptive quadrature to calculate the exponential matrix in eq b14 the built in function expm in matlab 7 was used which follows method 3 of moler and van loan moler and van loan 1978 to calculate the integral of the second term on the right hand side of eq b14 quadv was employed in matlab 7 which uses recursive adaptive simpson quadrature notably matrix a depends on flow parameters related to β and solute transport parameters associated with r and α l on the other hand the integrals of the triple product of the bessel functions within eq b10a were not related to any flow or transport parameters after the integrals of the triple product of the bessel functions are calculated through numerical integration with sufficient numbers of mf and mt values those products need not be calculated again to solve other problems involving various β r and α l values thus the computational burden of calculating matrix b can be reduced greatly allowing the proposed semi analytical solution to achieve reasonable computational efficiency appendix c supplementary data supplementary material related to this article can be found in the attached file supplementary file docx appendix d source code matlab file source code related to this article can be found in the attached file source code m 
107,solute transport through radial advection dispersion is a common phenomenon in many applications such as aquifer decontamination heat exchange for geothermal exploration and tracer testing numerous analytical solutions to the problem of tracer testing in a radially divergent flow field are available for fitting breakthrough curves however all of these analytical solutions assume non uniform flow velocity based on thiem s solution which varies only spatially not temporally although an injection well with a constant injection rate in a tracer test causes both spatial and temporal variability of the radial flow field previous analytical studies have employed a steady state groundwater flow solution i e thiem s solution to derive analytical solutions for breakthrough curves or spatial concentration distribution curves to the best of our knowledge no analytical solution to the radial advection dispersion equation under spatially and temporally variable flow conditions driven by injection at a constant rate is currently available here we propose a novel semi analytical solution for describing solute transport in spatially and temporally variable flow induced by an injection well with a constant injection rate we find that above certain threshold values of dimensionless parameters related to aquifer flow properties solute transport parameters and the injection rate the differences between previous analytical strategies our proposed semi analytical solution are negligible these threshold values tend to increase more sharply with an instantaneous injection source than a continuous injection source in other words it is more difficult for an instantaneous injection source to reach the condition where the difference between our approach and previous ones is negligible than for a continuous injection source type our findings clarify when existing analytical solutions can be reasonably used for parameter estimation through fitting of the breakthrough curve to field data and when the proposed semi analytical solution is a better alternative keywords divergent radial flow new semi analytical solution tracer test transient flow data availability i have shared the link to my data code at the attach file step nomenclature b aquifer thickness l c concentration m l 3 d dispersion coefficient l2 t 1 d dimensionless dispersion coefficient en transformed head associated with the n th eigenvalue h hydraulic head l h transformed hydraulic head h h 0 j 0 bessel function of the first kind with order zero j 1 bessel function of the first kind with order one l domain length of interest l m instantaneously injected mass m m injected mass flux m t 1 mf truncation number of series in the inversion transform of head mt truncation number of series in the inversion transform of concentration nn norm associated with n th eigenvalue q injection rate l3 t 1 r radial distance from the well l r retardation factor dimensionless s storativity dimensionless t time t t transmissivity l2 t 1 tn transformed concentration associated with n th eigenvalue v pore velocity l t 1 v dimensionless pore velocity greek letters α l longitudinal dispersivity l α l transport dimensionless parameter α l l β flow dimensionless parameter tπθb sq δ r dirac delta function l 1 θ porosity dimensionless λ n n th eigenvalue μ n n th zero value of bessel function of the first kind with zero order j 0 φ n n th eigenfunction of the transport equation ψn n th eigenfunction of the flow equation subscripts 0 initial boundary condition d dimensionless 1 introduction inaccurate prediction of solute transport can lead to unreliable risk analysis or inefficient design of groundwater remediation programs as well as inaccurate estimation of physical transport parameters in tracer tests analysis of solute transport in groundwater often occurs in situations involving convergent or divergent plane radial dispersion especially when tracer testing is performed in a radial flow field associated with a well numerous analytical solutions to the problem of tracer dispersion in radially convergent or divergent flow are available becker and charbeneau 2000 ogata 1958 lau et al 1959 hoopes and harleman 1967 tang and babu 1979 moench and ogata 1981 valocchi 1986 hsieh 1986 huang and goltz 2006 chen 1985 1986 1987 tang and peaceman 1987 chen and woodside 1988 novakowski 1992 moench 1989 1995 zlotnik and logan 1996 chen et al 1996 2002 2003a 2003b 2007 2012b lai et al 2016 wang and crampon 1995 wang and zhan 2013 wang et al 2020 welty and gelhar 1994 all of these solutions consider solute transport in a non uniform flow field with radial flow where the flow velocity is inversely proportional to the radial distance from the well based on the thiem equation thiem 1906 however the flow velocity obtained from the thiem equation varies only spatially not temporally at steady state despite strong field evidence that transient flow is ubiquitous previous analytical studies have assumed steady state groundwater flow dejam et al 2014 in convergent or divergent tracer tests prior to the introduction of a tracer into an injection well a well located in the aquifer is generally pumped or injected until it can be safely assumed that a steady horizontal radially convergent or divergent flow field is established however it is very difficult to determine whether a steady state has been reached under field conditions hours to days are often needed to reach steady state depending on aquifer characteristics and pumping or injection rates to reduce the waiting time prior to injection of the tracer from an injection well in the field a quasi steady state condition obtained after an insufficient amount of time is commonly used as the steady state condition such an incautious steady state flow assumption invariably leads to errors in the breakthrough curves obtained from the tracer test and these errors may be small or large therefore an analytical solution that considers transient flow effects is essential to accurately determine solute transport parameters in analyses of breakthrough curves from tracer tests regardless of flow conditions to the best of our knowledge no analytical solution to the radial advection dispersion equation in transient flow is currently available although a few analytical solutions have been reported for evaluation of solute transport in transient flow carlier 2008 chen et al 2012a these previous analytical solutions assume piecewise steady state flow for each pumping rate and thus the transitional period between two pumping rates is neglected therefore under the assumption of piecewise steady state flow these solutions can be used to analytically evaluate solute transport in a radial flow field with a multistep injection flow rate and arbitrary input concentration history however the assumption of piecewise steady state flow may not reflect or correctly approximate true transient flow state the application of analytical solutions is not limited to estimation of transport parameters in the tracer tests discussed above but can extend to verification or benchmarking of numerical codes today many sophisticated numerical algorithms such as the eulerian lagrangian localized adjoint method ellam the mixed hybrid finite element method the lagrangian eulerian decoupling method with an adaptive zooming and peak valley capturing scheme lezoompc and the discontinuous galerkin dg method appear to overcome the inherent numerical errors associated with spurious oscillation numerical dispersion grid orientation phase error peak clipping and valley elevation in particular numerical errors tend to occur in highly heterogeneous media and under strongly transient situations however very few analytical solutions are available to verify numerical results in these complex situations tabrizinejadas et al 2020 thus the proposed semi analytical solution describing solute transport in spatially and temporally variable radial flows will be useful for numerical code verification and benchmarking as well as estimation of transport parameters here we propose a new mathematical solution for solute transport in spatially and temporally variable radial flow induced by an injection well with a constant injection rate as shown in fig 1 although an injection well with a constant injection rate in tracer testing causes both spatial and temporal variability of the radial flow field previous analytical solutions employ only the steady state groundwater flow solution i e thiem s solution for derivation of the analytical solutions for breakthrough curves or spatial concentration distribution curves in contrast we adopt a newly derived analytical solution describing both spatial and temporal radial flow variability induced by an injection well with a constant injection rate the semi analytical solution proposed here better explains the effect of transient features of radial flow induced by an injection well with a constant flow rate on the concentration distribution or breakthrough curve than previous solutions which cannot account for transient features of radial flow this paper consists of five steps first the spatially and temporally variable flow induced by an injection well with a constant injection rate is solved using partial differential equations combining darcy s law with the conservation of mass in a radial coordinate system the partial differential equation describes the one dimensional radial flow of groundwater that is both spatially and temporally variable from an injection well with a constant injection rate here an analytical solution to the transient groundwater flow equation was derived through expansion of the generalized fourier series using the eigenfunction from a homogeneous helmholtz equation and assuming orthogonality of the eigenfunctions second the flow velocity is directly derived through application of darcy s law from the analytical solution of groundwater head described above third to solve the problem of solute transport in divergent radial flow in a transient state driven by a constant injection rate the derived analytical solution for flow velocity is directly substituted into the radially divergent advection dispersion equation our proposed solution is obtained using the generalized integral transform technique gitt from the radially divergent advection dispersion equation under unsteady divergent radial flow driven by a constant injection rate here two source types are considered namely continuous and instantaneous injection sources fourth our method is verified against previous analytical solutions including those of chen 1987 chen et al 2007 theis theis 1935 and thiem thiem 1906 as well as the numerical solution obtained from the two dimensional subsurface flow fate and transport of microbes and chemicals model 2dfatmic which is commercially available yeh and cheng 1997 finally we investigate the effects of flow parameters and solute transport parameters on the spatial concentration distribution and breakthrough curves for both continuous and instantaneous injection sources moreover through comparisons of our method to previous ones we identify the conditions of β dimensionless flow parameter and α l dimensionless transport parameter under which it may be reasonable to use existing analytical solutions such as those of chen 1987 and chen et al 2007 which are based on the thiem equation as fitting curves for parameter estimation despite unsteady flow as the breakthrough curve of the existing analytical solution and that of the proposed semi analytical solution are nearly identical 2 mathematical formulation 2 1 analytical solution for groundwater flow under transient flow conditions for calculating transient axisymmetric groundwater flow from an injection well in a homogeneous and isotropic confined aquifer system the following governing equation can be expressed in polar coordinate form chan et al 1976 yeh and chang 2006 samani and sedghi 2015 sedghi and zhan 2018 1 t 2 h r 2 1 r h r s h t δ r q 2 π r where s is storativity t is transmissivity h is hydraulic head t is time r is the radial distance from the injection well q is the injection rate and δ is the dirac delta function notably the well can be expressed as a boundary condition hantush and jacob 1955 neuman and witherspoon 1969 neuman 1972 malama et al 2007 loáiciga 2010 perina 2010 mishra et al 2012 sedghi and samani 2015 feng and zhan 2016 wen et al 2017 but is also represented by the properties of the dirac δ function without introduction of a boundary condition chan et al 1976 zlotnik and zhan 2005 yeh and chang 2006 samani and sedghi 2015 sedghi and zhan 2018 here the boundary condition is mass balance based on darcy s law at the interface between a well of infinitesimal radius and an aquifer loáiciga 2010 perina 2010 in mathematics an infinitesimal or infinitesimal number is a quantity that is closer to zero than any standard real number but that is not zero https en wikipedia org wiki infinitesimal chan et al 1976 demonstrated that eq 1 is mathematically equivalent to the boundary condition therefore eq 1 can be used to determine the head at any point around the well except at the well itself r 0 use of the dirac δ function allows the injection well to be included in the governing equation without explicitly introducing a boundary condition the initial and boundary conditions are 2a h r 0 h 0 0 r l 2b h l t h 0 t 0 where l is the domain length of interest and h 0 is the initial and boundary heads a limitation of this study is the assumption that the injection rate is constant thus this solution does not account for temporally variability of the injection rate moreover the injection well is assumed to fully penetrate a horizontal homogeneous and isotropic confined aquifer of constant thickness by introducing the new variable h h h 0 eqs 1 and 2 can be rewritten as eqs 3 and 4 respectively 3 t 2 h r 2 1 r h r s h t δ r q 2 π r 4a h r 0 0 0 r l 4b h l t 0 t 0 by defining the following dimensionless quantities 5 r d r l t d t t a t a π θ b l 2 q h d h b β t s 1 l 2 t a t s π θ b q where b is aquifer thickness and θ is a porosity eqs 3 and 4a 4b can be rewritten as follows 6 h d t d β 2 h d r d 2 1 r d h d r d δ r d 1 2 r d θ s 7 h d r d 0 0 0 r d 1 8 h d 1 t d 0 t d 0 solution of eq 6 with the boundary condition 8 and initial condition 7 requires expansion of the eigenfunction from a homogenous helmholtz equation in a generalized fourier series hayek 2001 details of the derivation are presented in appendix a finally using eqs 5 and a3 together with h h h 0 eq a9 in appendix a can be rewritten as 9 h r t q π t n 1 m f 1 j 1 2 μ n 1 μ n 2 j 0 μ n l r 1 exp t s 1 l 2 μ n 2 t h 0 eq 9 is an alternative semi analytical solution to the theis solution the derived solution is expressed as a spatially and temporally separable form and is better suited for gitt than the theis solution in terms of mathematical manipulation 2 2 semi analytical solution for solute transport under transient flow conditions the advection dispersion equation in cylindrical coordinates which describes the transport of a solute in a transient radially divergent flow field can be written as haddad et al 2015 10 θ r c t 1 r r r θ d r t c r r θ v r t c δ r m 2 π r b where c is concentration r is the retardation factor v is pore velocity d is the dispersion coefficient and m is the injected mass flux m q c 0 for continuous injection and m m δ t for slug injection c 0 is the injected concentration and m is the instantaneously injected mass a limitation of this study is that it does not account for skin effects around the well or the effects of mixing within the injection well in eq 10 molecular diffusion is assumed to be negligible relative to mechanical dispersion and the dispersion coefficient is assumed to be linearly dependent on the pore velocity 11 d r t α l v r t where α l is the longitudinal dispersivity initial and boundary conditions are expressed as 12a c r 0 0 0 r l 12b c l t 0 t 0 it is assumed that the initial concentration across the aquifer is zero and that the boundary is sufficiently distant for solute not to reach it the analytical solution used for hydraulic head presented in eq 9 and described in section 2 1 is an analytical alternative to the theis solution the main difference between the two is that eq 9 is a spatially and temporally separable form while theis solution is not the separable form of the analytical solution is used rather than theis solution because it is better suited to mathematical manipulation for gitt which is employed in this study to solve the solute transport equation here v r t with separable time and space are obtained from the head distributions calculated from eq 9 using darcy s law as follows 13a v r t v 0 k 1 m f j 1 μ k l r 1 j 1 2 μ k 1 μ k 1 exp t s μ k 2 l 2 t where 13b v 0 q π θ b l furthermore using eqs 11 and 13a d r t can be obtained as follows 14 d r t α l v 0 k 1 m f j 1 μ k l r 1 j 1 2 μ k 1 μ k 1 exp t s μ k 2 l 2 t by defining the dimensionless quantities α l α l l and c d c c i where ci c 0 under continuous injection conditions and c i m π θ b l 2 under instantaneous injection conditions and then substituting eqs 13a and 14 into eq 10 eq 10 can be rewritten as eq 15 15a c d t d 1 r d r d r d d r d t d c d r d r d v r d t d c d q d where 15b v r d t d 1 r k 1 m f j 1 μ k r d 1 j 1 2 μ k μ k 1 exp β μ k 2 t d 15c d r d t d α l r k 1 m f j 1 μ k r d 1 j 1 2 μ k μ k 1 exp β μ k 2 t d here q d 1 2 r r d δ r d is used for continuous injection and q d 1 2 r r d δ r d δ t d for instantaneous injection furthermore the initial and boundary conditions of eqs 12a 12b can be rewritten as follows using dimensionless quantities 16a c d r d 0 0 0 r d 1 16b c d 1 t d 0 t d 0 to solve eq 15a with the boundary condition of eq 16b and initial condition of eq 16a gitt is employed gitt establishes a pair of transforms such as an integral and an inversion transform almeida and cotta 1995 cotta 1993 liu et al 1998 2000 suk 2013 2016 2017 in gitt the following auxiliary equation is employed for construction of the pair of transforms 17 d 2 φ r d d r d 2 1 r d d φ r d d r d λ 2 φ r d 0 with the following boundary condition 18 φ 1 0 where λ and φ are the eigenvalue and corresponding eigenfunction respectively the auxiliary equation eq 17 with the boundary condition of eq 18 has the following eigenvalue λ eigenfunction φ and norm n 19 λ n μ n φ n r d j 0 μ n r d n n 1 2 j 1 2 μ n the forward transform and corresponding inverse transform can now be constructed using the eigenfunctions t n t d 1 n n 0 1 r d φ n r d c d r d t d d r d 1 n n 0 1 r d j 0 μ n r d c d r d t d d r d 20a n 1 2 20b c d r d t d n 1 φ n r d t n t d n 1 j 0 μ n r d t n t d n 1 m t j 0 μ n r d t n t d where tn is the transformed concentration associated with the n th eigenvalue and mt is set to a sufficiently large value to achieve the desired level of accuracy in the concentration distribution the detailed procedure used for obtaining t td in gitt is provided in appendix b once the set of coupled first order differential equations for t td is solved the inverse formula of gitt expressed in eq 20b can be calculated to obtain cd rd td 21a c d r d t d n 1 m t j 0 μ n r d t n t d finally using cd c ci concentration c can be obtained as 21b c r t c i n 1 m t j 0 μ n l r t n q π θ b l 2 t 3 verification to solve the radial advection dispersion equation for solute transport under divergent radial flow in a transient state transient axisymmetric groundwater flow from an injection well in a homogeneous and isotropic confined aquifer system is first solved to obtain an analytical solution for eq 9 as defined in section 2 1 then using the analytical solution obtained for flow the advection dispersion equation in cylindrical coordinates describing the transport of solute in a transient radially divergent flow field with instantaneous or continuous tracer input is readily solved to obtain semi analytical solution for eq 21b accordingly to validate the new semi analytical solution the analytical solution for flow should be verified first then the semi analytical solution for solute transport can be verified in this section two verification tests were performed first the derived analytical solutions for flow were compared to theis and thiem s solutions for verification as described in section 3 1 second the new semi analytical solutions for solute transport were compared to numerical solutions obtained using 2dfatmic as no analytical solutions for solute transport under transient divergent radial flow were available 3 1 comparison of the proposed analytical solution of flow with the theis solution to verify the proposed analytical solution of eq 9 defined in section 2 1 we assume values in an isotropic homogeneous confined aquifer of transmissivity t 0 01 m 2 day aquifer thickness b 10 m and injection rate q 1 m 3 day storativity values of 0 000002 0 0002 0 002 0 004 0 02 0 04 and 0 2 are assumed to illustrate various transient flow regimes the simulation domain was 30 m analytical results for hydraulic head obtained using the proposed analytical eq 9 are compared to the theis solution at a simulation time of 0 0628 days and thiem s steady state solution as shown in fig 2 the two align well in particular as storativity decreases the hydraulic head distribution approaches that of the steady state thiem solution 3 2 comparison of the proposed semi analytical solution for solute transport with numerical solutions to verify the proposed semi analytical solution against numerical solutions 2dfatmic was used to simulate two dimensional 2d flow and transport in a transient state a verification example was designed to describe solute transport in a radially divergent flow field with transient axisymmetric groundwater flow from an injection well in a homogeneous and isotropic confined aquifer system under conditions of both instantaneous and continuous tracer input at the injection well input parameters for the verification example are listed in table 1 for numerical simulation in 2dfatmic the input parameters for flow and transport as well as spatial and temporal discretization well information and initial and boundary conditions are shown in fig s1 and table s1 in the supplementary material as shown in fig 3 a analytical solutions for hydraulic head obtained using eq 9 aligned well with the numerical solutions from 2dfatmic at various times correspondingly as for groundwater flow the semi analytical solutions of solute concentration with continuous injection obtained using eq 21b were in accordance with the numerical solutions from 2dfatmic as shown in fig 3b thus we can confirm that the proposed semi analytical method provides correct solutions as shown in fig 3b contaminant concentrations around the injection well in the proposed and numerical models of 2dfatmic increased consistently over time due to the continuous injection of contaminants into the injection well in fig 3b the reason that the concentration peaks near the injection well in the proposed semi analytical solution are always higher than those of chen 1987 under the steady state flow can be explained by the temporal pattern of flow velocity around the well in transient flow the head near the well does not rise instantaneously unlike steady state flow but rises slowly over time to reach a steady state therefore in a transient flow at the early time the flow velocity near the well is always lower than the steady state flow until a steady state flow is reached thus under transient flow the peak of concentration around the well is higher than in steady state flow as shown in fig 3b similar to our results for continuous injection semi analytical solutions of solute concentrations for instantaneous injection were obtained using eq 21b and compared to the numerical solutions of 2dfatmic as shown in fig 4 this comparison indicates a very small difference between the analytical and numerical solutions around concentration peaks which might be due to numerical diffusion error in fig 4 as clean water is continuously injected after the contaminant mass is instantaneously injected from the injection well the clean water flowing into the injection well pushes the contaminant mass away from the injection well therefore the peak concentration moves away from the injection well over time in the numerical concentration distribution obtained from 2dfatmic the concentration peak moves away from the injection well over time in addition the semi analytical solutions and numerical solutions of 2dfatmic presented in figs 3a 3b and 4 were compared in tables 2 3 and 4 respectively by using normalized root mean square error nrmse values and l2 norm according to shaikh et al 2018 here the nrmse of head is defined as i 1 n h i h i 2 n h m a x n is the total number of data points hi is the semi analytical solution of head for the ith datum h i is the numerical solution of 2dfatmic for head at the ith datum and hmax is the maximum value of hi in addition the l2 norm provides average distance between analytical and numerical solutions average distance l2 norm between the proposed analytical values hana and the numerical values hnum over the spatial domain is defined as 1 l h n u m h a n a 1 l 0 l h n u m x t h a n a x t 2 d x 1 2 shaikh et al 2018 similarly the nrmse of concentration is defined as i 1 n c i c i 2 n c m a x ci is the semi analytical solution for concentration at the ith datum c i is the numerical solution of 2dfatmic for concentration at the ith datum and cmax is the maximum value of ci l2 norm of concentration is defined as 1 l c n u m c a n a 1 l 0 l c n u m x t c a n a x t 2 d x 1 2 where cana is the proposed semi analytical solution and cnum is the numerical solution of 2dfatmic the trapezoidal method is used for the calculation of the definite integral in l2 norm tables 2 3 and 4 show that the nrmse range is approximately 1 2 10 4 to 2 3 10 2 indicating that the differences between the new semi analytical solutions and numerical solutions obtained from 2dfatmic are very small l2 norms are in the range 3 79 10 4 1 33 the l2 norm error in table 4 looks large but corresponds to an error of about 1 relative to the peak concentration 4 results 4 1 comparison of the proposed semi analytical solution with previous analytical solutions based on the steady state thiem flow equation to analyze radial transport behavior through advection and dispersion in a radial flow field that diverges or converges in a transient state many researchers have previously applied divergent or convergent groundwater flow fields described by the simplified steady state thiem equation in advection dispersion equations in practice however determining whether flow has reached steady state conditions in the field is difficult accordingly the pseudo steady state condition is often assumed to represent steady state flow without caution in particular when determining the transport parameters in a tracer test through fitting of the theoretical breakthrough curve calculated under the assumption of steady state flow to field data as flow transients are common in the field errors may arise in the estimated transport parameters for practical reasons analysis of transport parameters while regarding the pseudo steady state flow condition as a true steady state flow condition has become customary as the long wait time required to achieve true steady state flow under field conditions would be expensive therefore in this study we investigated how transient flow affects transport behavior compared to steady state flow for this investigation the verification example described in section 3 1 was used to simulate radial dispersion in transient radially divergent flow from an injection well continuously injecting a concentration of 1 ppm in this example longitudinal dispersivity and porosity were assumed to be 1 m and 0 4 respectively the injection well radius was assumed to be zero and thus well mixing was not considered for steady state flow the analytical solution of chen 1987 was applied to obtain a concentration distribution with radial distance from the injection well at time t 0 0628 days results obtained using the analytical solution of chen 1987 were compared to those of the proposed semi analytical solution using various storage coefficients as shown in fig 5 in addition the numerical results of 2dfatmic were used to validate the proposed semi analytical solution under transient flow at various storage coefficients fig 5 the input parameters used for 2dfatmic are listed in table s1 of the supplementary material at storativity of less than 0 0002 the results of the analytical solution of chen 1987 and proposed semi analytical solutions showed strong agreement however as the storage coefficient increased the discrepancy between these methods expanded this result indicates that as the storage coefficient decreases flow approaches steady state thus the proposed semi analytical solution shows better agreement with the analytical solution of chen 1987 which describes solute transport in steady state radial flow conversely as the storage coefficient increases greater deviation from steady state occurs and the proposed semi analytical solution and numerical solution of 2dfatmic both diverge from the analytical solution of chen 1987 interestingly although the hydraulic head distribution at s 0 0002 has not yet reached steady state as shown in fig 2 the concentration distribution of the proposed semi analytical solution calculated using the flow velocity obtained from the hydraulic head distribution at s 0 0002 agrees well with that obtained using the analytical solution of chen 1987 for solute transport in steady state radial flow as shown in fig 5 in section 4 2 we provide a detailed discussion of the specific conditions under which good agreement can be achieved between concentration distributions obtained under steady state and transient flow to determine the extent to which transient flow affects the concentration distribution compared to steady state flow two examples are described in section 3 2 with a continuous source and instantaneous source these examples were used for comparison of the analytical solutions of chen 1987 and chen et al 2007 which are based on the steady state thiem equation with the proposed semi analytical method and the numerical solution obtained from 2dfatmic under transient flow as shown in figs 3b and 4 chen et al 2007 presented analytical solutions describing solute transport in a divergent flow tracer test with an instantaneous source while chen 1987 proposed an analytical solution for radial dispersion from the injection well with a continuous source as shown in figs 3b and 4 the analytical solutions of chen 1987 and chen et al 2007 which were developed using the steady state thiem equation showed significant discrepancies relative to the proposed semi analytical solutions and the numerical solution of 2dfatmic subsequently similar to our analysis of the effect of flow transiency on the spatially continuous concentration distribution the effect of transient flow on transport behavior in radially divergent flow was analyzed using the breakthrough curve for an observation point away from the injection well to obtain the breakthrough curve we assumed that the hydraulic conductivity of the aquifer is 8 64 10 3 m day corresponding to silty sand the thickness of the aquifer is 10 m porosity is 0 4 and the injection rate is 1 m3 day to achieve steady state flow a sufficiently small s 4 10 7 is used while s 0 28 is employed for simulating transient flow longitudinal dispersivities of α 0 025 0 05 0 1 0 25 0 5 0 75 and 1 m are assigned to represent various transport characteristics reflecting various peclet numbers finally the observation point is assumed to be located 5 m from the injection well under these conditions a continuous injection source with a concentration of 1 ppm and an instantaneous injection source with a mass of 78 5 g are separately applied at the injection well breakthrough curves of solute transport for the continuous injection source in the steady state were calculated for various longitudinal dispersivities using the analytical solution of chen 1987 while those for the instantaneous injection source were obtained for various longitudinal dispersivities using the analytical solution of chen et al 2007 similarly breakthrough curves were obtained for various longitudinal dispersivities using the proposed semi analytical solution with a sufficiently small value of s 4 10 7 and with s 0 28 for the continuous injection source the semi analytical solutions obtained using s 4 10 7 and s 0 28 were compared to the analytical solutions of chen 1987 as shown in fig 6 the proposed semi analytical solutions obtained with s 4 10 7 for all longitudinal dispersivities agree perfectly with those of chen 1987 on the other hand the proposed semi analytical solutions with the large value of s 0 28 for all longitudinal dispersivities show profound discrepancies with the results of chen 1987 as illustrated in fig 6 specifically as α r decreases these discrepancies tend to increase similarly for an instantaneous source the analytical solutions of chen et al 2007 were compared to the proposed semi analytical solutions with sufficiently small s 4 10 7 and s 0 28 as shown in fig 7 the proposed semi analytical solutions with s 4 10 7 for all longitudinal dispersivities aligned well with those of chen et al 2007 however the proposed semi analytical solutions with the large value of s 0 28 for all longitudinal dispersivities show profound discrepancies with the results of chen et al 2007 as shown in fig 7 similar to the case for a continuous source as α r shrinks the discrepancies tend to grow based on the aforementioned analytical studies of both instantaneous and continuous sources the effect of flow transients compared to steady state flows causes large discrepancies between breakthrough curves representing steady state and transient flows especially when α r is small these results suggest that the use of incorrect breakthrough curves obtained from previous analytical solutions including those of chen 1987 and chen et al 2007 based on the steady state flow assumption for determining parameters through curve fitting to field data obtained from tracer tests performed under conditions that deviate from steady state flow may lead to significant errors in the parameter estimates 4 2 influence of flow and solute transport parameters on the breakthrough curve and spatial concentration distribution to investigate the effects of flow parameter β and solute transport parameter α l on discrepancies between analytical solutions using the thiem equation and proposed semi analytical solution for transient flow various scenarios were designed by setting different ranges for the various parameters specifically to determine whether the proposed semi analytical solution is similar to the solutions of chen 1987 and chen et al 2007 in a given range of parameter values the similarity of the proposed semi analytical solution to the solutions of chen 1987 and chen et al 2007 was evaluated based on the ranges of various parameters to perform this analysis the characteristic values of various aquifer media from the available literature were summarized table 5 to determine a reasonable range for each parameter additionally assuming that the injection rates were 1 10 m 3 d a y β could be estimated from 0 003 to 5 000 here five or six values of β were chosen for each analysis as shown in table 6 values of 0 01 and 0 1 were selected for α l with the selected parameter values for β and α l the effects of β and α l on the spatial concentration distribution and breakthrough curve were assessed for a continuous injection source and instantaneous injection source for systematic analysis of the effects of various parameters several scenarios were assessed using the values of selected parameters listed in table 6 according to table 6 the effects of β and α l were analyzed based on discrepancies in the spatial concentration distribution or breakthrough curve between steady state and transient flow with a continuous injection source and instantaneous injection source respectively to increase the reliability of the proposed method we compared the results to the numerical solutions of 2dfatmic especially for β of 1 5 all input parameters of 2dfatmic are summarized in table s1 of the supplementary material fig 8 shows the effects of β on the spatial concentration distributions at two time points td 0 01 and 0 1 for two values of α l 0 01 and 0 1 with a continuous injection source as shown in fig 8 as β decreases the peak of the concentration distribution becomes higher while plumes migrate less in the flow direction small β indicates low transmissivity small aquifer thickness low porosity large storativity and a high injection rate while a large β has the opposite tendencies these trends are amplified as α l decreases as shown in fig 8b the differences between the semi analytical solutions and those of chen 1987 decrease with increasing β when α l is large these differences decrease further specifically we can determine a threshold of β above which the difference between the concentration distributions from the proposed semi analytical solution and those from chen 1987 s analytical solution are negligible i e within 1 in other words it is possible to determine a critical value of β with a well matched spatial concentration distribution under both steady and transient flow in the case of α l 0 1 the spatial concentration distributions under steady state and transient flow with β values above 15 and 8 nearly coincide at the times of td 0 01 and 0 1 as shown in in fig 8a while for α l 0 01 the spatial concentration distributions under steady state and transient flow with β values above 15 and 13 nearly coincide at td 0 01 and 0 1 as shown in in fig 8b according to fig 8 the concentration in the transient state is higher than in the steady state flow in particular the difference in concentration in the transient state and the steady state increases as the dispersivity decreases the reason can be explained by the fact that lower dispersivity cause less dispersion along the flow direction and more mass accumulation occurs which cause peak concentration more increase specially in the case of very small dispersivity α l such as less than 0 01 in this study the peak concentration can be increased to more than source concentration assuming that molecular diffusion is negligible to be zero however in real situation since the molecular diffusion is never zero peak concentration cannot exceed the source concentration similarly fig 9 shows the effects of α l on the spatial concentration distribution at two time points for each of five values of β with a continuous injection source as shown in fig 9 as α l increases the peak concentration decreases and plumes migrate farther in the flow direction this trend is subdued as β increases as shown in fig 9 the differences between the semi analytical solutions and those of chen 1987 decrease with increasing α l these differences decrease further with increasing β therefore the spatial concentration distribution obtained under transient flow approaches the concentration distribution under steady state flow as the transmissivity aquifer thickness porosity and longitudinal dispersivity increase but as the storativity and injection rate decrease in the same manner as the concentration distribution the effects of β on the breakthrough curve observed at the domain center with a continuous injection source were evaluated for two values of α l similar to the pattern shown in fig 8 fig 10 illustrates that decreasing β causes the peak of the breakthrough curve to become higher while plumes migrate more slowly in the flow direction similar to that shown in fig 8b this trend is amplified as α l decreases as shown in fig 10b the difference between the semi analytical solutions and those of chen 1987 are reduced with increasing β when α l is large this difference decreases further in accordance with the results presented above for the spatial concentration distributions in the cases of α l 0 1 and 0 01 the threshold values of β above which the difference between breakthrough curves obtained with the proposed semi analytical solution and that of chen 1987 are negligible i e within 1 are 6 and 14 respectively as shown in fig 10 similar to the results for the spatial concentration distribution presented in fig 9 fig 11 shows the effects of α l on the breakthrough curve observed at the domain center for each of five values of β with a continuous injection source as shown in fig 11 as α l increases the peak concentration decreases and plumes reach the observation point earlier similar to that shown in fig 9 this trend is subdued as β increases as shown in fig 11 the difference between the semi analytical solutions and those of chen 1987 decreases with increasing α l when β is large this difference decreases further accordingly as discussed above for the spatial concentration distribution in fig 9 we can conclude that the breakthrough curves obtained using the proposed semi analytical solutions for transient flow approached those obtained from chen 1987 s analytical solution under steady state flow when the transmissivity aquifer thickness porosity and longitudinal dispersivity are large but storativity and the injection rate are small in addition to the case with a continuous injection source the effects of β and α l on the spatial concentration distribution and breakthrough curve were assessed with an instantaneous injection source similar to our findings with a continuous injection source shown in fig 8 effects of β on the spatial concentration distribution at two time points td 0 01 and 0 1 are shown in fig s2 of the supplementary material for two values of α l 0 01 and 0 1 with an instantaneous injection source the characteristic behaviors of the concentration distribution depending on β and α l in fig s2 are similar to those in fig 8 specifically from fig s2 we can determine the threshold value of β above which the difference between the concentration distributions obtained from the proposed semi analytical solution and that of chen et al 2007 are negligible i e within 1 for α l 0 1 the thresholds of β are 150 and 60 at td 0 01 and 0 1 respectively while for α l 0 01 the thresholds of β are 150 and 125 at td 0 01 and 0 1 respectively similar to the results obtained with a continuous injection source shown in fig 9 the effects of α l on the spatial concentration distribution at two time points are shown in fig s3 of the supplementary material for each of five values of β with an instantaneous injection source according to the characteristic concentration distributions as β and α l as α l increase the concentration peak shrinks and plumes migrate farther in the flow direction this trend is subdued as β increases as shown in fig s3 of the supplementary material moreover the difference between the semi analytical solutions and those of chen et al 2007 decreases with increasing α l this difference shrinks further with increasing β similar inferences can be made from the characteristic concentration distribution with a continuous injection source as shown in fig 9 lastly the effects of β and α l on the breakthrough curve observed at the domain center with an instantaneous injection source were evaluated the effects of β and α l on the breakthrough curve for an instantaneous injection source are shown in fig s4 of the supplementary material which are similar to the results obtained for a continuous injection source as shown in fig 10 for α l 0 1 and 0 01 the thresholds of β above which the difference in the breakthrough curves between the proposed semi analytical solution and that of chen et al 2007 s is negligible within 1 are 90 and 150 respectively as shown in fig s4 of the supplementary material finally the effects of α l on the breakthrough curve observed at the domain center are shown in fig s5 of the supplementary material for five values of β with an instantaneous injection source the characteristic behaviors of the breakthrough curve related to β and α l with an instantaneous injection source are similar to those with a continuous injection source as shown in fig 11 these results regarding the influences of various parameters on the discrepancies between existing analytical solutions based on the thiem equation and the proposed semi analytical solution considering transient flow shown in figs 8 11 and figs s2 s5 of the supplementary material indicate that for both continuous and instantaneous injection sources the spatial concentration distribution and breakthrough curve obtained from the proposed semi analytical solutions with transient flow approach those obtained using the solutions of chen 1987 and chen et al 2007 with steady flow as the transmissivity aquifer thickness porosity and longitudinal dispersivity increase but as storativity and the injection rate decrease i e as both β and α l become larger 4 3 model application any data of tracer test in a transient divergent radial flow is not available and not existed in previous literatures since typical standard tracer test has been performed until now hoehn and roberts 1982 welty and gelhar 1994 novakowski 1992 chen et al 2007 ptak et al 2004 gutierrez et al 2013 as an alternative to new tracer test under a transient radial flow we found out previous field data obtained through the typical standard tracer test in literatures hoehn and roberts 1982 and we applied to estimate aquifer dispersivity using the new analytical solution proposed in this study a diverging radial flow tracer test for the assessment of aquifer dispersivity was performed in a sand and gravel aquifer over a 1 2m depth in palo alto baylands california hoehn and roberts 1982 a constant flow rate of 2 5 m3 hour was applied in this tracer test to establish divergent flow field hoehn and roberts 1982 after the flow field reached a steady state condition a slug of tracer mass 3h was instantaneously introduced into an injection well and tracer s concentration data were collected at an observation well located at 16 8 m from the injection well the average hydraulic conductivity was estimated to be 0 4 m hour and the effective porosity was measured as 0 22 in a core sample the small storage coefficient of 1ⅹ10 5 was estimated welty and gelhar 1994 and chen et al 2007 used this field data and estimated aquifer dispersivity by a curve matching technique using their proposed developed analytical solutions for estimation of aquifer dispersivity dimensionless type curves are useful welty and gelhar 1994 chen et al 2007 the dimensionless type curves are prepared by plotting normalized concentration c cpeak against dimensionless time t tm on logarithmic paper where cpeak is the peak concentration of the breakthrough curve tm πbθr 2 q and r is distance to the observation point from the injection well the parameter estimation employs the curve matching technique where the dimensionless breakthrough curves are prepared using the proposed semi analytical solution following procedure of welty and gelhar 1994 and chen et al 2007 for estimating the dispersivity we employed curve matching technique to estimate the dispersivity for the curve matching technique we prepared dimensionless breakthrough curves plotted in log log scale using our proposed semi analytical solutions on the curve matching technique the field data plotted on log log paper is superimposed on the calculated breakthrough curves with the axes sets kept parallel so that the most field data match calculated breakthrough curve in this study the value of longitudinal dispersivity is determined with 0 233 m that match most field data as shown in fig 12 this estimated dispersivity value is same as that determined in chen et al 2007 also the root mean square error between the proposed breakthrough data and the measured data was small to be 0 129 5 discussion through comparison of the proposed semi analytical solution with the existing analytical solutions of chen 1987 and chen et al 2007 as described in section 4 we determined that under specific conditions of β and α l the concentration distribution and breakthrough curve obtained from the proposed semi analytical solutions for transient groundwater flow deviated from those obtained from existing analytical solutions that assume steady groundwater flow with continuous and instantaneous injection sources respectively we determined that above certain threshold values of β the differences between the concentration distribution or breakthrough curve obtained from the proposed semi analytical solution and those resulting from existing analytical solutions are negligible i e within 1 here for the spatial concentration distribution the thresholds of β decrease as dimensionless time and α l increase as shown in figs 8 and s2 of the supplementary material regardless of the injection source type for the breakthrough curve the thresholds of β decrease as α l increases as shown in figs 10 and s4 of the supplementary material regardless of the injection source type furthermore regardless of the spatial concentration distribution and breakthrough curve an instantaneous injection source has larger thresholds of β than a continuous injection source as shown in figs 8 10 s2 and s4 in the supplementary material specifically for a continuous injection source the thresholds of β are 6 to 15 at the dimensionless time points and α l values considered in this study but increase to 60 and 150 respectively for an instantaneous injection source at the same dimensionless time points and α l values accordingly we can infer that it is more difficult for an instantaneous injection source to reach the condition where the difference in the concentration distribution or breakthrough curve between the proposed semi analytical and existing analytical solutions are negligible i e within 1 than for a continuous injection source given the same aquifer properties such as transmissivity aquifer thickness porosity and storativity and transport parameters such as longitudinal dispersivity based on these findings we can conclude that tracer tests conducted under the conditions of β and α l described above can reasonably use existing analytical solutions for curve fitting during parameter estimation rather than the proposed semi analytical solution in other cases parameter values should be estimated carefully with existing analytical solutions to ensure accurate values are selected in such cases the proposed semi analytical solution may be a better alternative for fitting field breakthrough curve data than existing analytical solutions especially when transient effects are significant notably although the difference between the proposed semi analytical solution and existing analytical solutions decreases with increasing values of both β and α l regardless of source type crucial differences were observed between the effects of β and α l on the similarity of the proposed semi analytical solution to existing analytical solutions when β is sufficiently large the proposed semi analytical solution and existing solutions provided nearly identical results regardless of α l however no matter how large α l becomes a discernable difference remains between the semi analytical solution and existing analytical solutions when β is not sufficiently large summarizing the limitations and advantages of this study this study is limited to analysis of a constant injection rate that is temporally varying injection rates are not considered moreover the injection well is assumed to fully penetrate a horizontal homogeneous and isotropic confined aquifer of constant thickness accordingly heterogeneous and anisotropic aquifers and partial penetrating wells cannot be considered in this study a further limitation is that we do not account for skin effects around the well or the effects of mixing within the injection well on the other hand a major strength of this study is that the proposed semi analytical method can consider spatially and temporally varying radial flow induced by an injection well at a constant rate while previous studies have considered only steady state groundwater flow using thiem s solution as eq 9 describing transient flow is analytically solved using the fourier series expansion for space and the eigenfunction of the helmholtz equation for time to obtain an analytical expression of head as a function of time and radial distance the corresponding velocity can be obtained using darcy s law and then directly applied to the velocity and dispersion coefficient terms in the transport equation ultimately a semi analytical solution for the derived transport equation is obtained using gitt our semi analytical solution better explains the effects of transient features of radial flow induced by injection at a constant rate on the concentration distribution or breakthrough curve than previous methods previous analytical studies could not consider such transient features of radial flow finally the proposed semi analytical solution is an important tool for developing new tracer tests where time efficiency is important as an alternative to traditional tracer testing in the traditional tracer test prior to introducing the tracer into the injection well a period of a few hours to a few days is needed depending on the aquifer properties and injection rate before establishment of a steady horizontal and radially divergent flow field can be assumed in contrast without waiting for the slow establishment of a steady horizontal and radially divergent flow field a new tracer test method could be developed wherein the tracer is injected simultaneous with the start of injection using the proposed semi analytical solution for curve fitting during parameter estimation moreover as the new method would not require steady state flow conditions for estimation of transport parameters no error in the breakthrough curve would be caused by transient flow effects 6 summary and conclusion a new semi analytical solution to the radial advection dispersion equation in cylindrical coordinates for solute transport during transient divergent radial flow was derived for continuous and instantaneous injection inputs into the injection well using the gitt method the main findings of this study are as follows the novelty of this study is the adoption of a new analytical solution for hydraulic head describing both spatially and temporally varying radial flow induced by an injection well rather than thiem s solution the corresponding velocity can be obtained using darcy s law and then directly used for the velocity and dispersion coefficient terms in the transport equation ultimately the semi analytical solution of the derived transport equation described above is obtained using gitt to account for the effect of transient radial flow features induced by the injection well at a constant rate on the concentration distribution or breakthrough curve an analytical solution to the transient groundwater flow equation was obtained by expanding the generalized fourier series using the eigenfunction of a homogeneous helmholtz equation and assuming orthogonality of eigenfunctions here the main difference between the derived analytical solution of eq 9 and theis solution is that eq 9 is separable in space and time while theis solution is not the solution derived in eq 9 is expressed as a separable form for space and time to better suit application to gitt in terms of mathematical manipulation verification of the proposed analytical solution for hydraulic head was performed through comparison with theis analytical solution and thiem s steady state solution while the spatial concentration distributions and breakthrough curves obtained from the new semi analytical solution were verified through comparison with the numerical solutions of 2dfatmic and analytical solutions of chen 1987 and chen et al 2007 depending on the aquifer flow properties solute transport parameters and injection rate selected profound discrepancies or perfect agreement between the spatial concentration distribution and breakthrough curve between existing analytical solutions and the proposed semi analytical solution were obtained as described in sections 3 and 4 in particular investigation of the influences of flow and solute transport parameters on the spatial concentration distribution and breakthrough curve described in section 4 showed that as the dimensionless parameters β and α l increase the spatial concentration distribution and breakthrough curve under transient flow approach those under steady flow meanwhile as β and α l decrease larger discrepancies arise furthermore regardless of the spatial concentration distribution and breakthrough curve the thresholds of β for an instantaneous injection source are larger than the corresponding values for a continuous injection source as shown in figs 8 10 s2 and s4 in the supplementary material specifically for a continuous injection source the thresholds of β are 6 15 at the dimensionless time points and α l values considered in this study while these thresholds are 60 150 for an instantaneous injection source at the same dimensionless time points and α l values the major advantage of our method is allowing for simulation of solute transport in new tracer test where tracer mass injection can be performed simultaneously with the start of water injection into the injection well without waiting for establishment of steady horizontal and radially divergent flow accordingly it can support the development of new tracer testing methods that are more effective in terms of time and cost than traditional tracer tests that require long wait times a few hours to a few days to achieve steady horizontal and radially divergent flow moreover our method could serve as a benchmark for testing numerical solutions credit author statement heejun suk conceptualization methodology software roles writing original draft funding acquisition visualization jui sheng chen conceptualization methodology validation weon shik han writing review editing formal analysis eungyu park supervision formal analysis declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the basic research project 22 3411 of the korea institute of geoscience and mineral resources kigam funded by the ministry of science and ict supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2022 104283 appendix e supplementary materials image application 1 image application 2 appendix a detailed derivation of the analytical solution to groundwater flow under transient flow conditions here the following homogeneous helmholtz equation is solved to obtain an eigenfunction set a1 d 2 ψ r d d r d 2 1 r d d ψ r d d r d λ 2 ψ r d 0 with the following boundary condition a2 ψ 1 0 where λ and ψ rd are the eigenvalue and corresponding eigenfunction respectively the helmholtz equation expressed in eq a1 with the boundary condition a2 and continuous bounded condition of hydraulic head at the injection well has the following eigenvalue eigenfunction and norm a3 λ n μ n ψ n r d j 0 μ n r d n n 1 2 j 1 2 μ n where j 0 and j 1 are the bessel functions of the first kind with order zero and order one respectively and μ n is the nth zero value of j 0 the forward transform and corresponding inverse transform can now be constructed using the eigenfunctions e n t d 1 n n 0 1 r d ψ n r d h d r d t d d r d 1 n n 0 1 r d j 0 μ n r d h d r d t d d r d a4a n 1 2 a4b h d r d t d n 1 ψ n r d e n t d n 1 j 0 μ n r d e n t d n 1 m f j 0 μ n r d e n t d where mf is set to a value sufficiently large to produce the desired level of accuracy for hydraulic head by substituting eqs a1 a3 and a4b into eq 6 eq 6 can be rewritten as follows a5 n 1 m f ψ n r d d e n t d d t d β n 1 m f μ n 2 ψ n r d e n t d δ r d 1 2 r d θ s to derive en td n 1 2 mf we apply the operator 0 1 r d ψ m r d d r d to eq a5 and use ψm 0 j 0 0 1 with the following orthogonality conditions a6 ψ m ψ n 0 1 r d ψ m r d ψ n r d d r d 0 m n n m m n then eq a5 can be rewritten as eq a7 a7 d e m t d d t d β μ m 2 e m t d θ 2 s 1 n m eq a7 is then solved using e m 0 1 n m 0 1 r d j 0 μ m r d h d r d t d 0 d r d 0 a8 e m t d θ 2 s 1 n m 1 β μ m 2 1 exp β μ m 2 t d from eq a4b hd rd td can be obtained using eq a8 as follows a9 h d r d t d n 1 m f θ 2 s 1 n n 1 β μ n 2 j 0 μ n r d 1 exp β μ n 2 t d appendix b detailed procedure of obtaining t t d in gitt to derive tn td n 1 2 mt we apply the operator 0 1 r d φ m r d d r d to eq 15a as 0 1 r d j 0 μ m r d c d t d d r d 0 1 r d j 0 μ m r d 1 r d r d r d d r d t d c d r d d r d 0 1 r d j 0 μ m r d 1 r d r d r d v r d t d c d d r d 0 1 r d j 0 μ m r d q d d r d b1 m 1 2 m t by applying the green theorem eq b1 can be written as follows 0 1 r d j 0 μ m r d c d t d d r d j 0 μ m r d r d d r d t d c d r d 0 1 0 1 j 0 μ m r d r d d r d t d c d r d d r d j 0 μ m r d r d v r d t d c d 0 1 0 1 j 0 μ m r d r d v r d t d c d d r d 0 1 r d j 0 μ m r d q d d r d b2 m 1 2 m t as j 0 μ m 0 eq b2 can be rewritten as follows 0 1 r d j 0 μ m r d c d t d d r d 0 1 j 0 μ m r d r d d r d t d c d r d d r d 0 1 j 0 μ m r d r d v r d t d c d d r d 0 1 r d j 0 μ m r d q d d r d b3 m 1 2 m t the inverse transform of eq 20b is substituted into eq b3 as follows n 1 m t 0 1 r d j 0 μ m r d j 0 μ n r d d r d d t n t d d t d n 1 m t 0 1 j 0 μ m r d r d d r d t d j 0 μ n r d d r d t n t d n 1 m t 0 1 j 0 μ m r d r d v r d t d j 0 μ n r d d r d t n t d 0 1 r d j 0 μ m r d q d d r d b4 m 1 2 m t j 0 μ n r d μ n j 1 μ n r d is then applied and v r d t d and d r d t d of eqs 15b and 15c respectively are substituted into eq b4 n 1 m t 0 1 r d j 0 μ m r d j 0 μ n r d d r d d t n t d d t d α l r n 1 m t k 1 m f μ m μ n j 1 2 μ k μ k 0 1 r d j 1 μ m r d j 1 μ n r d j 1 μ k r d d r d 1 e x p β μ k 2 t d t n t d 1 r n 1 m t k 1 m f μ m j 1 2 μ k μ k 0 1 r d j 1 μ m r d j 0 μ n r d j 1 μ k r d d r d 1 exp β μ k 2 t d t n t d 0 1 r d j 0 μ m r d q d d r d b5 m 1 2 m t then an orthogonality condition is applied to eq b5 n m d t m t d d t d α l r n 1 m t k 1 m f μ m μ n j 1 2 μ k μ k 0 1 r d j 1 μ m r d j 1 μ n r d j 1 μ k r d d r d 1 e x p β μ k 2 t d t n t d 1 r n 1 m t k 1 m f μ m j 1 2 μ k μ k 0 1 r d j 1 μ m r d j 0 μ n r d j 1 μ k r d d r d 1 exp β μ k 2 t d t n t d 0 1 r d j 0 μ m r d q d d r d b6 m 1 2 m t where nm is m th norm if we rearrange eq b6 then eq b6 can be shortened to yield the following denumerable system of coupled linear ordinary differential equations in terms of time b7 d t m t d d t d n 1 m t a m n t d t n t d f m t d m 1 2 m t where a m n t d α l r μ m μ n n m k 1 m f 1 j 1 2 μ k μ k 0 1 r d j 1 μ m r d j 1 μ n r d j 1 μ k r d d r d 1 exp β μ k 2 t d b8a 1 r μ m n m k 1 m f 1 j 1 2 μ k μ k 0 1 r d j 1 μ m r d j 0 μ n r d j 1 μ k r d d r d 1 exp β μ k 2 t d b8b f m t d 1 2 r 1 n m for continuous injection 1 2 r 1 n m δ t d for instantaneous injection here mf is set to a value sufficiently large to produce accurate velocity and dispersion coefficients and may differ from mt equation b8a can be rewritten as follows b9 a m n t d k 1 m f b m n k b k t d where b10a b m n k 1 r 1 n m 1 j 1 2 μ k μ k α l μ m μ n 0 1 r d j 1 μ m r d j 1 μ n r d j 1 μ k r d d r d μ m 0 1 r d j 1 μ m r d j 0 μ n r d j 1 μ k r d d r d b10b b k t d 1 exp β μ k 2 t d in this case the solution is derived according to linear system theory rugh 1996 the analytical solution for tm td becomes b11 t t d exp 0 t d a σ d σ t 0 0 t d exp τ t d a σ d σ f τ d τ where b12 t m 0 1 n m 0 1 r d j 0 μ m r d c d r d t d 0 d r d m 1 2 m t in eq b11 a σ d σ can be calculated using the properties of the constant matrix b as follows b13a a σ d σ b b σ d σ b b σ where b13b b k σ σ 1 β μ k 2 exp β μ k 2 σ substituting eq b13a into eq b11 eq b11 can be rewritten as follows b14 t t d exp b b t d b 0 t 0 0 t d exp b b t d b τ f τ d τ here the integrals of the triple products of the bessel functions in eq b10a were determined using the integral function in matlab 7 which employs adaptive quadrature to calculate the exponential matrix in eq b14 the built in function expm in matlab 7 was used which follows method 3 of moler and van loan moler and van loan 1978 to calculate the integral of the second term on the right hand side of eq b14 quadv was employed in matlab 7 which uses recursive adaptive simpson quadrature notably matrix a depends on flow parameters related to β and solute transport parameters associated with r and α l on the other hand the integrals of the triple product of the bessel functions within eq b10a were not related to any flow or transport parameters after the integrals of the triple product of the bessel functions are calculated through numerical integration with sufficient numbers of mf and mt values those products need not be calculated again to solve other problems involving various β r and α l values thus the computational burden of calculating matrix b can be reduced greatly allowing the proposed semi analytical solution to achieve reasonable computational efficiency appendix c supplementary data supplementary material related to this article can be found in the attached file supplementary file docx appendix d source code matlab file source code related to this article can be found in the attached file source code m 
108,reactive transport rt through heterogeneous media may cause chemical heterogeneity if water flux is slow through portions of the medium in such cases chemical localization i e the occurrence of reactions that would not occur in well mixed media may develop which is especially relevant for biochemical reactions occurring in biofilms the objective of this work is to study the conditions for chemical localization we represent the impact of heterogeneity by means of the non local multirate mass transfer mrmt model which views the porous media as consisting of one mobile and many immobile zones a dimensional analysis of the governing equations shows that the problem is characterized by reaction times and the distribution of residence times in immobile zones relative to transport time to analyze the interplay between them we simulated simple rt problems in multicontinuum media results indicate that immobile zones with residence times much smaller than transport can be lumped together with the mobile zone by modifying the reaction rates which reduces computations more importantly reactions driven by species that are not present in the inflowing water but are the result of previous reactions will take place preferentially in immobile zones whose residence time is comparable to or larger than reaction times in fact daughter species may take a long time and distance to build up that is daughter species will not be largest near the inflow where parent species display largest concentrations but further downstream at isolated long residence times immobile zones keywords chemical localization multirate mass transfer reactive transport multicontinuum media numerical modeling nomenclature α mass transfer rate t 1 f α probability density function of mass transfer rates τα 1 α residence time t p τα probability density function of residence times α0 scale parameter of f α τ α 0 scale parameter of p τα β shape parameter of f α and p τα γ β gamma function cm concentrations in the mobile zone ml 3 cim concentrations in the immobile zones ml 3 ϕ m porosity of mobile zone ϕ im porosity of immobile zones q darcy flux lt 1 d hydrodynamic dispersion l2t 1 rm sink source term due to chemical reactions in the mobile zone ml 3t 1 rim sink source term in the immobile zones ml 3t 1 km reaction rate constant in the mobile zone t 1 kim τα local reaction rate constant in the immobile zone with τα t 1 τ r 1 kim τα reaction time in the immobile zone with τα t g t memory function κ t reaction rate kernel δ t dirac delta function lc characteristic length l tc characteristic time t cc characteristic concentration ml 3 q modulus of q lt 1 d longitudinal component of d l2t 1 v q ϕ m mean fluid velocity in mobile zone lt 1 cmd dimensionless concentrations in mobile zone cmd cm cc cimd dimensionless concentrations in immobile zones cimd cim cc xd dimensionless distance xd x lc td dimensionless time td t tc η ratio of total immobile to mobile porosity η ϕ im ϕ m ταd dimensionless residence time ταd τα tc τ rd dimensionless reaction time τ rd τ r tc ce concentration of the inflowing water ml 3 c m 1 p mobile concentration in the first node for the pulse injection ml 3 l travel distance of solute l ta advective transport time t ϕ ϕ m ϕ im total porosity l s laplace transform s complex laplace variable 1 introduction reactive transport rt in porous media is essential for understanding environmental processes such as the fate of contaminants in aquifers and for a proper design and management of remediation strategies such as managed aquifer recharge e g valhondo et al 2020 or co2 geological storage e g agrawal et al 2021 carrera et al 2022 argue that the basic problem of rt is how to address the chemical and physical heterogeneity of natural media physical heterogeneity has received broad attention in the transport literature it is well known that transport in heterogeneous porous media displays anomalous non fickian behavior kitanidis 1988 both at field adams and gelhar 1992 and laboratory scales berkowitz and scher 2009 levy and berkowitz 2003 valocchi 1985 displaying early arrivals long tails and scale dependent dispersion coefficients carrera 1993 the problem is especially relevant for reactive transport because numerous reactions depend on local scale mixing to overcome this problem researchers have focused on small scale simulations in an attempt to simulate heterogeneity explicitly e g cirpka et al 2015 or even by pore scale simulations e g agrawal et al 2021 beyond the cost of such simulations what emerges is that upscaling parameters does not suffice but the transport equation may have to change and the advection dispersion reaction equation adre cannot be considered suitable for reactive transport carrera et al 2022 molins and knabner 2019 soler sagarra et al 2022 many non local methods have been developed to address the need for an alternative transport equation these include continuous time random walks ctrw berkowitz et al 2006 berkowitz and scher 1998 dentz et al 2015 2004 fractional advection dispersion equations fade benson et al 2000 benson and meerschaert 2009 marseguerra and zoia 2008 schumer et al 2003a 2003b multirate mass transfer mrmt babey et al 2017 benson and meerschaert 2009 dentz et al 2011 fernandez garcia and sanchez vila 2015 haggerty and gorelick 1995 salamon et al 2006 wang et al 2005 multiple interacting continua minc de dreuzy et al 2013 pruess and narasimhan 1985 structured interacting continua sinc babey et al 2015 rapaport et al 2017 memory functions carrera et al 1998 gouze et al 2008 haggerty et al 2000 willmann et al 2008 and so forth although these methods use different approaches they are essentially equivalent dentz and berkowitz 2003 neuman and tartakovsky 2009 silva et al 2009 unfortunately their solution is often based on laplace transform methods which makes them poorly suited for multicomponent and or non linear rt therefore most work on non local methods deals with the behavior of breakthrough curves btcs and conservative transport in heterogeneous porous media berkowitz and scher 2009 dentz et al 2015 haggerty et al 2000 schumer et al 2003b willmann et al 2008 still mrmt which can be considered the simplest paradigm of non local transport methods can be used for multicomponent rt the medium is viewed as consisting of a mobile and several overlapping immobile zones each of these zones can be modeled numerically which facilitates general rt simulation babaei and islam 2018 massoudieh and dentz 2020 soler sagarra et al 2016 willmann et al 2010 chemical heterogeneity has received a lot less attention than physical heterogeneity chemical heterogeneity may refer to large scale variability usually known from geological understanding or to pore scale variability portions of the porous media grain aggregates or individual grains or portion of grains can have different mineral compositions leading to different reaction rates and different concentrations at different parts of the pore space furthermore pore scale variability causes water fluxes to be spatially variable which causes dispersion and affects solute transport areas with low water flux may develop chemical conditions different from those of high flux which carry most of the water fig 1 in fact reacting surface tend to be larger in low flux than in high flux areas that is physical heterogeneity may induce chemical heterogeneity steefel et al 2005 call microenvironments these parts of the domain we term the phenomenon chemical localization to emphasize the local occurrence of reactions furthermore heterogeneity can cause chemical localization i e the occurrence of reactions that would not occur in well mixed media the importance of chemical localization has been widely recognized in the literature the discrepancy between measured mineral dissolution rates in laboratory and field is attributed to heterogeneity li et al 2008 modeling studies sometimes combined with chemical and geophysical datasets have shown the effect of heterogeneity on many particular systems such as bioremediation of contaminated aquifers scheibe et al 2006 reactive transport processes in fractures deng and spycher 2019 and mineral precipitation and dissolution in caprocks for co2 storage tian et al 2019 a clear example of chemical localization is presented by luquot et al 2016 who observed carbonate precipitation during injection of acidic co2 brine into a shale core which would not be possible if the acidic conditions associated to co2 injection prevailed throughout the domain soler sagarra et al 2016 showed that silicates weathering may cause sufficient alkalinity to facilitate carbonate precipitation in areas of low water flux a similar situation may occur for biochemical reactions which take place in biofilms biofilm growth generates immobile zones with limited access to electron acceptors which facilitates the occurrence of reducing conditions bellin et al 2014 the net result is that the microbial community is heterogeneous and reactions that would only occur under anaerobic conditions take place despite the overall aerobic water flux in analyzing this problem dentz et al 2011 concluded that transport under physical and chemical heterogeneity cannot be upscaled separately upscaling reactions depends on physical heterogeneity and upscaling transport is affected by chemical heterogeneity a similar conclusion was reached by battiato et al 2009 furthermore macroscale transport may be determined by microscale transport process in immobile zones gouze et al 2008 the situation cannot be considered satisfactory on the one hand chemical localization is frequently observed and we conjecture that its importance will increase with the need to simulate biochemical rt carrera et al 2022 yet it is not clear how to upscale the processes what is clear is that a multicontinuum representation is needed to be able to host and represent different chemical environments in fact lichtner and kang 2007 adopted a lattice boltzmann solution method with this goal we contend that a mrmt representation can reach the same goal at a much lower cost still the problem has never been analyzed formally so that numerous questions need to be answered regarding the conditions for localization and when does it need to be modeled the objective of this work is to study the conditions for localization of reactions in mrmt rt formulations to do so first we establish the governing equations of reactive transport in multicontinuum media and deduce a dimensionless form of these equations we then use the resulting model in two simple cases to analyze the conditions for localization 2 methodology we model reactive transport in heterogeneous porous medium using the mrmt approach haggerty and gorelick 1995 every point representative elementary volume is viewed as consisting of a mobile zone and a distribution of immobile zones characterized by their residence times each immobile zone exchanges solute mass with the mobile zone proportionally to the mass transfer rate α t 1 a complete description of variables employed in this paper is given in the nomenclature therefore it is natural to characterize this distribution by a probability density function pdf of mass transfer rates f α see fig 2 left to facilitate comparison to other non local methods we also characterize immobile zones by the distribution p τα of residence times τα 1 α t haggerty et al 2004 see fig 2 right p τα is given by dentz et al 2015 2011 dentz and berkowitz 2003 1 p τ α τ α 2 f α τ α 0 β γ β 1 τ α β 1 e τ α 0 τ α where β is the shape parameter τ α 0 is the scale parameter and γ β is the gamma function the residence time probability p τα dτα is the immobile zones frequency with residence times in the interval τα τα dτα obviously it satisfies the condition 0 p τ α d τ α 1 2 1 governing equations the transport of any reactive species in a medium that consists of a mobile continuum and multiple immobile continua can be expressed as dentz et al 2011 donado et al 2009 willmann et al 2010 2 ϕ m c m t l t c m ϕ i m 0 1 τ α p τ α c m x t c i m x τ α t d τ α ϕ m r m where lt cm q cm ϕ m d cm is the transport operator that describes advection and dispersion q lt 1 is darcy flux d l2t 1 is the hydrodynamic dispersion tensor ϕ m and ϕ im are the porosities of mobile and immobile zones which denote the volume fraction of mobile pore and immobile pore water over the bulk volume respectively cm ml 3 and cim ml 3 are concentrations in the mobile and immobile zone which are expressed as mass per unit volume of mobile and immobile water respectively rm ml 3t 1 is the sink source term due to chemical reactions in the mobile zone and corresponds to the mass removed by reactions in the mobile zone per unit volume of mobile water per unit time it should be noted that eq 2 remains valid for sorbing solutes in which case ϕ m and ϕ im are the storage capacity porosity times local retardation coefficient of mobile and immobile zones respectively mass balance in each immobile zone is given by 3 c i m x τ α t t 1 τ α c m x t c i m x τ α t r i m x τ α t where rim ml 3t 1 is the reactions sink source term in the immobile zone with residence time τα which corresponds to the mass removed by reactions in the immobile zone per unit volume of immobile water per unit time mass exchange between mobile and immobile zones is modeled by a first order mass transfer term represented by the continuous variable τα and characterized by a distribution density function p τα for the immobile zones thus the total mass exchange is the weighted sum over all immobile zones as expressed in the integral term of eq 2 integrating eq 3 with weight p τα over τα multiplying by ϕ im and substituting it into eq 2 yields the total solute mass balance 4 ϕ m c m x t t ϕ i m 0 p τ α c i m x τ α t t d τ α l t c m x t r x t in which r is the total reaction rate now per unit volume of bulk porous medium that integrates reactions in both mobile and immobile zones i e 5 r x t ϕ m r m x t ϕ i m 0 p τ α r i m x τ α t d τ α if the reaction follows first order kinetics the reaction rate in the mobile zone will be 6 r m x t k m c m x t where km t 1 is the reaction rate constant similarly the local reaction rate in the τα immobile zone becomes 7 r i m x τ α t k i m τ α c i m x τ α t where kim τα t 1 is the local reaction rate constant the reaction time τ r 1 kim τα t is assumed to depend on the immobile zone this dependence should be understood as indicating that as suggested by fig 1 different reactions with different reaction rates may occur in different immobile zones by inserting eq 7 into eq 3 then solving eq 3 we obtain the concentration in the immobile zone of τα as a function of mobile concentration history 8 c i m x τ α t c i m x τ α t 0 e 1 τ α 1 τ r t 0 t φ t t c m x t d t where φ t is given by 9 φ t 1 τ α e 1 τ α 1 τ r t assuming that the initial concentration in the immobile zones is zero i e cim x τα t 0 0 then by substituting eq 8 into eq 2 and rearranging terms we obtain the total solute mass balance as a sole function of cm 10 ϕ m c m x t t ϕ i m t 0 t g t t c m x t d t l t c m x t 0 t κ t t c m x t d t where the memory function carrera et al 1998 haggerty et al 2000 and reaction rate kernel dentz et al 2011 are given by 11 g t 0 p τ α φ t d τ α and 12 κ t ϕ m x 1 τ r m δ t ϕ i m x 0 1 τ r p τ α φ t d τ α respectively in which δ t is the dirac delta function the memory function can be viewed as the rate of change of concentration in the immobile zone that is caused by a unit change of concentration in the mobile zone at initial time t 0 in the presence of reactions the memory function not only incorporates the distribution of local mass transfer rates but also the distribution of local reaction rates similarly the reaction rate kernel represents the local reactions in immobile zones it integrates the reactions in both mobile and immobile zones and accounts for the mass transfer between mobile and immobile zones although the memory function is mainly controlled by the distribution of residence times in immobile zones it is also affected by the local reaction times in immobile zones through φ t eq 9 likewise the reaction rate kernel is mainly controlled by the chemical reactions but it is also affected by the distribution of residence times in immobile zones clearly the governing equations of reactive transport under physical and chemical heterogeneity 10 11 and 12 are controlled by the distribution of residence times and reaction times in immobile zones simultaneously the physical and chemical heterogeneities interact with each other and together they govern reactive transport dentz et al 2011 2 2 dimensionless formulations we write the dimensionless form of eqs 10 11 and 12 using the definitions of carrera et al 2022 which allows us to avoid the need for a peclet number so that all characteristic variables will be those describing the immobile zones distribution and reaction rates thus we define the characteristic length 13 l c ϕ m d q where q is the modulus of q and d is any norm of d here its longitudinal component and the characteristic transport time 14 t c l c v ϕ m 2 d q 2 note that in 1d the characteristic length equals the longitudinal dispersivity α l if molecular diffusion is neglected in the mobile zone because dispersion becomes d α l v where v q ϕ m is the mean fluid velocity in the mobile zone using these definitions to write all variables in dimensionless form i e td t tc ταd τα tc xd x lc cmd cm cc etc and defining η ϕ im ϕ m see the nomenclature table at the end for the definition of all variables and substituting them into eq 10 leads after some tedious but conventional algebra to the dimensionless form of the governing equations 15 c m d t d η t d 0 t d g t d t d c m d t d d t d d c m d d 2 c m d 0 t d κ t d t d c m d t d d t d note that in this dimensionless formulations the physical and chemical heterogeneity are represented by the distribution of residence and reaction times relative to the characteristic transport time tc and they are reflected simultaneously in the memory function and reaction rate kernel obviously in the situation where the characteristic length lc and the dimensionless ratio of porosity of immobile zone to porosity of mobile zone η are invariable the solution of eq 15 is governed by two characteristic dimensionless times the dimensionless residence time ταd and its distribution and the dimensionless reaction time τ rd in immobile zones the solution of governing eq 15 in laplace domain is expressed as 16 l c m d s e x p x d 2 1 1 4 s 1 η l g s l κ s where l s represents the laplace transform of a function the laplace transform of the memory function and reaction rate kernel are defined as 17 l g s 0 p τ α d l φ s d τ α d and 18 l κ s 1 τ r m d η 0 1 τ r d p τ α d l φ s d τ α d in which the laplace transform of φ td is given by 19 l φ s 1 τ α d τ α d τ r d τ α d τ r d s if we substitute s for s 1 η l g s l κ s in eq 16 then eq 16 becomes the solution of the transport equation in homogeneous media obviously the retardation of localized physical heterogeneity on transport is reflected in the term s η l g s and the decay of localized chemical heterogeneity on reactive species is shown in the term l κ s 2 3 steady state analytical solution a steady state solution is possible for the continuous injection or cumulative concentration of the pulse injection the relevant output for the chemical localization problem is the ratio between the species concentrations in immobile and mobile zone given by 20 0 c i m d x d τ α d t d d t d 0 c m d x d t d d t d l φ s s 0 as can be obtained from the laplace transform of eqs 8 and eq 9 the concentration in the immobile zone is the weighted integral of concentrations in all immobile zones which is defined as 21 c i m d x d t d 0 p τ α d c i m x d τ α d t d d τ α d from eq 8 we can obtain that 22 c i m d x d t d 0 t d g t d t d c m x d t d d t d then the ratio between the cumulative concentrations in the immobile and mobile zone becomes 23 0 c i m d x d t d d t d 0 c m d x d t d d t d l g s s 0 3 numerical models we have built several numerical models to study chemical localization in physical and chemical heterogeneous media the models have been calculated by the code rt mrmt dsa wang et al 2022 which is an object oriented fortran2003 code based on finite element method fem and capable of simulating reactive transport in multicontinuum media with mrmt species transport and reactions are solved simultaneously by using the direct substitution approach dsa based on the newton raphson method saaltink et al 2001 yeh and tripathi 1989 all the models are one dimensional with ϕ m 0 1 ϕ im 0 3 α l 1 l q 1 lt 1 thus we have lc 1 l tc 0 1 t η 3 the length of the domain l 100lc and the simulated time t 104 tc the mesh size δx 1 i e δxd lc and the time interval δt 0 1 i e δtd 10tc at the inlet we set a cauchy boundary condition 24 d c m 0 t n q c e c m 0 t q n 0 c e δ t where ce is the concentration of the inflowing water the outlet is an open boundary condition 25 d c m l t n 0 q n 0 where n is a unit vector which is normal to the boundary and represents the inner product operator initial concentrations are set to zero in both mobile and immobile zones that is cm x 0 cim x τα 0 0 ml 3 except for the first mobile node that has initial concentration c m 1 1 ml 3 this simulates a pulse injection in addition we calculate the cumulative concentration 0 t c d t for both mobile and immobile zones which is equivalent to a continuous injection simulated through a cauchy boundary condition at the inlet eq 24 with an inflow concentration ce c m 1δxϕ m 2q 0 05 we simulate three cases a no reaction system conservative transport a single reaction system and a sequential reaction system unless specified otherwise models use the same gamma distribution of residence times with β 1 2 and τ α 0 d 10 in the single reaction system only one hypothetical reaction a b occurs following a first order rate law with r k1 k 1 ca thus the degradation of species a follows ra k 1 ca and the formation of species b rb k 1 ca in the sequential reaction system a second hypothetical reaction b c is added also with first order kinetics r k2 k 2 cb thus the degradation of species a follows ra k 1 ca the formation and degradation of species b rb k 1 ca k 2 cb and the formation of species c rc k 2 cb these are simple linear rate laws in more realistic models rate laws may be more complex carrera et al 2022 also the reaction rate coefficient can be different for each immobile e g immobile zones with long residence times may tend to display more reducing conditions when simulating biochemical reactions eq 7 expresses this dependence by writing kim τα nevertheless this study focuses on the localization of chemical reactions therefore to facilitate comprehension we used simple reactions with constant rate coefficients kim τα kim although our code can handle more complicated reactions with variable rate coefficients 4 results and discussions we discuss the results for conservative transport section 4 1 which provides the basis for understanding chemical localization in single section 4 2 and sequential section 4 3 reaction systems 4 1 no reaction system the impact of mrmt on conservative transport is well known e g haggerty and gorelick 1995 we summarize here its main features to facilitate understanding the reactive case fig 3 displays concentrations in both mobile and immobile zones in log scale for a pulse injection and arithmetic scale for continuous injection the log log scale is usually preferred for tracer test analysis because it emphasizes tailing the late time slope of the pulse btc is that of the memory function plus 1 e g haggerty et al 2000 therefore by analyzing the btc of conservative tracers modelers can gain insight into the distribution of immobile zones still solute remains in the immobile zones far longer diffusing slowly back to the mobile zone the effect of tailing is somewhat less dramatic for a continuous injection cumulative concentration of a pulse the breakthrough curve approaches asymptotically the input concentration ce with the bulk of solute arising at ta for slow exchange large τ α 0 d most of the solute mass pulse flows in the mobile region so that the peak arrival time coincides with the advective time red arrow in fig 3 fast exchange shorter τ α 0 d allows equilibrating concentration in the mobile and immobile zones so that the medium behaves as if the whole porosity was mobile it is important to notice the above separation between fast and slow is relative to the advective transport time tam lϕ m q where l is the travel distance of solute if ta τα the immobile region becomes accessible to the solute and the actual travel time reflects the total porosity tat lϕ q where ϕ ϕ m ϕ im is the total porosity this effect is similar to retardation and it is frequently stated that the impact of immobile zones is to retard the solute e g haggerty and gorelick 1995 in fact the peak arrival for the τ α 0 d 10 1 btc in fig 3 orange arrow is retarded by a factor of 4 which reflects that ϕ m ϕ im equals 4ϕ m note however that 1 this kind of retardation has nothing to do with adsorption or any other partitioning process in fact ϕs in our equations can be viewed as retention capacities for sorbing solutes and 2 the apparent retardation associated to diffusion in immobile zones will be distance and flux dependent this kind of observations may explain why non local models are less popular in unconsolidated granular aquifers than in fractured media fractured media with diffusion lengths of the order of meters will display residence times of the order td l 2 d 10m 2 10 10 m 2 s 1012 s 3 105 years that is diffusion is never exhausted diffusion lengths in porous media are less than 1 cm so that residence times in immobile zones will be of the order of t d 10 2 m 2 10 10 m 2 s 10 6 s 4 m o n t h s this time may be relevant for tracer tests where travel time is of a few days but is too short for natural groundwater flow support for this kind of observations is provided by guimerà and carrera 2000 they observed that the advective porosity i e the porosity derived from the peak arrival time calculated from a broad collection of tracer tests in fractured rocks correlates with the peak arrival time this implies that the apparent mobile porosity increases when the flow rate is reduced which we take as indicative of fast immobile regions equilibrating with truly mobile zones increasing the travel time causes an increasing fraction of immobile regions to equilibrate with mobile zones thus becoming effectively mobile further insight into the behavior of conservative solutes can be gained from fig 3 right which displays the immobile concentration color scale versus distance and immobile residence time for td 300 the figure might be considered somewhat misleading in that the vertical axis refers to immobile porosity associated to small residence times recall pdf of immobile zones for a gamma distribution fig 2 and not distance to the mobile zone however as shown in fig 3 the concentration in immobile regions is independent of their volumetric fraction what fig 3 right shows is that concentrations in the immobile zones with short residence times from ταd 10 2 to 101 much shorter than the dimensionless travel time of 300 are identical to concentrations in the mobile zone on the other hand concentration is negligible in the immobile zones whose residence time is much larger than travel time for ταd higher than 103 the concentration in the immobile zones is 0 even at the shorter distances this might suggest that slow immobile regions might be neglected whereas fast immobile regions might be lumped with the mobile domain while this may be appropriate for inert tracers it may not be suitable for reacting tracers because reactivity is usually higher in the immobile regions certainly in the case of biofilms kone et al 2014 seifert and engesgaard 2007 taylor and jaffé 1990 which motivates our work 4 2 single reaction system in this case we consider two solutes a and b a is the only solute present in the inflow water while b is produced by the degradation of a concentrations of the two species in mobile and immobile zones for a pulse and a continuous injection are shown in fig 4 for several reaction times higher than the mean residence time the situation is now more complicated than in the conservative transport case because three sets of characteristic times are involved residence times in immobile zones reaction times and advective transport time the first immediate observation is that maximum concentrations of species a are reduced when the reaction rate is increased i e when the characteristic reaction time is reduced note that btc concentrations of a become negligible when reaction time is much smaller than transport time i e for case of τ rd 102 when transport time td 103 that means τ rd td species a is almost reduced and cannot be detected the behavior of the distribution of concentrations in the immobile regions may be less intuitive see fig 5 concentration of the parent species a is negligible in immobile zones with residence time much larger than the reaction time ταd τ rd because the solute diffusing into these zones is degraded before a significant concentration can build up it is also negligible in zones where residence time is much larger than the simulation time td because almost no solute has diffused into these regions yet on the other extreme concentration in fast immobile regions is virtually equal to the mobile concentration which suggests that these regions could be lumped with the mobile regions more interesting is the behavior of daughter species b which is washed away from the mobile zone and fast immobile zones before it becomes significant as a result b concentrations are dominant in immobile zones whose residence time lies between the reaction time and the simulation time solute a has arrived at immobile zones with residence time shorter than td at those immobile zones with residence time higher than reaction time a has been transformed into b this is the fundamental point to demonstrate that b has become localized in certain immobile zones which motivates this work and is further analyzed for the case of sequential reactions 4 3 sequential reaction system the sequential reaction case becomes increasingly complicated by the multiplicity of times involved therefore we start by considering the steady state solution to the sequential reaction system for a generic immobile region that exchanges mass with the mobile zone the governing equations are 26 0 α c m a c a k 1 c a 0 α c m b c b k 1 c a k 2 c b 0 α c m c c c k 2 c b where we have dropped the dependence on xd td and ταd for simplicity and because it is self evident i e ca c im a xd ταd td cma cma xd td etc from eq 26 we can obtain the analytical solution of each species at steady state as a function of the mobile concentrations 27 c a α c m a α k 1 c b α c m b k 1 c a α k 2 c c α c m c k 2 c b α these expressions become clearer when the concentrations of daughter products in the mobile zone can be neglected i e near the input assuming they are absent in the inflow and that the advective flux is large assuming cmb cmc 0 in eq 27 we get 28 c a c m a α α k 1 c b c m a α k 1 α k 1 α k 2 c c c m a k 1 k 2 α k 1 α k 2 fig 6 displays the steady state concentrations of species a b and c in immobile zones versus residence time τα 1 α note that the sum of concentrations a b and c equals one which is the concentration of a in the inflow this reflects the fact that this sum is conservative because ra rb rc k 1 ca k 1 ca k 2 cb k 2 cb 0 and the fact that at steady state the concentration of a conservative species in any immobile zone equals the mobile concentration as can be observed species a blue which is the only species present in the mobile zone dominates immobile zones with residence times much smaller than the reaction time of the first reaction say τα τ r1 10 therefore immobile zones with residence times significantly lower than the first reaction characteristic time can effectively be considered as mobile species b orange dominates immobile zones with residence times between the two reaction times when τ r1 τ r2 but its concentration is negligible when τ r1 τ r2 i e when its decay is faster than its production species c yellow dominates those immobile zones with residence times larger than the reaction time of the second reaction τα τ r2 1 k 2 thus when the second reaction is also fast right graph of fig 6 the concentration of the intermediate species b becomes small and the two reactions could probably be lumped and species b neglected provided it does not affect other reactions results for the full transport case a b and b c are summarized in fig 7 and fig 8 fig 7 displays the btcs for the transport conditions of fig 3 and fig 4 but only one immobile region to better isolate the effect of residence time as in fig 7 when the exchange is slow the btc of species a green and purple btcs for τ α 0 d 10 4 and 103 respectively overlaps with that of a conservative solute in the mobile zone black line except at the tail the concentrations of b and c are very small note the vertical axis the case of short residence times is also illustrative the corresponding btc blue line is virtually identical to the btc dotted black line where all the porosity has been lumped as mobile obviously the immobile zone reactions must be accounted for in this mobile the effective reaction rate is derived in the appendix a that is immobile regions with short residence time compared to transport and reaction times i e ταd td and ταd τ rd can be lumped and treated as mobile the effective reaction rate in the case of fig 7 turns out to be kam kim ϕ im ϕ im ϕ m see appendix a the most significant observation from the point of view of chemical localization derives from fig 8 which displays immobile regions concentrations as a function of space and residence time this figure makes it clear that c concentrations are only relevant in immobile zones with residence times comparable to reaction times regardless of the transport time therefore the three sets of times transport time reaction time and residence times are relevant when deciding the appropriate discretization of residence times note that this result is consistent with that of fig 6 the second reaction tends to become localized in zones where the residence time is greater than the first reaction time and the final daughter species c tends to concentrate in zones where the residence time is greater than the second reaction time 5 conclusion several conclusions can be drawn from the modeling results presented in this work 1 some reactions may occur in immobile regions that would not occur if the entire medium was mobile this is not surprising when the mineral composition is different in each immobile zone as was discussed by soler segarra et al 2016 what we show here is that independently of the reactivity of mobile and immobile zones the interplay between residence times and reaction times may cause some reactions to take place solely in the immobile zone this will occur whenever residence time is larger than or comparable to reaction time and both are much longer than the transport time it goes without saying that immobile zone reactions will be enhanced if reactivity in immobile zones is higher than in the mobile zone this is the case for biofilms where microbial mediated degradation reactions concentrate 2 regardless of reaction rates concentrations in the fast immobile zones i e zones where τα td lϕ q will tend to equilibrate with mobile concentrations therefore little is gained by representing them explicitly in a model all fast exchange immobile zones can be lumped into the mobile zone provided that the reaction rates are modified by the porosity ratio in general the corrected reaction rate will depend on both the actual immobile reaction rate and the residence time distribution in immobile zones but this latter dependence becomes negligible when residence time is much smaller than the reaction time 3 similarly very slow immobile zones τα td can be ignored because little mass will diffuse into them note that this conclusion is more relevant for laboratory experiments or short tracer tests where transport times are moderate under natural conditions transport time can be very long many years so that most immobile zones are indeed accessible 4 the time and space required for secondary species and reactions to build up may be large this finding runs contrary to the frequent view of searching for metabolites and secondary species near the sources of parent species instead they may tend to concentrate in isolated zones i e with long residence times at a distance from the source credit authorship contribution statement jingjing wang conceptualization methodology software validation formal analysis investigation writing original draft writing review editing visualization jesus carrera conceptualization methodology validation formal analysis resources writing original draft writing review editing visualization supervision funding acquisition maarten w saaltink conceptualization validation formal analysis writing original draft writing review editing visualization supervision cristina valhondo conceptualization validation formal analysis writing original draft writing review editing visualization supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors acknowledge the financial support of project nitrem european union european institute of innovation and technology project number 17013 pa2021 eit eit raw materials ga2021 eit rm and the project restora agència catalana de l aigua aca210 18 0040 additional funding was obtained from the generalitat de catalunya 2017 sgr1485 and the spanish ministry of science and innovation centre of excellence severo ochoa csic idaea cex2018 000794 s appendix a the objective of this appendix is to find an effective reaction rate in the mobile zone for cases when residence time in the immobile zone is much smaller than the reaction time such fast exchanging immobile zones can be lumped in the mobile zone but their reactions also need to be included in the mobile zone to this end we consider a simplified steady state mass balance in the mobile zone where the advection and dispersion terms are substituted by w cex cm where w is the flow rate per unit volume of medium that enters the mobile zone with concentration cex and leaves with concentration cm under steady state conditions mass balance reads a1 ϕ m d c m d t w c e x c m j n i m ϕ i m j α i m j c m c i m j ϕ m λ m c m 0 where ϕ m and ϕ i m j are the retention capacities of mobile and j immobile zone respectively cm ml 3 and c i m j ml 3 are concentrations in the mobile and immobile zone which are expressed as mass per unit volume of mobile and immobile water respectively α i m j t 1 is the mass exchange rate between mobile and jth immobile zone λ m ml 3t 1 is the rate constant for degradation reactions in the mobile zone and corresponds to the mass removed by reactions in the mobile zone per unit volume of mobile water per unit time mass balance in each immobile zone is given by a2 d c i m j d t α i m j c m c i m j λ i m j c i m j 0 solving eq a2 for c i m j yields a3 c i m j α i m j c m α i m j λ i m j substituting c i m j into eq a1 and solving for cm yields a4 c m w w j n i m ϕ i m j α i m j λ i m j α i m j λ i m j ϕ m λ m c e x this equation can also be used for the case in which all in general a subset of immobile zones are lumped into the mobile zone which we denote with subscript am all mobile a5 c a m w w ϕ a m λ a m c e x comparing eqs a4 and eq a5 it is clear that the solutions are identical if a6 ϕ a m λ a m j n i m ϕ i m j α i m j λ i m j α i m j λ i m j ϕ m λ m recalling that ϕ i m j p j ϕ i m and that ϕ am ϕ im ϕ m gives a7 λ a m ϕ i m ϕ i m ϕ m j n i m p j α i m j λ i m j α i m j λ i m j ϕ i m ϕ i m ϕ m λ m in the case discussed in the text λ m 0 α i m j λ i m j and all λ i m j λ i m so that j p j 1 and a8 λ a m ϕ i m λ i m ϕ i m ϕ m 
108,reactive transport rt through heterogeneous media may cause chemical heterogeneity if water flux is slow through portions of the medium in such cases chemical localization i e the occurrence of reactions that would not occur in well mixed media may develop which is especially relevant for biochemical reactions occurring in biofilms the objective of this work is to study the conditions for chemical localization we represent the impact of heterogeneity by means of the non local multirate mass transfer mrmt model which views the porous media as consisting of one mobile and many immobile zones a dimensional analysis of the governing equations shows that the problem is characterized by reaction times and the distribution of residence times in immobile zones relative to transport time to analyze the interplay between them we simulated simple rt problems in multicontinuum media results indicate that immobile zones with residence times much smaller than transport can be lumped together with the mobile zone by modifying the reaction rates which reduces computations more importantly reactions driven by species that are not present in the inflowing water but are the result of previous reactions will take place preferentially in immobile zones whose residence time is comparable to or larger than reaction times in fact daughter species may take a long time and distance to build up that is daughter species will not be largest near the inflow where parent species display largest concentrations but further downstream at isolated long residence times immobile zones keywords chemical localization multirate mass transfer reactive transport multicontinuum media numerical modeling nomenclature α mass transfer rate t 1 f α probability density function of mass transfer rates τα 1 α residence time t p τα probability density function of residence times α0 scale parameter of f α τ α 0 scale parameter of p τα β shape parameter of f α and p τα γ β gamma function cm concentrations in the mobile zone ml 3 cim concentrations in the immobile zones ml 3 ϕ m porosity of mobile zone ϕ im porosity of immobile zones q darcy flux lt 1 d hydrodynamic dispersion l2t 1 rm sink source term due to chemical reactions in the mobile zone ml 3t 1 rim sink source term in the immobile zones ml 3t 1 km reaction rate constant in the mobile zone t 1 kim τα local reaction rate constant in the immobile zone with τα t 1 τ r 1 kim τα reaction time in the immobile zone with τα t g t memory function κ t reaction rate kernel δ t dirac delta function lc characteristic length l tc characteristic time t cc characteristic concentration ml 3 q modulus of q lt 1 d longitudinal component of d l2t 1 v q ϕ m mean fluid velocity in mobile zone lt 1 cmd dimensionless concentrations in mobile zone cmd cm cc cimd dimensionless concentrations in immobile zones cimd cim cc xd dimensionless distance xd x lc td dimensionless time td t tc η ratio of total immobile to mobile porosity η ϕ im ϕ m ταd dimensionless residence time ταd τα tc τ rd dimensionless reaction time τ rd τ r tc ce concentration of the inflowing water ml 3 c m 1 p mobile concentration in the first node for the pulse injection ml 3 l travel distance of solute l ta advective transport time t ϕ ϕ m ϕ im total porosity l s laplace transform s complex laplace variable 1 introduction reactive transport rt in porous media is essential for understanding environmental processes such as the fate of contaminants in aquifers and for a proper design and management of remediation strategies such as managed aquifer recharge e g valhondo et al 2020 or co2 geological storage e g agrawal et al 2021 carrera et al 2022 argue that the basic problem of rt is how to address the chemical and physical heterogeneity of natural media physical heterogeneity has received broad attention in the transport literature it is well known that transport in heterogeneous porous media displays anomalous non fickian behavior kitanidis 1988 both at field adams and gelhar 1992 and laboratory scales berkowitz and scher 2009 levy and berkowitz 2003 valocchi 1985 displaying early arrivals long tails and scale dependent dispersion coefficients carrera 1993 the problem is especially relevant for reactive transport because numerous reactions depend on local scale mixing to overcome this problem researchers have focused on small scale simulations in an attempt to simulate heterogeneity explicitly e g cirpka et al 2015 or even by pore scale simulations e g agrawal et al 2021 beyond the cost of such simulations what emerges is that upscaling parameters does not suffice but the transport equation may have to change and the advection dispersion reaction equation adre cannot be considered suitable for reactive transport carrera et al 2022 molins and knabner 2019 soler sagarra et al 2022 many non local methods have been developed to address the need for an alternative transport equation these include continuous time random walks ctrw berkowitz et al 2006 berkowitz and scher 1998 dentz et al 2015 2004 fractional advection dispersion equations fade benson et al 2000 benson and meerschaert 2009 marseguerra and zoia 2008 schumer et al 2003a 2003b multirate mass transfer mrmt babey et al 2017 benson and meerschaert 2009 dentz et al 2011 fernandez garcia and sanchez vila 2015 haggerty and gorelick 1995 salamon et al 2006 wang et al 2005 multiple interacting continua minc de dreuzy et al 2013 pruess and narasimhan 1985 structured interacting continua sinc babey et al 2015 rapaport et al 2017 memory functions carrera et al 1998 gouze et al 2008 haggerty et al 2000 willmann et al 2008 and so forth although these methods use different approaches they are essentially equivalent dentz and berkowitz 2003 neuman and tartakovsky 2009 silva et al 2009 unfortunately their solution is often based on laplace transform methods which makes them poorly suited for multicomponent and or non linear rt therefore most work on non local methods deals with the behavior of breakthrough curves btcs and conservative transport in heterogeneous porous media berkowitz and scher 2009 dentz et al 2015 haggerty et al 2000 schumer et al 2003b willmann et al 2008 still mrmt which can be considered the simplest paradigm of non local transport methods can be used for multicomponent rt the medium is viewed as consisting of a mobile and several overlapping immobile zones each of these zones can be modeled numerically which facilitates general rt simulation babaei and islam 2018 massoudieh and dentz 2020 soler sagarra et al 2016 willmann et al 2010 chemical heterogeneity has received a lot less attention than physical heterogeneity chemical heterogeneity may refer to large scale variability usually known from geological understanding or to pore scale variability portions of the porous media grain aggregates or individual grains or portion of grains can have different mineral compositions leading to different reaction rates and different concentrations at different parts of the pore space furthermore pore scale variability causes water fluxes to be spatially variable which causes dispersion and affects solute transport areas with low water flux may develop chemical conditions different from those of high flux which carry most of the water fig 1 in fact reacting surface tend to be larger in low flux than in high flux areas that is physical heterogeneity may induce chemical heterogeneity steefel et al 2005 call microenvironments these parts of the domain we term the phenomenon chemical localization to emphasize the local occurrence of reactions furthermore heterogeneity can cause chemical localization i e the occurrence of reactions that would not occur in well mixed media the importance of chemical localization has been widely recognized in the literature the discrepancy between measured mineral dissolution rates in laboratory and field is attributed to heterogeneity li et al 2008 modeling studies sometimes combined with chemical and geophysical datasets have shown the effect of heterogeneity on many particular systems such as bioremediation of contaminated aquifers scheibe et al 2006 reactive transport processes in fractures deng and spycher 2019 and mineral precipitation and dissolution in caprocks for co2 storage tian et al 2019 a clear example of chemical localization is presented by luquot et al 2016 who observed carbonate precipitation during injection of acidic co2 brine into a shale core which would not be possible if the acidic conditions associated to co2 injection prevailed throughout the domain soler sagarra et al 2016 showed that silicates weathering may cause sufficient alkalinity to facilitate carbonate precipitation in areas of low water flux a similar situation may occur for biochemical reactions which take place in biofilms biofilm growth generates immobile zones with limited access to electron acceptors which facilitates the occurrence of reducing conditions bellin et al 2014 the net result is that the microbial community is heterogeneous and reactions that would only occur under anaerobic conditions take place despite the overall aerobic water flux in analyzing this problem dentz et al 2011 concluded that transport under physical and chemical heterogeneity cannot be upscaled separately upscaling reactions depends on physical heterogeneity and upscaling transport is affected by chemical heterogeneity a similar conclusion was reached by battiato et al 2009 furthermore macroscale transport may be determined by microscale transport process in immobile zones gouze et al 2008 the situation cannot be considered satisfactory on the one hand chemical localization is frequently observed and we conjecture that its importance will increase with the need to simulate biochemical rt carrera et al 2022 yet it is not clear how to upscale the processes what is clear is that a multicontinuum representation is needed to be able to host and represent different chemical environments in fact lichtner and kang 2007 adopted a lattice boltzmann solution method with this goal we contend that a mrmt representation can reach the same goal at a much lower cost still the problem has never been analyzed formally so that numerous questions need to be answered regarding the conditions for localization and when does it need to be modeled the objective of this work is to study the conditions for localization of reactions in mrmt rt formulations to do so first we establish the governing equations of reactive transport in multicontinuum media and deduce a dimensionless form of these equations we then use the resulting model in two simple cases to analyze the conditions for localization 2 methodology we model reactive transport in heterogeneous porous medium using the mrmt approach haggerty and gorelick 1995 every point representative elementary volume is viewed as consisting of a mobile zone and a distribution of immobile zones characterized by their residence times each immobile zone exchanges solute mass with the mobile zone proportionally to the mass transfer rate α t 1 a complete description of variables employed in this paper is given in the nomenclature therefore it is natural to characterize this distribution by a probability density function pdf of mass transfer rates f α see fig 2 left to facilitate comparison to other non local methods we also characterize immobile zones by the distribution p τα of residence times τα 1 α t haggerty et al 2004 see fig 2 right p τα is given by dentz et al 2015 2011 dentz and berkowitz 2003 1 p τ α τ α 2 f α τ α 0 β γ β 1 τ α β 1 e τ α 0 τ α where β is the shape parameter τ α 0 is the scale parameter and γ β is the gamma function the residence time probability p τα dτα is the immobile zones frequency with residence times in the interval τα τα dτα obviously it satisfies the condition 0 p τ α d τ α 1 2 1 governing equations the transport of any reactive species in a medium that consists of a mobile continuum and multiple immobile continua can be expressed as dentz et al 2011 donado et al 2009 willmann et al 2010 2 ϕ m c m t l t c m ϕ i m 0 1 τ α p τ α c m x t c i m x τ α t d τ α ϕ m r m where lt cm q cm ϕ m d cm is the transport operator that describes advection and dispersion q lt 1 is darcy flux d l2t 1 is the hydrodynamic dispersion tensor ϕ m and ϕ im are the porosities of mobile and immobile zones which denote the volume fraction of mobile pore and immobile pore water over the bulk volume respectively cm ml 3 and cim ml 3 are concentrations in the mobile and immobile zone which are expressed as mass per unit volume of mobile and immobile water respectively rm ml 3t 1 is the sink source term due to chemical reactions in the mobile zone and corresponds to the mass removed by reactions in the mobile zone per unit volume of mobile water per unit time it should be noted that eq 2 remains valid for sorbing solutes in which case ϕ m and ϕ im are the storage capacity porosity times local retardation coefficient of mobile and immobile zones respectively mass balance in each immobile zone is given by 3 c i m x τ α t t 1 τ α c m x t c i m x τ α t r i m x τ α t where rim ml 3t 1 is the reactions sink source term in the immobile zone with residence time τα which corresponds to the mass removed by reactions in the immobile zone per unit volume of immobile water per unit time mass exchange between mobile and immobile zones is modeled by a first order mass transfer term represented by the continuous variable τα and characterized by a distribution density function p τα for the immobile zones thus the total mass exchange is the weighted sum over all immobile zones as expressed in the integral term of eq 2 integrating eq 3 with weight p τα over τα multiplying by ϕ im and substituting it into eq 2 yields the total solute mass balance 4 ϕ m c m x t t ϕ i m 0 p τ α c i m x τ α t t d τ α l t c m x t r x t in which r is the total reaction rate now per unit volume of bulk porous medium that integrates reactions in both mobile and immobile zones i e 5 r x t ϕ m r m x t ϕ i m 0 p τ α r i m x τ α t d τ α if the reaction follows first order kinetics the reaction rate in the mobile zone will be 6 r m x t k m c m x t where km t 1 is the reaction rate constant similarly the local reaction rate in the τα immobile zone becomes 7 r i m x τ α t k i m τ α c i m x τ α t where kim τα t 1 is the local reaction rate constant the reaction time τ r 1 kim τα t is assumed to depend on the immobile zone this dependence should be understood as indicating that as suggested by fig 1 different reactions with different reaction rates may occur in different immobile zones by inserting eq 7 into eq 3 then solving eq 3 we obtain the concentration in the immobile zone of τα as a function of mobile concentration history 8 c i m x τ α t c i m x τ α t 0 e 1 τ α 1 τ r t 0 t φ t t c m x t d t where φ t is given by 9 φ t 1 τ α e 1 τ α 1 τ r t assuming that the initial concentration in the immobile zones is zero i e cim x τα t 0 0 then by substituting eq 8 into eq 2 and rearranging terms we obtain the total solute mass balance as a sole function of cm 10 ϕ m c m x t t ϕ i m t 0 t g t t c m x t d t l t c m x t 0 t κ t t c m x t d t where the memory function carrera et al 1998 haggerty et al 2000 and reaction rate kernel dentz et al 2011 are given by 11 g t 0 p τ α φ t d τ α and 12 κ t ϕ m x 1 τ r m δ t ϕ i m x 0 1 τ r p τ α φ t d τ α respectively in which δ t is the dirac delta function the memory function can be viewed as the rate of change of concentration in the immobile zone that is caused by a unit change of concentration in the mobile zone at initial time t 0 in the presence of reactions the memory function not only incorporates the distribution of local mass transfer rates but also the distribution of local reaction rates similarly the reaction rate kernel represents the local reactions in immobile zones it integrates the reactions in both mobile and immobile zones and accounts for the mass transfer between mobile and immobile zones although the memory function is mainly controlled by the distribution of residence times in immobile zones it is also affected by the local reaction times in immobile zones through φ t eq 9 likewise the reaction rate kernel is mainly controlled by the chemical reactions but it is also affected by the distribution of residence times in immobile zones clearly the governing equations of reactive transport under physical and chemical heterogeneity 10 11 and 12 are controlled by the distribution of residence times and reaction times in immobile zones simultaneously the physical and chemical heterogeneities interact with each other and together they govern reactive transport dentz et al 2011 2 2 dimensionless formulations we write the dimensionless form of eqs 10 11 and 12 using the definitions of carrera et al 2022 which allows us to avoid the need for a peclet number so that all characteristic variables will be those describing the immobile zones distribution and reaction rates thus we define the characteristic length 13 l c ϕ m d q where q is the modulus of q and d is any norm of d here its longitudinal component and the characteristic transport time 14 t c l c v ϕ m 2 d q 2 note that in 1d the characteristic length equals the longitudinal dispersivity α l if molecular diffusion is neglected in the mobile zone because dispersion becomes d α l v where v q ϕ m is the mean fluid velocity in the mobile zone using these definitions to write all variables in dimensionless form i e td t tc ταd τα tc xd x lc cmd cm cc etc and defining η ϕ im ϕ m see the nomenclature table at the end for the definition of all variables and substituting them into eq 10 leads after some tedious but conventional algebra to the dimensionless form of the governing equations 15 c m d t d η t d 0 t d g t d t d c m d t d d t d d c m d d 2 c m d 0 t d κ t d t d c m d t d d t d note that in this dimensionless formulations the physical and chemical heterogeneity are represented by the distribution of residence and reaction times relative to the characteristic transport time tc and they are reflected simultaneously in the memory function and reaction rate kernel obviously in the situation where the characteristic length lc and the dimensionless ratio of porosity of immobile zone to porosity of mobile zone η are invariable the solution of eq 15 is governed by two characteristic dimensionless times the dimensionless residence time ταd and its distribution and the dimensionless reaction time τ rd in immobile zones the solution of governing eq 15 in laplace domain is expressed as 16 l c m d s e x p x d 2 1 1 4 s 1 η l g s l κ s where l s represents the laplace transform of a function the laplace transform of the memory function and reaction rate kernel are defined as 17 l g s 0 p τ α d l φ s d τ α d and 18 l κ s 1 τ r m d η 0 1 τ r d p τ α d l φ s d τ α d in which the laplace transform of φ td is given by 19 l φ s 1 τ α d τ α d τ r d τ α d τ r d s if we substitute s for s 1 η l g s l κ s in eq 16 then eq 16 becomes the solution of the transport equation in homogeneous media obviously the retardation of localized physical heterogeneity on transport is reflected in the term s η l g s and the decay of localized chemical heterogeneity on reactive species is shown in the term l κ s 2 3 steady state analytical solution a steady state solution is possible for the continuous injection or cumulative concentration of the pulse injection the relevant output for the chemical localization problem is the ratio between the species concentrations in immobile and mobile zone given by 20 0 c i m d x d τ α d t d d t d 0 c m d x d t d d t d l φ s s 0 as can be obtained from the laplace transform of eqs 8 and eq 9 the concentration in the immobile zone is the weighted integral of concentrations in all immobile zones which is defined as 21 c i m d x d t d 0 p τ α d c i m x d τ α d t d d τ α d from eq 8 we can obtain that 22 c i m d x d t d 0 t d g t d t d c m x d t d d t d then the ratio between the cumulative concentrations in the immobile and mobile zone becomes 23 0 c i m d x d t d d t d 0 c m d x d t d d t d l g s s 0 3 numerical models we have built several numerical models to study chemical localization in physical and chemical heterogeneous media the models have been calculated by the code rt mrmt dsa wang et al 2022 which is an object oriented fortran2003 code based on finite element method fem and capable of simulating reactive transport in multicontinuum media with mrmt species transport and reactions are solved simultaneously by using the direct substitution approach dsa based on the newton raphson method saaltink et al 2001 yeh and tripathi 1989 all the models are one dimensional with ϕ m 0 1 ϕ im 0 3 α l 1 l q 1 lt 1 thus we have lc 1 l tc 0 1 t η 3 the length of the domain l 100lc and the simulated time t 104 tc the mesh size δx 1 i e δxd lc and the time interval δt 0 1 i e δtd 10tc at the inlet we set a cauchy boundary condition 24 d c m 0 t n q c e c m 0 t q n 0 c e δ t where ce is the concentration of the inflowing water the outlet is an open boundary condition 25 d c m l t n 0 q n 0 where n is a unit vector which is normal to the boundary and represents the inner product operator initial concentrations are set to zero in both mobile and immobile zones that is cm x 0 cim x τα 0 0 ml 3 except for the first mobile node that has initial concentration c m 1 1 ml 3 this simulates a pulse injection in addition we calculate the cumulative concentration 0 t c d t for both mobile and immobile zones which is equivalent to a continuous injection simulated through a cauchy boundary condition at the inlet eq 24 with an inflow concentration ce c m 1δxϕ m 2q 0 05 we simulate three cases a no reaction system conservative transport a single reaction system and a sequential reaction system unless specified otherwise models use the same gamma distribution of residence times with β 1 2 and τ α 0 d 10 in the single reaction system only one hypothetical reaction a b occurs following a first order rate law with r k1 k 1 ca thus the degradation of species a follows ra k 1 ca and the formation of species b rb k 1 ca in the sequential reaction system a second hypothetical reaction b c is added also with first order kinetics r k2 k 2 cb thus the degradation of species a follows ra k 1 ca the formation and degradation of species b rb k 1 ca k 2 cb and the formation of species c rc k 2 cb these are simple linear rate laws in more realistic models rate laws may be more complex carrera et al 2022 also the reaction rate coefficient can be different for each immobile e g immobile zones with long residence times may tend to display more reducing conditions when simulating biochemical reactions eq 7 expresses this dependence by writing kim τα nevertheless this study focuses on the localization of chemical reactions therefore to facilitate comprehension we used simple reactions with constant rate coefficients kim τα kim although our code can handle more complicated reactions with variable rate coefficients 4 results and discussions we discuss the results for conservative transport section 4 1 which provides the basis for understanding chemical localization in single section 4 2 and sequential section 4 3 reaction systems 4 1 no reaction system the impact of mrmt on conservative transport is well known e g haggerty and gorelick 1995 we summarize here its main features to facilitate understanding the reactive case fig 3 displays concentrations in both mobile and immobile zones in log scale for a pulse injection and arithmetic scale for continuous injection the log log scale is usually preferred for tracer test analysis because it emphasizes tailing the late time slope of the pulse btc is that of the memory function plus 1 e g haggerty et al 2000 therefore by analyzing the btc of conservative tracers modelers can gain insight into the distribution of immobile zones still solute remains in the immobile zones far longer diffusing slowly back to the mobile zone the effect of tailing is somewhat less dramatic for a continuous injection cumulative concentration of a pulse the breakthrough curve approaches asymptotically the input concentration ce with the bulk of solute arising at ta for slow exchange large τ α 0 d most of the solute mass pulse flows in the mobile region so that the peak arrival time coincides with the advective time red arrow in fig 3 fast exchange shorter τ α 0 d allows equilibrating concentration in the mobile and immobile zones so that the medium behaves as if the whole porosity was mobile it is important to notice the above separation between fast and slow is relative to the advective transport time tam lϕ m q where l is the travel distance of solute if ta τα the immobile region becomes accessible to the solute and the actual travel time reflects the total porosity tat lϕ q where ϕ ϕ m ϕ im is the total porosity this effect is similar to retardation and it is frequently stated that the impact of immobile zones is to retard the solute e g haggerty and gorelick 1995 in fact the peak arrival for the τ α 0 d 10 1 btc in fig 3 orange arrow is retarded by a factor of 4 which reflects that ϕ m ϕ im equals 4ϕ m note however that 1 this kind of retardation has nothing to do with adsorption or any other partitioning process in fact ϕs in our equations can be viewed as retention capacities for sorbing solutes and 2 the apparent retardation associated to diffusion in immobile zones will be distance and flux dependent this kind of observations may explain why non local models are less popular in unconsolidated granular aquifers than in fractured media fractured media with diffusion lengths of the order of meters will display residence times of the order td l 2 d 10m 2 10 10 m 2 s 1012 s 3 105 years that is diffusion is never exhausted diffusion lengths in porous media are less than 1 cm so that residence times in immobile zones will be of the order of t d 10 2 m 2 10 10 m 2 s 10 6 s 4 m o n t h s this time may be relevant for tracer tests where travel time is of a few days but is too short for natural groundwater flow support for this kind of observations is provided by guimerà and carrera 2000 they observed that the advective porosity i e the porosity derived from the peak arrival time calculated from a broad collection of tracer tests in fractured rocks correlates with the peak arrival time this implies that the apparent mobile porosity increases when the flow rate is reduced which we take as indicative of fast immobile regions equilibrating with truly mobile zones increasing the travel time causes an increasing fraction of immobile regions to equilibrate with mobile zones thus becoming effectively mobile further insight into the behavior of conservative solutes can be gained from fig 3 right which displays the immobile concentration color scale versus distance and immobile residence time for td 300 the figure might be considered somewhat misleading in that the vertical axis refers to immobile porosity associated to small residence times recall pdf of immobile zones for a gamma distribution fig 2 and not distance to the mobile zone however as shown in fig 3 the concentration in immobile regions is independent of their volumetric fraction what fig 3 right shows is that concentrations in the immobile zones with short residence times from ταd 10 2 to 101 much shorter than the dimensionless travel time of 300 are identical to concentrations in the mobile zone on the other hand concentration is negligible in the immobile zones whose residence time is much larger than travel time for ταd higher than 103 the concentration in the immobile zones is 0 even at the shorter distances this might suggest that slow immobile regions might be neglected whereas fast immobile regions might be lumped with the mobile domain while this may be appropriate for inert tracers it may not be suitable for reacting tracers because reactivity is usually higher in the immobile regions certainly in the case of biofilms kone et al 2014 seifert and engesgaard 2007 taylor and jaffé 1990 which motivates our work 4 2 single reaction system in this case we consider two solutes a and b a is the only solute present in the inflow water while b is produced by the degradation of a concentrations of the two species in mobile and immobile zones for a pulse and a continuous injection are shown in fig 4 for several reaction times higher than the mean residence time the situation is now more complicated than in the conservative transport case because three sets of characteristic times are involved residence times in immobile zones reaction times and advective transport time the first immediate observation is that maximum concentrations of species a are reduced when the reaction rate is increased i e when the characteristic reaction time is reduced note that btc concentrations of a become negligible when reaction time is much smaller than transport time i e for case of τ rd 102 when transport time td 103 that means τ rd td species a is almost reduced and cannot be detected the behavior of the distribution of concentrations in the immobile regions may be less intuitive see fig 5 concentration of the parent species a is negligible in immobile zones with residence time much larger than the reaction time ταd τ rd because the solute diffusing into these zones is degraded before a significant concentration can build up it is also negligible in zones where residence time is much larger than the simulation time td because almost no solute has diffused into these regions yet on the other extreme concentration in fast immobile regions is virtually equal to the mobile concentration which suggests that these regions could be lumped with the mobile regions more interesting is the behavior of daughter species b which is washed away from the mobile zone and fast immobile zones before it becomes significant as a result b concentrations are dominant in immobile zones whose residence time lies between the reaction time and the simulation time solute a has arrived at immobile zones with residence time shorter than td at those immobile zones with residence time higher than reaction time a has been transformed into b this is the fundamental point to demonstrate that b has become localized in certain immobile zones which motivates this work and is further analyzed for the case of sequential reactions 4 3 sequential reaction system the sequential reaction case becomes increasingly complicated by the multiplicity of times involved therefore we start by considering the steady state solution to the sequential reaction system for a generic immobile region that exchanges mass with the mobile zone the governing equations are 26 0 α c m a c a k 1 c a 0 α c m b c b k 1 c a k 2 c b 0 α c m c c c k 2 c b where we have dropped the dependence on xd td and ταd for simplicity and because it is self evident i e ca c im a xd ταd td cma cma xd td etc from eq 26 we can obtain the analytical solution of each species at steady state as a function of the mobile concentrations 27 c a α c m a α k 1 c b α c m b k 1 c a α k 2 c c α c m c k 2 c b α these expressions become clearer when the concentrations of daughter products in the mobile zone can be neglected i e near the input assuming they are absent in the inflow and that the advective flux is large assuming cmb cmc 0 in eq 27 we get 28 c a c m a α α k 1 c b c m a α k 1 α k 1 α k 2 c c c m a k 1 k 2 α k 1 α k 2 fig 6 displays the steady state concentrations of species a b and c in immobile zones versus residence time τα 1 α note that the sum of concentrations a b and c equals one which is the concentration of a in the inflow this reflects the fact that this sum is conservative because ra rb rc k 1 ca k 1 ca k 2 cb k 2 cb 0 and the fact that at steady state the concentration of a conservative species in any immobile zone equals the mobile concentration as can be observed species a blue which is the only species present in the mobile zone dominates immobile zones with residence times much smaller than the reaction time of the first reaction say τα τ r1 10 therefore immobile zones with residence times significantly lower than the first reaction characteristic time can effectively be considered as mobile species b orange dominates immobile zones with residence times between the two reaction times when τ r1 τ r2 but its concentration is negligible when τ r1 τ r2 i e when its decay is faster than its production species c yellow dominates those immobile zones with residence times larger than the reaction time of the second reaction τα τ r2 1 k 2 thus when the second reaction is also fast right graph of fig 6 the concentration of the intermediate species b becomes small and the two reactions could probably be lumped and species b neglected provided it does not affect other reactions results for the full transport case a b and b c are summarized in fig 7 and fig 8 fig 7 displays the btcs for the transport conditions of fig 3 and fig 4 but only one immobile region to better isolate the effect of residence time as in fig 7 when the exchange is slow the btc of species a green and purple btcs for τ α 0 d 10 4 and 103 respectively overlaps with that of a conservative solute in the mobile zone black line except at the tail the concentrations of b and c are very small note the vertical axis the case of short residence times is also illustrative the corresponding btc blue line is virtually identical to the btc dotted black line where all the porosity has been lumped as mobile obviously the immobile zone reactions must be accounted for in this mobile the effective reaction rate is derived in the appendix a that is immobile regions with short residence time compared to transport and reaction times i e ταd td and ταd τ rd can be lumped and treated as mobile the effective reaction rate in the case of fig 7 turns out to be kam kim ϕ im ϕ im ϕ m see appendix a the most significant observation from the point of view of chemical localization derives from fig 8 which displays immobile regions concentrations as a function of space and residence time this figure makes it clear that c concentrations are only relevant in immobile zones with residence times comparable to reaction times regardless of the transport time therefore the three sets of times transport time reaction time and residence times are relevant when deciding the appropriate discretization of residence times note that this result is consistent with that of fig 6 the second reaction tends to become localized in zones where the residence time is greater than the first reaction time and the final daughter species c tends to concentrate in zones where the residence time is greater than the second reaction time 5 conclusion several conclusions can be drawn from the modeling results presented in this work 1 some reactions may occur in immobile regions that would not occur if the entire medium was mobile this is not surprising when the mineral composition is different in each immobile zone as was discussed by soler segarra et al 2016 what we show here is that independently of the reactivity of mobile and immobile zones the interplay between residence times and reaction times may cause some reactions to take place solely in the immobile zone this will occur whenever residence time is larger than or comparable to reaction time and both are much longer than the transport time it goes without saying that immobile zone reactions will be enhanced if reactivity in immobile zones is higher than in the mobile zone this is the case for biofilms where microbial mediated degradation reactions concentrate 2 regardless of reaction rates concentrations in the fast immobile zones i e zones where τα td lϕ q will tend to equilibrate with mobile concentrations therefore little is gained by representing them explicitly in a model all fast exchange immobile zones can be lumped into the mobile zone provided that the reaction rates are modified by the porosity ratio in general the corrected reaction rate will depend on both the actual immobile reaction rate and the residence time distribution in immobile zones but this latter dependence becomes negligible when residence time is much smaller than the reaction time 3 similarly very slow immobile zones τα td can be ignored because little mass will diffuse into them note that this conclusion is more relevant for laboratory experiments or short tracer tests where transport times are moderate under natural conditions transport time can be very long many years so that most immobile zones are indeed accessible 4 the time and space required for secondary species and reactions to build up may be large this finding runs contrary to the frequent view of searching for metabolites and secondary species near the sources of parent species instead they may tend to concentrate in isolated zones i e with long residence times at a distance from the source credit authorship contribution statement jingjing wang conceptualization methodology software validation formal analysis investigation writing original draft writing review editing visualization jesus carrera conceptualization methodology validation formal analysis resources writing original draft writing review editing visualization supervision funding acquisition maarten w saaltink conceptualization validation formal analysis writing original draft writing review editing visualization supervision cristina valhondo conceptualization validation formal analysis writing original draft writing review editing visualization supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors acknowledge the financial support of project nitrem european union european institute of innovation and technology project number 17013 pa2021 eit eit raw materials ga2021 eit rm and the project restora agència catalana de l aigua aca210 18 0040 additional funding was obtained from the generalitat de catalunya 2017 sgr1485 and the spanish ministry of science and innovation centre of excellence severo ochoa csic idaea cex2018 000794 s appendix a the objective of this appendix is to find an effective reaction rate in the mobile zone for cases when residence time in the immobile zone is much smaller than the reaction time such fast exchanging immobile zones can be lumped in the mobile zone but their reactions also need to be included in the mobile zone to this end we consider a simplified steady state mass balance in the mobile zone where the advection and dispersion terms are substituted by w cex cm where w is the flow rate per unit volume of medium that enters the mobile zone with concentration cex and leaves with concentration cm under steady state conditions mass balance reads a1 ϕ m d c m d t w c e x c m j n i m ϕ i m j α i m j c m c i m j ϕ m λ m c m 0 where ϕ m and ϕ i m j are the retention capacities of mobile and j immobile zone respectively cm ml 3 and c i m j ml 3 are concentrations in the mobile and immobile zone which are expressed as mass per unit volume of mobile and immobile water respectively α i m j t 1 is the mass exchange rate between mobile and jth immobile zone λ m ml 3t 1 is the rate constant for degradation reactions in the mobile zone and corresponds to the mass removed by reactions in the mobile zone per unit volume of mobile water per unit time mass balance in each immobile zone is given by a2 d c i m j d t α i m j c m c i m j λ i m j c i m j 0 solving eq a2 for c i m j yields a3 c i m j α i m j c m α i m j λ i m j substituting c i m j into eq a1 and solving for cm yields a4 c m w w j n i m ϕ i m j α i m j λ i m j α i m j λ i m j ϕ m λ m c e x this equation can also be used for the case in which all in general a subset of immobile zones are lumped into the mobile zone which we denote with subscript am all mobile a5 c a m w w ϕ a m λ a m c e x comparing eqs a4 and eq a5 it is clear that the solutions are identical if a6 ϕ a m λ a m j n i m ϕ i m j α i m j λ i m j α i m j λ i m j ϕ m λ m recalling that ϕ i m j p j ϕ i m and that ϕ am ϕ im ϕ m gives a7 λ a m ϕ i m ϕ i m ϕ m j n i m p j α i m j λ i m j α i m j λ i m j ϕ i m ϕ i m ϕ m λ m in the case discussed in the text λ m 0 α i m j λ i m j and all λ i m j λ i m so that j p j 1 and a8 λ a m ϕ i m λ i m ϕ i m ϕ m 
109,the contamination of groundwater aquifers by chlorinated solvents is a water resource issue of great importance worldwide such contaminants are difficult to treat because they are often released as dense non aqueous phase liquids dnapls research shows that the application of remediation technologies to both the napl source and dissolved plume can lead to more efficient remediation rather than to either alone in these remediation efforts analytical models that evaluate behavior and fate of contaminants do provide a better understanding of the performance of these remedial technologies to the best of our knowledge there exist no analytical model of simulating the plume migration of multiple contaminants with capabilities of accounting for both napl source and plume remediation simultaneously and different retardation for original chlorinated solvent contaminant and its degradation byproducts in this study we present a new analytical model for remediating both napl source and downgradient contaminant plume in groundwater at sites contaminated with chlorinated solvents and their degradation products with different retardation factors as well as considering both napl source and plume remediation simultaneously a source model that accounts for the depletion of mass by the processes of dissolution or first order decay reactions corresponding with the removal or destruction of the source mass is coupled to a plume reactive transport model the source model is accounted for by relating source mass to the flux averaged source discharge concentration through a power function the developed analytical model considers 1 d advection 3 d dispersion first order decay reactions and ingrowth as well as linear isothermal equilibrium sorption the proposed analytical solution was derived through successive application of the laplace transform in time and the double finite fourier cosine transform regarding y and z the correctness of the analytical model and its auxiliary fortran computer program code are proved by showing excellent agreements between the simulated plume concentrations of all contaminants obtained from the derived analytical model and from a semi analytical model available in the literature application of the proposed analytical solutions illustrates that the use of identical retardation factors for all contaminants may lead to underestimation or overestimation of the mobility of the contaminants in cases when the retardation factors of the individual contaminants are greatly different from the identical retardation factor value adopted in all contaminants from the experiments on six scenarios corresponding six remedial treatments we found out that both the enhanced source decay and partial removal of source mass are main controlling factors at reducing the concentrations of all the contaminants whereas plume decay leads to effective reduction in the concentrations of pce however rather it causes unfavorable increases of the concentrations of the degradation byproducts ultimately the developed model is used to better understand the impacts of various possible combinations of remedial efforts and management decisions on remediation of the subsurface contamination and quantify the benefit of a certain remediation decision keywords napl source downgradient plume remediation chlorinated solvent analytical model retardation factor data availability no data was used for the research described in the article 1 introduction the contamination of groundwater aquifers by chlorinated solvents such as tetrachloroethene pce trichloroethene tce 1 1 1 trichloroethene tca and carbon tetrachloride ct is a water resource issue of great importance worldwide because of adverse effects such contaminants have on human health and to the environment as well as having an impact on sustainable use of groundwater resource it is difficult to restore chlorinated solvent contaminated groundwater sites because such solvents are often released as dense non aqueous phase liquids dnapls extensive research on the development of technology for the remediation of groundwater contaminated with the chlorinated solvent have been conducted over the past few decades experience with the remediation of chlorinated solvent contaminated groundwater sites for the reduction of contaminant concentrations below the requirements for safe drinking water standards e g maximum contaminant levels mcls has demonstrated that a mathematical model can be a very important tool during the decision making process analytical solutions of the advection dispersion equations ades are effective and practical tools for understanding contaminant plume migration evaluating remediation performance as well as calculating the exposure dose required for health risk assessment mcguire et al 2004 since most chlorinated solvent contaminated groundwater sites generally are characterized by the coexistence of the original contaminant and its degradation byproducts models that can simultaneously simulate the reactive transport of multiple contaminants than that of single contaminant are typically more useful for real world applications several multiple contaminant transport models have been presented in the literature where several ades combined with a sequential first order reaction network are simultaneously solved by analytical method but most of these have been limited only for one dimensional problems cho 1971 van genuchten 1985 sun and clement 1999 srinivasan and clement 2008a 2008b pérez guerrero et al 2009 2010 chen et al 2012a 2012b 2019a mieles and zhan 2012 suk 2013 2016 carr 2021 only a few analytical or semi analytic models are available for two or three dimensional multiple contaminant transport aziz et al 2000 bauer et al 2001 sudicky et al 2013 chen et al 2016 2019b perina 2021 liao et al 2021 among these the most popular analytical screening models is the public domain biochlor model by the center for subsurface modeling support of usepa aziz et al 2000 which described aquifer remediation by simulating natural attenuation process however the biochlor model requires the use of identical retardation factors for all contaminants moreover it also assumes time invariant source concentrations which implies no remediation of the napl source besides all other multi dimensional multi species analytical models did not account for the source decay either one of the most critical aspects associated with chlorinated solvent contaminated groundwater sites is the presence of dnapls in the subsurface environment serving as the continuing source of the downgradient plume if dnapls are present source remediation at a contaminated site may be required or advantageous to restore the aquifer to meet the mcls the remediation evaluation model for chlorinated solvents remchlor falta et al 2007 http www epa gov ada csmos models remchlor html is a screening level analytical model that can simultaneously accounts for both napl source and plume remediation it includes a dynamic source model following a power function relationship relating the napl source mass to the source discharge concentration similar to biochlor remchlor also requires the use of identical retardation factors for the original chlorinated solvent contaminant and its degradation byproducts however laboratory batch experiments have demonstrated different sorption coefficients retardation factors for distinct chlorinated solvent contaminants lu et al 2011 the retardation factor is an important transport parameter that significantly governs the movement of the contaminant it is designed to account for the sorption behaviors of contaminants in the aqueous phase onto the sorbed phase and highly depends on the composition of the mineral grains and the properties of the individual chlorinated solvent contaminants therefore assigning identical retardation factors for all chlorinated solvent contaminants would not be so realistic when simulating the plume migration of multiple contaminants with contaminant dependent retardation factors recently liao et al 2021 developed exact three dimensional analytical solutions to multi species advection dispersion equations coupled with a sequential first order degradation reaction network involving distinct retardation factors however liao et al 2021 simply considered a time invariant boundary source concentration and they did not account for source remediation to the best of our knowledge there exist no analytical model of simulating the plume migration of multiple contaminants with capabilities of accounting for both napl source and plume remediation simultaneously and different retardation for original chlorinated solvent contaminant and its degradation byproducts one thing to note is that the scope of the study is assumed to be limited to residual napl not free napl it means that our problem does not correspond to multiphase problem but reduces to multi species transport problem accordingly density and viscosity of napl do not affect movement of napl and water in this study the purpose of this study is thus to develop a new analytical screening level model that couples napl source and plume remediation in addition the newly developed model can use different retardation factors for the chlorinated solvent contaminant and its degradation products the present study is an extension of the work of liao et al 2021 for capability to handle source remediation as well as plume remediation clearly there is a practical need for the development of remediation evaluation models which can consider the effects of contaminant specific retardation factors along with coupled remediation of napl source and downgradient plume which will be illustrated later a fortran computer code is written for implementing the calculation of the newly developed analytical screening level model although the newly developed analytical model has superiority over existing analytical models in terms of dealing with multi species transport with contaminant specific retardation factors in the framework of cleaning both source and plume as like many previous analytical solutions it has inherent limitations of dealing with complex situation of nonuniform flow in heterogeneous media the proposed model might be a more practical tool for understanding and characterizing chlorinated solvent contaminated site where the source such as residual napl is remediated as well as the dissolved plume 2 development of new analytical model we develop new analytical model for describing three dimensional plume migration of a chlorinated solvent contaminant and its degradation byproducts in a groundwater system which has a geometry l w h as shown in fig 1 here l is the length w is the width and h is the height the residual napl source acts as continuing source of downgradient plume following falta et al 2005a 2005b the conceptual models and associated governing equations for source zone and downgradient plume zone are described below 2 1 source model remchlor considers a chlorinated solvent source model that uses conservation of mass and lumps the entire source zone into a single compartment falta et al 2005b by assuming that reduction of the dnapl source mass is caused by the removal by groundwater flowing through the source zone and additional first order decay resulting from the chemical or biological remedial technology the governing equation for conservation of the source mass is 1 d m t d t v d a c s t λ s m t where m t is the source mass at time t vd is the darcy flux a is the cross sectional area of source zone perpendicular to groundwater flow cs t is the flux averaged source discharge concentration of dissolved chlorinated solvent contaminant leaving the source zone at time t and λ s is the rate of first order source decay by remedial technology the source mass is related to the flux averaged source discharge concentration through a power function 2 c s t c s 0 m t m 0 γ where m 0 is the initial source mass c s 0 is the flux averaged source discharge concentration corresponding to the initial source mass the exponent γ is a parameter used for characterizing temporal change of the flux averaged source discharge concentration responding to time dependent source mass the solutions to eqs 1 and 2 can be obtained by falta et al 2007 3 m t v d a c s 0 λ s m 0 γ m 0 1 γ v d a c s 0 λ s m 0 γ e γ 1 λ s t 1 1 γ 4 c s t c s 0 m 0 γ v d a c s 0 λ s m 0 γ m 0 1 γ v d a c s 0 λ s m 0 γ e γ 1 λ s t γ 1 γ 2 2 downgradient plume model the downgradient plume migration of a chlorinated solvent contaminant and its degradation byproducts through the subsurface environment can be described by a set of ades sequentially coupled by a straight decay reaction network under the uniform flow condition the mathematical equations for the plume migrations will be governed by four important transport mechanisms namely one dimensional advection three dimensional hydrodynamic dispersion chain decay reactions and ingrowths as well as linear isotherm adsorption the reason for considering a three dimensional mass flux despite a one dimensional flow is that mass transfer in three directions can occur especially if the flow is slow in addition since groundwater flows are governed by darcy s law the reynolds number must be less than 1 10 when darcy s law is valid fetter 1994 the governing equations for plume migration of each of the compounds is d x 2 c i x y z t x 2 d y 2 c i x y z t y 2 d z 2 c i x y z t z 2 v c i x y z t x λ i c i x y z t ψ i λ i 1 c i 1 x y z t 5 r i c i x y z t t λ 0 0 i 1 4 where ci x y z t represents the contaminant concentration of the plume for species i ml 3 x y and z indicate the cartesian coordinates l t is the time t v is the x directional pore velocity lt 1 dx dy and dz are the dispersion coefficients in the x y and z directions respectively l2t 1 λ i is the first decay constant for species i t 1 ψ i is the yield coefficient between species i and its parent species i 1 ri the retardation factor for species i note that in eq 5 each species can be assigned as contaminant dependent retardation factors it is assumed that x direction is aligned along groundwater velocity initial concentration of species i is assumed to be zero across the entire area 6 c i x y z t 0 0 i 1 4 it is assumed that mass discharge leaves the contaminant source zone acting as a continuing source of the downgradient plume based on the conservation of contaminant mass at the interface where source mass enters the plume area the boundary condition for the plume area is specified as follows ϕ p v c i x 0 y z t ϕ p d x c i x 0 y z t x 7 v d c s t y 1 y y 2 a n d z 1 z z 2 a n d i 1 0 e l s e w h e r e a n d i 2 4 i 1 4 where ϕ p is the porosity of the plume area y 1 y 2 z 1 and z 2 are spatial coordinate values for representing rectangular area of source mass zone as schematically depicted in fig 1 to simplify the derivation procedure for the analytical solution the outlet boundary conditions are specified at infinity 8 c i x y z t 0 i 1 4 assuming no contaminant mass flux of individual contaminant flow across two end boundaries along y axis and z axis respectively we specify the following four boundary conditions as follows 9 c i x y 0 z t y 0 i 1 4 10 c i x y w z t y 0 i 1 4 11 c i x y z 0 t z 0 i 1 4 12 c i x y z h t z 0 i 1 4 to derive analytical solutions to the initial boundary value problem in eqs 5 12 combination of laplace transform and the double finite fourier cosine transform are utilized the details of the solution derivation are provided in appendix a 3 results and discussion 3 1 verification of the proposed analytical solutions the model verification is performed by comparing the simulated results obtained from our derived solutions against those generated from a semi analytical model chen et al 2019b found in the literature the semi analytical model was developed for simulating the three dimensional reactive plume migration of multiple contaminants resulting from a rectangular patch source with time dependent exponential decay of the boundary source concentration the scenario for the verification comparison is adopted from tutorial 6 of remchlor it assumes a hypothetical release of 1620 kg pce source mass m 0 at the initial time the dimensions of the discharge plane of the source zone are specified by y 1 45 m y 2 55 m z 1 3 5 m and z 2 6 5 m the source mass and the flux averaged concentration of dissolved pce leaving the source zone are assumed to follow the power law relationship with an exponent γ of 1 that leads to the exponential decay functions of the source mass m t and flux averaged source concentration cs t with time the initial flux averaged source concentration c s 0 is 100 mg l pce is assumed to go through reductive dechlorination to a series of degradation byproducts pce tetrachloroethylene tce trichloroethylene dce dichloroethene vc vinyl chloride in order to verify the proposed analytical solutions by comparing those against results obtained using remchlor and previous analytical model in chen et al 2019b all contaminants are assigned the same retardation factors of 2 because remchlor requires the use of the identical retardation factors for the original chlorinated solvent contaminant and its degradation byproducts the aquifer properties and contaminant parameters for the verification exercise are summarized in table 1 the summary of aquifer properties and contamination parameters in this exercise is shown in table 1 it should be noted that the previous semi analytical model in chen et al 2019b did not consider the yield coefficient thus yield coefficients for all contaminants are set to be 1 the concentration profiles of pce and its degradation byproducts tce dce and vc along the plume centerline at t 30 years from our proposed analytical solution and semi analytical solutions of chen et al 2019b respectively are compared each other in fig 2 although pce concentrations decrease with distance from the source tce dce and vc do not decrease with distance from the source as their own species of tce dce and vc are produced due to the decomposition of their own parent species accordingly away from the source concentrations of daughter species such as tce and dce are larger than concentration of their parent species such as pce and tce respectively as shown in fig 2 however vc concentration is not larger than dce concentration because its own degradation constant is large in table 1 as expected in the verification exercise the spatial concentration profiles of the four contaminants generated in the two solutions closely match the verification example obviously demonstrates the correctness of our analytical solutions in order to show computational efficiency of this proposed analytical solution computational execution times of intel r core tm i5 8250u cpu 1 60ghz computer with microsoft windows 10 operating system for calculating one observation in fig 2 were shown in table 2 3 2 effects of retardation factors on the plume migration of multiple contaminants the merit of the derived analytical model is that the pce and its degradation byproducts can have their own specific retardation factors rather than identical retardation factors for all contaminants in remchlor therefore this section uses a derived analytical model to examine how retardation factors of multiple contaminants have effects on plume migration the scenario is the same as the previous verification example except the use of contaminant dependent retardation factor values for pce and its degradation compounds the verification example that uses identical retardation factors for all contaminant serves as a baseline simulation for comparison in order to analyze the effects of the contaminant dependent retardation factors on the plume migration the following retardation factor values from pce tce dce to vc are 7 2 2 1 8 and 1 5 respectively besides retardation factors initial source mass initial source concentration darcy velocity porosity source decay constant empirical parameter for characterizing source discharge concentration to source mass cross sectional area of source zone perpendicular to groundwater flow domain size dispersion coefficient plume degradation constant yield coefficients and simulation time are summarized in table 3 the dimensions of the discharge plane of the source zone are specified by y 1 45 m y 2 55 m z 1 3 5 m and z 2 6 5 m fig 3 compares the spatial concentration profiles of pce and its degradation byproducts at 5 years along the plume centerline obtained with the contaminant dependent retardation factor values and those obtained with identical retardation factor values for all contaminants here the identical retardation factor of 2 corresponds to median of retardation factors of all contaminants in case that pce rpce 7 retardation factor value is much greater than the identical retardation factor value of 2 the simulated results obtained using identical retardation factors predict faster mobility of the pce plume than would be produced using contaminant dependent retardation factors as shown in fig 3 moreover although tce rtce 2 2 dce rdce 1 8 and vc rvc 1 5 retardation factor values are similar to or less than the identical retardation factor value migration of contaminant plumes of tce dce and vc adopting the contaminant dependent retardation factors are slower than using the identical retardation factor value as shown in fig 3 since tce dce and vc are the degradation byproducts from pce the mobility of these contaminants will be governed by the retardation factor of their parent contaminant species pce as well as their own retardation factors the results clearly illustrate that when predictive analytical model uses the same retardation factor for all contaminants simulations of plume migration of chlorinated solvent contaminant and of its degradation byproducts with different retardation factor values are not correct also we obtained concentration spatial concentrations of all species by assigning same retardation factor values of 3 1 as arithmetic average of individual retardation factor to all contaminants and compared those with results obtained with different retardation factor of individual species in fig 3 thus we can evaluate whether difference between results obtained using same retardation of arithmetic average and using distinct retardation of individual species are smaller or not than difference between results using same retardation of median and using distinct retardation as shown in fig 3 in this specific example concentration spatial concentrations of pce tce dce and vc obtained using same retardation factor of arithmetic averages are closer to those obtained using different retardation factors than those using same retardation factor of median also when concentration distributions of all contaminants are obtained using same retardation factor all contaminants show the similar moving distance as shown in fig 3 however from concentration distributions obtained using distinct retardation of individual species all contaminants show different migrating velocities as shown in fig 3 for instance in the case of different retardation travelled distance of vc at 5 years is about three time greater than that of pce but that of vc is same as that of pce in the same retardation case 3 3 effect of power function on downgradient plume migration in this study a power function with an exponent γ is used to characterize the relationship between the source mass and the source discharge concentration it is interested in investigating how the exponent γ which specifies a power function affects the downgradient plume migration of multiple contaminants the same scenario as described in section 3 2 is considered except different values of the exponent γ are used to investigate the effect of the power function on downgradient plume migration so all input conditions for simulation follows those in table 3 except different values of the exponent γ here various γ of 0 5 1 and 2 are adopted figs 4 and 5 depict comparison of the spatial concentration profiles of pce tce dce and vc along the plume centreline at t 5 and 10 years obtained using different values of exponent γ 0 5 1 and 2 respectively as can be clearly seen in figs 4 and 5 the predicted concentrations of pce tce dce and vc all increase with decreasing γ the explanation of the above observation can be found out that the same source mass with smaller exponent γ will produce higher level source discharge concentration according to eq 4 as well as occur downgradient migration of contaminant plume with higher concentration as time goes by the discharge concentration decreases with time and thus the inlet concentration of pce decreases with time as shown in fig 5 in addition the locations of the highest concentration of all contaminants become further away from the source over time and the plumes of all contaminants get more spreading over time contrary to pce the peak concentrations of dce and vc increase over time the reason is that the rates of its own production from the decay of parent contaminants are greater than the rates of its own decay field experiment at dover site suggested that the power function of an exponent of 1 would appropriately characterize the relation between source mass and source discharge concentration fure al 2006 falta et al 2005a showed a numerical simulations of a hypothetical two dimensional multiphase flow system composed of homogeneous hydrogeological media and several distinct dnapl pools and concluded that the relationship between the source mass and source discharge concentration depends largely on the correlation between the dnapl distribution and the permeability same source mass placed in a hydrogeological material with higher permeability will produce a higher source discharge concentration which corresponds to the case of a power function with an exponent γ smaller than 1 the physical significance of this case is that if most of the contaminant mass is located on a pathway with higher permeability most of it must be removed before concentration of downgradient plume at receptor exceeds mcls 3 4 application of the developed analytical solutions the evolution of a dissolved contaminant plume depends on the amount of napl mass and the architecture of the contaminant napl source the timing and effectiveness of remediation of napl source and the plume as well as site specific hydrogeology and geochemistry the implementation of active chemical and biological remedial efforts in contaminated areas in several studies have demonstrated that chemical or biological degradation of napl source areas are viable remediation strategies in some sites nrc national research coucile 2005 stroo et al 2012 therefore the analytical model developed in this study is used to simulate pollutant plume evolution following source and plume treatment to evaluate the efficiency of the remediation process due to the removal of source mass and enhancement of the napl source and plume decay rate aquifer properties and contaminant parameters used in the previous section to analysis the effect of retardation coefficients on the downgradient plume migration of multiple contaminants are adopted in the baseline scenario which does not consider active chemical or biological treatments but only considers natural attenuation here six remedial treatments are considered to evaluate individual processes on remediation efficiency 1 natural attenuation 2 partial napl source mass removal 3 enhanced source decay due to biological or chemical treatment 4 enhanced plume decay due to biological or chemical treatment 5 partial napl source mass removal and enhanced plume decay due to biological or chemical treatment and 6 both enhanced source and plume decay partial removal of napl source mass means simply reducing the initial source mass by 10 after one year the enhanced source decay is considered by increasing the source decay rate constant from 0 to 0 1 year 1 enhanced plume decay remediation is taken account by doubling the plume decay rate constants of all contaminants corresponding to natural attenuation the detail input and condition of all six simulations above are shown well in table 4 fig 6 presents the spatial concentration profiles from pce to vc on the plume centerline produced using our developed analytical model the lowest pce concentrations are generated for the enhanced source and plume decay followed by enhanced source decay partial removal of source mass and enhanced plume decay partial removal of source mass enhanced plume decay and natural attenuation in ascending order for the other degradation compounds including tce dce and vc the magnitudes of the contaminant concentrations in ascending sequence are produced by the following scenario sequence the enhanced source decay partial removal of source mass natural attenuation enhanced source and plume decay partial removal of source mass and enhanced plume decay and enhanced plume decay similar conclusion can be observed in breakthrough curves at 10 m distance from source as shown in fig 7 however as time goes by for enhanced source decay concentration of all contaminants drops quickly with time as shown in fig 7 because source concentration according to eq 4 is decreasing over time it should be emphasized that both the enhanced source decay and partial removal of source mass are main controlling factors at reducing the concentrations of all the contaminants although the enhanced plume decay leads to effective reduction in the concentrations of pce however it causes rather an unfavorably increase in the concentrations of the degradation products finally it can be concluded that the developed analytical model provides an important tool for determining the best choice of remedial alternative 4 conclusions a novel analytical model for considering remediation of napl source and downgradient plume at groundwater contamination site contaminated by chlorinated solvents and their degradation byproducts is developed to predict concentration distributions of multiple contaminants in this study the proposed analytical model can account for both napl source and plume remediation simultaneously and different retardation for original chlorinated solvent contaminant and its degradation byproducts the new analytical solution is featured by the fact that chlorinated solvents and decomposition byproducts can have their unique retardation factor rather than using the same retardation factor values as well as remediation of napl source and downgradient plume can be considered the model considers 1 d advection 3 d dispersion first order decay reactions and ingrowth as well as linear isothermal equilibrium sorption the proposed analytical solution was derived through successive application of the laplace transform in time and the double finite fourier cosine transform regarding y and z the results of a verification exercise indicate that there is excellent agreement between the simulated results produced using our proposed model and semi analytical solutions by chen et al 2019b application of the proposed analytical solutions illustrates that the use of identical retardation factors for all contaminants may lead to underestimation or overestimation of the mobility of the contaminants in cases when the retardation factors of the individual contaminants are greatly different from the identical retardation factor value adopted in all contaminants our proposed model shows that the predicted concentrations of pce tce dce and vc at the downgradient site all increase with decreasing the exponent of the power function characterizing the relationship between the source mass and source discharge concentration from the numerical experiments on six scenarios corresponding six remedial treatments we found out that both the enhanced source decay and partial removal of source mass are main controlling factors at reducing the concentrations of all the contaminants whereas plume decay leads to effective reduction in the concentrations of pce however rather it causes unfavorable increases of the concentrations of the degradation byproducts credit authorship contribution statement heejun suk methodology writing original draft kai wen zheng methodology zhong yi liao methodology ching ping liang writing review editing sheng wei wang writing review editing jui sheng chen conceptualization funding acquisition methodology writing original draft writing review editing declaration of competing interest the authors declare that they have no conflict of interest acknowledgments this research was funded by a research project supported by the taiwan epa the views or opinions expressed in this article are those of the authors and should not construed as the official point of view of the taiwan epa mention of tradenames vendor names or commercial products does not constitute endorsement or recommendation by the taiwan epa appendix a derivation of the proposed analytical solutions the temporal derivative of eq 5 will be first removed through application of the laplace transform through laplace transform eq 5 and the accompanying initial and boundary conditions in eqs 6 12 would be as followings d x 2 c i x y z s x 2 d y 2 c i x y z s y 2 d z 2 c i x y z s z 2 v c i x y z s x a1 s r i λ i c i x y z s ψ i λ i 1 c i 1 x y z s λ 0 0 i 1 4 subject to ϕ p v c i x 0 y z s ϕ p d x c i x 0 y z s x a2 v d c s s y 1 y y 2 a n d z 1 z z 2 i 1 0 e l s e w h e r e a n d i 2 4 i 1 4 a3 c i x y z s 0 i 1 4 a4 c i x y 0 z s y 0 i 1 4 a5 c i x y w z s y 0 i 1 4 a6 c i x y z 0 s z 0 i 1 4 a7 c i x y z h s z 0 i 1 4 where s is the laplace transform parameter c i x y z s is the laplace transformation of ci x y z t with respect to t which uses the following integral relations a8a c i x y z s l c i x y z t 0 e s t c i x y z t d t a8b l c i x y z t t 0 e s t c i x y z t t d t s c i x y z s c i x y z t 0 a8c l c i x y z t x 0 e s t c i x y z t x d t c i x y z s x a8d l 2 c i x y z t x 2 0 e s t 2 c i x y z t x 2 d t 2 c i x y z s x 2 through application of the double finite fourier cosine transform regarding y and z respectively we get a9 d x d 2 c i x m n s d x 2 v d c i x m n s d x θ i m n s c i x m n s ψ i λ i 1 c i 1 x m n s λ 0 0 i 1 4 a10 ϕ p v c i x 0 m n s ϕ p d x d c i x 0 m n s d x v d c s s φ y m φ z n i 1 0 i 2 4 a11 c i x m n s 0 i 1 4 where θ i m n s s r i d y m 2 π 2 w 2 d z n 2 π 2 h 2 λ i m and n are the two parameters for the double finite fourier cosine transforms c i x m n s is the double finite fourier cosine transformation of c i x y z s with respect to y and z which is represented by the following relations of double integrals a12 c i x m n s f y z c i x y z s 0 h 0 w c i x y z s c o s m π y w d y cos n π z h d z and a13 φ y m y 2 y 1 m 0 w m π sin m π y 2 w sin m π y 1 w m 1 2 a14 φ z n z 2 z 1 n 0 h n π sin n π z 2 h sin n π z 1 h n 1 2 the solutions to the ordinary differential equation ode system and their auxiliary boundary conditions as defined in eqs a9 a11 can be derived using the standard method for solving second order nonhomogeneous odes in the order of the degradation reaction the mathematical expressions of c i x m n s for species 1 4 can be indicated as follows a15 c 1 x m n s c s s φ y m φ z n ω 1 x m n s a16 c 2 x m n s c s s φ y m φ z n ψ 2 λ 1 α 21 s ω 2 x m n s ω 1 x m n s a17 c 3 x m n s c s s φ y m φ z n ψ 2 λ 1 ψ 3 λ 2 α 21 s ω 3 x m n s ω 2 x m n s α 32 s ω 3 x m n s ω 1 x m n s α 31 s a18 c 4 x m n s c s s φ y m φ z n ψ 2 λ 1 ψ 3 λ 2 ψ 4 λ 3 α 21 s 1 α 32 s ω 4 x m n s ω 3 x m n s α 43 s ω 4 x m n s ω 2 x m n s α 42 s 1 α 31 s ω 4 x m n s ω 3 x m n s α 43 s ω 4 x m n s ω 1 x m n s α 41 s where a19 ω i x m n s v e ξ i m n s x d x ξ i m n s v a20 ξ i m n s v v 2 4 d x θ i m n s 2 d x a21 α k j s r j r k s λ j λ k r j r k the original time space analytical solutions for individual species concentrations can be readily found by first performing the double inverse finite fourier cosine transform and then the inverse laplace transform inversion after performing the double inverse finite fourier cosine transform c i x y z s can be written as follows a22 c i x y z s f y z 1 c i x m n s y 2 y 1 w z 2 z 1 h a i x m 0 n 0 s 2 n 1 sin n π z 2 h sin n π z 1 h n π cos n π z h a i x m 0 n s 2 m 1 s i n m π y 2 w s i n m π y 1 w m π c o s m π y w z 2 z 1 h a i x m n 0 s 2 n 1 s i n n π z 2 h s i n n π z 1 h n π c o s n π z h a i x m n s i 1 4 where a23a a 1 x m n s c s s ω 1 x m n s a23b a 2 x m n s c s s ψ 2 λ 1 α 21 s ω 2 x m n s ω 1 x m n s a23c a 3 x m n s c s s ψ 2 λ 1 ψ 3 λ 2 α 21 s ω 3 x m n s ω 2 x m n s α 32 s ω 3 x m n s ω 1 x m n s α 31 s a23d a 4 x m n s c s s ψ 2 λ 1 ψ 3 λ 2 ψ 4 λ 3 α 21 s α 32 s ω 4 x m n s ω 3 x m n s α 43 s ω 4 x m n s ω 2 x m n s α 42 s c s s ψ 2 λ 1 ψ 3 λ 2 ψ 4 λ 3 α 21 s α 31 s ω 4 x m n s ω 3 x m n s α 43 s ω 4 x m n s ω 1 x m n s α 41 s here the inverse laplace transform is analytically executed with the aid of the three formulas in table a1 mathematical expressions for individual contaminant concentrations ci x y z t are sequentially given as a24 c i x y z t l 1 c i x y z s y 2 y 1 w z 2 z 1 h g i x m 0 n 0 t 2 n 1 sin n π z 2 h sin n π z 1 h n π cos n π z h g i x m 0 n t 2 m 1 sin m π y 2 w sin m π y 1 w m π cos m π y w z 2 z 1 h g i x m n 0 t 2 n 1 sin n π z 2 h sin n π z 1 h n π cos n π z h g i x m n t i 1 4 where a25 g i x m n t 0 t c s τ b i t τ d τ a26 b 1 t v π d x r 1 t e h 1 v x 2 d x o 1 t v 2 2 d x r 1 e v x d x o 1 t e r f c x 2 t r 1 d x v 2 d x r 1 t a27 b 2 t ψ 2 λ 1 γ 12 f 212 f 112 a28 b 3 t ψ 2 λ 1 ψ 3 λ 2 γ 12 f 312 f 323 f 212 f 223 γ 23 α 23 α 12 f 312 f 313 f 112 f 113 γ 13 α 13 α 12 b 4 t ψ 2 λ 1 ψ 3 λ 2 ψ 4 λ 3 γ 12 γ 23 γ 34 a 34 a 12 f 412 f 423 f 312 f 323 a 23 a 12 f 423 f 434 f 323 f 334 a 34 a 23 ψ 2 λ 1 ψ 3 λ 2 ψ 4 λ 3 γ 12 γ 23 γ 24 a 24 a 12 f 412 f 423 f 212 f 223 a 23 a 12 f 423 f 424 f 223 f 224 a 24 a 23 ψ 2 λ 1 ψ 3 λ 2 ψ 4 λ 3 γ 12 γ 13 γ 34 a 34 a 12 f 412 f 413 f 312 f 313 a 13 a 12 f 413 f 434 f 313 f 334 a 34 a 13 a29 ψ 2 λ 1 ψ 3 λ 2 ψ 4 λ 3 γ 12 γ 13 γ 14 a 14 a 12 f 412 f 413 f 112 f 113 a 13 a 12 f 413 f 414 f 113 f 114 a 14 a 13 a30 h 1 x t 1 4 d x r 1 x 2 t v 2 t r 1 f i j k v 2 u i j k d x r i v e v x 2 d x a j k t q i j k e r f c x 2 t r i d x u i j k t v 2 u i j k d x r i v e v x 2 d x a j k t q i j k e r f c x 2 t r i d x u i j k t a31 v 2 2 d x r i o i a j k e v x d x o i t e r f c x 2 t r i d x v 2 r i d x t a32 u i j k m n v 2 4 d x r i λ i r i d y r i m 2 π 2 w 2 d z r i n 2 π 2 h 2 a j k a33 q i j k u i j k r i d x x a34 o i λ i r i d y r i m 2 π 2 w 2 d z r i n 2 π 2 h 2 a35 γ j k r j r k a36 a j k λ j λ k r j r k 
109,the contamination of groundwater aquifers by chlorinated solvents is a water resource issue of great importance worldwide such contaminants are difficult to treat because they are often released as dense non aqueous phase liquids dnapls research shows that the application of remediation technologies to both the napl source and dissolved plume can lead to more efficient remediation rather than to either alone in these remediation efforts analytical models that evaluate behavior and fate of contaminants do provide a better understanding of the performance of these remedial technologies to the best of our knowledge there exist no analytical model of simulating the plume migration of multiple contaminants with capabilities of accounting for both napl source and plume remediation simultaneously and different retardation for original chlorinated solvent contaminant and its degradation byproducts in this study we present a new analytical model for remediating both napl source and downgradient contaminant plume in groundwater at sites contaminated with chlorinated solvents and their degradation products with different retardation factors as well as considering both napl source and plume remediation simultaneously a source model that accounts for the depletion of mass by the processes of dissolution or first order decay reactions corresponding with the removal or destruction of the source mass is coupled to a plume reactive transport model the source model is accounted for by relating source mass to the flux averaged source discharge concentration through a power function the developed analytical model considers 1 d advection 3 d dispersion first order decay reactions and ingrowth as well as linear isothermal equilibrium sorption the proposed analytical solution was derived through successive application of the laplace transform in time and the double finite fourier cosine transform regarding y and z the correctness of the analytical model and its auxiliary fortran computer program code are proved by showing excellent agreements between the simulated plume concentrations of all contaminants obtained from the derived analytical model and from a semi analytical model available in the literature application of the proposed analytical solutions illustrates that the use of identical retardation factors for all contaminants may lead to underestimation or overestimation of the mobility of the contaminants in cases when the retardation factors of the individual contaminants are greatly different from the identical retardation factor value adopted in all contaminants from the experiments on six scenarios corresponding six remedial treatments we found out that both the enhanced source decay and partial removal of source mass are main controlling factors at reducing the concentrations of all the contaminants whereas plume decay leads to effective reduction in the concentrations of pce however rather it causes unfavorable increases of the concentrations of the degradation byproducts ultimately the developed model is used to better understand the impacts of various possible combinations of remedial efforts and management decisions on remediation of the subsurface contamination and quantify the benefit of a certain remediation decision keywords napl source downgradient plume remediation chlorinated solvent analytical model retardation factor data availability no data was used for the research described in the article 1 introduction the contamination of groundwater aquifers by chlorinated solvents such as tetrachloroethene pce trichloroethene tce 1 1 1 trichloroethene tca and carbon tetrachloride ct is a water resource issue of great importance worldwide because of adverse effects such contaminants have on human health and to the environment as well as having an impact on sustainable use of groundwater resource it is difficult to restore chlorinated solvent contaminated groundwater sites because such solvents are often released as dense non aqueous phase liquids dnapls extensive research on the development of technology for the remediation of groundwater contaminated with the chlorinated solvent have been conducted over the past few decades experience with the remediation of chlorinated solvent contaminated groundwater sites for the reduction of contaminant concentrations below the requirements for safe drinking water standards e g maximum contaminant levels mcls has demonstrated that a mathematical model can be a very important tool during the decision making process analytical solutions of the advection dispersion equations ades are effective and practical tools for understanding contaminant plume migration evaluating remediation performance as well as calculating the exposure dose required for health risk assessment mcguire et al 2004 since most chlorinated solvent contaminated groundwater sites generally are characterized by the coexistence of the original contaminant and its degradation byproducts models that can simultaneously simulate the reactive transport of multiple contaminants than that of single contaminant are typically more useful for real world applications several multiple contaminant transport models have been presented in the literature where several ades combined with a sequential first order reaction network are simultaneously solved by analytical method but most of these have been limited only for one dimensional problems cho 1971 van genuchten 1985 sun and clement 1999 srinivasan and clement 2008a 2008b pérez guerrero et al 2009 2010 chen et al 2012a 2012b 2019a mieles and zhan 2012 suk 2013 2016 carr 2021 only a few analytical or semi analytic models are available for two or three dimensional multiple contaminant transport aziz et al 2000 bauer et al 2001 sudicky et al 2013 chen et al 2016 2019b perina 2021 liao et al 2021 among these the most popular analytical screening models is the public domain biochlor model by the center for subsurface modeling support of usepa aziz et al 2000 which described aquifer remediation by simulating natural attenuation process however the biochlor model requires the use of identical retardation factors for all contaminants moreover it also assumes time invariant source concentrations which implies no remediation of the napl source besides all other multi dimensional multi species analytical models did not account for the source decay either one of the most critical aspects associated with chlorinated solvent contaminated groundwater sites is the presence of dnapls in the subsurface environment serving as the continuing source of the downgradient plume if dnapls are present source remediation at a contaminated site may be required or advantageous to restore the aquifer to meet the mcls the remediation evaluation model for chlorinated solvents remchlor falta et al 2007 http www epa gov ada csmos models remchlor html is a screening level analytical model that can simultaneously accounts for both napl source and plume remediation it includes a dynamic source model following a power function relationship relating the napl source mass to the source discharge concentration similar to biochlor remchlor also requires the use of identical retardation factors for the original chlorinated solvent contaminant and its degradation byproducts however laboratory batch experiments have demonstrated different sorption coefficients retardation factors for distinct chlorinated solvent contaminants lu et al 2011 the retardation factor is an important transport parameter that significantly governs the movement of the contaminant it is designed to account for the sorption behaviors of contaminants in the aqueous phase onto the sorbed phase and highly depends on the composition of the mineral grains and the properties of the individual chlorinated solvent contaminants therefore assigning identical retardation factors for all chlorinated solvent contaminants would not be so realistic when simulating the plume migration of multiple contaminants with contaminant dependent retardation factors recently liao et al 2021 developed exact three dimensional analytical solutions to multi species advection dispersion equations coupled with a sequential first order degradation reaction network involving distinct retardation factors however liao et al 2021 simply considered a time invariant boundary source concentration and they did not account for source remediation to the best of our knowledge there exist no analytical model of simulating the plume migration of multiple contaminants with capabilities of accounting for both napl source and plume remediation simultaneously and different retardation for original chlorinated solvent contaminant and its degradation byproducts one thing to note is that the scope of the study is assumed to be limited to residual napl not free napl it means that our problem does not correspond to multiphase problem but reduces to multi species transport problem accordingly density and viscosity of napl do not affect movement of napl and water in this study the purpose of this study is thus to develop a new analytical screening level model that couples napl source and plume remediation in addition the newly developed model can use different retardation factors for the chlorinated solvent contaminant and its degradation products the present study is an extension of the work of liao et al 2021 for capability to handle source remediation as well as plume remediation clearly there is a practical need for the development of remediation evaluation models which can consider the effects of contaminant specific retardation factors along with coupled remediation of napl source and downgradient plume which will be illustrated later a fortran computer code is written for implementing the calculation of the newly developed analytical screening level model although the newly developed analytical model has superiority over existing analytical models in terms of dealing with multi species transport with contaminant specific retardation factors in the framework of cleaning both source and plume as like many previous analytical solutions it has inherent limitations of dealing with complex situation of nonuniform flow in heterogeneous media the proposed model might be a more practical tool for understanding and characterizing chlorinated solvent contaminated site where the source such as residual napl is remediated as well as the dissolved plume 2 development of new analytical model we develop new analytical model for describing three dimensional plume migration of a chlorinated solvent contaminant and its degradation byproducts in a groundwater system which has a geometry l w h as shown in fig 1 here l is the length w is the width and h is the height the residual napl source acts as continuing source of downgradient plume following falta et al 2005a 2005b the conceptual models and associated governing equations for source zone and downgradient plume zone are described below 2 1 source model remchlor considers a chlorinated solvent source model that uses conservation of mass and lumps the entire source zone into a single compartment falta et al 2005b by assuming that reduction of the dnapl source mass is caused by the removal by groundwater flowing through the source zone and additional first order decay resulting from the chemical or biological remedial technology the governing equation for conservation of the source mass is 1 d m t d t v d a c s t λ s m t where m t is the source mass at time t vd is the darcy flux a is the cross sectional area of source zone perpendicular to groundwater flow cs t is the flux averaged source discharge concentration of dissolved chlorinated solvent contaminant leaving the source zone at time t and λ s is the rate of first order source decay by remedial technology the source mass is related to the flux averaged source discharge concentration through a power function 2 c s t c s 0 m t m 0 γ where m 0 is the initial source mass c s 0 is the flux averaged source discharge concentration corresponding to the initial source mass the exponent γ is a parameter used for characterizing temporal change of the flux averaged source discharge concentration responding to time dependent source mass the solutions to eqs 1 and 2 can be obtained by falta et al 2007 3 m t v d a c s 0 λ s m 0 γ m 0 1 γ v d a c s 0 λ s m 0 γ e γ 1 λ s t 1 1 γ 4 c s t c s 0 m 0 γ v d a c s 0 λ s m 0 γ m 0 1 γ v d a c s 0 λ s m 0 γ e γ 1 λ s t γ 1 γ 2 2 downgradient plume model the downgradient plume migration of a chlorinated solvent contaminant and its degradation byproducts through the subsurface environment can be described by a set of ades sequentially coupled by a straight decay reaction network under the uniform flow condition the mathematical equations for the plume migrations will be governed by four important transport mechanisms namely one dimensional advection three dimensional hydrodynamic dispersion chain decay reactions and ingrowths as well as linear isotherm adsorption the reason for considering a three dimensional mass flux despite a one dimensional flow is that mass transfer in three directions can occur especially if the flow is slow in addition since groundwater flows are governed by darcy s law the reynolds number must be less than 1 10 when darcy s law is valid fetter 1994 the governing equations for plume migration of each of the compounds is d x 2 c i x y z t x 2 d y 2 c i x y z t y 2 d z 2 c i x y z t z 2 v c i x y z t x λ i c i x y z t ψ i λ i 1 c i 1 x y z t 5 r i c i x y z t t λ 0 0 i 1 4 where ci x y z t represents the contaminant concentration of the plume for species i ml 3 x y and z indicate the cartesian coordinates l t is the time t v is the x directional pore velocity lt 1 dx dy and dz are the dispersion coefficients in the x y and z directions respectively l2t 1 λ i is the first decay constant for species i t 1 ψ i is the yield coefficient between species i and its parent species i 1 ri the retardation factor for species i note that in eq 5 each species can be assigned as contaminant dependent retardation factors it is assumed that x direction is aligned along groundwater velocity initial concentration of species i is assumed to be zero across the entire area 6 c i x y z t 0 0 i 1 4 it is assumed that mass discharge leaves the contaminant source zone acting as a continuing source of the downgradient plume based on the conservation of contaminant mass at the interface where source mass enters the plume area the boundary condition for the plume area is specified as follows ϕ p v c i x 0 y z t ϕ p d x c i x 0 y z t x 7 v d c s t y 1 y y 2 a n d z 1 z z 2 a n d i 1 0 e l s e w h e r e a n d i 2 4 i 1 4 where ϕ p is the porosity of the plume area y 1 y 2 z 1 and z 2 are spatial coordinate values for representing rectangular area of source mass zone as schematically depicted in fig 1 to simplify the derivation procedure for the analytical solution the outlet boundary conditions are specified at infinity 8 c i x y z t 0 i 1 4 assuming no contaminant mass flux of individual contaminant flow across two end boundaries along y axis and z axis respectively we specify the following four boundary conditions as follows 9 c i x y 0 z t y 0 i 1 4 10 c i x y w z t y 0 i 1 4 11 c i x y z 0 t z 0 i 1 4 12 c i x y z h t z 0 i 1 4 to derive analytical solutions to the initial boundary value problem in eqs 5 12 combination of laplace transform and the double finite fourier cosine transform are utilized the details of the solution derivation are provided in appendix a 3 results and discussion 3 1 verification of the proposed analytical solutions the model verification is performed by comparing the simulated results obtained from our derived solutions against those generated from a semi analytical model chen et al 2019b found in the literature the semi analytical model was developed for simulating the three dimensional reactive plume migration of multiple contaminants resulting from a rectangular patch source with time dependent exponential decay of the boundary source concentration the scenario for the verification comparison is adopted from tutorial 6 of remchlor it assumes a hypothetical release of 1620 kg pce source mass m 0 at the initial time the dimensions of the discharge plane of the source zone are specified by y 1 45 m y 2 55 m z 1 3 5 m and z 2 6 5 m the source mass and the flux averaged concentration of dissolved pce leaving the source zone are assumed to follow the power law relationship with an exponent γ of 1 that leads to the exponential decay functions of the source mass m t and flux averaged source concentration cs t with time the initial flux averaged source concentration c s 0 is 100 mg l pce is assumed to go through reductive dechlorination to a series of degradation byproducts pce tetrachloroethylene tce trichloroethylene dce dichloroethene vc vinyl chloride in order to verify the proposed analytical solutions by comparing those against results obtained using remchlor and previous analytical model in chen et al 2019b all contaminants are assigned the same retardation factors of 2 because remchlor requires the use of the identical retardation factors for the original chlorinated solvent contaminant and its degradation byproducts the aquifer properties and contaminant parameters for the verification exercise are summarized in table 1 the summary of aquifer properties and contamination parameters in this exercise is shown in table 1 it should be noted that the previous semi analytical model in chen et al 2019b did not consider the yield coefficient thus yield coefficients for all contaminants are set to be 1 the concentration profiles of pce and its degradation byproducts tce dce and vc along the plume centerline at t 30 years from our proposed analytical solution and semi analytical solutions of chen et al 2019b respectively are compared each other in fig 2 although pce concentrations decrease with distance from the source tce dce and vc do not decrease with distance from the source as their own species of tce dce and vc are produced due to the decomposition of their own parent species accordingly away from the source concentrations of daughter species such as tce and dce are larger than concentration of their parent species such as pce and tce respectively as shown in fig 2 however vc concentration is not larger than dce concentration because its own degradation constant is large in table 1 as expected in the verification exercise the spatial concentration profiles of the four contaminants generated in the two solutions closely match the verification example obviously demonstrates the correctness of our analytical solutions in order to show computational efficiency of this proposed analytical solution computational execution times of intel r core tm i5 8250u cpu 1 60ghz computer with microsoft windows 10 operating system for calculating one observation in fig 2 were shown in table 2 3 2 effects of retardation factors on the plume migration of multiple contaminants the merit of the derived analytical model is that the pce and its degradation byproducts can have their own specific retardation factors rather than identical retardation factors for all contaminants in remchlor therefore this section uses a derived analytical model to examine how retardation factors of multiple contaminants have effects on plume migration the scenario is the same as the previous verification example except the use of contaminant dependent retardation factor values for pce and its degradation compounds the verification example that uses identical retardation factors for all contaminant serves as a baseline simulation for comparison in order to analyze the effects of the contaminant dependent retardation factors on the plume migration the following retardation factor values from pce tce dce to vc are 7 2 2 1 8 and 1 5 respectively besides retardation factors initial source mass initial source concentration darcy velocity porosity source decay constant empirical parameter for characterizing source discharge concentration to source mass cross sectional area of source zone perpendicular to groundwater flow domain size dispersion coefficient plume degradation constant yield coefficients and simulation time are summarized in table 3 the dimensions of the discharge plane of the source zone are specified by y 1 45 m y 2 55 m z 1 3 5 m and z 2 6 5 m fig 3 compares the spatial concentration profiles of pce and its degradation byproducts at 5 years along the plume centerline obtained with the contaminant dependent retardation factor values and those obtained with identical retardation factor values for all contaminants here the identical retardation factor of 2 corresponds to median of retardation factors of all contaminants in case that pce rpce 7 retardation factor value is much greater than the identical retardation factor value of 2 the simulated results obtained using identical retardation factors predict faster mobility of the pce plume than would be produced using contaminant dependent retardation factors as shown in fig 3 moreover although tce rtce 2 2 dce rdce 1 8 and vc rvc 1 5 retardation factor values are similar to or less than the identical retardation factor value migration of contaminant plumes of tce dce and vc adopting the contaminant dependent retardation factors are slower than using the identical retardation factor value as shown in fig 3 since tce dce and vc are the degradation byproducts from pce the mobility of these contaminants will be governed by the retardation factor of their parent contaminant species pce as well as their own retardation factors the results clearly illustrate that when predictive analytical model uses the same retardation factor for all contaminants simulations of plume migration of chlorinated solvent contaminant and of its degradation byproducts with different retardation factor values are not correct also we obtained concentration spatial concentrations of all species by assigning same retardation factor values of 3 1 as arithmetic average of individual retardation factor to all contaminants and compared those with results obtained with different retardation factor of individual species in fig 3 thus we can evaluate whether difference between results obtained using same retardation of arithmetic average and using distinct retardation of individual species are smaller or not than difference between results using same retardation of median and using distinct retardation as shown in fig 3 in this specific example concentration spatial concentrations of pce tce dce and vc obtained using same retardation factor of arithmetic averages are closer to those obtained using different retardation factors than those using same retardation factor of median also when concentration distributions of all contaminants are obtained using same retardation factor all contaminants show the similar moving distance as shown in fig 3 however from concentration distributions obtained using distinct retardation of individual species all contaminants show different migrating velocities as shown in fig 3 for instance in the case of different retardation travelled distance of vc at 5 years is about three time greater than that of pce but that of vc is same as that of pce in the same retardation case 3 3 effect of power function on downgradient plume migration in this study a power function with an exponent γ is used to characterize the relationship between the source mass and the source discharge concentration it is interested in investigating how the exponent γ which specifies a power function affects the downgradient plume migration of multiple contaminants the same scenario as described in section 3 2 is considered except different values of the exponent γ are used to investigate the effect of the power function on downgradient plume migration so all input conditions for simulation follows those in table 3 except different values of the exponent γ here various γ of 0 5 1 and 2 are adopted figs 4 and 5 depict comparison of the spatial concentration profiles of pce tce dce and vc along the plume centreline at t 5 and 10 years obtained using different values of exponent γ 0 5 1 and 2 respectively as can be clearly seen in figs 4 and 5 the predicted concentrations of pce tce dce and vc all increase with decreasing γ the explanation of the above observation can be found out that the same source mass with smaller exponent γ will produce higher level source discharge concentration according to eq 4 as well as occur downgradient migration of contaminant plume with higher concentration as time goes by the discharge concentration decreases with time and thus the inlet concentration of pce decreases with time as shown in fig 5 in addition the locations of the highest concentration of all contaminants become further away from the source over time and the plumes of all contaminants get more spreading over time contrary to pce the peak concentrations of dce and vc increase over time the reason is that the rates of its own production from the decay of parent contaminants are greater than the rates of its own decay field experiment at dover site suggested that the power function of an exponent of 1 would appropriately characterize the relation between source mass and source discharge concentration fure al 2006 falta et al 2005a showed a numerical simulations of a hypothetical two dimensional multiphase flow system composed of homogeneous hydrogeological media and several distinct dnapl pools and concluded that the relationship between the source mass and source discharge concentration depends largely on the correlation between the dnapl distribution and the permeability same source mass placed in a hydrogeological material with higher permeability will produce a higher source discharge concentration which corresponds to the case of a power function with an exponent γ smaller than 1 the physical significance of this case is that if most of the contaminant mass is located on a pathway with higher permeability most of it must be removed before concentration of downgradient plume at receptor exceeds mcls 3 4 application of the developed analytical solutions the evolution of a dissolved contaminant plume depends on the amount of napl mass and the architecture of the contaminant napl source the timing and effectiveness of remediation of napl source and the plume as well as site specific hydrogeology and geochemistry the implementation of active chemical and biological remedial efforts in contaminated areas in several studies have demonstrated that chemical or biological degradation of napl source areas are viable remediation strategies in some sites nrc national research coucile 2005 stroo et al 2012 therefore the analytical model developed in this study is used to simulate pollutant plume evolution following source and plume treatment to evaluate the efficiency of the remediation process due to the removal of source mass and enhancement of the napl source and plume decay rate aquifer properties and contaminant parameters used in the previous section to analysis the effect of retardation coefficients on the downgradient plume migration of multiple contaminants are adopted in the baseline scenario which does not consider active chemical or biological treatments but only considers natural attenuation here six remedial treatments are considered to evaluate individual processes on remediation efficiency 1 natural attenuation 2 partial napl source mass removal 3 enhanced source decay due to biological or chemical treatment 4 enhanced plume decay due to biological or chemical treatment 5 partial napl source mass removal and enhanced plume decay due to biological or chemical treatment and 6 both enhanced source and plume decay partial removal of napl source mass means simply reducing the initial source mass by 10 after one year the enhanced source decay is considered by increasing the source decay rate constant from 0 to 0 1 year 1 enhanced plume decay remediation is taken account by doubling the plume decay rate constants of all contaminants corresponding to natural attenuation the detail input and condition of all six simulations above are shown well in table 4 fig 6 presents the spatial concentration profiles from pce to vc on the plume centerline produced using our developed analytical model the lowest pce concentrations are generated for the enhanced source and plume decay followed by enhanced source decay partial removal of source mass and enhanced plume decay partial removal of source mass enhanced plume decay and natural attenuation in ascending order for the other degradation compounds including tce dce and vc the magnitudes of the contaminant concentrations in ascending sequence are produced by the following scenario sequence the enhanced source decay partial removal of source mass natural attenuation enhanced source and plume decay partial removal of source mass and enhanced plume decay and enhanced plume decay similar conclusion can be observed in breakthrough curves at 10 m distance from source as shown in fig 7 however as time goes by for enhanced source decay concentration of all contaminants drops quickly with time as shown in fig 7 because source concentration according to eq 4 is decreasing over time it should be emphasized that both the enhanced source decay and partial removal of source mass are main controlling factors at reducing the concentrations of all the contaminants although the enhanced plume decay leads to effective reduction in the concentrations of pce however it causes rather an unfavorably increase in the concentrations of the degradation products finally it can be concluded that the developed analytical model provides an important tool for determining the best choice of remedial alternative 4 conclusions a novel analytical model for considering remediation of napl source and downgradient plume at groundwater contamination site contaminated by chlorinated solvents and their degradation byproducts is developed to predict concentration distributions of multiple contaminants in this study the proposed analytical model can account for both napl source and plume remediation simultaneously and different retardation for original chlorinated solvent contaminant and its degradation byproducts the new analytical solution is featured by the fact that chlorinated solvents and decomposition byproducts can have their unique retardation factor rather than using the same retardation factor values as well as remediation of napl source and downgradient plume can be considered the model considers 1 d advection 3 d dispersion first order decay reactions and ingrowth as well as linear isothermal equilibrium sorption the proposed analytical solution was derived through successive application of the laplace transform in time and the double finite fourier cosine transform regarding y and z the results of a verification exercise indicate that there is excellent agreement between the simulated results produced using our proposed model and semi analytical solutions by chen et al 2019b application of the proposed analytical solutions illustrates that the use of identical retardation factors for all contaminants may lead to underestimation or overestimation of the mobility of the contaminants in cases when the retardation factors of the individual contaminants are greatly different from the identical retardation factor value adopted in all contaminants our proposed model shows that the predicted concentrations of pce tce dce and vc at the downgradient site all increase with decreasing the exponent of the power function characterizing the relationship between the source mass and source discharge concentration from the numerical experiments on six scenarios corresponding six remedial treatments we found out that both the enhanced source decay and partial removal of source mass are main controlling factors at reducing the concentrations of all the contaminants whereas plume decay leads to effective reduction in the concentrations of pce however rather it causes unfavorable increases of the concentrations of the degradation byproducts credit authorship contribution statement heejun suk methodology writing original draft kai wen zheng methodology zhong yi liao methodology ching ping liang writing review editing sheng wei wang writing review editing jui sheng chen conceptualization funding acquisition methodology writing original draft writing review editing declaration of competing interest the authors declare that they have no conflict of interest acknowledgments this research was funded by a research project supported by the taiwan epa the views or opinions expressed in this article are those of the authors and should not construed as the official point of view of the taiwan epa mention of tradenames vendor names or commercial products does not constitute endorsement or recommendation by the taiwan epa appendix a derivation of the proposed analytical solutions the temporal derivative of eq 5 will be first removed through application of the laplace transform through laplace transform eq 5 and the accompanying initial and boundary conditions in eqs 6 12 would be as followings d x 2 c i x y z s x 2 d y 2 c i x y z s y 2 d z 2 c i x y z s z 2 v c i x y z s x a1 s r i λ i c i x y z s ψ i λ i 1 c i 1 x y z s λ 0 0 i 1 4 subject to ϕ p v c i x 0 y z s ϕ p d x c i x 0 y z s x a2 v d c s s y 1 y y 2 a n d z 1 z z 2 i 1 0 e l s e w h e r e a n d i 2 4 i 1 4 a3 c i x y z s 0 i 1 4 a4 c i x y 0 z s y 0 i 1 4 a5 c i x y w z s y 0 i 1 4 a6 c i x y z 0 s z 0 i 1 4 a7 c i x y z h s z 0 i 1 4 where s is the laplace transform parameter c i x y z s is the laplace transformation of ci x y z t with respect to t which uses the following integral relations a8a c i x y z s l c i x y z t 0 e s t c i x y z t d t a8b l c i x y z t t 0 e s t c i x y z t t d t s c i x y z s c i x y z t 0 a8c l c i x y z t x 0 e s t c i x y z t x d t c i x y z s x a8d l 2 c i x y z t x 2 0 e s t 2 c i x y z t x 2 d t 2 c i x y z s x 2 through application of the double finite fourier cosine transform regarding y and z respectively we get a9 d x d 2 c i x m n s d x 2 v d c i x m n s d x θ i m n s c i x m n s ψ i λ i 1 c i 1 x m n s λ 0 0 i 1 4 a10 ϕ p v c i x 0 m n s ϕ p d x d c i x 0 m n s d x v d c s s φ y m φ z n i 1 0 i 2 4 a11 c i x m n s 0 i 1 4 where θ i m n s s r i d y m 2 π 2 w 2 d z n 2 π 2 h 2 λ i m and n are the two parameters for the double finite fourier cosine transforms c i x m n s is the double finite fourier cosine transformation of c i x y z s with respect to y and z which is represented by the following relations of double integrals a12 c i x m n s f y z c i x y z s 0 h 0 w c i x y z s c o s m π y w d y cos n π z h d z and a13 φ y m y 2 y 1 m 0 w m π sin m π y 2 w sin m π y 1 w m 1 2 a14 φ z n z 2 z 1 n 0 h n π sin n π z 2 h sin n π z 1 h n 1 2 the solutions to the ordinary differential equation ode system and their auxiliary boundary conditions as defined in eqs a9 a11 can be derived using the standard method for solving second order nonhomogeneous odes in the order of the degradation reaction the mathematical expressions of c i x m n s for species 1 4 can be indicated as follows a15 c 1 x m n s c s s φ y m φ z n ω 1 x m n s a16 c 2 x m n s c s s φ y m φ z n ψ 2 λ 1 α 21 s ω 2 x m n s ω 1 x m n s a17 c 3 x m n s c s s φ y m φ z n ψ 2 λ 1 ψ 3 λ 2 α 21 s ω 3 x m n s ω 2 x m n s α 32 s ω 3 x m n s ω 1 x m n s α 31 s a18 c 4 x m n s c s s φ y m φ z n ψ 2 λ 1 ψ 3 λ 2 ψ 4 λ 3 α 21 s 1 α 32 s ω 4 x m n s ω 3 x m n s α 43 s ω 4 x m n s ω 2 x m n s α 42 s 1 α 31 s ω 4 x m n s ω 3 x m n s α 43 s ω 4 x m n s ω 1 x m n s α 41 s where a19 ω i x m n s v e ξ i m n s x d x ξ i m n s v a20 ξ i m n s v v 2 4 d x θ i m n s 2 d x a21 α k j s r j r k s λ j λ k r j r k the original time space analytical solutions for individual species concentrations can be readily found by first performing the double inverse finite fourier cosine transform and then the inverse laplace transform inversion after performing the double inverse finite fourier cosine transform c i x y z s can be written as follows a22 c i x y z s f y z 1 c i x m n s y 2 y 1 w z 2 z 1 h a i x m 0 n 0 s 2 n 1 sin n π z 2 h sin n π z 1 h n π cos n π z h a i x m 0 n s 2 m 1 s i n m π y 2 w s i n m π y 1 w m π c o s m π y w z 2 z 1 h a i x m n 0 s 2 n 1 s i n n π z 2 h s i n n π z 1 h n π c o s n π z h a i x m n s i 1 4 where a23a a 1 x m n s c s s ω 1 x m n s a23b a 2 x m n s c s s ψ 2 λ 1 α 21 s ω 2 x m n s ω 1 x m n s a23c a 3 x m n s c s s ψ 2 λ 1 ψ 3 λ 2 α 21 s ω 3 x m n s ω 2 x m n s α 32 s ω 3 x m n s ω 1 x m n s α 31 s a23d a 4 x m n s c s s ψ 2 λ 1 ψ 3 λ 2 ψ 4 λ 3 α 21 s α 32 s ω 4 x m n s ω 3 x m n s α 43 s ω 4 x m n s ω 2 x m n s α 42 s c s s ψ 2 λ 1 ψ 3 λ 2 ψ 4 λ 3 α 21 s α 31 s ω 4 x m n s ω 3 x m n s α 43 s ω 4 x m n s ω 1 x m n s α 41 s here the inverse laplace transform is analytically executed with the aid of the three formulas in table a1 mathematical expressions for individual contaminant concentrations ci x y z t are sequentially given as a24 c i x y z t l 1 c i x y z s y 2 y 1 w z 2 z 1 h g i x m 0 n 0 t 2 n 1 sin n π z 2 h sin n π z 1 h n π cos n π z h g i x m 0 n t 2 m 1 sin m π y 2 w sin m π y 1 w m π cos m π y w z 2 z 1 h g i x m n 0 t 2 n 1 sin n π z 2 h sin n π z 1 h n π cos n π z h g i x m n t i 1 4 where a25 g i x m n t 0 t c s τ b i t τ d τ a26 b 1 t v π d x r 1 t e h 1 v x 2 d x o 1 t v 2 2 d x r 1 e v x d x o 1 t e r f c x 2 t r 1 d x v 2 d x r 1 t a27 b 2 t ψ 2 λ 1 γ 12 f 212 f 112 a28 b 3 t ψ 2 λ 1 ψ 3 λ 2 γ 12 f 312 f 323 f 212 f 223 γ 23 α 23 α 12 f 312 f 313 f 112 f 113 γ 13 α 13 α 12 b 4 t ψ 2 λ 1 ψ 3 λ 2 ψ 4 λ 3 γ 12 γ 23 γ 34 a 34 a 12 f 412 f 423 f 312 f 323 a 23 a 12 f 423 f 434 f 323 f 334 a 34 a 23 ψ 2 λ 1 ψ 3 λ 2 ψ 4 λ 3 γ 12 γ 23 γ 24 a 24 a 12 f 412 f 423 f 212 f 223 a 23 a 12 f 423 f 424 f 223 f 224 a 24 a 23 ψ 2 λ 1 ψ 3 λ 2 ψ 4 λ 3 γ 12 γ 13 γ 34 a 34 a 12 f 412 f 413 f 312 f 313 a 13 a 12 f 413 f 434 f 313 f 334 a 34 a 13 a29 ψ 2 λ 1 ψ 3 λ 2 ψ 4 λ 3 γ 12 γ 13 γ 14 a 14 a 12 f 412 f 413 f 112 f 113 a 13 a 12 f 413 f 414 f 113 f 114 a 14 a 13 a30 h 1 x t 1 4 d x r 1 x 2 t v 2 t r 1 f i j k v 2 u i j k d x r i v e v x 2 d x a j k t q i j k e r f c x 2 t r i d x u i j k t v 2 u i j k d x r i v e v x 2 d x a j k t q i j k e r f c x 2 t r i d x u i j k t a31 v 2 2 d x r i o i a j k e v x d x o i t e r f c x 2 t r i d x v 2 r i d x t a32 u i j k m n v 2 4 d x r i λ i r i d y r i m 2 π 2 w 2 d z r i n 2 π 2 h 2 a j k a33 q i j k u i j k r i d x x a34 o i λ i r i d y r i m 2 π 2 w 2 d z r i n 2 π 2 h 2 a35 γ j k r j r k a36 a j k λ j λ k r j r k 
