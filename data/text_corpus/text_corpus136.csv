index,text
680,a notable drawback in mixed size sediment morphodynamic modeling is the fact that the most commonly used mathematical model in this field i e the active layer model hirano 1971 can be ill posed under certain circumstances under these conditions the model loses its predictive capabilities as negligible perturbations in the initial or boundary conditions produce significant differences in the solution in this paper we propose a preconditioning method that regularizes the model to recover well posedness by altering the time scale of the sediment mixing processes we compare results of the regularized model to data from four new laboratory experiments conducted under conditions in which the active layer model is ill posed the regularized active layer model captures the change of bed elevation and surface texture averaged over the passage of several bedforms neither the active layer model nor the regularized one account for small scale changes due to individual bedforms 1 introduction the presence of mixed size sediment is a key feature of rivers sediment sorting patterns develop in the streamwise direction e g the characteristic downstream fining profile sternberg 1875 in the transverse direction e g bend sorting allen 1970 and in the vertical direction e g bed armoring parker and klingeman 1982 and dune sorting blom et al 2003 modeling applications in which the mixed size character of river morphodynamics is not negligible mandate the use of a suitable continuity model accounting for mass conservation of each of the considered sediment size fractions hirano 1971 was the first to develop a mixed sediment continuity model he assumed that the river bed can be vertically divided into an active top part the active layer which interacts with the flow and an inactive substrate in the model sediment transport and friction depend on the texture of the active layer whereas the sediment in the substrate only plays a role if net aggradation creates new substrate sediment or net degradation leads to the entrainment of substrate sediment into the active layer although it has been fruitfully used to represent physical phenomena related to mixed sediment for nearly half a century see chavarrías et al 2018 the active layer model suffers from a drawback under certain conditions it becomes ill posed chavarrías et al 2018 ribberink 1987 stecca et al 2014 a model is ill posed if a unique solution does not exist or if the solution does not depend continuously on the initial and boundary conditions hadamard 1923 if a model is ill posed infinitesimal variations in the initial or boundary conditions yield a significant deviation of the solution within an infinitesimal time hadamard 1923 when solving the mathematical model by numerical approximations perturbations in the initial and boundary conditions simply arise by truncation errors this makes an ill posed model unsuitable in practice the problem of ill posedness arises from an inaccurate representation of the physical processes joseph and saut 1990 for instance a two fluid model for incompressible and inviscid flow in two layers with a velocity discontinuity is ill posed von helmholtz 1868 kelvin 1871 it is regularized i e becomes well posed if viscous effects are taken into account joseph and saut 1990 from this perspective the preferred approach to regularize the active layer model would be the development of a new model that includes those physical mechanisms that are not accounted for by the active layer model there exist alternatives to the active layer that typically aim to improve the physical description of sediment mixing process ribberink 1987 introduced a second layer to account for the mixing due to dunes exceptionally larger than the average dune height besides producing a vertical sorting profile that better reproduces the results of a laboratory experiment blom 2008 ribberink s two layer model makes the occurrence of ill posedness less likely although it does not completely avoid it sieben 1994 luu et al 2006 2004 proposed a model in which the active layer is replaced by the sediment transport layer representing the sediment in transport rather than the sediment at the bed surface the thickness of the sediment transport layer is estimated with a closure relation such as the one developed by egashira and ashida 1992 although conceptually different the model by luu et al 2006 2004 is mathematically equivalent to the active layer model which implies that it can also be ill posed blom and parker 2004 and blom et al 2006 2008 developed a model in which both bed elevation and bed grain size distribution are treated using a vertically continuous formulation parker et al 2000 this implies that there is no distinction between the active and inactive part of the bed the model by blom and coauthors satisfactorily describes the vertical stratigraphy due to dunes at laboratory scale but it requires a time step too small to be applicable at large scale moreover its well posedness has not been studied simplifying the continuous framework proposed by parker et al 2000 the vertically continuous model by viparelli et al 2017 overcomes the need for a small time step although applicable at large spatial and temporal scales their model does not solve the problem of ill posedness chavarrías et al 2018 given the facts that a there is not yet a practically feasible alternative to the active layer model b the active layer model remains well posed over a large range of applications chavarrías et al 2018 and c it is a computationally cheap model implemented in several software packages here our objective is to develop a strategy to avoid ill posedness while maintaining the conceptual framework of the active layer model to this end we develop a regularization strategy that recovers well posedness of the active layer model and we conduct 4 laboratory experiments under conditions in which the active layer model is ill posed to obtain data to which we compare the results of our regularized model the paper is organized as follows in section 2 we review strategies for regularizing ill posed models in section 3 we present the regularization strategy section 4 presents the laboratory experiments and section 5 focuses on the numerical runs to reproduce the experimental results in section 6 we discuss the limitations of the regularization strategy as well as other possible modeling strategies 2 overview of regularization techniques in this section we review techniques used to regularize ill posed problems propagation problems are most completely mathematically represented by a set of partial differential equations constituting an initial value problem in these problems an initial state changes with time subject to conditions at the boundaries of the domain the matrix vector formulation provides a compact expression of the set of equations e g courant and hilbert 1989 lyn and goodwin 1987 toro 2001 1 q t a q x s where q is the vector of dependent variables a is the system matrix and s is the vector of source terms the velocity at which small waves propagate throughout the domain i e the eigenvalues of matrix a must be real for the problem to be well posed e g hadamard 1923 ivrii and petkov 1974 kabanikhin 2008 lax 1957 1958 1980 mizohata 1961 when the eigenvalues are real the problem is hyperbolic if the eigenvalues have an imaginary component the problem being elliptic or of mixed type an initial value problem is ill posed the two fluid shallow flow model i e a model of the flow of two layers of superimposed fluids at different velocities is known to be ill posed when the difference in flow velocity between the upper and lower layers exceeds a certain threshold ardron 1980 armi 1986 lawrence 1990 long 1956 pelanti et al 2008 in general terms ill posedness arises in multiphase models e g bubbles in a fluid harlow and amsden 1975 kumbaro and ndjinga 2011 murray 1965 stewart 1979 stewart and wendroff 1984 multiphase models are regularized by accounting for the forces at the interface between the two fluids abgrall and karni 2009 drew et al 1979 liska et al 1995 lyczkowski et al 1978 ramshaw and trapp 1978 stewart 1979 stuhmiller 1977 tiselj and petelin 1997 travis et al 1976 although the physics of multiphase problems is better represented when including the effects of the interface forces this approach does not completely eliminate the possibility of the problem being ill posed fernández nieto 2003 castro díaz et al 2011 and sarno et al 2017 introduce an additional term in the momentum equations to account for friction between the fluid layers their regularization strategy yields a well posed model and has a physical origin however the additional physical term depends on the time step of the numerical solution which implies that it cannot be considered a fully physically based solution the numerical solution of a mathematically ill posed model can be well posed chen and peng 2006 chen et al 2007 savary and zech 2007 spinewine et al 2011 if the numerical solution neglects information in the physical equations greco et al 2008 worded differently in such a case the physical equations are ill posed but the numerical equations that we actually solve are well posed in particular when using the hll solver a common approximate riemann solver proposed by harten et al 1983 see toro 2009 one only uses the fastest and slowest eigenvalues of the system which implies that the dynamics due to the intermediate celerities are not resolved this hides the problem of ill posedness rather than solves it in determining the steady equilibrium state of a fluid dynamics problem a commonly adopted strategy to achieve fast convergence is to modify the celerities at which information propagates i e the system eigenvalues chorin 1967 grabowski and berger 1976 plows 1968 soh and berger 1984 for instance in aerodynamics the speed of sound may differ significantly from the air velocity which causes a slow convergence to steady state choi and merkle 1993 feng and merkle 1990 godfrey et al 1993 van leer et al 1991 preconditioning methods turkel 1987 1993 1999 aim at bringing the eigenvalues of the system closer to each other such that a larger time step is allowed analogously the bed celerity i e the speed of the wave related to changes in bed elevation lyn and altinakar 2002 morris and williams 1996 stecca et al 2014 de vries 1965 is generally slow compared to the celerities associated with perturbations of the flow this fact has encouraged the use of a morphodynamic acceleration factor in morphodynamic modeling to reduce the computational time latteux 1995 lesser et al 2004 ranasinghe et al 2011 roelvink 2006 mathematically as we will show later the use of a morphodynamic acceleration factor is equivalent to the application of a particular preconditioning method by altering the celerity at which information propagates the transient state of the preconditioned problem is altered with respect to the original problem but both problems converge to the same steady state solution if the boundary conditions are steady a drawback of preconditioning is the fact that when the problem is subject to unsteady boundary conditions preconditioning methods modify the steady state as they indirectly modify the timing of the boundary conditions turkel 1999 for this reason the boundary conditions of a preconditioned model need to be adjusted if these vary with time the fact that a preconditioning method alters the transient state was used by zanotti et al 2007 to regularize the two fluid model they modified the system of equations by introducing two parameters one parameter modifies the continuity equation which affects the imaginary part of the eigenvalues depending on the relations between velocities and densities of the two fluids a specific value of this parameter makes the imaginary part equal to zero apart from modifying the imaginary component the parameter also modifies the real part of the eigenvalues they introduce a second parameter that affects all equations to recover the original real part of the eigenvalues they compare the solution of the regularized model to analytical solutions and they show that the regularized two fluid model is stable in the next section we will follow a similar approach to derive a regularization strategy for the active layer model 3 regularization strategy for the active layer model in this section we propose a strategy for recovering the well posed character of the system of equations for modeling mixed sediment river morphodynamics the modified set of equations is presented in section 3 1 in section 3 2 we derive the parameters used to recover the well posed character of the model considering a simplified case with two sediment size fractions and steady flow which allows us to obtain analytical expressions we then extend the validity to unsteady flow conditions section 3 3 and to conditions with more than 2 sediment size fractions section 3 4 in section 3 5 we discuss the implementation of the strategy 3 1 modified system of equations we consider one dimensional hydrostatic flow over a bed composed of n non cohesive size fractions the flow is described by the saint venant 1871 equations we assume a chézy type friction in which the nondimensional friction coefficient is independent of the flow and bed parameters the sediment transport rate is considered to adapt instantaneously to changes in the bed shear stress bell and sutherland 1983 the mass conservation of the bed sediment is described by the exner 1920 equation and the n 1 active layer equations hirano 1971 account for the conservation of the mass of each grain size fraction within a discrete top layer of the bed surface i e the active layer given the flow friction and sediment transport assumptions the model cannot represent small scale processes i e processes at the scale of bed elevation fluctuations due the stochastic nature of sediment transport ripples dunes or bed load sheets in other words the variables represent parameters averaged over a period larger than the characteristic time of small scale bed elevation fluctuations armanini and di silvio 1988 blom et al 2008 parker et al 2000 ribberink 1987 wong and parker 2006 we refer to appendix a for the model equations and the matrix vector formulation of the system analogous to zanotti et al 2007 section 2 the system of equations in equation 1 is modified multiplying the time derivative term by a diagonal matrix m to regularize the problem 2 m q t a q x s matrix m modifies the transient state only the preconditioning technique does not affect the solution of the steady state i e t 0 the morphodynamic model under unisize conditions was analyzed by cordier et al 2011 they found that the saint venant exner model is always well posed assuming a chézy type friction this confirms that the ill posed character of the mixed size sediment model results from the inappropriate representation of the mixing processes by the active layer model chavarrías et al 2018 for this reason we propose a regularization strategy that recovers the well posed character modifying the celerities at which mixed sediment processes occur this is done by means of a set of parameters αk for 1 k n 1 that multiply the time derivative of each active layer equation similarly to zanotti et al 2007 we consider a parameter β that can be used to rescale the celerities after being modified by αk we stipulate that this parameter β affects only the sediment processes including the exner 1920 equation but not the flow the modified system of equations must be mass conservative with respect to the sediment this implies that αk cannot be grain size dependent i e α k α k and that the preconditioning technique is only applicable when the active layer thickness is constant appendix b 3 2 derivation of the regularization coefficients in this section we derive the values of the coefficients α and β that enable regularization of the active layer model we consider a simplified case with two sediment size fractions under steady flow conditions as this allows us to obtain analytical expressions of the regularization parameters in this case the dependent variables of the system are the bed elevation η m and the volume of fine sediment in the active layer per unit of bed area m a1 chavarrías et al 2018 and appendix a 3 q s 2 η m a 1 the system matrix is 4 a s 2 u λ b λ s 1 μ 1 1 λ b γ 1 λ s 1 where the parameters λ b and λ s1 are the nondimensional approximated bed and sorting celerities which approximately represent the celerities at which infinitesimal perturbations in bed level and grain size distribution of the bed surface propagate through the domain chavarrías et al 2018 stecca et al 2014 de vries 1965 and appendix a 5 and u m s is the mean flow velocity the parameters γ 1 and μ 1 1 relate the changes in the sediment transport rate to the properties of the bed appendix a 5 subscript s indicates that the model is steady and subscript 2 highlights that it accounts for two sediment size fractions only the preconditioning matrix is 5 m s 2 β 1 0 0 α note that β does not affect the mathematical character of the system as it modifies all equations equally worded differently the parameter β changes the magnitude of the eigenvalues but not the type real or complex we compute the eigenvalues λk for k 1 2 of the modified system of equations as the roots of the characteristic polynomial det m s 2 λ a s 2 0 6 λ k u 2 β λ b λ s 1 α δ α for k 1 2 where the discriminant δ is a second degree polynomial on α equal to 7 δ λ b 2 α 2 2 λ b λ s 1 2 γ 1 μ 1 1 1 α λ s 1 2 we consider a situation which is ill posed if the regularization strategy is not applied this implies that when α 1 the regularization strategy is not applied δ 0 the eigenvalues are complex we aim to modify the system of equations as little as possible in regularizing it worded differently we aim at changing α as little as possible from 1 the minimum modification is obtained when the discriminant is equal to 0 i e the eigenvalues are in the limit for having an imaginary part different than 0 the threshold values α c that modify the system of equations as little as possible are found by equating 7 to zero 8 α c λ s 1 λ b 1 2 γ 1 μ 1 1 2 γ 1 μ 1 1 γ 1 μ 1 1 1 there are two possible values of α c that yield real eigenvalues the discriminant eq 7 as a function of α is a concave parabola as λ b 2 0 moreover when α 0 δ λ s 1 2 0 and when α 1 δ 0 this shows that one critical value of parameter α is between 0 and 1 and the second value is larger than 1 i e 0 α c1 1 α c2 we compute the value of parameter β that assuming α α c recovers the real part that the eigenvalues would have if they had not been modified using the parameter α 9 β λ b λ s 1 α c λ b λ s 1 in this case irrespective of the value of α the eigenvalues of the regularized system are equal to 10 λ k u 2 λ b λ s 1 for k 1 2 if we do not use β to recover the original real part of the eigenvalues i e if β 1 the eigenvalues of the regularized system are equal to 11 λ k u 2 λ b λ s 1 α for k 1 2 parameter α can be selected to be larger or smaller than 1 and if we choose to use β i e if β 1 the eigenvalues are independent of α summarizing we find three possible regularization strategies 1 α 1 and β 1 2 α 1 and β 1 3 α 1 and β 1 in general terms the approximated sorting celerities are positive and under subcritical flow conditions i e fr 1 the approximated bed celerity is also positive however due to hiding in the sediment transport relation under conditions in which ill posedness likely occurs λ s1 may be negative regardless of the froude number chavarrías et al 2018 in this case strategies 1 and 2 do not guarantee that the eigenvalues λk 0 we consider that it is physically unrealistic that morphodynamic information travels in the upstream direction under subcritical flow conditions a negative eigenvalue would imply that the boundary condition for morphology needs to be imposed at the downstream end to yield a well posed model and this is contradictory to the fact that the morphodynamic state under subcritical flow conditions depends on the load coming from upstream blom et al 2017a 2016 on the other hand strategy 3 guarantees that λk 0 appendix a of the supplementary material thus we consider that the only possible regularization strategy is the one in which α 1 and β 1 we need to guarantee that the celerities of the system of equations modified by the regularization strategy are not physically unrealistic in particular under a sufficiently small froude number the modified bed and sorting celerities must be significantly smaller than the celerities of the flow the regularization technique does not modify the approximated celerity associated with bed elevation changes i e β 1 and decreases the celerity associated with mixing processes i e α 1 we will discuss this point in section 6 1 for this reason the regularization technique does not cause the celerities to be physically unrealistic the regularization strategy is not limited to a particular range of parameter settings yet when using the value of α derived in this section the froude number cannot be in the transcritical region as in this case the quasi steady approximation is not valid cao and carling 2002b cao et al 2002 colombini and stocchino 2005 lyn 1987 lyn and altinakar 2002 sieben 1999 in the following section we consider unsteady flow which extends the regularization technique to the transcritical region 3 3 validity under unsteady flow conditions in this section we extend the validity of the regularization parameter α found for steady flow cases section 3 2 to unsteady flow conditions when considering unsteady flow conditions we cannot obtain an analytical expression of α c for regularizing the system of equations nevertheless we can numerically find the smallest value of α 1 for which the roots of the characteristic polynomial of det m u λ a u 0 are real values i e the eigenvalues are real where subscript u indicates that the model is unsteady matrices m u and a u are listed in appendix a 5 this procedure is nonetheless expensive computationally in comparison with an algebraic calculation fig 1 shows the maximum imaginary part of all eigenvalues of a reference ill posed case table 1 considering unsteady flow for varying α the sediment transport rate is computed using a fractional version of the engelund and hansen 1967 sediment transport relation blom et al 2017a a value α 16 1 yields a well posed model i e all eigenvalues are real to test the validity of the algebraic value of α c obtained assuming steady flow we consider the same reference case table 1 and we vary the flow velocity to obtain a range of conditions in fig 2 a we present the value of α c necessary to obtain a well posed model computed assuming steady flow eq 8 and numerically considering unsteady flow we conclude that for a froude number below approximately 0 6 there is no significant difference between the values for steady and unsteady flow this implies that for fr 0 6 the value of α c obtained analytically assuming steady flow is a good approximation of the actual value 3 4 validity under multiple size fractions conditions in a model with more than 2 size fractions we cannot analytically obtain the value of α c that regularizes the active layer model similar to the unsteady case it is possible to numerically obtain the smallest value of α 1 that yields real eigenvalues computed as the roots of the characteristic polynomial det m s λ a s 0 matrices m s and a s are presented in appendix a 5 again this process is relatively expensive in computational terms in this section we propose a method to obtain an approximate value of α c for such cases and compare it to the exact value obtained numerically assuming steady flow a system that models n sediment size fractions has n equations appendix a we reduce the system of n equations to an approximate system of 2 equations following the approach of ribberink 1987 we sum the n active layer equations to obtain one equation that models the changes of the mean grain size of the bed surface sediment appendix a 3 subsequently we apply the same technique as the one we have used in the case of 2 size fractions to obtain a critical value of α that guarantees that the approximate model is well posed 12 α cm λ m λ b 1 2 γ m μ m 2 γ m μ m γ m μ m 1 where the symbols are the equivalent of the case for two size fractions in the approximate model appendix a 5 we consider a case with 3 sediment size fractions where the fine and coarse fractions have characteristic sizes equal to d 1 0 001 m and d 3 0 005 m respectively the volume fraction contents of the 3 size fractions in the active layer are f a 1 0 f a 2 0 9 and f a 3 0 1 the substrate is fully composed of fine sediment we vary the medium grain size d 2 to obtain a range of conditions the remaining parameters are the same as the ones presented in table 1 in fig 2 b we compare the exact value of α c computed numerically to the approximated one computed using eq 12 the approximated value of α c follows the same trend as the exact one however the approximated value is both larger and smaller than the exact one depending on the sediment conditions this implies that the current approximate approach may be insufficient to regularize the active layer model in the case of more than 2 sediment size fractions the approximate system of equations can be ill posed under degradational conditions into a fine substrate only chavarrías et al 2018 ribberink 1987 however a 3 size fractions case can be ill posed under degradational conditions into a coarse substrate chavarrías et al 2018 which further limits the applicability of the approximate solution for the threshold value of α 3 5 implementation in this section we describe our approach for numerically solving the system of equations and apply the regularization strategy we have developed the numerical research code elv to model mixed size sediment river morphodynamics blom et al 2017a 2017b which solves the equations for flow bed elevation and the bed surface grain size distribution in a decoupled manner i e in series and not as a coupled system of equations thus our code is not appropriate for solving transcritical situations lyn 1987 lyn and altinakar 2002 sieben 1999 or cases with a high sediment concentration cao and carling 2002a morris and williams 1996 the one dimensional spatial domain is discretized using an equispaced grid all variables are computed at the cell centers and are considered constant in each time step here we assume steady flow which is represented by the backwater equation eq 16 this ordinary differential equation is integrated using the standard fourth order finite difference runge kutta method rk4 the exner 1920 equation eq 17 and active layer equation eq 19 are solved in conservative form using a first order upwind scheme in combination with forward euler to integrate in time we discretize the vertical domain in a finite number of cells having a certain thickness to account for stratigraphic changes in the substrate our scheme is balanced for the vertical fluxes between the active layer and the substrate stecca et al 2016 this means that mass conservation is guaranteed independent of the substrate discretization the time step varies with time and is computed such that the cfl number courant et al 1928 is constant and equal to 0 9 toro 2009 wu 2007 the details of the numerical implementation are described in appendix b of the supplementary material when the regularization strategy is applied we first determine the mathematical character of the model i e well posed or ill posed at each node using the approach proposed by chavarrías et al 2018 for the case of 2 size fractions this is done evaluating an algebraic equation and for more than 2 size fractions we numerically compute the eigenvalues of the system matrix at continuation for each node we compute the threshold value α c that guarantees that the model is well posed again this is done evaluating an algebraic expression eq 8 for 2 size fractions and it is done numerically for more than 2 size fractions section 3 4 the regularization strategy yields equal eigenvalues i e in a two size fractions case λ 1 λ 2 eq 11 this implies that the problem is hyperbolic but not strictly hyperbolic cordier et al 2011 lax 1980 toro 2009 in a non strictly hyperbolic problem the solution may not be unique and resonance may occur which gives rise to strong non linear interactions isaacson and temple 1992 liu 1987 in avoiding a non strictly hyperbolic problem we modify the value of α c using a small parameter ϵ 0 such that α α c 1 ϵ where α is the value used for updating the bed surface grain size distribution for the cases we have studied a value of ϵ 0 005 is sufficient to avoid the problems associated with non strict hyperbolicity ill posedness causes short wave instability chavarrías et al 2018 joseph and saut 1990 and section 5 1 2 meaning that perturbations will grow unstable at rates depending on the inverse of their length diffusion counteracts these effects by dampening perturbations gray and ancey 2011 regularization of the problem can be provided by numerical diffusion if a first order diffusive method is used however if the underlying problem is ill posed cell refinement will be able to reveal its ill posed character even if a first order method is used in its solution as we do in this paper this is because with decreasing cell size the numerical diffusion coefficient of a first order method will generally decrease while at the same time shorter more unstable perturbations will be solved therefore an ill posed problem will show no convergence due to its inherent instability when the mesh is progressively refined regardless of the low order method in use we observe such a behavior in section 5 1 2 where we show that our low order numerical scheme suffices to capture the consequences of ill posedness by revealing instability and non converging character in simulations conducted within the ill posed range it is likely that with a higher order non diffusive method these features would have become apparent even at lower mesh resolution due to absence of spurious diffusion dampening perturbations however it must be considered that our upwind scheme is characterized by small numerical diffusion coefficient and that stecca et al 2016 and siviglia et al 2017 have shown that a first order upwind scheme with a fine grid resolution is sufficient to capture the main features of mixed size sediment morphodynamic simulations such as the ones we conduct 4 laboratory experiments in this section we describe the laboratory experiments conducted under conditions in which the active layer model hirano 1971 is ill posed in order to obtain a data set to which we can compare the results of the proposed regularization strategy we describe the experimental plan materials and measurements in section 4 1 in section 4 2 we present the experimental results 4 1 experimental plan and measurements we conducted 4 laboratory experiments i1 i2 i3 and i4 the experiments reproduced degradational conditions into a fine substrate which are conditions prone to be ill posed chavarrías et al 2018 ribberink 1987 stecca et al 2014 the experiments were conducted in a 14 m long 0 40 m wide and 0 45 m high tilting flume in the water laboratory of the faculty of civil engineering and geosciences of delft university of technology at the upstream end a turbulence dissipation device was installed item a in fig 3 an inclined plane was placed downstream from the turbulence dissipation device item b in fig 3 to allow for an alluvial bed item c in fig 3 the structure was covered with glued sediment such that friction was similar to the one of the alluvial bed its elevation could be adjusted we consider a reference system with coordinate origin at the bottom of the flume at the downstream end of the metal structure the z axis is parallel to gravity and pointing up the x axis follows the streamwise direction of the flume being positive in the direction of the flow the y axis is perpendicular to the other two axes forming a right handed orthonormal basis we used two sediment size fractions fine and coarse with characteristic grain sizes computed as the arithmetic mean in ϕ scale equal to 2 1 mm and 5 5 mm the standard deviation of the two size fractions is 1 1 mm and 1 2 mm respectively the bed surface was initially flat with a constant slope and composed of coarse sediment only below a 0 03 m thick layer of coarse sediment we installed a patch of fine sediment of varying length l p m fig 3 and table 2 we imposed a constant water discharge and a constant sediment feed rate of the coarse fraction only which was in equilibrium with the initial condition table 3 and appendix c of the supplementary material the sediment was introduced using a feeder placed on top of the flume item d in fig 3 the downstream water level was lowered at a rate of 0 01 m h during 8 h by adjusting a sharp crested weir at x 12 60 m item g in fig 3 the lowering of the water level led to bed degradation and entrainment of the fine sediment in the patch we have tested that in these conditions the active layer model is ill posed regardless of the active layer thickness and sediment transport relation sediment was collected in a sand trap item e in fig 3 at the downstream end of the flume x 12 10 m the sediment was pumped from the sand trap item f in fig 3 into a tank positioned on a weight balance next to the flume this system allowed us to continuously measure the sediment transport rate the water inflow was measured using an ultrasonic flow meter and the downstream water level using a position sensor we obtained profiles of the water and bed elevation using laser sensors that were fixed to a carriage item h in fig 3 a camera was mounted on the carriage to measure the grain size distribution of the bed surface using the technique developed by orrú et al 2016a b item i in fig 3 to this end the coarse sediment was painted red and the fine sediment blue our experimental set up allowed us to measure either a profile of bed and water surface elevation or the bed surface grain size distribution at a certain location with time for the modeling of the laboratory experiments section 5 it is important to obtain turbulent flow conditions of a relatively deep flow i e flow cannot be affected by individual grains where sediment is predominantly transported as bed load the concentration of sediment needs to be so small that we can assume clear water these conditions were satisfied appendix c of the supplementary material 4 2 results all experiments were governed by the same conditions before the fine sediment in the patch was entrained we observed the superposition of bedforms of two different length scales fig 4 secondary bedforms approximately 0 5 m long and 0 01 m high were superimposed on primary longer bedforms of the order of 3 m and twice as high the primary bedforms are interpreted as incipient gravel dunes carling 1999 carling et al 2005 the characteristics of these features remained steady as the bed degraded the steadiness of the features characteristics is confirmed in a preparatory experimental run without a patch of fine sediment appendix c of the supplementary material after approximately 2 h the bed had degraded up to a point at which the trough of a long bedform was lower than the top part of the patch fig 5 a at that moment fine sediment was exposed entrained and transported the larger mobility of the fine sediment created a downstream moving degradational wave fig 5 b as erosion proceeded the shear stress was reduced due to the increased flow depth which reduced the degradation rate meanwhile the subsequent bedform advanced and started to fill the degradational pit with coarse sediment fig 5 c overall the passage of bedforms induced entrainment of fine sediment and subsequent coarsening of the top part of the substrate since the degradational wave increased in depth in downstream direction also the thickness of the coarse top layer increased in downstream direction fig 5 d the substrate coarsening mechanism created an irregular interface between coarse and fine sediment compared to the initial situation where the interface was parallel to the bed surface as a consequence the entrainment of fine sediment became a pseudo random process in space and time degradational waves formed at those locations where fine sediment was closest to the bed surface yet most of the waves grew for only a limited length as due to the irregular interface at some point the sediment present at the trough was coarse rather than fine sometimes the interface was sufficiently parallel to the bed surface and a large degradational wave formed this is seen in the content of coarse sediment at the bed surface of the patch fig 6 a c e and g and in the bed elevation fig 7 one or two small degradational waves formed after the passage of a large degradational wave characterized by the fact that the bed surface is composed of mainly fine sediment and the trough of a bedform reaches elevations significantly lower than average a longer patch allowed for the development of longer in space and time and deeper erosional waves figs 6 and 7 yet the decrease in degradation rate as the wave advanced acted as a saturation mechanism limiting the height of the wave thus the probability of lower bed elevation at the patch zone was not significantly larger for an increasing patch length fig 8 after the patch where the substrate was composed of coarse sediment only wave height decreased and the bed elevation profile tended to the one upstream of the patch fig 7 yet the presence of fine sediment downstream of the patch slightly increased the height of the bedforms with respect to the bedforms upstream of the patch fig 8 a and c bedforms downstream of the patch were characterized by a coarse front and fine tail and were approximately 2 grain sizes of the coarse sediment high these characteristics may indicate the presence of bedload sheets dietrich et al 1989 recking et al 2009 whiting et al 1988 or bedforms in a transitional phase to small dunes the domain downstream from the patch was not long enough to precisely conclude on the type of bedforms the changes in volume fraction content of coarse sediment at the bed surface were less pronounced downstream of the patch compared to at the patch fig 6 b d f and h this is because fine sediment entrained at the patch dispersed in the downstream direction 5 numerical modeling in this section we apply the regularization strategy in modeling the laboratory experiments conducted under conditions in which the active layer model is ill posed section 5 1 in section 5 2 we compare the results of the regularized active layer model to the results of the two layer model developed by ribberink 1987 by applying them to a thought experiment under conditions in which the active layer model is ill posed 5 1 modeling of our laboratory experiments in section 5 1 1 we calibrate the numerical model in section 5 1 2 we conduct a convergence test to show the consequences of ill posedness and the benefits of the regularization strategy in section 5 1 3 we apply the numerical model to the laboratory experiments described in the previous section in section 5 1 4 we test the regularization strategy assuming three sediment size fractions 5 1 1 calibration modeling the laboratory experiments requires values for the active layer thickness and the friction coefficient and the choice of a sediment transport relation to this end we use the results of a set of preparatory experiments appendix c of the supplementary material to chose a sediment transport relation we run two experiments conducted under equilibrium conditions while feeding the fine and the coarse sediment size fractions the sediment transport relation by ashida and michiue 1971 reproduces our results reasonably well appendix d of the supplementary material to obtain the skin friction coefficient c fb for computing the sediment transport rate appendix a 4 we correct the total measured friction coefficient c f for side wall friction with the method developed by johnson 1942 see guo 2015 we obtain the values c f 0 0104 and c fb 0 0084 bedform drag was negligible during the initial phase as bedforms were low when fine sediment was entrained bedforms grew and bedform drag may have played a role it is not reasonable to model this additional friction using standard relations e g engelund and hansen 1967 haque and mahmood 1983 wright and parker 2004 as these relations provide a bedform averaged friction coefficient while in our case large bedforms were isolated in space and time we decide to use a constant friction coefficient and we think that the most sensible approach is to neglect bedform drag a reasonable value for the active layer thickness is 0 01 m which corresponds to the distance below the mean bed elevation with a probability of entrainment below approximately 5 blom 2008 ribberink 1987 this value is also in accordance with 1 3 times d 90 as proposed by for instance hirano 1971 hoey and ferguson 1994 and seminara et al 1996 in one preparatory experiment under equilibrium conditions we fed coarse sediment only and from some point we started feeding tracer sediment i e sediment of a different color modeling the propagation of the front of tracer sediment we confirm that 0 01 m is a reasonable value for the active layer thickness appendix d of the supplementary material 5 1 2 convergence test first we aim to show the consequences of ill posedness to this end we simulate conditions similar to the ones of the experiments using the active layer model in the experiments degradation into a coarse substrate i e under well posed conditions occurred for approximately 2 h as the patch of fine sediment was placed 3 cm below the initial bed surface in order to obtain ill posed conditions at the start of the simulations the patch of fine sediment is placed right below the active layer in this manner 300 s simulations suffice for our purpose moreover the patch extends over a distance of 8 m from x 1 m to x 9 m to maximize the domain over which the model is ill posed we conduct 13 simulations using cell sizes ranging from 0 1 m down to 2 44 10 5 m the results do not converge and continue to change as the grid is refined fig 9 a we compute the error as a function of the cell size to quantify the lack of convergence as there is no analytical solution to which we can compare the results of the numerical runs we compute the error between the results of two successive simulations s and s 1 love and rider 2013 roy 2005 to this end first we interpolate the bed elevation results of all simulations using the smallest cell size the interpolation rather than linear takes into consideration that each value is constant inside a cell second we compute the error as the norm 1 of the difference between bed elevations of two successive simulations at a certain time t 13 error s t 1 l n x r 1 n x η r s t η r s 1 t where n x denotes the number of cells of the simulation with the smallest cell size and l m the domain length fig 9 c shows the error as a function of the cell size for several times if the cell size is large for instance larger than 0 01 m for short simulation times for instance shorten than 10 s the results seem to converge yet using the same cell size the results do not converge if one considers a longer simulation time similarly considering a simulation time equal to 10 s the results do not converge when the cell size is smaller than 0 002 m this behavior is characteristic of ill posed simulations the growth rate of perturbations increases with decreasing cell size for this reason the consequences of ill posedness arise earlier for smaller cell sizes given a certain cell size if the simulation is short enough perturbations do not have time to grow and the solution seems to converge for a fixed time simulations seem to converge after the error grows for instance for t 120 s simulations seem to converge for cell sizes between 0 001 m and 0 01 m this is due to the fact that at the given time perturbations have already grown significantly and have coarsened the bed material causing the simulation to be well posed a further decrease of the cell size or an analysis at a different time shows that the active layer model does not converge we repeat the same simulations applying the regularization strategy the initial value of the parameter that recovers the well posed character of the system is α c 11 6 in this case the solution does not show oscillations fig 9 b moreover the solution converges for a decreasing cell size independently from the time at which convergence is tested fig 9 d this supports the fact that the regularized model is well posed contrary to the active layer model the rate at which the solution converges confirms that the numerical scheme is first order accurate section 3 5 5 1 3 two sediment size fractions we reproduce all laboratory experiments using a cell size equal to 0 05 m the regularized model shows spatial or temporal oscillations in none of the cases fig 10 for all cases the bed elevation decreases smoothly in the streamwise direction fig 10 b f j and n this contrasts with the measured temporal change of bed elevation which presents bedforms and the formation of degradational waves at the upstream end of the patch fig 10 a e i and m the measured increase in wave height at the patch fig 10 a e i and m and section 4 2 is not captured the effect of the patch is observed in the model results in the fact that degradation occurs faster for a long patch fig 10 than for a short one fig 10 b the continuous and smooth predicted entrainment of substrate sediment yields an almost steady volume fraction content of sediment in the active layer both at the patch fig 10 c g k and o and at the downstream end fig 10 d h l and p the measured data shows on the other hand a variable volume fraction content at the bed surface the model correctly captures the mean value and nicely reproduces that a longer patch causes an increase in the amount of fine sediment at the bed surface the fact that the model does not capture bedforms is not surprising as the mechanisms necessary for bedform formation are not present in the model for instance the fact that the flow model is based on the hydrostatic pressure assumption prevents modelling processes such as flow separation the possibility of capturing the formation of the degradational waves at the patch is also discarded as from the analysis of well posedness we see that the regularized model does not show any instability mechanism that could induce wave growth for this reason the model results represent values averaged over the passage of several bedforms and degradational waves we choose not to filter the measured bed elevation data as given the characteristics of the bedforms it would introduce a large amount of spurious information e g the degradational wave would start at the wrong location and we would lose a significant amount of data at the beginning and end of the domain overall the regularized model yields a reasonable approximation of the mean temporal change of the measured data the degradational trend is captured and the surface grain size distribution approximates the average measured values the substrate is not unrealistically altered as there are no oscillations in the solution 5 1 4 three sediment size fractions to test the regularization strategy for multiple grain sizes we model experiment i4 table 2 using 3 different grain sizes by applying the exact solution to obtain the regularization parameter the fine size fraction remains the same and the previous coarse size fraction is represented in this case by two characteristic grain sizes equal to 4 895 mm and 5 895 mm for an initial volume fraction content at the bed surface of the medium size sediment equal to 0 375 the initial bed slope is the same as when using two characteristic sizes and the sum of the sediment transport rate of the medium and coarse fractions when using three sizes is equal to the sediment transport rate of the coarse fraction when using two sizes in this manner the simulation accounting for three sediment fractions is comparable to the one accounting for two size fractions in fig 11 we compare the bed elevation and mean grain size of the bed surface sediment predicted by the regularized model using 2 and 3 sediment size fractions the evolution of the bed elevation shows only a weak dependence on the number of size fractions used to discretize the sediment mixture the model with 3 size fractions presents a mild coarsening 0 2 increase in mean grain size with time before sediment from the patch is entrained after 2 h this coarsening is not visible when using 2 size fractions because in this case during the initial state the bed surface sediment consists of one single grain size only we conclude that the regularization technique is applicable for a general case with more than 2 size fractions 5 2 comparison between ribberink s 1987 two layer model and the regularized model to our knowledge there is no other laboratory data set apart from the one presented in section 4 to which we can apply the regularized active layer model to test its performance this is because either the conditions that other researchers have studied yield a well posed active layer model e g ashida and michiue 1971 or the active layer model is ill posed but the active layer thickness varies with time due to dune growth blom et al 2003 the latter case is a situation that the regularization strategy cannot deal with section 3 1 however ribberink 1987 applies his two layer model to a thought experiment under conditions in which the active layer model is ill posed in this section we apply the regularized active layer model to his thought experiment and compare it to the two layer model ribberink 1987 conducted a laboratory experiment with mixed size sediment which was dominated by aggradation after a period of degradation experiment e8 e9 the initial bed was characterized by a uniform slope composed of a bimodal mixture a coarse and fine fraction and well mixed both in the streamwise and vertical direction the sediment supply was initially in equilibrium a temporal increase of the proportion of the coarse fraction in the sediment supply perturbed the equilibrium condition and induced the downstream propagation of a coarsening wave the downstream migration of the coarsening front caused a preceding and temporary bed degradation as a result of the difference in sediment mobility between the coarse sediment forming the wedge and the fine sediment downstream of the front of the wedge eventually the bed aggraded and was characterized by a larger slope than the initial one so as to allow for the transport of the coarser fed sediment under equilibrium conditions during the short degradational part of the experiment the bed surface was coarser than the substrate i e conditions in which the active layer model is prone to be ill posed chavarrías et al 2018 ribberink 1987 stecca et al 2014 however while reproducing the experiment numerically ribberink 1987 found that the active layer model was well posed subsequently ribberink 1987 applied his two layer model to a thought experiment that was equal to e8 e9 except for the fact that the substrate sediment was finer than in the flume experiment such that the active layer model is ill posed a numerical simulation of the thought experiment using the active layer model showed oscillations that eventually made the code crash ribberink 1987 the thought experiment was reproduced well by a numerical code implementing ribberink s 1987 two layer model here we run a numerical simulation of the thought experiment using our regularized active layer model and compare it to the results of ribberink s 1987 two layer model reported in fig 7 9 of ribberink 1987 simulation details can be found in appendix c fig 12 presents the time series of bed elevation and mean grain size of the bed surface sediment at a location 20 m downstream from the inlet during the first 20 h the effects of the coarsening of the fed sediment are not felt 20 m downstream from the inlet while the regularized active layer model predicts a constant bed elevation and grain size distribution of the bed surface sediment during this period of time the two layer model predicts a fining of the bed surface fig 12 b this is due to the fact that the initial grain size distribution of the exchange layer is not in equilibrium with the one at the active layer and causes a vertical flux of sediment however the bed elevation remains constant as predicted by both models fig 12 a the aggradational phase is preceded by a degradational wave which is much more pronounced in the regularized active layer model than in the two layer model this is because in the regularized active layer model degradation causes entrainment of the fine substrate sediment whereas in the two layer model the exchange layer acts as a buffer that slows down the process the coarsening of the bed surface between approximately 25 h and 40 h as predicted by both models is very similar while after 40 h the regularized active layer model predicts a constant grain size distribution of the bed surface sediment the two layer model predicts an asymptotic adaptation toward equilibrium conditions this effect is again caused by the exchange layer that coarsens slowly compared to the active layer on top of it as it accounts for the effects of occasionally large bedforms the equilibrium state differs between the two models we believe that this is due to the fact that we do not know exactly what values were used by ribberink 1987 for the constants in the sediment transport relation appendix c the regularized active layer model captures the dynamics predicted by the two layer model of ribberink 1987 the advantage of the two layer model is that it accounts for a source of vertical mixing that the regularized active layer model does not take into consideration i e the mixing due to occasionally large bedforms on the other hand the two layer model may become ill posed sieben 1994 while the regularized active layer model is always well posed 6 discussion in this section we discuss the physical interpretation of the regularization strategy section 6 1 as well as possible extensions and further development section 6 2 6 1 physical interpretation of the regularization strategy the ill posed solution predicted by the active layer model is characterized by oscillations that temporarily fine the bed surface and coarsen the substrate this behavior is also observed in our laboratory experiments figs 6 and 7 one may be tempted to conclude that the active layer model although being mathematically ill posed provides reasonable results this argument is wrong for two reasons the first reason is that the numerical solution does not converge for a decreasing mesh size the solution keeps changing and oscillations become larger when the cell size is reduced chavarrías et al 2018 joseph and saut 1990 such a solution cannot be representative of physical phenomena second the physical processes responsible for the small scale variability in bed elevation i e ripples bedload sheets are not accounted for by the active layer model section 3 1 any resemblance of the model results with bed elevation fluctuations due to small scale bedforms is therefore coincidence the frequently used morphodynamic factor φ η latteux 1995 ranasinghe et al 2011 roelvink 2006 is a particular case of a preconditioning matrix with parameters β 1 φ η and α k 1 k the proposed regularization strategy can be considered as the use of a morphodynamic factor not only for the changes in bed elevation η but also for the changes in grain size distribution of the bed surface m ak the sorting morphodynamic factor φsk is then defined as φ s k 1 α k β we have seen that the only applicable regularization strategy is that in which α k α 1 k and β 1 which is equivalent to saying that the regularization strategy is based on a sorting morphodynamic factor 0 φs 1 this implies that the mixing or sorting processes associated with changes in grain size distribution of the bed surface sediment are slowed down with respect to the celerity predicted by the active layer model the effect of applying the regularization strategy is a slowdown of the sediment mixing processes in the model computations this effect is similar to the effect of a temporary increase of the active layer thickness from a physical perspective this slowdown of mixing processes may be associated with a temporary increase of the range of elevations covered by the bed level fluctuations blom et al 2008 the slowdown of mixing processes resulting from applying the regularization strategy implies that the regularized active layer model can be applied to a wider range of physical problems i e also those characterized by a fairly small time scale of mixing than the active layer model 6 2 alternatives to the regularization strategy our regularization strategy is applied locally and temporally worded differently only when and where the model is ill posed we update the grain size distribution of the bed surface sediment using the parameter α c moreover α c depends only on the conditions at the location under consideration note that the preconditioning matrix is diagonal this is the simplest strategy but one could decide to avoid discontinuities in the value of α c throughout the domain by coupling neighboring nodes carraro et al 2018 propose a technique to decrease the computational cost of morphodynamic simulations as in our case their strategy can be seen as a preconditioning technique they consider unisize sediment conditions and modify not only the exner 1920 equation but also the continuity equation here we modify the active layer equation but not the flow equations or the exner 1920 equation a combination of both strategies could yield a technique that both decreases the cost of numerical simulations and guarantees that the model is well posed we have focused on restoring the hyperbolic character of the system of equations and to this end we based our study on the linear solution i e short waves this focus suffices here as short waves are most sensitive to ill posedness joseph and saut 1990 however the regularization strategy modifies the celerity and growth rate not only of short waves but also of long ones for this reason we suggest to further study how long waves are affected and whether the results of the regularization strategy are physically realistic based on a similar analysis to that of lanzoni et al 2006 we have assumed a constant active layer thickness to avoid the added complexity due to a cumbersome closure relation linking the preconditioning parameters to the change in time of the active layer thickness it may be possible to extend our regularization strategy to situations in which the active layer thickness changes with time e g due to dune growth by providing such a closure relation on the other hand it is reasonable that the regularization strategy requires a constant active layer thickness given the fact that mathematically the strategy has the same effect as an increase in the active layer thickness i e a decrease in the celerity of the mixing processes we have concluded that the regularization strategy needs to slowdown the mixing processes i e α c 1 to guarantee that the eigenvalues are always positive regardless of the value of the sorting celerity λ s1 however if the sorting celerity is guaranteed to be positive e g because hiding is negligible the acceleration of the mixing processes also yields positive eigenvalues and a well posed model there may be cases in which the latter strategy yields more realistic results moreover we have chosen to guarantee that the regularized eigenvalues are positive reasoning that morphodynamic information travels in the downstream direction under subcritical conditions lanzoni et al 2006 lyn and altinakar 2002 stecca et al 2014 suzuki 1976 this statement is partially contradictory to recent studies that consider sediment transport as a stochastic process ancey and heyman 2014 furbish et al 2012 the stochastic nature of sediment transport yields an advection diffusion equation that models the amount of moving particles per unit of bed area the diffusive character implies that information also travels in the upstream direction for this reason a regularization strategy in which information travels in the upstream direction may be physically realistic under certain circumstances for a case with more than two sediment size fractions section 3 4 the approximate value of the parameter α c is not completely satisfactory as well posedness is not guaranteed we have observed in our tests that ill posedness occurs when at least two eigenvalues of the bed and sorting eigenvalues are similar with respect to the other bed and sorting eigenvalues for a case considering two sediment size fractions this is referred in literature as the crossing of eigenvalues sieben 1997 stecca et al 2014 worded differently the difference between two eigenvalues must be large enough for the model to be well posed a regularization strategy based on guaranteeing a minimum distance between eigenvalues could yield an inexpensive solution for the case with more than two sediment size fractions 7 conclusions we have developed a preconditioning method for regularizing the active layer model hirano 1971 used in modeling mixed sediment river morphodynamics our method recovers the well posed character of the system of equations by means of one parameter that modifies the celerity of the mixing processes physically this means that the mixing processes are slowed down or the time scale of the mixing processes is increased we conduct 4 laboratory experiments under conditions in which the active layer model is ill posed and we compare the observations to the predictions of the regularized active layer model the regularized active layer model captures the mean behavior observed in the experiments associated with changes averaged over the passage of several bedforms acknowledgments this research is part of the research programme rivercare supported by the dutch applied and engineering sciences aes domain of the netherlands organization for scientific research nwo and which is partly funded by the ministry of economic affairs under grant number p12 14 perspective programme the involvement of guglielmo stecca was supported by niwa under the sustainable water allocation programme the fruitful discussions and comments on the manuscript of liselot arkesteijn are gratefully acknowledged we thank the editor prof dr g c sander associate editor dr c manes and three anonymous reviewers for their comments which have significantly improved the manuscript appendix a model equations in this section we present the system of equations for modeling mixed sediment river morphodynamics in section a 1 we present the flow equations in section a 2 we present the active layer model hirano 1971 a simplified active layer model is presented in section a 3 in section a 4 we show the closure relations in section a 5 we present the system of equations in matrix vector formulation a 1 flow equations we consider a one dimensional mixture of water and sediment flowing over a mobile bed a set of partial differential equations that accounts for the interactions between sediment and water is found by applying mass and momentum conservation principles for the mixture of sediment and water e g garegnani et al 2011 greco et al 2012 the complete system of equations reduces to the saint venant exner model i e clear water approximation under low sediment concentrations c q b q 0 006 where q b m2 s and q m2 s are the sediment transport rate and flow discharge per unit width respectively e g garegnani et al 2011 garegnani et al 2013 in the remaining we will assume that the clear water approximation is valid the flow is modeled using the saint venant 1871 equations 14 h t q x 0 15 q t q 2 h g h 2 2 x g h η x g h s f where t s denotes the time coordinate x m the streamwise coordinate h m the flow depth g m s2 the acceleration due to gravity η m the bed elevation and s f the friction slope the flow equations can be further simplified assuming steady flow under this condition the conservation of water mass and momentum reduce to a spatially constant discharge and the backwater equation 16 h x 1 1 fr 2 η x s f 1 fr 2 where fr q g h 3 is the froude number a 2 active layer model to model changes in bed elevation we assume that the sediment transport rate adapts instantaneously to changes in bed shear stress spatial and or temporal adaptation to capacity load bell and sutherland 1983 phillips and sutherland 1989 1990 is not considered neglecting mechanisms such as subsidence and uplift paola and voller 2005 and assuming a constant bed porosity we obtain the exner 1920 equation 17 η t q b x 0 where for simplicity the sediment transport rate includes the pores the sediment phase is composed of a mixture of n non cohesive sediment size fractions each fraction is characterized by a grain size dk m where k is an index identifying a size fraction the total sediment transport rate per unit width is the sum of the sediment transport rate of size fraction k q bk m2 s 18 q b k 1 n q b k the conservation of the volume of sediment of size fraction k in the active layer per unit of bed area m a k f a k l a m is expressed mathematically as hirano 1971 19 m a k t f k i η l a t q b k x 0 for 1 k n 1 where f ak 0 1 is the volume fraction content of size fraction k in the active layer f k i 0 1 is the volume fraction content of size fraction k at the interface between the active layer and the substrate and l a m is the active layer thickness by definition 20 k 1 n f a k 1 k 1 n f k i 1 from the first constrain in eq 20 one obtains the change of the volume of sediment in the active layer of the nth grain size with time the system is complete with an equation for the conservation of mass in the substrate yet this equation is linearly dependent on the exner 1920 and hirano 1971 equations which implies that it does not play a role in the mathematical character of the system chavarrías et al 2018 stecca et al 2014 a 3 simplified active layer model to simplify the system of equations we replace the n 1 equations that account for the change in bed surface volume fraction content of the n fractions by one equation that models the average grain size following the approach of ribberink 1987 we multiply each regularized active layer equation by its characteristic grain size and we add all the equations 21 α d ma t d m i l a q b x 1 l a k 1 n d k q b k x 0 where d ma k 1 n d k f a k m is the mean grain size of the sediment in the active layer and d m i k 1 n d k f k i m is the mean grain size of the sediment at the interface between the active layer and the substrate the mean grain size is computed arithmetically as it is a necessary step to obtain an approximate equation yet we consider that the mean grain size is better approximated assuming the grain size distribution to be logarithmically distributed we write the sediment transport rate q bk as a function of the flow depth h and the mean grain size of the sediment in the active layer d ma such that 22 q b k x q b k h h x q b k d ma d ma x we use that 23 d ma k 1 n d k f a k d n 1 l a k 1 n 1 m a k d k d n where we have used the constrain that k 1 n f a k 1 thus 24 q b k d ma l 1 n 1 q b k m a l m a l d ma l a l 1 n 1 1 d l d n q b k m a l where we have used that 25 m a l d ma l a d l d n we substitute the backwater equation eq 16 in the exner 1920 equation eq 17 and the equation of the mean grain size eq 21 to obtain the final set of equations 26 η t 1 1 fr 2 q b h η x q b d ma d ma x 1 1 fr 2 q b h s f 27 α d ma t 1 l a 1 1 fr 2 d m i q b h k 1 n d k q b k h η x 1 l a d m i q b d ma k 1 n d k q b k d ma d ma x 1 l a 1 fr 2 d m i q b h k 1 n d k q b k h s f a 4 closure relations to close the system of equations we provide closure relations for the friction term the sediment transport rate and the flux between the active layer and the substrate we adopt the following chézy closure relation for the friction term 28 s f c f u 2 g h where c f is a nondimensional friction coefficient that we assume to be constant i e independent of the flow or bed properties and u q h m s is the mean flow velocity the sediment transport rate of size fraction k per unit width is assumed to be the product of a nondimensional sediment transport rate q b k and the bed surface fraction content the latter we assume equal to the active layer volume fraction content the einstein 1950 parameter g r d k 3 scales the nondimensional quantity such that 29 q b k f a k g r d k 3 1 p q b k where r ρ s ρ w 1 is the submerged specific gravity ρ s 2650 kg m3 the sediment density and ρ w 1000 kg m3 the water density the sediment transport rate q bk includes the volume of pores the nondimensional sediment transport rate is assumed to be a function of the nondimensional bed shear stress θk shields 1936 30 θ k c fb u 2 g r d k where c fb is the skin friction coefficient the nondimensional sediment transport rate is computed using a sediment transport relation such as the one proposed by ashida and michiue 1971 31 q b k 17 θ k ξ k θ c θ k ξ k θ c the parameter ξk is the hiding function 32 ξ k 0 843 d k d m 1 for d k d m 0 4 log 10 19 log 10 19 d k d m 2 for d k d m 0 4 where d m is a characteristic mean grain size of the sediment mixture ashida and michiue 1971 propose θ c 0 05 under degradational conditions we assume that the volume fraction content of sediment at the interface between the active layer and the substrate is equal to the sediment in the top part of the substrate under aggradational conditions the sediment in the active layer is assumed to be transferred to the substrate hirano 1971 33 f k i f s k z η l a if η l a t 0 f a k if η l a t 0 other formulations include those of hoey and ferguson 1994 a 5 matrix formulation in this section we present the matrix vector form eq 1 of the active layer model in combination with the unsteady flow equations stecca et al 2014 and assuming steady flow chavarrías et al 2018 as well as the simplified morphodynamic model the vector of dependent variables q u system matrix a u and vector of source terms s u of the fully unsteady system is stecca et al 2014 34 q u h q η m a k n 1 35 36 s u 0 g h s f 0 0 n 1 the preconditioning matrix is in this case 37 assuming steady flow the vector of dependent variables q s system matrix a s and vector of source term s s are equal to chavarrías et al 2018 38 q s η m a k n 1 39 40 s s s f 1 fr 2 q b h s f 1 fr 2 q b k h f k i q b h n 1 the preconditioning matrix assuming steady flow is 41 m s β 1 0 α 1 0 α n 1 the nondimensional approximated bed and sorting celerities are chavarrías et al 2018 de vries 1965 42 λ b ψ 1 fr 2 43 λ s 1 χ 1 μ 1 1 where the parameters are chavarrías et al 2018 stecca et al 2014 44 ψ q b q 45 γ k c k f k i 46 c k 1 ψ q b k q 47 χ l 1 u q b m a l 48 μ l k d l k f k i 49 d l k 1 u χ l q b k m a l in the simplified morphodynamic model section a 3 the vector of dependent variables q m system matrix a m and vector of source term s m are 50 q m η d ma 51 a m u 1 1 fr 2 q b h q b d ma 1 l a 1 1 fr 2 d m i q b h k 1 n d k q b k h 1 l a d m i q b d ma k 1 n d k q b k d ma 52 s m s f 1 fr 2 q b h 1 l a d m i q b h k 1 n d k q b k h the preconditioning matrix is 53 m m β 1 0 0 α the parameters are 54 λ m χ m μ m 55 γ m c m f m i 56 c m 1 ψ l a k 1 n d k q b k q 57 f m i d m i l a 58 χ m 1 u q b d ma 59 μ m d m f m i 60 d m 1 u χ m l a k 1 n d k q b k d ma appendix b mass conservation of the modified system mass conservation of the modified system of equations section 3 1 is guaranteed if the sum of the n modified active layer equations is equal to the modified exner 1920 equation as we already substituted the exner 1920 equation in the active layer equation the addition of the n modified active layer equations must yield an identity 61 k 1 n β α k m a k t k 1 n f k i β η l a t k 1 n q b k x 0 β l a t k 1 n α k f a k 1 β l a k 1 n α k f a k t 0 to allow for morphodynamic changes the parameter β must be different than 0 this yields a multiplicity of cumbersome closure relations for αk relating the temporal change of the active layer thickness to those of the volume fraction contents at the bed surface we choose to simplify the problem assuming that α k α k so that we obtain 62 β l a t α 1 0 given that α 1 to recover the well posedness of the system of equation the active layer thickness must be constant to conserve mass in the modified system of equations appendix c parameters of the numerical simulation of the thought experiment in this section we provide the details of our numerical simulation of the thought experiment conducted by ribberink 1987 the thought experiment is based on the laboratory experiment e8 e9 conducted by ribberink 1987 the only difference is that in the thought experiment the substrate is finer than in the laboratory experiment the domain is 30 m long and it is discretized into 0 01 m long cells the simulation time is 120 h the total and skin friction coefficient are equal to 0 0117 the sediment mixture is composed of two sediment sizes equal to 0 78 mm and 1 29 mm the flow discharge per unit width is constant and equal to 0 0803 m2 s the downstream water level is constant and such that initially the bed is in equilibrium the upstream sediment load is initially equal to 5 64 10 6 m2 s and it is composed of 50 of the fine fraction during the first 30 h the fraction of fine sediment linearly decreases to 0 the total amount of sediment decreases to 95 of the initial value the active layer thickness is equal to 0 02 m the initial volume fraction content of fine sediment in the substrate is 0 6 it is not fully clear to the authors which sediment transport relation and which parameters ribberink 1987 used in the simulation of the thought experiment using the two layer model we have inferred that he used the relation developed by meyer peter and müller 1948 with the hiding function by egiazaroff 1965 with the calibrated parameters a 15 85 b 1 5 and θ c 0 0307 the mean grain size is computed arithmetically we calibrate the ripple factor a constant multiplying the shields 1936 stress such that the bed slope and volume fraction content of fine sediment are as close as possible to the reported values we obtain that for a ripple factor equal to 0 3169 the bed slope is 1 65 10 3 the same as ribberink 1987 reported and the volume fraction content of fine sediment in the active layer is equal to 0 409 ribberink 1987 reported a value equal to 0 43 supplementary material supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2019 04 001 appendix d supplementary materials supplementary data s1 supplementary raw research data this is open data under the cc by license http creativecommons org licenses by 4 0 supplementary data s1 
680,a notable drawback in mixed size sediment morphodynamic modeling is the fact that the most commonly used mathematical model in this field i e the active layer model hirano 1971 can be ill posed under certain circumstances under these conditions the model loses its predictive capabilities as negligible perturbations in the initial or boundary conditions produce significant differences in the solution in this paper we propose a preconditioning method that regularizes the model to recover well posedness by altering the time scale of the sediment mixing processes we compare results of the regularized model to data from four new laboratory experiments conducted under conditions in which the active layer model is ill posed the regularized active layer model captures the change of bed elevation and surface texture averaged over the passage of several bedforms neither the active layer model nor the regularized one account for small scale changes due to individual bedforms 1 introduction the presence of mixed size sediment is a key feature of rivers sediment sorting patterns develop in the streamwise direction e g the characteristic downstream fining profile sternberg 1875 in the transverse direction e g bend sorting allen 1970 and in the vertical direction e g bed armoring parker and klingeman 1982 and dune sorting blom et al 2003 modeling applications in which the mixed size character of river morphodynamics is not negligible mandate the use of a suitable continuity model accounting for mass conservation of each of the considered sediment size fractions hirano 1971 was the first to develop a mixed sediment continuity model he assumed that the river bed can be vertically divided into an active top part the active layer which interacts with the flow and an inactive substrate in the model sediment transport and friction depend on the texture of the active layer whereas the sediment in the substrate only plays a role if net aggradation creates new substrate sediment or net degradation leads to the entrainment of substrate sediment into the active layer although it has been fruitfully used to represent physical phenomena related to mixed sediment for nearly half a century see chavarrías et al 2018 the active layer model suffers from a drawback under certain conditions it becomes ill posed chavarrías et al 2018 ribberink 1987 stecca et al 2014 a model is ill posed if a unique solution does not exist or if the solution does not depend continuously on the initial and boundary conditions hadamard 1923 if a model is ill posed infinitesimal variations in the initial or boundary conditions yield a significant deviation of the solution within an infinitesimal time hadamard 1923 when solving the mathematical model by numerical approximations perturbations in the initial and boundary conditions simply arise by truncation errors this makes an ill posed model unsuitable in practice the problem of ill posedness arises from an inaccurate representation of the physical processes joseph and saut 1990 for instance a two fluid model for incompressible and inviscid flow in two layers with a velocity discontinuity is ill posed von helmholtz 1868 kelvin 1871 it is regularized i e becomes well posed if viscous effects are taken into account joseph and saut 1990 from this perspective the preferred approach to regularize the active layer model would be the development of a new model that includes those physical mechanisms that are not accounted for by the active layer model there exist alternatives to the active layer that typically aim to improve the physical description of sediment mixing process ribberink 1987 introduced a second layer to account for the mixing due to dunes exceptionally larger than the average dune height besides producing a vertical sorting profile that better reproduces the results of a laboratory experiment blom 2008 ribberink s two layer model makes the occurrence of ill posedness less likely although it does not completely avoid it sieben 1994 luu et al 2006 2004 proposed a model in which the active layer is replaced by the sediment transport layer representing the sediment in transport rather than the sediment at the bed surface the thickness of the sediment transport layer is estimated with a closure relation such as the one developed by egashira and ashida 1992 although conceptually different the model by luu et al 2006 2004 is mathematically equivalent to the active layer model which implies that it can also be ill posed blom and parker 2004 and blom et al 2006 2008 developed a model in which both bed elevation and bed grain size distribution are treated using a vertically continuous formulation parker et al 2000 this implies that there is no distinction between the active and inactive part of the bed the model by blom and coauthors satisfactorily describes the vertical stratigraphy due to dunes at laboratory scale but it requires a time step too small to be applicable at large scale moreover its well posedness has not been studied simplifying the continuous framework proposed by parker et al 2000 the vertically continuous model by viparelli et al 2017 overcomes the need for a small time step although applicable at large spatial and temporal scales their model does not solve the problem of ill posedness chavarrías et al 2018 given the facts that a there is not yet a practically feasible alternative to the active layer model b the active layer model remains well posed over a large range of applications chavarrías et al 2018 and c it is a computationally cheap model implemented in several software packages here our objective is to develop a strategy to avoid ill posedness while maintaining the conceptual framework of the active layer model to this end we develop a regularization strategy that recovers well posedness of the active layer model and we conduct 4 laboratory experiments under conditions in which the active layer model is ill posed to obtain data to which we compare the results of our regularized model the paper is organized as follows in section 2 we review strategies for regularizing ill posed models in section 3 we present the regularization strategy section 4 presents the laboratory experiments and section 5 focuses on the numerical runs to reproduce the experimental results in section 6 we discuss the limitations of the regularization strategy as well as other possible modeling strategies 2 overview of regularization techniques in this section we review techniques used to regularize ill posed problems propagation problems are most completely mathematically represented by a set of partial differential equations constituting an initial value problem in these problems an initial state changes with time subject to conditions at the boundaries of the domain the matrix vector formulation provides a compact expression of the set of equations e g courant and hilbert 1989 lyn and goodwin 1987 toro 2001 1 q t a q x s where q is the vector of dependent variables a is the system matrix and s is the vector of source terms the velocity at which small waves propagate throughout the domain i e the eigenvalues of matrix a must be real for the problem to be well posed e g hadamard 1923 ivrii and petkov 1974 kabanikhin 2008 lax 1957 1958 1980 mizohata 1961 when the eigenvalues are real the problem is hyperbolic if the eigenvalues have an imaginary component the problem being elliptic or of mixed type an initial value problem is ill posed the two fluid shallow flow model i e a model of the flow of two layers of superimposed fluids at different velocities is known to be ill posed when the difference in flow velocity between the upper and lower layers exceeds a certain threshold ardron 1980 armi 1986 lawrence 1990 long 1956 pelanti et al 2008 in general terms ill posedness arises in multiphase models e g bubbles in a fluid harlow and amsden 1975 kumbaro and ndjinga 2011 murray 1965 stewart 1979 stewart and wendroff 1984 multiphase models are regularized by accounting for the forces at the interface between the two fluids abgrall and karni 2009 drew et al 1979 liska et al 1995 lyczkowski et al 1978 ramshaw and trapp 1978 stewart 1979 stuhmiller 1977 tiselj and petelin 1997 travis et al 1976 although the physics of multiphase problems is better represented when including the effects of the interface forces this approach does not completely eliminate the possibility of the problem being ill posed fernández nieto 2003 castro díaz et al 2011 and sarno et al 2017 introduce an additional term in the momentum equations to account for friction between the fluid layers their regularization strategy yields a well posed model and has a physical origin however the additional physical term depends on the time step of the numerical solution which implies that it cannot be considered a fully physically based solution the numerical solution of a mathematically ill posed model can be well posed chen and peng 2006 chen et al 2007 savary and zech 2007 spinewine et al 2011 if the numerical solution neglects information in the physical equations greco et al 2008 worded differently in such a case the physical equations are ill posed but the numerical equations that we actually solve are well posed in particular when using the hll solver a common approximate riemann solver proposed by harten et al 1983 see toro 2009 one only uses the fastest and slowest eigenvalues of the system which implies that the dynamics due to the intermediate celerities are not resolved this hides the problem of ill posedness rather than solves it in determining the steady equilibrium state of a fluid dynamics problem a commonly adopted strategy to achieve fast convergence is to modify the celerities at which information propagates i e the system eigenvalues chorin 1967 grabowski and berger 1976 plows 1968 soh and berger 1984 for instance in aerodynamics the speed of sound may differ significantly from the air velocity which causes a slow convergence to steady state choi and merkle 1993 feng and merkle 1990 godfrey et al 1993 van leer et al 1991 preconditioning methods turkel 1987 1993 1999 aim at bringing the eigenvalues of the system closer to each other such that a larger time step is allowed analogously the bed celerity i e the speed of the wave related to changes in bed elevation lyn and altinakar 2002 morris and williams 1996 stecca et al 2014 de vries 1965 is generally slow compared to the celerities associated with perturbations of the flow this fact has encouraged the use of a morphodynamic acceleration factor in morphodynamic modeling to reduce the computational time latteux 1995 lesser et al 2004 ranasinghe et al 2011 roelvink 2006 mathematically as we will show later the use of a morphodynamic acceleration factor is equivalent to the application of a particular preconditioning method by altering the celerity at which information propagates the transient state of the preconditioned problem is altered with respect to the original problem but both problems converge to the same steady state solution if the boundary conditions are steady a drawback of preconditioning is the fact that when the problem is subject to unsteady boundary conditions preconditioning methods modify the steady state as they indirectly modify the timing of the boundary conditions turkel 1999 for this reason the boundary conditions of a preconditioned model need to be adjusted if these vary with time the fact that a preconditioning method alters the transient state was used by zanotti et al 2007 to regularize the two fluid model they modified the system of equations by introducing two parameters one parameter modifies the continuity equation which affects the imaginary part of the eigenvalues depending on the relations between velocities and densities of the two fluids a specific value of this parameter makes the imaginary part equal to zero apart from modifying the imaginary component the parameter also modifies the real part of the eigenvalues they introduce a second parameter that affects all equations to recover the original real part of the eigenvalues they compare the solution of the regularized model to analytical solutions and they show that the regularized two fluid model is stable in the next section we will follow a similar approach to derive a regularization strategy for the active layer model 3 regularization strategy for the active layer model in this section we propose a strategy for recovering the well posed character of the system of equations for modeling mixed sediment river morphodynamics the modified set of equations is presented in section 3 1 in section 3 2 we derive the parameters used to recover the well posed character of the model considering a simplified case with two sediment size fractions and steady flow which allows us to obtain analytical expressions we then extend the validity to unsteady flow conditions section 3 3 and to conditions with more than 2 sediment size fractions section 3 4 in section 3 5 we discuss the implementation of the strategy 3 1 modified system of equations we consider one dimensional hydrostatic flow over a bed composed of n non cohesive size fractions the flow is described by the saint venant 1871 equations we assume a chézy type friction in which the nondimensional friction coefficient is independent of the flow and bed parameters the sediment transport rate is considered to adapt instantaneously to changes in the bed shear stress bell and sutherland 1983 the mass conservation of the bed sediment is described by the exner 1920 equation and the n 1 active layer equations hirano 1971 account for the conservation of the mass of each grain size fraction within a discrete top layer of the bed surface i e the active layer given the flow friction and sediment transport assumptions the model cannot represent small scale processes i e processes at the scale of bed elevation fluctuations due the stochastic nature of sediment transport ripples dunes or bed load sheets in other words the variables represent parameters averaged over a period larger than the characteristic time of small scale bed elevation fluctuations armanini and di silvio 1988 blom et al 2008 parker et al 2000 ribberink 1987 wong and parker 2006 we refer to appendix a for the model equations and the matrix vector formulation of the system analogous to zanotti et al 2007 section 2 the system of equations in equation 1 is modified multiplying the time derivative term by a diagonal matrix m to regularize the problem 2 m q t a q x s matrix m modifies the transient state only the preconditioning technique does not affect the solution of the steady state i e t 0 the morphodynamic model under unisize conditions was analyzed by cordier et al 2011 they found that the saint venant exner model is always well posed assuming a chézy type friction this confirms that the ill posed character of the mixed size sediment model results from the inappropriate representation of the mixing processes by the active layer model chavarrías et al 2018 for this reason we propose a regularization strategy that recovers the well posed character modifying the celerities at which mixed sediment processes occur this is done by means of a set of parameters αk for 1 k n 1 that multiply the time derivative of each active layer equation similarly to zanotti et al 2007 we consider a parameter β that can be used to rescale the celerities after being modified by αk we stipulate that this parameter β affects only the sediment processes including the exner 1920 equation but not the flow the modified system of equations must be mass conservative with respect to the sediment this implies that αk cannot be grain size dependent i e α k α k and that the preconditioning technique is only applicable when the active layer thickness is constant appendix b 3 2 derivation of the regularization coefficients in this section we derive the values of the coefficients α and β that enable regularization of the active layer model we consider a simplified case with two sediment size fractions under steady flow conditions as this allows us to obtain analytical expressions of the regularization parameters in this case the dependent variables of the system are the bed elevation η m and the volume of fine sediment in the active layer per unit of bed area m a1 chavarrías et al 2018 and appendix a 3 q s 2 η m a 1 the system matrix is 4 a s 2 u λ b λ s 1 μ 1 1 λ b γ 1 λ s 1 where the parameters λ b and λ s1 are the nondimensional approximated bed and sorting celerities which approximately represent the celerities at which infinitesimal perturbations in bed level and grain size distribution of the bed surface propagate through the domain chavarrías et al 2018 stecca et al 2014 de vries 1965 and appendix a 5 and u m s is the mean flow velocity the parameters γ 1 and μ 1 1 relate the changes in the sediment transport rate to the properties of the bed appendix a 5 subscript s indicates that the model is steady and subscript 2 highlights that it accounts for two sediment size fractions only the preconditioning matrix is 5 m s 2 β 1 0 0 α note that β does not affect the mathematical character of the system as it modifies all equations equally worded differently the parameter β changes the magnitude of the eigenvalues but not the type real or complex we compute the eigenvalues λk for k 1 2 of the modified system of equations as the roots of the characteristic polynomial det m s 2 λ a s 2 0 6 λ k u 2 β λ b λ s 1 α δ α for k 1 2 where the discriminant δ is a second degree polynomial on α equal to 7 δ λ b 2 α 2 2 λ b λ s 1 2 γ 1 μ 1 1 1 α λ s 1 2 we consider a situation which is ill posed if the regularization strategy is not applied this implies that when α 1 the regularization strategy is not applied δ 0 the eigenvalues are complex we aim to modify the system of equations as little as possible in regularizing it worded differently we aim at changing α as little as possible from 1 the minimum modification is obtained when the discriminant is equal to 0 i e the eigenvalues are in the limit for having an imaginary part different than 0 the threshold values α c that modify the system of equations as little as possible are found by equating 7 to zero 8 α c λ s 1 λ b 1 2 γ 1 μ 1 1 2 γ 1 μ 1 1 γ 1 μ 1 1 1 there are two possible values of α c that yield real eigenvalues the discriminant eq 7 as a function of α is a concave parabola as λ b 2 0 moreover when α 0 δ λ s 1 2 0 and when α 1 δ 0 this shows that one critical value of parameter α is between 0 and 1 and the second value is larger than 1 i e 0 α c1 1 α c2 we compute the value of parameter β that assuming α α c recovers the real part that the eigenvalues would have if they had not been modified using the parameter α 9 β λ b λ s 1 α c λ b λ s 1 in this case irrespective of the value of α the eigenvalues of the regularized system are equal to 10 λ k u 2 λ b λ s 1 for k 1 2 if we do not use β to recover the original real part of the eigenvalues i e if β 1 the eigenvalues of the regularized system are equal to 11 λ k u 2 λ b λ s 1 α for k 1 2 parameter α can be selected to be larger or smaller than 1 and if we choose to use β i e if β 1 the eigenvalues are independent of α summarizing we find three possible regularization strategies 1 α 1 and β 1 2 α 1 and β 1 3 α 1 and β 1 in general terms the approximated sorting celerities are positive and under subcritical flow conditions i e fr 1 the approximated bed celerity is also positive however due to hiding in the sediment transport relation under conditions in which ill posedness likely occurs λ s1 may be negative regardless of the froude number chavarrías et al 2018 in this case strategies 1 and 2 do not guarantee that the eigenvalues λk 0 we consider that it is physically unrealistic that morphodynamic information travels in the upstream direction under subcritical flow conditions a negative eigenvalue would imply that the boundary condition for morphology needs to be imposed at the downstream end to yield a well posed model and this is contradictory to the fact that the morphodynamic state under subcritical flow conditions depends on the load coming from upstream blom et al 2017a 2016 on the other hand strategy 3 guarantees that λk 0 appendix a of the supplementary material thus we consider that the only possible regularization strategy is the one in which α 1 and β 1 we need to guarantee that the celerities of the system of equations modified by the regularization strategy are not physically unrealistic in particular under a sufficiently small froude number the modified bed and sorting celerities must be significantly smaller than the celerities of the flow the regularization technique does not modify the approximated celerity associated with bed elevation changes i e β 1 and decreases the celerity associated with mixing processes i e α 1 we will discuss this point in section 6 1 for this reason the regularization technique does not cause the celerities to be physically unrealistic the regularization strategy is not limited to a particular range of parameter settings yet when using the value of α derived in this section the froude number cannot be in the transcritical region as in this case the quasi steady approximation is not valid cao and carling 2002b cao et al 2002 colombini and stocchino 2005 lyn 1987 lyn and altinakar 2002 sieben 1999 in the following section we consider unsteady flow which extends the regularization technique to the transcritical region 3 3 validity under unsteady flow conditions in this section we extend the validity of the regularization parameter α found for steady flow cases section 3 2 to unsteady flow conditions when considering unsteady flow conditions we cannot obtain an analytical expression of α c for regularizing the system of equations nevertheless we can numerically find the smallest value of α 1 for which the roots of the characteristic polynomial of det m u λ a u 0 are real values i e the eigenvalues are real where subscript u indicates that the model is unsteady matrices m u and a u are listed in appendix a 5 this procedure is nonetheless expensive computationally in comparison with an algebraic calculation fig 1 shows the maximum imaginary part of all eigenvalues of a reference ill posed case table 1 considering unsteady flow for varying α the sediment transport rate is computed using a fractional version of the engelund and hansen 1967 sediment transport relation blom et al 2017a a value α 16 1 yields a well posed model i e all eigenvalues are real to test the validity of the algebraic value of α c obtained assuming steady flow we consider the same reference case table 1 and we vary the flow velocity to obtain a range of conditions in fig 2 a we present the value of α c necessary to obtain a well posed model computed assuming steady flow eq 8 and numerically considering unsteady flow we conclude that for a froude number below approximately 0 6 there is no significant difference between the values for steady and unsteady flow this implies that for fr 0 6 the value of α c obtained analytically assuming steady flow is a good approximation of the actual value 3 4 validity under multiple size fractions conditions in a model with more than 2 size fractions we cannot analytically obtain the value of α c that regularizes the active layer model similar to the unsteady case it is possible to numerically obtain the smallest value of α 1 that yields real eigenvalues computed as the roots of the characteristic polynomial det m s λ a s 0 matrices m s and a s are presented in appendix a 5 again this process is relatively expensive in computational terms in this section we propose a method to obtain an approximate value of α c for such cases and compare it to the exact value obtained numerically assuming steady flow a system that models n sediment size fractions has n equations appendix a we reduce the system of n equations to an approximate system of 2 equations following the approach of ribberink 1987 we sum the n active layer equations to obtain one equation that models the changes of the mean grain size of the bed surface sediment appendix a 3 subsequently we apply the same technique as the one we have used in the case of 2 size fractions to obtain a critical value of α that guarantees that the approximate model is well posed 12 α cm λ m λ b 1 2 γ m μ m 2 γ m μ m γ m μ m 1 where the symbols are the equivalent of the case for two size fractions in the approximate model appendix a 5 we consider a case with 3 sediment size fractions where the fine and coarse fractions have characteristic sizes equal to d 1 0 001 m and d 3 0 005 m respectively the volume fraction contents of the 3 size fractions in the active layer are f a 1 0 f a 2 0 9 and f a 3 0 1 the substrate is fully composed of fine sediment we vary the medium grain size d 2 to obtain a range of conditions the remaining parameters are the same as the ones presented in table 1 in fig 2 b we compare the exact value of α c computed numerically to the approximated one computed using eq 12 the approximated value of α c follows the same trend as the exact one however the approximated value is both larger and smaller than the exact one depending on the sediment conditions this implies that the current approximate approach may be insufficient to regularize the active layer model in the case of more than 2 sediment size fractions the approximate system of equations can be ill posed under degradational conditions into a fine substrate only chavarrías et al 2018 ribberink 1987 however a 3 size fractions case can be ill posed under degradational conditions into a coarse substrate chavarrías et al 2018 which further limits the applicability of the approximate solution for the threshold value of α 3 5 implementation in this section we describe our approach for numerically solving the system of equations and apply the regularization strategy we have developed the numerical research code elv to model mixed size sediment river morphodynamics blom et al 2017a 2017b which solves the equations for flow bed elevation and the bed surface grain size distribution in a decoupled manner i e in series and not as a coupled system of equations thus our code is not appropriate for solving transcritical situations lyn 1987 lyn and altinakar 2002 sieben 1999 or cases with a high sediment concentration cao and carling 2002a morris and williams 1996 the one dimensional spatial domain is discretized using an equispaced grid all variables are computed at the cell centers and are considered constant in each time step here we assume steady flow which is represented by the backwater equation eq 16 this ordinary differential equation is integrated using the standard fourth order finite difference runge kutta method rk4 the exner 1920 equation eq 17 and active layer equation eq 19 are solved in conservative form using a first order upwind scheme in combination with forward euler to integrate in time we discretize the vertical domain in a finite number of cells having a certain thickness to account for stratigraphic changes in the substrate our scheme is balanced for the vertical fluxes between the active layer and the substrate stecca et al 2016 this means that mass conservation is guaranteed independent of the substrate discretization the time step varies with time and is computed such that the cfl number courant et al 1928 is constant and equal to 0 9 toro 2009 wu 2007 the details of the numerical implementation are described in appendix b of the supplementary material when the regularization strategy is applied we first determine the mathematical character of the model i e well posed or ill posed at each node using the approach proposed by chavarrías et al 2018 for the case of 2 size fractions this is done evaluating an algebraic equation and for more than 2 size fractions we numerically compute the eigenvalues of the system matrix at continuation for each node we compute the threshold value α c that guarantees that the model is well posed again this is done evaluating an algebraic expression eq 8 for 2 size fractions and it is done numerically for more than 2 size fractions section 3 4 the regularization strategy yields equal eigenvalues i e in a two size fractions case λ 1 λ 2 eq 11 this implies that the problem is hyperbolic but not strictly hyperbolic cordier et al 2011 lax 1980 toro 2009 in a non strictly hyperbolic problem the solution may not be unique and resonance may occur which gives rise to strong non linear interactions isaacson and temple 1992 liu 1987 in avoiding a non strictly hyperbolic problem we modify the value of α c using a small parameter ϵ 0 such that α α c 1 ϵ where α is the value used for updating the bed surface grain size distribution for the cases we have studied a value of ϵ 0 005 is sufficient to avoid the problems associated with non strict hyperbolicity ill posedness causes short wave instability chavarrías et al 2018 joseph and saut 1990 and section 5 1 2 meaning that perturbations will grow unstable at rates depending on the inverse of their length diffusion counteracts these effects by dampening perturbations gray and ancey 2011 regularization of the problem can be provided by numerical diffusion if a first order diffusive method is used however if the underlying problem is ill posed cell refinement will be able to reveal its ill posed character even if a first order method is used in its solution as we do in this paper this is because with decreasing cell size the numerical diffusion coefficient of a first order method will generally decrease while at the same time shorter more unstable perturbations will be solved therefore an ill posed problem will show no convergence due to its inherent instability when the mesh is progressively refined regardless of the low order method in use we observe such a behavior in section 5 1 2 where we show that our low order numerical scheme suffices to capture the consequences of ill posedness by revealing instability and non converging character in simulations conducted within the ill posed range it is likely that with a higher order non diffusive method these features would have become apparent even at lower mesh resolution due to absence of spurious diffusion dampening perturbations however it must be considered that our upwind scheme is characterized by small numerical diffusion coefficient and that stecca et al 2016 and siviglia et al 2017 have shown that a first order upwind scheme with a fine grid resolution is sufficient to capture the main features of mixed size sediment morphodynamic simulations such as the ones we conduct 4 laboratory experiments in this section we describe the laboratory experiments conducted under conditions in which the active layer model hirano 1971 is ill posed in order to obtain a data set to which we can compare the results of the proposed regularization strategy we describe the experimental plan materials and measurements in section 4 1 in section 4 2 we present the experimental results 4 1 experimental plan and measurements we conducted 4 laboratory experiments i1 i2 i3 and i4 the experiments reproduced degradational conditions into a fine substrate which are conditions prone to be ill posed chavarrías et al 2018 ribberink 1987 stecca et al 2014 the experiments were conducted in a 14 m long 0 40 m wide and 0 45 m high tilting flume in the water laboratory of the faculty of civil engineering and geosciences of delft university of technology at the upstream end a turbulence dissipation device was installed item a in fig 3 an inclined plane was placed downstream from the turbulence dissipation device item b in fig 3 to allow for an alluvial bed item c in fig 3 the structure was covered with glued sediment such that friction was similar to the one of the alluvial bed its elevation could be adjusted we consider a reference system with coordinate origin at the bottom of the flume at the downstream end of the metal structure the z axis is parallel to gravity and pointing up the x axis follows the streamwise direction of the flume being positive in the direction of the flow the y axis is perpendicular to the other two axes forming a right handed orthonormal basis we used two sediment size fractions fine and coarse with characteristic grain sizes computed as the arithmetic mean in ϕ scale equal to 2 1 mm and 5 5 mm the standard deviation of the two size fractions is 1 1 mm and 1 2 mm respectively the bed surface was initially flat with a constant slope and composed of coarse sediment only below a 0 03 m thick layer of coarse sediment we installed a patch of fine sediment of varying length l p m fig 3 and table 2 we imposed a constant water discharge and a constant sediment feed rate of the coarse fraction only which was in equilibrium with the initial condition table 3 and appendix c of the supplementary material the sediment was introduced using a feeder placed on top of the flume item d in fig 3 the downstream water level was lowered at a rate of 0 01 m h during 8 h by adjusting a sharp crested weir at x 12 60 m item g in fig 3 the lowering of the water level led to bed degradation and entrainment of the fine sediment in the patch we have tested that in these conditions the active layer model is ill posed regardless of the active layer thickness and sediment transport relation sediment was collected in a sand trap item e in fig 3 at the downstream end of the flume x 12 10 m the sediment was pumped from the sand trap item f in fig 3 into a tank positioned on a weight balance next to the flume this system allowed us to continuously measure the sediment transport rate the water inflow was measured using an ultrasonic flow meter and the downstream water level using a position sensor we obtained profiles of the water and bed elevation using laser sensors that were fixed to a carriage item h in fig 3 a camera was mounted on the carriage to measure the grain size distribution of the bed surface using the technique developed by orrú et al 2016a b item i in fig 3 to this end the coarse sediment was painted red and the fine sediment blue our experimental set up allowed us to measure either a profile of bed and water surface elevation or the bed surface grain size distribution at a certain location with time for the modeling of the laboratory experiments section 5 it is important to obtain turbulent flow conditions of a relatively deep flow i e flow cannot be affected by individual grains where sediment is predominantly transported as bed load the concentration of sediment needs to be so small that we can assume clear water these conditions were satisfied appendix c of the supplementary material 4 2 results all experiments were governed by the same conditions before the fine sediment in the patch was entrained we observed the superposition of bedforms of two different length scales fig 4 secondary bedforms approximately 0 5 m long and 0 01 m high were superimposed on primary longer bedforms of the order of 3 m and twice as high the primary bedforms are interpreted as incipient gravel dunes carling 1999 carling et al 2005 the characteristics of these features remained steady as the bed degraded the steadiness of the features characteristics is confirmed in a preparatory experimental run without a patch of fine sediment appendix c of the supplementary material after approximately 2 h the bed had degraded up to a point at which the trough of a long bedform was lower than the top part of the patch fig 5 a at that moment fine sediment was exposed entrained and transported the larger mobility of the fine sediment created a downstream moving degradational wave fig 5 b as erosion proceeded the shear stress was reduced due to the increased flow depth which reduced the degradation rate meanwhile the subsequent bedform advanced and started to fill the degradational pit with coarse sediment fig 5 c overall the passage of bedforms induced entrainment of fine sediment and subsequent coarsening of the top part of the substrate since the degradational wave increased in depth in downstream direction also the thickness of the coarse top layer increased in downstream direction fig 5 d the substrate coarsening mechanism created an irregular interface between coarse and fine sediment compared to the initial situation where the interface was parallel to the bed surface as a consequence the entrainment of fine sediment became a pseudo random process in space and time degradational waves formed at those locations where fine sediment was closest to the bed surface yet most of the waves grew for only a limited length as due to the irregular interface at some point the sediment present at the trough was coarse rather than fine sometimes the interface was sufficiently parallel to the bed surface and a large degradational wave formed this is seen in the content of coarse sediment at the bed surface of the patch fig 6 a c e and g and in the bed elevation fig 7 one or two small degradational waves formed after the passage of a large degradational wave characterized by the fact that the bed surface is composed of mainly fine sediment and the trough of a bedform reaches elevations significantly lower than average a longer patch allowed for the development of longer in space and time and deeper erosional waves figs 6 and 7 yet the decrease in degradation rate as the wave advanced acted as a saturation mechanism limiting the height of the wave thus the probability of lower bed elevation at the patch zone was not significantly larger for an increasing patch length fig 8 after the patch where the substrate was composed of coarse sediment only wave height decreased and the bed elevation profile tended to the one upstream of the patch fig 7 yet the presence of fine sediment downstream of the patch slightly increased the height of the bedforms with respect to the bedforms upstream of the patch fig 8 a and c bedforms downstream of the patch were characterized by a coarse front and fine tail and were approximately 2 grain sizes of the coarse sediment high these characteristics may indicate the presence of bedload sheets dietrich et al 1989 recking et al 2009 whiting et al 1988 or bedforms in a transitional phase to small dunes the domain downstream from the patch was not long enough to precisely conclude on the type of bedforms the changes in volume fraction content of coarse sediment at the bed surface were less pronounced downstream of the patch compared to at the patch fig 6 b d f and h this is because fine sediment entrained at the patch dispersed in the downstream direction 5 numerical modeling in this section we apply the regularization strategy in modeling the laboratory experiments conducted under conditions in which the active layer model is ill posed section 5 1 in section 5 2 we compare the results of the regularized active layer model to the results of the two layer model developed by ribberink 1987 by applying them to a thought experiment under conditions in which the active layer model is ill posed 5 1 modeling of our laboratory experiments in section 5 1 1 we calibrate the numerical model in section 5 1 2 we conduct a convergence test to show the consequences of ill posedness and the benefits of the regularization strategy in section 5 1 3 we apply the numerical model to the laboratory experiments described in the previous section in section 5 1 4 we test the regularization strategy assuming three sediment size fractions 5 1 1 calibration modeling the laboratory experiments requires values for the active layer thickness and the friction coefficient and the choice of a sediment transport relation to this end we use the results of a set of preparatory experiments appendix c of the supplementary material to chose a sediment transport relation we run two experiments conducted under equilibrium conditions while feeding the fine and the coarse sediment size fractions the sediment transport relation by ashida and michiue 1971 reproduces our results reasonably well appendix d of the supplementary material to obtain the skin friction coefficient c fb for computing the sediment transport rate appendix a 4 we correct the total measured friction coefficient c f for side wall friction with the method developed by johnson 1942 see guo 2015 we obtain the values c f 0 0104 and c fb 0 0084 bedform drag was negligible during the initial phase as bedforms were low when fine sediment was entrained bedforms grew and bedform drag may have played a role it is not reasonable to model this additional friction using standard relations e g engelund and hansen 1967 haque and mahmood 1983 wright and parker 2004 as these relations provide a bedform averaged friction coefficient while in our case large bedforms were isolated in space and time we decide to use a constant friction coefficient and we think that the most sensible approach is to neglect bedform drag a reasonable value for the active layer thickness is 0 01 m which corresponds to the distance below the mean bed elevation with a probability of entrainment below approximately 5 blom 2008 ribberink 1987 this value is also in accordance with 1 3 times d 90 as proposed by for instance hirano 1971 hoey and ferguson 1994 and seminara et al 1996 in one preparatory experiment under equilibrium conditions we fed coarse sediment only and from some point we started feeding tracer sediment i e sediment of a different color modeling the propagation of the front of tracer sediment we confirm that 0 01 m is a reasonable value for the active layer thickness appendix d of the supplementary material 5 1 2 convergence test first we aim to show the consequences of ill posedness to this end we simulate conditions similar to the ones of the experiments using the active layer model in the experiments degradation into a coarse substrate i e under well posed conditions occurred for approximately 2 h as the patch of fine sediment was placed 3 cm below the initial bed surface in order to obtain ill posed conditions at the start of the simulations the patch of fine sediment is placed right below the active layer in this manner 300 s simulations suffice for our purpose moreover the patch extends over a distance of 8 m from x 1 m to x 9 m to maximize the domain over which the model is ill posed we conduct 13 simulations using cell sizes ranging from 0 1 m down to 2 44 10 5 m the results do not converge and continue to change as the grid is refined fig 9 a we compute the error as a function of the cell size to quantify the lack of convergence as there is no analytical solution to which we can compare the results of the numerical runs we compute the error between the results of two successive simulations s and s 1 love and rider 2013 roy 2005 to this end first we interpolate the bed elevation results of all simulations using the smallest cell size the interpolation rather than linear takes into consideration that each value is constant inside a cell second we compute the error as the norm 1 of the difference between bed elevations of two successive simulations at a certain time t 13 error s t 1 l n x r 1 n x η r s t η r s 1 t where n x denotes the number of cells of the simulation with the smallest cell size and l m the domain length fig 9 c shows the error as a function of the cell size for several times if the cell size is large for instance larger than 0 01 m for short simulation times for instance shorten than 10 s the results seem to converge yet using the same cell size the results do not converge if one considers a longer simulation time similarly considering a simulation time equal to 10 s the results do not converge when the cell size is smaller than 0 002 m this behavior is characteristic of ill posed simulations the growth rate of perturbations increases with decreasing cell size for this reason the consequences of ill posedness arise earlier for smaller cell sizes given a certain cell size if the simulation is short enough perturbations do not have time to grow and the solution seems to converge for a fixed time simulations seem to converge after the error grows for instance for t 120 s simulations seem to converge for cell sizes between 0 001 m and 0 01 m this is due to the fact that at the given time perturbations have already grown significantly and have coarsened the bed material causing the simulation to be well posed a further decrease of the cell size or an analysis at a different time shows that the active layer model does not converge we repeat the same simulations applying the regularization strategy the initial value of the parameter that recovers the well posed character of the system is α c 11 6 in this case the solution does not show oscillations fig 9 b moreover the solution converges for a decreasing cell size independently from the time at which convergence is tested fig 9 d this supports the fact that the regularized model is well posed contrary to the active layer model the rate at which the solution converges confirms that the numerical scheme is first order accurate section 3 5 5 1 3 two sediment size fractions we reproduce all laboratory experiments using a cell size equal to 0 05 m the regularized model shows spatial or temporal oscillations in none of the cases fig 10 for all cases the bed elevation decreases smoothly in the streamwise direction fig 10 b f j and n this contrasts with the measured temporal change of bed elevation which presents bedforms and the formation of degradational waves at the upstream end of the patch fig 10 a e i and m the measured increase in wave height at the patch fig 10 a e i and m and section 4 2 is not captured the effect of the patch is observed in the model results in the fact that degradation occurs faster for a long patch fig 10 than for a short one fig 10 b the continuous and smooth predicted entrainment of substrate sediment yields an almost steady volume fraction content of sediment in the active layer both at the patch fig 10 c g k and o and at the downstream end fig 10 d h l and p the measured data shows on the other hand a variable volume fraction content at the bed surface the model correctly captures the mean value and nicely reproduces that a longer patch causes an increase in the amount of fine sediment at the bed surface the fact that the model does not capture bedforms is not surprising as the mechanisms necessary for bedform formation are not present in the model for instance the fact that the flow model is based on the hydrostatic pressure assumption prevents modelling processes such as flow separation the possibility of capturing the formation of the degradational waves at the patch is also discarded as from the analysis of well posedness we see that the regularized model does not show any instability mechanism that could induce wave growth for this reason the model results represent values averaged over the passage of several bedforms and degradational waves we choose not to filter the measured bed elevation data as given the characteristics of the bedforms it would introduce a large amount of spurious information e g the degradational wave would start at the wrong location and we would lose a significant amount of data at the beginning and end of the domain overall the regularized model yields a reasonable approximation of the mean temporal change of the measured data the degradational trend is captured and the surface grain size distribution approximates the average measured values the substrate is not unrealistically altered as there are no oscillations in the solution 5 1 4 three sediment size fractions to test the regularization strategy for multiple grain sizes we model experiment i4 table 2 using 3 different grain sizes by applying the exact solution to obtain the regularization parameter the fine size fraction remains the same and the previous coarse size fraction is represented in this case by two characteristic grain sizes equal to 4 895 mm and 5 895 mm for an initial volume fraction content at the bed surface of the medium size sediment equal to 0 375 the initial bed slope is the same as when using two characteristic sizes and the sum of the sediment transport rate of the medium and coarse fractions when using three sizes is equal to the sediment transport rate of the coarse fraction when using two sizes in this manner the simulation accounting for three sediment fractions is comparable to the one accounting for two size fractions in fig 11 we compare the bed elevation and mean grain size of the bed surface sediment predicted by the regularized model using 2 and 3 sediment size fractions the evolution of the bed elevation shows only a weak dependence on the number of size fractions used to discretize the sediment mixture the model with 3 size fractions presents a mild coarsening 0 2 increase in mean grain size with time before sediment from the patch is entrained after 2 h this coarsening is not visible when using 2 size fractions because in this case during the initial state the bed surface sediment consists of one single grain size only we conclude that the regularization technique is applicable for a general case with more than 2 size fractions 5 2 comparison between ribberink s 1987 two layer model and the regularized model to our knowledge there is no other laboratory data set apart from the one presented in section 4 to which we can apply the regularized active layer model to test its performance this is because either the conditions that other researchers have studied yield a well posed active layer model e g ashida and michiue 1971 or the active layer model is ill posed but the active layer thickness varies with time due to dune growth blom et al 2003 the latter case is a situation that the regularization strategy cannot deal with section 3 1 however ribberink 1987 applies his two layer model to a thought experiment under conditions in which the active layer model is ill posed in this section we apply the regularized active layer model to his thought experiment and compare it to the two layer model ribberink 1987 conducted a laboratory experiment with mixed size sediment which was dominated by aggradation after a period of degradation experiment e8 e9 the initial bed was characterized by a uniform slope composed of a bimodal mixture a coarse and fine fraction and well mixed both in the streamwise and vertical direction the sediment supply was initially in equilibrium a temporal increase of the proportion of the coarse fraction in the sediment supply perturbed the equilibrium condition and induced the downstream propagation of a coarsening wave the downstream migration of the coarsening front caused a preceding and temporary bed degradation as a result of the difference in sediment mobility between the coarse sediment forming the wedge and the fine sediment downstream of the front of the wedge eventually the bed aggraded and was characterized by a larger slope than the initial one so as to allow for the transport of the coarser fed sediment under equilibrium conditions during the short degradational part of the experiment the bed surface was coarser than the substrate i e conditions in which the active layer model is prone to be ill posed chavarrías et al 2018 ribberink 1987 stecca et al 2014 however while reproducing the experiment numerically ribberink 1987 found that the active layer model was well posed subsequently ribberink 1987 applied his two layer model to a thought experiment that was equal to e8 e9 except for the fact that the substrate sediment was finer than in the flume experiment such that the active layer model is ill posed a numerical simulation of the thought experiment using the active layer model showed oscillations that eventually made the code crash ribberink 1987 the thought experiment was reproduced well by a numerical code implementing ribberink s 1987 two layer model here we run a numerical simulation of the thought experiment using our regularized active layer model and compare it to the results of ribberink s 1987 two layer model reported in fig 7 9 of ribberink 1987 simulation details can be found in appendix c fig 12 presents the time series of bed elevation and mean grain size of the bed surface sediment at a location 20 m downstream from the inlet during the first 20 h the effects of the coarsening of the fed sediment are not felt 20 m downstream from the inlet while the regularized active layer model predicts a constant bed elevation and grain size distribution of the bed surface sediment during this period of time the two layer model predicts a fining of the bed surface fig 12 b this is due to the fact that the initial grain size distribution of the exchange layer is not in equilibrium with the one at the active layer and causes a vertical flux of sediment however the bed elevation remains constant as predicted by both models fig 12 a the aggradational phase is preceded by a degradational wave which is much more pronounced in the regularized active layer model than in the two layer model this is because in the regularized active layer model degradation causes entrainment of the fine substrate sediment whereas in the two layer model the exchange layer acts as a buffer that slows down the process the coarsening of the bed surface between approximately 25 h and 40 h as predicted by both models is very similar while after 40 h the regularized active layer model predicts a constant grain size distribution of the bed surface sediment the two layer model predicts an asymptotic adaptation toward equilibrium conditions this effect is again caused by the exchange layer that coarsens slowly compared to the active layer on top of it as it accounts for the effects of occasionally large bedforms the equilibrium state differs between the two models we believe that this is due to the fact that we do not know exactly what values were used by ribberink 1987 for the constants in the sediment transport relation appendix c the regularized active layer model captures the dynamics predicted by the two layer model of ribberink 1987 the advantage of the two layer model is that it accounts for a source of vertical mixing that the regularized active layer model does not take into consideration i e the mixing due to occasionally large bedforms on the other hand the two layer model may become ill posed sieben 1994 while the regularized active layer model is always well posed 6 discussion in this section we discuss the physical interpretation of the regularization strategy section 6 1 as well as possible extensions and further development section 6 2 6 1 physical interpretation of the regularization strategy the ill posed solution predicted by the active layer model is characterized by oscillations that temporarily fine the bed surface and coarsen the substrate this behavior is also observed in our laboratory experiments figs 6 and 7 one may be tempted to conclude that the active layer model although being mathematically ill posed provides reasonable results this argument is wrong for two reasons the first reason is that the numerical solution does not converge for a decreasing mesh size the solution keeps changing and oscillations become larger when the cell size is reduced chavarrías et al 2018 joseph and saut 1990 such a solution cannot be representative of physical phenomena second the physical processes responsible for the small scale variability in bed elevation i e ripples bedload sheets are not accounted for by the active layer model section 3 1 any resemblance of the model results with bed elevation fluctuations due to small scale bedforms is therefore coincidence the frequently used morphodynamic factor φ η latteux 1995 ranasinghe et al 2011 roelvink 2006 is a particular case of a preconditioning matrix with parameters β 1 φ η and α k 1 k the proposed regularization strategy can be considered as the use of a morphodynamic factor not only for the changes in bed elevation η but also for the changes in grain size distribution of the bed surface m ak the sorting morphodynamic factor φsk is then defined as φ s k 1 α k β we have seen that the only applicable regularization strategy is that in which α k α 1 k and β 1 which is equivalent to saying that the regularization strategy is based on a sorting morphodynamic factor 0 φs 1 this implies that the mixing or sorting processes associated with changes in grain size distribution of the bed surface sediment are slowed down with respect to the celerity predicted by the active layer model the effect of applying the regularization strategy is a slowdown of the sediment mixing processes in the model computations this effect is similar to the effect of a temporary increase of the active layer thickness from a physical perspective this slowdown of mixing processes may be associated with a temporary increase of the range of elevations covered by the bed level fluctuations blom et al 2008 the slowdown of mixing processes resulting from applying the regularization strategy implies that the regularized active layer model can be applied to a wider range of physical problems i e also those characterized by a fairly small time scale of mixing than the active layer model 6 2 alternatives to the regularization strategy our regularization strategy is applied locally and temporally worded differently only when and where the model is ill posed we update the grain size distribution of the bed surface sediment using the parameter α c moreover α c depends only on the conditions at the location under consideration note that the preconditioning matrix is diagonal this is the simplest strategy but one could decide to avoid discontinuities in the value of α c throughout the domain by coupling neighboring nodes carraro et al 2018 propose a technique to decrease the computational cost of morphodynamic simulations as in our case their strategy can be seen as a preconditioning technique they consider unisize sediment conditions and modify not only the exner 1920 equation but also the continuity equation here we modify the active layer equation but not the flow equations or the exner 1920 equation a combination of both strategies could yield a technique that both decreases the cost of numerical simulations and guarantees that the model is well posed we have focused on restoring the hyperbolic character of the system of equations and to this end we based our study on the linear solution i e short waves this focus suffices here as short waves are most sensitive to ill posedness joseph and saut 1990 however the regularization strategy modifies the celerity and growth rate not only of short waves but also of long ones for this reason we suggest to further study how long waves are affected and whether the results of the regularization strategy are physically realistic based on a similar analysis to that of lanzoni et al 2006 we have assumed a constant active layer thickness to avoid the added complexity due to a cumbersome closure relation linking the preconditioning parameters to the change in time of the active layer thickness it may be possible to extend our regularization strategy to situations in which the active layer thickness changes with time e g due to dune growth by providing such a closure relation on the other hand it is reasonable that the regularization strategy requires a constant active layer thickness given the fact that mathematically the strategy has the same effect as an increase in the active layer thickness i e a decrease in the celerity of the mixing processes we have concluded that the regularization strategy needs to slowdown the mixing processes i e α c 1 to guarantee that the eigenvalues are always positive regardless of the value of the sorting celerity λ s1 however if the sorting celerity is guaranteed to be positive e g because hiding is negligible the acceleration of the mixing processes also yields positive eigenvalues and a well posed model there may be cases in which the latter strategy yields more realistic results moreover we have chosen to guarantee that the regularized eigenvalues are positive reasoning that morphodynamic information travels in the downstream direction under subcritical conditions lanzoni et al 2006 lyn and altinakar 2002 stecca et al 2014 suzuki 1976 this statement is partially contradictory to recent studies that consider sediment transport as a stochastic process ancey and heyman 2014 furbish et al 2012 the stochastic nature of sediment transport yields an advection diffusion equation that models the amount of moving particles per unit of bed area the diffusive character implies that information also travels in the upstream direction for this reason a regularization strategy in which information travels in the upstream direction may be physically realistic under certain circumstances for a case with more than two sediment size fractions section 3 4 the approximate value of the parameter α c is not completely satisfactory as well posedness is not guaranteed we have observed in our tests that ill posedness occurs when at least two eigenvalues of the bed and sorting eigenvalues are similar with respect to the other bed and sorting eigenvalues for a case considering two sediment size fractions this is referred in literature as the crossing of eigenvalues sieben 1997 stecca et al 2014 worded differently the difference between two eigenvalues must be large enough for the model to be well posed a regularization strategy based on guaranteeing a minimum distance between eigenvalues could yield an inexpensive solution for the case with more than two sediment size fractions 7 conclusions we have developed a preconditioning method for regularizing the active layer model hirano 1971 used in modeling mixed sediment river morphodynamics our method recovers the well posed character of the system of equations by means of one parameter that modifies the celerity of the mixing processes physically this means that the mixing processes are slowed down or the time scale of the mixing processes is increased we conduct 4 laboratory experiments under conditions in which the active layer model is ill posed and we compare the observations to the predictions of the regularized active layer model the regularized active layer model captures the mean behavior observed in the experiments associated with changes averaged over the passage of several bedforms acknowledgments this research is part of the research programme rivercare supported by the dutch applied and engineering sciences aes domain of the netherlands organization for scientific research nwo and which is partly funded by the ministry of economic affairs under grant number p12 14 perspective programme the involvement of guglielmo stecca was supported by niwa under the sustainable water allocation programme the fruitful discussions and comments on the manuscript of liselot arkesteijn are gratefully acknowledged we thank the editor prof dr g c sander associate editor dr c manes and three anonymous reviewers for their comments which have significantly improved the manuscript appendix a model equations in this section we present the system of equations for modeling mixed sediment river morphodynamics in section a 1 we present the flow equations in section a 2 we present the active layer model hirano 1971 a simplified active layer model is presented in section a 3 in section a 4 we show the closure relations in section a 5 we present the system of equations in matrix vector formulation a 1 flow equations we consider a one dimensional mixture of water and sediment flowing over a mobile bed a set of partial differential equations that accounts for the interactions between sediment and water is found by applying mass and momentum conservation principles for the mixture of sediment and water e g garegnani et al 2011 greco et al 2012 the complete system of equations reduces to the saint venant exner model i e clear water approximation under low sediment concentrations c q b q 0 006 where q b m2 s and q m2 s are the sediment transport rate and flow discharge per unit width respectively e g garegnani et al 2011 garegnani et al 2013 in the remaining we will assume that the clear water approximation is valid the flow is modeled using the saint venant 1871 equations 14 h t q x 0 15 q t q 2 h g h 2 2 x g h η x g h s f where t s denotes the time coordinate x m the streamwise coordinate h m the flow depth g m s2 the acceleration due to gravity η m the bed elevation and s f the friction slope the flow equations can be further simplified assuming steady flow under this condition the conservation of water mass and momentum reduce to a spatially constant discharge and the backwater equation 16 h x 1 1 fr 2 η x s f 1 fr 2 where fr q g h 3 is the froude number a 2 active layer model to model changes in bed elevation we assume that the sediment transport rate adapts instantaneously to changes in bed shear stress spatial and or temporal adaptation to capacity load bell and sutherland 1983 phillips and sutherland 1989 1990 is not considered neglecting mechanisms such as subsidence and uplift paola and voller 2005 and assuming a constant bed porosity we obtain the exner 1920 equation 17 η t q b x 0 where for simplicity the sediment transport rate includes the pores the sediment phase is composed of a mixture of n non cohesive sediment size fractions each fraction is characterized by a grain size dk m where k is an index identifying a size fraction the total sediment transport rate per unit width is the sum of the sediment transport rate of size fraction k q bk m2 s 18 q b k 1 n q b k the conservation of the volume of sediment of size fraction k in the active layer per unit of bed area m a k f a k l a m is expressed mathematically as hirano 1971 19 m a k t f k i η l a t q b k x 0 for 1 k n 1 where f ak 0 1 is the volume fraction content of size fraction k in the active layer f k i 0 1 is the volume fraction content of size fraction k at the interface between the active layer and the substrate and l a m is the active layer thickness by definition 20 k 1 n f a k 1 k 1 n f k i 1 from the first constrain in eq 20 one obtains the change of the volume of sediment in the active layer of the nth grain size with time the system is complete with an equation for the conservation of mass in the substrate yet this equation is linearly dependent on the exner 1920 and hirano 1971 equations which implies that it does not play a role in the mathematical character of the system chavarrías et al 2018 stecca et al 2014 a 3 simplified active layer model to simplify the system of equations we replace the n 1 equations that account for the change in bed surface volume fraction content of the n fractions by one equation that models the average grain size following the approach of ribberink 1987 we multiply each regularized active layer equation by its characteristic grain size and we add all the equations 21 α d ma t d m i l a q b x 1 l a k 1 n d k q b k x 0 where d ma k 1 n d k f a k m is the mean grain size of the sediment in the active layer and d m i k 1 n d k f k i m is the mean grain size of the sediment at the interface between the active layer and the substrate the mean grain size is computed arithmetically as it is a necessary step to obtain an approximate equation yet we consider that the mean grain size is better approximated assuming the grain size distribution to be logarithmically distributed we write the sediment transport rate q bk as a function of the flow depth h and the mean grain size of the sediment in the active layer d ma such that 22 q b k x q b k h h x q b k d ma d ma x we use that 23 d ma k 1 n d k f a k d n 1 l a k 1 n 1 m a k d k d n where we have used the constrain that k 1 n f a k 1 thus 24 q b k d ma l 1 n 1 q b k m a l m a l d ma l a l 1 n 1 1 d l d n q b k m a l where we have used that 25 m a l d ma l a d l d n we substitute the backwater equation eq 16 in the exner 1920 equation eq 17 and the equation of the mean grain size eq 21 to obtain the final set of equations 26 η t 1 1 fr 2 q b h η x q b d ma d ma x 1 1 fr 2 q b h s f 27 α d ma t 1 l a 1 1 fr 2 d m i q b h k 1 n d k q b k h η x 1 l a d m i q b d ma k 1 n d k q b k d ma d ma x 1 l a 1 fr 2 d m i q b h k 1 n d k q b k h s f a 4 closure relations to close the system of equations we provide closure relations for the friction term the sediment transport rate and the flux between the active layer and the substrate we adopt the following chézy closure relation for the friction term 28 s f c f u 2 g h where c f is a nondimensional friction coefficient that we assume to be constant i e independent of the flow or bed properties and u q h m s is the mean flow velocity the sediment transport rate of size fraction k per unit width is assumed to be the product of a nondimensional sediment transport rate q b k and the bed surface fraction content the latter we assume equal to the active layer volume fraction content the einstein 1950 parameter g r d k 3 scales the nondimensional quantity such that 29 q b k f a k g r d k 3 1 p q b k where r ρ s ρ w 1 is the submerged specific gravity ρ s 2650 kg m3 the sediment density and ρ w 1000 kg m3 the water density the sediment transport rate q bk includes the volume of pores the nondimensional sediment transport rate is assumed to be a function of the nondimensional bed shear stress θk shields 1936 30 θ k c fb u 2 g r d k where c fb is the skin friction coefficient the nondimensional sediment transport rate is computed using a sediment transport relation such as the one proposed by ashida and michiue 1971 31 q b k 17 θ k ξ k θ c θ k ξ k θ c the parameter ξk is the hiding function 32 ξ k 0 843 d k d m 1 for d k d m 0 4 log 10 19 log 10 19 d k d m 2 for d k d m 0 4 where d m is a characteristic mean grain size of the sediment mixture ashida and michiue 1971 propose θ c 0 05 under degradational conditions we assume that the volume fraction content of sediment at the interface between the active layer and the substrate is equal to the sediment in the top part of the substrate under aggradational conditions the sediment in the active layer is assumed to be transferred to the substrate hirano 1971 33 f k i f s k z η l a if η l a t 0 f a k if η l a t 0 other formulations include those of hoey and ferguson 1994 a 5 matrix formulation in this section we present the matrix vector form eq 1 of the active layer model in combination with the unsteady flow equations stecca et al 2014 and assuming steady flow chavarrías et al 2018 as well as the simplified morphodynamic model the vector of dependent variables q u system matrix a u and vector of source terms s u of the fully unsteady system is stecca et al 2014 34 q u h q η m a k n 1 35 36 s u 0 g h s f 0 0 n 1 the preconditioning matrix is in this case 37 assuming steady flow the vector of dependent variables q s system matrix a s and vector of source term s s are equal to chavarrías et al 2018 38 q s η m a k n 1 39 40 s s s f 1 fr 2 q b h s f 1 fr 2 q b k h f k i q b h n 1 the preconditioning matrix assuming steady flow is 41 m s β 1 0 α 1 0 α n 1 the nondimensional approximated bed and sorting celerities are chavarrías et al 2018 de vries 1965 42 λ b ψ 1 fr 2 43 λ s 1 χ 1 μ 1 1 where the parameters are chavarrías et al 2018 stecca et al 2014 44 ψ q b q 45 γ k c k f k i 46 c k 1 ψ q b k q 47 χ l 1 u q b m a l 48 μ l k d l k f k i 49 d l k 1 u χ l q b k m a l in the simplified morphodynamic model section a 3 the vector of dependent variables q m system matrix a m and vector of source term s m are 50 q m η d ma 51 a m u 1 1 fr 2 q b h q b d ma 1 l a 1 1 fr 2 d m i q b h k 1 n d k q b k h 1 l a d m i q b d ma k 1 n d k q b k d ma 52 s m s f 1 fr 2 q b h 1 l a d m i q b h k 1 n d k q b k h the preconditioning matrix is 53 m m β 1 0 0 α the parameters are 54 λ m χ m μ m 55 γ m c m f m i 56 c m 1 ψ l a k 1 n d k q b k q 57 f m i d m i l a 58 χ m 1 u q b d ma 59 μ m d m f m i 60 d m 1 u χ m l a k 1 n d k q b k d ma appendix b mass conservation of the modified system mass conservation of the modified system of equations section 3 1 is guaranteed if the sum of the n modified active layer equations is equal to the modified exner 1920 equation as we already substituted the exner 1920 equation in the active layer equation the addition of the n modified active layer equations must yield an identity 61 k 1 n β α k m a k t k 1 n f k i β η l a t k 1 n q b k x 0 β l a t k 1 n α k f a k 1 β l a k 1 n α k f a k t 0 to allow for morphodynamic changes the parameter β must be different than 0 this yields a multiplicity of cumbersome closure relations for αk relating the temporal change of the active layer thickness to those of the volume fraction contents at the bed surface we choose to simplify the problem assuming that α k α k so that we obtain 62 β l a t α 1 0 given that α 1 to recover the well posedness of the system of equation the active layer thickness must be constant to conserve mass in the modified system of equations appendix c parameters of the numerical simulation of the thought experiment in this section we provide the details of our numerical simulation of the thought experiment conducted by ribberink 1987 the thought experiment is based on the laboratory experiment e8 e9 conducted by ribberink 1987 the only difference is that in the thought experiment the substrate is finer than in the laboratory experiment the domain is 30 m long and it is discretized into 0 01 m long cells the simulation time is 120 h the total and skin friction coefficient are equal to 0 0117 the sediment mixture is composed of two sediment sizes equal to 0 78 mm and 1 29 mm the flow discharge per unit width is constant and equal to 0 0803 m2 s the downstream water level is constant and such that initially the bed is in equilibrium the upstream sediment load is initially equal to 5 64 10 6 m2 s and it is composed of 50 of the fine fraction during the first 30 h the fraction of fine sediment linearly decreases to 0 the total amount of sediment decreases to 95 of the initial value the active layer thickness is equal to 0 02 m the initial volume fraction content of fine sediment in the substrate is 0 6 it is not fully clear to the authors which sediment transport relation and which parameters ribberink 1987 used in the simulation of the thought experiment using the two layer model we have inferred that he used the relation developed by meyer peter and müller 1948 with the hiding function by egiazaroff 1965 with the calibrated parameters a 15 85 b 1 5 and θ c 0 0307 the mean grain size is computed arithmetically we calibrate the ripple factor a constant multiplying the shields 1936 stress such that the bed slope and volume fraction content of fine sediment are as close as possible to the reported values we obtain that for a ripple factor equal to 0 3169 the bed slope is 1 65 10 3 the same as ribberink 1987 reported and the volume fraction content of fine sediment in the active layer is equal to 0 409 ribberink 1987 reported a value equal to 0 43 supplementary material supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2019 04 001 appendix d supplementary materials supplementary data s1 supplementary raw research data this is open data under the cc by license http creativecommons org licenses by 4 0 supplementary data s1 
681,digital rock physics drp is an eminent technology that facilitates and repeatable core analysis and multi physics simulation of rock properties one of the challenges in this field is the scalability of the problem size whereby large micro ct images over the order of 10003 voxels incur a high computational demand on performance we estimate the of permeability in large digital samples of rocks imaged by micro ct by using a fast and efficient dual grid domain decomposition technique based on the schwarz alternating method slow low memory with algebraic multigrid amg solvers fast high memory to solve on an otherwise unfeasible shared memory machine the comparisons and differences to other methods commonly used have been added in the introduction the method applies a scalable parallel simulation algorithm to solve pressure and velocity fields using the semi analytical pore scale finite volume solver pfvs within real 3d pore scale micro ct images the domain is split into non overlapping coarse partitions and also split into a set of dual coarse partitions of varying width the governing equations are then solved iteratively between the partition sets by updating the pressure and flux at the relevant boundaries before each step the method is validated and shown to converge to flux continuous conditions requisite of the governing equations permeability estimation is within 5 10 of the fine scale solution and significantly reduces memory limitations and computational time for solving problems in micro ct images allowing ordinary workstations to solve images over 10003 within the magnitude of 1 100 h of cpu time the permeability of a 2520 2520 7250 sample was calculated with a workstation to within 9 error of lbm calculated with a supercomputer within a similar timeframe keywords pore scale domain decomposition permeability x ray imaging flow simulation 1 introduction x ray micro computed tomography micro ct is a non invasive advanced imaging technique that provides three dimensional image of the internal structure of rocks hazlett 1995 lindquist et al 1996 iassonov et al 2009 blunt et al 2013 micro ct images are widely used in the analysis and modelling of hydraulic and mechanical properties in porous media iassonov et al 2009 liu and mostaghimi 2017 such as the estimation of permeability formation factor pore size distribution etc mostaghimi et al 2013 torskaya et al 2014 we can now obtain images from x ray micro ct scans with resolutions in the order of a few microns which is sufficient to obtain reasonable characteristics of the pore space of conventional rocks flannery et al 1987 mees et al 2003 coenen et al 2004 blunt et al 2013 in order to obtain fine detail and a more representative image of a rock sample a high resolution micro ct image of a rock sample is required leading to an increase in the number of voxels in the micro ct image hence micro ct images nowadays can be as large as 1000 to 2000 voxels in diameter and over 4000 voxels in length at a resolution of 3 µm soulaine et al 2016 large scale simulation can target core size domains and is also a major missing aspect of flow simulation within tightly packed and heterogeneous rocks such as diagenetic carbonate coal and shales direct numerical simulation at the same scale and the same boundary conditions allows for a direct comparison of experiment and simulation for heterogeneous reservoir cores giving a basis for understanding local mechanisms controlling reservoir performance and improved upscaling mechanisms flow simulation in porous media is of growing interest in a wide range of fields including petroleum engineering environmental studies and hydrology studies fenwick and blunt 1998 hilpert and miller 2001 blunt et al 2002 culligan et al 2006 mostaghimi and mahani 2010 mostaghimi et al 2016 blunt 2017 there are a number of numerical simulations techniques that are commonly used to solve for flow to obtain the pressure and velocity field or macroscopic properties such as permeability from micro ct images in many cases conducting flow simulation to obtain macroscopic properties can compare favourably to results obtained from experiments however the size of the image and associated computational costs can be obstacles sun et al 2012 most simulations such as lattice boltzmann methods lbm computational fluid dynamics cfd and semi analytical solvers sas are able to solve for flow within reasonable timeframes on images with less than 10003 voxels using a workstation pc run time for conducting such a simulation on a sandpack image with a size of 788 791 793 using methods mentioned earlier varied from 60 min to more than 9000 min with utilisation of parallel computing torskaya et al 2014 soulaine et al 2016 saxena et al 2017 therefore simulations are usually conducted on a subset large enough to cover the representative elementary volume of the image torskaya et al 2014 attempted to conduct flow simulation on a 10003 image using a semi analytical solver however due to memory limitations in their permeability simulation they were required to subdivide the sample into eight 5003 subsamples similar to soulaine et al 2016 they conducted the semi implicit method for solving the pressure linked equation algorithm simple patankar 1980 on openfoam jasak et al 2007 on several 3003 to 3503 sub volumes from a very large berea sandstone image of 4667 2130 2099 voxels mostaghimi et al 2013 simulated dispersion and flow on a 6003 voxels image using a workstation with 96 gb of ram it is primarily through the utilisation of massive parallel computer arrays that allows larger simulations to be conducted representing a cost and logistics barrier still not ideal for obtaining the flow field on images of 10003 voxels from traditional flow simulations hence it is prudent to develop other more computationally efficient methods that can solve for flow in a larger size to obtain the macroscopic properties comparable to experimental results multiscale methods are widely used in order to accelerate flow simulations these methods are based on constructing a set of prolongation operators that map between unknown parameters that are associated with cells in a finer scale grid it can be considered as an alternative approach to upscaling hajibeygi et al 2008 tomin and lunati 2013 lie et al 2016 khayrat and jenny 2017 mehmani and tchelepi 2018 the fine scale solutions obtained will iteratively approach true solutions and are iterated up to an arbitrary accuracy multiscale finite volumes msfv method tends to produce solutions with large unphysical pressure oscillations and highly circular velocity fields for cases with high aspect ratios or channelized media with strong permeability contrasts lunati and jenny 2007 kippe et al 2008 moreover at low iteration numbers there are also errors near the interfaces between the coarse grids due to inaccurate boundary conditions that do not necessarily represent the fine scale system but are useful for preconditioning and initialising a subsequent routine that converges to the true solution lie et al 2016 domain decomposition is a method for partitioning data across processors and memory caches widely used in cfd gropp and keyes 1992 chan and mathew 1994 domain decomposition in cfd fundamentally consists of solving the governing differential equations on subdomains while enforcing continuity between each of them until the local solution converges chan and mathew 1994 this allows parallelisation to be applied in order to solve each subdomain simultaneously or alternatively the complexity of solvers can also be reduced on sequential computing using domain decomposition domain decomposition is traditionally used for navier stokes solvers and lattice boltzmann simulations as each of the subdomains can be distributed into each processor allowing parallelization to solve the problem significantly faster than a single processor computer marshall et al 1997 wang et al 2005 zhang et al 2008 hence domain composition is a reasonable option for conducting efficient and cheap simulation on large domains while preserving fine scale details domain decomposition methods also exist for coupling a pore scale model to an adjacent continuum model developed by balhoff et al 2007 however due to the difference in the pore structure of the models the boundary conditions were different for two similar realizations with identical macroscopic properties such as grain diameter porosity and permeability since the pore structure is different moreover the boundary conditions used in this method were over simplified constant pressure linear pressure profile leading to incorrect results qualitatively and quantitatively balhoff et al 2007 lastly this method is computationally inefficient as it solves a large number of simultaneous equations equal to the number of pores at the boundary balhoff et al 2008 further developed domain decomposition methods by applying mortar coupling to overcome the over simplified boundary conditions mentioned prior the mortar space is a 2d finite element space that projects the pressure field onto subdomain boundaries this pressure field is determined in such a way that the fluxes of all subdomains are continuous sun et al 2012 applied mortar coupling to simulate flow on a very large and heterogeneous pore network model that consists of 684 301 connected pores divided into 100 sub volumes the upscaled permeability using mortar coupling with domain decomposition yielded good results over estimated by only 3 19 in the x direction and 0 95 in the y direction compared to results from a fine scale solution of a large network model the results also show that flow rates for all throats on the interface between two sub volumes matched well by the pressure convergence criteria between the sub volumes resulting in an increasingly conservative flux field domain decomposition performed directly on the geometry of a domain as opposed to decomposing the mathematical formulation has also been shown to considerably diminish computational memory requirements rabbani et al 2019 which is a benefit that is not always available in algebraic decomposition methods such as multiscale or multigrid methods we propose an extension of the semi analytical solver method of solving absolute permeability in micro ct images by applying a domain decomposition method that matches pressure between sub volumes by an iterative dual grid method based on the schwarz alternating method schwarz 1869 the micro ct image is partitioned into a set of coarse grid blocks with the underlying fine scale geometry embedded within these blocks a dual grid of the coarse grid is also partitioned such that the boundaries of the dual grid blocks lie within the body of the coarse grid blocks and vice versa this naturally results in an algorithm whereby the fine scale pressures solved within the coarse blocks can be extracted and used as boundary conditions for the dual grid blocks and vice versa this is demonstrated to trend towards flux continuity and is applied to granular rocks using a pore scale finite volume solver for fast computation of digital permeability computation time is comparable to pfvs a semi analytical solver which is 80 faster than stokes solvers chung et al 2019 and is within 5 10 accuracy computation of permeability in a very large image of 2520 2520 7250 voxels shows that the algorithm permits the estimation of permeability within the timescale of days on a typical workstation this is due to the domain decomposition technique being more efficient with computer resources than direct pfvs or lbm allowing flow to be solved in relatively low powered single dual socket cpu workstation and consumer pc devices 2 method 2 1 governing equations an elliptic diffusion equation is used to obtain the spatial pressure distribution in micro ct images hence estimate absolute permeability of micro ct images this method is cpu time efficient as it does not require time stepping to converge to a solution in general calculation of absolute permeability is usually inferred from steady state velocity fields meaning that explicit solution of the transient dynamics is unnecessary and should be avoided if possible the pfvs method is applied to illustrate the efficacy of the decomposition method the conservation of mass can be expressed as 1 v q where v is the velocity vector and q represents source and sink terms which is assumed to be zero we assign each voxel a local conductivity w calculated as outlined by chung et al 2019 to relate the velocity to the pressure gradient 2 v w p where p is pressure combining eq 2 with eq 1 gives an elliptic equation 3 w p 0 this equation is solved with prescribed constant pressure dirichlet boundary conditions on the inlet and outlet by using two point flux approximation tpfa aarnes et al 2007 lie et al 2012 and finite volume methods with an algebraic multi grid amg solver all solid voxels are removed from the system of equations resulting in a smaller system matrix once the spatial pressure distribution and velocity profile and subsequently the flow rate are calculated by eq 2 absolute permeability is estimated from 4 k n x n y n z r q μ δ p the length of the system is expressed as the voxels multiplied by the resolution of the image r hence the number of voxels in the main flow direction can be defined as nx and the other two directions are ny and nz q is flow rate m3 s μ is fluid viscosity pa s δp is pressure difference across the image pa imposed as boundary conditions under the assumptions of laminar incompressible flow and no slip boundary condition local conductivity w is defined as a weighting function representing the conductivity of a voxel for fluid flow it is a function of two variables the largest inscribed radius of the flow channel rmax and the distance from the solid wall r 5 w α r 2 ρ 8 μ 2 d max d d 2 i n p o r e v o x e l s where w is local conductivity α is the shape factor r is resolution of image m dmax is digital equivalent of the largest inscribed radius d is digital equivalent of radial distance from the inner wall ρ is fluid density kg m3 μ is fluid viscosity pa s 2 2 domain decomposition the decomposition method relies on the fact that there exists a unique pressure distribution in a system with heterogeneous conductivity such that the flow rate is conserved throughout the sample for a given domain ω of pore space voxels that is to be decomposed into n subdomains ω i the decomposition is performed such that 6 i 1 n ω i ω the grid of subdomains act as blocks on a coarse grid whereby each coarse grid block contains fine grid pore space voxel data in this implementation of domain decomposition the problem is designed to focus on the computation of absolute permeability in the pore space of rocks the boundary conditions imposed over the entire domain ω are imposed on the inlet γ in and outlet γ out surfaces of ω such that γ in ω and γ out ω and γ in γ out a constant uniform pressure distribution p is assigned to the inlet and outlet as p γ i n 1 and p γ o u t 0 the interface between connected subdomains denoted as γ ij contains the pressure distribution at the boundary of adjacent coarse grids p γ i j which is a unique array of constant pressure boundary conditions applied to the face of the nk fine scale voxels denoted with index k and boundary γ i j k whereby k 1 n k γ i j k γ i j and k 1 n k p γ i j k p γ i j a pressure matching method is applied that estimates the fine scale voxel values p γ i j k on the boundary faces γ ij of the coarse grid cells each interface region γ ij contains subsets that correspond to voxel faces that belong to either left or right coarse grid block denoted as γ i j l and γ i j r such that γ i j l γ i j r γ i j γ i j l ω i and γ i j r ω j a dual coarse grid is also extracted out of the image defined such that each dual coarse grid block dω ij is centred at the shared faces of the coarse grid blocks with a given thickness h conceptually illustrated in fig 1 with an explicit visualisation in fig 2 in a 1d decomposition example each dual grid block has shared faces with the full domain in the left and right coarse faces denoted d γ i j l and d γ i j r respectively each of these coarse faces contains the voxel sized fine grid faces of which there exists subsets corresponding to voxel faces that belong to either the left or right side of the interface for example on a grid partitioned into 5 coarse blocks ω1 to ω5 there exists dual grid blocks dω12 dω23 and so on the interface between coarse blocks 1 and 2 contains shared faces γ 12 l and γ 12 r representing the voxel faces that exist as part of the boundary of coarse grid block 1 and 2 respectively the first dual coarse grid block dω12 with a thickness of h will overlap the boundary between ω1 and ω2 the boundaries of interest in this dual block exist within the body of ω1 and ω2 denoted as d γ 12 1 and d γ 12 2 each of these boundaries contains subsets that belong to the left and right sides denoted as d γ 12 1 l and d γ 12 1 r each coarse grid block is vectorised into a finite volume grid to allow the removal of solid voxels in order to reduce computational time and memory this is also done on the dual coarse grid the iterative routine to determine the mass conservative pressure distribution begins by initialising a pressure field in this case a linear pressure gradient across the fine scale voxel domain and extracting the associated constant pressure boundary face distribution of each coarse grid cell each coarse block is then solved for the internal pressure field using the aforementioned fine scale voxel face pressures as dirichlet boundary conditions the pressure solution is flux continuous within each coarse grid but is not flux continuous at the face boundaries of the coarse grid this is corrected for by the dual coarse grid which extracts the face pressure distribution of the coarse grid at the dual grid boundary face locations which is then used to solve for pressure in the dual grids and used to update the internal pressure field for example a domain split into 5 parts in 1 dimension with a uniform initialisation will begin by imposing boundary conditions of p inlet 1 and p 12 0 8 and so on up to p outlet 0 these individual subdomains are solved to obtain the local pressure distribution within the coarse blocks grid block ω1 contains the shared face locations with dual grid d γ 12 1 and the new pressure distributions are used as the boundary condition when solving the pressure within dω12 and so on the iteration is continued until the residual calculated is less than a threshold value that is calculated as the maximum discrepancy in material flow between adjacent fine scale voxels in the direction of flow 7 max q i q i 1 q i c where qi is the flow rate in each slice i perpendicular to the direction of flow calculated by q i r 2 ω i v d ω i where i indexes cross section slices perpendicular to the flow direction and c is a threshold value in this study results are presented with a threshold of max q i q i 1 q i 0 1 fig 3 illustrates the algorithmic flow of the iteration between coarse grid and dual coarse grid to obtain a flux continuous fine scale pressure field and permeability estimation the number or partitions and the dual grid block thickness are controllable parameters that will be tested in this paper 3 materials a range of micro ct images are used in this paper bentheimer sandstone 5003 imaged at resolutions of 5 3 µm at the australian national university liu et al 2017 berea sandstone 4003 sandpack 1503 ketton carbonate 9003 imaged at resolution of 5 3 µm 10 µm and 3 8 µm respectively at imperial college london blunt et al 2013 menke et al 2015 these smaller samples shown in fig 4 and are used to test carbonate and sandstone morphologies to directly compare simulation speed and accuracy with published performance results using geodict fraunhofer 2011 and pfvs chung et al 2019 a bentheimer image measuring 2520 2520 7250 shown in fig 5 is also used to test computational efficiency at larger image sizes the core sample measuring 1 7 cm in diameter and 5 cm in length was imaged at the university of new south wales at a 6 9 µm resolution and segmented using converging active contours schlüter et al 2014 4 validation the flux of any given heterogeneous sample when split apart and solved should converge to a state whereby the volumetric flow rate along the cross section of the pressure potential from the inlet and outlets is constant this can be examined by comparing the obtained pressure and flux fields of a rock sample when solving for flow in a fine scale solution across the entire domain and when using the domain decomposition algorithm for the sake of visual clarity a 603 subsample of the sandpack micro ct image is used in this test a comparison is made between results obtained using the pfvs method on the entire domain and when applying the domain decomposition method by splitting the image into 4 partitions as shown in fig 6 the coarse domain is split at z 15 30 and 45 while the dual domain is split at z 8 rounded from 7 5 23 38 and 53 this allows the boundaries of each subdomain grid to lie within the body of their corresponding dual grid and vice versa fig 7 depicts the fine scale solution result obtained from pfvs and the normalised difference between the flux distribution at iterations 1 5 20 and 100 this is calculated as f l u x d e c o m p f l u x p f v s f l u x p f v s and shows a visual trend towards flux continuity which is supported by the streamlines presented in fig 8 the respective flow rate cross sections are shown in fig 9 indicating a convergence towards steady state incompressible flow conditions the normalised velocity probability density functions pdfs of the normalized velocity distribution v 1 v v v d v are shown in fig 10 and indicate that the average velocity within the samples are higher at lower iterations which would result in an overestimation of the permeability the pdfs converge at higher iterations towards the result obtained from the fine scale solution solver this is consistent with the expected convergence from the underlying alternating schwarz method schwarz 1869 with diffusive reduction in low frequency error eventually solving the elliptical diffusion equation as accurately as a fine scale solution the permeability of the sample can then be calculated with eq 4 using the average flow rate in the domain shown in fig 11 the results here indicate that the algorithm will converge to the fine scale solution showing a monotonically decreasing asymptote towards the fine scale solution 5 results and discussion 5 1 permeability estimation the estimated permeability from applying domain decomposition is compared to results obtained by a fine scale solution pfvs algorithm each sample was split into 5 partitions with non overlapping continuous dual partitions analogous to fig 6 the algorithm was run until the estimated permeability reached the convergence criteria of max q i q i 1 q i 0 1 this is chosen as the algorithm outputs diminishing returns as the permeability converges to the fine scale solution result at an ever slowing rate seen in fig 11 thus the computational efficiency can be tuned for accuracy or speed the performance results in fig 12 using the images as outlined in table 1 show that the method results in permeability estimates that are within 10 of pfvs using the aforementioned decomposition settings and convergence criteria the algorithm will tend to equal to pfvs over more iterations as shown in fig 11 which itself is in good agreement with other methods chung et al 2019 the results will always tend to overestimate the permeability compared to pfvs but with an adequate number of iterations will equal the pfvs result this can be addressed by calculating the permeability with a flow rate somewhere between the average flow rate q and the minimum flow rate qmin this is discussed further in a later section 5 2 computational efficiency when solving the elliptic equation within a micro ct image memory constraints are apparent using tpfa with a multigrid solver results in o n cpu efficiency hence the relatively faster pfvs method but presents challenges at high voxel counts due to the scalability of the memory required in a cubic 3d image of n voxels in each direction the discretised system of equations generates a tridiagonal square matrix of size n 3 by n 3 in sparse format this problem thus scales approximately between 3 2 n 3 and n 6 depending on whether the matrix requires decompression during solving this scalability issue is particularly important when attempting to solve for pressure in micro ct images since such images tend to be in the order of n 2000 which remains computationally challenging for modern workstations due to both memory and cpu speed limitations it can thus be said that the time to solution is not the bottleneck to obtaining estimates for the permeability since amg scales linearly in cpu speed but is instead the memory the domain decomposition algorithm was performed on a pc with a 3 20 ghz 16 core cpu and 256 gb of ddr4 ram table 2 shows the computational efficiency achieved for the samples used for permeability estimation in table 1 with the same convergence criteria of max q i q i 1 q i 0 1 the overall efficiency scales favourably by a power law relationship as shown in fig 13 specifically a comparison of the cpu time required to solve the permeability of a 4003 berea sandstone image indicated that the domain decomposition algorithm was 2 times faster than pfvs and 15 times faster than geodict fraunhofer 2011 the memory efficiency of the algorithm is also examined with the given samples results indicate that the memory usage of the algorithm is consistent with the partitioning as expected active memory usage is approximately 5 times lower in these cases of images partitioned into 5 subdomains compared to the memory required to solve the entire domain this is because only one subdomain is worked on at any given time when running the program in serial mode it can be seen that a typical consumer grade workstation with between 32gb to 64gb of ram is able to easily handle samples up to 9003 while smaller portable devices with between 8gb to 32gb of ram are able to handle such problems simply by increasing the number of partitions furthermore images exceeding 10003 are expected based on the memory performance shown to also be accessible by workstations with at least 256gb of ram when solving in serial mode it can be expected that application of domain decomposition to other algorithms that may be more memory efficient will also give proportionally more efficient domain decomposition performance table 3 5 3 effect of partitioning and dual grid thickness the main variables to the algorithm performance that can be controlled are the number of partitions and the thickness of the dual grids illustrated in fig 14 these are investigated on the 5003 sandstone image the sample was solved for 50 iterations with a varying number of partitions the sample was also split into 10 partitions with varying dual grid thicknesses to investigate the discussed effect on performance as shown in fig 15 there is a clear reduction in the permeability convergence rate for samples with higher subdivisions especially notable above 10 partitions due to the increase in the total number of unknowns to iterate for consistent with schwarz like convergence there is a trade off between the number of partitions and the computational resources available for an efficient solution fewer partitions results in more time per iteration seen as the 2 partition case took twice as long to reach 50 iterations compared to the 20 partition case memory usage also increases with fewer partitions thus a laptop computer with low specifications for example should run the algorithm with more partitions over a longer period of time while a powerful workstation may only require 2 5 partitions the flexibility of the algorithm to accommodate very large images in systems that are unable to handle the data required to solve for flow in the domain is the primary strength of this method similarly the thickness of the dual grid is a significant factor in the convergence performance as the dual grids dictate how accurate the boundary pressures are calculated for each iteration by increasing the dual grid thickness a larger slice of the pressure field is recomputed which results in a faster convergence rate in the case of an image with 500 voxels in the axis of partitioning split into 10 parts the non overlapping cell width is 50 cells however when the dual grids begin to overlap each other it can be seen in fig 16 that the permeability calculation begins a dampened oscillation due to overestimations of the pressure field in each iteration this oscillatory behaviour remains convergent and so remains an applicable and viable method of improving algorithmic performance overall it can be seen that applying increasing partitioning will tend to increase time taken to convergence while proportionately decreasing the active memory usage this is an expected outcome of domain decomposition as a whole and especially true for schwarz based implementations the optimal target for partitioning is thus suggested to be the upper limit of available memory in any given system 5 4 effect of flux distribution on permeability uncertainty as seen in fig 9 the flux distribution of a partitioned sample will approach a constant value satisfying flux conservation rules it is also noteworthy that the partition with the minimum initial flux value tends to closely represent the final flux result this is likely due to the critical radius of the entire domain existing within the partition with lower values of calculated flux thus acting as chokes within the domain this observation allows for a more accurate initial estimation of the permeability of the entire domain in this application of domain decomposition this can be empirically done by using the minimum partition flux q i m i n in eq 4 as opposed to the mean flux q this consideration of the critical radius also allows for imposition of upper and lower bounds for estimated permeability in the domain decomposition method applying these bounds to the bentheimer sandstone and ketton carbonate samples split into 5 partitions produces the permeability vs iteration chart as shown in fig 17 and indicates that the lower bound estimate of permeability provides a measure of the uncertainty range in the estimation process furthermore an intermediate estimate of the system permeability can be obtained by computing the midpoint flux qmid within the system which can be evaluated by eq 8 on the normalised flow rate vs z axis chart the permeability result shows faster convergence to the flux conserved value compared to running the routine to its true convergence 8 0 n x max q z q m i d q m i d d z 0 n z min q m i d q z q min d z 5 5 effect of partitioning in 3 dimensions the algorithm thus far has assumed a bread slices type of domain partitioning partitioning the domain such that each coarse slice is perpendicular to the direction of flow this is to investigate the effect of grid fineness related to the full size and the area shared by subdomains fig 18 applying 3d sugar cube 2 2 2 partitioning and comparing to a bread slices 1 1 8 partitioning to the bentheimer sandstone and ketton carbonate samples split into 8 partitions produces the normalised permeability vs iteration chart as shown in fig 19 results indicate that a sugar cube decomposition offers a marginal improvement in convergence rate for the bentheimer sandstone while performance was not changed for the ketton carbonate improved subdomain bandwidth and reduced inter partition communication between iterations are the primary factors that allow this speedup in general it can be expected that for the purpose of estimating the permeability of a segmented micro ct image a 3d sugar cube decomposition that tracks the value of qmid would converge to a solution faster than the tested methodology used in section 5 1 permeability estimation the bentheimer sandstone sample used in this case shows faster convergence to the true value under 3d decomposition compared to the serial decomposition case another point to consider is that in cases where the number of partitions is less than 8 a bread slices or match sticks partitioning in 2 dimensions resulting in long thin matchstick like subdomains approach would become the only methods available 5 6 solving permeability of large images the primary purpose of proposing this domain decomposition based method for solving the elliptic equation for modelling flow is to estimate the permeability of samples that would otherwise be too large for a computer to ordinarily handle a test was run on a 2520 2520 7250 image of a bentheimer sandstone this is the largest image we have access to it is cored from a high permeability region of a large block of bentheimer outcrop due to the size of the entire domain the system memory was insufficient to solve in parallel for reference a double precision property map of a 20003 image would consume 64gb of system memory the sparse matrix of 20006 would consume at least another order of magnitude more and the matrix inversion algorithm would require some degree of memory decompression during its execution during the manipulation and characterisation of the micro ct image multiple property maps of the conductivity face to cell maps etc are required thus the algorithm was run in serial with each subdomain grid called upon sequentially by the algorithm when required the domain was partitioned into 145 subdomains of 2520 2520 50 with the maximum non overlapping dual grid width the domain decomposition algorithm managed to solve the large problem in 20 days resulting in an estimated permeability of 5 7 d using a pc with 3 20 ghz 16 core cpu 256gb of ddr4 ram the resulting normalised velocity field is visualised in fig 20 the sample was also run using lbm with a result of 6 2 d mcclure et al 2014 this is based on 100 000 timesteps to achieve steady state on 1932 gpus on the titan supercomputer totalling 11 6 tb of gddr5 memory the process grid for the simulation was 2 2 483 with 1260 1260 15 sub domains allocated to each gpu the results obtained from the domain decomposition algorithm are within 9 of the result obtained by lbm 6 conclusions we have obtained the absolute permeability of large micro ct images by applying a schwarz based domain decomposition to the pfvs semi analytical method by an iterative pressure matching method that converges to flux continuous conditions this allows solution using computers that would otherwise be unable to handle the size of the domain under ordinary circumstances the domain is subdivided into a coarse grid set and a dual grid subdomain that overlaps the boundaries of the coarse grids by this technique the algorithm is able to solve for the pressure and flux of the entire domain with a scalable and parallelisable iteration between the grids by extending the pfvs method we conducted simulation with various micro ct images of porous reservoir rocks the overall methodology has been validated and shown to converge to a flux continuous system by iteratively solving between each partition set by updating the pressure and flux at the relevant boundaries before each step permeability estimation was within 5 10 of the fine scale pfvs solution within a comparable computational timeframe of 5 to 8 iterations in the cases of very large images or with restrictions on available computing power the algorithm significantly reduces memory limitations and computational time for solving flow in micro ct images using a single 16 core cpu with 256 gb of ddr3 ram the permeability of a 2520 2520 7250 sample was calculated to within 9 error of lbm this is while the lbm simulation required 1932 nvidia tesla k20x gpus totalling 11 6 tb of gddr5 ram within a similar timeframe this permits ordinary workstations and portable pcs to solve images over 10003 within the magnitude of 1 100 h of cpu time acknowledgements we would like to acknowledge tyree x ray facility for providing images that were analysed images used in the draft can be made available upon request an award of computer time was provided by the department of energy incite program this research also used resources of the oak ridge leadership computing facility which is a doe office of science user facility supported under contract de ac05 00or22725 aarnes et al 2007 j aarnes geometrical modeling numerical simulation and optimization industrial mathematics at sintef an introduction to the numerics of flow in porous media using matlab 2007 springer verlag balhoff et al 2008 m t balhoff mortar coupling and upscaling of pore scale models comput geosci 12 1 2008 15 27 balhoff et al 2007 m t balhoff coupling pore scale networks to continuum scale models of porous media comput geosci 33 3 2007 393 410 blunt 2017 m j blunt multiphase flow in permeable media a pore scale perspective 2017 cambridge university press blunt et al 2002 m j blunt detailed physics predictive capabilities and macroscopic consequences for pore network models of multiphase flow adv water resour 25 8 12 2002 1069 1089 blunt et al 2013 m j blunt pore scale imaging and modelling adv water resour 51 2013 197 216 chan and mathew 1994 t f chan t p mathew domain decomposition algorithms acta numerica 3 1994 61 143 chung et al 2018 t chung approximating permeability of micro ct images using elliptic flow equations spe j 2019 10 2118 191379 pa coenen et al 2004 j coenen measurement parameters and resolution aspects of micro x ray tomography for advanced core analysis proceedings of international symposium of the society of core analysts 2004 culligan et al 2006 k culligan pore scale characteristics of multiphase flow in porous media a comparison of air water and oil water experiments adv water resour 29 2 2006 227 238 fenwick and blunt 1998 d h fenwick m j blunt three dimensional modeling of three phase imbibition and drainage adv water resour 21 2 1998 121 143 flannery et al 1987 b p flannery three dimensional x ray microtomography science 237 4821 1987 1439 1444 fraunhofer 2011 i fraunhofer geodict homepage of the geodict software 16 2011 gropp and keyes 1992 w d gropp d e keyes domain decomposition methods in computational fluid dynamics int j numer methods fluids 14 2 1992 147 165 hajibeygi et al 2008 h hajibeygi iterative multiscale finite volume method j comput phys 227 19 2008 8604 8621 hazlett 1995 r hazlett simulation of capillary dominated displacements in microtomographic images of reservoir rocks multiphase flow in porous media 1995 springer 21 35 hilpert and miller 2001 m hilpert c t miller pore morphology based simulation of drainage in totally wetting porous media adv water resour 24 3 4 2001 243 255 iassonov et al 2009 p iassonov segmentation of x ray computed tomography images of porous materials a crucial step for characterization and quantitative analysis of pore structures water resour res 45 9 2009 jasak et al 2007 h jasak openfoam a c library for complex physics simulations international workshop on coupled methods in numerical dynamics 2007 iuc dubrovnik croatia khayrat and jenny 2017 k khayrat p jenny a multi scale network method for two phase flow in porous media j comput phys 342 2017 194 210 kippe et al 2008 v kippe a comparison of multiscale methods for elliptic problems in porous media flow comput geosci 12 3 2008 377 398 lie et al 2016 k a lie successful application of multiscale methods in a real reservoir simulator environment ecmor xv 15th european conference on the mathematics of oil recovery 2016 lie et al 2012 k a lie open source matlab implementation of consistent discretisations on complex grids comput geosci 16 2 2012 297 322 lindquist et al 1996 w b lindquist medial axis analysis of void structure in three dimensional tomographic images of porous media j geophys res 101 b4 1996 8297 8310 liu et al 2017 z liu pore scale characterization of two phase flow using integral geometry transport porous media 118 1 2017 99 117 liu and mostaghimi 2017 m liu p mostaghimi pore scale simulation of dissolution induced variations in rock mechanical properties int j heat mass transfer 111 2017 842 851 lunati and jenny 2007 i lunati p jenny treating highly anisotropic subsurface flow with the multiscale finite volume method multiscale model simul 6 1 2007 308 318 marshall et al 1997 j marshall a finite volume incompressible navier stokes model for studies of the ocean on parallel computers j geophys res 102 c3 1997 5753 5766 mcclure et al 2014 j e mcclure a novel heterogeneous algorithm to simulate multiphase flow in porous media on multicore cpu gpu systems comput phys commun 185 7 2014 1865 1874 mees et al 2003 f mees applications of x ray computed tomography in the geosciences 215 2003 geological society london 1 6 special publications mehmani and tchelepi 2018 y mehmani h a tchelepi multiscale computation of pore scale fluid dynamics single phase flow j comput phys 375 2018 1469 1487 menke et al 2015 h menke dynamic three dimensional pore scale imaging of reaction in a carbonate at reservoir conditions environ sci technol 49 7 2015 4407 4414 mostaghimi and mahani 2010 p mostaghimi h mahani a quantitative and qualitative comparison of coarse grid generation techniques for modeling fluid displacement in heterogeneous porous media spe reserv eval eng 13 01 2010 24 36 mostaghimi et al 2013 p mostaghimi computations of absolute permeability on micro ct images math geosci 45 1 2013 103 125 mostaghimi et al 2016 p mostaghimi numerical simulation of reactive transport on micro ct images math geosci 48 8 2016 963 983 patankar 1980 s patankar numerical heat transfer and fluid flow 1980 crc press rabbani et al 2019 a rabbani pore network extraction using geometrical domain decomposition adv water resour 123 2019 70 83 saxena et al 2017 n saxena 
681,digital rock physics drp is an eminent technology that facilitates and repeatable core analysis and multi physics simulation of rock properties one of the challenges in this field is the scalability of the problem size whereby large micro ct images over the order of 10003 voxels incur a high computational demand on performance we estimate the of permeability in large digital samples of rocks imaged by micro ct by using a fast and efficient dual grid domain decomposition technique based on the schwarz alternating method slow low memory with algebraic multigrid amg solvers fast high memory to solve on an otherwise unfeasible shared memory machine the comparisons and differences to other methods commonly used have been added in the introduction the method applies a scalable parallel simulation algorithm to solve pressure and velocity fields using the semi analytical pore scale finite volume solver pfvs within real 3d pore scale micro ct images the domain is split into non overlapping coarse partitions and also split into a set of dual coarse partitions of varying width the governing equations are then solved iteratively between the partition sets by updating the pressure and flux at the relevant boundaries before each step the method is validated and shown to converge to flux continuous conditions requisite of the governing equations permeability estimation is within 5 10 of the fine scale solution and significantly reduces memory limitations and computational time for solving problems in micro ct images allowing ordinary workstations to solve images over 10003 within the magnitude of 1 100 h of cpu time the permeability of a 2520 2520 7250 sample was calculated with a workstation to within 9 error of lbm calculated with a supercomputer within a similar timeframe keywords pore scale domain decomposition permeability x ray imaging flow simulation 1 introduction x ray micro computed tomography micro ct is a non invasive advanced imaging technique that provides three dimensional image of the internal structure of rocks hazlett 1995 lindquist et al 1996 iassonov et al 2009 blunt et al 2013 micro ct images are widely used in the analysis and modelling of hydraulic and mechanical properties in porous media iassonov et al 2009 liu and mostaghimi 2017 such as the estimation of permeability formation factor pore size distribution etc mostaghimi et al 2013 torskaya et al 2014 we can now obtain images from x ray micro ct scans with resolutions in the order of a few microns which is sufficient to obtain reasonable characteristics of the pore space of conventional rocks flannery et al 1987 mees et al 2003 coenen et al 2004 blunt et al 2013 in order to obtain fine detail and a more representative image of a rock sample a high resolution micro ct image of a rock sample is required leading to an increase in the number of voxels in the micro ct image hence micro ct images nowadays can be as large as 1000 to 2000 voxels in diameter and over 4000 voxels in length at a resolution of 3 µm soulaine et al 2016 large scale simulation can target core size domains and is also a major missing aspect of flow simulation within tightly packed and heterogeneous rocks such as diagenetic carbonate coal and shales direct numerical simulation at the same scale and the same boundary conditions allows for a direct comparison of experiment and simulation for heterogeneous reservoir cores giving a basis for understanding local mechanisms controlling reservoir performance and improved upscaling mechanisms flow simulation in porous media is of growing interest in a wide range of fields including petroleum engineering environmental studies and hydrology studies fenwick and blunt 1998 hilpert and miller 2001 blunt et al 2002 culligan et al 2006 mostaghimi and mahani 2010 mostaghimi et al 2016 blunt 2017 there are a number of numerical simulations techniques that are commonly used to solve for flow to obtain the pressure and velocity field or macroscopic properties such as permeability from micro ct images in many cases conducting flow simulation to obtain macroscopic properties can compare favourably to results obtained from experiments however the size of the image and associated computational costs can be obstacles sun et al 2012 most simulations such as lattice boltzmann methods lbm computational fluid dynamics cfd and semi analytical solvers sas are able to solve for flow within reasonable timeframes on images with less than 10003 voxels using a workstation pc run time for conducting such a simulation on a sandpack image with a size of 788 791 793 using methods mentioned earlier varied from 60 min to more than 9000 min with utilisation of parallel computing torskaya et al 2014 soulaine et al 2016 saxena et al 2017 therefore simulations are usually conducted on a subset large enough to cover the representative elementary volume of the image torskaya et al 2014 attempted to conduct flow simulation on a 10003 image using a semi analytical solver however due to memory limitations in their permeability simulation they were required to subdivide the sample into eight 5003 subsamples similar to soulaine et al 2016 they conducted the semi implicit method for solving the pressure linked equation algorithm simple patankar 1980 on openfoam jasak et al 2007 on several 3003 to 3503 sub volumes from a very large berea sandstone image of 4667 2130 2099 voxels mostaghimi et al 2013 simulated dispersion and flow on a 6003 voxels image using a workstation with 96 gb of ram it is primarily through the utilisation of massive parallel computer arrays that allows larger simulations to be conducted representing a cost and logistics barrier still not ideal for obtaining the flow field on images of 10003 voxels from traditional flow simulations hence it is prudent to develop other more computationally efficient methods that can solve for flow in a larger size to obtain the macroscopic properties comparable to experimental results multiscale methods are widely used in order to accelerate flow simulations these methods are based on constructing a set of prolongation operators that map between unknown parameters that are associated with cells in a finer scale grid it can be considered as an alternative approach to upscaling hajibeygi et al 2008 tomin and lunati 2013 lie et al 2016 khayrat and jenny 2017 mehmani and tchelepi 2018 the fine scale solutions obtained will iteratively approach true solutions and are iterated up to an arbitrary accuracy multiscale finite volumes msfv method tends to produce solutions with large unphysical pressure oscillations and highly circular velocity fields for cases with high aspect ratios or channelized media with strong permeability contrasts lunati and jenny 2007 kippe et al 2008 moreover at low iteration numbers there are also errors near the interfaces between the coarse grids due to inaccurate boundary conditions that do not necessarily represent the fine scale system but are useful for preconditioning and initialising a subsequent routine that converges to the true solution lie et al 2016 domain decomposition is a method for partitioning data across processors and memory caches widely used in cfd gropp and keyes 1992 chan and mathew 1994 domain decomposition in cfd fundamentally consists of solving the governing differential equations on subdomains while enforcing continuity between each of them until the local solution converges chan and mathew 1994 this allows parallelisation to be applied in order to solve each subdomain simultaneously or alternatively the complexity of solvers can also be reduced on sequential computing using domain decomposition domain decomposition is traditionally used for navier stokes solvers and lattice boltzmann simulations as each of the subdomains can be distributed into each processor allowing parallelization to solve the problem significantly faster than a single processor computer marshall et al 1997 wang et al 2005 zhang et al 2008 hence domain composition is a reasonable option for conducting efficient and cheap simulation on large domains while preserving fine scale details domain decomposition methods also exist for coupling a pore scale model to an adjacent continuum model developed by balhoff et al 2007 however due to the difference in the pore structure of the models the boundary conditions were different for two similar realizations with identical macroscopic properties such as grain diameter porosity and permeability since the pore structure is different moreover the boundary conditions used in this method were over simplified constant pressure linear pressure profile leading to incorrect results qualitatively and quantitatively balhoff et al 2007 lastly this method is computationally inefficient as it solves a large number of simultaneous equations equal to the number of pores at the boundary balhoff et al 2008 further developed domain decomposition methods by applying mortar coupling to overcome the over simplified boundary conditions mentioned prior the mortar space is a 2d finite element space that projects the pressure field onto subdomain boundaries this pressure field is determined in such a way that the fluxes of all subdomains are continuous sun et al 2012 applied mortar coupling to simulate flow on a very large and heterogeneous pore network model that consists of 684 301 connected pores divided into 100 sub volumes the upscaled permeability using mortar coupling with domain decomposition yielded good results over estimated by only 3 19 in the x direction and 0 95 in the y direction compared to results from a fine scale solution of a large network model the results also show that flow rates for all throats on the interface between two sub volumes matched well by the pressure convergence criteria between the sub volumes resulting in an increasingly conservative flux field domain decomposition performed directly on the geometry of a domain as opposed to decomposing the mathematical formulation has also been shown to considerably diminish computational memory requirements rabbani et al 2019 which is a benefit that is not always available in algebraic decomposition methods such as multiscale or multigrid methods we propose an extension of the semi analytical solver method of solving absolute permeability in micro ct images by applying a domain decomposition method that matches pressure between sub volumes by an iterative dual grid method based on the schwarz alternating method schwarz 1869 the micro ct image is partitioned into a set of coarse grid blocks with the underlying fine scale geometry embedded within these blocks a dual grid of the coarse grid is also partitioned such that the boundaries of the dual grid blocks lie within the body of the coarse grid blocks and vice versa this naturally results in an algorithm whereby the fine scale pressures solved within the coarse blocks can be extracted and used as boundary conditions for the dual grid blocks and vice versa this is demonstrated to trend towards flux continuity and is applied to granular rocks using a pore scale finite volume solver for fast computation of digital permeability computation time is comparable to pfvs a semi analytical solver which is 80 faster than stokes solvers chung et al 2019 and is within 5 10 accuracy computation of permeability in a very large image of 2520 2520 7250 voxels shows that the algorithm permits the estimation of permeability within the timescale of days on a typical workstation this is due to the domain decomposition technique being more efficient with computer resources than direct pfvs or lbm allowing flow to be solved in relatively low powered single dual socket cpu workstation and consumer pc devices 2 method 2 1 governing equations an elliptic diffusion equation is used to obtain the spatial pressure distribution in micro ct images hence estimate absolute permeability of micro ct images this method is cpu time efficient as it does not require time stepping to converge to a solution in general calculation of absolute permeability is usually inferred from steady state velocity fields meaning that explicit solution of the transient dynamics is unnecessary and should be avoided if possible the pfvs method is applied to illustrate the efficacy of the decomposition method the conservation of mass can be expressed as 1 v q where v is the velocity vector and q represents source and sink terms which is assumed to be zero we assign each voxel a local conductivity w calculated as outlined by chung et al 2019 to relate the velocity to the pressure gradient 2 v w p where p is pressure combining eq 2 with eq 1 gives an elliptic equation 3 w p 0 this equation is solved with prescribed constant pressure dirichlet boundary conditions on the inlet and outlet by using two point flux approximation tpfa aarnes et al 2007 lie et al 2012 and finite volume methods with an algebraic multi grid amg solver all solid voxels are removed from the system of equations resulting in a smaller system matrix once the spatial pressure distribution and velocity profile and subsequently the flow rate are calculated by eq 2 absolute permeability is estimated from 4 k n x n y n z r q μ δ p the length of the system is expressed as the voxels multiplied by the resolution of the image r hence the number of voxels in the main flow direction can be defined as nx and the other two directions are ny and nz q is flow rate m3 s μ is fluid viscosity pa s δp is pressure difference across the image pa imposed as boundary conditions under the assumptions of laminar incompressible flow and no slip boundary condition local conductivity w is defined as a weighting function representing the conductivity of a voxel for fluid flow it is a function of two variables the largest inscribed radius of the flow channel rmax and the distance from the solid wall r 5 w α r 2 ρ 8 μ 2 d max d d 2 i n p o r e v o x e l s where w is local conductivity α is the shape factor r is resolution of image m dmax is digital equivalent of the largest inscribed radius d is digital equivalent of radial distance from the inner wall ρ is fluid density kg m3 μ is fluid viscosity pa s 2 2 domain decomposition the decomposition method relies on the fact that there exists a unique pressure distribution in a system with heterogeneous conductivity such that the flow rate is conserved throughout the sample for a given domain ω of pore space voxels that is to be decomposed into n subdomains ω i the decomposition is performed such that 6 i 1 n ω i ω the grid of subdomains act as blocks on a coarse grid whereby each coarse grid block contains fine grid pore space voxel data in this implementation of domain decomposition the problem is designed to focus on the computation of absolute permeability in the pore space of rocks the boundary conditions imposed over the entire domain ω are imposed on the inlet γ in and outlet γ out surfaces of ω such that γ in ω and γ out ω and γ in γ out a constant uniform pressure distribution p is assigned to the inlet and outlet as p γ i n 1 and p γ o u t 0 the interface between connected subdomains denoted as γ ij contains the pressure distribution at the boundary of adjacent coarse grids p γ i j which is a unique array of constant pressure boundary conditions applied to the face of the nk fine scale voxels denoted with index k and boundary γ i j k whereby k 1 n k γ i j k γ i j and k 1 n k p γ i j k p γ i j a pressure matching method is applied that estimates the fine scale voxel values p γ i j k on the boundary faces γ ij of the coarse grid cells each interface region γ ij contains subsets that correspond to voxel faces that belong to either left or right coarse grid block denoted as γ i j l and γ i j r such that γ i j l γ i j r γ i j γ i j l ω i and γ i j r ω j a dual coarse grid is also extracted out of the image defined such that each dual coarse grid block dω ij is centred at the shared faces of the coarse grid blocks with a given thickness h conceptually illustrated in fig 1 with an explicit visualisation in fig 2 in a 1d decomposition example each dual grid block has shared faces with the full domain in the left and right coarse faces denoted d γ i j l and d γ i j r respectively each of these coarse faces contains the voxel sized fine grid faces of which there exists subsets corresponding to voxel faces that belong to either the left or right side of the interface for example on a grid partitioned into 5 coarse blocks ω1 to ω5 there exists dual grid blocks dω12 dω23 and so on the interface between coarse blocks 1 and 2 contains shared faces γ 12 l and γ 12 r representing the voxel faces that exist as part of the boundary of coarse grid block 1 and 2 respectively the first dual coarse grid block dω12 with a thickness of h will overlap the boundary between ω1 and ω2 the boundaries of interest in this dual block exist within the body of ω1 and ω2 denoted as d γ 12 1 and d γ 12 2 each of these boundaries contains subsets that belong to the left and right sides denoted as d γ 12 1 l and d γ 12 1 r each coarse grid block is vectorised into a finite volume grid to allow the removal of solid voxels in order to reduce computational time and memory this is also done on the dual coarse grid the iterative routine to determine the mass conservative pressure distribution begins by initialising a pressure field in this case a linear pressure gradient across the fine scale voxel domain and extracting the associated constant pressure boundary face distribution of each coarse grid cell each coarse block is then solved for the internal pressure field using the aforementioned fine scale voxel face pressures as dirichlet boundary conditions the pressure solution is flux continuous within each coarse grid but is not flux continuous at the face boundaries of the coarse grid this is corrected for by the dual coarse grid which extracts the face pressure distribution of the coarse grid at the dual grid boundary face locations which is then used to solve for pressure in the dual grids and used to update the internal pressure field for example a domain split into 5 parts in 1 dimension with a uniform initialisation will begin by imposing boundary conditions of p inlet 1 and p 12 0 8 and so on up to p outlet 0 these individual subdomains are solved to obtain the local pressure distribution within the coarse blocks grid block ω1 contains the shared face locations with dual grid d γ 12 1 and the new pressure distributions are used as the boundary condition when solving the pressure within dω12 and so on the iteration is continued until the residual calculated is less than a threshold value that is calculated as the maximum discrepancy in material flow between adjacent fine scale voxels in the direction of flow 7 max q i q i 1 q i c where qi is the flow rate in each slice i perpendicular to the direction of flow calculated by q i r 2 ω i v d ω i where i indexes cross section slices perpendicular to the flow direction and c is a threshold value in this study results are presented with a threshold of max q i q i 1 q i 0 1 fig 3 illustrates the algorithmic flow of the iteration between coarse grid and dual coarse grid to obtain a flux continuous fine scale pressure field and permeability estimation the number or partitions and the dual grid block thickness are controllable parameters that will be tested in this paper 3 materials a range of micro ct images are used in this paper bentheimer sandstone 5003 imaged at resolutions of 5 3 µm at the australian national university liu et al 2017 berea sandstone 4003 sandpack 1503 ketton carbonate 9003 imaged at resolution of 5 3 µm 10 µm and 3 8 µm respectively at imperial college london blunt et al 2013 menke et al 2015 these smaller samples shown in fig 4 and are used to test carbonate and sandstone morphologies to directly compare simulation speed and accuracy with published performance results using geodict fraunhofer 2011 and pfvs chung et al 2019 a bentheimer image measuring 2520 2520 7250 shown in fig 5 is also used to test computational efficiency at larger image sizes the core sample measuring 1 7 cm in diameter and 5 cm in length was imaged at the university of new south wales at a 6 9 µm resolution and segmented using converging active contours schlüter et al 2014 4 validation the flux of any given heterogeneous sample when split apart and solved should converge to a state whereby the volumetric flow rate along the cross section of the pressure potential from the inlet and outlets is constant this can be examined by comparing the obtained pressure and flux fields of a rock sample when solving for flow in a fine scale solution across the entire domain and when using the domain decomposition algorithm for the sake of visual clarity a 603 subsample of the sandpack micro ct image is used in this test a comparison is made between results obtained using the pfvs method on the entire domain and when applying the domain decomposition method by splitting the image into 4 partitions as shown in fig 6 the coarse domain is split at z 15 30 and 45 while the dual domain is split at z 8 rounded from 7 5 23 38 and 53 this allows the boundaries of each subdomain grid to lie within the body of their corresponding dual grid and vice versa fig 7 depicts the fine scale solution result obtained from pfvs and the normalised difference between the flux distribution at iterations 1 5 20 and 100 this is calculated as f l u x d e c o m p f l u x p f v s f l u x p f v s and shows a visual trend towards flux continuity which is supported by the streamlines presented in fig 8 the respective flow rate cross sections are shown in fig 9 indicating a convergence towards steady state incompressible flow conditions the normalised velocity probability density functions pdfs of the normalized velocity distribution v 1 v v v d v are shown in fig 10 and indicate that the average velocity within the samples are higher at lower iterations which would result in an overestimation of the permeability the pdfs converge at higher iterations towards the result obtained from the fine scale solution solver this is consistent with the expected convergence from the underlying alternating schwarz method schwarz 1869 with diffusive reduction in low frequency error eventually solving the elliptical diffusion equation as accurately as a fine scale solution the permeability of the sample can then be calculated with eq 4 using the average flow rate in the domain shown in fig 11 the results here indicate that the algorithm will converge to the fine scale solution showing a monotonically decreasing asymptote towards the fine scale solution 5 results and discussion 5 1 permeability estimation the estimated permeability from applying domain decomposition is compared to results obtained by a fine scale solution pfvs algorithm each sample was split into 5 partitions with non overlapping continuous dual partitions analogous to fig 6 the algorithm was run until the estimated permeability reached the convergence criteria of max q i q i 1 q i 0 1 this is chosen as the algorithm outputs diminishing returns as the permeability converges to the fine scale solution result at an ever slowing rate seen in fig 11 thus the computational efficiency can be tuned for accuracy or speed the performance results in fig 12 using the images as outlined in table 1 show that the method results in permeability estimates that are within 10 of pfvs using the aforementioned decomposition settings and convergence criteria the algorithm will tend to equal to pfvs over more iterations as shown in fig 11 which itself is in good agreement with other methods chung et al 2019 the results will always tend to overestimate the permeability compared to pfvs but with an adequate number of iterations will equal the pfvs result this can be addressed by calculating the permeability with a flow rate somewhere between the average flow rate q and the minimum flow rate qmin this is discussed further in a later section 5 2 computational efficiency when solving the elliptic equation within a micro ct image memory constraints are apparent using tpfa with a multigrid solver results in o n cpu efficiency hence the relatively faster pfvs method but presents challenges at high voxel counts due to the scalability of the memory required in a cubic 3d image of n voxels in each direction the discretised system of equations generates a tridiagonal square matrix of size n 3 by n 3 in sparse format this problem thus scales approximately between 3 2 n 3 and n 6 depending on whether the matrix requires decompression during solving this scalability issue is particularly important when attempting to solve for pressure in micro ct images since such images tend to be in the order of n 2000 which remains computationally challenging for modern workstations due to both memory and cpu speed limitations it can thus be said that the time to solution is not the bottleneck to obtaining estimates for the permeability since amg scales linearly in cpu speed but is instead the memory the domain decomposition algorithm was performed on a pc with a 3 20 ghz 16 core cpu and 256 gb of ddr4 ram table 2 shows the computational efficiency achieved for the samples used for permeability estimation in table 1 with the same convergence criteria of max q i q i 1 q i 0 1 the overall efficiency scales favourably by a power law relationship as shown in fig 13 specifically a comparison of the cpu time required to solve the permeability of a 4003 berea sandstone image indicated that the domain decomposition algorithm was 2 times faster than pfvs and 15 times faster than geodict fraunhofer 2011 the memory efficiency of the algorithm is also examined with the given samples results indicate that the memory usage of the algorithm is consistent with the partitioning as expected active memory usage is approximately 5 times lower in these cases of images partitioned into 5 subdomains compared to the memory required to solve the entire domain this is because only one subdomain is worked on at any given time when running the program in serial mode it can be seen that a typical consumer grade workstation with between 32gb to 64gb of ram is able to easily handle samples up to 9003 while smaller portable devices with between 8gb to 32gb of ram are able to handle such problems simply by increasing the number of partitions furthermore images exceeding 10003 are expected based on the memory performance shown to also be accessible by workstations with at least 256gb of ram when solving in serial mode it can be expected that application of domain decomposition to other algorithms that may be more memory efficient will also give proportionally more efficient domain decomposition performance table 3 5 3 effect of partitioning and dual grid thickness the main variables to the algorithm performance that can be controlled are the number of partitions and the thickness of the dual grids illustrated in fig 14 these are investigated on the 5003 sandstone image the sample was solved for 50 iterations with a varying number of partitions the sample was also split into 10 partitions with varying dual grid thicknesses to investigate the discussed effect on performance as shown in fig 15 there is a clear reduction in the permeability convergence rate for samples with higher subdivisions especially notable above 10 partitions due to the increase in the total number of unknowns to iterate for consistent with schwarz like convergence there is a trade off between the number of partitions and the computational resources available for an efficient solution fewer partitions results in more time per iteration seen as the 2 partition case took twice as long to reach 50 iterations compared to the 20 partition case memory usage also increases with fewer partitions thus a laptop computer with low specifications for example should run the algorithm with more partitions over a longer period of time while a powerful workstation may only require 2 5 partitions the flexibility of the algorithm to accommodate very large images in systems that are unable to handle the data required to solve for flow in the domain is the primary strength of this method similarly the thickness of the dual grid is a significant factor in the convergence performance as the dual grids dictate how accurate the boundary pressures are calculated for each iteration by increasing the dual grid thickness a larger slice of the pressure field is recomputed which results in a faster convergence rate in the case of an image with 500 voxels in the axis of partitioning split into 10 parts the non overlapping cell width is 50 cells however when the dual grids begin to overlap each other it can be seen in fig 16 that the permeability calculation begins a dampened oscillation due to overestimations of the pressure field in each iteration this oscillatory behaviour remains convergent and so remains an applicable and viable method of improving algorithmic performance overall it can be seen that applying increasing partitioning will tend to increase time taken to convergence while proportionately decreasing the active memory usage this is an expected outcome of domain decomposition as a whole and especially true for schwarz based implementations the optimal target for partitioning is thus suggested to be the upper limit of available memory in any given system 5 4 effect of flux distribution on permeability uncertainty as seen in fig 9 the flux distribution of a partitioned sample will approach a constant value satisfying flux conservation rules it is also noteworthy that the partition with the minimum initial flux value tends to closely represent the final flux result this is likely due to the critical radius of the entire domain existing within the partition with lower values of calculated flux thus acting as chokes within the domain this observation allows for a more accurate initial estimation of the permeability of the entire domain in this application of domain decomposition this can be empirically done by using the minimum partition flux q i m i n in eq 4 as opposed to the mean flux q this consideration of the critical radius also allows for imposition of upper and lower bounds for estimated permeability in the domain decomposition method applying these bounds to the bentheimer sandstone and ketton carbonate samples split into 5 partitions produces the permeability vs iteration chart as shown in fig 17 and indicates that the lower bound estimate of permeability provides a measure of the uncertainty range in the estimation process furthermore an intermediate estimate of the system permeability can be obtained by computing the midpoint flux qmid within the system which can be evaluated by eq 8 on the normalised flow rate vs z axis chart the permeability result shows faster convergence to the flux conserved value compared to running the routine to its true convergence 8 0 n x max q z q m i d q m i d d z 0 n z min q m i d q z q min d z 5 5 effect of partitioning in 3 dimensions the algorithm thus far has assumed a bread slices type of domain partitioning partitioning the domain such that each coarse slice is perpendicular to the direction of flow this is to investigate the effect of grid fineness related to the full size and the area shared by subdomains fig 18 applying 3d sugar cube 2 2 2 partitioning and comparing to a bread slices 1 1 8 partitioning to the bentheimer sandstone and ketton carbonate samples split into 8 partitions produces the normalised permeability vs iteration chart as shown in fig 19 results indicate that a sugar cube decomposition offers a marginal improvement in convergence rate for the bentheimer sandstone while performance was not changed for the ketton carbonate improved subdomain bandwidth and reduced inter partition communication between iterations are the primary factors that allow this speedup in general it can be expected that for the purpose of estimating the permeability of a segmented micro ct image a 3d sugar cube decomposition that tracks the value of qmid would converge to a solution faster than the tested methodology used in section 5 1 permeability estimation the bentheimer sandstone sample used in this case shows faster convergence to the true value under 3d decomposition compared to the serial decomposition case another point to consider is that in cases where the number of partitions is less than 8 a bread slices or match sticks partitioning in 2 dimensions resulting in long thin matchstick like subdomains approach would become the only methods available 5 6 solving permeability of large images the primary purpose of proposing this domain decomposition based method for solving the elliptic equation for modelling flow is to estimate the permeability of samples that would otherwise be too large for a computer to ordinarily handle a test was run on a 2520 2520 7250 image of a bentheimer sandstone this is the largest image we have access to it is cored from a high permeability region of a large block of bentheimer outcrop due to the size of the entire domain the system memory was insufficient to solve in parallel for reference a double precision property map of a 20003 image would consume 64gb of system memory the sparse matrix of 20006 would consume at least another order of magnitude more and the matrix inversion algorithm would require some degree of memory decompression during its execution during the manipulation and characterisation of the micro ct image multiple property maps of the conductivity face to cell maps etc are required thus the algorithm was run in serial with each subdomain grid called upon sequentially by the algorithm when required the domain was partitioned into 145 subdomains of 2520 2520 50 with the maximum non overlapping dual grid width the domain decomposition algorithm managed to solve the large problem in 20 days resulting in an estimated permeability of 5 7 d using a pc with 3 20 ghz 16 core cpu 256gb of ddr4 ram the resulting normalised velocity field is visualised in fig 20 the sample was also run using lbm with a result of 6 2 d mcclure et al 2014 this is based on 100 000 timesteps to achieve steady state on 1932 gpus on the titan supercomputer totalling 11 6 tb of gddr5 memory the process grid for the simulation was 2 2 483 with 1260 1260 15 sub domains allocated to each gpu the results obtained from the domain decomposition algorithm are within 9 of the result obtained by lbm 6 conclusions we have obtained the absolute permeability of large micro ct images by applying a schwarz based domain decomposition to the pfvs semi analytical method by an iterative pressure matching method that converges to flux continuous conditions this allows solution using computers that would otherwise be unable to handle the size of the domain under ordinary circumstances the domain is subdivided into a coarse grid set and a dual grid subdomain that overlaps the boundaries of the coarse grids by this technique the algorithm is able to solve for the pressure and flux of the entire domain with a scalable and parallelisable iteration between the grids by extending the pfvs method we conducted simulation with various micro ct images of porous reservoir rocks the overall methodology has been validated and shown to converge to a flux continuous system by iteratively solving between each partition set by updating the pressure and flux at the relevant boundaries before each step permeability estimation was within 5 10 of the fine scale pfvs solution within a comparable computational timeframe of 5 to 8 iterations in the cases of very large images or with restrictions on available computing power the algorithm significantly reduces memory limitations and computational time for solving flow in micro ct images using a single 16 core cpu with 256 gb of ddr3 ram the permeability of a 2520 2520 7250 sample was calculated to within 9 error of lbm this is while the lbm simulation required 1932 nvidia tesla k20x gpus totalling 11 6 tb of gddr5 ram within a similar timeframe this permits ordinary workstations and portable pcs to solve images over 10003 within the magnitude of 1 100 h of cpu time acknowledgements we would like to acknowledge tyree x ray facility for providing images that were analysed images used in the draft can be made available upon request an award of computer time was provided by the department of energy incite program this research also used resources of the oak ridge leadership computing facility which is a doe office of science user facility supported under contract de ac05 00or22725 aarnes et al 2007 j aarnes geometrical modeling numerical simulation and optimization industrial mathematics at sintef an introduction to the numerics of flow in porous media using matlab 2007 springer verlag balhoff et al 2008 m t balhoff mortar coupling and upscaling of pore scale models comput geosci 12 1 2008 15 27 balhoff et al 2007 m t balhoff coupling pore scale networks to continuum scale models of porous media comput geosci 33 3 2007 393 410 blunt 2017 m j blunt multiphase flow in permeable media a pore scale perspective 2017 cambridge university press blunt et al 2002 m j blunt detailed physics predictive capabilities and macroscopic consequences for pore network models of multiphase flow adv water resour 25 8 12 2002 1069 1089 blunt et al 2013 m j blunt pore scale imaging and modelling adv water resour 51 2013 197 216 chan and mathew 1994 t f chan t p mathew domain decomposition algorithms acta numerica 3 1994 61 143 chung et al 2018 t chung approximating permeability of micro ct images using elliptic flow equations spe j 2019 10 2118 191379 pa coenen et al 2004 j coenen measurement parameters and resolution aspects of micro x ray tomography for advanced core analysis proceedings of international symposium of the society of core analysts 2004 culligan et al 2006 k culligan pore scale characteristics of multiphase flow in porous media a comparison of air water and oil water experiments adv water resour 29 2 2006 227 238 fenwick and blunt 1998 d h fenwick m j blunt three dimensional modeling of three phase imbibition and drainage adv water resour 21 2 1998 121 143 flannery et al 1987 b p flannery three dimensional x ray microtomography science 237 4821 1987 1439 1444 fraunhofer 2011 i fraunhofer geodict homepage of the geodict software 16 2011 gropp and keyes 1992 w d gropp d e keyes domain decomposition methods in computational fluid dynamics int j numer methods fluids 14 2 1992 147 165 hajibeygi et al 2008 h hajibeygi iterative multiscale finite volume method j comput phys 227 19 2008 8604 8621 hazlett 1995 r hazlett simulation of capillary dominated displacements in microtomographic images of reservoir rocks multiphase flow in porous media 1995 springer 21 35 hilpert and miller 2001 m hilpert c t miller pore morphology based simulation of drainage in totally wetting porous media adv water resour 24 3 4 2001 243 255 iassonov et al 2009 p iassonov segmentation of x ray computed tomography images of porous materials a crucial step for characterization and quantitative analysis of pore structures water resour res 45 9 2009 jasak et al 2007 h jasak openfoam a c library for complex physics simulations international workshop on coupled methods in numerical dynamics 2007 iuc dubrovnik croatia khayrat and jenny 2017 k khayrat p jenny a multi scale network method for two phase flow in porous media j comput phys 342 2017 194 210 kippe et al 2008 v kippe a comparison of multiscale methods for elliptic problems in porous media flow comput geosci 12 3 2008 377 398 lie et al 2016 k a lie successful application of multiscale methods in a real reservoir simulator environment ecmor xv 15th european conference on the mathematics of oil recovery 2016 lie et al 2012 k a lie open source matlab implementation of consistent discretisations on complex grids comput geosci 16 2 2012 297 322 lindquist et al 1996 w b lindquist medial axis analysis of void structure in three dimensional tomographic images of porous media j geophys res 101 b4 1996 8297 8310 liu et al 2017 z liu pore scale characterization of two phase flow using integral geometry transport porous media 118 1 2017 99 117 liu and mostaghimi 2017 m liu p mostaghimi pore scale simulation of dissolution induced variations in rock mechanical properties int j heat mass transfer 111 2017 842 851 lunati and jenny 2007 i lunati p jenny treating highly anisotropic subsurface flow with the multiscale finite volume method multiscale model simul 6 1 2007 308 318 marshall et al 1997 j marshall a finite volume incompressible navier stokes model for studies of the ocean on parallel computers j geophys res 102 c3 1997 5753 5766 mcclure et al 2014 j e mcclure a novel heterogeneous algorithm to simulate multiphase flow in porous media on multicore cpu gpu systems comput phys commun 185 7 2014 1865 1874 mees et al 2003 f mees applications of x ray computed tomography in the geosciences 215 2003 geological society london 1 6 special publications mehmani and tchelepi 2018 y mehmani h a tchelepi multiscale computation of pore scale fluid dynamics single phase flow j comput phys 375 2018 1469 1487 menke et al 2015 h menke dynamic three dimensional pore scale imaging of reaction in a carbonate at reservoir conditions environ sci technol 49 7 2015 4407 4414 mostaghimi and mahani 2010 p mostaghimi h mahani a quantitative and qualitative comparison of coarse grid generation techniques for modeling fluid displacement in heterogeneous porous media spe reserv eval eng 13 01 2010 24 36 mostaghimi et al 2013 p mostaghimi computations of absolute permeability on micro ct images math geosci 45 1 2013 103 125 mostaghimi et al 2016 p mostaghimi numerical simulation of reactive transport on micro ct images math geosci 48 8 2016 963 983 patankar 1980 s patankar numerical heat transfer and fluid flow 1980 crc press rabbani et al 2019 a rabbani pore network extraction using geometrical domain decomposition adv water resour 123 2019 70 83 saxena et al 2017 n saxena 
682,groundwater use in india has been in the limelight in recent years due to its intensive and apparent unsustainable use that poses threats to water security drinking water supply and food production here we present estimates of usable groundwater storage for the first time at the state level across all of india using both in situ and satellite based measurements groundwater level data are used from 3907 in situ monitoring wells across india and the total usable groundwater storage ugws is estimated between 2005 and 2013 the ugws estimates indicates high rates of depletion 5 km3 yr of groundwater storage gws in north east india i e assam even though increase in precipitation has been observed in that state satellite based gravity recovery and climate experiment grace estimates indicate that the development of recent gws depletion zones is concentrated in unconsolidated sediments or lithotype across the indus ganges and brahmaputra basins in the states of punjab haryana uttar pradesh bihar and west bengal in contrast southern and central indian states such as andhra pradesh maharashtra gujarat tamil nadu and chattisgarh show replenishing gws trends we also find that the states with highest groundwater depletion rates are subjected to water intensive cropping practices during the study period we temporally downscale the ugws with support from grace satellite based measurements we conclude that the approach we developed here can be applied in other parts of the world to devise management options for sustainable groundwater use keywords usable groundwater storage food security india groundwater management 1 introduction groundwater being the largest freshwater resource available on earth plays crucial role in human sustenance and global food security through irrigated agriculture hertig and gleeson 2012 earlier studies rodell et al 2009 tiwari et al 2009 reager and famiglietti 2013 voss et al 2013 richey et al 2015 asoka et al 2017 bhanja et al 2017b report from various parts of the globe that many regions or nations have been experiencing discernible groundwater depletion in recent times the scenario has been further intensified as a function of increasing demand for foods through irrigated agriculture siebert et al 2015 and due to uncertainty in seasonal water availability linked to global warming and climate change famiglietti and rodell 2013 therefore delineating groundwater resources is a crucial step for designing an effective management framework for future sustainability of water and food india fig 1 comprises only 2 3 of the global terrestrial area but host about 17 8 of the population mukherjee et al 2015 the country also includes more than 30 of the global irrigated land fao 2013 net groundwater fed irrigated area has been rapidly increased from 5 98 mha in 1950 51 to 42 44 mha in 2013 14 in india des 2015 groundwater use in net irrigated area has been expanded from 28 7 in 1950 51 to 62 3 in 2013 14 des 2015 furthermore a significant portion of urban drinking water and 85 of the rural drinking water are used from groundwater sources pahuja et al 2010 india faces acute shortage of groundwater sourced drinking water and other usable waters as it is witnessing steep rise in water demand and change in societal water use pattern because of increasing population rapid urbanization and lifestyle change the area is drained by some of the largest fluvial systems like the indus ganges brahmaputra igb system supplementary fig 1 macdonald et al 2016 however availability of groundwater within the study region is extremely heterogeneous with aquifers ranging from high potential unconsolidated sedimentary formations to low yielding crystalline bedrocks mukherjee et al 2015 bhanja et al 2016 further in spite of relatively high precipitation 1200 mm year 900 mm in monsoon season ncc 2013 monsoon dependent precipitation based aquifer recharge is spatially monsoonal path dependent and temporally 75 precipitation during monsoon months variable scanlon et al 2010 bhanja et al 2018 based on the differential precipitation pattern distinct climate zones are formed in india ranging from extremely arid to some of the wettest places on earth mukherjee et al 2015 moreover the available groundwater is profusely abstracted 222 bcm irrigational groundwater abstracted in india during 2011 cgwb 2014b thereby characterizing much of the region to very high water stressed area groundwater withdrawal to availability ratio is greater than 0 8 alcamo et al 2003 bates et al 2008 hence groundwater storage and availability in the study region is largely based on dynamic equilibrium between hydraulic property of the aquifers precipitation distribution and intensity and human interferences by abstraction or replenishment previous studies have suggested that groundwater resources in most of india are under serious threat if withdrawal continues at this rate zaveri et al 2016 gross irrigated area increased more than 3 8 times in the last 60 years moa 2012 depletion causes include inefficient water use practices irrigation systems with poor maintenance and inadequate price of both power and water facilitating misuse of water moa 2012 bhanja et al 2017b some of the earlier studies rodell et al 2009 tiwari et al 2009 soni and hasan 2015 panda and wahr 2015 asoka et al 2017 have reported the patterns of groundwater storage gws anomalies in parts of india using satellite based observations bhanja et al 2016 evaluated the performance of satellite based groundwater storage estimates using a dense network of in situ groundwater level monitoring stations in 12 largest river basins in india and found consistent match with satellite based gws here for the first time we estimate groundwater storage changes and availability in major indian states using a dense network of in situ and satellite based estimates between 2005 and 2013 to our knowledge this is the first study on estimation of groundwater storage availability in the form of usable groundwater storage ugws nationally across the whole of india we also attempted to temporally downscale the ugws using satellite based gws estimates 2 data and methods 2 1 precipitation data the tropical rainfall measuring mission s trmm multi satellite precipitation analysis tmpa data is used here the tmpa has been developed to provide best precipitation estimates across the globe huffman et al 2010 we use the monthly gridded 0 25 0 25 3b43 product version 7 which includes a combination of multiple satellite retrieval as well as rain gauge measurements from the global precipitation climatology centre gpcc archive huffman et al 2007 2010 as the in situ groundwater level measurements are available for four times a year precipitation data is processed for the four time periods december january february may june august and september november respectively 2 2 groundwater storage estimates using in situ groundwater level data seasonal in situ borehole hydrographs are obtained from 15 653 locations across india from central ground water board cgwb india between january 2005 and november 2013 cgwb has been maintaining an excellent groundwater monitoring network that started in 1969 cgwb 2014a as of march 2017 23 125 monitoring locations are operating across india cgwb 2017 within which 16 703 72 are dug wells cgwb 2017 a previous estimate show that the non pumping observation wells are mostly located in unconfined aquifers cgwb 2014a we compare groundwater levels obtained from continuous monitoring sensors to the cgwb data in some locations within the study area the two measurements compared well with each other we process the data for maintaining temporal continuity i e at least three seasonal data out of four should be available at a location in every year interquartile range iqr filter has been applied on the data to remove outliers davis 2002 reducing the total number of locations down to 3907 table 1 fig 1 groundwater level anomalies h are estimated by subtracting the mean water level depths from the entire time series 2005 2013 for individual water level time series data 2 3 usable groundwater storage ugws and specific yield aquifer thickness extends up to 700 m or more in unconsolidated sedimentary formations of the indus ganges brahmaputra igb river basin supplementary table 1 cgwb 2012 aquifers are found to be existing up to 600 m in consolidated permeable sedimentary formations supplementary table 1 cgwb 2012 fractured encountered data shows the exploration of fractures up to 291 m depth for groundwater utilization in the fractured formations supplementary table 1 cgwb 2012 occurrence of modern groundwater at a depth of 150 m has been reported in north west india lapworth et al 2015 macdonald et al 2016 restricted their study to the depth of 200 m due to scarcity of data in the igb basin the upper 300 m of the terrestrial ground has also been assumed as the maximum depth of aquifer responding to most of the anthropogenic groundwater activities mukherjee et al 2007 2011 for its aquifer mapping program cgwb also considered to map the subsurface features up to the maximum depth of 300 m cgwb 2013b in general water quality deteriorates beyond 300 m because groundwater at that depth has undergone extensive hydrogeochemical evolution and getting enriched in ionic concentration it is also a costly affair to drill at greater depths particularly beyond 300 m the energy usage for deeper groundwater exploitation is also higher therefore based on the available information we have considered the upper 300 m as the usable thickness of the aquifer the ugws is estimated by multiplying usable aquifer thickness and specific yield values at each of the selected wells the study area is characterized into 6 hydrogeological units unconsolidated sedimentary aquifers consolidated permeable sedimentary aquifers sedimentary aquitards folded metasediment metamorphic aquifers jointed crystalline aquifers and fractured crystalline aquifers bhanja et al 2016 2018b specific yield sy being the property of the medium varies from 0 02 to 0 44 across different geologic material bhanja et al 2018a ranges of sy for different hydrogeologic formations in india are obtained from cgwb 2012 and provided in supplementary table 1 long term pumping tests are conducted for estimating sy values gec 2009 mean sy values of the hydrogeologic units in india varying from 0 018 to 0 13 here we apply the sy values reported in bhanja et al 2016 the gridded specific yield values are assigned to each of the wells on the basis of their locations our major assumption is that the aquifers are homogeneous interconnected and unconfined up to 300 m gleeson et al 2015 indicates negligible change in porosity in different rock types up to 300 m depth macdonald et al 2016 and bonsor et al 2017 considered aquifer extension up to 200 m in igb basin cgwb reported 300 m depth of aquifers in some of the places in the study region cgwb 2012 mukherjee et al 2007 2011 reported aquifer extending up to 300 m in parts of the study area the depth beyond that might be contaminated with naturally occurring chemical contaminants mukherjee et al 2011 we prefer using sy over porosity for calculating the usable water volume as sy includes the amount of extractable water from aquifer material unlike porosity which depicts the pore fraction only within aquifer material 2 4 satellite based groundwater storage estimates we use 101 monthly 2005 2013 gridded 1 1 liquid water equivalent thickness lwet also known as terrestrial water storage tws from the national aeronautics and space administration nasa jet propulsion laboratory s jpl archive bhanja et al 2016 reported better performance of grace mascon products against grace spherical harmonics products for reproducing groundwater storage estimates using in situ groundwater storage measurements in india the recently released rl05 mascon solution are used in this analysis the entire globe is divided into 30 spherical mass concentration units having equal area in the mascon approach watkins et al 2015 several techniques have been applied on the data for estimating terrestrial water storage tws http grace jpl nasa gov data get data jpl global mascons accessed on 26 april 2016 satellite laser ranging data are used to replace degree 2 and order 0 coefficients cheng and tapley 2004 geo center corrections degree 1 coefficients are computed following swenson et al 2008 the process developed by geruo et al 2013 has been followed to remove the post glacial rebound signal in the data we have multiplied the scale factor provided with the data with the tws solutions for more representative tws solutions we use global land data assimilation system gldas rodell et al 2004 simulation outputs from the nasa archive for soil moisture sm and surface water sw equivalent estimates snow is not taken into consideration as the study region is not subjected to snow except for the himalayan sections surface water measurements are not available across india we use surface runoff from gldas outputs as a proxy for sw following asoka et al 2017 we use an ensemble of sm and sw from 3 different land surface models lsm community land model clm dai et al 2003 variable infiltration capacity vic liang et al 1994 1996 and noah chen et al 1996 koren et al 1999 the ensemble result is reported to provide best results than using individual lsm s output bhanja et al 2016 time series of anomalies of each of the components are obtained by removing all time mean from the individual data groundwater storage anomalies gws are computed after removing sm and sw from tws grace have been widely used across the globe for computing the gws change even at the places with very few or scarce observation data available the original resolution of grace based estimates is approximately 3 3 spatial resolution as it was designed for regional scale studies tapley et al 2004 although recent algorithm developments are facilitating higher resolution output at 1 1 spatial resolution watkins et al 2015 the user should be cautious upon using the data for the local scale studies i e local scale groundwater storage change impacted from anthropogenic activities 2 5 temporal downscaling of usable groundwater storage the in situ data are available for four times a year we also attempted to temporally downscale i e monthly the ugws data using monthly scale satellite based gws estimates bhanja et al 2017a have reported groundwater spatial variability in major river basins using the same groundwater level measurement database used in this study the spatial variability of the wells located within each state is calculated following the equations bhanja et al 2017a 1 n t 2 1 α 2 n 1 s 2 d 2 2 n t 2 1 α 2 n 1 e 2 c l 2 h d 2 where n is the total number of samples σ is the spatial variability within each state d is the user desired accuracy level absolute error t 2 1 α 2 n 1 representing the student s t distribution at the significance level α 5 used here λ is the extent c and h are the intercept and slope of the linear relationship between log spatial variability and log extent respectively in order to compute the spatial variability further analysis is performed for the 15 states with number of wells 50 table 1 finally 8 states are selected for further analyses using in situ data table 1 to compute satellite based ugws ugwssat we used linear regression analysis using independent variable ugws and dependent variable satellite based gwsa gwsasat between 2005 and 2013 as the ugws values are available four times a year gwsasat values are used for the corresponding time period of the groundwater measurements 3 gws a sat m ugws c the slope m and intercept c values from the regression analysis have been used further to transform gwsasat to ugwssat in the following way 4 ugw s sat gws a sat c m 2 6 assumptions and limitations the satellite based estimates are not advisable to use for smaller basins states due to coarser resolution of satellite based observations gwsa from individual wells are spatially averaged to provide state wide gwsa following bhanja et al 2017a and scanlon et al 2018 for basin wide average the spatial error associated with the spatial averaging is computed following eq 2 based on unavailability of data an uniform aquifer thickness is used through india future studies targeted to improve the ugws estimates should consider including high resolution aquifer thickness disaggregating the gwsa signal from twsa is a challenging task due to unavailability of observational data for all of the required components 3 results and discussions 3 1 estimation of groundwater storage availability table 1 shows detail of the states and number of wells used in ugws calculation spatial mean precipitation and spatial mean ugws values while comparing the ugws in the states with moderate data availability 50 wells the highest ugws values are observed in the states such as haryana uttar pradesh and assam respectively all of the three states are located in highly fertile basins of the indus ganges and brahmaputra rivers figs 2 and 3 in bhanja et al 2016 indicates the spatial distribution of unconsolidated semi consolidated and crystalline aquifer units across india although the state jammu and kashmir is comprised of a combination of unconsolidated and consolidated lithotypes the in situ observation wells fig 1 used in this study are mostly confined to the unconsolidated semi consolidated lithotypes figs 1 and 2 in bhanja et al 2016 this is the main reason for obtaining higher than expected ugws values in jammu and kashmir table 1 ugws values in southern and central indian states that are comprised of crystalline rocks are showing comparatively lower ugws values table 1 precipitation rates might not influence the total ugws magnitude for example haryana receives comparatively lower rainfall but subjected to the highest observed ugws values on the other hand madhya pradesh chhattisgarh and karnataka are receiving almost the twice of the amount of precipitation in comparison to haryana however exhibits much lower ugws values supplementary fig 2 shows state wise time series of spatial mean ugws between 2005 and 2013 ugws data shows strong seasonality with highest values in monsoon or in post monsoon season most of the states are experiencing a rise in water table after 2009 2010 2009 is the year of lowest rainfall in the country during the study period supplementary fig 3 shows time series of spatial mean precipitation and their hp trends between 2005 and 2013 precipitation data shows strong seasonality supplementary fig 3 it is interesting to note that we observe recent increasing trend of precipitation in most of the states supplementary fig 3 indicating dominance of anthropogenic influence on groundwater depletion in the states like assam haryana and odisha the three states experience continuous depletion in groundwater level supplementary fig 2 3 2 groundwater storage anomaly from satellite based estimations satellite based gwsa estimates gwsasat show development of intense groundwater depletion zones in the states located in parts of indus ganges and brahmaputra basins between 2005 and 2013 fig 2 the highly fertile alluvial formations are linked with intense irrigation linked groundwater withdrawal siebert et al 2010 while the central and south indian states are subjected to comparatively lower irrigation linked groundwater withdrawal leading to unchangeable to replenishing gws conditions over the years fig 2 greater depleting gwsasat trends 4 km3 yr are observed in rajasthan and uttar pradesh fig 3 these estimates are in line with results from the earlier studies conducted within the region rodell et al 2009 tiwari et al 2009 soni and hasan 2015 panda and wahr 2015 bhanja et al 2017b 3 3 trends in precipitation and groundwater storages the state wise trends of precipitation ugws and gwsasat values are shown in fig 3 we observe increasing precipitation trend in most of the states fig 3a with a few exceptions decreasing precipitation trends are observed in tamil nadu kerala and karnataka ugws trends indicate rapid depletion in assam fig 3b at a rate of 5 km3 yr fig 3b despite of overall increase in precipitation the state is also subjected to comparatively higher amount of total precipitation 2663 mm year table 1 similar observation has been found in haryana with increase in precipitation and depletion in groundwater storage ugws and gwsasat both of the estimates show replenishing trend in andhra pradesh maharashtra and tamil nadu between 2005 and 2013 although gws in tamil nadu exhibit depleting hp trend in recent years supplementary fig 2 the estimates are also consistent with published reports of cgwb cgwb 2013a 2014b 3 4 groundwater use in irrigation despite increase in total precipitation in assam rajasthan and uttar pradesh the reasons for observing highest ugws gwsasat are further investigated using groundwater irrigation data and the underlying cropping pattern over the years state wise net irrigated area and land use statistics data are obtained from the ministry of agriculture and farmer welfare govt of india open source data are retrieved from data gov in groundwater irrigated area gwia has been rapidly increased in assam within the study period supplementary fig 4a increase in gwia has also been observed in rajasthan and uttar pradesh supplementary figure 4b 4c the total water requirement by crops is studied as a fraction of the total cropped area of water intensive crops and the total cropped area the annual cropped area for six of the most water intensive crops waters 2004 i e rice wheat sugarcane fruits and vegetables f v soya bean and cotton are shown in fig 4 supplementary table 2 it is observed that the water intensive crops cover maximum fraction of the total cropped area in assam rajasthan and uttar pradesh fig 4 the percentage trend of cropped area coverage of the water intensive crops has been increased in recent years at the three states during the study period fig 4 it is important to note that cropped area associated with the two most water intensive crops cotton and rice has been rapidly increased in assam and rajasthan in 2005 2013 this would lead to comparatively faster depletion of water resources if continued at the ongoing rate 3 5 temporal downscaling of ugws using satellite based measurements widespread use of satellite based approaches for estimation of gws has been observed in india rodell et al 2009 tiwari et al 2009 soni and hasan 2015 bhanja et al 2016 panda and wahr 2015 bhanja et al 2017b however all of the studies report gws anomaly or change over the years here we attempt to estimate ugws from the satellite based measurements ugwssat for the 8 states which have sufficient in situ measurement locations see section 2 5 for details in order to get realistic estimates the states with statistically significant p values 0 05 relationship between ugws and gwssat are further selected for the analyses strong seasonality is observed in ugwssat values with maximum values during monsoon season fig 5 in general ugwssat matches well with the ugws data fig 5 ugwssat shows recent increasing trend in four of the five states studied fig 5 3 6 spatial variability of the groundwater storage anomaly ugws values are estimated after analyzing the groundwater level observations from the number of wells indicated in table 1 hence state s with comparatively lower number of observation wells will not exactly represent the actual condition in that state s we have also investigated the error level associated with the spatial averaging of the wells within the states fig 6 absolute error level is found to be within 2 cm gwsa anomaly in the all 15 states studied out of which it is 1 cm in the 6 states fig 6 the results show comparatively lower absolute error level on comparing the error estimates in the river basins within united states reported by li et al 2015 the magnitude of the error is found to be within 5 of the estimated gwsa estimates across the states 3 7 significance of the ugws calculation the widely used gws anomaly provides relative not absolute information on groundwater storage condition the intense data driven approach has leading to our robust estimation of groundwater depletion replenishment potential in indian states highest depletion potential has been observed in assam with more than 2 of their total ugws depletion during 2005 2013 fig 7 interestingly precipitation data shows increasing trend in assam during the period fig 3a this contrasting nature of ugws and precipitation in assam might be linked with higher rates of irrigation linked groundwater withdrawal net irrigated area using irrigation from tube wells has been increased from 9 thousand hectares in 2004 2005 to 74 thousand hectares in 2013 2014 groundwater irrigation data is retrieved from the ministry of agriculture farmers welfare govt of india source https eands dacnet nic in accessed on february 20 2017 water intensive cropping has also been increased manifold in assam in recent years fig 4 the situation is alarming in view of groundwater quality issues prevalent in the region mukherjee et al 2015 macdonald et al 2016 for example groundwater is contaminated with geogenic arsenic in parts of eastern and northeastern india mukherjee et al 2015 macdonald et al 2016 parts of western and southern india are subjected to fluoride contamination in groundwater mukherjee et al 2015 parts of northwest western and southern india are linked with higher groundwater salinity mukherjee et al 2015 macdonald et al 2016 on the other hand andhra pradesh and jharkhand are experiencing the highest replenishment potential the concept can be applied in other parts of the globe for proper application of groundwater resource management 4 conclusions in this study we investigate groundwater storage changes in all of the major indian states using in situ n 3907 and satellite based measurements during the period of 2005 2013 in situ data are used to compute the usable groundwater storage ugws across the indian states in order to provide representative estimates we select only those states with sufficient density of in situ monitoring wells ugws data show greater depletion in assam at a rate of 6 66 km3 year in 2005 2013 satellite based gws estimates indicate greater depletion zones that are developed in parts of punjab haryana uttar pradesh bihar and west bengal groundwater storage shows replenishing trend in andhra pradesh maharashtra gujarat tamil nadu and chhattisgarh precipitation rates are showing increasing trend in most of the states even in the states of highest groundwater depletion substantial groundwater withdrawal linked with irrigation also indicates increasing trend in assam rajasthan and uttar pradesh the three states with the highest groundwater depletion in the study period water intensive cropping pattern linked with the prevalence of water intensive crops with 50 occurrence further influence the scenario in the three states we also attempt to temporally downscale the seasonal ugws estimates using monthly satellite based measurements the ugws calculations enable us to compute the changes in total usable water storage and also provide the quantity of usable groundwater available for future use this would provide a distinct picture of groundwater availability rather than the groundwater storage anomalies the approach could be used in other parts of the globe for quantification of groundwater storage availability acknowledgments and data snb acknowledges csir india for their support through spm fellowship this manuscript uses freely available data of the central ground water board cgwb government of india weblink http www india wris nrsc gov in gwl gwl html utype r2vuzxjhba uname accessed on june 20 2017 the opinion expressed in the paper is of authors own and not of the affiliated department we acknowledge cgwb india for providing water level data grace land data were processed by sean swenson supported by the nasa measures program and are available at http grace jpl nasa gov the gldas data used in this study were acquired as part of the mission of nasa s earth science division and archived and distributed by the goddard earth sciences ges data and information services center disc the trmm data has been obtained from nasa archive groundwater water irrigation data are retrieved from the ministry of agriculture farmers welfare govt of india source https eands dacnet nic in accessed on february 20 2017 we acknowledge dr dipankar saha cgwb we would also like to thank the editor prof paolo d odorico and the three anonymous reviewers for their constructive comments and suggestions supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2019 02 001 appendix supplementary materials image application 1 image application 2 
682,groundwater use in india has been in the limelight in recent years due to its intensive and apparent unsustainable use that poses threats to water security drinking water supply and food production here we present estimates of usable groundwater storage for the first time at the state level across all of india using both in situ and satellite based measurements groundwater level data are used from 3907 in situ monitoring wells across india and the total usable groundwater storage ugws is estimated between 2005 and 2013 the ugws estimates indicates high rates of depletion 5 km3 yr of groundwater storage gws in north east india i e assam even though increase in precipitation has been observed in that state satellite based gravity recovery and climate experiment grace estimates indicate that the development of recent gws depletion zones is concentrated in unconsolidated sediments or lithotype across the indus ganges and brahmaputra basins in the states of punjab haryana uttar pradesh bihar and west bengal in contrast southern and central indian states such as andhra pradesh maharashtra gujarat tamil nadu and chattisgarh show replenishing gws trends we also find that the states with highest groundwater depletion rates are subjected to water intensive cropping practices during the study period we temporally downscale the ugws with support from grace satellite based measurements we conclude that the approach we developed here can be applied in other parts of the world to devise management options for sustainable groundwater use keywords usable groundwater storage food security india groundwater management 1 introduction groundwater being the largest freshwater resource available on earth plays crucial role in human sustenance and global food security through irrigated agriculture hertig and gleeson 2012 earlier studies rodell et al 2009 tiwari et al 2009 reager and famiglietti 2013 voss et al 2013 richey et al 2015 asoka et al 2017 bhanja et al 2017b report from various parts of the globe that many regions or nations have been experiencing discernible groundwater depletion in recent times the scenario has been further intensified as a function of increasing demand for foods through irrigated agriculture siebert et al 2015 and due to uncertainty in seasonal water availability linked to global warming and climate change famiglietti and rodell 2013 therefore delineating groundwater resources is a crucial step for designing an effective management framework for future sustainability of water and food india fig 1 comprises only 2 3 of the global terrestrial area but host about 17 8 of the population mukherjee et al 2015 the country also includes more than 30 of the global irrigated land fao 2013 net groundwater fed irrigated area has been rapidly increased from 5 98 mha in 1950 51 to 42 44 mha in 2013 14 in india des 2015 groundwater use in net irrigated area has been expanded from 28 7 in 1950 51 to 62 3 in 2013 14 des 2015 furthermore a significant portion of urban drinking water and 85 of the rural drinking water are used from groundwater sources pahuja et al 2010 india faces acute shortage of groundwater sourced drinking water and other usable waters as it is witnessing steep rise in water demand and change in societal water use pattern because of increasing population rapid urbanization and lifestyle change the area is drained by some of the largest fluvial systems like the indus ganges brahmaputra igb system supplementary fig 1 macdonald et al 2016 however availability of groundwater within the study region is extremely heterogeneous with aquifers ranging from high potential unconsolidated sedimentary formations to low yielding crystalline bedrocks mukherjee et al 2015 bhanja et al 2016 further in spite of relatively high precipitation 1200 mm year 900 mm in monsoon season ncc 2013 monsoon dependent precipitation based aquifer recharge is spatially monsoonal path dependent and temporally 75 precipitation during monsoon months variable scanlon et al 2010 bhanja et al 2018 based on the differential precipitation pattern distinct climate zones are formed in india ranging from extremely arid to some of the wettest places on earth mukherjee et al 2015 moreover the available groundwater is profusely abstracted 222 bcm irrigational groundwater abstracted in india during 2011 cgwb 2014b thereby characterizing much of the region to very high water stressed area groundwater withdrawal to availability ratio is greater than 0 8 alcamo et al 2003 bates et al 2008 hence groundwater storage and availability in the study region is largely based on dynamic equilibrium between hydraulic property of the aquifers precipitation distribution and intensity and human interferences by abstraction or replenishment previous studies have suggested that groundwater resources in most of india are under serious threat if withdrawal continues at this rate zaveri et al 2016 gross irrigated area increased more than 3 8 times in the last 60 years moa 2012 depletion causes include inefficient water use practices irrigation systems with poor maintenance and inadequate price of both power and water facilitating misuse of water moa 2012 bhanja et al 2017b some of the earlier studies rodell et al 2009 tiwari et al 2009 soni and hasan 2015 panda and wahr 2015 asoka et al 2017 have reported the patterns of groundwater storage gws anomalies in parts of india using satellite based observations bhanja et al 2016 evaluated the performance of satellite based groundwater storage estimates using a dense network of in situ groundwater level monitoring stations in 12 largest river basins in india and found consistent match with satellite based gws here for the first time we estimate groundwater storage changes and availability in major indian states using a dense network of in situ and satellite based estimates between 2005 and 2013 to our knowledge this is the first study on estimation of groundwater storage availability in the form of usable groundwater storage ugws nationally across the whole of india we also attempted to temporally downscale the ugws using satellite based gws estimates 2 data and methods 2 1 precipitation data the tropical rainfall measuring mission s trmm multi satellite precipitation analysis tmpa data is used here the tmpa has been developed to provide best precipitation estimates across the globe huffman et al 2010 we use the monthly gridded 0 25 0 25 3b43 product version 7 which includes a combination of multiple satellite retrieval as well as rain gauge measurements from the global precipitation climatology centre gpcc archive huffman et al 2007 2010 as the in situ groundwater level measurements are available for four times a year precipitation data is processed for the four time periods december january february may june august and september november respectively 2 2 groundwater storage estimates using in situ groundwater level data seasonal in situ borehole hydrographs are obtained from 15 653 locations across india from central ground water board cgwb india between january 2005 and november 2013 cgwb has been maintaining an excellent groundwater monitoring network that started in 1969 cgwb 2014a as of march 2017 23 125 monitoring locations are operating across india cgwb 2017 within which 16 703 72 are dug wells cgwb 2017 a previous estimate show that the non pumping observation wells are mostly located in unconfined aquifers cgwb 2014a we compare groundwater levels obtained from continuous monitoring sensors to the cgwb data in some locations within the study area the two measurements compared well with each other we process the data for maintaining temporal continuity i e at least three seasonal data out of four should be available at a location in every year interquartile range iqr filter has been applied on the data to remove outliers davis 2002 reducing the total number of locations down to 3907 table 1 fig 1 groundwater level anomalies h are estimated by subtracting the mean water level depths from the entire time series 2005 2013 for individual water level time series data 2 3 usable groundwater storage ugws and specific yield aquifer thickness extends up to 700 m or more in unconsolidated sedimentary formations of the indus ganges brahmaputra igb river basin supplementary table 1 cgwb 2012 aquifers are found to be existing up to 600 m in consolidated permeable sedimentary formations supplementary table 1 cgwb 2012 fractured encountered data shows the exploration of fractures up to 291 m depth for groundwater utilization in the fractured formations supplementary table 1 cgwb 2012 occurrence of modern groundwater at a depth of 150 m has been reported in north west india lapworth et al 2015 macdonald et al 2016 restricted their study to the depth of 200 m due to scarcity of data in the igb basin the upper 300 m of the terrestrial ground has also been assumed as the maximum depth of aquifer responding to most of the anthropogenic groundwater activities mukherjee et al 2007 2011 for its aquifer mapping program cgwb also considered to map the subsurface features up to the maximum depth of 300 m cgwb 2013b in general water quality deteriorates beyond 300 m because groundwater at that depth has undergone extensive hydrogeochemical evolution and getting enriched in ionic concentration it is also a costly affair to drill at greater depths particularly beyond 300 m the energy usage for deeper groundwater exploitation is also higher therefore based on the available information we have considered the upper 300 m as the usable thickness of the aquifer the ugws is estimated by multiplying usable aquifer thickness and specific yield values at each of the selected wells the study area is characterized into 6 hydrogeological units unconsolidated sedimentary aquifers consolidated permeable sedimentary aquifers sedimentary aquitards folded metasediment metamorphic aquifers jointed crystalline aquifers and fractured crystalline aquifers bhanja et al 2016 2018b specific yield sy being the property of the medium varies from 0 02 to 0 44 across different geologic material bhanja et al 2018a ranges of sy for different hydrogeologic formations in india are obtained from cgwb 2012 and provided in supplementary table 1 long term pumping tests are conducted for estimating sy values gec 2009 mean sy values of the hydrogeologic units in india varying from 0 018 to 0 13 here we apply the sy values reported in bhanja et al 2016 the gridded specific yield values are assigned to each of the wells on the basis of their locations our major assumption is that the aquifers are homogeneous interconnected and unconfined up to 300 m gleeson et al 2015 indicates negligible change in porosity in different rock types up to 300 m depth macdonald et al 2016 and bonsor et al 2017 considered aquifer extension up to 200 m in igb basin cgwb reported 300 m depth of aquifers in some of the places in the study region cgwb 2012 mukherjee et al 2007 2011 reported aquifer extending up to 300 m in parts of the study area the depth beyond that might be contaminated with naturally occurring chemical contaminants mukherjee et al 2011 we prefer using sy over porosity for calculating the usable water volume as sy includes the amount of extractable water from aquifer material unlike porosity which depicts the pore fraction only within aquifer material 2 4 satellite based groundwater storage estimates we use 101 monthly 2005 2013 gridded 1 1 liquid water equivalent thickness lwet also known as terrestrial water storage tws from the national aeronautics and space administration nasa jet propulsion laboratory s jpl archive bhanja et al 2016 reported better performance of grace mascon products against grace spherical harmonics products for reproducing groundwater storage estimates using in situ groundwater storage measurements in india the recently released rl05 mascon solution are used in this analysis the entire globe is divided into 30 spherical mass concentration units having equal area in the mascon approach watkins et al 2015 several techniques have been applied on the data for estimating terrestrial water storage tws http grace jpl nasa gov data get data jpl global mascons accessed on 26 april 2016 satellite laser ranging data are used to replace degree 2 and order 0 coefficients cheng and tapley 2004 geo center corrections degree 1 coefficients are computed following swenson et al 2008 the process developed by geruo et al 2013 has been followed to remove the post glacial rebound signal in the data we have multiplied the scale factor provided with the data with the tws solutions for more representative tws solutions we use global land data assimilation system gldas rodell et al 2004 simulation outputs from the nasa archive for soil moisture sm and surface water sw equivalent estimates snow is not taken into consideration as the study region is not subjected to snow except for the himalayan sections surface water measurements are not available across india we use surface runoff from gldas outputs as a proxy for sw following asoka et al 2017 we use an ensemble of sm and sw from 3 different land surface models lsm community land model clm dai et al 2003 variable infiltration capacity vic liang et al 1994 1996 and noah chen et al 1996 koren et al 1999 the ensemble result is reported to provide best results than using individual lsm s output bhanja et al 2016 time series of anomalies of each of the components are obtained by removing all time mean from the individual data groundwater storage anomalies gws are computed after removing sm and sw from tws grace have been widely used across the globe for computing the gws change even at the places with very few or scarce observation data available the original resolution of grace based estimates is approximately 3 3 spatial resolution as it was designed for regional scale studies tapley et al 2004 although recent algorithm developments are facilitating higher resolution output at 1 1 spatial resolution watkins et al 2015 the user should be cautious upon using the data for the local scale studies i e local scale groundwater storage change impacted from anthropogenic activities 2 5 temporal downscaling of usable groundwater storage the in situ data are available for four times a year we also attempted to temporally downscale i e monthly the ugws data using monthly scale satellite based gws estimates bhanja et al 2017a have reported groundwater spatial variability in major river basins using the same groundwater level measurement database used in this study the spatial variability of the wells located within each state is calculated following the equations bhanja et al 2017a 1 n t 2 1 α 2 n 1 s 2 d 2 2 n t 2 1 α 2 n 1 e 2 c l 2 h d 2 where n is the total number of samples σ is the spatial variability within each state d is the user desired accuracy level absolute error t 2 1 α 2 n 1 representing the student s t distribution at the significance level α 5 used here λ is the extent c and h are the intercept and slope of the linear relationship between log spatial variability and log extent respectively in order to compute the spatial variability further analysis is performed for the 15 states with number of wells 50 table 1 finally 8 states are selected for further analyses using in situ data table 1 to compute satellite based ugws ugwssat we used linear regression analysis using independent variable ugws and dependent variable satellite based gwsa gwsasat between 2005 and 2013 as the ugws values are available four times a year gwsasat values are used for the corresponding time period of the groundwater measurements 3 gws a sat m ugws c the slope m and intercept c values from the regression analysis have been used further to transform gwsasat to ugwssat in the following way 4 ugw s sat gws a sat c m 2 6 assumptions and limitations the satellite based estimates are not advisable to use for smaller basins states due to coarser resolution of satellite based observations gwsa from individual wells are spatially averaged to provide state wide gwsa following bhanja et al 2017a and scanlon et al 2018 for basin wide average the spatial error associated with the spatial averaging is computed following eq 2 based on unavailability of data an uniform aquifer thickness is used through india future studies targeted to improve the ugws estimates should consider including high resolution aquifer thickness disaggregating the gwsa signal from twsa is a challenging task due to unavailability of observational data for all of the required components 3 results and discussions 3 1 estimation of groundwater storage availability table 1 shows detail of the states and number of wells used in ugws calculation spatial mean precipitation and spatial mean ugws values while comparing the ugws in the states with moderate data availability 50 wells the highest ugws values are observed in the states such as haryana uttar pradesh and assam respectively all of the three states are located in highly fertile basins of the indus ganges and brahmaputra rivers figs 2 and 3 in bhanja et al 2016 indicates the spatial distribution of unconsolidated semi consolidated and crystalline aquifer units across india although the state jammu and kashmir is comprised of a combination of unconsolidated and consolidated lithotypes the in situ observation wells fig 1 used in this study are mostly confined to the unconsolidated semi consolidated lithotypes figs 1 and 2 in bhanja et al 2016 this is the main reason for obtaining higher than expected ugws values in jammu and kashmir table 1 ugws values in southern and central indian states that are comprised of crystalline rocks are showing comparatively lower ugws values table 1 precipitation rates might not influence the total ugws magnitude for example haryana receives comparatively lower rainfall but subjected to the highest observed ugws values on the other hand madhya pradesh chhattisgarh and karnataka are receiving almost the twice of the amount of precipitation in comparison to haryana however exhibits much lower ugws values supplementary fig 2 shows state wise time series of spatial mean ugws between 2005 and 2013 ugws data shows strong seasonality with highest values in monsoon or in post monsoon season most of the states are experiencing a rise in water table after 2009 2010 2009 is the year of lowest rainfall in the country during the study period supplementary fig 3 shows time series of spatial mean precipitation and their hp trends between 2005 and 2013 precipitation data shows strong seasonality supplementary fig 3 it is interesting to note that we observe recent increasing trend of precipitation in most of the states supplementary fig 3 indicating dominance of anthropogenic influence on groundwater depletion in the states like assam haryana and odisha the three states experience continuous depletion in groundwater level supplementary fig 2 3 2 groundwater storage anomaly from satellite based estimations satellite based gwsa estimates gwsasat show development of intense groundwater depletion zones in the states located in parts of indus ganges and brahmaputra basins between 2005 and 2013 fig 2 the highly fertile alluvial formations are linked with intense irrigation linked groundwater withdrawal siebert et al 2010 while the central and south indian states are subjected to comparatively lower irrigation linked groundwater withdrawal leading to unchangeable to replenishing gws conditions over the years fig 2 greater depleting gwsasat trends 4 km3 yr are observed in rajasthan and uttar pradesh fig 3 these estimates are in line with results from the earlier studies conducted within the region rodell et al 2009 tiwari et al 2009 soni and hasan 2015 panda and wahr 2015 bhanja et al 2017b 3 3 trends in precipitation and groundwater storages the state wise trends of precipitation ugws and gwsasat values are shown in fig 3 we observe increasing precipitation trend in most of the states fig 3a with a few exceptions decreasing precipitation trends are observed in tamil nadu kerala and karnataka ugws trends indicate rapid depletion in assam fig 3b at a rate of 5 km3 yr fig 3b despite of overall increase in precipitation the state is also subjected to comparatively higher amount of total precipitation 2663 mm year table 1 similar observation has been found in haryana with increase in precipitation and depletion in groundwater storage ugws and gwsasat both of the estimates show replenishing trend in andhra pradesh maharashtra and tamil nadu between 2005 and 2013 although gws in tamil nadu exhibit depleting hp trend in recent years supplementary fig 2 the estimates are also consistent with published reports of cgwb cgwb 2013a 2014b 3 4 groundwater use in irrigation despite increase in total precipitation in assam rajasthan and uttar pradesh the reasons for observing highest ugws gwsasat are further investigated using groundwater irrigation data and the underlying cropping pattern over the years state wise net irrigated area and land use statistics data are obtained from the ministry of agriculture and farmer welfare govt of india open source data are retrieved from data gov in groundwater irrigated area gwia has been rapidly increased in assam within the study period supplementary fig 4a increase in gwia has also been observed in rajasthan and uttar pradesh supplementary figure 4b 4c the total water requirement by crops is studied as a fraction of the total cropped area of water intensive crops and the total cropped area the annual cropped area for six of the most water intensive crops waters 2004 i e rice wheat sugarcane fruits and vegetables f v soya bean and cotton are shown in fig 4 supplementary table 2 it is observed that the water intensive crops cover maximum fraction of the total cropped area in assam rajasthan and uttar pradesh fig 4 the percentage trend of cropped area coverage of the water intensive crops has been increased in recent years at the three states during the study period fig 4 it is important to note that cropped area associated with the two most water intensive crops cotton and rice has been rapidly increased in assam and rajasthan in 2005 2013 this would lead to comparatively faster depletion of water resources if continued at the ongoing rate 3 5 temporal downscaling of ugws using satellite based measurements widespread use of satellite based approaches for estimation of gws has been observed in india rodell et al 2009 tiwari et al 2009 soni and hasan 2015 bhanja et al 2016 panda and wahr 2015 bhanja et al 2017b however all of the studies report gws anomaly or change over the years here we attempt to estimate ugws from the satellite based measurements ugwssat for the 8 states which have sufficient in situ measurement locations see section 2 5 for details in order to get realistic estimates the states with statistically significant p values 0 05 relationship between ugws and gwssat are further selected for the analyses strong seasonality is observed in ugwssat values with maximum values during monsoon season fig 5 in general ugwssat matches well with the ugws data fig 5 ugwssat shows recent increasing trend in four of the five states studied fig 5 3 6 spatial variability of the groundwater storage anomaly ugws values are estimated after analyzing the groundwater level observations from the number of wells indicated in table 1 hence state s with comparatively lower number of observation wells will not exactly represent the actual condition in that state s we have also investigated the error level associated with the spatial averaging of the wells within the states fig 6 absolute error level is found to be within 2 cm gwsa anomaly in the all 15 states studied out of which it is 1 cm in the 6 states fig 6 the results show comparatively lower absolute error level on comparing the error estimates in the river basins within united states reported by li et al 2015 the magnitude of the error is found to be within 5 of the estimated gwsa estimates across the states 3 7 significance of the ugws calculation the widely used gws anomaly provides relative not absolute information on groundwater storage condition the intense data driven approach has leading to our robust estimation of groundwater depletion replenishment potential in indian states highest depletion potential has been observed in assam with more than 2 of their total ugws depletion during 2005 2013 fig 7 interestingly precipitation data shows increasing trend in assam during the period fig 3a this contrasting nature of ugws and precipitation in assam might be linked with higher rates of irrigation linked groundwater withdrawal net irrigated area using irrigation from tube wells has been increased from 9 thousand hectares in 2004 2005 to 74 thousand hectares in 2013 2014 groundwater irrigation data is retrieved from the ministry of agriculture farmers welfare govt of india source https eands dacnet nic in accessed on february 20 2017 water intensive cropping has also been increased manifold in assam in recent years fig 4 the situation is alarming in view of groundwater quality issues prevalent in the region mukherjee et al 2015 macdonald et al 2016 for example groundwater is contaminated with geogenic arsenic in parts of eastern and northeastern india mukherjee et al 2015 macdonald et al 2016 parts of western and southern india are subjected to fluoride contamination in groundwater mukherjee et al 2015 parts of northwest western and southern india are linked with higher groundwater salinity mukherjee et al 2015 macdonald et al 2016 on the other hand andhra pradesh and jharkhand are experiencing the highest replenishment potential the concept can be applied in other parts of the globe for proper application of groundwater resource management 4 conclusions in this study we investigate groundwater storage changes in all of the major indian states using in situ n 3907 and satellite based measurements during the period of 2005 2013 in situ data are used to compute the usable groundwater storage ugws across the indian states in order to provide representative estimates we select only those states with sufficient density of in situ monitoring wells ugws data show greater depletion in assam at a rate of 6 66 km3 year in 2005 2013 satellite based gws estimates indicate greater depletion zones that are developed in parts of punjab haryana uttar pradesh bihar and west bengal groundwater storage shows replenishing trend in andhra pradesh maharashtra gujarat tamil nadu and chhattisgarh precipitation rates are showing increasing trend in most of the states even in the states of highest groundwater depletion substantial groundwater withdrawal linked with irrigation also indicates increasing trend in assam rajasthan and uttar pradesh the three states with the highest groundwater depletion in the study period water intensive cropping pattern linked with the prevalence of water intensive crops with 50 occurrence further influence the scenario in the three states we also attempt to temporally downscale the seasonal ugws estimates using monthly satellite based measurements the ugws calculations enable us to compute the changes in total usable water storage and also provide the quantity of usable groundwater available for future use this would provide a distinct picture of groundwater availability rather than the groundwater storage anomalies the approach could be used in other parts of the globe for quantification of groundwater storage availability acknowledgments and data snb acknowledges csir india for their support through spm fellowship this manuscript uses freely available data of the central ground water board cgwb government of india weblink http www india wris nrsc gov in gwl gwl html utype r2vuzxjhba uname accessed on june 20 2017 the opinion expressed in the paper is of authors own and not of the affiliated department we acknowledge cgwb india for providing water level data grace land data were processed by sean swenson supported by the nasa measures program and are available at http grace jpl nasa gov the gldas data used in this study were acquired as part of the mission of nasa s earth science division and archived and distributed by the goddard earth sciences ges data and information services center disc the trmm data has been obtained from nasa archive groundwater water irrigation data are retrieved from the ministry of agriculture farmers welfare govt of india source https eands dacnet nic in accessed on february 20 2017 we acknowledge dr dipankar saha cgwb we would also like to thank the editor prof paolo d odorico and the three anonymous reviewers for their constructive comments and suggestions supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2019 02 001 appendix supplementary materials image application 1 image application 2 
683,short term precipitation forecasts from numerical weather prediction models are a vital source of information for real time flood forecasting systems previous studies show that assimilation of doppler weather radar dwr observations significantly improves the forecast skill of short term precipitation however the variational assimilation methods used for dwr assimilation are sensitive to the selection of control variable options in background error statistics in this study the impact of control variable choices in assimilating dwr observations for improving the forecast of heavy rainfall event is analysed for this purpose radar reflectivity and radial velocity observations are assimilated using stream function velocity potential ψχ and horizontal wind components uv control variable options in weather research and forecast model 3dvar three dimensional variational assimilation system the results show that dwr assimilation using uv control variable option has improved the skill of first 12 h of high intensity precipitation forecasts keywords radar data assimilation 3dvar background error statistics wrf control variables 1 introduction in the last five decades india is facing a continuous rise in flood disaster with an average of 3 floods per year during 2005 2015 an annual average of 1700 people has lost their lives due to the occurrence of flood disasters tripathi 2015 one of the primary reasons for such floods is due to the increase of extreme rain events over india roxy et al 2017 forecasting of such high intensity precipitation on a time scale of minutes to hours has immense benefits such as saving lives protecting economic assets and improving quality of life with the advancement in technology numerical weather prediction nwp models are currently used in short range precipitation forecasts the nwp models generally perform well in predicting frontal precipitations compared to convective precipitation forecasts olson et al 1995 in addition to that nwp model have limited skill in forecasting convective type precipitation over tropics koh and ng 2009 krishnamurti et al 1999 one of the major reasons for the poorest performance of nwp models in convective precipitation forecast is due to its sensitivity towards initial conditions jee and kim 2017 hence the predictability of convective precipitation can be improved by supplying the best possible initial conditions to the nwp model the uncertainty in the initial conditions can be reduced using data assimilation techniques which combines the available observations with nwp product background and their respective error statistics to provide an improved estimate of the atmospheric state ide et al 1997 commonly used data assimilation da methods are optimal interpolation methods the three dimensional 3dvar barker et al 2004 skamarock and klemp 2008 four dimensional variational 4dvar dimet and talagrand 1986 lewis and derber 1985 and kalman filter evensen 1994 approaches among these methods 3dvar is most commonly used for assimilation because of its practicability regarding computational efficiency sugimoto et al 2009 most of the operational centres focus on assimilation of conventional observations in their 3dvar assimilation systems to improve the initial state of mesoscale or microscale convective systems xiao and sun 2007 since conventional observations are too sparse da using these can only represent large scale dynamics structures in the analysis initial condition supplied to the nwp model tong et al 2016 however for forecasting convective precipitation a better description of small scale dynamic and thermodynamic structures in the initial conditions are essential li et al 2016 which can be achieved by assimilating high resolution and denser observations like doppler weather radar dwr observations dwr has the unique capability of sampling the atmosphere with high spatial and temporal resolution thereby providing detailed information about the wind and hydrometeor structures inside a convective weather system several studies have shown that assimilation of dwr data into nwp model improves the convective precipitation forecasts through better representation of mesoscale structure in the initial condition supplied to the model chung et al 2009 honda et al 2006 hu et al 2006 lindskog et al 2004 macpherson et al 2004 montmerle et al 2001 rennie et al 2011 sun et al 2010 sun and crook 2001 tai et al 2011 weygandt et al 2002 studies that focus on radar data assimilation into nwp models started to appear during the last decade sun et al 1991 were the first to design a radar data assimilation system known as variational doppler radar analysis system vdras operating on a four dimensional variational data assimilation method it was expanded by sun and crook 1998 to include microphysical retrievals and was used for short term forecast initialisation later xiao et al 2005 and xiao and sun 2007 developed operators for radial velocity and reflectivity data in the fifth generation mesoscale model mm5 model and showed that continuous assimilation of radar data for every three hours was essential for improving the forecast of heavy rainfall events the positive results obtained from these studies motivated the development of radar data assimilation scheme in wrf da system of the arw wrf community model in 2012 sun et al extended the radar variational analysis scheme of wrf da by adding the four dimensional variational analysis system to it li et al 2012 assimilated radar radial velocity data with wrf hybrid ensemble 3dvar system for prediction of hurricane ike an alternative strategy for assimilating radar data is ensemble kalman filter enkf evensen 1994 the enkf is a sequential assimilation method which improves the models initial conditions by processing a set of observations during a forward integration of an ensemble of model states dowell et al 2004 snyder and zhang 2003 were the first to explore the possibility of assimilating simulated radial velocity observations using enkf following their work caya et al 2005 gao and xue 2008 lange and craig 2014 sobash and stensrud 2013 tong and xue 2004 and xue et al 2006 tested both simulated radial velocity and reflectivity observations using enkf dowell et al 2004 were the first to assimilate real radar observations using enkf studies by chang et al 2014 dowell and wicker 2009 snook et al 2011 zhang et al 2009 have analysed the impact of real radial velocity observations using enkf system aksoy et al 2009 dong et al 2011 dong and xue 2013 snook et al 2015 further analysed the potential of using both real reflectivity and radial velocity observations in an enkf based assimilation system a few studies on the impact of radar data assimilation on forecasting precipitation were also performed for the indian region routray et al 2013 2010 noted that the assimilation of dwr radial velocity and reflectivity helped to improve predictions associated with monsoon depression forecasts for the indian region govindankutty et al 2010 demonstrated the positive impact of dwr radial wind and gts data on the intensity and spatial rainfall distribution of landfalling tropical cyclones abhilash et al 2012 showed improvement in short range forecasting of convective storms by assimilation of dwr radial velocity and reflectivity observations in the wrf 3dvar system osuri et al 2015 improved prediction of bay of bengal tropical cyclones through assimilation of dwr observations using the wrf 3dvar system although radar assimilation has been widely used in improving precipitation forecasts the impact of background error covariance matrix b on variational based radar assimilation methods has not been thoroughly investigated however the background error statistics play a significant role in spreading observations thereby influencing the analysis state of the atmosphere on the other hand the larger dimension of the b matrix 107 107 makes it difficult to model in order to avoid the explicit computation of inversed b matrix control variable preconditioning is usually applied however the choice of control variables alters the entire structure of the b matrix thereby altering the assimilation results descombes et al 2015 xie and macdonald 2012 two different options of control variables are usually used in regional models they are 1 stream function ψ and velocity potential χ 2 wind u and meridional wind v among these two control variable pairs ψχ is the most commonly used option in operational models tong et al 2016 uv control variables have also been used in various studies gao et al 1999 sun and crook 1997 zou 1997 which mainly focus on convective scale events a recent study by sun et al 2016 compared the control variables of ψχ with that of uv in the 3dvar system and concluded that uv pair performed better than the cx pair for limited area convection scale data assimilation they also found that the uv control variables provide a closer fit to radial velocity observations thereby improving the prediction of short term convective type precipitation forecasts in the study by sun et al 2016 indirect assimilation of radar reflectivity was performed to improve the skill of precipitation forecast using uv control variables the role of control variables in direct assimilation of reflectivity is yet to be explored studies related to the influence of control variables in affecting the prediction skill of weather systems has not been well documented over indian context also most of the dwr assimilation studies over indian regions are mainly focused on the simulation of tropical cyclones using ψχ control variables in a 3dvar system there is a dearth of research using dwr assimilation for convective scale precipitation forecasts over indian regions it is further hindered by the lack of studies on the sensitivity of dwr data to background error statistics bes in the current study we have investigated the role of control variables in forecasting a localised heavy rainfall event through direct assimilation of indian dwr reflectivity and radial velocity the primary objective of the present study is to analyse the impact of different control variables in assimilating dwr data for a convective scale event for this background error statistics generated using two control variable pairs ψχ and uv are used in the assimilation of radar data for predicting an extreme rainfall event occurred in chennai and its surrounding areas on 01 december 2015 indian meteorological department has recorded a widely distributed rainfall of 218 mm over the city which resulted in the inundation of low lying areas human causalities and deaths boyaj et al 2017 it was the eighth most expensive natural disaster to have hit the world in 2015 causing damages and losses ranging from 7 to 15 billion us veerasingam et al 2016 the paper is organised as follows the wrf model and its observation operators for assimilating doppler reflectivity and radial velocity data are described in section 2 the case study including model physics background error statistics generation and pre processing of radar data are introduced in section 3 in section 4 the design of the data assimilation and numerical forecast experiments are discussed the results and discussions are presented in sections 5 and 6 summarises the conclusions 2 a brief description of wrfda radar data assimilation system 2 1 wrfda 3dvar assimilation system advanced research weather research and forecast arw wrf model version 3 8 is used in this study for performing mesoscale simulations and data assimilation numerical experiments wrf is a non hydrostatic primitive equation mesoscale meteorological model with advanced dynamics physics and numerical schemes the data assimilation is performed using wrf 3dvar version 3 8 a variational data assimilation system developed for the wrf model wrf 3dvar system developed by barker et al 2004 employs incremental variational formulation courtier et al 1994 the main goal of the wrf 3dvar system is to produce a better initial condition to the wrf model through an iterative solution of a prescribed cost function ide et al 1997 1 j 1 2 x x b t b 1 x x b 1 2 y 0 h x t r 1 y 0 h x where vectors y0 xb x represents observation background and analysis variables respectively error covariance matrices for observation and background are denoted by r and b respectively the cost function produces an optimum comparison between the prior estimation of analysis field and observations weighted by their respective error covariance the observation operator h is used to map variables from model space to observation space generally r is assumed to be diagonal which means that the assimilated observations are independent of one another in practice the spatial and temporal correlation between high resolution observations are still possible thinning of high resolution observations are often performed in operational practices and it one of the efficient way to reduce the effective cross correlation liu and rabier 2002 the iterative minimisation process of the cost function is performed in a pre conditioned control variable space due to the large size of the b matrix 107 107 the major advantage of reducing the cost function in this space is that when the background fields are represented in the control variable space its errors are uncorrelated and the variances are of a unit size which in turn reduces the computation time to a greater extent the cost function defined using incremental formulation is given by 2 j 1 2 v t v 1 2 d h uv t r 1 d h uv where vector d y0 h xb is the innovation vector which measures the departure of observation from the background xb v is the control variable with the assumption uv x xb and h is the linearization operator for the nonlinear observation operator h the matrix u is a decomposition of b matrix and it consists of a series of operations barker et al 2004 upuvuh uv uh matrices define the vertical and horizontal auto correlation of the control variables and they are modelled through the application of empirical orthogonal functions eofs and recursive filters purser et al 2003 respectively the recursive filter used in this study consists of two parameters namely the correlation length scale s of the filter and the number of applications n of the filter the recursive filter rf is given with an initial condition aj at grid point j a single pass of the recursive filter consists of an initial smoothing from left to right c j α c j 1 1 α a j j 1 2 j followed by a pass from right to left d j α d j 1 1 α c j j j 2 1 where α 1 e e e 2 e n δ x 2 4 s 2 the length scale values s at each model level are estimated using the nmc method the up matrix converts the increments from control variable space to model variable space 2 2 assimilation of radial velocity and reflectivity data the radial velocity data and reflectivity data from dwr observation can be assimilated into the wrf variational assimilation system using their respective observation operator formulated by xiao et al 2005 xiao and sun 2007 for radar data assimilation the total water mixing ratio qt is chosen as the moisture control variable instead of pseudo relative humidity a warm rain parameterisation dudhia 1989 has been used to partition the moisture and water hydrometeor increments in the control variable space thereby establishing a relationship between rainwater qr cloud water qc moisture qv and temperature the reflectivity observation operator used in the variational assimilation system is shown in eq 3 and it is used to calculate model derived reflectivity from the rainwater mixing ratio 3 z 43 1 17 5 log ρ q r where z is the model derived reflectivity and ρ is the density of air the above relation is derived analytically by assuming the marshall palmer distribution of raindrop size sun and crook 1998 for radial velocity assimilation the model derived radial velocity is generated using the model predicted three dimensional wind field and rainwater mixing ratio qr the radial velocity operator used in the assimilation system is shown in eq 4 4 v r u x x i r i v y y i r i w v t z z i r i where u v w are the wind components x y z are the radar location xi yi zi are the location of the radar observation ri is the distance between radar and observation and vt is the terminal velocity the terminal velocity can be calculated from the algorithm of sun and crook 1998 and it is given by 5 v t 5 40 α q r 0 125 where qr is the rainwater mixing ratio the quantity α is a correction factor defined by 6 α p 0 p 0 4 where p is the base state pressure and p0 is the pressure at ground level 3 case study and model setup the case used in this study is a heavy rainfall event which occurred in the chennai city from 30 november to 2 december 2015 the city experienced extreme flooding and causalities during this event the propagation of convective systems from the west pacific ocean to the indian ocean chakraborty 2016 in coalition with local convective activity from warming of southern bay of bengal boyaj et al 2017 caused this heavy rainfall the convective systems were guided northward towards indian land region by two highs of mid troposphere situated in the east and west of the indian region the high to the east was due to the effect of el nino and that in the west was associated with a global shift of upper tropospheric rossby wave chakraborty 2016 boyaj et al 2017 found out that warming of the southern bay of bengal also played an equal role in increasing the intensity of the extreme rainfall event to understand the meteorological evolution of this extreme event at convective scale and also to improve the quantitative precipitation forecasts da experiments have been carried out on a single domain with a horizontal spacing of 10 km covering the south peninsular indian region and it is surrounding oceans fig 1 a shows the model domain used for the experiments the model is initialised using the global forecast system gfs data and the boundary conditions are updated at a 6 h interval fig 1b shows the 51 eta levels and its corresponding pressure levels with the model top pressure set at 10 hpa the parameterizations used in the wrf forecast include kessler scheme kessler 1969 betts miller janjic scheme cumulus parameterisation scheme janjić 1994 the yonsei university planetary scheme for the planetary boundary layer hong et al 2006 the rapid radiative transfer model longwave radiation mlawer et al 1997 the dudhia shortwave radiation scheme dudhia 1989 other physics options include the monin obukhov scheme monin and obukhov 1954 for the description of the surface layer and the unified noah land surface model tewari et al 2004 to present the land surface physics the combination of parameterisation schemes was chosen based on an extensive sensitivity analysis due to computational constraints we have limited this study to a single extreme event 3 1 generation of background error statistics the performance of variational da majorly depends on the background error statistics bes because the statistics contain valuable information about the spreading of observation information in model space and also determines how the final analysis is physically balanced sugimoto et al 2009 national meteorological centre nmc method parrish and derber 1992 is one of the most commonly used methods to calculate domain specific background error statistics bes the nmc method approximates the structure of matrix b through the statistical difference between 24 h and 12 h forecasts from a regional model the nmc based background error statistics is given by b x b x t x b x t t x t 24 x t 12 x t 24 x t 12 t where x b represents the atmospheric state of the model x t denotes the true atmospheric state x t 24 x t 12 represents the 24 h and 12 h forecasts from a regional model respectively in this study the wrf regional model was run for november 2015 to produce 12 h and 24 h forecasts at 0000 utc and 1200 utc then the background error statistics are generated by averaging the forecasts differences valid at the same hour using gen be utility program for the present study two different types of background error statistics are considered in the assimilation cycle they are generated using two different set of momentum control variables ψχ and uv which are named as cv ψχ and cv uv respectively following the calculation of bes single observation tests are performed on the two different bes at the centre of the domain using perturbed u wind the single observation tests help in providing information about the spread of calculated background error 3 2 pre processing of radar data pre processing of dwr data is a major step to be performed before data assimilation dwr pre processing includes coordinate conversion thinning of radar data to model resolution and finally quality control of the data dwr data is usually available in the polar coordinate system in which the data points are represented in azimuth range and elevation transforming the data points to cartesian coordinates is accomplished using equations given by doviak and zrnić 1993 the equations are given below the height of data points are calculated using the equation 7 h r sin θ r 2 2 r e where h is the height of the data point θ represents elevation angle r is the slant range distance and re is the radius of the earth the location of data points are calculated below latitude 8 λ λ r 180 π α cos φ longitude 9 ϕ ϕ r 180 π sin 1 sin φ sin s 2 r e cos λ π 180 range bin 10 s 2 4 3 r e sin 1 s cos θ 4 3 r e h r 11 α s 2 r e 12 s s 1 δ s n where λ r ϕ r are radar latitude and longitude φ is the azimuth angle in radians hr is the height of the radar and s1 is the size of first range bin the geo located data are thinned to a regular cartesian grid of 10 km model resolution using the method by abhilash et al 2012 thinning of radar observations reduces the effective cross correlation resulting in diagonal observation error covariance matrix even though thinning of radar data results in loss of information the effect of considering cross correlated observation error covariance matrix in indian dwr assimilation is a subject for further investigation in this study the observations error for radial velocity and reflectivity were set as 1 ms 1 and 1 dbz respectively in 2010 cheung and chan used the same set of observational error values to improve the prediction skill in the wind and rain fields we have removed the unwanted echoes and the non precipitation echoes by the interactive editing of radar echoes finally the quality controlled dwr data are written in wrfda acceptable ascii format in this study three sets of chennai dwr data from 06 utc of 30 november 2015 to 18 utc of 01 december 2015 with 6 hourly interval are pre processed and assimilated into the wrf 3dvar 4 experimental design four experiments namely control radar ψχ radar uv gts were designed detail description of the experiments is outlined in table 1 in the control experiment gfs data at 0 5 0 5 horizontal resolution produced by the national centres for environmental prediction ncep ftp nomads ncdc noaa gov gfs grid4 is used as an initial condition at 00 utc of 30 november 2015 and the model was integrated without any data assimilation for 48 h forecast starting at 00 utc of 30 november 2015 the second experiment radar ψχ was based on the assimilation of quality controlled conventional observations surface and radiosonde observations from global telecommunication system chennai doppler weather radar dwr radial velocity and reflectivity observations at 6 h cycle from 0600 utc of 30 november 2015 to 1800 utc of 30 november 2015 in wrf 3dvar system using ψχ as control variables before starting the assimilation process the model was spun up for 6 h with the initial condition from gfs at 00 utc of 30 november 2015 in the 6 h 3dvar update cycle the 6 h forecast from the previous cycle serves as background for the next cycle a total of three cycles from 0600 utc of 30 november 2015 to 1800 utc of 30 november 2015 were performed to improve the initial condition supplied to the model with the improved initial condition the model was integrated to provide 30 h forecast up to 0000 utc on 02 december 2015 for comparison purposes radar uv experiment assimilates the same data as radar ψχ experiment except it uses background error statistics with uv as control variables in the 3dvar system in order to highlight the contribution of radar data assimilation with uv control variable from conventional observations assimilation gts experiment is conducted in the gts experiment only quality controlled conventional observations are assimilated using uv control variable options 5 results and discussion 5 1 background error statistics comparison in the variational da methods the dimensions of matrix b are usually too large to be explicitly determined descombes et al 2015 hence the b matrix is modelled using a series of operators like vertical horizontal and physical transforms with homogeneous and isotropic assumptions barker et al 2004 in this study the empirical orthogonal function eof decomposition is used for defining the vertical variations in the control variables in eof decomposition the eigenvectors model the vertical transform and their associated eigenvalues represent the variance in order to represent the horizontal transform the length scale is estimated in the eof space through the application of recursive filter hayden and purser 1995 during the da process the recursive filter spreads out the eigenvalues weighted analysis increment in the eof space according to length scale value then the physical space transformation from eof mode is performed to spread out the information vertically fig 2 shows the variance and length scale of background error statistics for both the control variable options ψχ uv since the control variable options are derived based on homogeneous and isotropic assumptions they vary only with height the fig 2a shows the horizontal length scales of ψ χu u and v it can be noted that the length scales values of ψ and χu ranges from 330 km to 150 km for the first 20 modes whereas for u and v control variables the length scale value ranges from 90 km to 30 km for the first 20 modes this clearly shows that u and v have relatively smaller length scales compared to that of χ and ψu which means u and v represent more local features within a small radius of influence hence during data assimilation the analysis increment from u and v control variables will remain closer to the observations whereas the analysis increment from ψ and χu will be smoother and have a larger radius of influence to analyse the variance of background error statistics bes derived using two different control variable options eigenvalues are plotted to vertical modes fig 2b shows the normalised eigenvalue plots of ψ χu u and v from ψχ and uv respectively wherein the eigenvalues are normalised for the ease of plotting it can be observed from the fig 2b that the eigenvalues of u and v are greater than ψ and χu which indicates that u and v control variables pair captures the maximum variance when compared to the other two control variables in eof space it is further supported by fig 2c which shows the ratio between ψ or χu and u the ratio plot shows that the value decreases with increasing modes which states that the variance of u is greater in the first 20 modes the overall results from both length scale and eigenvalue plots show that background error statistics generated using uv control variable option has larger variance and smaller length scale which are consistent with previous results sun et al 2016 the results confirm that the use of uv control variable option in da helps to capture small scale structures in the analysis 5 2 single observation test in order to analyse the effect of momentum control variables ψχ and uv in physical space two single observation tests are performed the first single observation test involve the use of ψχ control variables and the second test uses uv as the control variables in both single observation tests a single perturbed wind observation with the innovation of 1 ms 1 is placed on the 19th model level in the centre of the domain 11 n 81 e and the wrf 3dvar system was run accordingly with their respective control variable options ψχ uv the analysis increment results from ψχ bes generated using ψχ control variables and uv bes generated using uv control variables show different u increment due to different background error covariance matrices the series of plots fig 3 show the comparison of vertical x z horizontal x y slices and profiles of resulting u increments from all single observation tests it can be observed from the x z plane plot fig 3a and c that the area of increment is much larger for radar ψχ tests when compared to that radar uv tests in terms of horizontal spread a horizontal cross section of increment values at a 19th model level x y plot for both the tests are shown in fig 3b and d it can be observed that single observation tests with uv as control variables show higher magnitude and smaller spatial spread of increment fig 3d when compared to its counterpart experiment fig 3b this is due to the larger length scale of ψχ background error statistics as observed in fig 2a it is also observed that ψχ control variables produce nonphysical negative increment around the assimilated single u wind observation fig 3b previous studies li et al 2016 sun et al 2016 xie and macdonald 2012 have shown similar nonphysical error outside the observation region with use of ψχ control variables if a radial wind observation is assimilated using ψχ these negative increments will cause an unrealistic local divergence and convergence on the other hand for uv control variables the single observation test shows a consistent wind increment around the u wind observation fig 3d an isotropic response has also been observed for all the tests the increment profile in fig 3e shows the smoothing effect of increments with the use of ψχ control variables it also shows that assimilation of observation using uv as control variable option results in larger magnitude and smaller spread of increments when compared to ψχ 5 3 verification against conventional observations fig 4 shows the domain averaged root mean square error rmse from the five experiments for zonal wind meridional wind temperature and specific humidity averaged over the assimilation cycles the rmses are calculated against the available observations synoptic and radiosonde and forecasts of all the experiments from 00 utc of 01 december 2015 to 00 utc of 02 december 2015 it has been observed from fig 4a and b that radar uv experiment shows 20 30 reduction in wind rmse when compared to other experiments this clearly shows that assimilation of radar data using control variables uv improves the wind forecasts significantly when compared to the usage of ψχ control variables especially at lower pressure levels for temperature and specific humidity fig 4c and d the radar uv experiment agrees best with the observations at all the pressure levels compared to other experiments fig 5 shows the time series of surface rmses from 00 utc of 01 december 2015 to 00 utc of 02 december 2015 clearly the assimilation experiment with uv control variables shows a reduced surface rmse value when compared to the experiments with ψχ control variables among all the experiments the radar uv shows better fit to the observation with 10 30 reduction in surface wind rmse values fig 5a and b during first 18 h of forecast and 15 20 reduction in 2 m temperature fig 5c rmse values overall it is found that assimilation of radar data with uv control variable option significantly reduces the forecast error for both the surface and upper atmospheric model variables 5 4 vertically integrated moisture transport and wind field forecasts the impacts of control variables on the vertically integrated moisture transport vimt and wind fields are explored the wind forecast at 850 hpa and vimt provides information about the source of moisture and the mechanism through which the moisture is transported fig 6 shows the wind forecast at 850 hpa from all the experiments at synoptic hours in all the experiments a short lived cyclonic wind circulation pattern can be seen in the northern part of indian ocean from 30 nov 00 utc to 01 dec 18 utc the pattern is due to the intensification of the convective system over the warm indian ocean as reported by chakraborty 2016 even though the circulation pattern is simulated in all the experiments radar uv shows a stronger wind speed of 20 ms 1 as compared to other experiments fig 6k o also from fig 6p t it is noticed that the assimilation of radar with ψχ control variable weakens the wind speed by 50 and also fails to capture the circulation pattern during the initial forecast hours fig 6p q when compared to other experiments the radar uv experiment shows higher spread and magnitude of wind 15 20 ms 1 on both land and oceanic regions the vimt plots in fig 7 indicates that the moisture from both bay of bengal and indian ocean have contributed to the extreme precipitation over the south east coast of india it can also be seen from fig 7 that most of the moisture contribution comes from the bay of bengal this is due to the increase in sea surface temperature sst over the southern bay of bengal making it favourable for deep convection as pointed out by boyaj et al 2017 it is evident from fig 7k o that assimilation of both reflectivity and radial velocity with uv as control variables in a 3dvar assimilation system resulted in higher convergence of moisture with a maximum vimt value of 6 8 kgm 1s 1 compared to other numerical experiments among all the experiments radar ψχ fig 7p t shows very low convergence of moisture with maximum vimt values ranging from 4 to 5 kgm 1s 1 it is also interesting to note that in radar uv experiment very high precipitation values are observed fig 8 over the similar regions of higher vimt values the increased vimt values are the likely reason for increased high intensity precipitation the above analyses clearly show that assimilation of both radial velocity and reflectivity data plays a key role in modifying the low level winds and moisture flux variables 5 5 spatial verification of precipitation over radar region to verify the spatial spread of rainfall the model simulated precipitation results from the four experiments are compared with gpm precipitations in this study gpm accumulated precipitation is used for spatial pattern and intensity verification of precipitation because it is the only available high resolution gridded rainfall data over the indian sub continent six hourly accumulated precipitation calculated using gpm imerg final product representing a half hour span and 0 1 0 1 spatial resolution is used for comparison imerg is one of the gpm products gpm atbd 2015 which provides a multi satellite accurate rain rate estimate over indian region krishna et al 2017 fig 8 shows a zoomed snapshot of the 6 h accumulated rainfall from control radar uv radar ψχ and gts experiments in comparison with gpm rainfall observations at 06 utc two precipitation patterns over land and ocean regions with maximum precipitation of 120 mm are observed fig 8q a careful examination indicates that the radar uv experiment s fig 8i simulated precipitation matches with the observed high intensity precipitation amount and spread by more than 50 whereas in other experiments the precipitation pattern and amount are poorly simulated with 10 20 of the high intensity region being captured this is due to the better convergence of wind and moisture flux in the radar uv experiment as mentioned previously in figs 6k and 7k at 12 utc a north south oriented rain band along the eastern coastline with the highest intensity of 80 mm is observed fig 8r among the four experiments the radar uv experiment fig 8j roughly matches the observed vertically oriented rain band whereas in other experiments the precipitation pattern and amounts are poorly predicted at 18 utc the observed precipitation has very high intensity over the land region with a larger spread fig 8s in control and gts experiments fig 8c and g the structures are captured to some extent while the intensity is relatively weak also radar ψχ experiment fig 8o shows an unrealistic rain band with the precipitation pattern and amounts being poorly simulated due to the substantial lack of moisture convergence figs 6s 7s on the other hand the radar uv fig 8k correctly simulates the high intensity precipitation regions at 24 utc rain bands with the highest intensity of about 40 mm are observed extending from land to the ocean fig 8t in comparison with the observed all the experiments except radar ψχ fig 8p showed an overestimated precipitation pattern shifted in the northeast direction the precipitation forecast error is found to increase rapidly with an increase in lead time overall it is seen that the rainfall forecast from radar uv experiment possesses better patterns compared to other experiments around the radar range of coverage with the improved convergence of wind and moisture fluxes 5 6 statistical verification of precipitation forecasts to analyse the effect of radar data assimilation on high intensity precipitation forecasts statistical verifications scores such as hit rate hr false alarm ratio far equitable threat score ets and fractional skill score fss were performed the hr also known as the probability of detection measures the fraction of observed events that were correctly forecasted far refers to the fraction of forecast events that do not occur and ets measures the fraction of observed events that were correctly predicted also accounting for the hits that would have been occurred due to random chance the fss introduced by roberts and lean 2008 is a neighbourhood based method which describes the fraction of observed events within a square neighbourhood centred around each pixel higher values of hr ets fss and lower values of far indicate better forecast skill the gpm 6 h accumulated precipitation with intensity above 60 mm 10 mm h is used for statistical verification against wrf six hour accumulated precipitation forecast to concentrate on forecast skill of extremely heavy precipitation we have chosen 10 mm h 60 mm for 6 h accumulated precipitation threshold defined by indian metrological department imd for verification fig 9 depicts the statistical verification scores of the five experiments from 00 utc of 01 december 2015 to 00 utc of 02 december 2015 it can be noticed from the hit rate line graph fig 10a that the radar uv experiment has the highest hit rate till 12 utc of 01 december 2015 whereas other experiments have the lowest hit rate a comparison between radar uv and radar ψχ experiments shows a 50 to 90 increase in hit rate in the radar uv experiment when the far fig 9b between radar ψχ and radar uv are compared it is seen that the implementation of uv control variables in radar data assimilation have reduced the false alarm up to 30 in addition the radar uv experiment shows a similar pattern to the hit rate with a low far value up to 12 utc when comparing the ets scores fig 9c the radar uv experiment shows the highest predictability till 12 utc and it gradually decreases as the forecast time goes on a similar pattern of decreasing predictability is also visible in the radar ψχ experiment the decreasing effect of radar data assimilation in the localisation of heavy precipitation with increasing lead time is due to the phenomenon that the influence of the radar data assimilation increments on total precipitation is forgotten over a couple of hours as the convection returns to its unperturbed equilibrium state craig et al 2012 the ets score also shows that the radar uv experiment exhibit a higher skill compared to the radar ψχ experiment for the whole forecast period fig 9d shows the fss boxplots for all the experiments over the forecast period each experiment s box plot in fig 9d describes their respective distribution of fss scores for the entire forecast hours the fss values of the 6 h accumulated precipitation are calculated using a 20 km radius of influence with a threshold of 10 mm h it can be seen that average fss scores of radar uv experiments are higher as compared to other experiments also the fss score indicates that the assimilation of radar data with ψχ as control variable option decreases the precipitation forecast skill overall the objective statistical scores represent a worthwhile improvement in high intensity precipitation forecast from the assimilation of radar data using uv control variables 6 conclusion this study evaluates the impact of background error statistics of two momentum control variable options in wrf 3dvar stream function velocity potential ψχ and zonal meridional winds uv radar data assimilation system for a convective high rainfall event occurred in chennai the background error statistics are derived from a 24 h and 12 h forecast differences valid at the same time generated by 10 km wrf real time forecasts during november 2015 over peninsular india using the nmc method by comparing the error statistics of ψχ and uv it has been observed that uv control variables capture the maximum variance when compared to the ψχ control variables it also shows that the horizontal length scale of ψχ is larger than that of uv the smaller length scale and larger variance from uv control variables produce analysis increments that tend to capture small scale features a single observation test was also performed to evaluate the characteristics of two momentum control variable options in the assimilation of zonal wind the results highlight that the use of uv control variables produce large magnitude and small horizontal spread increment when compared to the ψχ control variables using the two bes ψχ uv twin radar data assimilation experiments radar uv radar ψχ along with free forecast control and conventional observation gts assimilation experiments were performed forecasts from all the experiments are verified against synoptic and radiosonde observations significant reduction in the rmse values of both zonal and meridional wind is found in the radar uv experiment at all pressure levels when compared to other experiments for temperature and specific humidity forecast the radar uv experiment showed a reduction in rmse values at all pressure in addition to that 10 30 reduction in surface wind rmse and 15 20 reduction in 2 m temperature rmse were also observed in the radar uv experiment forecast verification using station observations showed that the model forecast variables are better forecasted in the radar data assimilation experiment using uv control variables in comparison with other experiments the impacts of control variables on the vertically integrated moisture transport vimt and wind fields forecast were also analyzed it has been observed that the use of uv control variables in a 3dvar radar data assimilation improves the wind speed and moisture convergence in the case of other experiments low wind speed and moisture flux were observed to understand the role of control variables in improving the qpf the spatial distribution and intensity of the rainfall were compared with gpm imerg 6 h accumulated precipitation it is found that the radar data assimilation experiment using uv control variables in the 3dvar assimilation system produces a better rainband structure of high intensity precipitation on statistical verification of very high intensity precipitation 10 mm h it is observed that radar uv experiment shows a higher hit rate equitable threat score and lower false alarm ratio than the other experiments during the initial 12 h of forecast lead time respectively among all the experiments radar ψχ experiment shows a lower predictability skill of high intensity precipitation for all forecast hours it has also been observed from the radar experiments that the forecast skill for precipitation decreases with the increasing lead time whereas the control experiment provides improved skill score as forecast period advances however in the case of designing nowcasting better forecast skill is mandatory at the initial forecast hour which the control experiment fails to satisfy the fss score for the whole forecast period also shows that radar uv experiments outperform all other experiments this study is an initial assessment of utilizing indian dwr data into a regional model for prediction of high intensity convective precipitation using different control variables in the background error statistics study results provide strong justification that assimilation of dwr reflectivity and radial velocity using uv control variables help to improve the prediction of localised heavy precipitation systems although the results are encouraging for a heavy convective event the impact of control variables on predicting a severe tropical cyclone needs further investigation additional investigations are being conducted to understand the sensitivity of dwr assimilation to microphysics schemes spatial resolutions and assimilation window sizes advanced data assimilation method like hybrid 3dvar and 4dvar for radar data assimilation are also planned to utilize the dwr data in a flow dependent manner acknowledgement the authors thank the editor and anonymous reviewers for careful review of the manuscript the authors wish to thank the support extended by the principal scientific advisor to the government of india through the project sa ab urban floods 2016 we extend our gratitude to the indian meteorological department for providing the doppler weather radar data supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2019 02 004 appendix supplementary materials image application 1 
683,short term precipitation forecasts from numerical weather prediction models are a vital source of information for real time flood forecasting systems previous studies show that assimilation of doppler weather radar dwr observations significantly improves the forecast skill of short term precipitation however the variational assimilation methods used for dwr assimilation are sensitive to the selection of control variable options in background error statistics in this study the impact of control variable choices in assimilating dwr observations for improving the forecast of heavy rainfall event is analysed for this purpose radar reflectivity and radial velocity observations are assimilated using stream function velocity potential ψχ and horizontal wind components uv control variable options in weather research and forecast model 3dvar three dimensional variational assimilation system the results show that dwr assimilation using uv control variable option has improved the skill of first 12 h of high intensity precipitation forecasts keywords radar data assimilation 3dvar background error statistics wrf control variables 1 introduction in the last five decades india is facing a continuous rise in flood disaster with an average of 3 floods per year during 2005 2015 an annual average of 1700 people has lost their lives due to the occurrence of flood disasters tripathi 2015 one of the primary reasons for such floods is due to the increase of extreme rain events over india roxy et al 2017 forecasting of such high intensity precipitation on a time scale of minutes to hours has immense benefits such as saving lives protecting economic assets and improving quality of life with the advancement in technology numerical weather prediction nwp models are currently used in short range precipitation forecasts the nwp models generally perform well in predicting frontal precipitations compared to convective precipitation forecasts olson et al 1995 in addition to that nwp model have limited skill in forecasting convective type precipitation over tropics koh and ng 2009 krishnamurti et al 1999 one of the major reasons for the poorest performance of nwp models in convective precipitation forecast is due to its sensitivity towards initial conditions jee and kim 2017 hence the predictability of convective precipitation can be improved by supplying the best possible initial conditions to the nwp model the uncertainty in the initial conditions can be reduced using data assimilation techniques which combines the available observations with nwp product background and their respective error statistics to provide an improved estimate of the atmospheric state ide et al 1997 commonly used data assimilation da methods are optimal interpolation methods the three dimensional 3dvar barker et al 2004 skamarock and klemp 2008 four dimensional variational 4dvar dimet and talagrand 1986 lewis and derber 1985 and kalman filter evensen 1994 approaches among these methods 3dvar is most commonly used for assimilation because of its practicability regarding computational efficiency sugimoto et al 2009 most of the operational centres focus on assimilation of conventional observations in their 3dvar assimilation systems to improve the initial state of mesoscale or microscale convective systems xiao and sun 2007 since conventional observations are too sparse da using these can only represent large scale dynamics structures in the analysis initial condition supplied to the nwp model tong et al 2016 however for forecasting convective precipitation a better description of small scale dynamic and thermodynamic structures in the initial conditions are essential li et al 2016 which can be achieved by assimilating high resolution and denser observations like doppler weather radar dwr observations dwr has the unique capability of sampling the atmosphere with high spatial and temporal resolution thereby providing detailed information about the wind and hydrometeor structures inside a convective weather system several studies have shown that assimilation of dwr data into nwp model improves the convective precipitation forecasts through better representation of mesoscale structure in the initial condition supplied to the model chung et al 2009 honda et al 2006 hu et al 2006 lindskog et al 2004 macpherson et al 2004 montmerle et al 2001 rennie et al 2011 sun et al 2010 sun and crook 2001 tai et al 2011 weygandt et al 2002 studies that focus on radar data assimilation into nwp models started to appear during the last decade sun et al 1991 were the first to design a radar data assimilation system known as variational doppler radar analysis system vdras operating on a four dimensional variational data assimilation method it was expanded by sun and crook 1998 to include microphysical retrievals and was used for short term forecast initialisation later xiao et al 2005 and xiao and sun 2007 developed operators for radial velocity and reflectivity data in the fifth generation mesoscale model mm5 model and showed that continuous assimilation of radar data for every three hours was essential for improving the forecast of heavy rainfall events the positive results obtained from these studies motivated the development of radar data assimilation scheme in wrf da system of the arw wrf community model in 2012 sun et al extended the radar variational analysis scheme of wrf da by adding the four dimensional variational analysis system to it li et al 2012 assimilated radar radial velocity data with wrf hybrid ensemble 3dvar system for prediction of hurricane ike an alternative strategy for assimilating radar data is ensemble kalman filter enkf evensen 1994 the enkf is a sequential assimilation method which improves the models initial conditions by processing a set of observations during a forward integration of an ensemble of model states dowell et al 2004 snyder and zhang 2003 were the first to explore the possibility of assimilating simulated radial velocity observations using enkf following their work caya et al 2005 gao and xue 2008 lange and craig 2014 sobash and stensrud 2013 tong and xue 2004 and xue et al 2006 tested both simulated radial velocity and reflectivity observations using enkf dowell et al 2004 were the first to assimilate real radar observations using enkf studies by chang et al 2014 dowell and wicker 2009 snook et al 2011 zhang et al 2009 have analysed the impact of real radial velocity observations using enkf system aksoy et al 2009 dong et al 2011 dong and xue 2013 snook et al 2015 further analysed the potential of using both real reflectivity and radial velocity observations in an enkf based assimilation system a few studies on the impact of radar data assimilation on forecasting precipitation were also performed for the indian region routray et al 2013 2010 noted that the assimilation of dwr radial velocity and reflectivity helped to improve predictions associated with monsoon depression forecasts for the indian region govindankutty et al 2010 demonstrated the positive impact of dwr radial wind and gts data on the intensity and spatial rainfall distribution of landfalling tropical cyclones abhilash et al 2012 showed improvement in short range forecasting of convective storms by assimilation of dwr radial velocity and reflectivity observations in the wrf 3dvar system osuri et al 2015 improved prediction of bay of bengal tropical cyclones through assimilation of dwr observations using the wrf 3dvar system although radar assimilation has been widely used in improving precipitation forecasts the impact of background error covariance matrix b on variational based radar assimilation methods has not been thoroughly investigated however the background error statistics play a significant role in spreading observations thereby influencing the analysis state of the atmosphere on the other hand the larger dimension of the b matrix 107 107 makes it difficult to model in order to avoid the explicit computation of inversed b matrix control variable preconditioning is usually applied however the choice of control variables alters the entire structure of the b matrix thereby altering the assimilation results descombes et al 2015 xie and macdonald 2012 two different options of control variables are usually used in regional models they are 1 stream function ψ and velocity potential χ 2 wind u and meridional wind v among these two control variable pairs ψχ is the most commonly used option in operational models tong et al 2016 uv control variables have also been used in various studies gao et al 1999 sun and crook 1997 zou 1997 which mainly focus on convective scale events a recent study by sun et al 2016 compared the control variables of ψχ with that of uv in the 3dvar system and concluded that uv pair performed better than the cx pair for limited area convection scale data assimilation they also found that the uv control variables provide a closer fit to radial velocity observations thereby improving the prediction of short term convective type precipitation forecasts in the study by sun et al 2016 indirect assimilation of radar reflectivity was performed to improve the skill of precipitation forecast using uv control variables the role of control variables in direct assimilation of reflectivity is yet to be explored studies related to the influence of control variables in affecting the prediction skill of weather systems has not been well documented over indian context also most of the dwr assimilation studies over indian regions are mainly focused on the simulation of tropical cyclones using ψχ control variables in a 3dvar system there is a dearth of research using dwr assimilation for convective scale precipitation forecasts over indian regions it is further hindered by the lack of studies on the sensitivity of dwr data to background error statistics bes in the current study we have investigated the role of control variables in forecasting a localised heavy rainfall event through direct assimilation of indian dwr reflectivity and radial velocity the primary objective of the present study is to analyse the impact of different control variables in assimilating dwr data for a convective scale event for this background error statistics generated using two control variable pairs ψχ and uv are used in the assimilation of radar data for predicting an extreme rainfall event occurred in chennai and its surrounding areas on 01 december 2015 indian meteorological department has recorded a widely distributed rainfall of 218 mm over the city which resulted in the inundation of low lying areas human causalities and deaths boyaj et al 2017 it was the eighth most expensive natural disaster to have hit the world in 2015 causing damages and losses ranging from 7 to 15 billion us veerasingam et al 2016 the paper is organised as follows the wrf model and its observation operators for assimilating doppler reflectivity and radial velocity data are described in section 2 the case study including model physics background error statistics generation and pre processing of radar data are introduced in section 3 in section 4 the design of the data assimilation and numerical forecast experiments are discussed the results and discussions are presented in sections 5 and 6 summarises the conclusions 2 a brief description of wrfda radar data assimilation system 2 1 wrfda 3dvar assimilation system advanced research weather research and forecast arw wrf model version 3 8 is used in this study for performing mesoscale simulations and data assimilation numerical experiments wrf is a non hydrostatic primitive equation mesoscale meteorological model with advanced dynamics physics and numerical schemes the data assimilation is performed using wrf 3dvar version 3 8 a variational data assimilation system developed for the wrf model wrf 3dvar system developed by barker et al 2004 employs incremental variational formulation courtier et al 1994 the main goal of the wrf 3dvar system is to produce a better initial condition to the wrf model through an iterative solution of a prescribed cost function ide et al 1997 1 j 1 2 x x b t b 1 x x b 1 2 y 0 h x t r 1 y 0 h x where vectors y0 xb x represents observation background and analysis variables respectively error covariance matrices for observation and background are denoted by r and b respectively the cost function produces an optimum comparison between the prior estimation of analysis field and observations weighted by their respective error covariance the observation operator h is used to map variables from model space to observation space generally r is assumed to be diagonal which means that the assimilated observations are independent of one another in practice the spatial and temporal correlation between high resolution observations are still possible thinning of high resolution observations are often performed in operational practices and it one of the efficient way to reduce the effective cross correlation liu and rabier 2002 the iterative minimisation process of the cost function is performed in a pre conditioned control variable space due to the large size of the b matrix 107 107 the major advantage of reducing the cost function in this space is that when the background fields are represented in the control variable space its errors are uncorrelated and the variances are of a unit size which in turn reduces the computation time to a greater extent the cost function defined using incremental formulation is given by 2 j 1 2 v t v 1 2 d h uv t r 1 d h uv where vector d y0 h xb is the innovation vector which measures the departure of observation from the background xb v is the control variable with the assumption uv x xb and h is the linearization operator for the nonlinear observation operator h the matrix u is a decomposition of b matrix and it consists of a series of operations barker et al 2004 upuvuh uv uh matrices define the vertical and horizontal auto correlation of the control variables and they are modelled through the application of empirical orthogonal functions eofs and recursive filters purser et al 2003 respectively the recursive filter used in this study consists of two parameters namely the correlation length scale s of the filter and the number of applications n of the filter the recursive filter rf is given with an initial condition aj at grid point j a single pass of the recursive filter consists of an initial smoothing from left to right c j α c j 1 1 α a j j 1 2 j followed by a pass from right to left d j α d j 1 1 α c j j j 2 1 where α 1 e e e 2 e n δ x 2 4 s 2 the length scale values s at each model level are estimated using the nmc method the up matrix converts the increments from control variable space to model variable space 2 2 assimilation of radial velocity and reflectivity data the radial velocity data and reflectivity data from dwr observation can be assimilated into the wrf variational assimilation system using their respective observation operator formulated by xiao et al 2005 xiao and sun 2007 for radar data assimilation the total water mixing ratio qt is chosen as the moisture control variable instead of pseudo relative humidity a warm rain parameterisation dudhia 1989 has been used to partition the moisture and water hydrometeor increments in the control variable space thereby establishing a relationship between rainwater qr cloud water qc moisture qv and temperature the reflectivity observation operator used in the variational assimilation system is shown in eq 3 and it is used to calculate model derived reflectivity from the rainwater mixing ratio 3 z 43 1 17 5 log ρ q r where z is the model derived reflectivity and ρ is the density of air the above relation is derived analytically by assuming the marshall palmer distribution of raindrop size sun and crook 1998 for radial velocity assimilation the model derived radial velocity is generated using the model predicted three dimensional wind field and rainwater mixing ratio qr the radial velocity operator used in the assimilation system is shown in eq 4 4 v r u x x i r i v y y i r i w v t z z i r i where u v w are the wind components x y z are the radar location xi yi zi are the location of the radar observation ri is the distance between radar and observation and vt is the terminal velocity the terminal velocity can be calculated from the algorithm of sun and crook 1998 and it is given by 5 v t 5 40 α q r 0 125 where qr is the rainwater mixing ratio the quantity α is a correction factor defined by 6 α p 0 p 0 4 where p is the base state pressure and p0 is the pressure at ground level 3 case study and model setup the case used in this study is a heavy rainfall event which occurred in the chennai city from 30 november to 2 december 2015 the city experienced extreme flooding and causalities during this event the propagation of convective systems from the west pacific ocean to the indian ocean chakraborty 2016 in coalition with local convective activity from warming of southern bay of bengal boyaj et al 2017 caused this heavy rainfall the convective systems were guided northward towards indian land region by two highs of mid troposphere situated in the east and west of the indian region the high to the east was due to the effect of el nino and that in the west was associated with a global shift of upper tropospheric rossby wave chakraborty 2016 boyaj et al 2017 found out that warming of the southern bay of bengal also played an equal role in increasing the intensity of the extreme rainfall event to understand the meteorological evolution of this extreme event at convective scale and also to improve the quantitative precipitation forecasts da experiments have been carried out on a single domain with a horizontal spacing of 10 km covering the south peninsular indian region and it is surrounding oceans fig 1 a shows the model domain used for the experiments the model is initialised using the global forecast system gfs data and the boundary conditions are updated at a 6 h interval fig 1b shows the 51 eta levels and its corresponding pressure levels with the model top pressure set at 10 hpa the parameterizations used in the wrf forecast include kessler scheme kessler 1969 betts miller janjic scheme cumulus parameterisation scheme janjić 1994 the yonsei university planetary scheme for the planetary boundary layer hong et al 2006 the rapid radiative transfer model longwave radiation mlawer et al 1997 the dudhia shortwave radiation scheme dudhia 1989 other physics options include the monin obukhov scheme monin and obukhov 1954 for the description of the surface layer and the unified noah land surface model tewari et al 2004 to present the land surface physics the combination of parameterisation schemes was chosen based on an extensive sensitivity analysis due to computational constraints we have limited this study to a single extreme event 3 1 generation of background error statistics the performance of variational da majorly depends on the background error statistics bes because the statistics contain valuable information about the spreading of observation information in model space and also determines how the final analysis is physically balanced sugimoto et al 2009 national meteorological centre nmc method parrish and derber 1992 is one of the most commonly used methods to calculate domain specific background error statistics bes the nmc method approximates the structure of matrix b through the statistical difference between 24 h and 12 h forecasts from a regional model the nmc based background error statistics is given by b x b x t x b x t t x t 24 x t 12 x t 24 x t 12 t where x b represents the atmospheric state of the model x t denotes the true atmospheric state x t 24 x t 12 represents the 24 h and 12 h forecasts from a regional model respectively in this study the wrf regional model was run for november 2015 to produce 12 h and 24 h forecasts at 0000 utc and 1200 utc then the background error statistics are generated by averaging the forecasts differences valid at the same hour using gen be utility program for the present study two different types of background error statistics are considered in the assimilation cycle they are generated using two different set of momentum control variables ψχ and uv which are named as cv ψχ and cv uv respectively following the calculation of bes single observation tests are performed on the two different bes at the centre of the domain using perturbed u wind the single observation tests help in providing information about the spread of calculated background error 3 2 pre processing of radar data pre processing of dwr data is a major step to be performed before data assimilation dwr pre processing includes coordinate conversion thinning of radar data to model resolution and finally quality control of the data dwr data is usually available in the polar coordinate system in which the data points are represented in azimuth range and elevation transforming the data points to cartesian coordinates is accomplished using equations given by doviak and zrnić 1993 the equations are given below the height of data points are calculated using the equation 7 h r sin θ r 2 2 r e where h is the height of the data point θ represents elevation angle r is the slant range distance and re is the radius of the earth the location of data points are calculated below latitude 8 λ λ r 180 π α cos φ longitude 9 ϕ ϕ r 180 π sin 1 sin φ sin s 2 r e cos λ π 180 range bin 10 s 2 4 3 r e sin 1 s cos θ 4 3 r e h r 11 α s 2 r e 12 s s 1 δ s n where λ r ϕ r are radar latitude and longitude φ is the azimuth angle in radians hr is the height of the radar and s1 is the size of first range bin the geo located data are thinned to a regular cartesian grid of 10 km model resolution using the method by abhilash et al 2012 thinning of radar observations reduces the effective cross correlation resulting in diagonal observation error covariance matrix even though thinning of radar data results in loss of information the effect of considering cross correlated observation error covariance matrix in indian dwr assimilation is a subject for further investigation in this study the observations error for radial velocity and reflectivity were set as 1 ms 1 and 1 dbz respectively in 2010 cheung and chan used the same set of observational error values to improve the prediction skill in the wind and rain fields we have removed the unwanted echoes and the non precipitation echoes by the interactive editing of radar echoes finally the quality controlled dwr data are written in wrfda acceptable ascii format in this study three sets of chennai dwr data from 06 utc of 30 november 2015 to 18 utc of 01 december 2015 with 6 hourly interval are pre processed and assimilated into the wrf 3dvar 4 experimental design four experiments namely control radar ψχ radar uv gts were designed detail description of the experiments is outlined in table 1 in the control experiment gfs data at 0 5 0 5 horizontal resolution produced by the national centres for environmental prediction ncep ftp nomads ncdc noaa gov gfs grid4 is used as an initial condition at 00 utc of 30 november 2015 and the model was integrated without any data assimilation for 48 h forecast starting at 00 utc of 30 november 2015 the second experiment radar ψχ was based on the assimilation of quality controlled conventional observations surface and radiosonde observations from global telecommunication system chennai doppler weather radar dwr radial velocity and reflectivity observations at 6 h cycle from 0600 utc of 30 november 2015 to 1800 utc of 30 november 2015 in wrf 3dvar system using ψχ as control variables before starting the assimilation process the model was spun up for 6 h with the initial condition from gfs at 00 utc of 30 november 2015 in the 6 h 3dvar update cycle the 6 h forecast from the previous cycle serves as background for the next cycle a total of three cycles from 0600 utc of 30 november 2015 to 1800 utc of 30 november 2015 were performed to improve the initial condition supplied to the model with the improved initial condition the model was integrated to provide 30 h forecast up to 0000 utc on 02 december 2015 for comparison purposes radar uv experiment assimilates the same data as radar ψχ experiment except it uses background error statistics with uv as control variables in the 3dvar system in order to highlight the contribution of radar data assimilation with uv control variable from conventional observations assimilation gts experiment is conducted in the gts experiment only quality controlled conventional observations are assimilated using uv control variable options 5 results and discussion 5 1 background error statistics comparison in the variational da methods the dimensions of matrix b are usually too large to be explicitly determined descombes et al 2015 hence the b matrix is modelled using a series of operators like vertical horizontal and physical transforms with homogeneous and isotropic assumptions barker et al 2004 in this study the empirical orthogonal function eof decomposition is used for defining the vertical variations in the control variables in eof decomposition the eigenvectors model the vertical transform and their associated eigenvalues represent the variance in order to represent the horizontal transform the length scale is estimated in the eof space through the application of recursive filter hayden and purser 1995 during the da process the recursive filter spreads out the eigenvalues weighted analysis increment in the eof space according to length scale value then the physical space transformation from eof mode is performed to spread out the information vertically fig 2 shows the variance and length scale of background error statistics for both the control variable options ψχ uv since the control variable options are derived based on homogeneous and isotropic assumptions they vary only with height the fig 2a shows the horizontal length scales of ψ χu u and v it can be noted that the length scales values of ψ and χu ranges from 330 km to 150 km for the first 20 modes whereas for u and v control variables the length scale value ranges from 90 km to 30 km for the first 20 modes this clearly shows that u and v have relatively smaller length scales compared to that of χ and ψu which means u and v represent more local features within a small radius of influence hence during data assimilation the analysis increment from u and v control variables will remain closer to the observations whereas the analysis increment from ψ and χu will be smoother and have a larger radius of influence to analyse the variance of background error statistics bes derived using two different control variable options eigenvalues are plotted to vertical modes fig 2b shows the normalised eigenvalue plots of ψ χu u and v from ψχ and uv respectively wherein the eigenvalues are normalised for the ease of plotting it can be observed from the fig 2b that the eigenvalues of u and v are greater than ψ and χu which indicates that u and v control variables pair captures the maximum variance when compared to the other two control variables in eof space it is further supported by fig 2c which shows the ratio between ψ or χu and u the ratio plot shows that the value decreases with increasing modes which states that the variance of u is greater in the first 20 modes the overall results from both length scale and eigenvalue plots show that background error statistics generated using uv control variable option has larger variance and smaller length scale which are consistent with previous results sun et al 2016 the results confirm that the use of uv control variable option in da helps to capture small scale structures in the analysis 5 2 single observation test in order to analyse the effect of momentum control variables ψχ and uv in physical space two single observation tests are performed the first single observation test involve the use of ψχ control variables and the second test uses uv as the control variables in both single observation tests a single perturbed wind observation with the innovation of 1 ms 1 is placed on the 19th model level in the centre of the domain 11 n 81 e and the wrf 3dvar system was run accordingly with their respective control variable options ψχ uv the analysis increment results from ψχ bes generated using ψχ control variables and uv bes generated using uv control variables show different u increment due to different background error covariance matrices the series of plots fig 3 show the comparison of vertical x z horizontal x y slices and profiles of resulting u increments from all single observation tests it can be observed from the x z plane plot fig 3a and c that the area of increment is much larger for radar ψχ tests when compared to that radar uv tests in terms of horizontal spread a horizontal cross section of increment values at a 19th model level x y plot for both the tests are shown in fig 3b and d it can be observed that single observation tests with uv as control variables show higher magnitude and smaller spatial spread of increment fig 3d when compared to its counterpart experiment fig 3b this is due to the larger length scale of ψχ background error statistics as observed in fig 2a it is also observed that ψχ control variables produce nonphysical negative increment around the assimilated single u wind observation fig 3b previous studies li et al 2016 sun et al 2016 xie and macdonald 2012 have shown similar nonphysical error outside the observation region with use of ψχ control variables if a radial wind observation is assimilated using ψχ these negative increments will cause an unrealistic local divergence and convergence on the other hand for uv control variables the single observation test shows a consistent wind increment around the u wind observation fig 3d an isotropic response has also been observed for all the tests the increment profile in fig 3e shows the smoothing effect of increments with the use of ψχ control variables it also shows that assimilation of observation using uv as control variable option results in larger magnitude and smaller spread of increments when compared to ψχ 5 3 verification against conventional observations fig 4 shows the domain averaged root mean square error rmse from the five experiments for zonal wind meridional wind temperature and specific humidity averaged over the assimilation cycles the rmses are calculated against the available observations synoptic and radiosonde and forecasts of all the experiments from 00 utc of 01 december 2015 to 00 utc of 02 december 2015 it has been observed from fig 4a and b that radar uv experiment shows 20 30 reduction in wind rmse when compared to other experiments this clearly shows that assimilation of radar data using control variables uv improves the wind forecasts significantly when compared to the usage of ψχ control variables especially at lower pressure levels for temperature and specific humidity fig 4c and d the radar uv experiment agrees best with the observations at all the pressure levels compared to other experiments fig 5 shows the time series of surface rmses from 00 utc of 01 december 2015 to 00 utc of 02 december 2015 clearly the assimilation experiment with uv control variables shows a reduced surface rmse value when compared to the experiments with ψχ control variables among all the experiments the radar uv shows better fit to the observation with 10 30 reduction in surface wind rmse values fig 5a and b during first 18 h of forecast and 15 20 reduction in 2 m temperature fig 5c rmse values overall it is found that assimilation of radar data with uv control variable option significantly reduces the forecast error for both the surface and upper atmospheric model variables 5 4 vertically integrated moisture transport and wind field forecasts the impacts of control variables on the vertically integrated moisture transport vimt and wind fields are explored the wind forecast at 850 hpa and vimt provides information about the source of moisture and the mechanism through which the moisture is transported fig 6 shows the wind forecast at 850 hpa from all the experiments at synoptic hours in all the experiments a short lived cyclonic wind circulation pattern can be seen in the northern part of indian ocean from 30 nov 00 utc to 01 dec 18 utc the pattern is due to the intensification of the convective system over the warm indian ocean as reported by chakraborty 2016 even though the circulation pattern is simulated in all the experiments radar uv shows a stronger wind speed of 20 ms 1 as compared to other experiments fig 6k o also from fig 6p t it is noticed that the assimilation of radar with ψχ control variable weakens the wind speed by 50 and also fails to capture the circulation pattern during the initial forecast hours fig 6p q when compared to other experiments the radar uv experiment shows higher spread and magnitude of wind 15 20 ms 1 on both land and oceanic regions the vimt plots in fig 7 indicates that the moisture from both bay of bengal and indian ocean have contributed to the extreme precipitation over the south east coast of india it can also be seen from fig 7 that most of the moisture contribution comes from the bay of bengal this is due to the increase in sea surface temperature sst over the southern bay of bengal making it favourable for deep convection as pointed out by boyaj et al 2017 it is evident from fig 7k o that assimilation of both reflectivity and radial velocity with uv as control variables in a 3dvar assimilation system resulted in higher convergence of moisture with a maximum vimt value of 6 8 kgm 1s 1 compared to other numerical experiments among all the experiments radar ψχ fig 7p t shows very low convergence of moisture with maximum vimt values ranging from 4 to 5 kgm 1s 1 it is also interesting to note that in radar uv experiment very high precipitation values are observed fig 8 over the similar regions of higher vimt values the increased vimt values are the likely reason for increased high intensity precipitation the above analyses clearly show that assimilation of both radial velocity and reflectivity data plays a key role in modifying the low level winds and moisture flux variables 5 5 spatial verification of precipitation over radar region to verify the spatial spread of rainfall the model simulated precipitation results from the four experiments are compared with gpm precipitations in this study gpm accumulated precipitation is used for spatial pattern and intensity verification of precipitation because it is the only available high resolution gridded rainfall data over the indian sub continent six hourly accumulated precipitation calculated using gpm imerg final product representing a half hour span and 0 1 0 1 spatial resolution is used for comparison imerg is one of the gpm products gpm atbd 2015 which provides a multi satellite accurate rain rate estimate over indian region krishna et al 2017 fig 8 shows a zoomed snapshot of the 6 h accumulated rainfall from control radar uv radar ψχ and gts experiments in comparison with gpm rainfall observations at 06 utc two precipitation patterns over land and ocean regions with maximum precipitation of 120 mm are observed fig 8q a careful examination indicates that the radar uv experiment s fig 8i simulated precipitation matches with the observed high intensity precipitation amount and spread by more than 50 whereas in other experiments the precipitation pattern and amount are poorly simulated with 10 20 of the high intensity region being captured this is due to the better convergence of wind and moisture flux in the radar uv experiment as mentioned previously in figs 6k and 7k at 12 utc a north south oriented rain band along the eastern coastline with the highest intensity of 80 mm is observed fig 8r among the four experiments the radar uv experiment fig 8j roughly matches the observed vertically oriented rain band whereas in other experiments the precipitation pattern and amounts are poorly predicted at 18 utc the observed precipitation has very high intensity over the land region with a larger spread fig 8s in control and gts experiments fig 8c and g the structures are captured to some extent while the intensity is relatively weak also radar ψχ experiment fig 8o shows an unrealistic rain band with the precipitation pattern and amounts being poorly simulated due to the substantial lack of moisture convergence figs 6s 7s on the other hand the radar uv fig 8k correctly simulates the high intensity precipitation regions at 24 utc rain bands with the highest intensity of about 40 mm are observed extending from land to the ocean fig 8t in comparison with the observed all the experiments except radar ψχ fig 8p showed an overestimated precipitation pattern shifted in the northeast direction the precipitation forecast error is found to increase rapidly with an increase in lead time overall it is seen that the rainfall forecast from radar uv experiment possesses better patterns compared to other experiments around the radar range of coverage with the improved convergence of wind and moisture fluxes 5 6 statistical verification of precipitation forecasts to analyse the effect of radar data assimilation on high intensity precipitation forecasts statistical verifications scores such as hit rate hr false alarm ratio far equitable threat score ets and fractional skill score fss were performed the hr also known as the probability of detection measures the fraction of observed events that were correctly forecasted far refers to the fraction of forecast events that do not occur and ets measures the fraction of observed events that were correctly predicted also accounting for the hits that would have been occurred due to random chance the fss introduced by roberts and lean 2008 is a neighbourhood based method which describes the fraction of observed events within a square neighbourhood centred around each pixel higher values of hr ets fss and lower values of far indicate better forecast skill the gpm 6 h accumulated precipitation with intensity above 60 mm 10 mm h is used for statistical verification against wrf six hour accumulated precipitation forecast to concentrate on forecast skill of extremely heavy precipitation we have chosen 10 mm h 60 mm for 6 h accumulated precipitation threshold defined by indian metrological department imd for verification fig 9 depicts the statistical verification scores of the five experiments from 00 utc of 01 december 2015 to 00 utc of 02 december 2015 it can be noticed from the hit rate line graph fig 10a that the radar uv experiment has the highest hit rate till 12 utc of 01 december 2015 whereas other experiments have the lowest hit rate a comparison between radar uv and radar ψχ experiments shows a 50 to 90 increase in hit rate in the radar uv experiment when the far fig 9b between radar ψχ and radar uv are compared it is seen that the implementation of uv control variables in radar data assimilation have reduced the false alarm up to 30 in addition the radar uv experiment shows a similar pattern to the hit rate with a low far value up to 12 utc when comparing the ets scores fig 9c the radar uv experiment shows the highest predictability till 12 utc and it gradually decreases as the forecast time goes on a similar pattern of decreasing predictability is also visible in the radar ψχ experiment the decreasing effect of radar data assimilation in the localisation of heavy precipitation with increasing lead time is due to the phenomenon that the influence of the radar data assimilation increments on total precipitation is forgotten over a couple of hours as the convection returns to its unperturbed equilibrium state craig et al 2012 the ets score also shows that the radar uv experiment exhibit a higher skill compared to the radar ψχ experiment for the whole forecast period fig 9d shows the fss boxplots for all the experiments over the forecast period each experiment s box plot in fig 9d describes their respective distribution of fss scores for the entire forecast hours the fss values of the 6 h accumulated precipitation are calculated using a 20 km radius of influence with a threshold of 10 mm h it can be seen that average fss scores of radar uv experiments are higher as compared to other experiments also the fss score indicates that the assimilation of radar data with ψχ as control variable option decreases the precipitation forecast skill overall the objective statistical scores represent a worthwhile improvement in high intensity precipitation forecast from the assimilation of radar data using uv control variables 6 conclusion this study evaluates the impact of background error statistics of two momentum control variable options in wrf 3dvar stream function velocity potential ψχ and zonal meridional winds uv radar data assimilation system for a convective high rainfall event occurred in chennai the background error statistics are derived from a 24 h and 12 h forecast differences valid at the same time generated by 10 km wrf real time forecasts during november 2015 over peninsular india using the nmc method by comparing the error statistics of ψχ and uv it has been observed that uv control variables capture the maximum variance when compared to the ψχ control variables it also shows that the horizontal length scale of ψχ is larger than that of uv the smaller length scale and larger variance from uv control variables produce analysis increments that tend to capture small scale features a single observation test was also performed to evaluate the characteristics of two momentum control variable options in the assimilation of zonal wind the results highlight that the use of uv control variables produce large magnitude and small horizontal spread increment when compared to the ψχ control variables using the two bes ψχ uv twin radar data assimilation experiments radar uv radar ψχ along with free forecast control and conventional observation gts assimilation experiments were performed forecasts from all the experiments are verified against synoptic and radiosonde observations significant reduction in the rmse values of both zonal and meridional wind is found in the radar uv experiment at all pressure levels when compared to other experiments for temperature and specific humidity forecast the radar uv experiment showed a reduction in rmse values at all pressure in addition to that 10 30 reduction in surface wind rmse and 15 20 reduction in 2 m temperature rmse were also observed in the radar uv experiment forecast verification using station observations showed that the model forecast variables are better forecasted in the radar data assimilation experiment using uv control variables in comparison with other experiments the impacts of control variables on the vertically integrated moisture transport vimt and wind fields forecast were also analyzed it has been observed that the use of uv control variables in a 3dvar radar data assimilation improves the wind speed and moisture convergence in the case of other experiments low wind speed and moisture flux were observed to understand the role of control variables in improving the qpf the spatial distribution and intensity of the rainfall were compared with gpm imerg 6 h accumulated precipitation it is found that the radar data assimilation experiment using uv control variables in the 3dvar assimilation system produces a better rainband structure of high intensity precipitation on statistical verification of very high intensity precipitation 10 mm h it is observed that radar uv experiment shows a higher hit rate equitable threat score and lower false alarm ratio than the other experiments during the initial 12 h of forecast lead time respectively among all the experiments radar ψχ experiment shows a lower predictability skill of high intensity precipitation for all forecast hours it has also been observed from the radar experiments that the forecast skill for precipitation decreases with the increasing lead time whereas the control experiment provides improved skill score as forecast period advances however in the case of designing nowcasting better forecast skill is mandatory at the initial forecast hour which the control experiment fails to satisfy the fss score for the whole forecast period also shows that radar uv experiments outperform all other experiments this study is an initial assessment of utilizing indian dwr data into a regional model for prediction of high intensity convective precipitation using different control variables in the background error statistics study results provide strong justification that assimilation of dwr reflectivity and radial velocity using uv control variables help to improve the prediction of localised heavy precipitation systems although the results are encouraging for a heavy convective event the impact of control variables on predicting a severe tropical cyclone needs further investigation additional investigations are being conducted to understand the sensitivity of dwr assimilation to microphysics schemes spatial resolutions and assimilation window sizes advanced data assimilation method like hybrid 3dvar and 4dvar for radar data assimilation are also planned to utilize the dwr data in a flow dependent manner acknowledgement the authors thank the editor and anonymous reviewers for careful review of the manuscript the authors wish to thank the support extended by the principal scientific advisor to the government of india through the project sa ab urban floods 2016 we extend our gratitude to the indian meteorological department for providing the doppler weather radar data supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2019 02 004 appendix supplementary materials image application 1 
684,we study the effects of boundary excitation on the onset of natural convection and the dynamics of subsequent convective mixing by conducting linear stability analysis lsa and direct numerical simulations dns a detailed parametric analysis on the stability of a diffusive boundary layer in porous media subject to three different types of linear decline linear decline followed by constant concentration and symmetric flat floored valley shape boundary conditions is presented we propose scaling relations based on results of lsa to describe the critical time and the associated wavenumber of convective instabilities that incorporate the effect of the boundary parameters the lsa results show that the classic onset criterion is applicable when decline factors α is smaller than 10 4 the results also demonstrate that α does not play a significant role in the instability of the system unless it is greater than 10 4 the results show that in systems with linear concentration decline followed by constant concentration the impact of decline on the stability of the system decreases as α increases based on the lsa results a system with α 10 2 leads to unified stability criteria at different constant concentration χ similar to the classic problem when the transient time τ and the wavenumber κ are rescaled by χ as τχ 2 and κ χ respectively our results also show that the duration of the flat portion in symmetric flat floored valley shape boundary condition is the main factor controlling the stability behavior of the system the dns results reveal that the dynamics of the buoyancy driven mixing is also significantly influenced by the temporal variation of concentration at the boundary these findings improve our understanding of buoyancy driven instabilities in the presence of boundary excitation and finds applications in thermal and solutal convection in porous media keywords buoyancy driven flows thermal convection solutal convection boundary excitation linear stability analysis 1 introduction solutal and thermal convection in porous media has wide range of applications in a number of fields such as geological flows groundwater hydrology diersch and kolditz 2002 simmons 2005 van dam et al 2009 waste disposal liu and dane 1996 mao et al 2006 schincariol and schwartz 1990 yang and edwards 2000 carbon dioxide sequestration emami meybodi et al 2015 lindeberg and wessel berg 1997 riaz et al 2006 petroleum reservoir engineering and geothermal reservoirs coumou et al 2008 horton and rogers 1945 zhao et al 2008 solutal and thermal convection can develop due to negative density gradients in the gravity field resulted from temperature and or concentration landau and lifshitz 2004 nield and bejan 2006 evolution of natural convection in porous media enables efficient heat solute transport over larger spatial and time scales than those achieved by molecular diffusion theoretical basis and importance of natural convection in porous media have been very well discussed in the book by nield and bejan 2006 stability of the diffusive boundary layer in porous media with different types of boundary conditions such as step change boundary condition elder and w 1967 ennis king et al 2005 nield and bejan 2013 constant flux boundary ingham and pop 2005 pop and ingham 2001 vafai 2005 partially permeable boundary elenius et al 2012 slim 2014 slim and ramakrishnan 2010 and moving boundary condition meulenbroek et al 2013 myint and firoozabadi 2013 has been widely discussed in the literature however these investigations are mainly concerned with systems with either fully developed or time independent base state ingham and pop 2005 nield and bejan 2013 pop and ingham 2001 vafai 2005 or constant boundary type problems elenius et al 2012 ennis king et al 2005 meulenbroek et al 2013 myint and firoozabadi 2013 slim 2014 slim and ramakrishnan 2010 where the imposed boundary is independent of time stability of fluids in porous media with boundary excitation is of particular interest especially in connection with the geophysical and environmental problems there are relatively very few studies available that look into the effect of interface boundary excitation on the stability of diffusive boundary layers in porous media hassanzadeh et al hassanzadeh et al 2006 studied the effect of linear decline negative ramp in concentration at the top boundary on the onset of convection in a transient diffusive layer using a linear stability analysis they found that the decline factor significantly affects the stability of the diffusive boundary layer in systems with low ra number ra 250 it was reported that the growth of the perturbations in systems with low ra number attenuates as the decline factor increases it was also observed that the effect of decline factor on the stability of systems with large ra number r 500 can be negligible more recently wen et al wen et al 2018 studied the dynamics of convective mixing in a closed porous system in the context of co2 sequestration it was shown that the pressure drop in the gas phase during dissolution of gas in water negatively affects both diffusive and convective mass transport of co2 it was reported that the pressure drop in a closed system decreases the dissolution flux and limits the convection before the underlying brine begins to saturate however these studies were either concerned with the dynamics of convective mixing in a finite domain wen et al 2018 or restricted to a simplified form of a time dependent boundary condition hassanzadeh et al 2006 these studies do not present any parametric analyses on the stability criterion of the system the objective of the present study is to perform an inclusive analysis of the instability and the associated dynamics of solutal natural convection in saturated porous media in the presence of boundary excitation the presented analysis and results in this study provide fundamental understanding of natural convection in the presence of boundary excitation three different types of time dependent boundary conditions are used to simulate the concentration excitation at the interface the effect of boundary excitation on the onset of instabilities and subsequent convective mixing is discussed a linear stability analysis using quasi steady state approximation qssa is conducted to study the effect of time dependent concentration boundary on the instability behavior of a gravitationally unstable diffusive boundary layer we present new scaling relations for the onset of convective instabilities in systems with linear decline linear decline followed by constant concentration and symmetric flat floored valley shape boundary conditions the developed scaling relations can be used to estimate the onset of density driven instabilities as a function of the characteristics of the boundary condition and the physical properties of the porous layer the dynamics of the system beyond the onset time is also studied using direct numerical simulations although we focus on solutal natural convection the insight developed here can be applied equally to thermal problems this paper is organized as follows in section 2 we describe the problem of interest via presenting the governing equations and boundary conditions followed by a base state solution for the diffusive mass transfer with time dependent boundary condition in section 3 mathematical formulation of linear stability analysis is presented results and discussion are presented in section 4 followed by section 5 which is summary and conclusion of this study 2 mathematical formulation 2 1 governing equations we consider a two dimensional homogeneous isotropic isothermal vertical cross section of a porous layer with thickness h as shown in fig 1 a the porous layer is saturated with a quiescent fluid which is initially free of solute a cartesian coordinate system was chosen with the z axis pointing downward the porous layer is assumed to be infinite in the x direction the bottom boundary is assumed to be impermeable to flow with zero mass flux the top boundary is also assumed impermeable to flow but is imposed to a time dependent concentration as shown in fig 1 b the time dependent concentration at the top boundary is defined as 1 c z 0 c 2 c 1 c 2 t 1 t t 1 h t 1 t c 3 c 2 t t 2 t 3 t 2 h t t 2 c 3 c 2 1 t t 2 t 3 t 2 h t t 3 where c is the concentration of the diffusing species t is the time c 1 c 2 c 3 are the concentration at z 0 for t 0 t 1 t t 2 and t t 3 respectively h is the heaviside step function h t 1 if t 0 and h t 0 if t 0 assuming the boussinesq approximation is valid and rock and fluid compressibility effects are negligible and in the absence of viscosity variation and dispersion effects the governing equations of non reactive single phase flow and transport can be written as bear 1972 2 d ϕ 2 c v c ϕ c t 3 v 0 4 v k μ p ρ g where v u v is the darcy velocity vector u and v are the horizontal and vertical components of the velocity vector respectively p is the pressure k is the porous medium permeability μ is the viscosity g is acceleration due to gravity z is the vertical coordinate positive downwards ρ is the density ϕ is the porosity and d is the effective molecular diffusion coefficient of the diffusing species in porous media and is assumed to be independent of concentration for dilute solutions it was assumed that density is a linear function of the local concentration of the dissolved species 5 ρ ρ 0 1 β c where ρ 0 is the fluid density at c 0 and β 1 ρ ρ c which can be obtained from an equation of state the governing equations were nondimensionalized by choosing c 1 as the concentration scale the buoyancy velocity ub kδρg μ as the velocity scale l dϕμ kδρg with δρ βρ0 c 1 as the length scale and d l 2 as the time scale it is worth noting that using height of the domain as the length scale would make it difficult if not impossible to distinguish the effect of top and bottom boundary in the finite domain and parameterize the role of the top boundary on the onset of convection in fact the defined decline rate α in h scaled system such as those used by hassanzadeh et al 2006 and wen et al 2018 contains h meaning that both alpha α and ra change with the height of the domain in this case depending on ra both top and bottom boundary would affect the behavior of diffusive flux and consequently onset of instability in a same fashion in other words for h scaled system change in α π in wen et al 2018 could mean either change in the decline rate for the concentration at the top boundary or change in h which may involve the bottom boundary effect therefore the used scaling may lead to misleading results especially in systems with low ra numbers here we intentionally use l dϕμ kδρg as the length scale to avoid this scaling problem and let α to only capture the top boundary features in other words time dependent nature of top boundary is isolated from the size of the domain accordingly the dimensionless form of the governing equations for flow and transport can be expressed as 6 2 v η 2 2 v ξ 2 2 c η 2 7 c τ 2 c η 2 2 c ξ 2 u c η v c ξ 2 2 base state solution at the early times when the thickness of the diffusive boundary layer δ 4 d t bird et al 2002 is very small compared to the height of the porous layer δ h the domain can be considered as a semi infinite medium in the z direction eqs 6 and 7 are subject to the following conditions 8a v ξ 0 v ξ 0 8b c ξ 0 9 c ξ 0 χ 2 χ 1 χ 2 α 1 τ h χ 2 χ 1 α 1 τ α 2 τ χ 2 χ 1 α 1 θ h τ χ 2 χ 1 α 1 θ χ 3 χ 2 α 2 τ χ 2 χ 1 α 1 θ h τ χ 3 χ 2 α 2 χ 2 χ 1 θ α 1 where χi ci c1 α1 χ2 χ1 τ1 α2 χ3 χ2 τ3 τ2 and θ τ1 τ2 fig 2 shows the dimensionless form of the time dependent concentration profile imposed at the upper boundary of the porous layer since the system is motionless prior to the onset of instabilities the bases state velocity is zero at the early times prior to the onset of instabilities the molecular diffusion is the dominant transport mechanism therefore eq 7 can be written as 10 c b τ 2 c b ξ 2 the time dependent base state solution of eq 10 subjects to the initial condition cb τ 0 0 and the boundary conditions given in eq 9 can be obtained using duhamel s theorem carslaw and jaeger 1959 11 c b ξ τ e r f c ξ 4 τ α 1 ω 0 ψ 0 α 1 ψ 1 ω 1 h τ χ 2 χ 1 α 1 α 2 ω 2 ψ 2 h τ χ 2 χ 1 α 1 θ α 2 ψ 3 ω 3 h τ χ 3 χ 2 α 2 χ 2 χ 1 θ α 1 where 12a ω i ξ τ ξ 2 2 τ τ i e r f c ξ 2 τ τ i 12b ψ i ξ τ ξ τ τ i π exp ξ 2 4 τ τ i for the limiting case of α 2 α 1 α χ3 χ1 1 and considering χ χ2 i e the time dependant bouandry eq 9 can be expressed as 13 c ξ 0 χ 1 α τ χ h 1 χ α τ α τ 1 χ θ h τ 1 χ α θ 1 χ α τ 1 χ θ h τ 1 χ θ 1 α θ and the base state solution eqs 11 and 12 is given as 14 c b ξ τ e r f c ξ 4 τ α ψ 0 ω 0 ω 1 ψ 1 h τ 1 χ α ω 2 ψ 2 h τ 1 χ α θ ψ 3 ω 3 h τ 1 χ θ 1 α θ the dissolution flux per unit area at the interface z 0 can be obtained as 15 f t d 0 ϕ c 0 t z d x using the diffusive time and length scales the non dimensional form of the flux can be expressed by 16 j τ f u b c 1 according to eqs 14 16 the diffusive flux at ξ 0 can be written as 17 j d i f f 1 π 1 τ λ 0 h τ 1 χ α λ 1 h τ 1 χ α θ λ 2 h τ 1 χ θ 1 θ α λ 3 where λ i 2 α τ τ i fig 3 shows the diffusive flux at the interface ξ 0 for systems imposed to the time dependent concentration boundary fig 3 a presents the diffusive flux for the system with a linear decline concentration boundary at different α 10 5 10 4 10 3 10 2 and 0 1 followed by a constant concentration of χ 0 the inset plot in fig 3 a shows the boundary condition a case with α 0 χ 1 is also shown for comparison it can be observed that the decline factor significantly influences the diffusive flux the linear decline boundary condition with small values of decline factor resembles gas absorption and co2 dissolution in water later in appendix it is shown that the linear decline boundary condition with a low decline factor is able to reasonably resemble the early time behavior of diffusive flux in a close system where the boundary is coupled with a finite gas cap wen et al 2018 fig 3 b shows the log log scale of the same results while for a system with a constant boundary condition α 0 0 χ 1 the diffusive flux declines as τ 1 2 at the early times the diffusive flux in systems with time dependent boundary condition α 0 χ 0 does not follow the same trend the results show that the diffusive flux decreases as the decline factor α increases fig 3 b reveals that at higher decline factors the diffusive flux departs earlier from τ 1 2 and declines much faster compared to the constant concentration boundary condition α 0 0 χ 1 at very high decline factors the diffusive flux turns to shut down even before the domain becomes saturated in this case due to the positive concentration gradient at the interface system may even lead to an out flux regime with a negative diffusive flux and act like a discharge problem see diffusive flux for systems with α 10 3 10 2 and 0 1 in other words the interface may reach a concentration lower than those of its underlying saturated fluid layers in systems with large decline factors this leads to a non uniform concentration distribution through the penetration depth of the diffusive front which negatively slows down the rate of dissolution the diffusive flux for a system with a linear decline α 0 01 followed by a constant concentration boundary at χ 0 0 0 1 0 3 0 5 0 7 1 is shown in fig 2 c the log log plot of the same results is shown in fig 3 d the inset plot in fig 3 c shows the boundary condition the diffusive flux for low values of χ follows a deep shut down during the decline of the interface concentration and then recovers after the decline is completed systems with χ 0 0 0 1 and 0 3 show a negative diffusive flux around their bounce back point as it was discussed earlier this behavior is attributed to the establishment of a positive concentration gradient at the interface where the effect of constant concentration boundary is not large enough to compensate the effect of the high decline rate and the interface reaches a lower concentration than that of the underlying fluid the diffusive flux deviates from the shutdown path and starts to recover as a consequence of establishment of the constant concentration boundary following the linear decline of the interface concentration the diffusive flux reaches a maximum and then declines and approaches the trend of the constant concentration boundary condition the results show that as χ increases the diffusive flux bounces back earlier and leads to a higher diffusive flux at the late time fig 3 e shows the diffusive flux for a system with a linear decline α1 0 01 followed by a constant concentration of χ 0 5 at the boundary succeeded by a linear positive ramp at α 2 0 01 at θ 0 1 0 25 0 5 0 75 1 0 and followed by a constant concentration of χ 1 a case with θ 1 is also shown for comparison the log log plot of the same results is shown in fig 3 f the inset plot in fig 3 e shows the boundary condition during the early time the diffusive flux goes to a deep shut down until the linear decline in the concentration of the top boundary is terminated it can be seen from fig 3 e that the diffusive flux experiences its bounce back just after the linear decline is over and the boundary profile turns flat at constant value of χ 0 5 the second bounce back occurs at the end of constant concentration period just after the linear ramp begins the diffusive flux then approaches the trend of a constant concentration boundary τ 1 2 at late time when the linear positive ramp is over and a constant concentration of χ 1 is established again the results demonstrate that as the time ratio θ decreases the second bounce back in the diffusive flux is delayed later we will show that how the dependency of the diffusive flux to the time dependent boundary condition may impact the onset and associated dynamics of convective dissolution 3 formulation of linear stability analysis to conduct linear stability analyis the base state is purturbed using ℜ ℜ b ℜ where ℜ v c and ℜ η ξ τ ε ℜ ξ τ exp i κ η are the infinitesimal perturbations of velocities and concentration where i is the imaginary unit and κ is the dimensionless horizontal wavenumber with a very small amplitude ε after substituting the perturbed variables into the flow and transport equations implementing the base state quantities linearizing the perturbations the following perturbed equations can be obtained 18 2 v ξ 2 κ 2 v κ 2 c 19 c τ 2 c ξ 2 κ 2 c c b ξ v the linearized eqs 18 and 19 were solved using a quasi steady state approximation qssa in which the disturbance quantities were assumed to have the following forms tan and homsy 1986 20 v ξ τ c ξ τ a τ 0 v ξ c ξ where variables defined by asterisks represent the perturbation eigenfunctions therefore the dimensionless growth rate σ reads 21 σ τ 0 1 a τ 0 d a d τ the time scales represented by τ and τ0 denote to the fast growing perturbations and the molecular diffusion time scales respectively using eq 20 eqs 18 and 19 can be written as 22 2 ξ 2 κ 2 v κ 2 c 0 23 c b ξ v 2 ξ 2 κ 2 c σ c 0 subject the following boundary conditions 24 v ξ 0 v ξ 0 25 c ξ 0 c ξ 0 to obtain the growth rate corresponding to an assigned wavenumber the system of perturbed eqs 22 and 23 are discretized using a second order finite difference method and then solved numerically the resulting discretized equations can be expressed by a system of linear equations 26a a 1 v a 2 c 0 26b a 3 v a 4 σ i c 0 where v and c are the eigenvectors for vertical velocity and concentration respectively a1 a4 are the coefficient matrices based on central discretization of the second derivatives related to the eigenfunctions and i is the identity matrix by substituting v a 1 1 a 2 c into the concentration stability equations eq 26 can be reduced to 27 a 4 a 3 a 1 1 a 2 σ i c 0 this eigenvalue problem is solved numerically and the maximum eigenvalue of the coefficient matrix is considered as the growth rate corresponding to the assigned wavenumber at a certain diffusive time τ0 a positive growth rate at a particular time is an indication of instability thus the onset time can be detected using a zero maximum growth rate i e the time at which the growth rate turns positive at a given wave number represents the onset of instability negative growth rates for every wavenumber suggest a stable system for brevity we refer the reader to the previous studies for more details on numerical procedure and validity of the computational algorithm riaz et al 2006 tan and homsy 1986 4 results and discussion 4 1 linear stability analysis 4 1 1 linear decline linear stability analysis lsa was conducted to parameterize the effect of the time dependent boundary condition on the growth rate of perturbations and consequently the onset of natural convection the lsa was conducted for a wide range of physical parameters of the time dependent boundary condition first we study the stability of a system imposed to a linear decline followed by a constant concentration of χ 0 at the upper boundary the stability analysis on the linear decline boundary condition is important not only in convective dissolution of co2 into brine in a sequestration process akhbari and hesse 2017 hassanzadeh et al 2006 wen et al 2018 but also in contaminant transport and waste disposal gao et al 2013 shen and chengji 2015 truex et al 2015 xie et al 2010 and crystallization processes and magma chambers holness et al 2006 kuritani et al 2007 worster et al 1990 lsa results show that the behavior of such a system is controlled by the concentration decline factor the perturbation growth rates for a system with constant concentration boundary α 0 χ 1 is shown in fig 4 a for this limiting case the stability analysis predicts the negative perturbations growth rates at early times τ0 25 and 37 5 suggesting an unconditionally stable system at these times as time increases the perturbations grow such that growth rates turn positive at critical time τc 56 at the corresponding wavenumber of κc 0 064 representing the onset of instability similar stability criterion has been reported in previous studies for systems with the same configuration and boundary conditions jafari raad and hassanzadeh 2015 meulenbroek et al 2013 tilton et al 2013 fig 4 b shows dispersion curves for the same system imposed to linear decline in concentration at the upper boundary with various decline factors at τ0 62 5 perturbations growth rate for the system with constant concentration boundary α 0 χ 1 at the similar time is also shown for comparison the results reveal that increase of decline factor slows down the growth of perturbations suggesting more stable diffusive boundary layer in other words increasing the decline factor has a stabilizing effect in a system with a linear decline boundary as it was discussed earlier this is attributed to a lower interface concentration at higher decline factor the same observations have been reported in earlier studies hassanzadeh et al 2006 wen et al 2018 the general effect of decline factor can be seen from fig 5 where the maximum growth rates σ max and the corresponding wavenumbers κmax are shown for systems with different decline factors α 0 0 0001 0 001 0 002 0 003 and 0 004 inspection of the maximum growth rates obtained for systems with different decline factors shown in fig 5 a indicates the significant impact of decline factor the effect of a large decline factor is to reduce the maximum growth rate significantly suggesting the stabilizing effect of the decline factor it can be seen that the maximum growth rate increases rapidly reaches a maximum and decreases the results show that systems with larger decline factor lead to higher attenuation of the instabilities while the late time evolution of the maximum growth rate scales with τ 1 4 for the system with constant concentration at the upper boundary α 0 the maximum growth rate scales with τ 5 8 in system with α 0 003 fig 5 b shows that the maximum wavenumber is also controlled by the decline factor while evolution of the maximum wavenumbers the most dangerous wavenumber for the constant boundary system α 0 decays as τ 1 4 it decays faster as τ 1 3 2 for system with α 0 003 a more general overview of the impact of the decline factor on the stability behavior of the diffusive boundary layer is provided using the neutral stability curves fig 6 shows the neutral stability curves for different decline rate the results for the system with a α 0 is also shown for comparison the neutral stability curves clearly show that the decline factor negatively affects the instability of the systems the instability limit shrinks and moves upward as the decline factor increases suggesting increase of the critical time this observation suggests that the system turns more stable at a higher decline factor it can be observed that the shrinkage effect is significant for a system with a large decline factor such as α 0 004 this behavior is mostly attributed to the lower mass flux at the interface at higher decline factor see fig 3b as the decline factor increases the support of the concentration source at the interface to the underlying diffusive boundary layer decreases this leads to small penetration depth of the diffusive front the weak buoyancy force and a delayed onset this may also result in attenuation of the already initiated instabilities at earlier times it can be also observed that the loci of the critical times marked by filled circles moves toward smaller wavenumbers as the decline factor increases it is worth noting that minimum of the neutral stability curve indicates the critical time τc to further clarify the effect of decline factor on the stability criteria of the diffusive boundary layer results of lsa for the scaled critical time and the corresponding wavenumber as a function of decline factor are shown in fig 7 the results show that the scaled critical time increases as the decline factor increases suggesting a more stable diffusive boundary layer the results reveal that the critical time and the corresponding wavenumbers are not sensitive to the decline of concentration when the decline factor is less than 10 4 for systems with decline factors less than 10 4 the scaled critical time and the corresponding wavenumber recover the scaling relations τc 55 6 and κc 0 0583 respectively these scaling relations are similar with those reported for the case of constant boundary condition α 0 for this particular case tilton et al tilton et al 2013 reported τc 55 62 and κc 0 058 which are quite close to those predicted in our analysis the critical time and wavenumber both reveal a non linear dependence for decline factors greater that 10 4 the scaled critical time and the corresponding wavenumbers increases decreases monotonically with the decline factor for the intermediate decline factor values of 10 4 α 4 4 10 3 followed by a sharp increase of the critical time suggesting an unconditionally stable system the results of lsa imply that both the onset and the wavelength of instabilities are controlled by the decline factor for 10 4 α 4 4 10 3 4 1 2 linear decline followed by constant concentration we extended our analysis to study the effect of a boundary condition which is described by a linear decline followed by constant concentration χ 0 this stability analysis is important in understanding the stability behavior of systems that experience a nearly uniform state after a temporal change in the upper boundary the presented analysis may find application in many material processing and industrial settings where convection can be accelerated or delayed by proper tuning of the boundary parameters the neutral stability curves for decline factors of α 0 01 and 0 1 at various concentrations of χ 0 3 0 5 and 0 7 are shown in fig 8 the neutral curve for χ 1 α 0 is also shown for comparison it can be observed that the instability limit in the neutral stability curves shown in figs 8 a c shift upward significantly as the concentration decreases the result also shows that the neutral stability curves considerably shrink as the concentration decreases suggesting a reduced instability region σ 0 it can be also observed that the loci of the critical points κc τc marked by filled symbols moves toward smaller wavenumbers as the concentration decreases in general a system with lower concentration leads to larger critical time reduced unstable region and much smaller dominant wavenumbers this is attributed to the lower interface concentration which negatively affects the growth of diffusive boundary layer comparison of the neutral stability curves for systems with different decline factors α 0 01 and 0 1 shown in figs 8 a and 8 c respectively demonstrates that α 0 1 leads to higher critical times than α 0 01 this observation reflects the stabilizing effect of the decline factor figs 8 b and d show the rescaled neutral stability curves where the transient time and the wavenumber are rescaled by χ as τ χ 2 and κ χ respectively interestingly this rescaling collapses all neutral curves to a single one with unique critical point κc τc for systems with α 0 1 suggesting a unified stability region as shown in fig 8 d this observation reveals that stability of a system with a large decline factor is controlled by the constant concentration portion of the boundary condition in other words the impact of decline factor on the stability of a system with linear decline followed by constant concentration decreases as the decline factor increases in fact as the decline factor increases the interface concentration reaches to the constant regime faster and consequently the behavior of the system with the constant concentration boundary is recovered more quickly the rescaled critical time and the corresponding wavenumber against the decline factor α for various concentrations of χ 0 0 0 3 0 5 and 0 7 are shown in fig 9 the results for the case of χ 1 α 0 is also shown for comparison as expected the system becomes more stable as the decline factor increases the results reveal three regions of instability in the first region α 10 4 the stability of the system is independent from the linear decline factor as well as the constant portion of the boundary condition in fact the drop of the interface concentration is so slow at small decline factors α 10 4 such that the onset is nearly unaffected by the decline of concentration at the upper boundary in other words stability of this region behaves similar to that of a constant concentration case reported in the literature meulenbroek et al 2013 tilton et al 2013 this region is followed by a non linear region 10 4 α 10 2 where both the decline factor and the constant concentration portion of the boundary condition play a role in the third region α 10 2 stability of the system is governed only by the constant concentration portion of the boundary condition this is attributed to the quick transitions of the interface concentration to the constant concentration at large decline factors α 10 2 the results shown in figs 9 c d reveal that for cases with χ 1 the rescaled critical time and the corresponding wavenumbers increases decreases and approaches the classical cases of constant concentration boundary condition jafari raad and hassanzadeh 2015 4 1 3 symmetric flat floored valley shape boundary condition a flat floored valley shape boundary condition is characterized by a linear decline a constant concentration portion followed by a linear rise the stability analysis on the behavior of the system with symmetric flat floored valley shape boundary condition provide fundamental understanding on the stability of the systems subject to cyclic boundary conditions in re entry heating or and periodic induced flow problems systems with re entry heating and periodic boundary condition find application in many industrial and environmental settings such as geothermal reservoir engineering underground waste management and industrial emergency cooling systems a controlled induced periodic boundary condition can also be used as a mechanism to control convection in the case of materials processing applications to attain higher efficiencies and to advance convection in achieving major enhancement of heat mass and momentum transfer kwak and hyun 1996 wu and wang 2017 although natural convection in porous media under periodic boundary conditions have been addressed in previous studies bhadauria et al 2013 caltaoirone 1976 chhuon and caltagirone 1979 kwak and hyun 1996 nield and bejan 2006 steen and aidun 1988 wu and wang 2017 xie et al 2010 to the best of our knowledge this is the first parametric analysis that addresses the role of boundary parameters on the stability behavior during each period of the boundary oscillation this analysis provides useful insight into the stability behavior of the system during each period and can be used as a tool for proper parameter tuning in an engineered natural convection problem the results of lsa for the scaled critical time and the corresponding wavenumber as a function of decline factor for this boundary condition are shown in fig 10 fig 10a and b show the critical time and the corresponding wavenumber for a case with χ 0 7 respectively for different θ 0 0 0 1 0 25 0 5 and 1 0 figs 10c and 10d show the same results for a case with χ 0 5 it is worth noting that θ τ1 τ2 is a measure of the duration of the constant boundary condition flat portion of the valley and thus smaller θ indicates longer duration of the flat portion the behavior of the critical time and the corresponding wavenumber for each case is shown a case with linear decline followed by a zero concentration is also shown for comparison the critical time and the corresponding wavenumber for this special case at a decline factor of 4 10 3 approach infinity and zero respectively which are illustrated by the vertical dashed lines and have been previously shown in figs 5 and 9 in addition a symmetric v shape boundary θ 1 is also shown for comparison for a boundary condition of interest which is a symmetric flat floored valley shape boundary condition the gradual increase of the onset time by increasing the decline factor shown by blue dashed line is partly due to the duration of the flat portion of the boundary condition the maximum critical times shown by triangles mark the rise of concentration at the top boundary the decline factor at which the onset time reaches a maximum depends on the duration of the flat portion of the boundary condition a longer duration of the flat portion smallerθ shows stronger stabilization effect of the boundary the concentration rise at the boundary leads to decline of the critical time shown by brown dashed line that approaches the classical case τc 55 6 the same observations can be made for the behavior of the critical wavenumber 4 2 numerical simulation we have conducted full numerical simulations to gain further insight into the instability behavior and the nonlinear dynamics of mixing beyond the onset we solved the nonlinear problem with a high accuracy numerical model developed based on a well known impec approach where the implicit scheme is used to discretize flow eqs 3 4 while the transport eq 2 are treated explicitly settari 2001 the developed numerical model is based on a uniform cartesian grid and second order finite difference discretization of the governing eqs 2 4 the numerical model considers the physical domain and the boundary conditions described in fig 1 one may refer to previous publications hassanzadeh et al 2007 for further details on the numerical model and controls on the accuracy and convergence of the numerical solutions 4 2 1 linear decline we studied the effect of the linear decline factor on the onset of convective dissolution and the associated dynamics in systems with a linearly decreasing ramp concentration boundary the concentration distributions space time concentration maps and the time dependent sherwood number as the most practical measures of convective dissolution are considered in analysis that follows the 2d numerical solutions were conducted to evaluate the concentration distribution associated with the convective dissolution the domain size is chosen to ensure that the numerical solutions are independent from the domain aspect ratio and the lateral boundaries could not influence the evolution of convective fingers fig 11 shows the time evolution of concentration distribution for systems with time dependent concentration boundary at different decline factors of α 0 0 00004 and 0 0004 it can be observed that these systems exhibit different instability behavior followed by different fingering pattern the results show that the systems with α 0 results in faster development of the instabilities compared to the cases with declining concentration at the top boundary these observations are in agreement with the results of stability analysis as it was discussed earlier this instability behavior is attributed partly to the growth of the diffusive boundary layer under the consequence of the time dependent concentration at the upper boundary as the decline factor increases the interface concentration that supports the growth of boundary layer decreases faster leading to lower mass flux fig 12 a shows space time maps of the concentration of the solute along a horizontal slice below the interface z 0 results of the space time concentration maps show that lateral spreading and merging of the developed fingers in the system when α 0 is more vigorous than those in the system with α 0 0004 the results also show that the system with α 0 leads to fingering pattern with shorter wavelength compared to the system with α 0 0004 to gain a better understanding of the instability behavior of the diffusive boundary layer and the dynamics of mixing process beyond the onset of instability we analyzed the time dependent sherwood number as a measure of the dissolution process sherwood number is defined as the ratio of the total dissolution flux to the pure diffusion flux sh ftotal fdiffusion where the dissolution flux per unit area is define as 28 f τ 1 a d d τ v c τ d v where v indicates the domain pore volume a is the cross sectional area of the interface and c is total concentration of the solute in the entire domain fig 12 b compares the time dependent sherwood number sh τ at the early times for the three cases shown in fig 12 a it can be observed that the sherwood number is unity at early times for all three cases suggesting a diffusion dominant mechanism fig 12 b reveals that the sherwood number for the system with α 0 deviates earlier from unity than that of α 0 00004 implying an earlier onset of convection for systems with smaller decline factor it is seen from fig 12 b that the diffusion is the dominant transport mechanism for the system with α 0 0004 these results confirm the linear stability analysis predictions on the effect of decline factor on the instability behavior of diffusive boundary layer in systems with a decreasing ramp concentration boundary 4 2 2 linear decline followed by constant concentration next we considered the effect of linear decline followed by constant concentration on the onset of convection and the dynamics of convective dissolution fig 13 presents the time evolution of concentration distribution for different concentrations of χ 0 7 0 5 and 0 3 while the decline factor remained constant at α 0 004 results for a system with a constant concentration boundary χ 1 is also shown for comparison consistent with the result of lsa fig 13 demonstrates that a system with lower concentration results in weaker development of instability leading to delayed onset of free convection comparison of the developed fingering patterns show that systems with a smaller concentration result in sluggish form of fingers associated with low rate of convective dissolution due to the presence of less dense mixture on the upper layer this is attributed to the fact that the flux of solute into the domain decreases when the concentration is lower at the interface which suppresses the growth of convective fingers along the vertical direction the results show that the magnitude of constant concentration following the linear decline significantly affects the wavelength of the density driven fingers such that systems with higher concentration result in fingers with smaller wavelengths fig 14 depicts space time contour maps of the solute concentration along a horizontal slice located just below the interface at z 0 as well as the time dependent sherwood number for the same cases shown in fig 13 the evolution of the fingers root concentration in fig 14 a demonstrates that the growth of the diffusive boundary layer is significantly controlled by the magnitude of the constant concentration following the linear decline it can be observed from these maps that systems with higher concentration lead to larger number of fingers associated with stronger finger roots it is seen from the space time map that finger interaction increases over time leading to a smaller number of dominant fingers the finger root concentration significantly reduced in the system with χ 0 3 leading to a fading finger pattern fig 14 b shows the numerical measurements of sherwood number as a function of time it can be observed that the magnitude of the constant concentration following the linear decline significantly influences the onset marked by the deviation of sherwood number from unity numerical results confirm that systems with higher concentration lead to earlier onset time examination of the sherwood number beyond the onset shows that a system with higher concentration results in a larger sherwood number implying a stronger convective flux as compared to other cases with lower concentration higher convective dissolution rate in systems with higher concentration ratio is attributed to the strong interaction and merging of fingers as they propagate downward these results show the important role of the constant concentration following the linear decline on evolution of the onset of convection and the dynamics of convective dissolution 4 2 3 symmetric flat floored valley shape boundary condition as the last part of our analysis the impact of a symmetric flat floored valley shape boundary condition on the onset of convection and the dynamics of mixing was investigated in particular we studied the effect of duration of the constant concentration flat portion of the valley by considering θ 0 1 0 25 0 5 and 1 0 while the decline factor and concentration remained constant at α 0 004 and χ 0 5 respectively it is worthwhile noting that θ τ1 τ2 and smaller θ indicates longer duration of the flat portion and θ 1 denotes a symmetric v shape boundary condition the temporal concentration distributions presented in fig 15 demonstrates that a system with larger time ratio θ results in faster development of instabilities in form of fingers this is in agreement with the results of lsa this observation is attributed to the fact that the as the time ratio increases the supporting flux for evolution of density driven fingers is stronger leading to more vigorous fingering careful review of the fingering patterns in systems with different θ shows that while the onset time and fingering patterns at the early times are different they lead to almost similar fingering pattern at the later times τ 5000 this behavior can be credited to the same supporting flux into the domain at the late times while a maximum interface concentration is established for all four considered cases this can be also observed from the space time maps shown in fig 16 a where almost the same fingering root patterns is seen for all cases at the late times τ 5000 numerical results of time dependent sherwood number shown in fig 16 b confirm that systems with shorter duration of the constant concentration flat portion of the valley lead to earlier onset time as well as stronger convective dissolution at early times beyond the onset 5 summary and conclusion linear stability analysis lsa and direct numerical simulations dns were conducted to study the effect of interface boundary excitation on the onset of convection and associated dynamics of convective dissolution stability behavior of the gravitational unstable diffusive boundary later was characterized as a function of parameters of a well defined time dependent interface concentration profile it was found that for a system with a linear decline α in concentration at the interface the onset time monotonically increases for 10 4 α 4 4 10 3 beyond which the system turns to become unconditionally stable the scaled critical time and the corresponding wavenumber were found as τc 55 6 and κc 0 0583 respectively for α 10 4 it was also observed that the instability behavior of systems with a linear decline followed by constant concentration is controlled by the constant concentration portion of the boundary condition such that the scaled critical times and the most dangerous wavenumbers lead to single scaling relations of τc 55 6 χ 2 and κc 0 0583χ respectively for α 10 1 it was shown that for a symmetric flat floored valley shape boundary condition the scaled critical time decreases by decreasing the duration of the flat portion of the boundary condition for the intermediate values of the decline factor 3 10 3 α 10 for the same interface boundary condition it was observed that the scaling relations for the critical time and the critical wavenumber at either large α 101 or small α 10 4 decline factors can be described as those in the classical system with constant concentration of χ 1 the dynamics of convective dissolution was also investigated using direct numerical simulations the results of numerical simulations confirm the general stability criteria predicted by the linear stability analysis the results also show that in addition to the onset time the development of instabilities in form of density driven fingers and the associated dynamics of convective dissolution are controlled by the interface boundary condition acknowledgments the authors would like to thank the anonymous reviewers for their constructive comments this work was supported by a discovery grant from the natural sciences and engineering research council of canada nserc alberta innovates technology futures aitf and was enabled in part by support provided by westgrid www westgrid ca and compute canada calcul canada www computecanada ca the first author also gratefully acknowledges the john and willie leone family department of energy and mineral engineering at pennsylvania state university for their hospitality supplementary material supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2019 02 005 appendix b supplementary materials image application 1 appendix a comparison of early time diffusive flux as it was discussed earlier the linear decline boundary condition with small values of decline factor may find application in gas liquid dissolution and absorption processes especially in system with small dissolution capacity where the interface concentration varies linearly over time here it is shown that the linear decline boundary condition with a low decline factor is able to reasonably resemble the diffusive flux the top boundary as compared to case when the boundary is coupled with a finite gas cap wen et al 2018 while the linear decline boundary condition does not resemble the pressure dependent concentration of co2 at the interface when a co2 gas cap is coupled with the underlying brine it can be shown that it recovers the flux at the top boundary for cases with small decline factor the solutions for the pressure dependent interface concentration wen et al 2018 and the linear decline concentration boundary are given by a1 c z d t d 1 1 π n 1 e μ n 2 t 2 π cos μ n z d 2 μ n sin μ n z d μ n 2 π π 2 0 z d 1 where μ n are the roots of the nonlinear equation tan μ n μ n π 0 n 1 2 a2 c z d t d 1 a d t d 4 π n 1 1 2 n 1 cos β n 1 z d e β n 2 t d a d β n 2 e β n 2 t d 1 0 z d 1 where z the height of the domain and positive downward and time are scaled by height of domain h and the diffusive time scale h2 d respectively βn 2n 1 π 2 and π and ad are dissolution capacity and the decline rate in the h scale system given by π vmkhrt vg wen et al 2018 and a d α k δ ρ g h ϕ μ d 2 rescaled α in the this study respectively we examined the diffusive flux as the most important factor in controlling the onset of instability for both pressure dependent and the linear decline boundary condition as shown in fig a1 the results for constant concentration boundary π a d 0 is also shown for comparison fig a1 shows that a system with the linear decline reasonably recovers the behavior of diffusive flux in a co2 water system at early times for small dissolution capacities i e π 0 5 a d 0 5 
684,we study the effects of boundary excitation on the onset of natural convection and the dynamics of subsequent convective mixing by conducting linear stability analysis lsa and direct numerical simulations dns a detailed parametric analysis on the stability of a diffusive boundary layer in porous media subject to three different types of linear decline linear decline followed by constant concentration and symmetric flat floored valley shape boundary conditions is presented we propose scaling relations based on results of lsa to describe the critical time and the associated wavenumber of convective instabilities that incorporate the effect of the boundary parameters the lsa results show that the classic onset criterion is applicable when decline factors α is smaller than 10 4 the results also demonstrate that α does not play a significant role in the instability of the system unless it is greater than 10 4 the results show that in systems with linear concentration decline followed by constant concentration the impact of decline on the stability of the system decreases as α increases based on the lsa results a system with α 10 2 leads to unified stability criteria at different constant concentration χ similar to the classic problem when the transient time τ and the wavenumber κ are rescaled by χ as τχ 2 and κ χ respectively our results also show that the duration of the flat portion in symmetric flat floored valley shape boundary condition is the main factor controlling the stability behavior of the system the dns results reveal that the dynamics of the buoyancy driven mixing is also significantly influenced by the temporal variation of concentration at the boundary these findings improve our understanding of buoyancy driven instabilities in the presence of boundary excitation and finds applications in thermal and solutal convection in porous media keywords buoyancy driven flows thermal convection solutal convection boundary excitation linear stability analysis 1 introduction solutal and thermal convection in porous media has wide range of applications in a number of fields such as geological flows groundwater hydrology diersch and kolditz 2002 simmons 2005 van dam et al 2009 waste disposal liu and dane 1996 mao et al 2006 schincariol and schwartz 1990 yang and edwards 2000 carbon dioxide sequestration emami meybodi et al 2015 lindeberg and wessel berg 1997 riaz et al 2006 petroleum reservoir engineering and geothermal reservoirs coumou et al 2008 horton and rogers 1945 zhao et al 2008 solutal and thermal convection can develop due to negative density gradients in the gravity field resulted from temperature and or concentration landau and lifshitz 2004 nield and bejan 2006 evolution of natural convection in porous media enables efficient heat solute transport over larger spatial and time scales than those achieved by molecular diffusion theoretical basis and importance of natural convection in porous media have been very well discussed in the book by nield and bejan 2006 stability of the diffusive boundary layer in porous media with different types of boundary conditions such as step change boundary condition elder and w 1967 ennis king et al 2005 nield and bejan 2013 constant flux boundary ingham and pop 2005 pop and ingham 2001 vafai 2005 partially permeable boundary elenius et al 2012 slim 2014 slim and ramakrishnan 2010 and moving boundary condition meulenbroek et al 2013 myint and firoozabadi 2013 has been widely discussed in the literature however these investigations are mainly concerned with systems with either fully developed or time independent base state ingham and pop 2005 nield and bejan 2013 pop and ingham 2001 vafai 2005 or constant boundary type problems elenius et al 2012 ennis king et al 2005 meulenbroek et al 2013 myint and firoozabadi 2013 slim 2014 slim and ramakrishnan 2010 where the imposed boundary is independent of time stability of fluids in porous media with boundary excitation is of particular interest especially in connection with the geophysical and environmental problems there are relatively very few studies available that look into the effect of interface boundary excitation on the stability of diffusive boundary layers in porous media hassanzadeh et al hassanzadeh et al 2006 studied the effect of linear decline negative ramp in concentration at the top boundary on the onset of convection in a transient diffusive layer using a linear stability analysis they found that the decline factor significantly affects the stability of the diffusive boundary layer in systems with low ra number ra 250 it was reported that the growth of the perturbations in systems with low ra number attenuates as the decline factor increases it was also observed that the effect of decline factor on the stability of systems with large ra number r 500 can be negligible more recently wen et al wen et al 2018 studied the dynamics of convective mixing in a closed porous system in the context of co2 sequestration it was shown that the pressure drop in the gas phase during dissolution of gas in water negatively affects both diffusive and convective mass transport of co2 it was reported that the pressure drop in a closed system decreases the dissolution flux and limits the convection before the underlying brine begins to saturate however these studies were either concerned with the dynamics of convective mixing in a finite domain wen et al 2018 or restricted to a simplified form of a time dependent boundary condition hassanzadeh et al 2006 these studies do not present any parametric analyses on the stability criterion of the system the objective of the present study is to perform an inclusive analysis of the instability and the associated dynamics of solutal natural convection in saturated porous media in the presence of boundary excitation the presented analysis and results in this study provide fundamental understanding of natural convection in the presence of boundary excitation three different types of time dependent boundary conditions are used to simulate the concentration excitation at the interface the effect of boundary excitation on the onset of instabilities and subsequent convective mixing is discussed a linear stability analysis using quasi steady state approximation qssa is conducted to study the effect of time dependent concentration boundary on the instability behavior of a gravitationally unstable diffusive boundary layer we present new scaling relations for the onset of convective instabilities in systems with linear decline linear decline followed by constant concentration and symmetric flat floored valley shape boundary conditions the developed scaling relations can be used to estimate the onset of density driven instabilities as a function of the characteristics of the boundary condition and the physical properties of the porous layer the dynamics of the system beyond the onset time is also studied using direct numerical simulations although we focus on solutal natural convection the insight developed here can be applied equally to thermal problems this paper is organized as follows in section 2 we describe the problem of interest via presenting the governing equations and boundary conditions followed by a base state solution for the diffusive mass transfer with time dependent boundary condition in section 3 mathematical formulation of linear stability analysis is presented results and discussion are presented in section 4 followed by section 5 which is summary and conclusion of this study 2 mathematical formulation 2 1 governing equations we consider a two dimensional homogeneous isotropic isothermal vertical cross section of a porous layer with thickness h as shown in fig 1 a the porous layer is saturated with a quiescent fluid which is initially free of solute a cartesian coordinate system was chosen with the z axis pointing downward the porous layer is assumed to be infinite in the x direction the bottom boundary is assumed to be impermeable to flow with zero mass flux the top boundary is also assumed impermeable to flow but is imposed to a time dependent concentration as shown in fig 1 b the time dependent concentration at the top boundary is defined as 1 c z 0 c 2 c 1 c 2 t 1 t t 1 h t 1 t c 3 c 2 t t 2 t 3 t 2 h t t 2 c 3 c 2 1 t t 2 t 3 t 2 h t t 3 where c is the concentration of the diffusing species t is the time c 1 c 2 c 3 are the concentration at z 0 for t 0 t 1 t t 2 and t t 3 respectively h is the heaviside step function h t 1 if t 0 and h t 0 if t 0 assuming the boussinesq approximation is valid and rock and fluid compressibility effects are negligible and in the absence of viscosity variation and dispersion effects the governing equations of non reactive single phase flow and transport can be written as bear 1972 2 d ϕ 2 c v c ϕ c t 3 v 0 4 v k μ p ρ g where v u v is the darcy velocity vector u and v are the horizontal and vertical components of the velocity vector respectively p is the pressure k is the porous medium permeability μ is the viscosity g is acceleration due to gravity z is the vertical coordinate positive downwards ρ is the density ϕ is the porosity and d is the effective molecular diffusion coefficient of the diffusing species in porous media and is assumed to be independent of concentration for dilute solutions it was assumed that density is a linear function of the local concentration of the dissolved species 5 ρ ρ 0 1 β c where ρ 0 is the fluid density at c 0 and β 1 ρ ρ c which can be obtained from an equation of state the governing equations were nondimensionalized by choosing c 1 as the concentration scale the buoyancy velocity ub kδρg μ as the velocity scale l dϕμ kδρg with δρ βρ0 c 1 as the length scale and d l 2 as the time scale it is worth noting that using height of the domain as the length scale would make it difficult if not impossible to distinguish the effect of top and bottom boundary in the finite domain and parameterize the role of the top boundary on the onset of convection in fact the defined decline rate α in h scaled system such as those used by hassanzadeh et al 2006 and wen et al 2018 contains h meaning that both alpha α and ra change with the height of the domain in this case depending on ra both top and bottom boundary would affect the behavior of diffusive flux and consequently onset of instability in a same fashion in other words for h scaled system change in α π in wen et al 2018 could mean either change in the decline rate for the concentration at the top boundary or change in h which may involve the bottom boundary effect therefore the used scaling may lead to misleading results especially in systems with low ra numbers here we intentionally use l dϕμ kδρg as the length scale to avoid this scaling problem and let α to only capture the top boundary features in other words time dependent nature of top boundary is isolated from the size of the domain accordingly the dimensionless form of the governing equations for flow and transport can be expressed as 6 2 v η 2 2 v ξ 2 2 c η 2 7 c τ 2 c η 2 2 c ξ 2 u c η v c ξ 2 2 base state solution at the early times when the thickness of the diffusive boundary layer δ 4 d t bird et al 2002 is very small compared to the height of the porous layer δ h the domain can be considered as a semi infinite medium in the z direction eqs 6 and 7 are subject to the following conditions 8a v ξ 0 v ξ 0 8b c ξ 0 9 c ξ 0 χ 2 χ 1 χ 2 α 1 τ h χ 2 χ 1 α 1 τ α 2 τ χ 2 χ 1 α 1 θ h τ χ 2 χ 1 α 1 θ χ 3 χ 2 α 2 τ χ 2 χ 1 α 1 θ h τ χ 3 χ 2 α 2 χ 2 χ 1 θ α 1 where χi ci c1 α1 χ2 χ1 τ1 α2 χ3 χ2 τ3 τ2 and θ τ1 τ2 fig 2 shows the dimensionless form of the time dependent concentration profile imposed at the upper boundary of the porous layer since the system is motionless prior to the onset of instabilities the bases state velocity is zero at the early times prior to the onset of instabilities the molecular diffusion is the dominant transport mechanism therefore eq 7 can be written as 10 c b τ 2 c b ξ 2 the time dependent base state solution of eq 10 subjects to the initial condition cb τ 0 0 and the boundary conditions given in eq 9 can be obtained using duhamel s theorem carslaw and jaeger 1959 11 c b ξ τ e r f c ξ 4 τ α 1 ω 0 ψ 0 α 1 ψ 1 ω 1 h τ χ 2 χ 1 α 1 α 2 ω 2 ψ 2 h τ χ 2 χ 1 α 1 θ α 2 ψ 3 ω 3 h τ χ 3 χ 2 α 2 χ 2 χ 1 θ α 1 where 12a ω i ξ τ ξ 2 2 τ τ i e r f c ξ 2 τ τ i 12b ψ i ξ τ ξ τ τ i π exp ξ 2 4 τ τ i for the limiting case of α 2 α 1 α χ3 χ1 1 and considering χ χ2 i e the time dependant bouandry eq 9 can be expressed as 13 c ξ 0 χ 1 α τ χ h 1 χ α τ α τ 1 χ θ h τ 1 χ α θ 1 χ α τ 1 χ θ h τ 1 χ θ 1 α θ and the base state solution eqs 11 and 12 is given as 14 c b ξ τ e r f c ξ 4 τ α ψ 0 ω 0 ω 1 ψ 1 h τ 1 χ α ω 2 ψ 2 h τ 1 χ α θ ψ 3 ω 3 h τ 1 χ θ 1 α θ the dissolution flux per unit area at the interface z 0 can be obtained as 15 f t d 0 ϕ c 0 t z d x using the diffusive time and length scales the non dimensional form of the flux can be expressed by 16 j τ f u b c 1 according to eqs 14 16 the diffusive flux at ξ 0 can be written as 17 j d i f f 1 π 1 τ λ 0 h τ 1 χ α λ 1 h τ 1 χ α θ λ 2 h τ 1 χ θ 1 θ α λ 3 where λ i 2 α τ τ i fig 3 shows the diffusive flux at the interface ξ 0 for systems imposed to the time dependent concentration boundary fig 3 a presents the diffusive flux for the system with a linear decline concentration boundary at different α 10 5 10 4 10 3 10 2 and 0 1 followed by a constant concentration of χ 0 the inset plot in fig 3 a shows the boundary condition a case with α 0 χ 1 is also shown for comparison it can be observed that the decline factor significantly influences the diffusive flux the linear decline boundary condition with small values of decline factor resembles gas absorption and co2 dissolution in water later in appendix it is shown that the linear decline boundary condition with a low decline factor is able to reasonably resemble the early time behavior of diffusive flux in a close system where the boundary is coupled with a finite gas cap wen et al 2018 fig 3 b shows the log log scale of the same results while for a system with a constant boundary condition α 0 0 χ 1 the diffusive flux declines as τ 1 2 at the early times the diffusive flux in systems with time dependent boundary condition α 0 χ 0 does not follow the same trend the results show that the diffusive flux decreases as the decline factor α increases fig 3 b reveals that at higher decline factors the diffusive flux departs earlier from τ 1 2 and declines much faster compared to the constant concentration boundary condition α 0 0 χ 1 at very high decline factors the diffusive flux turns to shut down even before the domain becomes saturated in this case due to the positive concentration gradient at the interface system may even lead to an out flux regime with a negative diffusive flux and act like a discharge problem see diffusive flux for systems with α 10 3 10 2 and 0 1 in other words the interface may reach a concentration lower than those of its underlying saturated fluid layers in systems with large decline factors this leads to a non uniform concentration distribution through the penetration depth of the diffusive front which negatively slows down the rate of dissolution the diffusive flux for a system with a linear decline α 0 01 followed by a constant concentration boundary at χ 0 0 0 1 0 3 0 5 0 7 1 is shown in fig 2 c the log log plot of the same results is shown in fig 3 d the inset plot in fig 3 c shows the boundary condition the diffusive flux for low values of χ follows a deep shut down during the decline of the interface concentration and then recovers after the decline is completed systems with χ 0 0 0 1 and 0 3 show a negative diffusive flux around their bounce back point as it was discussed earlier this behavior is attributed to the establishment of a positive concentration gradient at the interface where the effect of constant concentration boundary is not large enough to compensate the effect of the high decline rate and the interface reaches a lower concentration than that of the underlying fluid the diffusive flux deviates from the shutdown path and starts to recover as a consequence of establishment of the constant concentration boundary following the linear decline of the interface concentration the diffusive flux reaches a maximum and then declines and approaches the trend of the constant concentration boundary condition the results show that as χ increases the diffusive flux bounces back earlier and leads to a higher diffusive flux at the late time fig 3 e shows the diffusive flux for a system with a linear decline α1 0 01 followed by a constant concentration of χ 0 5 at the boundary succeeded by a linear positive ramp at α 2 0 01 at θ 0 1 0 25 0 5 0 75 1 0 and followed by a constant concentration of χ 1 a case with θ 1 is also shown for comparison the log log plot of the same results is shown in fig 3 f the inset plot in fig 3 e shows the boundary condition during the early time the diffusive flux goes to a deep shut down until the linear decline in the concentration of the top boundary is terminated it can be seen from fig 3 e that the diffusive flux experiences its bounce back just after the linear decline is over and the boundary profile turns flat at constant value of χ 0 5 the second bounce back occurs at the end of constant concentration period just after the linear ramp begins the diffusive flux then approaches the trend of a constant concentration boundary τ 1 2 at late time when the linear positive ramp is over and a constant concentration of χ 1 is established again the results demonstrate that as the time ratio θ decreases the second bounce back in the diffusive flux is delayed later we will show that how the dependency of the diffusive flux to the time dependent boundary condition may impact the onset and associated dynamics of convective dissolution 3 formulation of linear stability analysis to conduct linear stability analyis the base state is purturbed using ℜ ℜ b ℜ where ℜ v c and ℜ η ξ τ ε ℜ ξ τ exp i κ η are the infinitesimal perturbations of velocities and concentration where i is the imaginary unit and κ is the dimensionless horizontal wavenumber with a very small amplitude ε after substituting the perturbed variables into the flow and transport equations implementing the base state quantities linearizing the perturbations the following perturbed equations can be obtained 18 2 v ξ 2 κ 2 v κ 2 c 19 c τ 2 c ξ 2 κ 2 c c b ξ v the linearized eqs 18 and 19 were solved using a quasi steady state approximation qssa in which the disturbance quantities were assumed to have the following forms tan and homsy 1986 20 v ξ τ c ξ τ a τ 0 v ξ c ξ where variables defined by asterisks represent the perturbation eigenfunctions therefore the dimensionless growth rate σ reads 21 σ τ 0 1 a τ 0 d a d τ the time scales represented by τ and τ0 denote to the fast growing perturbations and the molecular diffusion time scales respectively using eq 20 eqs 18 and 19 can be written as 22 2 ξ 2 κ 2 v κ 2 c 0 23 c b ξ v 2 ξ 2 κ 2 c σ c 0 subject the following boundary conditions 24 v ξ 0 v ξ 0 25 c ξ 0 c ξ 0 to obtain the growth rate corresponding to an assigned wavenumber the system of perturbed eqs 22 and 23 are discretized using a second order finite difference method and then solved numerically the resulting discretized equations can be expressed by a system of linear equations 26a a 1 v a 2 c 0 26b a 3 v a 4 σ i c 0 where v and c are the eigenvectors for vertical velocity and concentration respectively a1 a4 are the coefficient matrices based on central discretization of the second derivatives related to the eigenfunctions and i is the identity matrix by substituting v a 1 1 a 2 c into the concentration stability equations eq 26 can be reduced to 27 a 4 a 3 a 1 1 a 2 σ i c 0 this eigenvalue problem is solved numerically and the maximum eigenvalue of the coefficient matrix is considered as the growth rate corresponding to the assigned wavenumber at a certain diffusive time τ0 a positive growth rate at a particular time is an indication of instability thus the onset time can be detected using a zero maximum growth rate i e the time at which the growth rate turns positive at a given wave number represents the onset of instability negative growth rates for every wavenumber suggest a stable system for brevity we refer the reader to the previous studies for more details on numerical procedure and validity of the computational algorithm riaz et al 2006 tan and homsy 1986 4 results and discussion 4 1 linear stability analysis 4 1 1 linear decline linear stability analysis lsa was conducted to parameterize the effect of the time dependent boundary condition on the growth rate of perturbations and consequently the onset of natural convection the lsa was conducted for a wide range of physical parameters of the time dependent boundary condition first we study the stability of a system imposed to a linear decline followed by a constant concentration of χ 0 at the upper boundary the stability analysis on the linear decline boundary condition is important not only in convective dissolution of co2 into brine in a sequestration process akhbari and hesse 2017 hassanzadeh et al 2006 wen et al 2018 but also in contaminant transport and waste disposal gao et al 2013 shen and chengji 2015 truex et al 2015 xie et al 2010 and crystallization processes and magma chambers holness et al 2006 kuritani et al 2007 worster et al 1990 lsa results show that the behavior of such a system is controlled by the concentration decline factor the perturbation growth rates for a system with constant concentration boundary α 0 χ 1 is shown in fig 4 a for this limiting case the stability analysis predicts the negative perturbations growth rates at early times τ0 25 and 37 5 suggesting an unconditionally stable system at these times as time increases the perturbations grow such that growth rates turn positive at critical time τc 56 at the corresponding wavenumber of κc 0 064 representing the onset of instability similar stability criterion has been reported in previous studies for systems with the same configuration and boundary conditions jafari raad and hassanzadeh 2015 meulenbroek et al 2013 tilton et al 2013 fig 4 b shows dispersion curves for the same system imposed to linear decline in concentration at the upper boundary with various decline factors at τ0 62 5 perturbations growth rate for the system with constant concentration boundary α 0 χ 1 at the similar time is also shown for comparison the results reveal that increase of decline factor slows down the growth of perturbations suggesting more stable diffusive boundary layer in other words increasing the decline factor has a stabilizing effect in a system with a linear decline boundary as it was discussed earlier this is attributed to a lower interface concentration at higher decline factor the same observations have been reported in earlier studies hassanzadeh et al 2006 wen et al 2018 the general effect of decline factor can be seen from fig 5 where the maximum growth rates σ max and the corresponding wavenumbers κmax are shown for systems with different decline factors α 0 0 0001 0 001 0 002 0 003 and 0 004 inspection of the maximum growth rates obtained for systems with different decline factors shown in fig 5 a indicates the significant impact of decline factor the effect of a large decline factor is to reduce the maximum growth rate significantly suggesting the stabilizing effect of the decline factor it can be seen that the maximum growth rate increases rapidly reaches a maximum and decreases the results show that systems with larger decline factor lead to higher attenuation of the instabilities while the late time evolution of the maximum growth rate scales with τ 1 4 for the system with constant concentration at the upper boundary α 0 the maximum growth rate scales with τ 5 8 in system with α 0 003 fig 5 b shows that the maximum wavenumber is also controlled by the decline factor while evolution of the maximum wavenumbers the most dangerous wavenumber for the constant boundary system α 0 decays as τ 1 4 it decays faster as τ 1 3 2 for system with α 0 003 a more general overview of the impact of the decline factor on the stability behavior of the diffusive boundary layer is provided using the neutral stability curves fig 6 shows the neutral stability curves for different decline rate the results for the system with a α 0 is also shown for comparison the neutral stability curves clearly show that the decline factor negatively affects the instability of the systems the instability limit shrinks and moves upward as the decline factor increases suggesting increase of the critical time this observation suggests that the system turns more stable at a higher decline factor it can be observed that the shrinkage effect is significant for a system with a large decline factor such as α 0 004 this behavior is mostly attributed to the lower mass flux at the interface at higher decline factor see fig 3b as the decline factor increases the support of the concentration source at the interface to the underlying diffusive boundary layer decreases this leads to small penetration depth of the diffusive front the weak buoyancy force and a delayed onset this may also result in attenuation of the already initiated instabilities at earlier times it can be also observed that the loci of the critical times marked by filled circles moves toward smaller wavenumbers as the decline factor increases it is worth noting that minimum of the neutral stability curve indicates the critical time τc to further clarify the effect of decline factor on the stability criteria of the diffusive boundary layer results of lsa for the scaled critical time and the corresponding wavenumber as a function of decline factor are shown in fig 7 the results show that the scaled critical time increases as the decline factor increases suggesting a more stable diffusive boundary layer the results reveal that the critical time and the corresponding wavenumbers are not sensitive to the decline of concentration when the decline factor is less than 10 4 for systems with decline factors less than 10 4 the scaled critical time and the corresponding wavenumber recover the scaling relations τc 55 6 and κc 0 0583 respectively these scaling relations are similar with those reported for the case of constant boundary condition α 0 for this particular case tilton et al tilton et al 2013 reported τc 55 62 and κc 0 058 which are quite close to those predicted in our analysis the critical time and wavenumber both reveal a non linear dependence for decline factors greater that 10 4 the scaled critical time and the corresponding wavenumbers increases decreases monotonically with the decline factor for the intermediate decline factor values of 10 4 α 4 4 10 3 followed by a sharp increase of the critical time suggesting an unconditionally stable system the results of lsa imply that both the onset and the wavelength of instabilities are controlled by the decline factor for 10 4 α 4 4 10 3 4 1 2 linear decline followed by constant concentration we extended our analysis to study the effect of a boundary condition which is described by a linear decline followed by constant concentration χ 0 this stability analysis is important in understanding the stability behavior of systems that experience a nearly uniform state after a temporal change in the upper boundary the presented analysis may find application in many material processing and industrial settings where convection can be accelerated or delayed by proper tuning of the boundary parameters the neutral stability curves for decline factors of α 0 01 and 0 1 at various concentrations of χ 0 3 0 5 and 0 7 are shown in fig 8 the neutral curve for χ 1 α 0 is also shown for comparison it can be observed that the instability limit in the neutral stability curves shown in figs 8 a c shift upward significantly as the concentration decreases the result also shows that the neutral stability curves considerably shrink as the concentration decreases suggesting a reduced instability region σ 0 it can be also observed that the loci of the critical points κc τc marked by filled symbols moves toward smaller wavenumbers as the concentration decreases in general a system with lower concentration leads to larger critical time reduced unstable region and much smaller dominant wavenumbers this is attributed to the lower interface concentration which negatively affects the growth of diffusive boundary layer comparison of the neutral stability curves for systems with different decline factors α 0 01 and 0 1 shown in figs 8 a and 8 c respectively demonstrates that α 0 1 leads to higher critical times than α 0 01 this observation reflects the stabilizing effect of the decline factor figs 8 b and d show the rescaled neutral stability curves where the transient time and the wavenumber are rescaled by χ as τ χ 2 and κ χ respectively interestingly this rescaling collapses all neutral curves to a single one with unique critical point κc τc for systems with α 0 1 suggesting a unified stability region as shown in fig 8 d this observation reveals that stability of a system with a large decline factor is controlled by the constant concentration portion of the boundary condition in other words the impact of decline factor on the stability of a system with linear decline followed by constant concentration decreases as the decline factor increases in fact as the decline factor increases the interface concentration reaches to the constant regime faster and consequently the behavior of the system with the constant concentration boundary is recovered more quickly the rescaled critical time and the corresponding wavenumber against the decline factor α for various concentrations of χ 0 0 0 3 0 5 and 0 7 are shown in fig 9 the results for the case of χ 1 α 0 is also shown for comparison as expected the system becomes more stable as the decline factor increases the results reveal three regions of instability in the first region α 10 4 the stability of the system is independent from the linear decline factor as well as the constant portion of the boundary condition in fact the drop of the interface concentration is so slow at small decline factors α 10 4 such that the onset is nearly unaffected by the decline of concentration at the upper boundary in other words stability of this region behaves similar to that of a constant concentration case reported in the literature meulenbroek et al 2013 tilton et al 2013 this region is followed by a non linear region 10 4 α 10 2 where both the decline factor and the constant concentration portion of the boundary condition play a role in the third region α 10 2 stability of the system is governed only by the constant concentration portion of the boundary condition this is attributed to the quick transitions of the interface concentration to the constant concentration at large decline factors α 10 2 the results shown in figs 9 c d reveal that for cases with χ 1 the rescaled critical time and the corresponding wavenumbers increases decreases and approaches the classical cases of constant concentration boundary condition jafari raad and hassanzadeh 2015 4 1 3 symmetric flat floored valley shape boundary condition a flat floored valley shape boundary condition is characterized by a linear decline a constant concentration portion followed by a linear rise the stability analysis on the behavior of the system with symmetric flat floored valley shape boundary condition provide fundamental understanding on the stability of the systems subject to cyclic boundary conditions in re entry heating or and periodic induced flow problems systems with re entry heating and periodic boundary condition find application in many industrial and environmental settings such as geothermal reservoir engineering underground waste management and industrial emergency cooling systems a controlled induced periodic boundary condition can also be used as a mechanism to control convection in the case of materials processing applications to attain higher efficiencies and to advance convection in achieving major enhancement of heat mass and momentum transfer kwak and hyun 1996 wu and wang 2017 although natural convection in porous media under periodic boundary conditions have been addressed in previous studies bhadauria et al 2013 caltaoirone 1976 chhuon and caltagirone 1979 kwak and hyun 1996 nield and bejan 2006 steen and aidun 1988 wu and wang 2017 xie et al 2010 to the best of our knowledge this is the first parametric analysis that addresses the role of boundary parameters on the stability behavior during each period of the boundary oscillation this analysis provides useful insight into the stability behavior of the system during each period and can be used as a tool for proper parameter tuning in an engineered natural convection problem the results of lsa for the scaled critical time and the corresponding wavenumber as a function of decline factor for this boundary condition are shown in fig 10 fig 10a and b show the critical time and the corresponding wavenumber for a case with χ 0 7 respectively for different θ 0 0 0 1 0 25 0 5 and 1 0 figs 10c and 10d show the same results for a case with χ 0 5 it is worth noting that θ τ1 τ2 is a measure of the duration of the constant boundary condition flat portion of the valley and thus smaller θ indicates longer duration of the flat portion the behavior of the critical time and the corresponding wavenumber for each case is shown a case with linear decline followed by a zero concentration is also shown for comparison the critical time and the corresponding wavenumber for this special case at a decline factor of 4 10 3 approach infinity and zero respectively which are illustrated by the vertical dashed lines and have been previously shown in figs 5 and 9 in addition a symmetric v shape boundary θ 1 is also shown for comparison for a boundary condition of interest which is a symmetric flat floored valley shape boundary condition the gradual increase of the onset time by increasing the decline factor shown by blue dashed line is partly due to the duration of the flat portion of the boundary condition the maximum critical times shown by triangles mark the rise of concentration at the top boundary the decline factor at which the onset time reaches a maximum depends on the duration of the flat portion of the boundary condition a longer duration of the flat portion smallerθ shows stronger stabilization effect of the boundary the concentration rise at the boundary leads to decline of the critical time shown by brown dashed line that approaches the classical case τc 55 6 the same observations can be made for the behavior of the critical wavenumber 4 2 numerical simulation we have conducted full numerical simulations to gain further insight into the instability behavior and the nonlinear dynamics of mixing beyond the onset we solved the nonlinear problem with a high accuracy numerical model developed based on a well known impec approach where the implicit scheme is used to discretize flow eqs 3 4 while the transport eq 2 are treated explicitly settari 2001 the developed numerical model is based on a uniform cartesian grid and second order finite difference discretization of the governing eqs 2 4 the numerical model considers the physical domain and the boundary conditions described in fig 1 one may refer to previous publications hassanzadeh et al 2007 for further details on the numerical model and controls on the accuracy and convergence of the numerical solutions 4 2 1 linear decline we studied the effect of the linear decline factor on the onset of convective dissolution and the associated dynamics in systems with a linearly decreasing ramp concentration boundary the concentration distributions space time concentration maps and the time dependent sherwood number as the most practical measures of convective dissolution are considered in analysis that follows the 2d numerical solutions were conducted to evaluate the concentration distribution associated with the convective dissolution the domain size is chosen to ensure that the numerical solutions are independent from the domain aspect ratio and the lateral boundaries could not influence the evolution of convective fingers fig 11 shows the time evolution of concentration distribution for systems with time dependent concentration boundary at different decline factors of α 0 0 00004 and 0 0004 it can be observed that these systems exhibit different instability behavior followed by different fingering pattern the results show that the systems with α 0 results in faster development of the instabilities compared to the cases with declining concentration at the top boundary these observations are in agreement with the results of stability analysis as it was discussed earlier this instability behavior is attributed partly to the growth of the diffusive boundary layer under the consequence of the time dependent concentration at the upper boundary as the decline factor increases the interface concentration that supports the growth of boundary layer decreases faster leading to lower mass flux fig 12 a shows space time maps of the concentration of the solute along a horizontal slice below the interface z 0 results of the space time concentration maps show that lateral spreading and merging of the developed fingers in the system when α 0 is more vigorous than those in the system with α 0 0004 the results also show that the system with α 0 leads to fingering pattern with shorter wavelength compared to the system with α 0 0004 to gain a better understanding of the instability behavior of the diffusive boundary layer and the dynamics of mixing process beyond the onset of instability we analyzed the time dependent sherwood number as a measure of the dissolution process sherwood number is defined as the ratio of the total dissolution flux to the pure diffusion flux sh ftotal fdiffusion where the dissolution flux per unit area is define as 28 f τ 1 a d d τ v c τ d v where v indicates the domain pore volume a is the cross sectional area of the interface and c is total concentration of the solute in the entire domain fig 12 b compares the time dependent sherwood number sh τ at the early times for the three cases shown in fig 12 a it can be observed that the sherwood number is unity at early times for all three cases suggesting a diffusion dominant mechanism fig 12 b reveals that the sherwood number for the system with α 0 deviates earlier from unity than that of α 0 00004 implying an earlier onset of convection for systems with smaller decline factor it is seen from fig 12 b that the diffusion is the dominant transport mechanism for the system with α 0 0004 these results confirm the linear stability analysis predictions on the effect of decline factor on the instability behavior of diffusive boundary layer in systems with a decreasing ramp concentration boundary 4 2 2 linear decline followed by constant concentration next we considered the effect of linear decline followed by constant concentration on the onset of convection and the dynamics of convective dissolution fig 13 presents the time evolution of concentration distribution for different concentrations of χ 0 7 0 5 and 0 3 while the decline factor remained constant at α 0 004 results for a system with a constant concentration boundary χ 1 is also shown for comparison consistent with the result of lsa fig 13 demonstrates that a system with lower concentration results in weaker development of instability leading to delayed onset of free convection comparison of the developed fingering patterns show that systems with a smaller concentration result in sluggish form of fingers associated with low rate of convective dissolution due to the presence of less dense mixture on the upper layer this is attributed to the fact that the flux of solute into the domain decreases when the concentration is lower at the interface which suppresses the growth of convective fingers along the vertical direction the results show that the magnitude of constant concentration following the linear decline significantly affects the wavelength of the density driven fingers such that systems with higher concentration result in fingers with smaller wavelengths fig 14 depicts space time contour maps of the solute concentration along a horizontal slice located just below the interface at z 0 as well as the time dependent sherwood number for the same cases shown in fig 13 the evolution of the fingers root concentration in fig 14 a demonstrates that the growth of the diffusive boundary layer is significantly controlled by the magnitude of the constant concentration following the linear decline it can be observed from these maps that systems with higher concentration lead to larger number of fingers associated with stronger finger roots it is seen from the space time map that finger interaction increases over time leading to a smaller number of dominant fingers the finger root concentration significantly reduced in the system with χ 0 3 leading to a fading finger pattern fig 14 b shows the numerical measurements of sherwood number as a function of time it can be observed that the magnitude of the constant concentration following the linear decline significantly influences the onset marked by the deviation of sherwood number from unity numerical results confirm that systems with higher concentration lead to earlier onset time examination of the sherwood number beyond the onset shows that a system with higher concentration results in a larger sherwood number implying a stronger convective flux as compared to other cases with lower concentration higher convective dissolution rate in systems with higher concentration ratio is attributed to the strong interaction and merging of fingers as they propagate downward these results show the important role of the constant concentration following the linear decline on evolution of the onset of convection and the dynamics of convective dissolution 4 2 3 symmetric flat floored valley shape boundary condition as the last part of our analysis the impact of a symmetric flat floored valley shape boundary condition on the onset of convection and the dynamics of mixing was investigated in particular we studied the effect of duration of the constant concentration flat portion of the valley by considering θ 0 1 0 25 0 5 and 1 0 while the decline factor and concentration remained constant at α 0 004 and χ 0 5 respectively it is worthwhile noting that θ τ1 τ2 and smaller θ indicates longer duration of the flat portion and θ 1 denotes a symmetric v shape boundary condition the temporal concentration distributions presented in fig 15 demonstrates that a system with larger time ratio θ results in faster development of instabilities in form of fingers this is in agreement with the results of lsa this observation is attributed to the fact that the as the time ratio increases the supporting flux for evolution of density driven fingers is stronger leading to more vigorous fingering careful review of the fingering patterns in systems with different θ shows that while the onset time and fingering patterns at the early times are different they lead to almost similar fingering pattern at the later times τ 5000 this behavior can be credited to the same supporting flux into the domain at the late times while a maximum interface concentration is established for all four considered cases this can be also observed from the space time maps shown in fig 16 a where almost the same fingering root patterns is seen for all cases at the late times τ 5000 numerical results of time dependent sherwood number shown in fig 16 b confirm that systems with shorter duration of the constant concentration flat portion of the valley lead to earlier onset time as well as stronger convective dissolution at early times beyond the onset 5 summary and conclusion linear stability analysis lsa and direct numerical simulations dns were conducted to study the effect of interface boundary excitation on the onset of convection and associated dynamics of convective dissolution stability behavior of the gravitational unstable diffusive boundary later was characterized as a function of parameters of a well defined time dependent interface concentration profile it was found that for a system with a linear decline α in concentration at the interface the onset time monotonically increases for 10 4 α 4 4 10 3 beyond which the system turns to become unconditionally stable the scaled critical time and the corresponding wavenumber were found as τc 55 6 and κc 0 0583 respectively for α 10 4 it was also observed that the instability behavior of systems with a linear decline followed by constant concentration is controlled by the constant concentration portion of the boundary condition such that the scaled critical times and the most dangerous wavenumbers lead to single scaling relations of τc 55 6 χ 2 and κc 0 0583χ respectively for α 10 1 it was shown that for a symmetric flat floored valley shape boundary condition the scaled critical time decreases by decreasing the duration of the flat portion of the boundary condition for the intermediate values of the decline factor 3 10 3 α 10 for the same interface boundary condition it was observed that the scaling relations for the critical time and the critical wavenumber at either large α 101 or small α 10 4 decline factors can be described as those in the classical system with constant concentration of χ 1 the dynamics of convective dissolution was also investigated using direct numerical simulations the results of numerical simulations confirm the general stability criteria predicted by the linear stability analysis the results also show that in addition to the onset time the development of instabilities in form of density driven fingers and the associated dynamics of convective dissolution are controlled by the interface boundary condition acknowledgments the authors would like to thank the anonymous reviewers for their constructive comments this work was supported by a discovery grant from the natural sciences and engineering research council of canada nserc alberta innovates technology futures aitf and was enabled in part by support provided by westgrid www westgrid ca and compute canada calcul canada www computecanada ca the first author also gratefully acknowledges the john and willie leone family department of energy and mineral engineering at pennsylvania state university for their hospitality supplementary material supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2019 02 005 appendix b supplementary materials image application 1 appendix a comparison of early time diffusive flux as it was discussed earlier the linear decline boundary condition with small values of decline factor may find application in gas liquid dissolution and absorption processes especially in system with small dissolution capacity where the interface concentration varies linearly over time here it is shown that the linear decline boundary condition with a low decline factor is able to reasonably resemble the diffusive flux the top boundary as compared to case when the boundary is coupled with a finite gas cap wen et al 2018 while the linear decline boundary condition does not resemble the pressure dependent concentration of co2 at the interface when a co2 gas cap is coupled with the underlying brine it can be shown that it recovers the flux at the top boundary for cases with small decline factor the solutions for the pressure dependent interface concentration wen et al 2018 and the linear decline concentration boundary are given by a1 c z d t d 1 1 π n 1 e μ n 2 t 2 π cos μ n z d 2 μ n sin μ n z d μ n 2 π π 2 0 z d 1 where μ n are the roots of the nonlinear equation tan μ n μ n π 0 n 1 2 a2 c z d t d 1 a d t d 4 π n 1 1 2 n 1 cos β n 1 z d e β n 2 t d a d β n 2 e β n 2 t d 1 0 z d 1 where z the height of the domain and positive downward and time are scaled by height of domain h and the diffusive time scale h2 d respectively βn 2n 1 π 2 and π and ad are dissolution capacity and the decline rate in the h scale system given by π vmkhrt vg wen et al 2018 and a d α k δ ρ g h ϕ μ d 2 rescaled α in the this study respectively we examined the diffusive flux as the most important factor in controlling the onset of instability for both pressure dependent and the linear decline boundary condition as shown in fig a1 the results for constant concentration boundary π a d 0 is also shown for comparison fig a1 shows that a system with the linear decline reasonably recovers the behavior of diffusive flux in a co2 water system at early times for small dissolution capacities i e π 0 5 a d 0 5 
