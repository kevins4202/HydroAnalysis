index,text
20340,the time required for water renewal in an estuary is closely related to its self purification ability and environment degree a fvcom based water age wa model was conducted to investigate the renewal timescale in the pearl river estuary pre under various hydrodynamic scenarios model sensitivities revealed the depth averaged wa during the summer was significantly smaller than that during the winter meanwhile the region with vertically significant variations in the wa varied from almost the whole estuary to the downstream it can be explained that the seaward residual currents became stronger and narrowed the region of vertical circulations by impeding salinity invasion and stratification during typhoon hagupit the depth averaged wa was apparently increased in the most of the estuary because the horizontal water circulations between the estuary and open sea were significantly decreased by the strong up estuary surge waves moreover the vertical wa distribution almost became a single layer structure with the severely weakened vertical circulations after reclamations the variable shorelines in the pre significantly affected the hydrodynamic characteristics and water circulations thus the depth averaged wa complicatedly changed and the vertical difference of the wa values slightly increased in narrowed waterways and their downstream due to the limited effects on the vertical circulations keywords water age pearl river estuary river discharge surge wave reclamation project 1 introduction along with economic development and human activities pollution eutrophication and hypoxia have threatened estuaries previous studies suggest that both the amount of pollutant input and water renewal rate determine the degree of the estuarine water quality liu et al 2011 sun et al 2013 the water renewal process in an estuary is usually complex due to the interactions of several dynamic processes such as river discharge density induced circulation tide and wind to quantify water renewal of water bodies and transport process of pollutants in estuaries a variety of time scales have been introduced and utilized including water age wa resistance time flushing time and turnover time delhez et al 1999 kwak and cho 2019 the residence time characterizes the duration of time for the water parcel at any location will remain in the estuarine system the turnover time and flushing time describe an overall dynamic condition of the waterbody however both of them are difficult to study the pollutant transport comprehensively because they do not take the spatial variations into account the wa at a specified location in an estuarine area is defined as the time elapsed since the river water leaves the river mouth where its age is specified as zero to its arrival at the location of interest bolin and rodhe 1973 delhez et al 1999 compared with other time scales e g resistance time and flushing time the wa has been treated as a more fundamental timescale for predicting the spatial and temporal distributions of pollutants based on spatio temporal heterogeneity numerical simulation has been widely applied to investigate the water renewal and transport time in estuarine waters because it can account with realistic shoreline bottom topography tidal range and other physical factors typical models that are considered included the depth or laterally integrated two dimensional 2d hydrodynamic models and the three dimensional 3d hydrodynamic models compared with the complex 3d hydrodynamic models the vertically and laterally integrated 2d hydrodynamic models are more robust and efficient for hydrodynamic simulation in real scale basins by eliminating dependence on vertical and horizontal coordinates respectively malhadas et al 2010 lin et al 2017 used a depth integrated finite element model to investigate the hydrodynamics and water exchange in sansha bay sun et al 2013 investigated the water exchange capability in the pearl river estuary pre with a depth integrated hydrodynamic dispersion model chen 2007 developed a laterally averaged trajectory model to estimate the residence time and wa in the alafia river estuary florida braunschweig et al 2003 proposed a methodology to estimate the renewal time scales in estuaries and applied it to the tagus estuary portugal using a 2d depth integrated model vertical stratification in estuaries can be significantly affected by the multiple dynamic conditions e g tidal current wind and freshwater discharge which in turn changes the vertical water renewal and transport time of dissolved substances geyer and maccready 2014 miettunen et al 2020 in the regions that the stratification plays an important role in long term circulation a 2d numerical model does not capture the main features in the hydrodynamics and erroneous estimations for timescale will be made recently several 3d hydrodynamic models have been developed and applied in the strongly stratified coastal waters concerned with understanding water renewal of water bodies li et al 2019 established a 3d hydrodynamic model to predict the spatial distribution and seasonal variation of the wa in the new york new jersey harbor chen et al 2015 simulated the response of the saltwater intrusion and wa to sea level rise in a tidal estuary applying a 3d semi implicit eulerian lagrangian finite element model gao et al 2018 simulated the 3d wa distribution in the yangtze river and xiangxi bay and applied it to quantitatively analyze the effects of hydrodynamics on the water quality by linking the wa and phytoplankton levels zu and gan 2015 investigated the hydrodynamic processes and coupled estuary shelf circulations around the pre using the 3d regional ocean model system gong et al 2018 applied the coawst modeling system to study the effects of waves on the dispersal of the pearl river plume during winter season and the results indicated that the waves apparently contribute to retaining freshwater in the western shore and simultaneously displace the river plume further downstream in a down wave direction being the third largest estuarine system in china the pre is located along the northern shelf of the south china sea see fig 1 a 21 0 23 0 n 112 5 115 0 e and covers an area of about 400 000 km2 the pearl river drains into the south china sea via eight major outlets yamen ym hutiaomen htm jitimen jtm modaomen mdm hengmen hem hongqimen hqm jiaomen jm and humen hum and forms the pre fig 1b the major part of the pre is situated in the subtropical monsoon climate zone which has strong seasonality in freshwater discharge with average discharge being about 2 104 m3 s in summer season may aug and 4 103 m3 s in winter season dec mar wong et al 2003 ji et al 2012 the pre adjacent to the main development area of western pacific typhoons suffers the most frequent typhoons among all the global typhoon active oceans causing dramatic hydrodynamic variations and serious surge wave hazards in local regions yin et al 2017 the topography in the pre is composed of several deep channels shallow shoals and clusters of islands which further makes it more vulnerable to surge and wave hazards according to statistics from the annual tropical cyclone publication of hong kong observatory h k o 2017 fourteen typhoons causing high storm surges over 1 m were observed in hong kong situated in the south of the pre from 1999 to 2018 as the most densely populated and economically developed megalopolis in china the pre area has also witnessed dramatic human activities e g coastal reclamation bridge and port construction and rapid developments in the meanwhile the coastline continuously advances toward the sea with the type and length of the coastline changing obviously as a result in the past three decades the area of coastal land has increased by 251 76 km2 while coastline has increased by 149 2 km in the pre zhang et al 2015 the previous studies showed the significance of seasonable freshwater discharge tidal dynamic surge wave and reclamation conditions to the hydrodynamic characteristics and water circulations in the pre dong et al 2004 zu and gan 2015 shen et al 2018 gong et al 2018 thus the authors concluded that the spatial distribution of the water renewal timescale may be considerably affected by the seasonal water discharges variable tidal dynamics surge waves and shorelines in the pre waters with the performance of the reclamation projects in fact the effects of the surge wave and reclamation conditions have not been well considered and studied while a lot of efforts were conducted to investigate the spatio temporal distribution of the water renewal timescale in estuaries with various conditions e g tidal dynamic sea level rise and water discharge sun et al 2013 karna and baptista 2016 chen et al 2015 the related researches may be useful to better understand the estuarine self purification ability in more complex dynamic conditions and propose more reasonable reclamation schemes for avoiding the decrease of the ecological environment degree it is worthy to more comprehensively study the water renewal timescale in the pre and other waters in this study the concept of the wa is applied to investigate the hydrodynamic and water renewal characteristics in the pre due to its advantage in predicting the spatio temporal distributions of pollutants and the simulation is performed within 3d fvcom framework chen et al 2006 it is organized as follows section 2 introduces the hydrodynamic model the methods for calculating the typhoon wind field and wa section 3 presents the verification of the established model in the pre the effects of freshwater discharge surge wave and reclamation conditions on the wa are investigated and shown in section 4 in section 5 summary and conclusion are given 2 description of methodology 2 1 hydrodynamic model fvcom developed by chen et al 2006 is a 3d unstructured grid finite volume primitive equation ocean model the primitive governing equations are mathematically closed by a turbulent closure scheme the modified mellor and yamada 1982 level 2 5 my 2 5 turbulent closure scheme is adopted for vertical eddy mixing and the parameterization scheme of smagorinsky 1963 is adopted for horizontal eddy viscosity and diffusivity fvcom swave qi et al 2009 is an unstructured grid finite volume wave model which has been developed from the third generation surface wave model swan simulating waves nearshore the model describes waves based on the euler approximation wave action density spectrum balance equation the implementation is made using the explicit second order upwind finite volume schemes in geographic space the implicit crank nicolson method in directional space and the flux corrected transport fct algorithm in frequency space in this study fvcom swave and fvcom hydrodynamic model were coupled to calculate and provide the hydrodynamic characteristics for predicting the wa distribution more details on model coupling are referred to in the fvcom user manual chen et al 2013 2 2 typhoon model in general the choice of the pressure and typhoon models has a critical effect on the accurate degree of modeling storm surge and wave characteristics in the past few decades several numerical models have been established to predict the pressure and wind fields during a typhoon process jelesnianski 1965 holland 1980 wang et al 1991 in this study the nested model of fujita formula and takahashi formula was chosen to predict pressure field due to its successful applications in many coastal and estuarine waters yin et al 2017 the formulas can be written as 1 p r p p p 0 1 2 r r 2 0 r 2 r 2 p r p p p 0 1 r r 2 r r where r is the radial distance from calculating grid to the typhoon center in the field p r is the pressure at a distance r from the typhoon center p is the background pressure 1013 25 hpa p 0 is the pressure at typhoon center r is the radius of maximum wind speed from the typhoon center and it is evaluated as 3 r 28 52 tanh 0 0873 φ 28 12 22 exp p 0 1013 25 33 86 0 2 c m where φ is the latitude of the typhoon center c is the wind speed at the typhoon center m is the initial radius moreover ueno formula is the chosen to predict typhoon wind field in the pre and it is expressed as when 0 r 2 r 4 w x c 1 v x e x p π 4 r r r c 2 f 2 f 2 4 10 3 2 δ p ρ a r 2 1 2 r r 2 3 2 x x 0 s i n θ y y 0 cos θ 5 w y c 1 v y e x p π 4 r r r c 2 f 2 f 2 4 10 3 2 δ p ρ a r 2 1 r r 2 3 2 x x 0 cos θ y y 0 s i n θ when 2 r r 6 w x c 1 v x e x p π 4 r r r c 2 f 2 f 2 4 10 3 δ p ρ a r r 1 r r 2 x x 0 s i n θ y y 0 c o s θ 7 w y c 1 v y exp π 4 r r r c 2 f 2 f 2 4 10 3 δ p ρ a r r 1 r r 2 x x 0 c o s θ y y 0 s i n θ where w x and w y are the components of wind velocities in x and y direction respectively c 1 and c 2 are empirical constants v x and v y are typhoon forward velocity in x and y direction respectively f is the coriolis force parameter it is given by f 2 7 292 10 5 s i nφ ρ a is the air density and it is set as 1 2929 kg m3 θ is the inflow angle 20 δp is pressure deficit it should be noted that when the typhoon center is far away from the research region the empirical formula cannot accurately capture the real wind field thus the background wind data downloaded from ecmwf database https www ecmwf int en forecasts is included for increasing the accuracy of simulating wind field the coupled typhoon model based on empirical formula and background wind data is expressed as 8 w wind w model 1 α w model α w background w background where α r r 1 r 2 r 1 r 1 and r 2 are empirical constants 2 3 wa calculation in estuarine and coastal waters multiple pollutants are always discharged into the water body it may be more helpful for evaluating the risks of environmental problems to know the elapsed time of a substance since it entered the system i e the mean age of the substance that is transported to the location of concern deleersnijder et al 2001 developed a constituent oriented age and residence time theory cart for predicting the wa distribution in a real estuarine system based on tracer concentration c t x and age concentration α t x assuming that there is only one tracer discharged into the coastal system and neglecting additional source and sink terms the transport equations for calculating the tracer and age concentrations can be expressed as 9 c t x t u c t x k c t x 0 10 α t x t u α t x k α t x c t x where t is time u is the flow velocity x is location and k is the diffusivity tensor the wa a t x then can be calculated as follows 11 a t x α t x c t x in the numerical simulation a passive tracer c t x of concentration 1 g l was continuously released together with the freshwater discharged from the upstream boundaries the value of α t x was set as 0 at the upstream boundaries inside the computational domain the initial values of c t x and α t x were both set as 0 3 model configuration and verification 3 1 model configuration since the surges and waves affected the area of interest over a relatively large region and the hydrodynamic characteristics at the open edges of the grid are difficult to be accurately predicted grid boundaries should be sufficiently far away from the area of interest so as to ensure that boundary disturbances do not affect its hydrodynamic process nevertheless it may result in the decrease of the resolution or the increase of the total grid number to achieve the feature that may predict the wave and flow parameters over the area of interest efficiently and accurately two nested grid method was implemented in present model fig 2 the domain of outer model included not only the whole pre but also a main part of the south china sea 105 7 119 9 e 13 6 23 1 n in the outer domain the total number of triangular elements was set as 39 729 and the total number of nodes was set as 21 079 the mesh resolution varies from about 25 km on the boundary of the model to about 300 m in the area of the interest as regard the domain of inner model which covered only the pre with variable shorelines 1990 2010 and 2020 due to reclamation activities fig 3 more information of inner grids was shown in table 1 these inner models with variable shorelines were used to investigate the effects of land reclamations on the distribution of the wa in the pre over the past 30 years a global topography database etop1 https ngdc noaa gov mgg globalglobal html was used for bathymetry interpolation in the most of domain except for the pre where the bathymetry data was obtained from higher resolution field measurement in 2010 fig 1b along the open sea boundary of outer model the water level condition induced by astronomical tide was specified by combining the eight tidal constituents m2 s2 k1 o1 n2 k2 q2 and p1 the temperature and salinity data was extracted from the 1 12 global reanalysis data based on the cmems database http ncss hycom org thredds catalog html for the conditions e g water level velocity and salinity at open sea boundary of inner model which were provided by the outer model the eight major outlets were set as the open boundary of the river discharge and the freshwater discharges were obtained by the sum of the daily discharge data in the upstream measured station of the pear river shijiao station gaoyao station and boluo station and the ratio of river discharges as shown in fig 4 liu and cai 2019 as for the sea surface boundary the data were based on ecmwf database with a high resolution of 0 25 0 25 https apps ecmwf int datasets data interim full daily levtype sfc including wind relative humidity clearness coefficient temperature evaporation and precipitation in addition the wind data predicted by typhoon model was considered as a supplement of ecmwf database with typhoon center being faring from the research region the simulation time of the model was from aug 1 2008 to aug 20 2010 during which the observational data were available to verify the model the inner model with shoreline in 2010 was adopted during the verification process the time steps used were set as 30 s for the external model and 5 s for the internal model moreover the tidal level flow velocity temperature and salinity were initially set as 0 m 0 m s 20 c and 30 psμ respectively 3 2 model verification the hydrodynamic process in the pre is extremely complex due to numerous river inlets and the radial river network especially the interaction of the river discharges astronomical tides waves and storm surges to guarantee the model reliability in the pre the simulation results were verified to series of observational data including the tide level flow velocity salinity surge tide and significant wave height 3 2 1 tidal level and current tidal level and current are generally considered as very important components for simulating hydrodynamic characteristics in an estuary field data collected from eight gauge stations t1 t8 see fig 1b in the pre during aug 14 18 2010 was used to perform the comparison of the simulated tidal level as shown in fig 5 in general the simulated results accurately captured the tidal level variations in terms of range and phase to further interpret the accuracy of the model results conveniently the mean absolute errors mae and root mean square errors rmse between the simulation and observation at the eight tidal stations were calculated and shown in table 2 from table 2 it can be seen that the maximum mae and rmse for the tidal level were 0 180 and 0 220 m respectively the verification of the flow velocity at the eight gauge stations u1 u6 see fig 1b during feb 16 17 and 25 26 2009 and mar 17 18 2010 was conducted and shown in fig 6 in this simulation the model over predicted the flood currents at u2 u3 and u6 stations the errors may be caused by the limited resolution of boundary conditions e g freshwater discharges winds and tides the maximum mae and rmse for flow velocity were 0 121 and 0 157 m s respectively at u6 station table 3 overall the model predictions of current velocity followed the general variation pattern and reasonably match the observations 3 2 2 salinity and temperature the salinity and temperature distributions can reflect the entire results of all hydrodynamic processes in turn it further affects the density circulation and changes the mixing processes the salinity verification was selected and compared with the measured data in the same station and time period as the flow current verification as shown in fig 7 and table 3 the proposed model satisfactorily reproduced the salinity variation at all measuring stations with the mae and rmse ranging from 1 065 to 2 009 psμ and from 1 224 to 2 637 psμ respectively fig 8 shows the distributions of the depth averaged salinity and temperature in the pre during the winter and summer it can be seen that the salinity value was smallest near the pre inlets and increased along the estuary moreover the salinity in the winter was significantly higher than that in the summer due to decreased freshwater discharge thereby more likely causing the instruction of salt water the distribution of the temperature during the winter was characterized by a gradual increase from land to sea which was opposite to the temperature distribution during the summer 3 2 3 storm tide and wave as a representative of the severe typhoon to make landfall in the pre hagupit 0809 was selected for the validation of the coupled surge wave model and the further investigation of the storm surge and wave effects on the wa the detail hagupit information e g hourly typhoon central pressure and maximum wind speed was obtained from the chinese typhoon weather web site http typhoon nmc cn web html hagupit originated from a tropical storm in the northwestern pacific on sept 19 2008 fig 9 it was strengthened into a typhoon on sept 21 and further upgraded into a severe typhoon on sept 22 the typhoon then advanced west northwestwards and further strengthened in the south china sea with the maximum wind speeds around 50 m s and minimum central pressure of 935 hpa at 22 45 utc time on sept 23 it made landfall at the coastal region of maoming county guangdong province after making landfall hagupit rapidly weakened with moving toward the northwest in guangdong province typhoon s landing brought tremendous wind storm surge and wave hazards liu et al 2009 according to government statistics the 22 people were killed and direct economic loss was topped to us 1 742 280 000 during typhoon process to verify the accuracy of the coupled surge wave model in the pre four gauge stations w1 w2 s1 and s2 see fig 9 were selected to compare the storm tides and waves between observations and simulations fig 10 as can be seen from the wave process at w1 station the value of the significant wave height was below 1 0 m when hagupit was far away from the research region with the movement of typhoon towards the measuring station the significant wave height was at a rate of slow growth until the sharp increase happens at 01 00 on sept 23 after that under the influence of hagupit it continuously increased and reached the peak value of 11 36 m at 6 00 on sept 23 the variation of the wave at station w2 presented the same trend as station w1 and the maximum significant wave height was 3 07 m at 23 00 on sept 23 the mae of the simulated significant wave heights from the measured results were 0 735 and 0 190 m at stations w1 and w2 respectively the rmse were 1 456 and 0 231 m respectively eventually the observation data collected at stations s1 and s2 were utilized to validate the simulation accuracy of the storm tide it can be seen that the simulated range and phase of the storm tide were in reasonable agreement with the measurements the mae of the storm tides between simulation and observation at stations s1 and s2 were 0 211 and 0 311 m respectively and the rmse were 0 231 and 0 340 m respectively above verifications show that the coupled surge wave model was capable of reflecting the interaction of river discharge astronomical tide wave and storm tide during hagupit process fig 11 shows the simulated wind fields in the pre at four typical times the results indicated that the background wind was dominant in the wind field when the typhoon was far away from the pre region fig 11a its direction was southeast and speed was lower than 5 0 m s with hagupit moving toward the pre it was gradually affected by the typhoon and the wind turned northerly fig 11b then the wind field was controlled by the strong southeast wind with speed ranging from 16 2 to 28 3 m s when the typhoon moved through the pre 24 00 on sept 23 fig 11c at 06 00 utc time on sept 23 the southeast wind decreased to 11 5 17 8 m s as hagupit moved away and weakened fig 11d fig 12 shows the simulated maximum significant wave height and storm tide for hagupit it is obvious that the maximum significant wave height in the offshore waters tends to be higher than that in the nearshore waters and the maximum value can be up to 4 5 m in the mouth of the pre however the distribution of maximum storm tide presented a reverse trend compared with that of the maximum significant wave height the maximum storm tide value of 3 2 m is presented in the upstream of the river channels and it decreased toward offshore waters 4 numerical results and discussions in this subsection the water renewal capability of the pre with the open sea is studied by examining the wa a series of sensitivity runs are designed to investigate the factors affecting the wa within the estuary specifically this includes varying section 4 1 the river discharge of the pearl river section 4 2 the surge wave condition during typhoon hagupi and section 4 3 coastline caused by reclamation projects 1990 2020 4 1 influence of seasonal river discharge on wa in general river discharge plays a critical role in determining the long term water renewal of estuaries thus the influence of the river discharge on the wa in the pre is firstly investigated fig 13 shows the depth averaged and vertical distributions of the wa for both the winter and summer the results showed that the wa value was the smallest in the river inlets and it gradually increased along the estuary for both the two seasons whereas there was a significant difference in magnitude during the winter the wa was significantly lower than that during the summer almost everywhere in the pre it took about 19 2 17 3 8 0 and 30 0 days for the tracer to travel from the headwater to the mouth of the hb jtm mdm and lb the boundary of the pre respectively fig 13a in comparison during the summer the wa value was only about 13 1 11 2 2 1 and 11 2 days at the mouth of the hb jtm mdm and lb respectively which indicates that the depth averaged renewal ability of water body was stronger compared to that during the winter fig 13c d shows that the vertical wa distributions along the longitudinal section ls see fig 1b were a two layer structure for both the winter and summer where lower wa values appeared at upper layers near the surface while higher wa values appeared at lower layers near the bed during the winter the significant variation of the wa in vertical direction appeared in the most of estuarine region coving the upstream and downstream the water was 4 0 days older at the bottom layer than at the surface layer of the upstream this difference was slightly larger than that in the downstream during the summer the significant variation of the wa in vertical direction was appeared in the downstream where the water was 1 2 days older in the bottom layer than in the surface layer to better investigate the hydrodynamic mechanism of the seasonal water renewal and wa distribution in the pre the depth averaged currents and vertical distributions of longitudinal component v along ls during the winter and summer were both conducted and shown in fig 14 during the winter the river discharges induced the seaward currents at the surface layer thus leading to wa gradients fig 14a the strong currents appeared in the upstream of the rivers due to the comprehensive effects of the narrow channel and large river discharge the current speeds at estuary center were relatively large and it decreased at the banks of the estuary the high currents around the mouths of the estuaries may be tidally induced residual currents due to the complicated topography during the summer the pattern of the surface residual currents was similar with that during the winter while its speeds were greatly increased in the most of the pre due to larger river discharge volumes fig 14b it can explain why the wa distribution during the summer was smaller than that during the winter fig 14c d indicate that the area of the circulation loops induced by seaward 0 m s and landward flows 0 m s was decreased from almost the whole estuary during the winter to the downstream during the summer which can be attributed to that the increased river discharge impeded the salinity invasion and stratification in each circulation loop the water flow was seaward at the surface whereas it was landward at the bottom thus the wa values generally increased from the free surface to the seabed and the high wa values appeared at the bottom of water column above results indicated that the wa spatial distributions and seasonal variations were the dominant phenomena in the pre which were highly related to vertical and horizontal water circulations caused by freshwater seawater interaction 4 2 influence of surge wave on wa storm surges and waves greatly contribute to the estuarine circulations in the pre which suffers the most frequent typhoons among all the global typhoon active oceans hagupit a typical representative of severe typhoons was utilized to diagnose the effects of surge wave condition on the water renewal and wa distribution fig 15 shows the time series of the surface wa and hydrodynamic parameters at station g1 the downstream end of the ls see fig 1b with different surge wave scenarios in the case without surge wave condition the wa presented periodic fluctuations from 14 to 20 days due to the influence of tides while the tidally depth averaged wa within tidal cycle remained nearly constant which means that the tide variation played a minor role in the water circulations and wa distributions compared with the seasonally variable discharge when the surge wave condition was included in simulation the considerable differences of the wa variation were observed the wa value increased by 1 83 24 43 when the typhoon was far away from the pre because the southeast background winds dominated local wind field and it directly generated landward waves decreased the seaward currents and increased the landward currents furthermore the presence of landward waves further contributed to this variation of the residual currents by the way of wave radiation stress fig 15b and c with the movement of the typhoon northwestwards to station g1 the differences of the wa in the two surge wave scenarios became very smaller due to the reverse variation trends of the residual currents induced by the weak northwest typhoon forcing then the wa value more dramatically rose and kept a higher wa value of 26 7 days with the significant increase of landward currents induced by stronger up estuary surge waves where maximum values of storm tide and significant wave height were 1 72 m and 1 93 m respectively the increased rate of the wa was up to 67 67 and the periodic fluctuations caused by the tides were apparently weakened compared with that in the case without surge wave condition fig 16 and fig 17 show the depth averaged and vertical distributions of the wa and corresponding residual currents for different surge wave scenarios when the surge wave condition was considered in the simulation and wind field was dominated by background wind compared with the case without surge wave condition a slight increase in the wa appeared at the middle and mouth of the lb while a notable decrease in the wa appeared at jtm fig 16a and b where the direction of landward currents were obviously changed by the up estuary surge waves fig 17a and b when the wind field was dominated by typhoon wind compared with the case without surge wave condition the wa was apparently higher almost everywhere in the case with surge wave condition fig 16c and d because the horizontal water circulations were more obviously affected and the water exchanges between the estuary and open sea were more significantly reduced by the up estuary surge waves fig 17c and d as a result the time that the tracer arrives at the mouth of the hb jtm mdm and lb increased from 13 6 12 2 2 5 and 14 7 days to 16 5 12 8 3 0 and 24 5 days respectively the vertical wa distributions were a two layer structure in the case without surge wave condition the differences of the wa values between the surface and bottom layers were 6 0 days fig 16e and g in the case with surge wave condition it became less stratified due to the weakness effects of the up estuary surge waves on the vertical water circulations and mixing fig 17e and f especially around the mouth of the estuary where the vertical difference in the wa values decreased from 2 0 5 3 days to 1 5 2 5 days fig 16f as the wind field was dominated by background wind the vertical wa distribution almost became a single layer structure and the vertically largest difference in the wa values was only 2 5 days as the wind field was dominated by typhoon wind fig 16h this can attribute to the more significantly weakness effects of the up estuary surge waves on the vertical water circulations and mixing fig 17g and h in a summary the up estuary surge waves can significantly impede the water circulations in horizontal and vertical direction thereby reducing the renewal ability of the pre 4 3 influence of reclamation project on wa to the best of our knowledge the total length of the pre coastline increased by 149 2 km and the coastal land increased by 251 76 km2 in the past three decades 1990 2020 as a result of the reclamation projects fig 3 illustrates the main location of reclamation projects in the pre to study the influence of the reclamation projects on the wa the simulation of the hydrodynamic process for surge wave scenario in section 4 2 was further performed considering the variable coastline fig 18 shows the depth averaged and vertical distributions of the wa for variable coastline scenarios in the lb the reclamation projects are mainly located in jibaosha wanqingsha hengmentan and both coasts of the estuary and they narrowed the local waterways the wa values slightly decreased in the downstream of the projects and the mouth of the lb fig 18a c which can be mainly explained by that the narrowed waterways increased the seaward currents and significantly contributed to horizontal water circulations especially in narrowed waterways and their downstream fig 19 a c the increased reclamation area in the gaolan island blocks the water exchange between the hb and jtm it hindered the movement of water body with the lower wa value from east to the hb fig 19b d resulting in an increase of the wa in local regions it is obvious that the 12 day contour line clearly moved towards land fig 18b d the reclamation in the mdm narrowed its waterway leading to a decrease of the wa in this waterway which was similar with the wa variation in the lb in vertical direction the reclamation projects had very limited effects on water circulations fig 19e and f thus the difference of the wa between the surface and bottom layers slightly increased it was only increased by 1 day in narrowed waterways and their downstream and less than 1 day in other regions fig 18e and f in a summary the construction of the reclamation projects in the pre obviously changed the morphology of the shoreline and further significantly affected the horizontal water circulations and renewal ability while it has slight effects in the vertical water 5 conclusions a coupled 3d surge wave solute transport model was established to calculate the age of the water discharged from the pearl river the agreement between the measured data and calculated results showed that the model can reasonably simulate the hydrodynamic process in the pre and it is capable of simulating the tracer transport and wa distribution using the verified model a series of sensitivity runs were performed for different freshwater discharge surge wave and coastline scenarios though the present model results the main conclusions can be summarized as follows the wa values for the whole of the pre show a seasonal variation which is mainly due to the variable freshwater discharges horizontally the depth averaged wa value was smallest in the river inlets and it gradually increased along the estuary for both the winter and summer while the wa value was generally larger in the winter than that in the summer during the winter the depth averaged wa values at the mouth of the hb jm mdm and lb were 19 2 17 3 8 0 and 30 0 days respectively they decreased to 13 1 11 2 2 1 and 11 2 days during the summer respectively vertically the variation of the wa was significant in almost the whole estuarine region during the winter and the downstream during the summer due to the impediment effects of river discharge on the salinity intrusion and stratification in the stratified regions the wa value was generally smaller at the upper layer than at the lower layer the difference was 4 days during the winter and 1 2 days during the summer the up estuary surge waves can significantly impede the water circulations in horizontal and vertical direction thereby reducing the renewal ability of the pre in the case with surge wave condition the wa values slightly increased in the most of the pre and became less stratified in vertical direction compared with that in the case without surge wave condition as the wind field was dominated by background wind the wa values more apparently increased in almost the whole pre and became almost a single layer structure as wind field was dominated by typhoon wind the vertically difference in the wa values decreased from 6 days to 2 5 days the depth averaged values increased from 13 6 12 2 2 5 and 14 7 days to 16 5 12 8 3 0 and 24 5 days at the mouth of the hb jtm mdm and lb respectively by considering the variable coastline induced by reclamation projects the depth averaged wa values obviously varied due to its significant effects on horizontal water circulations while the vertical difference of the wa between the surface and bottom layers slightly increased it was only increased by 1 day in narrowed waterways and their downstream and less than 1 day in other regions the findings of this study are beneficial to understand the hydrodynamics and water renewal in a stratified estuarine system affected by typhoons and other extreme weather hazards it also may provide an auxiliary guidance in reasonably constructing reclamations for avoiding the decrease of the water exchange capacity and ecological environment degree credit authors contribution statement hongxing zhang numerical simulation validation results analysis final approval yongming shen conceptualization and methodology data curation and formal analysis original draft preparation reviewing and editing funding acquisition jun tang reviewing and editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study was funded by the key special project for introduced talents team of southern marine science and engineering guangdong laboratory guangzhou under grant no gml2019zd0403 by the program for guangdong introducing innovative and enterpreneurial teams under grant no 2019zt08l213 by guangdong provincial key laboratory project grant no 2019b121203011 and by the national nature science foundation of china under grant no 51779039 
20340,the time required for water renewal in an estuary is closely related to its self purification ability and environment degree a fvcom based water age wa model was conducted to investigate the renewal timescale in the pearl river estuary pre under various hydrodynamic scenarios model sensitivities revealed the depth averaged wa during the summer was significantly smaller than that during the winter meanwhile the region with vertically significant variations in the wa varied from almost the whole estuary to the downstream it can be explained that the seaward residual currents became stronger and narrowed the region of vertical circulations by impeding salinity invasion and stratification during typhoon hagupit the depth averaged wa was apparently increased in the most of the estuary because the horizontal water circulations between the estuary and open sea were significantly decreased by the strong up estuary surge waves moreover the vertical wa distribution almost became a single layer structure with the severely weakened vertical circulations after reclamations the variable shorelines in the pre significantly affected the hydrodynamic characteristics and water circulations thus the depth averaged wa complicatedly changed and the vertical difference of the wa values slightly increased in narrowed waterways and their downstream due to the limited effects on the vertical circulations keywords water age pearl river estuary river discharge surge wave reclamation project 1 introduction along with economic development and human activities pollution eutrophication and hypoxia have threatened estuaries previous studies suggest that both the amount of pollutant input and water renewal rate determine the degree of the estuarine water quality liu et al 2011 sun et al 2013 the water renewal process in an estuary is usually complex due to the interactions of several dynamic processes such as river discharge density induced circulation tide and wind to quantify water renewal of water bodies and transport process of pollutants in estuaries a variety of time scales have been introduced and utilized including water age wa resistance time flushing time and turnover time delhez et al 1999 kwak and cho 2019 the residence time characterizes the duration of time for the water parcel at any location will remain in the estuarine system the turnover time and flushing time describe an overall dynamic condition of the waterbody however both of them are difficult to study the pollutant transport comprehensively because they do not take the spatial variations into account the wa at a specified location in an estuarine area is defined as the time elapsed since the river water leaves the river mouth where its age is specified as zero to its arrival at the location of interest bolin and rodhe 1973 delhez et al 1999 compared with other time scales e g resistance time and flushing time the wa has been treated as a more fundamental timescale for predicting the spatial and temporal distributions of pollutants based on spatio temporal heterogeneity numerical simulation has been widely applied to investigate the water renewal and transport time in estuarine waters because it can account with realistic shoreline bottom topography tidal range and other physical factors typical models that are considered included the depth or laterally integrated two dimensional 2d hydrodynamic models and the three dimensional 3d hydrodynamic models compared with the complex 3d hydrodynamic models the vertically and laterally integrated 2d hydrodynamic models are more robust and efficient for hydrodynamic simulation in real scale basins by eliminating dependence on vertical and horizontal coordinates respectively malhadas et al 2010 lin et al 2017 used a depth integrated finite element model to investigate the hydrodynamics and water exchange in sansha bay sun et al 2013 investigated the water exchange capability in the pearl river estuary pre with a depth integrated hydrodynamic dispersion model chen 2007 developed a laterally averaged trajectory model to estimate the residence time and wa in the alafia river estuary florida braunschweig et al 2003 proposed a methodology to estimate the renewal time scales in estuaries and applied it to the tagus estuary portugal using a 2d depth integrated model vertical stratification in estuaries can be significantly affected by the multiple dynamic conditions e g tidal current wind and freshwater discharge which in turn changes the vertical water renewal and transport time of dissolved substances geyer and maccready 2014 miettunen et al 2020 in the regions that the stratification plays an important role in long term circulation a 2d numerical model does not capture the main features in the hydrodynamics and erroneous estimations for timescale will be made recently several 3d hydrodynamic models have been developed and applied in the strongly stratified coastal waters concerned with understanding water renewal of water bodies li et al 2019 established a 3d hydrodynamic model to predict the spatial distribution and seasonal variation of the wa in the new york new jersey harbor chen et al 2015 simulated the response of the saltwater intrusion and wa to sea level rise in a tidal estuary applying a 3d semi implicit eulerian lagrangian finite element model gao et al 2018 simulated the 3d wa distribution in the yangtze river and xiangxi bay and applied it to quantitatively analyze the effects of hydrodynamics on the water quality by linking the wa and phytoplankton levels zu and gan 2015 investigated the hydrodynamic processes and coupled estuary shelf circulations around the pre using the 3d regional ocean model system gong et al 2018 applied the coawst modeling system to study the effects of waves on the dispersal of the pearl river plume during winter season and the results indicated that the waves apparently contribute to retaining freshwater in the western shore and simultaneously displace the river plume further downstream in a down wave direction being the third largest estuarine system in china the pre is located along the northern shelf of the south china sea see fig 1 a 21 0 23 0 n 112 5 115 0 e and covers an area of about 400 000 km2 the pearl river drains into the south china sea via eight major outlets yamen ym hutiaomen htm jitimen jtm modaomen mdm hengmen hem hongqimen hqm jiaomen jm and humen hum and forms the pre fig 1b the major part of the pre is situated in the subtropical monsoon climate zone which has strong seasonality in freshwater discharge with average discharge being about 2 104 m3 s in summer season may aug and 4 103 m3 s in winter season dec mar wong et al 2003 ji et al 2012 the pre adjacent to the main development area of western pacific typhoons suffers the most frequent typhoons among all the global typhoon active oceans causing dramatic hydrodynamic variations and serious surge wave hazards in local regions yin et al 2017 the topography in the pre is composed of several deep channels shallow shoals and clusters of islands which further makes it more vulnerable to surge and wave hazards according to statistics from the annual tropical cyclone publication of hong kong observatory h k o 2017 fourteen typhoons causing high storm surges over 1 m were observed in hong kong situated in the south of the pre from 1999 to 2018 as the most densely populated and economically developed megalopolis in china the pre area has also witnessed dramatic human activities e g coastal reclamation bridge and port construction and rapid developments in the meanwhile the coastline continuously advances toward the sea with the type and length of the coastline changing obviously as a result in the past three decades the area of coastal land has increased by 251 76 km2 while coastline has increased by 149 2 km in the pre zhang et al 2015 the previous studies showed the significance of seasonable freshwater discharge tidal dynamic surge wave and reclamation conditions to the hydrodynamic characteristics and water circulations in the pre dong et al 2004 zu and gan 2015 shen et al 2018 gong et al 2018 thus the authors concluded that the spatial distribution of the water renewal timescale may be considerably affected by the seasonal water discharges variable tidal dynamics surge waves and shorelines in the pre waters with the performance of the reclamation projects in fact the effects of the surge wave and reclamation conditions have not been well considered and studied while a lot of efforts were conducted to investigate the spatio temporal distribution of the water renewal timescale in estuaries with various conditions e g tidal dynamic sea level rise and water discharge sun et al 2013 karna and baptista 2016 chen et al 2015 the related researches may be useful to better understand the estuarine self purification ability in more complex dynamic conditions and propose more reasonable reclamation schemes for avoiding the decrease of the ecological environment degree it is worthy to more comprehensively study the water renewal timescale in the pre and other waters in this study the concept of the wa is applied to investigate the hydrodynamic and water renewal characteristics in the pre due to its advantage in predicting the spatio temporal distributions of pollutants and the simulation is performed within 3d fvcom framework chen et al 2006 it is organized as follows section 2 introduces the hydrodynamic model the methods for calculating the typhoon wind field and wa section 3 presents the verification of the established model in the pre the effects of freshwater discharge surge wave and reclamation conditions on the wa are investigated and shown in section 4 in section 5 summary and conclusion are given 2 description of methodology 2 1 hydrodynamic model fvcom developed by chen et al 2006 is a 3d unstructured grid finite volume primitive equation ocean model the primitive governing equations are mathematically closed by a turbulent closure scheme the modified mellor and yamada 1982 level 2 5 my 2 5 turbulent closure scheme is adopted for vertical eddy mixing and the parameterization scheme of smagorinsky 1963 is adopted for horizontal eddy viscosity and diffusivity fvcom swave qi et al 2009 is an unstructured grid finite volume wave model which has been developed from the third generation surface wave model swan simulating waves nearshore the model describes waves based on the euler approximation wave action density spectrum balance equation the implementation is made using the explicit second order upwind finite volume schemes in geographic space the implicit crank nicolson method in directional space and the flux corrected transport fct algorithm in frequency space in this study fvcom swave and fvcom hydrodynamic model were coupled to calculate and provide the hydrodynamic characteristics for predicting the wa distribution more details on model coupling are referred to in the fvcom user manual chen et al 2013 2 2 typhoon model in general the choice of the pressure and typhoon models has a critical effect on the accurate degree of modeling storm surge and wave characteristics in the past few decades several numerical models have been established to predict the pressure and wind fields during a typhoon process jelesnianski 1965 holland 1980 wang et al 1991 in this study the nested model of fujita formula and takahashi formula was chosen to predict pressure field due to its successful applications in many coastal and estuarine waters yin et al 2017 the formulas can be written as 1 p r p p p 0 1 2 r r 2 0 r 2 r 2 p r p p p 0 1 r r 2 r r where r is the radial distance from calculating grid to the typhoon center in the field p r is the pressure at a distance r from the typhoon center p is the background pressure 1013 25 hpa p 0 is the pressure at typhoon center r is the radius of maximum wind speed from the typhoon center and it is evaluated as 3 r 28 52 tanh 0 0873 φ 28 12 22 exp p 0 1013 25 33 86 0 2 c m where φ is the latitude of the typhoon center c is the wind speed at the typhoon center m is the initial radius moreover ueno formula is the chosen to predict typhoon wind field in the pre and it is expressed as when 0 r 2 r 4 w x c 1 v x e x p π 4 r r r c 2 f 2 f 2 4 10 3 2 δ p ρ a r 2 1 2 r r 2 3 2 x x 0 s i n θ y y 0 cos θ 5 w y c 1 v y e x p π 4 r r r c 2 f 2 f 2 4 10 3 2 δ p ρ a r 2 1 r r 2 3 2 x x 0 cos θ y y 0 s i n θ when 2 r r 6 w x c 1 v x e x p π 4 r r r c 2 f 2 f 2 4 10 3 δ p ρ a r r 1 r r 2 x x 0 s i n θ y y 0 c o s θ 7 w y c 1 v y exp π 4 r r r c 2 f 2 f 2 4 10 3 δ p ρ a r r 1 r r 2 x x 0 c o s θ y y 0 s i n θ where w x and w y are the components of wind velocities in x and y direction respectively c 1 and c 2 are empirical constants v x and v y are typhoon forward velocity in x and y direction respectively f is the coriolis force parameter it is given by f 2 7 292 10 5 s i nφ ρ a is the air density and it is set as 1 2929 kg m3 θ is the inflow angle 20 δp is pressure deficit it should be noted that when the typhoon center is far away from the research region the empirical formula cannot accurately capture the real wind field thus the background wind data downloaded from ecmwf database https www ecmwf int en forecasts is included for increasing the accuracy of simulating wind field the coupled typhoon model based on empirical formula and background wind data is expressed as 8 w wind w model 1 α w model α w background w background where α r r 1 r 2 r 1 r 1 and r 2 are empirical constants 2 3 wa calculation in estuarine and coastal waters multiple pollutants are always discharged into the water body it may be more helpful for evaluating the risks of environmental problems to know the elapsed time of a substance since it entered the system i e the mean age of the substance that is transported to the location of concern deleersnijder et al 2001 developed a constituent oriented age and residence time theory cart for predicting the wa distribution in a real estuarine system based on tracer concentration c t x and age concentration α t x assuming that there is only one tracer discharged into the coastal system and neglecting additional source and sink terms the transport equations for calculating the tracer and age concentrations can be expressed as 9 c t x t u c t x k c t x 0 10 α t x t u α t x k α t x c t x where t is time u is the flow velocity x is location and k is the diffusivity tensor the wa a t x then can be calculated as follows 11 a t x α t x c t x in the numerical simulation a passive tracer c t x of concentration 1 g l was continuously released together with the freshwater discharged from the upstream boundaries the value of α t x was set as 0 at the upstream boundaries inside the computational domain the initial values of c t x and α t x were both set as 0 3 model configuration and verification 3 1 model configuration since the surges and waves affected the area of interest over a relatively large region and the hydrodynamic characteristics at the open edges of the grid are difficult to be accurately predicted grid boundaries should be sufficiently far away from the area of interest so as to ensure that boundary disturbances do not affect its hydrodynamic process nevertheless it may result in the decrease of the resolution or the increase of the total grid number to achieve the feature that may predict the wave and flow parameters over the area of interest efficiently and accurately two nested grid method was implemented in present model fig 2 the domain of outer model included not only the whole pre but also a main part of the south china sea 105 7 119 9 e 13 6 23 1 n in the outer domain the total number of triangular elements was set as 39 729 and the total number of nodes was set as 21 079 the mesh resolution varies from about 25 km on the boundary of the model to about 300 m in the area of the interest as regard the domain of inner model which covered only the pre with variable shorelines 1990 2010 and 2020 due to reclamation activities fig 3 more information of inner grids was shown in table 1 these inner models with variable shorelines were used to investigate the effects of land reclamations on the distribution of the wa in the pre over the past 30 years a global topography database etop1 https ngdc noaa gov mgg globalglobal html was used for bathymetry interpolation in the most of domain except for the pre where the bathymetry data was obtained from higher resolution field measurement in 2010 fig 1b along the open sea boundary of outer model the water level condition induced by astronomical tide was specified by combining the eight tidal constituents m2 s2 k1 o1 n2 k2 q2 and p1 the temperature and salinity data was extracted from the 1 12 global reanalysis data based on the cmems database http ncss hycom org thredds catalog html for the conditions e g water level velocity and salinity at open sea boundary of inner model which were provided by the outer model the eight major outlets were set as the open boundary of the river discharge and the freshwater discharges were obtained by the sum of the daily discharge data in the upstream measured station of the pear river shijiao station gaoyao station and boluo station and the ratio of river discharges as shown in fig 4 liu and cai 2019 as for the sea surface boundary the data were based on ecmwf database with a high resolution of 0 25 0 25 https apps ecmwf int datasets data interim full daily levtype sfc including wind relative humidity clearness coefficient temperature evaporation and precipitation in addition the wind data predicted by typhoon model was considered as a supplement of ecmwf database with typhoon center being faring from the research region the simulation time of the model was from aug 1 2008 to aug 20 2010 during which the observational data were available to verify the model the inner model with shoreline in 2010 was adopted during the verification process the time steps used were set as 30 s for the external model and 5 s for the internal model moreover the tidal level flow velocity temperature and salinity were initially set as 0 m 0 m s 20 c and 30 psμ respectively 3 2 model verification the hydrodynamic process in the pre is extremely complex due to numerous river inlets and the radial river network especially the interaction of the river discharges astronomical tides waves and storm surges to guarantee the model reliability in the pre the simulation results were verified to series of observational data including the tide level flow velocity salinity surge tide and significant wave height 3 2 1 tidal level and current tidal level and current are generally considered as very important components for simulating hydrodynamic characteristics in an estuary field data collected from eight gauge stations t1 t8 see fig 1b in the pre during aug 14 18 2010 was used to perform the comparison of the simulated tidal level as shown in fig 5 in general the simulated results accurately captured the tidal level variations in terms of range and phase to further interpret the accuracy of the model results conveniently the mean absolute errors mae and root mean square errors rmse between the simulation and observation at the eight tidal stations were calculated and shown in table 2 from table 2 it can be seen that the maximum mae and rmse for the tidal level were 0 180 and 0 220 m respectively the verification of the flow velocity at the eight gauge stations u1 u6 see fig 1b during feb 16 17 and 25 26 2009 and mar 17 18 2010 was conducted and shown in fig 6 in this simulation the model over predicted the flood currents at u2 u3 and u6 stations the errors may be caused by the limited resolution of boundary conditions e g freshwater discharges winds and tides the maximum mae and rmse for flow velocity were 0 121 and 0 157 m s respectively at u6 station table 3 overall the model predictions of current velocity followed the general variation pattern and reasonably match the observations 3 2 2 salinity and temperature the salinity and temperature distributions can reflect the entire results of all hydrodynamic processes in turn it further affects the density circulation and changes the mixing processes the salinity verification was selected and compared with the measured data in the same station and time period as the flow current verification as shown in fig 7 and table 3 the proposed model satisfactorily reproduced the salinity variation at all measuring stations with the mae and rmse ranging from 1 065 to 2 009 psμ and from 1 224 to 2 637 psμ respectively fig 8 shows the distributions of the depth averaged salinity and temperature in the pre during the winter and summer it can be seen that the salinity value was smallest near the pre inlets and increased along the estuary moreover the salinity in the winter was significantly higher than that in the summer due to decreased freshwater discharge thereby more likely causing the instruction of salt water the distribution of the temperature during the winter was characterized by a gradual increase from land to sea which was opposite to the temperature distribution during the summer 3 2 3 storm tide and wave as a representative of the severe typhoon to make landfall in the pre hagupit 0809 was selected for the validation of the coupled surge wave model and the further investigation of the storm surge and wave effects on the wa the detail hagupit information e g hourly typhoon central pressure and maximum wind speed was obtained from the chinese typhoon weather web site http typhoon nmc cn web html hagupit originated from a tropical storm in the northwestern pacific on sept 19 2008 fig 9 it was strengthened into a typhoon on sept 21 and further upgraded into a severe typhoon on sept 22 the typhoon then advanced west northwestwards and further strengthened in the south china sea with the maximum wind speeds around 50 m s and minimum central pressure of 935 hpa at 22 45 utc time on sept 23 it made landfall at the coastal region of maoming county guangdong province after making landfall hagupit rapidly weakened with moving toward the northwest in guangdong province typhoon s landing brought tremendous wind storm surge and wave hazards liu et al 2009 according to government statistics the 22 people were killed and direct economic loss was topped to us 1 742 280 000 during typhoon process to verify the accuracy of the coupled surge wave model in the pre four gauge stations w1 w2 s1 and s2 see fig 9 were selected to compare the storm tides and waves between observations and simulations fig 10 as can be seen from the wave process at w1 station the value of the significant wave height was below 1 0 m when hagupit was far away from the research region with the movement of typhoon towards the measuring station the significant wave height was at a rate of slow growth until the sharp increase happens at 01 00 on sept 23 after that under the influence of hagupit it continuously increased and reached the peak value of 11 36 m at 6 00 on sept 23 the variation of the wave at station w2 presented the same trend as station w1 and the maximum significant wave height was 3 07 m at 23 00 on sept 23 the mae of the simulated significant wave heights from the measured results were 0 735 and 0 190 m at stations w1 and w2 respectively the rmse were 1 456 and 0 231 m respectively eventually the observation data collected at stations s1 and s2 were utilized to validate the simulation accuracy of the storm tide it can be seen that the simulated range and phase of the storm tide were in reasonable agreement with the measurements the mae of the storm tides between simulation and observation at stations s1 and s2 were 0 211 and 0 311 m respectively and the rmse were 0 231 and 0 340 m respectively above verifications show that the coupled surge wave model was capable of reflecting the interaction of river discharge astronomical tide wave and storm tide during hagupit process fig 11 shows the simulated wind fields in the pre at four typical times the results indicated that the background wind was dominant in the wind field when the typhoon was far away from the pre region fig 11a its direction was southeast and speed was lower than 5 0 m s with hagupit moving toward the pre it was gradually affected by the typhoon and the wind turned northerly fig 11b then the wind field was controlled by the strong southeast wind with speed ranging from 16 2 to 28 3 m s when the typhoon moved through the pre 24 00 on sept 23 fig 11c at 06 00 utc time on sept 23 the southeast wind decreased to 11 5 17 8 m s as hagupit moved away and weakened fig 11d fig 12 shows the simulated maximum significant wave height and storm tide for hagupit it is obvious that the maximum significant wave height in the offshore waters tends to be higher than that in the nearshore waters and the maximum value can be up to 4 5 m in the mouth of the pre however the distribution of maximum storm tide presented a reverse trend compared with that of the maximum significant wave height the maximum storm tide value of 3 2 m is presented in the upstream of the river channels and it decreased toward offshore waters 4 numerical results and discussions in this subsection the water renewal capability of the pre with the open sea is studied by examining the wa a series of sensitivity runs are designed to investigate the factors affecting the wa within the estuary specifically this includes varying section 4 1 the river discharge of the pearl river section 4 2 the surge wave condition during typhoon hagupi and section 4 3 coastline caused by reclamation projects 1990 2020 4 1 influence of seasonal river discharge on wa in general river discharge plays a critical role in determining the long term water renewal of estuaries thus the influence of the river discharge on the wa in the pre is firstly investigated fig 13 shows the depth averaged and vertical distributions of the wa for both the winter and summer the results showed that the wa value was the smallest in the river inlets and it gradually increased along the estuary for both the two seasons whereas there was a significant difference in magnitude during the winter the wa was significantly lower than that during the summer almost everywhere in the pre it took about 19 2 17 3 8 0 and 30 0 days for the tracer to travel from the headwater to the mouth of the hb jtm mdm and lb the boundary of the pre respectively fig 13a in comparison during the summer the wa value was only about 13 1 11 2 2 1 and 11 2 days at the mouth of the hb jtm mdm and lb respectively which indicates that the depth averaged renewal ability of water body was stronger compared to that during the winter fig 13c d shows that the vertical wa distributions along the longitudinal section ls see fig 1b were a two layer structure for both the winter and summer where lower wa values appeared at upper layers near the surface while higher wa values appeared at lower layers near the bed during the winter the significant variation of the wa in vertical direction appeared in the most of estuarine region coving the upstream and downstream the water was 4 0 days older at the bottom layer than at the surface layer of the upstream this difference was slightly larger than that in the downstream during the summer the significant variation of the wa in vertical direction was appeared in the downstream where the water was 1 2 days older in the bottom layer than in the surface layer to better investigate the hydrodynamic mechanism of the seasonal water renewal and wa distribution in the pre the depth averaged currents and vertical distributions of longitudinal component v along ls during the winter and summer were both conducted and shown in fig 14 during the winter the river discharges induced the seaward currents at the surface layer thus leading to wa gradients fig 14a the strong currents appeared in the upstream of the rivers due to the comprehensive effects of the narrow channel and large river discharge the current speeds at estuary center were relatively large and it decreased at the banks of the estuary the high currents around the mouths of the estuaries may be tidally induced residual currents due to the complicated topography during the summer the pattern of the surface residual currents was similar with that during the winter while its speeds were greatly increased in the most of the pre due to larger river discharge volumes fig 14b it can explain why the wa distribution during the summer was smaller than that during the winter fig 14c d indicate that the area of the circulation loops induced by seaward 0 m s and landward flows 0 m s was decreased from almost the whole estuary during the winter to the downstream during the summer which can be attributed to that the increased river discharge impeded the salinity invasion and stratification in each circulation loop the water flow was seaward at the surface whereas it was landward at the bottom thus the wa values generally increased from the free surface to the seabed and the high wa values appeared at the bottom of water column above results indicated that the wa spatial distributions and seasonal variations were the dominant phenomena in the pre which were highly related to vertical and horizontal water circulations caused by freshwater seawater interaction 4 2 influence of surge wave on wa storm surges and waves greatly contribute to the estuarine circulations in the pre which suffers the most frequent typhoons among all the global typhoon active oceans hagupit a typical representative of severe typhoons was utilized to diagnose the effects of surge wave condition on the water renewal and wa distribution fig 15 shows the time series of the surface wa and hydrodynamic parameters at station g1 the downstream end of the ls see fig 1b with different surge wave scenarios in the case without surge wave condition the wa presented periodic fluctuations from 14 to 20 days due to the influence of tides while the tidally depth averaged wa within tidal cycle remained nearly constant which means that the tide variation played a minor role in the water circulations and wa distributions compared with the seasonally variable discharge when the surge wave condition was included in simulation the considerable differences of the wa variation were observed the wa value increased by 1 83 24 43 when the typhoon was far away from the pre because the southeast background winds dominated local wind field and it directly generated landward waves decreased the seaward currents and increased the landward currents furthermore the presence of landward waves further contributed to this variation of the residual currents by the way of wave radiation stress fig 15b and c with the movement of the typhoon northwestwards to station g1 the differences of the wa in the two surge wave scenarios became very smaller due to the reverse variation trends of the residual currents induced by the weak northwest typhoon forcing then the wa value more dramatically rose and kept a higher wa value of 26 7 days with the significant increase of landward currents induced by stronger up estuary surge waves where maximum values of storm tide and significant wave height were 1 72 m and 1 93 m respectively the increased rate of the wa was up to 67 67 and the periodic fluctuations caused by the tides were apparently weakened compared with that in the case without surge wave condition fig 16 and fig 17 show the depth averaged and vertical distributions of the wa and corresponding residual currents for different surge wave scenarios when the surge wave condition was considered in the simulation and wind field was dominated by background wind compared with the case without surge wave condition a slight increase in the wa appeared at the middle and mouth of the lb while a notable decrease in the wa appeared at jtm fig 16a and b where the direction of landward currents were obviously changed by the up estuary surge waves fig 17a and b when the wind field was dominated by typhoon wind compared with the case without surge wave condition the wa was apparently higher almost everywhere in the case with surge wave condition fig 16c and d because the horizontal water circulations were more obviously affected and the water exchanges between the estuary and open sea were more significantly reduced by the up estuary surge waves fig 17c and d as a result the time that the tracer arrives at the mouth of the hb jtm mdm and lb increased from 13 6 12 2 2 5 and 14 7 days to 16 5 12 8 3 0 and 24 5 days respectively the vertical wa distributions were a two layer structure in the case without surge wave condition the differences of the wa values between the surface and bottom layers were 6 0 days fig 16e and g in the case with surge wave condition it became less stratified due to the weakness effects of the up estuary surge waves on the vertical water circulations and mixing fig 17e and f especially around the mouth of the estuary where the vertical difference in the wa values decreased from 2 0 5 3 days to 1 5 2 5 days fig 16f as the wind field was dominated by background wind the vertical wa distribution almost became a single layer structure and the vertically largest difference in the wa values was only 2 5 days as the wind field was dominated by typhoon wind fig 16h this can attribute to the more significantly weakness effects of the up estuary surge waves on the vertical water circulations and mixing fig 17g and h in a summary the up estuary surge waves can significantly impede the water circulations in horizontal and vertical direction thereby reducing the renewal ability of the pre 4 3 influence of reclamation project on wa to the best of our knowledge the total length of the pre coastline increased by 149 2 km and the coastal land increased by 251 76 km2 in the past three decades 1990 2020 as a result of the reclamation projects fig 3 illustrates the main location of reclamation projects in the pre to study the influence of the reclamation projects on the wa the simulation of the hydrodynamic process for surge wave scenario in section 4 2 was further performed considering the variable coastline fig 18 shows the depth averaged and vertical distributions of the wa for variable coastline scenarios in the lb the reclamation projects are mainly located in jibaosha wanqingsha hengmentan and both coasts of the estuary and they narrowed the local waterways the wa values slightly decreased in the downstream of the projects and the mouth of the lb fig 18a c which can be mainly explained by that the narrowed waterways increased the seaward currents and significantly contributed to horizontal water circulations especially in narrowed waterways and their downstream fig 19 a c the increased reclamation area in the gaolan island blocks the water exchange between the hb and jtm it hindered the movement of water body with the lower wa value from east to the hb fig 19b d resulting in an increase of the wa in local regions it is obvious that the 12 day contour line clearly moved towards land fig 18b d the reclamation in the mdm narrowed its waterway leading to a decrease of the wa in this waterway which was similar with the wa variation in the lb in vertical direction the reclamation projects had very limited effects on water circulations fig 19e and f thus the difference of the wa between the surface and bottom layers slightly increased it was only increased by 1 day in narrowed waterways and their downstream and less than 1 day in other regions fig 18e and f in a summary the construction of the reclamation projects in the pre obviously changed the morphology of the shoreline and further significantly affected the horizontal water circulations and renewal ability while it has slight effects in the vertical water 5 conclusions a coupled 3d surge wave solute transport model was established to calculate the age of the water discharged from the pearl river the agreement between the measured data and calculated results showed that the model can reasonably simulate the hydrodynamic process in the pre and it is capable of simulating the tracer transport and wa distribution using the verified model a series of sensitivity runs were performed for different freshwater discharge surge wave and coastline scenarios though the present model results the main conclusions can be summarized as follows the wa values for the whole of the pre show a seasonal variation which is mainly due to the variable freshwater discharges horizontally the depth averaged wa value was smallest in the river inlets and it gradually increased along the estuary for both the winter and summer while the wa value was generally larger in the winter than that in the summer during the winter the depth averaged wa values at the mouth of the hb jm mdm and lb were 19 2 17 3 8 0 and 30 0 days respectively they decreased to 13 1 11 2 2 1 and 11 2 days during the summer respectively vertically the variation of the wa was significant in almost the whole estuarine region during the winter and the downstream during the summer due to the impediment effects of river discharge on the salinity intrusion and stratification in the stratified regions the wa value was generally smaller at the upper layer than at the lower layer the difference was 4 days during the winter and 1 2 days during the summer the up estuary surge waves can significantly impede the water circulations in horizontal and vertical direction thereby reducing the renewal ability of the pre in the case with surge wave condition the wa values slightly increased in the most of the pre and became less stratified in vertical direction compared with that in the case without surge wave condition as the wind field was dominated by background wind the wa values more apparently increased in almost the whole pre and became almost a single layer structure as wind field was dominated by typhoon wind the vertically difference in the wa values decreased from 6 days to 2 5 days the depth averaged values increased from 13 6 12 2 2 5 and 14 7 days to 16 5 12 8 3 0 and 24 5 days at the mouth of the hb jtm mdm and lb respectively by considering the variable coastline induced by reclamation projects the depth averaged wa values obviously varied due to its significant effects on horizontal water circulations while the vertical difference of the wa between the surface and bottom layers slightly increased it was only increased by 1 day in narrowed waterways and their downstream and less than 1 day in other regions the findings of this study are beneficial to understand the hydrodynamics and water renewal in a stratified estuarine system affected by typhoons and other extreme weather hazards it also may provide an auxiliary guidance in reasonably constructing reclamations for avoiding the decrease of the water exchange capacity and ecological environment degree credit authors contribution statement hongxing zhang numerical simulation validation results analysis final approval yongming shen conceptualization and methodology data curation and formal analysis original draft preparation reviewing and editing funding acquisition jun tang reviewing and editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study was funded by the key special project for introduced talents team of southern marine science and engineering guangdong laboratory guangzhou under grant no gml2019zd0403 by the program for guangdong introducing innovative and enterpreneurial teams under grant no 2019zt08l213 by guangdong provincial key laboratory project grant no 2019b121203011 and by the national nature science foundation of china under grant no 51779039 
20341,the unsteady thrust of a propeller in presence of an asymmetric upstream rudder is experimentally and numerically studied first a high resolution dynamometer is utilized to measure the unsteady thrust of the propeller downstream of a rudder in the water tunnel second by means of the large eddy simulation a cfd model including both rudder and propeller is established to predict the flow field and the unsteady thrust of the propeller after verifying the accuracy of the numerical method the influences of rudder angle on the unsteady thrust of propeller are numerically studied it is shown that for the flow field the separation location of vortices moves upstream on the rudder surface with the increase of rudder angle for the tonal forces the tonal thrust increases with the rudder angle and the transverse tonal force increases rapidly due to the increased asymmetry of the flow field for the broadband forces the force spectrum in the low frequency range increases and humps appear at the blade passing frequencies keywords rudder wake dynamometer propeller broadband force large eddy simulation 1 introduction the propeller and rudder are the main propulsion devices of the surface or underwater vehicles in which the former is an active device that generates the thrust to keep the vehicle on move and the latter is a control surface that produces the transverse force to steer or keep the vehicle on course kracht 1992 the interaction between propeller and rudder utterly changes the flow ingested by the propeller and rudder which affects the performance and unsteady forces of the propeller and rudder the knowledge of this interaction effects is nowadays a focal aspect for the improvement of ship s performance and submarine s mute features felli et al 2009 numbers of investigations are conducted to study the interactions between the propeller and rudder in terms of experimental researches most of the investigations are focused on the characteristics of the flow field and the performance measurements of the propeller the flow field around a propeller rudder system is experimentally studied through time resolved flow visualizations and ldv phase sampling measurements felli and falchi 2011 felli et al 2009 the results characterize evolution of velocity components and trailing edge vortices in detail yilmaz et al 2020 observe the cavitation of the propeller rudder system and the performance of propeller in cavitating conditions is measured in order to improve the propeller s performance the propeller boss cap fins and twisted rudder are applied cheng et al 2014 sun et al 2016 the experimental results demonstrate that the efficiency can be improved by an appropriate rudder type although there are plenty of experiments on the flow field and propeller performance the measurements of propeller unsteady forces are limited the earliest measurement of propeller unsteady forces dates to 1960s lewis 1963 when the fluctuating forces of propeller in non uniform flow are measured after that a six component dynamometer utilizing a sting mounted balance with semiconductor strain gages as the sensing elements are designed boswell and miller 1968 jessup 1990 the six components of unsteady loading at the blade passing frequency bpf are measured which agree with the predicted results within approximately 15 percent in recent studies it is found that the broadband forces could excite the global mode of the blades and induce severe vibrations chen et al 2017 tong and chen 2020 but it is much more difficult to measure than the tonal forces at bpf due to the small amplitude and influences of elastic modes the only measurements of propeller broadband force in open literature are conducted by sevik 1970 in the experiment the dynamometer utilizing piezoelectric crystal as the sensing elements are designed the broadband forces of propeller ingested isotropic inflow turbulence generated by grids are measured in general these experiments on the unsteady forces are not in good agreements with the predicted results and these measurement methods have not been widely used subsequently in terms of numerical researches both the potential flow theory and turbulence model have been applied in the prediction of flow parameters and propeller forces a computational method based on lifting theory and potential surface panel method has been developed to predict the hydrodynamic performance of the propeller rudder system ghassemi and ghadimi 2008 hydrodynamic performance can be predicted well for the rudder angles up to 30 by means of detailed propeller rudder system model and fine meshes the cfd methods can predict the evolution of the flow field more accurately di mascio et al 2015 posa et al 2019 sun et al 2018 villa et al 2020 the rans method is applied to study the hull propeller rudder system in oblique flow the tonal forces at the first and second blade passing frequencies are studied in case of different drift angles sun et al 2018 in order to investigate the statistic characteristics of flow field around propeller rudder system large eddy simulations are carried out on a notional submarine propeller in presence of an upstream rudder posa et al 2019 2021 the immersed boundary methodology is adopted to simulate the rotation of propeller by means of grids of more than 1 7 billion nodes the characteristics of the flow field are clearly captured it is found that the largest coherent structures in the flow field are the propeller tip vortices and hub vortex the topology of which is unchanged for different rudder angle soon after the same numerical methods are utilized to further investigate the wake structure of a propeller upstream a rudder posa et al 2020a b results show that the interaction between hub vortex and the boundary layer of rudder is important to the dynamics of the overall wake similarly there is still little research on the broadband forces of the propeller in the propeller rudder system yao et al 2020 combines the fourier spectral synthesis and the large eddy simulations to predict the broadband forces of the propeller ingesting isotropic turbulence inflow the characteristics of the predicted curve are consistent with experimental results but the inflow conditions in the investigations are too ideal in this paper the unsteady thrust of a propeller in presence of an asymmetric upstream rudder are experimentally and numerically studied a high resolution dynamometer is utilized to measure the unsteady forces of the propeller downstream of a rudder under different advance coefficients by means of the large eddy simulation a cfd model including rudder and propeller is established in detail to calculate the flow field distribution and the unsteady forces of the propeller in order to investigate characteristics of propeller forces in steering conditions five cases with different rudder angles α 0 7 5 15 22 5 30 are numerically studied and compared the influences of the rudder angle on the flow field the time averaged forces and the unsteady forces of the propeller rudder system are discussed the motivation is to discover the characteristics of propeller unsteady thrust in the practical sailing and steering conditions which will be helpful in the future design on low noise propulsion 2 experimental investigations the unsteady thrust of a propeller in presence of an upstream rudder is measured in the shanghai jiao tong university sjtu cavitation tunnel with a dynamometer in this section the parameters of the water tunnel and configurations of the experiment are introduced first then the parameters and calibration results of the dynamometer are discussed finally the measured results of three test conditions are compared 2 1 experimental apparatus the cavitation tunnel in sjtu has a test section in length of 6 1m and its cross section is 1m 1m as shown in fig 1 the maximum flow velocity is 15 m s the range of the static pressure at the centerline of the test section can be varied from 25 kpa to 300 kpa the non uniformity of the axial flow velocity is below 1 and the turbulent intensity of the inflow is below 0 3 the experiment conducted with a dtmb 4382 propeller and a rudder of naca0012 section the main characteristic parameters of the propeller are shown in table 1 the expanded view of the propeller converts the propeller from its helix to a flat plane the expanded area is the propeller blade area in the expanded view and the expanded area ratio is defined as 1 ear a e π r 2 z r h r c d r π r 2 where z is the number of blades r h is the radius of propeller hub r is the radius of the propeller the advance ratio is defined as 2 j v n d where v is the advance velocity of the propeller n is the rotation speed in hz and d is the diameter of the propeller the relative location and size of the propeller rudder system is shown in fig 2 a in order to guarantee the strength of structures upper part of the rudder gradually increases in section area and connects to the wall of the water tunnel the lower part of rudder is facing the upper part of the propeller and the distance between the propeller and the rudder is 100 mm for purpose of simulating the asymmetric and intensity wake in the actual situation other instruments in the experiment are shown in fig 2 b 2 2 dynamometer and test configuration the dynamometer utilized in the experiment is specially designed for the measurements of the unsteady thrust of propeller as shown in fig 3 the length of the dynamometer is 2 5m the measuring range is 0 800n and the resolution of the dynamometer is 0 001n the calibration test is required before the measurements as shown in fig 4 a a vibration exciter is fixed in front of the dynamometer to providing a horizontal thrust to the propeller the input force is measured by the standard force transducer which connects the vibration exciter with the propeller then the thrust is measured by the dynamometer and compared with the input force in the calibration test the white noise signal is input to obtain the transfer function of the system as shown in fig 4 b it is indicated that the useful range of the dynamometer is within 500hz in order to ensure the water tightness and reliability of signal transmission the installation of the rudder and the dynamometer are specially designed according to the structure of water tunnel as shown in fig 5 the rudder is fixed in the water tunnel through cover plate 1 the distance from the propeller is adjusted by placing the rudder at different positions on the cover plate the distance is fixed at 100 mm in the experiment the dynamometer is installed in the water tunnel through cover plate 2 in the experimental installation due to design and processing errors the size of rudder failed to fit the upper wall when its bottom surface is at the center line of the water tunnel finally the rudder is fixed to the upper wall by bolts and a few pads as indicated in fig 2 a the length of the rudder is 465 mm and the length of the tunnel is 1m so there is about 35 mm gap between the top of rudder and upper wall during the measurement the unsteady force acting on the propeller induced by the non uniform flow is converted into the charge signal by the piezoelectric force sensor the sensor is installed closely to the propeller to obtain the undistorted signal then the charge is converted into the voltage signal by the charge amplifier the signal is transmitted to the acquisition instrument through the slip ring finally the unsteady forces acting on the propeller are obtained by processing on the computer 2 3 test results seven cases of different advance coefficients are tested under the rotation speed of 20rps 15rps and 11rps which are listed in table 2 as shown in fig 6 a the main feature of the unsteady forces in frequency domain is the superposition of broadband components and tonal components the tonal components are tonal forces at the blade passing frequency bpf and its multiples the broadband components decay exponentially as the frequency increases from the general trend as shown in fig 6 a fig 6 b when the rotation speed is constant the broadband unsteady force increases with the increase of advance coefficients fig 6 a fig 6 b also compare the unsteady forces at the first two passing frequencies of the propeller results show that the tonal forces increase significantly with the increase of advance coefficients when the rotation speed is constant in addition the tonal force at the first passing frequency is much larger than that at the second blade passing frequency as shown in fig 6 c when the advance coefficient is constant the unsteady forces increase significantly with the rotation speed 3 numerical investigations in this section the propeller in presence of an upstream rudder is numerically studied firstly numerical simulation is performed on the above test conditions with fluent solvers to mutually verify the measurement results and the numerical results the agreement between the computational results and the experimental results is excellent after the validation the influences of the rudder angle on the unsteady force of the propeller are studied 3 1 numerical schemes in order to obtain the accurate unsteady forces of the propeller the large eddy simulation les is adopted to resolve the flow field around the rudder and propeller the governing equations for les are derived by filtering the incompressible navier stokes equations as 3 u i x i 0 4 u i t u i u j x i 1 ρ p x i x j ν u i x j τ i j x j where u i and p denote the filtered velocity and filtered pressure respectively the quantity τ i j is the subgrid scales sgs stress τ i j u i u j u i u j taking into account the effect of the subgrid scales on the resolved ones the approximate governing equations are obtained by modeling the sgs stress using different models in the present simulations using fluent solvers the wall adaptive local eddy viscosity wale model nicoud and ducros 1999 is employed in the calculations 3 2 computational domain and boundary conditions the section of the computational domain is consistent with the section of the water tunnel as shown in fig 7 in order to handle the rotating propeller in presence of the stationary rudder the mesh moving method is utilized and the fluid domain is divided into a rotating domain and a stationary domain as shown in fig 7 a the rotating domain is a cylinder domain with 300 mm diameter which completely encloses the propeller flow field data is transmitted at the interface between these two domains the coordinate system is chosen such that the propeller which rotates around the negative x axis is located at the origin and the flow stream is in the direction of positive x the inlet and outlet of the domain is located 3m from the origin and the distance between the propeller and rudder is 100 mm the geometry of the rudder and the relative position between the rudder and the propeller is the same as that in the experiment test the gap between the rudder and the upper wall of water tunnel is also reflected in the computational domain all simulations here deal with the rotation speed of 20rps the non uniformity of the axial velocity of the water tunnel is less than 1 so it is appropriate for the inflow to be regarded as a uniform flow on the other hand the turbulence intensity of the water tunnel is less than 0 3 and there are no other obstacles in front of the propeller rudder system thus the inlet condition is the uniform incoming flow of 4 45 m s without velocity fluctuations the gauge pressure of the outlet is 0 pa which is the same in the experiments the shear condition of the wall is no slip three advance velocities are investigated corresponding to the advance coefficients of 0 5 0 7 and 0 89 the reynolds number relevant to the propeller re p based on the chord and the relative velocity at 0 7r of the blade is equal to 5 re p c 0 7 r 2 π n 0 7 r 2 u 2 ν while the reynolds number relevant to the rudder re r based on the chord of the rudder and the free stream velocity is equal to 6 re r c r u ν thus the reynolds number relevant to the propeller is 1 901 000 1 913 000 and 1 927 000 and the reynolds number relevant to the rudder is 618 900 866 300 and 1 101 000 for three different working conditions respectively the grids of the computational domain have 6 2 million control volumes consisting of only hexahedral cells the unstructured grids for the propeller and the rudder are shown in fig 8 which are carefully designed to capture the essential features of the flow field in order to resolve the near wall flow features the grids are clustered to the propeller and rudder surface twenty layers of the hexahedral cells are extruded from the surface with a minimum wall normal spacing of 0 0004d on the blades and 0 002d on the rudder the transition of the fine grids to the coarse grids is achieved by applying a growth ratio of 1 1 the non dimensional distance y on the blade and the rudder is 1 2 and 0 8 respectively according to cfl criterion for convergence the time step size is set as 1 389 10 4 s namely the time in which the propeller rotates 1 to guarantee enough temporal resolution the unsteady force data are sampled every time step 3 3 mesh converge analysis the mesh independent test on hydrodynamic performance is conducted with three different grid numbers as listed in table 3 the inflow velocity is 4 45 m s and the rotation speed is 20rps time averaged thrust coefficients and the fluctuating thrust coefficients at the first blade passing frequency are compared which are defined as 7 k t t ρ n 2 d 4 8 k t 1 b p f t 1 b p f ρ n 2 d 4 where t is the time averaged propeller thrust t 1 b p f is the fluctuating thrust at the first blade passing frequency n is the rotation speed in hz and d is the diameter of the propeller the results show that the medium and fine grids have less than 1 discrepancy with respect to the time averaged thrust coefficients for the fluctuating force at the first blade passing frequency the discrepancy between the medium and fine grids is less than 5 because the dynamometer is specially designed for the measurements of unsteady thrust of the propeller there are no experimental results for the time averaged thrust and only the thrust at the first blade passing frequency are validated with the experimental data the fluctuating blade thrust coefficient measured in the experiment is 2 884 10 4 deviation from the experimental results are listed in table 1 in order to verify that the grid is fine enough the results of the urans model conducted with the medium cells are compared with that of les model it is shown that the fluctuating thrust at the first blade passing frequency calculated by les is much closer to the experimental data nevertheless the discrepancy between numerical results of les model and the experimental results still exceeds 15 this is mainly caused by two reasons on the one hand the quantities of the fluctuating forces at the first blade passing frequencies is small in magnitude which is about one thousandth of the time averaged thrust numerical noise will more or less affect the results one the other hand non uniformity of inflow in numerical calculations is weaker than that of experiments 3 4 validation in the numerical investigation the three test conditions in experiments are firstly calculated the calculated unsteady thrust is compared with the measured ones in the frequency domain as shown in fig 9 a fig 9 c on the whole the magnitude of the calculated thrust is the same as that of the measured results the trend of the calculated force is a good match with the measured force within 500hz especially around 100hz which is the first blade passing frequency there is a significant discrepancy between the calculated unsteady thrust and the measured thrust within the low frequency range 50hz where the calculated thrust is larger than the measured thrust for the tonal forces at the first passing frequency the agreement between the calculated force and measured force is excellent at the advance coefficients 0 5 and 0 7 as shown in table 4 when the advance coefficients is 0 9 the deviation from the experimental results exceeds 15 the reason is that the non uniformity and fluctuations of inflow increase with the increase of speed in addition there is no distinct spectrum line at the second and third blade passing frequencies in the numerical results the reason is that the spatial non uniformity of inflow in numerical calculations is weaker than that of experiments in general the numerical results are consistent with the measured results which indicates that the numerical method and experimental method is convincible like the measurement results the calculated unsteady thrust reflects the obvious characteristics of the propeller unsteady forces namely the superposition of broadband components and tonal components to facilitate analysis and comparison between different working conditions the broadband components and the tonal components are usually separated furthermore due to the numerical noise in the calculation results it is necessary to smooth the broadband components an adjacent averaged weighting approach yao et al 2020 is utilized according to the following equation 9 g i j 1 n w j f j i n 2 n w j 1 j i 1 n 1 2 2 where f i and g i are the i th input and output data points n is the total number of points in the window and w j is a quadratic weight factor the smoothed numerical results are compared with the measured results as shown in fig 10 for broadband spectrum the two have a consistent trend of change for the three advance coefficients thus the numerical results will smooth with the adjacent averaged weighting approach in the following discussion 3 5 influences of rudder angles on the propeller force when the ship is sailing turning the rudder will directly change the characteristics of flow field which will result in the enhancement of propeller unsteady force and induce severe vibration and noise in order to investigate influences of rudder angle another four rudder angles relative to the free stream are simulated α 7 5 15 22 5 30 indicated as cases c075 c150 c225 and c300 respectively as shown in fig 11 the right handed cartesian coordinates system utilized in the following analysis is consistent with that in fig 11 from downstream to upstream the left side is port side and the right side is starboard side as shown in fig 11 a the zero rudder angle investigated in the experiment is denoted as c000 all the simulations here deal with advance coefficients equal to 0 89 with 4 45 m s inflow velocity and 20rps rotation speed analysis of different rudder angles are divided into three parts influences on the flow field influences on the time averaged forces of propeller and influences on the unsteady forces of propeller in the following analysis the time averaged quantities are computed as follow 10 g x y z 1 m i 1 m g x y z t i where g represents the time average of quantity g and m is the number of instantaneous realizations the phase averages of quantities of the flow field are estimated with instantaneous flow fields associated to the same reference position of the propeller blade thus the expression of the phase averaged quantities is 11 g x y z 1 n i 1 n g x y z t 0 i 1 n m where g represents the phase average of quantity g n is the number of instantaneous realizations corresponding to the same reference position of the propeller blade t 0 is the instant in time when the collection is started n is the frequency of the rotation and m is the number of propeller blades 3 5 1 influences on the flow field the change of rudder angle significantly alters the wake of rudder namely the inflow of propeller which will greatly affect the force induced on the propeller the phase averaged stream wise vorticity on x y and x z plane of the rudder wake are shown in fig 12 from the perspective of x y plane the axial vorticity behind the bottom tip of rudder becomes larger with the increase of the rudder angle moreover the wake region at the bottom tip of rudder bends upwards with the increase of rudder angle the perspective of x z plane is shown in fig 12 b for c000 the vorticity separates at the trailing edge on both surface a and surface b with the increase of rudder angle the separation location on surface a moves upstream while the separation location on surface b is still at the trailing edge in addition the vorticity separating from surface a increases significantly with the increase of rudder angle more details of coherent structures are compared for different rudder angles via three y z planes as shown in fig 13 fig 13 a shows the phase averaged second invariant of velocity gradient tensor in the near wake of rudder x d 0 608 there are two symmetric structure along the positive y axis see in fig 13 b c000 which are associated to the trailing edge and bottom tip of the rudder as the increase of rudder angle the symmetry of wake disappears in addition the wake region of the rudder trailing edge gradually spread into a ring surrounding the vortex associated to the bottom tip of rudder fig 13 b reports the rudder wake of x y plane at x d 0 428 compared with the upstream plane the area of wake region associated to the trailing edge of rudder decreases when the rudder is parallel to the inflow direction c000 while the wake region associated to the bottom tip of rudder is almost unchanged moreover once the rudder angle increases c075 c150 c225 and c300 the wake region becomes larger and rotates around x axis compared to the upstream plane the evolution of wake region indicates that the influences of propeller rotation on the upstream increases with the rudder angle as shown in fig 13 c after impinging on the hub the significant vortex region accumulates on the surface of the hub and the magnitude increases with the rudder angle the radial profiles of axial velocity for different rudder angles are shown in figs 14 and 15 in order to analyze the asymmetry of rudder wake fig 14 compares the radial profile of axial velocity along y axis see in fig 14 a due to the asymmetry of rudder the axial velocity on the upper plane is smaller than the lower plane however the increase in rudder angle compensates for the asymmetry see c075 c3000 in fig 14 a and the asymmetry gradually decreases with the evolution of the flow field as shown in fig 14 b and c in order to analyze the influences of rudder angles on the flow field fig 15 compares the radial profile of axial velocity along z axis see in fig 15 a as the increase of rudder angle the velocity deficit at the center of profile moves to the starboard side in the near wake of the rudder more humps appear on the starboard side with the increase of rudder angle as shown in fig 15 b by unfolding the cylindrical surface with different radii i e 0 3r 0 6r and 0 9r around the propeller fig 16 reveals changes of the flow field with the increase of rudder angle in details for blades at 0 3r the wake is roughly uniform after different blades when the rudder is parallel with flow direction c000 once the rudder deflects wake after different blades advance with different speed see c075 in fig 16 a the vortices on the starboard side deflect to the port side see c075 in fig 17 a as the rudder angle continues to increase see c0150 c225 and c300 in fig 17 a the magnitude of vortices increases and vortices separateing from different blades on the starboard side are mixed in addition low speed regions downstream blades are mixed which completely changes the flow field near the blade facing the rudder see c0150 c225 and c300 in fig 16 a the differences of axial speed on the pressure side and suction side of this blade tend to vanish which indicates that the thrust generated on the blade decrease rapidly this is validated by the contour of pressure as shown in fig 17 b the difference of pressure between the pressure side and suction side becomes smaller however these influences on the blade generally vanish with the increase of radius see in fig 16 b and c the reason is that the velocity increase with the radius and the mixing process of wake regions moves downstream 3 5 2 influences on the time averaged forces of propeller and rudder influences of the rudder angle on the time averaged forces of propeller are discussed in this section fig 18 compares the time averaged forces of propeller for different rudder angles in general the transverse and vertical forces of propeller is an order of magnitude smaller than force in the flow direction with the increase of rudder angle amplitude of the propeller force in flow direction increases linearly the vertical force decreases first and then increase to 29n as shown in fig 18 d changes of the transverse force are more complicated the force nearly vanishes for c075 then the direction of force reverses for c150 c225 and c300 the force is maximum when the rudder angle is 22 5 c225 3 5 3 influences on the unsteady forces of propeller and rudder in this section the unsteady forces are analyzed for different rudder angles as indicated in the experimental results the unsteady forces in frequency domain are the superposition of broadband components and tonal components so the broadband components and tonal components of unsteady forces are analyzed separately for the convenience of comparison the tonal forces of the propeller at the first blade passing frequency for different rudder angles are compared in fig 19 although the time averaged forces in vertical direction and transverse direction are negligible compared with time averaged thrust the fluctuating forces in these two directions at the first blade passing frequency are comparable with the fluctuating thrust as shown in fig 19 a furthermore the fluctuating transverse forces exceed the thrust for large rudder angles see c225 and c300 it can be explained by the phase averaged pressure around the blade as shown in fig 17 b when the rudder angle is large for c225 and c300 the differences of pressure between the pressure side and suction side of the blade facing the rudder tend to vanish which leads to the decrease of thrust generated on the blade thus the transverse asymmetry increases and the transverse force increases the variation trend for tonal forces at different directions are shown in detail in fig 19 b d for the propeller thrust see in fig 19 b the force has two surges with the increase of rudder angle i e from c075 to c150 and from c225 to c300 where the tonal force increases more than twofold for the vertical force and transverse force see in fig 19 c fig 19 d the forces increase almost exponentially with the rudder angle the broadband force spectra of the propeller for different rudder angles are compared in fig 20 in general the broadband thrust spectrum is an order magnitude higher than the vertical and transverse broadband force spectrum which is different from the tonal forces the force spectrum decays logarithmically with increasing frequency as the increase of rudder angle the force spectrum increases sharply within 200hz compared with c000 the force spectrum even increases by more than two orders of magnitude at 0hz for c300 since the longitudinal vibration mode and bending modes of the propeller shaft are usually very low within 200hz in ocean industry the steering of ship increase of rudder angle could excite these modes and cause severe vibration when the frequency exceeds 200hz the increase of force spectrum is not obvious with the rudder angle in addition the decay of broadband force spectrum is relatively smooth when the rudder is parallel with the flow direction c000 when the rudder is oblique to the flow direction c075 c150 c225 and c300 humps appear at the blade passing frequencies in order to explain the variation characteristics of broadband force spectrum with rudder angle the velocity spectrum at eight points in the flow field are investigated as shown in fig 21 four points on the x y plane are investigated which are located at 0 3r and 0 9r and distributed along y axis the x y plane is divided into upper and lower planes along x axis at the location of 0 3r see fig 21 b velocity at the upper plane and lower plane is asymmetric this asymmetry of velocity spectrum increases rapidly for c300 especially in the low frequency range at the location of 0 9r see fig 21 c the velocity spectrum on the upper plane is larger than that on the lower plane within 100hz it indicates that energy of eddies on the upper plane is larger than that on the lower plane especially for eddies with large scale in the low frequency range as shown in fig 22 four points on the x z plane are investigated which are located at 0 3r and 0 9r and distributed along z axis the x z plane is divided into left and right planes along x axis the velocity spectrum on the right plane has little change when the rudder angle increases from 0 to 22 5 when the rudder angle increases to 30 the velocity spectrum decreases rapidly on the right plane on the left plane the velocity spectrum increases with the rudder angle within 100hz to summarize the energy of large scaled eddies increases with the rudder angle it explains the significant increase of broadband force spectrum in the low frequency range in addition the spatial distribution of eddies becomes asymmetric with the increase of rudder angle the energy of eddies is more concentrated on the upper x y plane and left x z plane it explains the increase of vertical and transverse broadband force spectrum as shown in fig 20 4 conclusions the unsteady thrust of a propeller in presence of an asymmetric upstream rudder is experimentally and numerically studied first the unsteady force of the propeller is measured with a high resolution dynamometer second by means of detailed propeller rudder model and fine meshes the large eddy simulation is applied to calculate the flow field distribution and unsteady thrust of the propeller after verifying the accuracy of the numerical method the influences of rudder angle on the flow field and unsteady forces of propeller are numerically studied results are summarized as follow i the spatial non uniformity and temporal unsteadiness of the flow field induced by the upstream rudder leads to the changes in tonal components and broadband components of the propeller thrust which is reflected in both experimental and numerical studies the good agreements with experimental results demonstrate that the numerical model based on the large eddy simulation can accurately capture the variation trend of tonal components and broadband components in low frequency range ii the analysis of the phase averaged quantities of inflow field indicates that both the intensity of the vortex and the asymmetry of the flow field increases with the rudder angle the former leads to the increase of tonal forces in three directions and the latter causes the transverse force to increase the most when the rudder angle increases from 0 to 30 the tonal thrust increases from 0 16n to 1 04n while the transverse force increases from 0 1n to 1 07n iii the analysis of statistical characteristics of inflow field indicates that with the increase of rudder angle the energy distribution of eddies in the wake is changed in two aspects on the one hand the energy of large scale eddies increases with the rudder angle it explains the significant increase of broadband force spectrum in the low frequency range on the other hand the spatial distribution of eddies becomes more asymmetric with the increase of rudder angle the energy of eddies are more concentrated on the upper x y plane and left x z plane it explains the increase of vertical and transverse broadband force spectrum credit authorship contribution statement x d tong conceptualization methodology software investigation resources data curation writing original draft visualization h y chen software investigation visualization x q dong investigation visualization software y chen writing review editing formal analysis validation supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the work was supported by national nature science foundation of china grant no 52071214 the work is also supported by the deep blue program of shanghai jiao tong university 
20341,the unsteady thrust of a propeller in presence of an asymmetric upstream rudder is experimentally and numerically studied first a high resolution dynamometer is utilized to measure the unsteady thrust of the propeller downstream of a rudder in the water tunnel second by means of the large eddy simulation a cfd model including both rudder and propeller is established to predict the flow field and the unsteady thrust of the propeller after verifying the accuracy of the numerical method the influences of rudder angle on the unsteady thrust of propeller are numerically studied it is shown that for the flow field the separation location of vortices moves upstream on the rudder surface with the increase of rudder angle for the tonal forces the tonal thrust increases with the rudder angle and the transverse tonal force increases rapidly due to the increased asymmetry of the flow field for the broadband forces the force spectrum in the low frequency range increases and humps appear at the blade passing frequencies keywords rudder wake dynamometer propeller broadband force large eddy simulation 1 introduction the propeller and rudder are the main propulsion devices of the surface or underwater vehicles in which the former is an active device that generates the thrust to keep the vehicle on move and the latter is a control surface that produces the transverse force to steer or keep the vehicle on course kracht 1992 the interaction between propeller and rudder utterly changes the flow ingested by the propeller and rudder which affects the performance and unsteady forces of the propeller and rudder the knowledge of this interaction effects is nowadays a focal aspect for the improvement of ship s performance and submarine s mute features felli et al 2009 numbers of investigations are conducted to study the interactions between the propeller and rudder in terms of experimental researches most of the investigations are focused on the characteristics of the flow field and the performance measurements of the propeller the flow field around a propeller rudder system is experimentally studied through time resolved flow visualizations and ldv phase sampling measurements felli and falchi 2011 felli et al 2009 the results characterize evolution of velocity components and trailing edge vortices in detail yilmaz et al 2020 observe the cavitation of the propeller rudder system and the performance of propeller in cavitating conditions is measured in order to improve the propeller s performance the propeller boss cap fins and twisted rudder are applied cheng et al 2014 sun et al 2016 the experimental results demonstrate that the efficiency can be improved by an appropriate rudder type although there are plenty of experiments on the flow field and propeller performance the measurements of propeller unsteady forces are limited the earliest measurement of propeller unsteady forces dates to 1960s lewis 1963 when the fluctuating forces of propeller in non uniform flow are measured after that a six component dynamometer utilizing a sting mounted balance with semiconductor strain gages as the sensing elements are designed boswell and miller 1968 jessup 1990 the six components of unsteady loading at the blade passing frequency bpf are measured which agree with the predicted results within approximately 15 percent in recent studies it is found that the broadband forces could excite the global mode of the blades and induce severe vibrations chen et al 2017 tong and chen 2020 but it is much more difficult to measure than the tonal forces at bpf due to the small amplitude and influences of elastic modes the only measurements of propeller broadband force in open literature are conducted by sevik 1970 in the experiment the dynamometer utilizing piezoelectric crystal as the sensing elements are designed the broadband forces of propeller ingested isotropic inflow turbulence generated by grids are measured in general these experiments on the unsteady forces are not in good agreements with the predicted results and these measurement methods have not been widely used subsequently in terms of numerical researches both the potential flow theory and turbulence model have been applied in the prediction of flow parameters and propeller forces a computational method based on lifting theory and potential surface panel method has been developed to predict the hydrodynamic performance of the propeller rudder system ghassemi and ghadimi 2008 hydrodynamic performance can be predicted well for the rudder angles up to 30 by means of detailed propeller rudder system model and fine meshes the cfd methods can predict the evolution of the flow field more accurately di mascio et al 2015 posa et al 2019 sun et al 2018 villa et al 2020 the rans method is applied to study the hull propeller rudder system in oblique flow the tonal forces at the first and second blade passing frequencies are studied in case of different drift angles sun et al 2018 in order to investigate the statistic characteristics of flow field around propeller rudder system large eddy simulations are carried out on a notional submarine propeller in presence of an upstream rudder posa et al 2019 2021 the immersed boundary methodology is adopted to simulate the rotation of propeller by means of grids of more than 1 7 billion nodes the characteristics of the flow field are clearly captured it is found that the largest coherent structures in the flow field are the propeller tip vortices and hub vortex the topology of which is unchanged for different rudder angle soon after the same numerical methods are utilized to further investigate the wake structure of a propeller upstream a rudder posa et al 2020a b results show that the interaction between hub vortex and the boundary layer of rudder is important to the dynamics of the overall wake similarly there is still little research on the broadband forces of the propeller in the propeller rudder system yao et al 2020 combines the fourier spectral synthesis and the large eddy simulations to predict the broadband forces of the propeller ingesting isotropic turbulence inflow the characteristics of the predicted curve are consistent with experimental results but the inflow conditions in the investigations are too ideal in this paper the unsteady thrust of a propeller in presence of an asymmetric upstream rudder are experimentally and numerically studied a high resolution dynamometer is utilized to measure the unsteady forces of the propeller downstream of a rudder under different advance coefficients by means of the large eddy simulation a cfd model including rudder and propeller is established in detail to calculate the flow field distribution and the unsteady forces of the propeller in order to investigate characteristics of propeller forces in steering conditions five cases with different rudder angles α 0 7 5 15 22 5 30 are numerically studied and compared the influences of the rudder angle on the flow field the time averaged forces and the unsteady forces of the propeller rudder system are discussed the motivation is to discover the characteristics of propeller unsteady thrust in the practical sailing and steering conditions which will be helpful in the future design on low noise propulsion 2 experimental investigations the unsteady thrust of a propeller in presence of an upstream rudder is measured in the shanghai jiao tong university sjtu cavitation tunnel with a dynamometer in this section the parameters of the water tunnel and configurations of the experiment are introduced first then the parameters and calibration results of the dynamometer are discussed finally the measured results of three test conditions are compared 2 1 experimental apparatus the cavitation tunnel in sjtu has a test section in length of 6 1m and its cross section is 1m 1m as shown in fig 1 the maximum flow velocity is 15 m s the range of the static pressure at the centerline of the test section can be varied from 25 kpa to 300 kpa the non uniformity of the axial flow velocity is below 1 and the turbulent intensity of the inflow is below 0 3 the experiment conducted with a dtmb 4382 propeller and a rudder of naca0012 section the main characteristic parameters of the propeller are shown in table 1 the expanded view of the propeller converts the propeller from its helix to a flat plane the expanded area is the propeller blade area in the expanded view and the expanded area ratio is defined as 1 ear a e π r 2 z r h r c d r π r 2 where z is the number of blades r h is the radius of propeller hub r is the radius of the propeller the advance ratio is defined as 2 j v n d where v is the advance velocity of the propeller n is the rotation speed in hz and d is the diameter of the propeller the relative location and size of the propeller rudder system is shown in fig 2 a in order to guarantee the strength of structures upper part of the rudder gradually increases in section area and connects to the wall of the water tunnel the lower part of rudder is facing the upper part of the propeller and the distance between the propeller and the rudder is 100 mm for purpose of simulating the asymmetric and intensity wake in the actual situation other instruments in the experiment are shown in fig 2 b 2 2 dynamometer and test configuration the dynamometer utilized in the experiment is specially designed for the measurements of the unsteady thrust of propeller as shown in fig 3 the length of the dynamometer is 2 5m the measuring range is 0 800n and the resolution of the dynamometer is 0 001n the calibration test is required before the measurements as shown in fig 4 a a vibration exciter is fixed in front of the dynamometer to providing a horizontal thrust to the propeller the input force is measured by the standard force transducer which connects the vibration exciter with the propeller then the thrust is measured by the dynamometer and compared with the input force in the calibration test the white noise signal is input to obtain the transfer function of the system as shown in fig 4 b it is indicated that the useful range of the dynamometer is within 500hz in order to ensure the water tightness and reliability of signal transmission the installation of the rudder and the dynamometer are specially designed according to the structure of water tunnel as shown in fig 5 the rudder is fixed in the water tunnel through cover plate 1 the distance from the propeller is adjusted by placing the rudder at different positions on the cover plate the distance is fixed at 100 mm in the experiment the dynamometer is installed in the water tunnel through cover plate 2 in the experimental installation due to design and processing errors the size of rudder failed to fit the upper wall when its bottom surface is at the center line of the water tunnel finally the rudder is fixed to the upper wall by bolts and a few pads as indicated in fig 2 a the length of the rudder is 465 mm and the length of the tunnel is 1m so there is about 35 mm gap between the top of rudder and upper wall during the measurement the unsteady force acting on the propeller induced by the non uniform flow is converted into the charge signal by the piezoelectric force sensor the sensor is installed closely to the propeller to obtain the undistorted signal then the charge is converted into the voltage signal by the charge amplifier the signal is transmitted to the acquisition instrument through the slip ring finally the unsteady forces acting on the propeller are obtained by processing on the computer 2 3 test results seven cases of different advance coefficients are tested under the rotation speed of 20rps 15rps and 11rps which are listed in table 2 as shown in fig 6 a the main feature of the unsteady forces in frequency domain is the superposition of broadband components and tonal components the tonal components are tonal forces at the blade passing frequency bpf and its multiples the broadband components decay exponentially as the frequency increases from the general trend as shown in fig 6 a fig 6 b when the rotation speed is constant the broadband unsteady force increases with the increase of advance coefficients fig 6 a fig 6 b also compare the unsteady forces at the first two passing frequencies of the propeller results show that the tonal forces increase significantly with the increase of advance coefficients when the rotation speed is constant in addition the tonal force at the first passing frequency is much larger than that at the second blade passing frequency as shown in fig 6 c when the advance coefficient is constant the unsteady forces increase significantly with the rotation speed 3 numerical investigations in this section the propeller in presence of an upstream rudder is numerically studied firstly numerical simulation is performed on the above test conditions with fluent solvers to mutually verify the measurement results and the numerical results the agreement between the computational results and the experimental results is excellent after the validation the influences of the rudder angle on the unsteady force of the propeller are studied 3 1 numerical schemes in order to obtain the accurate unsteady forces of the propeller the large eddy simulation les is adopted to resolve the flow field around the rudder and propeller the governing equations for les are derived by filtering the incompressible navier stokes equations as 3 u i x i 0 4 u i t u i u j x i 1 ρ p x i x j ν u i x j τ i j x j where u i and p denote the filtered velocity and filtered pressure respectively the quantity τ i j is the subgrid scales sgs stress τ i j u i u j u i u j taking into account the effect of the subgrid scales on the resolved ones the approximate governing equations are obtained by modeling the sgs stress using different models in the present simulations using fluent solvers the wall adaptive local eddy viscosity wale model nicoud and ducros 1999 is employed in the calculations 3 2 computational domain and boundary conditions the section of the computational domain is consistent with the section of the water tunnel as shown in fig 7 in order to handle the rotating propeller in presence of the stationary rudder the mesh moving method is utilized and the fluid domain is divided into a rotating domain and a stationary domain as shown in fig 7 a the rotating domain is a cylinder domain with 300 mm diameter which completely encloses the propeller flow field data is transmitted at the interface between these two domains the coordinate system is chosen such that the propeller which rotates around the negative x axis is located at the origin and the flow stream is in the direction of positive x the inlet and outlet of the domain is located 3m from the origin and the distance between the propeller and rudder is 100 mm the geometry of the rudder and the relative position between the rudder and the propeller is the same as that in the experiment test the gap between the rudder and the upper wall of water tunnel is also reflected in the computational domain all simulations here deal with the rotation speed of 20rps the non uniformity of the axial velocity of the water tunnel is less than 1 so it is appropriate for the inflow to be regarded as a uniform flow on the other hand the turbulence intensity of the water tunnel is less than 0 3 and there are no other obstacles in front of the propeller rudder system thus the inlet condition is the uniform incoming flow of 4 45 m s without velocity fluctuations the gauge pressure of the outlet is 0 pa which is the same in the experiments the shear condition of the wall is no slip three advance velocities are investigated corresponding to the advance coefficients of 0 5 0 7 and 0 89 the reynolds number relevant to the propeller re p based on the chord and the relative velocity at 0 7r of the blade is equal to 5 re p c 0 7 r 2 π n 0 7 r 2 u 2 ν while the reynolds number relevant to the rudder re r based on the chord of the rudder and the free stream velocity is equal to 6 re r c r u ν thus the reynolds number relevant to the propeller is 1 901 000 1 913 000 and 1 927 000 and the reynolds number relevant to the rudder is 618 900 866 300 and 1 101 000 for three different working conditions respectively the grids of the computational domain have 6 2 million control volumes consisting of only hexahedral cells the unstructured grids for the propeller and the rudder are shown in fig 8 which are carefully designed to capture the essential features of the flow field in order to resolve the near wall flow features the grids are clustered to the propeller and rudder surface twenty layers of the hexahedral cells are extruded from the surface with a minimum wall normal spacing of 0 0004d on the blades and 0 002d on the rudder the transition of the fine grids to the coarse grids is achieved by applying a growth ratio of 1 1 the non dimensional distance y on the blade and the rudder is 1 2 and 0 8 respectively according to cfl criterion for convergence the time step size is set as 1 389 10 4 s namely the time in which the propeller rotates 1 to guarantee enough temporal resolution the unsteady force data are sampled every time step 3 3 mesh converge analysis the mesh independent test on hydrodynamic performance is conducted with three different grid numbers as listed in table 3 the inflow velocity is 4 45 m s and the rotation speed is 20rps time averaged thrust coefficients and the fluctuating thrust coefficients at the first blade passing frequency are compared which are defined as 7 k t t ρ n 2 d 4 8 k t 1 b p f t 1 b p f ρ n 2 d 4 where t is the time averaged propeller thrust t 1 b p f is the fluctuating thrust at the first blade passing frequency n is the rotation speed in hz and d is the diameter of the propeller the results show that the medium and fine grids have less than 1 discrepancy with respect to the time averaged thrust coefficients for the fluctuating force at the first blade passing frequency the discrepancy between the medium and fine grids is less than 5 because the dynamometer is specially designed for the measurements of unsteady thrust of the propeller there are no experimental results for the time averaged thrust and only the thrust at the first blade passing frequency are validated with the experimental data the fluctuating blade thrust coefficient measured in the experiment is 2 884 10 4 deviation from the experimental results are listed in table 1 in order to verify that the grid is fine enough the results of the urans model conducted with the medium cells are compared with that of les model it is shown that the fluctuating thrust at the first blade passing frequency calculated by les is much closer to the experimental data nevertheless the discrepancy between numerical results of les model and the experimental results still exceeds 15 this is mainly caused by two reasons on the one hand the quantities of the fluctuating forces at the first blade passing frequencies is small in magnitude which is about one thousandth of the time averaged thrust numerical noise will more or less affect the results one the other hand non uniformity of inflow in numerical calculations is weaker than that of experiments 3 4 validation in the numerical investigation the three test conditions in experiments are firstly calculated the calculated unsteady thrust is compared with the measured ones in the frequency domain as shown in fig 9 a fig 9 c on the whole the magnitude of the calculated thrust is the same as that of the measured results the trend of the calculated force is a good match with the measured force within 500hz especially around 100hz which is the first blade passing frequency there is a significant discrepancy between the calculated unsteady thrust and the measured thrust within the low frequency range 50hz where the calculated thrust is larger than the measured thrust for the tonal forces at the first passing frequency the agreement between the calculated force and measured force is excellent at the advance coefficients 0 5 and 0 7 as shown in table 4 when the advance coefficients is 0 9 the deviation from the experimental results exceeds 15 the reason is that the non uniformity and fluctuations of inflow increase with the increase of speed in addition there is no distinct spectrum line at the second and third blade passing frequencies in the numerical results the reason is that the spatial non uniformity of inflow in numerical calculations is weaker than that of experiments in general the numerical results are consistent with the measured results which indicates that the numerical method and experimental method is convincible like the measurement results the calculated unsteady thrust reflects the obvious characteristics of the propeller unsteady forces namely the superposition of broadband components and tonal components to facilitate analysis and comparison between different working conditions the broadband components and the tonal components are usually separated furthermore due to the numerical noise in the calculation results it is necessary to smooth the broadband components an adjacent averaged weighting approach yao et al 2020 is utilized according to the following equation 9 g i j 1 n w j f j i n 2 n w j 1 j i 1 n 1 2 2 where f i and g i are the i th input and output data points n is the total number of points in the window and w j is a quadratic weight factor the smoothed numerical results are compared with the measured results as shown in fig 10 for broadband spectrum the two have a consistent trend of change for the three advance coefficients thus the numerical results will smooth with the adjacent averaged weighting approach in the following discussion 3 5 influences of rudder angles on the propeller force when the ship is sailing turning the rudder will directly change the characteristics of flow field which will result in the enhancement of propeller unsteady force and induce severe vibration and noise in order to investigate influences of rudder angle another four rudder angles relative to the free stream are simulated α 7 5 15 22 5 30 indicated as cases c075 c150 c225 and c300 respectively as shown in fig 11 the right handed cartesian coordinates system utilized in the following analysis is consistent with that in fig 11 from downstream to upstream the left side is port side and the right side is starboard side as shown in fig 11 a the zero rudder angle investigated in the experiment is denoted as c000 all the simulations here deal with advance coefficients equal to 0 89 with 4 45 m s inflow velocity and 20rps rotation speed analysis of different rudder angles are divided into three parts influences on the flow field influences on the time averaged forces of propeller and influences on the unsteady forces of propeller in the following analysis the time averaged quantities are computed as follow 10 g x y z 1 m i 1 m g x y z t i where g represents the time average of quantity g and m is the number of instantaneous realizations the phase averages of quantities of the flow field are estimated with instantaneous flow fields associated to the same reference position of the propeller blade thus the expression of the phase averaged quantities is 11 g x y z 1 n i 1 n g x y z t 0 i 1 n m where g represents the phase average of quantity g n is the number of instantaneous realizations corresponding to the same reference position of the propeller blade t 0 is the instant in time when the collection is started n is the frequency of the rotation and m is the number of propeller blades 3 5 1 influences on the flow field the change of rudder angle significantly alters the wake of rudder namely the inflow of propeller which will greatly affect the force induced on the propeller the phase averaged stream wise vorticity on x y and x z plane of the rudder wake are shown in fig 12 from the perspective of x y plane the axial vorticity behind the bottom tip of rudder becomes larger with the increase of the rudder angle moreover the wake region at the bottom tip of rudder bends upwards with the increase of rudder angle the perspective of x z plane is shown in fig 12 b for c000 the vorticity separates at the trailing edge on both surface a and surface b with the increase of rudder angle the separation location on surface a moves upstream while the separation location on surface b is still at the trailing edge in addition the vorticity separating from surface a increases significantly with the increase of rudder angle more details of coherent structures are compared for different rudder angles via three y z planes as shown in fig 13 fig 13 a shows the phase averaged second invariant of velocity gradient tensor in the near wake of rudder x d 0 608 there are two symmetric structure along the positive y axis see in fig 13 b c000 which are associated to the trailing edge and bottom tip of the rudder as the increase of rudder angle the symmetry of wake disappears in addition the wake region of the rudder trailing edge gradually spread into a ring surrounding the vortex associated to the bottom tip of rudder fig 13 b reports the rudder wake of x y plane at x d 0 428 compared with the upstream plane the area of wake region associated to the trailing edge of rudder decreases when the rudder is parallel to the inflow direction c000 while the wake region associated to the bottom tip of rudder is almost unchanged moreover once the rudder angle increases c075 c150 c225 and c300 the wake region becomes larger and rotates around x axis compared to the upstream plane the evolution of wake region indicates that the influences of propeller rotation on the upstream increases with the rudder angle as shown in fig 13 c after impinging on the hub the significant vortex region accumulates on the surface of the hub and the magnitude increases with the rudder angle the radial profiles of axial velocity for different rudder angles are shown in figs 14 and 15 in order to analyze the asymmetry of rudder wake fig 14 compares the radial profile of axial velocity along y axis see in fig 14 a due to the asymmetry of rudder the axial velocity on the upper plane is smaller than the lower plane however the increase in rudder angle compensates for the asymmetry see c075 c3000 in fig 14 a and the asymmetry gradually decreases with the evolution of the flow field as shown in fig 14 b and c in order to analyze the influences of rudder angles on the flow field fig 15 compares the radial profile of axial velocity along z axis see in fig 15 a as the increase of rudder angle the velocity deficit at the center of profile moves to the starboard side in the near wake of the rudder more humps appear on the starboard side with the increase of rudder angle as shown in fig 15 b by unfolding the cylindrical surface with different radii i e 0 3r 0 6r and 0 9r around the propeller fig 16 reveals changes of the flow field with the increase of rudder angle in details for blades at 0 3r the wake is roughly uniform after different blades when the rudder is parallel with flow direction c000 once the rudder deflects wake after different blades advance with different speed see c075 in fig 16 a the vortices on the starboard side deflect to the port side see c075 in fig 17 a as the rudder angle continues to increase see c0150 c225 and c300 in fig 17 a the magnitude of vortices increases and vortices separateing from different blades on the starboard side are mixed in addition low speed regions downstream blades are mixed which completely changes the flow field near the blade facing the rudder see c0150 c225 and c300 in fig 16 a the differences of axial speed on the pressure side and suction side of this blade tend to vanish which indicates that the thrust generated on the blade decrease rapidly this is validated by the contour of pressure as shown in fig 17 b the difference of pressure between the pressure side and suction side becomes smaller however these influences on the blade generally vanish with the increase of radius see in fig 16 b and c the reason is that the velocity increase with the radius and the mixing process of wake regions moves downstream 3 5 2 influences on the time averaged forces of propeller and rudder influences of the rudder angle on the time averaged forces of propeller are discussed in this section fig 18 compares the time averaged forces of propeller for different rudder angles in general the transverse and vertical forces of propeller is an order of magnitude smaller than force in the flow direction with the increase of rudder angle amplitude of the propeller force in flow direction increases linearly the vertical force decreases first and then increase to 29n as shown in fig 18 d changes of the transverse force are more complicated the force nearly vanishes for c075 then the direction of force reverses for c150 c225 and c300 the force is maximum when the rudder angle is 22 5 c225 3 5 3 influences on the unsteady forces of propeller and rudder in this section the unsteady forces are analyzed for different rudder angles as indicated in the experimental results the unsteady forces in frequency domain are the superposition of broadband components and tonal components so the broadband components and tonal components of unsteady forces are analyzed separately for the convenience of comparison the tonal forces of the propeller at the first blade passing frequency for different rudder angles are compared in fig 19 although the time averaged forces in vertical direction and transverse direction are negligible compared with time averaged thrust the fluctuating forces in these two directions at the first blade passing frequency are comparable with the fluctuating thrust as shown in fig 19 a furthermore the fluctuating transverse forces exceed the thrust for large rudder angles see c225 and c300 it can be explained by the phase averaged pressure around the blade as shown in fig 17 b when the rudder angle is large for c225 and c300 the differences of pressure between the pressure side and suction side of the blade facing the rudder tend to vanish which leads to the decrease of thrust generated on the blade thus the transverse asymmetry increases and the transverse force increases the variation trend for tonal forces at different directions are shown in detail in fig 19 b d for the propeller thrust see in fig 19 b the force has two surges with the increase of rudder angle i e from c075 to c150 and from c225 to c300 where the tonal force increases more than twofold for the vertical force and transverse force see in fig 19 c fig 19 d the forces increase almost exponentially with the rudder angle the broadband force spectra of the propeller for different rudder angles are compared in fig 20 in general the broadband thrust spectrum is an order magnitude higher than the vertical and transverse broadband force spectrum which is different from the tonal forces the force spectrum decays logarithmically with increasing frequency as the increase of rudder angle the force spectrum increases sharply within 200hz compared with c000 the force spectrum even increases by more than two orders of magnitude at 0hz for c300 since the longitudinal vibration mode and bending modes of the propeller shaft are usually very low within 200hz in ocean industry the steering of ship increase of rudder angle could excite these modes and cause severe vibration when the frequency exceeds 200hz the increase of force spectrum is not obvious with the rudder angle in addition the decay of broadband force spectrum is relatively smooth when the rudder is parallel with the flow direction c000 when the rudder is oblique to the flow direction c075 c150 c225 and c300 humps appear at the blade passing frequencies in order to explain the variation characteristics of broadband force spectrum with rudder angle the velocity spectrum at eight points in the flow field are investigated as shown in fig 21 four points on the x y plane are investigated which are located at 0 3r and 0 9r and distributed along y axis the x y plane is divided into upper and lower planes along x axis at the location of 0 3r see fig 21 b velocity at the upper plane and lower plane is asymmetric this asymmetry of velocity spectrum increases rapidly for c300 especially in the low frequency range at the location of 0 9r see fig 21 c the velocity spectrum on the upper plane is larger than that on the lower plane within 100hz it indicates that energy of eddies on the upper plane is larger than that on the lower plane especially for eddies with large scale in the low frequency range as shown in fig 22 four points on the x z plane are investigated which are located at 0 3r and 0 9r and distributed along z axis the x z plane is divided into left and right planes along x axis the velocity spectrum on the right plane has little change when the rudder angle increases from 0 to 22 5 when the rudder angle increases to 30 the velocity spectrum decreases rapidly on the right plane on the left plane the velocity spectrum increases with the rudder angle within 100hz to summarize the energy of large scaled eddies increases with the rudder angle it explains the significant increase of broadband force spectrum in the low frequency range in addition the spatial distribution of eddies becomes asymmetric with the increase of rudder angle the energy of eddies is more concentrated on the upper x y plane and left x z plane it explains the increase of vertical and transverse broadband force spectrum as shown in fig 20 4 conclusions the unsteady thrust of a propeller in presence of an asymmetric upstream rudder is experimentally and numerically studied first the unsteady force of the propeller is measured with a high resolution dynamometer second by means of detailed propeller rudder model and fine meshes the large eddy simulation is applied to calculate the flow field distribution and unsteady thrust of the propeller after verifying the accuracy of the numerical method the influences of rudder angle on the flow field and unsteady forces of propeller are numerically studied results are summarized as follow i the spatial non uniformity and temporal unsteadiness of the flow field induced by the upstream rudder leads to the changes in tonal components and broadband components of the propeller thrust which is reflected in both experimental and numerical studies the good agreements with experimental results demonstrate that the numerical model based on the large eddy simulation can accurately capture the variation trend of tonal components and broadband components in low frequency range ii the analysis of the phase averaged quantities of inflow field indicates that both the intensity of the vortex and the asymmetry of the flow field increases with the rudder angle the former leads to the increase of tonal forces in three directions and the latter causes the transverse force to increase the most when the rudder angle increases from 0 to 30 the tonal thrust increases from 0 16n to 1 04n while the transverse force increases from 0 1n to 1 07n iii the analysis of statistical characteristics of inflow field indicates that with the increase of rudder angle the energy distribution of eddies in the wake is changed in two aspects on the one hand the energy of large scale eddies increases with the rudder angle it explains the significant increase of broadband force spectrum in the low frequency range on the other hand the spatial distribution of eddies becomes more asymmetric with the increase of rudder angle the energy of eddies are more concentrated on the upper x y plane and left x z plane it explains the increase of vertical and transverse broadband force spectrum credit authorship contribution statement x d tong conceptualization methodology software investigation resources data curation writing original draft visualization h y chen software investigation visualization x q dong investigation visualization software y chen writing review editing formal analysis validation supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the work was supported by national nature science foundation of china grant no 52071214 the work is also supported by the deep blue program of shanghai jiao tong university 
20342,this study presents an artificial intelligence ai model to forecast time series wind waves in the us atlantic coast the fundamental technique in the proposed model is the long short term memory model which is able to learn patterns from data sequence the model is trained using historical wind data wave data temperature data and atmospheric pressure data then the model is used to forecast significant wave height average wave period and mean wave direction a 2 year meteorological data measured at four noaa buoy stations in the us atlantic coast are used to train and evaluate the model s forecast skills the results show the artificial neural network model converges fast and does not have over fitting nor under fitting issues furthermore a short term forecast e g 1 to 6 h achieves higher accuracy than a long term forecast e g 24 to 48 h this study shows that sufficient forecast accuracy can be obtained by using the input hours equal to the forecast lead time comparison using rose plots confirms that the artificial neural network model reproduces wave height and wave period statistics very well the artificial neural network model is used to forecast storm waves induced by hurricanes isaias and eta in the us south atlantic region and two winter storms in the us north atlantic region the model forecast is compared with noaa measurement the results show that the artificial neural network model is able to accurately forecast both significant wave height and average wave period associated with storm events when the forecast lead time is relatively short e g 1 to 6 h the proposed artificial neural network model can serve as an alternative tool to traditional coastal models for wave prediction and storm forecast keywords significant wave height averaged wave period mean wave direction wind waves storm forecast artificial intelligence long short term memory model 1 introduction this study focuses on wind wave climates in the us atlantic coast which experiences seasonal tropical cyclones for example the 2020 atlantic hurricane season had 30 named storms and 14 of them were hurricanes climate change and sea level rise would exacerbate storm hazards e g yin et al 2020 wind waves contribute to nearshore wave setup which can be significant when comparing with storm surge since wind waves are much stronger during storms the study of storm waves will significantly improve our capability to understand other coastal processes under storms e g coastal morphology beach erosion and rip currents thus an accurate forecast of wind waves is essential for storm forecasting and risk management in the coastal zones wind wave study has been carried out for decades the early works developed wave spectral models that characterize wave height and wave period e g jonswap spectrum hasselmann et al 1973 pierson moskowitz spectrum pierson jr and moskowitz 1964 and tma spectrum bouws et al 1985 early methods for wave forecast were simple empirical equations that related wave height and wave period to representative wind speed fetch length and wind blow duration e g young 1988 hubertz et al 1994 with the development of numerical method and computer hardware those empirical formulations have been implemented in coastal models to estimate wind waves in oceanic and coastal settings e g swan e g holthuijsen 2010 and stwave smith et al 2001 furthermore shallow water equations based coastal model e g adcirc of luettich et al 1992 was integrated with the spectral wave model swan to simulate storm surge and hurricane generated waves e g dietrich et al 2012 what is more phase resolving coastal models e g zijlema et al 2011 shi et al 2012 wei and jia 2014 can be used to simulate time varying wave processes in the nearshore zone however the major limitation to apply those coastal models for wind wave modeling and forecast is that coastal models usually require expensive high performance computing facility which is not affordable for a wide research community with the advent of artificial intelligence in the past decade machine learning models have been applied to study coastal processes and a few recent studies related to wave prediction were reviewed in this section kagemoto 2020 applied a recurrent neural network rnn model the long short term memory lstm model hochreiter and schmidhuber 1997 to forecast both actual wave trains and numerically reproduced irregular wave trains and the author found that the lstm model generates reasonably accurate forecasts fan et al 2020 also applied the lstm model to predict significant wave heights at several buoy stations globally and their lstm model was able to provide more accurate significant wave height forecast when comparing with several other machine learning models pirhooshyaran and snyder 2020 applied rnns including a simple lstm and an encoder and decoder lstm to predict a single variable i e significant wave height and two variables i e significant wave height and energy flux ni and ma 2020 presented an integrated approach using lstm and principal component analysis pca to predict significant wave height their pca method was used to extract principal components from a set of input signals while lstm was adopted to avoid long term independence during the forecasting kim et al 2020a developed a convolutional lstm and a denoising autoencoder to predict ocean weather including wind wave parameters the aforementioned studies showed that the lstm model is the go to method for wave prediction which will be investigated in this work as well on the other hand the above literature reviews identified several research gaps first a univariate prediction related to wave height was studied intensively e g kagemoto 2020 fan et al 2020 pirhooshyaran and snyder 2020 among others while other wave parameters such as wave period and wave direction were rarely addressed but both parameters are important to characterize wind wave conditions for storm forecast and marine operation second to the author s knowledge forecasting of wind waves due to hurricanes or typhoons using machine learning models has not been well studied for example dixit and londhe 2016 applied neuro wavelet technique to predict significant wave heights of several atlantic hurricanes however their study did not predict wave period nor wave direction this study aims to address these research needs and make several novel contributions to the wind wave forecast research field specifically this study will explore the possibility of using a wide range of meteorological parameters to develop a multivariate wind wave forecast model the developed wind wave forecast model is able to predict full wind wave parameters including significant wave height average wave period and mean wave direction furthermore the study will investigate the efficiency of the artificial neural network model to forecast storm waves this paper is organized as follows section 2 introduces noaa buoy stations and their meteorological data selects the input features for artificial neural network model training and presents model forecast scenarios section 3 explains the background of artificial neural network model presents the model architecture and provides the details on data preparation section 4 presents a series of results related to model training metrics forecast skills comparison with noaa measurement section 5 discusses the possibilities and the challenges in applying the proposed artificial neural network model to forecast storm waves finally the conclusion is drawn in section 6 2 wind wave data 2 1 introduction to noaa buoy stations the wind wave data used in this study were collected by noaa national data buoy center ndbc https www ndbc noaa gov the location of four ndbc stations can be found in the map of fig 1 their station ids station names and latitudes and longitudes are listed in table 1 those four stations were selected for two major reasons the first one was that they had relatively more complete wind wave data than other stations for the study period of this project i e the full two years of 2019 and 2020 the second reason was that all four stations are in the us atlantic coast which experiences seasonal storm events specifically station 41009 is in the east coast of florida station 41008 in the east coast of georgia station 41003 is in the east coast of south north carolina and station 44013 is in the massachusetts bay the three stations in the south atlantic coast are within the impact region of atlantic hurricanes from june through november station 44013 is within the impact region of winter storms or nor easters in the winter months 2 2 wind wave data overview the time period of wind wave data used in this study was from january 1 2019 to december 31 2020 the total number of records at each station is more than 17500 with the data interval of one hour there were some data gaps in the records from several hours up to a few days the missing data for those periods were filled with previous available noaa measurement at the same station this section presents the statistical distribution of the wind speed and the significant wave height in the form of rose plots fig 2 shows the rose plots of wind speed for the four stations over the 2 year period the recorded wind direction was used to draw the rose plots the wind speeds were categorized into four bins 0 5 m s 5 10 m s 10 15 m s and above 15 m s it is seen that at station 41008 the wind blew from the northeast or southwest directions which are parallel to the coastal lines near this buoy station the maximum percentage is about 12 for the northeast winds and about 10 for the south and southwest winds winds in the range of 10 15 m s were from the northeast direction and most of the wind speeds were in the range of 5 10 m s the winds at station 41009 mainly blew from northeast to south directions and the maximum percentage is about 8 9 from the east the majority of the winds were in the range of 5 10 m s at station 41009 the winds blew mainly from northeast and southeast directions at station 41013 and the wind direction was also parallel to the coastal lines near this station the maximum percentage of wind records was about 12 from the southwest direction the majority of the winds were in the range of 5 10 m s on the other hand the strongest winds blew from north northeast direction at station 44013 the winds blew from northwest and southeast directions which were in the land sides of the station in particular the strongest winds were from the west and northwest directions the majority of winds were within the range of 5 10 m s overall the wind speeds at these four stations were relatively different posing a challenge to the machine learning model to resolve diverse wind patterns fig 3 shows the rose plots of significant wave heights for the four stations over the 2 year period the recorded mean wave direction was used to draw the rose plots the significant wave heights were categorized into five bins 0 0 5 m 0 5 1 0 m 1 0 1 5 m 1 5 2 0 m and above 2 0 m it is seen that at station 41008 the waves propagated from the east and southwest directions the maximum percentage was about 27 for the east southeast direction and about 20 for the east side the majority of wave heights were in the range of 0 5 1 0 m and its percentage was about 40 among the 2 year records the waves at station 41009 mainly propagated from east to northeast directions and the maximum percentages were 29 from the east and 26 from the east northeast direction comparing to station 41008 the wave heights at station 41009 were larger since more than 10 of the waves were above 2 0 m the wave height distribution was more diverse at station 41013 than the two stations described above waves propagated mainly from the south to the east at station 41013 the maximum percentage of wave records was about 18 from the east southwest direction the percentage of wave height magnitudes was more evenly distributed among four wave height bins at station 44013 the waves propagated from southeast to northeast directions the largest percentage of waves was about 26 from the east and about 17 of the waves were from the east northeast direction the majority of wave heights were within the range of 0 5 1 0 m similar to the wind speeds plots in fig 2 the distributions of significant wave heights at these four stations were relatively different 2 3 wind wave data correlation this study utilized the measured meteorological data to forecast wave climate parameters at noaa stations table 2 shows those parameters and their corresponding definitions the 12 variables are broadly related to i the winds i e gst wdir wspd ii the waves i e apd dpd mwd wvht iii the temperatures i e atmp dewp wtmp iv the tides tide and v the atmospheric pressure pres the wave related parameters are the target variables in this study i e the parameters will be forecast by the artificial neural network model it should be noted that the noaa buoy station does not record the tide data and the tide data used in this analysis were from the nearest tide stations from noaa tides and currents https tidesandcurrents noaa gov the selection of input parameters for machine learning forecast models was guided by the analysis of statistical correlation among different physical parameters e g fan et al 2020 kim et al 2020b to better understand the correlation among these wind wave parameters a correlation analysis was carried out by using the pearson standard correlation coefficient r as defined below 1 r i 1 n x i x y i y i 1 n x i x 2 y i y 2 where n is the sample size x i and y i are individual samples with index i x 1 n i 1 n x i and y 1 n i 1 n y i it should be noted that the pearson correlation coefficient is a measure of the linear correlation of variables and it ignores many other types of relationship a value of r 1 indicates the perfect positive relationship between two variables e g x increases as y increases a value of r 1 indicates that a perfect negative relationship between two variables e g x increases as y decreases a value of r 0 indicates the absence of a linear relationship between two variables fig 4 shows the pearson correlation coefficient r matrix among all wind wave parameters the 2 year noaa measured data for all four stations were used to calculate the correlation coefficient there are several important observations the first one is the tides or water levels i e tide have a very week correlation with other wind wave parameters since the correlation coefficients of tides to others are close to 0 thus the tides were not considered as an input parameter in the artificial neural network model second the two wind parameters gst i e the peak gust speed and wspd i e the short term average wind speed have a correlation coefficient of 0 99 indicating a strong linear relationship since average wind speed is more commonly used for coastal modeling the wspd rather than gst was used for artificial neural network model development third the two wave period parameters dpd i e dominant wave period and apd i e average wave period have a correlation with r 0 6 considering the fact that the domain wave period is relatively noisy the average wave period was used in short three variables the tides tide gust speed gst and dominant wave period dpd were not used in this study and the target wind wave parameters are significant wave height wvht average wave period apd and mean wave direction mwd as indicated in table 2 in other words nine out of twelve wind wave parameters were selected as input features to predict three target wave climate parameters it is worth pointing out that different from the study by fan et al 2020 where only positively correlated variables were used for machine learning this study considered variables that are either negatively or positively correlated to the target parameters since both types of correlation are useful for machine learning furthermore the study of fan et al 2020 only used wind direction wind speed and wave height one hour ago as the input feature this study considered a broader range of input features related to winds waves temperatures and atmospheric pressure it is expected that the model trained using a broader dataset will generalize better than the model trained with limited data types fig 5 shows an example of time series profiles of the wind wave data that were used to develop the artificial neural network model the time series data were from noaa station 41008 and the period of the data was from january 1 2019 to march 1 2019 the profiles for the selected nine variables were presented the complexity of the time series sample is clearly observed from this figure for example we can see sudden changes of mean wave direction mwd and wind direction wdir from 0 to 360 or from 360 to 0 although both 0 and 360 represent the north direction and they are very close in reality their values however are the two limits ends of the direction related data furthermore we also deal with data with different frequencies almost all time series profiles show the rise and fall patterns however the frequency or the recurrence of those patterns are very different from each other what is more the magnitudes of those nine variables are very different they range from e g 3 i e the magnitude of significant wave heights to 1030 i e the magnitude of atmospheric pressures overall the wind wave data used in this study were very complicated and thus posed a challenge to artificial neural network models specifically can an artificial neural network model learn the complex patterns hidden in these data what are the levels of accuracy and efficiency if it can learn from the data these are the key questions this study would like to answer in the following sections 2 4 wind waves forecast scenarios the ultimate goal of this study is to develop an artificial neural network model that will be able to forecast wind wave conditions in coastal areas that are vulnerable to storms or tropical cyclones forecast lead time is critical to achieve this goal as previously explored by several studies e g kim et al 2016 hien et al 2020 kim et al 2021 the prediction forecast lead time in this study was motivated by noaa s guidelines practices on issuing tropical cyclone advisory https www nhc noaa gov aboutnhcprod shtml specifically noaa tropical cyclone public advisories are normally issued every 6 h however intermediate public advisories are issued every 3 h when coastal watches or warnings are in effect furthermore special public advisories may be issued at any time due to significant changes in warnings or in the cyclone noaa issues tropical cyclone forecast advisory that includes the location intensity and system motion of the cyclones the issue intervals are 12 24 36 48 60 and 72 h from the current synoptic time in general weather forecast becomes more challenging and less accurate for a longer forecast lead time by considering noaa s practice as reviewed above and the difficulty of the long term forecast this study proposed to forecast wind waves conditions for these six intervals 1 h 3 h 6 h 12 h 24 h and 48 h the 1 hour forecast was used to consider special public advisories that are issued at any time due to the significance of the storms or cyclones 36 h and 72 h forecasts were doable by the artificial neural network model however they were not included due to the level of accuracy becomes lower when the forecast lead time becomes longer the wind wave condition forecast requires the past conditions however there was no previous study that clearly determined the proper length of past data this study proposed to examine the length i e the number of hours of the input past data by experimenting with four ratios i e 1 1 3 1 5 1 and 7 1 of the forecast hours as shown in table 3 for example a 3 hour forecast was tested with input data in the past of 3 9 15 and 21 h as a result there are 24 runs for each of the four noaa stations and the total number of runs is 96 for all stations 3 an artificial neural network model for wind waves forecast this section presents an artificial neural network model for wind waves forecast for the four noaa stations introduced in the previous section we first briefly review the background of the long short term memory model which was the fundamental artificial neural network model used in this study next we describe the proposed artificial neural network architecture in detail finally we explain how to prepare transform the noaa wind wave data into a format that will be input into the model 3 1 artificial neural network model background the artificial neural network was inspired by the biological neural network which helps animal brains to perform complex computations and learning e g mcculloch and pitts 1943 artificial intelligence machine learning and deep learning have gained significant advancement in the past decade thanks to new and fast hardware a large number of datasets and neural network algorithm improvement chollet 2018 a complete review of the latest artificial intelligence technology is beyond the scope of this study and the artificial intelligence models related to time series forecast are briefly reviewed in this section time series forecast is a challenging task because the algorithm has to take into account the temporal dependence and the order of data a recurrent neural network rnn addresses this issue by maintaining a state i e so called memory containing the information relative to what it has learned so far one of the well known rnns is the long short term memory lstm model developed by hochreiter and schmidhuber 1997 the lstm model has been gradually improved over years by several studies e g graves 2013 sak et al 2014 zaremba et al 2014 the basic idea of the lstm model is to recognize important features from the input data store them in the long term state preserve them for as long as needed and use them for prediction whenever it is needed géron 2019 the lstm model is a key neural network model that made this study successful to predict time series wind wave profiles by training it using historical meteorological data an important improvement of the lstm model was the convolutional lstm by shi et al 2015 the convolutional lstm is able to preserve the spatial information which is lost in the fully connected lstm model this was achieved by applying many moving filters to capture temporal and spatial patterns the network diagram and the mathematical equations of the lstm model are presented in appendix 3 2 the model architecture the proposed artificial neural network model was developed based on the python package keras https keras io which is an open source software library that provides a python interface for artificial neural networks chollet 2018 keras provides high level deep learning application programming interface that allow users without a significant machine learning background knowledge to easily build train and evaluate different types of artificial intelligence neural networks keras itself does not perform any heavy computation and it relies on the so called computation backend e g tensorflow géron 2019 the software version of keras 2 4 3 was used in this study the keras tuner https keras io keras tuner of o malley et al 2019 was used to select optimized hyperparameters e g the number of neural network units per layer with the objective to minimize the validation loss fig 6 shows the proposed artificial neural network model for the wind wave forecast it should be pointed out that each of the runs in this study has the same neural networks configuration as seen in fig 6 but different input shapes as defined in table 3 this example model architecture is for r06 that forecasts 3 hour wind wave conditions with 9 hour input data in the past the shape information i e the input size and the output size of each layer was also displayed in fig 6 a neural network model is usually made up of three types of layers input layer one or more hidden layer s and output layer e g brownlee 2018 each of the layers carries out several mathematical operations on its input data and then produces results as the input for the next layer or as the model output a brief description of the wind wave artificial neural network model of fig 6 is provided below the input layer instantiates a 5d tensor that has the shape size of the input training data the first dimension of none 1 1 9 9 is the batch size of the training sample since it is determined at the run time and not pre defined a none is used to indicate that the size will be determined at the run time the second dimension is one which is the number of steps in the training data table 3 shows that we only consider one step of input that has e g 9 h data the third and fourth dimensions are the size of input data the number of rows and the number of columns since one dimensional 1d temporal data were used in this work the number of rows is assumed to be one and the number of columns is the input duration i e 9 h for this specific case finally the fifth dimension is the number of input features the number of features is 9 in this study because 9 out of 12 variables were selected to predict wind wave conditions as listed in table 2 the first hidden layer in our artificial neural network model is a convlstm2d layer or convolutional lstm the convolution operation applies filters to extract features from the input data this study applied 50 filters with the size of 1 3 for r02 r24 as indicated in table 3 the activation function is the rectified linear unit function relu the kernel is initialized using the he initialization of he et al 2015 and the l2 kernel regularization with a value of 0 01 is also applied in this layer the second hidden layer is a flatten layer which transforms a multiple dimensional matrix of features into 1d data the third hidden layer is a repeatvector operation which repeats the input from the previous layer by a factor there are three target wind wave parameters i e wvht apd and mwd and 3 was the number of repeats in our artificial neural network model the four hidden layer is an lstm layer this study specified 50 units in the lstm layer as a result the output dimension has the shape of none 3 50 both none and 3 have the same meaning explained in previous layers the fifth hidden layer is a fully connected dense layer and it has 30 units as indicated in the output shape it is important to note that the so called timedistributed operation was applied to preserve the order of data sequence which is essential for time series forecasting finally the output layer is a fully connected dense layer with its size equal to 3 which matches the number of target wind wave parameters the other 3 indicates the output size i e 3 h forecast 3 3 data preparation and computing environment traditional coastal modeling and forecast take time series data as the boundary conditions e g waves and tides and spatial forcing e g winds and atmospheric pressure however this approach does not work with machine learning model and the time series noaa measurement presented in section 2 must be pre processed before it can be used to train and test our artificial neural network model this section explains the data transformation and preparation steps in details in hope to provide a reference for future research using a similar machine learning approach the first data preparation step is to address the issue that the input data have different magnitudes or scales e g the magnitude of wave height is a few meters but the pressure is more than a thousand hpa machine learning models do not perform well when the input numerical data or features have very different scales this issue was addressed by standardization which is expressed as 2 z x u s where x is the sample u is the mean of the sample s is the standard deviation and z is the standardized sample in short the standardization first subtracts the mean value and then it divides by the standard deviation so that the resulting distribution has unit variance géron 2019 the standardscaler transformer of scikit learn pedregosa et al 2011 was used to achieve the above goal it is important to point out that each of the nine features were independently standardized by computing its relevant statistics furthermore the standardization process does not change the statistical distribution of the input variable but rather it is a simple data pre processing technique the standardization technique was applied to the measurement at the selected four noaa stations as mentioned in section 2 the standardized data for each station were then split into training and test samples as listed in table 4 the training sample was used to train the model and then the test sample which was not seen by the artificial neural network model during the training stage was used to examine the capability of trained model for wind wave forecast the full training sample was divided into sub samples and each sub sample includes both input sequence and target sequence according to their run scenarios as defined in table 3 fig 7 shows the data preparation for the training sample for r06 which uses 9 h input data to predict future 3 h wind wave conditions it is seen that the time shift between sub sample 1 and sub sample 2 is one hour resulting in 11997 sub samples with the last three samples are the target sequence of sub sample 11997 the order of those sub samples was randomized and 15 of them was used as the validation sample for model training fig 8 shows the data preparation for test sample the full test sample was also divided into sub samples different from the training sample preparation the test sub samples have a time shift equal to the forecast duration e g 3 h for r06 the motivation was that the forecast results would not have any overlaps so that they could be easily merged to get the full forecast sequence that will be compared with noaa measurement in short the number of test sub samples is approximately equal to the length of the test sample divided by the length of forecast sequence as a result the number of test sub samples for a long term forecast e g 48 h will be much smaller than that for a short term forecast e g 1 h thus the model forecast time varies as to be shown in section 4 after all necessary data preparation 24 run scenarios listed in table 3 were carried out for each of four noaa stations resulting in 96 runs using the proposed artificial neural network model for wind waves forecast the computing system was configured as below the cpu model name is intel r xeon r cpu 2 00 ghz the clock speed of the cpu is 2k mhz and the cpu cache size is 39424 kb two cpus were used for the artificial neural network model training and forecast 4 results this section presents the results of the artificial neural network model for wind wave forecast the artificial neural network model training convergence is demonstrated by the training metrics then we show the training efficiency in terms of computing time next we evaluate the model capability for wind wave forecast using a commonly used forecast skill parameter we further show the statistical agreement between the model forecast with the noaa measurement by using rose plots finally we compare the time series wind wave results for different forecast hours and identify model configurations that are both efficient and accurate it should be noted that most of the results in this section were related to noaa station 41008 there were two reasons for this choice first the same type of results at other stations is very similar to these presented for station 41008 second in the author s opinion it is better to show results for a consistent noaa station if possible rather than changing the station locations from section to section 4 1 the model training metrics the artificial neural network model was trained with 200 epochs to make sure that the model training converged the artificial neural network model iterates over the full training and validation sample during one epoch the batch size is 16 for all 96 runs the batch size is the number of training sub examples utilized in one iteration epoch the artificial neural network model training process was monitored by two metrics root mean squared error rmse and the coefficient of determination or r squared r 2 the definition of rmse is given as below 3 r m s e 1 n i 1 n y i f i 2 where y is the noaa measurement f is the prediction or forecast value i is the index and n is the number of samples the coefficient of determination r 2 is defined as 4 r 2 1 s s r e s s s t o t where the sum of squares of residuals s s r e s is defined as 5 s s r e s i 1 n y i f i 2 and the total sum of squares s s t o t is defined as 6 s s t o t i 1 n y i y 2 with y 1 n i 1 n y i the above metrics were applied to both training and validation samples and fig 9 shows the comparison of training and validation metrics with respect to the number of epochs the results show that the rmse reduces as the number of epochs iterations increases and it reaches a stable value of 0 3 similarly the r 2 gradually increases as the number of epochs increases and it reaches a stable value of 0 85 more than that the trends for both training and validation curves are very close indicating that the model gives similar performance for training and validation samples and it does not have under fitting nor over fitting issues it should be pointed out that both training and validation samples are standardized using eq 2 and their mean values were removed in the training and validation samples as a result the rmse value in fig 9 does not reflect the real magnitude of the error between model forecast and noaa measurement the model training time is proportional to the number of epochs and it seems like a waste of time to use 200 epochs since the model already converged around dozens of epochs test runs showed that a longer forecast scenario e g 48 h forecast needs a larger number of epochs however all model tests have converged before 200 epochs another reason to use a larger number of iterations e g 200 is that the computing cost for training the proposed artificial neural network model was not expensive as shown in fig 10 the picture shows the training time and forecast time for all 24 run scenarios for noaa buoy station 41008 there are six forecast sequences i e 1 h 3 h 6 h 12 h 24 h and 48 h and each of them was tested with four different input lengths as a ratio of the input hours to the forecast hours i e 1 1 3 1 5 1 and 7 1 as listed in table 3 there are several important observations first the training time increases as the forecast length increases from 1 h to 48 h second for each of the six forecast scenarios the smaller the input to forecast ratio the shorter the training time third the forecast time reduces as the forecast length increases this is because the number of prediction test sub samples is the total number of test samples divided by the forecast length if the forecast length is larger and the number of forecast or test sub samples is smaller subsequently the time to run forecasts will be much shorter it is important to point out that the 300 s forecast time was the total computing time for the 6 5 month forecast from may 15 2020 to december 31 2020 in other words it only takes about 1 2 s to predict wave conditions for 1 2 days in the future the readers are also reminded that the major training time of 10 50 min was for 200 epochs or iterations and the model was run on 2 cpus indicating that the training time per epoch is only a few seconds the computation cost of artificial neural network model is comparable or even cheaper than that required by traditional coastal modeling systems 4 2 the artificial neural network model forecast skill the artificial neural network model forecast skill was evaluated by the root mean squared error rmse as defined in eq 3 fig 11 shows the comparison of rmse for the 24 run scenarios for noaa buoy station 41008 a separate rmse distribution was presented for each of the three wind wave parameters significant wave height wvht average wave period apd and mean wave direction mwd it should be clarified that the rmse was obtained by using the forecast wind wave data with noaa measurement from may 15 2020 to december 31 2020 different from the rmse value obtained from the standardized data shown in fig 9 each of the three wind wave parameters presented in fig 11 has its real magnitude for example the magnitude of the mean wave direction is 360 it is seen that the rmse increases as the length of the forecast sequences increase from 1 h to 48 h specifically the rmses of significant wave height comparison are 0 08 m 0 11 m 0 18 m 0 28 m 0 37 m and 0 43 m for 1 hour 3 hour 6 hour 12 hour 24 hour and 48 hour forecasts respectively the rmses of average wave period comparison are 0 22 s 0 40 s 0 53 s 0 71 s 0 86 s and 1 0 s for 1 hour 3 hour 6 hour 12 hour 24 hour and 48 hour forecasts respectively the rmses of mean wave direction comparison are 35 40 46 50 56 and 60 for 1 hour 3 hour 6 hour 12 hour 24 hour and 48 hour forecasts respectively it is seen that the accuracy redues when the length of the prediction sequences is getting longer there are several reasons for this phenomenon first our personal experience indicates that it is easier to predict the wave in the future one hour than that in one or two days second neural network models using simple logistic function or hyperbolic function see fig a 1 may not resolve highly nonlinear wave process when the forecast lead time becomes longer nevertheless considering the fact that the magnitudes for the three wave parameters are approximately 3 0 m 12 s and 360 the forecast accuracy of the artificial neural network model is satisfactory furthermore four ratios of input hours to forecast hours i e 1 1 3 1 5 1 and 7 1 were used to predict the same duration in the future it is seen that the smaller the ratio the smaller the rmse for all three wind wave parameters the ratio of 1 1 seems the best option in terms of forecast accuracy and model training time this is an important finding that can be adopted by future research on time series forecast in view of the relatively short model training time and the fast forecast speed as shown in fig 10 the artificial neural network model has a great potential to forecast weather and storms for emergency management and marine operation 4 3 comparison of statistical wind wave parameters this section compares the artificial neural network model forecast with the noaa measurement using rose plots the analysis was based on the 6 5 month forecast from may 15 2020 to december 31 2020 for both model forecast and noaa measurement both significant wave height and average wave period were analyzed the forecast mean wave direction was used to draw rose plots for forecast and the measured wave direction was used to draw rose plots for noaa measurement fig 12 shows the comparison of significant wave height rose plots at noaa stations 41008 and 41009 five wave height bins 0 0 5 m 0 5 1 0 m 1 0 1 5 m 1 5 2 0 m and 2 0 m above were used it is seen that at station 41008 the majority of the waves propagated from the east southeast direction which was clearly observed from both noaa measurements and the forecast by the artificial neural network model moreover the percentage distribution of wave height bins is also very similar between measurement and forecast the waves were mainly from east and northeast directions at station 41009 the forecast slightly over predicts waves from the east side when comparing with the measurement and it under predicts the waves from the east southeast direction overall the comparison of significant wave heights at stations 41008 and 41009 shows that the artificial neural network model is able to capture the main wave directions and the wave height distribution fig 13 shows the comparison of average wave period rose plots at noaa stations 41013 and 44013 five wave period bins 0 2 s 2 4 s 4 6 s 6 8 s and 8 s above were used it is seen that at station 41013 the majority of the waves propagated from the east southeast and southeast directions furthermore most of the waves have a wave period between 4 6 s both phenomena were clearly forecast by the artificial neural network model similar to station 41009 the waves were mainly from east and northeast directions at station 44013 the forecast also slightly over predicts waves from the east side when comparing with the measurement and it under predicts the waves from the east northeast direction in short the rose plot comparisons in figs 12 and 13 show that the artificial neural network model is able to reproduce the wave statistics for both wave heights and wave periods at the four noaa stations well 4 4 comparison of time series wind wave forecast this section further compares the time series wind wave forecast with noaa measurement fig 14 presents the comparison of significant wave height average wave period and mean wave direction at station 41008 for the month of september 2020 we present three different forecast lengths 3 h 12 h and 48 h since each of them was tested with four ratios of input hours to forecast hours results based on the ratio of 1 1 were presented in fig 14 their corresponding run indices are r05 r13 and r21 as listed in table 3 the rmses of the three runs can be found in fig 11 in general the comparison in fig 14 shows that a shorter forecast length gives more accurate predictions specifically a 3 hour forecast captures almost the full trend of all three wind wave parameters in this whole month a 48 hour forecast has the largest discrepancy and the accuracy of a 12 hour forecast is better than a 48 hour forecast but less than the 3 hour forecast overall the level of agreement observed in fig 14 is consistent with the forecast skills as shown earlier in fig 11 5 applications and discussion an ai based approach for storm forecast the 2020 atlantic hurricane season was the most active and the fifth costliest atlantic hurricane season on record there were 30 named storms that occurred in 2020 and several of them had impacted the region studied in this work and their storm wave conditions were recorded by noaa buoys this section investigates the artificial neural network model s capability to predict wind waves for four selected storm events 5 1 hurricane isaias july 28 2020 august 5 2020 hurricane isaias was a category 1 hurricane in 2020 that caused extensive damages across the caribbean and the us east coast this storm was recorded by noaa buoy stations 41008 41009 and 41013 that were considered in this work isaias made landfall near ocean isle beach north carolina on august 4 with maximum 1 minute sustained winds of 90 mph 150 km h and a minimum central pressure of 986 millibars the noaa station 41013 frying pan shoals nc is on the east side where isaias made landfall the comparison of time series significant wave height and average wave period associated with isaias is shown in fig 15 four forecast sequences of 1 h 3 h 6 h and 12 h with the 1 1 ratio of input hours to forecast hours were tested and their corresponding run indices are r01 r05 r09 and r13 as listed in table 3 the noaa measurement showed that the peak significant wave height was about 7 m and the peak average wave period was about 8 7 s the comparison shows that the artificial neural network model using 1 hour and 3 hour forecasts was able to capture the approximate time when the storm occurred and the forecast peak significant wave height and average wave period were very close to the actual measurement as we increase the model forecast hours from 3 h to 6 h and 12 h the forecast skills for the non storm profiles are still acceptable however they did not capture the peak values as well as the 3 hour forecast one obvious reason for the difference is that the impact duration of isaias on this buoy station is less than 12 h and a 12 hour forecast lead time was longer than the actual event due to the limited 2 year data the model was not exposed to enough historical data to capture such a rare and fast storm as a result there are an under prediction and a phase delay in the time series comparison the agreement between noaa measurement and the model forecast is further compared using a scatter plot in fig 16 the scatter points are hourly data shown in fig 15 the perfect forecast will be along the straight line over prediction appears above the line while under predictions appear below the straight line since four forecast scenarios have the same number of scatter points if the discrepancy is larger if they are further away from the straight line the forecast skills are also evaluated using the rmse and r 2 for the four forecast lead time the comparison for the significant wave height in fig 16 a confirms that a short term e g 1 hour forecast agrees better with the measurement than that with a long term e g 12 hour forecast since its scatter points cluster around the straight line this is further confirmed by a smaller rmse 0 17 m vs 0 42 m and a larger r 2 0 96 vs 0 74 a similar observation can be found in fig 16 b for the average wave period comparison the rmse decreases as the forecast lead time increases while the r 2 decreases as the forecast lead time increases 5 2 hurricane eta october 31 november 13 2020 hurricane eta was a category 4 hurricane in 2020 that caused significant damage across parts of central america eta originated from a tropical wave in the eastern caribbean sea on october 31 and it became a category 4 hurricane on november 3 it made landfall in the florida keys on november 9 although noaa station 41009 is on the east coast of florida it recorded the impact of eta from approximately november 6 to november 13 fig 17 shows the time series comparison of significant wave height and average wave period associated with eta recorded by noaa station 41009 canaveral 20 nm east of cape canaveral fl with the artificial neural network model forecast different from a relatively short impact of isaias at station 41013 in fig 15 the duration of eta was about 6 days including both the rise and the recession of significant wave height and average wave period the comparison shows that all four forecasts match very well with the rise portion of both wave height and wave period while 1 hour 3 hour and 6 hour forecasts agree very well with the recession portion of the storm impact it is seen that there is a slight phase delay for a 12 hour forecast during the storm recession this might be due to the lack of representative storms in the training data to capture the physical process a similar comparison using scatter plot is shown in fig 18 using the hourly data shown in fig 17 the rmse and r 2 comparisons for both significant wave height and average wave period support that the accuracy for 1 hour to 6 hour forecast is very similar while the rmse and r 2 for the 12 hour forecast are not significantly different from those from a short term forecast the more scattered distribution confirms the time series comparison discrepancy observed in fig 17 5 3 us northeast winter storms november 30 december 8 2020 the final wind wave forecast comparison between the artificial neural network model forecast and noaa measurement was not related to tropical cyclones but winter storms e g nor easters different from hurricanes that originate over the warm waters of the tropical regions nor easters originate from the us northeastern coast and they pick up strength from cold air a nor easter can produce wind gusts that are stronger than winds from hurricanes there were two winter storm events were recorded by noaa station 44013 boston 16 nm east of boston ma from late november to the middle of december fig 19 shows the comparison between noaa measurement and the artificial neural network model forecast the first storm is around december 1 and the peak significant wave height was about 3 5 m and the average wave period was 6 2 s all four forecast scenarios match very well with the significant wave height the second storm was around december 6 and its peak significant wave height was about 4 8 m the 1 hour 3 hour and 6 hour forecasts match very well with the measurement however a 12 hour forecast captures the significant wave height peak but it shows a phase delay when comparing with the measurement fig 20 further confirms these observations using scatter plots and training metrics rmse and r 2 it shows that the rmse and r 2 are relatively similar for 1 hour 3 hour and 6 hour forecasts while the 12 hour forecast shows a larger discrepancy from the measurement finally a few observations among the forecasts for isaias eta and nor easter can be made first the wind wave forecast model provides a similar accuracy among these storms if the forecast lead time is the same for example figs 16 18 and 20 show that the rmses for a 1 hour forecast lead time are 0 17 m 0 17 m and 0 1 m for isaias eta and nor easters respectively second given the same forecast lead time the forecast model gives a better prediction of significant wave height than that of the average wave period as indicated by a larger r 2 for the significant wave height than that of the average wave period for each of the storms third a similar phase delay for the 12 hour forecast during a storm recession has been consistently observed among these storms this phenomenon again might be caused by the insufficiency of storm data to train the forecast model to capture the sharp drop of significant wave heights and average wave period fourth the distribution of scatter points on the two sides of the straight lines in figs 16 18 and 20 is relatively equal showing that there is no systematic error in the wind wave forecast model that would lead to a consistent over prediction or under prediction overall the comparison of the artificial neural network model forecast of hurricanes and nor easters shows that the proposed artificial neural network model trained with only 1 5 years of data was able to forecast the storm wave height and wave period with sufficiently accurate if the forecast length is within 1 6 h a longer forecast e g 12 h or more requires additional improvement of the model e g model training with longer historical records that include more storm events so that the model would learn the long term patterns of storm waves more accurately 6 conclusions this study has presented an artificial neural network model to forecast time series wind waves at four selected noaa stations in the us atlantic coast the artificial neural network model consists of several neural network layers that take the past measurement and forecast future wave conditions the key neural network technique in our model is the long short term memory model which is able to learn patterns from data sequences the model was applied to a 2 year long dataset from january 1 2019 to december 31 2020 the input features of the artificial neural network model include historical wind data wind speed and wind direction wave data significant wave height average wave period and mean wave direction temperature data air temperature dew point temperature sea surface temperature and atmospheric pressure these features were selected by evaluating the pearson correlation coefficient the model was trained using 1 5 years of data and was used to forecast the remaining 6 5 month wind wave parameters including significant wave height average wave period and mean wave direction motivated by noaa storm forecast practice six forecast periods including 1 h 3 h 6 h 12 h 24 h and 48 h were carried out each of the six forecast scenarios was tested with four different ratios of input hours to forecast hours 1 1 3 1 5 1 and 7 1 the conclusions and major contributions of this study are summarized as follows two training metrics root mean square error and coefficient of determination r 2 were used to evaluate the model training efficiency the results showed the artificial neural network model converges very quickly and does not have over fitting nor under fitting issues the forecast skill of the artificial neural network model was examined by calculating the root mean square error for the 6 5 month long forecast and the corresponding noaa measurement it was found that a short term forecast e g 1 h 3 h or 6 h achieves a high level accuracy the discrepancy increases as the forecast lead time increases the experimentation of four different ratios of input hours to forecast hours i e 1 1 3 1 5 1 and 7 1 showed that the forecast accuracy using a ratio of 1 1 is comparable or even better than a longer input sequence what is more the training time of a shorter input sequence is faster thus this study recommended using the input hours with the same length as the forecast hours for future research on time series forecasts the 6 5 month long forecast was further evaluated by generating rose plots for both significant wave height and average wave period the agreement was examined for all four noaa stations and the result showed that the artificial neural network model reproduces wave statistics for wave heights and wave periods very well furthermore the forecast time series significant wave height and average wave period were also compared with corresponding noaa measurement the result confirms that a short term forecast e g 3 h is more accurate than a long term forecast e g 48 h lastly the capability of the artificial neural network model to forecast storm waves was evaluated by comparing with wave conditions for several storm events including hurricanes isaias and eta in the us south atlantic region and two winter storms in the us north atlantic region the result shows that the artificial neural network model is able to accurately forecast the significant wave height and average wave period associated with storm events when the forecast lead time is relatively short e g 1 to 6 h to conclude the proposed artificial neural network model is an efficient tool for predicting wind wave conditions it can serve as an alternative to traditional coastal models for storm forecast the future work will address the need for accurate long term storm forecasts e g by providing more training data or developing a new neural network model credit authorship contribution statement zhangping wei conceptualization methodology software validation formal analysis investigation resources data curation writing original draft writing review editing visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was supported by the faculty start up fund from university of north carolina wilmington united states the author would like to acknowledge grayson jackson for experimenting an early version of the artificial neural network model by predicting time series significant wave heights for noaa station 41108 wilmington harbor nc through an undergraduate capstone project the author would like to acknowledge three anonymous reviewers for their constructive comments which greatly improved the manuscript appendix the lstm model the lstm network diagram is shown in fig a 1 the mathematical equations of the lstm model e g hochreiter and schmidhuber 1997 géron 2019 can be found in eqs a 1 to a 6 a 1 i t σ w x i x t w h i h t 1 b i a 2 f t σ w x f x t w h f h t 1 b f a 3 o t σ w x o x t w h o h t 1 b o a 4 g t tanh w x g x t w h g h t 1 b g a 5 c t f t c t 1 i t g t a 6 y t h t o t tanh c t where the logistic function σ and hyperbolic tangent function tanh are defined as a 7 σ x 1 1 e x a 8 tanh x 2 σ 2 x 1 in eqs a 1 to a 6 w x f w x g w x i w x o are the weight matrices of each of the four layers for the connection to input vector x t next w h f w h g w h i w h o are the weight matrices of each of the four layers for the connection to the previous short term state h t 1 finally b f b g b i and b o are the bias terms for each of the four layers the convolutional lstm of shi et al 2015 improves the original lstm model to handle data that involve spatial and temporal spaces in two major steps they represent inputs outputs short term states and gates in 3d tensors one of the three dimensions represents time and the other two dimensions represent the spatial dimensions they apply the convolution operator rather than dot product operator in a 1 to a 6 as a result both spatial and temporal features can be learned by the convolution operation 
20342,this study presents an artificial intelligence ai model to forecast time series wind waves in the us atlantic coast the fundamental technique in the proposed model is the long short term memory model which is able to learn patterns from data sequence the model is trained using historical wind data wave data temperature data and atmospheric pressure data then the model is used to forecast significant wave height average wave period and mean wave direction a 2 year meteorological data measured at four noaa buoy stations in the us atlantic coast are used to train and evaluate the model s forecast skills the results show the artificial neural network model converges fast and does not have over fitting nor under fitting issues furthermore a short term forecast e g 1 to 6 h achieves higher accuracy than a long term forecast e g 24 to 48 h this study shows that sufficient forecast accuracy can be obtained by using the input hours equal to the forecast lead time comparison using rose plots confirms that the artificial neural network model reproduces wave height and wave period statistics very well the artificial neural network model is used to forecast storm waves induced by hurricanes isaias and eta in the us south atlantic region and two winter storms in the us north atlantic region the model forecast is compared with noaa measurement the results show that the artificial neural network model is able to accurately forecast both significant wave height and average wave period associated with storm events when the forecast lead time is relatively short e g 1 to 6 h the proposed artificial neural network model can serve as an alternative tool to traditional coastal models for wave prediction and storm forecast keywords significant wave height averaged wave period mean wave direction wind waves storm forecast artificial intelligence long short term memory model 1 introduction this study focuses on wind wave climates in the us atlantic coast which experiences seasonal tropical cyclones for example the 2020 atlantic hurricane season had 30 named storms and 14 of them were hurricanes climate change and sea level rise would exacerbate storm hazards e g yin et al 2020 wind waves contribute to nearshore wave setup which can be significant when comparing with storm surge since wind waves are much stronger during storms the study of storm waves will significantly improve our capability to understand other coastal processes under storms e g coastal morphology beach erosion and rip currents thus an accurate forecast of wind waves is essential for storm forecasting and risk management in the coastal zones wind wave study has been carried out for decades the early works developed wave spectral models that characterize wave height and wave period e g jonswap spectrum hasselmann et al 1973 pierson moskowitz spectrum pierson jr and moskowitz 1964 and tma spectrum bouws et al 1985 early methods for wave forecast were simple empirical equations that related wave height and wave period to representative wind speed fetch length and wind blow duration e g young 1988 hubertz et al 1994 with the development of numerical method and computer hardware those empirical formulations have been implemented in coastal models to estimate wind waves in oceanic and coastal settings e g swan e g holthuijsen 2010 and stwave smith et al 2001 furthermore shallow water equations based coastal model e g adcirc of luettich et al 1992 was integrated with the spectral wave model swan to simulate storm surge and hurricane generated waves e g dietrich et al 2012 what is more phase resolving coastal models e g zijlema et al 2011 shi et al 2012 wei and jia 2014 can be used to simulate time varying wave processes in the nearshore zone however the major limitation to apply those coastal models for wind wave modeling and forecast is that coastal models usually require expensive high performance computing facility which is not affordable for a wide research community with the advent of artificial intelligence in the past decade machine learning models have been applied to study coastal processes and a few recent studies related to wave prediction were reviewed in this section kagemoto 2020 applied a recurrent neural network rnn model the long short term memory lstm model hochreiter and schmidhuber 1997 to forecast both actual wave trains and numerically reproduced irregular wave trains and the author found that the lstm model generates reasonably accurate forecasts fan et al 2020 also applied the lstm model to predict significant wave heights at several buoy stations globally and their lstm model was able to provide more accurate significant wave height forecast when comparing with several other machine learning models pirhooshyaran and snyder 2020 applied rnns including a simple lstm and an encoder and decoder lstm to predict a single variable i e significant wave height and two variables i e significant wave height and energy flux ni and ma 2020 presented an integrated approach using lstm and principal component analysis pca to predict significant wave height their pca method was used to extract principal components from a set of input signals while lstm was adopted to avoid long term independence during the forecasting kim et al 2020a developed a convolutional lstm and a denoising autoencoder to predict ocean weather including wind wave parameters the aforementioned studies showed that the lstm model is the go to method for wave prediction which will be investigated in this work as well on the other hand the above literature reviews identified several research gaps first a univariate prediction related to wave height was studied intensively e g kagemoto 2020 fan et al 2020 pirhooshyaran and snyder 2020 among others while other wave parameters such as wave period and wave direction were rarely addressed but both parameters are important to characterize wind wave conditions for storm forecast and marine operation second to the author s knowledge forecasting of wind waves due to hurricanes or typhoons using machine learning models has not been well studied for example dixit and londhe 2016 applied neuro wavelet technique to predict significant wave heights of several atlantic hurricanes however their study did not predict wave period nor wave direction this study aims to address these research needs and make several novel contributions to the wind wave forecast research field specifically this study will explore the possibility of using a wide range of meteorological parameters to develop a multivariate wind wave forecast model the developed wind wave forecast model is able to predict full wind wave parameters including significant wave height average wave period and mean wave direction furthermore the study will investigate the efficiency of the artificial neural network model to forecast storm waves this paper is organized as follows section 2 introduces noaa buoy stations and their meteorological data selects the input features for artificial neural network model training and presents model forecast scenarios section 3 explains the background of artificial neural network model presents the model architecture and provides the details on data preparation section 4 presents a series of results related to model training metrics forecast skills comparison with noaa measurement section 5 discusses the possibilities and the challenges in applying the proposed artificial neural network model to forecast storm waves finally the conclusion is drawn in section 6 2 wind wave data 2 1 introduction to noaa buoy stations the wind wave data used in this study were collected by noaa national data buoy center ndbc https www ndbc noaa gov the location of four ndbc stations can be found in the map of fig 1 their station ids station names and latitudes and longitudes are listed in table 1 those four stations were selected for two major reasons the first one was that they had relatively more complete wind wave data than other stations for the study period of this project i e the full two years of 2019 and 2020 the second reason was that all four stations are in the us atlantic coast which experiences seasonal storm events specifically station 41009 is in the east coast of florida station 41008 in the east coast of georgia station 41003 is in the east coast of south north carolina and station 44013 is in the massachusetts bay the three stations in the south atlantic coast are within the impact region of atlantic hurricanes from june through november station 44013 is within the impact region of winter storms or nor easters in the winter months 2 2 wind wave data overview the time period of wind wave data used in this study was from january 1 2019 to december 31 2020 the total number of records at each station is more than 17500 with the data interval of one hour there were some data gaps in the records from several hours up to a few days the missing data for those periods were filled with previous available noaa measurement at the same station this section presents the statistical distribution of the wind speed and the significant wave height in the form of rose plots fig 2 shows the rose plots of wind speed for the four stations over the 2 year period the recorded wind direction was used to draw the rose plots the wind speeds were categorized into four bins 0 5 m s 5 10 m s 10 15 m s and above 15 m s it is seen that at station 41008 the wind blew from the northeast or southwest directions which are parallel to the coastal lines near this buoy station the maximum percentage is about 12 for the northeast winds and about 10 for the south and southwest winds winds in the range of 10 15 m s were from the northeast direction and most of the wind speeds were in the range of 5 10 m s the winds at station 41009 mainly blew from northeast to south directions and the maximum percentage is about 8 9 from the east the majority of the winds were in the range of 5 10 m s at station 41009 the winds blew mainly from northeast and southeast directions at station 41013 and the wind direction was also parallel to the coastal lines near this station the maximum percentage of wind records was about 12 from the southwest direction the majority of the winds were in the range of 5 10 m s on the other hand the strongest winds blew from north northeast direction at station 44013 the winds blew from northwest and southeast directions which were in the land sides of the station in particular the strongest winds were from the west and northwest directions the majority of winds were within the range of 5 10 m s overall the wind speeds at these four stations were relatively different posing a challenge to the machine learning model to resolve diverse wind patterns fig 3 shows the rose plots of significant wave heights for the four stations over the 2 year period the recorded mean wave direction was used to draw the rose plots the significant wave heights were categorized into five bins 0 0 5 m 0 5 1 0 m 1 0 1 5 m 1 5 2 0 m and above 2 0 m it is seen that at station 41008 the waves propagated from the east and southwest directions the maximum percentage was about 27 for the east southeast direction and about 20 for the east side the majority of wave heights were in the range of 0 5 1 0 m and its percentage was about 40 among the 2 year records the waves at station 41009 mainly propagated from east to northeast directions and the maximum percentages were 29 from the east and 26 from the east northeast direction comparing to station 41008 the wave heights at station 41009 were larger since more than 10 of the waves were above 2 0 m the wave height distribution was more diverse at station 41013 than the two stations described above waves propagated mainly from the south to the east at station 41013 the maximum percentage of wave records was about 18 from the east southwest direction the percentage of wave height magnitudes was more evenly distributed among four wave height bins at station 44013 the waves propagated from southeast to northeast directions the largest percentage of waves was about 26 from the east and about 17 of the waves were from the east northeast direction the majority of wave heights were within the range of 0 5 1 0 m similar to the wind speeds plots in fig 2 the distributions of significant wave heights at these four stations were relatively different 2 3 wind wave data correlation this study utilized the measured meteorological data to forecast wave climate parameters at noaa stations table 2 shows those parameters and their corresponding definitions the 12 variables are broadly related to i the winds i e gst wdir wspd ii the waves i e apd dpd mwd wvht iii the temperatures i e atmp dewp wtmp iv the tides tide and v the atmospheric pressure pres the wave related parameters are the target variables in this study i e the parameters will be forecast by the artificial neural network model it should be noted that the noaa buoy station does not record the tide data and the tide data used in this analysis were from the nearest tide stations from noaa tides and currents https tidesandcurrents noaa gov the selection of input parameters for machine learning forecast models was guided by the analysis of statistical correlation among different physical parameters e g fan et al 2020 kim et al 2020b to better understand the correlation among these wind wave parameters a correlation analysis was carried out by using the pearson standard correlation coefficient r as defined below 1 r i 1 n x i x y i y i 1 n x i x 2 y i y 2 where n is the sample size x i and y i are individual samples with index i x 1 n i 1 n x i and y 1 n i 1 n y i it should be noted that the pearson correlation coefficient is a measure of the linear correlation of variables and it ignores many other types of relationship a value of r 1 indicates the perfect positive relationship between two variables e g x increases as y increases a value of r 1 indicates that a perfect negative relationship between two variables e g x increases as y decreases a value of r 0 indicates the absence of a linear relationship between two variables fig 4 shows the pearson correlation coefficient r matrix among all wind wave parameters the 2 year noaa measured data for all four stations were used to calculate the correlation coefficient there are several important observations the first one is the tides or water levels i e tide have a very week correlation with other wind wave parameters since the correlation coefficients of tides to others are close to 0 thus the tides were not considered as an input parameter in the artificial neural network model second the two wind parameters gst i e the peak gust speed and wspd i e the short term average wind speed have a correlation coefficient of 0 99 indicating a strong linear relationship since average wind speed is more commonly used for coastal modeling the wspd rather than gst was used for artificial neural network model development third the two wave period parameters dpd i e dominant wave period and apd i e average wave period have a correlation with r 0 6 considering the fact that the domain wave period is relatively noisy the average wave period was used in short three variables the tides tide gust speed gst and dominant wave period dpd were not used in this study and the target wind wave parameters are significant wave height wvht average wave period apd and mean wave direction mwd as indicated in table 2 in other words nine out of twelve wind wave parameters were selected as input features to predict three target wave climate parameters it is worth pointing out that different from the study by fan et al 2020 where only positively correlated variables were used for machine learning this study considered variables that are either negatively or positively correlated to the target parameters since both types of correlation are useful for machine learning furthermore the study of fan et al 2020 only used wind direction wind speed and wave height one hour ago as the input feature this study considered a broader range of input features related to winds waves temperatures and atmospheric pressure it is expected that the model trained using a broader dataset will generalize better than the model trained with limited data types fig 5 shows an example of time series profiles of the wind wave data that were used to develop the artificial neural network model the time series data were from noaa station 41008 and the period of the data was from january 1 2019 to march 1 2019 the profiles for the selected nine variables were presented the complexity of the time series sample is clearly observed from this figure for example we can see sudden changes of mean wave direction mwd and wind direction wdir from 0 to 360 or from 360 to 0 although both 0 and 360 represent the north direction and they are very close in reality their values however are the two limits ends of the direction related data furthermore we also deal with data with different frequencies almost all time series profiles show the rise and fall patterns however the frequency or the recurrence of those patterns are very different from each other what is more the magnitudes of those nine variables are very different they range from e g 3 i e the magnitude of significant wave heights to 1030 i e the magnitude of atmospheric pressures overall the wind wave data used in this study were very complicated and thus posed a challenge to artificial neural network models specifically can an artificial neural network model learn the complex patterns hidden in these data what are the levels of accuracy and efficiency if it can learn from the data these are the key questions this study would like to answer in the following sections 2 4 wind waves forecast scenarios the ultimate goal of this study is to develop an artificial neural network model that will be able to forecast wind wave conditions in coastal areas that are vulnerable to storms or tropical cyclones forecast lead time is critical to achieve this goal as previously explored by several studies e g kim et al 2016 hien et al 2020 kim et al 2021 the prediction forecast lead time in this study was motivated by noaa s guidelines practices on issuing tropical cyclone advisory https www nhc noaa gov aboutnhcprod shtml specifically noaa tropical cyclone public advisories are normally issued every 6 h however intermediate public advisories are issued every 3 h when coastal watches or warnings are in effect furthermore special public advisories may be issued at any time due to significant changes in warnings or in the cyclone noaa issues tropical cyclone forecast advisory that includes the location intensity and system motion of the cyclones the issue intervals are 12 24 36 48 60 and 72 h from the current synoptic time in general weather forecast becomes more challenging and less accurate for a longer forecast lead time by considering noaa s practice as reviewed above and the difficulty of the long term forecast this study proposed to forecast wind waves conditions for these six intervals 1 h 3 h 6 h 12 h 24 h and 48 h the 1 hour forecast was used to consider special public advisories that are issued at any time due to the significance of the storms or cyclones 36 h and 72 h forecasts were doable by the artificial neural network model however they were not included due to the level of accuracy becomes lower when the forecast lead time becomes longer the wind wave condition forecast requires the past conditions however there was no previous study that clearly determined the proper length of past data this study proposed to examine the length i e the number of hours of the input past data by experimenting with four ratios i e 1 1 3 1 5 1 and 7 1 of the forecast hours as shown in table 3 for example a 3 hour forecast was tested with input data in the past of 3 9 15 and 21 h as a result there are 24 runs for each of the four noaa stations and the total number of runs is 96 for all stations 3 an artificial neural network model for wind waves forecast this section presents an artificial neural network model for wind waves forecast for the four noaa stations introduced in the previous section we first briefly review the background of the long short term memory model which was the fundamental artificial neural network model used in this study next we describe the proposed artificial neural network architecture in detail finally we explain how to prepare transform the noaa wind wave data into a format that will be input into the model 3 1 artificial neural network model background the artificial neural network was inspired by the biological neural network which helps animal brains to perform complex computations and learning e g mcculloch and pitts 1943 artificial intelligence machine learning and deep learning have gained significant advancement in the past decade thanks to new and fast hardware a large number of datasets and neural network algorithm improvement chollet 2018 a complete review of the latest artificial intelligence technology is beyond the scope of this study and the artificial intelligence models related to time series forecast are briefly reviewed in this section time series forecast is a challenging task because the algorithm has to take into account the temporal dependence and the order of data a recurrent neural network rnn addresses this issue by maintaining a state i e so called memory containing the information relative to what it has learned so far one of the well known rnns is the long short term memory lstm model developed by hochreiter and schmidhuber 1997 the lstm model has been gradually improved over years by several studies e g graves 2013 sak et al 2014 zaremba et al 2014 the basic idea of the lstm model is to recognize important features from the input data store them in the long term state preserve them for as long as needed and use them for prediction whenever it is needed géron 2019 the lstm model is a key neural network model that made this study successful to predict time series wind wave profiles by training it using historical meteorological data an important improvement of the lstm model was the convolutional lstm by shi et al 2015 the convolutional lstm is able to preserve the spatial information which is lost in the fully connected lstm model this was achieved by applying many moving filters to capture temporal and spatial patterns the network diagram and the mathematical equations of the lstm model are presented in appendix 3 2 the model architecture the proposed artificial neural network model was developed based on the python package keras https keras io which is an open source software library that provides a python interface for artificial neural networks chollet 2018 keras provides high level deep learning application programming interface that allow users without a significant machine learning background knowledge to easily build train and evaluate different types of artificial intelligence neural networks keras itself does not perform any heavy computation and it relies on the so called computation backend e g tensorflow géron 2019 the software version of keras 2 4 3 was used in this study the keras tuner https keras io keras tuner of o malley et al 2019 was used to select optimized hyperparameters e g the number of neural network units per layer with the objective to minimize the validation loss fig 6 shows the proposed artificial neural network model for the wind wave forecast it should be pointed out that each of the runs in this study has the same neural networks configuration as seen in fig 6 but different input shapes as defined in table 3 this example model architecture is for r06 that forecasts 3 hour wind wave conditions with 9 hour input data in the past the shape information i e the input size and the output size of each layer was also displayed in fig 6 a neural network model is usually made up of three types of layers input layer one or more hidden layer s and output layer e g brownlee 2018 each of the layers carries out several mathematical operations on its input data and then produces results as the input for the next layer or as the model output a brief description of the wind wave artificial neural network model of fig 6 is provided below the input layer instantiates a 5d tensor that has the shape size of the input training data the first dimension of none 1 1 9 9 is the batch size of the training sample since it is determined at the run time and not pre defined a none is used to indicate that the size will be determined at the run time the second dimension is one which is the number of steps in the training data table 3 shows that we only consider one step of input that has e g 9 h data the third and fourth dimensions are the size of input data the number of rows and the number of columns since one dimensional 1d temporal data were used in this work the number of rows is assumed to be one and the number of columns is the input duration i e 9 h for this specific case finally the fifth dimension is the number of input features the number of features is 9 in this study because 9 out of 12 variables were selected to predict wind wave conditions as listed in table 2 the first hidden layer in our artificial neural network model is a convlstm2d layer or convolutional lstm the convolution operation applies filters to extract features from the input data this study applied 50 filters with the size of 1 3 for r02 r24 as indicated in table 3 the activation function is the rectified linear unit function relu the kernel is initialized using the he initialization of he et al 2015 and the l2 kernel regularization with a value of 0 01 is also applied in this layer the second hidden layer is a flatten layer which transforms a multiple dimensional matrix of features into 1d data the third hidden layer is a repeatvector operation which repeats the input from the previous layer by a factor there are three target wind wave parameters i e wvht apd and mwd and 3 was the number of repeats in our artificial neural network model the four hidden layer is an lstm layer this study specified 50 units in the lstm layer as a result the output dimension has the shape of none 3 50 both none and 3 have the same meaning explained in previous layers the fifth hidden layer is a fully connected dense layer and it has 30 units as indicated in the output shape it is important to note that the so called timedistributed operation was applied to preserve the order of data sequence which is essential for time series forecasting finally the output layer is a fully connected dense layer with its size equal to 3 which matches the number of target wind wave parameters the other 3 indicates the output size i e 3 h forecast 3 3 data preparation and computing environment traditional coastal modeling and forecast take time series data as the boundary conditions e g waves and tides and spatial forcing e g winds and atmospheric pressure however this approach does not work with machine learning model and the time series noaa measurement presented in section 2 must be pre processed before it can be used to train and test our artificial neural network model this section explains the data transformation and preparation steps in details in hope to provide a reference for future research using a similar machine learning approach the first data preparation step is to address the issue that the input data have different magnitudes or scales e g the magnitude of wave height is a few meters but the pressure is more than a thousand hpa machine learning models do not perform well when the input numerical data or features have very different scales this issue was addressed by standardization which is expressed as 2 z x u s where x is the sample u is the mean of the sample s is the standard deviation and z is the standardized sample in short the standardization first subtracts the mean value and then it divides by the standard deviation so that the resulting distribution has unit variance géron 2019 the standardscaler transformer of scikit learn pedregosa et al 2011 was used to achieve the above goal it is important to point out that each of the nine features were independently standardized by computing its relevant statistics furthermore the standardization process does not change the statistical distribution of the input variable but rather it is a simple data pre processing technique the standardization technique was applied to the measurement at the selected four noaa stations as mentioned in section 2 the standardized data for each station were then split into training and test samples as listed in table 4 the training sample was used to train the model and then the test sample which was not seen by the artificial neural network model during the training stage was used to examine the capability of trained model for wind wave forecast the full training sample was divided into sub samples and each sub sample includes both input sequence and target sequence according to their run scenarios as defined in table 3 fig 7 shows the data preparation for the training sample for r06 which uses 9 h input data to predict future 3 h wind wave conditions it is seen that the time shift between sub sample 1 and sub sample 2 is one hour resulting in 11997 sub samples with the last three samples are the target sequence of sub sample 11997 the order of those sub samples was randomized and 15 of them was used as the validation sample for model training fig 8 shows the data preparation for test sample the full test sample was also divided into sub samples different from the training sample preparation the test sub samples have a time shift equal to the forecast duration e g 3 h for r06 the motivation was that the forecast results would not have any overlaps so that they could be easily merged to get the full forecast sequence that will be compared with noaa measurement in short the number of test sub samples is approximately equal to the length of the test sample divided by the length of forecast sequence as a result the number of test sub samples for a long term forecast e g 48 h will be much smaller than that for a short term forecast e g 1 h thus the model forecast time varies as to be shown in section 4 after all necessary data preparation 24 run scenarios listed in table 3 were carried out for each of four noaa stations resulting in 96 runs using the proposed artificial neural network model for wind waves forecast the computing system was configured as below the cpu model name is intel r xeon r cpu 2 00 ghz the clock speed of the cpu is 2k mhz and the cpu cache size is 39424 kb two cpus were used for the artificial neural network model training and forecast 4 results this section presents the results of the artificial neural network model for wind wave forecast the artificial neural network model training convergence is demonstrated by the training metrics then we show the training efficiency in terms of computing time next we evaluate the model capability for wind wave forecast using a commonly used forecast skill parameter we further show the statistical agreement between the model forecast with the noaa measurement by using rose plots finally we compare the time series wind wave results for different forecast hours and identify model configurations that are both efficient and accurate it should be noted that most of the results in this section were related to noaa station 41008 there were two reasons for this choice first the same type of results at other stations is very similar to these presented for station 41008 second in the author s opinion it is better to show results for a consistent noaa station if possible rather than changing the station locations from section to section 4 1 the model training metrics the artificial neural network model was trained with 200 epochs to make sure that the model training converged the artificial neural network model iterates over the full training and validation sample during one epoch the batch size is 16 for all 96 runs the batch size is the number of training sub examples utilized in one iteration epoch the artificial neural network model training process was monitored by two metrics root mean squared error rmse and the coefficient of determination or r squared r 2 the definition of rmse is given as below 3 r m s e 1 n i 1 n y i f i 2 where y is the noaa measurement f is the prediction or forecast value i is the index and n is the number of samples the coefficient of determination r 2 is defined as 4 r 2 1 s s r e s s s t o t where the sum of squares of residuals s s r e s is defined as 5 s s r e s i 1 n y i f i 2 and the total sum of squares s s t o t is defined as 6 s s t o t i 1 n y i y 2 with y 1 n i 1 n y i the above metrics were applied to both training and validation samples and fig 9 shows the comparison of training and validation metrics with respect to the number of epochs the results show that the rmse reduces as the number of epochs iterations increases and it reaches a stable value of 0 3 similarly the r 2 gradually increases as the number of epochs increases and it reaches a stable value of 0 85 more than that the trends for both training and validation curves are very close indicating that the model gives similar performance for training and validation samples and it does not have under fitting nor over fitting issues it should be pointed out that both training and validation samples are standardized using eq 2 and their mean values were removed in the training and validation samples as a result the rmse value in fig 9 does not reflect the real magnitude of the error between model forecast and noaa measurement the model training time is proportional to the number of epochs and it seems like a waste of time to use 200 epochs since the model already converged around dozens of epochs test runs showed that a longer forecast scenario e g 48 h forecast needs a larger number of epochs however all model tests have converged before 200 epochs another reason to use a larger number of iterations e g 200 is that the computing cost for training the proposed artificial neural network model was not expensive as shown in fig 10 the picture shows the training time and forecast time for all 24 run scenarios for noaa buoy station 41008 there are six forecast sequences i e 1 h 3 h 6 h 12 h 24 h and 48 h and each of them was tested with four different input lengths as a ratio of the input hours to the forecast hours i e 1 1 3 1 5 1 and 7 1 as listed in table 3 there are several important observations first the training time increases as the forecast length increases from 1 h to 48 h second for each of the six forecast scenarios the smaller the input to forecast ratio the shorter the training time third the forecast time reduces as the forecast length increases this is because the number of prediction test sub samples is the total number of test samples divided by the forecast length if the forecast length is larger and the number of forecast or test sub samples is smaller subsequently the time to run forecasts will be much shorter it is important to point out that the 300 s forecast time was the total computing time for the 6 5 month forecast from may 15 2020 to december 31 2020 in other words it only takes about 1 2 s to predict wave conditions for 1 2 days in the future the readers are also reminded that the major training time of 10 50 min was for 200 epochs or iterations and the model was run on 2 cpus indicating that the training time per epoch is only a few seconds the computation cost of artificial neural network model is comparable or even cheaper than that required by traditional coastal modeling systems 4 2 the artificial neural network model forecast skill the artificial neural network model forecast skill was evaluated by the root mean squared error rmse as defined in eq 3 fig 11 shows the comparison of rmse for the 24 run scenarios for noaa buoy station 41008 a separate rmse distribution was presented for each of the three wind wave parameters significant wave height wvht average wave period apd and mean wave direction mwd it should be clarified that the rmse was obtained by using the forecast wind wave data with noaa measurement from may 15 2020 to december 31 2020 different from the rmse value obtained from the standardized data shown in fig 9 each of the three wind wave parameters presented in fig 11 has its real magnitude for example the magnitude of the mean wave direction is 360 it is seen that the rmse increases as the length of the forecast sequences increase from 1 h to 48 h specifically the rmses of significant wave height comparison are 0 08 m 0 11 m 0 18 m 0 28 m 0 37 m and 0 43 m for 1 hour 3 hour 6 hour 12 hour 24 hour and 48 hour forecasts respectively the rmses of average wave period comparison are 0 22 s 0 40 s 0 53 s 0 71 s 0 86 s and 1 0 s for 1 hour 3 hour 6 hour 12 hour 24 hour and 48 hour forecasts respectively the rmses of mean wave direction comparison are 35 40 46 50 56 and 60 for 1 hour 3 hour 6 hour 12 hour 24 hour and 48 hour forecasts respectively it is seen that the accuracy redues when the length of the prediction sequences is getting longer there are several reasons for this phenomenon first our personal experience indicates that it is easier to predict the wave in the future one hour than that in one or two days second neural network models using simple logistic function or hyperbolic function see fig a 1 may not resolve highly nonlinear wave process when the forecast lead time becomes longer nevertheless considering the fact that the magnitudes for the three wave parameters are approximately 3 0 m 12 s and 360 the forecast accuracy of the artificial neural network model is satisfactory furthermore four ratios of input hours to forecast hours i e 1 1 3 1 5 1 and 7 1 were used to predict the same duration in the future it is seen that the smaller the ratio the smaller the rmse for all three wind wave parameters the ratio of 1 1 seems the best option in terms of forecast accuracy and model training time this is an important finding that can be adopted by future research on time series forecast in view of the relatively short model training time and the fast forecast speed as shown in fig 10 the artificial neural network model has a great potential to forecast weather and storms for emergency management and marine operation 4 3 comparison of statistical wind wave parameters this section compares the artificial neural network model forecast with the noaa measurement using rose plots the analysis was based on the 6 5 month forecast from may 15 2020 to december 31 2020 for both model forecast and noaa measurement both significant wave height and average wave period were analyzed the forecast mean wave direction was used to draw rose plots for forecast and the measured wave direction was used to draw rose plots for noaa measurement fig 12 shows the comparison of significant wave height rose plots at noaa stations 41008 and 41009 five wave height bins 0 0 5 m 0 5 1 0 m 1 0 1 5 m 1 5 2 0 m and 2 0 m above were used it is seen that at station 41008 the majority of the waves propagated from the east southeast direction which was clearly observed from both noaa measurements and the forecast by the artificial neural network model moreover the percentage distribution of wave height bins is also very similar between measurement and forecast the waves were mainly from east and northeast directions at station 41009 the forecast slightly over predicts waves from the east side when comparing with the measurement and it under predicts the waves from the east southeast direction overall the comparison of significant wave heights at stations 41008 and 41009 shows that the artificial neural network model is able to capture the main wave directions and the wave height distribution fig 13 shows the comparison of average wave period rose plots at noaa stations 41013 and 44013 five wave period bins 0 2 s 2 4 s 4 6 s 6 8 s and 8 s above were used it is seen that at station 41013 the majority of the waves propagated from the east southeast and southeast directions furthermore most of the waves have a wave period between 4 6 s both phenomena were clearly forecast by the artificial neural network model similar to station 41009 the waves were mainly from east and northeast directions at station 44013 the forecast also slightly over predicts waves from the east side when comparing with the measurement and it under predicts the waves from the east northeast direction in short the rose plot comparisons in figs 12 and 13 show that the artificial neural network model is able to reproduce the wave statistics for both wave heights and wave periods at the four noaa stations well 4 4 comparison of time series wind wave forecast this section further compares the time series wind wave forecast with noaa measurement fig 14 presents the comparison of significant wave height average wave period and mean wave direction at station 41008 for the month of september 2020 we present three different forecast lengths 3 h 12 h and 48 h since each of them was tested with four ratios of input hours to forecast hours results based on the ratio of 1 1 were presented in fig 14 their corresponding run indices are r05 r13 and r21 as listed in table 3 the rmses of the three runs can be found in fig 11 in general the comparison in fig 14 shows that a shorter forecast length gives more accurate predictions specifically a 3 hour forecast captures almost the full trend of all three wind wave parameters in this whole month a 48 hour forecast has the largest discrepancy and the accuracy of a 12 hour forecast is better than a 48 hour forecast but less than the 3 hour forecast overall the level of agreement observed in fig 14 is consistent with the forecast skills as shown earlier in fig 11 5 applications and discussion an ai based approach for storm forecast the 2020 atlantic hurricane season was the most active and the fifth costliest atlantic hurricane season on record there were 30 named storms that occurred in 2020 and several of them had impacted the region studied in this work and their storm wave conditions were recorded by noaa buoys this section investigates the artificial neural network model s capability to predict wind waves for four selected storm events 5 1 hurricane isaias july 28 2020 august 5 2020 hurricane isaias was a category 1 hurricane in 2020 that caused extensive damages across the caribbean and the us east coast this storm was recorded by noaa buoy stations 41008 41009 and 41013 that were considered in this work isaias made landfall near ocean isle beach north carolina on august 4 with maximum 1 minute sustained winds of 90 mph 150 km h and a minimum central pressure of 986 millibars the noaa station 41013 frying pan shoals nc is on the east side where isaias made landfall the comparison of time series significant wave height and average wave period associated with isaias is shown in fig 15 four forecast sequences of 1 h 3 h 6 h and 12 h with the 1 1 ratio of input hours to forecast hours were tested and their corresponding run indices are r01 r05 r09 and r13 as listed in table 3 the noaa measurement showed that the peak significant wave height was about 7 m and the peak average wave period was about 8 7 s the comparison shows that the artificial neural network model using 1 hour and 3 hour forecasts was able to capture the approximate time when the storm occurred and the forecast peak significant wave height and average wave period were very close to the actual measurement as we increase the model forecast hours from 3 h to 6 h and 12 h the forecast skills for the non storm profiles are still acceptable however they did not capture the peak values as well as the 3 hour forecast one obvious reason for the difference is that the impact duration of isaias on this buoy station is less than 12 h and a 12 hour forecast lead time was longer than the actual event due to the limited 2 year data the model was not exposed to enough historical data to capture such a rare and fast storm as a result there are an under prediction and a phase delay in the time series comparison the agreement between noaa measurement and the model forecast is further compared using a scatter plot in fig 16 the scatter points are hourly data shown in fig 15 the perfect forecast will be along the straight line over prediction appears above the line while under predictions appear below the straight line since four forecast scenarios have the same number of scatter points if the discrepancy is larger if they are further away from the straight line the forecast skills are also evaluated using the rmse and r 2 for the four forecast lead time the comparison for the significant wave height in fig 16 a confirms that a short term e g 1 hour forecast agrees better with the measurement than that with a long term e g 12 hour forecast since its scatter points cluster around the straight line this is further confirmed by a smaller rmse 0 17 m vs 0 42 m and a larger r 2 0 96 vs 0 74 a similar observation can be found in fig 16 b for the average wave period comparison the rmse decreases as the forecast lead time increases while the r 2 decreases as the forecast lead time increases 5 2 hurricane eta october 31 november 13 2020 hurricane eta was a category 4 hurricane in 2020 that caused significant damage across parts of central america eta originated from a tropical wave in the eastern caribbean sea on october 31 and it became a category 4 hurricane on november 3 it made landfall in the florida keys on november 9 although noaa station 41009 is on the east coast of florida it recorded the impact of eta from approximately november 6 to november 13 fig 17 shows the time series comparison of significant wave height and average wave period associated with eta recorded by noaa station 41009 canaveral 20 nm east of cape canaveral fl with the artificial neural network model forecast different from a relatively short impact of isaias at station 41013 in fig 15 the duration of eta was about 6 days including both the rise and the recession of significant wave height and average wave period the comparison shows that all four forecasts match very well with the rise portion of both wave height and wave period while 1 hour 3 hour and 6 hour forecasts agree very well with the recession portion of the storm impact it is seen that there is a slight phase delay for a 12 hour forecast during the storm recession this might be due to the lack of representative storms in the training data to capture the physical process a similar comparison using scatter plot is shown in fig 18 using the hourly data shown in fig 17 the rmse and r 2 comparisons for both significant wave height and average wave period support that the accuracy for 1 hour to 6 hour forecast is very similar while the rmse and r 2 for the 12 hour forecast are not significantly different from those from a short term forecast the more scattered distribution confirms the time series comparison discrepancy observed in fig 17 5 3 us northeast winter storms november 30 december 8 2020 the final wind wave forecast comparison between the artificial neural network model forecast and noaa measurement was not related to tropical cyclones but winter storms e g nor easters different from hurricanes that originate over the warm waters of the tropical regions nor easters originate from the us northeastern coast and they pick up strength from cold air a nor easter can produce wind gusts that are stronger than winds from hurricanes there were two winter storm events were recorded by noaa station 44013 boston 16 nm east of boston ma from late november to the middle of december fig 19 shows the comparison between noaa measurement and the artificial neural network model forecast the first storm is around december 1 and the peak significant wave height was about 3 5 m and the average wave period was 6 2 s all four forecast scenarios match very well with the significant wave height the second storm was around december 6 and its peak significant wave height was about 4 8 m the 1 hour 3 hour and 6 hour forecasts match very well with the measurement however a 12 hour forecast captures the significant wave height peak but it shows a phase delay when comparing with the measurement fig 20 further confirms these observations using scatter plots and training metrics rmse and r 2 it shows that the rmse and r 2 are relatively similar for 1 hour 3 hour and 6 hour forecasts while the 12 hour forecast shows a larger discrepancy from the measurement finally a few observations among the forecasts for isaias eta and nor easter can be made first the wind wave forecast model provides a similar accuracy among these storms if the forecast lead time is the same for example figs 16 18 and 20 show that the rmses for a 1 hour forecast lead time are 0 17 m 0 17 m and 0 1 m for isaias eta and nor easters respectively second given the same forecast lead time the forecast model gives a better prediction of significant wave height than that of the average wave period as indicated by a larger r 2 for the significant wave height than that of the average wave period for each of the storms third a similar phase delay for the 12 hour forecast during a storm recession has been consistently observed among these storms this phenomenon again might be caused by the insufficiency of storm data to train the forecast model to capture the sharp drop of significant wave heights and average wave period fourth the distribution of scatter points on the two sides of the straight lines in figs 16 18 and 20 is relatively equal showing that there is no systematic error in the wind wave forecast model that would lead to a consistent over prediction or under prediction overall the comparison of the artificial neural network model forecast of hurricanes and nor easters shows that the proposed artificial neural network model trained with only 1 5 years of data was able to forecast the storm wave height and wave period with sufficiently accurate if the forecast length is within 1 6 h a longer forecast e g 12 h or more requires additional improvement of the model e g model training with longer historical records that include more storm events so that the model would learn the long term patterns of storm waves more accurately 6 conclusions this study has presented an artificial neural network model to forecast time series wind waves at four selected noaa stations in the us atlantic coast the artificial neural network model consists of several neural network layers that take the past measurement and forecast future wave conditions the key neural network technique in our model is the long short term memory model which is able to learn patterns from data sequences the model was applied to a 2 year long dataset from january 1 2019 to december 31 2020 the input features of the artificial neural network model include historical wind data wind speed and wind direction wave data significant wave height average wave period and mean wave direction temperature data air temperature dew point temperature sea surface temperature and atmospheric pressure these features were selected by evaluating the pearson correlation coefficient the model was trained using 1 5 years of data and was used to forecast the remaining 6 5 month wind wave parameters including significant wave height average wave period and mean wave direction motivated by noaa storm forecast practice six forecast periods including 1 h 3 h 6 h 12 h 24 h and 48 h were carried out each of the six forecast scenarios was tested with four different ratios of input hours to forecast hours 1 1 3 1 5 1 and 7 1 the conclusions and major contributions of this study are summarized as follows two training metrics root mean square error and coefficient of determination r 2 were used to evaluate the model training efficiency the results showed the artificial neural network model converges very quickly and does not have over fitting nor under fitting issues the forecast skill of the artificial neural network model was examined by calculating the root mean square error for the 6 5 month long forecast and the corresponding noaa measurement it was found that a short term forecast e g 1 h 3 h or 6 h achieves a high level accuracy the discrepancy increases as the forecast lead time increases the experimentation of four different ratios of input hours to forecast hours i e 1 1 3 1 5 1 and 7 1 showed that the forecast accuracy using a ratio of 1 1 is comparable or even better than a longer input sequence what is more the training time of a shorter input sequence is faster thus this study recommended using the input hours with the same length as the forecast hours for future research on time series forecasts the 6 5 month long forecast was further evaluated by generating rose plots for both significant wave height and average wave period the agreement was examined for all four noaa stations and the result showed that the artificial neural network model reproduces wave statistics for wave heights and wave periods very well furthermore the forecast time series significant wave height and average wave period were also compared with corresponding noaa measurement the result confirms that a short term forecast e g 3 h is more accurate than a long term forecast e g 48 h lastly the capability of the artificial neural network model to forecast storm waves was evaluated by comparing with wave conditions for several storm events including hurricanes isaias and eta in the us south atlantic region and two winter storms in the us north atlantic region the result shows that the artificial neural network model is able to accurately forecast the significant wave height and average wave period associated with storm events when the forecast lead time is relatively short e g 1 to 6 h to conclude the proposed artificial neural network model is an efficient tool for predicting wind wave conditions it can serve as an alternative to traditional coastal models for storm forecast the future work will address the need for accurate long term storm forecasts e g by providing more training data or developing a new neural network model credit authorship contribution statement zhangping wei conceptualization methodology software validation formal analysis investigation resources data curation writing original draft writing review editing visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was supported by the faculty start up fund from university of north carolina wilmington united states the author would like to acknowledge grayson jackson for experimenting an early version of the artificial neural network model by predicting time series significant wave heights for noaa station 41108 wilmington harbor nc through an undergraduate capstone project the author would like to acknowledge three anonymous reviewers for their constructive comments which greatly improved the manuscript appendix the lstm model the lstm network diagram is shown in fig a 1 the mathematical equations of the lstm model e g hochreiter and schmidhuber 1997 géron 2019 can be found in eqs a 1 to a 6 a 1 i t σ w x i x t w h i h t 1 b i a 2 f t σ w x f x t w h f h t 1 b f a 3 o t σ w x o x t w h o h t 1 b o a 4 g t tanh w x g x t w h g h t 1 b g a 5 c t f t c t 1 i t g t a 6 y t h t o t tanh c t where the logistic function σ and hyperbolic tangent function tanh are defined as a 7 σ x 1 1 e x a 8 tanh x 2 σ 2 x 1 in eqs a 1 to a 6 w x f w x g w x i w x o are the weight matrices of each of the four layers for the connection to input vector x t next w h f w h g w h i w h o are the weight matrices of each of the four layers for the connection to the previous short term state h t 1 finally b f b g b i and b o are the bias terms for each of the four layers the convolutional lstm of shi et al 2015 improves the original lstm model to handle data that involve spatial and temporal spaces in two major steps they represent inputs outputs short term states and gates in 3d tensors one of the three dimensions represents time and the other two dimensions represent the spatial dimensions they apply the convolution operator rather than dot product operator in a 1 to a 6 as a result both spatial and temporal features can be learned by the convolution operation 
20343,a wave energy dissipator wed is proposed in this paper composed of two asymmetric hinged floaters and two hydraulic cylinders with the purpose to resist wave induced relative rotation around the hinge experimental studies are performed to explore its performance under a wide range of regular waves based on reynolds averaged navier stokes equations a 3d numerical model is set up considering the non linear interaction of wave and wed the agreement between the experimental and numerical results is good with the validated numerical model the influence of the wed geometrical factors on energy conversion and wave transmission is examined for a given raft length the difference in energy conversion between the two multiplicative inverse fore and aft raft lengths is significant which is dependent on the wave frequency however as for the wave transmission the difference in between is insignificantly small almost independent of the wave frequency the findings demonstrate that for energy conversion its maximum value per unit length corresponds to a large fore and aft length ratio but a small total raft length the combination of experiments and simulations provides reference for both understanding of hydrodynamic behaviours and design including parameter selection of the dissipator keywords wave structure interaction wave energy conversion wave transmission experiment computational fluid dynamics raft length ratio 1 introduction floating breakwater fbw is widely used for dissipating wave energy owing to its advantages of little interference in water circulation good adaptability to poor foundation easy removal and aesthetic acceptability over the traditional bottom founded ones mccartney 1985 most floating breakwaters attenuate ocean waves through reflection of incoming waves and turbulent dissipation dong et al 2008 koutandos et al 2005 another way to dissipate wave energy that has drawn increasing attention is to capture wave energy through a power take off pto or damping system integrated with the fbw chen et al 2016 he et al 2012 ning et al 2018 reabroy et al 2019 zhang et al 2020 zhao et al 2017 the integrated systems help improve the wave attenuation performance chen et al 2016 he et al 2012 ning et al 2018 reabroy et al 2019 zhang et al 2020 zhao et al 2017 the performance of fbw with or without pto has been extensively studied the hydrodynamic interactions of large scale fbw with either regular or irregular waves are examined by koutandos et al 2005 their results indicate by dissipating wave energy during heaving that a single heaving fbw generates lower reflection than a single fixed one dong et al 2008 compare the performances between a double pontoon and a single pontoon fbw of the same total length in wave propagation direction it shows that the former attenuates the wave height more effectively than the latter peña et al 2011 measure the forces and moments acting on the connectors of a pontoon type fbw it is also found that the fbw with two rigidly connected pontoons possesses higher wave energy dissipation efficiency than the single pontoon one however a significant overload in the connectors is observed in the double pontoon layout it should be pointed out that the rigidly connected arrangement can be regarded as a single floater as there is no relative motion in between the overloading is reduced through connection of the two pontoons by joints and use of damping or pto systems between them many physical models are set up to investigate the hydrodynamic of the single floater type of fbw dong et al 2008 koutandos et al 2005 peña et al 2011 however limited experimental studies have been carried out to explore the behavior of a fbw consisting of hinged dual floaters especially if equipped with a damping system at the joint many efforts have also been devoted to the hydrodynamic characteristics of floating bodies acting as a wave energy converter wec inclusive of the dual floater type antonio 2010 lin and zhang 2016 in light of the linearized wave theory haren 1978 presents a 2d analytical approach for a wec consisting of a train of hinged floaters mei and newman 1979 indicated that the optimum wave energy capture efficiency is attained if the raft on the transmission side are much longer than the raft on the incidence side based on 2d linear potential flow theory zheng and zhang 2017b compare the performances of the dual raft type wec with both asymmetric and symmetric raft configurations at the same length the asymmetric configuration improves the power capture capacity and results in an increase in wave transmission in the study of wec behaviors the non linear wave structure interaction and effects of turbulence and wave energy dissipation are disregarded ning et al 2017 zheng and zhang 2017b which are however essential parameters for the fbw performance evaluation of wave transmission chen et al 2016 dong et al 2008 moreover in order to capture effectively wave energy from the side direction the width of dual raft wec in the wave crest direction is mostly smaller than one wave length antonio 2010 the waves behind it cannot be effectively attenuated due to wave diffraction to efficiently attenuate waves behind a fbw its width should be much larger than one wave length in an open sea mccartney 1985 although the performance of wave transmission is mentioned in some studies on dual raft wecs zanuttigh and angelelli 2013 zheng and zhang 2017b there are differences in the hydrodynamic behaviors between the dual floater type fbw and wec further numerical and experimental studies including the effect of turbulence and wave energy dissipation are necessary to reveal the performance of the dual floater fbw integrated with a damping system based on the reynolds averaged navier stokes rans equations chen et al 2016 present a numerical model to examine the performance of a twin raft device integrated with a damping system they demonstrate that the differences in behavior exhibited by an inviscid fluid and a viscous fluid can be large loukogeorgaki et al 2014 assess the structural response of an fbw consisting of floating modules connected with flexible pto connectors in a wave basin they show that the response depends strongly on the incident wave period an asymmetric configuration of single floater devices has drawn increasing attention he et al 2013 investigate experimentally the performance of single floater type fbw with two asymmetric pneumatic chambers a narrower front and a wider rear the efficiency is heightened of wave energy extraction over a wide range of wave frequency based on computational fluid dynamics cfd zhang et al 2020 look into the hydrodynamics of a single heaving floater of both symmetric and asymmetric arrangements the asymmetric floater leads to higher power conversion efficiency and better wave attenuation performance the majority of the work so far however has concentrated on single floater type fbw and well elucidated the fundamental mechanism of how to improve power conversion and wave attenuation performance of single floater type fbw he et al 2013 zhang et al 2020 although the dual floater system is characterized by broad effective frequency range ning et al 2017 little work has concentrated on the dual floater fbw with asymmetric configuration considering the effect of turbulence and wave energy dissipation so far most studies are limited to the dynamic analysis of dual floater type of fbw neither the effect of turbulence and wave energy dissipation nor the pto damping system and asymmetric configuration of the device in the turbulent fluid are considered in this paper an experimental and numerical investigation is carried out to look into the performance of the dual raft fbw integrated with a damping system referred to as a wave energy dissipator wed we limit our attention to a parametric study characterized by a specific damping coefficient for the fbw under investigation both asymmetric and symmetric configurations are considered based on the rans equations a numerical model is set up to simulate the full non linear interaction of wave and wed in which the effects of both turbulence and wave energy dissipation are taken into account the numerical results are then compared with the experimental ones within a wide range of wave period wave energy conversion and wave transmission are examined for different device and fore and aft floater lengths note that yamamoto 1981 and koutandos et al 2005 study the behaviours of fbw and find that the frequency response function of wave transmission coefficient in random waves is similar to that in periodic waves therefore our work is confined to regular waves under which the performance of a wed is explored to understand its basic mechanism the paper is organized as follows in section 2 a dual raft wed with asymmetric configuration is introduced then an experimental setup is described along with a description of measurements of the wed with both asymmetric and symmetric configuration in section 3 a numerical model based on rans equations is presented in section 4 the experimental and numerical results are discussed finally in section 5 conclusions summarizing the major findings are drawn 2 experimental set up the performance of the wed model is built in scale 1 10 and tested in a wave flume at the state key laboratory of hydroscience and engineering tsinghua university beijing the flume is 40 m long 2 5 m wide and 1 5 m high its sidewalls are made of glass plates two parallel piston type generators are installed at one end and wave absorbers at the other as shown in fig 1 and fig 2 consider a hinged dual raft wed with an asymmetric configuration i e the same width combined with unequal lengths of the fore raft and aft raft the width of each raft is less than the width of the wave flume or numerical wave tank which is a common approach in fbw experimental studies he et al 2012 2013 koutandos et al 2005 waves travelling along the longitudinal axis of the model drive the fore and aft rafts to rotate around the hinge as shown in fig 3 the linear dampers at the hinge resist the wave induced relative rotation of the rafts the dampers convert the captured wave energy into internal energy each physical wed model consists of two hinged rafts with linear dampers placed between them figs 1 and 3 the dampers are hydraulically driven a damper s ends are respectively hinged on the holders of the fore and aft rafts they are used to slow down the relative rotation and dissipate the wave energy absorbed by the floaters the length of the fore or aft raft is changed by assembling a different number of rectangular modules each module is 1 0 m long 2 0 m wide and 0 2 m high the draught of each module is 0 1 m table 1 summarizes the geometric parameters of the six wed models designated as model a to f where l f fore raft length l a aft raft length b raft width d raft height d r raft draught l s raft spacing l mx anchor point position in horizontal direction l m0 rope initial length k m rope equivalent stiffness m r rope weight m d damper weight γ d damper damping coefficient l dh distance between damper end and hinge point perpendicular to longitudinal axis of fore raft and l h distance between damper end and hinge point parallel to longitudinal axis of fore raft fig 1 these models are tested separately in the wave flume fig 4 each model is placed 14 m from the wave generators and moored to the bottom of the flume with the help of four identical slack nylon ropes diameter 5 mm length 2 5 m fig 4 the weight of each rope is 0 02 kg m and is negligible the anchor points of two fore ropes and two aft ropes are 1 5 m from the fore raft and the aft raft in horizontal direction respectively i e l mx 1 5 m to protect the sidewalls against collision with the wed a thin steel frame is constructed close to the walls figs 3 and 4 a measurement system is installed consisting of a laser displacement sensor micro epsilon ild1700 with a 12 μm resolution and a wave gauge with an accuracy of 0 1 mm figs 1 and 4 the laser displacement sensor is fixed on the top of the aft raft the wave gauge measuring transmitted wave height h t is placed one wave length behind the wed model to prevent the signal contamination due to locally induced wave fluctuations mansard and funke 1980 prior to the deployment of the wed model in the flume the wave generators are calibrated so that the incident wave parameters measured by the wave gauge placed at its deployment position are the same as the selected ones listed in table 2 where l 0 wave flume length b 0 wave flume width d 0 water depth t incident wave period λ incident wave length and h incident wave height the waves produced by wave generators are exactly the same regardless of the models at the downstream end of the flume wave elimination materials are placed to significantly reduce the wave reflection however it is impossible to fully eliminate the wave reflection the reflected waves are estimated in light of the two point method goda and suzuki 1976 the spectral density of the reflected and incident waves are then compared for t 1 5 2 5 s it is found that the maximum spectral density of the incident waves is 10 100 times as high as that of the reflected ones at the downstream end the wave reflection coefficient calculated with reference to goda and suzuki 1976 ranges from 0 10 to 0 35 in order to reduce the contamination of wave reflections the dynamic responses of the wed are measured within effective time durations calculated from the time when the stable incident waves arrive at the wed to the time when the reflected waves reach the wed they are usually within the range 3t 6t and vary depending on wave periods each of the wed models is tested over a wide range of waves for each test the wave gauge downstream of the wed model measures the transmitted wave height with a 50 hz sampling frequency the wave transmission coefficient c t is given by 1 c t h t h the laser displacement sensor fixed on the top of the aft raft measures the distance l 0 with a sampling rate of 312 5 hz there is a geometric relationship between l 0 and the relative angular displacement θ of the fore and aft rafts 2 l 0 l 1 l 3 tan θ l 2 cos θ where l 1 distance between the hinge point and laser sensor front plane perpendicular to laser light beam l 2 distance between the hinge point and reflection plate and l 3 distance between the hinge point and the laser light beam fig 1 thus the time series of θ at a sampling rate of 312 5 hz is obtained 3 θ arcsin l 2 l 1 l 0 2 l 3 2 arctan l 1 l 0 l 3 the relative angular velocity θ is obtained through the derivative of θ to time the distance between the fore and aft hinge points of each damper l d varies with the rotation of the fore and aft rafts 4 l d 2 l h cos θ 2 l dh sin θ 2 thus the velocity of the piston v p is obtained 5 v p l h sin θ 2 l dh cos θ 2 θ the θ value is small usually below 5 in our layouts thus eq 5 reduces to 6 v p l dh θ the resistance f d provided by the linear dampers is 7 f d γ d v p as the relative rotation of the rafts is small the resistance moment m d is expressed as 8 m d f d l dh γ d v p l dh γ d l dh 2 θ thus there is an equivalent moment damping coefficient γ obtained as γ γ d l dh 2 then m d is described by m d γ θ the average power that the device captures through the damping system is written as 9 p d 1 t t 0 t 0 t m d θ d t 1 t t 0 t 0 t γ θ 2 d t where t 0 time when the power becomes stable the incoming wave power per unit width of the wave front p in is given by mccormick 2009 10 p in ρ l g h 2 8 ω 2 k 1 2 k d 0 sinh 2 k d 0 where ρ l liquid density g acceleration of gravity ω incident wave frequency k wave number then wave energy conversion ratio η is calculated as 11 η p d b p in 100 where b raft width 3 numerical method based on the rans equations a three dimensional numerical wave tank is set up the hydrodynamics of the wed is formulated in a cartesian coordinate system x y z with its origin at the mean water level the x and y axes are parallel with the length and width direction of the flume and the z axis is in the vertical direction fig 2 for a hinged dual raft wed the rafts are modelled as rigid bodies three dimensional water flow around the wed is simulated owing to symmetry it is assumed that each raft heaves in the z direction and pitches around the hinge in the y direction rolling yawing and swaying of the rafts are neglected the fluid motion is solved using ansys fluent a commercial finite volume method package the governing equations are presented in the following the dynamic equations of the hinged floaters are developed based on lagrange formulation the structure motion equations are solved by user defined code which was compiled in fluent 3 1 fluid motion the finite volume method is used to discrete the continuity equation and the rans equations for incompressible viscous flows the integral form of the conservation equation for mass is 12 d d t c v ρ d v a n ρ v v b d a 0 and the integral form of the conservation equation for momentum is 13 d d t c v ρ v d v a n ρ v v v b d a a n t p i d a c v ρ s d v where cv is control volume a is surface of the control volume t is time n is the local unit normal vector to the surface ρ is fluid density v is fluid velocity v b is velocity of surface element da p is fluid pressure i is the unit tensor s is the body force such as gravity and t is the viscous part of the stress tensor for incompressible newtonian fluids considered in rans equation defined as 14 t μ μ t v v t where μ is dynamic viscosity of fluid μ t is turbulent viscosity computed by a turbulence model of eddy viscosity type sst k ω as a function of turbulence kinetic energy k and specific rate of dissipation ω menter et al 2003 the pressure field is coupled to the velocity field by the piso method issa 1986 the conserved scalar quantities k and ω are written as 15 d d t c v ρ ϕ d v a n ρ ϕ v v b d a a n γ ϕ d a c v ρ s ϕ d v where ϕ is conserved scalar quantities e g k and ω γ is diffusion coefficient and s ϕ is volumetric source of ϕ detailed in menter et al 2003 the liquid gas interface is tracked by the volume of fluid vof model hirt and nichols 1981 which assumes that the two phases in a control volume share velocity and pressure therefore the same set of governing eq 12 15 are solved for an equivalent fluid whose physical properties are calculated as functions of the physical properties of its constituent phases and their volume fractions 16 ρ α ρ l 1 α ρ g 17 μ α μ l 1 α μ g where α is volume fraction of liquid equal to 1 00 if fully filled by liquid and to 0 if fully occupied by gas ρ g is gas density and μ l and μ g are liquid and gas dynamic viscosities the transport of volume fractions α is described by the conservation equation 18 d d t c v α d v a n α v v b d a 0 3 2 structure motion the motion of the dual raft wed is analyzed in a global cartesian coordinate system the forces are illustrated in fig 5 where f i f i x 0 f i z t is hydrodynamic force vector acting on the i th raft i 1 2 represent the fore and aft rafts f i x and f i z are components of f i in the x and z directions m i 0 m i 0 t is hydrodynamic moment vector acting on the i th raft with respect to the raft center m i is component of m i in the y direction m f i 0 m f i 0 t is linear damping moment vector acting on the i th raft m f i is component of m f i in the y direction f m f m cos θ m 0 f m sin θ m t is mooring force vector f m is the mooring force value θ m is the angle between the mooring line and the x axis r h r x 0 r z t is the position vector of the hinge r x and r z are the components of r h in the x and z directions θ i 0 θ i 0 t is the angular vector of the i th raft and θ i is the component of θ i in the y direction f i and m i at the n th time step is given as follows hadžić et al 2005 19 f i n s i n t p i d s 20 m i n s i r s n r i n t p i n d s where superscript n denotes the n th time step s i is the surface of the i th raft r s is the position vector of the point on the local raft surface expressed in global coordinate system and r i is the position vector of the center of mass of the i th raft at the n th time step m f i is given as 21 m f i n γ θ 1 n θ 2 n where θ 1 and θ 2 are the angular velocity vectors of the fore and aft rafts respectively the mooring rope is modelled as a spring at the n th time step f m is given as 22 f m n k m l m n l m0 l m l m0 0 0 l m l m0 0 where l m length of the mooring rope k m l m0 are the same as the ones listed in table 1 according to the lagrange formulation the equation for motion of the hinged rafts is given as huo 2013 liu et al 2015 23 a x b where 24 a m 1 m 2 0 l f l s 2 m 1 sin θ 1 l a l s 2 m 2 sin θ 2 0 m 1 m 2 l f l s 2 m 1 cos θ 1 l a l s 2 m 2 cos θ 2 l f l s 2 m 1 sin θ 1 l f l s 2 m 1 cos θ 1 1 4 m 1 l f l s 2 j 1 0 l a l s 2 m 2 sin θ 2 l a l s 2 m 2 cos θ 2 0 1 4 m 2 l a l s 2 j 2 25 x r x r z θ 1 θ 2 t 26 b f 1 x f 2 x l f l s 2 m 1 θ 1 2 cos θ 1 l a l s 2 m 2 θ 2 2 cos θ 2 f m cos θ m f 1 z f 2 z l f l s 2 m 1 θ 1 2 sin θ 1 l a l s 2 m 2 θ 2 2 sin θ 2 m 1 g m 2 g f m sin θ m m 1 m f 1 f 1 x l f l s 2 sin θ 1 f 1 z l f l s 2 cos θ 1 m m l f l s 2 m 1 g cos θ 1 m 2 m f 2 f 2 x l a l s 2 sin θ 2 f 2 z l a l s 2 cos θ 2 l a l s 2 m 2 g cos θ 2 where m i is mass of the i th raft j i is the moment of inertia of the i th raft in the y direction m m is the moment of mooring force acting on the fore raft r x and r z are the accelerations of the hinge point in the x and z directions θ 1 and θ 2 are the angular accelerations of the fore and aft rafts r x and r z are the velocities of the hinge point in the x and z directions and θ 1 and θ 2 are the angular velocities of the fore and aft rafts thus r x r z θ 1 θ 2 r x r z θ 1 and θ 2 are described as follows 27 y j f j t y 1 y 2 y 3 y 4 y 5 y 6 y 7 y 8 where j 1 2 8 y 1 r x y 2 r z y 3 θ 1 y 4 θ 2 y 5 r x y 6 r z y 7 θ 1 y 8 θ 2 define y y 1 y 2 y 3 y 4 y 5 y 6 y 7 y 8 t eq 27 is rewritten as 28 y f t y upon applying the runge kutta rk method to eq 29 y at the n 1 th time step is obtained 29 y n 1 y n δ t 6 k 1 2 k 2 2 k 3 k 4 30 t n 1 t n δ t where 31 k 1 f t n y n 32 k 2 f t n δ t 2 y n δ t 2 k 1 33 k 3 f t n δ t 2 y n δ t 2 k 2 34 k 4 f t n δ t y n δ t k 3 where δ t is time step of the simulation 3 3 boundary conditions the motion of the dual raft dissipator and fluid are fully coupled through velocities and pressures normal to the fluid structure interface restrictions are added so that the fluid particles adhere to the fluid structure interface 35 v s n v n on s 36 f s n f f n 0 on s where s is fluid structure interface v s is velocity vector of the raft on the fluid structure interface f s is vector of traction acting on the raft on the fluid structure interface and f f is vector of stresses exerted on the fluid on the fluid structure interface v s is determined from the motion of the raft and the relative position of the point of interest 37 v s n v i n θ i n r s n r i n along with wave elevation water particle velocities are specified at the inlet boundary see fig 6 based on the fifth order stokes wave fenton 1985 38 v 1 n c 0 g k 3 1 2 i 1 5 ε i j 1 i j k a i j cosh j k z cos j k x c t n c v 1 v 2 n 0 v 3 n c 0 g k 3 1 2 i 1 5 ε i j 1 i j k a i j sinh j k z sin j k x c t n where v 1 v 2 and v 3 are flow velocities in the x y and z directions respectively c is wave speed v 1 is mean horizontal fluid flow velocity and ε is the dimensionless wave height ε k h 2 details descriptions of v 1 c 0 and a i j are referred to fenton 1985 at the velocity inlet boundary k and ω are estimated by k 1 5 u avg i 2 and ω k 1 2 c u l where u avg mean flow velocity i turbulence intensity c u empirical constant and l turbulence length scale i c u and l are calculated in light of fluent user s guide chapter 6 the outlet boundary is specified as hydrostatic pressure see fig 6 p out ρ g z in order to suppress the numerical reflection caused by the outlet boundary a momentum damping term s d is added in z direction momentum equation eq 13 for the cells in its immediate vicinity the s d is given in park and kim 1998 as 39 s d β x x s x e x s 2 z b z z b z fs v z where β a parameter to be controlled initially set as 10 or larger if the wave is not dissipated enough in the numerical beach zone x s and x e start and end points of the added dissipation zone in the x direction z b and z fs bottom and free surface positions of the damping zone in the z direction and v z fluid velocity in the z direction as also used by elhanafi et al 2017a a damping zone of length 2λ is found to be sufficient for damping waves consider e g a wave of t 2 0 s and h 0 10 m its maximum spectral density of the incident wave is 1000 times as large as that of the reflected wave the reflection coefficient is 0 02 calculated with reference to goda and suzuki 1976 thus the wave reflection is negligibly small with the damping zone 3 4 numerical setting and algorithm a numerical wave model nwm is set up with the following specifications the length of the computational domain under investigation is 14λ including a 2λ long damping zone at the end and its width is 1 25b the wed device is placed 6λ from the velocity inlet boundary see fig 6 the domain includes a 5d height both under and above the mean wave surface at least 16 and 50 cells per wave height and wavelength are generated the cell size in the y direction δy is four times the cell size in the x direction δx close to the recommendation by elhanafi et al 2017b δx increases gradually from 1 50λ to 1 10λ in damping zone see fig 6b to help dissipate waves agamloh et al 2008 the mesh size in the z direction δz increases from 1 16h to h outside the free surface zone to reduce mesh number without reducing simulation accuracy elhanafi et al 2017b mesh convergence is checked and approximately one million elements are sufficient to provide reliable results of η and c t a fixed time step 1 1000 of the wave period is used to simulate regular water waves the numerical model takes 400 s cpu time per time step the cfd set up is summarized in table 3 chen et al 2017 elhanafi et al 2017a b windt et al 2018 the fluid motion equations are calculated using ansys fluent the wed motion equations are solved by a self developed program with c programming language compiled into the fluent solver through a user defined functions udfs there are three udfs named as udf update udf force and udf motion respectively the algorithm schematic is shown in fig 7 udf update uses define cg motion macro fluent customization manual chapter 2 to specify the motion of the hinged floaters by providing fluent with the velocities i e r x r z θ 1 θ 2 at the beginning of each time step then the moving structure surface s i is updated using the dynamic mesh of diffusion based smoothing fluent user s guide chapter 10 see fig 6c appling the new structure surface boundaries the fluid motion is solved by pressure based segregated solver the piso method issa 1986 is applied to couple the pressure and velocity fields during the iterations in fluent the udf force executes once every iteration to obtain p t n from the solver then to calculate f i and m i determined by eqs 19 and 20 udf motion executes once each time step to solve the structure motion by using eq 29 if the termination criterion is not satisfied the solution is transferred to the next time step by udf update thus the interaction of the structure and fluid is achieved 4 results and discussion the following dimensionless parameters are introduced 40 θ 1 k h 0 θ l f l f h 0 l a l a h 0 γ g d 0 ρ g h 0 3 l f l a b γ where θ dimensionless relative rotation of the rafts h 0 reference wave height 0 10 m l f dimensionless length of the fore raft l a dimensionless length of the aft raft and γ dimensionless damping coefficient of the damping system it should be pointed out that since the effect of damping coefficient on the performance of the wed has been studied comprehensively in the previous study chen et al 2016 a specific dimensionless damping coefficient γ 181 85 which is the optimized result of the wed for l f 20 l a 20 kd 0 1 530 and h d 0 5 is directly used in the following multi parameter study more damping coefficient should be studied to obtain the optimum design of the wed which is beyond the scope of this article 4 1 effect of wave parameter the physical wed model of l f 20 l a 20 is tested over a range of k l f l a for γ 181 85 fig 8 shows the variations of η and c t with k l f l a for h d 0 4 0 5 and 0 6 η and c t are defined as eqs 11 and 1 respectively it is seen that η increases with an increasing k l f l a and then decreases after reaching a maximum value 35 7 at h d 0 4 27 0 at h d 0 5 and 22 8 at h d 0 6 which all occur at k l f l a 6 12 the peak η decreases significantly as h d increases which is due to the non linear interaction of the wed and water for h d 0 4 0 5 and 0 6 c t decreases as k l f l a increases and for the same k l f l a c t decreases slightly as h d decreases in order to investigate the non linear effects it is necessary to compare the experimental results of η and c t with k l f l a with the results obtained by using a linear analytical model zheng and zhang 2017a a second order model hedberg and saccullo 2014 and the present numerical model respectively fig 9 shows the comparison of the experimental results of η and c t with k l f l a with the above mentioned three theoretical results the relative difference in η between the experiment and analysis results features a monotonically increasing curve as a function of k l f l a ranging from 6 7 to 126 1 average is 60 9 the linear analytical model severely overestimates η probably due to neglect of non linear effects whereas the 2nd order model also overestimates η but the average relative difference is reduced to 46 6 compared with the experiment due to the non linear effect of second order wave force and drift force hedberg and saccullo 2014 the present numerical model takes into account the non linear terms such as turbulence term and viscous dissipation term and its results are in good agreement with the experimental results the relative difference in c t between the experimental and theoretical results exhibits a monotonically increasing trend with k l f l a ranging from 1 1 to 47 7 average is 12 7 the linear analytical model underestimates c t probably due to the overestimate of η which indicates that more wave energy is estimated to be captured by the wed and less transmitted to the back of the wed it can be seen from fig 9b that the results of c t obtained by using the present numerical model are compared with the experimental ones the average relative difference is less than 3 to understand the non linear interaction of the wave and the wed fig 10 shows an instantanoeus velocity vector y vorticity and specific turbulence dissipation rate distribution at l f 20 and l a 20 the specific dissipation rate ω is obtained by eq 15 large vorticity and ω values are obvious around the upper corner of the fore raft which implies that high turbulent dissipation occurs due to the non linear interaction of head wave with the fore raft 4 2 effect of wave parameter and length ratio as the non linear hydrodynamic behaviours of the fore and aft rafts exhibit significant differences experiment is conducted to investigate the performance of the wed with the same total length but different length ratio for the physical wed models with the same total length l f l a 40 but three different length ratio l f l a 1 3 1 and 3 the variations of η and c t with k l f l a are shown in fig 11 the tests are made at γ 181 85 and h d 0 4 0 5 and 0 6 it can be seen from fig 11a that η at l f l a 1 is larger than at l f l a 1 3 or 3 and η at l f l a 1 3 is larger than at l f l a 3 the difference in η among l f l a 1 3 1 and 3 increases with k l f l a and then decreases after reaching a maximum value thus for examined dual raft weds with the same total length η with a symmetric arrangement of two rafts is larger than the one with an asymmetric one η at a short fore raft length is larger than at a long one this is presumably due to the fact that it is easier for the waves to transmit through a short fore raft a large exciting force acts on the aft raft increases the relative rotation and absorbs more wave energy fig 11b shows that the c t k l f l a curves for l f l a 1 1 3 and 3 almost overlap each other this implies that for the dual raft wed models with the same total length c t is almost independent of the fore and aft raft length ratio the wed models with the same total length l f l a 30 but two different length ratios l f l a 1 2 and 2 are also tested similar results are obtained at the same l f l a but different l f l a values fig 12 shows the variations of η and c t with k l f l a the tests are made at γ 181 85 and h 0 8 1 0 and 1 2 it is seen from fig 12a that η at l f l a 1 2 is larger than at l f l a 2 the difference varies with k l f l a and tends to increase after k l f l a 4 21 at l f l a 1 2 and 2 the curves of c t k l f l a shown in fig 12b are almost identical thus the results at l f l a 1 3 1 2 2 and 3 show that there exists obvious difference in η among the four l f l a combinations such differences vary considerably depending on k l f l a it is also revealed that the difference in c t is insignificantly small and is almost independent of k l f l a 4 3 effect of raft length and length ratio corresponding to the maximum energy conversion an optimal length ratio or optimal total length should exist however this is difficult to obtain in the experiments despite that fact that six physical models are tested more tests are also limited by time and funds contrary to the physical tests numerical simulations are easier to provide insight into the relations among the characteristic dimensions wave transmission and energy conversion an optimal wed configuration should have high wave energy conversion two parameters which influence the performance are raft length and fore and aft raft length ratio to illustrate their influences on η and c t a wide range of raft length and length ratio is examined fig 13 shows for γ 181 85 and h d 0 5 kd 0 1 530 the contour maps of η and c t with l f l a and l f l a it is seen from fig 13a that for a given l f l a η ascends with an increasing l f l a and reaches the maximum before descending the variation of η with l f l a exhibits at a specific l f l a a similar trend for a given total length l f l a there always exists an optimal l f l a which corresponds to a maximum η η max it is also seen from fig 13a that for a specific l f l a η at l f l a 1 is larger than the one for its multiplicative inverse length ratio this means that for a wed with unequal lengths of two rafts the fore raft should be shorter so as to obtain a larger η this is also evidenced in the experimental results see figs 11a and 12a fig 13b shows that the larger l f l a is the smaller c t becomes for a given l f l a c t changes little with l f l a which is also observed in the experiments see figs 11b and 12b l f l a plays a major role in c t while the influence of l f l a on c t is small at various raft lengths and length ratios the comparisons of η and c t between numerical simulations and the experiments are also given in fig 13 in which subscripts num and exp denote numerical and experimental results respectively it is seen that the former predicts a slightly larger η than the latter this is supposedly due to the fact the dampers used in the experiments exhibit a trait of non linear damping which leads to absorption of less wave energy than the linear dampers applied in the numerical simulations zheng et al 2015 it is worth pointing out that η max is 73 4 among the examined cases corresponding to an optimal length l f l a opt 79 i e l f l a opt λ 1 92 and an optimal length ratio l f l a opt 0 33 further analysis is necessary to judge whether a dissipator with η max is the most cost effective the energy conversion ratio per unit length χ is defined as χ η l f l a it is assumed that the larger χ is the less cost effective the wed becomes fig 14 shows the variation of χ with l f l a and l f l a it is obvious that for a given l f l a χ increases with an increasing l f l a and reaches the maximum before declining a similar trend of the χ variation with l f l a is observed there always exist an optimal l f l a and an optimal l f l a that lead to χ max it is found that χ max occurs at l f l a 0 53 and l f l a 60 which corresponds l f l a opt λ 1 46 it is revealed that the optimal length and optimal length ratio corresponding to η max are different from those corresponding to χ max to show the difference between them a comparison is made the relative difference is defined as 41 e ζ χ max ζ η max ζ η max in which ζ is one of variables l f l a opt l f l a opt η or χ ζ χ max and ζ η max corresponds to χ max and η max respectively the comparisons are summarized in table 4 the optimal l f l a opt corresponding to χ max and η max are 0 53 and 0 33 respectively while the optimal l f l a opt corresponding to χ max and η max are 60 0 and 79 0 respectively l f l a opt for χ max is 60 6 larger than that for η max l f l a opt for χ max is 24 1 smaller than that for η max for η at its maximum viz η max 73 4 χ is 0 93 for χ at its maximum viz χ max 1 06 η is 63 6 thus η for χ max is 13 4 smaller than that for η max χ for χ max is 14 0 larger than that for η max both weds damp the incident wave height by over 55 viz c t is below 0 45 see fig 13b 5 conclusions laboratory models of a dual raft wed with both asymmetric and symmetric configurations are built in a large wave flume featuring different combinations of geometric dimensions based upon the rans equations in fluent and self programming a numerical model is set up to deal with the fully non linear fluid structure interplay between the waves and the wed models the effects of turbulence wave energy dissipation and mechanical damping are included in both physical and numerical modeling the dynamic behaviours in terms of parameters including wave energy conversion and wave transmission are explored comparisons are made between them and the agreement is good the validated numerical model is then adopted to examine the performance of more combinations of raft and fore and aft raft lengths from the investigations the following conclusions can be drawn 1 the wave energy conversion ratio η increases with an increasing k l f l a and reaches a maximum before decreasing the wave transmission coefficient c t decreases with an increasing k l f l a in the examined cases the non linear effects are significant that on average the linear analytical model overestimates η by 60 9 and underestimates c t by 12 7 2 for a given total raft length the difference in energy conversion ratio between the two multiplicative inverse fore and aft raft length ratios is significant which is dependent on k l f l a whereas the difference in wave transmission coefficient between them is insignificantly small almost independent of k l f l a 3 for a specific total raft length l f l a there is an optimal fore and aft raft length ratio l f l a opt which corresponds to the maximum wave energy conversion ratio η max the larger l f l a is the smaller l f l a opt becomes 4 the total raft length plays a major role in c t whereas the influence of fore and aft raft length ratio on c t is insignificant 5 the optimal total length corresponding to the maximum energy conversion ratio per unit length is 1 46λ and the fore to aft raft length ratio is 0 53 whereas the optimal total length corresponding to the total maximum energy conversion ratio is 1 92λ and the fore to aft raft length ratio is 0 33 6 the optimal length ratio l f l a opt for χ max is 60 6 larger than that for η max whereas l f l a opt for χ max is 24 1 smaller than that for η max with η at its maximum viz η max 73 4 the corresponding energy conversion ratio per unit length χ is 0 93 with χ at its maximum viz χ max 1 06 the corresponding η is 63 6 η for χ max is 13 4 smaller than that for η max whereas χ for χ max is 14 0 larger than that for η max future work will extend by analyzing wave reflection turbulence dissipation by the wed and considering even the effects of irregular waves on its performance credit authorship contribution statement wenchuang chen conceptualization methodology software validation formal analysis investigation data curation writing original draft writing review editing visualization yongliang zhang conceptualization methodology validation formal analysis investigation writing review editing supervision project administration funding acquisition james yang writing review editing huifeng yu data curation sendong liang resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported by the national natural science foundation of china grant no 51679124 51879144 state key laboratory of hydroscience and engineering grant no 2020 ky 02 and tsinghua national laboratory for information science and technology nomenclature b raft width b 0 wave flume width c t wave transmission coefficient c wave speed c u empirical constant for calculating ω d raft height d 0 water depth d r raft draught e relative difference in ζ χ max and ζ η max f m mooring force value f m mooring force vector f i x hydrodynamic force acting on the i th raft in the x direction f i z hydrodynamic force acting on the i th raft in the z direction f f vector of stresses exerted on the fluid on the fluid structure interface f i hydrodynamic force vector acting on the i th raft f s vector of traction acting on the raft on the fluid structure interface f d resistance on piston g acceleration of gravity h incident wave height h dimensionless wave height h 0 reference wave height h t transmitted wave height i turbulence intensity i unit tensor j i moment of inertia of the i th raft in the y direction k wave number k turbulent kinetic energy k m rope stiffness l 0 wave flume length l a aft raft length l a dimensionless length of the aft raft l f fore raft length l f dimensionless length of the fore raft l f l a opt optimal fore and aft raft length ratio corresponding to χ max or η max l f l a opt optimal total length corresponding to χ max or η max l turbulence length scale l 0 laser distance l 1 distances between the hinge point and laser sensor front plane perpendicular to laser light beam l 2 distances between the hinge point and reflection plate l 3 distances between the hinge point and the laser light beam l d length of the linear damper l dh distance between damper end and hinge point perpendicular to longitudinal axis of foreraft l h distance between damper end and hinge point parallel to longitudinal axis of fore raft l m length of the mooring rope l m0 initial length of the mooring rope l mx anchor point position l s raft spacing m d resistance moment provided by damping system m f i linear damping moment acting on the i th raft in the y direction m i hydrodynamic moment acting on the i th raft with respect to the raft center in the y direction m m moment of mooring force acting on the fore raft m f i linear damping moment vector acting on the i th raft m i hydrodynamic moment vector acting on the i th raft with respect to the raft center m d damper weight m r mooring rope weight p d average power captured by the wed device through the damping system p in incoming wave power per unit width of the wave front p fluid pressure r x position of the hinge in the x direction r x velocity of the hinge point in the x direction r x acceleration of the hinge point in the x direction r z position of the hinge in the z direction r z velocity of the hinge point in the z direction r z acceleration of the hinge point in the z direction r h position vector of the hinge r s position vector of the point on the raft surface r i position vector of the center of mass of the i th raft s i surface of the i th raft s body force such as gravity s d momentum damping term t viscous part of the stress tensor t wave period u avg mean flow velocity v fluid velocity v b velocity vector of the surface element da v i velocity vector of the center of the i th raft v s velocity vector of the raft on the fluid structure interface v z fluid velocity in the z direction v p velocity of the piston x e start point of the added dissipation zone in the x direction x s end point of the added dissipation zone in the x direction z b bottom position of the damping zone in the z direction z fs free surface position of the damping zone in the z direction α volume fraction of liquid γ equivalent moment damping coefficient of damper γ dimensionless damping coefficient γ d damper damping coefficient ε dimensionless wave height in calculating fifth order stokes wave ε k h 2 θ relative angular displacement θ dimensionless relative rotation of the rafts θ i angular of the i th raft in the y th direction θ i angular velocity of the i th raft θ i angular acceleration of the i th raft θ m angle between the mooring line and the x axis θ relative angular velocity θ i angular vector of the i th raft θ i angular velocity vector of the i th raft λ wave length μ dynamic viscosity of the fluid μ g gas dynamic viscosity μ l liquid dynamic viscosity μ t turbulent viscosity ρ fluid density ρ g gas density ρ l liquid density ζ η max variables corresponding to η max ζ χ max variables corresponding to χ max η wave energy conversion ratio η 0 wave surface elevation χ energy conversion ratio per unit length г diffusion coefficient ω specific dissipation rate ω wave frequency δ t time step of the simulation δx mesh size in x direction δy mesh size in y direction δz mesh size in z direction 
20343,a wave energy dissipator wed is proposed in this paper composed of two asymmetric hinged floaters and two hydraulic cylinders with the purpose to resist wave induced relative rotation around the hinge experimental studies are performed to explore its performance under a wide range of regular waves based on reynolds averaged navier stokes equations a 3d numerical model is set up considering the non linear interaction of wave and wed the agreement between the experimental and numerical results is good with the validated numerical model the influence of the wed geometrical factors on energy conversion and wave transmission is examined for a given raft length the difference in energy conversion between the two multiplicative inverse fore and aft raft lengths is significant which is dependent on the wave frequency however as for the wave transmission the difference in between is insignificantly small almost independent of the wave frequency the findings demonstrate that for energy conversion its maximum value per unit length corresponds to a large fore and aft length ratio but a small total raft length the combination of experiments and simulations provides reference for both understanding of hydrodynamic behaviours and design including parameter selection of the dissipator keywords wave structure interaction wave energy conversion wave transmission experiment computational fluid dynamics raft length ratio 1 introduction floating breakwater fbw is widely used for dissipating wave energy owing to its advantages of little interference in water circulation good adaptability to poor foundation easy removal and aesthetic acceptability over the traditional bottom founded ones mccartney 1985 most floating breakwaters attenuate ocean waves through reflection of incoming waves and turbulent dissipation dong et al 2008 koutandos et al 2005 another way to dissipate wave energy that has drawn increasing attention is to capture wave energy through a power take off pto or damping system integrated with the fbw chen et al 2016 he et al 2012 ning et al 2018 reabroy et al 2019 zhang et al 2020 zhao et al 2017 the integrated systems help improve the wave attenuation performance chen et al 2016 he et al 2012 ning et al 2018 reabroy et al 2019 zhang et al 2020 zhao et al 2017 the performance of fbw with or without pto has been extensively studied the hydrodynamic interactions of large scale fbw with either regular or irregular waves are examined by koutandos et al 2005 their results indicate by dissipating wave energy during heaving that a single heaving fbw generates lower reflection than a single fixed one dong et al 2008 compare the performances between a double pontoon and a single pontoon fbw of the same total length in wave propagation direction it shows that the former attenuates the wave height more effectively than the latter peña et al 2011 measure the forces and moments acting on the connectors of a pontoon type fbw it is also found that the fbw with two rigidly connected pontoons possesses higher wave energy dissipation efficiency than the single pontoon one however a significant overload in the connectors is observed in the double pontoon layout it should be pointed out that the rigidly connected arrangement can be regarded as a single floater as there is no relative motion in between the overloading is reduced through connection of the two pontoons by joints and use of damping or pto systems between them many physical models are set up to investigate the hydrodynamic of the single floater type of fbw dong et al 2008 koutandos et al 2005 peña et al 2011 however limited experimental studies have been carried out to explore the behavior of a fbw consisting of hinged dual floaters especially if equipped with a damping system at the joint many efforts have also been devoted to the hydrodynamic characteristics of floating bodies acting as a wave energy converter wec inclusive of the dual floater type antonio 2010 lin and zhang 2016 in light of the linearized wave theory haren 1978 presents a 2d analytical approach for a wec consisting of a train of hinged floaters mei and newman 1979 indicated that the optimum wave energy capture efficiency is attained if the raft on the transmission side are much longer than the raft on the incidence side based on 2d linear potential flow theory zheng and zhang 2017b compare the performances of the dual raft type wec with both asymmetric and symmetric raft configurations at the same length the asymmetric configuration improves the power capture capacity and results in an increase in wave transmission in the study of wec behaviors the non linear wave structure interaction and effects of turbulence and wave energy dissipation are disregarded ning et al 2017 zheng and zhang 2017b which are however essential parameters for the fbw performance evaluation of wave transmission chen et al 2016 dong et al 2008 moreover in order to capture effectively wave energy from the side direction the width of dual raft wec in the wave crest direction is mostly smaller than one wave length antonio 2010 the waves behind it cannot be effectively attenuated due to wave diffraction to efficiently attenuate waves behind a fbw its width should be much larger than one wave length in an open sea mccartney 1985 although the performance of wave transmission is mentioned in some studies on dual raft wecs zanuttigh and angelelli 2013 zheng and zhang 2017b there are differences in the hydrodynamic behaviors between the dual floater type fbw and wec further numerical and experimental studies including the effect of turbulence and wave energy dissipation are necessary to reveal the performance of the dual floater fbw integrated with a damping system based on the reynolds averaged navier stokes rans equations chen et al 2016 present a numerical model to examine the performance of a twin raft device integrated with a damping system they demonstrate that the differences in behavior exhibited by an inviscid fluid and a viscous fluid can be large loukogeorgaki et al 2014 assess the structural response of an fbw consisting of floating modules connected with flexible pto connectors in a wave basin they show that the response depends strongly on the incident wave period an asymmetric configuration of single floater devices has drawn increasing attention he et al 2013 investigate experimentally the performance of single floater type fbw with two asymmetric pneumatic chambers a narrower front and a wider rear the efficiency is heightened of wave energy extraction over a wide range of wave frequency based on computational fluid dynamics cfd zhang et al 2020 look into the hydrodynamics of a single heaving floater of both symmetric and asymmetric arrangements the asymmetric floater leads to higher power conversion efficiency and better wave attenuation performance the majority of the work so far however has concentrated on single floater type fbw and well elucidated the fundamental mechanism of how to improve power conversion and wave attenuation performance of single floater type fbw he et al 2013 zhang et al 2020 although the dual floater system is characterized by broad effective frequency range ning et al 2017 little work has concentrated on the dual floater fbw with asymmetric configuration considering the effect of turbulence and wave energy dissipation so far most studies are limited to the dynamic analysis of dual floater type of fbw neither the effect of turbulence and wave energy dissipation nor the pto damping system and asymmetric configuration of the device in the turbulent fluid are considered in this paper an experimental and numerical investigation is carried out to look into the performance of the dual raft fbw integrated with a damping system referred to as a wave energy dissipator wed we limit our attention to a parametric study characterized by a specific damping coefficient for the fbw under investigation both asymmetric and symmetric configurations are considered based on the rans equations a numerical model is set up to simulate the full non linear interaction of wave and wed in which the effects of both turbulence and wave energy dissipation are taken into account the numerical results are then compared with the experimental ones within a wide range of wave period wave energy conversion and wave transmission are examined for different device and fore and aft floater lengths note that yamamoto 1981 and koutandos et al 2005 study the behaviours of fbw and find that the frequency response function of wave transmission coefficient in random waves is similar to that in periodic waves therefore our work is confined to regular waves under which the performance of a wed is explored to understand its basic mechanism the paper is organized as follows in section 2 a dual raft wed with asymmetric configuration is introduced then an experimental setup is described along with a description of measurements of the wed with both asymmetric and symmetric configuration in section 3 a numerical model based on rans equations is presented in section 4 the experimental and numerical results are discussed finally in section 5 conclusions summarizing the major findings are drawn 2 experimental set up the performance of the wed model is built in scale 1 10 and tested in a wave flume at the state key laboratory of hydroscience and engineering tsinghua university beijing the flume is 40 m long 2 5 m wide and 1 5 m high its sidewalls are made of glass plates two parallel piston type generators are installed at one end and wave absorbers at the other as shown in fig 1 and fig 2 consider a hinged dual raft wed with an asymmetric configuration i e the same width combined with unequal lengths of the fore raft and aft raft the width of each raft is less than the width of the wave flume or numerical wave tank which is a common approach in fbw experimental studies he et al 2012 2013 koutandos et al 2005 waves travelling along the longitudinal axis of the model drive the fore and aft rafts to rotate around the hinge as shown in fig 3 the linear dampers at the hinge resist the wave induced relative rotation of the rafts the dampers convert the captured wave energy into internal energy each physical wed model consists of two hinged rafts with linear dampers placed between them figs 1 and 3 the dampers are hydraulically driven a damper s ends are respectively hinged on the holders of the fore and aft rafts they are used to slow down the relative rotation and dissipate the wave energy absorbed by the floaters the length of the fore or aft raft is changed by assembling a different number of rectangular modules each module is 1 0 m long 2 0 m wide and 0 2 m high the draught of each module is 0 1 m table 1 summarizes the geometric parameters of the six wed models designated as model a to f where l f fore raft length l a aft raft length b raft width d raft height d r raft draught l s raft spacing l mx anchor point position in horizontal direction l m0 rope initial length k m rope equivalent stiffness m r rope weight m d damper weight γ d damper damping coefficient l dh distance between damper end and hinge point perpendicular to longitudinal axis of fore raft and l h distance between damper end and hinge point parallel to longitudinal axis of fore raft fig 1 these models are tested separately in the wave flume fig 4 each model is placed 14 m from the wave generators and moored to the bottom of the flume with the help of four identical slack nylon ropes diameter 5 mm length 2 5 m fig 4 the weight of each rope is 0 02 kg m and is negligible the anchor points of two fore ropes and two aft ropes are 1 5 m from the fore raft and the aft raft in horizontal direction respectively i e l mx 1 5 m to protect the sidewalls against collision with the wed a thin steel frame is constructed close to the walls figs 3 and 4 a measurement system is installed consisting of a laser displacement sensor micro epsilon ild1700 with a 12 μm resolution and a wave gauge with an accuracy of 0 1 mm figs 1 and 4 the laser displacement sensor is fixed on the top of the aft raft the wave gauge measuring transmitted wave height h t is placed one wave length behind the wed model to prevent the signal contamination due to locally induced wave fluctuations mansard and funke 1980 prior to the deployment of the wed model in the flume the wave generators are calibrated so that the incident wave parameters measured by the wave gauge placed at its deployment position are the same as the selected ones listed in table 2 where l 0 wave flume length b 0 wave flume width d 0 water depth t incident wave period λ incident wave length and h incident wave height the waves produced by wave generators are exactly the same regardless of the models at the downstream end of the flume wave elimination materials are placed to significantly reduce the wave reflection however it is impossible to fully eliminate the wave reflection the reflected waves are estimated in light of the two point method goda and suzuki 1976 the spectral density of the reflected and incident waves are then compared for t 1 5 2 5 s it is found that the maximum spectral density of the incident waves is 10 100 times as high as that of the reflected ones at the downstream end the wave reflection coefficient calculated with reference to goda and suzuki 1976 ranges from 0 10 to 0 35 in order to reduce the contamination of wave reflections the dynamic responses of the wed are measured within effective time durations calculated from the time when the stable incident waves arrive at the wed to the time when the reflected waves reach the wed they are usually within the range 3t 6t and vary depending on wave periods each of the wed models is tested over a wide range of waves for each test the wave gauge downstream of the wed model measures the transmitted wave height with a 50 hz sampling frequency the wave transmission coefficient c t is given by 1 c t h t h the laser displacement sensor fixed on the top of the aft raft measures the distance l 0 with a sampling rate of 312 5 hz there is a geometric relationship between l 0 and the relative angular displacement θ of the fore and aft rafts 2 l 0 l 1 l 3 tan θ l 2 cos θ where l 1 distance between the hinge point and laser sensor front plane perpendicular to laser light beam l 2 distance between the hinge point and reflection plate and l 3 distance between the hinge point and the laser light beam fig 1 thus the time series of θ at a sampling rate of 312 5 hz is obtained 3 θ arcsin l 2 l 1 l 0 2 l 3 2 arctan l 1 l 0 l 3 the relative angular velocity θ is obtained through the derivative of θ to time the distance between the fore and aft hinge points of each damper l d varies with the rotation of the fore and aft rafts 4 l d 2 l h cos θ 2 l dh sin θ 2 thus the velocity of the piston v p is obtained 5 v p l h sin θ 2 l dh cos θ 2 θ the θ value is small usually below 5 in our layouts thus eq 5 reduces to 6 v p l dh θ the resistance f d provided by the linear dampers is 7 f d γ d v p as the relative rotation of the rafts is small the resistance moment m d is expressed as 8 m d f d l dh γ d v p l dh γ d l dh 2 θ thus there is an equivalent moment damping coefficient γ obtained as γ γ d l dh 2 then m d is described by m d γ θ the average power that the device captures through the damping system is written as 9 p d 1 t t 0 t 0 t m d θ d t 1 t t 0 t 0 t γ θ 2 d t where t 0 time when the power becomes stable the incoming wave power per unit width of the wave front p in is given by mccormick 2009 10 p in ρ l g h 2 8 ω 2 k 1 2 k d 0 sinh 2 k d 0 where ρ l liquid density g acceleration of gravity ω incident wave frequency k wave number then wave energy conversion ratio η is calculated as 11 η p d b p in 100 where b raft width 3 numerical method based on the rans equations a three dimensional numerical wave tank is set up the hydrodynamics of the wed is formulated in a cartesian coordinate system x y z with its origin at the mean water level the x and y axes are parallel with the length and width direction of the flume and the z axis is in the vertical direction fig 2 for a hinged dual raft wed the rafts are modelled as rigid bodies three dimensional water flow around the wed is simulated owing to symmetry it is assumed that each raft heaves in the z direction and pitches around the hinge in the y direction rolling yawing and swaying of the rafts are neglected the fluid motion is solved using ansys fluent a commercial finite volume method package the governing equations are presented in the following the dynamic equations of the hinged floaters are developed based on lagrange formulation the structure motion equations are solved by user defined code which was compiled in fluent 3 1 fluid motion the finite volume method is used to discrete the continuity equation and the rans equations for incompressible viscous flows the integral form of the conservation equation for mass is 12 d d t c v ρ d v a n ρ v v b d a 0 and the integral form of the conservation equation for momentum is 13 d d t c v ρ v d v a n ρ v v v b d a a n t p i d a c v ρ s d v where cv is control volume a is surface of the control volume t is time n is the local unit normal vector to the surface ρ is fluid density v is fluid velocity v b is velocity of surface element da p is fluid pressure i is the unit tensor s is the body force such as gravity and t is the viscous part of the stress tensor for incompressible newtonian fluids considered in rans equation defined as 14 t μ μ t v v t where μ is dynamic viscosity of fluid μ t is turbulent viscosity computed by a turbulence model of eddy viscosity type sst k ω as a function of turbulence kinetic energy k and specific rate of dissipation ω menter et al 2003 the pressure field is coupled to the velocity field by the piso method issa 1986 the conserved scalar quantities k and ω are written as 15 d d t c v ρ ϕ d v a n ρ ϕ v v b d a a n γ ϕ d a c v ρ s ϕ d v where ϕ is conserved scalar quantities e g k and ω γ is diffusion coefficient and s ϕ is volumetric source of ϕ detailed in menter et al 2003 the liquid gas interface is tracked by the volume of fluid vof model hirt and nichols 1981 which assumes that the two phases in a control volume share velocity and pressure therefore the same set of governing eq 12 15 are solved for an equivalent fluid whose physical properties are calculated as functions of the physical properties of its constituent phases and their volume fractions 16 ρ α ρ l 1 α ρ g 17 μ α μ l 1 α μ g where α is volume fraction of liquid equal to 1 00 if fully filled by liquid and to 0 if fully occupied by gas ρ g is gas density and μ l and μ g are liquid and gas dynamic viscosities the transport of volume fractions α is described by the conservation equation 18 d d t c v α d v a n α v v b d a 0 3 2 structure motion the motion of the dual raft wed is analyzed in a global cartesian coordinate system the forces are illustrated in fig 5 where f i f i x 0 f i z t is hydrodynamic force vector acting on the i th raft i 1 2 represent the fore and aft rafts f i x and f i z are components of f i in the x and z directions m i 0 m i 0 t is hydrodynamic moment vector acting on the i th raft with respect to the raft center m i is component of m i in the y direction m f i 0 m f i 0 t is linear damping moment vector acting on the i th raft m f i is component of m f i in the y direction f m f m cos θ m 0 f m sin θ m t is mooring force vector f m is the mooring force value θ m is the angle between the mooring line and the x axis r h r x 0 r z t is the position vector of the hinge r x and r z are the components of r h in the x and z directions θ i 0 θ i 0 t is the angular vector of the i th raft and θ i is the component of θ i in the y direction f i and m i at the n th time step is given as follows hadžić et al 2005 19 f i n s i n t p i d s 20 m i n s i r s n r i n t p i n d s where superscript n denotes the n th time step s i is the surface of the i th raft r s is the position vector of the point on the local raft surface expressed in global coordinate system and r i is the position vector of the center of mass of the i th raft at the n th time step m f i is given as 21 m f i n γ θ 1 n θ 2 n where θ 1 and θ 2 are the angular velocity vectors of the fore and aft rafts respectively the mooring rope is modelled as a spring at the n th time step f m is given as 22 f m n k m l m n l m0 l m l m0 0 0 l m l m0 0 where l m length of the mooring rope k m l m0 are the same as the ones listed in table 1 according to the lagrange formulation the equation for motion of the hinged rafts is given as huo 2013 liu et al 2015 23 a x b where 24 a m 1 m 2 0 l f l s 2 m 1 sin θ 1 l a l s 2 m 2 sin θ 2 0 m 1 m 2 l f l s 2 m 1 cos θ 1 l a l s 2 m 2 cos θ 2 l f l s 2 m 1 sin θ 1 l f l s 2 m 1 cos θ 1 1 4 m 1 l f l s 2 j 1 0 l a l s 2 m 2 sin θ 2 l a l s 2 m 2 cos θ 2 0 1 4 m 2 l a l s 2 j 2 25 x r x r z θ 1 θ 2 t 26 b f 1 x f 2 x l f l s 2 m 1 θ 1 2 cos θ 1 l a l s 2 m 2 θ 2 2 cos θ 2 f m cos θ m f 1 z f 2 z l f l s 2 m 1 θ 1 2 sin θ 1 l a l s 2 m 2 θ 2 2 sin θ 2 m 1 g m 2 g f m sin θ m m 1 m f 1 f 1 x l f l s 2 sin θ 1 f 1 z l f l s 2 cos θ 1 m m l f l s 2 m 1 g cos θ 1 m 2 m f 2 f 2 x l a l s 2 sin θ 2 f 2 z l a l s 2 cos θ 2 l a l s 2 m 2 g cos θ 2 where m i is mass of the i th raft j i is the moment of inertia of the i th raft in the y direction m m is the moment of mooring force acting on the fore raft r x and r z are the accelerations of the hinge point in the x and z directions θ 1 and θ 2 are the angular accelerations of the fore and aft rafts r x and r z are the velocities of the hinge point in the x and z directions and θ 1 and θ 2 are the angular velocities of the fore and aft rafts thus r x r z θ 1 θ 2 r x r z θ 1 and θ 2 are described as follows 27 y j f j t y 1 y 2 y 3 y 4 y 5 y 6 y 7 y 8 where j 1 2 8 y 1 r x y 2 r z y 3 θ 1 y 4 θ 2 y 5 r x y 6 r z y 7 θ 1 y 8 θ 2 define y y 1 y 2 y 3 y 4 y 5 y 6 y 7 y 8 t eq 27 is rewritten as 28 y f t y upon applying the runge kutta rk method to eq 29 y at the n 1 th time step is obtained 29 y n 1 y n δ t 6 k 1 2 k 2 2 k 3 k 4 30 t n 1 t n δ t where 31 k 1 f t n y n 32 k 2 f t n δ t 2 y n δ t 2 k 1 33 k 3 f t n δ t 2 y n δ t 2 k 2 34 k 4 f t n δ t y n δ t k 3 where δ t is time step of the simulation 3 3 boundary conditions the motion of the dual raft dissipator and fluid are fully coupled through velocities and pressures normal to the fluid structure interface restrictions are added so that the fluid particles adhere to the fluid structure interface 35 v s n v n on s 36 f s n f f n 0 on s where s is fluid structure interface v s is velocity vector of the raft on the fluid structure interface f s is vector of traction acting on the raft on the fluid structure interface and f f is vector of stresses exerted on the fluid on the fluid structure interface v s is determined from the motion of the raft and the relative position of the point of interest 37 v s n v i n θ i n r s n r i n along with wave elevation water particle velocities are specified at the inlet boundary see fig 6 based on the fifth order stokes wave fenton 1985 38 v 1 n c 0 g k 3 1 2 i 1 5 ε i j 1 i j k a i j cosh j k z cos j k x c t n c v 1 v 2 n 0 v 3 n c 0 g k 3 1 2 i 1 5 ε i j 1 i j k a i j sinh j k z sin j k x c t n where v 1 v 2 and v 3 are flow velocities in the x y and z directions respectively c is wave speed v 1 is mean horizontal fluid flow velocity and ε is the dimensionless wave height ε k h 2 details descriptions of v 1 c 0 and a i j are referred to fenton 1985 at the velocity inlet boundary k and ω are estimated by k 1 5 u avg i 2 and ω k 1 2 c u l where u avg mean flow velocity i turbulence intensity c u empirical constant and l turbulence length scale i c u and l are calculated in light of fluent user s guide chapter 6 the outlet boundary is specified as hydrostatic pressure see fig 6 p out ρ g z in order to suppress the numerical reflection caused by the outlet boundary a momentum damping term s d is added in z direction momentum equation eq 13 for the cells in its immediate vicinity the s d is given in park and kim 1998 as 39 s d β x x s x e x s 2 z b z z b z fs v z where β a parameter to be controlled initially set as 10 or larger if the wave is not dissipated enough in the numerical beach zone x s and x e start and end points of the added dissipation zone in the x direction z b and z fs bottom and free surface positions of the damping zone in the z direction and v z fluid velocity in the z direction as also used by elhanafi et al 2017a a damping zone of length 2λ is found to be sufficient for damping waves consider e g a wave of t 2 0 s and h 0 10 m its maximum spectral density of the incident wave is 1000 times as large as that of the reflected wave the reflection coefficient is 0 02 calculated with reference to goda and suzuki 1976 thus the wave reflection is negligibly small with the damping zone 3 4 numerical setting and algorithm a numerical wave model nwm is set up with the following specifications the length of the computational domain under investigation is 14λ including a 2λ long damping zone at the end and its width is 1 25b the wed device is placed 6λ from the velocity inlet boundary see fig 6 the domain includes a 5d height both under and above the mean wave surface at least 16 and 50 cells per wave height and wavelength are generated the cell size in the y direction δy is four times the cell size in the x direction δx close to the recommendation by elhanafi et al 2017b δx increases gradually from 1 50λ to 1 10λ in damping zone see fig 6b to help dissipate waves agamloh et al 2008 the mesh size in the z direction δz increases from 1 16h to h outside the free surface zone to reduce mesh number without reducing simulation accuracy elhanafi et al 2017b mesh convergence is checked and approximately one million elements are sufficient to provide reliable results of η and c t a fixed time step 1 1000 of the wave period is used to simulate regular water waves the numerical model takes 400 s cpu time per time step the cfd set up is summarized in table 3 chen et al 2017 elhanafi et al 2017a b windt et al 2018 the fluid motion equations are calculated using ansys fluent the wed motion equations are solved by a self developed program with c programming language compiled into the fluent solver through a user defined functions udfs there are three udfs named as udf update udf force and udf motion respectively the algorithm schematic is shown in fig 7 udf update uses define cg motion macro fluent customization manual chapter 2 to specify the motion of the hinged floaters by providing fluent with the velocities i e r x r z θ 1 θ 2 at the beginning of each time step then the moving structure surface s i is updated using the dynamic mesh of diffusion based smoothing fluent user s guide chapter 10 see fig 6c appling the new structure surface boundaries the fluid motion is solved by pressure based segregated solver the piso method issa 1986 is applied to couple the pressure and velocity fields during the iterations in fluent the udf force executes once every iteration to obtain p t n from the solver then to calculate f i and m i determined by eqs 19 and 20 udf motion executes once each time step to solve the structure motion by using eq 29 if the termination criterion is not satisfied the solution is transferred to the next time step by udf update thus the interaction of the structure and fluid is achieved 4 results and discussion the following dimensionless parameters are introduced 40 θ 1 k h 0 θ l f l f h 0 l a l a h 0 γ g d 0 ρ g h 0 3 l f l a b γ where θ dimensionless relative rotation of the rafts h 0 reference wave height 0 10 m l f dimensionless length of the fore raft l a dimensionless length of the aft raft and γ dimensionless damping coefficient of the damping system it should be pointed out that since the effect of damping coefficient on the performance of the wed has been studied comprehensively in the previous study chen et al 2016 a specific dimensionless damping coefficient γ 181 85 which is the optimized result of the wed for l f 20 l a 20 kd 0 1 530 and h d 0 5 is directly used in the following multi parameter study more damping coefficient should be studied to obtain the optimum design of the wed which is beyond the scope of this article 4 1 effect of wave parameter the physical wed model of l f 20 l a 20 is tested over a range of k l f l a for γ 181 85 fig 8 shows the variations of η and c t with k l f l a for h d 0 4 0 5 and 0 6 η and c t are defined as eqs 11 and 1 respectively it is seen that η increases with an increasing k l f l a and then decreases after reaching a maximum value 35 7 at h d 0 4 27 0 at h d 0 5 and 22 8 at h d 0 6 which all occur at k l f l a 6 12 the peak η decreases significantly as h d increases which is due to the non linear interaction of the wed and water for h d 0 4 0 5 and 0 6 c t decreases as k l f l a increases and for the same k l f l a c t decreases slightly as h d decreases in order to investigate the non linear effects it is necessary to compare the experimental results of η and c t with k l f l a with the results obtained by using a linear analytical model zheng and zhang 2017a a second order model hedberg and saccullo 2014 and the present numerical model respectively fig 9 shows the comparison of the experimental results of η and c t with k l f l a with the above mentioned three theoretical results the relative difference in η between the experiment and analysis results features a monotonically increasing curve as a function of k l f l a ranging from 6 7 to 126 1 average is 60 9 the linear analytical model severely overestimates η probably due to neglect of non linear effects whereas the 2nd order model also overestimates η but the average relative difference is reduced to 46 6 compared with the experiment due to the non linear effect of second order wave force and drift force hedberg and saccullo 2014 the present numerical model takes into account the non linear terms such as turbulence term and viscous dissipation term and its results are in good agreement with the experimental results the relative difference in c t between the experimental and theoretical results exhibits a monotonically increasing trend with k l f l a ranging from 1 1 to 47 7 average is 12 7 the linear analytical model underestimates c t probably due to the overestimate of η which indicates that more wave energy is estimated to be captured by the wed and less transmitted to the back of the wed it can be seen from fig 9b that the results of c t obtained by using the present numerical model are compared with the experimental ones the average relative difference is less than 3 to understand the non linear interaction of the wave and the wed fig 10 shows an instantanoeus velocity vector y vorticity and specific turbulence dissipation rate distribution at l f 20 and l a 20 the specific dissipation rate ω is obtained by eq 15 large vorticity and ω values are obvious around the upper corner of the fore raft which implies that high turbulent dissipation occurs due to the non linear interaction of head wave with the fore raft 4 2 effect of wave parameter and length ratio as the non linear hydrodynamic behaviours of the fore and aft rafts exhibit significant differences experiment is conducted to investigate the performance of the wed with the same total length but different length ratio for the physical wed models with the same total length l f l a 40 but three different length ratio l f l a 1 3 1 and 3 the variations of η and c t with k l f l a are shown in fig 11 the tests are made at γ 181 85 and h d 0 4 0 5 and 0 6 it can be seen from fig 11a that η at l f l a 1 is larger than at l f l a 1 3 or 3 and η at l f l a 1 3 is larger than at l f l a 3 the difference in η among l f l a 1 3 1 and 3 increases with k l f l a and then decreases after reaching a maximum value thus for examined dual raft weds with the same total length η with a symmetric arrangement of two rafts is larger than the one with an asymmetric one η at a short fore raft length is larger than at a long one this is presumably due to the fact that it is easier for the waves to transmit through a short fore raft a large exciting force acts on the aft raft increases the relative rotation and absorbs more wave energy fig 11b shows that the c t k l f l a curves for l f l a 1 1 3 and 3 almost overlap each other this implies that for the dual raft wed models with the same total length c t is almost independent of the fore and aft raft length ratio the wed models with the same total length l f l a 30 but two different length ratios l f l a 1 2 and 2 are also tested similar results are obtained at the same l f l a but different l f l a values fig 12 shows the variations of η and c t with k l f l a the tests are made at γ 181 85 and h 0 8 1 0 and 1 2 it is seen from fig 12a that η at l f l a 1 2 is larger than at l f l a 2 the difference varies with k l f l a and tends to increase after k l f l a 4 21 at l f l a 1 2 and 2 the curves of c t k l f l a shown in fig 12b are almost identical thus the results at l f l a 1 3 1 2 2 and 3 show that there exists obvious difference in η among the four l f l a combinations such differences vary considerably depending on k l f l a it is also revealed that the difference in c t is insignificantly small and is almost independent of k l f l a 4 3 effect of raft length and length ratio corresponding to the maximum energy conversion an optimal length ratio or optimal total length should exist however this is difficult to obtain in the experiments despite that fact that six physical models are tested more tests are also limited by time and funds contrary to the physical tests numerical simulations are easier to provide insight into the relations among the characteristic dimensions wave transmission and energy conversion an optimal wed configuration should have high wave energy conversion two parameters which influence the performance are raft length and fore and aft raft length ratio to illustrate their influences on η and c t a wide range of raft length and length ratio is examined fig 13 shows for γ 181 85 and h d 0 5 kd 0 1 530 the contour maps of η and c t with l f l a and l f l a it is seen from fig 13a that for a given l f l a η ascends with an increasing l f l a and reaches the maximum before descending the variation of η with l f l a exhibits at a specific l f l a a similar trend for a given total length l f l a there always exists an optimal l f l a which corresponds to a maximum η η max it is also seen from fig 13a that for a specific l f l a η at l f l a 1 is larger than the one for its multiplicative inverse length ratio this means that for a wed with unequal lengths of two rafts the fore raft should be shorter so as to obtain a larger η this is also evidenced in the experimental results see figs 11a and 12a fig 13b shows that the larger l f l a is the smaller c t becomes for a given l f l a c t changes little with l f l a which is also observed in the experiments see figs 11b and 12b l f l a plays a major role in c t while the influence of l f l a on c t is small at various raft lengths and length ratios the comparisons of η and c t between numerical simulations and the experiments are also given in fig 13 in which subscripts num and exp denote numerical and experimental results respectively it is seen that the former predicts a slightly larger η than the latter this is supposedly due to the fact the dampers used in the experiments exhibit a trait of non linear damping which leads to absorption of less wave energy than the linear dampers applied in the numerical simulations zheng et al 2015 it is worth pointing out that η max is 73 4 among the examined cases corresponding to an optimal length l f l a opt 79 i e l f l a opt λ 1 92 and an optimal length ratio l f l a opt 0 33 further analysis is necessary to judge whether a dissipator with η max is the most cost effective the energy conversion ratio per unit length χ is defined as χ η l f l a it is assumed that the larger χ is the less cost effective the wed becomes fig 14 shows the variation of χ with l f l a and l f l a it is obvious that for a given l f l a χ increases with an increasing l f l a and reaches the maximum before declining a similar trend of the χ variation with l f l a is observed there always exist an optimal l f l a and an optimal l f l a that lead to χ max it is found that χ max occurs at l f l a 0 53 and l f l a 60 which corresponds l f l a opt λ 1 46 it is revealed that the optimal length and optimal length ratio corresponding to η max are different from those corresponding to χ max to show the difference between them a comparison is made the relative difference is defined as 41 e ζ χ max ζ η max ζ η max in which ζ is one of variables l f l a opt l f l a opt η or χ ζ χ max and ζ η max corresponds to χ max and η max respectively the comparisons are summarized in table 4 the optimal l f l a opt corresponding to χ max and η max are 0 53 and 0 33 respectively while the optimal l f l a opt corresponding to χ max and η max are 60 0 and 79 0 respectively l f l a opt for χ max is 60 6 larger than that for η max l f l a opt for χ max is 24 1 smaller than that for η max for η at its maximum viz η max 73 4 χ is 0 93 for χ at its maximum viz χ max 1 06 η is 63 6 thus η for χ max is 13 4 smaller than that for η max χ for χ max is 14 0 larger than that for η max both weds damp the incident wave height by over 55 viz c t is below 0 45 see fig 13b 5 conclusions laboratory models of a dual raft wed with both asymmetric and symmetric configurations are built in a large wave flume featuring different combinations of geometric dimensions based upon the rans equations in fluent and self programming a numerical model is set up to deal with the fully non linear fluid structure interplay between the waves and the wed models the effects of turbulence wave energy dissipation and mechanical damping are included in both physical and numerical modeling the dynamic behaviours in terms of parameters including wave energy conversion and wave transmission are explored comparisons are made between them and the agreement is good the validated numerical model is then adopted to examine the performance of more combinations of raft and fore and aft raft lengths from the investigations the following conclusions can be drawn 1 the wave energy conversion ratio η increases with an increasing k l f l a and reaches a maximum before decreasing the wave transmission coefficient c t decreases with an increasing k l f l a in the examined cases the non linear effects are significant that on average the linear analytical model overestimates η by 60 9 and underestimates c t by 12 7 2 for a given total raft length the difference in energy conversion ratio between the two multiplicative inverse fore and aft raft length ratios is significant which is dependent on k l f l a whereas the difference in wave transmission coefficient between them is insignificantly small almost independent of k l f l a 3 for a specific total raft length l f l a there is an optimal fore and aft raft length ratio l f l a opt which corresponds to the maximum wave energy conversion ratio η max the larger l f l a is the smaller l f l a opt becomes 4 the total raft length plays a major role in c t whereas the influence of fore and aft raft length ratio on c t is insignificant 5 the optimal total length corresponding to the maximum energy conversion ratio per unit length is 1 46λ and the fore to aft raft length ratio is 0 53 whereas the optimal total length corresponding to the total maximum energy conversion ratio is 1 92λ and the fore to aft raft length ratio is 0 33 6 the optimal length ratio l f l a opt for χ max is 60 6 larger than that for η max whereas l f l a opt for χ max is 24 1 smaller than that for η max with η at its maximum viz η max 73 4 the corresponding energy conversion ratio per unit length χ is 0 93 with χ at its maximum viz χ max 1 06 the corresponding η is 63 6 η for χ max is 13 4 smaller than that for η max whereas χ for χ max is 14 0 larger than that for η max future work will extend by analyzing wave reflection turbulence dissipation by the wed and considering even the effects of irregular waves on its performance credit authorship contribution statement wenchuang chen conceptualization methodology software validation formal analysis investigation data curation writing original draft writing review editing visualization yongliang zhang conceptualization methodology validation formal analysis investigation writing review editing supervision project administration funding acquisition james yang writing review editing huifeng yu data curation sendong liang resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported by the national natural science foundation of china grant no 51679124 51879144 state key laboratory of hydroscience and engineering grant no 2020 ky 02 and tsinghua national laboratory for information science and technology nomenclature b raft width b 0 wave flume width c t wave transmission coefficient c wave speed c u empirical constant for calculating ω d raft height d 0 water depth d r raft draught e relative difference in ζ χ max and ζ η max f m mooring force value f m mooring force vector f i x hydrodynamic force acting on the i th raft in the x direction f i z hydrodynamic force acting on the i th raft in the z direction f f vector of stresses exerted on the fluid on the fluid structure interface f i hydrodynamic force vector acting on the i th raft f s vector of traction acting on the raft on the fluid structure interface f d resistance on piston g acceleration of gravity h incident wave height h dimensionless wave height h 0 reference wave height h t transmitted wave height i turbulence intensity i unit tensor j i moment of inertia of the i th raft in the y direction k wave number k turbulent kinetic energy k m rope stiffness l 0 wave flume length l a aft raft length l a dimensionless length of the aft raft l f fore raft length l f dimensionless length of the fore raft l f l a opt optimal fore and aft raft length ratio corresponding to χ max or η max l f l a opt optimal total length corresponding to χ max or η max l turbulence length scale l 0 laser distance l 1 distances between the hinge point and laser sensor front plane perpendicular to laser light beam l 2 distances between the hinge point and reflection plate l 3 distances between the hinge point and the laser light beam l d length of the linear damper l dh distance between damper end and hinge point perpendicular to longitudinal axis of foreraft l h distance between damper end and hinge point parallel to longitudinal axis of fore raft l m length of the mooring rope l m0 initial length of the mooring rope l mx anchor point position l s raft spacing m d resistance moment provided by damping system m f i linear damping moment acting on the i th raft in the y direction m i hydrodynamic moment acting on the i th raft with respect to the raft center in the y direction m m moment of mooring force acting on the fore raft m f i linear damping moment vector acting on the i th raft m i hydrodynamic moment vector acting on the i th raft with respect to the raft center m d damper weight m r mooring rope weight p d average power captured by the wed device through the damping system p in incoming wave power per unit width of the wave front p fluid pressure r x position of the hinge in the x direction r x velocity of the hinge point in the x direction r x acceleration of the hinge point in the x direction r z position of the hinge in the z direction r z velocity of the hinge point in the z direction r z acceleration of the hinge point in the z direction r h position vector of the hinge r s position vector of the point on the raft surface r i position vector of the center of mass of the i th raft s i surface of the i th raft s body force such as gravity s d momentum damping term t viscous part of the stress tensor t wave period u avg mean flow velocity v fluid velocity v b velocity vector of the surface element da v i velocity vector of the center of the i th raft v s velocity vector of the raft on the fluid structure interface v z fluid velocity in the z direction v p velocity of the piston x e start point of the added dissipation zone in the x direction x s end point of the added dissipation zone in the x direction z b bottom position of the damping zone in the z direction z fs free surface position of the damping zone in the z direction α volume fraction of liquid γ equivalent moment damping coefficient of damper γ dimensionless damping coefficient γ d damper damping coefficient ε dimensionless wave height in calculating fifth order stokes wave ε k h 2 θ relative angular displacement θ dimensionless relative rotation of the rafts θ i angular of the i th raft in the y th direction θ i angular velocity of the i th raft θ i angular acceleration of the i th raft θ m angle between the mooring line and the x axis θ relative angular velocity θ i angular vector of the i th raft θ i angular velocity vector of the i th raft λ wave length μ dynamic viscosity of the fluid μ g gas dynamic viscosity μ l liquid dynamic viscosity μ t turbulent viscosity ρ fluid density ρ g gas density ρ l liquid density ζ η max variables corresponding to η max ζ χ max variables corresponding to χ max η wave energy conversion ratio η 0 wave surface elevation χ energy conversion ratio per unit length г diffusion coefficient ω specific dissipation rate ω wave frequency δ t time step of the simulation δx mesh size in x direction δy mesh size in y direction δz mesh size in z direction 
20344,quadrotor auv is a new and promising vehicle in applications due to its special advantages however the problem of dynamic modeling of quadrotor auv has not been investigated yet in this study a new dynamic modeling method for a quadrotor auv is proposed by using a novel cfd simulation to calculate the hydrodynamic coefficients star ccm is used to simulate the uniform and variable motion of each degree of freedom of a quadrotor auv to decouple original high coupling dynamic model through the simulation of the auv and the propeller motion the main hydrodynamic coefficients are calculated while the mathematical relationship between the rotation velocity and the thrust torque is concluded specifically the static mesh and dynamic mesh models are used to simulate the uniform and variable motion of the quadrotor auv respectively the calculation of added mass and drag coefficient does not interfere with each other leading to accurate results a numerical method is also proposed to separate the linear and nonlinear parts of the total drag coefficients then a six dof dynamic model of a quadrotor auv is established the proposed cfd simulation also provides a reliable repeatable and low cost method for dynamic modeling of underwater vehicles keywords quadrotor auv hydrodynamic coefficients cfd dynamic model 1 introduction autonomous underwater vehicle auv a kind of robot for hazardous underwater environments can be used for submarine investigation communication network layout and other functions and has high application value zereik et al 2018 sahoo et al 2019 during the past few decades the development of material science manufacturing technology sensor technology and novel batteries made possible multifunctional intelligent auvs various types of auvs continue to emerge and have attracted the attention of modern scientific research and manufacturing fields the design of new concept underwater vehicles has become the current research focus quadrotor auv is a new type of underwater vehicles whose mechanical structure and dynamic principle is similar to the quadrotor uav unmanned aerial vehicle and has recently been widely concerned by researchers ahmed 2015 raharja et al 2015 ranganathan et al 2015 the advantages of the quadrotor auv can be summarized as firstly the quadrotor system is used to replace the traditional rudder propulsion system which greatly simplifies the design and gives the vehicle the ability to hover for a long time and rotate in place secondly due to its small size and simple structure the auv can move flexibly while keeping low cost last by adding or modifying the propeller propulsion this type of auv may become a cross domain vehicle drews jr et al 2014 alzu bi et al 2015 mercado ravell et al 2018 mercado ravell et al 2019 it is well known that the dynamic models of auvs are non linear strong coupling time varying and multiple input multiple output mimo systems and cover all the hydrodynamic loads these hydrodynamic loads are usually not constant in time they are functions of speed acceleration and auvs size expressed in the form of hydrodynamic coefficients multiplied by speed or acceleration as shown in table 1 the hydrodynamic coefficients of auv can be divided into two parts the added mass coefficients and the drag coefficients which respectively reflect the dynamic characteristics of auv in the acceleration and uniform motion fossen 2002 inaccurate hydrodynamic coefficients will lead to the failure of the dynamic model and affect the performance of control system according to the existing literature there are three common methods to calculate hydrodynamic coefficients as follows analytical and semi empirical ase in this research area jones et al 2002 and de barros et al 2008 presented several main analytical methods and their applications which covered a few of auvs with general shapes cardenas and de barros 2019 proposed an analytical method combined with the estimator based on an extended kalman filter which further increases the feasibility and accuracy ase is essentially a kind of microelement method including strip theory st and equivalent ellipsoid method eem which treat auv as a finite number of transverse two dimensional slices and ellipsoids respectively the advantage of this method is low cost and does not need professional experimental instruments but the obtained hydrodynamic coefficients are inevitably lower than the actual value due to the neglect of viscosity experimental fluid dynamics efd in the present study in the field park et al 2017 javanmard and mansoorzadeh 2019 and avila et al 2012 used various experimental methods such as towing tank and planar motion mechanism pmm to estimate hydrodynamic coefficients by controlling the uniform and variable motion in each dof the hydrodynamic load is applied to the auv in the terms of data processing park et al 2017 used least squares curve fitting and surface fitting while avila et al 2012 applied system identification si to analyze the experimental results efd method takes full account of the viscous term and the detail interference of auv s shape and perhaps it is the most reliable method to obtain hydrodynamic coefficients on the other hand the expensive special equipment is needed to test the uniform and variable motion of auv and the experiment process is cumbersome and time consuming computational fluid dynamics cfd there are two kinds of cfd methods the first one is based on potential flow assumption including the panel method pm and the boundary element method bem tyagi and sen 2006 and go and ahn 2019 used a cfd solver to study the motion of some typical auvs and proposed that the cfd method could be used to determine the hydrodynamic coefficients under different conditions in fact similar to the ase method this method does not consider the viscosity of fluid either and requires the designer to have the professional knowledge of fluid mechanics the second one is the cfd software which simulates the motion of auv in the flow field in the computer thus the calculation process can refer to efd method theoretically the cfd software can simulate motion in various dof of the vehicle under water or other media and measure both the kinematic and dynamic parameters compared with ase and efd method the cfd software can greatly simplify the preparatory work and reduce economic costs in the research of this field phillips et al 2010 proposed a package of cfd simulations which are used to measure the hydrodynamic forces of auv javanmard et al 2020 used the cfd software to calculate the added mass coefficients of an underwater vehicle the calculation results of this method may not be as accurate as those of efd method despite of this cfd software is still a time saving and cost effective tool the cfd software used in this research is star ccm of siemens which is based on finite element mesh dividing and has been applied to the hydrodynamic research of various underwater vehicles compared with other similar software star ccm has a more friendly interface more powerful meshing function simplified workflow and low learning costs for users its advantages are as follows 1 highly integrated star ccm is a software integrating geometry processing mesh generation solver and post processing other software products such as cfx its mesh generation module preprocessing module and solving module are independent which need to be opened separately resulting in long operation time 2 surface wrapping star ccm s surface wrapping can process complex geometry into a completely topologically closed leakless surface which can greatly reduce the time of mesh generation 3 overset mesh in star ccm overset mesh setting and simulation are more efficient and convenient because this technology has been used in star ccm for a long time it is more mature and accurate in the aspect of structure design yang et al 2019 used star ccm to study the performance of wave glider s propulsion system and analyzed the optimal propulsion force under different hydrofoils arrangements matveev and morabito 2020 simulated the forces acting on the vehicle s planing surfaces to verify the influence of deadrise angles on hydrodynamic characteristics while in the aspect of propeller hydrodynamic analysis bhattacharyya et al 2016 used star ccm to investigate the scale effects on the open water characteristics of a 4 bladed propeller yilmaz et al 2019 studied the tip vortex cavitation of a propeller and proposed a new and efficient mesh adaptation and refinement approach to cavitation simulation marcs according to the existing literature the research works generally focus on the design or optimization in a partial structure rather than a complete vehicle such as propeller or planing surfaces and only uses the static mesh for the cfd software simulation which may be not suitable for the simulation of variable motion a new cfd simulation scheme combining static and dynamic mesh is proposed in this study which can simulate both the uniform and variable motion of a quadrotor auv in six dof and the rotation of a single propeller although javanmard et al 2020 tried to calculate the added mass coefficients of auv in translational motion he did not further simulate the rotational motion or calculate the drag coefficients to the best of author s knowledge it is the first time to use star ccm to build the complete dynamic model of a quadrotor auv fig 1 shows the main scheme in establishing the model in which b and d are parameters related to the propeller dynamics the static and dynamic mesh models for the uniform and variable motion simulation are constructed respectively multiple groups of dynamic data are recorded in different motion environments processed by the curve and surface fitting to obtain the hydrodynamic coefficients respectively then by substituting these parameters into the dynamic equation a complete six dof model can be given the main contributions of this paper are summarized as follows 1 a six dof dynamic model of a quadrotor auv is established for the first time through the simulation of both the auv and the propeller motion the main hydrodynamic coefficients are calculated while the mathematical relationship between the rotation velocity and the thrust torque is concluded the underwater motion characteristics of the quadrotor auv including the relevance between the shape and dynamic characteristics are revealed 2 a novel mesh configuration method for star ccm simulation is proposed the static mesh and dynamic mesh model are used to simulate the uniform and variable motion of the quadrotor auv respectively thus the calculation of added mass and drag coefficients does not interfere with each other leading to accurate calculation results 3 a numerical method is proposed to separate the linear and nonlinear parts of the total drag coefficients according to the motion equation of single dof the curve fitting is used to calculate the drag coefficients in translational motion while the surface fitting is used to obtain the hydrodynamic coefficients in rotational motion the rest arrangement of this paper is demonstrated as follows section 2 introduces the kinematics and dynamics equations of the auv and explains the significance of each parameter section 3 analyzes the feasibility and simulates the motion of auv and propeller section 4 gives the conclusion to summarize the advantages of the scheme and the future works 2 model fig 2 shows the haizhe auv designed in the authors laboratory the auv is mainly composed of a spherical cabin radius γ 0 1125 m and four propellers the two hemispherical shells of the cabin are connected by flanges the rotor thrusters are installed on the four cantilevers of the flange and the control circuits are placed in the center of the cabin the actuating inputs are generated by four propellers producing the desired thrust and torque the propeller arrangement adopts the x shaped structure motor1 and motor3 rotate clockwise while motor2 and motor4 rotate anticlockwise fig 3 the attitude and motion of the auv can be controlled by adjusting the rotation speed of each propeller because the auv is nearly symmetrical in three coordinate planes the corresponding products of inertia can be assumed to be zero 2 1 kinematics equations for the convenience of hydrodynamics analysis two reference frames are introduced i e the body fixed coordinate frame and the earth fixed coordinate frame as shown in fig 3 the z axis of the body fixed coordinate system and the other one point vertically upward and to the sky respectively the body fixed coordinate frame is a moving coordinate frame which is fixed to the auv the linear and angular velocities of the auv are expressed in the system and the origin is chosen to coincide with the center of buoyancy the earth fixed coordinate frame on the other hand has its origin fixed to a specific point in space and the motion and location of the auv are described in the system table 2 shows the force torque linear angular velocity and position euler angle of the auv in six dof we introduce the following vectors defined as 1 η 1 x y z η 2 ϕ θ ψ η η 1 η 2 v 1 u v w v 2 p q r v v 1 v 2 f 1 x y z f 2 k m n f f 1 f 2 where η is the position and euler angle vector v is the velocity vector and f is the input vector the kinematics equations of the auv can be expressed as 2 η 1 η 2 r 1 η 2 0 3 3 0 3 3 r 2 η 2 v 1 v 2 in which the conversion equations of the linear velocity and angular velocity are given as follows where s sin c cos and t tan 3 η 1 r 1 η 2 v 1 r 1 η 2 c ψ c θ c ψ s θ s ϕ s ψ c ϕ s ψ s ϕ c ψ c ϕ s θ s ψ c θ c ψ c ϕ s ψ s θ s ϕ s θ s ψ c ϕ c ψ s ϕ s θ c θ s ϕ c θ c ϕ η 2 r 2 η 2 v 2 r 2 η 2 1 s ϕ t θ c ϕ t θ 0 c ϕ s ϕ 0 s ϕ c θ c ϕ c θ 2 2 dynamics equations without considering the environmental interference the overall dynamic equation of the auv can be presented as below fossen 2002 4 m t v c v v d l v d n l v v g η f where m t is the total mass matrix c v is the coriolis centripetal matrix d l v d n l v v are the linear nonlinear drag matrix and g η is the restoring force matrix it is should be pointed out that m t includes the rigid body system inertia matrix m r b and the added mass matrix m a as follows 5 m t m r b m a m r b m 0 0 0 m z g m y g 0 m 0 m z g 0 m x g 0 0 m m y g m x g 0 0 m z g m y g i x 0 0 m z g 0 m x g 0 i y 0 m y g m x g 0 0 0 i z m a diag x u y v z w k p m q n r similarly c v includes the rigid body system inertia part c r b v and the added mass part c a v where c v c r b v c a v c r b v 0 0 0 0 0 0 0 0 0 m y g q z g r m y g p w m z g p v m x g q w m z g r x g p m z g q u m x g r v m y g r u m x g p y g q m y g q z g r m x g q w m x g r v m y g p w m z g r x g p m y g r u m z g p v m z g q u m x g p y g q 0 i z r i y q i z r 0 i x p i y q i x p 0 6 c a v 0 0 0 0 z w w y v v 0 0 0 z w w 0 x u u 0 0 0 y v v x u u 0 0 z w w y v v 0 n r r m q q z w w 0 x u u n r r 0 k p p y v v x u u 0 m q q k p p 0 the two drag coefficients matrices are described as 7 d l diag x u y v z w k p m q n r d n l diag x u y v z w k p m q n r taking the buoyancy center as the origin the restoring force g η can be expressed as 8 g η g b s θ b g c θ s ϕ b g c θ c ϕ y g g c θ c ϕ z g g c θ s ϕ z g g s θ x g g c θ c ϕ x g g c θ s ϕ y g g s θ where b is the buoyancy and g is the gravity the inputs configuration of the auv is similar to that of the quadrotor uav raharja et al 2015 the distance between the rotation axis of auv and that of propeller denoted by l 15 cm the inputs matrix can be obtained 9 f x y z k m n 0 0 f τ 1 f τ 2 f τ 3 f τ 4 f τ 1 f τ 2 f τ 3 f τ 4 l 2 f τ 1 f τ 2 f τ 3 f τ 4 l 2 m τ 1 m τ 2 m τ 3 m τ 4 where f τ i and m τ i are the thrust and torque produced by each propeller and they are proportional to the square of the propeller speed the mathematical relations between them and the angular velocity ω i of each propeller are given as follows song et al 2020 10 f τ i b ω i 2 11 m τ i d ω i 2 where b is the thrust coefficient and d is the torque coefficient so we can get that x 0 y 0 z b ω 1 2 b ω 2 2 b ω 3 2 b ω 4 2 k b ω 1 2 b ω 2 2 b ω 3 2 b ω 4 2 l 2 m b ω 1 2 b ω 2 2 b ω 3 2 b ω 4 2 l 2 n d ω 1 2 d ω 2 2 d ω 3 2 d ω 4 2 table 3 shows the main parameters of the auv where γ is the radius x g y g z g is the coordinates of the center of gravity and i x i y i z is the moment of inertia then a complete six dof model of the auv can be obtained by calculating the hydrodynamic coefficients and the related dynamic parameters of the propellers 3 simulation in this section star ccm is used to simulate the translational and rotational motions of the auv on each axis to calculate hydrodynamic coefficients to test the simulation and calculation method the feasibility analysis is firstly presented 3 1 validation in this section by simulating the translational motion of a sphere the additional mass coefficient is calculated and compared with the theoretical value so as to verify the feasibility of the scheme the radius of the sphere is r 0 0 1125 m and the mass is m 0 2 5 kg since the sphere is symmetrical in three coordinate planes it can be derived that x u y v z w and the simulation on a single dof is feasible the translational motion on the z axis is chosen according to the empirical formula the added mass coefficient of the standard sphere m 0 a is given as follows javanmard and mansoorzadeh 2019 12 m 0 a 2 ρ π r 0 3 3 where the density of water ρ 1000 kg m 3 thus the theoretical value m 0 a 2 9821 kg now we simulate the motion using star ccm to calculate m 0 a and compare it with the theoretical value a kind of dynamic mesh technology i e the overset mesh is used to simulate the variable speed motion of the sphere in the simulation model fig 4 the radius and height of the cylinder are respectively 0 8 m and 1 7 m the boundary conditions on the side are set as wall which is 0 7 m away from the surface of the sphere the upper surface is the velocity inlet surface which is located 0 4 m above the sphere and the lower surface is the pressure outlet located 1 1 m below the sphere in terms of mesh size the basic mesh size of the sphere is 0 005 m and the minimum surface size and maximum mesh cell size are set to 0 0005 m and 0 01 m respectively the basic mesh size of the cylinder flow field is 0 01 m and other size settings are the same as the sphere the k ε turbulence model is selected the time step is set to 0 001s so that the curve can stabilize in a short physical time other settings including the sub relaxation factor were set by the default setting all simulations were carried out on a desktop computer with 6 cores i7 processors and 32 gb internal memory in parallel mode the dynamic equation of the sphere on the z axis can be generalized as 13 m 0 m 0 a a 0 d 0 v 0 f 0 b 0 g 0 where a 0 is the acceleration d 0 v 0 is the total drag f 0 is the external force and b 0 g 0 is the restoring force when f 0 0 n and the sphere is fixed in the flow field there is the simulation result b 0 g 0 33 683 n fig 5 when a flow with a given velocity v c 0 1 m s is introduced from the velocity inlet the force on the sphere is 33 652 n fig 5 in other words when f 0 0 n and v 0 0 1 m s there is d 0 v 0 b 0 g 0 33 652 n then f 0 10 n 15 n 20 n is applied to the sphere respectively and the acceleration at v c 0 1 m s is measured to get the added mass coefficient fig 6 which is calculated by the following formula 14 m 0 a f 0 d 0 v 0 b 0 g 0 a 0 m 0 the calculation results are shown in table 4 it is proved that the difference between the added mass coefficients calculated by star ccm simulation and the theoretical value is very small therefore it can be derived that the proposed cfd method is feasible in terms of drag coefficients the division of the linear part and nonlinear part is more complicated which will be introduced in detail in the later section 3 2 simulation of translational motion from this subsection the simulation of haizhe was carried out to estimate the hydrodynamic coefficients in order to simplify the simulation and calculation process the model is treated as follows in the later simulation 1 set the initial roll pitch and yaw of haizhe to 0 this means that when there is no external force and the attitude is stable ϕ θ ψ 0 and many monomials in the dynamic model are 0 2 the center of gravity of the haizhe is set as the origin i e it is set to coincide with the center of buoyancy this does not affect the calculation result of hydrodynamic coefficients 3 in each simulation only one dof velocity or acceleration is given to the auv to eliminate the coupling interference for example when calculating the hydrodynamic coefficients in the direction of x axis translation setting v u 0 0 0 0 0 t and v u 0 0 0 0 0 t then eqs 4 11 can be simplified to m x u u x u u x u u 2 x so the simplified dynamic equation of the auv in each dof can be derived from eqs 4 11 as follows 15 m x u u x u u x u u 2 x 16 m y v v y v v y v v 2 y 17 m z w w z w w z w w 2 b g z 18 i x k p p k p p k p p 2 k 19 i y m q q m q q m q q 2 m 20 i z n r r n r r n r r 2 n where eqs 15 17 are used for translational motion simulation and eqs 18 20 are used for rotational motion simulation to start with the later subsection will simulate the translational motion of the auv including the uniform and variable motion on the z axis and x axis to calculate its drag coefficients and added mass coefficients 3 2 1 estimation of z w and z w first the uniform translational motion on z axis is simulated since the acceleration is 0 the influence of the added mass coefficient can be excluded when the input force z 0 eq 17 can be simplified as 21 z w w z w w w b g the static mesh model is shown in fig 7 the radius and height of the cylinder flow field are 0 5 m and 1 5 m respectively the upper surface is located 0 1 m above the auv and the lower surface is located 1 2 m below the auv the mesh size and other conditions are the same as those in section 3 1 because the propeller rotates at high speed when the auv is moving and the blades are very thin the envelope surface is used to replace the original propeller in this model to reduce the error and improve the calculation efficiency by setting the upper part of the flow field as the velocity inlet and the lower part as the pressure outlet a current flow with velocity v c can be given to simulate a uniform moving auv when z 0 n and the auv is fixed in space the restoring force b g 13 0845 n fig 8 similar to the motion simulation of the sphere keeping z 0 n the force f z on auv under different v c can be recorded fig 8 it is worth noting that f z b g z w w z w w w where w can be equivalent to v c the ratio of total drag to velocity i e the total drag coefficient can be calculated as table 5 it can be seen that the total drag coefficient increases as the speed increases which is consistent with the predicted results to get a more obvious conclusion we simulate the model with high speed thus v c is raised above 1 m s fig 9 with the further increase of the speed the increasing trend of the total drag coefficient is also strengthened table 6 according to the above model the total drag coefficient can be divided into the linear part z w and the nonlinear part z w in the aspect of data processing cftool curve fitting toolbox in matlab is used in this paper to fit curves and surfaces cftool is a practical toolbox that can achieve a variety of linear nonlinear function fittings the fitting type used in this article is polynomial which allows users to choose the number of arguments and polynomial forms of the function we obtain fig 10 where the x axis is the speed the y axis is the total drag the quadratic curve is used the square coefficient p1 z w the linear term p2 z w and the constant part p3 is set to 0 the fitting in fig 10 performs well but z w is negative in the result which is inconsistent with the actual situation it is may not be difficult to explain this phenomenon in the case of a high speed or more precisely when v c 1 m s the value of the linear part of drag coefficient is very small which can be ignored in this case fitting all the points at the same time will lead to a abnormal result to get z w accurately five points with v c 0 1 m s are fitted separately fig 11 we can get that z w 0 3747 kg s returning this value to the original fitting program and re fit all points fig 12 we obtain that z w 36 35 kg m the result window shows the fit type fitting values and coefficients with 95 confidence bounds for the curve fitted in this paper its quality can be seen from the sse and r square evaluation parameters sse is the sum of squares due to error this statistic measures the deviation of the original value from the fitted values a value closer to 0 indicates a better fit while r square is the coefficient of multiple determination this statistic measures how successful the fit is in explaining the variation of the data a value closer to 1 indicates a better fit it can be obtained that the rmse 0 7235 and r square 0 9998 both the results of rmse and r square prove that the curve fitting is in line with the expectation 3 2 2 estimation of z w next the variable translational motion of the auv on the z axis is simulated to calculate the added mass coefficient z w different from the uniform simulation the dynamic mesh is used in the pretreatment process instead of the static one importantly the static mesh model is relatively simple to set and the most essential feature of it is to keep still all the time in simulation while the dynamic mesh model strictly follows the principle of dynamics in other words it moves and deforms under the action of external force in fig 13 the small cylinder is the overset mesh model and the auv is translated to the middle of the flow field in other words the distance between the auv and the upper and lower surfaces of the cylinder is 0 65 m the rest of the settings remain unchanged different input force z is applied to the auv and its velocity and acceleration are obtained when the velocity reaches 0 1 m s the acceleration is recorded fig 14 according to the simulation of uniform motion when w 0 1 m s b g z w w z w w w 12 6770 n using eq 17 the added mass coefficient z w under different accelerations can be calculated table 7 the results of z w are basically the same under different accelerations which confirms the previous conjecture that the hydrodynamic coefficients are only related to the shape of auvs taking the average value we can get z w 3 1337 kg thus all the hydrodynamic coefficients of z axis translational motion are obtained 3 2 3 estimation of x u and x u the same method is used to calculate the hydrodynamic coefficients of the x axis translational motion in fact due to the under actuated system of the quadrotor auv the translational motion on the xoy plane is bound to be accompanied by roll or pitch which will lead to changes in hydrodynamic coefficients the haizhe mentioned in this paper has a spherical body its hydrodynamic coefficients are not sensitive to rotation and the angle of roll or pitch during translation is small so the change of the hydrodynamic coefficients is not obvious therefore our simulations were in an upright condition similarly the uniform motion is simulated and the simulated data are sorted out as table 8 where f x is the external force on the auv it is worth mentioning that the buoyancy does not need to be considered for the translational motion on the x axis therefore the resultant force on the auv is the total drag which omits one step of calculation compared with the simulation process on the z axis firstly five points with v c 0 1 m s are fitted fig 15 then the value of x u 0 7318 kg s is returned and all points are fitted again fig 16 we can get that x u 3 006 kg m since rmse 0 1532 and r square 0 9996 the curve fitting is proved in line with the expectation 3 2 4 estimation of x u continue the variable translational motion on the x axis to calculate the added mass coefficient x u the calculation method is the same as the above different input force x is applied to the auv and its velocity and acceleration are measured when the velocity reaches 0 1 m s the acceleration is recorded table 9 taking the average value x u 1 9897 kg we have obtained all the hydrodynamic coefficients of x axis translational motion since the motions of auv on the x axis and y axis are symmetrical we can obtain y v x u 0 7318 kg s y v x u 3 006 kg m y u x u 1 9897 kg it can be seen from the above results that when the speed of auv become very small the proportion of the corresponding nonlinear drag also becomes small with the increase of auv s speed the value of this part of drag increases rapidly while when the speed is higher than 1 m s the linear drag can almost be ignored besides the hydrodynamic coefficients of the translational motion on the x axis are smaller than those on the z axis which is especially obvious in the nonlinear drag coefficients this is because when the auv is translational on the z axis the integral frame and four propellers are all hindered by the flow field while the area of stress is smaller when the auv is translational on the x axis 3 3 simulation of rotational motion in this part we will simulate the rotational motion of the auv different from the translational motion it is unable to simulate uniform rotational motion while we can calculate both the drag coefficients and the added mass coefficients at the same time 3 3 1 estimation of n r n r and n r in the simulation of the z axis rotational motion a constant input moment n is applied to the auv to obtain the angular acceleration when the auv reaches a certain angular velocity then according to eq 20 n r n r and n r can be calculated when n 0 5 n m record the angular velocity and acceleration at different times and repeat this step when n 1 n m 1 5 n m and 2 n m and record in the same way table 10 by using the cftool command of matlab to fit the surface we obtain fig 17 where the x axis is r the y axis is r and the z axis is n the surface parameters are configured as follows p00 p11 0 n r p10 0 006736 kg m 2 s n r p20 0 008206 kg m 2 n r p01 i z 0 0037 kg m 2 the values of rmse 0 0001618 and r square 1 prove that the curve fitting is in line with the expectation 3 3 2 estimation of k p k p and k p by using the same method the rotation about the x axis can be simulated according to eq 18 k p k p and k p can be calculated the data is recorded in the same way as in the previous part table 11 fig 18 shows the result of surface fitting where the x axis is p the y axis is p and the z axis is k the surface parameters are configured as follows p00 p11 0 k p p10 0 001359 kg m 2 s k p p20 0 000012 kg m 2 k p p01 i x 0 0058 kg m 2 since the motions of auv on the x axis and y axis are symmetrical we can get m q k p 0 001359 kg m 2 s m q k p 0 000012 kg m 2 and m q k p 0 0058 kg m 2 therefore compared with the translational motion the drag of the auv in rotation is smaller due to the spherical structure of the auv this phenomenon is especially obvious when the auv rotates around the x axis and the nonlinear drag is almost negligible in the circumstances 3 4 simulation of propeller motion in this part the dynamic simulation of the propeller is carried out the thrust torque generated by the propeller is related to its speed diameter width moving medium atmospheric pressure etc in the ideal state the relationships between speed and thrust torque can be summarized as follows f τ i b ω i 2 m τ i d ω i 2 however in fact when the propeller rotates at high speed the flow around it will inevitably interfere with the hull of haizhe resulting in the attenuation of thrust and torque because the radius of the propeller is very small and the distance between the propeller and the hull is relatively large the attenuation may not be too high but it cannot be completely ignored therefore the propeller dynamics simulation under the ideal state and the actual state were carried out in this paper and the results of thrust couple are compared at the same speed the ideal model is shown in fig 19 the diameter of propeller is about 0 05 m the outer dark cylindrical part is overset mesh the base size of mesh is 0 001 m the minimum maximum mesh size are 0 0001 m and 0 002 m the diameter and height of the cylindrical flow field surface are 0 2 m and 1 3 m and the base size of mesh is 0 002 m the minimum maximum mesh size are 0 0002 m and 0 01 m as the propeller rotates at high speed the time step is set to 0 0001 s and the other settings remain unchanged fig 20 shows the actual model because the auv is symmetrical the model is simplified to a quarter of the original one the radius of the cylindrical flow field is 0 6 m the height is 2 m and the surface contacting with the auv is set as a symmetrical plane the mesh size and other settings are consistent with the ideal state model because the actual operating speed of propeller is about 120 rad s we take the simulation speed of 60 rad s 150 rad s and set 10 rad s as the interval to sample 10 speed points as shown in fig 21 take the square of rotational speed as the x axis and the thrust couple as the y axis the data in the figure displays that there is a little difference between the two curve when ω 2 10000 rad 2 s 2 i e ω 100 rad s the two curves almost overlap as ω continues to rise the ideal thrust couple is slightly larger than the actual value the reason for this phenomenon can be seen from the vector diagram as shown in fig 22 the vector arrow indicates the direction of flow and its velocity compared with the ideal state the flow velocity in the actual state is similar but the direction of the flow near the hull changes significantly which causes interference to the thrust couple the thrust coefficient b and couple coefficient d under ideal and actual states are calculated respectively the results are shown in fig 23 as mentioned above the propeller speed is about 120 rad s in actual motion therefore 6 points when the ω 100 150 rad s were selected in this paper and take the average value of b d of the actual state as the result the values are as follows b 3 065 1 0 4 n 2 s 2 rad 2 d 4 099 1 0 6 n 2 m 2 s 2 rad 2 3 5 results now all the parameters are presented in table 12 which can be substituted into eqs 4 11 to obtain a complete six dof dynamic model of the quadrotor auv 4 conclusion this paper presents a new cfd method for calculating hydrodynamic coefficients which can be applied to any complex shape underwater vehicle compared with the traditional methods such as ase approach which only supports the calculation of underwater vehicles with simple shape and structure efd approach that needs professional equipments and time consuming process and the traditional cfd methods which requires designers to have professional knowledge of fluid mechanic the advantages of the proposed method are low cost reliable and highly repeatable to verify the feasibility the proposed method is used to calculate the added mass coefficient of a sphere it is proved that the scheme has high accuracy by comparing with the empirical formula value the dynamic and static mesh schemes are used in this study which can effectively improve the calculation efficiency and the linear and nonlinear parts of the drag coefficient are separated by using curve fitting and surface fitting respectively then a complete six dof dynamic model including propeller model is established which can be used for dynamics research and control algorithm development the proposed method can also be employed for other underwater vehicle in the future the research work focuses on the design of the auv with new functions such as developing a new water air vehicle based on haizhe auv and use star ccm to optimize the structure associated with the shape and volume of the vehicle credit authorship contribution statement daxiong ji conceptualization of this study methodology rui wang writing original draft yangyang zhai data curation haitao gu software declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20344,quadrotor auv is a new and promising vehicle in applications due to its special advantages however the problem of dynamic modeling of quadrotor auv has not been investigated yet in this study a new dynamic modeling method for a quadrotor auv is proposed by using a novel cfd simulation to calculate the hydrodynamic coefficients star ccm is used to simulate the uniform and variable motion of each degree of freedom of a quadrotor auv to decouple original high coupling dynamic model through the simulation of the auv and the propeller motion the main hydrodynamic coefficients are calculated while the mathematical relationship between the rotation velocity and the thrust torque is concluded specifically the static mesh and dynamic mesh models are used to simulate the uniform and variable motion of the quadrotor auv respectively the calculation of added mass and drag coefficient does not interfere with each other leading to accurate results a numerical method is also proposed to separate the linear and nonlinear parts of the total drag coefficients then a six dof dynamic model of a quadrotor auv is established the proposed cfd simulation also provides a reliable repeatable and low cost method for dynamic modeling of underwater vehicles keywords quadrotor auv hydrodynamic coefficients cfd dynamic model 1 introduction autonomous underwater vehicle auv a kind of robot for hazardous underwater environments can be used for submarine investigation communication network layout and other functions and has high application value zereik et al 2018 sahoo et al 2019 during the past few decades the development of material science manufacturing technology sensor technology and novel batteries made possible multifunctional intelligent auvs various types of auvs continue to emerge and have attracted the attention of modern scientific research and manufacturing fields the design of new concept underwater vehicles has become the current research focus quadrotor auv is a new type of underwater vehicles whose mechanical structure and dynamic principle is similar to the quadrotor uav unmanned aerial vehicle and has recently been widely concerned by researchers ahmed 2015 raharja et al 2015 ranganathan et al 2015 the advantages of the quadrotor auv can be summarized as firstly the quadrotor system is used to replace the traditional rudder propulsion system which greatly simplifies the design and gives the vehicle the ability to hover for a long time and rotate in place secondly due to its small size and simple structure the auv can move flexibly while keeping low cost last by adding or modifying the propeller propulsion this type of auv may become a cross domain vehicle drews jr et al 2014 alzu bi et al 2015 mercado ravell et al 2018 mercado ravell et al 2019 it is well known that the dynamic models of auvs are non linear strong coupling time varying and multiple input multiple output mimo systems and cover all the hydrodynamic loads these hydrodynamic loads are usually not constant in time they are functions of speed acceleration and auvs size expressed in the form of hydrodynamic coefficients multiplied by speed or acceleration as shown in table 1 the hydrodynamic coefficients of auv can be divided into two parts the added mass coefficients and the drag coefficients which respectively reflect the dynamic characteristics of auv in the acceleration and uniform motion fossen 2002 inaccurate hydrodynamic coefficients will lead to the failure of the dynamic model and affect the performance of control system according to the existing literature there are three common methods to calculate hydrodynamic coefficients as follows analytical and semi empirical ase in this research area jones et al 2002 and de barros et al 2008 presented several main analytical methods and their applications which covered a few of auvs with general shapes cardenas and de barros 2019 proposed an analytical method combined with the estimator based on an extended kalman filter which further increases the feasibility and accuracy ase is essentially a kind of microelement method including strip theory st and equivalent ellipsoid method eem which treat auv as a finite number of transverse two dimensional slices and ellipsoids respectively the advantage of this method is low cost and does not need professional experimental instruments but the obtained hydrodynamic coefficients are inevitably lower than the actual value due to the neglect of viscosity experimental fluid dynamics efd in the present study in the field park et al 2017 javanmard and mansoorzadeh 2019 and avila et al 2012 used various experimental methods such as towing tank and planar motion mechanism pmm to estimate hydrodynamic coefficients by controlling the uniform and variable motion in each dof the hydrodynamic load is applied to the auv in the terms of data processing park et al 2017 used least squares curve fitting and surface fitting while avila et al 2012 applied system identification si to analyze the experimental results efd method takes full account of the viscous term and the detail interference of auv s shape and perhaps it is the most reliable method to obtain hydrodynamic coefficients on the other hand the expensive special equipment is needed to test the uniform and variable motion of auv and the experiment process is cumbersome and time consuming computational fluid dynamics cfd there are two kinds of cfd methods the first one is based on potential flow assumption including the panel method pm and the boundary element method bem tyagi and sen 2006 and go and ahn 2019 used a cfd solver to study the motion of some typical auvs and proposed that the cfd method could be used to determine the hydrodynamic coefficients under different conditions in fact similar to the ase method this method does not consider the viscosity of fluid either and requires the designer to have the professional knowledge of fluid mechanics the second one is the cfd software which simulates the motion of auv in the flow field in the computer thus the calculation process can refer to efd method theoretically the cfd software can simulate motion in various dof of the vehicle under water or other media and measure both the kinematic and dynamic parameters compared with ase and efd method the cfd software can greatly simplify the preparatory work and reduce economic costs in the research of this field phillips et al 2010 proposed a package of cfd simulations which are used to measure the hydrodynamic forces of auv javanmard et al 2020 used the cfd software to calculate the added mass coefficients of an underwater vehicle the calculation results of this method may not be as accurate as those of efd method despite of this cfd software is still a time saving and cost effective tool the cfd software used in this research is star ccm of siemens which is based on finite element mesh dividing and has been applied to the hydrodynamic research of various underwater vehicles compared with other similar software star ccm has a more friendly interface more powerful meshing function simplified workflow and low learning costs for users its advantages are as follows 1 highly integrated star ccm is a software integrating geometry processing mesh generation solver and post processing other software products such as cfx its mesh generation module preprocessing module and solving module are independent which need to be opened separately resulting in long operation time 2 surface wrapping star ccm s surface wrapping can process complex geometry into a completely topologically closed leakless surface which can greatly reduce the time of mesh generation 3 overset mesh in star ccm overset mesh setting and simulation are more efficient and convenient because this technology has been used in star ccm for a long time it is more mature and accurate in the aspect of structure design yang et al 2019 used star ccm to study the performance of wave glider s propulsion system and analyzed the optimal propulsion force under different hydrofoils arrangements matveev and morabito 2020 simulated the forces acting on the vehicle s planing surfaces to verify the influence of deadrise angles on hydrodynamic characteristics while in the aspect of propeller hydrodynamic analysis bhattacharyya et al 2016 used star ccm to investigate the scale effects on the open water characteristics of a 4 bladed propeller yilmaz et al 2019 studied the tip vortex cavitation of a propeller and proposed a new and efficient mesh adaptation and refinement approach to cavitation simulation marcs according to the existing literature the research works generally focus on the design or optimization in a partial structure rather than a complete vehicle such as propeller or planing surfaces and only uses the static mesh for the cfd software simulation which may be not suitable for the simulation of variable motion a new cfd simulation scheme combining static and dynamic mesh is proposed in this study which can simulate both the uniform and variable motion of a quadrotor auv in six dof and the rotation of a single propeller although javanmard et al 2020 tried to calculate the added mass coefficients of auv in translational motion he did not further simulate the rotational motion or calculate the drag coefficients to the best of author s knowledge it is the first time to use star ccm to build the complete dynamic model of a quadrotor auv fig 1 shows the main scheme in establishing the model in which b and d are parameters related to the propeller dynamics the static and dynamic mesh models for the uniform and variable motion simulation are constructed respectively multiple groups of dynamic data are recorded in different motion environments processed by the curve and surface fitting to obtain the hydrodynamic coefficients respectively then by substituting these parameters into the dynamic equation a complete six dof model can be given the main contributions of this paper are summarized as follows 1 a six dof dynamic model of a quadrotor auv is established for the first time through the simulation of both the auv and the propeller motion the main hydrodynamic coefficients are calculated while the mathematical relationship between the rotation velocity and the thrust torque is concluded the underwater motion characteristics of the quadrotor auv including the relevance between the shape and dynamic characteristics are revealed 2 a novel mesh configuration method for star ccm simulation is proposed the static mesh and dynamic mesh model are used to simulate the uniform and variable motion of the quadrotor auv respectively thus the calculation of added mass and drag coefficients does not interfere with each other leading to accurate calculation results 3 a numerical method is proposed to separate the linear and nonlinear parts of the total drag coefficients according to the motion equation of single dof the curve fitting is used to calculate the drag coefficients in translational motion while the surface fitting is used to obtain the hydrodynamic coefficients in rotational motion the rest arrangement of this paper is demonstrated as follows section 2 introduces the kinematics and dynamics equations of the auv and explains the significance of each parameter section 3 analyzes the feasibility and simulates the motion of auv and propeller section 4 gives the conclusion to summarize the advantages of the scheme and the future works 2 model fig 2 shows the haizhe auv designed in the authors laboratory the auv is mainly composed of a spherical cabin radius γ 0 1125 m and four propellers the two hemispherical shells of the cabin are connected by flanges the rotor thrusters are installed on the four cantilevers of the flange and the control circuits are placed in the center of the cabin the actuating inputs are generated by four propellers producing the desired thrust and torque the propeller arrangement adopts the x shaped structure motor1 and motor3 rotate clockwise while motor2 and motor4 rotate anticlockwise fig 3 the attitude and motion of the auv can be controlled by adjusting the rotation speed of each propeller because the auv is nearly symmetrical in three coordinate planes the corresponding products of inertia can be assumed to be zero 2 1 kinematics equations for the convenience of hydrodynamics analysis two reference frames are introduced i e the body fixed coordinate frame and the earth fixed coordinate frame as shown in fig 3 the z axis of the body fixed coordinate system and the other one point vertically upward and to the sky respectively the body fixed coordinate frame is a moving coordinate frame which is fixed to the auv the linear and angular velocities of the auv are expressed in the system and the origin is chosen to coincide with the center of buoyancy the earth fixed coordinate frame on the other hand has its origin fixed to a specific point in space and the motion and location of the auv are described in the system table 2 shows the force torque linear angular velocity and position euler angle of the auv in six dof we introduce the following vectors defined as 1 η 1 x y z η 2 ϕ θ ψ η η 1 η 2 v 1 u v w v 2 p q r v v 1 v 2 f 1 x y z f 2 k m n f f 1 f 2 where η is the position and euler angle vector v is the velocity vector and f is the input vector the kinematics equations of the auv can be expressed as 2 η 1 η 2 r 1 η 2 0 3 3 0 3 3 r 2 η 2 v 1 v 2 in which the conversion equations of the linear velocity and angular velocity are given as follows where s sin c cos and t tan 3 η 1 r 1 η 2 v 1 r 1 η 2 c ψ c θ c ψ s θ s ϕ s ψ c ϕ s ψ s ϕ c ψ c ϕ s θ s ψ c θ c ψ c ϕ s ψ s θ s ϕ s θ s ψ c ϕ c ψ s ϕ s θ c θ s ϕ c θ c ϕ η 2 r 2 η 2 v 2 r 2 η 2 1 s ϕ t θ c ϕ t θ 0 c ϕ s ϕ 0 s ϕ c θ c ϕ c θ 2 2 dynamics equations without considering the environmental interference the overall dynamic equation of the auv can be presented as below fossen 2002 4 m t v c v v d l v d n l v v g η f where m t is the total mass matrix c v is the coriolis centripetal matrix d l v d n l v v are the linear nonlinear drag matrix and g η is the restoring force matrix it is should be pointed out that m t includes the rigid body system inertia matrix m r b and the added mass matrix m a as follows 5 m t m r b m a m r b m 0 0 0 m z g m y g 0 m 0 m z g 0 m x g 0 0 m m y g m x g 0 0 m z g m y g i x 0 0 m z g 0 m x g 0 i y 0 m y g m x g 0 0 0 i z m a diag x u y v z w k p m q n r similarly c v includes the rigid body system inertia part c r b v and the added mass part c a v where c v c r b v c a v c r b v 0 0 0 0 0 0 0 0 0 m y g q z g r m y g p w m z g p v m x g q w m z g r x g p m z g q u m x g r v m y g r u m x g p y g q m y g q z g r m x g q w m x g r v m y g p w m z g r x g p m y g r u m z g p v m z g q u m x g p y g q 0 i z r i y q i z r 0 i x p i y q i x p 0 6 c a v 0 0 0 0 z w w y v v 0 0 0 z w w 0 x u u 0 0 0 y v v x u u 0 0 z w w y v v 0 n r r m q q z w w 0 x u u n r r 0 k p p y v v x u u 0 m q q k p p 0 the two drag coefficients matrices are described as 7 d l diag x u y v z w k p m q n r d n l diag x u y v z w k p m q n r taking the buoyancy center as the origin the restoring force g η can be expressed as 8 g η g b s θ b g c θ s ϕ b g c θ c ϕ y g g c θ c ϕ z g g c θ s ϕ z g g s θ x g g c θ c ϕ x g g c θ s ϕ y g g s θ where b is the buoyancy and g is the gravity the inputs configuration of the auv is similar to that of the quadrotor uav raharja et al 2015 the distance between the rotation axis of auv and that of propeller denoted by l 15 cm the inputs matrix can be obtained 9 f x y z k m n 0 0 f τ 1 f τ 2 f τ 3 f τ 4 f τ 1 f τ 2 f τ 3 f τ 4 l 2 f τ 1 f τ 2 f τ 3 f τ 4 l 2 m τ 1 m τ 2 m τ 3 m τ 4 where f τ i and m τ i are the thrust and torque produced by each propeller and they are proportional to the square of the propeller speed the mathematical relations between them and the angular velocity ω i of each propeller are given as follows song et al 2020 10 f τ i b ω i 2 11 m τ i d ω i 2 where b is the thrust coefficient and d is the torque coefficient so we can get that x 0 y 0 z b ω 1 2 b ω 2 2 b ω 3 2 b ω 4 2 k b ω 1 2 b ω 2 2 b ω 3 2 b ω 4 2 l 2 m b ω 1 2 b ω 2 2 b ω 3 2 b ω 4 2 l 2 n d ω 1 2 d ω 2 2 d ω 3 2 d ω 4 2 table 3 shows the main parameters of the auv where γ is the radius x g y g z g is the coordinates of the center of gravity and i x i y i z is the moment of inertia then a complete six dof model of the auv can be obtained by calculating the hydrodynamic coefficients and the related dynamic parameters of the propellers 3 simulation in this section star ccm is used to simulate the translational and rotational motions of the auv on each axis to calculate hydrodynamic coefficients to test the simulation and calculation method the feasibility analysis is firstly presented 3 1 validation in this section by simulating the translational motion of a sphere the additional mass coefficient is calculated and compared with the theoretical value so as to verify the feasibility of the scheme the radius of the sphere is r 0 0 1125 m and the mass is m 0 2 5 kg since the sphere is symmetrical in three coordinate planes it can be derived that x u y v z w and the simulation on a single dof is feasible the translational motion on the z axis is chosen according to the empirical formula the added mass coefficient of the standard sphere m 0 a is given as follows javanmard and mansoorzadeh 2019 12 m 0 a 2 ρ π r 0 3 3 where the density of water ρ 1000 kg m 3 thus the theoretical value m 0 a 2 9821 kg now we simulate the motion using star ccm to calculate m 0 a and compare it with the theoretical value a kind of dynamic mesh technology i e the overset mesh is used to simulate the variable speed motion of the sphere in the simulation model fig 4 the radius and height of the cylinder are respectively 0 8 m and 1 7 m the boundary conditions on the side are set as wall which is 0 7 m away from the surface of the sphere the upper surface is the velocity inlet surface which is located 0 4 m above the sphere and the lower surface is the pressure outlet located 1 1 m below the sphere in terms of mesh size the basic mesh size of the sphere is 0 005 m and the minimum surface size and maximum mesh cell size are set to 0 0005 m and 0 01 m respectively the basic mesh size of the cylinder flow field is 0 01 m and other size settings are the same as the sphere the k ε turbulence model is selected the time step is set to 0 001s so that the curve can stabilize in a short physical time other settings including the sub relaxation factor were set by the default setting all simulations were carried out on a desktop computer with 6 cores i7 processors and 32 gb internal memory in parallel mode the dynamic equation of the sphere on the z axis can be generalized as 13 m 0 m 0 a a 0 d 0 v 0 f 0 b 0 g 0 where a 0 is the acceleration d 0 v 0 is the total drag f 0 is the external force and b 0 g 0 is the restoring force when f 0 0 n and the sphere is fixed in the flow field there is the simulation result b 0 g 0 33 683 n fig 5 when a flow with a given velocity v c 0 1 m s is introduced from the velocity inlet the force on the sphere is 33 652 n fig 5 in other words when f 0 0 n and v 0 0 1 m s there is d 0 v 0 b 0 g 0 33 652 n then f 0 10 n 15 n 20 n is applied to the sphere respectively and the acceleration at v c 0 1 m s is measured to get the added mass coefficient fig 6 which is calculated by the following formula 14 m 0 a f 0 d 0 v 0 b 0 g 0 a 0 m 0 the calculation results are shown in table 4 it is proved that the difference between the added mass coefficients calculated by star ccm simulation and the theoretical value is very small therefore it can be derived that the proposed cfd method is feasible in terms of drag coefficients the division of the linear part and nonlinear part is more complicated which will be introduced in detail in the later section 3 2 simulation of translational motion from this subsection the simulation of haizhe was carried out to estimate the hydrodynamic coefficients in order to simplify the simulation and calculation process the model is treated as follows in the later simulation 1 set the initial roll pitch and yaw of haizhe to 0 this means that when there is no external force and the attitude is stable ϕ θ ψ 0 and many monomials in the dynamic model are 0 2 the center of gravity of the haizhe is set as the origin i e it is set to coincide with the center of buoyancy this does not affect the calculation result of hydrodynamic coefficients 3 in each simulation only one dof velocity or acceleration is given to the auv to eliminate the coupling interference for example when calculating the hydrodynamic coefficients in the direction of x axis translation setting v u 0 0 0 0 0 t and v u 0 0 0 0 0 t then eqs 4 11 can be simplified to m x u u x u u x u u 2 x so the simplified dynamic equation of the auv in each dof can be derived from eqs 4 11 as follows 15 m x u u x u u x u u 2 x 16 m y v v y v v y v v 2 y 17 m z w w z w w z w w 2 b g z 18 i x k p p k p p k p p 2 k 19 i y m q q m q q m q q 2 m 20 i z n r r n r r n r r 2 n where eqs 15 17 are used for translational motion simulation and eqs 18 20 are used for rotational motion simulation to start with the later subsection will simulate the translational motion of the auv including the uniform and variable motion on the z axis and x axis to calculate its drag coefficients and added mass coefficients 3 2 1 estimation of z w and z w first the uniform translational motion on z axis is simulated since the acceleration is 0 the influence of the added mass coefficient can be excluded when the input force z 0 eq 17 can be simplified as 21 z w w z w w w b g the static mesh model is shown in fig 7 the radius and height of the cylinder flow field are 0 5 m and 1 5 m respectively the upper surface is located 0 1 m above the auv and the lower surface is located 1 2 m below the auv the mesh size and other conditions are the same as those in section 3 1 because the propeller rotates at high speed when the auv is moving and the blades are very thin the envelope surface is used to replace the original propeller in this model to reduce the error and improve the calculation efficiency by setting the upper part of the flow field as the velocity inlet and the lower part as the pressure outlet a current flow with velocity v c can be given to simulate a uniform moving auv when z 0 n and the auv is fixed in space the restoring force b g 13 0845 n fig 8 similar to the motion simulation of the sphere keeping z 0 n the force f z on auv under different v c can be recorded fig 8 it is worth noting that f z b g z w w z w w w where w can be equivalent to v c the ratio of total drag to velocity i e the total drag coefficient can be calculated as table 5 it can be seen that the total drag coefficient increases as the speed increases which is consistent with the predicted results to get a more obvious conclusion we simulate the model with high speed thus v c is raised above 1 m s fig 9 with the further increase of the speed the increasing trend of the total drag coefficient is also strengthened table 6 according to the above model the total drag coefficient can be divided into the linear part z w and the nonlinear part z w in the aspect of data processing cftool curve fitting toolbox in matlab is used in this paper to fit curves and surfaces cftool is a practical toolbox that can achieve a variety of linear nonlinear function fittings the fitting type used in this article is polynomial which allows users to choose the number of arguments and polynomial forms of the function we obtain fig 10 where the x axis is the speed the y axis is the total drag the quadratic curve is used the square coefficient p1 z w the linear term p2 z w and the constant part p3 is set to 0 the fitting in fig 10 performs well but z w is negative in the result which is inconsistent with the actual situation it is may not be difficult to explain this phenomenon in the case of a high speed or more precisely when v c 1 m s the value of the linear part of drag coefficient is very small which can be ignored in this case fitting all the points at the same time will lead to a abnormal result to get z w accurately five points with v c 0 1 m s are fitted separately fig 11 we can get that z w 0 3747 kg s returning this value to the original fitting program and re fit all points fig 12 we obtain that z w 36 35 kg m the result window shows the fit type fitting values and coefficients with 95 confidence bounds for the curve fitted in this paper its quality can be seen from the sse and r square evaluation parameters sse is the sum of squares due to error this statistic measures the deviation of the original value from the fitted values a value closer to 0 indicates a better fit while r square is the coefficient of multiple determination this statistic measures how successful the fit is in explaining the variation of the data a value closer to 1 indicates a better fit it can be obtained that the rmse 0 7235 and r square 0 9998 both the results of rmse and r square prove that the curve fitting is in line with the expectation 3 2 2 estimation of z w next the variable translational motion of the auv on the z axis is simulated to calculate the added mass coefficient z w different from the uniform simulation the dynamic mesh is used in the pretreatment process instead of the static one importantly the static mesh model is relatively simple to set and the most essential feature of it is to keep still all the time in simulation while the dynamic mesh model strictly follows the principle of dynamics in other words it moves and deforms under the action of external force in fig 13 the small cylinder is the overset mesh model and the auv is translated to the middle of the flow field in other words the distance between the auv and the upper and lower surfaces of the cylinder is 0 65 m the rest of the settings remain unchanged different input force z is applied to the auv and its velocity and acceleration are obtained when the velocity reaches 0 1 m s the acceleration is recorded fig 14 according to the simulation of uniform motion when w 0 1 m s b g z w w z w w w 12 6770 n using eq 17 the added mass coefficient z w under different accelerations can be calculated table 7 the results of z w are basically the same under different accelerations which confirms the previous conjecture that the hydrodynamic coefficients are only related to the shape of auvs taking the average value we can get z w 3 1337 kg thus all the hydrodynamic coefficients of z axis translational motion are obtained 3 2 3 estimation of x u and x u the same method is used to calculate the hydrodynamic coefficients of the x axis translational motion in fact due to the under actuated system of the quadrotor auv the translational motion on the xoy plane is bound to be accompanied by roll or pitch which will lead to changes in hydrodynamic coefficients the haizhe mentioned in this paper has a spherical body its hydrodynamic coefficients are not sensitive to rotation and the angle of roll or pitch during translation is small so the change of the hydrodynamic coefficients is not obvious therefore our simulations were in an upright condition similarly the uniform motion is simulated and the simulated data are sorted out as table 8 where f x is the external force on the auv it is worth mentioning that the buoyancy does not need to be considered for the translational motion on the x axis therefore the resultant force on the auv is the total drag which omits one step of calculation compared with the simulation process on the z axis firstly five points with v c 0 1 m s are fitted fig 15 then the value of x u 0 7318 kg s is returned and all points are fitted again fig 16 we can get that x u 3 006 kg m since rmse 0 1532 and r square 0 9996 the curve fitting is proved in line with the expectation 3 2 4 estimation of x u continue the variable translational motion on the x axis to calculate the added mass coefficient x u the calculation method is the same as the above different input force x is applied to the auv and its velocity and acceleration are measured when the velocity reaches 0 1 m s the acceleration is recorded table 9 taking the average value x u 1 9897 kg we have obtained all the hydrodynamic coefficients of x axis translational motion since the motions of auv on the x axis and y axis are symmetrical we can obtain y v x u 0 7318 kg s y v x u 3 006 kg m y u x u 1 9897 kg it can be seen from the above results that when the speed of auv become very small the proportion of the corresponding nonlinear drag also becomes small with the increase of auv s speed the value of this part of drag increases rapidly while when the speed is higher than 1 m s the linear drag can almost be ignored besides the hydrodynamic coefficients of the translational motion on the x axis are smaller than those on the z axis which is especially obvious in the nonlinear drag coefficients this is because when the auv is translational on the z axis the integral frame and four propellers are all hindered by the flow field while the area of stress is smaller when the auv is translational on the x axis 3 3 simulation of rotational motion in this part we will simulate the rotational motion of the auv different from the translational motion it is unable to simulate uniform rotational motion while we can calculate both the drag coefficients and the added mass coefficients at the same time 3 3 1 estimation of n r n r and n r in the simulation of the z axis rotational motion a constant input moment n is applied to the auv to obtain the angular acceleration when the auv reaches a certain angular velocity then according to eq 20 n r n r and n r can be calculated when n 0 5 n m record the angular velocity and acceleration at different times and repeat this step when n 1 n m 1 5 n m and 2 n m and record in the same way table 10 by using the cftool command of matlab to fit the surface we obtain fig 17 where the x axis is r the y axis is r and the z axis is n the surface parameters are configured as follows p00 p11 0 n r p10 0 006736 kg m 2 s n r p20 0 008206 kg m 2 n r p01 i z 0 0037 kg m 2 the values of rmse 0 0001618 and r square 1 prove that the curve fitting is in line with the expectation 3 3 2 estimation of k p k p and k p by using the same method the rotation about the x axis can be simulated according to eq 18 k p k p and k p can be calculated the data is recorded in the same way as in the previous part table 11 fig 18 shows the result of surface fitting where the x axis is p the y axis is p and the z axis is k the surface parameters are configured as follows p00 p11 0 k p p10 0 001359 kg m 2 s k p p20 0 000012 kg m 2 k p p01 i x 0 0058 kg m 2 since the motions of auv on the x axis and y axis are symmetrical we can get m q k p 0 001359 kg m 2 s m q k p 0 000012 kg m 2 and m q k p 0 0058 kg m 2 therefore compared with the translational motion the drag of the auv in rotation is smaller due to the spherical structure of the auv this phenomenon is especially obvious when the auv rotates around the x axis and the nonlinear drag is almost negligible in the circumstances 3 4 simulation of propeller motion in this part the dynamic simulation of the propeller is carried out the thrust torque generated by the propeller is related to its speed diameter width moving medium atmospheric pressure etc in the ideal state the relationships between speed and thrust torque can be summarized as follows f τ i b ω i 2 m τ i d ω i 2 however in fact when the propeller rotates at high speed the flow around it will inevitably interfere with the hull of haizhe resulting in the attenuation of thrust and torque because the radius of the propeller is very small and the distance between the propeller and the hull is relatively large the attenuation may not be too high but it cannot be completely ignored therefore the propeller dynamics simulation under the ideal state and the actual state were carried out in this paper and the results of thrust couple are compared at the same speed the ideal model is shown in fig 19 the diameter of propeller is about 0 05 m the outer dark cylindrical part is overset mesh the base size of mesh is 0 001 m the minimum maximum mesh size are 0 0001 m and 0 002 m the diameter and height of the cylindrical flow field surface are 0 2 m and 1 3 m and the base size of mesh is 0 002 m the minimum maximum mesh size are 0 0002 m and 0 01 m as the propeller rotates at high speed the time step is set to 0 0001 s and the other settings remain unchanged fig 20 shows the actual model because the auv is symmetrical the model is simplified to a quarter of the original one the radius of the cylindrical flow field is 0 6 m the height is 2 m and the surface contacting with the auv is set as a symmetrical plane the mesh size and other settings are consistent with the ideal state model because the actual operating speed of propeller is about 120 rad s we take the simulation speed of 60 rad s 150 rad s and set 10 rad s as the interval to sample 10 speed points as shown in fig 21 take the square of rotational speed as the x axis and the thrust couple as the y axis the data in the figure displays that there is a little difference between the two curve when ω 2 10000 rad 2 s 2 i e ω 100 rad s the two curves almost overlap as ω continues to rise the ideal thrust couple is slightly larger than the actual value the reason for this phenomenon can be seen from the vector diagram as shown in fig 22 the vector arrow indicates the direction of flow and its velocity compared with the ideal state the flow velocity in the actual state is similar but the direction of the flow near the hull changes significantly which causes interference to the thrust couple the thrust coefficient b and couple coefficient d under ideal and actual states are calculated respectively the results are shown in fig 23 as mentioned above the propeller speed is about 120 rad s in actual motion therefore 6 points when the ω 100 150 rad s were selected in this paper and take the average value of b d of the actual state as the result the values are as follows b 3 065 1 0 4 n 2 s 2 rad 2 d 4 099 1 0 6 n 2 m 2 s 2 rad 2 3 5 results now all the parameters are presented in table 12 which can be substituted into eqs 4 11 to obtain a complete six dof dynamic model of the quadrotor auv 4 conclusion this paper presents a new cfd method for calculating hydrodynamic coefficients which can be applied to any complex shape underwater vehicle compared with the traditional methods such as ase approach which only supports the calculation of underwater vehicles with simple shape and structure efd approach that needs professional equipments and time consuming process and the traditional cfd methods which requires designers to have professional knowledge of fluid mechanic the advantages of the proposed method are low cost reliable and highly repeatable to verify the feasibility the proposed method is used to calculate the added mass coefficient of a sphere it is proved that the scheme has high accuracy by comparing with the empirical formula value the dynamic and static mesh schemes are used in this study which can effectively improve the calculation efficiency and the linear and nonlinear parts of the drag coefficient are separated by using curve fitting and surface fitting respectively then a complete six dof dynamic model including propeller model is established which can be used for dynamics research and control algorithm development the proposed method can also be employed for other underwater vehicle in the future the research work focuses on the design of the auv with new functions such as developing a new water air vehicle based on haizhe auv and use star ccm to optimize the structure associated with the shape and volume of the vehicle credit authorship contribution statement daxiong ji conceptualization of this study methodology rui wang writing original draft yangyang zhai data curation haitao gu software declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
