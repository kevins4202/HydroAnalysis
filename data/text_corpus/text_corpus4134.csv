index,text
20670,this paper reports on fast numerical methods capable of modelling the behaviour of a flooded hull in waves the focus of the current research concerns the development and the application of such methods for hull girder loads prior dealing with damage scenarios a lightened numerical model for hull girder loads in intact case is proposed i e operating on a reduced number of input data four approaches for modelling damaged ship dynamics based on lumped mass technique are developed and compared finalized to hull girder outcomes they exploit different assumptions in particular on the free surface inclination and on the amount of flooded water in an open to sea compartment comparisons with available experimental data are carried out for the frigate hull named dtmb5415 in head and beam seas the outcomes of the current research point out the levels of accuracy of the proposed methodologies on ship dynamics and on sea loads according to the investigated wave scenario keywords hull girder wave loads damaged hull 1 introduction ship safety is one of the main concern in maritime industry a better knowledge of the adverse phenomena that lead to accidents is of primary importance together with the development of suited numerical tools capable of modelling them nowacki 2010 among the adverse scenarios that a ship might face in her lifetime there is the flooding of one of more compartments this problem is detrimental both for ship damage stability and for hull girder strength actually the presence of adverse weather conditions such as wind and waves cannot be excluded from the problem indeed it seems that ship accidents are often associated to certain sea state conditions zhang and li 2017 the scenario of a damaged ship in waves involves a strong interaction between fluid and ship dynamics affecting both ship motions and structural loads many experimental studies focused on hull girder loads of an intact ship in regular waves accounting for head beam and oblique seas kukkanen and matusiak 2014 fonseca and guedes 2004 zhu et al 2011 nevertheless several experimental campaign were dedicated also to damaged hull for the estimation of loads in waves korkut et al 2005 lee et al 2012 the availability of these data allowed validating numerical tools for the evaluation of hull girder loads the most of the numerical methods deals with the intact ship in waves only a few considers the case of a damaged compartment moreover there are two possible methodology to numerically model hull girder loads in waves the first one based on cfd computations rörup et al 2010 schellin et al 2015 ensures a greater accuracy in modelling ship dynamics at the cost of a higher computational time the second methodology is based on strip theory kukkanen and matusiak 2014 song et al 2011 that is faster but less detailed all of these methods can account for non linearities that become relevant when approaching couplings between fluid dynamics and ship motions song et al 2016 souto iglesias et al 2004 sadat hosseini et al 2016 indeed in distress situations such as damage scenarios whereby human lives cargo and environment are put in danger a quick and reliable assessment and communication of ship state is crucial nordströmet al 2016 in this case a faster method proven its reasonable effectiveness is more suitable to give rapidly details on the possible evolution of the damaged condition hence a strip theory based model is the preferable candidate for such scope moreover a hybrid sea keeping model has been adopted to include pertinent non linearities matusiak 2013 in such a model radiation i e added mass and damping and diffraction forces are estimated from potential theory by solving a boundary value problem in the domain of frequency while restoring and froude krylov actions are evaluated from pressure distribution on the immersed hull discretized by triangular panels a further action toward a lighter model is the implementation of the radiation and diffraction sectional forces by means of simplified functions for instance the research work acanfora and coppola 2019 adopts linear force distributions in case of a damaged ship in waves the flooded water dynamics coupled with ship dynamics must first be properly modelled prior to carry out the estimation of hull girder loads a fast way of modelling a flooded hull is the lumped mass approach papanikolaou and spanos 2008 associated to a flat free surface of the floodwater the free surface can be assumed always horizontal during the simulation i e in phase with ship inclination quasi static approach letizia 1996 or it can have a different inclination as induced by ship dynamics dynamic lumped mass approach manderbacka et al 2015 acanfora and cirillo 2017 in general the quasi static approach provides accurate outcomes only in particular cases namely when ship dynamics is quite low i e long waves de kat 2000 or the flooded compartment is almost fully flooded instead the dynamic assumption of the free surface proved to be fairly effective for all filling levels in the whole range of wave frequency but especially for the intermediate fillings of the flooded compartment manderbacka et al 2015 acanfora and cirillo 2017 dealing with simulation of flooded compartments the water exchange phenomena between damaged tank and the sea can be considered in acanfora and cirillo 2017 a numerical model for the dynamics of a flooded hull in waves has been already validated in that work the experimental wave loads available for the dtmb5415 in head sea and beam sea begovic et al 2017 have been compared with the results obtained by the numerical simulation this paper aims at characterizing a numerical model based on a fast approach for the assessment of hull girder loads of a damaged ship with a flooded compartment based on the above review of the state of the art the following novel aspects are provided in this study in the first part a method for a quick implementation of radiation diffraction and weight forces for the intact hull is enhanced with polynomial functions differently from acanfora and coppola 2019 in the second part a novel routine for the generation of sectional forces due to the flooded water dynamics in the damaged compartment is provided following the approach presented in acanfora et al 2019 the latter represents the main focus of the research study introducing the dynamic lumped mass approach for the estimation of hull girder loads of a damaged ship in waves besides novel outcomes are provided by conducting a comparative study of the influence of the different features i e dynamic lumped mass and flooded water exchange this is achieved by comparing numerical results with experimental wave loads available for the dtmb5415 in head sea and beam sea begovic et al 2017 for this hull the numerical model for the ship dynamics of the flooded hull in waves has been already validated in acanfora et al 2019 for the same sea states therefore four combinations of free surface and flooding are investigated namely the flooded water exchange vs constant flooded water assumption and dynamic lumped mass vs quasi static lumped mass assumption this aims at assessing the influence of the dynamics of the floodwater on hull girder problems looking also at the accuracy of the applied methods the following section reports on the numerical model focusing on all sectional force distributions involved in the simulations then the case study on the frigate hull dtmb5415 well known in the technical literature for benchmarking is introduced in section 3 preliminary applications on ship dynamics are presented in section 4 the comparison of the hull girder results with the experimental data and the related discussions are included in section 5 finally section 6 concludes 2 numerical model for ship dynamics in waves in synthesis for the sake of synthesis this section provides only a detailed description of the sectional force distributions all the details about the calculations of the concentrated forces and moments based on a 6dof model centered at ship center of gravity for the intact and the damaged hull are fully available in previous papers which the reader can refer to and freely access on line matusiak 2013 acanfora et al 2019 the main issue faced herein is the discretization of all forces and moments into sectional forces despite this might appear as a reverse approach concentrated forces and moments are usually obtained from integration of distributed forces most of the time only concentrated forces might be directly available thus the discretization techniques presented herein aim at reducing the amount of input data needed at the same time they allow performing the calculations when only concentrated forces are available on the other hand such approaches might introduce some approximations 2 1 description of the discretizing routine for intact ship generalized forces the determination of the longitudinal weight distribution is the first step when approaching the calculation of the longitudinal strength of a ship moreover weight distributions of principal axes determine the ship s radii of inertia which have a profound effect on the sea keeping performance of a vessel detailed weight distributions are not always available since it is not easy to measure them directly lin and shaw 2015 otherwise when derived from approximated methods it might happen that total displacement static moment and moment of inertia are not properly depicted i e the values obtained from the numerical integration of the weight distribution could differ from the values corresponding to the entire hull the discretization routine adopted herein assumes that weight distributes by means of a 4th order polynomial function p w x whose coefficients a w b w c w d w and e w are identified by imposing the following requirements 1 p w a w x 4 b w x 3 c w x 2 d w x e w x a x f p w d x δ x a x f p w x d x δ x g x a x f p w x 2 d x i y y p w x a p w 0 this approach guarantees the achievement of the concentrated values of displacement δ static moment δx g and moment of inertia i yy from the weight distribution although this one might somehow differ from the real one the main difference stays in the continuity of the distribution while ship weight distribution can exhibit step discontinuities the last requirement sets a known sectional weight p w0 at the aft extremity x a used for avoiding negative values of p w x a similar approach is adopted for radiation and diffraction forces differently from weight distribution when strip theory is employed these forces are usually available by integration of sectional forces it is worth recalling that the simulation model adopted herein implements radiation and diffraction forces obtained by a separated tool based on potential strip theory faltinsen 1990 thus the possibility of inputting concentrated forces and moments rather than sectional forces in the simulation model has advantages in reducing the pre processing of the input data and therefore the computational burden polynomial distributions of the 4th order are used for vertical and horizontal force distributions regarding radiation and diffraction imposing null values at the extremities and imposing the achievement of the corresponding global forces and moments i e in the y axis and z axis direction body fixed reference frame the equations below provide examples regarding diffraction forces and moments that are f diff z and m diff y f diff y and m diff z distributed by means of p diff z x and p diff y x respectively the same equations apply to radiation actions that for the sake of synthesis are omitted 2 p d i f f z a d z x 4 b d z x 3 c d z x 2 d x e d z x a x f p d i f f z d x f d i f f z x a x f p d i f f z x d x m d i f f y p d i f f z x a 0 p d i f f z x f 0 3 p d i f f y a d y x 4 b d y x 3 c d y x 2 d d y x e d y x a x f p d i f f y d x f d i f f y x a x f p d i f f y x d x m d i f f z p d i f f y x a 0 p d i f f y x f 0 the normal forces and the roll moment i e in the x axis direction and around x axis respectively body fixed reference frame are distributed by 4th order polynomial function as above actually for these distributions the requirement on the static moment is used as dummy parameter for adjusting the shape of the distribution if needed it is also worth specifying that the roll damping moment includes both potential damping and viscous damping the latter obtained by the knowledge of quadratic damping coefficient β for the intact hull begovic et al 2015 inertia restoring and froude krylov force distributions adopt the same routines previously developed in acanfora and coppola 2018 2019 accounting for all the pertinent non linearities an enhancement in restoring and froude krylov distributions is provided herein by improving the panel discretization of the hull surface in the previous applications the panel definition allowed panel arrangement even across the ends of the segments thus inducing some odd discontinuities in load distributions in order to avoid such issue the current triangular panels that discretize the hull surface are strictly defined within each hull segment see fig 1 for the beam wave scenario at zero speed the ship is assumed free to drift in order to model such condition the cross flow drag model is implemented in the numerical simulation this approach is based on the cross flow resistance concept where the hull resistance force distribution is evaluated once local draft and ship transverse velocity are known at each ship section the cross flow drag coefficient is set cd 1 2 this method allows a direct implementation of hull force distribution bertram 2000 2 2 numerical model for ship flooding and discretizing routine in the 6dof model the damage is simulated by means of the added weight method the flooded water amount m i is modelled as a lumped mass as in acanfora et al 2019 a brief description is provided below the position of the lumped mass r i is restrained on a discrete three dimensional path depending on the amount of flooded water and on the free surface inclination in the lateral and longitudinal direction angles ϕ e and θ e respectively the acceleration of the lumped mass in body fixed coordinates that is a l alx i aly j alz k is equal to as derived in acanfora and cirillo 2016 4 a l u ω r i ω u ω r i u i 2 ω u i the acceleration of the lumped mass depends on ship dynamics r i and u i are position and velocity of the lumped mass respectively u and ω are velocity and angular velocity of the ship respectively it is possible expressing the acceleration in the inertial system frame as a li alix i aliy j aliz k thus if the ship has instantaneous roll and pitch angles ϕ and θ and the lumped mass has accelerations a lix and a liy the free surface will be inclined of angles ϕ e and θ e in the body fixed frame see acanfora et al 2019 5 ϕ e ϕ tan 1 a liy g 6 θ e θ tan 1 a lix g in other words it is assumed that the inclination of the flat free surface is not horizontal i e normal to the gravity vector since it is assumed normal to the so called apparent gravity vector g e 7 g e g k a lix i a liy j viscous effects in the floodwater dynamics are applied as reduction in the lateral acceleration as a l i y δ f ϕ e r i y where the friction coefficient δ f is obtained from a reference model based on the dissipation of the energy of standing waves in rectangular rooms if the quasi static method holds then the free surface and the ship have exactly the same inclinations in presence of a damage opening on the side flooding water exchange is modelled by accounting for the sign of the flow rate q t as presented in manderbacka et al 2015 8 m i t 0 t ρ q t d t 9 q t s i g n h o h t 2 3 l 0 c d h 0 t 2 g h t this depends on the instantaneous difference between sea water height h 0 and the flooded water height in the compartment ht based on the ship dynamics h t h 0 t h t t it is worth underlying that wave effects are not accounted for in the estimations of the flooding law if the assumption on constant flooded water holds then no flow rate is calculated in the simulation all forces and moments due to the flooding are obtained by means of the method discussed above with respect to the center of gravity in the current research study flooded water force distribution is performed the forces distribute by means of linear functions from the end to the beginning of the damaged compartment otherwise values are set to zero step discontinuities are set at the flooded compartment extremities considering the limited extent of the damaged compartment together with the flat free surface assumption the linear distribution is considered fairly accurate in the estimation of the dynamics of a damaged hull restoring and froude krylov forces are directly calculated on the instantaneous wetted surface inertia forces are calculated accounting for the flooded water mass effects radiation and diffraction forces are assumed the same of the intact hull however by means of the dynamic method the lumped mass is not in phase with the ship motions thus depending on the phase the flooded water forces can dampen roll and pitch motions this effect can be seen as an additional contribution to the linear potential damping and cannot be achieved by quasi static method in begovic et al 2015 it is acknowledged that there is a significant difference between the non linear damping coefficient β for the intact and the damaged dtmb5415 hull for the purpose of the case study the coefficient β of the intact hull is adopted also for the damaged scenario this is aligned with the target of the fast method proposed herein whereas is less plausible the availability of a non linear damping coefficient β for a generic damage scenario nevertheless the adoption of the proper non linear damping coefficient could improve the accuracy of the results 3 case study the vessel chosen for the applications is the dtmb5415 table 1 includes all ship main characteristics weight and geometry together with the main particulars of the damaged compartment for this navy combatant hull several experimental campaigns were carried out by different researchers in different times checking the repeatability and thus the accuracy of the data in particular begovic et al 2013 addresses experimental results about ship motions in regular beam and head waves for the intact and the damaged hull these data helped in assessing the accuracy of the numerical flooding model adopted herein when applied to ship dynamics in waves see acanfora et al 2019 it was observed an overall good agreement between simulated and experimental results instead begovic et al 2017 recalls the previous campaign and provides in addition experimental results on hull girder loads in the same scenarios this reference paper is used herein to check the accuracy of the developed numerical model for the estimation of hull girder loads moreover since the whole experimental dataset is not fully available the simulation data are plotted over the available model test data pictures at first the current applications aim at setting up the intact hull outcomes obtained by the polynomial force distributions as presented above then the different approaches in modelling ship flooding are applied and discussed namely quasi static vs dynamic assumption of the free surface i e ϕ and θ vs ϕ e and θ e as inclination of the free surface constant flooded water vs variable flooded water i e m i vs m i t both in head and beam waves table 2 summarises the list of the studied cases focusing on the different implementations of the flooded water models the comparison of the experimental data with all proposed approaches will help understanding the relevance of each assumption against ship motion and hull girder load modelling 4 ship dynamics results and discussions prior presenting hull girder loads this section addresses the numerical simulation results for ship dynamics this is deemed necessary to ensure that global forces and moments depict the expected ship motions for the head sea condition heave and pitch motions are simulated and compared with the corresponding experimental data that were repeated in two different campaigns and correlated with uncertainty analysis see begovic et al 2017 they are available for both the intact and the damaged ship from the same reference paper the roll responses in beam waves in the same conditions are available as well heave pitch and roll amplitudes are achieved by applying fft analysis fast fourier transform to the time histories obtained by the numerical simulation thus they are made non dimensional by dividing heave amplitude by wave amplitude and pitch and roll amplitude with wave steepness that are η 3 a η 5 k a η 4 k a all numerical simulations are carried out with the ratio h λ 1 60 wave height over wave length differently from the reference experimental tests that feature h λ 1 50 this reduction in wave height is necessary to guarantee a reliable application of the numerical method that becomes less accurate with waves overcoming the freeboard deck acanfora et al 2019 it is worth noticing from the experimental data that the intact and the damaged ship in head waves do not present remarkable modifications in rigid hull dynamics see fig 2 and fig 3 in general there is a fine agreement between experimental and numerical results both for heave and pitch for intact and damaged hull the application of the four different damage models does not show any appreciable difference all models provide similar outcomes however it is possible to observe that the main variations in the simulated data are induced by the variable flooded water assumption indeed the constant mass and the full static models provide almost overlapping curves for heave and pitch which suggests that the free surface dynamics follow exactly ship dynamics that means θ e θ and ϕ e ϕ the measured roll motions in beam waves differently from the head sea case significantly modify between the intact and damage conditions in particular the flooded water effects dampen roll amplitudes see fig 4 the comparison between numerical and experimental data shows a fine agreement for the intact condition for the damage scenario the full numerical model provides the finest outcomes among all the applied methods see figs 4 and 5 by comparing the four damage models it is immediately clear that for the beam sea condition quasi static assumption leads to overestimated results especially in the resonant range while the effects of flooded water variation are almost negligible therefore based on the current observations the quasi static damage models are withdrawn from the load estimations in beam waves 5 hull girder loads results and discussions this section presents hull girder loads by numerical simulations for the intact and the damaged conditions the experimental data for comparisons are taken from the reference paper begovic et al 2017 hull girder load amplitudes are all obtained as half of the peak to peak value except for vsf vertical shear force and hogging and sagging vbm vertical bending moment that are obtained by difference with the static values indeed from the experimental results it is possible to observe that there is only a modest variation between hogging and sagging values moreover static values for the vsf and vbm are not directly available both for intact or damaged case therefore in order to avoid additional approximations herein the numerical half peak to peak values of vsf compare to experimental vsf and half peak to peak values of vbm compare to experimental sagging vbm i e considered as mean value hull girder loads are made non dimensional by dividing shear forces vsf and hsf vertical and horizontal shear forces respectively by ρglba and moments vbm hbm and tm vertical and horizontal bending moment and torsional moment respectively by ρgl 2 ba ship length and beam refer to the overall values all hull girder loads refer to a longitudinal position corresponding to the 0 364 l oa 5 1 hull girder loads in head sea the following subsection presents hull girder loads in head sea at zero speed figs 6 and 7 show vsf and vbm respectively made non dimensional as defined above experimental data compare with the numerical outcomes for the intact and the damage cases the comparison between numerical and experimental results for the intact case show some gaps both for vsf and vbm however it is worth recalling that also potential strip theory pst approach faltinsen 1990 based on the effective distribution of weight and hydrodynamic forces provides similar results see fig 8 the outcomes in fig 8 show a good agreement between pst approach with the developed method especially at small wave periods while they exhibit larger gaps for increasing wave periods this can be related to the non linear features of the developed method that become more relevant for longer waves characterized also by larger amplitudes given a fixed steepness therefore the same discrepancies between experimental and numerical data are expected both for pst and the developed method especially at small wave periods the latter proves to have at least the same level of accuracy of well acknowledged methods in head waves nevertheless the initial gaps in the intact hull results affect the trend of the damage case simulations consequently for a fair assessment of the investigated damage approaches the comparisons apply to the differences between intact and damage data differently from ship dynamic results in head sea the implemented damage techniques result in distinguishable hull girder load curves in fig 9 and fig 10 the differences between damage and intact results for non dimensional vsf and vbm respectively disclose a satisfactory agreement among all the damage models with the experimental results generally constant mass and full static approach provide very similar outcomes resulting the most accurate among the others from which they fall apart especially for wave periods higher than 12 s this suggests that if the flooded water remains constant the assumption on the free surface does not affect the simulation outcomes this might highlight some issues for the variable flooding mass approaches in long waves in head sea due to the adopted flooding law technique referring to the undisturbed sea profile 5 2 hull girder loads in beam sea the following subsection shows hull girder loads in beam waves at zero speed that are hsf hbm and tm hull is free to drift both in the numerical and in the experimental simulations in order to avoid change of heading effects in the numerical outcomes the post processed data refer to a limited steady state period just after the transient stage extinguishes figs 11 13 show non dimensional hsf hbm and tm respectively experimental data compare with the numerical outcomes for the intact and the damage cases for the latter ones the numerical models involving quasi static assumption on the free surface withdraw from the comparisons since affected by large discrepancies already on ship dynamics see fig 5 all numerical results show a satisfactory agreement with the experimental ones intact hsf and hbm numerical outcomes see figs 11 and 12 respectively show a fair match with experimental results in similar trends and values nevertheless hsf and tm curves see figs 11 and 13 respectively exhibit a small shift towards higher wave periods compared to experimental points already observable in ship dynamic outcomes despite less pronounced see fig 5 this is noticeable for both intact and damage cases differently from vsf hsf vbm and hbm that cannot be tuned the finest tm agreement for the intact hull is achieved by slightly modifying the shape of radiation and diffraction moments as explained in the sub section 2 1 this tuning allows a direct comparison between experimental and numerical data for the damage cases being the main objective of the current research it is also interesting to observe how constant mass and full model outcomes somewhat fall apart for hsf and hbm see figs 11 and 12 while almost overlapping in ship roll response and in tm results see figs 5 and 13 respectively in general the full model shows the best agreement for all hull girder loads in beam waves this supports the confidence in the applicability of the current flooding law in beam waves with side damage 5 3 discussions on the accuracy of the results the application of the numerical method presented in this paper focuses on the effects of flood water treatment on hull girder loads of a damaged ship however the accuracy of the method is affected by the initial thorough agreement of the dynamics of the rigid ship and of the hull girder loads for the intact hull that is not always achieved for the damaged hull scenario in beam sea see fig 4 the numerical method shows larger gaps in modelling the exact peak of roll motion response this mainly depends on the assumptions related to the non linear damping effects indeed numerical simulations are carried out at a reduced wave amplitude that is h λ 1 60 while the experimental value is h λ 1 50 and the implemented quadratic damping coefficient β refers to the intact condition it can be seen from begovic et al 2015 that the non linear damping coefficient β for damaged hull of the dtmb5415 is almost twice the value of β for the intact hull therefore the main discrepancies in the hull girder loads in beam waves for the damaged ship i e hsf hbm and tm damaged see figs 11 13 respectively depend on this initial error on ship dynamics moreover they are affected also by the accuracy of force distribution on the intact hull for instance the latter is the main source of error for the analysed vsf and vbm in head sea see figs 6 and 7 it is observed that the vsf and vbm for the intact hull are modelled by the current method with the same level of accuracy of potential strip theory method see fig 8 especially for small wave period it is worth recalling that both the approaches base on linear 2d radiation and diffraction forces that thus could be identified as a common source of error in view of these considerations the overall agreement of the presented method for hull girder loads of a damaged ship with the experimental data can be claimed satisfactory both in head and beam waves 6 conclusions fast numerical methods for assessing hull girder loads in waves for a damaged ship were developed and validated against experimental data the accuracy of their outcomes strongly depended on and followed the precision in modelling the complete ship dynamics and the accuracy in modelling hull girder loads of the intact ship about the first aspect this paper provided several comparisons among the investigated models for ship dynamic outcomes regarding hull girder loads of the intact hull the proposed approach based on distributing concentrated forces and moments given as input data provided satisfactory outcomes indeed the observed errors on sea loads were within the same level of accuracy of well acknowledged methods referring to strip theory approaches based on the current results and in agreement with previous researches the couplings of flooded water and ship motions in head sea moderately affected ship dynamics i e all the investigated damage models proved to be effective for heave and pitch simulations however different vsf and vbm were achieved by each method this suggests that the amount of flooded water and its dynamics have a relevant influence on hull girder load estimation in head sea rather than on ship dynamics the quasi static method with constant mass resulted the most accurate in modelling hull girder loads moreover some limits of applicability of the implemented flooding law in head sea scenarios were pointed out this might bring the attention on future research studies accounting for wave pressure at the damaged hole in beam waves the quasi static assumption on the free surface failed with large amount in modelling ship roll motions of the flooded hull and thus resulted not applicable for hull girder load estimations the simulated hull girder loads in beam waves for both intact and damaged ship were found in good agreement with the experimental data the full damage model i e with dynamic assumption on the free surface and variable flooding water was the most accurate the constant mass assumption was less precise but still satisfactory this suggests that the flooding law based on the undisturbed sea level proved to be reliable in beam wave scenarios despite the current validations limit to a single hull and to a single loading condition these research outcomes seem promising for future developments and applications of the presented methods credit authorship contribution statement maria acanfora conceptualization methodology software investigation writing original draft flavio balsamo validation conceptualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20670,this paper reports on fast numerical methods capable of modelling the behaviour of a flooded hull in waves the focus of the current research concerns the development and the application of such methods for hull girder loads prior dealing with damage scenarios a lightened numerical model for hull girder loads in intact case is proposed i e operating on a reduced number of input data four approaches for modelling damaged ship dynamics based on lumped mass technique are developed and compared finalized to hull girder outcomes they exploit different assumptions in particular on the free surface inclination and on the amount of flooded water in an open to sea compartment comparisons with available experimental data are carried out for the frigate hull named dtmb5415 in head and beam seas the outcomes of the current research point out the levels of accuracy of the proposed methodologies on ship dynamics and on sea loads according to the investigated wave scenario keywords hull girder wave loads damaged hull 1 introduction ship safety is one of the main concern in maritime industry a better knowledge of the adverse phenomena that lead to accidents is of primary importance together with the development of suited numerical tools capable of modelling them nowacki 2010 among the adverse scenarios that a ship might face in her lifetime there is the flooding of one of more compartments this problem is detrimental both for ship damage stability and for hull girder strength actually the presence of adverse weather conditions such as wind and waves cannot be excluded from the problem indeed it seems that ship accidents are often associated to certain sea state conditions zhang and li 2017 the scenario of a damaged ship in waves involves a strong interaction between fluid and ship dynamics affecting both ship motions and structural loads many experimental studies focused on hull girder loads of an intact ship in regular waves accounting for head beam and oblique seas kukkanen and matusiak 2014 fonseca and guedes 2004 zhu et al 2011 nevertheless several experimental campaign were dedicated also to damaged hull for the estimation of loads in waves korkut et al 2005 lee et al 2012 the availability of these data allowed validating numerical tools for the evaluation of hull girder loads the most of the numerical methods deals with the intact ship in waves only a few considers the case of a damaged compartment moreover there are two possible methodology to numerically model hull girder loads in waves the first one based on cfd computations rörup et al 2010 schellin et al 2015 ensures a greater accuracy in modelling ship dynamics at the cost of a higher computational time the second methodology is based on strip theory kukkanen and matusiak 2014 song et al 2011 that is faster but less detailed all of these methods can account for non linearities that become relevant when approaching couplings between fluid dynamics and ship motions song et al 2016 souto iglesias et al 2004 sadat hosseini et al 2016 indeed in distress situations such as damage scenarios whereby human lives cargo and environment are put in danger a quick and reliable assessment and communication of ship state is crucial nordströmet al 2016 in this case a faster method proven its reasonable effectiveness is more suitable to give rapidly details on the possible evolution of the damaged condition hence a strip theory based model is the preferable candidate for such scope moreover a hybrid sea keeping model has been adopted to include pertinent non linearities matusiak 2013 in such a model radiation i e added mass and damping and diffraction forces are estimated from potential theory by solving a boundary value problem in the domain of frequency while restoring and froude krylov actions are evaluated from pressure distribution on the immersed hull discretized by triangular panels a further action toward a lighter model is the implementation of the radiation and diffraction sectional forces by means of simplified functions for instance the research work acanfora and coppola 2019 adopts linear force distributions in case of a damaged ship in waves the flooded water dynamics coupled with ship dynamics must first be properly modelled prior to carry out the estimation of hull girder loads a fast way of modelling a flooded hull is the lumped mass approach papanikolaou and spanos 2008 associated to a flat free surface of the floodwater the free surface can be assumed always horizontal during the simulation i e in phase with ship inclination quasi static approach letizia 1996 or it can have a different inclination as induced by ship dynamics dynamic lumped mass approach manderbacka et al 2015 acanfora and cirillo 2017 in general the quasi static approach provides accurate outcomes only in particular cases namely when ship dynamics is quite low i e long waves de kat 2000 or the flooded compartment is almost fully flooded instead the dynamic assumption of the free surface proved to be fairly effective for all filling levels in the whole range of wave frequency but especially for the intermediate fillings of the flooded compartment manderbacka et al 2015 acanfora and cirillo 2017 dealing with simulation of flooded compartments the water exchange phenomena between damaged tank and the sea can be considered in acanfora and cirillo 2017 a numerical model for the dynamics of a flooded hull in waves has been already validated in that work the experimental wave loads available for the dtmb5415 in head sea and beam sea begovic et al 2017 have been compared with the results obtained by the numerical simulation this paper aims at characterizing a numerical model based on a fast approach for the assessment of hull girder loads of a damaged ship with a flooded compartment based on the above review of the state of the art the following novel aspects are provided in this study in the first part a method for a quick implementation of radiation diffraction and weight forces for the intact hull is enhanced with polynomial functions differently from acanfora and coppola 2019 in the second part a novel routine for the generation of sectional forces due to the flooded water dynamics in the damaged compartment is provided following the approach presented in acanfora et al 2019 the latter represents the main focus of the research study introducing the dynamic lumped mass approach for the estimation of hull girder loads of a damaged ship in waves besides novel outcomes are provided by conducting a comparative study of the influence of the different features i e dynamic lumped mass and flooded water exchange this is achieved by comparing numerical results with experimental wave loads available for the dtmb5415 in head sea and beam sea begovic et al 2017 for this hull the numerical model for the ship dynamics of the flooded hull in waves has been already validated in acanfora et al 2019 for the same sea states therefore four combinations of free surface and flooding are investigated namely the flooded water exchange vs constant flooded water assumption and dynamic lumped mass vs quasi static lumped mass assumption this aims at assessing the influence of the dynamics of the floodwater on hull girder problems looking also at the accuracy of the applied methods the following section reports on the numerical model focusing on all sectional force distributions involved in the simulations then the case study on the frigate hull dtmb5415 well known in the technical literature for benchmarking is introduced in section 3 preliminary applications on ship dynamics are presented in section 4 the comparison of the hull girder results with the experimental data and the related discussions are included in section 5 finally section 6 concludes 2 numerical model for ship dynamics in waves in synthesis for the sake of synthesis this section provides only a detailed description of the sectional force distributions all the details about the calculations of the concentrated forces and moments based on a 6dof model centered at ship center of gravity for the intact and the damaged hull are fully available in previous papers which the reader can refer to and freely access on line matusiak 2013 acanfora et al 2019 the main issue faced herein is the discretization of all forces and moments into sectional forces despite this might appear as a reverse approach concentrated forces and moments are usually obtained from integration of distributed forces most of the time only concentrated forces might be directly available thus the discretization techniques presented herein aim at reducing the amount of input data needed at the same time they allow performing the calculations when only concentrated forces are available on the other hand such approaches might introduce some approximations 2 1 description of the discretizing routine for intact ship generalized forces the determination of the longitudinal weight distribution is the first step when approaching the calculation of the longitudinal strength of a ship moreover weight distributions of principal axes determine the ship s radii of inertia which have a profound effect on the sea keeping performance of a vessel detailed weight distributions are not always available since it is not easy to measure them directly lin and shaw 2015 otherwise when derived from approximated methods it might happen that total displacement static moment and moment of inertia are not properly depicted i e the values obtained from the numerical integration of the weight distribution could differ from the values corresponding to the entire hull the discretization routine adopted herein assumes that weight distributes by means of a 4th order polynomial function p w x whose coefficients a w b w c w d w and e w are identified by imposing the following requirements 1 p w a w x 4 b w x 3 c w x 2 d w x e w x a x f p w d x δ x a x f p w x d x δ x g x a x f p w x 2 d x i y y p w x a p w 0 this approach guarantees the achievement of the concentrated values of displacement δ static moment δx g and moment of inertia i yy from the weight distribution although this one might somehow differ from the real one the main difference stays in the continuity of the distribution while ship weight distribution can exhibit step discontinuities the last requirement sets a known sectional weight p w0 at the aft extremity x a used for avoiding negative values of p w x a similar approach is adopted for radiation and diffraction forces differently from weight distribution when strip theory is employed these forces are usually available by integration of sectional forces it is worth recalling that the simulation model adopted herein implements radiation and diffraction forces obtained by a separated tool based on potential strip theory faltinsen 1990 thus the possibility of inputting concentrated forces and moments rather than sectional forces in the simulation model has advantages in reducing the pre processing of the input data and therefore the computational burden polynomial distributions of the 4th order are used for vertical and horizontal force distributions regarding radiation and diffraction imposing null values at the extremities and imposing the achievement of the corresponding global forces and moments i e in the y axis and z axis direction body fixed reference frame the equations below provide examples regarding diffraction forces and moments that are f diff z and m diff y f diff y and m diff z distributed by means of p diff z x and p diff y x respectively the same equations apply to radiation actions that for the sake of synthesis are omitted 2 p d i f f z a d z x 4 b d z x 3 c d z x 2 d x e d z x a x f p d i f f z d x f d i f f z x a x f p d i f f z x d x m d i f f y p d i f f z x a 0 p d i f f z x f 0 3 p d i f f y a d y x 4 b d y x 3 c d y x 2 d d y x e d y x a x f p d i f f y d x f d i f f y x a x f p d i f f y x d x m d i f f z p d i f f y x a 0 p d i f f y x f 0 the normal forces and the roll moment i e in the x axis direction and around x axis respectively body fixed reference frame are distributed by 4th order polynomial function as above actually for these distributions the requirement on the static moment is used as dummy parameter for adjusting the shape of the distribution if needed it is also worth specifying that the roll damping moment includes both potential damping and viscous damping the latter obtained by the knowledge of quadratic damping coefficient β for the intact hull begovic et al 2015 inertia restoring and froude krylov force distributions adopt the same routines previously developed in acanfora and coppola 2018 2019 accounting for all the pertinent non linearities an enhancement in restoring and froude krylov distributions is provided herein by improving the panel discretization of the hull surface in the previous applications the panel definition allowed panel arrangement even across the ends of the segments thus inducing some odd discontinuities in load distributions in order to avoid such issue the current triangular panels that discretize the hull surface are strictly defined within each hull segment see fig 1 for the beam wave scenario at zero speed the ship is assumed free to drift in order to model such condition the cross flow drag model is implemented in the numerical simulation this approach is based on the cross flow resistance concept where the hull resistance force distribution is evaluated once local draft and ship transverse velocity are known at each ship section the cross flow drag coefficient is set cd 1 2 this method allows a direct implementation of hull force distribution bertram 2000 2 2 numerical model for ship flooding and discretizing routine in the 6dof model the damage is simulated by means of the added weight method the flooded water amount m i is modelled as a lumped mass as in acanfora et al 2019 a brief description is provided below the position of the lumped mass r i is restrained on a discrete three dimensional path depending on the amount of flooded water and on the free surface inclination in the lateral and longitudinal direction angles ϕ e and θ e respectively the acceleration of the lumped mass in body fixed coordinates that is a l alx i aly j alz k is equal to as derived in acanfora and cirillo 2016 4 a l u ω r i ω u ω r i u i 2 ω u i the acceleration of the lumped mass depends on ship dynamics r i and u i are position and velocity of the lumped mass respectively u and ω are velocity and angular velocity of the ship respectively it is possible expressing the acceleration in the inertial system frame as a li alix i aliy j aliz k thus if the ship has instantaneous roll and pitch angles ϕ and θ and the lumped mass has accelerations a lix and a liy the free surface will be inclined of angles ϕ e and θ e in the body fixed frame see acanfora et al 2019 5 ϕ e ϕ tan 1 a liy g 6 θ e θ tan 1 a lix g in other words it is assumed that the inclination of the flat free surface is not horizontal i e normal to the gravity vector since it is assumed normal to the so called apparent gravity vector g e 7 g e g k a lix i a liy j viscous effects in the floodwater dynamics are applied as reduction in the lateral acceleration as a l i y δ f ϕ e r i y where the friction coefficient δ f is obtained from a reference model based on the dissipation of the energy of standing waves in rectangular rooms if the quasi static method holds then the free surface and the ship have exactly the same inclinations in presence of a damage opening on the side flooding water exchange is modelled by accounting for the sign of the flow rate q t as presented in manderbacka et al 2015 8 m i t 0 t ρ q t d t 9 q t s i g n h o h t 2 3 l 0 c d h 0 t 2 g h t this depends on the instantaneous difference between sea water height h 0 and the flooded water height in the compartment ht based on the ship dynamics h t h 0 t h t t it is worth underlying that wave effects are not accounted for in the estimations of the flooding law if the assumption on constant flooded water holds then no flow rate is calculated in the simulation all forces and moments due to the flooding are obtained by means of the method discussed above with respect to the center of gravity in the current research study flooded water force distribution is performed the forces distribute by means of linear functions from the end to the beginning of the damaged compartment otherwise values are set to zero step discontinuities are set at the flooded compartment extremities considering the limited extent of the damaged compartment together with the flat free surface assumption the linear distribution is considered fairly accurate in the estimation of the dynamics of a damaged hull restoring and froude krylov forces are directly calculated on the instantaneous wetted surface inertia forces are calculated accounting for the flooded water mass effects radiation and diffraction forces are assumed the same of the intact hull however by means of the dynamic method the lumped mass is not in phase with the ship motions thus depending on the phase the flooded water forces can dampen roll and pitch motions this effect can be seen as an additional contribution to the linear potential damping and cannot be achieved by quasi static method in begovic et al 2015 it is acknowledged that there is a significant difference between the non linear damping coefficient β for the intact and the damaged dtmb5415 hull for the purpose of the case study the coefficient β of the intact hull is adopted also for the damaged scenario this is aligned with the target of the fast method proposed herein whereas is less plausible the availability of a non linear damping coefficient β for a generic damage scenario nevertheless the adoption of the proper non linear damping coefficient could improve the accuracy of the results 3 case study the vessel chosen for the applications is the dtmb5415 table 1 includes all ship main characteristics weight and geometry together with the main particulars of the damaged compartment for this navy combatant hull several experimental campaigns were carried out by different researchers in different times checking the repeatability and thus the accuracy of the data in particular begovic et al 2013 addresses experimental results about ship motions in regular beam and head waves for the intact and the damaged hull these data helped in assessing the accuracy of the numerical flooding model adopted herein when applied to ship dynamics in waves see acanfora et al 2019 it was observed an overall good agreement between simulated and experimental results instead begovic et al 2017 recalls the previous campaign and provides in addition experimental results on hull girder loads in the same scenarios this reference paper is used herein to check the accuracy of the developed numerical model for the estimation of hull girder loads moreover since the whole experimental dataset is not fully available the simulation data are plotted over the available model test data pictures at first the current applications aim at setting up the intact hull outcomes obtained by the polynomial force distributions as presented above then the different approaches in modelling ship flooding are applied and discussed namely quasi static vs dynamic assumption of the free surface i e ϕ and θ vs ϕ e and θ e as inclination of the free surface constant flooded water vs variable flooded water i e m i vs m i t both in head and beam waves table 2 summarises the list of the studied cases focusing on the different implementations of the flooded water models the comparison of the experimental data with all proposed approaches will help understanding the relevance of each assumption against ship motion and hull girder load modelling 4 ship dynamics results and discussions prior presenting hull girder loads this section addresses the numerical simulation results for ship dynamics this is deemed necessary to ensure that global forces and moments depict the expected ship motions for the head sea condition heave and pitch motions are simulated and compared with the corresponding experimental data that were repeated in two different campaigns and correlated with uncertainty analysis see begovic et al 2017 they are available for both the intact and the damaged ship from the same reference paper the roll responses in beam waves in the same conditions are available as well heave pitch and roll amplitudes are achieved by applying fft analysis fast fourier transform to the time histories obtained by the numerical simulation thus they are made non dimensional by dividing heave amplitude by wave amplitude and pitch and roll amplitude with wave steepness that are η 3 a η 5 k a η 4 k a all numerical simulations are carried out with the ratio h λ 1 60 wave height over wave length differently from the reference experimental tests that feature h λ 1 50 this reduction in wave height is necessary to guarantee a reliable application of the numerical method that becomes less accurate with waves overcoming the freeboard deck acanfora et al 2019 it is worth noticing from the experimental data that the intact and the damaged ship in head waves do not present remarkable modifications in rigid hull dynamics see fig 2 and fig 3 in general there is a fine agreement between experimental and numerical results both for heave and pitch for intact and damaged hull the application of the four different damage models does not show any appreciable difference all models provide similar outcomes however it is possible to observe that the main variations in the simulated data are induced by the variable flooded water assumption indeed the constant mass and the full static models provide almost overlapping curves for heave and pitch which suggests that the free surface dynamics follow exactly ship dynamics that means θ e θ and ϕ e ϕ the measured roll motions in beam waves differently from the head sea case significantly modify between the intact and damage conditions in particular the flooded water effects dampen roll amplitudes see fig 4 the comparison between numerical and experimental data shows a fine agreement for the intact condition for the damage scenario the full numerical model provides the finest outcomes among all the applied methods see figs 4 and 5 by comparing the four damage models it is immediately clear that for the beam sea condition quasi static assumption leads to overestimated results especially in the resonant range while the effects of flooded water variation are almost negligible therefore based on the current observations the quasi static damage models are withdrawn from the load estimations in beam waves 5 hull girder loads results and discussions this section presents hull girder loads by numerical simulations for the intact and the damaged conditions the experimental data for comparisons are taken from the reference paper begovic et al 2017 hull girder load amplitudes are all obtained as half of the peak to peak value except for vsf vertical shear force and hogging and sagging vbm vertical bending moment that are obtained by difference with the static values indeed from the experimental results it is possible to observe that there is only a modest variation between hogging and sagging values moreover static values for the vsf and vbm are not directly available both for intact or damaged case therefore in order to avoid additional approximations herein the numerical half peak to peak values of vsf compare to experimental vsf and half peak to peak values of vbm compare to experimental sagging vbm i e considered as mean value hull girder loads are made non dimensional by dividing shear forces vsf and hsf vertical and horizontal shear forces respectively by ρglba and moments vbm hbm and tm vertical and horizontal bending moment and torsional moment respectively by ρgl 2 ba ship length and beam refer to the overall values all hull girder loads refer to a longitudinal position corresponding to the 0 364 l oa 5 1 hull girder loads in head sea the following subsection presents hull girder loads in head sea at zero speed figs 6 and 7 show vsf and vbm respectively made non dimensional as defined above experimental data compare with the numerical outcomes for the intact and the damage cases the comparison between numerical and experimental results for the intact case show some gaps both for vsf and vbm however it is worth recalling that also potential strip theory pst approach faltinsen 1990 based on the effective distribution of weight and hydrodynamic forces provides similar results see fig 8 the outcomes in fig 8 show a good agreement between pst approach with the developed method especially at small wave periods while they exhibit larger gaps for increasing wave periods this can be related to the non linear features of the developed method that become more relevant for longer waves characterized also by larger amplitudes given a fixed steepness therefore the same discrepancies between experimental and numerical data are expected both for pst and the developed method especially at small wave periods the latter proves to have at least the same level of accuracy of well acknowledged methods in head waves nevertheless the initial gaps in the intact hull results affect the trend of the damage case simulations consequently for a fair assessment of the investigated damage approaches the comparisons apply to the differences between intact and damage data differently from ship dynamic results in head sea the implemented damage techniques result in distinguishable hull girder load curves in fig 9 and fig 10 the differences between damage and intact results for non dimensional vsf and vbm respectively disclose a satisfactory agreement among all the damage models with the experimental results generally constant mass and full static approach provide very similar outcomes resulting the most accurate among the others from which they fall apart especially for wave periods higher than 12 s this suggests that if the flooded water remains constant the assumption on the free surface does not affect the simulation outcomes this might highlight some issues for the variable flooding mass approaches in long waves in head sea due to the adopted flooding law technique referring to the undisturbed sea profile 5 2 hull girder loads in beam sea the following subsection shows hull girder loads in beam waves at zero speed that are hsf hbm and tm hull is free to drift both in the numerical and in the experimental simulations in order to avoid change of heading effects in the numerical outcomes the post processed data refer to a limited steady state period just after the transient stage extinguishes figs 11 13 show non dimensional hsf hbm and tm respectively experimental data compare with the numerical outcomes for the intact and the damage cases for the latter ones the numerical models involving quasi static assumption on the free surface withdraw from the comparisons since affected by large discrepancies already on ship dynamics see fig 5 all numerical results show a satisfactory agreement with the experimental ones intact hsf and hbm numerical outcomes see figs 11 and 12 respectively show a fair match with experimental results in similar trends and values nevertheless hsf and tm curves see figs 11 and 13 respectively exhibit a small shift towards higher wave periods compared to experimental points already observable in ship dynamic outcomes despite less pronounced see fig 5 this is noticeable for both intact and damage cases differently from vsf hsf vbm and hbm that cannot be tuned the finest tm agreement for the intact hull is achieved by slightly modifying the shape of radiation and diffraction moments as explained in the sub section 2 1 this tuning allows a direct comparison between experimental and numerical data for the damage cases being the main objective of the current research it is also interesting to observe how constant mass and full model outcomes somewhat fall apart for hsf and hbm see figs 11 and 12 while almost overlapping in ship roll response and in tm results see figs 5 and 13 respectively in general the full model shows the best agreement for all hull girder loads in beam waves this supports the confidence in the applicability of the current flooding law in beam waves with side damage 5 3 discussions on the accuracy of the results the application of the numerical method presented in this paper focuses on the effects of flood water treatment on hull girder loads of a damaged ship however the accuracy of the method is affected by the initial thorough agreement of the dynamics of the rigid ship and of the hull girder loads for the intact hull that is not always achieved for the damaged hull scenario in beam sea see fig 4 the numerical method shows larger gaps in modelling the exact peak of roll motion response this mainly depends on the assumptions related to the non linear damping effects indeed numerical simulations are carried out at a reduced wave amplitude that is h λ 1 60 while the experimental value is h λ 1 50 and the implemented quadratic damping coefficient β refers to the intact condition it can be seen from begovic et al 2015 that the non linear damping coefficient β for damaged hull of the dtmb5415 is almost twice the value of β for the intact hull therefore the main discrepancies in the hull girder loads in beam waves for the damaged ship i e hsf hbm and tm damaged see figs 11 13 respectively depend on this initial error on ship dynamics moreover they are affected also by the accuracy of force distribution on the intact hull for instance the latter is the main source of error for the analysed vsf and vbm in head sea see figs 6 and 7 it is observed that the vsf and vbm for the intact hull are modelled by the current method with the same level of accuracy of potential strip theory method see fig 8 especially for small wave period it is worth recalling that both the approaches base on linear 2d radiation and diffraction forces that thus could be identified as a common source of error in view of these considerations the overall agreement of the presented method for hull girder loads of a damaged ship with the experimental data can be claimed satisfactory both in head and beam waves 6 conclusions fast numerical methods for assessing hull girder loads in waves for a damaged ship were developed and validated against experimental data the accuracy of their outcomes strongly depended on and followed the precision in modelling the complete ship dynamics and the accuracy in modelling hull girder loads of the intact ship about the first aspect this paper provided several comparisons among the investigated models for ship dynamic outcomes regarding hull girder loads of the intact hull the proposed approach based on distributing concentrated forces and moments given as input data provided satisfactory outcomes indeed the observed errors on sea loads were within the same level of accuracy of well acknowledged methods referring to strip theory approaches based on the current results and in agreement with previous researches the couplings of flooded water and ship motions in head sea moderately affected ship dynamics i e all the investigated damage models proved to be effective for heave and pitch simulations however different vsf and vbm were achieved by each method this suggests that the amount of flooded water and its dynamics have a relevant influence on hull girder load estimation in head sea rather than on ship dynamics the quasi static method with constant mass resulted the most accurate in modelling hull girder loads moreover some limits of applicability of the implemented flooding law in head sea scenarios were pointed out this might bring the attention on future research studies accounting for wave pressure at the damaged hole in beam waves the quasi static assumption on the free surface failed with large amount in modelling ship roll motions of the flooded hull and thus resulted not applicable for hull girder load estimations the simulated hull girder loads in beam waves for both intact and damaged ship were found in good agreement with the experimental data the full damage model i e with dynamic assumption on the free surface and variable flooding water was the most accurate the constant mass assumption was less precise but still satisfactory this suggests that the flooding law based on the undisturbed sea level proved to be reliable in beam wave scenarios despite the current validations limit to a single hull and to a single loading condition these research outcomes seem promising for future developments and applications of the presented methods credit authorship contribution statement maria acanfora conceptualization methodology software investigation writing original draft flavio balsamo validation conceptualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20671,ship emissions is one of the main components of port pollution inefficient waterway management may not only result in additional waiting time of ships but also the aggravated emissions in port with special consideration of combining scheduling optimization and speed reduction of ships in port this paper proposed a new emission reduction method called ship scheduling with speed reduction sssr performance of the sssr method has been testified through comparisons between the new and traditional ship emission reduction methods based on the navigation safety under three different strategies the effectiveness of the new ship emission reduction method has been testified through a series of experiments with practical data in port especially under various stages in port the emissions of ships can be reduced by 8 0 11 9 and the traffic efficiency can be improved by 3 8 6 2 keywords emission reduction ship scheduling speed reduction optimization algorithm port waterway 1 introduction marine transportation has become the main force of international trade which accounts for roughly 80 the quality of transport service is greatly affected by the efficiency of port management meanwhile the increasing number of ships also brings big challenges to the port and waterway capacity which greatly influences on the port ecological environment and waterway efficiency different stages of ship operations in port will cause various types of emissions and impede the construction of the green port villalba and gemechu 2011 furthermore there is no unified approach to reduce ship emissions of various stages all together therefore it is necessary to investigate how to reduce ship emissions at various stages in port simultaneously ships waiting in port and sailing in the waterway are the key stages of ships in port which associated with ship scheduling and speed controlling improper scheduling of ships in port will lead to serious congestion problem and affect the implementation of scheduled berthing and departure plans for inbound and outbound ships resulting in abundant delay especially for one way channel in port for navigation safety ships from opposite direction cannot enter the channel at the same time in the one way channel total waiting time of ships can judge the navigation efficiency of port waterway thus efforts of existing literatures are mainly focusing on the reduction of ships waiting time by using different optimization methods in consideration of scheduling order travel direction and distance of the berth for ships by using improved genetic algorithm zhang et al 2016 can significantly reduce ship s waiting time by scheduling the incoming and outgoing ships through different waterways the mathematical model and heuristics can minimize ship s waiting time as well as reducing the emissions of ships while waiting in the port waterway lalla et al 2018 during heavy traffic conditions ship s arrival and departure in the port area depend on the scheduling sequence of ships which can reduce the cost of berthing and delay by using mixed integer linear programming li and jia 2019 furthermore the ship scheduling problem not only appears in the port waterway but also in inland waterway canal and transit under the influence of geographical environment weather navigation rules etc there are navigation restrictions on the ships to improve the navigation efficiency of ships in the waterway optimal scheduling is also adopted as mentioned by many researchers traffic congestion in inland controlled waterway caused by narrow channel poor natural conditions and insufficient throughput capacity of locks has become the compelling problem the sorted vessel sequence and traffic commands are proposed to improve the efficiency and accuracy of the vessel traffic scheduling reducing the traveling time liang et al 2019 the adequate safety self organizing scheduling model is proposed to ensure the safety and efficiency of vessels in restricted waterway xin et al 2019 in order to avoid excessive time wasted in waiting for lock service the water land transshipment co scheduling lwtc problem is tackled by hybrid heuristic method liu et al 2020 the ant q algorithm is proposed for the ship lock arrangement to improve the ship lock navigable capability in inland waterway ji et al 2020 for navigation limitation of the narrow part of the canal changing speed setting the sideline capacity and limiting for waiting time of ships are set to minimize the total sailing time of ships meisel and fagerholt 2019 for the transit a mathematical formulation of scheduling by prioritizing of ships is put forward to increase the traffic management efficiency ulusçu et al 2009 studies of ship scheduling mainly focus on the traffic efficiency of ships in waterway besides few literatures combine the ship emissions problem with the ship scheduling this can also provide a ship emission reduction method appropriately emissions from ships will affect the ecological environment of the ocean and construction of the green port emission reduction measures have been considered in many kinds of literatures for the consideration of fuel consumption the fuel replacement of different tonnage and types of ships have been discussed on the effectiveness of emissions reduction wan et al 2019 for the connection between traffic efficiency with emissions the possibility of improving energy efficiency by reducing the waiting time of ships in port have been discussed in detail johnson and styhre 2015 besides several emission reduction measures are proposed together for comparison speed reduction decreasing the auxiliary time of berthing improving the efficiency of port facilities using the on shore power supply and alternative fuels are put forward for comparison peng et al 2018 also macro measures including alternative fuels design measures and operational measures are proposed respectively winnes et al 2015 speed is closely related to fuel consumption of marine engines as well as the emissions even a small change of the speed will greatly influence the emissions nowadays many works focus on the optimization of speed have been conducted under the condition of strictly limiting emissions in emission control area eca speed optimization method can maximize navigation profit fagerholt and psaraftis 2015 and minimize cost of ships sheng et al 2019 in consideration of ship s route conserve energy and reduce emissions are deemed necessary by speed optimization kim and lee 2018 also a speed optimization model can be established by the ship log data which can effectively reduce the fuel cost of the ship and minimize the fuel operating cost gusti 2017 over a voyage of ships a two phase optimal solution framework considering sailing speed displacement trim weather and sea conditions on ship fuel eﬃciency is quantified by adjusting its sailing speeds and trim settings can minimize ship s bunker fuel consumption significantly du et al 2019 from the above speed optimization can not only be a simple change at the operational level but also play a significant role in changing emissions and increasing revenue vessel speed reduction vsr is a program adopted by ports of los angeles long beach san diego new york new jersey and some ports of korea the objective of this program is to reduce emissions from ships by slowing their speeds as they approach or depart the port take a reference of this program an activity based model to calculate fuel consumption and emissions of ships entering kaohsiung port has been proposed chang and jhang 2016 results show that carbon emissions can be reduced by about 40 after decreasing the speed to 12 knots however there are some problems with the measures of speed reduction for ships substantially reduction will destroy the engines hence there is a limitation of reduction range and the speed has a curve relationship with the fuel consumption du et al 2011 for the shipping company speed reduction may delay the sailing date and route plan as well as the sailing cost of ships study of the feasibility of implementing the slow steaming strategies by shipping companies indicates that this strategy is sustainable in the long run cariou 2011 also the researchers estimated the economic speed of routes and explored the policy impact of fuel tax and speed reduction measures on carbon emissions corbett et al 2009 the speed reduction may have negative economic impact on the company otherwise for the applicability speed reduction method only focuses on the sailing stage of ships the emission reduction methods mentioned by existing literature mainly focus on one stage or one operation adopted by ships in port it is necessary to explore whether one method can reduce the emissions from various stages of ships in port nowadays ships enter or leave with higher speed in some ports higher speed will not only affect the navigation safety of ships but also produce excessive ship emissions meanwhile inefficient ship scheduling will make ships too much waiting in anchorage and berths resulting in additional emissions the kinds of literature on ship scheduling problems mostly focus on traffic navigation efficiency as well as decreasing the waiting time of ships which can also promote the emission reduction of ships therefore this paper summarizes the existing measures of ship emission reduction and combined with the ship scheduling problem to establish a new ship emission reduction method in port this paper is structured as follows chapter 1 is the introduction with literature review the second chapter describes relevant concepts and theories in this study chapter 3 introduces the mathematical model of the proposed method chapter 4 is the strategy design followed by the example analysis in chapter 5 finally conclusion and discussions are given in chapter 6 2 relevant concepts and theories ship scheduling in port waterway is mostly based on experience inefficient scheduling may lead to the long waiting time of ships and more fuel energy consumption may result in a large number of emissions in the port area meanwhile ships sailing in the waterway with higher speed may also produce additional emissions this paper explores the feasibility of reducing ship emissions in port through efficient ship scheduling and speed reduction measures to study whether ship scheduling can be combined with speed reduction and propose the solution of efficient ship scheduling method with low carbon operations of ships in port based on navigation safety 2 1 carbon emission formulation in port operations of ships in port refers to 4 stages including waiting at berth or anchorage sailing in port waterway auxiliary operations loading and unloading operations in different operation stages main and auxiliary engines will have different fuel consumptions and produce carbon emissions which can be calculated according to iso14064 1 2006 and ipcc 2006 the relationship between energy consumptions and carbon emission as follows 1 c f i e n e r g y where c represents the carbon emission f represents the energy consumption i e n e r g y represents the coefficient of carbon emission which can be obtained according to the work of endresen et al 2007 and ipcc 2006 2 1 1 sailing emissions of ships in the port waterway at the stage of sailing in the port waterway fuel consumptions of the main engine is approximately cubic related to the speed of ship corbett et al 2009 according to peng et al 2018 the formulation as follows 2 f j i s h i p s a i l p i m r j m l m v i 0 v i d 3 n p i a r j a l a d v i 0 where f j i s h i p s a i l represents the fuel consumption of ship i with different types of engines j p i m and p i a represent the main engine power and auxiliary engine power of ship i r j m and r j a represent the consumption rates of main and auxiliary engines l m and l a represent the load coefficients of main and auxiliary engines which are set to 0 8 and 0 5 n represents the number of the auxiliary engines v i 0 and v i d represent the actual speed and design speed of ships respectively d represents the sailing distances of ships 2 1 2 waiting emissions of ships in the port waterway the waiting stage of ships including waiting at anchorage to enter the port and waiting at berth to leave the port only auxiliary engine works the formulation as follows 3 f j i s h i p a n c h o r l a p i a r j a t i a n c h o r 4 f j i s h i p b e r t h l a p i a r j a t i b e r t h where f j i s h i p a n c h o r represents the fuel consumption of ship i with different types of engines j at anchorage p i a represents the auxiliary engine power of ship i r j a represents the consumption rates of auxiliary engines l a represents the load coefficients of auxiliary engines t i a n c h o r represents the waiting time of ship i at anchorage f j i s h i p b e r t h represents the fuel consumption of ship i with different types of engines j at berth t i b e r t h represents the waiting time of ship i at berth 2 2 navigation safety of ships in the port waterway in port waterway the safe time interval between ships is relevant to speed length width and distance of ships ship domain is an ellipse centered on a ship fuji and tanaka 1971 the size of ship domain is 6 l 1 6 l which means the length of the longitudinal axis is 6 times the length of the ship s length and the length of the horizontal axis is 1 6 times the width of the ship s length the size of a large ship with a tonnage of 200 000 tons or more is 8 l 3 2 l to ensure the navigation safety of ships the distance between ships will change when the speed is variable and the minimum distance between ships is the sum of the longitudinal axes of the ship domain wang et al 2018 proposed a concept of ship s critical time interval and formulated a calculation method of ship safety time distance under variable speed from the perspective of ship scheduling in port the speed reduction of ships will also affect the navigation safety of adjacent ships therefore this paper proposes the safety time calculation framework of adjacent ships considering various conditions fig 1 5 δ t v i v j d t v j v j v i 6 δ t v i v j l c h a n n e l v i l c h a n n e l d t v j v j v i this paper discusses the impact of speed reduction on emission therefore only the active speed reduction behavior is focused in port waterway when the speed of the following ship is less than the front ship the distance between ships will increase so the ships only need to keep the minimum distance when start sailing when the speed of the following ship is larger than the front ship the safe time interval can be obtained based on equation 6 in this situation the following ship should pay more attention to keep the distance from the front ship in the worst case the minimum distance should be the sum of the longitudinal axes of the ship domain the distance between ships is related to the interval between sailing start time this paper provides that the following ship should calculate the time interval between the front ship before starting to sail and judge if the time interval satisfies the critical time interval δ t v i v j that is the time interval when the distance of the following ship and the front ship at the end of navigation in the channel is the minimum safe distance between the adjacent approach channel time difference as shown in equation 6 if the time interval is less than δ t v i v j the following ship should wait until satisfy 7 d s 6 m a x l i l j 8 δ s v d s v j there is a ship encounter situation while ships entering and leaving the port at the entrance of the one way channel see fig 2 to keep safety navigation the distance between ships can be calculated based on equation 7 the distance between ships with opposite direction is six times the length of the longer ship the equation of the time interval is shown in equation 8 to ensure the navigation safety of adjacent ships the distance between ships in the same direction required a safety distance d h which is added based on d t when the front ship berths nearly see fig 3 that is to produce a safe distance for the following ship when the front ship is in auxiliary operation the safe time interval needs to add the berthing time based on δ t v i v j when the front ship berths far away the safe distance of ships can be calculated without considering d h 2 3 new emission reduction method for ships in port emission reduction measurements for ships in port mainly include reducing the speed of ships entering and leaving the port decreasing the waiting time of ships at anchorage or berth adjusting the operations of ships to avoid large scale maneuver using shore side electricity technology using alternative fuels etc this paper mainly focuses on the measurements of traffic management including speed reduction and decreases the waiting time of ships in the port waterway and proposes a new emission reduction method 2 3 1 decrease waiting time of ships the increasing number of ships have a large influence on port waterway traffic constrained by the large density of the arrival and departure ships in port the severe weather or the cargos that ship demand are not prepared in time most arrival ships wait at anchorage for entering the port and departure ships wait at berth for leaving the port too much waiting time will cause a large number of emissions there should be a rational scheduling way to keep safety efficient and low carbon the waiting time of ships at anchorage and berth can be reduced by optimizing the ship scheduling sequence zhang et al 2016 and is an efficient method to reduce the waiting emissions of ships in port winnes et al 2015 2 3 2 ship speed reduction fuel consumptions of the main engine is approximately cubic related to the speed of ships corbett et al 2009 reduction on 10 of speed can save 27 fuel consumption of ships therefore it is an effective way to reduce the sailing emissions of ships by speed reduction on the sea ship speed reduction can effectively reduce fuel consumption and emissions and protect the ecological environment of the ocean however under the influence of ship scheduling rent and operation cost weather environment and other factors it is necessary to optimize the speed considering multiple factors nowadays some ports in developed countries take the vessel speed reduction vsr plan to encourage reducing the speed to 10 knots for ships sailing close and leaving the port over the years this plan has an obvious effect on the environmental protection of the port however this plan will have some impacts on the waterway traffic firstly in most ports overtaking of ships is not allowed it means that the following ship should take actions to maintain the safe distance when front ship reduces the speed either change course or reduce speed this will impose a negative influence on the safe navigation of ships in the port waterway secondly speed reduction will have an influence on the sailing time as well as the sailing date the reduction of speed may delay navigation efficiency thirdly if ships with low speed while sailing in the port waterway take the speed reduction action the engines may be destroyed and increase the emissions on the contrary thus there is a limit range for speed reduction multiple factors should be considered when taking the speed reduction action alone in the port area to reduce the emissions 2 3 3 new method approach different stages of ships in port will cause various emissions optimizing the ship scheduling sequence can reduce the waiting time of ships in port and mitigate the waiting emissions reducing the speed of high speed ships will reduce the sailing emissions in the port waterway the ship scheduling with speed reduction sssr method is proposed to optimize ship scheduling sequence and reduce speed for high speed ships together in this paper see fig 4 it can be used for the ports which have some high speed ships entering or leaving generally the ship s speed may be limited by the navigation rules while sailing at the low speed in some ports there is no need to reduce speed further besides excessive deceleration can damage engines as well as decreasing navigational efficiency in vessel speed reduction vsr program which has been discussed in chapter 2 3 2 thus sssr is not applicable to all ports only the waterway is long enough which can contain multiple ships at the same time and few ships have relatively high speed which exceed 10 knots can this method be used in sssr speed reduction will increase the sailing time if the increase of sailing time is greater than the decrease of waiting time it will influence the traffic efficiency of the waterway therefore traffic efficiency as well as emissions should be investigated together by optimizing the ship scheduling and speed reduction there should be two objectives which are the total scheduling time of ships and the total emissions of ships in port the total emissions in this paper are the emissions that can be reduced by traffic management including sailing emissions and waiting emissions moreover the sssr method will influence the distance between ships by changing the scheduling sequence and speed the safety time interval and distance mentioned in section 2 2 should also be guaranteed to ensure the safety navigation 3 construction of the sssr model 3 1 model assumptions this paper studies the problem of ship emission reduction in port under the ideal conditions before building the model the following assumptions are put forward for the relevant problems 1 the hydrometeorological conditions in this period can meet the requirements of ships operations the anchorage capacity is sufficient the berthing operation plan has been formulated in advance and berth allocation is not considered 2 ships entering and leaving the port while sailing at the average speed 3 the scope of ships entering and leaving port is from anchorage entering the port area to berth and ship completion to leave port area respectively 4 the study only considers the process of using its own power equipment to sail in the port area and does not consider the use of tugs to pull in and leave the wharf 5 the ship reduction in this paper is the active reduction behavior of ships and the passive reduction behavior affected by traffic flow is not considered 3 2 variable and parameter setting 9 m i n i m i z e e c 10 e i u k b t i k b t i a i k k b t i k d t i k f 11 c i u k b v v n e w c i k v i k k b v v o r i g i n c i k v i u k b c i k a n c h o r i k k b c i k b e r t h variable and parameter settings can be seen in table 1 function 9 minimizes the two objectives mentioned in functions 10 and 11 function 10 is the total scheduling time of ships entering and leaving the port in a certain period function 11 is the total emissions for ships at various stages in port waiting at anchorage waiting at berth sailing in the port waterway in a certain period 3 2 1 constraints 12 k 0 b k x i k t 1 i s t t s 13 l k l i x i k t 0 i s k b t t i k b t i k s o u t 14 d k d i x i k t 0 i s k b t t i k b t i k s o u t functions 12 to 14 describes the constraints of ships in berth constraint 12 ensures that each ship can only occupy one berth in the scheduling horizon constraint 13 defines the length of berth should larger than the length of ships constraint 14 indicates the draft condition should be satisfied in the period of berthing 15 t i k s i n m 1 b e r t h i k t t t i k b m 1 b e r t h i k t i u k b t t s 16 t i k c t i k s i n τ i k v 0 i i t i u k b t t s 17 t i k b t i k s i n τ i k v 0 τ i k v 1 τ i k 2 i i t i u k b t t s v v o r g i n v n e w 18 t i k d t i k s o u t τ i k 2 τ i k v 1 i i t i k k b t t s v v o r g i n v n e w 19 t i k s i n t i a i i t 0 i u k b t t s 20 t i k s o u t t i k f i i t 0 i k k b t t s functions 15 to 20 describes the sailing and waiting constraints of ships constraint 15 ensures the assigned berth must be available during the scheduling horizon of ships constraints 16 18 defines the arrival time point including the entry of channel berth the end of channel constraints 19 20 indicates the waiting time of ships in anchorage and berth 21 t i k s i n t j k s i n δ t v i v j b i j δ h v i v j m 1 r i j i j u k b v v o r g i n v n e w 22 t i k c t j k c δ t v i v j b i j δ h v i v j m 1 r i j i j u k b v v o r g i n v n e w t i k c τ i k v 1 t j k c τ j k v 1 δ t v i v j b i j δ h v i v j m 1 r i j 23 i j u k b v v o r g i n v n e w 24 t i k s o u t t j k s o u t δ t v i v j m 1 z i j i j k k b v v o r g i n v n e w 25 t i k s o u t τ i k 2 t j k s o u t τ j k 2 δ t v i v j m 1 z i j i j k k b v v o r g i n v n e w 26 t i k d t j k d δ t v i v j m 1 z i j i j k k b v v o r g i n v n e w functions 21 to 26 describes the safety constraints of ships in the same direction constraints 21 23 ensures the adjacent incoming ships must keep the safety time interval not less than δ t v i v j during the sailing period whether in variable speed or original speed and considering the special safety time δ h v i v j for different sequence of berthing when necessary constraints 24 26 defines the adjacent outcoming ships must keep the safety time interval as well t j k s o u t τ j k 2 t i k c τ i k v 1 δ s v m i m j 2 0 27 i j i u j k k b v v o r g i n v n e w t j k s o u t τ j k v 0 t i k s o u t τ i k v 1 τ i k 2 δ s v m i m j 2 0 28 i j i k j u k b v v o r g i n v n e w functions 27 to 28 describes the safety constraints of ships in the opposite direction constraint 27 defines the outcoming ship j should keep safety time interval δ s v with the incoming ship i constraint 28 indicates the incoming ship j should keep safety time interval δ s v with the outcoming ship i 29 τ i k v 1 l c h a n n e l v i 0 i s k b v v o r g i n v n e w 30 v i k c h a n g e v i k o r i g i n i s k b v i d o r i g i n v o r g i n v i d c h a n g e v n e w 31 v i k c h a n g e v g u i d e i s k b v i d c h a n g e v n e w 32 v i k c h a n g e v m i n i m i z e i s k b v i d c h a n g e v n e w 33 i i t 0 1 i s t t s 34 m i 0 1 i s 35 x i k t 0 1 i s k b t t s 36 r i j 0 1 i j u 37 z i j 0 1 i j k 38 b e r t h i k t 0 1 i u k b t t s 39 b i j 0 1 i j u functions 29 to 32 describes the speed constraints of ships constraint 29 ensures the theoretical sailing time of ships in the channel should not less than the time with average speed constraint 30 indicates the speed after reducing should not larger than the original speed constraint 31 ensures the new speed should larger than the lower bound of speed reduction constraint 32 defines the new speed should larger than the lower bound of sailing speed constraints 33 to 39 specify the types of the decision variables 4 design of the strategies 4 1 introduction of the strategies this paper proposed three emission reduction strategies to testify the effectiveness of the method sssr strategy 3 the design of three strategies can be seen in table 2 strategy 1 is the traditional emission reduction method which is commonly proposed in many literatures and is related to the ship scheduling problem as usual the single objective function in strategy 1 is the total waiting time of ships in port therefore the formulation is as follows 40 m i n i u k b t i k s i n t i a i k k b t i k s o u t t i k f subject to constraints 12 to 29 and 33 to 39 besides changes in emissions due to speed are not tested and v v o r i g i n in constraints strategy 2 is not the optimal problem while considering the vsr plan and the speed reduction plan proposed by hulda winnes et al 2015 strategy 2 set to figure out the feasibility of this method that is to use the actual ship scheduling sequence while reducing the speed for high speed ships appropriately based on navigation safety strategy 3 is the sssr method which uses the multi objective optimization algorithm to optimize the objective functions and constraints are set in chapter 3 2 4 2 algorithms design 4 2 1 improved elitist reserved and adaptive genetic algorithm for strategy 1 algorithm 1 improved elitist reserved and adaptive genetic algorithm ieraga image 1 the ieraga is the improved genetic algorithm the adaptive adjustment of genetic parameters can greatly improve the convergence precision and the speed elite retention strategy can prevent the optimal individual from being destroyed by hybridization it can avoid the local optimum to the greatest extent and maintain the diversity of the population as well as the effectiveness of cross mutation lines 1 to 4 is the population initialization the chromosome is composed of randomly generated non repetitive numbers which consist of ship scheduling sequence entering and leaving the port then it is necessary to fix the chromosome see fig 5 suppose that 9 ships are randomly generated for port sequence u 3 and k 1 are incoming and outgoing ships which using the same berth at this time k 1 occupying the berth does not leave the port while u 3 is ready to enter which does not meet the berth requirements therefore the berth conflict correction should be taken before adding chromosomes to the population lines 6 to 9 calculate the fitness function of the total waiting time of ships in a certain period and update the best solutions from the population lines 10 to 17 are the process of selection crossover and mutation the process of selection adopts the roulette wheel selection method according to the fitness value the crossover and mutation probability are adaptively changed when the population fitness is concentrated and the diversity is poor increases the probability of crossover and mutation when the population fitness is dispersed and the diversity is high decrease the probability the formulation is as follows 41 p c p c 1 p c 1 p c 2 f f m a x p m p m 1 p m 1 p m 2 f f m a x p c 1 and p c 2 are the upper and lower bounds of crossover probability p m 1 and p m 2 are the upper and lower bounds of mutation probability f is the average fitness of each generation population f m a x is the max value of the average fitness of each generation population line 11 updates the probability for a new generation the crossover of the chromosome adopts the single point crossover see fig 6 which indicates in lines 12 to 14 randomly select the intersection point for single point crossing the mapping relationship is used to replace the conflicting chromosomes so that two new chromosomes are obtained after crossing the berth conflict correction should be taken the process of mutation adopts multi points mutation which indicates in lines 15 to 17 randomly select the mutation points and ensure the ship number after mutation then search the same ship number of the point in the chromosome replace it to a new number the mutation process can be completed after several operations after mutation the berth conflict correction should be taken lines 18 to 19 are the elitist reserved strategy the parents and offspring after selection crossover and mutation are combined to a population with twice size a new generation population is formed successively with the low fitness value chromosomes in the population so that the individuals with good characteristics can be retained in each iteration process which is conducive to the protection of excellent genes in the genetic process 4 2 2 non dominated sorting genetic algorithm nsga ii for strategy 3 algorithm 2 non dominated sorting genetic algorithm nsga ii image 2 nsga ii is used to solve multi objective optimization models the new fast non dominated sorting algorithm based on hierarchy is proposed to reduce the complexity of the algorithm also an elite strategy is introduced to enlarge the sampling space the congestion degree and congestion comparison operator are proposed to ensure the evenly distributed of solutions see fig 7 this algorithm is suitable for solving the problem of ship traffic optimization problem lines 1 to 4 are the population initialization the chromosome is composed of randomly generated non repetitive numbers which are the ship scheduling and speed sequence the speed sequence consists of actual original low speed and reduction speed for high speed ships then the berth conflict correction is taken lines 5 to 22 are the main structure of this algorithm the objective values are the total scheduling time of ships and the total carbon emissions of ships in port after fast non dominated sort and through selection crossover and mutation the group is combined with the offspring to form a new group with twice the size of the population the new group is hierarchical after fast non dominated sort and crowding distance calculation and the population is stratified according to the level of individual non inferior solution according to the elite strategy selection algorithm the new groups are added in order according to the hierarchical level and then the pareto front is obtained after the iteration 5 example analysis 5 1 description of the port a coastal port which applies one way navigation in the channel in northern china is adopted in this paper as an example as a coal transfer port there is a large number of ships berthing in this port every year the pollution in the port area mainly comes from emissions from ships in recent years a variety of pollution control measures have been taken including establishing a green port index system with water environment atmospheric environment and the acoustic environment as the main contents promoting the use of ship shore power technology optimizing ship traffic management etc reducing port pollution and emissions is the key to build a green port in the future 5 2 parameter setting data of 29 ships entering and leaving the port on a certain day in 2018 are selected as the input parameters of ships for analysis ship scheduling according to one way navigation rules in the port area for ships fuel consumption rate of the engine and other relevant data related to carbon emission calculation which are not obtained from real data according to second imo ghg study 2009 propulsion trends in bulk carriers gbt 51305 2018 technical standard for ship shore power facilities of wharf relevant values and calculation are carried out by the different tonnage of ships for emissions of real ships in port this paper calculates the emissions by real ships data according to the formulations mentioned in chapter 2 1 for the speed reduction range of high speed ships referring winnes et al 2015 to set 10 knots as the lower bound of reduction speed that is to say a high speed ship is defined as a ship with an average speed of more than 10 knots if the speed is properly reduced it should be less than the original speed and greater than 10 knots and the average speed which not exceed 10 knots should keep the original speed parameters of ships can be seen in table 3 the settings of the two genetic algorithms are as follows the initially crossover and mutation probability are set to 0 95 and 0 1 the size of the population is set as 200 moreover based on a series of trial experiments it is found that the curves always converge around generation 200 and solutions remain unchanged after about 200 iterations therefore to ensure the efficiency and validity of the algorithms the maximum iteration number is set as 500 for both algorithms 5 3 results analysis the results are shown in figs 8 and 9 the ieraga algorithm converges in generation 200 and faster to reach stable than the simple genetic algorithm by comparing with the first come first served fcfs strategy actual ship scheduling of port optimization of simple genetic algorithm the results can be seen from fig 8 the actual ship scheduling is based on a certain experience and the target value still has some optimization space the total waiting time of ships can decrease by 10 2 and the waiting emissions of ships can decrease by 16 4 by optimizing the ship scheduling sequence not adjusting the speed of ships can significantly reduce the waiting emissions of ships in port which is an effective measure to reduce the emission of ships in port strategy 2 takes speed reduction measures for high speed ships while not changing the ship scheduling sequence see fig 10 by reducing the speed for 5 10 15 and to the lower bound are considered the total sailing emissions of ships and total sailing time in a certain period are calculated when reducing 5 of the speed the total sailing emissions can decrease by 0 863 thousand tons while the total sailing time increases 21 min when reducing 10 the total sailing emissions can decrease 1 65 thousand tons while the total sailing time increases 45 min when reducing 15 the total sailing emissions can decrease 2 269 thousand tons while the total sailing time increases 65 min when reducing to the lower bound the total sailing emissions can decrease 2 927 thousand tons while the total sailing time increases 91 min speed reduction can significantly reduce the sailing emissions however it will also influence the navigation of ships in the port waterway there is an opposite relationship between ship sailing carbon emissions and ship navigation efficiency therefore the method of ship speed reduction will affect the overall navigation efficiency and safety of the port which has both advantages and disadvantages strategy 3 sssr optimizes the ship scheduling sequence and speed of high speed ships the objective functions are total scheduling time of ships in a certain period and total emissions of ships in different stages of port operation waiting in port sailing in a port waterway 18 pareto optimal solutions are obtained while two objectives are better than those under the actual port ship scheduling the 18 optimal solutions and the general feasible solutions are shown in fig 11 obviously the optimal solutions in the pareto optimal front are not dominated by any other solutions and are relatively evenly distributed besides the converge curves of two objective functions in nsga ii algorithm are performed in fig 12 the effectiveness of the algorithm can be verified table 4 shows the values of the 18 pareto optimal solutions according to table 4 the total ship scheduling time can decrease by 6 215 at most the total emissions of ships in different stages of port operation can decrease 11 935 at most after optimization the total waiting time of ships in port is reduced in 277 360 min and the increase in total navigation time caused by speed reduction is distributed in 37 79 min as shown in fig 13 the results imply that the influence of some high speed ships on navigation efficiency in a certain period can be compensated by optimizing the scheduling sequence of ships in port waterway by using the sssr method fig 14 shows the total scheduling time and carbon emissions of ships in port by using different strategies strategy 1 can significantly decrease the waiting time of ships in port and reduce the waiting emissions of ships partially moreover this can also be an effective way for many ports two values of strategy 2 are obtained by reducing all high speed ships to the lower bound in this way the emissions of ships can be greatly reduced but the scheduling time will largely increase simultaneously this is because of increased sailing time caused by speed reduction compared with the actual data the 18 solutions in strategy 3 sssr can simultaneously decrease the emissions of ships and the scheduling time significantly the sssr method outperforms the traditional strategy 1 by reducing emissions of ships at various stages in port which has enormous potential because of the speed reduction in sssr the total scheduling time of ships are a little larger than the strategy 1 but there is no doubt that it is an effective method to decrease emissions and increase traffic efficiency 6 conclusions and discussions in this paper the new emissions reduction method sssr of ships in port is proposed three strategies are constructed to study the effectiveness of this method the conclusions are as follows 1 by optimizing the scheduling sequence of ships entering and leaving the port within a certain period alone the excessive waiting time of ships in port and the corresponding carbon emission can be reduced optimizing ship scheduling sequence is one of the feasible measures to reduce the carbon emission of ships in port however only focus on one stage ships entering and leaving the port are tackled 2 the carbon emissions can be reduced by appropriately reducing the speed of ships sailing in the port however since the speed reduction of ships will negatively affect the navigation efficiency and safety of ships in the port area the feasibility and necessity of the ship speed reduction measures need to be considered 3 by optimizing the scheduling sequence of ships entering and leaving the port in a certain period and reducing the speed of high speed ships the total scheduling time and total carbon emissions of ships in port can be effectively reduced in the sssr method by taking measures the influence of ship speed reduction measures alone on waterway traffic of ships can be compensated the newly developed sssr method can not only make the transport of ships more efficient but also reduce the carbon emissions of ships in the port to achieve a low carbon environment the relevant research and methods in this paper can be used to solve the problem of ship emission reduction in port and can also be applied to other similar ports moreover it can support the construction of a green port credit authorship contribution statement zicheng xia conceptualization methodology formal analysis writing original draft zijian guo methodology software formal analysis writing original draft wenyuan wang investigation resources writing review editing ying jiang data curation validation visualization writing original draft supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we would like to acknowledge the support of national key research and development program of china no 2020yfe0201200 and the support of national natural science foundation of china no 51779037 and thank for supporting this research 
20671,ship emissions is one of the main components of port pollution inefficient waterway management may not only result in additional waiting time of ships but also the aggravated emissions in port with special consideration of combining scheduling optimization and speed reduction of ships in port this paper proposed a new emission reduction method called ship scheduling with speed reduction sssr performance of the sssr method has been testified through comparisons between the new and traditional ship emission reduction methods based on the navigation safety under three different strategies the effectiveness of the new ship emission reduction method has been testified through a series of experiments with practical data in port especially under various stages in port the emissions of ships can be reduced by 8 0 11 9 and the traffic efficiency can be improved by 3 8 6 2 keywords emission reduction ship scheduling speed reduction optimization algorithm port waterway 1 introduction marine transportation has become the main force of international trade which accounts for roughly 80 the quality of transport service is greatly affected by the efficiency of port management meanwhile the increasing number of ships also brings big challenges to the port and waterway capacity which greatly influences on the port ecological environment and waterway efficiency different stages of ship operations in port will cause various types of emissions and impede the construction of the green port villalba and gemechu 2011 furthermore there is no unified approach to reduce ship emissions of various stages all together therefore it is necessary to investigate how to reduce ship emissions at various stages in port simultaneously ships waiting in port and sailing in the waterway are the key stages of ships in port which associated with ship scheduling and speed controlling improper scheduling of ships in port will lead to serious congestion problem and affect the implementation of scheduled berthing and departure plans for inbound and outbound ships resulting in abundant delay especially for one way channel in port for navigation safety ships from opposite direction cannot enter the channel at the same time in the one way channel total waiting time of ships can judge the navigation efficiency of port waterway thus efforts of existing literatures are mainly focusing on the reduction of ships waiting time by using different optimization methods in consideration of scheduling order travel direction and distance of the berth for ships by using improved genetic algorithm zhang et al 2016 can significantly reduce ship s waiting time by scheduling the incoming and outgoing ships through different waterways the mathematical model and heuristics can minimize ship s waiting time as well as reducing the emissions of ships while waiting in the port waterway lalla et al 2018 during heavy traffic conditions ship s arrival and departure in the port area depend on the scheduling sequence of ships which can reduce the cost of berthing and delay by using mixed integer linear programming li and jia 2019 furthermore the ship scheduling problem not only appears in the port waterway but also in inland waterway canal and transit under the influence of geographical environment weather navigation rules etc there are navigation restrictions on the ships to improve the navigation efficiency of ships in the waterway optimal scheduling is also adopted as mentioned by many researchers traffic congestion in inland controlled waterway caused by narrow channel poor natural conditions and insufficient throughput capacity of locks has become the compelling problem the sorted vessel sequence and traffic commands are proposed to improve the efficiency and accuracy of the vessel traffic scheduling reducing the traveling time liang et al 2019 the adequate safety self organizing scheduling model is proposed to ensure the safety and efficiency of vessels in restricted waterway xin et al 2019 in order to avoid excessive time wasted in waiting for lock service the water land transshipment co scheduling lwtc problem is tackled by hybrid heuristic method liu et al 2020 the ant q algorithm is proposed for the ship lock arrangement to improve the ship lock navigable capability in inland waterway ji et al 2020 for navigation limitation of the narrow part of the canal changing speed setting the sideline capacity and limiting for waiting time of ships are set to minimize the total sailing time of ships meisel and fagerholt 2019 for the transit a mathematical formulation of scheduling by prioritizing of ships is put forward to increase the traffic management efficiency ulusçu et al 2009 studies of ship scheduling mainly focus on the traffic efficiency of ships in waterway besides few literatures combine the ship emissions problem with the ship scheduling this can also provide a ship emission reduction method appropriately emissions from ships will affect the ecological environment of the ocean and construction of the green port emission reduction measures have been considered in many kinds of literatures for the consideration of fuel consumption the fuel replacement of different tonnage and types of ships have been discussed on the effectiveness of emissions reduction wan et al 2019 for the connection between traffic efficiency with emissions the possibility of improving energy efficiency by reducing the waiting time of ships in port have been discussed in detail johnson and styhre 2015 besides several emission reduction measures are proposed together for comparison speed reduction decreasing the auxiliary time of berthing improving the efficiency of port facilities using the on shore power supply and alternative fuels are put forward for comparison peng et al 2018 also macro measures including alternative fuels design measures and operational measures are proposed respectively winnes et al 2015 speed is closely related to fuel consumption of marine engines as well as the emissions even a small change of the speed will greatly influence the emissions nowadays many works focus on the optimization of speed have been conducted under the condition of strictly limiting emissions in emission control area eca speed optimization method can maximize navigation profit fagerholt and psaraftis 2015 and minimize cost of ships sheng et al 2019 in consideration of ship s route conserve energy and reduce emissions are deemed necessary by speed optimization kim and lee 2018 also a speed optimization model can be established by the ship log data which can effectively reduce the fuel cost of the ship and minimize the fuel operating cost gusti 2017 over a voyage of ships a two phase optimal solution framework considering sailing speed displacement trim weather and sea conditions on ship fuel eﬃciency is quantified by adjusting its sailing speeds and trim settings can minimize ship s bunker fuel consumption significantly du et al 2019 from the above speed optimization can not only be a simple change at the operational level but also play a significant role in changing emissions and increasing revenue vessel speed reduction vsr is a program adopted by ports of los angeles long beach san diego new york new jersey and some ports of korea the objective of this program is to reduce emissions from ships by slowing their speeds as they approach or depart the port take a reference of this program an activity based model to calculate fuel consumption and emissions of ships entering kaohsiung port has been proposed chang and jhang 2016 results show that carbon emissions can be reduced by about 40 after decreasing the speed to 12 knots however there are some problems with the measures of speed reduction for ships substantially reduction will destroy the engines hence there is a limitation of reduction range and the speed has a curve relationship with the fuel consumption du et al 2011 for the shipping company speed reduction may delay the sailing date and route plan as well as the sailing cost of ships study of the feasibility of implementing the slow steaming strategies by shipping companies indicates that this strategy is sustainable in the long run cariou 2011 also the researchers estimated the economic speed of routes and explored the policy impact of fuel tax and speed reduction measures on carbon emissions corbett et al 2009 the speed reduction may have negative economic impact on the company otherwise for the applicability speed reduction method only focuses on the sailing stage of ships the emission reduction methods mentioned by existing literature mainly focus on one stage or one operation adopted by ships in port it is necessary to explore whether one method can reduce the emissions from various stages of ships in port nowadays ships enter or leave with higher speed in some ports higher speed will not only affect the navigation safety of ships but also produce excessive ship emissions meanwhile inefficient ship scheduling will make ships too much waiting in anchorage and berths resulting in additional emissions the kinds of literature on ship scheduling problems mostly focus on traffic navigation efficiency as well as decreasing the waiting time of ships which can also promote the emission reduction of ships therefore this paper summarizes the existing measures of ship emission reduction and combined with the ship scheduling problem to establish a new ship emission reduction method in port this paper is structured as follows chapter 1 is the introduction with literature review the second chapter describes relevant concepts and theories in this study chapter 3 introduces the mathematical model of the proposed method chapter 4 is the strategy design followed by the example analysis in chapter 5 finally conclusion and discussions are given in chapter 6 2 relevant concepts and theories ship scheduling in port waterway is mostly based on experience inefficient scheduling may lead to the long waiting time of ships and more fuel energy consumption may result in a large number of emissions in the port area meanwhile ships sailing in the waterway with higher speed may also produce additional emissions this paper explores the feasibility of reducing ship emissions in port through efficient ship scheduling and speed reduction measures to study whether ship scheduling can be combined with speed reduction and propose the solution of efficient ship scheduling method with low carbon operations of ships in port based on navigation safety 2 1 carbon emission formulation in port operations of ships in port refers to 4 stages including waiting at berth or anchorage sailing in port waterway auxiliary operations loading and unloading operations in different operation stages main and auxiliary engines will have different fuel consumptions and produce carbon emissions which can be calculated according to iso14064 1 2006 and ipcc 2006 the relationship between energy consumptions and carbon emission as follows 1 c f i e n e r g y where c represents the carbon emission f represents the energy consumption i e n e r g y represents the coefficient of carbon emission which can be obtained according to the work of endresen et al 2007 and ipcc 2006 2 1 1 sailing emissions of ships in the port waterway at the stage of sailing in the port waterway fuel consumptions of the main engine is approximately cubic related to the speed of ship corbett et al 2009 according to peng et al 2018 the formulation as follows 2 f j i s h i p s a i l p i m r j m l m v i 0 v i d 3 n p i a r j a l a d v i 0 where f j i s h i p s a i l represents the fuel consumption of ship i with different types of engines j p i m and p i a represent the main engine power and auxiliary engine power of ship i r j m and r j a represent the consumption rates of main and auxiliary engines l m and l a represent the load coefficients of main and auxiliary engines which are set to 0 8 and 0 5 n represents the number of the auxiliary engines v i 0 and v i d represent the actual speed and design speed of ships respectively d represents the sailing distances of ships 2 1 2 waiting emissions of ships in the port waterway the waiting stage of ships including waiting at anchorage to enter the port and waiting at berth to leave the port only auxiliary engine works the formulation as follows 3 f j i s h i p a n c h o r l a p i a r j a t i a n c h o r 4 f j i s h i p b e r t h l a p i a r j a t i b e r t h where f j i s h i p a n c h o r represents the fuel consumption of ship i with different types of engines j at anchorage p i a represents the auxiliary engine power of ship i r j a represents the consumption rates of auxiliary engines l a represents the load coefficients of auxiliary engines t i a n c h o r represents the waiting time of ship i at anchorage f j i s h i p b e r t h represents the fuel consumption of ship i with different types of engines j at berth t i b e r t h represents the waiting time of ship i at berth 2 2 navigation safety of ships in the port waterway in port waterway the safe time interval between ships is relevant to speed length width and distance of ships ship domain is an ellipse centered on a ship fuji and tanaka 1971 the size of ship domain is 6 l 1 6 l which means the length of the longitudinal axis is 6 times the length of the ship s length and the length of the horizontal axis is 1 6 times the width of the ship s length the size of a large ship with a tonnage of 200 000 tons or more is 8 l 3 2 l to ensure the navigation safety of ships the distance between ships will change when the speed is variable and the minimum distance between ships is the sum of the longitudinal axes of the ship domain wang et al 2018 proposed a concept of ship s critical time interval and formulated a calculation method of ship safety time distance under variable speed from the perspective of ship scheduling in port the speed reduction of ships will also affect the navigation safety of adjacent ships therefore this paper proposes the safety time calculation framework of adjacent ships considering various conditions fig 1 5 δ t v i v j d t v j v j v i 6 δ t v i v j l c h a n n e l v i l c h a n n e l d t v j v j v i this paper discusses the impact of speed reduction on emission therefore only the active speed reduction behavior is focused in port waterway when the speed of the following ship is less than the front ship the distance between ships will increase so the ships only need to keep the minimum distance when start sailing when the speed of the following ship is larger than the front ship the safe time interval can be obtained based on equation 6 in this situation the following ship should pay more attention to keep the distance from the front ship in the worst case the minimum distance should be the sum of the longitudinal axes of the ship domain the distance between ships is related to the interval between sailing start time this paper provides that the following ship should calculate the time interval between the front ship before starting to sail and judge if the time interval satisfies the critical time interval δ t v i v j that is the time interval when the distance of the following ship and the front ship at the end of navigation in the channel is the minimum safe distance between the adjacent approach channel time difference as shown in equation 6 if the time interval is less than δ t v i v j the following ship should wait until satisfy 7 d s 6 m a x l i l j 8 δ s v d s v j there is a ship encounter situation while ships entering and leaving the port at the entrance of the one way channel see fig 2 to keep safety navigation the distance between ships can be calculated based on equation 7 the distance between ships with opposite direction is six times the length of the longer ship the equation of the time interval is shown in equation 8 to ensure the navigation safety of adjacent ships the distance between ships in the same direction required a safety distance d h which is added based on d t when the front ship berths nearly see fig 3 that is to produce a safe distance for the following ship when the front ship is in auxiliary operation the safe time interval needs to add the berthing time based on δ t v i v j when the front ship berths far away the safe distance of ships can be calculated without considering d h 2 3 new emission reduction method for ships in port emission reduction measurements for ships in port mainly include reducing the speed of ships entering and leaving the port decreasing the waiting time of ships at anchorage or berth adjusting the operations of ships to avoid large scale maneuver using shore side electricity technology using alternative fuels etc this paper mainly focuses on the measurements of traffic management including speed reduction and decreases the waiting time of ships in the port waterway and proposes a new emission reduction method 2 3 1 decrease waiting time of ships the increasing number of ships have a large influence on port waterway traffic constrained by the large density of the arrival and departure ships in port the severe weather or the cargos that ship demand are not prepared in time most arrival ships wait at anchorage for entering the port and departure ships wait at berth for leaving the port too much waiting time will cause a large number of emissions there should be a rational scheduling way to keep safety efficient and low carbon the waiting time of ships at anchorage and berth can be reduced by optimizing the ship scheduling sequence zhang et al 2016 and is an efficient method to reduce the waiting emissions of ships in port winnes et al 2015 2 3 2 ship speed reduction fuel consumptions of the main engine is approximately cubic related to the speed of ships corbett et al 2009 reduction on 10 of speed can save 27 fuel consumption of ships therefore it is an effective way to reduce the sailing emissions of ships by speed reduction on the sea ship speed reduction can effectively reduce fuel consumption and emissions and protect the ecological environment of the ocean however under the influence of ship scheduling rent and operation cost weather environment and other factors it is necessary to optimize the speed considering multiple factors nowadays some ports in developed countries take the vessel speed reduction vsr plan to encourage reducing the speed to 10 knots for ships sailing close and leaving the port over the years this plan has an obvious effect on the environmental protection of the port however this plan will have some impacts on the waterway traffic firstly in most ports overtaking of ships is not allowed it means that the following ship should take actions to maintain the safe distance when front ship reduces the speed either change course or reduce speed this will impose a negative influence on the safe navigation of ships in the port waterway secondly speed reduction will have an influence on the sailing time as well as the sailing date the reduction of speed may delay navigation efficiency thirdly if ships with low speed while sailing in the port waterway take the speed reduction action the engines may be destroyed and increase the emissions on the contrary thus there is a limit range for speed reduction multiple factors should be considered when taking the speed reduction action alone in the port area to reduce the emissions 2 3 3 new method approach different stages of ships in port will cause various emissions optimizing the ship scheduling sequence can reduce the waiting time of ships in port and mitigate the waiting emissions reducing the speed of high speed ships will reduce the sailing emissions in the port waterway the ship scheduling with speed reduction sssr method is proposed to optimize ship scheduling sequence and reduce speed for high speed ships together in this paper see fig 4 it can be used for the ports which have some high speed ships entering or leaving generally the ship s speed may be limited by the navigation rules while sailing at the low speed in some ports there is no need to reduce speed further besides excessive deceleration can damage engines as well as decreasing navigational efficiency in vessel speed reduction vsr program which has been discussed in chapter 2 3 2 thus sssr is not applicable to all ports only the waterway is long enough which can contain multiple ships at the same time and few ships have relatively high speed which exceed 10 knots can this method be used in sssr speed reduction will increase the sailing time if the increase of sailing time is greater than the decrease of waiting time it will influence the traffic efficiency of the waterway therefore traffic efficiency as well as emissions should be investigated together by optimizing the ship scheduling and speed reduction there should be two objectives which are the total scheduling time of ships and the total emissions of ships in port the total emissions in this paper are the emissions that can be reduced by traffic management including sailing emissions and waiting emissions moreover the sssr method will influence the distance between ships by changing the scheduling sequence and speed the safety time interval and distance mentioned in section 2 2 should also be guaranteed to ensure the safety navigation 3 construction of the sssr model 3 1 model assumptions this paper studies the problem of ship emission reduction in port under the ideal conditions before building the model the following assumptions are put forward for the relevant problems 1 the hydrometeorological conditions in this period can meet the requirements of ships operations the anchorage capacity is sufficient the berthing operation plan has been formulated in advance and berth allocation is not considered 2 ships entering and leaving the port while sailing at the average speed 3 the scope of ships entering and leaving port is from anchorage entering the port area to berth and ship completion to leave port area respectively 4 the study only considers the process of using its own power equipment to sail in the port area and does not consider the use of tugs to pull in and leave the wharf 5 the ship reduction in this paper is the active reduction behavior of ships and the passive reduction behavior affected by traffic flow is not considered 3 2 variable and parameter setting 9 m i n i m i z e e c 10 e i u k b t i k b t i a i k k b t i k d t i k f 11 c i u k b v v n e w c i k v i k k b v v o r i g i n c i k v i u k b c i k a n c h o r i k k b c i k b e r t h variable and parameter settings can be seen in table 1 function 9 minimizes the two objectives mentioned in functions 10 and 11 function 10 is the total scheduling time of ships entering and leaving the port in a certain period function 11 is the total emissions for ships at various stages in port waiting at anchorage waiting at berth sailing in the port waterway in a certain period 3 2 1 constraints 12 k 0 b k x i k t 1 i s t t s 13 l k l i x i k t 0 i s k b t t i k b t i k s o u t 14 d k d i x i k t 0 i s k b t t i k b t i k s o u t functions 12 to 14 describes the constraints of ships in berth constraint 12 ensures that each ship can only occupy one berth in the scheduling horizon constraint 13 defines the length of berth should larger than the length of ships constraint 14 indicates the draft condition should be satisfied in the period of berthing 15 t i k s i n m 1 b e r t h i k t t t i k b m 1 b e r t h i k t i u k b t t s 16 t i k c t i k s i n τ i k v 0 i i t i u k b t t s 17 t i k b t i k s i n τ i k v 0 τ i k v 1 τ i k 2 i i t i u k b t t s v v o r g i n v n e w 18 t i k d t i k s o u t τ i k 2 τ i k v 1 i i t i k k b t t s v v o r g i n v n e w 19 t i k s i n t i a i i t 0 i u k b t t s 20 t i k s o u t t i k f i i t 0 i k k b t t s functions 15 to 20 describes the sailing and waiting constraints of ships constraint 15 ensures the assigned berth must be available during the scheduling horizon of ships constraints 16 18 defines the arrival time point including the entry of channel berth the end of channel constraints 19 20 indicates the waiting time of ships in anchorage and berth 21 t i k s i n t j k s i n δ t v i v j b i j δ h v i v j m 1 r i j i j u k b v v o r g i n v n e w 22 t i k c t j k c δ t v i v j b i j δ h v i v j m 1 r i j i j u k b v v o r g i n v n e w t i k c τ i k v 1 t j k c τ j k v 1 δ t v i v j b i j δ h v i v j m 1 r i j 23 i j u k b v v o r g i n v n e w 24 t i k s o u t t j k s o u t δ t v i v j m 1 z i j i j k k b v v o r g i n v n e w 25 t i k s o u t τ i k 2 t j k s o u t τ j k 2 δ t v i v j m 1 z i j i j k k b v v o r g i n v n e w 26 t i k d t j k d δ t v i v j m 1 z i j i j k k b v v o r g i n v n e w functions 21 to 26 describes the safety constraints of ships in the same direction constraints 21 23 ensures the adjacent incoming ships must keep the safety time interval not less than δ t v i v j during the sailing period whether in variable speed or original speed and considering the special safety time δ h v i v j for different sequence of berthing when necessary constraints 24 26 defines the adjacent outcoming ships must keep the safety time interval as well t j k s o u t τ j k 2 t i k c τ i k v 1 δ s v m i m j 2 0 27 i j i u j k k b v v o r g i n v n e w t j k s o u t τ j k v 0 t i k s o u t τ i k v 1 τ i k 2 δ s v m i m j 2 0 28 i j i k j u k b v v o r g i n v n e w functions 27 to 28 describes the safety constraints of ships in the opposite direction constraint 27 defines the outcoming ship j should keep safety time interval δ s v with the incoming ship i constraint 28 indicates the incoming ship j should keep safety time interval δ s v with the outcoming ship i 29 τ i k v 1 l c h a n n e l v i 0 i s k b v v o r g i n v n e w 30 v i k c h a n g e v i k o r i g i n i s k b v i d o r i g i n v o r g i n v i d c h a n g e v n e w 31 v i k c h a n g e v g u i d e i s k b v i d c h a n g e v n e w 32 v i k c h a n g e v m i n i m i z e i s k b v i d c h a n g e v n e w 33 i i t 0 1 i s t t s 34 m i 0 1 i s 35 x i k t 0 1 i s k b t t s 36 r i j 0 1 i j u 37 z i j 0 1 i j k 38 b e r t h i k t 0 1 i u k b t t s 39 b i j 0 1 i j u functions 29 to 32 describes the speed constraints of ships constraint 29 ensures the theoretical sailing time of ships in the channel should not less than the time with average speed constraint 30 indicates the speed after reducing should not larger than the original speed constraint 31 ensures the new speed should larger than the lower bound of speed reduction constraint 32 defines the new speed should larger than the lower bound of sailing speed constraints 33 to 39 specify the types of the decision variables 4 design of the strategies 4 1 introduction of the strategies this paper proposed three emission reduction strategies to testify the effectiveness of the method sssr strategy 3 the design of three strategies can be seen in table 2 strategy 1 is the traditional emission reduction method which is commonly proposed in many literatures and is related to the ship scheduling problem as usual the single objective function in strategy 1 is the total waiting time of ships in port therefore the formulation is as follows 40 m i n i u k b t i k s i n t i a i k k b t i k s o u t t i k f subject to constraints 12 to 29 and 33 to 39 besides changes in emissions due to speed are not tested and v v o r i g i n in constraints strategy 2 is not the optimal problem while considering the vsr plan and the speed reduction plan proposed by hulda winnes et al 2015 strategy 2 set to figure out the feasibility of this method that is to use the actual ship scheduling sequence while reducing the speed for high speed ships appropriately based on navigation safety strategy 3 is the sssr method which uses the multi objective optimization algorithm to optimize the objective functions and constraints are set in chapter 3 2 4 2 algorithms design 4 2 1 improved elitist reserved and adaptive genetic algorithm for strategy 1 algorithm 1 improved elitist reserved and adaptive genetic algorithm ieraga image 1 the ieraga is the improved genetic algorithm the adaptive adjustment of genetic parameters can greatly improve the convergence precision and the speed elite retention strategy can prevent the optimal individual from being destroyed by hybridization it can avoid the local optimum to the greatest extent and maintain the diversity of the population as well as the effectiveness of cross mutation lines 1 to 4 is the population initialization the chromosome is composed of randomly generated non repetitive numbers which consist of ship scheduling sequence entering and leaving the port then it is necessary to fix the chromosome see fig 5 suppose that 9 ships are randomly generated for port sequence u 3 and k 1 are incoming and outgoing ships which using the same berth at this time k 1 occupying the berth does not leave the port while u 3 is ready to enter which does not meet the berth requirements therefore the berth conflict correction should be taken before adding chromosomes to the population lines 6 to 9 calculate the fitness function of the total waiting time of ships in a certain period and update the best solutions from the population lines 10 to 17 are the process of selection crossover and mutation the process of selection adopts the roulette wheel selection method according to the fitness value the crossover and mutation probability are adaptively changed when the population fitness is concentrated and the diversity is poor increases the probability of crossover and mutation when the population fitness is dispersed and the diversity is high decrease the probability the formulation is as follows 41 p c p c 1 p c 1 p c 2 f f m a x p m p m 1 p m 1 p m 2 f f m a x p c 1 and p c 2 are the upper and lower bounds of crossover probability p m 1 and p m 2 are the upper and lower bounds of mutation probability f is the average fitness of each generation population f m a x is the max value of the average fitness of each generation population line 11 updates the probability for a new generation the crossover of the chromosome adopts the single point crossover see fig 6 which indicates in lines 12 to 14 randomly select the intersection point for single point crossing the mapping relationship is used to replace the conflicting chromosomes so that two new chromosomes are obtained after crossing the berth conflict correction should be taken the process of mutation adopts multi points mutation which indicates in lines 15 to 17 randomly select the mutation points and ensure the ship number after mutation then search the same ship number of the point in the chromosome replace it to a new number the mutation process can be completed after several operations after mutation the berth conflict correction should be taken lines 18 to 19 are the elitist reserved strategy the parents and offspring after selection crossover and mutation are combined to a population with twice size a new generation population is formed successively with the low fitness value chromosomes in the population so that the individuals with good characteristics can be retained in each iteration process which is conducive to the protection of excellent genes in the genetic process 4 2 2 non dominated sorting genetic algorithm nsga ii for strategy 3 algorithm 2 non dominated sorting genetic algorithm nsga ii image 2 nsga ii is used to solve multi objective optimization models the new fast non dominated sorting algorithm based on hierarchy is proposed to reduce the complexity of the algorithm also an elite strategy is introduced to enlarge the sampling space the congestion degree and congestion comparison operator are proposed to ensure the evenly distributed of solutions see fig 7 this algorithm is suitable for solving the problem of ship traffic optimization problem lines 1 to 4 are the population initialization the chromosome is composed of randomly generated non repetitive numbers which are the ship scheduling and speed sequence the speed sequence consists of actual original low speed and reduction speed for high speed ships then the berth conflict correction is taken lines 5 to 22 are the main structure of this algorithm the objective values are the total scheduling time of ships and the total carbon emissions of ships in port after fast non dominated sort and through selection crossover and mutation the group is combined with the offspring to form a new group with twice the size of the population the new group is hierarchical after fast non dominated sort and crowding distance calculation and the population is stratified according to the level of individual non inferior solution according to the elite strategy selection algorithm the new groups are added in order according to the hierarchical level and then the pareto front is obtained after the iteration 5 example analysis 5 1 description of the port a coastal port which applies one way navigation in the channel in northern china is adopted in this paper as an example as a coal transfer port there is a large number of ships berthing in this port every year the pollution in the port area mainly comes from emissions from ships in recent years a variety of pollution control measures have been taken including establishing a green port index system with water environment atmospheric environment and the acoustic environment as the main contents promoting the use of ship shore power technology optimizing ship traffic management etc reducing port pollution and emissions is the key to build a green port in the future 5 2 parameter setting data of 29 ships entering and leaving the port on a certain day in 2018 are selected as the input parameters of ships for analysis ship scheduling according to one way navigation rules in the port area for ships fuel consumption rate of the engine and other relevant data related to carbon emission calculation which are not obtained from real data according to second imo ghg study 2009 propulsion trends in bulk carriers gbt 51305 2018 technical standard for ship shore power facilities of wharf relevant values and calculation are carried out by the different tonnage of ships for emissions of real ships in port this paper calculates the emissions by real ships data according to the formulations mentioned in chapter 2 1 for the speed reduction range of high speed ships referring winnes et al 2015 to set 10 knots as the lower bound of reduction speed that is to say a high speed ship is defined as a ship with an average speed of more than 10 knots if the speed is properly reduced it should be less than the original speed and greater than 10 knots and the average speed which not exceed 10 knots should keep the original speed parameters of ships can be seen in table 3 the settings of the two genetic algorithms are as follows the initially crossover and mutation probability are set to 0 95 and 0 1 the size of the population is set as 200 moreover based on a series of trial experiments it is found that the curves always converge around generation 200 and solutions remain unchanged after about 200 iterations therefore to ensure the efficiency and validity of the algorithms the maximum iteration number is set as 500 for both algorithms 5 3 results analysis the results are shown in figs 8 and 9 the ieraga algorithm converges in generation 200 and faster to reach stable than the simple genetic algorithm by comparing with the first come first served fcfs strategy actual ship scheduling of port optimization of simple genetic algorithm the results can be seen from fig 8 the actual ship scheduling is based on a certain experience and the target value still has some optimization space the total waiting time of ships can decrease by 10 2 and the waiting emissions of ships can decrease by 16 4 by optimizing the ship scheduling sequence not adjusting the speed of ships can significantly reduce the waiting emissions of ships in port which is an effective measure to reduce the emission of ships in port strategy 2 takes speed reduction measures for high speed ships while not changing the ship scheduling sequence see fig 10 by reducing the speed for 5 10 15 and to the lower bound are considered the total sailing emissions of ships and total sailing time in a certain period are calculated when reducing 5 of the speed the total sailing emissions can decrease by 0 863 thousand tons while the total sailing time increases 21 min when reducing 10 the total sailing emissions can decrease 1 65 thousand tons while the total sailing time increases 45 min when reducing 15 the total sailing emissions can decrease 2 269 thousand tons while the total sailing time increases 65 min when reducing to the lower bound the total sailing emissions can decrease 2 927 thousand tons while the total sailing time increases 91 min speed reduction can significantly reduce the sailing emissions however it will also influence the navigation of ships in the port waterway there is an opposite relationship between ship sailing carbon emissions and ship navigation efficiency therefore the method of ship speed reduction will affect the overall navigation efficiency and safety of the port which has both advantages and disadvantages strategy 3 sssr optimizes the ship scheduling sequence and speed of high speed ships the objective functions are total scheduling time of ships in a certain period and total emissions of ships in different stages of port operation waiting in port sailing in a port waterway 18 pareto optimal solutions are obtained while two objectives are better than those under the actual port ship scheduling the 18 optimal solutions and the general feasible solutions are shown in fig 11 obviously the optimal solutions in the pareto optimal front are not dominated by any other solutions and are relatively evenly distributed besides the converge curves of two objective functions in nsga ii algorithm are performed in fig 12 the effectiveness of the algorithm can be verified table 4 shows the values of the 18 pareto optimal solutions according to table 4 the total ship scheduling time can decrease by 6 215 at most the total emissions of ships in different stages of port operation can decrease 11 935 at most after optimization the total waiting time of ships in port is reduced in 277 360 min and the increase in total navigation time caused by speed reduction is distributed in 37 79 min as shown in fig 13 the results imply that the influence of some high speed ships on navigation efficiency in a certain period can be compensated by optimizing the scheduling sequence of ships in port waterway by using the sssr method fig 14 shows the total scheduling time and carbon emissions of ships in port by using different strategies strategy 1 can significantly decrease the waiting time of ships in port and reduce the waiting emissions of ships partially moreover this can also be an effective way for many ports two values of strategy 2 are obtained by reducing all high speed ships to the lower bound in this way the emissions of ships can be greatly reduced but the scheduling time will largely increase simultaneously this is because of increased sailing time caused by speed reduction compared with the actual data the 18 solutions in strategy 3 sssr can simultaneously decrease the emissions of ships and the scheduling time significantly the sssr method outperforms the traditional strategy 1 by reducing emissions of ships at various stages in port which has enormous potential because of the speed reduction in sssr the total scheduling time of ships are a little larger than the strategy 1 but there is no doubt that it is an effective method to decrease emissions and increase traffic efficiency 6 conclusions and discussions in this paper the new emissions reduction method sssr of ships in port is proposed three strategies are constructed to study the effectiveness of this method the conclusions are as follows 1 by optimizing the scheduling sequence of ships entering and leaving the port within a certain period alone the excessive waiting time of ships in port and the corresponding carbon emission can be reduced optimizing ship scheduling sequence is one of the feasible measures to reduce the carbon emission of ships in port however only focus on one stage ships entering and leaving the port are tackled 2 the carbon emissions can be reduced by appropriately reducing the speed of ships sailing in the port however since the speed reduction of ships will negatively affect the navigation efficiency and safety of ships in the port area the feasibility and necessity of the ship speed reduction measures need to be considered 3 by optimizing the scheduling sequence of ships entering and leaving the port in a certain period and reducing the speed of high speed ships the total scheduling time and total carbon emissions of ships in port can be effectively reduced in the sssr method by taking measures the influence of ship speed reduction measures alone on waterway traffic of ships can be compensated the newly developed sssr method can not only make the transport of ships more efficient but also reduce the carbon emissions of ships in the port to achieve a low carbon environment the relevant research and methods in this paper can be used to solve the problem of ship emission reduction in port and can also be applied to other similar ports moreover it can support the construction of a green port credit authorship contribution statement zicheng xia conceptualization methodology formal analysis writing original draft zijian guo methodology software formal analysis writing original draft wenyuan wang investigation resources writing review editing ying jiang data curation validation visualization writing original draft supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we would like to acknowledge the support of national key research and development program of china no 2020yfe0201200 and the support of national natural science foundation of china no 51779037 and thank for supporting this research 
20672,three dimensional numerical simulations of wave run up on three circular cylinders in an equilateral triangular configuration are performed at different spacing ratios 1 5 l d 4 0 where l is the center to center distance and d is the diameter of cylinder the mechanism of wave superposition in the vicinity of three cylinders is illustrated the effects of spacing ratio and wave steepness on the wave run up ratio and wave force on three cylinders are investigated the results show that with variation of the spacing ratio different superposition processes among incident waves lateral edge waves and scattering waves are observed it should be noted that under the given condition the significant amplification of wave height is observed among three cylinders at l d 2 0 and 2 5 the spacing ratio has a significant effect on the wave run up ratio at the cylindrical surface and wave force on each cylinder rather than the wave steepness ka keywords three cylinders in an equilateral triangular configuration near trapping wave run up spacing ratio 1 introduction with the development of the exploration of oil and gas offshore wind turbine into the deep ocean the configuration of three column supported offshore structures has gradually attracted considerable attention due to its good applicability to water depth stability and low construction cost in the offshore and ocean engineering such as the tripod foundation jacket up foundation and semi submersible platform etc one of the most issue for the design of jacket up and floating structures is the air gap design which is closely related to the wave run up height due to the proximity of the multiple columns the interior wave surface elevation increases significantly with specific incident wave frequencies a comprehensive understanding of the interaction between wave and three column structures is urgently needed numerous investigations on wave run up on a single cylinder have been performed in the past few decades the potential flow theory and scattering theory have been employed to derive the wave run up formula of first order linear wave and second order stokes wave acting on the cylinder maccamy and fuchs 1954 sarpkaya and isaacson 1981 kriebel 1990 1992 the wave run up calculated using the linear scattering theory is found to be much smaller than those experimental results the second order non linear scattering theory is reported to be only applicable for the small wave steepness conditions liu et al 2001 employed a mixed eulerian lagrangian boundary element model to investigate the magnitude of the third harmonic force on a circular surface piercing cylinder and the results are in consistent with the analytical results faltinsen et al 1995 malenica et al 1995 as well as experimental results by krokstad et al 1995 a series of numerical and experimental studies were carried out to investigate the wave interaction with a single cylinder morris thomas 2004 mo et al 2007 paulsen et al 2014 aggarwal et al 2016 jian et al 2017 mohseni et al 2018 due to the complex interaction between waves and multiple columns the results of wave run up on a single column cannot be directly applied to multi column structures linton and evans 1990 obtained a simple expression for the wave forces on multiple bodies by simplifying the velocity field around the structure evans and porter 1997 1999 theoretically studied the near trapping interference phenomenon for two tandem cylinders and cylinder groups it is found that the wave loads acting on multiple cylinders increased significantly compared with that of a single cylinder the maximum wave force and wave run up height increase significantly when the multiple cylinders are arranged in a proximity regime cong et al 2015 experimentally studied the near trapping phenomenon for multi column arrays ji et al 2015 studied the multi directional random wave interaction with an array of cylinders the results show that the multi directional wave run up tends to be larger than the unidirectional wave run up kamath et al 2015 2016 investigated the hydrodynamics and wave forces for three cylinders in tandem three side by side cylinders four cylinder group and a 3 3 square array of nine cylinders at low keulegan carpenter kc numbers previous studies have paid much attention on the near trapping phenomenon for the four column offshore structure huang 2004 walker et al 2008 jiang et al 2011 grice et al 2013 shan 2013 bai et al 2014 wolgamot et al 2015 cao and wan 2017 wang et al 2018 the results show that the near trapping interference causes the wave energy concentrated on the inner side of four cylinders leading to the maximum wave height moreover the near trapping interference has a great influence on the second order wave force however a comprehensive understanding of the combined effects of spacing ratio and wave parameters on the near trapping phenomenon for three column structure is still lacking therefore the purpose of the present study is to investigate the effects of spacing ratio and wave steepness on the wave run up ratio and wave force for three cylinders in an equilateral triangular configuration the physical mechanism of wave run up among three cylinders is illustrated the paper is organized as follows the numerical methods are described in section 2 the numerical results of wave run up and wave force for three cylinders are discussed in section 3 conclusions are drawn in section 4 2 numerical method 2 1 governing equations the governing equations for three dimensional incompressible viscous fluid flow are mass conservation and navier stokes equations and the equations are solved by the open source field operation and manipulation openfoam combined with the mass source function proposed by lin and liu 1999 the flow motion can be described by the equations expressed as follows 1 u s x y z t 2 ρ u t ρ u u p μ u ρ g σ κ ρ ρ θ u where x y z are the coordinates in a cartesian coordinate system respectively u g denote the velocity vector and the gravitational acceleration respectively ρ p μ are the fluid density pressure and the dynamic viscosity coefficient respectively σ κ ρ indicates the surface tension a mass source term s is added into the mass conservation equation to generate waves according to lin and liu 1999 based on the assumption that all of the mass increase or decrease induced by the mass source function contributes to the generation of the target wave the equation between the source function and the expected time history of free surface elevation η t can be expressed 3 0 t ω s x y z t d ω d t 2 0 t c η t d t where ω denotes the source region c is the phase velocity of target wave in the following numerical simulation a region inside the computational domain is marked and defined as source region since the surface elevation of a linear monochromatic wave expressed as η t hsin ωt 2 the mass source function can be derived as follows 4 s x y z t c h a s sin ω t x y z ω 0 x y z ω where a s is the cross section of the source term h and ω are the wave height and circular frequency respectively a sponge layer ρθu i is added on the right side of the momentum conservation equation to absorb the incident wave at the both sides of numerical wave tank and reduce the influence of reflected waves the symbol θ represents the absorbing coefficient expressed as 5 θ β x s i x x s i 0 x x s i 0 x s i x x s o β x x s o x o x s o x s o x x o where β is the damping coefficient and is equal to 3 5 in the present research x si is the end position of the damping zone at the left side of wave tank x so and x o are the start position of the damping zone at the right side and the end of the wave tank respectively the volume of fluid vof method proposed by hirt et al 1981 is employed to capture the water air interface the volume fraction α is defined as 6 α 0 air 0 α 1 int e r f a c e 1 w a t e r the density ρ and viscosity μ are calculated by the weighting function defined below 7 ρ α ρ 1 1 α ρ 2 μ α μ 1 1 α μ 2 where ρ 1 and ρ 2 denote the density of water and air respectively μ 1 and μ 2 denote the viscosity of water and air respectively then the equation of volume fraction α can be derived 8 α t u i α x i 0 the governing equations and the vof equation are discretized by the finite volume method fvm pressure implicit with splitting of operator piso algorithm is employed for the pressure velocity coupling the convection items are discretized by cell limited gauss linear scheme the pressure term and laplace term are discretized by gauss linear scheme the time discretization adopts the first order implicit euler scheme the gauss interface compression scheme is applied to discretize volume fraction equations to capture free surface accurately 2 2 numerical model the computational domain of the numerical wake tank with the dimension of 0 x 11λ l d 0 y 2 0m and 0 z 1 5m is shown in fig 1 λ l and d represent for the wave length center to center interval and cylinder diameter respectively two wave damping zones are set at the left and right sides of the wave tank to avoid the effect of reflected waves and the length of damping zone on the left and right sides is 2λ and 2 5λ respectively a source region of the rectangular cross section with dimensions 0 1λ 2 0m 0 025λ is employed 1λ away from the damping zone on the left and h a 0 25λ below the free surface in consistent with the source region used in perić and abdel maksoud 2015 the diameter of each cylinder is d 0 15m and the spacing ratio l d is varied from 1 5 to 4 0 three wave steepness parameters of 0 120 0 157 and 0 209 are considered the wavelength is λ 1 26m and wave period is t 0 9s the details for the test cases are presented in table 1 the keulegan carpenter number kc defined as kc πh d where h is the wave height and d is the diameter of cylinder the keulegan carpenter number at the mean water level is relatively small where the inertial force has a more significant effect than the drag force on the total measured force the global and local view of mesh is plotted in fig 2 the free outflow boundary condition is employed on the inlet and outlet of the wave tank where the gradient of velocity and pressure are set to zero no slip wall condition is employed for the bottom of wave tank symmetry boundary condition is applied to two lateral sides of the wave tank the pressure outlet boundary condition is applied on the top side of the wave tank 2 2 1 verification of numerical model the mesh convergence tests for the empty wave tank and wave run up on a single cylinder are performed with different mesh densities the details of the mesh convergence test are presented in table 2 δ x and δ z represent the minimum mesh size in the direction of wave propagation and wave height respectively δ y c denotes the thickness of the first layer on the cylinder surface the computational domain of numerical wave tank with a single cylinder is shown in fig 3 the comparisons of free surface elevation at a distance of λ and 3λ away from the source region for empty wave tank between the present results and theoretical airy wave theory are presented in fig 4 except the result of mesh 1 the maximum discrepancy is less than 2 0 and 4 0 when it is λ and 3λ away from source region respectively and the longitudinal attenuation is small enough to be ignored the present numerical result is generally in consistent with the theoretical linear wave solution in the present study the iso surface with α 0 5 is defined as the free surface in order to ensure the accuracy of numerical model comparisons of the numerical results of wave run up on a single cylinder with the experimental and sph results of jian et al 2017 are carried out at incident wave height h 0 048m and wave length λ 1 26m the comparisons of the free surface elevations and wave forces on a single cylinder with different mesh densities are shown in fig 5 together with the numerical and experimental results in jian 2017 and theoretical result obtained from maccamy and fuchs 1954 the present numerical results are in good agreement with the literature results where the differences in the results of wave run up ratio and wave force on a single cylinder among the present numerical results and theory results are less than 3 the numerical result of wave force on the single cylinder is compared with that obtained from morison formula which is expressed as follows 9 f h 1 2 ρ c d d u u ρ c m a d u d t where u is the horizontal velocity of the water particle du dt is the horizontal acceleration of the water particle a is the cross section area of the cylinder c d and c m are the drag and inertia coefficients respectively therefore the medium mesh is considered to be fine enough and adopted for the numerical simulations of wave run up on three cylinders 3 results and discussion 3 1 the physical mechanism of wave superposition figs 6 8 show the wave spatial contours around three cylinders at different spacing ratios with wave steepness ka 0 209 the top views are plotted where the wave propagates in the positive x direction from left to right the moment when the wave crest arrives at the upstream cylinder is defined as t t 0 at small spacing ratio l d 1 5 when the wave crest arrives t t 0 an amplification of wave height is observed due to the superposition of scattering wave derived from intermediate cylinder with the incident wave propagating forward t t 0 09 three cylinders can be considered as a single large bluff body due to the small spacing ratio a water tongue in the gap between intermediate and downstream cylinders is almost breaking at t t 0 31 a large proportion of water is trapped in the gap between upstream and downstream cylinders resulting into the large wave run up height at the downstream cylinder as the wave move forward t t 0 44 and t t 0 64 the wave interaction becomes weaken and only ripples are observed due to the multiple reflections among three cylinders after the wave passes through t t 0 87 the negative water particle velocity is observed at the back stagnation of upstream cylinder and the merge phenomenon of lateral edge waves occurs at the surface of downstream cylinder resulting into the increasing of wave height in the gap between the upstream and downstream cylinders at l d 2 5 as the wave crest arrives at the upstream cylinder t t 0 the lateral edge wave around the upstream cylinder superposes with the incident wave and an obvious increase in wave height is observed between the upstream and downstream cylinders the wave upwelling is observed caused by the scattering waves as the wave moves forward t t 0 13 a prominent crest line is formed inside three cylinders which can be considered as the superposition of incident wave lateral edge wave and scattering wave with the arrival of incident wave crest at the downstream cylinder t t 0 33 the lateral edge waves around the intermediate cylinder collide at the back stagnation point the concentrated wave at the back side of the intermediate cylinder shifts to the positive y direction due to the asymmetry of three cylinders besides as the incident wave crest superposes with the scattering wave derived from the intermediate cylinder a significant amplification of wave height is observed at the gap between intermediate and downstream cylinders after the wave crest passes through the cylinders there are many disturbances in the vicinity of three cylinders t t 0 58 the superposition of the scattering wave and lateral edge waves is observed propagating to the inner side of three cylinders t t 0 78 afterward the lateral edge waves merge with the scattering wave inside three cylinders but the height of superposition wave is relatively small t t 0 91 when the wave propagates to the three cylinder structure the wave superposition occurs in the vicinity especially inside the structure when the scattering waves derived from cylinders converge to the internal the lateral edge waves at the cylindrical surface have a period similar to the incident wave strong nonlinear wave structure interaction induces the significant wave run up at small spacing ratio as l d increases to 4 0 at t t 0 two symmetry scattering waves derived from the upstream and downstream cylinders tend to concentrate to the inside of three cylinders the wave height amplification is observed when the incident wave crest superposes with the scattering waves with the wave crest arriving at the inner side of three cylinders t t 0 24 strong interference between the incident wave crest and scattering wave occurs at the inside of three cylinders as the incident wave moves forward t t 0 33 the lateral edge waves around the upstream cylinder are at the shoulder point of the cylinder while the lateral edge waves around the downstream cylinder are more close to the back stagnation point due to the positive wave velocity with the impact of the reverse velocity of wave trough t t 0 51 the lateral edge waves at the surfaces of upstream and downstream cylinders merge as the next wave crest approaches t t 0 80 a significant crest line is formed at the front of upstream cylinder 3 2 wave run up fig 9 shows the time histories of the non dimensional free surface elevations in the vicinity of the three cylinders at different spacing ratios with wave steepness ka 0 209 at the front stagnation of each cylinder a1 a2 a3 wave height amplification is observed especially at spacing ratio l d 2 0 a large portion of wave energy transforms into potential energy and significant wave run up at the front side of cylinders is observed especially at a2 and a3 strong non linearity is also observed at specific locations b1 c3 d2 which are all in the clearance between three cylinders at the location a3 one portion of the wave energy is trapped in the gap between upstream cylinder cy1 and downstream cylinder cy3 the wave upwelling is significant at the front stagnation point of downstream cylinder cy3 both the wave crests and troughs become sharp and asymmetrical due to the wave superposition phenomenon the maximum wave run up ratio appears at l d 2 0 with a value of 3 151 at the location b1 the back stagnation point of upstream cylinder cy1 multiple peaks are observed in one wave period at l d 1 5 which is caused by the lateral edge waves and scattering wave produced by the other two cylinders as spacing ratio l d increases to 2 0 the wave crest becomes wide and flat the wave run up phenomenon is not apparent due to the phase difference among the incident waves scattering waves and lateral edge waves at l d 2 5 the maximum wave run up ratio increases to 1 961 at the location c3 obvious secondary waves are observed at l d 1 5 indicating the strong nonlinearity it should be noted that the maximum wave run up ratio reaches 2 967 at l d 2 0 while it decreases as the spacing ratio increases at the location d2 wave height amplification is also obvious at l d 2 0 and 2 5 as a consequence of wave superposition when l d increases to 3 0 and 4 0 the wave run up ratio at all location decreases because of the weaker proximity interference among three cylinders the harmonic components of wave amplitudes are determined by the fast fourier transform fft analysis of the wave elevations to investigate the wave nonlinearity the power spectrum of the wave trains at different spacing ratios for the locations a3 and b1 are presented in fig 10 multiple peak frequencies are observed from the power spectrum plots indicating that the wave elevation consists of the first second third order harmonic components the temporal variations of the wave elevations appear to be unstable due to the multiple harmonic components the first order component of the wave elevation is predominated at all the examining spacing ratios the second order component also plays an important role in the significant increase of the wave run up ratio except at l d 1 5 for a3 and at l d 3 0 for b1 the third order component is relatively smaller than the first and second order components it is noticeable that at small spacing ratio l d 1 5 significant influence of the strong nonlinearity of the wave train occurs a relatively large broadband of the wave energy consisting four harmonic components is observed due to the proximity interference among three cylinders the exhibiting high order behavior contributes to the significant discrepancies in the irregular of the wave elevation at l d 1 5 the comparisons of the wave run up ratios around three cylindrical surfaces are performed at different spacing ratios with the wave steepness ka 0 209 for the convenience of later discussion the back stagnation point of the cylinder is defined as θ s 0 and the counterclockwise direction is positive by averaging the crest value of the free surface in 10 wave periods the mean wave run up ratio is presented in fig 11 the peak value of mean wave run up ratio generally occurs at the head wave sides of three cylinders θ s 180 at all the examined spacing ratios 1 5 l d 4 0 however the mean wave run up ratio for upstream cylinder cy1 occurs at the radial directional angle θ s 0 for l d 2 5 which may be contributed to the complicated wave superposition process of the reflected and scattering waves the relationship between the mean wave run up ratio and spacing ratio is not linear variation with the increase of l d the mean wave run up ratio for upstream cylinder cy1 decreases from 1 716 at l d 1 5 to 1 313 at l d 3 0 for the intermediate cylinder cy2 the mean wave run up ratio varies from the value of 2 086 at l d 2 0 to 1 257 at l d 4 0 it is interesting to note that the mean wave run up ratio for intermediate cylinder cy2 maintains at large values at θ s 180 and 270 for both two spacing ratios l d 2 0 and 2 5 the mean wave run up ratio for downstream cylinder cy3 is much larger than those for upstream cylinder cy1 and intermediate cylinder cy2 which is about 1 94 times that of the single cylinder large wave run up ratios are observed at the radial directional angle θ s 90 and 180 for downstream cylinder cy3 at l d 2 0 it is caused by the upwelling of incident wave and trapped wave between upstream cylinder cy1 and downstream cylinder cy3 when l d 3 0 the wave run up ratios for three cylinder structure approach to that of a single cylinder due to the diminishing of the interference among three cylinders the comparisons of the wave run up ratios for three cylinders among the present numerical results and analytical solutions are presented in fig 11 it can be seen that due to the near trapping phenomenon the distributions of the wave run up ratios around the surfaces for three cylinders are significantly different from those obtained from the analytical solutions hallermeier 1976 niedazwecki and huston 1992 especially for the cases at l d 2 0 and 2 5 the wave run up ratios are severely underestimated by analytical solution method due to the ignorance of the strong nonlinear interactions among three cylinders to further elucidate the nonlinearity of the harmonic components the normalized first second and third order harmonic components of the wave amplitudes are calculated in the vicinity of the three cylinders with ka 0 209 as shown in fig 12 the variation trend of the first order component with spacing ratio is generally the same especially for the downstream cylinder cy3 the maximum value occurs at the head wave side of each cylinder with the increase of spacing ratio the first order wave component gradually reduces it is interesting to note that at l d 2 0 the maximum second order wave amplitude occurs at the radial directional angle θ s 270 for intermediate cylinder cy2 and θ s 90 for downstream cylinder cy3 this may be contributed to the occurrence of the secondary peak value of the wave run up ratio for intermediate cylinder cy2 and downstream cylinder cy3 and so is the third order component the third order wave component is high at the inner of three cylinder structure the conclusion can be drawn that part of the wave energy is trapped inside three cylinders at l d 1 5 and 2 0 results in the occurrence of strong nonlinearity phenomenon the third order wave component decreases at l d 2 5 3 3 the effect of wave steepness on wave run up fig 13 shows a series of the non dimensional wave trains from four wave probes in the vicinity of three cylinders with different wave steepness ka 0 120 0 157 and 0 209 compared with the incident wave the wave crest and trough become sharp at the locations of a3 and g4 moreover there is an obvious secondary wave crest induced by the lateral edge waves at the wave trough of d2 the normalized wave elevation at the positions of a3 and d2 ka 0 209 is a little higher than the other cases fig 14 shows the power spectrum of the wave elevations at different specific locations a3 b1 d2 and g4 for spacing ratio l d 2 0 with the increase of wave steepness the first second and third order components become larger at all these locations when the wave steepness parameter ka increases to 0 209 the high order components become significant in the power spectrum at the location b1 the value of third order component is close to that of second order it is interesting to note that at the center of three cylinders g4 the value of third order component becomes larger than that of second order the existence of the high order components indicates the occurrence of near trapping phenomenon fig 15 shows the variation of the mean wave run up ratio η a from the four wave probes in the vicinity of three cylinders with different wave steepness parameters at 1 5 l d 4 0 the wave steepness parameter has little effect on the mean wave run up ratio but for spacing ratios l d 2 0 and 2 5 the mean wave run up ratio increases with the increase of wave steepness parameter ka the peak value of mean wave run up ratio occurs at the head wave side of each cylinder except for upstream cylinder cy1 at l d 2 5 where the mean wave run up ratio occurs at θ s 0 for upstream cylinder cy1 it is interesting to note that at l d 2 0 the mean wave run up ratios around intermediate cylinder cy2 and downstream cylinder cy3 at ka 0 209 are much larger than those for upstream cylinder cy1 to further elucidate the effect of multiple harmonic components the normalized first second and third order components of the wave elevation with different wave steepness at l d 2 0 are presented in fig 16 the discrepancies among the multiple harmonic components become more pronounced as ka increases from 0 120 to 0 209 the maximum value of the first order harmonic component occurs at the head wave side of three cylinders θ s 180 it can be concluded that the second order component is relatively large at the inner side of three cylinders due to the superposition of the scattering wave and reflected wave at the inner side of three cylinders the third order component is affected by the scattering and reflected waves and exhibits a relatively large value the second and third order components are significant inside the three cylinders at l d 2 0 the increase in the wave steepness amplifies the discrepancy the higher order components are caused by multiple superposition of waves which is the sign of trapped energy inside 3 4 wave force on three cylinders fig 17 shows the time histories of the normalized inline and transverse wave forces f x ρgr 2 a and f y ρgr 2 a on the three cylinders at different spacing ratios with large wave steepness ka 0 209 when the spacing ratio is small the inline wave force of upstream cylinder cy1 has an obvious deformation affected by the phase difference between the incident waves and scattering waves with the increase of l d no obvious deformation is observed indicating the diminishing of the proximity interferences among cylinders the fluctuation of the wave forces for intermediate cylinder cy2 is relatively smooth due to the symmetrical distribution of the scattering waves induced by upstream cylinder cy1 and downstream cylinder cy3 the wave force on downstream cylinder cy3 reaches a maximum value at l d 2 0 for all three cylinders the inline wave forces have a little difference as for the transverse force it is induced by the scattering waves and lateral edge waves the time histories of transverse forces exhibit multi peak behaviors indicating the complicated interaction among three cylinders by averaging the crest value of the inline and transverse wave forces in 10 wave periods the variations of normalized wave forces with spacing ratio at different wave steepness are presented in fig 18 the result for a single cylinder is also presented by a dash line for comparison the mean inline wave force on upstream cylinder cy1 increases with the increase of l d and exceeds that on a single cylinder when the spacing ratio is larger than 2 5 however the peak value of mean inline wave force for intermediate cylinder cy2 occurs at small spacing ratio l d 1 5 a significant decrease of the mean inline wave force is observed at l d 2 0 and it keeps at a stable level for intermediate spacing ratio 2 0 l d 3 0 the peak value of mean inline wave force on the downstream cylinder cy3 occurs at l d 2 0 with ka 0 209 it seems that the superposition between waves becomes strongest the mean transverse wave force is relatively small comparing with mean inline force and varies with spacing ratio it is worth noting that the maximum values of mean transverse forces on intermediate cylinder cy2 and downstream cylinder cy3 occur at l d 2 5 and 2 0 respectively the mean transverse force on downstream cylinder cy3 reaches a minimum value at l d 3 0 4 conclusion three dimensional numerical simulations of wave run up on three cylinders in an equilateral triangular configuration are performed the effects of spacing ratio and wave steepness on the wave run up ratios and wave forces are investigated the conclusions are summarized as follows 1 the spacing ratio has a significant effect on the wave run up ratio for the three cylinders the near trapping phenomenon is observed at l d 2 0 and 2 5 the complicated superposition progress involves the incident waves lateral edge waves around three cylinders scattering waves and reflecting waves inside the three cylinders 2 significant wave height amplification phenomenon is observed at the front stagnation point of each cylinder and inside the three cylinders at l d 2 0 and 2 5 with the increase of wave steepness the discrepancy of the multiple harmonic components of wave elevations increases and becomes pronounced 3 both the inline and transverse wave forces for the three cylinders are varied with the spacing ratio the peak value of mean inline wave force occurs on the upstream cylinder at l d 4 0 whereas at l d 1 5 and 2 0 on the intermediate and downstream cylinders respectively the maximum value of mean transverse wave force occurs on the downstream cylinder at l d 2 0 credit authorship contribution statement yangyang gao conceptualization numerical simulation supervision investigation writing review editing jiahui zhu numerical model data curation investigation writing original draft xinchen qu numerical model data curation lizhong wang writing review editing bin wang writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the joint fund of zhejiang provincial natural science foundation grant no lhz19e090004 
20672,three dimensional numerical simulations of wave run up on three circular cylinders in an equilateral triangular configuration are performed at different spacing ratios 1 5 l d 4 0 where l is the center to center distance and d is the diameter of cylinder the mechanism of wave superposition in the vicinity of three cylinders is illustrated the effects of spacing ratio and wave steepness on the wave run up ratio and wave force on three cylinders are investigated the results show that with variation of the spacing ratio different superposition processes among incident waves lateral edge waves and scattering waves are observed it should be noted that under the given condition the significant amplification of wave height is observed among three cylinders at l d 2 0 and 2 5 the spacing ratio has a significant effect on the wave run up ratio at the cylindrical surface and wave force on each cylinder rather than the wave steepness ka keywords three cylinders in an equilateral triangular configuration near trapping wave run up spacing ratio 1 introduction with the development of the exploration of oil and gas offshore wind turbine into the deep ocean the configuration of three column supported offshore structures has gradually attracted considerable attention due to its good applicability to water depth stability and low construction cost in the offshore and ocean engineering such as the tripod foundation jacket up foundation and semi submersible platform etc one of the most issue for the design of jacket up and floating structures is the air gap design which is closely related to the wave run up height due to the proximity of the multiple columns the interior wave surface elevation increases significantly with specific incident wave frequencies a comprehensive understanding of the interaction between wave and three column structures is urgently needed numerous investigations on wave run up on a single cylinder have been performed in the past few decades the potential flow theory and scattering theory have been employed to derive the wave run up formula of first order linear wave and second order stokes wave acting on the cylinder maccamy and fuchs 1954 sarpkaya and isaacson 1981 kriebel 1990 1992 the wave run up calculated using the linear scattering theory is found to be much smaller than those experimental results the second order non linear scattering theory is reported to be only applicable for the small wave steepness conditions liu et al 2001 employed a mixed eulerian lagrangian boundary element model to investigate the magnitude of the third harmonic force on a circular surface piercing cylinder and the results are in consistent with the analytical results faltinsen et al 1995 malenica et al 1995 as well as experimental results by krokstad et al 1995 a series of numerical and experimental studies were carried out to investigate the wave interaction with a single cylinder morris thomas 2004 mo et al 2007 paulsen et al 2014 aggarwal et al 2016 jian et al 2017 mohseni et al 2018 due to the complex interaction between waves and multiple columns the results of wave run up on a single column cannot be directly applied to multi column structures linton and evans 1990 obtained a simple expression for the wave forces on multiple bodies by simplifying the velocity field around the structure evans and porter 1997 1999 theoretically studied the near trapping interference phenomenon for two tandem cylinders and cylinder groups it is found that the wave loads acting on multiple cylinders increased significantly compared with that of a single cylinder the maximum wave force and wave run up height increase significantly when the multiple cylinders are arranged in a proximity regime cong et al 2015 experimentally studied the near trapping phenomenon for multi column arrays ji et al 2015 studied the multi directional random wave interaction with an array of cylinders the results show that the multi directional wave run up tends to be larger than the unidirectional wave run up kamath et al 2015 2016 investigated the hydrodynamics and wave forces for three cylinders in tandem three side by side cylinders four cylinder group and a 3 3 square array of nine cylinders at low keulegan carpenter kc numbers previous studies have paid much attention on the near trapping phenomenon for the four column offshore structure huang 2004 walker et al 2008 jiang et al 2011 grice et al 2013 shan 2013 bai et al 2014 wolgamot et al 2015 cao and wan 2017 wang et al 2018 the results show that the near trapping interference causes the wave energy concentrated on the inner side of four cylinders leading to the maximum wave height moreover the near trapping interference has a great influence on the second order wave force however a comprehensive understanding of the combined effects of spacing ratio and wave parameters on the near trapping phenomenon for three column structure is still lacking therefore the purpose of the present study is to investigate the effects of spacing ratio and wave steepness on the wave run up ratio and wave force for three cylinders in an equilateral triangular configuration the physical mechanism of wave run up among three cylinders is illustrated the paper is organized as follows the numerical methods are described in section 2 the numerical results of wave run up and wave force for three cylinders are discussed in section 3 conclusions are drawn in section 4 2 numerical method 2 1 governing equations the governing equations for three dimensional incompressible viscous fluid flow are mass conservation and navier stokes equations and the equations are solved by the open source field operation and manipulation openfoam combined with the mass source function proposed by lin and liu 1999 the flow motion can be described by the equations expressed as follows 1 u s x y z t 2 ρ u t ρ u u p μ u ρ g σ κ ρ ρ θ u where x y z are the coordinates in a cartesian coordinate system respectively u g denote the velocity vector and the gravitational acceleration respectively ρ p μ are the fluid density pressure and the dynamic viscosity coefficient respectively σ κ ρ indicates the surface tension a mass source term s is added into the mass conservation equation to generate waves according to lin and liu 1999 based on the assumption that all of the mass increase or decrease induced by the mass source function contributes to the generation of the target wave the equation between the source function and the expected time history of free surface elevation η t can be expressed 3 0 t ω s x y z t d ω d t 2 0 t c η t d t where ω denotes the source region c is the phase velocity of target wave in the following numerical simulation a region inside the computational domain is marked and defined as source region since the surface elevation of a linear monochromatic wave expressed as η t hsin ωt 2 the mass source function can be derived as follows 4 s x y z t c h a s sin ω t x y z ω 0 x y z ω where a s is the cross section of the source term h and ω are the wave height and circular frequency respectively a sponge layer ρθu i is added on the right side of the momentum conservation equation to absorb the incident wave at the both sides of numerical wave tank and reduce the influence of reflected waves the symbol θ represents the absorbing coefficient expressed as 5 θ β x s i x x s i 0 x x s i 0 x s i x x s o β x x s o x o x s o x s o x x o where β is the damping coefficient and is equal to 3 5 in the present research x si is the end position of the damping zone at the left side of wave tank x so and x o are the start position of the damping zone at the right side and the end of the wave tank respectively the volume of fluid vof method proposed by hirt et al 1981 is employed to capture the water air interface the volume fraction α is defined as 6 α 0 air 0 α 1 int e r f a c e 1 w a t e r the density ρ and viscosity μ are calculated by the weighting function defined below 7 ρ α ρ 1 1 α ρ 2 μ α μ 1 1 α μ 2 where ρ 1 and ρ 2 denote the density of water and air respectively μ 1 and μ 2 denote the viscosity of water and air respectively then the equation of volume fraction α can be derived 8 α t u i α x i 0 the governing equations and the vof equation are discretized by the finite volume method fvm pressure implicit with splitting of operator piso algorithm is employed for the pressure velocity coupling the convection items are discretized by cell limited gauss linear scheme the pressure term and laplace term are discretized by gauss linear scheme the time discretization adopts the first order implicit euler scheme the gauss interface compression scheme is applied to discretize volume fraction equations to capture free surface accurately 2 2 numerical model the computational domain of the numerical wake tank with the dimension of 0 x 11λ l d 0 y 2 0m and 0 z 1 5m is shown in fig 1 λ l and d represent for the wave length center to center interval and cylinder diameter respectively two wave damping zones are set at the left and right sides of the wave tank to avoid the effect of reflected waves and the length of damping zone on the left and right sides is 2λ and 2 5λ respectively a source region of the rectangular cross section with dimensions 0 1λ 2 0m 0 025λ is employed 1λ away from the damping zone on the left and h a 0 25λ below the free surface in consistent with the source region used in perić and abdel maksoud 2015 the diameter of each cylinder is d 0 15m and the spacing ratio l d is varied from 1 5 to 4 0 three wave steepness parameters of 0 120 0 157 and 0 209 are considered the wavelength is λ 1 26m and wave period is t 0 9s the details for the test cases are presented in table 1 the keulegan carpenter number kc defined as kc πh d where h is the wave height and d is the diameter of cylinder the keulegan carpenter number at the mean water level is relatively small where the inertial force has a more significant effect than the drag force on the total measured force the global and local view of mesh is plotted in fig 2 the free outflow boundary condition is employed on the inlet and outlet of the wave tank where the gradient of velocity and pressure are set to zero no slip wall condition is employed for the bottom of wave tank symmetry boundary condition is applied to two lateral sides of the wave tank the pressure outlet boundary condition is applied on the top side of the wave tank 2 2 1 verification of numerical model the mesh convergence tests for the empty wave tank and wave run up on a single cylinder are performed with different mesh densities the details of the mesh convergence test are presented in table 2 δ x and δ z represent the minimum mesh size in the direction of wave propagation and wave height respectively δ y c denotes the thickness of the first layer on the cylinder surface the computational domain of numerical wave tank with a single cylinder is shown in fig 3 the comparisons of free surface elevation at a distance of λ and 3λ away from the source region for empty wave tank between the present results and theoretical airy wave theory are presented in fig 4 except the result of mesh 1 the maximum discrepancy is less than 2 0 and 4 0 when it is λ and 3λ away from source region respectively and the longitudinal attenuation is small enough to be ignored the present numerical result is generally in consistent with the theoretical linear wave solution in the present study the iso surface with α 0 5 is defined as the free surface in order to ensure the accuracy of numerical model comparisons of the numerical results of wave run up on a single cylinder with the experimental and sph results of jian et al 2017 are carried out at incident wave height h 0 048m and wave length λ 1 26m the comparisons of the free surface elevations and wave forces on a single cylinder with different mesh densities are shown in fig 5 together with the numerical and experimental results in jian 2017 and theoretical result obtained from maccamy and fuchs 1954 the present numerical results are in good agreement with the literature results where the differences in the results of wave run up ratio and wave force on a single cylinder among the present numerical results and theory results are less than 3 the numerical result of wave force on the single cylinder is compared with that obtained from morison formula which is expressed as follows 9 f h 1 2 ρ c d d u u ρ c m a d u d t where u is the horizontal velocity of the water particle du dt is the horizontal acceleration of the water particle a is the cross section area of the cylinder c d and c m are the drag and inertia coefficients respectively therefore the medium mesh is considered to be fine enough and adopted for the numerical simulations of wave run up on three cylinders 3 results and discussion 3 1 the physical mechanism of wave superposition figs 6 8 show the wave spatial contours around three cylinders at different spacing ratios with wave steepness ka 0 209 the top views are plotted where the wave propagates in the positive x direction from left to right the moment when the wave crest arrives at the upstream cylinder is defined as t t 0 at small spacing ratio l d 1 5 when the wave crest arrives t t 0 an amplification of wave height is observed due to the superposition of scattering wave derived from intermediate cylinder with the incident wave propagating forward t t 0 09 three cylinders can be considered as a single large bluff body due to the small spacing ratio a water tongue in the gap between intermediate and downstream cylinders is almost breaking at t t 0 31 a large proportion of water is trapped in the gap between upstream and downstream cylinders resulting into the large wave run up height at the downstream cylinder as the wave move forward t t 0 44 and t t 0 64 the wave interaction becomes weaken and only ripples are observed due to the multiple reflections among three cylinders after the wave passes through t t 0 87 the negative water particle velocity is observed at the back stagnation of upstream cylinder and the merge phenomenon of lateral edge waves occurs at the surface of downstream cylinder resulting into the increasing of wave height in the gap between the upstream and downstream cylinders at l d 2 5 as the wave crest arrives at the upstream cylinder t t 0 the lateral edge wave around the upstream cylinder superposes with the incident wave and an obvious increase in wave height is observed between the upstream and downstream cylinders the wave upwelling is observed caused by the scattering waves as the wave moves forward t t 0 13 a prominent crest line is formed inside three cylinders which can be considered as the superposition of incident wave lateral edge wave and scattering wave with the arrival of incident wave crest at the downstream cylinder t t 0 33 the lateral edge waves around the intermediate cylinder collide at the back stagnation point the concentrated wave at the back side of the intermediate cylinder shifts to the positive y direction due to the asymmetry of three cylinders besides as the incident wave crest superposes with the scattering wave derived from the intermediate cylinder a significant amplification of wave height is observed at the gap between intermediate and downstream cylinders after the wave crest passes through the cylinders there are many disturbances in the vicinity of three cylinders t t 0 58 the superposition of the scattering wave and lateral edge waves is observed propagating to the inner side of three cylinders t t 0 78 afterward the lateral edge waves merge with the scattering wave inside three cylinders but the height of superposition wave is relatively small t t 0 91 when the wave propagates to the three cylinder structure the wave superposition occurs in the vicinity especially inside the structure when the scattering waves derived from cylinders converge to the internal the lateral edge waves at the cylindrical surface have a period similar to the incident wave strong nonlinear wave structure interaction induces the significant wave run up at small spacing ratio as l d increases to 4 0 at t t 0 two symmetry scattering waves derived from the upstream and downstream cylinders tend to concentrate to the inside of three cylinders the wave height amplification is observed when the incident wave crest superposes with the scattering waves with the wave crest arriving at the inner side of three cylinders t t 0 24 strong interference between the incident wave crest and scattering wave occurs at the inside of three cylinders as the incident wave moves forward t t 0 33 the lateral edge waves around the upstream cylinder are at the shoulder point of the cylinder while the lateral edge waves around the downstream cylinder are more close to the back stagnation point due to the positive wave velocity with the impact of the reverse velocity of wave trough t t 0 51 the lateral edge waves at the surfaces of upstream and downstream cylinders merge as the next wave crest approaches t t 0 80 a significant crest line is formed at the front of upstream cylinder 3 2 wave run up fig 9 shows the time histories of the non dimensional free surface elevations in the vicinity of the three cylinders at different spacing ratios with wave steepness ka 0 209 at the front stagnation of each cylinder a1 a2 a3 wave height amplification is observed especially at spacing ratio l d 2 0 a large portion of wave energy transforms into potential energy and significant wave run up at the front side of cylinders is observed especially at a2 and a3 strong non linearity is also observed at specific locations b1 c3 d2 which are all in the clearance between three cylinders at the location a3 one portion of the wave energy is trapped in the gap between upstream cylinder cy1 and downstream cylinder cy3 the wave upwelling is significant at the front stagnation point of downstream cylinder cy3 both the wave crests and troughs become sharp and asymmetrical due to the wave superposition phenomenon the maximum wave run up ratio appears at l d 2 0 with a value of 3 151 at the location b1 the back stagnation point of upstream cylinder cy1 multiple peaks are observed in one wave period at l d 1 5 which is caused by the lateral edge waves and scattering wave produced by the other two cylinders as spacing ratio l d increases to 2 0 the wave crest becomes wide and flat the wave run up phenomenon is not apparent due to the phase difference among the incident waves scattering waves and lateral edge waves at l d 2 5 the maximum wave run up ratio increases to 1 961 at the location c3 obvious secondary waves are observed at l d 1 5 indicating the strong nonlinearity it should be noted that the maximum wave run up ratio reaches 2 967 at l d 2 0 while it decreases as the spacing ratio increases at the location d2 wave height amplification is also obvious at l d 2 0 and 2 5 as a consequence of wave superposition when l d increases to 3 0 and 4 0 the wave run up ratio at all location decreases because of the weaker proximity interference among three cylinders the harmonic components of wave amplitudes are determined by the fast fourier transform fft analysis of the wave elevations to investigate the wave nonlinearity the power spectrum of the wave trains at different spacing ratios for the locations a3 and b1 are presented in fig 10 multiple peak frequencies are observed from the power spectrum plots indicating that the wave elevation consists of the first second third order harmonic components the temporal variations of the wave elevations appear to be unstable due to the multiple harmonic components the first order component of the wave elevation is predominated at all the examining spacing ratios the second order component also plays an important role in the significant increase of the wave run up ratio except at l d 1 5 for a3 and at l d 3 0 for b1 the third order component is relatively smaller than the first and second order components it is noticeable that at small spacing ratio l d 1 5 significant influence of the strong nonlinearity of the wave train occurs a relatively large broadband of the wave energy consisting four harmonic components is observed due to the proximity interference among three cylinders the exhibiting high order behavior contributes to the significant discrepancies in the irregular of the wave elevation at l d 1 5 the comparisons of the wave run up ratios around three cylindrical surfaces are performed at different spacing ratios with the wave steepness ka 0 209 for the convenience of later discussion the back stagnation point of the cylinder is defined as θ s 0 and the counterclockwise direction is positive by averaging the crest value of the free surface in 10 wave periods the mean wave run up ratio is presented in fig 11 the peak value of mean wave run up ratio generally occurs at the head wave sides of three cylinders θ s 180 at all the examined spacing ratios 1 5 l d 4 0 however the mean wave run up ratio for upstream cylinder cy1 occurs at the radial directional angle θ s 0 for l d 2 5 which may be contributed to the complicated wave superposition process of the reflected and scattering waves the relationship between the mean wave run up ratio and spacing ratio is not linear variation with the increase of l d the mean wave run up ratio for upstream cylinder cy1 decreases from 1 716 at l d 1 5 to 1 313 at l d 3 0 for the intermediate cylinder cy2 the mean wave run up ratio varies from the value of 2 086 at l d 2 0 to 1 257 at l d 4 0 it is interesting to note that the mean wave run up ratio for intermediate cylinder cy2 maintains at large values at θ s 180 and 270 for both two spacing ratios l d 2 0 and 2 5 the mean wave run up ratio for downstream cylinder cy3 is much larger than those for upstream cylinder cy1 and intermediate cylinder cy2 which is about 1 94 times that of the single cylinder large wave run up ratios are observed at the radial directional angle θ s 90 and 180 for downstream cylinder cy3 at l d 2 0 it is caused by the upwelling of incident wave and trapped wave between upstream cylinder cy1 and downstream cylinder cy3 when l d 3 0 the wave run up ratios for three cylinder structure approach to that of a single cylinder due to the diminishing of the interference among three cylinders the comparisons of the wave run up ratios for three cylinders among the present numerical results and analytical solutions are presented in fig 11 it can be seen that due to the near trapping phenomenon the distributions of the wave run up ratios around the surfaces for three cylinders are significantly different from those obtained from the analytical solutions hallermeier 1976 niedazwecki and huston 1992 especially for the cases at l d 2 0 and 2 5 the wave run up ratios are severely underestimated by analytical solution method due to the ignorance of the strong nonlinear interactions among three cylinders to further elucidate the nonlinearity of the harmonic components the normalized first second and third order harmonic components of the wave amplitudes are calculated in the vicinity of the three cylinders with ka 0 209 as shown in fig 12 the variation trend of the first order component with spacing ratio is generally the same especially for the downstream cylinder cy3 the maximum value occurs at the head wave side of each cylinder with the increase of spacing ratio the first order wave component gradually reduces it is interesting to note that at l d 2 0 the maximum second order wave amplitude occurs at the radial directional angle θ s 270 for intermediate cylinder cy2 and θ s 90 for downstream cylinder cy3 this may be contributed to the occurrence of the secondary peak value of the wave run up ratio for intermediate cylinder cy2 and downstream cylinder cy3 and so is the third order component the third order wave component is high at the inner of three cylinder structure the conclusion can be drawn that part of the wave energy is trapped inside three cylinders at l d 1 5 and 2 0 results in the occurrence of strong nonlinearity phenomenon the third order wave component decreases at l d 2 5 3 3 the effect of wave steepness on wave run up fig 13 shows a series of the non dimensional wave trains from four wave probes in the vicinity of three cylinders with different wave steepness ka 0 120 0 157 and 0 209 compared with the incident wave the wave crest and trough become sharp at the locations of a3 and g4 moreover there is an obvious secondary wave crest induced by the lateral edge waves at the wave trough of d2 the normalized wave elevation at the positions of a3 and d2 ka 0 209 is a little higher than the other cases fig 14 shows the power spectrum of the wave elevations at different specific locations a3 b1 d2 and g4 for spacing ratio l d 2 0 with the increase of wave steepness the first second and third order components become larger at all these locations when the wave steepness parameter ka increases to 0 209 the high order components become significant in the power spectrum at the location b1 the value of third order component is close to that of second order it is interesting to note that at the center of three cylinders g4 the value of third order component becomes larger than that of second order the existence of the high order components indicates the occurrence of near trapping phenomenon fig 15 shows the variation of the mean wave run up ratio η a from the four wave probes in the vicinity of three cylinders with different wave steepness parameters at 1 5 l d 4 0 the wave steepness parameter has little effect on the mean wave run up ratio but for spacing ratios l d 2 0 and 2 5 the mean wave run up ratio increases with the increase of wave steepness parameter ka the peak value of mean wave run up ratio occurs at the head wave side of each cylinder except for upstream cylinder cy1 at l d 2 5 where the mean wave run up ratio occurs at θ s 0 for upstream cylinder cy1 it is interesting to note that at l d 2 0 the mean wave run up ratios around intermediate cylinder cy2 and downstream cylinder cy3 at ka 0 209 are much larger than those for upstream cylinder cy1 to further elucidate the effect of multiple harmonic components the normalized first second and third order components of the wave elevation with different wave steepness at l d 2 0 are presented in fig 16 the discrepancies among the multiple harmonic components become more pronounced as ka increases from 0 120 to 0 209 the maximum value of the first order harmonic component occurs at the head wave side of three cylinders θ s 180 it can be concluded that the second order component is relatively large at the inner side of three cylinders due to the superposition of the scattering wave and reflected wave at the inner side of three cylinders the third order component is affected by the scattering and reflected waves and exhibits a relatively large value the second and third order components are significant inside the three cylinders at l d 2 0 the increase in the wave steepness amplifies the discrepancy the higher order components are caused by multiple superposition of waves which is the sign of trapped energy inside 3 4 wave force on three cylinders fig 17 shows the time histories of the normalized inline and transverse wave forces f x ρgr 2 a and f y ρgr 2 a on the three cylinders at different spacing ratios with large wave steepness ka 0 209 when the spacing ratio is small the inline wave force of upstream cylinder cy1 has an obvious deformation affected by the phase difference between the incident waves and scattering waves with the increase of l d no obvious deformation is observed indicating the diminishing of the proximity interferences among cylinders the fluctuation of the wave forces for intermediate cylinder cy2 is relatively smooth due to the symmetrical distribution of the scattering waves induced by upstream cylinder cy1 and downstream cylinder cy3 the wave force on downstream cylinder cy3 reaches a maximum value at l d 2 0 for all three cylinders the inline wave forces have a little difference as for the transverse force it is induced by the scattering waves and lateral edge waves the time histories of transverse forces exhibit multi peak behaviors indicating the complicated interaction among three cylinders by averaging the crest value of the inline and transverse wave forces in 10 wave periods the variations of normalized wave forces with spacing ratio at different wave steepness are presented in fig 18 the result for a single cylinder is also presented by a dash line for comparison the mean inline wave force on upstream cylinder cy1 increases with the increase of l d and exceeds that on a single cylinder when the spacing ratio is larger than 2 5 however the peak value of mean inline wave force for intermediate cylinder cy2 occurs at small spacing ratio l d 1 5 a significant decrease of the mean inline wave force is observed at l d 2 0 and it keeps at a stable level for intermediate spacing ratio 2 0 l d 3 0 the peak value of mean inline wave force on the downstream cylinder cy3 occurs at l d 2 0 with ka 0 209 it seems that the superposition between waves becomes strongest the mean transverse wave force is relatively small comparing with mean inline force and varies with spacing ratio it is worth noting that the maximum values of mean transverse forces on intermediate cylinder cy2 and downstream cylinder cy3 occur at l d 2 5 and 2 0 respectively the mean transverse force on downstream cylinder cy3 reaches a minimum value at l d 3 0 4 conclusion three dimensional numerical simulations of wave run up on three cylinders in an equilateral triangular configuration are performed the effects of spacing ratio and wave steepness on the wave run up ratios and wave forces are investigated the conclusions are summarized as follows 1 the spacing ratio has a significant effect on the wave run up ratio for the three cylinders the near trapping phenomenon is observed at l d 2 0 and 2 5 the complicated superposition progress involves the incident waves lateral edge waves around three cylinders scattering waves and reflecting waves inside the three cylinders 2 significant wave height amplification phenomenon is observed at the front stagnation point of each cylinder and inside the three cylinders at l d 2 0 and 2 5 with the increase of wave steepness the discrepancy of the multiple harmonic components of wave elevations increases and becomes pronounced 3 both the inline and transverse wave forces for the three cylinders are varied with the spacing ratio the peak value of mean inline wave force occurs on the upstream cylinder at l d 4 0 whereas at l d 1 5 and 2 0 on the intermediate and downstream cylinders respectively the maximum value of mean transverse wave force occurs on the downstream cylinder at l d 2 0 credit authorship contribution statement yangyang gao conceptualization numerical simulation supervision investigation writing review editing jiahui zhu numerical model data curation investigation writing original draft xinchen qu numerical model data curation lizhong wang writing review editing bin wang writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the joint fund of zhejiang provincial natural science foundation grant no lhz19e090004 
20673,the main problems facing the development of china s marine aquaculture industry include improper use of marine resources overfishing and seawater pollution large scale marine ranch based on ecological environment provides a promising solution for solving the above problems and achieving the sustainable development of the marine aquaculture industry therefore this study presents a novel design of a large scale recreational fishery marine ranch system which consists of three major subsystems including 1 management platform 2 deep sea cage group and 3 environmental supporting facilities such as artificial reefs algae planting areas and seagrass beds etc the management platform is a multifunctional system combining areas and subsystems for living entertainment leisure monitoring and automatic feeding management etc the usage of deep sea cage group makes the most of the ocean space when being integrated with those ecosystem based environmental supporting facilities it also addresses the seawater pollution issue that is generally encountered by conventional cage based farming systems preliminary calculation and simulation results show that the expected design goals can be basically achieved the overall goal of this research is to combine the sustainable development of the marine aquaculture industry assist the development of the tertiary industry and the continuous improvement of the living environment which in turn will maximize the comprehensive benefits keywords marine ranch recreational fisheries deep sea cage artificial reef marine environmental protection sustainable development 1 introduction with the rapid development of china s economy environmental pollution in coastal areas lack of logical utilization planning and overexploitation of marine resources have led to the depletion of china s coastal fishery resources and the deterioration of the marine ecological environment this has gradually become a common problem wang and wang 2013 yang 2016 yu and wang 2015 for example in recent years the fishing rate of 15 kinds of economic fish in sanya s offshore fishing grounds has dropped by more than 35 yin 2010 and the decline in fishery resources has become even more severe several important challenges include 1 optimize the fishery industrial complex 2 restore the offshore ecological environment and fishery resources 3 ensure the sustainable use of marine fishery resources and 4 promote fishery transformation and advancement these challenges must be overcome in order to achieve further development of the modern fishery in recent years with the rise of the tertiary industry the development of eco tourism of the deep blue ocean has become a strategic direction of marine development in coastal areas li et al 2011 tian et al 2017 yan and wang 2004 a new type of marine fishery production method is emerging which is marine ranch recreational fishing this method is based on establishment of an ecosystem and it makes full use of modern science and technology for management thus it is expected to effectively improve the quantity and quality of fishery resources as well as provide a new idea for expanding marine recreational fishery in this ecosystem the marine ecological environment will be optimized by building and restoring habitats for aquatic life in addition by artificially propagating aquatic organisms following goals can be achieved including making full use of primary marine productivity increasing available resources and returning catches thereby achieving better economic ecological and social benefits as a new fishery production model that integrates ecological optimization resource conservation and environmental friendliness large scale marine ranch have received worldwide attention and development yang et al 2004 zhang and zhang 2013 china s thirteenth five year plan requires that by 2020 the following goals should be achieved more than cny 1 4 trillion usd 197 8 billion in fishery output value establishment of more than 80 new national large scale marine ranch demonstration areas more than 550 national aquatic germplasm resource protection areas more than 80 aquatic biological protection areas above the provincial level more than 2500 new aquaculture demonstration sites more than 50 healthy aquaculture demonstration counties healthy aquaculture demonstration areas reach to 65 si 2017 based on the large scale marine ranch construction marine protection and tourism can be seamlessly combined by developing a low carbon island tourism model leading to a win win situation of low carbon environmental protection and tourism a large scale marine ranch is a specific sea area that can be viewed as an ecologically coupled system of environment and industry according to the characteristics of regional marine ecosystems through the protection and optimization of biological habitats various fishery production factors such as proliferation and aquaculture are organically combined to form marine ranches rational and efficient use of marine space would maximize marine productivity in addition an efficient fishery production and management model with a good ecological environment and high standard platform can be established in this way a new marine fishery industry will be realized which will also enable the land sea coordination and the combination of three industries chen et al 2006 marine ranches originated in the united states in the last century and were later promoted and developed in japan and south korea relatively developed countries also became pioneers by realizing the importance of ecological agriculture and environmental protection large scale marine ranches have become beautiful business cards for these countries liu and yang 1995 china s marine ranches started production relatively early related research was initialed in the late 1970s despite 50 years of development china s large scale marine ranch has not yet formed a favorable industrial structure due to various reasons such as insufficient capital investment unsustainable management lack of maintenance and lack of innovation in 2010 the construction of hong tang wan large scale marine ranch was carried out in sanya as the first large scale marine ranch in china after that the development of large scale marine ranches underwent a rapid growth and entered the fast lane toward the future with the improvement of people s living standards tourism industry has entered a long term expansion in the past few years china s amount of overseas tourism and the associated consumption has been effectively beneficial the combination of tourism and ecological agriculture has become an inevitable focus of fishery development in the united states there are 35 2 million consumers of recreational fishing every year total direct and indirect economic benefits are around usd 108 4 billion zhang and thesis 2017 chai and zhang 2007 in 1993 the number of tourists fishing in japan reached 37 29 million accounting for 30 of the national population in 2003 the output value of the australian fishing industry is as high as aud 1 8 billion liu 2011 china s recreational fisheries began in the 1990s cities with early fishery development used their geographical advantage along the coast lakes or rivers to develop value added tourism and leisure industries such as water tourism fishing and fishing festivals now it has begun to take shape zhang 2015 the output value of china s leisure fishery in 2017 was 70 842 billion cny usd 10 billon cai and yang 2019 in economically developed areas such as hainan province and guangdong province tourism and aquaculture have been at the forefront of china and are the earliest pioneers in launching recreational fisheries and marine ranches after the rapid development of aquaculture in the early stages of reform and opening locations they have entered a stable state since then the rapid development of tertiary industry such as tourism and real estate has entered a new stage with the establishment of a free trade port hainan will become china s comprehensive deepening reform and opening pilot zone a national ecological civilization pilot zone an international tourism consumer center and a major strategic service guarantee zone openness environmental protection and leisure tourism have become its developmental direction and various corresponding leisure ranch research and development plans have also followed as shown in fig 1 a marine hotels and marine fishing are themed recreational projects dedicated to recreational fishery marine ranches the geographical location of offshore hotels with special features is shown in fig 1 b it is noteworthy that in this study we refer to the key technology and equipment development in current international marine ranch research to design a new large scale recreational fishery marine ranch system based on ecosystem combination and a sustainable system configuration the main purpose of this study is not only to provide a theoretical support to solve the current problem of over cultivation of marine fisheries but also accelerate the coordinated development between marine leisure tourism and environmental protection 2 design of a large scale modern recreational fishery marine ranch 2 1 overall design a large scale marine ranch is a project with a wide range of technologies and difficulties the research on key components of the ranch can provide a theoretical basis for a logical design of the large scale marine ranch in accordance with the national strategy for developing dark blue territory modern large scale recreational fishery marine ranches generally use sea areas with a depth of 30 50 m it is mainly composed of 1 a living and leisure aquaculture management platform 2 a large scale intelligent deep sea breeding cage group and 3 environmental supporting facilities including artificial reefs algae planting areas and seagrass beds wang et al 2004 yu et al 2004 as shown in fig 2 and fig 3 although the management platform is the most important from a technical point of view the key feature of this ranch lies in the integration of the large scale breeding cage group with those environmental supporting facilities large deep sea cage groups can make full use of farming space and reduce costs due to the long term accumulation of feed and fish manure in traditional cage farming the eutrophication of seawater in the farming area will increase and seawater will be gradually deteriorated generally after 3 4 years of continuous farming the seawater in this area will not be suitable for continuous cultivation natural restoration of this area will take a long time before it can be used again corruption of seawater not only affects the normal growth of fish populations but also increases the possibility of disease transmission improving the environment of aquaculture areas and achieving natural purification of water bodies is one of the necessary conditions to ensure cage farming the integration of cage farming into the marine ranch system can solve some problems that cannot be solved by conventional cage farming alone marine ranches are one of the best ways to repair seawater and provide a decent living environment for marine life by adding artificial fish reefs and seaweed cultivation it not only provides a suitable environment for wild fish species but also attracts more wild fish to the farming area these wild fish will digest the excess feed and seaweed will process the manure of the farmed fish so it can clean the water body of the farming area in addition artificial fish reefs will play a role in blocking waves and currents providing relatively calm waters to the culture area and reducing the impact of waves on cages and cultured fish zhang et al 2016 however there are still some objective difficulties and challenges in the development of such marine ranches to solve these challenges a logical layout careful design planning advanced technical equipment support and large scale capital investment are required slow financial reimbursement is another issue that may be encountered therefore the construction of such a large scale marine ranch system generally needs to be implemented through government promotion in addition the design of the marine ranch needs to be tailored to local conditions to avoid unreasonable designs that may result in failure to achieve the expected results and the associated investment losses li and guo 2016 with the rapid development of information and automation technology automatic feeding and advanced agriculture have entered a new stage the development and application of a large number of automated equipment such as low light underwater monitoring systems online water quality monitoring and alarm systems wind and wave monitoring and forecasting systems and remote data transmission and control systems have been used for automatic aquaculture in the deep seas and constructing marine aquaculture traditional mechanization has transitioned to the era of intelligence and networking fig 4 shows pictures of a typical marine ranch and the associated monitoring platform in rongcheng allan bay shandong more details in the design of each subsystem in the large scale marine ranch are presented below 2 2 design of management platform the aquaculture management platform has a length of 50 m and a width of 25 m the designed waterline is 50 m long the designed displacement is 2700 tons below the deck is the engine room which is a functional module for ship ballasting electricity energy storage fish feed storage daily necessities storage freshwater production and storage there are 2 5 levels above the deck and they are used for living entertainment leisure automatic feeding and breeding monitoring management as shown in fig 5 the platform is designed based on cruise ship and is separated from the cage it can store enough feed necessities and fresh water for 15 days usage it is also equipped with a desalination system for temporary replenishment and has enough space to store sewage of 30 days the waste liquid produced can be transported back to shore to ensure that the water in the cultivation area is not polluted when a typhoon comes the control system will lower the cages and sink them into a safe area below the sea level later the cages can be positioned by buoys the management platform can sail back to the port to ensure safety the living area is designed with various modules for accommodation food entertainment recreational fishing automatic feeding and monitoring management this design is conducive to the development of 1 the function of recreational fishing tan and xu 2011 wang and zhang 2013 2 the combination of food and entertainment and 3 sea fishing and sea accommodation which will promote tourism consumption the layouts of two levels of the living area are shown in figs 6 and 7 respectively the first floor consists of 1 a monitoring room for monitoring the breeding environment 2 multiple deluxe restaurants for group dinners 3 a public restaurant for individual customers 4 a matching kitchen and 5 multiple standard suites for accommodation the second floor is composed of 1 a karaoke room 2 a coffee shop 3 a gym 4 a chess card room and 5 a number of luxurious bed rooms in addition food and fuel for daily necessities are placed on the bottom of the cabin automatic feeding equipment adopts mechanical loading pneumatic feeding and automatic feed distribution as shown in fig 8 according to the monitoring data the feeding amount and frequency are adjusted appropriately for each cage the combination of marine ranches and aquaculture cages will increase the number of wild fish in the farming area this will also contribute toward the development of marine fishing projects and increase the added value of recreational fisheries chen 2011 gou 2006 huang 2005 2 3 design of large scale automatic lifting deep sea cages deep sea cages are the most important part of the culture sector in recreational fisheries it must be addressed that china s sea conditions are complicated especially in the south china sea strong typhoons are often encountered traditional hdpe cages chang et al 2002 chen 2002 fu et al 2013 cannot resist typhoons of level 12 or higher which results in a loss of hundreds of millions of cnys in cage based marine farming in the south china sea in recent years wuchuan heavy industries has imported a semi submersible all steel structure automatic breeding cage built with norwegian technology this is considered as a new step towards intelligent ultra large breeding cages our large deep sea cages are developed with the basis of large scale ranch cages on a unified marine ranch management platform when the typhoon arrives the cages can be automatically sunk to a depth of 10 m below the sea level to avoid the impact of the typhoon and tide on the cages thereby avoiding the induced losses because these cages as shown in figs 9 and 10 are designed in combination with a unified farming management platform they are more suitable for recreational fisheries the concept of artificial reefs has been employed in the design of reef anchors which are made of concrete and steel and are used to stabilize the cages they also act as small reefs providing private habitats for wild fishes the high density deep sea cage group farming method increases the yield of deep sea aquaculture in 2015 china s total marine fishing output value was cny 200 351 billion usd 28 3 billion with an added value of cny 115 04 billion usd 16 3 billion marine culture production value was cny 293 766 billion usd 41 5 billion with an added value of cny 171 813 billion usd 24 3 billion chen 2016 over the past two years the total value of aquatic products has increased at a rate of 3 4 per year including freshwater fishing and aquaculture the growth rate of marine aquaculture exceeds the growth rate of marine fishing the increase in aquaculture production has forced space constrained aquaculture areas to develop in a more logical sense with accelerated self repairing capability based on reasonable structural layout design large scale marine ranches with modern recreational fisheries will implement a scientific ecological chain to increase value and efficiency therefore it can be regarded as a promising solution for the problem of weakening the self healing capacity of the sea caused by the high density intensive fish farming model which will enable the sustainable and healthy development of aquaculture the aquaculture area of the yellow sea in china is mainly used for farming seabasses yellow croakers and groupers its geographical location is longitude 122 5 latitude 37 0 as shown in fig 11 feed is usually made from mixed small fishes and it is given 4 to 5 times a day excessive artificial feed and fish manure are the main causes of seawater deterioration in the farm collection bottles are placed at multiple points on the seabed near the cages to obtain residual feed and manure samples in the area based on sufficient data from multiple batches the regional distribution of residual feed and manure near the cages is determined then based on the nature and quantity of feed feed conversion factor fcr digestibility and nutrient composition of manure the mass balance equation foy and rosell 1991 as shown in equation 1 is employed to obtain the excretion of fish thereby obtaining the food intake of fish and the distribution of residual feed on the seabed caused by tides in fact fish absorb only 28 35 of their feed liu et al 2004 zhuang and guo 2008 inedible feed and fish manure will continue to accumulate on the ocean floor and further break down into nitrogen phosphorus and other organic matter resulting in eutrophication throughout the body of water the degree of eutrophication is related to the tide food intake and surrounding environment 1 nutrient load amount of nutrients in the feed amount of nutrients in the fish 2 4 design of environmental supporting facilities the environmental support facilities mainly include artificial reefs algae planting areas and seagrass beds as a blue granary that can purify seawater and provide a shelter for marine life marine ranches are also an important way to resolve the decline in fishery resources due to water pollution and excessive consumption in the early days marine ranches construction usually began by launching large objects such as shipwrecks concrete stone structures and some derelict containers or tires into the sea these structures provide habitats for marine life and create an environment suitable for the reproduction and living of marine life thereby optimizing the resources of marine life with the research and development of marine ranches the design of artificial reefs no longer focuses on the utilization of waste but more on the rational design and deployment of reef groups as shown in fig 12 seagrass and seaweed can be properly arranged around the farm and shellfish can be cultured at the bottom achieving the layering of biological communities and logical development of marine farm biodiversity wang 2007 these can be developed in combination with cage culture to achieve economic social and environmental benefits at the same time hwang et al 2015 algae and seaweed can absorb excess nutrients in the water in recent years red tides have frequently appeared along the coast of qingdao china the reason can be attributed to the eutrophication of the seawater which further led to the excessive reproduction of algae microorganisms and plankton the introduction of artificial fish reefs will help improve water quality and reduce the occurrence of marine disasters such as red tides artificial fish reefs can be attached by many organisms especially benthic organisms such as algae and shellfish the growth of benthic plants such as seaweed consumes a large amount of nutrients including nitrogen and phosphorus and simultaneously performs photosynthesis and absorption of carbon dioxide while releasing oxygen benthic animals such as shellfish can consume a substantial amount of organic debris and phytoplankton through filter feeding to achieve clean water from another perspective cultured algae in the upper layer of seawater and seagrass beds formed by the bottom seaweeds not only provide habitats shelters and breeding places for marine wildlife but also are an important means to improve water quality and optimize the biological chain in china which has the largest algae cultivation and consumption seaweed is also an important by product of seafood and has certain economic value the biomass of a mature and stable seagrass bed was determined to be 64 7 g m2 jiao et al 2011 the test found that within 72 h 10 g of large seaweed could reduce the nitrogen concentration in 5 l of seawater from 0 45 mg l to 0 01 mg l and reduce the phosphorus concentration from 0 595 mg l to 0 055 mg l wang et al 2011 therefore for a marine algae farm with a capacity of 1080 tons it can absorb about 81 kg of nitrogen and 97 kg of phosphorus per day the bottom seagrass bed covers 132 000 m2 in the ranch chlorophylls and halophiles that have slender leaves and stems are selected the planting density is 150 plants per m2 and the coverage rate exceeds 40 according to measurements the ability of seagrass beds to treat eutrophication is lower than that of seaweed in farming areas however seagrass beds can hold sands slow the water flow in the farming area and provide living space for wild fish and crabs therefore it plays an important role in stabilizing and enriching the ecological chain generally about 10 000 m3 of net cages are required to raise 200 tons of fish each feeding requires about 40 tons of feed and other animals and plants consume about 28 tons in a typical marine ranch the amount of fish cultured in cages is about 1600 2400 tons so in each feeding time about 200 300 tons of feed need to be processed through the ecological chain therefore a complete and stable ecological chain is an important guarantee for the sustainable development of the marine ranch artificial fish reefs play an important role in providing habitats and increasing wildlife populations in marine ranch they can also stabilize the water at the bottom of the farming area reduce the area of pollution by eutrophication and reduce the impact of surges on farming based on the measurement and comparison of the ecological environment before and after the release of artificial fish reef it was found that the fish species in the artificial fish reef area increased by 1 8 times and the number of fish increased by 3 5 times jiao et al 2011 the designed artificial reef volume is 16 500 m3 which can provide habitat for 160 tons wild fish jiao et al 2011 3 methods in this section some preliminary simulation methods are presented on 1 motion state of residual un consumed feed in its landing process in water and 2 influence of the artificial reefs on water the purpose of these studies is to provide theoretical supports to the related designs as discussed in the last section 3 1 motion of residual feed in water the feeding process will be affected by many factors such as ocean currents tidal currents wind currents and waveguide currents under the influence of the ocean current the pollution range along the tidal current is higher than in other directions fig 13 shows the tidal schedule changes with the date the time of ebb and flood currents will be gradually postponed from the beginning of the month and will start again every month under the influence of the waves when the feed meets the flood current the pollution near the shore side is greater than that of the deep seaside it is reversed in the case of ebb current in the simulation an average peak tide velocity 0 51 m s towards the coast and an ebb tide velocity 0 44 m s have been employed these parameters are selected based on our experiences and those public tidal information as provided by china oceanic information network and the local branches of china msa maritime safety administration also these values have long been used in our previous related modeling and simulation works sampling and inspection of the seafloor around the cages showed that the degree of pollution in the sea area between the cages and the coast was higher than that in the deeper sea the theoretical force equation for feed landing is 2 f d c d a ρ s υ υ p υ υ p 2 3 f g f f f 4 t ρ 0 ν h f where 5 g ρ 0 g ν 6 f f ρ s g ν 7 f φ a ρ s υ h in which f d is the water flow force c d is the dynamic coefficient a is the against current area ρ 0 is the density of feed ρ s is the density of seawater is the speed of the sea current p is the speed of feed f is the force on the feed in the vertical direction and g is the gravity of feed f f is buoyancy f is fluid resistance g is gravitational acceleration v is feed volume t is the time it takes for the feed to sink to the ocean floor h is the depth of seawater and h is the longitudinal speed of the feed when the current speed and the volume and weight of the feed are known the trajectory of the residual feed under the action of the current can be calculated 3 2 influence of artificial reefs on water the correct placement and layout of reefs is a major factor in the design of marine ranch in our design every 12 reefs are arranged in a row and every 2 rows are in a group each group of reefs is staggered so the largest area can be circled the double layer is used to better stop the flow at the sea floor the forces acting on the reef have a turbulence model which can be described using dynamic equations xie et al 2012 8 ρ u t ρ u u μ e f f u p μ e f f u t b where 9 μ e f f μ μ t 10 p p 2 3 ρ k where ρ is density u is the velocity vector current velocity in cfd analysis t is time t is static temperature μ eff is the effective viscosity b is the sum of bulk forces p is the corrected pressure μ t is the turbulent viscosity μ is the molecular viscosity p is the static pressure k is the turbulent kinetic energy per unit volume 4 simulation results some preliminary simulation results are presented in this section 4 1 motion of residual feed in water the obtained trajectory of the sinking feed is an arc with an accelerated descending speed as indicated in fig 14 assuming that the bottom of the sea is a plane and its depth is known the range and probability of the feed reaching the bottom of the sea will form a polluted area the resulting degree of contamination is shown in fig 15 to address this a seagrass bed can be built at the bottom of the contaminating area combined with artificial fish reefs it can improve the living environment of marine wildlife and help solve the problem of eutrophication of seawater caused by excessive feed thereby forming a stable ecological cycle chain 4 2 influence of artificial reefs on water the current pressure on the reef is shown in fig 16 and the convergence of the calculated water resistance c d is shown in fig 17 converges to 0 44488 after 1500 iterations from the water speed distribution in fig 18 and the water velocity 3d vector distribution near the fish reef in fig 19 it is clear that the effect of artificial fish reefs on blocking the current is very obvious current velocity in the reef zone decreases by two orders of magnitude it has a strong protective effect on the stability of the water flow in the farming area especially near the seagrass bed the surface traces on the reef are shown in fig 20 as shown in the figure the water from the outside currents will flow upward after contacting the reef this will also lift the sea floor water and increase its circulation with upper layer water which promotes the exchange between clean and contaminated sea waters all these results support that the design goals as set forth in the last section can be achieved showing the attractive technical and economic feasibility of the proposed large scale marine ranch system 5 conclusions in this paper we presented a detailed design of a large scale modern recreational fishery marine ranch system this is an extremely versatile new marine ranch system which not only implements the integration of production and recreation functions but also provides a possible solution of seawater pollution issue that have been suffered by conventional marine ranches therefore it inspires a new promising direction for the sustainable development of marine aquaculture the whole ranch system is divided into three major subsystems including 1 multifunctional management platform 2 self elevating deep sea cage group and 3 ecosystem based environmental supporting facilities as the brain of the whole system the management platform is featured with its multifunction since a number of modules have been integrated on it such as power source storage freshwater production living entertainment monitoring and management etc and flexibility because of its cruise ship based design so it can sail back to the port for safety during typhoon large scale cage group is the crucial part for implementing the aquaculture function of the ranch system it is designed to be automatic lifting which means it can be lowered and raised automatically before and after typhoon based on the cage dimension in this study theoretical simulation of the feed trajectories and the resultant pollution area are also simulated this will be helpful for the future design and management of time frequency and amount of automatic feeding as for the environmental supporting facilities the basic concept behind the design is the achievement of synergetic effects between the cage group and these facilities such as the artificial fish reefs will not only reduce the surges impact and stabilize the water near the cages as confirmed by the simulation results but also provide habitats for the wildlife in the ranch the algae planting areas and seagrass beds will absorb those excess nutrients in the water coming from those not consumed feeds and the fish manure that contains not fully digested feeds such that the water near the cages can be cleaned at the same time they are also desirable natural habitats for the wildlife on the other hand these algae and seagrass themselves can be harvested as possible products of the ranch based on their values as food therefore it can be concluded that the large scale marine ranch system as presented in this study could provide a very practical and effective solution for those issues encountered in the current sustainable development of marine fisheries funding this study was supported by national key r d program of china no 2019yfd0900800 project number 2019yfd0900804 weihai science technology development plan project of china no 2018ns05 and special funding for modern agricultural industry technology system no cars 50 availability of data and material the datasets used and or analyzed during the current study are available from the corresponding author on reasonable request ethic statement not applicable conflict of interests all authors declare that they have no conflict of interests author contribution yongming tan carried out the studies participated in collecting data analysis and drafted the manuscript shangyou lou performed the statistical analysis and participated in its design all authors listed have read the complete manuscript and have approved submission of the paper the manuscript is truthful original work without fabrication fraud or plagiarism all authors declare that there are no conflicts of interest declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements none 
20673,the main problems facing the development of china s marine aquaculture industry include improper use of marine resources overfishing and seawater pollution large scale marine ranch based on ecological environment provides a promising solution for solving the above problems and achieving the sustainable development of the marine aquaculture industry therefore this study presents a novel design of a large scale recreational fishery marine ranch system which consists of three major subsystems including 1 management platform 2 deep sea cage group and 3 environmental supporting facilities such as artificial reefs algae planting areas and seagrass beds etc the management platform is a multifunctional system combining areas and subsystems for living entertainment leisure monitoring and automatic feeding management etc the usage of deep sea cage group makes the most of the ocean space when being integrated with those ecosystem based environmental supporting facilities it also addresses the seawater pollution issue that is generally encountered by conventional cage based farming systems preliminary calculation and simulation results show that the expected design goals can be basically achieved the overall goal of this research is to combine the sustainable development of the marine aquaculture industry assist the development of the tertiary industry and the continuous improvement of the living environment which in turn will maximize the comprehensive benefits keywords marine ranch recreational fisheries deep sea cage artificial reef marine environmental protection sustainable development 1 introduction with the rapid development of china s economy environmental pollution in coastal areas lack of logical utilization planning and overexploitation of marine resources have led to the depletion of china s coastal fishery resources and the deterioration of the marine ecological environment this has gradually become a common problem wang and wang 2013 yang 2016 yu and wang 2015 for example in recent years the fishing rate of 15 kinds of economic fish in sanya s offshore fishing grounds has dropped by more than 35 yin 2010 and the decline in fishery resources has become even more severe several important challenges include 1 optimize the fishery industrial complex 2 restore the offshore ecological environment and fishery resources 3 ensure the sustainable use of marine fishery resources and 4 promote fishery transformation and advancement these challenges must be overcome in order to achieve further development of the modern fishery in recent years with the rise of the tertiary industry the development of eco tourism of the deep blue ocean has become a strategic direction of marine development in coastal areas li et al 2011 tian et al 2017 yan and wang 2004 a new type of marine fishery production method is emerging which is marine ranch recreational fishing this method is based on establishment of an ecosystem and it makes full use of modern science and technology for management thus it is expected to effectively improve the quantity and quality of fishery resources as well as provide a new idea for expanding marine recreational fishery in this ecosystem the marine ecological environment will be optimized by building and restoring habitats for aquatic life in addition by artificially propagating aquatic organisms following goals can be achieved including making full use of primary marine productivity increasing available resources and returning catches thereby achieving better economic ecological and social benefits as a new fishery production model that integrates ecological optimization resource conservation and environmental friendliness large scale marine ranch have received worldwide attention and development yang et al 2004 zhang and zhang 2013 china s thirteenth five year plan requires that by 2020 the following goals should be achieved more than cny 1 4 trillion usd 197 8 billion in fishery output value establishment of more than 80 new national large scale marine ranch demonstration areas more than 550 national aquatic germplasm resource protection areas more than 80 aquatic biological protection areas above the provincial level more than 2500 new aquaculture demonstration sites more than 50 healthy aquaculture demonstration counties healthy aquaculture demonstration areas reach to 65 si 2017 based on the large scale marine ranch construction marine protection and tourism can be seamlessly combined by developing a low carbon island tourism model leading to a win win situation of low carbon environmental protection and tourism a large scale marine ranch is a specific sea area that can be viewed as an ecologically coupled system of environment and industry according to the characteristics of regional marine ecosystems through the protection and optimization of biological habitats various fishery production factors such as proliferation and aquaculture are organically combined to form marine ranches rational and efficient use of marine space would maximize marine productivity in addition an efficient fishery production and management model with a good ecological environment and high standard platform can be established in this way a new marine fishery industry will be realized which will also enable the land sea coordination and the combination of three industries chen et al 2006 marine ranches originated in the united states in the last century and were later promoted and developed in japan and south korea relatively developed countries also became pioneers by realizing the importance of ecological agriculture and environmental protection large scale marine ranches have become beautiful business cards for these countries liu and yang 1995 china s marine ranches started production relatively early related research was initialed in the late 1970s despite 50 years of development china s large scale marine ranch has not yet formed a favorable industrial structure due to various reasons such as insufficient capital investment unsustainable management lack of maintenance and lack of innovation in 2010 the construction of hong tang wan large scale marine ranch was carried out in sanya as the first large scale marine ranch in china after that the development of large scale marine ranches underwent a rapid growth and entered the fast lane toward the future with the improvement of people s living standards tourism industry has entered a long term expansion in the past few years china s amount of overseas tourism and the associated consumption has been effectively beneficial the combination of tourism and ecological agriculture has become an inevitable focus of fishery development in the united states there are 35 2 million consumers of recreational fishing every year total direct and indirect economic benefits are around usd 108 4 billion zhang and thesis 2017 chai and zhang 2007 in 1993 the number of tourists fishing in japan reached 37 29 million accounting for 30 of the national population in 2003 the output value of the australian fishing industry is as high as aud 1 8 billion liu 2011 china s recreational fisheries began in the 1990s cities with early fishery development used their geographical advantage along the coast lakes or rivers to develop value added tourism and leisure industries such as water tourism fishing and fishing festivals now it has begun to take shape zhang 2015 the output value of china s leisure fishery in 2017 was 70 842 billion cny usd 10 billon cai and yang 2019 in economically developed areas such as hainan province and guangdong province tourism and aquaculture have been at the forefront of china and are the earliest pioneers in launching recreational fisheries and marine ranches after the rapid development of aquaculture in the early stages of reform and opening locations they have entered a stable state since then the rapid development of tertiary industry such as tourism and real estate has entered a new stage with the establishment of a free trade port hainan will become china s comprehensive deepening reform and opening pilot zone a national ecological civilization pilot zone an international tourism consumer center and a major strategic service guarantee zone openness environmental protection and leisure tourism have become its developmental direction and various corresponding leisure ranch research and development plans have also followed as shown in fig 1 a marine hotels and marine fishing are themed recreational projects dedicated to recreational fishery marine ranches the geographical location of offshore hotels with special features is shown in fig 1 b it is noteworthy that in this study we refer to the key technology and equipment development in current international marine ranch research to design a new large scale recreational fishery marine ranch system based on ecosystem combination and a sustainable system configuration the main purpose of this study is not only to provide a theoretical support to solve the current problem of over cultivation of marine fisheries but also accelerate the coordinated development between marine leisure tourism and environmental protection 2 design of a large scale modern recreational fishery marine ranch 2 1 overall design a large scale marine ranch is a project with a wide range of technologies and difficulties the research on key components of the ranch can provide a theoretical basis for a logical design of the large scale marine ranch in accordance with the national strategy for developing dark blue territory modern large scale recreational fishery marine ranches generally use sea areas with a depth of 30 50 m it is mainly composed of 1 a living and leisure aquaculture management platform 2 a large scale intelligent deep sea breeding cage group and 3 environmental supporting facilities including artificial reefs algae planting areas and seagrass beds wang et al 2004 yu et al 2004 as shown in fig 2 and fig 3 although the management platform is the most important from a technical point of view the key feature of this ranch lies in the integration of the large scale breeding cage group with those environmental supporting facilities large deep sea cage groups can make full use of farming space and reduce costs due to the long term accumulation of feed and fish manure in traditional cage farming the eutrophication of seawater in the farming area will increase and seawater will be gradually deteriorated generally after 3 4 years of continuous farming the seawater in this area will not be suitable for continuous cultivation natural restoration of this area will take a long time before it can be used again corruption of seawater not only affects the normal growth of fish populations but also increases the possibility of disease transmission improving the environment of aquaculture areas and achieving natural purification of water bodies is one of the necessary conditions to ensure cage farming the integration of cage farming into the marine ranch system can solve some problems that cannot be solved by conventional cage farming alone marine ranches are one of the best ways to repair seawater and provide a decent living environment for marine life by adding artificial fish reefs and seaweed cultivation it not only provides a suitable environment for wild fish species but also attracts more wild fish to the farming area these wild fish will digest the excess feed and seaweed will process the manure of the farmed fish so it can clean the water body of the farming area in addition artificial fish reefs will play a role in blocking waves and currents providing relatively calm waters to the culture area and reducing the impact of waves on cages and cultured fish zhang et al 2016 however there are still some objective difficulties and challenges in the development of such marine ranches to solve these challenges a logical layout careful design planning advanced technical equipment support and large scale capital investment are required slow financial reimbursement is another issue that may be encountered therefore the construction of such a large scale marine ranch system generally needs to be implemented through government promotion in addition the design of the marine ranch needs to be tailored to local conditions to avoid unreasonable designs that may result in failure to achieve the expected results and the associated investment losses li and guo 2016 with the rapid development of information and automation technology automatic feeding and advanced agriculture have entered a new stage the development and application of a large number of automated equipment such as low light underwater monitoring systems online water quality monitoring and alarm systems wind and wave monitoring and forecasting systems and remote data transmission and control systems have been used for automatic aquaculture in the deep seas and constructing marine aquaculture traditional mechanization has transitioned to the era of intelligence and networking fig 4 shows pictures of a typical marine ranch and the associated monitoring platform in rongcheng allan bay shandong more details in the design of each subsystem in the large scale marine ranch are presented below 2 2 design of management platform the aquaculture management platform has a length of 50 m and a width of 25 m the designed waterline is 50 m long the designed displacement is 2700 tons below the deck is the engine room which is a functional module for ship ballasting electricity energy storage fish feed storage daily necessities storage freshwater production and storage there are 2 5 levels above the deck and they are used for living entertainment leisure automatic feeding and breeding monitoring management as shown in fig 5 the platform is designed based on cruise ship and is separated from the cage it can store enough feed necessities and fresh water for 15 days usage it is also equipped with a desalination system for temporary replenishment and has enough space to store sewage of 30 days the waste liquid produced can be transported back to shore to ensure that the water in the cultivation area is not polluted when a typhoon comes the control system will lower the cages and sink them into a safe area below the sea level later the cages can be positioned by buoys the management platform can sail back to the port to ensure safety the living area is designed with various modules for accommodation food entertainment recreational fishing automatic feeding and monitoring management this design is conducive to the development of 1 the function of recreational fishing tan and xu 2011 wang and zhang 2013 2 the combination of food and entertainment and 3 sea fishing and sea accommodation which will promote tourism consumption the layouts of two levels of the living area are shown in figs 6 and 7 respectively the first floor consists of 1 a monitoring room for monitoring the breeding environment 2 multiple deluxe restaurants for group dinners 3 a public restaurant for individual customers 4 a matching kitchen and 5 multiple standard suites for accommodation the second floor is composed of 1 a karaoke room 2 a coffee shop 3 a gym 4 a chess card room and 5 a number of luxurious bed rooms in addition food and fuel for daily necessities are placed on the bottom of the cabin automatic feeding equipment adopts mechanical loading pneumatic feeding and automatic feed distribution as shown in fig 8 according to the monitoring data the feeding amount and frequency are adjusted appropriately for each cage the combination of marine ranches and aquaculture cages will increase the number of wild fish in the farming area this will also contribute toward the development of marine fishing projects and increase the added value of recreational fisheries chen 2011 gou 2006 huang 2005 2 3 design of large scale automatic lifting deep sea cages deep sea cages are the most important part of the culture sector in recreational fisheries it must be addressed that china s sea conditions are complicated especially in the south china sea strong typhoons are often encountered traditional hdpe cages chang et al 2002 chen 2002 fu et al 2013 cannot resist typhoons of level 12 or higher which results in a loss of hundreds of millions of cnys in cage based marine farming in the south china sea in recent years wuchuan heavy industries has imported a semi submersible all steel structure automatic breeding cage built with norwegian technology this is considered as a new step towards intelligent ultra large breeding cages our large deep sea cages are developed with the basis of large scale ranch cages on a unified marine ranch management platform when the typhoon arrives the cages can be automatically sunk to a depth of 10 m below the sea level to avoid the impact of the typhoon and tide on the cages thereby avoiding the induced losses because these cages as shown in figs 9 and 10 are designed in combination with a unified farming management platform they are more suitable for recreational fisheries the concept of artificial reefs has been employed in the design of reef anchors which are made of concrete and steel and are used to stabilize the cages they also act as small reefs providing private habitats for wild fishes the high density deep sea cage group farming method increases the yield of deep sea aquaculture in 2015 china s total marine fishing output value was cny 200 351 billion usd 28 3 billion with an added value of cny 115 04 billion usd 16 3 billion marine culture production value was cny 293 766 billion usd 41 5 billion with an added value of cny 171 813 billion usd 24 3 billion chen 2016 over the past two years the total value of aquatic products has increased at a rate of 3 4 per year including freshwater fishing and aquaculture the growth rate of marine aquaculture exceeds the growth rate of marine fishing the increase in aquaculture production has forced space constrained aquaculture areas to develop in a more logical sense with accelerated self repairing capability based on reasonable structural layout design large scale marine ranches with modern recreational fisheries will implement a scientific ecological chain to increase value and efficiency therefore it can be regarded as a promising solution for the problem of weakening the self healing capacity of the sea caused by the high density intensive fish farming model which will enable the sustainable and healthy development of aquaculture the aquaculture area of the yellow sea in china is mainly used for farming seabasses yellow croakers and groupers its geographical location is longitude 122 5 latitude 37 0 as shown in fig 11 feed is usually made from mixed small fishes and it is given 4 to 5 times a day excessive artificial feed and fish manure are the main causes of seawater deterioration in the farm collection bottles are placed at multiple points on the seabed near the cages to obtain residual feed and manure samples in the area based on sufficient data from multiple batches the regional distribution of residual feed and manure near the cages is determined then based on the nature and quantity of feed feed conversion factor fcr digestibility and nutrient composition of manure the mass balance equation foy and rosell 1991 as shown in equation 1 is employed to obtain the excretion of fish thereby obtaining the food intake of fish and the distribution of residual feed on the seabed caused by tides in fact fish absorb only 28 35 of their feed liu et al 2004 zhuang and guo 2008 inedible feed and fish manure will continue to accumulate on the ocean floor and further break down into nitrogen phosphorus and other organic matter resulting in eutrophication throughout the body of water the degree of eutrophication is related to the tide food intake and surrounding environment 1 nutrient load amount of nutrients in the feed amount of nutrients in the fish 2 4 design of environmental supporting facilities the environmental support facilities mainly include artificial reefs algae planting areas and seagrass beds as a blue granary that can purify seawater and provide a shelter for marine life marine ranches are also an important way to resolve the decline in fishery resources due to water pollution and excessive consumption in the early days marine ranches construction usually began by launching large objects such as shipwrecks concrete stone structures and some derelict containers or tires into the sea these structures provide habitats for marine life and create an environment suitable for the reproduction and living of marine life thereby optimizing the resources of marine life with the research and development of marine ranches the design of artificial reefs no longer focuses on the utilization of waste but more on the rational design and deployment of reef groups as shown in fig 12 seagrass and seaweed can be properly arranged around the farm and shellfish can be cultured at the bottom achieving the layering of biological communities and logical development of marine farm biodiversity wang 2007 these can be developed in combination with cage culture to achieve economic social and environmental benefits at the same time hwang et al 2015 algae and seaweed can absorb excess nutrients in the water in recent years red tides have frequently appeared along the coast of qingdao china the reason can be attributed to the eutrophication of the seawater which further led to the excessive reproduction of algae microorganisms and plankton the introduction of artificial fish reefs will help improve water quality and reduce the occurrence of marine disasters such as red tides artificial fish reefs can be attached by many organisms especially benthic organisms such as algae and shellfish the growth of benthic plants such as seaweed consumes a large amount of nutrients including nitrogen and phosphorus and simultaneously performs photosynthesis and absorption of carbon dioxide while releasing oxygen benthic animals such as shellfish can consume a substantial amount of organic debris and phytoplankton through filter feeding to achieve clean water from another perspective cultured algae in the upper layer of seawater and seagrass beds formed by the bottom seaweeds not only provide habitats shelters and breeding places for marine wildlife but also are an important means to improve water quality and optimize the biological chain in china which has the largest algae cultivation and consumption seaweed is also an important by product of seafood and has certain economic value the biomass of a mature and stable seagrass bed was determined to be 64 7 g m2 jiao et al 2011 the test found that within 72 h 10 g of large seaweed could reduce the nitrogen concentration in 5 l of seawater from 0 45 mg l to 0 01 mg l and reduce the phosphorus concentration from 0 595 mg l to 0 055 mg l wang et al 2011 therefore for a marine algae farm with a capacity of 1080 tons it can absorb about 81 kg of nitrogen and 97 kg of phosphorus per day the bottom seagrass bed covers 132 000 m2 in the ranch chlorophylls and halophiles that have slender leaves and stems are selected the planting density is 150 plants per m2 and the coverage rate exceeds 40 according to measurements the ability of seagrass beds to treat eutrophication is lower than that of seaweed in farming areas however seagrass beds can hold sands slow the water flow in the farming area and provide living space for wild fish and crabs therefore it plays an important role in stabilizing and enriching the ecological chain generally about 10 000 m3 of net cages are required to raise 200 tons of fish each feeding requires about 40 tons of feed and other animals and plants consume about 28 tons in a typical marine ranch the amount of fish cultured in cages is about 1600 2400 tons so in each feeding time about 200 300 tons of feed need to be processed through the ecological chain therefore a complete and stable ecological chain is an important guarantee for the sustainable development of the marine ranch artificial fish reefs play an important role in providing habitats and increasing wildlife populations in marine ranch they can also stabilize the water at the bottom of the farming area reduce the area of pollution by eutrophication and reduce the impact of surges on farming based on the measurement and comparison of the ecological environment before and after the release of artificial fish reef it was found that the fish species in the artificial fish reef area increased by 1 8 times and the number of fish increased by 3 5 times jiao et al 2011 the designed artificial reef volume is 16 500 m3 which can provide habitat for 160 tons wild fish jiao et al 2011 3 methods in this section some preliminary simulation methods are presented on 1 motion state of residual un consumed feed in its landing process in water and 2 influence of the artificial reefs on water the purpose of these studies is to provide theoretical supports to the related designs as discussed in the last section 3 1 motion of residual feed in water the feeding process will be affected by many factors such as ocean currents tidal currents wind currents and waveguide currents under the influence of the ocean current the pollution range along the tidal current is higher than in other directions fig 13 shows the tidal schedule changes with the date the time of ebb and flood currents will be gradually postponed from the beginning of the month and will start again every month under the influence of the waves when the feed meets the flood current the pollution near the shore side is greater than that of the deep seaside it is reversed in the case of ebb current in the simulation an average peak tide velocity 0 51 m s towards the coast and an ebb tide velocity 0 44 m s have been employed these parameters are selected based on our experiences and those public tidal information as provided by china oceanic information network and the local branches of china msa maritime safety administration also these values have long been used in our previous related modeling and simulation works sampling and inspection of the seafloor around the cages showed that the degree of pollution in the sea area between the cages and the coast was higher than that in the deeper sea the theoretical force equation for feed landing is 2 f d c d a ρ s υ υ p υ υ p 2 3 f g f f f 4 t ρ 0 ν h f where 5 g ρ 0 g ν 6 f f ρ s g ν 7 f φ a ρ s υ h in which f d is the water flow force c d is the dynamic coefficient a is the against current area ρ 0 is the density of feed ρ s is the density of seawater is the speed of the sea current p is the speed of feed f is the force on the feed in the vertical direction and g is the gravity of feed f f is buoyancy f is fluid resistance g is gravitational acceleration v is feed volume t is the time it takes for the feed to sink to the ocean floor h is the depth of seawater and h is the longitudinal speed of the feed when the current speed and the volume and weight of the feed are known the trajectory of the residual feed under the action of the current can be calculated 3 2 influence of artificial reefs on water the correct placement and layout of reefs is a major factor in the design of marine ranch in our design every 12 reefs are arranged in a row and every 2 rows are in a group each group of reefs is staggered so the largest area can be circled the double layer is used to better stop the flow at the sea floor the forces acting on the reef have a turbulence model which can be described using dynamic equations xie et al 2012 8 ρ u t ρ u u μ e f f u p μ e f f u t b where 9 μ e f f μ μ t 10 p p 2 3 ρ k where ρ is density u is the velocity vector current velocity in cfd analysis t is time t is static temperature μ eff is the effective viscosity b is the sum of bulk forces p is the corrected pressure μ t is the turbulent viscosity μ is the molecular viscosity p is the static pressure k is the turbulent kinetic energy per unit volume 4 simulation results some preliminary simulation results are presented in this section 4 1 motion of residual feed in water the obtained trajectory of the sinking feed is an arc with an accelerated descending speed as indicated in fig 14 assuming that the bottom of the sea is a plane and its depth is known the range and probability of the feed reaching the bottom of the sea will form a polluted area the resulting degree of contamination is shown in fig 15 to address this a seagrass bed can be built at the bottom of the contaminating area combined with artificial fish reefs it can improve the living environment of marine wildlife and help solve the problem of eutrophication of seawater caused by excessive feed thereby forming a stable ecological cycle chain 4 2 influence of artificial reefs on water the current pressure on the reef is shown in fig 16 and the convergence of the calculated water resistance c d is shown in fig 17 converges to 0 44488 after 1500 iterations from the water speed distribution in fig 18 and the water velocity 3d vector distribution near the fish reef in fig 19 it is clear that the effect of artificial fish reefs on blocking the current is very obvious current velocity in the reef zone decreases by two orders of magnitude it has a strong protective effect on the stability of the water flow in the farming area especially near the seagrass bed the surface traces on the reef are shown in fig 20 as shown in the figure the water from the outside currents will flow upward after contacting the reef this will also lift the sea floor water and increase its circulation with upper layer water which promotes the exchange between clean and contaminated sea waters all these results support that the design goals as set forth in the last section can be achieved showing the attractive technical and economic feasibility of the proposed large scale marine ranch system 5 conclusions in this paper we presented a detailed design of a large scale modern recreational fishery marine ranch system this is an extremely versatile new marine ranch system which not only implements the integration of production and recreation functions but also provides a possible solution of seawater pollution issue that have been suffered by conventional marine ranches therefore it inspires a new promising direction for the sustainable development of marine aquaculture the whole ranch system is divided into three major subsystems including 1 multifunctional management platform 2 self elevating deep sea cage group and 3 ecosystem based environmental supporting facilities as the brain of the whole system the management platform is featured with its multifunction since a number of modules have been integrated on it such as power source storage freshwater production living entertainment monitoring and management etc and flexibility because of its cruise ship based design so it can sail back to the port for safety during typhoon large scale cage group is the crucial part for implementing the aquaculture function of the ranch system it is designed to be automatic lifting which means it can be lowered and raised automatically before and after typhoon based on the cage dimension in this study theoretical simulation of the feed trajectories and the resultant pollution area are also simulated this will be helpful for the future design and management of time frequency and amount of automatic feeding as for the environmental supporting facilities the basic concept behind the design is the achievement of synergetic effects between the cage group and these facilities such as the artificial fish reefs will not only reduce the surges impact and stabilize the water near the cages as confirmed by the simulation results but also provide habitats for the wildlife in the ranch the algae planting areas and seagrass beds will absorb those excess nutrients in the water coming from those not consumed feeds and the fish manure that contains not fully digested feeds such that the water near the cages can be cleaned at the same time they are also desirable natural habitats for the wildlife on the other hand these algae and seagrass themselves can be harvested as possible products of the ranch based on their values as food therefore it can be concluded that the large scale marine ranch system as presented in this study could provide a very practical and effective solution for those issues encountered in the current sustainable development of marine fisheries funding this study was supported by national key r d program of china no 2019yfd0900800 project number 2019yfd0900804 weihai science technology development plan project of china no 2018ns05 and special funding for modern agricultural industry technology system no cars 50 availability of data and material the datasets used and or analyzed during the current study are available from the corresponding author on reasonable request ethic statement not applicable conflict of interests all authors declare that they have no conflict of interests author contribution yongming tan carried out the studies participated in collecting data analysis and drafted the manuscript shangyou lou performed the statistical analysis and participated in its design all authors listed have read the complete manuscript and have approved submission of the paper the manuscript is truthful original work without fabrication fraud or plagiarism all authors declare that there are no conflicts of interest declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements none 
20674,this paper addresses a dual closed loop fast integral terminal sliding mode control method of a multi underactuated auv formation system with uncertain model parameters and environmental disturbances different from the traditional sliding mode control method this technique can not only keep the formation stable but also significantly overcomes the problem that the formation tracking errors of the traditional method may not converge to zero in finite time then an adaptive radial basis function rbf neural network controller is incorporated with a conditional integrator to deal with the uncertain model parameters approximation errors and environmental disturbances in practical multi auv systems and also the proposed controller is continuous with the property of chattering restraining a virtual leader is adopted on the basis of the leader following strategy to improve the robustness of the formation system and prevent the problem of formation collapse caused by the failure of the leader auv moreover the rigorous stability analysis based on lyapunov method and numerical simulations demonstrate tracking errors converge to 0 in finite time finally simulation results demonstrate the effectiveness of the proposed formation controller the auv formation can track the desired trajectory accurately with 10 model parameter perturbation keywords multi underactuated auv system uncertainties finite time control fast integral terminal sliding mode control rbf neural network conditional integrator 1 introduction in recent years a lot of research has been done in the field of underactuated autonomous underwater vehicle auv formation control aguiar and hespanha 2004 however the auv formation control problem still brings challenges to system designers because most auv are underactuated i e their actuators are less than degrees of freedom dof and impose non integral acceleration constraints yuh 2000 wang et al 2020a zhang et al 2020 wang et al 2019 li et al 2019 yu et al 2019 in addition the kinematic and dynamic models of auv are usually underactuated highly nonlinear and coupled and its hydrodynamic parameters are often uncertain especially when auv may be subjected to unknown disturbances from ocean currents fossen 1994 which makes the formation control of multi underactuated auv become an arduous task based on thorough review of the literatures there are several different approaches to achieve the formation control for multi auv system including artificial potential field method pan et al 2017 virtual structure method z yan et al 2015 and leader following method li et al 2018 park 2015 cui et al 2010 ihle et al 2006 among the above control schemes the leader following control strategy seems to be the most popular one because of its reliability and simplicity it has been widely used in the design of formation controller in the context of multi auv recycling a new leader following consensus protocol with time varying delay for discrete time multi auv recovery systems is proposed by modeling directed fixed communication topology in zhang et al 2020 under the framework of leader following formation strategy wang et al 2019 addressed the problem of three dimensional trajectory tracking control of auv under parameter uncertainties and external disturbances however the above literatures did not take into account the impact on formation when the leader auv fault based on this problem li and du 2018 proposed a formation strategy based on virtual leader which used the virtual reference point as the formation leader to provide reference location information for the follower auvs in the formation however a good formation controller should not only satisfy the stability of the formation system but also improve its robustness and adaptability to system parameter uncertainties and unknown environment disturbances therefore under the leader following formation control method a large number of robust and adaptive techniques are introduced such as neural network fuzzy control sliding mode control sun et al 2018 asif et al 2017 li and zhu 2016 and so on mixing two or more of them is a common control scheme for multi auv formation control systems in wang et al 2020a a bounded formation control law is proposed by comprehensive the backstepping method a neural estimation model and a saturation function it overcomes the formation problems of multi underactuated auv in the case of unknown dynamics and limited control torque wang et al 2020b proposed a filter backstepping based neural adaptive formation tracking control method the calculation explosion of the traditional backstepping method is avoided by using the filtering method and the adaptive neural network is used to improve the adaptive ability of the controller a sliding mode formation control strategy using backstepping method and adaptive neural network is proposed in wang et al 2020c and a continuous proportional integral pi function is designed to avoid the influence of chattering in standard sliding mode control method however above references only considered the situation of the formation system in the horizontal plane in addition most of the formation controller use smooth feedback method and the closed loop system is asymptotically stable this is due to the closed loop control system satisfies lipchitz continuity however the system states which satisfy lipchitz continuity converge exponentially namely the system states really converge to the equilibrium point in infinite time or uncertain time in the field of auv formation control the corresponding evaluation index is closely related to the convergence rate of the system state if the system error converges slowly it may lead to formation failure or instability from the point of view of time optimization and practical application of auv formation system the finite time control method is of significance gao and guo 2020 and qiao and zhang 2019 proposed two methods to prove the finite time stability of auv formation system respectively and gao and guo 2020 and qiao and zhang 2019 adopt command filtered method and integral terminal sliding mode control method respectively in yu et al 2019 the globally finite time control strategy is proposed based on the proportional integral derivative sliding mode control pid smc which globally stabilizes all trajectory tracking errors in the finite time motivated by aforementioned considerations this paper studies the 3d finite time formation problem of a class of underactuated auvs in 5 dof with uncertain model parameters and unknown environmental disturbances compared with previous representative literatures the main novelties and contributions of this paper are in the following three aspects i this paper addresses the leader following formation control problem for multi underactuated auv system in 3d space which is rarely investigated in the previous research in addition this paper introduces the virtual leader into the traditional leader following control strategy to improve the robustness of the formation ii dual closed loop fast integral terminal sliding mode control method is utilized in the design of proposed formation controller this technique can not only guarantees the formation tracking errors converge in finite time but also improve the adaptability and rapidity of the system iii rbf neural network controller is incorporated with conditional integrator to deal with the uncertain model parameters approximation errors and environmental disturbances in practical multi auv systems the remainder of the paper is organized as follows section 2 formulates the mathematical model of underactuated auvs with uncertain dynamics and some useful notations and preliminaries section 3 introduces the design of adaptive dual closed up fast integral terminal sliding mode formation controller and section 4 states the main results of this paper simulation results and conclusions are given in section 5 and 6 respectively 2 preliminaries and problem formulation this section describes the mathematical model of the underactuated auvs and provides the formulation of the leader following formation control problem based on virtual leader 2 1 preliminaries in this section some lemmas and preliminary results that will be used in subsequent stability proofs are presented consider the following time varying nonlinear cascaded system and its subsystems 1 x 1 f t x 1 x 2 f 1 t x 1 g t x 1 x 2 x 2 f 2 t x 2 where x 1 ℝ n 1 x 2 ℝ n 2 t x 1 ℝ 0 ℝ n 1 f 1 t x 1 f 1 t x 1 0 g t x 1 x 2 f t x 1 x 2 f 1 t x 1 0 and g t x 1 0 0 define a finite time bounded positive definite function θ t x 1 ℝ 0 ℝ n 1 ℝ 0 satisfies radially unbounded in x 1 x 2 for its subsystems there is the following finite time stability lemma 1 lemma 1 tibhat and bernstein 2000 suppose there exists a positive definite lyapunov function v d ℝ such that the following inequality is satisfied v x c v x α 0 x ν 0 where c 0 α 0 1 then the system state can converge to the equilibrium point y t f y t in a finite time the convergence time of the system state is as follows 2 t x 1 c 1 a v x 1 α x n then the origin is a locally finite time stable equilibrium of y t f y t for the whole cascade system there is the following finite time stability lemma 2 lemma 2 qiao and zhang 2019 li shihua and yu ping 2007 the cascaded system 1 is uniformly finite time stable if the following conditions hold 1 each subsystem satisfies locally finite time stability respectively 2 the derivative of θ t x 1 satisfies 3 θ t x 1 ω θ t x 1 t t 0 0 where ω ℝ 0 ℝ 0 is a nonsubtractive function satisfying the following conditions for some constant ω 0 4 ω ω 0 ω d c ω c 2 2 auv model the auv dynamic model can be described as 6 dof model in the earth fixed coordinate system e ξ η ζ and the body fixed coordinate system o x y z as shown in fig 1 inspired by do 2009 shojaei and arefi 2015 xia et al 2020 consider the above underactuated 5 dof auvs its dynamics and kinematics model can be presented as follows η i j η i v i 5 m i v i c i v i v i d i v i v i g η i τ i τ i d the expression of the main parameters is as follows and the detailed meaning of each parameter is the same as that of references do 2009 shojaei and arefi 2015 and xia et al 2020 m i is the inertia matrix c i v i is the coriolis and centripetal matrix d i v i is the hydrodynamic damping matrix and j η i is the transformation matrix from the o x y z to the e ξ η ζ respectively are given by 6 m i m 11 0 0 0 0 0 m 22 0 0 0 0 0 m 33 0 0 0 0 0 m 55 0 0 0 0 0 m 66 7 c i v i 0 0 0 m 33 w m 22 v 0 0 0 0 m 11 u 0 0 0 m 11 u 0 m 33 w 0 m 11 u 0 0 m 22 v m 33 u 0 0 0 d i v i d 11 0 0 0 0 0 d 22 0 0 0 0 0 d 33 0 0 0 0 0 d 55 0 0 0 0 0 d 66 8 j η i s 0 0 t s cos ψ cos θ sin ψ cos ψ sin θ sin ψ cos θ cos ψ sin ψ sin θ sin θ 0 cos θ t 1 0 0 1 cos θ τ i τ u 0 0 τ q τ r t and τ i d τ d u τ d v τ d w τ d q τ d r t denote the control inputs and environmental disturbances respectively g η 0 0 0 ρ g g m l sin θ 0 t is the static and static moment matrix according to shojaei and arefi 2015 and yan et al 2019 the underactuated auv kinetics can be divided into two equations that include actuated and unactuated dynamics that is 9a η j a η v a j w η v w 9b m 1 v a c 1 v w v a d 1 v a v a g 1 η τ a τ d 1 9c m 2 v w c 2 v a v w d 2 v w v w τ d 2 where v a u q r t and v w v w t are the velocity vectors of the underactuated auv in the actuated and unactuated directions respectively j a η and j w η v w are represented by the following matrix respectively 10 j a η cos θ cos ψ 0 0 cos θ sin ψ 0 0 sin θ 0 0 0 1 0 0 0 1 cos θ j w η v w v sin ψ w sin θ cos ψ v cos ψ w sin θ sin ψ w cos θ 0 0 the detailed expression of the parameters and matrices in the formula can be obtained in the above references the uncertainty of the underactuated auv dynamic model is due to the uncertainty of hydrodynamic coefficient modeling error and parameter perturbation therefore the model parameters m c v d v g η given in 5 can be written as the sum of the nominal dynamics and uncertain dynamics i e 11 m m m c v c v c v d v d v d v g η g η g η where m c v d v g η are the nominal terms and m c v d v g η are the uncertain terms then the dynamic model of auv given in 1 can be rewritten in the following form 12 m v c v v d v v g η τ τ d τ f where τ f is the uncertain model parameter which is defined as 13 τ f m v c v v d v v g η then the actuated and unactuated dynamic model given in 9 can be rewritten in the follows 14a η j a η v a j w η v w 14b m 1 v a c 1 v w v a d 1 v a v a g 1 η τ a τ d 1 τ f 1 14c m 2 v w c 2 v a v w d 2 v w v w τ d 2 τ f 2 assumption 1 the environmental disturbances are assumed to be bounded in sense that τ f 1 c o n and c o n denotes a positive constant wang et al 2020b qi and cai 2017 shojaei 2016 2 3 virtual leader in the process of multi auv system formation assembling to perform missions a formation reference point frp is defined as the virtual leader and we define the virtual leader exactly the same dynamics as the follower auvs l i i 1 n are the spatial distance error vectors between the follower auvs and the virtual leader the virtual leader moves along the desired trajectory which consists of a series path points η d x d y d z d t pitch and yaw angles are calculated by 16 the follower auv forms a formation by tracking the reference location provided by the virtual leader the mission process of multi auv formation system is shown in fig 2 in order to facilitate the statements of the formation controller the guidance law proposed in yu et al 2019 is adopted according to yu et al 2019 and li et al 2019 the desired point of each follower auv is defined as 15 y i d x i d y i d z i d x d l i cos θ d cos ψ d y d l i cos θ d sin ψ d z d l i sin θ d remark 1 the tracking guidance law proposed in yu et al 2019 is developed by extending the horizontal virtual vehicle method and line of sight los method z ping yan et al 2015 θ d ψ d shown in fig 3 is calculated by los method the detailed derivation process refers to the above references and the conclusion is given directly here 16 θ d arcsin z z d l ψ d arctan y y d x x d in the leader following formation considered in this paper there is a virtual leader which only provides a reference trajectory and virtual attitude information for the follower auvs the formation controller need to be designed for the follower auvs to keep a predefined distance with respect to its virtual leader therefore when the virtual leader cruises the follower auv can generate their own reference trajectory next we formulate the formation position tracking controller for the follower auvs to track the reference trajectory 2 4 adaptive rbf neural network controller the structure of rbf neural network is a kind of forward network topology which is composed of three layers realize the nonlinear mapping x h i x from the input layer to the hidden layer and realize the linear mapping h i x y from the hidden layer to the output layer rbf neural network can learn by itself and approximate any function continuously rbf neural network using gaussian radial basis function as neuron transfer function can accelerate learning speed and can effectively improve the robustness and adaptability of the system shojaei 2016 in rbf neural network any continuous function f x can be approximated by neural network with arbitrary precision f x w t h x ε where x x 1 x n t is the input of the rbf neural network w denotes the ideal constant weight vector and ε is the approximation error the radial basis function 17 h x h 1 x h n x t h i x exp x c i 2 2 b i 2 i 1 n where n is the number of neural network nodes c i and b i denote the center and the width of the receptive field respectively using the universal approximation property of rbf neural networks the continuous smooth function f x can be approximated as follows 18 f ˆ x w ˆ t h x where w ˆ is the weight vector 2 5 conditional integrator the traditional sliding mode controller is affected by chattering which will excite the unmodeled high frequency dynamics reduce the system performance and even lead to system instability seshagiri and khalil 2002 in order to reduce chattering the common method is to replace the discontinuous control with a continuous approximate function in the boundary layer of the sliding manifold but this will increase the steady state error in order to reduce the steady state error the width of the boundary layer must be reduced but too small the boundary layer will make the controller return to the chattering of high frequency mode from a review of seshagiri and khalil 2002 seshagiri and khalil 2005 and references therein conditional integrator has been widely applied to reduce chattering while at the same time achieve zero steady state error the conditional integrator in which integrators only acts in the boundary layer of the sliding mode controller thus improving the transient response of the system in addition it does not cause large overshoot and setting time during the period of control saturation inspired by the literature m burger et al 2009 mernout burger et al 2009 in this section a conditional integrator is introduced to deal with the unknown environmental disturbances τ d 1 this paper will illustrate the idea behind conditional integrators after transform the system to normal form 19 e τ ο where τ is the control input and ο is the unknown constant environmental disturbances with a known bound ο c ο obviously the control goal is to design the controller τ guarantees that e t converges to zero for control input τ we use conditional integrators based on the following work m burger et al 2009 mernout burger et al 2009 as follows from this work the conditional integrator control law is given by 20 τ k s a t g λ e μ 21 λ g λ μ s a t g λ e μ s a t x is an element wise saturation function s a t x x x 1 s g n x x 1 control parameters satisfy k c ο g 0 and μ 0 λ ℝ 3 is an auxiliary state variable this control method combines the benefits of integral action and sliding mode control it can deal with unknown and bounded disturbance by generating smooth and bounded control signals without chattering in what follows we will expand its application on the basis of its existing advantages a detailed analysis will be given in the controller design sectionf 3 formulation controller design this section focuses on the problem of fast formation in multi underactuated auv system in 3 d space the main control objectives are 1 ensuring the formation stability of multi underactuated auv system through the dual closed loop fast integral terminal sliding mode controller 2 approximating system uncertain model parameters by adaptive rbf neural network controller 3 compensating unknown bounded environment disturbances by conditional integrator in order to facilitate the design of the formation controller one of the follower auv is taken as an example to design the controller in the following the detailed block diagram of the proposed adaptive fast integral terminal sliding mode formation controller is shown in fig 4 3 1 outer loop fast integral terminal sliding mode controller in this section the main task of the outer loop fast integral terminal sliding mode controller song and zhang 2016 qiao and zhang 2019 is to design the virtual speed v i c for the actual speed v i a by using the error e i y y i y i d between the system output y i x y z t and the expected output y i d x i d y i d z i d t inspired by consolini and tosques 2012 the system 14 may prove no minimum phase if the system output is directly selected as y η so it is necessary to redefine the system output according to shojaei and arefi 2015 first of all defining a virtual point at a positive constant l from the position of the center of mass then the origin of the earth fixed coordinate system must be coordinate with the virtual point so the system output is redefined as follows 22 y y i x l cos θ cos ψ y l cos θ sin ψ z l sin θ y d y i d x i d y i d z i d where θ and ψ are the pitch angle and yaw angle respectively e y y y d v a v i a v c v i c the trajectory of the virtual leader is a smooth curve and any point on the curve is differentiable therefore the desired trajectory of the follower auv has the same properties then the fast integral terminal sliding mode surface is designed as 23 s y e y α e y 24 e y e y α 1 e y γ 1 with e y 0 0 where α 0 α 1 1 1 γ 1 2 γ 1 g h g h n and all of them are odd from 14 we can obtain that 25 e y j y y v a j δ y v w y d where 26 j y y cos θ cos ψ l sin θ cos ψ l sin ψ cos θ sin ψ l sin θ sin ψ l cos ψ sin θ l cos θ 0 j δ y v w v sin ψ w sin θ cos ψ v cos ψ w sin θ sin ψ w cos θ then from 25 v c which acts as the reference velocity command for the velocity signals v a is designed as 27 v c y d j δ y v w α e y ϖ v c f j y y 28 v c f s y s y 0 i f s y 0 i f s y 0 where ϖ ℝ 3 3 is a constant and positive definite diagonal matrix remark 2 the pitch angle is bounded such that θ π 2 to avoid any possible singularity about j y y in fact according to khac duc do 2009 auvs are not likely to enter the neighborhood of θ π 2 because of the metacentric restoring forces 3 2 inner loop fast integral terminal sliding mode controller different from the outer loop fast integral terminal sliding mode controller the control task in the inner loop is to design the control input τ a to make the velocity error vector e v v a v c converge to 0 in finite time then the inner loop fast integral terminal sliding mode surface is designed as song and zhang 2016 qiao and zhang 2019 29 s v e v β e v 30 e v e v β 1 e v γ 2 with e v 0 0 where β 0 γ 2 γ 1 γ 2 p q p q n and all of them are odd taking the time derivative of 29 yields 31 s v m 1 1 c 1 v w v a d 1 v a v a g 1 y τ d 1 τ f 1 τ a v c β e v β β 1 e v γ 2 to ensure that the system state has the fast convergence when it is far away from the sliding mode surface and approaching the sliding mode surface then choose the following exponential reaching law 32 s v k v s v ρ 2 s i g n s v k v ρ 2 0 from 5 17 18 we design 33 τ a m 1 v c β e v β β 1 e v γ 2 k v s v ρ 2 s v γ 3 s g n s v c 1 v w v a d 1 v a v a g 1 y τ d 1 τ f 1 obviously after the above analysis the formation of multi auv system can be formed theoretically under the control laws 27 28 and 33 in fact it is not difficult to find that the control law 33 contains the uncertain system parameters τ f 1 and unknown environmental disturbances τ d 1 therefore the designed controller cannot be applied to practice so an adaptive rbf neural network controller and a conditional integrator are designed to solve these problems in the following stage 3 3 adaptive rbf neural network controller considering uncertain model parameters the main task of this section is to design an adaptive neural network weight updating rules the rbf neural network is applied to compensate the function f x containing the uncertain model parameters to the controller in this paper the unknown continuous function f x is defined as follows 34 f x τ f 1 m 1 v c c 1 v w v a d 1 v a v a g 1 y then the approximation error of adaptive rbf neural network is 35 f x f ˆ x w t h x ε w ˆ t h x w t h x ε where 36 w t w t w ˆ t different from the method of updating adaptive weights w ˆ directly given in yan et al 2019 this paper proposes a method of deducing the adaptive law of rbf neural network through lyapunov method consider the lyapunov function as 37 v 1 1 2 s v t m 1 s v 1 2 γ 4 w t w where 0 γ 4 1 taking the time derivative of 37 yields 38 v 1 s v t m 1 s v 1 γ 4 w t w ˆ 39 s v t c 1 v w v a d 1 v a v a g 1 y τ d 1 τ f 1 τ a m 1 v c m 1 β e v m 1 β β 1 e v γ 2 1 γ 4 w t w ˆ then the adaptive rbf neural network control law can be designed according to 39 as 40 τ a m 1 v c β e v β β 1 e v γ 2 k v s v ρ 2 s v γ 3 s g n s v c 1 v w v a d 1 v a v a g 1 y τ d 1 f ˆ by substituting the designed control law 40 into the 39 it can be obtained 41 v 1 s v t τ f 1 f ˆ m 1 k v s v m 1 ρ 2 s v γ 3 s g n s v 1 γ 4 w t w ˆ s v t w t h x ε m 1 k v s v m 1 ρ 2 s v γ 3 s g n s v 1 γ 4 w t w ˆ m 1 k v s v 2 m 1 ρ 2 s v 1 γ 3 s g n s v s v t ε w t w ˆ γ 4 s v h x then the adaptive weight law of rbf neural network can be designed as follows 42 w ˆ γ 4 s v h x it is not difficult to find that in the conclusion of system stability obtained in this section the condition that the external environmental constant disturbance τ d 1 is unknown is not taken into account then in order to deal with this problem we introduce a conditional integrator to compensate the external disturbance of the multi auv formation system 3 4 conditional integrator the work in this stage is an extension of the references seshagiri and khalil 2002 and seshagiri and khalil 2005 inspired by e τ ο the essence of the conditional integrator is to design the conditional integrator τ in the presence of external disturbance ο to control the error e converge to zero in a finite time to this end redefine the control law 40 43 τ a m 1 v c β e v β β 1 e v γ 2 k v s v ρ 2 s v γ 3 s g n s v c 1 v w v a d 1 v a v a g 1 y τ ˆ d f ˆ where τ ˆ d is the new control input to be specified later replacing it into the model 14b yields 44 m 1 v a c 1 v w v a d 1 v a v a g 1 η τ a τ d 1 τ f 1 45 m 1 v a m 1 v c m 1 β e v β β 1 e v γ 2 k v s v ρ 2 s v γ 3 s g n s v τ d 1 τ ˆ d τ f 1 f ˆ 46 m 1 e v β e v s v τ d 1 τ ˆ d τ f 1 f ˆ τ d 1 ε τ ˆ d in this way we get a standard form similar to 19 47 e τ ˆ d τ e where e m 1 e v β e v s v and τ e τ d 1 ε stands for lumped disturbance then the controller is developed as 48 τ ˆ d k s a t g λ e μ 49 λ g λ μ s a t g λ e μ and k μ g are diagonal matrices the definition of saturation function has been given in previous section according to m burger et al 2009 the designed conditional integrator is analyzed here noticing that all solution of 49 are bounded for large e with this bound on λ t one can show that for g λ e μ we obtain s a t g λ e μ s g n g λ e μ and 47 48 becomes τ ˆ d k s g n g λ e μ 50 e k s g n g λ e μ τ ε the conditional integrator behaves like a sliding mode controller however when the error e is small for the states λ and e reach the unsaturated zone g λ e μ in finite time s a t g λ e μ g λ e μ inside this zone 49 becomes an integrator λ e and the whole controller behaves like a pi controller 51 τ ˆ d k g λ e μ k i e d t k p e where k i g k μ k p k μ therefore the conditional integrator inherits the advantages of pi controller and sliding mode controller the boundedness of the auxiliary control quantity λ is qualitatively analyzed above and then the lyapunov function v 4 is constructed to analyze its quantity 52 v 2 1 2 λ t g 1 λ taking the time derivative of 52 yields 53 v 2 λ t λ λ t g 1 μ s a t g λ e μ λ t λ 3 λ g 1 μ λ t λ 3 2 g 1 μ 2 3 2 λ 2 54 1 3 2 λ 2 3 2 g 1 μ 2 then it is known from the above formula that the auxiliary control quantity λ is bounded by 55 λ 2 3 3 g 1 μ 4 main results theorem 1 consider a formation system consisting of a group of n under actuated auvs whose outer loop position tracking error dynamics with fast integral terminal sliding mode if the reference velocity command v c for the velocity signals v a is designed as 27 28 then the formation position tracking errors e y converges rapidly to the sliding mode surface and locally converges to 0 along the sliding mode surface in finite time that is the outer loop position tracking error dynamic system is locally finite time stable at the equilibrium e y 0 proof the convergent time t i 1 of e y is obtained as 56 t i 1 t s y 0 s y 0 t v a v c t e y 0 e y 0 let t v a v c be the time when the actual velocities v a converge to the reference velocities v c let t s y 0 s y 0 be the settling time of s y from s y 0 to s y 0 and t e y 0 e y 0 be the convergent time from e y 0 to e y 0 on the surface s y 0 obviously the complete proof of theorem 1 needs to ensure that the actual velocities v a can accurately track the reference velocities v c in a finite time and the detailed proof of t v a v c will be given in theorem 2 to move on consider the following lyapunov function 57 v 3 1 2 s y t s y taking the time derivative of 57 and substituting 23 24 into it yields 58 v 3 s y t s y s y t e y α e y s y t j y y v a j δ y v w y d α e y s y t y d j δ y v w α e y ϖ v c f j δ y v w y d α e y s y t ϖ v c f s y t ϖ s y s y 59 λ min ϖ s y 2 s y 2 λ min ϖ v 1 1 2 with s y 0 therefore it satisfies the form of finite time stability in lemma 1 that is the state of the variable vector s y can reach the sliding surface s y 0 in a finite time and the settling time t s y 0 s y 0 satisfies 60 t s y 0 s y 0 2 λ min ϖ 1 v 1 1 2 s y λ min ϖ 1 s y on the surface s y 0 yields 61 e y t α e y t 62 e y t α e y t α γ 1 α 1 e y γ 1 t solve the bernoulli equation 62 to obtain 63 e y t α 1 e y α t α 1 e y α 1 γ 1 t α 1 γ 1 e y 1 γ 1 0 α 1 1 1 γ 1 thus e y t will coverage to zero in the finite time 64 t e y 0 e y 0 α 1 γ 1 1 ln α 1 1 α 1 γ 1 e y 0 1 γ 1 α 1 65 α 1 γ 1 1 ln α 1 1 e y 0 1 γ 1 α 1 meanwhile the tracking error e y t converge to zero in the same amount of time t e y 0 e y 0 therefore the convergent time of the formation systems outer loop position tracking error is obtained as t 1 i 1 n t i 1 this completes the proof theorem 2 consider the inner loop velocity tracking error dynamics with the proposed controller 43 adaptive rbf neural network controller 34 weight adaptive law 42 disturbance estimation of conditional integrator 48 and 49 then the velocity tracking errors e v will locally converge to zero in finite time namely the velocity tracking error dynamic system e v is locally finite time stable at the equilibrium e v 0 proof consider the following positive definite lyapunov candidate 66 v 4 1 2 s v t m 1 s v 1 2 γ 4 w t w 1 2 λ t g 1 λ differentiating v 2 with respect to time yields 67 v 4 s v t c 1 v w v a d 1 v a v a g 1 y τ d 1 τ f 1 τ a m 1 v c m 1 β e v m 1 β β 1 e v γ 2 1 γ 4 w t w ˆ λ t λ λ t g 1 μ s a t g λ e μ m 1 k v s v 2 m 1 ρ 2 s v 1 γ 3 s g n s v s v t ε w t w ˆ γ 4 s v h x 1 3 2 λ 2 3 2 g 1 μ 2 m 1 ρ 2 s v 1 γ 3 m 1 ρ 2 s v 2 1 γ 3 2 68 m 1 ρ 2 2 1 γ 3 2 v 1 γ 3 2 here 34 42 43 48 49 have been used because 0 γ 3 1 0 1 γ 3 2 1 m 1 ρ 2 2 1 γ 3 2 0 the inequality satisfies the form of finite time stability in lemma 1 that is the state of the system can reach the sliding mode surface s v 0 in finite time similarly according to lemma 1 after reaching the sliding surface the state of the system will reach the equilibrium point e v 0 in a finite time that is the relative velocity is zero 69 t v a v c t e v 0 e v 0 t s v 0 s v 0 according to lemma 1 70 t s y 0 s y 0 1 m 1 ρ 2 2 1 γ 3 2 v e v 1 γ 3 2 similar to theorem 1 on the surface s v 0 yields 71 e v t β e v t 72 e v t β e v t β γ 2 β 1 e v γ 2 t solve 72 to obtain 73 e v t β 1 e v β t β 1 e v β 1 γ 2 t β 1 γ 2 e v 1 γ 2 0 β 1 1 1 γ 2 thus e v t will coverage to zero in finite time 74 t e v 0 e v 0 β 1 γ 2 1 ln β 1 1 β 1 γ 1 e v 0 1 γ 2 β 1 75 β 1 γ 2 1 ln β 1 1 e v 0 1 γ 2 β 1 meanwhile the tracking error e v t converge to zero in the same amount of time t e v 0 e v 0 76 t v a v c 1 m 1 ρ 2 2 1 γ 3 2 v e v 1 γ 3 2 β 1 γ 2 1 ln β 1 1 e v 0 1 γ 2 β 1 this completes the proof theorem 3 consider the full dual closed loop multi auv formation control system with cascade structure which can be expressed as 2 where x 1 e y x 2 e v 77 f 1 t x 1 j y y v c j δ y v w y d α e y ϖ v c f 78 g t x 1 x 2 j y y e v 79 f 2 t x 2 m 1 1 c 1 v w v a d 1 v a v a g 1 y τ d 1 τ f 1 τ a v c has the uniform finite time stability proof consider the following function which is positive definite and finite time bounded 80 θ t x 1 1 2 e y t e y 1 2 x 1 2 select a continuous function k c c 2 as a class k function and compare 80 with class k function such that θ t x 1 k x 1 taking the time derivative of 80 yields 81 θ t x 1 e y t e y α e y t e y ϖ v c f e y t j y y e v α i 1 3 e y i g h h e y t ϖ s y s y e y t j y y e v α i 1 3 e y i g h h λ max ϖ e y j y y e y 82 λ max ϖ j y y e y η e y where 83 η λ max ϖ j y y the following proof is in two cases 84 θ t x 1 η e y η e y 2 2 η θ t x 1 θ t x 1 η e y η x 1 e y 1 x 1 e y 1 therefore from 84 one gets 85 θ t x 1 2 η θ t x 1 η ω θ t x 1 where ω c 2 η c η obviously ω c is a no decreasing function moreover the function ω c satisfies the following conditions 86 ω ω 0 ω 0 ω d c ω c ω d c 2 η c η 2 η 1 ln 2 η c η ω only a brief proof is given here and the detailed method can be referenced in qiao and zhang 2019 from the above analysis the formation system satisfies the two conditions in lemma 2 it is concluded that the full formation system is uniformly finite time stable under the proposed control law this completes the proof 5 simulation results and discussion to illustrate the performance of the control method proposed for leader following formation control of multi underactuated auvs numerical simulations have been performed on an underactuated auv in 5 dof by using related simulation software the nominal model matrices in 2 and 3 are taken as follows m 1 m x u 0 0 0 0 0 m y v 0 0 0 0 0 m z w 0 0 0 0 0 i y m q 0 0 0 0 0 i z n r d 1 d i a g x u y v z w m q n r d i a g x u u u y v v v z w w w m q q q n r r r where m 185 x u 30 y v 80 z w 80 x u u 100 m q 40 i z 40 n r 40 x u 70 i y 40 y v 100 y v v 200 z w 100 z w w 200 m q 50 m q q 100 n r 50 n r r 100 in this paper an auv is assumed to be symmetrical in plane and height and have a torpedo like shape that can provide good hydrodynamic performance this shape also means that some parameters can be ignored or simplified i e g η i 0 in practice these parameters are impossible to be accurately obtained so specifically we assume that the system parameters will simultaneously increase the errors of the order of 10 on actual model in addition the environmental disturbances and system uncertain parameters are also taken into account the lumped uncertainty of the system are chosen as τ d 1 τ f 1 0 1 m i i sin 0 1 t 1 r a n d yan et al 2019 xu et al 2015 where r a n d is gaussian random noise with mean 0 and variance 1 in the following we use a virtual leader and three auvs to form a formation and in order to demonstrate the three dimensional coordinated movement ability of the formation system two mission scenarios are considered 1 virtual leader tracking a spiral diving curve 2 virtual leader tracking along the spatial sine trajectory the detailed virtual leader s desired trajectories and initial positions of the vehicle are shown in table 1 the simulation time range is 150s formation parameters are l 0 5 5 θ 0 π 6 π 6 ψ 0 π 3 π 3 γ 1 1 1 1 α 1 1 β 1 1 α 1 β 4 k y 1 k v 20 ρ 1 1 ϖ d i a g 1 1 1 5 for the neural network the gaussian rbf neural network with the centers c i evenly spaced on 0 1 and the width b i 0 8 the hidden layer contains 5 neurons the weight update rule from the hidden layer to the output layer is given by formula w ˆ γ 4 s v h x for the conditional integrator the control gain matrices are k d i a g 5 1 1 μ d i a g 10 2 2 g d i a g 0 5 0 5 0 1 5 1 control performance discussion the simulation results of scenario 1 are shown in figs 5 13 in fig 5 the green line is the desired trajectory of the virtual leader the red line is the auv1 s trajectory the blue lines represent the trajectories of auv2 and auv3 respectively orange arrows denote external disturbances in the simulation results two aspects can be observed clearly 1 although there is an initial error between auvs and desired trajectory each follower auv can converge to the desired trajectory in finite time 2 the formation remains stable in the presence of environmental disturbances and uncertain model parameters as shown in fig 6 tracking errors denote the position error between each auv and the virtual leader all tracking errors converge to 0 in finite time moreover the settling time accounts for only 1 5 of the simulation time for auv1 combining experimental data and simulation pictures the tracking errors stay in zero after 17s moreover x y z position errors remain constant at 0 000 0 000 0 000 respectively figs 7 8 further show that the whole formation system has the same linear velocity and angular velocity the desired longitudinal velocity and yaw angular velocity are u d 0 5 m s and r d 0 05 r a d s respectively which can be calculated from the desired trajectory it can be seen from figs 7 8 that the longitudinal velocity and yaw angular velocity of each auv can quickly reach their desired values respectively moreover pitch errors and yaw errors between each auv and the virtual leader converge to zero as shown in figs 10 11 however the yaw errors change periodically in fig 11 the main reason is that the research object of this paper is the multi underactuated auv formation system while in the spiral diving high speed tracking mission its ever changing yaw angle makes the nonlinear coupling of auv dynamics more intense figs 12 13 shows the approximate ability of rbf neural network in fig 12 the mean square error mse is a measure that reflects the degree of difference between the estimator and the output obviously under the proposed weight updating rule the estimated error of rbf neural network is close to zero the five lines in fig 13 show the weight update curves of five neurons in the hidden layer it can be observed that the designed adaptive weight updating rate is sensitive and fast in response from all above figures we can clearly see that under the control of the proposed controller the formation system is stable and has good cooperation in scenario 2 the virtual leader moves along a spatial sine trajectory with time varying velocities as in case one the green red and blue lines represent the trajectories of the virtual leader auv1 auv2 and auv3 respectively in fig 14 even if the position attitude and speed information of the auv are required for time varying control the proposed formation controller can not only maintain the stability of the multi underactuated auv system but also control each auv converge to the desired trajectory in finite time similarly the simulation results are shown in figs 14 22 the difference however is that in figs 16 and 18 the actual velocities and control inputs of the vehicle present the time varying characteristics however fig 18 indicates that the lumped system uncertainties can be effectively compensated by the rbf neural network and conditional integrator moreover the system chattering can be suppressed in the presented controller another difference is that in the first case the yaw of the formation changes periodically therefore the yaw error occurs at every inflection point in the second case the pitch of the formation changes periodically the main reason is that in the process of spatial sine trajectory tracking the attitude angles of auv change nonlinearly at all times especially at the corner of the curve which leads to more serious nonlinearity of auv dynamics coupling therefore different from the previous scenario of constant velocity control the attitude errors of the formation system does not converge to zero but converge to a bounded set near zero as shown in fig 20 as well the time varying control requirements make figs 21 22 better demonstrate the approximation ability of the adaptive rbf neural network and the bounded disturbance estimation of the conditional integrator from all above results it is relevant to point out that the proposed control method guarantees the stability of the formation and the desired formation is well established even though the underactuated auv may subject to unknown model parameters and environmental disturbances in 3d space moreover under the proposed controller all position errors and attitude errors converge to zero or a bounded set near zero in finite time 5 2 comparative analysis in this section a comparison with a backstepping method wang et al 2020c and an integral sliding mode controller ismc bian and xiang 2019 is proposed the simulation scenario is that auv1 tracks the virtual leader in the presence of uncertain model parameters and external disturbance simulation results are illustrated as figs 23 26 in the two simulation scenarios under the proposed controller in this paper the position tracking errors converge to 0 fastest and there is almost no overshoot moreover the control forces are stable and almost no chattering obviously it can be observed that the advantage of the proposed controller in tracking performance chattering reducing and convergence speed the proposed controller has the strongest robustness owing to the fast integral terminal sliding mode controller qiao and zhang 2019 and the conditional integrator 6 conclusion a finite time formation controller of multi underactuated auv system with uncertain model parameters and external disturbances has been presented from a practical point of view that is an important contribution since the convergence time has been improved from asymptotic convergence to finite time convergence numerical simulation shows that the convergence time is within 1 5 of the simulation time a dual closed loop fast integral terminal sliding mode controller has been effectively utilized to design a finite time formation controller in contrast to previous works this technique has been proved to not only guarantee the vehicle s dynamics converge to the reference trajectory in finite time including the time evolutions of position attitude as well as velocities but also effectively improve the robustness adaptability and rapidity of the system moreover numerical simulations demonstrate that the proposed controller with adaptive rbf neural network and conditional integrator can effectively be provided with strongly robust with regard to uncertain model parameters approximation errors and environmental disturbances mse converges to 0 1 and the chattering of the controller is almost zero the dual closed loop stability of the formation is demonstrated by using lyapunov method and numerical simulations the next work will focus on the time varying disturbances and real experimental verification of the proposed controller credit authorship contribution statement guoqing xia methodology investigation yu zhang investigation writing original draft wei zhang project administration funding acquisition writing review editing ximing chen software data correction haoyu yang figure optimization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is supported by the national natural science foundation of china grant no 51879049 and the natural science foundation of heilongjiang province china grant no jj2019lh2279 
20674,this paper addresses a dual closed loop fast integral terminal sliding mode control method of a multi underactuated auv formation system with uncertain model parameters and environmental disturbances different from the traditional sliding mode control method this technique can not only keep the formation stable but also significantly overcomes the problem that the formation tracking errors of the traditional method may not converge to zero in finite time then an adaptive radial basis function rbf neural network controller is incorporated with a conditional integrator to deal with the uncertain model parameters approximation errors and environmental disturbances in practical multi auv systems and also the proposed controller is continuous with the property of chattering restraining a virtual leader is adopted on the basis of the leader following strategy to improve the robustness of the formation system and prevent the problem of formation collapse caused by the failure of the leader auv moreover the rigorous stability analysis based on lyapunov method and numerical simulations demonstrate tracking errors converge to 0 in finite time finally simulation results demonstrate the effectiveness of the proposed formation controller the auv formation can track the desired trajectory accurately with 10 model parameter perturbation keywords multi underactuated auv system uncertainties finite time control fast integral terminal sliding mode control rbf neural network conditional integrator 1 introduction in recent years a lot of research has been done in the field of underactuated autonomous underwater vehicle auv formation control aguiar and hespanha 2004 however the auv formation control problem still brings challenges to system designers because most auv are underactuated i e their actuators are less than degrees of freedom dof and impose non integral acceleration constraints yuh 2000 wang et al 2020a zhang et al 2020 wang et al 2019 li et al 2019 yu et al 2019 in addition the kinematic and dynamic models of auv are usually underactuated highly nonlinear and coupled and its hydrodynamic parameters are often uncertain especially when auv may be subjected to unknown disturbances from ocean currents fossen 1994 which makes the formation control of multi underactuated auv become an arduous task based on thorough review of the literatures there are several different approaches to achieve the formation control for multi auv system including artificial potential field method pan et al 2017 virtual structure method z yan et al 2015 and leader following method li et al 2018 park 2015 cui et al 2010 ihle et al 2006 among the above control schemes the leader following control strategy seems to be the most popular one because of its reliability and simplicity it has been widely used in the design of formation controller in the context of multi auv recycling a new leader following consensus protocol with time varying delay for discrete time multi auv recovery systems is proposed by modeling directed fixed communication topology in zhang et al 2020 under the framework of leader following formation strategy wang et al 2019 addressed the problem of three dimensional trajectory tracking control of auv under parameter uncertainties and external disturbances however the above literatures did not take into account the impact on formation when the leader auv fault based on this problem li and du 2018 proposed a formation strategy based on virtual leader which used the virtual reference point as the formation leader to provide reference location information for the follower auvs in the formation however a good formation controller should not only satisfy the stability of the formation system but also improve its robustness and adaptability to system parameter uncertainties and unknown environment disturbances therefore under the leader following formation control method a large number of robust and adaptive techniques are introduced such as neural network fuzzy control sliding mode control sun et al 2018 asif et al 2017 li and zhu 2016 and so on mixing two or more of them is a common control scheme for multi auv formation control systems in wang et al 2020a a bounded formation control law is proposed by comprehensive the backstepping method a neural estimation model and a saturation function it overcomes the formation problems of multi underactuated auv in the case of unknown dynamics and limited control torque wang et al 2020b proposed a filter backstepping based neural adaptive formation tracking control method the calculation explosion of the traditional backstepping method is avoided by using the filtering method and the adaptive neural network is used to improve the adaptive ability of the controller a sliding mode formation control strategy using backstepping method and adaptive neural network is proposed in wang et al 2020c and a continuous proportional integral pi function is designed to avoid the influence of chattering in standard sliding mode control method however above references only considered the situation of the formation system in the horizontal plane in addition most of the formation controller use smooth feedback method and the closed loop system is asymptotically stable this is due to the closed loop control system satisfies lipchitz continuity however the system states which satisfy lipchitz continuity converge exponentially namely the system states really converge to the equilibrium point in infinite time or uncertain time in the field of auv formation control the corresponding evaluation index is closely related to the convergence rate of the system state if the system error converges slowly it may lead to formation failure or instability from the point of view of time optimization and practical application of auv formation system the finite time control method is of significance gao and guo 2020 and qiao and zhang 2019 proposed two methods to prove the finite time stability of auv formation system respectively and gao and guo 2020 and qiao and zhang 2019 adopt command filtered method and integral terminal sliding mode control method respectively in yu et al 2019 the globally finite time control strategy is proposed based on the proportional integral derivative sliding mode control pid smc which globally stabilizes all trajectory tracking errors in the finite time motivated by aforementioned considerations this paper studies the 3d finite time formation problem of a class of underactuated auvs in 5 dof with uncertain model parameters and unknown environmental disturbances compared with previous representative literatures the main novelties and contributions of this paper are in the following three aspects i this paper addresses the leader following formation control problem for multi underactuated auv system in 3d space which is rarely investigated in the previous research in addition this paper introduces the virtual leader into the traditional leader following control strategy to improve the robustness of the formation ii dual closed loop fast integral terminal sliding mode control method is utilized in the design of proposed formation controller this technique can not only guarantees the formation tracking errors converge in finite time but also improve the adaptability and rapidity of the system iii rbf neural network controller is incorporated with conditional integrator to deal with the uncertain model parameters approximation errors and environmental disturbances in practical multi auv systems the remainder of the paper is organized as follows section 2 formulates the mathematical model of underactuated auvs with uncertain dynamics and some useful notations and preliminaries section 3 introduces the design of adaptive dual closed up fast integral terminal sliding mode formation controller and section 4 states the main results of this paper simulation results and conclusions are given in section 5 and 6 respectively 2 preliminaries and problem formulation this section describes the mathematical model of the underactuated auvs and provides the formulation of the leader following formation control problem based on virtual leader 2 1 preliminaries in this section some lemmas and preliminary results that will be used in subsequent stability proofs are presented consider the following time varying nonlinear cascaded system and its subsystems 1 x 1 f t x 1 x 2 f 1 t x 1 g t x 1 x 2 x 2 f 2 t x 2 where x 1 ℝ n 1 x 2 ℝ n 2 t x 1 ℝ 0 ℝ n 1 f 1 t x 1 f 1 t x 1 0 g t x 1 x 2 f t x 1 x 2 f 1 t x 1 0 and g t x 1 0 0 define a finite time bounded positive definite function θ t x 1 ℝ 0 ℝ n 1 ℝ 0 satisfies radially unbounded in x 1 x 2 for its subsystems there is the following finite time stability lemma 1 lemma 1 tibhat and bernstein 2000 suppose there exists a positive definite lyapunov function v d ℝ such that the following inequality is satisfied v x c v x α 0 x ν 0 where c 0 α 0 1 then the system state can converge to the equilibrium point y t f y t in a finite time the convergence time of the system state is as follows 2 t x 1 c 1 a v x 1 α x n then the origin is a locally finite time stable equilibrium of y t f y t for the whole cascade system there is the following finite time stability lemma 2 lemma 2 qiao and zhang 2019 li shihua and yu ping 2007 the cascaded system 1 is uniformly finite time stable if the following conditions hold 1 each subsystem satisfies locally finite time stability respectively 2 the derivative of θ t x 1 satisfies 3 θ t x 1 ω θ t x 1 t t 0 0 where ω ℝ 0 ℝ 0 is a nonsubtractive function satisfying the following conditions for some constant ω 0 4 ω ω 0 ω d c ω c 2 2 auv model the auv dynamic model can be described as 6 dof model in the earth fixed coordinate system e ξ η ζ and the body fixed coordinate system o x y z as shown in fig 1 inspired by do 2009 shojaei and arefi 2015 xia et al 2020 consider the above underactuated 5 dof auvs its dynamics and kinematics model can be presented as follows η i j η i v i 5 m i v i c i v i v i d i v i v i g η i τ i τ i d the expression of the main parameters is as follows and the detailed meaning of each parameter is the same as that of references do 2009 shojaei and arefi 2015 and xia et al 2020 m i is the inertia matrix c i v i is the coriolis and centripetal matrix d i v i is the hydrodynamic damping matrix and j η i is the transformation matrix from the o x y z to the e ξ η ζ respectively are given by 6 m i m 11 0 0 0 0 0 m 22 0 0 0 0 0 m 33 0 0 0 0 0 m 55 0 0 0 0 0 m 66 7 c i v i 0 0 0 m 33 w m 22 v 0 0 0 0 m 11 u 0 0 0 m 11 u 0 m 33 w 0 m 11 u 0 0 m 22 v m 33 u 0 0 0 d i v i d 11 0 0 0 0 0 d 22 0 0 0 0 0 d 33 0 0 0 0 0 d 55 0 0 0 0 0 d 66 8 j η i s 0 0 t s cos ψ cos θ sin ψ cos ψ sin θ sin ψ cos θ cos ψ sin ψ sin θ sin θ 0 cos θ t 1 0 0 1 cos θ τ i τ u 0 0 τ q τ r t and τ i d τ d u τ d v τ d w τ d q τ d r t denote the control inputs and environmental disturbances respectively g η 0 0 0 ρ g g m l sin θ 0 t is the static and static moment matrix according to shojaei and arefi 2015 and yan et al 2019 the underactuated auv kinetics can be divided into two equations that include actuated and unactuated dynamics that is 9a η j a η v a j w η v w 9b m 1 v a c 1 v w v a d 1 v a v a g 1 η τ a τ d 1 9c m 2 v w c 2 v a v w d 2 v w v w τ d 2 where v a u q r t and v w v w t are the velocity vectors of the underactuated auv in the actuated and unactuated directions respectively j a η and j w η v w are represented by the following matrix respectively 10 j a η cos θ cos ψ 0 0 cos θ sin ψ 0 0 sin θ 0 0 0 1 0 0 0 1 cos θ j w η v w v sin ψ w sin θ cos ψ v cos ψ w sin θ sin ψ w cos θ 0 0 the detailed expression of the parameters and matrices in the formula can be obtained in the above references the uncertainty of the underactuated auv dynamic model is due to the uncertainty of hydrodynamic coefficient modeling error and parameter perturbation therefore the model parameters m c v d v g η given in 5 can be written as the sum of the nominal dynamics and uncertain dynamics i e 11 m m m c v c v c v d v d v d v g η g η g η where m c v d v g η are the nominal terms and m c v d v g η are the uncertain terms then the dynamic model of auv given in 1 can be rewritten in the following form 12 m v c v v d v v g η τ τ d τ f where τ f is the uncertain model parameter which is defined as 13 τ f m v c v v d v v g η then the actuated and unactuated dynamic model given in 9 can be rewritten in the follows 14a η j a η v a j w η v w 14b m 1 v a c 1 v w v a d 1 v a v a g 1 η τ a τ d 1 τ f 1 14c m 2 v w c 2 v a v w d 2 v w v w τ d 2 τ f 2 assumption 1 the environmental disturbances are assumed to be bounded in sense that τ f 1 c o n and c o n denotes a positive constant wang et al 2020b qi and cai 2017 shojaei 2016 2 3 virtual leader in the process of multi auv system formation assembling to perform missions a formation reference point frp is defined as the virtual leader and we define the virtual leader exactly the same dynamics as the follower auvs l i i 1 n are the spatial distance error vectors between the follower auvs and the virtual leader the virtual leader moves along the desired trajectory which consists of a series path points η d x d y d z d t pitch and yaw angles are calculated by 16 the follower auv forms a formation by tracking the reference location provided by the virtual leader the mission process of multi auv formation system is shown in fig 2 in order to facilitate the statements of the formation controller the guidance law proposed in yu et al 2019 is adopted according to yu et al 2019 and li et al 2019 the desired point of each follower auv is defined as 15 y i d x i d y i d z i d x d l i cos θ d cos ψ d y d l i cos θ d sin ψ d z d l i sin θ d remark 1 the tracking guidance law proposed in yu et al 2019 is developed by extending the horizontal virtual vehicle method and line of sight los method z ping yan et al 2015 θ d ψ d shown in fig 3 is calculated by los method the detailed derivation process refers to the above references and the conclusion is given directly here 16 θ d arcsin z z d l ψ d arctan y y d x x d in the leader following formation considered in this paper there is a virtual leader which only provides a reference trajectory and virtual attitude information for the follower auvs the formation controller need to be designed for the follower auvs to keep a predefined distance with respect to its virtual leader therefore when the virtual leader cruises the follower auv can generate their own reference trajectory next we formulate the formation position tracking controller for the follower auvs to track the reference trajectory 2 4 adaptive rbf neural network controller the structure of rbf neural network is a kind of forward network topology which is composed of three layers realize the nonlinear mapping x h i x from the input layer to the hidden layer and realize the linear mapping h i x y from the hidden layer to the output layer rbf neural network can learn by itself and approximate any function continuously rbf neural network using gaussian radial basis function as neuron transfer function can accelerate learning speed and can effectively improve the robustness and adaptability of the system shojaei 2016 in rbf neural network any continuous function f x can be approximated by neural network with arbitrary precision f x w t h x ε where x x 1 x n t is the input of the rbf neural network w denotes the ideal constant weight vector and ε is the approximation error the radial basis function 17 h x h 1 x h n x t h i x exp x c i 2 2 b i 2 i 1 n where n is the number of neural network nodes c i and b i denote the center and the width of the receptive field respectively using the universal approximation property of rbf neural networks the continuous smooth function f x can be approximated as follows 18 f ˆ x w ˆ t h x where w ˆ is the weight vector 2 5 conditional integrator the traditional sliding mode controller is affected by chattering which will excite the unmodeled high frequency dynamics reduce the system performance and even lead to system instability seshagiri and khalil 2002 in order to reduce chattering the common method is to replace the discontinuous control with a continuous approximate function in the boundary layer of the sliding manifold but this will increase the steady state error in order to reduce the steady state error the width of the boundary layer must be reduced but too small the boundary layer will make the controller return to the chattering of high frequency mode from a review of seshagiri and khalil 2002 seshagiri and khalil 2005 and references therein conditional integrator has been widely applied to reduce chattering while at the same time achieve zero steady state error the conditional integrator in which integrators only acts in the boundary layer of the sliding mode controller thus improving the transient response of the system in addition it does not cause large overshoot and setting time during the period of control saturation inspired by the literature m burger et al 2009 mernout burger et al 2009 in this section a conditional integrator is introduced to deal with the unknown environmental disturbances τ d 1 this paper will illustrate the idea behind conditional integrators after transform the system to normal form 19 e τ ο where τ is the control input and ο is the unknown constant environmental disturbances with a known bound ο c ο obviously the control goal is to design the controller τ guarantees that e t converges to zero for control input τ we use conditional integrators based on the following work m burger et al 2009 mernout burger et al 2009 as follows from this work the conditional integrator control law is given by 20 τ k s a t g λ e μ 21 λ g λ μ s a t g λ e μ s a t x is an element wise saturation function s a t x x x 1 s g n x x 1 control parameters satisfy k c ο g 0 and μ 0 λ ℝ 3 is an auxiliary state variable this control method combines the benefits of integral action and sliding mode control it can deal with unknown and bounded disturbance by generating smooth and bounded control signals without chattering in what follows we will expand its application on the basis of its existing advantages a detailed analysis will be given in the controller design sectionf 3 formulation controller design this section focuses on the problem of fast formation in multi underactuated auv system in 3 d space the main control objectives are 1 ensuring the formation stability of multi underactuated auv system through the dual closed loop fast integral terminal sliding mode controller 2 approximating system uncertain model parameters by adaptive rbf neural network controller 3 compensating unknown bounded environment disturbances by conditional integrator in order to facilitate the design of the formation controller one of the follower auv is taken as an example to design the controller in the following the detailed block diagram of the proposed adaptive fast integral terminal sliding mode formation controller is shown in fig 4 3 1 outer loop fast integral terminal sliding mode controller in this section the main task of the outer loop fast integral terminal sliding mode controller song and zhang 2016 qiao and zhang 2019 is to design the virtual speed v i c for the actual speed v i a by using the error e i y y i y i d between the system output y i x y z t and the expected output y i d x i d y i d z i d t inspired by consolini and tosques 2012 the system 14 may prove no minimum phase if the system output is directly selected as y η so it is necessary to redefine the system output according to shojaei and arefi 2015 first of all defining a virtual point at a positive constant l from the position of the center of mass then the origin of the earth fixed coordinate system must be coordinate with the virtual point so the system output is redefined as follows 22 y y i x l cos θ cos ψ y l cos θ sin ψ z l sin θ y d y i d x i d y i d z i d where θ and ψ are the pitch angle and yaw angle respectively e y y y d v a v i a v c v i c the trajectory of the virtual leader is a smooth curve and any point on the curve is differentiable therefore the desired trajectory of the follower auv has the same properties then the fast integral terminal sliding mode surface is designed as 23 s y e y α e y 24 e y e y α 1 e y γ 1 with e y 0 0 where α 0 α 1 1 1 γ 1 2 γ 1 g h g h n and all of them are odd from 14 we can obtain that 25 e y j y y v a j δ y v w y d where 26 j y y cos θ cos ψ l sin θ cos ψ l sin ψ cos θ sin ψ l sin θ sin ψ l cos ψ sin θ l cos θ 0 j δ y v w v sin ψ w sin θ cos ψ v cos ψ w sin θ sin ψ w cos θ then from 25 v c which acts as the reference velocity command for the velocity signals v a is designed as 27 v c y d j δ y v w α e y ϖ v c f j y y 28 v c f s y s y 0 i f s y 0 i f s y 0 where ϖ ℝ 3 3 is a constant and positive definite diagonal matrix remark 2 the pitch angle is bounded such that θ π 2 to avoid any possible singularity about j y y in fact according to khac duc do 2009 auvs are not likely to enter the neighborhood of θ π 2 because of the metacentric restoring forces 3 2 inner loop fast integral terminal sliding mode controller different from the outer loop fast integral terminal sliding mode controller the control task in the inner loop is to design the control input τ a to make the velocity error vector e v v a v c converge to 0 in finite time then the inner loop fast integral terminal sliding mode surface is designed as song and zhang 2016 qiao and zhang 2019 29 s v e v β e v 30 e v e v β 1 e v γ 2 with e v 0 0 where β 0 γ 2 γ 1 γ 2 p q p q n and all of them are odd taking the time derivative of 29 yields 31 s v m 1 1 c 1 v w v a d 1 v a v a g 1 y τ d 1 τ f 1 τ a v c β e v β β 1 e v γ 2 to ensure that the system state has the fast convergence when it is far away from the sliding mode surface and approaching the sliding mode surface then choose the following exponential reaching law 32 s v k v s v ρ 2 s i g n s v k v ρ 2 0 from 5 17 18 we design 33 τ a m 1 v c β e v β β 1 e v γ 2 k v s v ρ 2 s v γ 3 s g n s v c 1 v w v a d 1 v a v a g 1 y τ d 1 τ f 1 obviously after the above analysis the formation of multi auv system can be formed theoretically under the control laws 27 28 and 33 in fact it is not difficult to find that the control law 33 contains the uncertain system parameters τ f 1 and unknown environmental disturbances τ d 1 therefore the designed controller cannot be applied to practice so an adaptive rbf neural network controller and a conditional integrator are designed to solve these problems in the following stage 3 3 adaptive rbf neural network controller considering uncertain model parameters the main task of this section is to design an adaptive neural network weight updating rules the rbf neural network is applied to compensate the function f x containing the uncertain model parameters to the controller in this paper the unknown continuous function f x is defined as follows 34 f x τ f 1 m 1 v c c 1 v w v a d 1 v a v a g 1 y then the approximation error of adaptive rbf neural network is 35 f x f ˆ x w t h x ε w ˆ t h x w t h x ε where 36 w t w t w ˆ t different from the method of updating adaptive weights w ˆ directly given in yan et al 2019 this paper proposes a method of deducing the adaptive law of rbf neural network through lyapunov method consider the lyapunov function as 37 v 1 1 2 s v t m 1 s v 1 2 γ 4 w t w where 0 γ 4 1 taking the time derivative of 37 yields 38 v 1 s v t m 1 s v 1 γ 4 w t w ˆ 39 s v t c 1 v w v a d 1 v a v a g 1 y τ d 1 τ f 1 τ a m 1 v c m 1 β e v m 1 β β 1 e v γ 2 1 γ 4 w t w ˆ then the adaptive rbf neural network control law can be designed according to 39 as 40 τ a m 1 v c β e v β β 1 e v γ 2 k v s v ρ 2 s v γ 3 s g n s v c 1 v w v a d 1 v a v a g 1 y τ d 1 f ˆ by substituting the designed control law 40 into the 39 it can be obtained 41 v 1 s v t τ f 1 f ˆ m 1 k v s v m 1 ρ 2 s v γ 3 s g n s v 1 γ 4 w t w ˆ s v t w t h x ε m 1 k v s v m 1 ρ 2 s v γ 3 s g n s v 1 γ 4 w t w ˆ m 1 k v s v 2 m 1 ρ 2 s v 1 γ 3 s g n s v s v t ε w t w ˆ γ 4 s v h x then the adaptive weight law of rbf neural network can be designed as follows 42 w ˆ γ 4 s v h x it is not difficult to find that in the conclusion of system stability obtained in this section the condition that the external environmental constant disturbance τ d 1 is unknown is not taken into account then in order to deal with this problem we introduce a conditional integrator to compensate the external disturbance of the multi auv formation system 3 4 conditional integrator the work in this stage is an extension of the references seshagiri and khalil 2002 and seshagiri and khalil 2005 inspired by e τ ο the essence of the conditional integrator is to design the conditional integrator τ in the presence of external disturbance ο to control the error e converge to zero in a finite time to this end redefine the control law 40 43 τ a m 1 v c β e v β β 1 e v γ 2 k v s v ρ 2 s v γ 3 s g n s v c 1 v w v a d 1 v a v a g 1 y τ ˆ d f ˆ where τ ˆ d is the new control input to be specified later replacing it into the model 14b yields 44 m 1 v a c 1 v w v a d 1 v a v a g 1 η τ a τ d 1 τ f 1 45 m 1 v a m 1 v c m 1 β e v β β 1 e v γ 2 k v s v ρ 2 s v γ 3 s g n s v τ d 1 τ ˆ d τ f 1 f ˆ 46 m 1 e v β e v s v τ d 1 τ ˆ d τ f 1 f ˆ τ d 1 ε τ ˆ d in this way we get a standard form similar to 19 47 e τ ˆ d τ e where e m 1 e v β e v s v and τ e τ d 1 ε stands for lumped disturbance then the controller is developed as 48 τ ˆ d k s a t g λ e μ 49 λ g λ μ s a t g λ e μ and k μ g are diagonal matrices the definition of saturation function has been given in previous section according to m burger et al 2009 the designed conditional integrator is analyzed here noticing that all solution of 49 are bounded for large e with this bound on λ t one can show that for g λ e μ we obtain s a t g λ e μ s g n g λ e μ and 47 48 becomes τ ˆ d k s g n g λ e μ 50 e k s g n g λ e μ τ ε the conditional integrator behaves like a sliding mode controller however when the error e is small for the states λ and e reach the unsaturated zone g λ e μ in finite time s a t g λ e μ g λ e μ inside this zone 49 becomes an integrator λ e and the whole controller behaves like a pi controller 51 τ ˆ d k g λ e μ k i e d t k p e where k i g k μ k p k μ therefore the conditional integrator inherits the advantages of pi controller and sliding mode controller the boundedness of the auxiliary control quantity λ is qualitatively analyzed above and then the lyapunov function v 4 is constructed to analyze its quantity 52 v 2 1 2 λ t g 1 λ taking the time derivative of 52 yields 53 v 2 λ t λ λ t g 1 μ s a t g λ e μ λ t λ 3 λ g 1 μ λ t λ 3 2 g 1 μ 2 3 2 λ 2 54 1 3 2 λ 2 3 2 g 1 μ 2 then it is known from the above formula that the auxiliary control quantity λ is bounded by 55 λ 2 3 3 g 1 μ 4 main results theorem 1 consider a formation system consisting of a group of n under actuated auvs whose outer loop position tracking error dynamics with fast integral terminal sliding mode if the reference velocity command v c for the velocity signals v a is designed as 27 28 then the formation position tracking errors e y converges rapidly to the sliding mode surface and locally converges to 0 along the sliding mode surface in finite time that is the outer loop position tracking error dynamic system is locally finite time stable at the equilibrium e y 0 proof the convergent time t i 1 of e y is obtained as 56 t i 1 t s y 0 s y 0 t v a v c t e y 0 e y 0 let t v a v c be the time when the actual velocities v a converge to the reference velocities v c let t s y 0 s y 0 be the settling time of s y from s y 0 to s y 0 and t e y 0 e y 0 be the convergent time from e y 0 to e y 0 on the surface s y 0 obviously the complete proof of theorem 1 needs to ensure that the actual velocities v a can accurately track the reference velocities v c in a finite time and the detailed proof of t v a v c will be given in theorem 2 to move on consider the following lyapunov function 57 v 3 1 2 s y t s y taking the time derivative of 57 and substituting 23 24 into it yields 58 v 3 s y t s y s y t e y α e y s y t j y y v a j δ y v w y d α e y s y t y d j δ y v w α e y ϖ v c f j δ y v w y d α e y s y t ϖ v c f s y t ϖ s y s y 59 λ min ϖ s y 2 s y 2 λ min ϖ v 1 1 2 with s y 0 therefore it satisfies the form of finite time stability in lemma 1 that is the state of the variable vector s y can reach the sliding surface s y 0 in a finite time and the settling time t s y 0 s y 0 satisfies 60 t s y 0 s y 0 2 λ min ϖ 1 v 1 1 2 s y λ min ϖ 1 s y on the surface s y 0 yields 61 e y t α e y t 62 e y t α e y t α γ 1 α 1 e y γ 1 t solve the bernoulli equation 62 to obtain 63 e y t α 1 e y α t α 1 e y α 1 γ 1 t α 1 γ 1 e y 1 γ 1 0 α 1 1 1 γ 1 thus e y t will coverage to zero in the finite time 64 t e y 0 e y 0 α 1 γ 1 1 ln α 1 1 α 1 γ 1 e y 0 1 γ 1 α 1 65 α 1 γ 1 1 ln α 1 1 e y 0 1 γ 1 α 1 meanwhile the tracking error e y t converge to zero in the same amount of time t e y 0 e y 0 therefore the convergent time of the formation systems outer loop position tracking error is obtained as t 1 i 1 n t i 1 this completes the proof theorem 2 consider the inner loop velocity tracking error dynamics with the proposed controller 43 adaptive rbf neural network controller 34 weight adaptive law 42 disturbance estimation of conditional integrator 48 and 49 then the velocity tracking errors e v will locally converge to zero in finite time namely the velocity tracking error dynamic system e v is locally finite time stable at the equilibrium e v 0 proof consider the following positive definite lyapunov candidate 66 v 4 1 2 s v t m 1 s v 1 2 γ 4 w t w 1 2 λ t g 1 λ differentiating v 2 with respect to time yields 67 v 4 s v t c 1 v w v a d 1 v a v a g 1 y τ d 1 τ f 1 τ a m 1 v c m 1 β e v m 1 β β 1 e v γ 2 1 γ 4 w t w ˆ λ t λ λ t g 1 μ s a t g λ e μ m 1 k v s v 2 m 1 ρ 2 s v 1 γ 3 s g n s v s v t ε w t w ˆ γ 4 s v h x 1 3 2 λ 2 3 2 g 1 μ 2 m 1 ρ 2 s v 1 γ 3 m 1 ρ 2 s v 2 1 γ 3 2 68 m 1 ρ 2 2 1 γ 3 2 v 1 γ 3 2 here 34 42 43 48 49 have been used because 0 γ 3 1 0 1 γ 3 2 1 m 1 ρ 2 2 1 γ 3 2 0 the inequality satisfies the form of finite time stability in lemma 1 that is the state of the system can reach the sliding mode surface s v 0 in finite time similarly according to lemma 1 after reaching the sliding surface the state of the system will reach the equilibrium point e v 0 in a finite time that is the relative velocity is zero 69 t v a v c t e v 0 e v 0 t s v 0 s v 0 according to lemma 1 70 t s y 0 s y 0 1 m 1 ρ 2 2 1 γ 3 2 v e v 1 γ 3 2 similar to theorem 1 on the surface s v 0 yields 71 e v t β e v t 72 e v t β e v t β γ 2 β 1 e v γ 2 t solve 72 to obtain 73 e v t β 1 e v β t β 1 e v β 1 γ 2 t β 1 γ 2 e v 1 γ 2 0 β 1 1 1 γ 2 thus e v t will coverage to zero in finite time 74 t e v 0 e v 0 β 1 γ 2 1 ln β 1 1 β 1 γ 1 e v 0 1 γ 2 β 1 75 β 1 γ 2 1 ln β 1 1 e v 0 1 γ 2 β 1 meanwhile the tracking error e v t converge to zero in the same amount of time t e v 0 e v 0 76 t v a v c 1 m 1 ρ 2 2 1 γ 3 2 v e v 1 γ 3 2 β 1 γ 2 1 ln β 1 1 e v 0 1 γ 2 β 1 this completes the proof theorem 3 consider the full dual closed loop multi auv formation control system with cascade structure which can be expressed as 2 where x 1 e y x 2 e v 77 f 1 t x 1 j y y v c j δ y v w y d α e y ϖ v c f 78 g t x 1 x 2 j y y e v 79 f 2 t x 2 m 1 1 c 1 v w v a d 1 v a v a g 1 y τ d 1 τ f 1 τ a v c has the uniform finite time stability proof consider the following function which is positive definite and finite time bounded 80 θ t x 1 1 2 e y t e y 1 2 x 1 2 select a continuous function k c c 2 as a class k function and compare 80 with class k function such that θ t x 1 k x 1 taking the time derivative of 80 yields 81 θ t x 1 e y t e y α e y t e y ϖ v c f e y t j y y e v α i 1 3 e y i g h h e y t ϖ s y s y e y t j y y e v α i 1 3 e y i g h h λ max ϖ e y j y y e y 82 λ max ϖ j y y e y η e y where 83 η λ max ϖ j y y the following proof is in two cases 84 θ t x 1 η e y η e y 2 2 η θ t x 1 θ t x 1 η e y η x 1 e y 1 x 1 e y 1 therefore from 84 one gets 85 θ t x 1 2 η θ t x 1 η ω θ t x 1 where ω c 2 η c η obviously ω c is a no decreasing function moreover the function ω c satisfies the following conditions 86 ω ω 0 ω 0 ω d c ω c ω d c 2 η c η 2 η 1 ln 2 η c η ω only a brief proof is given here and the detailed method can be referenced in qiao and zhang 2019 from the above analysis the formation system satisfies the two conditions in lemma 2 it is concluded that the full formation system is uniformly finite time stable under the proposed control law this completes the proof 5 simulation results and discussion to illustrate the performance of the control method proposed for leader following formation control of multi underactuated auvs numerical simulations have been performed on an underactuated auv in 5 dof by using related simulation software the nominal model matrices in 2 and 3 are taken as follows m 1 m x u 0 0 0 0 0 m y v 0 0 0 0 0 m z w 0 0 0 0 0 i y m q 0 0 0 0 0 i z n r d 1 d i a g x u y v z w m q n r d i a g x u u u y v v v z w w w m q q q n r r r where m 185 x u 30 y v 80 z w 80 x u u 100 m q 40 i z 40 n r 40 x u 70 i y 40 y v 100 y v v 200 z w 100 z w w 200 m q 50 m q q 100 n r 50 n r r 100 in this paper an auv is assumed to be symmetrical in plane and height and have a torpedo like shape that can provide good hydrodynamic performance this shape also means that some parameters can be ignored or simplified i e g η i 0 in practice these parameters are impossible to be accurately obtained so specifically we assume that the system parameters will simultaneously increase the errors of the order of 10 on actual model in addition the environmental disturbances and system uncertain parameters are also taken into account the lumped uncertainty of the system are chosen as τ d 1 τ f 1 0 1 m i i sin 0 1 t 1 r a n d yan et al 2019 xu et al 2015 where r a n d is gaussian random noise with mean 0 and variance 1 in the following we use a virtual leader and three auvs to form a formation and in order to demonstrate the three dimensional coordinated movement ability of the formation system two mission scenarios are considered 1 virtual leader tracking a spiral diving curve 2 virtual leader tracking along the spatial sine trajectory the detailed virtual leader s desired trajectories and initial positions of the vehicle are shown in table 1 the simulation time range is 150s formation parameters are l 0 5 5 θ 0 π 6 π 6 ψ 0 π 3 π 3 γ 1 1 1 1 α 1 1 β 1 1 α 1 β 4 k y 1 k v 20 ρ 1 1 ϖ d i a g 1 1 1 5 for the neural network the gaussian rbf neural network with the centers c i evenly spaced on 0 1 and the width b i 0 8 the hidden layer contains 5 neurons the weight update rule from the hidden layer to the output layer is given by formula w ˆ γ 4 s v h x for the conditional integrator the control gain matrices are k d i a g 5 1 1 μ d i a g 10 2 2 g d i a g 0 5 0 5 0 1 5 1 control performance discussion the simulation results of scenario 1 are shown in figs 5 13 in fig 5 the green line is the desired trajectory of the virtual leader the red line is the auv1 s trajectory the blue lines represent the trajectories of auv2 and auv3 respectively orange arrows denote external disturbances in the simulation results two aspects can be observed clearly 1 although there is an initial error between auvs and desired trajectory each follower auv can converge to the desired trajectory in finite time 2 the formation remains stable in the presence of environmental disturbances and uncertain model parameters as shown in fig 6 tracking errors denote the position error between each auv and the virtual leader all tracking errors converge to 0 in finite time moreover the settling time accounts for only 1 5 of the simulation time for auv1 combining experimental data and simulation pictures the tracking errors stay in zero after 17s moreover x y z position errors remain constant at 0 000 0 000 0 000 respectively figs 7 8 further show that the whole formation system has the same linear velocity and angular velocity the desired longitudinal velocity and yaw angular velocity are u d 0 5 m s and r d 0 05 r a d s respectively which can be calculated from the desired trajectory it can be seen from figs 7 8 that the longitudinal velocity and yaw angular velocity of each auv can quickly reach their desired values respectively moreover pitch errors and yaw errors between each auv and the virtual leader converge to zero as shown in figs 10 11 however the yaw errors change periodically in fig 11 the main reason is that the research object of this paper is the multi underactuated auv formation system while in the spiral diving high speed tracking mission its ever changing yaw angle makes the nonlinear coupling of auv dynamics more intense figs 12 13 shows the approximate ability of rbf neural network in fig 12 the mean square error mse is a measure that reflects the degree of difference between the estimator and the output obviously under the proposed weight updating rule the estimated error of rbf neural network is close to zero the five lines in fig 13 show the weight update curves of five neurons in the hidden layer it can be observed that the designed adaptive weight updating rate is sensitive and fast in response from all above figures we can clearly see that under the control of the proposed controller the formation system is stable and has good cooperation in scenario 2 the virtual leader moves along a spatial sine trajectory with time varying velocities as in case one the green red and blue lines represent the trajectories of the virtual leader auv1 auv2 and auv3 respectively in fig 14 even if the position attitude and speed information of the auv are required for time varying control the proposed formation controller can not only maintain the stability of the multi underactuated auv system but also control each auv converge to the desired trajectory in finite time similarly the simulation results are shown in figs 14 22 the difference however is that in figs 16 and 18 the actual velocities and control inputs of the vehicle present the time varying characteristics however fig 18 indicates that the lumped system uncertainties can be effectively compensated by the rbf neural network and conditional integrator moreover the system chattering can be suppressed in the presented controller another difference is that in the first case the yaw of the formation changes periodically therefore the yaw error occurs at every inflection point in the second case the pitch of the formation changes periodically the main reason is that in the process of spatial sine trajectory tracking the attitude angles of auv change nonlinearly at all times especially at the corner of the curve which leads to more serious nonlinearity of auv dynamics coupling therefore different from the previous scenario of constant velocity control the attitude errors of the formation system does not converge to zero but converge to a bounded set near zero as shown in fig 20 as well the time varying control requirements make figs 21 22 better demonstrate the approximation ability of the adaptive rbf neural network and the bounded disturbance estimation of the conditional integrator from all above results it is relevant to point out that the proposed control method guarantees the stability of the formation and the desired formation is well established even though the underactuated auv may subject to unknown model parameters and environmental disturbances in 3d space moreover under the proposed controller all position errors and attitude errors converge to zero or a bounded set near zero in finite time 5 2 comparative analysis in this section a comparison with a backstepping method wang et al 2020c and an integral sliding mode controller ismc bian and xiang 2019 is proposed the simulation scenario is that auv1 tracks the virtual leader in the presence of uncertain model parameters and external disturbance simulation results are illustrated as figs 23 26 in the two simulation scenarios under the proposed controller in this paper the position tracking errors converge to 0 fastest and there is almost no overshoot moreover the control forces are stable and almost no chattering obviously it can be observed that the advantage of the proposed controller in tracking performance chattering reducing and convergence speed the proposed controller has the strongest robustness owing to the fast integral terminal sliding mode controller qiao and zhang 2019 and the conditional integrator 6 conclusion a finite time formation controller of multi underactuated auv system with uncertain model parameters and external disturbances has been presented from a practical point of view that is an important contribution since the convergence time has been improved from asymptotic convergence to finite time convergence numerical simulation shows that the convergence time is within 1 5 of the simulation time a dual closed loop fast integral terminal sliding mode controller has been effectively utilized to design a finite time formation controller in contrast to previous works this technique has been proved to not only guarantee the vehicle s dynamics converge to the reference trajectory in finite time including the time evolutions of position attitude as well as velocities but also effectively improve the robustness adaptability and rapidity of the system moreover numerical simulations demonstrate that the proposed controller with adaptive rbf neural network and conditional integrator can effectively be provided with strongly robust with regard to uncertain model parameters approximation errors and environmental disturbances mse converges to 0 1 and the chattering of the controller is almost zero the dual closed loop stability of the formation is demonstrated by using lyapunov method and numerical simulations the next work will focus on the time varying disturbances and real experimental verification of the proposed controller credit authorship contribution statement guoqing xia methodology investigation yu zhang investigation writing original draft wei zhang project administration funding acquisition writing review editing ximing chen software data correction haoyu yang figure optimization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is supported by the national natural science foundation of china grant no 51879049 and the natural science foundation of heilongjiang province china grant no jj2019lh2279 
