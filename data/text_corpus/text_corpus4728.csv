index,text
23640,using a double plate wave maker a series of laboratory experiments of internal solitary wave isw loads on semi submersible platforms were conducted in a density stratified fluid tank combined with experimental results a numerical flume based on the navier stokes equations in a two layer fluid is developed to simulate nonlinear interactions between isws and a semi submersible platform the numerical results of horizontal and vertical forces as well as torques on the semi submersible platform also agree well with the experimental measurements besides the numerical results indicate that the horizontal and vertical forces on the semi submersible platform due to isws can be divided into three components namely the wave pressure difference forces viscous pressure difference forces and the frictional force which is negligible for the horizontal force the wave and viscous pressure difference components are of the same order implying that the viscous effect is significant for the vertical force the contribution of the viscous pressure difference is not important moreover the diffraction effect is significant for horizontal force and insignificant for vertical force hence it is feasible to estimate the vertical load using the froude krylov approach keywords internal solitary waves semi submersible platform wave loads 1 introduction a large number of observations show that internal solitary waves isws occur frequently and exist widely in the ocean due to density stratification arising from salinity and temperature variations apel et al 1985 which present significant hazards in coastal and oceanic regions where offshore petroleum exploration production and sub sea storage activities are in progress osborne and burch 1980 for instance in 1990 a sudden strong current accompanied by an internal wave caused a cable breakage in the extended test period of the liuhua oilfield in the south china sea bole et al 1994 therefore drilling rigs should be built to withstand isw loads in the areas where internal solitons may occur ablowitz and clarkson 1991 a semi submersible floating structure can serve as a drilling platform or an offshore wind turbine foundation there is a large number of experimental and numerical investigations on the performance of this type of platform under the action of wind waves and currents and methods and software have been developed to calculate the hydrodynamic loads faltinsen 1993 kvittem et al 2012 nonetheless there are relatively fewer studies on the loading mechanism of isws on floating structures in general previous researches were mainly focused on cylinder structures and adopted the morison formula morison et al 1950 to calculate isw loads cai et al 2003 2008 2006 si et al 2012 song et al 2011 however the geometry of the semi submersible platform is much more complicated than a cylinder thus it is difficult to directly calculate the isw load by the morison formula apparently by modifying its coefficients the morison formula can still be used to estimate the loads on the cylindrical components of platforms such as columns horizontal and diagonal braces for instance huang et al 2013 and chen et al 2017 developed two sets of modified coefficients of the morison formula by fitting the experimental data however these modified coefficients are not universal and certainly depend on the model settings it is therefore questionable to extend the modified coefficients to other circumstances owing to the practical significance of the problem and the aforementioned discussion a lot of isw hydrodynamic issues on floating platforms should be clarified including the mechanism of various load components the influence of viscosity and so on with the enhancement of computing capability cfd simulations provide an effective way to analyze the problem mentioned above as a first step towards a comprehensive understanding one of the key issues is to develop an accurate and controllable numerical flume for the interaction between isws and structures previously wang et al 2017 proposed a new method to generate isws by adding a mass source sink term to the continuity equation which has been proved effective and accurate however special attentions should be paid to such issues as whether the numerical waveform can match the desired one in the presence of platforms the reliability of simulated isw loads and so on in the present paper based on wave generation method proposed and with the aid of laboratory experiments we will develop a numerical flume to calculate isw loads on semi submersible platforms furthermore the components of the isw loads accounting for wave pressure fluid viscosity and wave diffraction as well will be discussed the present paper is organized as follows section 2 briefly describes the developed numerical flume section 3 introduces the experimental facility and procedure section 4 presents the numerical results including wave properties and the isw load characteristics on the semi submersible platform finally conclusions are given in section 5 2 numerical methods the present numerical experiments use the full navier stokes equations to simulate the nonlinear interactions between isws and a semi submersible platform the isws are obtained by adding a mass source sink term to the continuity equation 2 1 governing equations for an incompressible fluid of density ρ i the velocity components u i v i w i in cartesian coordinates o x y z its origin is at the interface see fig 1 and the pressure p i satisfy the continuity equation and the navier stokes equations 1 u i x v i y w i z 0 2 u i t u i u i x v i u i y w i u i z p i x ρ i ν u i x x u i y y u i z z 3 v i t u i v i x v i v i y w i v i z p i y ρ i ν v i x x v i y y v i z z 4 w i t u i w i x v i w i y w i w i z p i z ρ i ν w i x x w i y y w i z z g where g is the gravitational acceleration the subscripts with respect to space and time represent partial differentiation and i 1 i 2 denotes the upper lower layer fluid in order to generate isws by using the mass source method eq 1 is modified as 5 u i x v i y w i z 0 x y z ω s i x y z t ρ i x y z ω where the additional mass source term s i x y z t is a nonzero function only in the source region ω the computational domain is shown in fig 1 which consists of three regions the mass source region wave propagation region and dissipation region demarcated by isw interface the source region can be divided into two subregions ω 1 and ω 2 which respectively denote the source region and the sink region fluxes between the source and the sink are forced to cancel each other in order to ensure the conservation of mass in the computational domain for simplicity we assume that the mass source functions vary with time only namely s i is independent of spatial variables we consider the interface fluctuation in the mass source region during the wave generation process and define s i t as 6 s 1 t ρ 1 c ζ t h 1 ζ t 1 δ x 7 s 2 t ρ 2 c ζ t h 2 ζ t 1 δ x where c denotes the phase speed δ x is the width of the mass source region and ζ t is interface displacement of an isw wang et al 2017 2 2 boundary and initial conditions the rigid lid approximation is adopted on the top in the present paper it follows that the impermeability condition should be satisfied at the top and bottom of the fluid domain 8 w 1 z h 1 0 w 2 z h 2 0 moreover the surface of the platform is set to the impermeability boundary the forces and torque on the surface are monitored during the simulation the normal velocity is continuous and so is the pressure at the interface z ζ x y t which give the boundary conditions 9 ζ t u 1 ζ x v 1 ζ y w 1 ζ t u 2 ζ x v 2 ζ y w 2 p 1 p 2 only right traveling isws are considered so a symmetry condition is posed on the left boundary the right boundary is specified as a smooth non slip wall in order to avoid wave reflection at the end a buffering region is allocated to dissipate isws in the numerical flume which is realized by adding a source term to the momentum equation in the vertical direction 10 w i t u i w i x v i w i y w i w i z p i z ρ i ν w i x x w i y y w i z z g δ x w where the damping function δ x is nonzero only in the dissipation region otherwise δ x 0 in the present paper we choose δ x as a linear function 11 δ x α x x s x e x s where α is an empirical coefficient depending on the specific case while x s and x e respectively denote the horizontal coordinates of two endpoints of the dissipation region x s x e there is no wave or current in the computation domain at the initial moment indicating that both the velocity and velocity gradient are zero at t 0 2 3 interface treatment the vof volume of fluid method hirt and nichols 1981 is employed to track the isw interface the vof equation can be written as follows 12 a i t x a i u y a i v z a i w s a i ρ i where a i is the volume fraction for fluid i i 1 2 for every single controlled volume the total volume fraction is unit i e a 1 a 2 1 and each component meets one of the following situations 1 a i 0 the cell is empty of fluid i 2 a i 1 the cell is full of fluid i 3 0 a i 1 the cell contains the interface between two fluids 2 4 forces on a semi submersible platform at the experiment stage the horizontal force f x vertical force f z and torque m y are measured by the three component force balance correspondingly these loads and torque are also monitored during the simulation lateral force f y caused by periodic trailing vortex behind the semi submersible platform is much less than f x or f z so it is not discussed in the paper the f x and f z on a semi submersible platform can be expressed as 13 f x μ s u y v x n y u z w x n z d s s p n x d s 14 f z μ s u z w x n x v z w y n y d s s p n z d s where μ denotes the dynamic viscosity of water 1 01 10 3 n s m 2 s is the wetted surface of the semi submersible platform and n x n y n z is the outward unit normal vector of the surface in the formulas the forces consist of two parts where the first term represents the friction f x f z and the second one represents the pressure difference force f x p f z p 15 f x p s p n x d s 16 f z p z p n z d s 17 f x μ s u y v x n y u z w x n z d s 18 f z μ s u z w x n x v z w y n y d s furthermore according to the contribution of the viscosity the pressure difference force can be divided into two components wave pressure difference force f x p w f z p w and viscous pressure difference force f x p v f z p v the wave pressure difference force is associated with the fluctuation of water parcels which can be calculated based on the euler equations while the viscous pressure difference force is associated with the viscous effect which can be calculated by subtracting the wave pressure difference force obtained by the euler equations from the one obtained by the navier stokes n s equations the expressions of f x p w f z p w and f x p v f z p v are given as 19 f x p w s p n x d s euler 20 f z p w s p n z d s euler 21 f x p v s p n x d s n s s p n x d s euler 22 f z p v s p n z d s n s s p n z d s euler to facilitate comparison with experiment measurements the moment center is placed at the joint point of the experiment model and the three component force balance see fig 4 a considering the symmetry of the model and neglecting the slightly nonuniform distribution of the vertical force over the horizontal wetted surfaces of the structure we have the torque m y given by 23 m y μ s u y v x n y u z w x n z d d s s p n x d d s where d is the arm of the horizontal force of each wetted cell of the structure namely the vertical distance between the cell center and the moment center 3 experimental facility and procedure a series of experiments is conducted in the large scale density stratified tank length 30 m width 0 6 m height 1 2 m at shanghai jiao tong university see fig 2 the fluid in the tank is stratified into two layers with the injection method we first inject fresh water density ρ 1 998 k g m 3 till its depth equal to h 1 then slowly inject salt water density ρ 2 1025 k g m 3 from two mushroom type inlets at the bottom of the tank until the total depth reaches to h as a consequence the salt water is of the depth h 2 h h 1 fig 3 shows the density and brunt väisälä frequency of the stratified fluid in the tank as h 1 h 2 20 80 where the brunt väisälä frequency is defined as n z g ρ 1 ρ 1 z different from the gravity collapse method du et al 2016 at the experimental stage isws are generated using a double plate identified by black wave maker and the procedure is similar to that described by wessels and hutter 1996 in order to generate nonlinear isws with higher amplitudes the drive mechanism of the wave maker is significantly upgraded and the control software of two plates is modified besides a steel plate with adjusted size through tests is put on the top of the wave maker to weaken the disturbance of the free surface in addition a wedge shape wave breaker is set up at the end right end in fig 2 of the tank to prevent solitary waves from reflecting the two steel plates move along the opposite directions at different speeds so as to generate an isw at the interface between two layers at the preparation stage two plates are set to the same heights as undisturbed fluid layers during the generation process the speed of the upper and lower plates u 1 u 2 are controlled by a computer and can be expressed respectively as 24 u 1 c ζ t h 1 u 2 c ζ t h 2 where c is the phase speed and ζ t denotes the interface displacement of the desired isw isws are measured using two rows of conductivity probes which are arranged with 3 m apart each row consists of 13 equally distributed probes and the distance between two consecutive probes is 3 cm it is known that the conductivity has a linear relationship with density so we can get density variations by post processing the conductivity signal measured with the two rows of probes as a consequence we can easily obtain isw interface displacement as well as the phase speed in the experiment there is always trailing waves phenomenon behind the leading isw the existence of trailing waves implies the dissipation of wave energy during wave generation therefore the measured amplitude is very difficult to reach the desired amplitude for a specific case in order to generate the desired isw waveform for a specific density stratification firstly we have to seek the relation between the measured amplitude a m and the desired amplitude a d based on a series of experiments and then the desired amplitude can be achieved by adjusting input parameters according to the relation the experimental model and the dimensions of the underwater part are shown in fig 4 the forces f x f z m y on the semi submersible platform during the isw propagation are measured by the three component force balance which is connected to the model and fixed on the top of the tank before the experiment an additional weight is introduced to ensure the balance between gravity and buoyancy of the model afterwards we load and unload weights on the model along the horizontal and vertical directions respectively in order to obtain the calibration relationship between the measured electronic signals and loads during the experiment isw loads on the model can be calculated from the electrical signals according to the calibration relationship 4 numerical results and discussions 4 1 numerical implementation a numerical flume is established to generate isws using udf user defined function redevelopment tools on the platform of fluent software the numerical model works as follows first calculate the isw interface displacement ζ t by a suitable isw theory as in table 1 then put ζ t in the mass source function given by eqs 6 and 7 and finally the isw is excited in the source term region during the propagation of the isw the forces on the semi submersible platform are monitored in real time structured elements are used to ensure the mesh quality of the computational domain with regard to the flume the grids in x and y direction are refined to λ 25 and λ 30 respectively the constant λ is defined as λ 1 a x m ζ x d x introduced by koop and butler 1981 where x m is the location of the wave crest and a is the amplitude of the isw in z direction the computational domain is divided into three parts h 2 z a a z 0 and 0 z h 1 local grid refinements are employed to reduce the numerical dispersion in the region of wave motion a z 0 where the grid is refined to a 10 in the upper and lower regions the grids are set to the geometric progression common ratio is 1 03 particularly for the wet surface of the platform shown in fig 5 the grid size need to be further refined to about λ 300 the governing equations are discretized on three dimension structured grids using finite volume method fvm and well chosen numerical schemes are taken to avoid the spurious effects in particular the pressure implicit with splitting of operators piso algorithm is adopted to solve the pressure velocity coupling where the spatial gradient are discretized with the green gauss node based method together with a second order upwind scheme for vof volume fraction moreover the temporal terms are discretized using a second order implicit scheme and the time step is set to 0 005s during the simulation nonlinearity and dispersion are two fundamental mechanisms which govern the physics of isws camassa et al 2006 isws are commonly described by the korteweg de vries kdv equation extended kdv ekdv equation miyata choi camassa mcc equation and others choi and camassa 2000 helfrich and melville 2006 in the present paper 15 numerical experiments are carried out for the interaction between isws and a platform under different depths and wave amplitudes table 1 which are in line with the experiment cases the length of the flume is 30 m in which δ x 0 04 m and the width of damping region is 6 m the total depth is 1 m the draft of the semi submersible platform d is 0 633 m the displacement volume is 1 918 10 3 m 3 the upper layer fluid density ρ 1 is 998 kg m 3 and the lower layer fluid density ρ 2 is 1025 kg m 3 4 2 numerical simulations for isws fig 6 shows the comparisons for wave profiles of isws between cfd simulations theories and laboratory experiments as shown in table 1 case a1 case a2 and case a5 represent the weakly moderately and strongly nonlinear isws respectively the wave profiles obtained by the cfd simulation are in good agreement with both the theoretical and experimental results the relative errors are within 3 which indicates that the numerical wave maker can accurately generate the waveform in the presence of platforms no matter it is a weakly nonlinear isw or a strongly nonlinear one the numerical results of wave amplitudes in all cases are shown in fig 7 where the dots represent the simulated results and the dashed line represents the desired amplitude it shows that the simulated amplitudes are in good agreement with the desired ones with the maximum error less than 5 in order to further test the accuracy of the proposed wave generating method the validation of velocity fields induced by isws in the presence of platforms is very important fig 8 shows the comparisons of vertical profiles of horizontal velocities at wave troughs between the cfd simulation and theoretical prediction t 50s for case a2 in the figure the theoretical results is based on the strongly nonlinear asymptotic approximation model in a two fluid system proposed by camassa et al 2006 the leading order horizontal velocity can be written as upper layer fluid 25 u 1 x z c 1 h 1 η 1 η 1 2 6 h 1 z 2 2 h 1 η 1 η 1 2 2 h 1 η 1 2 η 1 3 lower layer fluid 26 u 2 x z c 1 h 2 η 2 η 2 2 6 z h 2 2 2 h 2 η 2 η 2 2 2 h 2 η 2 2 η 2 3 where x x c t η 1 η 1 x η 2 η 2 x η 1 η 1 x x η 2 η 2 x x η 1 h 1 ζ and η 2 h 2 ζ except the region near the interface the vertical distributions of horizontal velocities alter little in the upper and lower fluid overall the results show that velocity distributions agree well with the theory it is worth mentioning that the proposed numerical model is based on the two layer fluid approximation due to numerical diffusion the density features a smooth transition near the interface in the beginning fig 9 shows that the actual density profile at the trough of an isw t 25 s 125 s for case a2 although the density distribution does not satisfy the two layer fluid assumption the deviation is not significant moreover from 25 s to 125 s the profile still remains the same these facts suggest that the influence of numerical diffusion is limited though unavoidable in order to study the isw loads it is necessary to analyze the influence of fluid viscosity on the generation and propagation of isws simulations based on the navier stokes equations and the euler equations are carried out the wave profiles for case a2 simulated by the two systems are shown in fig 10 we can see that the waveforms generated by the two simulation patterns remain stable and the amplitude does not decay obviously during the propagation of the isw with the relative error less than 5 it is shown that the influence of fluid viscosity is limited 4 3 load characteristics on the semi submersible platform to facilitate discussion we define f x f x ρ 1 g f z f z ρ 1 g and m y m y ρ 1 g d as the dimensionless horizontal vertical forces and the torque respectively on the semi submersible platform due to isws the dimensionless loads and torques versus amplitudes are shown in fig 11 demonstrating that amplitudes for the horizontal and vertical forces as well as the torque obtained numerically are in good agreement with the experimental results with the maximum error less than 14 the maximum error often shows up in the later stage for example case b4 and case b5 for each experimental setting one possible reason is the deviation of the density structure from the strict two layer configuration after several rounds of experiments fig 12 depicts the time variations of the dimensionless loads and torque for case a2 the numerical and experimental results are in good agreement which means that it is reasonable and feasible to calculate the loads and torque on the semi submersible platform based on the proposed numerical flume according to eq 15 the torque m y is proportional to the horizontal load f x hence we primarily focus on f x and f z in the subsequent analysis from eqs 13 and 14 it can be seen that the pressure difference and frictions are two components of horizontal and vertical forces the time variations of these two components for case a2 are shown in fig 13 the results indicate that the pressure difference force f x p f z p is the dominant component while the friction f x f z is ignorable the time variations of wave and viscous pressure difference forces due to isws for case a2 are shown in fig 14 for the horizontal force the viscous effect is significant the absolute maximum of f x p f x p v is 2 9e 3 0 8e 3 whereas for the vertical force the viscous pressure difference force is not important the absolute maximum of f z p f z p v is 9 8e 3 1 3e 3 4 4 numerical convergence in order to verify the numerical convergence simulations are performed with 3 different spatial resolutions of case a2 and the measured maximum loads f x m a x f z m a x and the relative errors of experimental results are listed in table 2 the n x n y n z represents the grid number in the x y z direction note that the grids are not uniformly distributed in the whole computation domain and the specific grid generation rule is already introduced in section 4 1 generally the more grid number the smaller the numerical error however when the grid number is above a critical value the error will not be significantly decreased but the computation cost increases in table 2 both the f x m a x and f z m a x are almost unchanged when grids are finer than the configuration 435 20 145 employed in the present paper it indicates that the numerical results with such grid distribution are stable and convergent 4 5 the froude krylov force and the diffraction effect in this section we discuss the interference of the platform in flow fields for regular incident waves the total non viscous forces f x p w f z p w acting on a floating structure include two parts the froude krylov force and diffraction force the former is based on the froude krylov assumption that the pressure distribution due to the incident wave is not affected by the presence of structure the diffraction force is owing to the effect of the floating body which disturbs the waves specifically the froude krylov forces f x k f z k on a semi submersible platform due to isws can be obtained by integrating the dynamic pressure p over the wetted surface s of the platform thus the horizontal and vertical force components can be described as follows 27 f x k s p n x d s 28 f z k s p n z d s where p is determined by the bernoulli equation taking the froude krylov assumption i e the pressure distribution due to the incident wave is not affected by the presence of the structure into consideration we have v i 2 0 hence the dynamic pressure p induced by isws can be written as 29 p ρ i ϕ t 1 2 u i 2 w i 2 where ϕ denotes the potential of the wave induced velocity field the horizontal velocities u i are obtained by eqs 25 and 26 and the first order approximation of vertical velocities w i are given by 30 w i 1 i 1 h i 1 i z u i x w i t h u i x 1 i c ζ h i 1 i ζ next we can get the diffraction forces f x d f z d by subtracting the froude krylov forces f x k f z k from the non viscous forces f x p w f z p w the froude krylov force f x k the diffraction force f x d and the non viscous force f x p w are shown in fig 15 a the f x k makes a considerable contribution to f x p w which imply that the diffraction effect is not negligible in fig 15 b it can be seen that the froude krylov force f z k behaves very much similar to the non viscous force f z p w as time evolves and the diffraction force f z d is relatively limited in addition to the conclusion drawn in section 3 2 that the effect of fluid viscosity for the vertical force can be neglected it is feasible to estimate the vertical isw load by adopting the froude krylov force 5 conclusions combined with laboratory experiments a numerical flume based on the navier stokes equations in a two layer fluid is developed to simulate the nonlinear interactions between isws and a semi submersible platform where isws are generated by adding a mass source term and a sink term to the continuity equation in the source region located within the computational domain the conclusions are summarized as follows 1 the waveform and amplitude of the isw based on the developed numerical flume are in good agreement with the experimental and theoretical results moreover numerical results for the horizontal and vertical forces as well as torques on the semi submersible platform due to the isw are in good agreement with experimental results hence it is feasible to simulate the nonlinear interactions between isws and semi submersible platforms by the developed numerical flume 2 in general hydrodynamic force of an offshore structure consists of three components the wave and viscous pressure difference components and the friction component however for the case of a semi submersible structure under the action of isws the friction component is proved to be very small and can be neglected both for the horizontal and the vertical forces and the viscous pressure difference component is insignificant for vertical force but the viscous pressure difference component accounts for noticeable percentage of the horizontal force implying significant effect of fluid viscosity in addition the vertical force of the structure exerted by an isw can be estimated by means of the froude krylov approach which is of practical implication for engineering acknowledgments we acknowledge the financial support from the national key r d program of china 2017yfc1404202 the national natural science foundation of china 11602274 11232012 11572332 and 11372184 and the strategic priority research program of the chinese academy of sciences xdb22040203 
23640,using a double plate wave maker a series of laboratory experiments of internal solitary wave isw loads on semi submersible platforms were conducted in a density stratified fluid tank combined with experimental results a numerical flume based on the navier stokes equations in a two layer fluid is developed to simulate nonlinear interactions between isws and a semi submersible platform the numerical results of horizontal and vertical forces as well as torques on the semi submersible platform also agree well with the experimental measurements besides the numerical results indicate that the horizontal and vertical forces on the semi submersible platform due to isws can be divided into three components namely the wave pressure difference forces viscous pressure difference forces and the frictional force which is negligible for the horizontal force the wave and viscous pressure difference components are of the same order implying that the viscous effect is significant for the vertical force the contribution of the viscous pressure difference is not important moreover the diffraction effect is significant for horizontal force and insignificant for vertical force hence it is feasible to estimate the vertical load using the froude krylov approach keywords internal solitary waves semi submersible platform wave loads 1 introduction a large number of observations show that internal solitary waves isws occur frequently and exist widely in the ocean due to density stratification arising from salinity and temperature variations apel et al 1985 which present significant hazards in coastal and oceanic regions where offshore petroleum exploration production and sub sea storage activities are in progress osborne and burch 1980 for instance in 1990 a sudden strong current accompanied by an internal wave caused a cable breakage in the extended test period of the liuhua oilfield in the south china sea bole et al 1994 therefore drilling rigs should be built to withstand isw loads in the areas where internal solitons may occur ablowitz and clarkson 1991 a semi submersible floating structure can serve as a drilling platform or an offshore wind turbine foundation there is a large number of experimental and numerical investigations on the performance of this type of platform under the action of wind waves and currents and methods and software have been developed to calculate the hydrodynamic loads faltinsen 1993 kvittem et al 2012 nonetheless there are relatively fewer studies on the loading mechanism of isws on floating structures in general previous researches were mainly focused on cylinder structures and adopted the morison formula morison et al 1950 to calculate isw loads cai et al 2003 2008 2006 si et al 2012 song et al 2011 however the geometry of the semi submersible platform is much more complicated than a cylinder thus it is difficult to directly calculate the isw load by the morison formula apparently by modifying its coefficients the morison formula can still be used to estimate the loads on the cylindrical components of platforms such as columns horizontal and diagonal braces for instance huang et al 2013 and chen et al 2017 developed two sets of modified coefficients of the morison formula by fitting the experimental data however these modified coefficients are not universal and certainly depend on the model settings it is therefore questionable to extend the modified coefficients to other circumstances owing to the practical significance of the problem and the aforementioned discussion a lot of isw hydrodynamic issues on floating platforms should be clarified including the mechanism of various load components the influence of viscosity and so on with the enhancement of computing capability cfd simulations provide an effective way to analyze the problem mentioned above as a first step towards a comprehensive understanding one of the key issues is to develop an accurate and controllable numerical flume for the interaction between isws and structures previously wang et al 2017 proposed a new method to generate isws by adding a mass source sink term to the continuity equation which has been proved effective and accurate however special attentions should be paid to such issues as whether the numerical waveform can match the desired one in the presence of platforms the reliability of simulated isw loads and so on in the present paper based on wave generation method proposed and with the aid of laboratory experiments we will develop a numerical flume to calculate isw loads on semi submersible platforms furthermore the components of the isw loads accounting for wave pressure fluid viscosity and wave diffraction as well will be discussed the present paper is organized as follows section 2 briefly describes the developed numerical flume section 3 introduces the experimental facility and procedure section 4 presents the numerical results including wave properties and the isw load characteristics on the semi submersible platform finally conclusions are given in section 5 2 numerical methods the present numerical experiments use the full navier stokes equations to simulate the nonlinear interactions between isws and a semi submersible platform the isws are obtained by adding a mass source sink term to the continuity equation 2 1 governing equations for an incompressible fluid of density ρ i the velocity components u i v i w i in cartesian coordinates o x y z its origin is at the interface see fig 1 and the pressure p i satisfy the continuity equation and the navier stokes equations 1 u i x v i y w i z 0 2 u i t u i u i x v i u i y w i u i z p i x ρ i ν u i x x u i y y u i z z 3 v i t u i v i x v i v i y w i v i z p i y ρ i ν v i x x v i y y v i z z 4 w i t u i w i x v i w i y w i w i z p i z ρ i ν w i x x w i y y w i z z g where g is the gravitational acceleration the subscripts with respect to space and time represent partial differentiation and i 1 i 2 denotes the upper lower layer fluid in order to generate isws by using the mass source method eq 1 is modified as 5 u i x v i y w i z 0 x y z ω s i x y z t ρ i x y z ω where the additional mass source term s i x y z t is a nonzero function only in the source region ω the computational domain is shown in fig 1 which consists of three regions the mass source region wave propagation region and dissipation region demarcated by isw interface the source region can be divided into two subregions ω 1 and ω 2 which respectively denote the source region and the sink region fluxes between the source and the sink are forced to cancel each other in order to ensure the conservation of mass in the computational domain for simplicity we assume that the mass source functions vary with time only namely s i is independent of spatial variables we consider the interface fluctuation in the mass source region during the wave generation process and define s i t as 6 s 1 t ρ 1 c ζ t h 1 ζ t 1 δ x 7 s 2 t ρ 2 c ζ t h 2 ζ t 1 δ x where c denotes the phase speed δ x is the width of the mass source region and ζ t is interface displacement of an isw wang et al 2017 2 2 boundary and initial conditions the rigid lid approximation is adopted on the top in the present paper it follows that the impermeability condition should be satisfied at the top and bottom of the fluid domain 8 w 1 z h 1 0 w 2 z h 2 0 moreover the surface of the platform is set to the impermeability boundary the forces and torque on the surface are monitored during the simulation the normal velocity is continuous and so is the pressure at the interface z ζ x y t which give the boundary conditions 9 ζ t u 1 ζ x v 1 ζ y w 1 ζ t u 2 ζ x v 2 ζ y w 2 p 1 p 2 only right traveling isws are considered so a symmetry condition is posed on the left boundary the right boundary is specified as a smooth non slip wall in order to avoid wave reflection at the end a buffering region is allocated to dissipate isws in the numerical flume which is realized by adding a source term to the momentum equation in the vertical direction 10 w i t u i w i x v i w i y w i w i z p i z ρ i ν w i x x w i y y w i z z g δ x w where the damping function δ x is nonzero only in the dissipation region otherwise δ x 0 in the present paper we choose δ x as a linear function 11 δ x α x x s x e x s where α is an empirical coefficient depending on the specific case while x s and x e respectively denote the horizontal coordinates of two endpoints of the dissipation region x s x e there is no wave or current in the computation domain at the initial moment indicating that both the velocity and velocity gradient are zero at t 0 2 3 interface treatment the vof volume of fluid method hirt and nichols 1981 is employed to track the isw interface the vof equation can be written as follows 12 a i t x a i u y a i v z a i w s a i ρ i where a i is the volume fraction for fluid i i 1 2 for every single controlled volume the total volume fraction is unit i e a 1 a 2 1 and each component meets one of the following situations 1 a i 0 the cell is empty of fluid i 2 a i 1 the cell is full of fluid i 3 0 a i 1 the cell contains the interface between two fluids 2 4 forces on a semi submersible platform at the experiment stage the horizontal force f x vertical force f z and torque m y are measured by the three component force balance correspondingly these loads and torque are also monitored during the simulation lateral force f y caused by periodic trailing vortex behind the semi submersible platform is much less than f x or f z so it is not discussed in the paper the f x and f z on a semi submersible platform can be expressed as 13 f x μ s u y v x n y u z w x n z d s s p n x d s 14 f z μ s u z w x n x v z w y n y d s s p n z d s where μ denotes the dynamic viscosity of water 1 01 10 3 n s m 2 s is the wetted surface of the semi submersible platform and n x n y n z is the outward unit normal vector of the surface in the formulas the forces consist of two parts where the first term represents the friction f x f z and the second one represents the pressure difference force f x p f z p 15 f x p s p n x d s 16 f z p z p n z d s 17 f x μ s u y v x n y u z w x n z d s 18 f z μ s u z w x n x v z w y n y d s furthermore according to the contribution of the viscosity the pressure difference force can be divided into two components wave pressure difference force f x p w f z p w and viscous pressure difference force f x p v f z p v the wave pressure difference force is associated with the fluctuation of water parcels which can be calculated based on the euler equations while the viscous pressure difference force is associated with the viscous effect which can be calculated by subtracting the wave pressure difference force obtained by the euler equations from the one obtained by the navier stokes n s equations the expressions of f x p w f z p w and f x p v f z p v are given as 19 f x p w s p n x d s euler 20 f z p w s p n z d s euler 21 f x p v s p n x d s n s s p n x d s euler 22 f z p v s p n z d s n s s p n z d s euler to facilitate comparison with experiment measurements the moment center is placed at the joint point of the experiment model and the three component force balance see fig 4 a considering the symmetry of the model and neglecting the slightly nonuniform distribution of the vertical force over the horizontal wetted surfaces of the structure we have the torque m y given by 23 m y μ s u y v x n y u z w x n z d d s s p n x d d s where d is the arm of the horizontal force of each wetted cell of the structure namely the vertical distance between the cell center and the moment center 3 experimental facility and procedure a series of experiments is conducted in the large scale density stratified tank length 30 m width 0 6 m height 1 2 m at shanghai jiao tong university see fig 2 the fluid in the tank is stratified into two layers with the injection method we first inject fresh water density ρ 1 998 k g m 3 till its depth equal to h 1 then slowly inject salt water density ρ 2 1025 k g m 3 from two mushroom type inlets at the bottom of the tank until the total depth reaches to h as a consequence the salt water is of the depth h 2 h h 1 fig 3 shows the density and brunt väisälä frequency of the stratified fluid in the tank as h 1 h 2 20 80 where the brunt väisälä frequency is defined as n z g ρ 1 ρ 1 z different from the gravity collapse method du et al 2016 at the experimental stage isws are generated using a double plate identified by black wave maker and the procedure is similar to that described by wessels and hutter 1996 in order to generate nonlinear isws with higher amplitudes the drive mechanism of the wave maker is significantly upgraded and the control software of two plates is modified besides a steel plate with adjusted size through tests is put on the top of the wave maker to weaken the disturbance of the free surface in addition a wedge shape wave breaker is set up at the end right end in fig 2 of the tank to prevent solitary waves from reflecting the two steel plates move along the opposite directions at different speeds so as to generate an isw at the interface between two layers at the preparation stage two plates are set to the same heights as undisturbed fluid layers during the generation process the speed of the upper and lower plates u 1 u 2 are controlled by a computer and can be expressed respectively as 24 u 1 c ζ t h 1 u 2 c ζ t h 2 where c is the phase speed and ζ t denotes the interface displacement of the desired isw isws are measured using two rows of conductivity probes which are arranged with 3 m apart each row consists of 13 equally distributed probes and the distance between two consecutive probes is 3 cm it is known that the conductivity has a linear relationship with density so we can get density variations by post processing the conductivity signal measured with the two rows of probes as a consequence we can easily obtain isw interface displacement as well as the phase speed in the experiment there is always trailing waves phenomenon behind the leading isw the existence of trailing waves implies the dissipation of wave energy during wave generation therefore the measured amplitude is very difficult to reach the desired amplitude for a specific case in order to generate the desired isw waveform for a specific density stratification firstly we have to seek the relation between the measured amplitude a m and the desired amplitude a d based on a series of experiments and then the desired amplitude can be achieved by adjusting input parameters according to the relation the experimental model and the dimensions of the underwater part are shown in fig 4 the forces f x f z m y on the semi submersible platform during the isw propagation are measured by the three component force balance which is connected to the model and fixed on the top of the tank before the experiment an additional weight is introduced to ensure the balance between gravity and buoyancy of the model afterwards we load and unload weights on the model along the horizontal and vertical directions respectively in order to obtain the calibration relationship between the measured electronic signals and loads during the experiment isw loads on the model can be calculated from the electrical signals according to the calibration relationship 4 numerical results and discussions 4 1 numerical implementation a numerical flume is established to generate isws using udf user defined function redevelopment tools on the platform of fluent software the numerical model works as follows first calculate the isw interface displacement ζ t by a suitable isw theory as in table 1 then put ζ t in the mass source function given by eqs 6 and 7 and finally the isw is excited in the source term region during the propagation of the isw the forces on the semi submersible platform are monitored in real time structured elements are used to ensure the mesh quality of the computational domain with regard to the flume the grids in x and y direction are refined to λ 25 and λ 30 respectively the constant λ is defined as λ 1 a x m ζ x d x introduced by koop and butler 1981 where x m is the location of the wave crest and a is the amplitude of the isw in z direction the computational domain is divided into three parts h 2 z a a z 0 and 0 z h 1 local grid refinements are employed to reduce the numerical dispersion in the region of wave motion a z 0 where the grid is refined to a 10 in the upper and lower regions the grids are set to the geometric progression common ratio is 1 03 particularly for the wet surface of the platform shown in fig 5 the grid size need to be further refined to about λ 300 the governing equations are discretized on three dimension structured grids using finite volume method fvm and well chosen numerical schemes are taken to avoid the spurious effects in particular the pressure implicit with splitting of operators piso algorithm is adopted to solve the pressure velocity coupling where the spatial gradient are discretized with the green gauss node based method together with a second order upwind scheme for vof volume fraction moreover the temporal terms are discretized using a second order implicit scheme and the time step is set to 0 005s during the simulation nonlinearity and dispersion are two fundamental mechanisms which govern the physics of isws camassa et al 2006 isws are commonly described by the korteweg de vries kdv equation extended kdv ekdv equation miyata choi camassa mcc equation and others choi and camassa 2000 helfrich and melville 2006 in the present paper 15 numerical experiments are carried out for the interaction between isws and a platform under different depths and wave amplitudes table 1 which are in line with the experiment cases the length of the flume is 30 m in which δ x 0 04 m and the width of damping region is 6 m the total depth is 1 m the draft of the semi submersible platform d is 0 633 m the displacement volume is 1 918 10 3 m 3 the upper layer fluid density ρ 1 is 998 kg m 3 and the lower layer fluid density ρ 2 is 1025 kg m 3 4 2 numerical simulations for isws fig 6 shows the comparisons for wave profiles of isws between cfd simulations theories and laboratory experiments as shown in table 1 case a1 case a2 and case a5 represent the weakly moderately and strongly nonlinear isws respectively the wave profiles obtained by the cfd simulation are in good agreement with both the theoretical and experimental results the relative errors are within 3 which indicates that the numerical wave maker can accurately generate the waveform in the presence of platforms no matter it is a weakly nonlinear isw or a strongly nonlinear one the numerical results of wave amplitudes in all cases are shown in fig 7 where the dots represent the simulated results and the dashed line represents the desired amplitude it shows that the simulated amplitudes are in good agreement with the desired ones with the maximum error less than 5 in order to further test the accuracy of the proposed wave generating method the validation of velocity fields induced by isws in the presence of platforms is very important fig 8 shows the comparisons of vertical profiles of horizontal velocities at wave troughs between the cfd simulation and theoretical prediction t 50s for case a2 in the figure the theoretical results is based on the strongly nonlinear asymptotic approximation model in a two fluid system proposed by camassa et al 2006 the leading order horizontal velocity can be written as upper layer fluid 25 u 1 x z c 1 h 1 η 1 η 1 2 6 h 1 z 2 2 h 1 η 1 η 1 2 2 h 1 η 1 2 η 1 3 lower layer fluid 26 u 2 x z c 1 h 2 η 2 η 2 2 6 z h 2 2 2 h 2 η 2 η 2 2 2 h 2 η 2 2 η 2 3 where x x c t η 1 η 1 x η 2 η 2 x η 1 η 1 x x η 2 η 2 x x η 1 h 1 ζ and η 2 h 2 ζ except the region near the interface the vertical distributions of horizontal velocities alter little in the upper and lower fluid overall the results show that velocity distributions agree well with the theory it is worth mentioning that the proposed numerical model is based on the two layer fluid approximation due to numerical diffusion the density features a smooth transition near the interface in the beginning fig 9 shows that the actual density profile at the trough of an isw t 25 s 125 s for case a2 although the density distribution does not satisfy the two layer fluid assumption the deviation is not significant moreover from 25 s to 125 s the profile still remains the same these facts suggest that the influence of numerical diffusion is limited though unavoidable in order to study the isw loads it is necessary to analyze the influence of fluid viscosity on the generation and propagation of isws simulations based on the navier stokes equations and the euler equations are carried out the wave profiles for case a2 simulated by the two systems are shown in fig 10 we can see that the waveforms generated by the two simulation patterns remain stable and the amplitude does not decay obviously during the propagation of the isw with the relative error less than 5 it is shown that the influence of fluid viscosity is limited 4 3 load characteristics on the semi submersible platform to facilitate discussion we define f x f x ρ 1 g f z f z ρ 1 g and m y m y ρ 1 g d as the dimensionless horizontal vertical forces and the torque respectively on the semi submersible platform due to isws the dimensionless loads and torques versus amplitudes are shown in fig 11 demonstrating that amplitudes for the horizontal and vertical forces as well as the torque obtained numerically are in good agreement with the experimental results with the maximum error less than 14 the maximum error often shows up in the later stage for example case b4 and case b5 for each experimental setting one possible reason is the deviation of the density structure from the strict two layer configuration after several rounds of experiments fig 12 depicts the time variations of the dimensionless loads and torque for case a2 the numerical and experimental results are in good agreement which means that it is reasonable and feasible to calculate the loads and torque on the semi submersible platform based on the proposed numerical flume according to eq 15 the torque m y is proportional to the horizontal load f x hence we primarily focus on f x and f z in the subsequent analysis from eqs 13 and 14 it can be seen that the pressure difference and frictions are two components of horizontal and vertical forces the time variations of these two components for case a2 are shown in fig 13 the results indicate that the pressure difference force f x p f z p is the dominant component while the friction f x f z is ignorable the time variations of wave and viscous pressure difference forces due to isws for case a2 are shown in fig 14 for the horizontal force the viscous effect is significant the absolute maximum of f x p f x p v is 2 9e 3 0 8e 3 whereas for the vertical force the viscous pressure difference force is not important the absolute maximum of f z p f z p v is 9 8e 3 1 3e 3 4 4 numerical convergence in order to verify the numerical convergence simulations are performed with 3 different spatial resolutions of case a2 and the measured maximum loads f x m a x f z m a x and the relative errors of experimental results are listed in table 2 the n x n y n z represents the grid number in the x y z direction note that the grids are not uniformly distributed in the whole computation domain and the specific grid generation rule is already introduced in section 4 1 generally the more grid number the smaller the numerical error however when the grid number is above a critical value the error will not be significantly decreased but the computation cost increases in table 2 both the f x m a x and f z m a x are almost unchanged when grids are finer than the configuration 435 20 145 employed in the present paper it indicates that the numerical results with such grid distribution are stable and convergent 4 5 the froude krylov force and the diffraction effect in this section we discuss the interference of the platform in flow fields for regular incident waves the total non viscous forces f x p w f z p w acting on a floating structure include two parts the froude krylov force and diffraction force the former is based on the froude krylov assumption that the pressure distribution due to the incident wave is not affected by the presence of structure the diffraction force is owing to the effect of the floating body which disturbs the waves specifically the froude krylov forces f x k f z k on a semi submersible platform due to isws can be obtained by integrating the dynamic pressure p over the wetted surface s of the platform thus the horizontal and vertical force components can be described as follows 27 f x k s p n x d s 28 f z k s p n z d s where p is determined by the bernoulli equation taking the froude krylov assumption i e the pressure distribution due to the incident wave is not affected by the presence of the structure into consideration we have v i 2 0 hence the dynamic pressure p induced by isws can be written as 29 p ρ i ϕ t 1 2 u i 2 w i 2 where ϕ denotes the potential of the wave induced velocity field the horizontal velocities u i are obtained by eqs 25 and 26 and the first order approximation of vertical velocities w i are given by 30 w i 1 i 1 h i 1 i z u i x w i t h u i x 1 i c ζ h i 1 i ζ next we can get the diffraction forces f x d f z d by subtracting the froude krylov forces f x k f z k from the non viscous forces f x p w f z p w the froude krylov force f x k the diffraction force f x d and the non viscous force f x p w are shown in fig 15 a the f x k makes a considerable contribution to f x p w which imply that the diffraction effect is not negligible in fig 15 b it can be seen that the froude krylov force f z k behaves very much similar to the non viscous force f z p w as time evolves and the diffraction force f z d is relatively limited in addition to the conclusion drawn in section 3 2 that the effect of fluid viscosity for the vertical force can be neglected it is feasible to estimate the vertical isw load by adopting the froude krylov force 5 conclusions combined with laboratory experiments a numerical flume based on the navier stokes equations in a two layer fluid is developed to simulate the nonlinear interactions between isws and a semi submersible platform where isws are generated by adding a mass source term and a sink term to the continuity equation in the source region located within the computational domain the conclusions are summarized as follows 1 the waveform and amplitude of the isw based on the developed numerical flume are in good agreement with the experimental and theoretical results moreover numerical results for the horizontal and vertical forces as well as torques on the semi submersible platform due to the isw are in good agreement with experimental results hence it is feasible to simulate the nonlinear interactions between isws and semi submersible platforms by the developed numerical flume 2 in general hydrodynamic force of an offshore structure consists of three components the wave and viscous pressure difference components and the friction component however for the case of a semi submersible structure under the action of isws the friction component is proved to be very small and can be neglected both for the horizontal and the vertical forces and the viscous pressure difference component is insignificant for vertical force but the viscous pressure difference component accounts for noticeable percentage of the horizontal force implying significant effect of fluid viscosity in addition the vertical force of the structure exerted by an isw can be estimated by means of the froude krylov approach which is of practical implication for engineering acknowledgments we acknowledge the financial support from the national key r d program of china 2017yfc1404202 the national natural science foundation of china 11602274 11232012 11572332 and 11372184 and the strategic priority research program of the chinese academy of sciences xdb22040203 
23641,in the calculation of the eedi for ships the accurate estimation of the ship speed power curves is of great significance the objective of this paper is to give a more accurate estimation method of speed power curves for container ships first the influence of three important factors on the eedi value is studied including the main engine power the deadweight and the reference speed and the calculation methods of the reference velocity are summarized next based on the speed power data from series of container ships the estimation accuracy of the original admiralty coefficient formula is evaluated then the constant power exponent in the admiralty coefficient formula is replaced by the hull form coefficients and a modified admiralty coefficient formula is proposed the modified formula proves to be more accurate than the original formula for the estimation of the power curve finally the application results of the two estimation formulas are compared in the calculation of the eedi for the container ship and the modified formula is recommended keywords eedi power curves estimation formula modified formula 1 introduction greenhouse gas emission has always been the focus of scientific research of environmental protection carbon dioxide is the main component of greenhouse gases for the period 2007 2012 on average the earth produced 33 billion tons of co2 per year up nearly 60 percent from 21 billion tons in 1970 second imo ghg study 2009 third imo ghg study 2014 according to unctad united nations conference on trade and development 2006 about 80 of world trade by volume is carried by sea where demand for seaborne transport is closely linked to the development of the economy third imo ghg study 2014 the vast majority of ships are powered by burning fuel oil to propel ships forward while the co2 produced by the combustion of fuel oil is emitted into the atmosphere according to the third imo ghg study 2014 the most comprehensive and authoritative assessment of the level of ghg emitted by ships total shipping is estimated to have emitted 949 million tonnes or about 2 7 of the global emissions of co2 in 2012 third imo ghg study 2014 mepc 2014 with the increase of greenhouse gas emission in shipping industry mepc 2012 third imo ghg study 2014 the reduction of greenhouse gas emissions and protecting atmospheric environment attracts more attention from the shipping industry the international maritime organization imo introduces the energy efficiency design index eedi regulation to limit emissions of co2 for the new ships international maritime organization 2011 2014a the regulation has been implemented on 1 january 2013 the eedi is a measure of a ship s co2 emissions in grams per ton transported and nautical mile sailed at a specific power plant operating point which represents the energy efficiency level of the ship international maritime organization 2014b the regulations establish an emission baseline based on the statistical analysis of existing ships and control the energy efficiency level of the new ships based on the baseline mepc 2012 the whole emission reduction process is divided into four stages and the eedi requirements of each stage can be expressed as follows mepc 2012 1 attained eedi required eedi 1 x 100 reference line value where the attained eedi is obtained from the eedi formula the required eedi is calculated according to the ship s type and capacity x is the reduction factor specified in table 1 the reference line values shall be calculated as follows mepc 2011 2 reference line value a b c where a b and c are the parameters given in table 2 reference line and required eedi values for container ships are shown in fig 1 the eedi has strict control over the co2 emission from the new ships and has an important influence on the design of new ships balland et al 2014 perera and mo 2016 sun et al 2016 devanney 2011 studied the impact of the eedi on very large crude carrier design and co2 emissions ančić and šestan 2015 studied the influence of the required eedi reduction factor on the co2 emission from bulk carriers by estimating the co2 emission from bulk carriers based on the current reduction factor change policy tzannatos and stournaras 2015 made an eedi analysis of ro pax and passenger ships in greece it was shown that the eedi baseline calculation is highly influenced by vessel design and operational characteristics attah and bucknall 2015 investigated the impacts of the eedi regulation on the design of future lng carriers and proposed amendments to the eedi baseline values for lng carriers faitar and novac 2016 conducted a complex comparative analysis of eedi and eeoi energy efficiency operational indicator with two cases bøckmann and steen 2016 researched the calculation of eedi in beaufort 6 wind and waves for a general cargo vessel using three different calculation methods for the added resistance due to waves duan et al 2012 studied the eedi calculation and certificate application in detail and analyzed the necessary energy saving and emission reduction measures for the ships to meet the more demanding eedi requirement in the future hu et al 2013 adopted the iso method to calibrate the ship trial speed in order to obtain the reference speed of eedi and calculated the attained eedi and the required eedi zhu et al 2013 proposed a direct power curve calculation method which was validated by practical examples and was proved to be more clear simple and accurate than the conventional indirect calculation method most of the previous work mentioned above is focused on the influence of the eedi on ship design and the calculation of the eedi there are few articles on the estimation of speed power curves during the eedi calculation three key factors define the attained eedi ships power system co2 emission capacity dwt and speed vref kristensen 2010 the speed vref is obtained from the speed power curves that meet the definition conditions and the calculation of vref includes two stages in the first stage the theoretical value is derived from the power curves of the model test in the second stage the theoretical value is modified by the power curve of the sea trial if the loading state of the sea trial is different from that of the model test in the second stage it is necessary to re estimate the power curves of the model test or the sea trial to ensure that the power curves of the two are in the same loading state the estimation method of the power curve is not mentioned in the eedi calculation and the imo does not give a unified standard the accurate estimation of the ship speed power curves is of great significance during the eedi calculation the aim of the present paper is to propose a modified estimation formula for the power curves of container ships and to apply this formula to the eedi calculation 2 calculation of eedi 2 1 formula of attained eedi according to mepc 2014 guidelines the attained eedi of a ship is calculated from the following formula international maritime organization 2014b 3 eedi j 1 n f j i 1 nme p me i c fme i sfc me i p ae c fae sfc ae j 1 n f j i 1 npti p pti i i 1 neff f eff i p aeeff i c fae sfc ae i 1 neff f eff i p eff i c fme sfc me f i f c f l capacity f w v r e f n is the number of main engines me shaft motors pti or units of innovative energy efficiency technology eff p is the power of the main and auxiliary engines measured in kw pme i is 75 percent of mcr for each main engine 4 p me i 0 75 mcr me i p pto i ppto i is 75 percent of nominal power of each shaft generator ppti i is 75 percent of the rated power consumption of each shaft motor divided by the weighted average efficiency of the generators peff i is the output of the innovative mechanical energy efficient technology for propulsion at 75 percent main engine power paeeff i is the auxiliary power reduction due to innovative electrical energy efficient technology measured at pme i pae is the required auxiliary engine power to supply normal maximum sea load including necessary power for propulsion machinery systems and accommodation and pae is written as follows 5 p ae mcrme 10000 kw 0 025 i 1 nme mcr me i i 1 npti p pti i 0 75 250 6 p ae mcrme 10000 k w 0 05 i 1 nme mcr me i i 1 npti p pti i 0 75 cf is a non dimensional conversion factor for fuel consumption measured in g and co2 emission sfc is the certified specific fuel consumption measured in g kwh of the engines f j is a power correction factor to account for ship specific design elements feff i is the availability factor of each innovative energy efficient technology fi is the capacity factor for any technical regulatory limitation on capacity and should be assumed to be one 1 0 if no necessity of the factor is granted fc is the cubic correction factor fl is the factor for general cargo ships equipped with cranes and other cargo related gear to compensate for a loss of deadweight of the ship fw is a non dimensional coefficient indicating the decrease of speed in representative sea conditions of wave height capacity is deadweight of the ship in tons vref is the ship speed in knots in calm water at the summer load line draught 70 dwt draught for container ship obtained at 75 percent of mcr power 2 2 impact parameters analysis for the sake of analysis it is assumed that the special design correction coefficient fj the energy efficiency coefficient feff the load capacity correction coefficient fi the cabin correction coefficient fc the compensation load factor fl and the speed loss coefficient fw are 1 0 and the influence of the shaft generator shaft motor and innovative energy saving technology on the propulsive power are ignored the calculation formula of attained eedi can be simplified as follows 7 eedi i 1 nme p me i c fme i sfc me i p ae c fae sfc ae capacity v r e f from 4 and 6 it can be seen that the auxiliary power pae can be calculated by the main engine power pme cf and sfc are constant terms then the eedi can be expressed as 8 eedi p m e dwt v ref therefore the main factors affecting the eedi value of ship are the main engine power pme the capacity dwt and the reference speed vref take 8000teu container ship as an example duan et al 2012 its attained eedi is 15 99 g t nm the main engine power is 68520 kw the deadweight is 101588 9 t and the reference speed is 26 0 kn the influence of the main factors on the eedi value is studied based on the admiralty coefficient formula we keep the deadweight unchanged when the influence of the main engine power on the eedi value is studied the main engine power is reduced by 1 10 the speed can be obtained by the following equation 9 v a δ b 2 3 v b 3 p a δ a 2 3 p b 1 3 v b p a p b 1 3 where pb δb vb represent the main engine power displacement and speed before conversion and pa δa va represent the main engine power displacement and speed after conversion the variation of the eedi with the main engine power is shown in fig 2 it can be seen that the eedi value decreases gradually with the decrease of the main engine power the eedi value decreases by 6 78 when the main engine power decreases by 10 we keep the main engine power unchanged when the influence of the deadweight on the eedi value is studied the deadweight increases by 1 10 and the displacement increases by 0 85 8 5 the speed can be obtained by the following equation 10 v a δ b 2 3 v b 3 p a δ a 2 3 p b 1 3 v b δ b δ a 2 9 the variation of the eedi with the deadweight is shown in fig 2 it can be seen that the eedi value decreases gradually with the increase of the deadweight the eedi value decreases by 7 43 when the deadweight increases by 10 we keep the deadweight unchanged when the influence of the reference speed on the eedi value is studied the reference speed is reduced by 1 10 the main engine power can be obtained by the following equation 11 p a δ a 2 3 v a 3 p b δ b 2 3 v b 3 v a v b 3 p b the variation of the eedi with the reference speed is shown in fig 2 it can be seen that the eedi value decreases gradually with the decrease of the reference speed the eedi value decreases by 19 00 when the reference speed decreases by 10 through the comparison of the three factors when the main engine power the capacity and the reference speed changes by the same percentage the influence of the reference speed on the eedi value is the most significant followed by the capacity and the last is the main engine power 2 3 calculation of vref in the calculation of the attained eedi the speed vref is the most complicated factor kristensen 2010 international maritime organization 2014b it is determined by the power curves of the model test and the sea trial accurate estimation of the power curves is of great significance for the calculation of the attained eedi at present the calculation process of the speed vref is divided into four kinds of circumstances the sea trial of ship is conducted in summer load draught 70 dwt draught for the container ship and in the deep water condition the speed vref is the measured ship speed at sea trial at 75 of mcr power the sea trial is conducted in the ballast condition rather than in the summer load draught condition it is necessary to use the power curves of the model test in full loaded and ballast conditions the speed is corrected to the summer load draught condition by compare the power curve of the sea trial and the power curve of the model test the speed correction method is shown in fig 3 the speed correction formula is given as follows international maritime organization 2012 12 v full s v full p v ballast s v ballast p vfull s adjusted ship speed by the results of sea trial in full loaded condition vfull p estimated ship speed by the results of model test in full loaded condition vballast s ship speed obtained as a result of the sea trial in ballast condition vballast p estimated ship speed by the results of model test in ballast condition the ballast condition of the sea trial is different from that of the model test firstly it is necessary to re estimate the power curves of the model test or the sea trial to ensure that the power curves of the two are in the same loading state then the speed correction method is adopted for speed correction in the eedi calculation of the container ship the vref is the speed at 70 dwt draught sometimes there is no power curve of model test at 70 dwt draught it is necessary to estimate the power curve at 70 dwt draught eedi condition then the speed correction method is adopted for speed correction in the latter two cases imo does not give a unified reference method to estimate the power curves from the sea trial or the model test this makes a difference in eedi calculations for the same ship this paper will attempt to give an accurate estimation method of power curves for the container ship based on the original admiralty coefficient formula to ensure the accurate calculation of the container ship s eedi 3 estimation method of power curves the admiralty coefficient formula can be used to estimate the power curves of the ships which is expressed as ships with similar hull form scale and speed have the same admiralty coefficient in the eedi calculation a power curve of displacement δ1 is used to estimate the power curve of displacement δ2 for the same ship so the admiralty coefficient formula is applicable the power curve of the displacement δ1 is used to calculate the admiralty coefficient c and the power curve of the displacement δ2 can be calculated as follows 13 p s δ 2 3 v 3 c the admiralty coefficient formula is a simple estimation method which is widely used in engineering duan et al 2012 adopted the admiralty coefficient formula to calculate the power curve at 70 dwt draught eedi condition and got the speed vref in the calculation of a container ship s eedi the calculation process was recognized by the germanischer lloyd but the admiralty coefficient method although a useful and simple estimation method is a somewhat blunt instrument when used in power estimation since it fails to effectively distinguish between the power and hull related parameters carlton 2007 yuan 2009 used the admiralty coefficient method to predict ship s powering performance the estimation results were compared with the actual values and the overall errors were large and unstable the effectiveness of the admiralty coefficient formula should be evaluated in the engineering firstly based on the speed power data from series of container ships the estimation accuracy of the original admiralty coefficient formula is evaluated then the constant power exponent in the admiralty coefficient formula is replaced by the hull form coefficient and a modified admiralty coefficient formula is proposed to estimate the power curves of the container ship 3 1 evaluation of the estimation formula in order to evaluate the effectiveness of the admiralty coefficient formula for the calculation of the power curve of the container ship the power data of four container ships 1100teu 4250teu 4700teu 9400teu are selected which are provided by the towing tank laboratory of the school of naval architecture and ocean engineering huazhong university of science and technology as shown in fig 4 the towing tank is one of the official members of the international towing tank conference ittc the principal dimensions of the towing tank are 175 6 4 m the maximum speed and acceleration of the carriage is 8 0 m sec and 0 67 m sec2 respectively the power data are obtained by resistance tests and propulsion tests the parameters of the four container ships are given in table 3 the model scales of 1100teu 4250teu 4700teu and 9400teu are λ1 26 λ2 40 λ3 42 and λ4 55 respectively the ship models are shown in fig 5 the towing carriage is electronically controlled and the selected carriage speed is kept constant during the actual measuring period before decelerating and stopping the towing carriage is equipped with a computerized data recording and processing system during resistance tests the ship model is towed by means of a thin wire which is connected to a resistance dynamometer mounted above the model the tow force measured at the dynamometer is identical to the resistance of the model navigation bars keep the model on a straight course while allowing free trim and sinkage the installation of the equipments is illustrated in fig 6 during the propulsion tests the model is driven by its own propeller powered by an electric motor in order to compensate for the model s increased surface friction it is additionally towed by a thin wire during the propulsion test the towing force fd which is applied is calculated as a function of the model s speed according to 14 f d ρ m 2 v m 2 s m c f m c f s where ρ m is the water density of model test vm is the velocity of model ship sm is the wetted surface area of model ship cfm is the friction resistance coefficient of model ship and cfs is the friction resistance coefficient of real ship the model ship in the propulsion test is shown in fig 7 based on the test results and the trial prediction method the main engine power of real ship can be got the power data of the four container ships with different displacements and speeds are shown in table 4 in order to facilitate the analysis and comparison of the admiralty coefficient formula and the actual data the ratio of the adjacent draught t2 t1 t2 t1 the ratio of the adjacent displacement δ2 δ1 δ2 δ1 and the corresponding ratio of the power ps2 ps1 for each container ship are listed in table 5 in table 5 it can be found that some of the power ratios of the adjacent displacement are less than 1 under the same speed this means that the power of the ship decreases with increasing displacement but according to the admiralty coefficient formula the power of the ship will increase with increasing displacement for the similar ships at the same speed which can be expressed as follows 15 p s 2 p s 1 δ 2 δ 1 x 1 where δ1 and δ2 are the displacements δ2 δ1 ps1 and ps2 are the corresponding power the admiralty coefficient formula does not fit well with the actual situation as an empirical formula it only provides a rough estimate of the power in the formula the power exponent x is a very important parameter which has significant influence on the estimation results of the formula the power exponent x takes 2 3 in engineering according to the admiralty coefficient formula the power data of the four container ships are selected to analyze the estimation accuracy of the admiralty coefficient formula when the power exponent x takes 2 3 for the same displacement ratio δ2 δ1 the power ratios at different speeds are averaged the calculated values of the formula are compared with the actual values as listed in table 6 it can be seen from table 6 that the relative error between the calculated value and the actual value is obvious especially near the design draught and the maximum error is 11 3 in other words the power exponent x 2 3 in the admiralty coefficient formula is unreasonable according to the data in table 6 when the power exponent of the formula is 2 3 we get the following equation 16 p s 2 p s 1 δ 2 δ 1 2 3 it shows that the power exponent in the formula is large relative to the fixed power exponent when it is expressed as a function of the ship type it may be more reasonable for the estimation of the ship s power 3 2 correction of the estimation formula due to the low prediction accuracy of the original admiralty coefficient formula for the power of the container ship it should be modified the experimental data indicated that the fixed power exponent x 2 3 in the admiralty coefficient formula is large so we start with the power exponent to modify the original admiralty coefficient formula the shape of the ship hull is determined by the ship form parameters which include ship form coefficients scale coefficients and shape parameters but the ship form coefficients mainly reflect the shape change of the ship hull below the waterline under different displacements including block coefficient cb prismatic coefficient cp and waterplane coefficient cw etc in order to analyze the influence of the ship shape change below the waterline on the power we choose the block coefficient cb the prismatic coefficient cp and the waterplane coefficient cw to replace the fixed power exponent since the cb and the cp are approximately equal for container ships the cb and the cw of the original ship are used as variable parameters to explore the relationship between the ship form coefficients and the power exponent in the admiralty coefficient formula first we consider the block coefficient cb in isolation and express the exponent x as a linear function of cb 17 x α 1 β 1 c b where α1 and β1 are the constant coefficients we use the curve fitting method to solve the constant coefficients based on the power data of container ships the final solution is x 1 cb the estimation results of x 1 cb are compared with the calculated results of x 2 3 as listed in table 7 the calculated results show that the estimation accuracy of the power is improved obviously by modifying the power index of the formula to 1 cb especially near the design draught then we consider the waterplane coefficient cw in isolation and express the exponent x as a linear function of cw 18 x α 2 β 2 c w where α2 and β2 are the constant coefficients the curve fitting method is used to solve the constant coefficients based on the power data of container ships the final solution is x 1 cw the estimation results of x 1 cw are compared with the calculated results of x 2 3 as listed in table 8 it shows that the estimation accuracy of the power near the design draught is further improved by modifying the power index to 1 cw at last in order to consider the effect of the block coefficient cb and the waterplane coefficient cw of the original ship on the calculation results of the admiralty coefficient formula we express the exponent x as a linear function of cb and cw 19 x α 3 β 3 c b c w where α3 and β3 are the constant coefficients the curve fitting method is used to solve the constant coefficients based on the power data of container ships the final solution is x 1 2 c b c w 3 the estimation results of x 1 2 c b c w 3 are compared with the calculated results of x 2 3 as listed in table 9 the calculated results of x 1 2 c b c w 3 are better than that of x 2 3 it can be seen from table 7 table 8 and table 9 when the power exponent is 2 3 1 cb and 1 cw half of the relative errors between the calculated results and the actual values are greater than 2 7 but when the power exponent is 1 2 c b c w 3 all the relative errors between the calculated results and the actual values are within 2 6 except one maximum relative error the estimation results of the power are more accurate and stable by modifying the power index to 1 2 c b c w 3 compared with the power exponents x 2 3 x 1 cb and x 1 cw therefore the power curves in the calculation of the container ship s eedi can be estimated by the following modified formula 20 p s 2 p s 1 δ 2 δ 1 1 2 c b c w 3 in order to further verify the estimation accuracy of the modified formula we use the power data of 4 9 m and 7 3 m draught to estimate the power of 5 5 m and 7 7 m draught of the 1100teu container ship the estimation results of the modified formula and the original formula are compared with the model test results as shown in fig 8 and fig 9 it can be seen that the estimation results of the modified formula are closer to the experimental results compared with the estimation results of the original formula therefore the modified admiralty coefficient formula is more suitable for estimating the power of the container ships 4 application of the estimation formula in the calculation of ships eedi the estimation of ship speed power curves is present and the accurate estimation of ship power curves is of great significance to the eedi calculation the original admiralty coefficient formula and the modified admiralty coefficient formula are used to estimate the power curves in the process of the eedi calculation of 1100teu container ship and the calculation results of the two formulas are compared the power data from model test for the ship at design draught and ballast draught are shown in table 4 the sea trial was carried out in the loading state of 4 5 m prior to the trial the ship s state and the environmental conditions should be recorded including the forward draught midship draught the stern draught the weather condition the air temperature the water temperature the atmospheric pressure etc the trial runs were conducted over the same ground area for each base course each speed run was commenced and completed at the same place the trial duration should be long enough to accommodate a speed power measurement within the required accuracy the run duration should be the same for all speed runs with a minimum of 10 min all trials were carried out using double runs i e each run should be followed by a return run in exactly the opposite direction and at the same engine setting the path of ship during double runs is shown in fig 10 to determine the speed power curve for the ship the sea trial was conducted at four different power settings on each run the ship s speed was measured with differential global positioning system dgps the propeller shaft power was measured by shaft power meter moreover ship s heading relative wind velocity and direction water depth wave height period and direction and other parameters were recorded after the sea trial the speeds and powers were corrected to the condition of no wind no wave no flow and deep water by iso 15016 2015 international organization for standardization 2015 and the data is shown in table 10 before the eedi calculation the reference speed vref should be obtained by the power curves because the ballast condition of the model test is different from the load state of the sea trial the estimation formula is adopted to convert the power curve of the model test into the power curve of 4 5 m draught state since there is no power curve of 70 dwt draught the power curve of the model test in the other draught should be converted into the power curve of 70 dwt draught then the speed vref of the attained eedi in 70 dwt draught is derived by formula 12 of the speed correction principle the calculation processes of the reference speed vref using the original admiralty coefficient formula and the modified admiralty coefficient formula are shown in fig 11 and fig 12 respectively finally the vref obtained by the original admiralty coefficient formula is 17 48kn and the vref obtained by the modified admiralty coefficient formula is 18 22kn the parameters of the eedi calculation of 1100teu container ship are shown in table 11 let us ignore the innovative energy efficiency technology that is paeeff 0 peff 0 and assume that the correction factor fi fj fc fw 1 according to the regulations of the mepc international maritime organization 2014b the attained eedi and required eedi are calculated by formula 3 and 1 respectively as shown in table 12 the calculation results show that the eedi calculated by the original admiralty coefficient formula does not meet the requirement of attained eedi required eedi in phase 1 phase 2 and phase 3 the eedi calculated by the modified admiralty coefficient formula meets the requirement of attained eedi required eedi in phase 1 the speed value calculated by the modified admiralty coefficient formula is 1 04 times higher than that calculated by the original admiralty coefficient formula and the eedi value is 4 05 smaller the direct application of the original empirical formula may further amplify the error of the estimation therefore it is more appropriate to apply the modified admiralty coefficient formula to estimate the power curves in the eedi calculation of the container ship 5 conclusions in the eedi calculation the reference speed is obtained from the ship power curves the accurate estimation of the ship power curves is very important the analysis of three impact factors which are the main engine power the capacity and the reference speed indicates that the influence of the reference speed on the eedi value is the most significant the accuracy of the original admiralty coefficient formula is evaluated to estimate the power curves of the container ship it is shown that the fixed power exponent in the original admiralty coefficient formula is too large then the modified formula is adopted to estimate the power curves of the container ship and the results are closer to the experiment results than that of the original formula the eedi value obtained by the modified admiralty coefficient formula is 4 05 smaller than that obtained by the original admiralty coefficient formula the modified formula is recommended for the calculation of the container ship s eedi in future work the estimation formula of power curve will be verified and corrected by more actual data in addition some other influence factors such as the geometric feature of the bulbous bow can be taken into account in the formula as well acknowledgement the authors gratefully acknowledge the financial support from the national natural science foundation of china nsfc under project number 51679097 51609115 51474109 and the financial support from the opening fund of the hubei key laboratory of naval architecture ocean engineering hydrodynamics under project number 201701 as well 
23641,in the calculation of the eedi for ships the accurate estimation of the ship speed power curves is of great significance the objective of this paper is to give a more accurate estimation method of speed power curves for container ships first the influence of three important factors on the eedi value is studied including the main engine power the deadweight and the reference speed and the calculation methods of the reference velocity are summarized next based on the speed power data from series of container ships the estimation accuracy of the original admiralty coefficient formula is evaluated then the constant power exponent in the admiralty coefficient formula is replaced by the hull form coefficients and a modified admiralty coefficient formula is proposed the modified formula proves to be more accurate than the original formula for the estimation of the power curve finally the application results of the two estimation formulas are compared in the calculation of the eedi for the container ship and the modified formula is recommended keywords eedi power curves estimation formula modified formula 1 introduction greenhouse gas emission has always been the focus of scientific research of environmental protection carbon dioxide is the main component of greenhouse gases for the period 2007 2012 on average the earth produced 33 billion tons of co2 per year up nearly 60 percent from 21 billion tons in 1970 second imo ghg study 2009 third imo ghg study 2014 according to unctad united nations conference on trade and development 2006 about 80 of world trade by volume is carried by sea where demand for seaborne transport is closely linked to the development of the economy third imo ghg study 2014 the vast majority of ships are powered by burning fuel oil to propel ships forward while the co2 produced by the combustion of fuel oil is emitted into the atmosphere according to the third imo ghg study 2014 the most comprehensive and authoritative assessment of the level of ghg emitted by ships total shipping is estimated to have emitted 949 million tonnes or about 2 7 of the global emissions of co2 in 2012 third imo ghg study 2014 mepc 2014 with the increase of greenhouse gas emission in shipping industry mepc 2012 third imo ghg study 2014 the reduction of greenhouse gas emissions and protecting atmospheric environment attracts more attention from the shipping industry the international maritime organization imo introduces the energy efficiency design index eedi regulation to limit emissions of co2 for the new ships international maritime organization 2011 2014a the regulation has been implemented on 1 january 2013 the eedi is a measure of a ship s co2 emissions in grams per ton transported and nautical mile sailed at a specific power plant operating point which represents the energy efficiency level of the ship international maritime organization 2014b the regulations establish an emission baseline based on the statistical analysis of existing ships and control the energy efficiency level of the new ships based on the baseline mepc 2012 the whole emission reduction process is divided into four stages and the eedi requirements of each stage can be expressed as follows mepc 2012 1 attained eedi required eedi 1 x 100 reference line value where the attained eedi is obtained from the eedi formula the required eedi is calculated according to the ship s type and capacity x is the reduction factor specified in table 1 the reference line values shall be calculated as follows mepc 2011 2 reference line value a b c where a b and c are the parameters given in table 2 reference line and required eedi values for container ships are shown in fig 1 the eedi has strict control over the co2 emission from the new ships and has an important influence on the design of new ships balland et al 2014 perera and mo 2016 sun et al 2016 devanney 2011 studied the impact of the eedi on very large crude carrier design and co2 emissions ančić and šestan 2015 studied the influence of the required eedi reduction factor on the co2 emission from bulk carriers by estimating the co2 emission from bulk carriers based on the current reduction factor change policy tzannatos and stournaras 2015 made an eedi analysis of ro pax and passenger ships in greece it was shown that the eedi baseline calculation is highly influenced by vessel design and operational characteristics attah and bucknall 2015 investigated the impacts of the eedi regulation on the design of future lng carriers and proposed amendments to the eedi baseline values for lng carriers faitar and novac 2016 conducted a complex comparative analysis of eedi and eeoi energy efficiency operational indicator with two cases bøckmann and steen 2016 researched the calculation of eedi in beaufort 6 wind and waves for a general cargo vessel using three different calculation methods for the added resistance due to waves duan et al 2012 studied the eedi calculation and certificate application in detail and analyzed the necessary energy saving and emission reduction measures for the ships to meet the more demanding eedi requirement in the future hu et al 2013 adopted the iso method to calibrate the ship trial speed in order to obtain the reference speed of eedi and calculated the attained eedi and the required eedi zhu et al 2013 proposed a direct power curve calculation method which was validated by practical examples and was proved to be more clear simple and accurate than the conventional indirect calculation method most of the previous work mentioned above is focused on the influence of the eedi on ship design and the calculation of the eedi there are few articles on the estimation of speed power curves during the eedi calculation three key factors define the attained eedi ships power system co2 emission capacity dwt and speed vref kristensen 2010 the speed vref is obtained from the speed power curves that meet the definition conditions and the calculation of vref includes two stages in the first stage the theoretical value is derived from the power curves of the model test in the second stage the theoretical value is modified by the power curve of the sea trial if the loading state of the sea trial is different from that of the model test in the second stage it is necessary to re estimate the power curves of the model test or the sea trial to ensure that the power curves of the two are in the same loading state the estimation method of the power curve is not mentioned in the eedi calculation and the imo does not give a unified standard the accurate estimation of the ship speed power curves is of great significance during the eedi calculation the aim of the present paper is to propose a modified estimation formula for the power curves of container ships and to apply this formula to the eedi calculation 2 calculation of eedi 2 1 formula of attained eedi according to mepc 2014 guidelines the attained eedi of a ship is calculated from the following formula international maritime organization 2014b 3 eedi j 1 n f j i 1 nme p me i c fme i sfc me i p ae c fae sfc ae j 1 n f j i 1 npti p pti i i 1 neff f eff i p aeeff i c fae sfc ae i 1 neff f eff i p eff i c fme sfc me f i f c f l capacity f w v r e f n is the number of main engines me shaft motors pti or units of innovative energy efficiency technology eff p is the power of the main and auxiliary engines measured in kw pme i is 75 percent of mcr for each main engine 4 p me i 0 75 mcr me i p pto i ppto i is 75 percent of nominal power of each shaft generator ppti i is 75 percent of the rated power consumption of each shaft motor divided by the weighted average efficiency of the generators peff i is the output of the innovative mechanical energy efficient technology for propulsion at 75 percent main engine power paeeff i is the auxiliary power reduction due to innovative electrical energy efficient technology measured at pme i pae is the required auxiliary engine power to supply normal maximum sea load including necessary power for propulsion machinery systems and accommodation and pae is written as follows 5 p ae mcrme 10000 kw 0 025 i 1 nme mcr me i i 1 npti p pti i 0 75 250 6 p ae mcrme 10000 k w 0 05 i 1 nme mcr me i i 1 npti p pti i 0 75 cf is a non dimensional conversion factor for fuel consumption measured in g and co2 emission sfc is the certified specific fuel consumption measured in g kwh of the engines f j is a power correction factor to account for ship specific design elements feff i is the availability factor of each innovative energy efficient technology fi is the capacity factor for any technical regulatory limitation on capacity and should be assumed to be one 1 0 if no necessity of the factor is granted fc is the cubic correction factor fl is the factor for general cargo ships equipped with cranes and other cargo related gear to compensate for a loss of deadweight of the ship fw is a non dimensional coefficient indicating the decrease of speed in representative sea conditions of wave height capacity is deadweight of the ship in tons vref is the ship speed in knots in calm water at the summer load line draught 70 dwt draught for container ship obtained at 75 percent of mcr power 2 2 impact parameters analysis for the sake of analysis it is assumed that the special design correction coefficient fj the energy efficiency coefficient feff the load capacity correction coefficient fi the cabin correction coefficient fc the compensation load factor fl and the speed loss coefficient fw are 1 0 and the influence of the shaft generator shaft motor and innovative energy saving technology on the propulsive power are ignored the calculation formula of attained eedi can be simplified as follows 7 eedi i 1 nme p me i c fme i sfc me i p ae c fae sfc ae capacity v r e f from 4 and 6 it can be seen that the auxiliary power pae can be calculated by the main engine power pme cf and sfc are constant terms then the eedi can be expressed as 8 eedi p m e dwt v ref therefore the main factors affecting the eedi value of ship are the main engine power pme the capacity dwt and the reference speed vref take 8000teu container ship as an example duan et al 2012 its attained eedi is 15 99 g t nm the main engine power is 68520 kw the deadweight is 101588 9 t and the reference speed is 26 0 kn the influence of the main factors on the eedi value is studied based on the admiralty coefficient formula we keep the deadweight unchanged when the influence of the main engine power on the eedi value is studied the main engine power is reduced by 1 10 the speed can be obtained by the following equation 9 v a δ b 2 3 v b 3 p a δ a 2 3 p b 1 3 v b p a p b 1 3 where pb δb vb represent the main engine power displacement and speed before conversion and pa δa va represent the main engine power displacement and speed after conversion the variation of the eedi with the main engine power is shown in fig 2 it can be seen that the eedi value decreases gradually with the decrease of the main engine power the eedi value decreases by 6 78 when the main engine power decreases by 10 we keep the main engine power unchanged when the influence of the deadweight on the eedi value is studied the deadweight increases by 1 10 and the displacement increases by 0 85 8 5 the speed can be obtained by the following equation 10 v a δ b 2 3 v b 3 p a δ a 2 3 p b 1 3 v b δ b δ a 2 9 the variation of the eedi with the deadweight is shown in fig 2 it can be seen that the eedi value decreases gradually with the increase of the deadweight the eedi value decreases by 7 43 when the deadweight increases by 10 we keep the deadweight unchanged when the influence of the reference speed on the eedi value is studied the reference speed is reduced by 1 10 the main engine power can be obtained by the following equation 11 p a δ a 2 3 v a 3 p b δ b 2 3 v b 3 v a v b 3 p b the variation of the eedi with the reference speed is shown in fig 2 it can be seen that the eedi value decreases gradually with the decrease of the reference speed the eedi value decreases by 19 00 when the reference speed decreases by 10 through the comparison of the three factors when the main engine power the capacity and the reference speed changes by the same percentage the influence of the reference speed on the eedi value is the most significant followed by the capacity and the last is the main engine power 2 3 calculation of vref in the calculation of the attained eedi the speed vref is the most complicated factor kristensen 2010 international maritime organization 2014b it is determined by the power curves of the model test and the sea trial accurate estimation of the power curves is of great significance for the calculation of the attained eedi at present the calculation process of the speed vref is divided into four kinds of circumstances the sea trial of ship is conducted in summer load draught 70 dwt draught for the container ship and in the deep water condition the speed vref is the measured ship speed at sea trial at 75 of mcr power the sea trial is conducted in the ballast condition rather than in the summer load draught condition it is necessary to use the power curves of the model test in full loaded and ballast conditions the speed is corrected to the summer load draught condition by compare the power curve of the sea trial and the power curve of the model test the speed correction method is shown in fig 3 the speed correction formula is given as follows international maritime organization 2012 12 v full s v full p v ballast s v ballast p vfull s adjusted ship speed by the results of sea trial in full loaded condition vfull p estimated ship speed by the results of model test in full loaded condition vballast s ship speed obtained as a result of the sea trial in ballast condition vballast p estimated ship speed by the results of model test in ballast condition the ballast condition of the sea trial is different from that of the model test firstly it is necessary to re estimate the power curves of the model test or the sea trial to ensure that the power curves of the two are in the same loading state then the speed correction method is adopted for speed correction in the eedi calculation of the container ship the vref is the speed at 70 dwt draught sometimes there is no power curve of model test at 70 dwt draught it is necessary to estimate the power curve at 70 dwt draught eedi condition then the speed correction method is adopted for speed correction in the latter two cases imo does not give a unified reference method to estimate the power curves from the sea trial or the model test this makes a difference in eedi calculations for the same ship this paper will attempt to give an accurate estimation method of power curves for the container ship based on the original admiralty coefficient formula to ensure the accurate calculation of the container ship s eedi 3 estimation method of power curves the admiralty coefficient formula can be used to estimate the power curves of the ships which is expressed as ships with similar hull form scale and speed have the same admiralty coefficient in the eedi calculation a power curve of displacement δ1 is used to estimate the power curve of displacement δ2 for the same ship so the admiralty coefficient formula is applicable the power curve of the displacement δ1 is used to calculate the admiralty coefficient c and the power curve of the displacement δ2 can be calculated as follows 13 p s δ 2 3 v 3 c the admiralty coefficient formula is a simple estimation method which is widely used in engineering duan et al 2012 adopted the admiralty coefficient formula to calculate the power curve at 70 dwt draught eedi condition and got the speed vref in the calculation of a container ship s eedi the calculation process was recognized by the germanischer lloyd but the admiralty coefficient method although a useful and simple estimation method is a somewhat blunt instrument when used in power estimation since it fails to effectively distinguish between the power and hull related parameters carlton 2007 yuan 2009 used the admiralty coefficient method to predict ship s powering performance the estimation results were compared with the actual values and the overall errors were large and unstable the effectiveness of the admiralty coefficient formula should be evaluated in the engineering firstly based on the speed power data from series of container ships the estimation accuracy of the original admiralty coefficient formula is evaluated then the constant power exponent in the admiralty coefficient formula is replaced by the hull form coefficient and a modified admiralty coefficient formula is proposed to estimate the power curves of the container ship 3 1 evaluation of the estimation formula in order to evaluate the effectiveness of the admiralty coefficient formula for the calculation of the power curve of the container ship the power data of four container ships 1100teu 4250teu 4700teu 9400teu are selected which are provided by the towing tank laboratory of the school of naval architecture and ocean engineering huazhong university of science and technology as shown in fig 4 the towing tank is one of the official members of the international towing tank conference ittc the principal dimensions of the towing tank are 175 6 4 m the maximum speed and acceleration of the carriage is 8 0 m sec and 0 67 m sec2 respectively the power data are obtained by resistance tests and propulsion tests the parameters of the four container ships are given in table 3 the model scales of 1100teu 4250teu 4700teu and 9400teu are λ1 26 λ2 40 λ3 42 and λ4 55 respectively the ship models are shown in fig 5 the towing carriage is electronically controlled and the selected carriage speed is kept constant during the actual measuring period before decelerating and stopping the towing carriage is equipped with a computerized data recording and processing system during resistance tests the ship model is towed by means of a thin wire which is connected to a resistance dynamometer mounted above the model the tow force measured at the dynamometer is identical to the resistance of the model navigation bars keep the model on a straight course while allowing free trim and sinkage the installation of the equipments is illustrated in fig 6 during the propulsion tests the model is driven by its own propeller powered by an electric motor in order to compensate for the model s increased surface friction it is additionally towed by a thin wire during the propulsion test the towing force fd which is applied is calculated as a function of the model s speed according to 14 f d ρ m 2 v m 2 s m c f m c f s where ρ m is the water density of model test vm is the velocity of model ship sm is the wetted surface area of model ship cfm is the friction resistance coefficient of model ship and cfs is the friction resistance coefficient of real ship the model ship in the propulsion test is shown in fig 7 based on the test results and the trial prediction method the main engine power of real ship can be got the power data of the four container ships with different displacements and speeds are shown in table 4 in order to facilitate the analysis and comparison of the admiralty coefficient formula and the actual data the ratio of the adjacent draught t2 t1 t2 t1 the ratio of the adjacent displacement δ2 δ1 δ2 δ1 and the corresponding ratio of the power ps2 ps1 for each container ship are listed in table 5 in table 5 it can be found that some of the power ratios of the adjacent displacement are less than 1 under the same speed this means that the power of the ship decreases with increasing displacement but according to the admiralty coefficient formula the power of the ship will increase with increasing displacement for the similar ships at the same speed which can be expressed as follows 15 p s 2 p s 1 δ 2 δ 1 x 1 where δ1 and δ2 are the displacements δ2 δ1 ps1 and ps2 are the corresponding power the admiralty coefficient formula does not fit well with the actual situation as an empirical formula it only provides a rough estimate of the power in the formula the power exponent x is a very important parameter which has significant influence on the estimation results of the formula the power exponent x takes 2 3 in engineering according to the admiralty coefficient formula the power data of the four container ships are selected to analyze the estimation accuracy of the admiralty coefficient formula when the power exponent x takes 2 3 for the same displacement ratio δ2 δ1 the power ratios at different speeds are averaged the calculated values of the formula are compared with the actual values as listed in table 6 it can be seen from table 6 that the relative error between the calculated value and the actual value is obvious especially near the design draught and the maximum error is 11 3 in other words the power exponent x 2 3 in the admiralty coefficient formula is unreasonable according to the data in table 6 when the power exponent of the formula is 2 3 we get the following equation 16 p s 2 p s 1 δ 2 δ 1 2 3 it shows that the power exponent in the formula is large relative to the fixed power exponent when it is expressed as a function of the ship type it may be more reasonable for the estimation of the ship s power 3 2 correction of the estimation formula due to the low prediction accuracy of the original admiralty coefficient formula for the power of the container ship it should be modified the experimental data indicated that the fixed power exponent x 2 3 in the admiralty coefficient formula is large so we start with the power exponent to modify the original admiralty coefficient formula the shape of the ship hull is determined by the ship form parameters which include ship form coefficients scale coefficients and shape parameters but the ship form coefficients mainly reflect the shape change of the ship hull below the waterline under different displacements including block coefficient cb prismatic coefficient cp and waterplane coefficient cw etc in order to analyze the influence of the ship shape change below the waterline on the power we choose the block coefficient cb the prismatic coefficient cp and the waterplane coefficient cw to replace the fixed power exponent since the cb and the cp are approximately equal for container ships the cb and the cw of the original ship are used as variable parameters to explore the relationship between the ship form coefficients and the power exponent in the admiralty coefficient formula first we consider the block coefficient cb in isolation and express the exponent x as a linear function of cb 17 x α 1 β 1 c b where α1 and β1 are the constant coefficients we use the curve fitting method to solve the constant coefficients based on the power data of container ships the final solution is x 1 cb the estimation results of x 1 cb are compared with the calculated results of x 2 3 as listed in table 7 the calculated results show that the estimation accuracy of the power is improved obviously by modifying the power index of the formula to 1 cb especially near the design draught then we consider the waterplane coefficient cw in isolation and express the exponent x as a linear function of cw 18 x α 2 β 2 c w where α2 and β2 are the constant coefficients the curve fitting method is used to solve the constant coefficients based on the power data of container ships the final solution is x 1 cw the estimation results of x 1 cw are compared with the calculated results of x 2 3 as listed in table 8 it shows that the estimation accuracy of the power near the design draught is further improved by modifying the power index to 1 cw at last in order to consider the effect of the block coefficient cb and the waterplane coefficient cw of the original ship on the calculation results of the admiralty coefficient formula we express the exponent x as a linear function of cb and cw 19 x α 3 β 3 c b c w where α3 and β3 are the constant coefficients the curve fitting method is used to solve the constant coefficients based on the power data of container ships the final solution is x 1 2 c b c w 3 the estimation results of x 1 2 c b c w 3 are compared with the calculated results of x 2 3 as listed in table 9 the calculated results of x 1 2 c b c w 3 are better than that of x 2 3 it can be seen from table 7 table 8 and table 9 when the power exponent is 2 3 1 cb and 1 cw half of the relative errors between the calculated results and the actual values are greater than 2 7 but when the power exponent is 1 2 c b c w 3 all the relative errors between the calculated results and the actual values are within 2 6 except one maximum relative error the estimation results of the power are more accurate and stable by modifying the power index to 1 2 c b c w 3 compared with the power exponents x 2 3 x 1 cb and x 1 cw therefore the power curves in the calculation of the container ship s eedi can be estimated by the following modified formula 20 p s 2 p s 1 δ 2 δ 1 1 2 c b c w 3 in order to further verify the estimation accuracy of the modified formula we use the power data of 4 9 m and 7 3 m draught to estimate the power of 5 5 m and 7 7 m draught of the 1100teu container ship the estimation results of the modified formula and the original formula are compared with the model test results as shown in fig 8 and fig 9 it can be seen that the estimation results of the modified formula are closer to the experimental results compared with the estimation results of the original formula therefore the modified admiralty coefficient formula is more suitable for estimating the power of the container ships 4 application of the estimation formula in the calculation of ships eedi the estimation of ship speed power curves is present and the accurate estimation of ship power curves is of great significance to the eedi calculation the original admiralty coefficient formula and the modified admiralty coefficient formula are used to estimate the power curves in the process of the eedi calculation of 1100teu container ship and the calculation results of the two formulas are compared the power data from model test for the ship at design draught and ballast draught are shown in table 4 the sea trial was carried out in the loading state of 4 5 m prior to the trial the ship s state and the environmental conditions should be recorded including the forward draught midship draught the stern draught the weather condition the air temperature the water temperature the atmospheric pressure etc the trial runs were conducted over the same ground area for each base course each speed run was commenced and completed at the same place the trial duration should be long enough to accommodate a speed power measurement within the required accuracy the run duration should be the same for all speed runs with a minimum of 10 min all trials were carried out using double runs i e each run should be followed by a return run in exactly the opposite direction and at the same engine setting the path of ship during double runs is shown in fig 10 to determine the speed power curve for the ship the sea trial was conducted at four different power settings on each run the ship s speed was measured with differential global positioning system dgps the propeller shaft power was measured by shaft power meter moreover ship s heading relative wind velocity and direction water depth wave height period and direction and other parameters were recorded after the sea trial the speeds and powers were corrected to the condition of no wind no wave no flow and deep water by iso 15016 2015 international organization for standardization 2015 and the data is shown in table 10 before the eedi calculation the reference speed vref should be obtained by the power curves because the ballast condition of the model test is different from the load state of the sea trial the estimation formula is adopted to convert the power curve of the model test into the power curve of 4 5 m draught state since there is no power curve of 70 dwt draught the power curve of the model test in the other draught should be converted into the power curve of 70 dwt draught then the speed vref of the attained eedi in 70 dwt draught is derived by formula 12 of the speed correction principle the calculation processes of the reference speed vref using the original admiralty coefficient formula and the modified admiralty coefficient formula are shown in fig 11 and fig 12 respectively finally the vref obtained by the original admiralty coefficient formula is 17 48kn and the vref obtained by the modified admiralty coefficient formula is 18 22kn the parameters of the eedi calculation of 1100teu container ship are shown in table 11 let us ignore the innovative energy efficiency technology that is paeeff 0 peff 0 and assume that the correction factor fi fj fc fw 1 according to the regulations of the mepc international maritime organization 2014b the attained eedi and required eedi are calculated by formula 3 and 1 respectively as shown in table 12 the calculation results show that the eedi calculated by the original admiralty coefficient formula does not meet the requirement of attained eedi required eedi in phase 1 phase 2 and phase 3 the eedi calculated by the modified admiralty coefficient formula meets the requirement of attained eedi required eedi in phase 1 the speed value calculated by the modified admiralty coefficient formula is 1 04 times higher than that calculated by the original admiralty coefficient formula and the eedi value is 4 05 smaller the direct application of the original empirical formula may further amplify the error of the estimation therefore it is more appropriate to apply the modified admiralty coefficient formula to estimate the power curves in the eedi calculation of the container ship 5 conclusions in the eedi calculation the reference speed is obtained from the ship power curves the accurate estimation of the ship power curves is very important the analysis of three impact factors which are the main engine power the capacity and the reference speed indicates that the influence of the reference speed on the eedi value is the most significant the accuracy of the original admiralty coefficient formula is evaluated to estimate the power curves of the container ship it is shown that the fixed power exponent in the original admiralty coefficient formula is too large then the modified formula is adopted to estimate the power curves of the container ship and the results are closer to the experiment results than that of the original formula the eedi value obtained by the modified admiralty coefficient formula is 4 05 smaller than that obtained by the original admiralty coefficient formula the modified formula is recommended for the calculation of the container ship s eedi in future work the estimation formula of power curve will be verified and corrected by more actual data in addition some other influence factors such as the geometric feature of the bulbous bow can be taken into account in the formula as well acknowledgement the authors gratefully acknowledge the financial support from the national natural science foundation of china nsfc under project number 51679097 51609115 51474109 and the financial support from the opening fund of the hubei key laboratory of naval architecture ocean engineering hydrodynamics under project number 201701 as well 
23642,this paper proposes the station keeping control for an underwater vehicle keeping balance motions and performing accurate manipulations in underwater inspections in order to control position and maintain bilateral balance in deep water a controller is designed with a sprott system based self synchronization error formulation and a bisection approach algorithm to enhance the performances of brushless dc motors a sufficiently high but not exceeding metacentric height gm is designed for the proposed underwater vehicle depth control with a pressure sensor is carried out depth gauge to determine the operated voltages using the voltage control mode the practical tracking controller can maintain the same dynamics for bilateral propellers uncertainty dynamic parameters cannot be precisely modeled in a vehicle and another one can track the pre specified dynamic responses of a reference model it keeps the bilateral propeller balancing operations by close loop controlling the duty ratios of a buck boost converter in contrast with the incremental conductance based controller and pid controller the proposed bilateral propellers controller is used to demonstrate the superior performances in depth and station keeping tests operating with armature voltages of 0 30 vdc and rotor speeds of 0 900 rpm in 0 3 m diving depth keywords self synchronization error formulation bisection approach algorithm metacentric height gm practical tracking controller bilateral propellers 1 introduction recently underwater vehicles are widely used for oceanographic research commercial tasks and military missions including hull and harbor inspection pollution surveillance underwater salvage and autonomous navigation observation class vehicles with specific sensors such as autonomous underwater vehicles auvs or remotely operated vehicles rovs can dive into a deep sea environment to make detailed maps of the seafloor measure the concentration of various compounds and capture images using an underwater camera miller et al 2010 bingham 2008 he et al 2011 if the underwater vehicle has a station keeping function it can maintain balance motion navigate accurately and perform accurate manipulations for underwater inspections miller et al 2010 donovan 2012 an important issue in a marine propulsion system is a propeller that generates thrust and overcomes water resistance in addition its motion will be affected by current forces hydrodynamics and pressure a vehicle swing frequency is affected by the separation distance between the center of gravity g and the center of buoyancy b any rotational motion around the center of b immediately sets up a restoring moment arm the fleet type submarine chapter 5 the restoring moment is proportional to distance gm i e the distance between the g of the vehicle and its metacenter m which is called the metacentric height mh each vehicle was designed with a large mh to ensure safety against the overturning of a floating body the mh is a measurement of a floating body s initial static stability a sufficient distance that does not exceed gm was determined for the design of the underwater vehicle for an underwater vehicle or a submarine the surrounding tank is submerged and stable the stable equilibrium always has the g below the b and both are in the same vertical line as shown in fig 1 a this study aims to design a vision servo vehicle to enable underwater station keeping stability for applications such as sea pipeline exploration geological exploration and reservoir investigation the proposed underwater vehicle is employed with respect to the desired distance measurement in addition the voltage and thrust characteristics of each thruster in a thruster pair will not be identical as they operate over time therefore a pressure sensing system and a close loop control algorithm were used to mitigate thrust imbalance effects in an uncertain marine environment an underwater vehicle consists of several components a vehicle hull thrusters a camera lights sensors depth gyroscope and accelerometer a power source ac dc and dc dc converter and a control system blue ray team rov team 2012 as shown in fig 1 b the laptop communicates with the control system via an ethernet protocol and a wireless router the propulsion system comprises two dc brushless thrusters model 260 tecnadyne inc that are arranged vertically to allow for diving and depth and motion controls a pressure transducer p51 ssi technologies inc is used to measure the depth under the waterline a brushless type motor is commonly used to enhance the performance of the motor a gearbox reduces the rotational speed improves torque and significantly reduces power consumption blue ray team the gear train consists of a planetary gear with a reduction gearbox ratio fitted directly to the output end of the motor previous studies fossen 1994 thor et al 2000 have proposed different methods to control a dc motor such as voltage control current control or torque control therefore a high efficiency motor controller is used to regulate the armature voltage depending on the output loading the propulsion components of electric vehicles such as brushless dc motors bdcm perform better than brushed dc motors and induction motors and are widely used in industrial applications because of their simple structure fast response high power density high reliability and low maintenance requirements pan and luo 2005 wang et al 2011 to achieve good performance a proportional integral differential pid controller is commonly used for this application wang et al 2011 singhal and padhee 2012 artificial intelligence ai methods such as fuzzy controllers cao and cao 2009 artificial neural networks ann based controllers pan and luo 2005 wlas et al 2005 bose 2007 differential geometric based non linear controllers huang et al 2009 and sliding mode controllers haddoun et al 2006 are also employed in electric vehicles the fuzzy and ann methods cao and cao 2009 wlas et al 2005 bose 2007 have high computational capability for the controller however it is essential to consider the various uncertainty conditions to design an adaptive model based controller with improved performance when proposing a station keeping control the proposed self synchronized practical tracking controller tracks the dynamic responses of a reference model a chaotic system cs such as the sprott system comprising a master system ms and a slave system ss kuo 2007 chen et al 2007 2013 pisarchik and ruiz oliveras 2010 kuo et al 2013 is a simple structure to design a self synchronization error formulation a coupling dynamic variable is used so that the response of the ss can automatically track the response of the ms to trace the bdcm voltage changes in real time signals this is represented using straightforward mathematical formulations and it provides rapid solutions in deep water self synchronized practical tracking maintains the same dynamics for bilateral propellers then the bisection approach algorithm is employed to control the duty ratios of a buck boost converter bbc under step up and step down conditions the proposed controller can quickly regulate the control signal to switch the duty ratio of the bbc for an estimated operating point its manipulation can eliminate the chattering phenomenon and allow for good station keeping and steady motion for deep water tasks for an active vehicle the proposed controller needs to utilize a digital signal processor dsp a field programmable gate array fpga a chip or an application specific integrated circuit chip bose 2007 which provides control procedures to achieve good performance at present high level chips have advanced vlsi technology and its support built in functions have improved the execution speed in this study the sprottcsbased self synchronization error formulation and bisection approach algorithm were designed as a microcomputer based controller in an embedded system the intelligent mobile vehicle could track the pre specified dynamic responses of a reference model and maintain the same dynamics for bilateral propellers in a simulation model of an underwater vehicle the dynamic tests show that the proposed method has good computational efficiency this paper is organized as follows section 2 describes the electromechanical propulsion system and section 3 describes the implementation of a practical tracking controller in sections 4 and 5 the experimental results and conclusions are given to show the efficiency of the proposed controller 2 an electromechanical system for an underwater vehicle 2 1 dc electromechanical system a dc electromechanical system comprises electrical and mechanical components as shown in fig 2 it can be used for robotic controls computer taps and disk drive position controls propeller controls and underwater vehicle control a magnetic field is produced by stationary permanent magnets pm or a stationary electromagnet in servo applications the dc motor is used in the linear range of the magnetization curve therefore the field flux φ is proportional to the field current i f that is φ i f the torque t m of the motor is proportional to the armature current i a and its back electromotive force emf is also proportional to speed nise 2004 the relation between the armature current i a applied armature voltage e a and back emf v b is found using a loop equation around the laplace transformed armature circuit 1 r a i a s l a s i a s v b s e a s 2 t m s k m i a s v b s k b s θ m s wherein k m is the motor torque constant and k b is the back emf constant by substituting equation 2 into 1 3 r a l a s t m s k m k b s θ m s e a s at the steady state condition the term l a st m s instantly disappears and equation 3 transforms as follows 4 r a k m t m s k b s θ m s e a s taking the inverse laplace transform equation 4 becomes 5 r a k m t m t k b ω m t e a t if a dc voltage e a is applied the motor operates at a constant angular velocity ω m with a constant torque t m therefore the motor operates at a steady state with a dc voltage input nise 2004 6 r a k m t m k b ω m e a t m k m k b r a ω m k m r a e a the stall torque t stall and the no load speed ω no load are derived using equation 6 7 t m 0 ω n o l o a d 1 k b e a ω m 0 t stall k m r a e a the electrical constants k m r a and k b are determined from a dynamometer test of a motor for a given e a as shown in fig 3 since the flux in a pm motor is fixed or constant the speed torque and current torque characteristics are straight lines the speed torque characteristics of a pm motor are controlled by changing either the armature voltage or the resistance of the armature circuit the objective is to control the armature voltage e a of dc motor using the proposed controller 2 2 motor voltage control a dc motor control model can be described as a motor armature voltage control b motor armature current control or c motor torque control the motor s torque is controlled by means of motor currents voltages and motor fluxes the dynamics of the electrical part of the electromechanical system are usually faster than the propeller shaft dynamics for a small propeller the time constant of the electrical and mechanical system can be comparable let us assume that the rotational speed can be reduced via a gearbox thus the gearbox ratio is chosen as 1 under a normal assumption for a dc motor dynamic nise 2004 as 8 r a k m t m t k b ω m t e a t r a i a t k b ω m t e a t j m d d t ω m t t m t t l k m i a t t l where ω m t is the propeller angular velocity rad sec t l is the load from the propeller and j m is the rotor moment of inertia the speed dynamics are obtained using the motor voltage control as fossen 1994 9 j m d d t ω m t k m k b r a ω m t k m r a e a t t l the term k m r a e a t is the control input and the term k n k m k b r a is the linear damping in practice unsteady flow such as cavitation in and out of water effects and a wave influenced boundary layer effect affects the propeller s thrust and torque thrust t and torque t l can be represented as ghasseni and ghadimi 2011 kim et al 2009 10 t ρ d p 4 k t j ω ω 11 t l ρ d p 5 k l j ω ω wherein ρ is the water density freshwater 1000 kg m3 saltwater 1025 kg m3 d p is the propeller diameter m j is the advance ratio with tangent speed u and ω is the angular velocity pivano 2008 12 j 2 π d p ω 1 ω f u the advance speed is very difficult to measure and an estimated speed is computed using the term 1 ω f u where ω f is the wake fraction number and is determined by experimental tests for an underwater vehicle the parameters k t and k l of open water vehicles are considered to have a linear relationship in advance ratio j they are approximated as lewis 1988 ittc 2002a ittc 2002b 13 k t α 1 j α 2 14 k l β 1 j β 2 where parameters α 1 α 2 β 1 and β 2 are non dimensional constants the propeller characteristics are determined by experimental testing with a propeller a least squares curve fit is used to estimate the parameters k t and k l therefore the load torque t l can be expressed as 15 t l ρ d p 5 β 1 j 2 β 2 j ω ω therefore it is possible to simulate an underwater vehicle for a given operating condition for different supply voltages a set of parallel speed torques can be obtained to match the load 3 practical tracking controller 3 1 self synchronization error formulation if a physical system does not deviate from the nominal operating conditions then a controller acts to handle the nonlinearity in small or large operating ranges according to the desired dynamic behaviors the so called practical tracking concept over limited time intervals a dynamic plant requires adequate tracking control to achieve pre specified dynamic behaviors such as mobile robotic navigation a car towing multiple trailers path tracking a spacecraft or a ship in this study a tracking control problem for an underwater vehicle system is proposed for tracking applications chaos synchronization systems such as lorenz rossler and sprott systems are used in adaptive control systems gyro motion controls and secure optical communication systems kuo 2007 chen et al 2007 2013 pisarchik and ruiz oliveras 2010 kuo et al 2013 whose dynamic behaviors can mimic others and synchronization is achieved for different time varying unknown parameters therefore to achieve synchronization between a master system ms and a slave system ss the ss follows the states of the ms by using reference information this means that the trajectories of the system converge to the same states as the other and they remain in step with each other in this study the sprott system x r 3 and y r 3 is used and its dynamical equation is given by 16 master system ms x a m x f x a m x 2 sign x 1 m 17 slave system ss y a s y f y a s y 2 s i g n y 1 s wherein x x 1m x 2m x 3m t y y 1s y 2s y 3s t and matrices a m or a s are 3 3 systems 18 a m a s 0 1 0 0 0 1 1 2 b a 19 s i g n δ 1 i f δ 0 1 i f δ 0 wherein δ x 1m or δ y 1s and sign δ is the signum function when tracking the dynamic errors the error variables are defined as e 1 x 1m y 1s e 2 x 2m y 2s e 3 x 3m y 3s and e e 1 e 2 e 3 t x 1m y 1s x 2m y 2s x 3m y 3s t the components x and y synchronize only if e 0 without considering the initial conditions in y which synchronize with x over a limited time interval by subtracting 17 from 16 the error system 20 can be expressed by the following relation 20 e 1 e 2 e 3 0 1 0 0 0 1 1 2 b a e 2 0 0 s i g n x 1 m s i g n y 1 s its purpose is to drive the system state to the desired objective and the variables x 1m and y 1s are simultaneously positive voltage in this study so f x f y 0 the last two equations form a linear system that is decoupled from the variable e 1 with the form 21 e 2 e 3 0 1 b a e 2 e 3 a e the polynomial p a λ is termed the characteristic equation of a and the real or complex eigenvalues are defined as 22 p a λ λ 2 a λ b 0 λ 1 2 a 1 2 a 2 4 b if the system parameters a 0 and b 0 the negative eigenvalues are easily determined and the robust asymptomatic stability of the system 21 is guaranteed for the sprott system computation discrete time master and slave systems are used as shown in fig 4 for discrete signals discrete variables x 1m v m1 i x 2m v m2 i and x 3m v m3 i i 1 2 3 n are a data sequence obtained from the desired voltage v m and discrete variables y 1s v s1 i y 2s v s2 i and y 3s v s3 i are a data sequence obtained from the instantaneous voltage or measurement voltage v s where n is the switch number of the buck boost convert the first term of the error system 21 is used to track the dynamic errors between the desired voltage and the instantaneous voltage if the error variables are e 1 i v m1 i v s1 i e 2 i v m2 i v s2 i e 3 i v m3 i v s3 i the discrete error equation self synchronization error dynamics is denoted as 23 φ φ 1 φ 2 e 2 i a b s 1 2 e 1 i b e 2 i a e 3 i equation 23 as a voltage detector is used to determine dynamic errors that are zero or have bounded ranges the dynamic error φ is used to extract the relevant variations from the desired voltage and the instantaneous voltage φ1 0 for the boost mode or for the buck mode a bisection approach algorithm is used to regulate the output voltage of the buck boost converter at each switching step i 1 2 3 n the method divides the interval in two by computing the mid voltage v m v s1 i 2 as shown in fig 4 b if the desired voltage v m and the initial voltage v s1 1 v s are estimated each switch has the following steps step 1 set the parameters of ms v m1 i v m2 i v m3 i v m i 1 2 3 n step 2 calculate the mid voltage v mid v m v s1 i 2 and the set the parameters of ss v m1 i v m2 i v m1 i v m3 i 2 v m3 i v mid i 1 2 3 n step 3 set the next initial parameter v m1 i 1 v m3 i step 4 calculate the φ2 if the convergent condition φ2 ε then fix the desired voltage 3 2 buck boost converter bbc control the basic configuration of a buck boost converter bbc is shown in fig 4 an inductor l and a capacitor c comprise a low pass filter and the feedback circuit is formed with resistors r 1 and r 2 its improvement structure has four switches to control the boost mode m p1 on m n1 off switch m p2 and m n2 and the buck mode m p2 on m n2 off switch m p1 and m n1 the following four functions are required to estimate 1 input voltage range v in v in min and v in max 2 desired voltage v m 3 maximum desired current i m and 4 switch sequences for boost and buck modes instruments 2012 sahu and rincón mora 2005 liou et al 2008 these must be estimated because some parameters are known so the power stage can be calculated varying the duty cycle of the switching time regulates the output voltage and the current of a bbc during the turn off time t off and the turn on time t on the duty cycle of the control signal is defined as 24 d t on t on t off t on t d the operating parameters of the bbc are used to estimate the duty cycle d buck for the buck mode and the duty cycle d boost for the boost mode as 25 d buck η v m v in 26 d boost 1 η v in v m where η is the estimated efficiency v m is the desired output voltage of the bbc and v in is the input voltage for buck mode and boost mode v in min v in v in max the converter also operates at the extremes of its maximum and minimum operating range v m min v m v m max the duty cycle is always positive and less than 1 this study uses a converter as a dc step up and steep down transformer which regulates voltages by switching the duty cycle d using equation 27 27 d i d i 1 δ d 28 δ d η δ v v m δ v v s 1 i v m 2 f o r b u c k mode δ v v m v s 1 i 2 f o r b o o s t mode where i 1 2 3 n is the switching number therefore v m is the desired voltage since the instantaneous voltage v s slowly rises or falls according to the measurement for a reference desired voltage the instantaneous voltages of another can be regulated by using the increment or decrease in the duty cycle δd 3 3 implementation of practical tracking controller fig 5 shows the block diagram of the bilateral propeller dynamic control model 260 tecnadyne inc rated voltage 48vdc rated depth 800 m for an underwater vehicle the high speed low inertia motor is coupled to a 6 1 ratio planetary gear set that is assembled with hardened high precision spur gears for voltage regulation to the brushless dc motors bdcms for the appropriate duty cycle the bilateral output approaches a desired voltage level the desired voltage is determined by depth control using a pressure sensor p51 ssi technologies inc as a depth gauge as shown in fig 6 wherein the estimated water depth h v h can be described as h v h 2 599 v h 1 520 and v h is the measurement voltage of the pressure transducer the controller of the dc brushless thruster accepts 5 vdc of analog speed and a direction control signal that can be supplied via a laptop with a digital analog card or a simple joystick however a vehicle s motion is affected by the current forces hydrodynamics and underwater pressure in practical operation for a reference desired voltage v m another measures the output voltage v s when its voltage is lower than the desired voltage and the controller turns on the step up voltages otherwise it turns on the step down voltages using pulse width modulation pwm a bisection approach algorithm is used to regulate the output voltage of a bbc this is accomplished by using a fixed switching frequency and varying the duty cycles the switching noise is filtered using an inductor and a capacitor a pwm uses a digital controller and performs on off switching from a few kilohertz khz to several kilohertz this produces less power loss in the switching devices in addition the proposed controller is used to calculate the duty cycle and can quickly reach the convergent condition the dynamic error φ1 is used to identify the boost mode or the buck mode from the desired voltage and the instantaneous voltage the bisection approach algorithm then regulates the duty cycle when the condition φ2 ε is met the controller remains unchanged where ε 10 1 is the tolerance error the output voltages are obtained using dc voltage sensors until the operating conditions change significantly the proposed controller continually performs bbc control 4 experiment results and discussion the proposed practical tracking controller was designed and tested on a pc pentium iv 2 4 ghz with 480 mb ram and matlab software mathworks inc natick massachusetts and labview graphical programming national instruments corporation austin texas u s a prototype underwater vehicle with two dc thrusters 48vdc was used for testing with the relevant specific parameters as shown in table 1 feasibility tests and practical tests were used to validate the proposed controller as detailed below 4 1 feasibility tests the proposed control procedure consists of three stages a the first stage where the voltage detector extracts dynamic errors to identify the operating state in boost mode or buck mode using equation 23 b the second stage where the bisection approach algorithm is used to adjust the duty cycle to reach the desired voltage using equations 27 and 28 and c the third stage where the controller maintains current operation at the desired voltage the discrete dynamic errors φ1 and φ2 are calculated using equation 23 with system parameters a and b when the system parameters are selected subject to a 1 00 0 and b 0 50 0 the dynamic errors are bounded within limited ranges to reduce the tracking time and switching operations the selected system parameters are used to model self synchronization error formulation for boost mode operation as the armature voltage increases when the step varies from 24vdc 32vdc the proposed controller tracks the desired voltages until it reaches the convergence condition as shown in fig 7 a for the same initial voltage 24vdc the dynamic errors versus the switch number are shown in fig 7 b positive values mean that the controller is operated in boost mode the test results indicate that the dynamic errors decrease gradually and the convergence condition is guaranteed this takes less than 10 switching operations therefore the input voltage v in is regulated to raise the voltage level by switching the duty cycle of the dc dc converter as shown in fig 7 c for buck mode operation as the armature voltage decreases when the step varies from 32vdc 24vdc the test results for tracking the desired voltages are shown in fig 7 d for the initial voltages from 32vdc to 26vdc the plots of the dynamic errors versus the switch number are shown in fig 7 e negative values mean that the controller is operated in buck mode the test results show that the dynamic errors gradually approach to zero this also takes less than 10 switching operations v in is then regulated to decrease the voltage level by switching the duty cycle of the dc dc converter as shown in fig 7 f these tests show that the proposed controller can operate in both boost or buck modes there is a fast calculation and operation under steady conditions is guaranteed for real time applications 4 2 practical tests and discussion the graphic user interface for the prototype control system uses labwiew graphical programming as shown in fig 8 the self synchronized practical tracking algorithm consists of the self synchronization error formulation the bisection approach algorithm and the buck boost converter control algorithm the related parameters for the control system are set as shown in table 1 this can be used to control bilateral propellers for on line real time analysis these experimental results show that the proposed controller offers a promising solution for step varying voltages for a reference dc thruster armature voltages increase with time variation from 12vdc 25vdc were used to validate the effectiveness of the proposed controller another could quickly track the desired voltages in each step change that corresponded to the reference operating conditions as shown in fig 8 practical tracking control means that the changes in the desired voltages and the proposed controller require less than 10 switching operations to regulate another s armature voltages as the voltage gradually increases the controller follows the reference with the δd using equation 28 for boost mode conversely the δd is used for buck mode when the convergence condition is guaranteed the bilateral propellers maintain the same operating conditions the proposed controller slightly adjusts or remains unchanged before the condition changes as shown by the red dashed line in fig 8 fig 8 shows the practical tests demonstrated in the swimming pool of national kaohsiung marine university cijin branch kaohsiung city a power supply and communication cables are attached to the vehicle the control commands are assigned along a communication cable between a laptop and an embedded processor the vehicle is also equipped with environmental sensors such as a pressure sensor for depth gauging and a digital accelerometer for motion detection users can remotely operate the underwater vehicle by a joystick for the depth control experiments the vehicle slowly dives with increasing armature voltages in station keeping operation in a 1 76m diving depth as shown in fig 9 a it maintains an armature voltage of 25vdc a duty cycle of 0 5980 and a rotor speed of 861 rpm given a swing disturbance the vehicle quickly recovers station keeping operation as shown in fig 9 b 9 h the experimental tests confirm that the proposed controller can maintain stable operation in varying environmental conditions some algorithms have also been proposed about practical tracking control such as the incremental conductance method control icmc and pid controllers wang et al 2011 singhal and padhee 2012 kwon et al 2009 verma et al 2012 using dc dc or dc ac converters in energy utilization for bdcms and induction motors can be achieved using an icmc the switching operation requirement for icmc depends on the changes in the incremental voltage δv using a smaller δv to track the desired voltage results in smaller errors than in the desired voltage but the switching number increases however a large δv allows for the rapid tracking of the desired voltage but it can easily result in a perturbation or oscillation chattering phenomenon around the desired operating point which leads to an unexpected loss and on off switching for an initial voltage of 12 v and the incremental voltage δv 0 5 v fig 10 shows the experimental results of the tracking voltage versus tracking time it can be seen that the icmc required less than 30 tracking cycles and took average computing time 7 s in addition a pid controller is also used in this control application however a pid controller without optimal control parameters has large overshoot and oscillation response which results in increased setting time to achieve the steady state value the ziegler nicholas based tuning rule is used to tune the control parameters including proportional integral and derivative gains the optimal control parameters k p 0 5 k i 1 k d 3 can minimize the overshoot phenomenon and improve transient response as shown in fig 10 in practical tests the proposed controller is feasible and stable for bilateral propellers dynamic control for the variations in step responses it can be observed that the proposed method is superior to icmc and pid controller in tracking cycles less than 10 cycles and computing time average time 3 s 5 conclusion this study proposes a self synchronization practical tracking controller for the dynamic control of bilateral propellers for an underwater vehicle for depth control and operations under stable and swing conditions the proposed practical tracking controller gives promising results in terms of fast calculation and rapid tracking of the desired voltage and guaranteed station keeping in real time applications if there are variations in the step responses the proposed controller takes less than 10 switching operations and improves perturbation and oscillation around the desired operating point in transient time therefore the tracking time and the number of switching operation required are both reduced in addition the proposed control algorithm is easy to implement on a laptop pc based control a programmable micro controller or an embedded system the efficiency of the proposed prototype vehicle is validated for operating under station keeping conditions and swing disturbances in future works the propulsion system could comprise four thrusters two arranged in the horizontal plane and two in the vertical plane which allows for complex motion control in applications for autonomous underwater vehicles auv operations acknowledgement this work is supported in part by the national science council of taiwan under contract number most 104 2221 e 022 004 most 105 2221 e 022 011 duration august 1 2015 july 31 2017 appendix a supplementary data the following are the supplementary data related to this article vid 1 vid 1 vid 2 vid 2 vid 3 vid 3 appendix a supplementary data supplementary data related to this article can be found at https doi org 10 1016 j oceaneng 2017 12 073 
23642,this paper proposes the station keeping control for an underwater vehicle keeping balance motions and performing accurate manipulations in underwater inspections in order to control position and maintain bilateral balance in deep water a controller is designed with a sprott system based self synchronization error formulation and a bisection approach algorithm to enhance the performances of brushless dc motors a sufficiently high but not exceeding metacentric height gm is designed for the proposed underwater vehicle depth control with a pressure sensor is carried out depth gauge to determine the operated voltages using the voltage control mode the practical tracking controller can maintain the same dynamics for bilateral propellers uncertainty dynamic parameters cannot be precisely modeled in a vehicle and another one can track the pre specified dynamic responses of a reference model it keeps the bilateral propeller balancing operations by close loop controlling the duty ratios of a buck boost converter in contrast with the incremental conductance based controller and pid controller the proposed bilateral propellers controller is used to demonstrate the superior performances in depth and station keeping tests operating with armature voltages of 0 30 vdc and rotor speeds of 0 900 rpm in 0 3 m diving depth keywords self synchronization error formulation bisection approach algorithm metacentric height gm practical tracking controller bilateral propellers 1 introduction recently underwater vehicles are widely used for oceanographic research commercial tasks and military missions including hull and harbor inspection pollution surveillance underwater salvage and autonomous navigation observation class vehicles with specific sensors such as autonomous underwater vehicles auvs or remotely operated vehicles rovs can dive into a deep sea environment to make detailed maps of the seafloor measure the concentration of various compounds and capture images using an underwater camera miller et al 2010 bingham 2008 he et al 2011 if the underwater vehicle has a station keeping function it can maintain balance motion navigate accurately and perform accurate manipulations for underwater inspections miller et al 2010 donovan 2012 an important issue in a marine propulsion system is a propeller that generates thrust and overcomes water resistance in addition its motion will be affected by current forces hydrodynamics and pressure a vehicle swing frequency is affected by the separation distance between the center of gravity g and the center of buoyancy b any rotational motion around the center of b immediately sets up a restoring moment arm the fleet type submarine chapter 5 the restoring moment is proportional to distance gm i e the distance between the g of the vehicle and its metacenter m which is called the metacentric height mh each vehicle was designed with a large mh to ensure safety against the overturning of a floating body the mh is a measurement of a floating body s initial static stability a sufficient distance that does not exceed gm was determined for the design of the underwater vehicle for an underwater vehicle or a submarine the surrounding tank is submerged and stable the stable equilibrium always has the g below the b and both are in the same vertical line as shown in fig 1 a this study aims to design a vision servo vehicle to enable underwater station keeping stability for applications such as sea pipeline exploration geological exploration and reservoir investigation the proposed underwater vehicle is employed with respect to the desired distance measurement in addition the voltage and thrust characteristics of each thruster in a thruster pair will not be identical as they operate over time therefore a pressure sensing system and a close loop control algorithm were used to mitigate thrust imbalance effects in an uncertain marine environment an underwater vehicle consists of several components a vehicle hull thrusters a camera lights sensors depth gyroscope and accelerometer a power source ac dc and dc dc converter and a control system blue ray team rov team 2012 as shown in fig 1 b the laptop communicates with the control system via an ethernet protocol and a wireless router the propulsion system comprises two dc brushless thrusters model 260 tecnadyne inc that are arranged vertically to allow for diving and depth and motion controls a pressure transducer p51 ssi technologies inc is used to measure the depth under the waterline a brushless type motor is commonly used to enhance the performance of the motor a gearbox reduces the rotational speed improves torque and significantly reduces power consumption blue ray team the gear train consists of a planetary gear with a reduction gearbox ratio fitted directly to the output end of the motor previous studies fossen 1994 thor et al 2000 have proposed different methods to control a dc motor such as voltage control current control or torque control therefore a high efficiency motor controller is used to regulate the armature voltage depending on the output loading the propulsion components of electric vehicles such as brushless dc motors bdcm perform better than brushed dc motors and induction motors and are widely used in industrial applications because of their simple structure fast response high power density high reliability and low maintenance requirements pan and luo 2005 wang et al 2011 to achieve good performance a proportional integral differential pid controller is commonly used for this application wang et al 2011 singhal and padhee 2012 artificial intelligence ai methods such as fuzzy controllers cao and cao 2009 artificial neural networks ann based controllers pan and luo 2005 wlas et al 2005 bose 2007 differential geometric based non linear controllers huang et al 2009 and sliding mode controllers haddoun et al 2006 are also employed in electric vehicles the fuzzy and ann methods cao and cao 2009 wlas et al 2005 bose 2007 have high computational capability for the controller however it is essential to consider the various uncertainty conditions to design an adaptive model based controller with improved performance when proposing a station keeping control the proposed self synchronized practical tracking controller tracks the dynamic responses of a reference model a chaotic system cs such as the sprott system comprising a master system ms and a slave system ss kuo 2007 chen et al 2007 2013 pisarchik and ruiz oliveras 2010 kuo et al 2013 is a simple structure to design a self synchronization error formulation a coupling dynamic variable is used so that the response of the ss can automatically track the response of the ms to trace the bdcm voltage changes in real time signals this is represented using straightforward mathematical formulations and it provides rapid solutions in deep water self synchronized practical tracking maintains the same dynamics for bilateral propellers then the bisection approach algorithm is employed to control the duty ratios of a buck boost converter bbc under step up and step down conditions the proposed controller can quickly regulate the control signal to switch the duty ratio of the bbc for an estimated operating point its manipulation can eliminate the chattering phenomenon and allow for good station keeping and steady motion for deep water tasks for an active vehicle the proposed controller needs to utilize a digital signal processor dsp a field programmable gate array fpga a chip or an application specific integrated circuit chip bose 2007 which provides control procedures to achieve good performance at present high level chips have advanced vlsi technology and its support built in functions have improved the execution speed in this study the sprottcsbased self synchronization error formulation and bisection approach algorithm were designed as a microcomputer based controller in an embedded system the intelligent mobile vehicle could track the pre specified dynamic responses of a reference model and maintain the same dynamics for bilateral propellers in a simulation model of an underwater vehicle the dynamic tests show that the proposed method has good computational efficiency this paper is organized as follows section 2 describes the electromechanical propulsion system and section 3 describes the implementation of a practical tracking controller in sections 4 and 5 the experimental results and conclusions are given to show the efficiency of the proposed controller 2 an electromechanical system for an underwater vehicle 2 1 dc electromechanical system a dc electromechanical system comprises electrical and mechanical components as shown in fig 2 it can be used for robotic controls computer taps and disk drive position controls propeller controls and underwater vehicle control a magnetic field is produced by stationary permanent magnets pm or a stationary electromagnet in servo applications the dc motor is used in the linear range of the magnetization curve therefore the field flux φ is proportional to the field current i f that is φ i f the torque t m of the motor is proportional to the armature current i a and its back electromotive force emf is also proportional to speed nise 2004 the relation between the armature current i a applied armature voltage e a and back emf v b is found using a loop equation around the laplace transformed armature circuit 1 r a i a s l a s i a s v b s e a s 2 t m s k m i a s v b s k b s θ m s wherein k m is the motor torque constant and k b is the back emf constant by substituting equation 2 into 1 3 r a l a s t m s k m k b s θ m s e a s at the steady state condition the term l a st m s instantly disappears and equation 3 transforms as follows 4 r a k m t m s k b s θ m s e a s taking the inverse laplace transform equation 4 becomes 5 r a k m t m t k b ω m t e a t if a dc voltage e a is applied the motor operates at a constant angular velocity ω m with a constant torque t m therefore the motor operates at a steady state with a dc voltage input nise 2004 6 r a k m t m k b ω m e a t m k m k b r a ω m k m r a e a the stall torque t stall and the no load speed ω no load are derived using equation 6 7 t m 0 ω n o l o a d 1 k b e a ω m 0 t stall k m r a e a the electrical constants k m r a and k b are determined from a dynamometer test of a motor for a given e a as shown in fig 3 since the flux in a pm motor is fixed or constant the speed torque and current torque characteristics are straight lines the speed torque characteristics of a pm motor are controlled by changing either the armature voltage or the resistance of the armature circuit the objective is to control the armature voltage e a of dc motor using the proposed controller 2 2 motor voltage control a dc motor control model can be described as a motor armature voltage control b motor armature current control or c motor torque control the motor s torque is controlled by means of motor currents voltages and motor fluxes the dynamics of the electrical part of the electromechanical system are usually faster than the propeller shaft dynamics for a small propeller the time constant of the electrical and mechanical system can be comparable let us assume that the rotational speed can be reduced via a gearbox thus the gearbox ratio is chosen as 1 under a normal assumption for a dc motor dynamic nise 2004 as 8 r a k m t m t k b ω m t e a t r a i a t k b ω m t e a t j m d d t ω m t t m t t l k m i a t t l where ω m t is the propeller angular velocity rad sec t l is the load from the propeller and j m is the rotor moment of inertia the speed dynamics are obtained using the motor voltage control as fossen 1994 9 j m d d t ω m t k m k b r a ω m t k m r a e a t t l the term k m r a e a t is the control input and the term k n k m k b r a is the linear damping in practice unsteady flow such as cavitation in and out of water effects and a wave influenced boundary layer effect affects the propeller s thrust and torque thrust t and torque t l can be represented as ghasseni and ghadimi 2011 kim et al 2009 10 t ρ d p 4 k t j ω ω 11 t l ρ d p 5 k l j ω ω wherein ρ is the water density freshwater 1000 kg m3 saltwater 1025 kg m3 d p is the propeller diameter m j is the advance ratio with tangent speed u and ω is the angular velocity pivano 2008 12 j 2 π d p ω 1 ω f u the advance speed is very difficult to measure and an estimated speed is computed using the term 1 ω f u where ω f is the wake fraction number and is determined by experimental tests for an underwater vehicle the parameters k t and k l of open water vehicles are considered to have a linear relationship in advance ratio j they are approximated as lewis 1988 ittc 2002a ittc 2002b 13 k t α 1 j α 2 14 k l β 1 j β 2 where parameters α 1 α 2 β 1 and β 2 are non dimensional constants the propeller characteristics are determined by experimental testing with a propeller a least squares curve fit is used to estimate the parameters k t and k l therefore the load torque t l can be expressed as 15 t l ρ d p 5 β 1 j 2 β 2 j ω ω therefore it is possible to simulate an underwater vehicle for a given operating condition for different supply voltages a set of parallel speed torques can be obtained to match the load 3 practical tracking controller 3 1 self synchronization error formulation if a physical system does not deviate from the nominal operating conditions then a controller acts to handle the nonlinearity in small or large operating ranges according to the desired dynamic behaviors the so called practical tracking concept over limited time intervals a dynamic plant requires adequate tracking control to achieve pre specified dynamic behaviors such as mobile robotic navigation a car towing multiple trailers path tracking a spacecraft or a ship in this study a tracking control problem for an underwater vehicle system is proposed for tracking applications chaos synchronization systems such as lorenz rossler and sprott systems are used in adaptive control systems gyro motion controls and secure optical communication systems kuo 2007 chen et al 2007 2013 pisarchik and ruiz oliveras 2010 kuo et al 2013 whose dynamic behaviors can mimic others and synchronization is achieved for different time varying unknown parameters therefore to achieve synchronization between a master system ms and a slave system ss the ss follows the states of the ms by using reference information this means that the trajectories of the system converge to the same states as the other and they remain in step with each other in this study the sprott system x r 3 and y r 3 is used and its dynamical equation is given by 16 master system ms x a m x f x a m x 2 sign x 1 m 17 slave system ss y a s y f y a s y 2 s i g n y 1 s wherein x x 1m x 2m x 3m t y y 1s y 2s y 3s t and matrices a m or a s are 3 3 systems 18 a m a s 0 1 0 0 0 1 1 2 b a 19 s i g n δ 1 i f δ 0 1 i f δ 0 wherein δ x 1m or δ y 1s and sign δ is the signum function when tracking the dynamic errors the error variables are defined as e 1 x 1m y 1s e 2 x 2m y 2s e 3 x 3m y 3s and e e 1 e 2 e 3 t x 1m y 1s x 2m y 2s x 3m y 3s t the components x and y synchronize only if e 0 without considering the initial conditions in y which synchronize with x over a limited time interval by subtracting 17 from 16 the error system 20 can be expressed by the following relation 20 e 1 e 2 e 3 0 1 0 0 0 1 1 2 b a e 2 0 0 s i g n x 1 m s i g n y 1 s its purpose is to drive the system state to the desired objective and the variables x 1m and y 1s are simultaneously positive voltage in this study so f x f y 0 the last two equations form a linear system that is decoupled from the variable e 1 with the form 21 e 2 e 3 0 1 b a e 2 e 3 a e the polynomial p a λ is termed the characteristic equation of a and the real or complex eigenvalues are defined as 22 p a λ λ 2 a λ b 0 λ 1 2 a 1 2 a 2 4 b if the system parameters a 0 and b 0 the negative eigenvalues are easily determined and the robust asymptomatic stability of the system 21 is guaranteed for the sprott system computation discrete time master and slave systems are used as shown in fig 4 for discrete signals discrete variables x 1m v m1 i x 2m v m2 i and x 3m v m3 i i 1 2 3 n are a data sequence obtained from the desired voltage v m and discrete variables y 1s v s1 i y 2s v s2 i and y 3s v s3 i are a data sequence obtained from the instantaneous voltage or measurement voltage v s where n is the switch number of the buck boost convert the first term of the error system 21 is used to track the dynamic errors between the desired voltage and the instantaneous voltage if the error variables are e 1 i v m1 i v s1 i e 2 i v m2 i v s2 i e 3 i v m3 i v s3 i the discrete error equation self synchronization error dynamics is denoted as 23 φ φ 1 φ 2 e 2 i a b s 1 2 e 1 i b e 2 i a e 3 i equation 23 as a voltage detector is used to determine dynamic errors that are zero or have bounded ranges the dynamic error φ is used to extract the relevant variations from the desired voltage and the instantaneous voltage φ1 0 for the boost mode or for the buck mode a bisection approach algorithm is used to regulate the output voltage of the buck boost converter at each switching step i 1 2 3 n the method divides the interval in two by computing the mid voltage v m v s1 i 2 as shown in fig 4 b if the desired voltage v m and the initial voltage v s1 1 v s are estimated each switch has the following steps step 1 set the parameters of ms v m1 i v m2 i v m3 i v m i 1 2 3 n step 2 calculate the mid voltage v mid v m v s1 i 2 and the set the parameters of ss v m1 i v m2 i v m1 i v m3 i 2 v m3 i v mid i 1 2 3 n step 3 set the next initial parameter v m1 i 1 v m3 i step 4 calculate the φ2 if the convergent condition φ2 ε then fix the desired voltage 3 2 buck boost converter bbc control the basic configuration of a buck boost converter bbc is shown in fig 4 an inductor l and a capacitor c comprise a low pass filter and the feedback circuit is formed with resistors r 1 and r 2 its improvement structure has four switches to control the boost mode m p1 on m n1 off switch m p2 and m n2 and the buck mode m p2 on m n2 off switch m p1 and m n1 the following four functions are required to estimate 1 input voltage range v in v in min and v in max 2 desired voltage v m 3 maximum desired current i m and 4 switch sequences for boost and buck modes instruments 2012 sahu and rincón mora 2005 liou et al 2008 these must be estimated because some parameters are known so the power stage can be calculated varying the duty cycle of the switching time regulates the output voltage and the current of a bbc during the turn off time t off and the turn on time t on the duty cycle of the control signal is defined as 24 d t on t on t off t on t d the operating parameters of the bbc are used to estimate the duty cycle d buck for the buck mode and the duty cycle d boost for the boost mode as 25 d buck η v m v in 26 d boost 1 η v in v m where η is the estimated efficiency v m is the desired output voltage of the bbc and v in is the input voltage for buck mode and boost mode v in min v in v in max the converter also operates at the extremes of its maximum and minimum operating range v m min v m v m max the duty cycle is always positive and less than 1 this study uses a converter as a dc step up and steep down transformer which regulates voltages by switching the duty cycle d using equation 27 27 d i d i 1 δ d 28 δ d η δ v v m δ v v s 1 i v m 2 f o r b u c k mode δ v v m v s 1 i 2 f o r b o o s t mode where i 1 2 3 n is the switching number therefore v m is the desired voltage since the instantaneous voltage v s slowly rises or falls according to the measurement for a reference desired voltage the instantaneous voltages of another can be regulated by using the increment or decrease in the duty cycle δd 3 3 implementation of practical tracking controller fig 5 shows the block diagram of the bilateral propeller dynamic control model 260 tecnadyne inc rated voltage 48vdc rated depth 800 m for an underwater vehicle the high speed low inertia motor is coupled to a 6 1 ratio planetary gear set that is assembled with hardened high precision spur gears for voltage regulation to the brushless dc motors bdcms for the appropriate duty cycle the bilateral output approaches a desired voltage level the desired voltage is determined by depth control using a pressure sensor p51 ssi technologies inc as a depth gauge as shown in fig 6 wherein the estimated water depth h v h can be described as h v h 2 599 v h 1 520 and v h is the measurement voltage of the pressure transducer the controller of the dc brushless thruster accepts 5 vdc of analog speed and a direction control signal that can be supplied via a laptop with a digital analog card or a simple joystick however a vehicle s motion is affected by the current forces hydrodynamics and underwater pressure in practical operation for a reference desired voltage v m another measures the output voltage v s when its voltage is lower than the desired voltage and the controller turns on the step up voltages otherwise it turns on the step down voltages using pulse width modulation pwm a bisection approach algorithm is used to regulate the output voltage of a bbc this is accomplished by using a fixed switching frequency and varying the duty cycles the switching noise is filtered using an inductor and a capacitor a pwm uses a digital controller and performs on off switching from a few kilohertz khz to several kilohertz this produces less power loss in the switching devices in addition the proposed controller is used to calculate the duty cycle and can quickly reach the convergent condition the dynamic error φ1 is used to identify the boost mode or the buck mode from the desired voltage and the instantaneous voltage the bisection approach algorithm then regulates the duty cycle when the condition φ2 ε is met the controller remains unchanged where ε 10 1 is the tolerance error the output voltages are obtained using dc voltage sensors until the operating conditions change significantly the proposed controller continually performs bbc control 4 experiment results and discussion the proposed practical tracking controller was designed and tested on a pc pentium iv 2 4 ghz with 480 mb ram and matlab software mathworks inc natick massachusetts and labview graphical programming national instruments corporation austin texas u s a prototype underwater vehicle with two dc thrusters 48vdc was used for testing with the relevant specific parameters as shown in table 1 feasibility tests and practical tests were used to validate the proposed controller as detailed below 4 1 feasibility tests the proposed control procedure consists of three stages a the first stage where the voltage detector extracts dynamic errors to identify the operating state in boost mode or buck mode using equation 23 b the second stage where the bisection approach algorithm is used to adjust the duty cycle to reach the desired voltage using equations 27 and 28 and c the third stage where the controller maintains current operation at the desired voltage the discrete dynamic errors φ1 and φ2 are calculated using equation 23 with system parameters a and b when the system parameters are selected subject to a 1 00 0 and b 0 50 0 the dynamic errors are bounded within limited ranges to reduce the tracking time and switching operations the selected system parameters are used to model self synchronization error formulation for boost mode operation as the armature voltage increases when the step varies from 24vdc 32vdc the proposed controller tracks the desired voltages until it reaches the convergence condition as shown in fig 7 a for the same initial voltage 24vdc the dynamic errors versus the switch number are shown in fig 7 b positive values mean that the controller is operated in boost mode the test results indicate that the dynamic errors decrease gradually and the convergence condition is guaranteed this takes less than 10 switching operations therefore the input voltage v in is regulated to raise the voltage level by switching the duty cycle of the dc dc converter as shown in fig 7 c for buck mode operation as the armature voltage decreases when the step varies from 32vdc 24vdc the test results for tracking the desired voltages are shown in fig 7 d for the initial voltages from 32vdc to 26vdc the plots of the dynamic errors versus the switch number are shown in fig 7 e negative values mean that the controller is operated in buck mode the test results show that the dynamic errors gradually approach to zero this also takes less than 10 switching operations v in is then regulated to decrease the voltage level by switching the duty cycle of the dc dc converter as shown in fig 7 f these tests show that the proposed controller can operate in both boost or buck modes there is a fast calculation and operation under steady conditions is guaranteed for real time applications 4 2 practical tests and discussion the graphic user interface for the prototype control system uses labwiew graphical programming as shown in fig 8 the self synchronized practical tracking algorithm consists of the self synchronization error formulation the bisection approach algorithm and the buck boost converter control algorithm the related parameters for the control system are set as shown in table 1 this can be used to control bilateral propellers for on line real time analysis these experimental results show that the proposed controller offers a promising solution for step varying voltages for a reference dc thruster armature voltages increase with time variation from 12vdc 25vdc were used to validate the effectiveness of the proposed controller another could quickly track the desired voltages in each step change that corresponded to the reference operating conditions as shown in fig 8 practical tracking control means that the changes in the desired voltages and the proposed controller require less than 10 switching operations to regulate another s armature voltages as the voltage gradually increases the controller follows the reference with the δd using equation 28 for boost mode conversely the δd is used for buck mode when the convergence condition is guaranteed the bilateral propellers maintain the same operating conditions the proposed controller slightly adjusts or remains unchanged before the condition changes as shown by the red dashed line in fig 8 fig 8 shows the practical tests demonstrated in the swimming pool of national kaohsiung marine university cijin branch kaohsiung city a power supply and communication cables are attached to the vehicle the control commands are assigned along a communication cable between a laptop and an embedded processor the vehicle is also equipped with environmental sensors such as a pressure sensor for depth gauging and a digital accelerometer for motion detection users can remotely operate the underwater vehicle by a joystick for the depth control experiments the vehicle slowly dives with increasing armature voltages in station keeping operation in a 1 76m diving depth as shown in fig 9 a it maintains an armature voltage of 25vdc a duty cycle of 0 5980 and a rotor speed of 861 rpm given a swing disturbance the vehicle quickly recovers station keeping operation as shown in fig 9 b 9 h the experimental tests confirm that the proposed controller can maintain stable operation in varying environmental conditions some algorithms have also been proposed about practical tracking control such as the incremental conductance method control icmc and pid controllers wang et al 2011 singhal and padhee 2012 kwon et al 2009 verma et al 2012 using dc dc or dc ac converters in energy utilization for bdcms and induction motors can be achieved using an icmc the switching operation requirement for icmc depends on the changes in the incremental voltage δv using a smaller δv to track the desired voltage results in smaller errors than in the desired voltage but the switching number increases however a large δv allows for the rapid tracking of the desired voltage but it can easily result in a perturbation or oscillation chattering phenomenon around the desired operating point which leads to an unexpected loss and on off switching for an initial voltage of 12 v and the incremental voltage δv 0 5 v fig 10 shows the experimental results of the tracking voltage versus tracking time it can be seen that the icmc required less than 30 tracking cycles and took average computing time 7 s in addition a pid controller is also used in this control application however a pid controller without optimal control parameters has large overshoot and oscillation response which results in increased setting time to achieve the steady state value the ziegler nicholas based tuning rule is used to tune the control parameters including proportional integral and derivative gains the optimal control parameters k p 0 5 k i 1 k d 3 can minimize the overshoot phenomenon and improve transient response as shown in fig 10 in practical tests the proposed controller is feasible and stable for bilateral propellers dynamic control for the variations in step responses it can be observed that the proposed method is superior to icmc and pid controller in tracking cycles less than 10 cycles and computing time average time 3 s 5 conclusion this study proposes a self synchronization practical tracking controller for the dynamic control of bilateral propellers for an underwater vehicle for depth control and operations under stable and swing conditions the proposed practical tracking controller gives promising results in terms of fast calculation and rapid tracking of the desired voltage and guaranteed station keeping in real time applications if there are variations in the step responses the proposed controller takes less than 10 switching operations and improves perturbation and oscillation around the desired operating point in transient time therefore the tracking time and the number of switching operation required are both reduced in addition the proposed control algorithm is easy to implement on a laptop pc based control a programmable micro controller or an embedded system the efficiency of the proposed prototype vehicle is validated for operating under station keeping conditions and swing disturbances in future works the propulsion system could comprise four thrusters two arranged in the horizontal plane and two in the vertical plane which allows for complex motion control in applications for autonomous underwater vehicles auv operations acknowledgement this work is supported in part by the national science council of taiwan under contract number most 104 2221 e 022 004 most 105 2221 e 022 011 duration august 1 2015 july 31 2017 appendix a supplementary data the following are the supplementary data related to this article vid 1 vid 1 vid 2 vid 2 vid 3 vid 3 appendix a supplementary data supplementary data related to this article can be found at https doi org 10 1016 j oceaneng 2017 12 073 
23643,in order to realize three dimensional stable control of underactuated autonomous underwater vehicles auvs this study analyses nonlinear hydrodynamic characteristics of auvs based on the mathematical taylor series the nonholonomic control system properties of auvs are investigated using nonholonomic system theory under three dimensional control input the constraint of underactuated auvs is proved not to be integrated by the local integrability theorem and the controllability of underactuated auvs is verified through small time local controllability stlc in order to simplify the trigonometric terms in underactuated auv motion functions quaternion theory is applied to transform the function to develop a continuous time varying controller results of a simulation experiment show that this control law is effective in achieving three dimensional stabilization from arbitrary initial positions keywords underactuated autonomous underwater vehicles three dimension stabilization control quaternion nonholonomic system 1 introduction underactuated auvs are designed so that the number of dimensions of independent control inputs is less than the number of degrees of freedom wang et al 2010 the point of stabilization of an underactuated auv is also known as stabilization control which is a control input that drives the auv from a given initial position to the designated target position and orientation and stabilizes it in that configuration the difficulty of designing underactuated auvs is that these systems have nonholonomic constraints that are inconsistent with the necessary conditions of the brocket theorem yan 2009 thus there is no feedback from a smooth time invariant state to the controller that would cause the auv to stabilize at the equilibrium point hence linear control theory cannot be used directly to solve the stabilization of underactuated auvs some researchers have investigated stabilization control of underactuated auvs but they have focused basically on two dimensional issues aguiar and pascoal 2001 designed a time invariant non continuous self adaptive controller considering the uncertainty of model parameters the kinematics model was first converted into a polar coordinate system through coordinate transformation a smooth time invariant controller was then designed using the backstepping method and the lyapunov method in the new polar coordinate system to realize the stabilization of underactuated auvs in two dimensional horizontal positions and orientations for different initial conditions sankaranarayanan et al 2003 developed a switching controller to make an auv move from an arbitrary initial state to the origin in a horizontal plane they mainly used a switch of states and control input to decompose the system model into several subsystems they then stabilized these subsystems in an orderly manner using proper controllers with respect to their characteristics in order to stabilize the position and orientation of the whole system at the origin this method was proposed based on the assumption that the subsystems involved are stable before stabilization control and are independent of previous stages this method can only be used in two dimensional cases tian and li 2001 constructed a smooth time invariant feedback controller for a general model of a nonholonomic system which can ensure global exponential convergence of the system the motion equations of a two dimensional auv were transformed from one model to another and a stabilization controller was designed however the model must be in a specific form in order to apply this method and its motion function must also be changed because it is difficult to achieve a chain structure for spatial motion equations with six degrees of freedom aguiar and pascoal 2002 used a diffeomorphic method to change the horizontal motion equation of an auv into a second order system and proposed a continuous time varying smooth mixed controller a simulation of horizontal motion was conducted according to the assembly of preset systematic dynamics states the results showed that an auv could be stabilized in a small zone near the target location however due to the existence of a swing speed the speed drift term of the second order system is not in the control input vector field making the actual stabilization path difficult to predict aguiar et al 2007 proposed a stabilization method for nonlinear systems with disturbances using mixed control and introduced a stable or unstable transfer system and an interactive transfer system the second order system was obtained through changing the motion equations the time varying differential controller was designed using interactive control and a stabilization simulation for horizontal auv motion was performed the simulation results realized convergence of auv location as the heading angle tended to the design value however there was turbulence exists in the longitudinal position due to the fact that the heading angle was not completely stable at a value of zero leonard 1995 developed an open loop control synthesis method based on a kinematic method for underactuated auvs and applied this synthesis method to achieving self adaption of control authority in order to verify its effectiveness two operations were executed one took the roll angle and pitch angle as control inputs in order to realize yaw the other was an auv mooring operation the experimental results verified the feasibility of using the roll angle and pitch angle as control inputs to achieve yaw nevertheless only the kinematic model was considered without any dynamic equations of motion most existing research concentrates on designing two dimensional stabilization of underactuated auvs however the actual motions of auvs are three dimensional because equations of motion under three dimensional conditions exhibit significant nonlinearity and coupling it is difficult to establish a smooth controller in these cases hence research on three dimensional stabilization control is rare in the present paper nonlinear dynamics physical constraints and constraint integrability and controllability of a dynamic model system for underactuated auvs are analyzed the equations of spatial motion for an auv are transformed using quaternions and thus a continuous time varying controller is proposed the convergence of this controller is then verified by introducing formal functions pettersen and egeland 1997 in order to realize three dimensional stabilization control of underactuated auvs at arbitrary positions simulation results show that the developed controller is effective 2 materials and methods 2 1 general dynamics equation underactuated auvs generally use propeller rudder wing forms so external forces consist only of an axial propulsion force x trimming moment m and yawing moment n if the influence of external currents and waves is considered an additional disturbing force τ b can be obtained from the following dynamic equation feng 2010 1 m v c v v d v v g η τ τ b where m r 6 6 is the inertial matrix of the auv including additional mass c v r 6 6 is its coriolis force matrix d v r 6 6 is its fluid damping matrix and g η r 6 1 is its resilience matrix which is generated by gravity and buoyancy τ r 6 1 is the force matrix induced by the propeller and τ b is disturbing force matrix the additive kinematic equation is 2 ξ j η v the overall external forces and orientation can be obtained from this equation feng 2010 because only three degrees of freedom have control inputs in real auv motion the six degree of freedom dynamic equation can be simplified as 3 m a v c a v v d a v v g a η τ m u v c u v v d u v v g u η 0 ξ j η v where a indicates the driven system and u is the underactuated system control inputs along the axial trimming and heading directions are contained in the first equation the second equation represents underactuated motion in the horizontal vertical and roll directions 2 2 the nonlinear dynamic nature of underactuated auvs an underactuated auv is a hull rudder propeller system and its hydrodynamic function can be expressed using parameters of underwater vehicle motion 4 f f v v ω ω δ δ n where v is the vehicle speed ω is its angular velocity δ is the rudder angle and n indicates the rotational speed of the propeller the general hydrodynamics expression can be obtained according to the taylor series expansion taking straight sailing with constant speed in a balanced state as an example the taylor series is expanded to three orders therefore the force in the y direction is 5 y f y u v r u v r δ y 0 y u δ u y v v y r r y u u y v v y r r y δ δ 1 2 y u u δ u 2 y v v v 2 y r r r 2 y δ δ δ 2 2 y u v δ u v 2 y u r δ u r 2 y u δ δ u δ 2 y v r v r 2 y v δ v δ 2 y r δ r δ 1 3 y u u u δ u 3 y v v v v 3 y r r r r 3 y δ δ δ δ 3 3 y u u v δ u 2 v y v v r v 2 r from eq 5 it is clear that a significant coupling i e significant nonlinearity exists in terms of forces for an underactuated auv during the actual modelling process the kinematic mathematical models of an underactuated auv are not strictly accurate especially when terms are simplified and many factors are neglected the complexity of the kinematic mathematical auv model is mainly manifested in high nonlinearity and coupling of hull viscous hydrodynamics control inputs force matrix and external interference high nonlinearity in terms of viscous hydrodynamics can be seen from the forces in the y direction that simulate the operational motion of an auv therefore nonlinear terms multivariate taylor series of three orders should be considered and linear processing is effective only when executed in a small region near the origin underactuated auvs feature high coupling and nonlinearity thus both the hydrodynamic coefficients and control forces in the dynamic model have uncertainty one aspect is that the hydrodynamic coefficients are difficult to estimate using theoretical methods or experimental testing another is that the force generated by the propeller and rudder correlates nonlinearly with the sailing speed of an auv and this relationship is difficult to establish using an accurate model the results of conventional propeller open water tests and rudder hydrodynamic tests differ significantly from practical application effects wang et al 2010 considering that underwater vehicles may carry different tools and equipment when performing tasks variations in loading can result in changes in auv mass center of mass center of buoyancy and hydrodynamic coefficients xuemin and yuru 2001 external interferences mainly include wind waves currents shallow water effects and bank effects in addition to these influences on system balance characteristics interferences affect the high nonlinearity and uncertainty of models for auv motion control underactuated auvs are highly nonlinear systems which involve time varying characteristics of motion complicated operational environments and uncertainty therefore nonlinearity should be considered when designing an underactuated auv control system wang et al 2010 2 3 characteristics of nonholonomic systems according to the theory of nonholonomic systems the integrability and controllability of system constraints directly affect the determination of the three dimensional tracking control strategy of underactuated auv which is the key problem of effective control the integrability analysis determines whether the auv system is complete and the controllability determines whether the system can be transferred between states they are closely related to the problem of track planning and tracking therefore it is beneficial to design the auv path tracking controller by analyzing the dynamic control characteristics of auv based on the nonholonomic system theory he ming et al 2012 actual mechanical systems can be classified into fully actuated mechanical systems and underactuated mechanical systems according to the relationship between the number of control input dimensions and the number of configuration space dimensions in terms of system constraints systems can be divided into holonomic and nonholonomic systems yan 2009 the general form of nonholonomic constraints can be expressed as 6 h i q q q q m 0 i 1 k the following lemma provides necessary and sufficient conditions for proving local integrability yan 2009 2 3 1 lemma 1 local integrability constraint equations are locally integrable when they satisfy the following conditions 1 g u η is a constant 2 c u v d u v is a constant matrix 3 the distributed ω ker c u d u j 1 η is fully integrable for an underactuated auv with a propeller rudder wing form there are control inputs with three degrees of freedom assuming that the auv s gravity and buoyancy forces are balanced the constraint equation is 7 m λ 22 v m λ 11 u r m λ 33 w p y v y v v v v 0 m λ 33 w m λ 22 v p m λ 11 u q z w z w w w w 0 i x λ 44 p λ 33 λ 22 w v i z i y λ 55 λ 66 q r k p k p p p p b g y w cos θ cos ϕ b g z w cos θ sin ϕ 0 where m λ are the mass and additional mass of the auv respectively u v w are linear velocities and p q r are angular velocities hence 8 c u d u v m λ 11 u r m λ 33 w p y v y v v v v m λ 22 v p m λ 11 u q z w z w w w w λ 33 λ 22 w v i z i y λ 55 λ 66 q r k p k p p p p it is evident from eq 8 that c u d u relates to velocity so c u d u is not a constant matrix which is inconsistent with condition 2 of lemma 1 consequently the constraint equation is proved to be non integrable moreover an underactuated auv also possesses non integrable acceleration constraints belonging to two order nonholonomic systems 2 3 2 theorem 1 let η v 0 0 which is a balance point in the equation of spatial motion with six degrees of freedom under the conditions that the control input is zero and no external interference exists no smooth time invariant feedback controller makes the system asymptotically stable near the equilibrium point he ming et al 2012 wang et al 2010 2 4 analysis of controllability the controllability concept for linear systems is extended to nonholonomic systems using a differential geometry method and the necessary conditions of small time local controllability stlc proposed by sussmann morin and samson 1995 based on the nonholonomic characteristics of underactuated auvs when determining the stlc of an underactuated auv the system is generally transformed into the following state equation chen et al 2006 9 x f x g x u where f x is the drift vector field for the nonlinear system g x is the control vector field and u is a control input 2 4 1 sussmann theorem an affine nonlinear system is small time locally controlled if it satisfies the following 1 the order condition of lie algebra and 2 all bad brackets are expressed by linear combinations of good brackets 2 4 2 theorem 2 system 10 m v c v v d v v g η τ ξ j η v is small time locally controlled at the balanced point η v 0 0 2 4 3 verification the mapping is defined as 11 f η v j η v m 1 c v v d v v g η and a vector is assumed as follows 12 g g 1 g 2 g 3 g 4 g 11 g 12 d i a g 0 0 0 1 m 11 1 m 22 1 m 66 the system can be written as 13 η v f η v g τ and this can be simplified as 14 η v f η v g 7 τ 1 g 11 τ 5 g 12 τ 6 15 f η v u cos ϕ c o s θ v cos ϕ sin θ sin φ sin ϕ cos φ w cos ϕ sin θ cos φ sin ϕ sin φ u sin ϕ c o s θ v sin ϕ sin θ sin φ cos ϕ cos φ w sin ϕ sin θ cos φ cos ϕ sin φ u sin θ v cos θ sin φ w cos θ cos φ p q sin φ tan θ r cos φ tan θ q cos φ r sin φ q sin φ cos θ r cos φ cos θ m 33 m 11 w q m 22 m 11 v r x u m 11 u m 11 m 22 u r m 33 m 22 w p y v m 22 v m 22 m 33 v p m 11 m 33 u q z w m 33 w m 33 m 22 m 44 w v m 66 m 55 m 44 q r k p m 44 p m 11 m 33 m 55 u w m 44 m 66 m 55 p r m q m 55 q m 22 m 11 m 66 u v m 55 m 44 m 66 p q n r m 66 r in order to describe the system let 16 g 0 x f η v τ 0 1 with 17 η v g 0 τ 0 g 7 τ 1 g 11 τ 5 g 12 τ 6 lie brackets in the extended vector field g 0 g 7 g 11 g 12 are calculated as 18 g 0 g 7 1 m 11 cos ϕ cos θ sin ϕ cos θ sin θ 0 0 0 x u m 11 m 11 m 22 r m 11 m 33 q 0 m 11 m 33 m 55 w m 22 m 11 m 66 v t 19 g 0 g 11 1 m 55 0 0 0 sin φ tan θ cos φ sin φ cos θ m 33 m 11 w 0 m 11 m 33 u m 66 m 55 m 44 r m q m 55 m 55 m 44 m 66 p t 20 g 0 g 12 1 m 66 0 0 0 cos φ tan θ sin φ cos φ cos θ m 22 m 11 v m 11 m 22 u 0 m 66 m 55 m 44 q m 44 m 66 m 55 p n r m 66 t 21 g 7 g 11 0 g 7 g 12 0 g 11 g 12 0 22 g 0 g 0 g 7 1 m 11 sin θ cos ϕ q cos φ r sin φ cos θ sin ϕ q sin φ cos θ r cos φ cos θ x u m 11 cos ϕ c o s θ m 11 m 22 r cos ϕ sin θ sin φ sin ϕ cos φ m 11 m 33 q cos ϕ sin θ cos φ sin ϕ sin φ sin θ sin ϕ q cos φ r sin φ cos θ cos ϕ q sin φ cos θ r cos φ cos θ x u m 11 sin ϕ c o s θ m 11 m 22 r sin ϕ sin θ sin φ cos ϕ cos φ m 11 m 33 q sin ϕ sin θ cos φ cos ϕ sin φ cos θ q cos φ r sin φ x u m 11 sin θ m 11 m 22 r cos θ sin φ m 11 m 33 q cos θ cos φ m 11 m 33 m 55 w sin φ tan θ m 22 m 11 m 66 v cos φ tan θ m 11 m 33 m 55 w cos φ m 22 m 11 m 66 v sin φ m 11 m 33 m 55 w sin φ sec θ m 22 m 11 m 66 v cos φ sec θ x u m 11 2 r 2 q 2 m 33 m 22 w m 11 m 33 m 55 w m 22 m 11 v m 22 m 11 m 66 v m 11 m 22 m 22 m 11 m 66 u v m 55 m 44 m 66 p q n r m 66 r x u m 22 r y v m 11 m 22 2 r m 11 m 22 p q m 11 m 22 u m 22 m 11 m 66 v m 11 m 33 m 11 m 33 m 55 u w m 44 m 66 m 55 p q m q m 55 q x u m 33 q z w m 11 m 33 2 q m 11 m 33 p r m 11 m 33 u m 11 m 33 m 55 w m 33 m 22 m 44 w m 11 m 22 r m 33 m 22 m 44 v m 11 m 33 q m 11 m 33 m 55 w m 66 m 55 m 44 r m 22 m 11 m 66 v m 66 m 55 m 44 q m 11 m 33 m 55 m 22 m 33 v p m 11 m 33 u q z w m 33 w m 11 m 33 m 55 u m 11 m 33 q m 11 m 33 m 55 w x u m 33 m 11 m 33 m 55 w m q m 55 m 44 m 66 m 55 p m 22 m 11 m 66 v m 22 m 11 m 66 m 11 m 22 u r m 33 m 22 w p y v m 22 v m 22 m 11 m 66 u m 11 m 33 q m 22 m 11 m 66 v x u m 33 m 55 m 44 m 66 q m 11 m 33 m 55 w n r m 66 p m 22 m 11 m 66 v lie brackets in the vector field extended from vector f and g are computed yue 2002 in sequence and the dimensions of the extended g are finally determined 23 dim g 0 g 7 g 11 g 12 g 0 g 7 g 0 g 11 g 0 g 12 g 7 g 11 10 for arbitrary η v r 6 it can be proved that the above extended vectors satisfy the control conditions of lie algebra i e the system is strongly locally reachable hence according to the sussmann theorem the equation of spatial motion with six degrees of freedom is small time locally controlled at the balance point he ming et al 2012 2 5 stabilization design based on quaternions from the analysis of the control system above the dynamic characteristics of an underactuated auv have two order nonholonomic constraints thus no smooth time invariant feedback controller makes the system asymptotically stable near the equilibrium point in order to solve this problem a continuous time varying controller is designed based on quaternion theory in this paper this requires transforming the motion model and realizes three dimensional stabilization of an underactuated auv 2 5 1 quaternion in geodetic coordinate systems and body fixed coordinate systems a given orientation is designated by φ θ ϕ and rotations of x y z respectively then the equation of transformation from the quaternion to euler angles is ni et al 2009 24 φ arctan 2 q 0 q 1 q 2 q 3 1 2 q 1 2 q 2 2 θ arcsin 2 q 1 q 3 q 0 q 2 ϕ arctan 2 q 1 q 2 q 0 q 3 1 2 q 2 2 q 3 2 where φ θ ϕ are the roll angle trimming angle and yaw angle respectively q 0 q 1 q 2 q 3 are the four components of the quaternion the orientation cosine matrix that transforms the coordinates is 25 a b g a x φ a y θ a z ϕ cos ϕ c o s θ sin ϕ c o s θ sin θ cos ϕ sin θ sin φ sin ϕ cos φ sin ϕ sin θ sin φ cos ϕ cos φ cos θ sin φ cos ϕ sin θ cos φ sin ϕ sin φ sin ϕ sin θ cos φ cos ϕ sin φ cos θ cos φ the quaternion matrix that realizes the corresponding coordinate transformation is 26 a q q 0 2 q 1 2 q 2 2 q 3 2 2 q 1 q 2 q 0 q 3 2 q 1 q 3 q 0 q 2 2 q 1 q 2 q 0 q 3 q 0 2 q 1 2 q 2 2 q 3 2 2 q 2 q 3 q 0 q 1 2 q 1 q 3 q 0 q 2 2 q 2 q 3 q 0 q 1 q 0 2 q 1 2 q 2 2 q 3 2 2 5 2 spatial motion equations of an underactuated auv in order to obtain an appropriate similar motion model the unit quaternion is selected to parameterize the dynamic equation the unit quaternion is defined as follows rotate through an angle of ϕ near the unit vector k then the four parameters can be expressed as 27 ε 1 ε 2 ε 3 t k sin ϕ k 2 ε 4 cos ϕ k 2 assuming that ϕ k π and ε 4 0 the quaternion meets the following condition 28 ε 1 2 ε 2 2 ε 3 2 ε 4 2 1 thus ε 4 can only be defined by ε 1 ε 2 ε 3 t the kinematic equations of an underactuated auv are written as x 1 2 ε 1 2 2 ε 2 2 u 2 ε 1 ε 2 ε 3 1 ε 1 2 ε 2 2 ε 3 2 v 2 ε 1 ε 3 ε 2 1 ε 1 2 ε 2 2 ε 3 2 w y 2 ε 1 ε 2 ε 3 1 ε 1 2 ε 2 2 ε 3 2 u 1 2 ε 1 2 2 ε 2 2 v 2 ε 2 ε 3 ε 1 1 ε 1 2 ε 2 2 ε 3 2 w z 2 ε 1 ε 3 ε 2 1 ε 1 2 ε 2 2 ε 3 2 u 2 ε 2 ε 3 ε 1 1 ε 1 2 ε 2 2 ε 3 2 v 1 2 ε 1 2 2 ε 2 2 w ε 1 1 2 p 1 ε 1 2 ε 2 2 ε 3 2 ε 3 q ε 2 r ε 2 1 2 ε 3 p q 1 ε 1 2 ε 2 2 ε 3 2 ε 1 r ε 3 1 2 ε 2 p ε 1 q r 1 ε 1 2 ε 2 2 ε 3 2 u τ 1 m 33 m 11 w q m 22 m 11 v r x u m 11 u v m 11 m 22 u r m 33 m 22 w p y v m 22 v w m 22 m 33 v p m 11 m 33 u q z w m 33 w p τ 4 m 33 m 22 m 44 w v m 66 m 55 m 44 q r d 44 m 44 p 2 w b g z m 44 ε 2 ε 3 ε 1 1 ε 1 2 ε 2 2 ε 3 2 q τ 5 m 11 m 33 m 55 u w m 44 m 66 m 55 p r d 55 m 55 q 2 w b g z m 55 ε 2 1 ε 1 2 ε 2 2 ε 3 2 ε 1 ε 3 29 r τ 6 m 22 m 11 m 66 u v m 55 m 44 m 66 p q d 66 m 66 r define vector η η 1 η 2 t where η 1 x y z t is the position vector in the inertial coordinate system η 2 ε 1 ε 2 ε 3 t and τ τ 1 τ 2 τ 3 τ 4 τ 5 τ 6 t represents the control inputs in longitudinal lateral vertical horizontal rolling trimming and yawing directions respectively 2 5 3 stabilization design for an auv only stabilization control inputs of auv in four directions are investigated the axial thrust force f rolling moment k trimming moment m and yawing moment n according to the third condition of the brockett theorem yan 2009 there is no smooth time invariant feedback controller that makes the system asymptotically stable near the equilibrium point in spatial motion equations with six degrees of freedom therefore a continuous time varying feedback controller is proposed in the present paper 2 5 3 1 proposition in the following equation 30 u d η ε v w t k x x ρ a η ε v w sin t ε p d η ε v w t k ε 1 ε 1 q d η ε v w t k ε 2 ε 2 2 k z d w ρ a η ε v w sin t ε r d η ε v w t k ε 3 ε 3 2 k y d v ρ a η ε v w sin t ε where k x k ε 1 k ε 2 k ε 3 k d and ε are positive and ρ a η ε v w is a standard function that can be differentiated under any condition morin and samson 1995 and is given by δ λ a η ε v w λ x λ 2 y λ 2 z λ ε 1 λ ε 2 λ ε 3 λ 2 v λ 2 w t it can be further defined as 31 τ 1 η v t k 1 m 11 u u d η v w t τ 4 η v t k 4 m 44 p p d η v w t τ 5 η v t k 5 m 55 q q d η v w t τ 6 η v t k 6 m 66 r r d η v w t therefore as k 1 k 2 k 3 k 4 are sufficiently large and positive for any ε 0 ε 0 ε 0 0 the controller in eq 31 can stabilize the local index in system 29 2 5 3 2 verification under the control inputs τ 2 0 and τ 3 0 eq 29 of the spatial motion model for an underactuated auv can be written as 32 η v f η v t h η v t where 33 f η v t u v 2 ε 3 u w 2 ε 2 u p 2 q 2 r 2 1 m 11 d 11 u τ 1 1 m 22 d 22 v m 11 u r 1 m 33 d 33 v m 11 u q 1 m 44 d 44 p 2 w b g z ε 1 τ 4 1 m 55 d 55 q 2 w b g z ε 2 τ 5 1 m 66 d 66 r τ 6 t and h η v t is the rest term δ λ β η ε v w λ x λ 2 y λ 2 z λ ε 1 λ ε 2 λ ε 3 λ 2 v λ 2 w t compared to its expanded form τ 1 τ 4 τ 5 τ 6 are homogeneous first order and continuous at η v 0 and at zero points vector f is therefore continuous moreover f is time periodic f 0 0 t 0 comparing with the expanded form δ λ β f is in zeroth order form the vector field h η v t is also continuous it is a sum of series of strictly positive order forms relative to δ λ β thus the solution of system 32 η v 0 0 is a local exponential stabilization 34 η v f η v t noticing that ε 4 is not present in f η v t the seventh equation in system 34 can be removed because ε 4 is the only parameter defined by ε 1 ε 2 and ε 3 satisfying ε 1 2 ε 2 2 ε 3 2 ε 4 2 1 the original system in eq 32 is asymptotically stable if the reduced equation is asymptotically partial stable further define u d e f u d p d e f p d q d e f q d r d e f r d and take them as input variables so that the reduced system becomes 35 x y z ε 1 ε 2 ε 3 v w u d v 2 ε 3 u d w 2 ε 2 u d 1 2 p d 1 2 q d 1 2 r d m 11 m 22 u d r d d 22 m 22 v m 11 m 33 u d q d d 33 m 33 w control inputs of the system in eq 32 are defined in the set of equations in eq 31 considering that the input is periodic and time varying the generated results are periodic and time varying as well this can be written as 36 ξ g ξ t ε the system in eq 35 is approximately substituted by an autonomous average system and the average system of eq 36 is 37 ξ g 0 ξ where g 0 ξ 1 t 0 t g ξ t d t substituting the control input in eq 31 into eq 35 the average system of eq 35 can be written as 38 x y z ε 1 ε 2 ε 3 v w k x x v 2 k x ε 3 x w 2 k x ε 2 x 1 2 k ε 1 ε 1 1 2 k ε 2 ε 2 1 2 k ε 3 ε 3 m 11 m 22 k x k ε 3 x ε 3 k y d v d 22 m 22 v m 11 m 33 k x k ε 2 x ε 2 k z d w d 33 m 33 w because the linearity of the initial form of eq 38 is asymptotically stable the initial form of eq 38 is asymptotically stable because eq 35 is continuous the time period is zeroth order with respect to the expansion δ λ β η ε v w λ x λ 2 y λ 2 z λ ε 1 λ ε 2 λ ε 3 λ 2 v λ 2 w t therefore there are values that satisfy ε 0 0 for any ε 0 ε 0 and the initial form of eq 34 is asymptotically stable functions u d p d q d and r d are continuous time periodic differentiable with respect to time and zeroth order relative to the expanded form δ λ β thus u p q and r are defined in eq 32 39 u d 11 m 11 u k 1 u u d η v w t p d 44 m 44 p 2 w b g z ε 1 k 4 p p d η q d 55 m 55 q 2 w b g z ε 2 k 5 q q d η v w t r d 66 m 66 r k 6 r r d η v w t the systems in eqs 30 and 32 satisfy the proposition in pettersen and egeland 1997 thus there is a smaller parameter k i taken as the boundary so that most parameters are larger than k i the latter half of eq 32 affects its first half and the internal control loop is regulated so that the actual velocity can trace the designed velocity therefore there are sufficiently large positive numbers k 1 k 2 k 3 k 4 which make the initial form of the system in eq 32 asymptotically stable compared to the expanded δ λ β η v 0 0 is a stable point of local asymptotic exponential stability for the system in eq 32 if d 44 m 44 is large enough the control input moment appears useless under the presence of a hydrodynamic moment this is evident from the dynamics equation 40 p d 44 m 44 p 2 w b g z ε 1 m 44 τ 4 m 44 2 6 if k ε 1 is 2 w b g z m 44 0 eq 40 changes into 41 p d 44 m 44 p p d τ 4 m 44 hence if d 44 m 44 is large enough k ε 1 2 w b g z m 44 provides ε 1 with a high convergence speed thus under control inputs of τ 1 τ 5 and τ 6 if τ 4 0 exponents are convergent in the system in eq 3 large d 44 m 44 means that the hydrodynamic restoring moment in the rolling direction is large enough which is also one of basic properties of an auv 3 results and discussion 3 1 simulation experiment for stabilization control the basic parameters of the underactuated auv wl 3 are as follows m 11 120 m 22 160 m 33 160 m 44 60 m 55 100 m 66 100 d 11 40 d 22 70 d 33 70 d 44 30 d 55 60 and d 66 60 the auv is of neutral buoyancy and is not included in the gravity and buoyancy calculations assuming gravity and buoyancy balance and that the center of gravity coincides with the center of buoyancy the control input is executed using the controller in eqs 30 and 31 when τ 4 0 it achieves asymptotic convergence the related control parameters are as follows k 1 3 k 5 3 k 6 3 k x 2 k ε 2 2 k ε 3 2 k 0 3 d 0 3 and ε 2 5 the nominal criterion is 42 ρ α x 4 y 2 z 2 ε 1 4 ε 2 4 ε 2 4 v 2 w 2 1 4 and the initial position is x y z ε 1 ε 2 ε 3 u v w p q r 0 6 8 0 0 0 0 0 0 0 0 0 simulation results are shown in figs 1 7 the variations of translational velocities u v and w are plotted in fig 1 angular velocities of rotation p q and r are shown in fig 2 displacements x y z are presented in fig 3 and curves of conversion variables ε 1 ε 2 ε 3 in fig 4 fig 5 displays curves of control inputs t 1 t 5 t 6 and the actual stabilized motion trajectory of the underactuated auv is shown in fig 6 curves of nominal standard ρ α are shown in fig 7 in fig 1 velocities at the initial time have significant change rates and overshoots which indicates that there are large control inputs and input changes at the same time sudden input forces and moments cause the underactuated auv to experience large velocity changes which are permitted in the simulation displacements fig 3 oscillate in the vicinity of the stable point therefore actual trajectories are denser around the stable point which is consistent with simulation results during practical auv operation the transformation rates of physical parameters should be considered because the kinematic parameters of the auv cannot be dramatically changed to result in the auv jittering and thereby influence actual trajectory tracking from fig 1 it is clear that the convergence of longitudinal velocity is slower compared to that of lateral and vertical velocity moreover the convergence of longitudinal displacement is also slower than that of lateral and vertical displacement because there is vertical control input and the control input is a synthesis function combining each variable the vertical control input convergence lags behind the single variable input so variables converge slowly in the longitudinal direction conversion variables ε 1 ε 2 ε 3 represent angular velocities in the rolling longitudinal and yawing directions since the initial control input is large the variation of oscillation is obvious and the change of the actual situation must be considered if maintaining consistency with the translational velocity the nominal standard ρ α is the sum of an even number of squares of variables and therefore must be greater than zero with the convergence of each variable being equal to zero ρ α tends to zero these variables change more rapidly at the initial time because each physical variable converges quickly and the corresponding ρ α reduces rapidly from the simulation results it is evident that the developed control input can realize point stabilization control of underwater vehicles by variable transformation using the quaternion method moreover state variable velocity and displacement of an underactuated auv can converge to zero the simulation results show that the designed controller can achieve three dimensional stabilization in the case of three control inputs 4 conclusion nonlinear characteristics of underactuated auvs were analyzed based on the taylor series the nonholonomic control system properties of auvs were investigated using nonholonomic system theory under three dimensional control inputs the constraints of underactuated auvs were proved not to be integrated by the local integrability theorem and the controllability of underactuated auvs was verified through small time local controllability stlc based on the nonlinear characteristics of an underactuated auv quaternion theory was applied to transfer the underactuated auv motion function to develop a time varying control law this control law can achieve stabilization in arbitrary initial positions simulation results verified the effectiveness of the control law conflicts of interest none declared acknowledgments this study was supported by national natural science foundation of china 51179035 the funding agency had no role in the study design the collection analysis or interpretation of data the writing of the report or the decision to submit the article for publication 
23643,in order to realize three dimensional stable control of underactuated autonomous underwater vehicles auvs this study analyses nonlinear hydrodynamic characteristics of auvs based on the mathematical taylor series the nonholonomic control system properties of auvs are investigated using nonholonomic system theory under three dimensional control input the constraint of underactuated auvs is proved not to be integrated by the local integrability theorem and the controllability of underactuated auvs is verified through small time local controllability stlc in order to simplify the trigonometric terms in underactuated auv motion functions quaternion theory is applied to transform the function to develop a continuous time varying controller results of a simulation experiment show that this control law is effective in achieving three dimensional stabilization from arbitrary initial positions keywords underactuated autonomous underwater vehicles three dimension stabilization control quaternion nonholonomic system 1 introduction underactuated auvs are designed so that the number of dimensions of independent control inputs is less than the number of degrees of freedom wang et al 2010 the point of stabilization of an underactuated auv is also known as stabilization control which is a control input that drives the auv from a given initial position to the designated target position and orientation and stabilizes it in that configuration the difficulty of designing underactuated auvs is that these systems have nonholonomic constraints that are inconsistent with the necessary conditions of the brocket theorem yan 2009 thus there is no feedback from a smooth time invariant state to the controller that would cause the auv to stabilize at the equilibrium point hence linear control theory cannot be used directly to solve the stabilization of underactuated auvs some researchers have investigated stabilization control of underactuated auvs but they have focused basically on two dimensional issues aguiar and pascoal 2001 designed a time invariant non continuous self adaptive controller considering the uncertainty of model parameters the kinematics model was first converted into a polar coordinate system through coordinate transformation a smooth time invariant controller was then designed using the backstepping method and the lyapunov method in the new polar coordinate system to realize the stabilization of underactuated auvs in two dimensional horizontal positions and orientations for different initial conditions sankaranarayanan et al 2003 developed a switching controller to make an auv move from an arbitrary initial state to the origin in a horizontal plane they mainly used a switch of states and control input to decompose the system model into several subsystems they then stabilized these subsystems in an orderly manner using proper controllers with respect to their characteristics in order to stabilize the position and orientation of the whole system at the origin this method was proposed based on the assumption that the subsystems involved are stable before stabilization control and are independent of previous stages this method can only be used in two dimensional cases tian and li 2001 constructed a smooth time invariant feedback controller for a general model of a nonholonomic system which can ensure global exponential convergence of the system the motion equations of a two dimensional auv were transformed from one model to another and a stabilization controller was designed however the model must be in a specific form in order to apply this method and its motion function must also be changed because it is difficult to achieve a chain structure for spatial motion equations with six degrees of freedom aguiar and pascoal 2002 used a diffeomorphic method to change the horizontal motion equation of an auv into a second order system and proposed a continuous time varying smooth mixed controller a simulation of horizontal motion was conducted according to the assembly of preset systematic dynamics states the results showed that an auv could be stabilized in a small zone near the target location however due to the existence of a swing speed the speed drift term of the second order system is not in the control input vector field making the actual stabilization path difficult to predict aguiar et al 2007 proposed a stabilization method for nonlinear systems with disturbances using mixed control and introduced a stable or unstable transfer system and an interactive transfer system the second order system was obtained through changing the motion equations the time varying differential controller was designed using interactive control and a stabilization simulation for horizontal auv motion was performed the simulation results realized convergence of auv location as the heading angle tended to the design value however there was turbulence exists in the longitudinal position due to the fact that the heading angle was not completely stable at a value of zero leonard 1995 developed an open loop control synthesis method based on a kinematic method for underactuated auvs and applied this synthesis method to achieving self adaption of control authority in order to verify its effectiveness two operations were executed one took the roll angle and pitch angle as control inputs in order to realize yaw the other was an auv mooring operation the experimental results verified the feasibility of using the roll angle and pitch angle as control inputs to achieve yaw nevertheless only the kinematic model was considered without any dynamic equations of motion most existing research concentrates on designing two dimensional stabilization of underactuated auvs however the actual motions of auvs are three dimensional because equations of motion under three dimensional conditions exhibit significant nonlinearity and coupling it is difficult to establish a smooth controller in these cases hence research on three dimensional stabilization control is rare in the present paper nonlinear dynamics physical constraints and constraint integrability and controllability of a dynamic model system for underactuated auvs are analyzed the equations of spatial motion for an auv are transformed using quaternions and thus a continuous time varying controller is proposed the convergence of this controller is then verified by introducing formal functions pettersen and egeland 1997 in order to realize three dimensional stabilization control of underactuated auvs at arbitrary positions simulation results show that the developed controller is effective 2 materials and methods 2 1 general dynamics equation underactuated auvs generally use propeller rudder wing forms so external forces consist only of an axial propulsion force x trimming moment m and yawing moment n if the influence of external currents and waves is considered an additional disturbing force τ b can be obtained from the following dynamic equation feng 2010 1 m v c v v d v v g η τ τ b where m r 6 6 is the inertial matrix of the auv including additional mass c v r 6 6 is its coriolis force matrix d v r 6 6 is its fluid damping matrix and g η r 6 1 is its resilience matrix which is generated by gravity and buoyancy τ r 6 1 is the force matrix induced by the propeller and τ b is disturbing force matrix the additive kinematic equation is 2 ξ j η v the overall external forces and orientation can be obtained from this equation feng 2010 because only three degrees of freedom have control inputs in real auv motion the six degree of freedom dynamic equation can be simplified as 3 m a v c a v v d a v v g a η τ m u v c u v v d u v v g u η 0 ξ j η v where a indicates the driven system and u is the underactuated system control inputs along the axial trimming and heading directions are contained in the first equation the second equation represents underactuated motion in the horizontal vertical and roll directions 2 2 the nonlinear dynamic nature of underactuated auvs an underactuated auv is a hull rudder propeller system and its hydrodynamic function can be expressed using parameters of underwater vehicle motion 4 f f v v ω ω δ δ n where v is the vehicle speed ω is its angular velocity δ is the rudder angle and n indicates the rotational speed of the propeller the general hydrodynamics expression can be obtained according to the taylor series expansion taking straight sailing with constant speed in a balanced state as an example the taylor series is expanded to three orders therefore the force in the y direction is 5 y f y u v r u v r δ y 0 y u δ u y v v y r r y u u y v v y r r y δ δ 1 2 y u u δ u 2 y v v v 2 y r r r 2 y δ δ δ 2 2 y u v δ u v 2 y u r δ u r 2 y u δ δ u δ 2 y v r v r 2 y v δ v δ 2 y r δ r δ 1 3 y u u u δ u 3 y v v v v 3 y r r r r 3 y δ δ δ δ 3 3 y u u v δ u 2 v y v v r v 2 r from eq 5 it is clear that a significant coupling i e significant nonlinearity exists in terms of forces for an underactuated auv during the actual modelling process the kinematic mathematical models of an underactuated auv are not strictly accurate especially when terms are simplified and many factors are neglected the complexity of the kinematic mathematical auv model is mainly manifested in high nonlinearity and coupling of hull viscous hydrodynamics control inputs force matrix and external interference high nonlinearity in terms of viscous hydrodynamics can be seen from the forces in the y direction that simulate the operational motion of an auv therefore nonlinear terms multivariate taylor series of three orders should be considered and linear processing is effective only when executed in a small region near the origin underactuated auvs feature high coupling and nonlinearity thus both the hydrodynamic coefficients and control forces in the dynamic model have uncertainty one aspect is that the hydrodynamic coefficients are difficult to estimate using theoretical methods or experimental testing another is that the force generated by the propeller and rudder correlates nonlinearly with the sailing speed of an auv and this relationship is difficult to establish using an accurate model the results of conventional propeller open water tests and rudder hydrodynamic tests differ significantly from practical application effects wang et al 2010 considering that underwater vehicles may carry different tools and equipment when performing tasks variations in loading can result in changes in auv mass center of mass center of buoyancy and hydrodynamic coefficients xuemin and yuru 2001 external interferences mainly include wind waves currents shallow water effects and bank effects in addition to these influences on system balance characteristics interferences affect the high nonlinearity and uncertainty of models for auv motion control underactuated auvs are highly nonlinear systems which involve time varying characteristics of motion complicated operational environments and uncertainty therefore nonlinearity should be considered when designing an underactuated auv control system wang et al 2010 2 3 characteristics of nonholonomic systems according to the theory of nonholonomic systems the integrability and controllability of system constraints directly affect the determination of the three dimensional tracking control strategy of underactuated auv which is the key problem of effective control the integrability analysis determines whether the auv system is complete and the controllability determines whether the system can be transferred between states they are closely related to the problem of track planning and tracking therefore it is beneficial to design the auv path tracking controller by analyzing the dynamic control characteristics of auv based on the nonholonomic system theory he ming et al 2012 actual mechanical systems can be classified into fully actuated mechanical systems and underactuated mechanical systems according to the relationship between the number of control input dimensions and the number of configuration space dimensions in terms of system constraints systems can be divided into holonomic and nonholonomic systems yan 2009 the general form of nonholonomic constraints can be expressed as 6 h i q q q q m 0 i 1 k the following lemma provides necessary and sufficient conditions for proving local integrability yan 2009 2 3 1 lemma 1 local integrability constraint equations are locally integrable when they satisfy the following conditions 1 g u η is a constant 2 c u v d u v is a constant matrix 3 the distributed ω ker c u d u j 1 η is fully integrable for an underactuated auv with a propeller rudder wing form there are control inputs with three degrees of freedom assuming that the auv s gravity and buoyancy forces are balanced the constraint equation is 7 m λ 22 v m λ 11 u r m λ 33 w p y v y v v v v 0 m λ 33 w m λ 22 v p m λ 11 u q z w z w w w w 0 i x λ 44 p λ 33 λ 22 w v i z i y λ 55 λ 66 q r k p k p p p p b g y w cos θ cos ϕ b g z w cos θ sin ϕ 0 where m λ are the mass and additional mass of the auv respectively u v w are linear velocities and p q r are angular velocities hence 8 c u d u v m λ 11 u r m λ 33 w p y v y v v v v m λ 22 v p m λ 11 u q z w z w w w w λ 33 λ 22 w v i z i y λ 55 λ 66 q r k p k p p p p it is evident from eq 8 that c u d u relates to velocity so c u d u is not a constant matrix which is inconsistent with condition 2 of lemma 1 consequently the constraint equation is proved to be non integrable moreover an underactuated auv also possesses non integrable acceleration constraints belonging to two order nonholonomic systems 2 3 2 theorem 1 let η v 0 0 which is a balance point in the equation of spatial motion with six degrees of freedom under the conditions that the control input is zero and no external interference exists no smooth time invariant feedback controller makes the system asymptotically stable near the equilibrium point he ming et al 2012 wang et al 2010 2 4 analysis of controllability the controllability concept for linear systems is extended to nonholonomic systems using a differential geometry method and the necessary conditions of small time local controllability stlc proposed by sussmann morin and samson 1995 based on the nonholonomic characteristics of underactuated auvs when determining the stlc of an underactuated auv the system is generally transformed into the following state equation chen et al 2006 9 x f x g x u where f x is the drift vector field for the nonlinear system g x is the control vector field and u is a control input 2 4 1 sussmann theorem an affine nonlinear system is small time locally controlled if it satisfies the following 1 the order condition of lie algebra and 2 all bad brackets are expressed by linear combinations of good brackets 2 4 2 theorem 2 system 10 m v c v v d v v g η τ ξ j η v is small time locally controlled at the balanced point η v 0 0 2 4 3 verification the mapping is defined as 11 f η v j η v m 1 c v v d v v g η and a vector is assumed as follows 12 g g 1 g 2 g 3 g 4 g 11 g 12 d i a g 0 0 0 1 m 11 1 m 22 1 m 66 the system can be written as 13 η v f η v g τ and this can be simplified as 14 η v f η v g 7 τ 1 g 11 τ 5 g 12 τ 6 15 f η v u cos ϕ c o s θ v cos ϕ sin θ sin φ sin ϕ cos φ w cos ϕ sin θ cos φ sin ϕ sin φ u sin ϕ c o s θ v sin ϕ sin θ sin φ cos ϕ cos φ w sin ϕ sin θ cos φ cos ϕ sin φ u sin θ v cos θ sin φ w cos θ cos φ p q sin φ tan θ r cos φ tan θ q cos φ r sin φ q sin φ cos θ r cos φ cos θ m 33 m 11 w q m 22 m 11 v r x u m 11 u m 11 m 22 u r m 33 m 22 w p y v m 22 v m 22 m 33 v p m 11 m 33 u q z w m 33 w m 33 m 22 m 44 w v m 66 m 55 m 44 q r k p m 44 p m 11 m 33 m 55 u w m 44 m 66 m 55 p r m q m 55 q m 22 m 11 m 66 u v m 55 m 44 m 66 p q n r m 66 r in order to describe the system let 16 g 0 x f η v τ 0 1 with 17 η v g 0 τ 0 g 7 τ 1 g 11 τ 5 g 12 τ 6 lie brackets in the extended vector field g 0 g 7 g 11 g 12 are calculated as 18 g 0 g 7 1 m 11 cos ϕ cos θ sin ϕ cos θ sin θ 0 0 0 x u m 11 m 11 m 22 r m 11 m 33 q 0 m 11 m 33 m 55 w m 22 m 11 m 66 v t 19 g 0 g 11 1 m 55 0 0 0 sin φ tan θ cos φ sin φ cos θ m 33 m 11 w 0 m 11 m 33 u m 66 m 55 m 44 r m q m 55 m 55 m 44 m 66 p t 20 g 0 g 12 1 m 66 0 0 0 cos φ tan θ sin φ cos φ cos θ m 22 m 11 v m 11 m 22 u 0 m 66 m 55 m 44 q m 44 m 66 m 55 p n r m 66 t 21 g 7 g 11 0 g 7 g 12 0 g 11 g 12 0 22 g 0 g 0 g 7 1 m 11 sin θ cos ϕ q cos φ r sin φ cos θ sin ϕ q sin φ cos θ r cos φ cos θ x u m 11 cos ϕ c o s θ m 11 m 22 r cos ϕ sin θ sin φ sin ϕ cos φ m 11 m 33 q cos ϕ sin θ cos φ sin ϕ sin φ sin θ sin ϕ q cos φ r sin φ cos θ cos ϕ q sin φ cos θ r cos φ cos θ x u m 11 sin ϕ c o s θ m 11 m 22 r sin ϕ sin θ sin φ cos ϕ cos φ m 11 m 33 q sin ϕ sin θ cos φ cos ϕ sin φ cos θ q cos φ r sin φ x u m 11 sin θ m 11 m 22 r cos θ sin φ m 11 m 33 q cos θ cos φ m 11 m 33 m 55 w sin φ tan θ m 22 m 11 m 66 v cos φ tan θ m 11 m 33 m 55 w cos φ m 22 m 11 m 66 v sin φ m 11 m 33 m 55 w sin φ sec θ m 22 m 11 m 66 v cos φ sec θ x u m 11 2 r 2 q 2 m 33 m 22 w m 11 m 33 m 55 w m 22 m 11 v m 22 m 11 m 66 v m 11 m 22 m 22 m 11 m 66 u v m 55 m 44 m 66 p q n r m 66 r x u m 22 r y v m 11 m 22 2 r m 11 m 22 p q m 11 m 22 u m 22 m 11 m 66 v m 11 m 33 m 11 m 33 m 55 u w m 44 m 66 m 55 p q m q m 55 q x u m 33 q z w m 11 m 33 2 q m 11 m 33 p r m 11 m 33 u m 11 m 33 m 55 w m 33 m 22 m 44 w m 11 m 22 r m 33 m 22 m 44 v m 11 m 33 q m 11 m 33 m 55 w m 66 m 55 m 44 r m 22 m 11 m 66 v m 66 m 55 m 44 q m 11 m 33 m 55 m 22 m 33 v p m 11 m 33 u q z w m 33 w m 11 m 33 m 55 u m 11 m 33 q m 11 m 33 m 55 w x u m 33 m 11 m 33 m 55 w m q m 55 m 44 m 66 m 55 p m 22 m 11 m 66 v m 22 m 11 m 66 m 11 m 22 u r m 33 m 22 w p y v m 22 v m 22 m 11 m 66 u m 11 m 33 q m 22 m 11 m 66 v x u m 33 m 55 m 44 m 66 q m 11 m 33 m 55 w n r m 66 p m 22 m 11 m 66 v lie brackets in the vector field extended from vector f and g are computed yue 2002 in sequence and the dimensions of the extended g are finally determined 23 dim g 0 g 7 g 11 g 12 g 0 g 7 g 0 g 11 g 0 g 12 g 7 g 11 10 for arbitrary η v r 6 it can be proved that the above extended vectors satisfy the control conditions of lie algebra i e the system is strongly locally reachable hence according to the sussmann theorem the equation of spatial motion with six degrees of freedom is small time locally controlled at the balance point he ming et al 2012 2 5 stabilization design based on quaternions from the analysis of the control system above the dynamic characteristics of an underactuated auv have two order nonholonomic constraints thus no smooth time invariant feedback controller makes the system asymptotically stable near the equilibrium point in order to solve this problem a continuous time varying controller is designed based on quaternion theory in this paper this requires transforming the motion model and realizes three dimensional stabilization of an underactuated auv 2 5 1 quaternion in geodetic coordinate systems and body fixed coordinate systems a given orientation is designated by φ θ ϕ and rotations of x y z respectively then the equation of transformation from the quaternion to euler angles is ni et al 2009 24 φ arctan 2 q 0 q 1 q 2 q 3 1 2 q 1 2 q 2 2 θ arcsin 2 q 1 q 3 q 0 q 2 ϕ arctan 2 q 1 q 2 q 0 q 3 1 2 q 2 2 q 3 2 where φ θ ϕ are the roll angle trimming angle and yaw angle respectively q 0 q 1 q 2 q 3 are the four components of the quaternion the orientation cosine matrix that transforms the coordinates is 25 a b g a x φ a y θ a z ϕ cos ϕ c o s θ sin ϕ c o s θ sin θ cos ϕ sin θ sin φ sin ϕ cos φ sin ϕ sin θ sin φ cos ϕ cos φ cos θ sin φ cos ϕ sin θ cos φ sin ϕ sin φ sin ϕ sin θ cos φ cos ϕ sin φ cos θ cos φ the quaternion matrix that realizes the corresponding coordinate transformation is 26 a q q 0 2 q 1 2 q 2 2 q 3 2 2 q 1 q 2 q 0 q 3 2 q 1 q 3 q 0 q 2 2 q 1 q 2 q 0 q 3 q 0 2 q 1 2 q 2 2 q 3 2 2 q 2 q 3 q 0 q 1 2 q 1 q 3 q 0 q 2 2 q 2 q 3 q 0 q 1 q 0 2 q 1 2 q 2 2 q 3 2 2 5 2 spatial motion equations of an underactuated auv in order to obtain an appropriate similar motion model the unit quaternion is selected to parameterize the dynamic equation the unit quaternion is defined as follows rotate through an angle of ϕ near the unit vector k then the four parameters can be expressed as 27 ε 1 ε 2 ε 3 t k sin ϕ k 2 ε 4 cos ϕ k 2 assuming that ϕ k π and ε 4 0 the quaternion meets the following condition 28 ε 1 2 ε 2 2 ε 3 2 ε 4 2 1 thus ε 4 can only be defined by ε 1 ε 2 ε 3 t the kinematic equations of an underactuated auv are written as x 1 2 ε 1 2 2 ε 2 2 u 2 ε 1 ε 2 ε 3 1 ε 1 2 ε 2 2 ε 3 2 v 2 ε 1 ε 3 ε 2 1 ε 1 2 ε 2 2 ε 3 2 w y 2 ε 1 ε 2 ε 3 1 ε 1 2 ε 2 2 ε 3 2 u 1 2 ε 1 2 2 ε 2 2 v 2 ε 2 ε 3 ε 1 1 ε 1 2 ε 2 2 ε 3 2 w z 2 ε 1 ε 3 ε 2 1 ε 1 2 ε 2 2 ε 3 2 u 2 ε 2 ε 3 ε 1 1 ε 1 2 ε 2 2 ε 3 2 v 1 2 ε 1 2 2 ε 2 2 w ε 1 1 2 p 1 ε 1 2 ε 2 2 ε 3 2 ε 3 q ε 2 r ε 2 1 2 ε 3 p q 1 ε 1 2 ε 2 2 ε 3 2 ε 1 r ε 3 1 2 ε 2 p ε 1 q r 1 ε 1 2 ε 2 2 ε 3 2 u τ 1 m 33 m 11 w q m 22 m 11 v r x u m 11 u v m 11 m 22 u r m 33 m 22 w p y v m 22 v w m 22 m 33 v p m 11 m 33 u q z w m 33 w p τ 4 m 33 m 22 m 44 w v m 66 m 55 m 44 q r d 44 m 44 p 2 w b g z m 44 ε 2 ε 3 ε 1 1 ε 1 2 ε 2 2 ε 3 2 q τ 5 m 11 m 33 m 55 u w m 44 m 66 m 55 p r d 55 m 55 q 2 w b g z m 55 ε 2 1 ε 1 2 ε 2 2 ε 3 2 ε 1 ε 3 29 r τ 6 m 22 m 11 m 66 u v m 55 m 44 m 66 p q d 66 m 66 r define vector η η 1 η 2 t where η 1 x y z t is the position vector in the inertial coordinate system η 2 ε 1 ε 2 ε 3 t and τ τ 1 τ 2 τ 3 τ 4 τ 5 τ 6 t represents the control inputs in longitudinal lateral vertical horizontal rolling trimming and yawing directions respectively 2 5 3 stabilization design for an auv only stabilization control inputs of auv in four directions are investigated the axial thrust force f rolling moment k trimming moment m and yawing moment n according to the third condition of the brockett theorem yan 2009 there is no smooth time invariant feedback controller that makes the system asymptotically stable near the equilibrium point in spatial motion equations with six degrees of freedom therefore a continuous time varying feedback controller is proposed in the present paper 2 5 3 1 proposition in the following equation 30 u d η ε v w t k x x ρ a η ε v w sin t ε p d η ε v w t k ε 1 ε 1 q d η ε v w t k ε 2 ε 2 2 k z d w ρ a η ε v w sin t ε r d η ε v w t k ε 3 ε 3 2 k y d v ρ a η ε v w sin t ε where k x k ε 1 k ε 2 k ε 3 k d and ε are positive and ρ a η ε v w is a standard function that can be differentiated under any condition morin and samson 1995 and is given by δ λ a η ε v w λ x λ 2 y λ 2 z λ ε 1 λ ε 2 λ ε 3 λ 2 v λ 2 w t it can be further defined as 31 τ 1 η v t k 1 m 11 u u d η v w t τ 4 η v t k 4 m 44 p p d η v w t τ 5 η v t k 5 m 55 q q d η v w t τ 6 η v t k 6 m 66 r r d η v w t therefore as k 1 k 2 k 3 k 4 are sufficiently large and positive for any ε 0 ε 0 ε 0 0 the controller in eq 31 can stabilize the local index in system 29 2 5 3 2 verification under the control inputs τ 2 0 and τ 3 0 eq 29 of the spatial motion model for an underactuated auv can be written as 32 η v f η v t h η v t where 33 f η v t u v 2 ε 3 u w 2 ε 2 u p 2 q 2 r 2 1 m 11 d 11 u τ 1 1 m 22 d 22 v m 11 u r 1 m 33 d 33 v m 11 u q 1 m 44 d 44 p 2 w b g z ε 1 τ 4 1 m 55 d 55 q 2 w b g z ε 2 τ 5 1 m 66 d 66 r τ 6 t and h η v t is the rest term δ λ β η ε v w λ x λ 2 y λ 2 z λ ε 1 λ ε 2 λ ε 3 λ 2 v λ 2 w t compared to its expanded form τ 1 τ 4 τ 5 τ 6 are homogeneous first order and continuous at η v 0 and at zero points vector f is therefore continuous moreover f is time periodic f 0 0 t 0 comparing with the expanded form δ λ β f is in zeroth order form the vector field h η v t is also continuous it is a sum of series of strictly positive order forms relative to δ λ β thus the solution of system 32 η v 0 0 is a local exponential stabilization 34 η v f η v t noticing that ε 4 is not present in f η v t the seventh equation in system 34 can be removed because ε 4 is the only parameter defined by ε 1 ε 2 and ε 3 satisfying ε 1 2 ε 2 2 ε 3 2 ε 4 2 1 the original system in eq 32 is asymptotically stable if the reduced equation is asymptotically partial stable further define u d e f u d p d e f p d q d e f q d r d e f r d and take them as input variables so that the reduced system becomes 35 x y z ε 1 ε 2 ε 3 v w u d v 2 ε 3 u d w 2 ε 2 u d 1 2 p d 1 2 q d 1 2 r d m 11 m 22 u d r d d 22 m 22 v m 11 m 33 u d q d d 33 m 33 w control inputs of the system in eq 32 are defined in the set of equations in eq 31 considering that the input is periodic and time varying the generated results are periodic and time varying as well this can be written as 36 ξ g ξ t ε the system in eq 35 is approximately substituted by an autonomous average system and the average system of eq 36 is 37 ξ g 0 ξ where g 0 ξ 1 t 0 t g ξ t d t substituting the control input in eq 31 into eq 35 the average system of eq 35 can be written as 38 x y z ε 1 ε 2 ε 3 v w k x x v 2 k x ε 3 x w 2 k x ε 2 x 1 2 k ε 1 ε 1 1 2 k ε 2 ε 2 1 2 k ε 3 ε 3 m 11 m 22 k x k ε 3 x ε 3 k y d v d 22 m 22 v m 11 m 33 k x k ε 2 x ε 2 k z d w d 33 m 33 w because the linearity of the initial form of eq 38 is asymptotically stable the initial form of eq 38 is asymptotically stable because eq 35 is continuous the time period is zeroth order with respect to the expansion δ λ β η ε v w λ x λ 2 y λ 2 z λ ε 1 λ ε 2 λ ε 3 λ 2 v λ 2 w t therefore there are values that satisfy ε 0 0 for any ε 0 ε 0 and the initial form of eq 34 is asymptotically stable functions u d p d q d and r d are continuous time periodic differentiable with respect to time and zeroth order relative to the expanded form δ λ β thus u p q and r are defined in eq 32 39 u d 11 m 11 u k 1 u u d η v w t p d 44 m 44 p 2 w b g z ε 1 k 4 p p d η q d 55 m 55 q 2 w b g z ε 2 k 5 q q d η v w t r d 66 m 66 r k 6 r r d η v w t the systems in eqs 30 and 32 satisfy the proposition in pettersen and egeland 1997 thus there is a smaller parameter k i taken as the boundary so that most parameters are larger than k i the latter half of eq 32 affects its first half and the internal control loop is regulated so that the actual velocity can trace the designed velocity therefore there are sufficiently large positive numbers k 1 k 2 k 3 k 4 which make the initial form of the system in eq 32 asymptotically stable compared to the expanded δ λ β η v 0 0 is a stable point of local asymptotic exponential stability for the system in eq 32 if d 44 m 44 is large enough the control input moment appears useless under the presence of a hydrodynamic moment this is evident from the dynamics equation 40 p d 44 m 44 p 2 w b g z ε 1 m 44 τ 4 m 44 2 6 if k ε 1 is 2 w b g z m 44 0 eq 40 changes into 41 p d 44 m 44 p p d τ 4 m 44 hence if d 44 m 44 is large enough k ε 1 2 w b g z m 44 provides ε 1 with a high convergence speed thus under control inputs of τ 1 τ 5 and τ 6 if τ 4 0 exponents are convergent in the system in eq 3 large d 44 m 44 means that the hydrodynamic restoring moment in the rolling direction is large enough which is also one of basic properties of an auv 3 results and discussion 3 1 simulation experiment for stabilization control the basic parameters of the underactuated auv wl 3 are as follows m 11 120 m 22 160 m 33 160 m 44 60 m 55 100 m 66 100 d 11 40 d 22 70 d 33 70 d 44 30 d 55 60 and d 66 60 the auv is of neutral buoyancy and is not included in the gravity and buoyancy calculations assuming gravity and buoyancy balance and that the center of gravity coincides with the center of buoyancy the control input is executed using the controller in eqs 30 and 31 when τ 4 0 it achieves asymptotic convergence the related control parameters are as follows k 1 3 k 5 3 k 6 3 k x 2 k ε 2 2 k ε 3 2 k 0 3 d 0 3 and ε 2 5 the nominal criterion is 42 ρ α x 4 y 2 z 2 ε 1 4 ε 2 4 ε 2 4 v 2 w 2 1 4 and the initial position is x y z ε 1 ε 2 ε 3 u v w p q r 0 6 8 0 0 0 0 0 0 0 0 0 simulation results are shown in figs 1 7 the variations of translational velocities u v and w are plotted in fig 1 angular velocities of rotation p q and r are shown in fig 2 displacements x y z are presented in fig 3 and curves of conversion variables ε 1 ε 2 ε 3 in fig 4 fig 5 displays curves of control inputs t 1 t 5 t 6 and the actual stabilized motion trajectory of the underactuated auv is shown in fig 6 curves of nominal standard ρ α are shown in fig 7 in fig 1 velocities at the initial time have significant change rates and overshoots which indicates that there are large control inputs and input changes at the same time sudden input forces and moments cause the underactuated auv to experience large velocity changes which are permitted in the simulation displacements fig 3 oscillate in the vicinity of the stable point therefore actual trajectories are denser around the stable point which is consistent with simulation results during practical auv operation the transformation rates of physical parameters should be considered because the kinematic parameters of the auv cannot be dramatically changed to result in the auv jittering and thereby influence actual trajectory tracking from fig 1 it is clear that the convergence of longitudinal velocity is slower compared to that of lateral and vertical velocity moreover the convergence of longitudinal displacement is also slower than that of lateral and vertical displacement because there is vertical control input and the control input is a synthesis function combining each variable the vertical control input convergence lags behind the single variable input so variables converge slowly in the longitudinal direction conversion variables ε 1 ε 2 ε 3 represent angular velocities in the rolling longitudinal and yawing directions since the initial control input is large the variation of oscillation is obvious and the change of the actual situation must be considered if maintaining consistency with the translational velocity the nominal standard ρ α is the sum of an even number of squares of variables and therefore must be greater than zero with the convergence of each variable being equal to zero ρ α tends to zero these variables change more rapidly at the initial time because each physical variable converges quickly and the corresponding ρ α reduces rapidly from the simulation results it is evident that the developed control input can realize point stabilization control of underwater vehicles by variable transformation using the quaternion method moreover state variable velocity and displacement of an underactuated auv can converge to zero the simulation results show that the designed controller can achieve three dimensional stabilization in the case of three control inputs 4 conclusion nonlinear characteristics of underactuated auvs were analyzed based on the taylor series the nonholonomic control system properties of auvs were investigated using nonholonomic system theory under three dimensional control inputs the constraints of underactuated auvs were proved not to be integrated by the local integrability theorem and the controllability of underactuated auvs was verified through small time local controllability stlc based on the nonlinear characteristics of an underactuated auv quaternion theory was applied to transfer the underactuated auv motion function to develop a time varying control law this control law can achieve stabilization in arbitrary initial positions simulation results verified the effectiveness of the control law conflicts of interest none declared acknowledgments this study was supported by national natural science foundation of china 51179035 the funding agency had no role in the study design the collection analysis or interpretation of data the writing of the report or the decision to submit the article for publication 
23644,modified wells turbines allow an efficient use of the power contained in the ocean and sea waves the present study introduces the performance of an axial turbine which called wells turbine this turbine is used in oscillating water column owc wave energy conversion devices this type of axial turbine is investigated through numerical analysis and optimization unsteady 3d reynolds averaged navier stokes equations were solved with k ω sst turbulence closer model a comparative study of optimized and conventional blades with steady and unsteady flows has been presented for shape optimization blade profile thickness and sweep modifications along with and without grooved casing gc designs are considered the results concluded that the reference blade with gc performs better in terms of torque coefficient and efficiency if the flow is attached the unsteady flow gives a stream wise circulation near the blade suction surface the groove changes the tip vortex and helps to suppress the flow separation in addition the effect of blade sweep profile variation and groove depth on the hysteresis behavior of the wells turbine has been investigated in this work keywords blade thickness casing groove blade sweep wells turbine unsteady flow wave energy 1 introduction in 1976 professor wells of the queen s university of belfast proposed a self rectifying axial flow air turbine suitable for the owc the turbine is called wells turbine in its simplest form the air turbine rotor consists of several symmetric airfoil blades positioned around a hub as shown in fig 1 a because of simplicity in design the turbine has been widely applied for wave energy conversion and an important amount of research and developments have been done in many countries many research programs attempting to garner energy from sea waves depend on the oscillating water column owc as the energy converter mechanism keskin citiroglu and okur 2014 he et al 2013 ning et al 2016 in such a mechanism the water wave energy is converted to pneumatic energy in the air which flows reciprocally across a self rectifying axial air flow turbine called a wells turbine the wells turbine is an axial flow and self rectifying works on the bidirectional flow and produces unidirectional shaft rotation several researchers studied steady and unsteady behavior of this turbine to predict the performance brito melo et al 2002 raghunathan 1995 torresi et al 2008 halder et al 2015 taha et al 2010 the turbine has disadvantages such as low efficiency poor starting characteristics and low power output hence it is required to redesign the turbine to improve its output power and aerodynamic efficiency in wider wave variability kim et al 2001 inoue et al 1986a reported the performance of the turbine based on starting and running characteristics and modified blade solidity setting angle tip to chord ratio etc the solidity has a higher performance sensitivity than that of the setting angle or the tip to chord ratio setoguchi et al 1998 2003 the performance of the turbine varies during inhaling and exhaling of the air puddu et al 2014 and is better during the outflow phase compared kim at el kim et al 2002a reported the effect of blade thickness and angle of attack and found hysteresis characteristics under sinusoidal flow conditions the blade thickness and the angle of attack were more effective on the turbine performance than the setting angle and the gap to chord ratio shabaan shaaban 2016a 2016b numerically optimized the performance of wells turbine with rotor radial solidity distribution das et al das et al 2017 discussed different type owc device and optimization techniques the results indicated that the optimized geometry enhanced better performance than others the anticlockwise hysteresis loop in the decelerating flow leads to a flow separation on the suction surface ss near the hub whereas the clockwise hysteresis loop in the in the accelerating flow is related to the separation on the suction surface near the tip kinoue et al 2003 2005 the second law efficiency and entropy generation characteristics for the blade with naca0015 profile under unsteady flow showed better than that of the naca0012 naca0020 and naca0021 blades shehata et al 2016 thakker and abdulhadi kinoue et al 2003 2005 investigated the effect of blade profile under unidirectional sinusoidal and real sea flow conditions and indicated that the higher rotor solidity has better turbine starting characteristics shehata et al shehata et al 2017 used passive flow control technique to enhance the turbine performance of symmetrical airfoil in the stall regime it is shown that the torque coefficient of the blade is increased by 40 within stall regime and stall occurred more than before 17 ghisu et al ghisu et al 2017 investigated numerically how the dynamic effects are negligible on the turbine during acceleration and deceleration and there are no significant differences between the secondary flow structures which develop in the two phases table 1 summarizes the modifications of blade profiles under sinusoidal flow conditions the dynamic and hysteresis characteristics of unsteady aerodynamic phenomena have been investigated and indicated that the unsteady behavior of the dynamic stall is anticlockwise ericsson and reding 1987 kingdom 1998 leishman 1990 shida et al 1987 thakker et al 2008 zanotti and gibertini 2013 several articles studied the unsteady behavior by modifying design parameters such as blade pitch angle mohamed and shaaban 2013 blade profile shape kinoue et al 2003 leishman 1990 shida et al 1987 thakker et al 2008 raghunathan and tan 1985 mohamed et al 2011 blade sweep zanotti and gibertini 2013 mohamed and shaaban 2013 webster and gato 1999 end plate takao et al 2006 2007 blade solidity raghunathan and tan 1983 have also been reported 2 purpose of the present work the blade shape and sweep modification have a deep effect on the turbine performance therefore it is required to optimize the blade shape and sweep as well as finally finding the unsteady behavior of the turbine through numerical simulation typically a bidirectional flow turbine faces highly turbulent flow as the flow varies sinusoidally and reverses its direction in each wave sequence hence steady and unsteady flow simulations around the wells turbine under sinusoidal flow conditions have been carried out in this work blade profile thickness and sweep parameters are the design variables peak torque coefficient and the corresponding efficiency are considered as optimization objectives and the final analysis includes the grooved casing gc design the groove is introduced at the blade casing the parallel groove to the blade chord line and all along the circumference of the blade is added the groove had a depth of h from the blade tip and a width of w this article introduces a detailed approach to solve the unsteady flow problem around the turbine 3 numerical modeling fig 1 shows a typical wells turbine having a tip clearance of 1 and symmetric airfoils naca0015 torresi et al 2008 and used as a reference design for this problem the turbine has a stagger angle of 90 and rotates in one direction detailed specifications of the turbine are given in table 2 the ansys cfx v14 5 ansys cfx 2010 commercial code is a coupled solver which solves the fluid dynamic equations the flow is simulated using 3d reynolds averaged navier stokes rans equations with the k w sst model and discretized with the cell centered finite volume method torresi et al 2008 the high resolution and the second order schemes were applied for momentum and turbulence equations ansys cfx 2010 benini and biollo 2007 the flow was simulated for a single rotor blade with applied periodic condition on the domain the computational model is shown in fig 1c and the mesh were generated using gambit 2 4 6 fluent 2005 the structured mesh covered the entire computational domain near the blade surfaces dense grids were employed to capture flow features at the boundary layer zone several three dimensional grids varying 0 7 to 26 5 million cells with increasing density and quality have been tested for the baseline or reference blade configuration the coarsest grid is associated with a large variation of the performance parameters the grids employing more than 1 4 million cells lead to less than 2 variation in the target variables it is found that the average relative errors are approximately 2 and 3 for pressure coefficient and efficiency between the present cfd and experimental results respectively the grid independency test found the optimum numbers of elements and nodes which are 1 4 million and 1 3 million respectively fig 2 a total of 15 boundary layers were employed near the wall the average y value is 3 5 and the maximum y value is 7 1 as the cost of cfd simulations increases rapidly with the number of grid cells the number of cells between 1 3 and 1 4 million is maintained in the present paper table 3 illustrates the boundary conditions and the meshing details the no slip conditions are applied over the solid surfaces the mrf moving reference frame model is adopted in this work for the unsteady calculations one half of a wave period is considered the frequency of the inlet velocity is 0 1 hz evans and porter 1995 the unsteady analysis is initialized with the steady solution and the high resolution advection scheme is used for discretization of time terms second order backward euler method is used to control the convergence the residual target values are 10e 5 and the number of iterations in each time step is 1 30 the inlet flow has sinusoidal velocity profile fig 3 mathematically time step δγ is considered as 0 001s based on the cfl criteria the parallel computations are carried out in a two partition virgo super cluster with xeon 2 6 ghz dual core processor the time step is increased in three gradual steps from 0 001 to 0 01 to check time step independent result the results showed that the value of tangential forces are well matched during accelerating flow conditions while decelerating flow is less match the counterclockwise unsteady loop closely as shown in fig 4 generally fig 4 shows that the results are independence on the time step value the performance parameters are defined as static pressure drop 2 δ p δ p o ρ ω 2 r t i p 2 torque coefficient 3 t t ρ ω 2 r t i p 5 efficiency 4 η t ω q δ p o flow coefficient 5 u v u t i p 4 optimization methodology to check the unsteady behavior the authors applied the numerical technique on a reference blade with gc two optimized blades that produce higher torques and efficiencies in this case a gc design is also used to modify the blade shape an optimization is done using a surrogate coupled genetic algorithm fig 5 shows the optimization procedure five design variables from sweep angles and profile thickness are used to define the optimization problem and are modified fig 6 the objectives are to maximize the torque and the efficiency total 21 design points are used to fit the surrogate model the design variables and the design space are shown in table 4 the peak tc t and the corresponding eff η are selected as the objective functions the multi objective optimization via genetic algorithms gas deb 2001 mohamed et al mohamed et al 2010 mohammadi et al 2018 provides a set of optimum solutions a surrogate which mimics the high fidelity model approximately produces responses the degree of fidelity of the surrogate depends on the nature of data points used to construct it the kriging model based surrogates were fitted to generate populations for ga the ga requires a large number of expensive initial populations which are evaluated by the high fidelity cfd model the easiest way to reduce such expenses is surrogate construction and population generation from the surrogate ga produced feasible solutions are plotted in a pareto optimal front pof and clustered using the k means clustering algorithm in the present work the authors used their in house optimization code for surrogate coupled ga written in matlab after finding the pof two extreme design points or designs are further analyzed fig 7 shows that the gc design gives a better performance halder et al 2015 the groove is mounted circumferentially on the blade tip off the rotor a 3 casing groove is applied on the optimal and reference designs and unsteady flow is simulated surrogate models also called meta models or low fidelity models represent the scalable analytic models that are based on experimental or computational results and are used to approximate the multi variate input and the output behavior of a system the surrogates are problem depended and there is no the best surrogate model for all the problems different types of surrogate models are used to solve the engineering problems and second order polynomial or response surface approximation rsa kriging krg and radial basis neural network rbnn are the most prevalent surrogates each surrogate behaves differently for different problems in this work the above three surrogates are used and errors in data fitting in the surrogates are estimated the surrogate having the lowest error is used to search the optimal point then the flow field is analysis the rsa myers and montgomery 1995 is an assemble of statistical and mathematical techniques that used for improving developing and optimizing processes it is a second order polynomial function to fit the desired data the rbnn orr 1996 consists of three layer function such as an input layer a hidden layer and a linear output layer the spread constant sc and the error goal eg are the input parameters along with the data in this function a south african mining engineer krige first implemented the kriging model in spatial analysis and computer experiment the krg was implemented as a surrogate method by several authors matheron 1963 jeong et al 2005 simpson et al 2001 sacks et al 1989 it is a combination of a global model and a systematic departure from the mean 5 weighted average surrogate was model the weight average surrogate was is an ensemble of surrogate models goel et al 2007 acar and rais rohani 2009 the predicted response of the was model is defined as follows 6 f w a s w r s a f r s a w k r g f k r g w r b f f r b f in order to evaluate the cross validation error the data points are arbitrarily divided into n number of equal points to construct the surrogate n 1 points are used to fit a surrogate and the remaining point is used to estimate the error the surrogate is constructed n times and each of the n points is used for validation each time a surrogate is constructed hence n errors are obtained and the gross mean square error or the cv cross validation error is calculated a single surrogate gives only one e cv which is used to calculate weights of the surrogates eq 2 nasg ii non dominated sorting genetic algorithm ii is an efficient algorithm used to solve the multi objective optimization problems via pof deb et al 2002 the input of nsga ii is the initial population obtained from a surrogate and the solution proceeds through generations via mutations and crossovers the cfd or the surrogate models estimate the values of the objective functions at each design points a converged solution is obtained if a stopping criterion is reached in the present computation 50 generations are set as the stopping criterion and subsequently the pofs are produced the pareto optimal solutions are selected via clustering and reproduced through rans analysis 6 cfd validation fig 8 illustrates the result of pressure drop coefficient δp torque t and efficiency η for both unsteady sinusoidal flow and steady behaviors at wider flow coefficient for the bidirectional flow the continuous and dash lines are the steady and the unsteady result respectively the experimental results curran and gato 1997 and the numerical results halder et al 2015 match well with an unsteady clockwise loop the results showed that the pressure coefficient torque coefficient and efficiency for steady flow are closed to the matching the curve during acceleration flow of the unsteady cases however the decelerating flow does not match the counterclockwise unsteady loop closely similar hysteresis behavior was also reported in other literature kinoue et al 2004 2005 1 the stall can be detected once the torque coefficient peaks go down with the increase in flow coefficient the deep stall is noticed at u 0 225 and 0 226 for the steady and the unsteady cases sinusoidal flow respectively fig 8b the torque coefficient is fluctuated randomly after deep stall conditions a counterclockwise and clockwise hysteresis loop is noted for unsteady flow created using sinusoidal profile eq 1 the hysteresis loop helps in a dynamic stall due to the attached boundary layer reattachment of flow from le and detached vortex 7 results and discussions during optimization a design space defined by the ranges of the variables is decided table 4 and samples are collected by a sampling technique the samples are evaluated in a cfd solver and surrogates are constructed the surrogates fed population to the genetic algorithm to generate pof fig 9 finally five cluster points are selected and cfd simulations are done to cross check the genetic algorithm produced results in the present computations casing grooving only is applied to the optimal and reference cases and no to the sample points to find optimal point only steady simulations are done as each unsteady simulation needs several runs to converge into a single solution table 5 introduces the comparison of the optimal and the reference points among the cluster points two extreme points named as point a and point e are used for the comparative study and flow analysis the point a shows the highest torque coefficient and the corresponding lowest efficiency while the point e shows the opposite the steady and unsteady simulations for reference blade point a and point e with 3 casing groove are done the unsteady results for δp t and η are shown in fig 10 the continuous and dash lines are the steady and the unsteady result respectively the calculated numerical results show the clockwise unsteady loop which resembles the existing results halder et al 2015 counterclockwise unsteady loop for decelerated flow does not match closely and similar hysteresis behavior has been reported in earlier literature kinoue et al 2004 2005 the stall is observed at u 0 3 0 35 and 0 325 for the steady case and at u 0 325 0 375 and 0 325 for an unsteady case for reference point a point e designs respectively fig 10b figs 10 and 11 show that the reference blade with the casing groove attains the better performance in terms of efficiency as compared to those of the blades a and e in the accelerating and decelerating flow fig 11 shows that the flow velocity increases and turbine obtains energy from the air and after certain velocity the flow separates and the performance drops again the air velocity goes down the flow re attaches and the performance improves further analysis for the reference blade with the groove is selected as it performs better the circumferential contour line at the mid span of the flow passage is shown in fig 12 the denser contour lines are observed near the ss signifying the thicker boundary layer along the ps at u 0 06 and 0 23 the boundary layer separates at the ss in the accelerating and decelerating flows a larger flow separation can be noticed in the accelerating flow at u 0 35 and u 0 40 or in the deep stall conditions the flow reattachment can be seen along the ss in the decelerating flow similar unsteady behavior has also been reported in other literature kinoue et al 2003 the streamline patterns at the mid span of the flow passage can be seen in fig 13 for u 0 06 the flow patterns are almost same and attached to the blade surface for accelerating and declaring flows for u 0 23 a larger size the reverse flow appears near the te in the accelerating flow deep stall conditions are visible at u 0 35 and the flow separates near the le during the acceleration flow the decelerating flow has less separation at u 0 35 fig 14 shows the pressure coefficient cp variation on the ss the higher and the lower pressure values are at the te and le respectively for u 0 06 in the stalled and unstalled conditions the pressure variance is almost same for both cases from the le to the te the pressure difference is relatively higher in between the le to the te for the decelerating flow for u 0 23 and u 0 35 fig 10a the higher pressure region is observed near the te in the accelerating flow which corresponds to the flow separation in fig 13 similar observation was also noticed by kinoue et al kinoue et al 2003 for u 0 06 the streamlines remain attached on the ss for both the cases fig 15 at u 0 23 a larger corner vortex is observed in the accelerating flow a larger clockwise spiral vortex at u 0 35 can be seen near the hub le in the accelerating flow the static pressure is higher at the mid span of ss as shown in fig 16 at u 0 23 and 0 35 in the accelerating flow fig 17 shows the static pressure at the mid chord of the flow passage the pressure drops with the increase in flow coefficient for both the cases consequently the tip leakage flow increases interacts with the passage vortex and gives further flow separation for u 0 40 the turbine stalls completely and efficiency drops further the lower pressure region is near the blade midspan the tip vortex or tip separation at the tip of the blade increases with the flow coefficient fig 18 the leakage vortex on the ss grows in the accelerating flow and decreases in the decelerating flow at u 0 06 the flow remains close to the blade ss for both stalled and unstalled conditions for u 0 35 the tip leakage vortex appears near the ss in the decelerating flow on the other hand there is no tip leakage vortex in the accelerating flow u 0 35 the tangential vortices at the mid chord of the flow passage as shown in fig 19 shows that the tip leakage flow starts near the le and moves towards the te at u 0 40 the vortices are low in the accelerating flow and generate higher power fig 19 the tip leakage flow starts near the le and moves towards the te the higher vortex is generated from the blade tip surface whereas the vortex gets diminished by the casing boundary layer thereafter both the vortices passage and tip vortices bend near the blade ss for u 0 05 higher vortices are obtained near the ss however as the u increases from 0 23 to 0 40 the vortex decreases in the accelerating flow because of the low pressure region fig 17 on the other hand the vortex increases as the flow decelerate and move to near the ss such behavior is again consistent with the unsteady flow of the stalled and unstalled conditions 8 effect of blade sweep shape and casing groove on the hysteretic behavior fig 10 shows the effect of blade sweep shape and casing groove on the hysteresis behavior of the wells turbine it is observed that the peak torque coefficient is found for optimum blade a as compared to the reference and optimum blade e fig 20 shows the streamlines pattern on the ss of the blade for optimum blade a and e comparing fig 20 with fig 15 it can observe that the flow separates near the hub surface than the blade tip surface for optimum blade e and reference blade of the accelerating and decelerating flow however the flow separation near the hub on the ss comparatively less for optimum blade a of the accelerating and decelerating flow the result can be supported why optimum blade a is higher torque coefficient for hysteresis loop compared to the optimum design e and reference blade comparing fig 21 with fig 13 it is noticed that higher separation is found at the blade suction side for reference blade and optimum blade e as compared to the optimum blade a of the accelerating and decelerating flow the static pressure distribution at the mid chord of the flow passage is shown in fig 22 it is observed that the lower pressure region is noticed at the suction side for optimum blade e fig 22 and reference blade fig 17 as compared to the optimum blade a fig 22 of the accelerating and decelerating flow 9 conclusions an optimization and analysis by numerical modeling of a wells turbine have been done in this work to find the effect of blade sweep blade profile and groove depth under steady and unsteady flow condition numerical simulations are carried out by solving unsteady three dimensional rans equations the main inferences are summarized as follows a hysteresis characteristic loop consisting counter clockwise and clockwise variation of the performance parameters is observed in the unsteady simulations results the reference blade with grooved casing performs better in terms of efficiency the unsteady performance is more sensitive to the groove depth as compared to the cases with the combined blade thickness and blade profile change with grooved casing larger flow separation appears in the accelerating flow along the suction surface as compared to the decelerating flow the lower pressure region is found near the mid span of the blade in the decelerating flow than the accelerating flow which means a higher pressure difference in the unstalled conditions the efficiency is increased by 8 and the torque coefficient decreased by 17 4 during unstalled conditions considered peak torque based on stalled and unstalled conditions 
23644,modified wells turbines allow an efficient use of the power contained in the ocean and sea waves the present study introduces the performance of an axial turbine which called wells turbine this turbine is used in oscillating water column owc wave energy conversion devices this type of axial turbine is investigated through numerical analysis and optimization unsteady 3d reynolds averaged navier stokes equations were solved with k ω sst turbulence closer model a comparative study of optimized and conventional blades with steady and unsteady flows has been presented for shape optimization blade profile thickness and sweep modifications along with and without grooved casing gc designs are considered the results concluded that the reference blade with gc performs better in terms of torque coefficient and efficiency if the flow is attached the unsteady flow gives a stream wise circulation near the blade suction surface the groove changes the tip vortex and helps to suppress the flow separation in addition the effect of blade sweep profile variation and groove depth on the hysteresis behavior of the wells turbine has been investigated in this work keywords blade thickness casing groove blade sweep wells turbine unsteady flow wave energy 1 introduction in 1976 professor wells of the queen s university of belfast proposed a self rectifying axial flow air turbine suitable for the owc the turbine is called wells turbine in its simplest form the air turbine rotor consists of several symmetric airfoil blades positioned around a hub as shown in fig 1 a because of simplicity in design the turbine has been widely applied for wave energy conversion and an important amount of research and developments have been done in many countries many research programs attempting to garner energy from sea waves depend on the oscillating water column owc as the energy converter mechanism keskin citiroglu and okur 2014 he et al 2013 ning et al 2016 in such a mechanism the water wave energy is converted to pneumatic energy in the air which flows reciprocally across a self rectifying axial air flow turbine called a wells turbine the wells turbine is an axial flow and self rectifying works on the bidirectional flow and produces unidirectional shaft rotation several researchers studied steady and unsteady behavior of this turbine to predict the performance brito melo et al 2002 raghunathan 1995 torresi et al 2008 halder et al 2015 taha et al 2010 the turbine has disadvantages such as low efficiency poor starting characteristics and low power output hence it is required to redesign the turbine to improve its output power and aerodynamic efficiency in wider wave variability kim et al 2001 inoue et al 1986a reported the performance of the turbine based on starting and running characteristics and modified blade solidity setting angle tip to chord ratio etc the solidity has a higher performance sensitivity than that of the setting angle or the tip to chord ratio setoguchi et al 1998 2003 the performance of the turbine varies during inhaling and exhaling of the air puddu et al 2014 and is better during the outflow phase compared kim at el kim et al 2002a reported the effect of blade thickness and angle of attack and found hysteresis characteristics under sinusoidal flow conditions the blade thickness and the angle of attack were more effective on the turbine performance than the setting angle and the gap to chord ratio shabaan shaaban 2016a 2016b numerically optimized the performance of wells turbine with rotor radial solidity distribution das et al das et al 2017 discussed different type owc device and optimization techniques the results indicated that the optimized geometry enhanced better performance than others the anticlockwise hysteresis loop in the decelerating flow leads to a flow separation on the suction surface ss near the hub whereas the clockwise hysteresis loop in the in the accelerating flow is related to the separation on the suction surface near the tip kinoue et al 2003 2005 the second law efficiency and entropy generation characteristics for the blade with naca0015 profile under unsteady flow showed better than that of the naca0012 naca0020 and naca0021 blades shehata et al 2016 thakker and abdulhadi kinoue et al 2003 2005 investigated the effect of blade profile under unidirectional sinusoidal and real sea flow conditions and indicated that the higher rotor solidity has better turbine starting characteristics shehata et al shehata et al 2017 used passive flow control technique to enhance the turbine performance of symmetrical airfoil in the stall regime it is shown that the torque coefficient of the blade is increased by 40 within stall regime and stall occurred more than before 17 ghisu et al ghisu et al 2017 investigated numerically how the dynamic effects are negligible on the turbine during acceleration and deceleration and there are no significant differences between the secondary flow structures which develop in the two phases table 1 summarizes the modifications of blade profiles under sinusoidal flow conditions the dynamic and hysteresis characteristics of unsteady aerodynamic phenomena have been investigated and indicated that the unsteady behavior of the dynamic stall is anticlockwise ericsson and reding 1987 kingdom 1998 leishman 1990 shida et al 1987 thakker et al 2008 zanotti and gibertini 2013 several articles studied the unsteady behavior by modifying design parameters such as blade pitch angle mohamed and shaaban 2013 blade profile shape kinoue et al 2003 leishman 1990 shida et al 1987 thakker et al 2008 raghunathan and tan 1985 mohamed et al 2011 blade sweep zanotti and gibertini 2013 mohamed and shaaban 2013 webster and gato 1999 end plate takao et al 2006 2007 blade solidity raghunathan and tan 1983 have also been reported 2 purpose of the present work the blade shape and sweep modification have a deep effect on the turbine performance therefore it is required to optimize the blade shape and sweep as well as finally finding the unsteady behavior of the turbine through numerical simulation typically a bidirectional flow turbine faces highly turbulent flow as the flow varies sinusoidally and reverses its direction in each wave sequence hence steady and unsteady flow simulations around the wells turbine under sinusoidal flow conditions have been carried out in this work blade profile thickness and sweep parameters are the design variables peak torque coefficient and the corresponding efficiency are considered as optimization objectives and the final analysis includes the grooved casing gc design the groove is introduced at the blade casing the parallel groove to the blade chord line and all along the circumference of the blade is added the groove had a depth of h from the blade tip and a width of w this article introduces a detailed approach to solve the unsteady flow problem around the turbine 3 numerical modeling fig 1 shows a typical wells turbine having a tip clearance of 1 and symmetric airfoils naca0015 torresi et al 2008 and used as a reference design for this problem the turbine has a stagger angle of 90 and rotates in one direction detailed specifications of the turbine are given in table 2 the ansys cfx v14 5 ansys cfx 2010 commercial code is a coupled solver which solves the fluid dynamic equations the flow is simulated using 3d reynolds averaged navier stokes rans equations with the k w sst model and discretized with the cell centered finite volume method torresi et al 2008 the high resolution and the second order schemes were applied for momentum and turbulence equations ansys cfx 2010 benini and biollo 2007 the flow was simulated for a single rotor blade with applied periodic condition on the domain the computational model is shown in fig 1c and the mesh were generated using gambit 2 4 6 fluent 2005 the structured mesh covered the entire computational domain near the blade surfaces dense grids were employed to capture flow features at the boundary layer zone several three dimensional grids varying 0 7 to 26 5 million cells with increasing density and quality have been tested for the baseline or reference blade configuration the coarsest grid is associated with a large variation of the performance parameters the grids employing more than 1 4 million cells lead to less than 2 variation in the target variables it is found that the average relative errors are approximately 2 and 3 for pressure coefficient and efficiency between the present cfd and experimental results respectively the grid independency test found the optimum numbers of elements and nodes which are 1 4 million and 1 3 million respectively fig 2 a total of 15 boundary layers were employed near the wall the average y value is 3 5 and the maximum y value is 7 1 as the cost of cfd simulations increases rapidly with the number of grid cells the number of cells between 1 3 and 1 4 million is maintained in the present paper table 3 illustrates the boundary conditions and the meshing details the no slip conditions are applied over the solid surfaces the mrf moving reference frame model is adopted in this work for the unsteady calculations one half of a wave period is considered the frequency of the inlet velocity is 0 1 hz evans and porter 1995 the unsteady analysis is initialized with the steady solution and the high resolution advection scheme is used for discretization of time terms second order backward euler method is used to control the convergence the residual target values are 10e 5 and the number of iterations in each time step is 1 30 the inlet flow has sinusoidal velocity profile fig 3 mathematically time step δγ is considered as 0 001s based on the cfl criteria the parallel computations are carried out in a two partition virgo super cluster with xeon 2 6 ghz dual core processor the time step is increased in three gradual steps from 0 001 to 0 01 to check time step independent result the results showed that the value of tangential forces are well matched during accelerating flow conditions while decelerating flow is less match the counterclockwise unsteady loop closely as shown in fig 4 generally fig 4 shows that the results are independence on the time step value the performance parameters are defined as static pressure drop 2 δ p δ p o ρ ω 2 r t i p 2 torque coefficient 3 t t ρ ω 2 r t i p 5 efficiency 4 η t ω q δ p o flow coefficient 5 u v u t i p 4 optimization methodology to check the unsteady behavior the authors applied the numerical technique on a reference blade with gc two optimized blades that produce higher torques and efficiencies in this case a gc design is also used to modify the blade shape an optimization is done using a surrogate coupled genetic algorithm fig 5 shows the optimization procedure five design variables from sweep angles and profile thickness are used to define the optimization problem and are modified fig 6 the objectives are to maximize the torque and the efficiency total 21 design points are used to fit the surrogate model the design variables and the design space are shown in table 4 the peak tc t and the corresponding eff η are selected as the objective functions the multi objective optimization via genetic algorithms gas deb 2001 mohamed et al mohamed et al 2010 mohammadi et al 2018 provides a set of optimum solutions a surrogate which mimics the high fidelity model approximately produces responses the degree of fidelity of the surrogate depends on the nature of data points used to construct it the kriging model based surrogates were fitted to generate populations for ga the ga requires a large number of expensive initial populations which are evaluated by the high fidelity cfd model the easiest way to reduce such expenses is surrogate construction and population generation from the surrogate ga produced feasible solutions are plotted in a pareto optimal front pof and clustered using the k means clustering algorithm in the present work the authors used their in house optimization code for surrogate coupled ga written in matlab after finding the pof two extreme design points or designs are further analyzed fig 7 shows that the gc design gives a better performance halder et al 2015 the groove is mounted circumferentially on the blade tip off the rotor a 3 casing groove is applied on the optimal and reference designs and unsteady flow is simulated surrogate models also called meta models or low fidelity models represent the scalable analytic models that are based on experimental or computational results and are used to approximate the multi variate input and the output behavior of a system the surrogates are problem depended and there is no the best surrogate model for all the problems different types of surrogate models are used to solve the engineering problems and second order polynomial or response surface approximation rsa kriging krg and radial basis neural network rbnn are the most prevalent surrogates each surrogate behaves differently for different problems in this work the above three surrogates are used and errors in data fitting in the surrogates are estimated the surrogate having the lowest error is used to search the optimal point then the flow field is analysis the rsa myers and montgomery 1995 is an assemble of statistical and mathematical techniques that used for improving developing and optimizing processes it is a second order polynomial function to fit the desired data the rbnn orr 1996 consists of three layer function such as an input layer a hidden layer and a linear output layer the spread constant sc and the error goal eg are the input parameters along with the data in this function a south african mining engineer krige first implemented the kriging model in spatial analysis and computer experiment the krg was implemented as a surrogate method by several authors matheron 1963 jeong et al 2005 simpson et al 2001 sacks et al 1989 it is a combination of a global model and a systematic departure from the mean 5 weighted average surrogate was model the weight average surrogate was is an ensemble of surrogate models goel et al 2007 acar and rais rohani 2009 the predicted response of the was model is defined as follows 6 f w a s w r s a f r s a w k r g f k r g w r b f f r b f in order to evaluate the cross validation error the data points are arbitrarily divided into n number of equal points to construct the surrogate n 1 points are used to fit a surrogate and the remaining point is used to estimate the error the surrogate is constructed n times and each of the n points is used for validation each time a surrogate is constructed hence n errors are obtained and the gross mean square error or the cv cross validation error is calculated a single surrogate gives only one e cv which is used to calculate weights of the surrogates eq 2 nasg ii non dominated sorting genetic algorithm ii is an efficient algorithm used to solve the multi objective optimization problems via pof deb et al 2002 the input of nsga ii is the initial population obtained from a surrogate and the solution proceeds through generations via mutations and crossovers the cfd or the surrogate models estimate the values of the objective functions at each design points a converged solution is obtained if a stopping criterion is reached in the present computation 50 generations are set as the stopping criterion and subsequently the pofs are produced the pareto optimal solutions are selected via clustering and reproduced through rans analysis 6 cfd validation fig 8 illustrates the result of pressure drop coefficient δp torque t and efficiency η for both unsteady sinusoidal flow and steady behaviors at wider flow coefficient for the bidirectional flow the continuous and dash lines are the steady and the unsteady result respectively the experimental results curran and gato 1997 and the numerical results halder et al 2015 match well with an unsteady clockwise loop the results showed that the pressure coefficient torque coefficient and efficiency for steady flow are closed to the matching the curve during acceleration flow of the unsteady cases however the decelerating flow does not match the counterclockwise unsteady loop closely similar hysteresis behavior was also reported in other literature kinoue et al 2004 2005 1 the stall can be detected once the torque coefficient peaks go down with the increase in flow coefficient the deep stall is noticed at u 0 225 and 0 226 for the steady and the unsteady cases sinusoidal flow respectively fig 8b the torque coefficient is fluctuated randomly after deep stall conditions a counterclockwise and clockwise hysteresis loop is noted for unsteady flow created using sinusoidal profile eq 1 the hysteresis loop helps in a dynamic stall due to the attached boundary layer reattachment of flow from le and detached vortex 7 results and discussions during optimization a design space defined by the ranges of the variables is decided table 4 and samples are collected by a sampling technique the samples are evaluated in a cfd solver and surrogates are constructed the surrogates fed population to the genetic algorithm to generate pof fig 9 finally five cluster points are selected and cfd simulations are done to cross check the genetic algorithm produced results in the present computations casing grooving only is applied to the optimal and reference cases and no to the sample points to find optimal point only steady simulations are done as each unsteady simulation needs several runs to converge into a single solution table 5 introduces the comparison of the optimal and the reference points among the cluster points two extreme points named as point a and point e are used for the comparative study and flow analysis the point a shows the highest torque coefficient and the corresponding lowest efficiency while the point e shows the opposite the steady and unsteady simulations for reference blade point a and point e with 3 casing groove are done the unsteady results for δp t and η are shown in fig 10 the continuous and dash lines are the steady and the unsteady result respectively the calculated numerical results show the clockwise unsteady loop which resembles the existing results halder et al 2015 counterclockwise unsteady loop for decelerated flow does not match closely and similar hysteresis behavior has been reported in earlier literature kinoue et al 2004 2005 the stall is observed at u 0 3 0 35 and 0 325 for the steady case and at u 0 325 0 375 and 0 325 for an unsteady case for reference point a point e designs respectively fig 10b figs 10 and 11 show that the reference blade with the casing groove attains the better performance in terms of efficiency as compared to those of the blades a and e in the accelerating and decelerating flow fig 11 shows that the flow velocity increases and turbine obtains energy from the air and after certain velocity the flow separates and the performance drops again the air velocity goes down the flow re attaches and the performance improves further analysis for the reference blade with the groove is selected as it performs better the circumferential contour line at the mid span of the flow passage is shown in fig 12 the denser contour lines are observed near the ss signifying the thicker boundary layer along the ps at u 0 06 and 0 23 the boundary layer separates at the ss in the accelerating and decelerating flows a larger flow separation can be noticed in the accelerating flow at u 0 35 and u 0 40 or in the deep stall conditions the flow reattachment can be seen along the ss in the decelerating flow similar unsteady behavior has also been reported in other literature kinoue et al 2003 the streamline patterns at the mid span of the flow passage can be seen in fig 13 for u 0 06 the flow patterns are almost same and attached to the blade surface for accelerating and declaring flows for u 0 23 a larger size the reverse flow appears near the te in the accelerating flow deep stall conditions are visible at u 0 35 and the flow separates near the le during the acceleration flow the decelerating flow has less separation at u 0 35 fig 14 shows the pressure coefficient cp variation on the ss the higher and the lower pressure values are at the te and le respectively for u 0 06 in the stalled and unstalled conditions the pressure variance is almost same for both cases from the le to the te the pressure difference is relatively higher in between the le to the te for the decelerating flow for u 0 23 and u 0 35 fig 10a the higher pressure region is observed near the te in the accelerating flow which corresponds to the flow separation in fig 13 similar observation was also noticed by kinoue et al kinoue et al 2003 for u 0 06 the streamlines remain attached on the ss for both the cases fig 15 at u 0 23 a larger corner vortex is observed in the accelerating flow a larger clockwise spiral vortex at u 0 35 can be seen near the hub le in the accelerating flow the static pressure is higher at the mid span of ss as shown in fig 16 at u 0 23 and 0 35 in the accelerating flow fig 17 shows the static pressure at the mid chord of the flow passage the pressure drops with the increase in flow coefficient for both the cases consequently the tip leakage flow increases interacts with the passage vortex and gives further flow separation for u 0 40 the turbine stalls completely and efficiency drops further the lower pressure region is near the blade midspan the tip vortex or tip separation at the tip of the blade increases with the flow coefficient fig 18 the leakage vortex on the ss grows in the accelerating flow and decreases in the decelerating flow at u 0 06 the flow remains close to the blade ss for both stalled and unstalled conditions for u 0 35 the tip leakage vortex appears near the ss in the decelerating flow on the other hand there is no tip leakage vortex in the accelerating flow u 0 35 the tangential vortices at the mid chord of the flow passage as shown in fig 19 shows that the tip leakage flow starts near the le and moves towards the te at u 0 40 the vortices are low in the accelerating flow and generate higher power fig 19 the tip leakage flow starts near the le and moves towards the te the higher vortex is generated from the blade tip surface whereas the vortex gets diminished by the casing boundary layer thereafter both the vortices passage and tip vortices bend near the blade ss for u 0 05 higher vortices are obtained near the ss however as the u increases from 0 23 to 0 40 the vortex decreases in the accelerating flow because of the low pressure region fig 17 on the other hand the vortex increases as the flow decelerate and move to near the ss such behavior is again consistent with the unsteady flow of the stalled and unstalled conditions 8 effect of blade sweep shape and casing groove on the hysteretic behavior fig 10 shows the effect of blade sweep shape and casing groove on the hysteresis behavior of the wells turbine it is observed that the peak torque coefficient is found for optimum blade a as compared to the reference and optimum blade e fig 20 shows the streamlines pattern on the ss of the blade for optimum blade a and e comparing fig 20 with fig 15 it can observe that the flow separates near the hub surface than the blade tip surface for optimum blade e and reference blade of the accelerating and decelerating flow however the flow separation near the hub on the ss comparatively less for optimum blade a of the accelerating and decelerating flow the result can be supported why optimum blade a is higher torque coefficient for hysteresis loop compared to the optimum design e and reference blade comparing fig 21 with fig 13 it is noticed that higher separation is found at the blade suction side for reference blade and optimum blade e as compared to the optimum blade a of the accelerating and decelerating flow the static pressure distribution at the mid chord of the flow passage is shown in fig 22 it is observed that the lower pressure region is noticed at the suction side for optimum blade e fig 22 and reference blade fig 17 as compared to the optimum blade a fig 22 of the accelerating and decelerating flow 9 conclusions an optimization and analysis by numerical modeling of a wells turbine have been done in this work to find the effect of blade sweep blade profile and groove depth under steady and unsteady flow condition numerical simulations are carried out by solving unsteady three dimensional rans equations the main inferences are summarized as follows a hysteresis characteristic loop consisting counter clockwise and clockwise variation of the performance parameters is observed in the unsteady simulations results the reference blade with grooved casing performs better in terms of efficiency the unsteady performance is more sensitive to the groove depth as compared to the cases with the combined blade thickness and blade profile change with grooved casing larger flow separation appears in the accelerating flow along the suction surface as compared to the decelerating flow the lower pressure region is found near the mid span of the blade in the decelerating flow than the accelerating flow which means a higher pressure difference in the unstalled conditions the efficiency is increased by 8 and the torque coefficient decreased by 17 4 during unstalled conditions considered peak torque based on stalled and unstalled conditions 
