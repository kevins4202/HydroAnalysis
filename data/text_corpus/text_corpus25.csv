index,text
125,synthetic design storms are often used to plan new drainage systems or assess flood impacts on infrastructure to simulate extreme rainfall events under climate change design storms can be modified to match a different return frequency of extreme rainfall events as well as a modified temporal distribution of rainfall intensities however the same magnitude of change to the rainfall intensities is often applied in space several hydrological applications are limited by this climate change impacts on urban pluvial floods for example require the use of 2d design storms rainfall fields at sub kilometer and sub hourly scales recent kilometer scale climate models also known as convection permitting climate models cpm provide rainfall outputs at a high spatial resolution although rainfall simulations are still restricted to a limited number of climate scenarios and time periods we nevertheless explored the potential use of rainfall data obtained from these models for hydrological flood impact studies by introducing a method of spatial quantile mapping sqm to demonstrate the new methodology we extracted high resolution rainfall simulations from a cpm for four domains representing different urban areas in switzerland extreme storms that are plausible under the present climate conditions were simulated with a 2d stochastic rainfall model based on the cpm informed stochastically generated rainfall fields we modified the design storms to fit the future climate scenario using three different methods the sqm a uniform quantile mapping and a uniform adjustment based on a rainfall temperature relationship throughout all storms the temporal distribution of rainfall was the same using a flood model we assessed the impact of different rainfall adjustment methods on urban flooding significant differences were found in the flood water depths and areas between the three methods in general the sqm method results in a higher flood impact than the storms that were modified otherwise the results suggest that spatial storm profiles may need to be re adjusted when assessing flood impacts graphical abstract keywords spatial quantile mapping extreme rainfall urban flood high resolution rainfall climate change 1 introduction floods are one of the main natural hazards contributing to massive economic losses and casualties paprotny et al 2018 especially vulnerable to damage from river overflows and flash floods are urban areas which contain significant concentrations of infrastructure including residential commercial and industrial structures gueneralp et al 2015 flash floods are commonly triggered by short duration but intense rainfall bursts e g fowler et al 2021b while river overflows are caused primarily by prolonged rainfall events and other climate factors such as snow melt and evaporation see bloeschl et al 2019 global warming is predicted to cause both short and long duration extreme rainfall events to occur more frequently and with greater intensity in the future trenberth 2011 westra et al 2014 moustakis et al 2021 fowler et al 2021a consequently higher flood frequencies damages and economic losses are predicted hirabayashi et al 2013 jongman et al 2014 mallakpour and villarini 2015 design storms are a commonly used tool for assessing flood impacts sun et al 2011 they are often synthetic hyetographs that represent extreme rainfall events for a given return period and storm duration berk et al 2017 hyetographs can either have a simple bell like shape with a length and maximum rainfall intensity matching observed extreme rainfall events or they can be stochastically modeled to simulate pseudo extreme rainfall events onof et al 2000 chimene and campos 2020 on the basis of climate model data their intensities can be adapted to reflect extreme rainfall events at future climates e g berggren et al 2014 peleg et al 2015 design storms can be conceptualized at a point scale i e in a one dimensional 1d spatial configuration representing the areal rainfall over a catchment onof et al 2000 in some circumstances however using design storms with a two dimensional 2d configuration is more appropriate e g paschalis et al 2014 niemi et al 2016 peleg et al 2020 especially when extreme rainfall events are convective in nature as they often exhibit a high degree of spatial heterogeneity belachsen et al 2017 additionally fast response catchments such as those in mountainous or urban areas are sensitive to rainfall heterogeneity peleg et al 2017a moraga et al 2021 making spatially distributed simulations necessary another advantage of using stochastic models to simulate design storms is that their output is an ensemble of multiple space time realizations of the storm since stochastic space time variability is a significant source of uncertainty in hydrological impacts fatichi et al 2016 peleg et al 2017a moraga et al 2021 it is beneficial to simulate it in order to for example evaluate the effects of climate change on changes in storm properties on flood statistics a number of stochastic models are available to simulate 2d design storms these include the streap model paschalis et al 2013 the hires wg peleg and morin 2014 and the storm model singer et al 2018 among others in many locations we can estimate how the magnitude duration and temporal structure of storm hyetographs will likely change under future climate conditions climate models can provide this type of information or it can be obtained from empirical relationships between extreme rainfall properties and climate variables such as temperature increase ban et al 2014 wasko and sharma 2015 li et al 2018 moustakis et al 2020 ali et al 2021 it is possible to modify 1d design storms for climate change impact studies when this information is available e g olsson et al 2013 global warming is also projected to change the spatial patterns of extreme rainfall a number of studies linked changes in temperature to changes in storm extent and spatial heterogeneity of rainfall fields wasko et al 2016 lochbihler et al 2017 peleg et al 2018 chen et al 2021 climate induced changes in the spatial properties of extreme rainfall have been found to influence catchment hydrological responses peleg et al 2020 2021 as a result when using 2d design storms it is crucial not only to modify the rainfall intensities and temporal structure but also the spatial structure of the storm convection permitting climate models cpm can simulate rainfall fields at high spatial and temporal resolution i e on kilometers and sub hour scales prein et al 2015 schär et al 2020 as a result of their high computational demand and the time required to run them cpm are not currently used to simulate a wide range of emissions scenarios for long periods of time e g simulating the entire 21st century thus cpm data tend to underrepresent low frequency intense storms consequently in the vast majority of cases their data cannot be used directly for hydrological flood assessment studies their data can be used to understand how for example rainfall intensities are affected by air temperatures lenderink et al 2021 allowing design storms to be adjusted accordingly based on their ability to explicitly simulate deep convection these models have proven to reproduce the spatial structure of rainfall adequately at the kilometer scale for numerous areas ban et al 2014 2021 leutwyler et al 2017 including over complex terrain e g lind et al 2020 in the context of climate change cpm can be used to investigate how the spatial structure of extreme storms will change in the future e g prein et al 2017 2020 chen et al 2021 while theoretically this information can be used to alter the spatial structure of 2d design storms for flood assessment applications in practice this has not been done yet in this paper we describe a new spatial quantile mapping technique that allows for the modification of the spatial structure of 2d design storms the extreme storm observed in lausanne in summer 2018 served as our case study in order to construct a 2d design storm and modify its spatial structure to fit future climate conditions with our 2d modified design storm we examined flood statistics in four swiss cities using a flood inundation model and discuss the importance of modifying the spatial structure of storms by comparing our new method with other widely used methods that allow changes in storm magnitude but lack the spatial dimension 2 rainfall adjustment methods we simulated a 2d design storm altered it spatially to take into account the modifications expected due to climate change and examined the changes in flood statistics in addition we also tested two other non spatial rainfall modification methods these processes are illustrated and explained in fig 1 the methods for modifying the rainfall patterns and intensity are explained in the subsequent subsections and the numerical experiment we conducted as a case study is described in section 3 2 1 spatial quantile mapping the initial step in performing the spatial quantile mapping sqm method is to calculate storm composites using the cpm both for storms occurring in the present climate fig 2a and future climate fig 2b the choice of storms to include depends on the application suppose the aim is to modify a design storm that represents a 10 year return period the relevant rain fields for this return period should then be extracted from an archive of present and future cpm simulations the storm composite is constructed by centering each rainfall field from the 10 year storm archive on the location of their maximum rainfall intensity over one another and calculating the mean of the rainfall intensities at each grid cell we assume that the spatial structure of the storm composite is stationary and that the adjustment factors derived from the composite can be applied to each distinct rainfall field of the design storm the empirical cumulative distribution function cdf of the spatial rainfall intensities of the present and future storms is then compiled fig 2c the rainfall intensities obtained from the storm composites are sorted and linearly ranked from the lowest rainfall intensity s q 0 to the highest s q 1 linear interpolation is used to compute rain intensity continuous over the entire quantile ranges s q 0 1 in most cases it is possible to fit a probability distribution to the data instead of the empirical cdf for example the rain fields presented in fig 2 can be fitted with a lognormal distribution which is a common probability distribution in rain fields e g cho et al 2004 in order to calculate the adjustment factor of rainfall intensity per quantile c f s q we divide the future storm profile p r s q f by the present storm profile p r s q p both are illustrated in fig 2c 1 c f s q p r s q f p r s q p the adjustment factor can then be applied to adjust the rainfall intensities of the design storm 2 r i s q f r i s q p c f s q where i are the individual rain fields composing the design storm r in addition to changes in rainfall intensity it is likely that the area of the storm will change in the future adjusting the area of the storm is therefore also necessary and should be applied per rainfall field it is essential to know which probability distribution the rainfall intensities follow in space in order to perform the adjustment the area adjustment procedure is done as follows i the rainfall intensity field is transformed into its quantile field ii a random quantile vector is generated with the size of the wet number of grid cells representing the new area iii in the quantile field dry grid cells that are close to wet grid cells by euclidean distance are converted into wet grid cells so as to reach the desired storm area iv the quantiles from the second step are assigned to the quantile field and v the quantile field is back transformed into a rainfall intensity field using this procedure the area of the rainfall field can be modified while the storm spatial structure remains largely intact in the case of shrinking fields the same procedure can be applied but in step iii the grid cells with the lowest rainfall intensities are classified as dry until the desired rainfall area is met as an example we used a rainfall field characterized by a spatial lognormal distribution fig 3a the following parameters can be derived from this synthetic rainfall field the mean areal rainfall r ˆ the total wetted area r a and the spatial rainfall coefficient of variation r c v based on this information the rainfall field can be transformed into its quantile field fig 3b using the following transformation see paschalis et al 2013 peleg et al 2020 for details 3 q x y l n r x y l o g r a r c v 2 1 l o g r c v 2 1 where q x y is the quantile field obtained from the l n cumulative lognormal distribution r x y is the rainfall intensity field l o g r a r c v 2 1 is the μ parameter and l o g r c v 2 1 is the σ parameter of the probability distribution the next step is to generate the quantile vector q n with a length that correspond to the number of grid cells of the newly desired area 4 q n n 1 n 0 1 0 1 where n 1 is the inverse cumulative normal distribution and n is a randomly generated normal vector a zero mean unit variance gaussian the length of q n determines the new area of the rainfall field r a and is defined as r a r a c f a where c f a is the adjustment factor of the total wetted area obtained from dividing the future total wetted area of the rainfall composite with the present one using a simple image morphological dilation method e g van den boomgaard and van balen 1992 the quantile field q x y is then adjusted to match the desired area and the values of the simulated vector q n are sorted similarly to the original field and assigned to the newly adjusted quantile field q x y fig 3c by using a morphological method to adjust the wetted area we assume that the spatial correlation structure of the rainfall field is approximately stationary i e changes in the spatial correlation structure due to climate change are not explicitly accounted for the newly adjusted quantile field is finally back transformed into a rainfall intensity field 5 r x y l n 1 q x y l o g r a r c v 2 1 l o g r c v 2 1 where r x y is the new rainfall intensity field fig 3d q x y is the adjusted quantile field fig 3c and l n 1 is the inverse cumulative lognormal distribution the above example used the lognormal distribution but the same procedure can be applied to any probability distribution 2 2 other rainfall adjustment methods the two other non spatial rainfall modification methods that were used here are a uniform adjustment based on a rainfall temperature relationship cc relation and uniform quantile mapping uqm methods fig 1 the first is based on the well known clausius clapeyron relation trenberth et al 2003 that link extreme rainfall intensification mostly convective in type and increase in temperature see recent publications by moustakis et al 2020 ali et al 2021 fowler et al 2021a among many others based on the assumption that the rainfall will intensify at a rate of 7 c 1 a valid assumption for switzerland molnar et al 2015 ban et al 2015 we defined the rainfall intensification factor as follows 6 c c 1 0 7 t where c c is the clausius clapeyron intensification factor that is determined by the increase in temperature t the new rainfall field r x y is simply a multiplication of r x y with c c the uqm is expressed as 7 r x y f 1 u r x y where u is the quantile function and f 1 is an inverse cumulative probability distribution function we used the generalized pareto distribution in our case study as in peleg et al 2017b it was fitted to the cpm s rainfall intensities of the present climate replacing u and of the future climate replacing f 1 3 modifying an intense storm a case study the numerical experiment is illustrated in fig 1 as our case study we selected the extreme storm recorded over the city of lausanne section 3 1 applying a stochastic rainfall generator model we simulated multiple realizations of this storm section 3 2 then we evaluated the abilities of cpm to generate extreme rainfall in this region section 3 3 and determined how the spatial structure of the storm is expected to change section 3 4 we duplicated the lausanne storm for four other cities in switzerland fig 4 which are considerably larger than lausanne and modified its spatial structure using the methods listed in section 2 the selected cities are located in different climatic zones with different urban forms and terrain characteristics thus representing a wide variety of urban hydrological responses to extreme rainfall as a final step we used an inundation model section 3 5 to examine the hydrological response 3 1 the lausanne storm on june 11th 2018 an intense convective storm swept through the city of lausanne in switzerland fig 4 the storm lasted for four hours between 7 pm and 11 pm local time and is the most intense short rain burst ever recorded in switzerland at around 9 pm a rain gauge in the city s vicinity lsn recorded a peak of 41 mm of rainfall within 10 min fig 5 the rain burst flooded several streets and the underground metro system causing damage but no casualties the storm was captured not only by the local rain gauge but also by the meteoswiss weather radar system which enabled the analysis of the space time evolution of the storm at a fine resolution of 1 km and 5 min germann et al 2015 a 16 km x 16 km window centered over lausanne was used to analyze the storm s mean areal rainfall intensity r ˆ rainfall spatial structure r c v and fraction of wetted area r a fig 5 3 2 stochastic rainfall generator model stochastic rainfall generators are used to simulate extreme storms for flood assessments especially in urban areas mcrobie et al 2013 peleg et al 2017a the models can be used to generate multiple storms with extreme rainfall events for a given climate or they can be used to generate individual extreme storms with a known return period storms simulated by gridded rainfall generators can be parameterized to reproduce the temporal structure of an observed extreme rainfall event such as the storm duration and the temporal distribution of mean rainfall over the domain but differ in the spatial distribution of rainfall intensities within the domain we simulated the design storm with the streap rainfall generator model paschalis et al 2013 which was used in several climate impact studies in the past paschalis et al 2014 skinner et al 2020 peleg et al 2020 2021 nyman et al 2021 ramirez et al 2022 among others we first obtained the information needed to stochastically generate a design storm that will have similar spatial characteristics of a real storm i e a time series of r ˆ r a r c v and mean advection velocity and direction these parameters can all be determined using weather radar data then we used the fast fourier transform method to simulate a gaussian mixture bimodal quantile field as we found that it enable a better representation of the convective structure of the rainfall we allowed the quantile fields to advect and evolve over time using an auto regressive moving average model see paschalis et al 2013 for additional details last we applied the inverse lognormal functions as described in section 2 1 to create rainfall intensity fields from the quantile fields we embedded the sqm uqm and cc relation adjustment methods in the model to enable simulating the design storm for future climate conditions fig 1 according to information obtained from cpm the storm is simulated at a spatial resolution of 10 m x 10 m and temporal resolution of 5 min 3 3 convection permitting model we used convection permitting climate simulations conducted with a horziontal grid spacing of 2 2 km over european domain presented in hentgen et al 2019 leutwyler et al 2017 the simulations were conducted using the consortium for small scale modeling in climate mode cosmo clm model baldauf et al 2011 over 10 years long periods in present day climate driven by era interim reanalysis and future climate driven by pseudo global warming pgw approach e g schär et al 1996 rasmussen et al 2011 the basic idea of the pgw approach is to apply large scale perturbations calculated as climate change signal from a general circulation model at the lateral boundaries of a present day simulation the pgw simulations represent climate at the end of the century based on rcp8 5 greenhouse gas emission scenario first we have investigated the cpm s capabilities to reproduce the spatial structure of extreme storms by comparing the storm profile of the 1 most intense rainfall fields obtained from the evaluation period of the cpm for the years 1999 2009 with the radar data 2015 2019 assuming stationary climate for the 1999 2019 period the rainfall spatial profiles represent the distribution of rainfall intensities according to their cumulative area and they are computed for the rainfall composite as explained above an illustration of the different types of rainfall spatial profiles standardized from 0 no rain to 1 peak intensity to enable comparison between fields with different maximum rainfall intensities is provided in fig s1 since the lengths and periods of the sampled data differed as well as the space time resolutions of the two products we are not expecting a perfect match between the storm profiles but we aimed to investigate if there was a general agreement between them still it appears that the cpm simulates the rainfall spatial structure of extreme storms properly in the four cities as there is a general agreement that storms exhibit spatial profiles between types 3 and 4 fig 6 a second issue we examined was the validity of applying the cc relation adjustment i e whether the scaling relationship between rainfall properties and temperature computed using cpm data is consistent with that of weather radar data we calculated the scaling relationship between r ˆ t and r a t using the following equation 8 l o g r α β t where β is the regression coefficient the scale and t is the air temperature bounded between 5 and 25 o c to avoid solid precipitation and the expected breaking point due to humidity limitations peleg et al 2018 a 2 o c interval was used to bin the rainfall variables r ˆ and r a further details on the binning method are given by ali et al 2021 note that other methods can be employed to extract the cc scale e g visser et al 2021 the results of this examination show a high level of agreement between the radar and cpm rainfall temperature scaling table 1 as both show a strengthening of the storm r ˆ and a decreasing area r a with increasing temperature all trends were found significant by the mann kendall test p values 0 05 the fitting statistics are presented in table s1 3 4 design storm modifications the storm profiles of the 1 most intense rainfall fields for the present and future climates were obtained from the cpm for the four different domains fig 7 these profiles were used as the basis for the sqm adjustment along with the information of the change in the storm area δ r a in each of the locations the example of the present and future storm composites and the changes to the storm profile in fig 2 was generated using the cpm information for bern in fig 8 four additional examples of simulated present and future storm composites for the bern area are presented to illustrate the spatial stochasticity of the rainfall generator model and its potential to simulate multiple realizations of the same design storm it is noteworthy that the area of the storm chosen in our case study to demonstrate the storm adjustment process is relatively small compared to the grid spacing of the cpm we only have 256 grid cells for calculating the spatial composite of cpm s storms which can lead to under representation of the storm profile cpm domains should be matched up with the storm extent to be adjusted and a sufficient number of grid cells should be available to accurately represent the storm spatial structure a change in 2 m air temperature during the occurrence of the 1 most intense rainfall simulated by the cpm for the present and future climates was computed δ t 1 to modify the lausanne storm according to the cc relation table 2 to apply the uqm method the rainfall intensity quantiles for the present and future climates were extracted from the cpm for each location see example in fig s2 3 5 inundation model the outputs of the rainfall generator model i e the ensemble of simulated design storms both for present and future climates were input into the caddies caflood 2d cellular automata flood model guidolin et al 2016 caddies provides data structures to store rasters and automata spaces methods to retrieve and assign automaton cell neighborhoods abstract methods to implement transition functions and more caflood is an application for rapid flood modeling that has been widely used both in academic research recent publications include webber et al 2020 vamvakeridou lyroudia et al 2020 padulano et al 2021 among many others and in the private sector see case studies in https www cafloodpro com the required inputs include terrain elevation roughness rainfall and water levels at domain boundaries at each time step caflood applies the manning s equation in each automaton cell to compute the velocity of water flowing from to each of its neighbors to ultimately calculate the resulting water level in each cell to this end the edge between a cell and its neighbor is treated as a channel of width equal to cell side length the version of the caddies caflood model used in this study includes the possibility to take spatially distributed rainfall into account fig 9 shows an example of an inundation map produced by the model showing the average maximum water depths of 30 realizations of the lausanne storm simulated for the present climate conditions in the city of bern from the results obtained using the inundation model water depth maps at each time step were used for analyzing the impact of the different storm adjustment methods on the flood characteristics which were summarized in two statistical measures we first computed the ratio of change in peak water depths between the future scenarios and the rainfall runoff simulations of the present 9 δ h i 1 n h i f i 1 n h i p i 1 n h i p where h i is the water depth at any grid cell i n is the total number of grid cells in the domain and p and f are the present and future corrected method simulations respectively in addition we calculated the ratio of change in the flooded area δ θ between the present and future simulations grid cells i with a peak water depth above 10 cm were considered flooded and assigned a value of 1 or 0 otherwise then we used eq 9 to sum the flooded area replacing h i with θ i 3 6 the hydrological response to the rainfall adjustment different hydrological responses result from the three different storm adjustment methods as expected the sqm method is associated with higher water depths fig 10 and larger inundated areas fig s3 in bern geneva and zurich this can be explained by the increasing area of the storm and the increasing intensity of the rainfall in these locations fig 7 however in bellinzona the storm area is expected only to increase slightly and the peak rainfall intensity is expected to weaken fig 7 resulting in reduced hydrological impacts fig 10 and s3 we note that in comparison to the other locations cpm data for bellinzona are less in agreement with radar data table 1 another possibility could be that the limited data from future climate simulations 10 years do not show extremely heavy rainfall storms in this region the two homogeneous rain adjustment methods uqm and cc relation agree well in two locations bern and zurich contrary to this the uqm has a much greater impact on flood assessments in geneva and bellinzona fig 10 and s3 3 7 implications it is evident from the results that it is essential to apply rainfall adjustment to both rainfall intensities and the spatial structure of storms as the impact on the flood can be significant spatial rainfall adjustment is more likely to be important in catchments with fast hydrological responses such as small to medium sized rural catchments or urban areas and less important in large catchments where the temporal structure of rainfall should be more influential however further research is needed to examine the impact of changes in convection organization on catchment response at large scales for this case study the purpose of applying rainfall adjustments was not to identify the true signal of change in flood assessments for the four locations but rather to demonstrate the sqm method the assessment of climate change impacts on flood statistics and their uncertainties requires using additional climate scenarios and rainfall adjustment methods and performing a detailed validation of the cpm s ability to represent rainfall for these locations which is beyond the scope of this paper furthermore we demonstrated the sqm on a single convective storm but it should be noted that the method can be applied to any type of storm for example stratiform storms research is still needed on how to identify the storm types in cpm and extract the adjustment factors a task that remains challenging 4 perspectives on sqm s future development under the assumption that the rainfall structure and intensity will change the same throughout the storm duration we demonstrated the spatial adjustment of design storms changes in rainfall structure however are likely to be non stationary hence we plan to further develop the sqm scheme to adjust design storms both spatially and temporally additionally changes in the spatial structure of the storm are likely influenced by the type of rainfall e g convective vs stratiform its source and orientation it is possible to address this issue if the changes to the spatial structure obtained from the cpm are analyzed based on rainfall types in addition the sqm properties i e the change in storm area and the change in spatial quantile of rainfall intensity can be scaled with the return period of extreme storms the result will be a more flexible form of correction to design storms of varying severity 5 conclusions we presented the sqm a simple method for spatially adjusting the structure of design storms using data from a cpm we applied the sqm to a design storm and presented a case study results indicate that modifying the spatial structure of the storm can yield considerable differences in flood impacts in comparison to other adjustment methods that apply uniform adjustment to rainfall intensities we plan to extend sqm to adjust rainfall also in its temporal component in the future in addition to the spatial component of the adjustment described in this paper code availability an example of the spatial quantile mapping sqm method can be found in the zenodo archive at https doi org 10 5281 zenodo 6563635 this script peleg 2022 reproduces fig 3 from the manuscript credit authorship contribution statement nadav peleg writing original draft conceptualization methodology software writing review editing nikolina ban writing review editing conceptualization michael j gibson writing review editing conceptualization software albert s chen writing review editing conceptualization athanasios paschalis writing review editing conceptualization software paolo burlando writing review editing conceptualization joão p leitão writing original draft conceptualization methodology software declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments np acknowledges the support of the swiss national science foundation snsf grant 194649 rainfall and floods in future cities nb acknowledges prace for awarding her access to piz daint at swiss national supercomputing center cscs switzerland nb also acknowledges the federal office for meteorology and climatology meteoswiss the swiss national supercomputing centre cscs and eth zürich for their contributions to the development of the gpu accelerated version of cosmo asc acknowledges the alan turning institute for the support to his work via turing fellow at university of exeter caddies caflood 2d was originally developed in the project simplified dual drainage modelling for flood risk assessment in urban areas gr j09796 funded by the uk engineering and physical sciences research council appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j advwatres 2022 104258 appendix a supplementary data the following is the supplementary material related to this article mmc s1 
125,synthetic design storms are often used to plan new drainage systems or assess flood impacts on infrastructure to simulate extreme rainfall events under climate change design storms can be modified to match a different return frequency of extreme rainfall events as well as a modified temporal distribution of rainfall intensities however the same magnitude of change to the rainfall intensities is often applied in space several hydrological applications are limited by this climate change impacts on urban pluvial floods for example require the use of 2d design storms rainfall fields at sub kilometer and sub hourly scales recent kilometer scale climate models also known as convection permitting climate models cpm provide rainfall outputs at a high spatial resolution although rainfall simulations are still restricted to a limited number of climate scenarios and time periods we nevertheless explored the potential use of rainfall data obtained from these models for hydrological flood impact studies by introducing a method of spatial quantile mapping sqm to demonstrate the new methodology we extracted high resolution rainfall simulations from a cpm for four domains representing different urban areas in switzerland extreme storms that are plausible under the present climate conditions were simulated with a 2d stochastic rainfall model based on the cpm informed stochastically generated rainfall fields we modified the design storms to fit the future climate scenario using three different methods the sqm a uniform quantile mapping and a uniform adjustment based on a rainfall temperature relationship throughout all storms the temporal distribution of rainfall was the same using a flood model we assessed the impact of different rainfall adjustment methods on urban flooding significant differences were found in the flood water depths and areas between the three methods in general the sqm method results in a higher flood impact than the storms that were modified otherwise the results suggest that spatial storm profiles may need to be re adjusted when assessing flood impacts graphical abstract keywords spatial quantile mapping extreme rainfall urban flood high resolution rainfall climate change 1 introduction floods are one of the main natural hazards contributing to massive economic losses and casualties paprotny et al 2018 especially vulnerable to damage from river overflows and flash floods are urban areas which contain significant concentrations of infrastructure including residential commercial and industrial structures gueneralp et al 2015 flash floods are commonly triggered by short duration but intense rainfall bursts e g fowler et al 2021b while river overflows are caused primarily by prolonged rainfall events and other climate factors such as snow melt and evaporation see bloeschl et al 2019 global warming is predicted to cause both short and long duration extreme rainfall events to occur more frequently and with greater intensity in the future trenberth 2011 westra et al 2014 moustakis et al 2021 fowler et al 2021a consequently higher flood frequencies damages and economic losses are predicted hirabayashi et al 2013 jongman et al 2014 mallakpour and villarini 2015 design storms are a commonly used tool for assessing flood impacts sun et al 2011 they are often synthetic hyetographs that represent extreme rainfall events for a given return period and storm duration berk et al 2017 hyetographs can either have a simple bell like shape with a length and maximum rainfall intensity matching observed extreme rainfall events or they can be stochastically modeled to simulate pseudo extreme rainfall events onof et al 2000 chimene and campos 2020 on the basis of climate model data their intensities can be adapted to reflect extreme rainfall events at future climates e g berggren et al 2014 peleg et al 2015 design storms can be conceptualized at a point scale i e in a one dimensional 1d spatial configuration representing the areal rainfall over a catchment onof et al 2000 in some circumstances however using design storms with a two dimensional 2d configuration is more appropriate e g paschalis et al 2014 niemi et al 2016 peleg et al 2020 especially when extreme rainfall events are convective in nature as they often exhibit a high degree of spatial heterogeneity belachsen et al 2017 additionally fast response catchments such as those in mountainous or urban areas are sensitive to rainfall heterogeneity peleg et al 2017a moraga et al 2021 making spatially distributed simulations necessary another advantage of using stochastic models to simulate design storms is that their output is an ensemble of multiple space time realizations of the storm since stochastic space time variability is a significant source of uncertainty in hydrological impacts fatichi et al 2016 peleg et al 2017a moraga et al 2021 it is beneficial to simulate it in order to for example evaluate the effects of climate change on changes in storm properties on flood statistics a number of stochastic models are available to simulate 2d design storms these include the streap model paschalis et al 2013 the hires wg peleg and morin 2014 and the storm model singer et al 2018 among others in many locations we can estimate how the magnitude duration and temporal structure of storm hyetographs will likely change under future climate conditions climate models can provide this type of information or it can be obtained from empirical relationships between extreme rainfall properties and climate variables such as temperature increase ban et al 2014 wasko and sharma 2015 li et al 2018 moustakis et al 2020 ali et al 2021 it is possible to modify 1d design storms for climate change impact studies when this information is available e g olsson et al 2013 global warming is also projected to change the spatial patterns of extreme rainfall a number of studies linked changes in temperature to changes in storm extent and spatial heterogeneity of rainfall fields wasko et al 2016 lochbihler et al 2017 peleg et al 2018 chen et al 2021 climate induced changes in the spatial properties of extreme rainfall have been found to influence catchment hydrological responses peleg et al 2020 2021 as a result when using 2d design storms it is crucial not only to modify the rainfall intensities and temporal structure but also the spatial structure of the storm convection permitting climate models cpm can simulate rainfall fields at high spatial and temporal resolution i e on kilometers and sub hour scales prein et al 2015 schär et al 2020 as a result of their high computational demand and the time required to run them cpm are not currently used to simulate a wide range of emissions scenarios for long periods of time e g simulating the entire 21st century thus cpm data tend to underrepresent low frequency intense storms consequently in the vast majority of cases their data cannot be used directly for hydrological flood assessment studies their data can be used to understand how for example rainfall intensities are affected by air temperatures lenderink et al 2021 allowing design storms to be adjusted accordingly based on their ability to explicitly simulate deep convection these models have proven to reproduce the spatial structure of rainfall adequately at the kilometer scale for numerous areas ban et al 2014 2021 leutwyler et al 2017 including over complex terrain e g lind et al 2020 in the context of climate change cpm can be used to investigate how the spatial structure of extreme storms will change in the future e g prein et al 2017 2020 chen et al 2021 while theoretically this information can be used to alter the spatial structure of 2d design storms for flood assessment applications in practice this has not been done yet in this paper we describe a new spatial quantile mapping technique that allows for the modification of the spatial structure of 2d design storms the extreme storm observed in lausanne in summer 2018 served as our case study in order to construct a 2d design storm and modify its spatial structure to fit future climate conditions with our 2d modified design storm we examined flood statistics in four swiss cities using a flood inundation model and discuss the importance of modifying the spatial structure of storms by comparing our new method with other widely used methods that allow changes in storm magnitude but lack the spatial dimension 2 rainfall adjustment methods we simulated a 2d design storm altered it spatially to take into account the modifications expected due to climate change and examined the changes in flood statistics in addition we also tested two other non spatial rainfall modification methods these processes are illustrated and explained in fig 1 the methods for modifying the rainfall patterns and intensity are explained in the subsequent subsections and the numerical experiment we conducted as a case study is described in section 3 2 1 spatial quantile mapping the initial step in performing the spatial quantile mapping sqm method is to calculate storm composites using the cpm both for storms occurring in the present climate fig 2a and future climate fig 2b the choice of storms to include depends on the application suppose the aim is to modify a design storm that represents a 10 year return period the relevant rain fields for this return period should then be extracted from an archive of present and future cpm simulations the storm composite is constructed by centering each rainfall field from the 10 year storm archive on the location of their maximum rainfall intensity over one another and calculating the mean of the rainfall intensities at each grid cell we assume that the spatial structure of the storm composite is stationary and that the adjustment factors derived from the composite can be applied to each distinct rainfall field of the design storm the empirical cumulative distribution function cdf of the spatial rainfall intensities of the present and future storms is then compiled fig 2c the rainfall intensities obtained from the storm composites are sorted and linearly ranked from the lowest rainfall intensity s q 0 to the highest s q 1 linear interpolation is used to compute rain intensity continuous over the entire quantile ranges s q 0 1 in most cases it is possible to fit a probability distribution to the data instead of the empirical cdf for example the rain fields presented in fig 2 can be fitted with a lognormal distribution which is a common probability distribution in rain fields e g cho et al 2004 in order to calculate the adjustment factor of rainfall intensity per quantile c f s q we divide the future storm profile p r s q f by the present storm profile p r s q p both are illustrated in fig 2c 1 c f s q p r s q f p r s q p the adjustment factor can then be applied to adjust the rainfall intensities of the design storm 2 r i s q f r i s q p c f s q where i are the individual rain fields composing the design storm r in addition to changes in rainfall intensity it is likely that the area of the storm will change in the future adjusting the area of the storm is therefore also necessary and should be applied per rainfall field it is essential to know which probability distribution the rainfall intensities follow in space in order to perform the adjustment the area adjustment procedure is done as follows i the rainfall intensity field is transformed into its quantile field ii a random quantile vector is generated with the size of the wet number of grid cells representing the new area iii in the quantile field dry grid cells that are close to wet grid cells by euclidean distance are converted into wet grid cells so as to reach the desired storm area iv the quantiles from the second step are assigned to the quantile field and v the quantile field is back transformed into a rainfall intensity field using this procedure the area of the rainfall field can be modified while the storm spatial structure remains largely intact in the case of shrinking fields the same procedure can be applied but in step iii the grid cells with the lowest rainfall intensities are classified as dry until the desired rainfall area is met as an example we used a rainfall field characterized by a spatial lognormal distribution fig 3a the following parameters can be derived from this synthetic rainfall field the mean areal rainfall r ˆ the total wetted area r a and the spatial rainfall coefficient of variation r c v based on this information the rainfall field can be transformed into its quantile field fig 3b using the following transformation see paschalis et al 2013 peleg et al 2020 for details 3 q x y l n r x y l o g r a r c v 2 1 l o g r c v 2 1 where q x y is the quantile field obtained from the l n cumulative lognormal distribution r x y is the rainfall intensity field l o g r a r c v 2 1 is the μ parameter and l o g r c v 2 1 is the σ parameter of the probability distribution the next step is to generate the quantile vector q n with a length that correspond to the number of grid cells of the newly desired area 4 q n n 1 n 0 1 0 1 where n 1 is the inverse cumulative normal distribution and n is a randomly generated normal vector a zero mean unit variance gaussian the length of q n determines the new area of the rainfall field r a and is defined as r a r a c f a where c f a is the adjustment factor of the total wetted area obtained from dividing the future total wetted area of the rainfall composite with the present one using a simple image morphological dilation method e g van den boomgaard and van balen 1992 the quantile field q x y is then adjusted to match the desired area and the values of the simulated vector q n are sorted similarly to the original field and assigned to the newly adjusted quantile field q x y fig 3c by using a morphological method to adjust the wetted area we assume that the spatial correlation structure of the rainfall field is approximately stationary i e changes in the spatial correlation structure due to climate change are not explicitly accounted for the newly adjusted quantile field is finally back transformed into a rainfall intensity field 5 r x y l n 1 q x y l o g r a r c v 2 1 l o g r c v 2 1 where r x y is the new rainfall intensity field fig 3d q x y is the adjusted quantile field fig 3c and l n 1 is the inverse cumulative lognormal distribution the above example used the lognormal distribution but the same procedure can be applied to any probability distribution 2 2 other rainfall adjustment methods the two other non spatial rainfall modification methods that were used here are a uniform adjustment based on a rainfall temperature relationship cc relation and uniform quantile mapping uqm methods fig 1 the first is based on the well known clausius clapeyron relation trenberth et al 2003 that link extreme rainfall intensification mostly convective in type and increase in temperature see recent publications by moustakis et al 2020 ali et al 2021 fowler et al 2021a among many others based on the assumption that the rainfall will intensify at a rate of 7 c 1 a valid assumption for switzerland molnar et al 2015 ban et al 2015 we defined the rainfall intensification factor as follows 6 c c 1 0 7 t where c c is the clausius clapeyron intensification factor that is determined by the increase in temperature t the new rainfall field r x y is simply a multiplication of r x y with c c the uqm is expressed as 7 r x y f 1 u r x y where u is the quantile function and f 1 is an inverse cumulative probability distribution function we used the generalized pareto distribution in our case study as in peleg et al 2017b it was fitted to the cpm s rainfall intensities of the present climate replacing u and of the future climate replacing f 1 3 modifying an intense storm a case study the numerical experiment is illustrated in fig 1 as our case study we selected the extreme storm recorded over the city of lausanne section 3 1 applying a stochastic rainfall generator model we simulated multiple realizations of this storm section 3 2 then we evaluated the abilities of cpm to generate extreme rainfall in this region section 3 3 and determined how the spatial structure of the storm is expected to change section 3 4 we duplicated the lausanne storm for four other cities in switzerland fig 4 which are considerably larger than lausanne and modified its spatial structure using the methods listed in section 2 the selected cities are located in different climatic zones with different urban forms and terrain characteristics thus representing a wide variety of urban hydrological responses to extreme rainfall as a final step we used an inundation model section 3 5 to examine the hydrological response 3 1 the lausanne storm on june 11th 2018 an intense convective storm swept through the city of lausanne in switzerland fig 4 the storm lasted for four hours between 7 pm and 11 pm local time and is the most intense short rain burst ever recorded in switzerland at around 9 pm a rain gauge in the city s vicinity lsn recorded a peak of 41 mm of rainfall within 10 min fig 5 the rain burst flooded several streets and the underground metro system causing damage but no casualties the storm was captured not only by the local rain gauge but also by the meteoswiss weather radar system which enabled the analysis of the space time evolution of the storm at a fine resolution of 1 km and 5 min germann et al 2015 a 16 km x 16 km window centered over lausanne was used to analyze the storm s mean areal rainfall intensity r ˆ rainfall spatial structure r c v and fraction of wetted area r a fig 5 3 2 stochastic rainfall generator model stochastic rainfall generators are used to simulate extreme storms for flood assessments especially in urban areas mcrobie et al 2013 peleg et al 2017a the models can be used to generate multiple storms with extreme rainfall events for a given climate or they can be used to generate individual extreme storms with a known return period storms simulated by gridded rainfall generators can be parameterized to reproduce the temporal structure of an observed extreme rainfall event such as the storm duration and the temporal distribution of mean rainfall over the domain but differ in the spatial distribution of rainfall intensities within the domain we simulated the design storm with the streap rainfall generator model paschalis et al 2013 which was used in several climate impact studies in the past paschalis et al 2014 skinner et al 2020 peleg et al 2020 2021 nyman et al 2021 ramirez et al 2022 among others we first obtained the information needed to stochastically generate a design storm that will have similar spatial characteristics of a real storm i e a time series of r ˆ r a r c v and mean advection velocity and direction these parameters can all be determined using weather radar data then we used the fast fourier transform method to simulate a gaussian mixture bimodal quantile field as we found that it enable a better representation of the convective structure of the rainfall we allowed the quantile fields to advect and evolve over time using an auto regressive moving average model see paschalis et al 2013 for additional details last we applied the inverse lognormal functions as described in section 2 1 to create rainfall intensity fields from the quantile fields we embedded the sqm uqm and cc relation adjustment methods in the model to enable simulating the design storm for future climate conditions fig 1 according to information obtained from cpm the storm is simulated at a spatial resolution of 10 m x 10 m and temporal resolution of 5 min 3 3 convection permitting model we used convection permitting climate simulations conducted with a horziontal grid spacing of 2 2 km over european domain presented in hentgen et al 2019 leutwyler et al 2017 the simulations were conducted using the consortium for small scale modeling in climate mode cosmo clm model baldauf et al 2011 over 10 years long periods in present day climate driven by era interim reanalysis and future climate driven by pseudo global warming pgw approach e g schär et al 1996 rasmussen et al 2011 the basic idea of the pgw approach is to apply large scale perturbations calculated as climate change signal from a general circulation model at the lateral boundaries of a present day simulation the pgw simulations represent climate at the end of the century based on rcp8 5 greenhouse gas emission scenario first we have investigated the cpm s capabilities to reproduce the spatial structure of extreme storms by comparing the storm profile of the 1 most intense rainfall fields obtained from the evaluation period of the cpm for the years 1999 2009 with the radar data 2015 2019 assuming stationary climate for the 1999 2019 period the rainfall spatial profiles represent the distribution of rainfall intensities according to their cumulative area and they are computed for the rainfall composite as explained above an illustration of the different types of rainfall spatial profiles standardized from 0 no rain to 1 peak intensity to enable comparison between fields with different maximum rainfall intensities is provided in fig s1 since the lengths and periods of the sampled data differed as well as the space time resolutions of the two products we are not expecting a perfect match between the storm profiles but we aimed to investigate if there was a general agreement between them still it appears that the cpm simulates the rainfall spatial structure of extreme storms properly in the four cities as there is a general agreement that storms exhibit spatial profiles between types 3 and 4 fig 6 a second issue we examined was the validity of applying the cc relation adjustment i e whether the scaling relationship between rainfall properties and temperature computed using cpm data is consistent with that of weather radar data we calculated the scaling relationship between r ˆ t and r a t using the following equation 8 l o g r α β t where β is the regression coefficient the scale and t is the air temperature bounded between 5 and 25 o c to avoid solid precipitation and the expected breaking point due to humidity limitations peleg et al 2018 a 2 o c interval was used to bin the rainfall variables r ˆ and r a further details on the binning method are given by ali et al 2021 note that other methods can be employed to extract the cc scale e g visser et al 2021 the results of this examination show a high level of agreement between the radar and cpm rainfall temperature scaling table 1 as both show a strengthening of the storm r ˆ and a decreasing area r a with increasing temperature all trends were found significant by the mann kendall test p values 0 05 the fitting statistics are presented in table s1 3 4 design storm modifications the storm profiles of the 1 most intense rainfall fields for the present and future climates were obtained from the cpm for the four different domains fig 7 these profiles were used as the basis for the sqm adjustment along with the information of the change in the storm area δ r a in each of the locations the example of the present and future storm composites and the changes to the storm profile in fig 2 was generated using the cpm information for bern in fig 8 four additional examples of simulated present and future storm composites for the bern area are presented to illustrate the spatial stochasticity of the rainfall generator model and its potential to simulate multiple realizations of the same design storm it is noteworthy that the area of the storm chosen in our case study to demonstrate the storm adjustment process is relatively small compared to the grid spacing of the cpm we only have 256 grid cells for calculating the spatial composite of cpm s storms which can lead to under representation of the storm profile cpm domains should be matched up with the storm extent to be adjusted and a sufficient number of grid cells should be available to accurately represent the storm spatial structure a change in 2 m air temperature during the occurrence of the 1 most intense rainfall simulated by the cpm for the present and future climates was computed δ t 1 to modify the lausanne storm according to the cc relation table 2 to apply the uqm method the rainfall intensity quantiles for the present and future climates were extracted from the cpm for each location see example in fig s2 3 5 inundation model the outputs of the rainfall generator model i e the ensemble of simulated design storms both for present and future climates were input into the caddies caflood 2d cellular automata flood model guidolin et al 2016 caddies provides data structures to store rasters and automata spaces methods to retrieve and assign automaton cell neighborhoods abstract methods to implement transition functions and more caflood is an application for rapid flood modeling that has been widely used both in academic research recent publications include webber et al 2020 vamvakeridou lyroudia et al 2020 padulano et al 2021 among many others and in the private sector see case studies in https www cafloodpro com the required inputs include terrain elevation roughness rainfall and water levels at domain boundaries at each time step caflood applies the manning s equation in each automaton cell to compute the velocity of water flowing from to each of its neighbors to ultimately calculate the resulting water level in each cell to this end the edge between a cell and its neighbor is treated as a channel of width equal to cell side length the version of the caddies caflood model used in this study includes the possibility to take spatially distributed rainfall into account fig 9 shows an example of an inundation map produced by the model showing the average maximum water depths of 30 realizations of the lausanne storm simulated for the present climate conditions in the city of bern from the results obtained using the inundation model water depth maps at each time step were used for analyzing the impact of the different storm adjustment methods on the flood characteristics which were summarized in two statistical measures we first computed the ratio of change in peak water depths between the future scenarios and the rainfall runoff simulations of the present 9 δ h i 1 n h i f i 1 n h i p i 1 n h i p where h i is the water depth at any grid cell i n is the total number of grid cells in the domain and p and f are the present and future corrected method simulations respectively in addition we calculated the ratio of change in the flooded area δ θ between the present and future simulations grid cells i with a peak water depth above 10 cm were considered flooded and assigned a value of 1 or 0 otherwise then we used eq 9 to sum the flooded area replacing h i with θ i 3 6 the hydrological response to the rainfall adjustment different hydrological responses result from the three different storm adjustment methods as expected the sqm method is associated with higher water depths fig 10 and larger inundated areas fig s3 in bern geneva and zurich this can be explained by the increasing area of the storm and the increasing intensity of the rainfall in these locations fig 7 however in bellinzona the storm area is expected only to increase slightly and the peak rainfall intensity is expected to weaken fig 7 resulting in reduced hydrological impacts fig 10 and s3 we note that in comparison to the other locations cpm data for bellinzona are less in agreement with radar data table 1 another possibility could be that the limited data from future climate simulations 10 years do not show extremely heavy rainfall storms in this region the two homogeneous rain adjustment methods uqm and cc relation agree well in two locations bern and zurich contrary to this the uqm has a much greater impact on flood assessments in geneva and bellinzona fig 10 and s3 3 7 implications it is evident from the results that it is essential to apply rainfall adjustment to both rainfall intensities and the spatial structure of storms as the impact on the flood can be significant spatial rainfall adjustment is more likely to be important in catchments with fast hydrological responses such as small to medium sized rural catchments or urban areas and less important in large catchments where the temporal structure of rainfall should be more influential however further research is needed to examine the impact of changes in convection organization on catchment response at large scales for this case study the purpose of applying rainfall adjustments was not to identify the true signal of change in flood assessments for the four locations but rather to demonstrate the sqm method the assessment of climate change impacts on flood statistics and their uncertainties requires using additional climate scenarios and rainfall adjustment methods and performing a detailed validation of the cpm s ability to represent rainfall for these locations which is beyond the scope of this paper furthermore we demonstrated the sqm on a single convective storm but it should be noted that the method can be applied to any type of storm for example stratiform storms research is still needed on how to identify the storm types in cpm and extract the adjustment factors a task that remains challenging 4 perspectives on sqm s future development under the assumption that the rainfall structure and intensity will change the same throughout the storm duration we demonstrated the spatial adjustment of design storms changes in rainfall structure however are likely to be non stationary hence we plan to further develop the sqm scheme to adjust design storms both spatially and temporally additionally changes in the spatial structure of the storm are likely influenced by the type of rainfall e g convective vs stratiform its source and orientation it is possible to address this issue if the changes to the spatial structure obtained from the cpm are analyzed based on rainfall types in addition the sqm properties i e the change in storm area and the change in spatial quantile of rainfall intensity can be scaled with the return period of extreme storms the result will be a more flexible form of correction to design storms of varying severity 5 conclusions we presented the sqm a simple method for spatially adjusting the structure of design storms using data from a cpm we applied the sqm to a design storm and presented a case study results indicate that modifying the spatial structure of the storm can yield considerable differences in flood impacts in comparison to other adjustment methods that apply uniform adjustment to rainfall intensities we plan to extend sqm to adjust rainfall also in its temporal component in the future in addition to the spatial component of the adjustment described in this paper code availability an example of the spatial quantile mapping sqm method can be found in the zenodo archive at https doi org 10 5281 zenodo 6563635 this script peleg 2022 reproduces fig 3 from the manuscript credit authorship contribution statement nadav peleg writing original draft conceptualization methodology software writing review editing nikolina ban writing review editing conceptualization michael j gibson writing review editing conceptualization software albert s chen writing review editing conceptualization athanasios paschalis writing review editing conceptualization software paolo burlando writing review editing conceptualization joão p leitão writing original draft conceptualization methodology software declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments np acknowledges the support of the swiss national science foundation snsf grant 194649 rainfall and floods in future cities nb acknowledges prace for awarding her access to piz daint at swiss national supercomputing center cscs switzerland nb also acknowledges the federal office for meteorology and climatology meteoswiss the swiss national supercomputing centre cscs and eth zürich for their contributions to the development of the gpu accelerated version of cosmo asc acknowledges the alan turning institute for the support to his work via turing fellow at university of exeter caddies caflood 2d was originally developed in the project simplified dual drainage modelling for flood risk assessment in urban areas gr j09796 funded by the uk engineering and physical sciences research council appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j advwatres 2022 104258 appendix a supplementary data the following is the supplementary material related to this article mmc s1 
126,shallow bedrock aquifers are prevalent across the northern hemisphere and can be the primary source of freshwater for many communities cryospheric impacts from climate warming are particularly concerning for bedrock aquifers where recharge is dominated by winter precipitation for the management and protection of fractured rock groundwater supplies the processes influencing infiltration and recharge under warmer winter conditions require a greater understanding as such a numerical investigation was undertaken with the objective of testing a conceptual model of midwinter infiltration and recharge near a granitic canadian shield bedrock outcrop using data collected over an unseasonably warm and rainy winter in eastern ontario canada additional objectives were to determine if infiltration and recharge would be limited through frozen soils without an outcrop and to explore the hydrologic implications of an additional midwinter snowmelt event results supported the concept that outcrops provide preferential infiltration along the soil rock interface at outcrop margins which enables localized bedrock recharge under frozen conditions to simulate soil moisture content near the outcrop bedrock runoff was needed as additional lateral input in the lower soil profile 75 cm the amount of runoff required as input was controlled by the hydraulic conductivity of the soil rock interface in the absence of an outcrop limited midwinter infiltration occurs due to reduced permeabilities of frozen soils from repeated early winter rainfall and snowmelt events additional midwinter melt events can likely increase bedrock recharge but the associated decline in snow depth deepens soil frost which delays further infiltration and increases surface runoff simulations suggest winter is becoming a more active time for bedrock recharge where outcrops are present but wetter conditions have implications for frozen soil permeability findings extend to similar seasonally frozen bedrock environments which are relied on as a source of freshwater and are rapidly changing under a warming climate keywords bedrock recharge seasonally frozen soils snowmelt infiltration soil rock interface canadian shield climate change 1 introduction almost half of canada s landmass is covered by the canadian shield bostock 2014 fig 1 which is comprised of fractured crystalline bedrock overlain by a thin discontinuous veneer of glacial soils kettles 1992 similar landscapes can be found in norway sweden finland and western russia where the baltic shield is a dominant landcover allaby 2010 fractured bedrock in northern environments contain aquifers that are highly depended upon for municipal domestic and agricultural water supply e g beyer 1968 herr et al 1978 karro 1999 nunes et al 2017 and often winter precipitation and snowmelt are the dominant sources of groundwater recharge abbott et al 2000 jasechko et al 2014 2017 raidla et al 2016 wright and novakowski 2020a however rising temperatures from climate change are increasing the occurrence of midwinter warming kreyling 2010 vikhamar schuler et al 2016 and rain on snow ros events il jeong and sushama 2018 when combined with repeated freeze thaw cycles these cryospheric changes have implications for the spatiotemporal patterns of infiltration and recharge lundberg et al 2016 there remains a lack of understanding regarding what these changes mean for shallow bedrock aquifers bare rock outcrops are common in shield landscapes and have previously been identified as key areas for bedrock recharge e g peters et al 1995 spence and woo 2002 gleeson et al 2009 wright and novakowski 2019 zhao et al 2020 the importance of outcrops on local recharge stems from the absence of overlying soils which allows for direct infiltration along open fractures due to the low storage of crystalline aquifers even a small precipitation event can result in rapid and large many meters hydraulic head rises and groundwater recharge cai and ofterdinger 2016 miles and novakowski 2016 rock outcrops have also been shown to influence ecological functions zhao et al 2018 local infiltration patterns soil hydraulic properties zhao et al 2020 soil moisture li et al 2016 and contaminant transport levison and novakowski 2012 thus better understanding outcrop scale processes is of considerable value to groundwater resource protection management and ecosystem services despite the prevalence of shield environments in the northern hemisphere the role of ice and frost on bedrock infiltration and recharge has not been well characterized many hydrological studies in shallow bedrock environments occur at the hillslope scale with a primary focus on runoff generation and stream discharge resulting from summer rainfall buttle et al 2004 buttle and turcotte 1999 peters et al 1995 renzetti et al 1992 these studies along with others across many environments e g spence and woo 2003 kosugi et al 2006 onda et al 2006 tromp van meerveld and mcdonnell 2006 graham et al 2010 fu et al 2012 sohrt et al 2014 have observed lateral interflow along the soil rock interface as a primary pathway for hillslope runoff and bedrock infiltration similar observations have occurred at the outcrop scale li et al 2016 wright and novakowski 2020b zhao et al 2020 since the canadian shield is common throughout cold regions frozen processes will influence infiltration and recharge and likely affect the activation and connectivity of the soil rock interface but this is poorly understood the partitioning of infiltration and recharge along the soil rock interface of hillslopes has previously been modelled appels et al 2015 bockgård and niemi 2004 gardner et al 2020 kormos et al 2015 but freeze thaw processes were not included additionally no outcrop scale numerical investigations have been undertaken particularly that incorporate physically based frozen processes in the simulations to date most hydrologic studies on bedrock outcrops and preferential lateral flow have occurred in karst limestone li et al 2016 zhao et al 2018 occur at larger hillslope scales e g peters et al 1995 graham et al 2010 fu et al 2012 kormos et al 2015 only focus on the spring freshet gleeson et al 2009 and or take place during rain dominated seasons levison and novakowski 2012 miles and novakowski 2016 praamsma 2016 relatively few studies have investigated the outcrop scale processes influencing infiltration and recharge under frozen conditions spence and woo 2002 thorne et al 1998 except for wright and novakowski 2020b the processes of midwinter recharge have not been examined closely and none have employed physically based models to understand such processes considering that rising temperatures from climate change are altering the cryosphere and the importance of outcrops on bedrock recharge additional investigations are needed that examine cryo hydrologic processes surrounding shield outcrops additionally understanding the key infiltration and recharge processes under warmer winter conditions and how to represent them in numerical models is imperative for projecting and protecting groundwater resources under climate change this study stems from a conceptual model of midwinter infiltration and bedrock recharge that was developed by wright and novakowski 2020b using cryo hydrogeologic data collected over an unseasonably warm and rainy winter season 2019 2020 these winter conditions were considered analogous to what is anticipated under future climate scenarios the conceptual model consists of lateral infiltration along the soil rock interface at outcrop margins that bypasses low permeability frozen soils in the absence of an outcrop it was hypothesized that limited vertical infiltration would take place but field data could not confirm this through numerical analysis the objectives of this study are to 1 establish if vertical infiltration would occur through the overburden without an outcrop under the 2019 2020 warm and wet winter 2 test the conceptual model of lateral flow along the soil rock interface as a pathway for midwinter infiltration and 3 examine the hydrologic implications of an additional midwinter melt on the relative timing and magnitude of vertical infiltration and bedrock recharge all objectives use collected field data but objective 3 involves a hypothetical scenario using hourly weather data from december 2019 to april 2020 the thermal and hydrological conditions of the surface and subsurface were simulated using the physically based 1 d simultaneous heat and water shaw model results were compared to measured field data to determine if general infiltration and recharge patterns could be reproduced to support the conceptual model the scenarios considered included a shallow 75 cm soil profile with and without a nearby bedrock outcrop and the same soil profiles with an additional simulated midwinter melt findings can be extended to similar frozen bedrock environments which are relied on as a source of freshwater for domestic municipal and agricultural use and are rapidly changing under a warming climate 2 study site data for the numerical analysis was collected at a site located near perth ontario in the tay river watershed fig 1 the investigation focuses on processes occurring at the outcrop scale 10 m by 20 m in this case situated in an agricultural field used to annually harvest hay approximately 5 of the 850 km2 watershed is bedrock outcrop 20 is agricultural land 50 is mixed forests and the remaining area is wetland and water bodies ontario ministry of natural resources and forestry 2016 the area is underlain by non weathered precambrian syenite migmatite bedrock dugas 1952 wilson 1930 with a thin up to 8 m till veneer kettles 1992 uplift from glacial unloading has resulted in horizontal sheeting fractures and inclined fractures striking northeast which control groundwater recharge and flow in the bedrock gleeson et al 2009 the area is low lying with minimal topographical relief climate of the study region is humid continental baldwin et al 2000 köppen 2011 in drummond centre ontario 15 km north of site average annual rainfall is 702 2 mm and annual snowfall is 174 0 mm water equivalent with similar precipitation amounts across all four seasons 1981 2010 eccc 2021 from the same station daily average air temperatures are 6 1 c 1 3 c snow cover is typically present between mid november and mid april annual precipitation and temperature in the area have historically been increasing wazneh et al 2017 average winter temperatures winter precipitation and the frequency of freezing rain events are predicted to increase across the region by 2100 cheng et al 2011 mcdermid et al 2015 3 methods 3 1 data collection weather data collected at hourly intervals included air temperature 0 3 c hygrovue 5 relative humidity 3 hygrovue 5 solar radiation expected accuracy for daily sums 10 cmp3 pyranometer wind speed 1 1 m s onset wind direction 5o onset precipitation 1 0 hobo tipping bucket and snow depth 1 cm sr50a snowfall was measured using an antifreeze adaptor campbell scientific cs705 for a tipping bucket rain gauge mccaughey and farnes 1996 in the unsaturated overburden a profile of five meter group 5tm volumetric water content vwc 3 and temperature sensors 1 c were installed at depths illustrated in fig 2 a the lowest sensor was positioned as close to the soil rock contact as sensor geometry would allow vwc was converted from dielectric permittivity using topp et al 1980 for normal mineral soil since the dielectric constants of ice and dry mineral soil are fairly similar 3 2 and 2 2 3 5 and differ considerably from water 80 the sensors approximate the unfrozen volumetric water content of the soil patterson and smith 1981 at an operating range down to 40 c a pressure transducer with a thermistor 3 mm 0 05 c solinst levelogger was also installed in the bedrock outcrop at 7 5 m below ground surface bgs in a drilled well to compare groundwater responses to fluxes exiting the soil profile for further details on the data instrumentation and collection refer to wright and novakowski 2020b 3 2 conceptual model the conceptual model being tested consists of a fractured crystalline rock outcrop with a sloped contact between the adjacent glacial till fig 2a repeated rainfall and snowmelt events in the early winter results in frozen saturated ground and low permeability soil that inhibits subsequent vertical infiltration through the soil profile near the outcrop however runoff generated from ros or midwinter snowmelt events can bypass the frozen soil layer and enter the subsurface laterally along the soil rock interface here the soil rock interface is defined as a thin 1 cm sloped contact between bedrock and overburden where sheet flow occurs fig 2a this is represented numerically by a single node at the bottom of the soil profile fig 2b a multi node approach 5 20 nodes was also investigated but did not influence the interpretation of the results and it was beyond the scope of the study to explore other variations in lateral subsurface flow in detail e g diffuse or pipe flow this preferential flow pathway may remain open because of advective heat transfer from bedrock runoff and or the higher thermal conductivity of the bedrock leading to greater warming during melt events and higher conduction from geothermal heat compared to soils additionally macropores along the contact that form from soil contraction expansion may be enhanced relative to those in soil due to additional soil erosion from water flowing along the bedrock boundary water entering along the soil rock contact is primarily partitioned into to the high storage unsaturated soil and directed down slope to depressions in the overlying bedrock secondary partitioning of lateral flow is into the fractured bedrock where water rapidly drains into low storage fractures which results in large many meters water table rises 3 3 shaw model description the simultaneous heat and water model shaw 3 0 2 is a robust physically based model flerchinger and saxton 1989 ireson et al 2013 mohammed et al 2018 with the demonstrated ability to simulate both near surface conditions including the snowpack and heat and water transport in soils under freeze thaw conditions chen et al 2019 li et al 2012a 2012b marshall et al 2019 xu et al 1991 shaw was selected for the numerical analysis after careful review of available codes see discussion in supplementary material the finite difference model first developed by flerchinger and saxton 1989 simultaneously solves energy and water balances through a one dimensional profile that extends from plant canopy to a specified subsurface depth while accounting for effects of snow dead plant residue and plant cover plant cover was not simulated in this case due to the absence of plant growth during winter months in the hay field although shaw is a one dimensional model it can be configured to be pseudo two dimensional by including lateral inflow outflow at each node over the entire soil profile using a source sink term in the richard s equation for a summary of all the heat and water processes considered in the shaw model refer to fig s1 in supplementary material 3 3 1 heat flux through the system the energy balance for each layer of snow is given by 1 ρ s p c i t t ρ l l f θ s p t z k s p t z r n d z l s ρ v t q v z for a layer of potentially freezing soil the 1 d heat flux equation considering advective heat transfer by liquid and latent heat transfer by vapor is given as 2 c s t t ρ i l f θ i t z k s t z ρ l c l q l t z l v ρ v t q v z where ρsp ρl ρi ρv are density of snow liquid water ice and vapor kg m 3 θsp and θi are volumetric liquid water and ice content m3 m 3 ksp and ks are thermal conductivity of the snow and soil w m 1 c 1 ci and cl are specific heat capacity of ice and liquid water j kg 1 c 1 cs is volumetric heat capacity j kg 1c 1 rn is net downward radiation flux within the snow w m 2 lf and ls are latent heat of fusion and sublimation j kg 1 qv is vapor flux kg s 1 m 2 ql is liquid water flux through the soil m s 1 and t is temperature c 3 3 2 water flux through the system liquid water content is computed for each snow layer from the energy balance while assuming density and ice content are constant for each time step snow layer thickness and density modified for compaction and settling are adjusted for vapor transfer and change in liquid content at the end of each time step attenuation and lag coefficients are used to route excess liquid water through the snowpack the resulting outflow and any rainfall and ponded water are infiltrated into the soil using a green ampt approach for a multi layered soil at the end of each timestep the equation for water flux through the soil considering freezing and thawing is given by 3 θ l t ρ i ρ l ρ θ i t z k ψ z 1 1 ρ l q v z u where k is unsaturated hydraulic conductivity m s 1 ψ is soil matric potential m and u is a source sink term for water flux m3 m 3s 1 which allows for water to artificially be introduced into the profile in this study u is used to add water into the lower soil node to represent lateral subsurface flow from upslope that travels along the soil rock contact and enters the soil profile fig 2b matric potential is given by the brooks corey relation for the soil moisture release curve with unsaturated hydraulic conductivity computed from 4 k k s ψ ψ e λ l 2 2 where ks is saturated hydraulic conductivity m s 1 ψe is air entry potential m l is a pore connectivity parameter and λ is the brooks corey pore size distribution parameter it is assumed that water flow through frozen soil is analogous to unfrozen soil and therefore the relationship between matric potential and unsaturated hydraulic conductivity remains valid to account for the reduced permeability from ice blocking pore throats hydraulic conductivity is linearly reduced with ice content and assumed zero below a porosity of 0 13 bloomsburg and wang 1969 soil matric potential directly affects the freezing point of water in the presence of ice the clausius clapeyron equation describes the thermodynamic equilibrium between pressure and temperature by 5 ϕ l f g t t k where ϕ is the total water potential m g is the acceleration of gravity m s 1 and tk is temperature k 3 3 3 boundary and initial conditions the water and energy fluxes at the upper boundary are calculated from hourly weather data including air temperature relative humidity solar radiation wind speed and precipitation the equation for the surface energy balance is as follows 6 r n h l v e g where rn is net radiation w m 2 h is sensible heat flux w m 2 lve is latent heat flux w m 2 g is ground heat flux w m 2 lv is latent heat of evaporation j kg 1 and e is total evapotranspiration from the soil surface and plant canopy kg m 2 s 1 prior to using measured precipitation for simulations all precipitation was corrected for wind induced undercatch using the exponential transfer function developed by kochendorfer et al 2017 7 c e e a u 1 t a n 1 b t a i r c where ce is catch efficiency u is wind speed m s tair is air temperature c and a b and c are coefficients determined from site data the coefficients used are for an unshielded gauge with 10 m height wind speeds up to 8 m s us un from kochendorfer et al 2017 these conditions most closely reflected those of the study site where maximum wind speed measured was 8 05 m s other correlation coefficients were tested but the us un coefficients yielded the closest approximation to the measured snowpack when modelled in shaw fig 3 several adjustments e g precipitation increases temperature decreases were also made to the input data to better align the simulated snowpack with the snow depth measured on site fig 3a these manual adjustments were made because the focus of this study was not on snowpack simulation but instead on providing realistic surface conditions for the assessment of subsurface processes adjustments were made to the data on december 30 january 6 february 15 and february 18 details in supplementary material a unit gradient was applied to the bottom boundary for water flux where the gradient is assumed to be driven by gravity alone under gravity drainage the gradient term for matric potential in eqn 3 becomes zero and the water flux exiting the soil profile is limited by the k of the bottom node in the near outcrop scenario drainage is therefore limited by the k of the soil rock interface which can be scaled by varying ks gravity drainage was selected because the underlying rock is highly fractured which allows for rapid drainage ks 0 9 90 cm hr to the water table that remains in the bedrock miles and novakowski 2016 although gravitational discrepancies between vertical drainage and that along a bedrock slope 12 5 may influence the magnitude of water flux exiting the profile only the relative patterns of flux are being evaluated in this study the bottom thermal boundary was specified for each time step using temperatures measured from the lowest sensor at 73 cm since temperature responses appeared to be influenced by advective heat transport from water fluxes during infiltration the whole temperature time series was not applied to the bottom boundary to investigate if simulated vertical infiltration events could produce observed temperature fluctuations instead five points in the time series between infiltration events were input for the thermal boundary where values between points were linearly interpolated within shaw fig 4 75 cm shaw requires initial values of total moisture content and temperature for each soil node in the simulation measured values of temperature and total moisture content right before freezing were linearly interpolated between field sensors for the input file initial moisture content and temperature profiles for each node used in the simulation can be found in supplementary material fig s2 3 3 4 numerical implementation the 1 d energy and water balance equations for snow and soil are written in implicit finite difference form and solved iteratively using a newton raphson technique flerchinger 2017 linear gradients are assumed between nodes to calculate flux and energy storage is calculated from layer thickness for each node the flux equations are written in terms of unknown end of time step values where the partial derivatives are computed to form a tri diagonal matrix the newton raphson approximations for the unknown values in the matrix are computed and iterations continue until approximations are within a prescribed tolerance for this study tolerance was set at 0 001 which is in c for energy balance and fraction of change in matric potential or vapor density for water the iterative solutions alternate between the heat flux and water flux equations for each time step and updated values from one iteration are used in the other until a prescribed tolerance is reached this allows for the flux equations to be solved simultaneously and maintains the correct balance between the coupled heat and water flux equations a procedural flow chart for the shaw model has been included in supplementary material fig s2 3 3 5 subsurface parameter estimation parameter estimations used for the simulations are shown in table 1 the percent of sand silt and clay was estimated from in field soil characterization when soil was excavated for sensor installation hydraulic conductivity of the soil was measured on site by gleeson et al 2009 and miles and novakowski 2016 values ranged from 0 2 to 2 cm hr with a mean of 1 cm hr which was used for vertical ks and lateral ks lat hydraulic conductivity following model calibration table 1 model fit was evaluated based on the root mean square error rmse between field observations and simulated moisture content and temperature isotropic conditions were used to avoid adding additional model complexity that could not be supported with field measurements saturated vwc θs was assumed to be the maximum vwc measured at each soil horizon fig 2a values ranged from 0 23 0 43 with a vertical harmonic mean of 0 34 over 0 73 m the mean value was used for the entire soil profile in early simulations but improved fits to measured moisture content could be achieved with a three layered system using values that more closely reflected field measurements fig 2c the brooks corey parameters used for the simulations are shown in table 1 during model testing these parameters namely air entry potential and pore size distribution were manually adjusted one at a time within the range of literature values for this soil type different combinations of parameters at different soil horizons resulted in similar fits to the measured data example provided in supplementary material as fig s3 since introducing additional heterogeneity did not alter the interpretation of the results and that this heterogeneity could not be constrained using field measurements a constant value within the range of literature values that resulted in the best fit to moisture content data was used for the entire soil profile table 1 through model calibration it was found that independently varying the values for air entry potential 0 2 0 5 and pore size distribution parameter 2 4 shifted the vwc up and down but generally maintained a similar response to infiltration events varying residual water content 0 01 0 1 did not change the simulated vwc no site measured values were obtained for the soil rock interface so all values have been inversely estimated from simulations the hydraulic properties assigned to represent the soil rock contact were kept the same as the soil profile except for hydraulic conductivity and air entry potential this difference was to account for distinct properties of the soil rock interface which can have higher hydraulic conductivities than overlying soil graham et al 2010 that are further enhanced by high drainage macropores between the soil and rock zhao et al 2020 a lower air entry potential 0 05 m was used to represent such enhanced drainage along the sloped 12 5 interface a range of hydraulic conductivities equal vertical and lateral for the soil rock contact were tested 0 1 9 cm hr with 1 cm hr and 9 cm hr providing similar fits depending on the proportion of runoff added as lateral flow discussion on this point is revisited in section 5 1 an example of the input file which includes the soil properties used for each node is included in supplementary material 3 4 simulations site characteristics used in the simulations correspond to the study site 44o50 n with a ground slope of 1 and elevation of 155 m above sea level the primary model used in all simulations includes a transient multi layered snowpack 1 cm dead plant residue and 75 cm soil profile with three layers of specified thickness as shown in fig 2c for these simulations 96 nodes were used where vertical nodal spacing was 0 005 m between 0 0 2 m and 0 01 m between 0 21 0 75 m fig s4 simulations with 36 nodes and 76 nodes with a similar discretization configuration were also tested but since fewer nodes did not impact the run time or change the interpretation of results the highest possible number of soil nodes were used for this nodal spacing a finer nodal spacing was used in the upper 0 2 m as it is most likely to develop frost based on measured soil temperatures the models were run with hourly time steps which is the smallest possible time step in shaw the bottom node at 75 cm of the primary model was adjusted to represent a soil profile adjacent to a bedrock outcrop fig 2b and a profile without an outcrop fig 2c for the no outcrop scenario the soil hydraulic characteristics of the bottom node were kept consistent with the rest of the soil profile the same properties were used for the near outcrop scenario except for hydraulic conductivity and air entry potential of the bottom node the near bedrock scenario was run with and without lateral flow under the same boundary conditions and compared to field measured data using the rmse details and summary table in section s2 supplementary material subsurface lateral flow along the soil rock interface was represented by adding water flux into the lower soil profile equal to varying proportions of bedrock runoff i e 0 5 2 runoff which represents different bedrock contributing areas and partitioning of surface and subsurface water bedrock runoff was estimated by generating a third model representing the near impermeable bedrock surface although the bedrock is fractured minimal volumes of water would be removed from runoff into the bedrock due to its very low 5 10 4 specific yield milloy 2007 the surface slope was adjusted to that of the soil rock interface 12 5 and the same weather conditions were applied as the soil profiles the runoff output file was then used as an input file for lateral flow note that the temperature of the lateral inflow cannot be specified in shaw however the relatively small temperature fluctuations introduced by water entering the bottom of the profile is not expected to influence frost depths near surface which will be dominated by much larger variations in air temperature the last simulation explored how an additional midwinter snowmelt event would influence infiltration and recharge an intense midwinter warming event was simulated by increasing air temperatures to 10 c between february 2 4 with all else remaining constant this weather scenario was also applied to the bedrock runoff model to create lateral flow inputs for the near outcrop model the discussion of results with respect to climate warming assumed that the baseline climate regime for comparison is on the far end of the spectrum where temperatures remain below freezing throughout the entire winter since all water would be stored as snow on surface there would be no opportunity for infiltration and recharge to occur as such this scenario did not need to be simulated 4 results 4 1 surface conditions with adjustments described in section 3 3 3 a good approximation of the measured snowpack was achieved fig 3a considering the complexities of snow accumulation melt and redistribution the greatest discrepancies seen were during the spring freshet where the modelled snowpack melted earlier than measured in the field which has implications for the timing of spring infiltration and subsurface thermal conditions discussed in section 4 3 other discrepancies between the shaw model snowpack and measured depth can be attributed to differences in newly fallen snow density and unaccounted for blowing snow snowfall measurements can also be delayed using the cs705 snowfall adapter due to the lag between snow falling on the surface of the antifreeze and the time it takes to melt which increases with decreasing temperature 4 2 no outcrop scenario although no field data was acquired away from the outcrop results from the no outcrop simulations were compared to measured near outcrop data to inform how the soil conditions may differ between the two locations the no outcrop scenario resulted in the driest subsurface conditions and the greatest maximum frost depth of 16 1 cm fig 3b frost depth is computed in shaw based on ice content the simulated temperature profile visually fits well with the measured data the rmse was highest near surface 1 32 and decreased with increasing depth 0 36 at 45 cm due to large temperature variations during snow free periods frost was consistently present between january 1 and the spring freshet that occurred between march 8 12 for most of january and february ice saturation near surface remained above 80 which effectively inhibited vertical infiltration below the top few centimeters of the profile for all scenarios and cases considered similar unfrozen vwc was simulated near surface fig 5 5 cm with rmse only ranging between 0 065 and 0 069 table s1 only the final spring freshet resulted in moisture content increases in the deeper horizons the water flux leaving the bottom of the no outcrop profile was only apparent during the spring freshet which cannot explain the measured water table fluctuations observed in the underlying bedrock aquifer fig 6 this supports the concept that minimal midwinter bedrock recharge would have occurred in the absence of an outcrop greater frost depths by spring likely cause the delayed peak in fluxes draining from the soil profile in this scenario however the diffuse recharge from water released from storage in the overburden during spring freshet is likely a driver of the sustained elevated hydraulic heads observed in march compared to the steeper recession seen following the january rain melt event where more water in the overburden was stored as ice macropores at this site are not well characterized and could provide additional pathways for recharge through the soil that are not captured by this model large air filled pores at the time of soil freezing may also allow for midwinter infiltration granger et al 1984 however based on the repetitive melts rainfall at the onset of winter it is reasonable to assume that there would be limited air filled pores during most midwinter infiltration events in this case any infiltrating water in macropores can also refreeze pittman et al 2020 and considerably reduce infiltration along soil preferential pathways with each consecutive melt event mohammed et al 2021 assuming macropores along the soil rock contact are larger than those in the soil profile this process may not apply to the macropore along the contact or it may take longer for macropores to become sufficiently blocked with ice additionally a relatively thick ice layer 2 6 cm was present at ground surface for most of this winter which is not accounted for in this model as such although macropores are not explicitly incorporated in this simulation the simulation results and field observations suggest possible but considerably reduced midwinter infiltration through frozen soils 4 3 near outcrop scenario initial simulations for the near outcrop scenario considered vertical infiltration alone without the addition of lateral flow from bedrock runoff in the vertical infiltration case the vwc increases throughout much of the profile fig 5 which results in shallower frost depths the ice saturation however remains sufficiently high to again inhibit vertical infiltration below 5 cm although the unfrozen vwc shifts closer to the measured values avg profile rmse 0 066 vertical infiltration alone cannot account for most of the measured peaks in vwc as highlighted by the grey bars in fig 5 like the no outcrop case only the large snowmelt during spring freshet resulted in an increase in unfrozen vwc in the entire soil profile subsequent simulations accounted for lateral flow inputs sourced from bedrock outcrop runoff half of the bedrock runoff 0 5 was added near the bottom of the profile for the case of a soil rock interface with a ks of 1 cm hr fig 5 first column this additional water input improved the simulated vwc for all horizons below 5 cm avg profile rmse 0 044 particularly just above the soil rock contact at 73 cm rmse 0 029 the model improvement is most evident throughout late february and early march this amount of lateral inflow however was still insufficient to account for the vwc increases in upper horizons 22 cm and 45 cm since water entering along the soil rock interface also needs to propagate upwards adding all the bedrock runoff 1 was then tested with further improvements in the fit e g rmse at 73 cm 0 025 but peaks at 22 cm and 45 cm e g around march 1 were still poorly represented adding more water to the system however began to overestimate water content in the lower horizons similar fits could be produced by keeping all else the same except for increasing the ks of the soil rock interface to 9 cm hr avg profile rmse 0 045 with the higher hydraulic conductivity higher lateral inflows 1 and 2 runoff were needed to compensate for more water draining from the profile fig 5 second column the additional water supplied by lateral inflow increased the bulk water content of the profile which decreased the frost depth fig 3b frost depth differed by as much as 9 5 cm between the near and no outcrop scenarios by the end of winter simulated temperatures for all near outcrop cases at the measured horizons remained similar the primary differences between simulated and measured temperatures are highlighted by the grey bars in fig 4 shaw is capable of simulating advective heat transport of water yet the sharp temperature declines corresponding with infiltration events in early january were not reproduced by the vertical infiltration cases it is most likely these temperature responses are from advective heat transport along the soil rock interface however the temperature of lateral subsurface water inputs cannot be specified in the shaw model for this reason there is little difference in the temperature profiles with rmse 0 69 and without rmse 0 68 lateral flow fig 4 the exception is during the spring freshet where temperature increased at 22 cm and 45 cm before measured values this is likely in part due to thinner frost depths but also faster simulated spring snowmelt than observed in the field fig 3a with the early removal of the insulative snow layer the ground warms faster as air temperatures rise lundberg et al 2016 the absolute magnitude of flux exiting the profile along the soil rock contact fig 6 is likely an over estimate due to how water is being forced into the model to represent lateral flow the magnitude of flux for the case with lateral flow is also highly sensitive to model parameters and is therefore limited to this study instead these fluxes are used to provide insight into the timing and relative magnitude of water that is both leaving the profile along the soil rock contact and the small fraction of this water that would enter open fractures and recharge the underlying bedrock aquifer modelled bottom fluxes support the conceptual model of lateral flow providing a pathway for midwinter recharge both the low lateral flow ks 1 cm hr 0 5 runoff and high lateral flow ks 9 cm hr 2 runoff cases better explain the observed hydraulic head fluctuations measured in the bedrock outcrop compared to vertical infiltration alone fig 6 4 4 additional midwinter melt the induced i e hypothetical midwinter warming event resulted in a 13 cm decline in snow depth with a thin 8 1 cm snowpack remaining fig 7 a in the no outcrop scenario this midwinter melt event did not result in additional water fluxes draining from the bottom of the soil profile from this it can be inferred that no bedrock recharge would occur in this case from this midwinter melt example and other actual events from this winter the high ice saturation resulting from substantial early winter rainfall restricts midwinter recharge until the snowpack is completely reduced and the frost begins to recede under the conceptual model of lateral infiltration along the soil rock contact however considerable water fluxes are possible from both the high and low flow cases first grey bar fig 7c the comparison between simulations with lateral flow and the hydraulic head measurements in the bedrock aquifer fig 6 would suggest that this midwinter melt would produce similar hydraulic head rises recharge as those observed in early march the midwinter melt resulted in a thinner snowpack for the remainder of the winter which increased frost depths by 5 6 cm across the scenarios fig 7b the high and low lateral flow cases were similar prior to introducing the melt but differed slightly with deeper frost following the melt this led to a 2 day difference in complete soil thaw between the high and low flow cases consequently there is a similar lag between the peak water fluxes leaving the soil profile grey bars in fig 7c an even greater delay in deep subsurface drainage was seen with the no outcrop case here the deeper frost depths led to a 9 day delay in complete soil thaw and peak water fluxes 5 discussion 5 1 sensitivity to the hydraulic conductivity of the soil rock interface the ks of the lower soil node determined what proportion of bedrock runoff was needed to fit the measured vwc i e 1 cm hr vs 9 cm hr in fig 5 the bottom boundary theoretically represents a combination of the ks of the soil rock interface the discrete fractures and the bedrock matrix although the ks of discrete fractures can be up to 90 cm hr 2 5 10 4 m s the matrix is likely on the order of 4 10 5 cm hr 1 10 10 m s gleeson et al 2009 and the very low 5 10 4 specific yield of the bedrock milloy 2007 would not drain appreciable volumes of infiltrating water thus the primary control on draining most of the water away from the soil profile is likely along the slope of the soil rock interface previous studies have found flow velocities along this interface can be 1 3 orders of magnitude higher than surrounding soils graham et al 2010 sohrt et al 2014 zhao et al 2020 results here show that an interface with a ks equal to or 1 order of magnitude higher than the soil can simulate measured vwc dependent on soil characteristics if the interface has a low air entry potential 0 05 m the necessity of a low air entry potential suggests macropores between the soil and rock may be at play reitsma and kueper 1994 zhao et al 2020 this study demonstrates that hydraulic measurements of this interface are key for constraining a hydrologic model of local scale infiltration near outcrops in addition to more common hillslope simulations e g bockgård and niemi 2004 appels et al 2015 gardner et al 2020 these measurements however are challenging to obtain and typically require detailed experimental sprinkler equipments and dye tracers e g graham et al 2010 sohrt et al 2014 zhao et al 2020 thus a focus should be placed on obtaining hydraulic measurements of this nature as well as developing simplified field testing techniques for the soil rock interface for both high and low lateral flow cases an exact fit to the measured data was not achieved but this was not the primary objective of the simulations heterogeneities and hysteresis in the soil drainage curves that are not represented in these simulations could account for the differences between measured and simulated data producing similar fits with different hydraulic properties places additional limitations on the simulations better constraining the soil drainage parameters with field and lab measurements could likely have improved the model fit but the main goal of this study was to simulate the basic infiltration responses test the proposed conceptual model and evaluate the key processes that need to be implemented into more robust numerical models the system being modelled clearly requires a multi dimensional approach but the pseudo two dimensional method applied here provides a more tractable approach and a proof of concept for additional studies 5 2 activation of the soil rock interface the addition of lateral flow generally improved the fit to measured moisture content and better reflected the observed hydraulic head patterns in the bedrock fig 6 however throughout the groundwater recession that occurred from mid january to late february minor snowmelt and ros events did not result in water table fluctuations and modelled vwc was over estimated on an event basis wright and novakowski 2020b observed thick ice 5 6 cm at the base of the snowpack basal ice that formed from the freezing of ponded water on surface following the extreme rainfall event in early january basal ice forms from the percolation of snowmelt water to the base of the snowpack and can be found in a variety of environments lundberg et al 2016 peeters et al 2019 phillips et al 2016 woo et al 1982 including humid northern climates such as the study area sturm et al 1995 although shaw does an energy and water balance for the snowpack ponded water is not included as a result the associated reduction in infiltrability was not captured in the simulations and may account for the over estimation of midwinter vwc there may also be a precipitation snowmelt threshold that leads to sufficient saturation conditions to enable lateral flow along the soil rock contact much like the precipitation thresholds found at larger hillslope scales e g tromp van meerveld and mcdonnell 2006 hopp and mcdonnell 2009 graham et al 2010 an ice saturation threshold may also need to be met to deactivate flow along this interface for example mohammed et al 2021 found that with each additional midwinter snowmelt event infiltrability of macropores was reduced due to the refreezing of porewater as such the deactivation threshold may have been reached following the repeated snowmelt and ros events by mid february since it is hypothesized that the macropores along the soil rock contact are larger and more continuous than soil macropores the threshold for deactivation may be greater compared to soil macropores the induced midwinter snowmelt event in february fig 7 assumes the interface was activated and lateral infiltration could take place but it is difficult to determine if this would be the case without accounting for the full surface water and energy balance in a 2 d simulation the induced melt however was of similar intensity to observed late winter melts that did result in bedrock recharge which suggests an event threshold would hypothetically be met additionally the subsurface thermal implications of the melt event namely reduced snow depth would generally be independent of subsurface infiltration further field and modelling work however is needed to better understand the activation deactivation of the soil rock interface under repeated midwinter snowmelt and ros events under various climate change scenarios 5 3 hydrologic implications study findings extend to similar bedrock environments common throughout north america scandinavia russia and china richts et al 2011 where warming conditions are also leading to cryo hydrologic change ipcc 2019 findings suggest that in the absence of an outcrop limited bedrock recharge would have occurred under the simulated warm and rainy winter conditions although frost was relatively shallow in this case the high ice saturations generated from early winter rain and snowmelt were sufficient to inhibit vertical infiltration through the soil simulations can also be considered conservative since surface ice layers basal ice that would further reduce infiltrability were not accounted for this implies that even a thin soil veneer 75 cm over bedrock could be sufficient to limit midwinter bedrock recharge and increase surface runoff during midwinter melts this study supports the concept that bedrock outcrops can provide a pathway for rapid and localized midwinter recharge both via the soil rock interface at outcrop margins wright and novakowski 2020b and frost free fractures spence and woo 2002 thorne et al 1998 since the specific yield of the bedrock outcrop is low 5 10 4 inflow along the soil rock interface may lead to greater volumes of snowmelt partitioning into the subsurface and offers considerably higher storage for subsequent diffuse recharge than fractured rock alone under a colder climate scenario little recharge occurs in the winter because precipitation is stored on surface as snow until temperatures rise above freezing in spring since this study suggests a mechanism that permits winter infiltration and recharge it is reasonable to infer that with increased ros and midwinter melts under climate change winter recharge will increase relative to a cold climate scenario where temperatures consistently remain below freezing although bare bedrock represents only a small 5 proportion of landcover in the study watershed outcrops may be responsible for far greater winter recharge on a regional scale further work however is needed to assess the extent of lateral flow away from the outcrop and the radial influence it has on the underlying groundwater system additional midwinter melts decrease snow depth which alters the subsurface thermal regime by deepening frost lundberg et al 2016 and leading to delayed ground thaw fig 7 meltwater being stored in the overburden can contribute to recharge but much larger volumes of water are stored on surface as snow and ice thus the delay in ground thaw of saturated frozen ground delays infiltration deep percolation and recharge while increasing surface runoff this has implications for estimating seasonal annual recharge rates in vulnerable bedrock aquifers and for flood forecasting sharp declines in soil temperature that correspond to infiltration events could not be accounted for by modelling vertical advection which provides strong evidence for the soil rock interface as a pathway for lateral advective heat transport not only does this have implications for the timing of seasonal frost thaw and infiltration guan et al 2010b 2010a sjöberg et al 2016 but it has also been demonstrated that lateral flow can accelerate permafrost thaw e g rowland et al 2011 de grandpré et al 2012 kurylyk et al 2016 sjöberg et al 2016 lateral flow along the soil rock interface has been observed during spring freshet in subarctic shield catchments spence and woo 2003 2002 but its influence on permafrost thaw has not been explored warmer bedrock runoff flowing laterally along the soil rock interface and increased moisture content will likely influence the timing of seasonal frost thaw near outcrops and possibly affect rates of permafrost thaw in discontinuous permafrost shield environments such environments are undergoing a gradual transition from perennially to seasonally frozen ground due to rapidly rising annual average air temperatures box et al 2019 since field investigations in northern latitudes particularly in bedrock can be cost prohibitive the use of southern analogues i e space for time approach such as this study can help identify key processes requiring further investigation and inform future hydrologic changes in remote northern locations under continued global warming 6 conclusions hourly weather data collected over an unseasonably warm and rainy winter 2019 2020 was used as input in the physically based 1 d shaw model to simulate the thermal and hydrologic conditions of the surface and shallow 75 cm subsurface model scenarios were created to test a conceptual model representing midwinter infiltration along the soil rock interface as compared to measured field data additional objectives were to establish if midwinter recharge would occur in the absence of an outcrop and assess the hydrologic implications of an additional hypothetical midwinter melt event from the results of the numerical investigation the following conclusions were made 1 vertical midwinter infiltration through the soil profile was largely restricted by high 80 ice saturations near surface that resulted from rain on snow and snowmelt events during early winter evidence suggests that under wet winter conditions and in the absence of a bedrock outcrop deep percolation and bedrock recharge is limited to the spring freshet or sufficient midwinter warming events that result in complete ground thaw 2 simulations support the concept that the soil rock interface provides a key pathway for midwinter infiltration and bedrock recharge where it would otherwise be inhibited by low permeability frozen soils runoff generated from the bedrock outcrop provides lateral subsurface inflow which is controlled by the hydraulic conductivity of the soil rock interface 3 with all else equal the addition of a midwinter warming event results in a reduced snowpack which cools the subsurface and deepens frost the deepening of frost leads to a delay in infiltration deep percolation and bedrock recharge while increasing surface runoff if the soil rock contact is activated midwinter melt events would result in enhanced bedrock recharge not only do findings demonstrate the cryo hydrological processes that enable mid winter recharge but they also provide insight into how these processes may be influenced under repeated midwinter melts the hydrologic implications of increased midwinter melts apply to groundwater resource management and protection as well as flood forecasting and mitigation it is well known that outcrops can be important areas of localized bedrock recharge but studies to date have largely focused on rain dominated systems or the spring freshet this study supports the notions that outcrops can also be local areas of winter time recharge and that the winter season is becoming more hydrologically active in the northern hemisphere under climate change further work is needed however to assess the lateral extent of subsurface flow along the soil rock interface and the influence of this local recharge on larger groundwater systems new insights from this study indicate that the hydraulic conductivity of the soil rock interface is an important control on lateral inflow so focus should be placed on this measurement and the development of hydraulic field testing methods for the soil rock interface additionally the thresholds that enable lateral flow i e event size and ice saturation require further studies that encompass multi dimensional and physically based models nevertheless this numerical analysis was a critical step to provide a proof of concept for future investigations and provide new insight on modelling approaches for representing lateral flow along the soil rock interface findings extend to similar bedrock environments in the northern hemisphere that are essential for ecosystem functioning and freshwater supply and are rapidly changing under a warming climate credit authorship contribution statement stephanie n wright writing original draft writing review editing conceptualization formal analysis kent s novakowski supervision conceptualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors wish to thank m howroyd n pease and m davidson for their assistance in the field dr a mohammed for his insight on model configuration and simulation and dr g ferchinger for his technical support additional thanks to the miller family for site access this work was supported by the natural sciences and engineering research council of canada rgpin 05060 2016 and the dean s research fund faculty of engineering and applied science queen s university supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2022 104261 appendix supplementary materials image application 1 
126,shallow bedrock aquifers are prevalent across the northern hemisphere and can be the primary source of freshwater for many communities cryospheric impacts from climate warming are particularly concerning for bedrock aquifers where recharge is dominated by winter precipitation for the management and protection of fractured rock groundwater supplies the processes influencing infiltration and recharge under warmer winter conditions require a greater understanding as such a numerical investigation was undertaken with the objective of testing a conceptual model of midwinter infiltration and recharge near a granitic canadian shield bedrock outcrop using data collected over an unseasonably warm and rainy winter in eastern ontario canada additional objectives were to determine if infiltration and recharge would be limited through frozen soils without an outcrop and to explore the hydrologic implications of an additional midwinter snowmelt event results supported the concept that outcrops provide preferential infiltration along the soil rock interface at outcrop margins which enables localized bedrock recharge under frozen conditions to simulate soil moisture content near the outcrop bedrock runoff was needed as additional lateral input in the lower soil profile 75 cm the amount of runoff required as input was controlled by the hydraulic conductivity of the soil rock interface in the absence of an outcrop limited midwinter infiltration occurs due to reduced permeabilities of frozen soils from repeated early winter rainfall and snowmelt events additional midwinter melt events can likely increase bedrock recharge but the associated decline in snow depth deepens soil frost which delays further infiltration and increases surface runoff simulations suggest winter is becoming a more active time for bedrock recharge where outcrops are present but wetter conditions have implications for frozen soil permeability findings extend to similar seasonally frozen bedrock environments which are relied on as a source of freshwater and are rapidly changing under a warming climate keywords bedrock recharge seasonally frozen soils snowmelt infiltration soil rock interface canadian shield climate change 1 introduction almost half of canada s landmass is covered by the canadian shield bostock 2014 fig 1 which is comprised of fractured crystalline bedrock overlain by a thin discontinuous veneer of glacial soils kettles 1992 similar landscapes can be found in norway sweden finland and western russia where the baltic shield is a dominant landcover allaby 2010 fractured bedrock in northern environments contain aquifers that are highly depended upon for municipal domestic and agricultural water supply e g beyer 1968 herr et al 1978 karro 1999 nunes et al 2017 and often winter precipitation and snowmelt are the dominant sources of groundwater recharge abbott et al 2000 jasechko et al 2014 2017 raidla et al 2016 wright and novakowski 2020a however rising temperatures from climate change are increasing the occurrence of midwinter warming kreyling 2010 vikhamar schuler et al 2016 and rain on snow ros events il jeong and sushama 2018 when combined with repeated freeze thaw cycles these cryospheric changes have implications for the spatiotemporal patterns of infiltration and recharge lundberg et al 2016 there remains a lack of understanding regarding what these changes mean for shallow bedrock aquifers bare rock outcrops are common in shield landscapes and have previously been identified as key areas for bedrock recharge e g peters et al 1995 spence and woo 2002 gleeson et al 2009 wright and novakowski 2019 zhao et al 2020 the importance of outcrops on local recharge stems from the absence of overlying soils which allows for direct infiltration along open fractures due to the low storage of crystalline aquifers even a small precipitation event can result in rapid and large many meters hydraulic head rises and groundwater recharge cai and ofterdinger 2016 miles and novakowski 2016 rock outcrops have also been shown to influence ecological functions zhao et al 2018 local infiltration patterns soil hydraulic properties zhao et al 2020 soil moisture li et al 2016 and contaminant transport levison and novakowski 2012 thus better understanding outcrop scale processes is of considerable value to groundwater resource protection management and ecosystem services despite the prevalence of shield environments in the northern hemisphere the role of ice and frost on bedrock infiltration and recharge has not been well characterized many hydrological studies in shallow bedrock environments occur at the hillslope scale with a primary focus on runoff generation and stream discharge resulting from summer rainfall buttle et al 2004 buttle and turcotte 1999 peters et al 1995 renzetti et al 1992 these studies along with others across many environments e g spence and woo 2003 kosugi et al 2006 onda et al 2006 tromp van meerveld and mcdonnell 2006 graham et al 2010 fu et al 2012 sohrt et al 2014 have observed lateral interflow along the soil rock interface as a primary pathway for hillslope runoff and bedrock infiltration similar observations have occurred at the outcrop scale li et al 2016 wright and novakowski 2020b zhao et al 2020 since the canadian shield is common throughout cold regions frozen processes will influence infiltration and recharge and likely affect the activation and connectivity of the soil rock interface but this is poorly understood the partitioning of infiltration and recharge along the soil rock interface of hillslopes has previously been modelled appels et al 2015 bockgård and niemi 2004 gardner et al 2020 kormos et al 2015 but freeze thaw processes were not included additionally no outcrop scale numerical investigations have been undertaken particularly that incorporate physically based frozen processes in the simulations to date most hydrologic studies on bedrock outcrops and preferential lateral flow have occurred in karst limestone li et al 2016 zhao et al 2018 occur at larger hillslope scales e g peters et al 1995 graham et al 2010 fu et al 2012 kormos et al 2015 only focus on the spring freshet gleeson et al 2009 and or take place during rain dominated seasons levison and novakowski 2012 miles and novakowski 2016 praamsma 2016 relatively few studies have investigated the outcrop scale processes influencing infiltration and recharge under frozen conditions spence and woo 2002 thorne et al 1998 except for wright and novakowski 2020b the processes of midwinter recharge have not been examined closely and none have employed physically based models to understand such processes considering that rising temperatures from climate change are altering the cryosphere and the importance of outcrops on bedrock recharge additional investigations are needed that examine cryo hydrologic processes surrounding shield outcrops additionally understanding the key infiltration and recharge processes under warmer winter conditions and how to represent them in numerical models is imperative for projecting and protecting groundwater resources under climate change this study stems from a conceptual model of midwinter infiltration and bedrock recharge that was developed by wright and novakowski 2020b using cryo hydrogeologic data collected over an unseasonably warm and rainy winter season 2019 2020 these winter conditions were considered analogous to what is anticipated under future climate scenarios the conceptual model consists of lateral infiltration along the soil rock interface at outcrop margins that bypasses low permeability frozen soils in the absence of an outcrop it was hypothesized that limited vertical infiltration would take place but field data could not confirm this through numerical analysis the objectives of this study are to 1 establish if vertical infiltration would occur through the overburden without an outcrop under the 2019 2020 warm and wet winter 2 test the conceptual model of lateral flow along the soil rock interface as a pathway for midwinter infiltration and 3 examine the hydrologic implications of an additional midwinter melt on the relative timing and magnitude of vertical infiltration and bedrock recharge all objectives use collected field data but objective 3 involves a hypothetical scenario using hourly weather data from december 2019 to april 2020 the thermal and hydrological conditions of the surface and subsurface were simulated using the physically based 1 d simultaneous heat and water shaw model results were compared to measured field data to determine if general infiltration and recharge patterns could be reproduced to support the conceptual model the scenarios considered included a shallow 75 cm soil profile with and without a nearby bedrock outcrop and the same soil profiles with an additional simulated midwinter melt findings can be extended to similar frozen bedrock environments which are relied on as a source of freshwater for domestic municipal and agricultural use and are rapidly changing under a warming climate 2 study site data for the numerical analysis was collected at a site located near perth ontario in the tay river watershed fig 1 the investigation focuses on processes occurring at the outcrop scale 10 m by 20 m in this case situated in an agricultural field used to annually harvest hay approximately 5 of the 850 km2 watershed is bedrock outcrop 20 is agricultural land 50 is mixed forests and the remaining area is wetland and water bodies ontario ministry of natural resources and forestry 2016 the area is underlain by non weathered precambrian syenite migmatite bedrock dugas 1952 wilson 1930 with a thin up to 8 m till veneer kettles 1992 uplift from glacial unloading has resulted in horizontal sheeting fractures and inclined fractures striking northeast which control groundwater recharge and flow in the bedrock gleeson et al 2009 the area is low lying with minimal topographical relief climate of the study region is humid continental baldwin et al 2000 köppen 2011 in drummond centre ontario 15 km north of site average annual rainfall is 702 2 mm and annual snowfall is 174 0 mm water equivalent with similar precipitation amounts across all four seasons 1981 2010 eccc 2021 from the same station daily average air temperatures are 6 1 c 1 3 c snow cover is typically present between mid november and mid april annual precipitation and temperature in the area have historically been increasing wazneh et al 2017 average winter temperatures winter precipitation and the frequency of freezing rain events are predicted to increase across the region by 2100 cheng et al 2011 mcdermid et al 2015 3 methods 3 1 data collection weather data collected at hourly intervals included air temperature 0 3 c hygrovue 5 relative humidity 3 hygrovue 5 solar radiation expected accuracy for daily sums 10 cmp3 pyranometer wind speed 1 1 m s onset wind direction 5o onset precipitation 1 0 hobo tipping bucket and snow depth 1 cm sr50a snowfall was measured using an antifreeze adaptor campbell scientific cs705 for a tipping bucket rain gauge mccaughey and farnes 1996 in the unsaturated overburden a profile of five meter group 5tm volumetric water content vwc 3 and temperature sensors 1 c were installed at depths illustrated in fig 2 a the lowest sensor was positioned as close to the soil rock contact as sensor geometry would allow vwc was converted from dielectric permittivity using topp et al 1980 for normal mineral soil since the dielectric constants of ice and dry mineral soil are fairly similar 3 2 and 2 2 3 5 and differ considerably from water 80 the sensors approximate the unfrozen volumetric water content of the soil patterson and smith 1981 at an operating range down to 40 c a pressure transducer with a thermistor 3 mm 0 05 c solinst levelogger was also installed in the bedrock outcrop at 7 5 m below ground surface bgs in a drilled well to compare groundwater responses to fluxes exiting the soil profile for further details on the data instrumentation and collection refer to wright and novakowski 2020b 3 2 conceptual model the conceptual model being tested consists of a fractured crystalline rock outcrop with a sloped contact between the adjacent glacial till fig 2a repeated rainfall and snowmelt events in the early winter results in frozen saturated ground and low permeability soil that inhibits subsequent vertical infiltration through the soil profile near the outcrop however runoff generated from ros or midwinter snowmelt events can bypass the frozen soil layer and enter the subsurface laterally along the soil rock interface here the soil rock interface is defined as a thin 1 cm sloped contact between bedrock and overburden where sheet flow occurs fig 2a this is represented numerically by a single node at the bottom of the soil profile fig 2b a multi node approach 5 20 nodes was also investigated but did not influence the interpretation of the results and it was beyond the scope of the study to explore other variations in lateral subsurface flow in detail e g diffuse or pipe flow this preferential flow pathway may remain open because of advective heat transfer from bedrock runoff and or the higher thermal conductivity of the bedrock leading to greater warming during melt events and higher conduction from geothermal heat compared to soils additionally macropores along the contact that form from soil contraction expansion may be enhanced relative to those in soil due to additional soil erosion from water flowing along the bedrock boundary water entering along the soil rock contact is primarily partitioned into to the high storage unsaturated soil and directed down slope to depressions in the overlying bedrock secondary partitioning of lateral flow is into the fractured bedrock where water rapidly drains into low storage fractures which results in large many meters water table rises 3 3 shaw model description the simultaneous heat and water model shaw 3 0 2 is a robust physically based model flerchinger and saxton 1989 ireson et al 2013 mohammed et al 2018 with the demonstrated ability to simulate both near surface conditions including the snowpack and heat and water transport in soils under freeze thaw conditions chen et al 2019 li et al 2012a 2012b marshall et al 2019 xu et al 1991 shaw was selected for the numerical analysis after careful review of available codes see discussion in supplementary material the finite difference model first developed by flerchinger and saxton 1989 simultaneously solves energy and water balances through a one dimensional profile that extends from plant canopy to a specified subsurface depth while accounting for effects of snow dead plant residue and plant cover plant cover was not simulated in this case due to the absence of plant growth during winter months in the hay field although shaw is a one dimensional model it can be configured to be pseudo two dimensional by including lateral inflow outflow at each node over the entire soil profile using a source sink term in the richard s equation for a summary of all the heat and water processes considered in the shaw model refer to fig s1 in supplementary material 3 3 1 heat flux through the system the energy balance for each layer of snow is given by 1 ρ s p c i t t ρ l l f θ s p t z k s p t z r n d z l s ρ v t q v z for a layer of potentially freezing soil the 1 d heat flux equation considering advective heat transfer by liquid and latent heat transfer by vapor is given as 2 c s t t ρ i l f θ i t z k s t z ρ l c l q l t z l v ρ v t q v z where ρsp ρl ρi ρv are density of snow liquid water ice and vapor kg m 3 θsp and θi are volumetric liquid water and ice content m3 m 3 ksp and ks are thermal conductivity of the snow and soil w m 1 c 1 ci and cl are specific heat capacity of ice and liquid water j kg 1 c 1 cs is volumetric heat capacity j kg 1c 1 rn is net downward radiation flux within the snow w m 2 lf and ls are latent heat of fusion and sublimation j kg 1 qv is vapor flux kg s 1 m 2 ql is liquid water flux through the soil m s 1 and t is temperature c 3 3 2 water flux through the system liquid water content is computed for each snow layer from the energy balance while assuming density and ice content are constant for each time step snow layer thickness and density modified for compaction and settling are adjusted for vapor transfer and change in liquid content at the end of each time step attenuation and lag coefficients are used to route excess liquid water through the snowpack the resulting outflow and any rainfall and ponded water are infiltrated into the soil using a green ampt approach for a multi layered soil at the end of each timestep the equation for water flux through the soil considering freezing and thawing is given by 3 θ l t ρ i ρ l ρ θ i t z k ψ z 1 1 ρ l q v z u where k is unsaturated hydraulic conductivity m s 1 ψ is soil matric potential m and u is a source sink term for water flux m3 m 3s 1 which allows for water to artificially be introduced into the profile in this study u is used to add water into the lower soil node to represent lateral subsurface flow from upslope that travels along the soil rock contact and enters the soil profile fig 2b matric potential is given by the brooks corey relation for the soil moisture release curve with unsaturated hydraulic conductivity computed from 4 k k s ψ ψ e λ l 2 2 where ks is saturated hydraulic conductivity m s 1 ψe is air entry potential m l is a pore connectivity parameter and λ is the brooks corey pore size distribution parameter it is assumed that water flow through frozen soil is analogous to unfrozen soil and therefore the relationship between matric potential and unsaturated hydraulic conductivity remains valid to account for the reduced permeability from ice blocking pore throats hydraulic conductivity is linearly reduced with ice content and assumed zero below a porosity of 0 13 bloomsburg and wang 1969 soil matric potential directly affects the freezing point of water in the presence of ice the clausius clapeyron equation describes the thermodynamic equilibrium between pressure and temperature by 5 ϕ l f g t t k where ϕ is the total water potential m g is the acceleration of gravity m s 1 and tk is temperature k 3 3 3 boundary and initial conditions the water and energy fluxes at the upper boundary are calculated from hourly weather data including air temperature relative humidity solar radiation wind speed and precipitation the equation for the surface energy balance is as follows 6 r n h l v e g where rn is net radiation w m 2 h is sensible heat flux w m 2 lve is latent heat flux w m 2 g is ground heat flux w m 2 lv is latent heat of evaporation j kg 1 and e is total evapotranspiration from the soil surface and plant canopy kg m 2 s 1 prior to using measured precipitation for simulations all precipitation was corrected for wind induced undercatch using the exponential transfer function developed by kochendorfer et al 2017 7 c e e a u 1 t a n 1 b t a i r c where ce is catch efficiency u is wind speed m s tair is air temperature c and a b and c are coefficients determined from site data the coefficients used are for an unshielded gauge with 10 m height wind speeds up to 8 m s us un from kochendorfer et al 2017 these conditions most closely reflected those of the study site where maximum wind speed measured was 8 05 m s other correlation coefficients were tested but the us un coefficients yielded the closest approximation to the measured snowpack when modelled in shaw fig 3 several adjustments e g precipitation increases temperature decreases were also made to the input data to better align the simulated snowpack with the snow depth measured on site fig 3a these manual adjustments were made because the focus of this study was not on snowpack simulation but instead on providing realistic surface conditions for the assessment of subsurface processes adjustments were made to the data on december 30 january 6 february 15 and february 18 details in supplementary material a unit gradient was applied to the bottom boundary for water flux where the gradient is assumed to be driven by gravity alone under gravity drainage the gradient term for matric potential in eqn 3 becomes zero and the water flux exiting the soil profile is limited by the k of the bottom node in the near outcrop scenario drainage is therefore limited by the k of the soil rock interface which can be scaled by varying ks gravity drainage was selected because the underlying rock is highly fractured which allows for rapid drainage ks 0 9 90 cm hr to the water table that remains in the bedrock miles and novakowski 2016 although gravitational discrepancies between vertical drainage and that along a bedrock slope 12 5 may influence the magnitude of water flux exiting the profile only the relative patterns of flux are being evaluated in this study the bottom thermal boundary was specified for each time step using temperatures measured from the lowest sensor at 73 cm since temperature responses appeared to be influenced by advective heat transport from water fluxes during infiltration the whole temperature time series was not applied to the bottom boundary to investigate if simulated vertical infiltration events could produce observed temperature fluctuations instead five points in the time series between infiltration events were input for the thermal boundary where values between points were linearly interpolated within shaw fig 4 75 cm shaw requires initial values of total moisture content and temperature for each soil node in the simulation measured values of temperature and total moisture content right before freezing were linearly interpolated between field sensors for the input file initial moisture content and temperature profiles for each node used in the simulation can be found in supplementary material fig s2 3 3 4 numerical implementation the 1 d energy and water balance equations for snow and soil are written in implicit finite difference form and solved iteratively using a newton raphson technique flerchinger 2017 linear gradients are assumed between nodes to calculate flux and energy storage is calculated from layer thickness for each node the flux equations are written in terms of unknown end of time step values where the partial derivatives are computed to form a tri diagonal matrix the newton raphson approximations for the unknown values in the matrix are computed and iterations continue until approximations are within a prescribed tolerance for this study tolerance was set at 0 001 which is in c for energy balance and fraction of change in matric potential or vapor density for water the iterative solutions alternate between the heat flux and water flux equations for each time step and updated values from one iteration are used in the other until a prescribed tolerance is reached this allows for the flux equations to be solved simultaneously and maintains the correct balance between the coupled heat and water flux equations a procedural flow chart for the shaw model has been included in supplementary material fig s2 3 3 5 subsurface parameter estimation parameter estimations used for the simulations are shown in table 1 the percent of sand silt and clay was estimated from in field soil characterization when soil was excavated for sensor installation hydraulic conductivity of the soil was measured on site by gleeson et al 2009 and miles and novakowski 2016 values ranged from 0 2 to 2 cm hr with a mean of 1 cm hr which was used for vertical ks and lateral ks lat hydraulic conductivity following model calibration table 1 model fit was evaluated based on the root mean square error rmse between field observations and simulated moisture content and temperature isotropic conditions were used to avoid adding additional model complexity that could not be supported with field measurements saturated vwc θs was assumed to be the maximum vwc measured at each soil horizon fig 2a values ranged from 0 23 0 43 with a vertical harmonic mean of 0 34 over 0 73 m the mean value was used for the entire soil profile in early simulations but improved fits to measured moisture content could be achieved with a three layered system using values that more closely reflected field measurements fig 2c the brooks corey parameters used for the simulations are shown in table 1 during model testing these parameters namely air entry potential and pore size distribution were manually adjusted one at a time within the range of literature values for this soil type different combinations of parameters at different soil horizons resulted in similar fits to the measured data example provided in supplementary material as fig s3 since introducing additional heterogeneity did not alter the interpretation of the results and that this heterogeneity could not be constrained using field measurements a constant value within the range of literature values that resulted in the best fit to moisture content data was used for the entire soil profile table 1 through model calibration it was found that independently varying the values for air entry potential 0 2 0 5 and pore size distribution parameter 2 4 shifted the vwc up and down but generally maintained a similar response to infiltration events varying residual water content 0 01 0 1 did not change the simulated vwc no site measured values were obtained for the soil rock interface so all values have been inversely estimated from simulations the hydraulic properties assigned to represent the soil rock contact were kept the same as the soil profile except for hydraulic conductivity and air entry potential this difference was to account for distinct properties of the soil rock interface which can have higher hydraulic conductivities than overlying soil graham et al 2010 that are further enhanced by high drainage macropores between the soil and rock zhao et al 2020 a lower air entry potential 0 05 m was used to represent such enhanced drainage along the sloped 12 5 interface a range of hydraulic conductivities equal vertical and lateral for the soil rock contact were tested 0 1 9 cm hr with 1 cm hr and 9 cm hr providing similar fits depending on the proportion of runoff added as lateral flow discussion on this point is revisited in section 5 1 an example of the input file which includes the soil properties used for each node is included in supplementary material 3 4 simulations site characteristics used in the simulations correspond to the study site 44o50 n with a ground slope of 1 and elevation of 155 m above sea level the primary model used in all simulations includes a transient multi layered snowpack 1 cm dead plant residue and 75 cm soil profile with three layers of specified thickness as shown in fig 2c for these simulations 96 nodes were used where vertical nodal spacing was 0 005 m between 0 0 2 m and 0 01 m between 0 21 0 75 m fig s4 simulations with 36 nodes and 76 nodes with a similar discretization configuration were also tested but since fewer nodes did not impact the run time or change the interpretation of results the highest possible number of soil nodes were used for this nodal spacing a finer nodal spacing was used in the upper 0 2 m as it is most likely to develop frost based on measured soil temperatures the models were run with hourly time steps which is the smallest possible time step in shaw the bottom node at 75 cm of the primary model was adjusted to represent a soil profile adjacent to a bedrock outcrop fig 2b and a profile without an outcrop fig 2c for the no outcrop scenario the soil hydraulic characteristics of the bottom node were kept consistent with the rest of the soil profile the same properties were used for the near outcrop scenario except for hydraulic conductivity and air entry potential of the bottom node the near bedrock scenario was run with and without lateral flow under the same boundary conditions and compared to field measured data using the rmse details and summary table in section s2 supplementary material subsurface lateral flow along the soil rock interface was represented by adding water flux into the lower soil profile equal to varying proportions of bedrock runoff i e 0 5 2 runoff which represents different bedrock contributing areas and partitioning of surface and subsurface water bedrock runoff was estimated by generating a third model representing the near impermeable bedrock surface although the bedrock is fractured minimal volumes of water would be removed from runoff into the bedrock due to its very low 5 10 4 specific yield milloy 2007 the surface slope was adjusted to that of the soil rock interface 12 5 and the same weather conditions were applied as the soil profiles the runoff output file was then used as an input file for lateral flow note that the temperature of the lateral inflow cannot be specified in shaw however the relatively small temperature fluctuations introduced by water entering the bottom of the profile is not expected to influence frost depths near surface which will be dominated by much larger variations in air temperature the last simulation explored how an additional midwinter snowmelt event would influence infiltration and recharge an intense midwinter warming event was simulated by increasing air temperatures to 10 c between february 2 4 with all else remaining constant this weather scenario was also applied to the bedrock runoff model to create lateral flow inputs for the near outcrop model the discussion of results with respect to climate warming assumed that the baseline climate regime for comparison is on the far end of the spectrum where temperatures remain below freezing throughout the entire winter since all water would be stored as snow on surface there would be no opportunity for infiltration and recharge to occur as such this scenario did not need to be simulated 4 results 4 1 surface conditions with adjustments described in section 3 3 3 a good approximation of the measured snowpack was achieved fig 3a considering the complexities of snow accumulation melt and redistribution the greatest discrepancies seen were during the spring freshet where the modelled snowpack melted earlier than measured in the field which has implications for the timing of spring infiltration and subsurface thermal conditions discussed in section 4 3 other discrepancies between the shaw model snowpack and measured depth can be attributed to differences in newly fallen snow density and unaccounted for blowing snow snowfall measurements can also be delayed using the cs705 snowfall adapter due to the lag between snow falling on the surface of the antifreeze and the time it takes to melt which increases with decreasing temperature 4 2 no outcrop scenario although no field data was acquired away from the outcrop results from the no outcrop simulations were compared to measured near outcrop data to inform how the soil conditions may differ between the two locations the no outcrop scenario resulted in the driest subsurface conditions and the greatest maximum frost depth of 16 1 cm fig 3b frost depth is computed in shaw based on ice content the simulated temperature profile visually fits well with the measured data the rmse was highest near surface 1 32 and decreased with increasing depth 0 36 at 45 cm due to large temperature variations during snow free periods frost was consistently present between january 1 and the spring freshet that occurred between march 8 12 for most of january and february ice saturation near surface remained above 80 which effectively inhibited vertical infiltration below the top few centimeters of the profile for all scenarios and cases considered similar unfrozen vwc was simulated near surface fig 5 5 cm with rmse only ranging between 0 065 and 0 069 table s1 only the final spring freshet resulted in moisture content increases in the deeper horizons the water flux leaving the bottom of the no outcrop profile was only apparent during the spring freshet which cannot explain the measured water table fluctuations observed in the underlying bedrock aquifer fig 6 this supports the concept that minimal midwinter bedrock recharge would have occurred in the absence of an outcrop greater frost depths by spring likely cause the delayed peak in fluxes draining from the soil profile in this scenario however the diffuse recharge from water released from storage in the overburden during spring freshet is likely a driver of the sustained elevated hydraulic heads observed in march compared to the steeper recession seen following the january rain melt event where more water in the overburden was stored as ice macropores at this site are not well characterized and could provide additional pathways for recharge through the soil that are not captured by this model large air filled pores at the time of soil freezing may also allow for midwinter infiltration granger et al 1984 however based on the repetitive melts rainfall at the onset of winter it is reasonable to assume that there would be limited air filled pores during most midwinter infiltration events in this case any infiltrating water in macropores can also refreeze pittman et al 2020 and considerably reduce infiltration along soil preferential pathways with each consecutive melt event mohammed et al 2021 assuming macropores along the soil rock contact are larger than those in the soil profile this process may not apply to the macropore along the contact or it may take longer for macropores to become sufficiently blocked with ice additionally a relatively thick ice layer 2 6 cm was present at ground surface for most of this winter which is not accounted for in this model as such although macropores are not explicitly incorporated in this simulation the simulation results and field observations suggest possible but considerably reduced midwinter infiltration through frozen soils 4 3 near outcrop scenario initial simulations for the near outcrop scenario considered vertical infiltration alone without the addition of lateral flow from bedrock runoff in the vertical infiltration case the vwc increases throughout much of the profile fig 5 which results in shallower frost depths the ice saturation however remains sufficiently high to again inhibit vertical infiltration below 5 cm although the unfrozen vwc shifts closer to the measured values avg profile rmse 0 066 vertical infiltration alone cannot account for most of the measured peaks in vwc as highlighted by the grey bars in fig 5 like the no outcrop case only the large snowmelt during spring freshet resulted in an increase in unfrozen vwc in the entire soil profile subsequent simulations accounted for lateral flow inputs sourced from bedrock outcrop runoff half of the bedrock runoff 0 5 was added near the bottom of the profile for the case of a soil rock interface with a ks of 1 cm hr fig 5 first column this additional water input improved the simulated vwc for all horizons below 5 cm avg profile rmse 0 044 particularly just above the soil rock contact at 73 cm rmse 0 029 the model improvement is most evident throughout late february and early march this amount of lateral inflow however was still insufficient to account for the vwc increases in upper horizons 22 cm and 45 cm since water entering along the soil rock interface also needs to propagate upwards adding all the bedrock runoff 1 was then tested with further improvements in the fit e g rmse at 73 cm 0 025 but peaks at 22 cm and 45 cm e g around march 1 were still poorly represented adding more water to the system however began to overestimate water content in the lower horizons similar fits could be produced by keeping all else the same except for increasing the ks of the soil rock interface to 9 cm hr avg profile rmse 0 045 with the higher hydraulic conductivity higher lateral inflows 1 and 2 runoff were needed to compensate for more water draining from the profile fig 5 second column the additional water supplied by lateral inflow increased the bulk water content of the profile which decreased the frost depth fig 3b frost depth differed by as much as 9 5 cm between the near and no outcrop scenarios by the end of winter simulated temperatures for all near outcrop cases at the measured horizons remained similar the primary differences between simulated and measured temperatures are highlighted by the grey bars in fig 4 shaw is capable of simulating advective heat transport of water yet the sharp temperature declines corresponding with infiltration events in early january were not reproduced by the vertical infiltration cases it is most likely these temperature responses are from advective heat transport along the soil rock interface however the temperature of lateral subsurface water inputs cannot be specified in the shaw model for this reason there is little difference in the temperature profiles with rmse 0 69 and without rmse 0 68 lateral flow fig 4 the exception is during the spring freshet where temperature increased at 22 cm and 45 cm before measured values this is likely in part due to thinner frost depths but also faster simulated spring snowmelt than observed in the field fig 3a with the early removal of the insulative snow layer the ground warms faster as air temperatures rise lundberg et al 2016 the absolute magnitude of flux exiting the profile along the soil rock contact fig 6 is likely an over estimate due to how water is being forced into the model to represent lateral flow the magnitude of flux for the case with lateral flow is also highly sensitive to model parameters and is therefore limited to this study instead these fluxes are used to provide insight into the timing and relative magnitude of water that is both leaving the profile along the soil rock contact and the small fraction of this water that would enter open fractures and recharge the underlying bedrock aquifer modelled bottom fluxes support the conceptual model of lateral flow providing a pathway for midwinter recharge both the low lateral flow ks 1 cm hr 0 5 runoff and high lateral flow ks 9 cm hr 2 runoff cases better explain the observed hydraulic head fluctuations measured in the bedrock outcrop compared to vertical infiltration alone fig 6 4 4 additional midwinter melt the induced i e hypothetical midwinter warming event resulted in a 13 cm decline in snow depth with a thin 8 1 cm snowpack remaining fig 7 a in the no outcrop scenario this midwinter melt event did not result in additional water fluxes draining from the bottom of the soil profile from this it can be inferred that no bedrock recharge would occur in this case from this midwinter melt example and other actual events from this winter the high ice saturation resulting from substantial early winter rainfall restricts midwinter recharge until the snowpack is completely reduced and the frost begins to recede under the conceptual model of lateral infiltration along the soil rock contact however considerable water fluxes are possible from both the high and low flow cases first grey bar fig 7c the comparison between simulations with lateral flow and the hydraulic head measurements in the bedrock aquifer fig 6 would suggest that this midwinter melt would produce similar hydraulic head rises recharge as those observed in early march the midwinter melt resulted in a thinner snowpack for the remainder of the winter which increased frost depths by 5 6 cm across the scenarios fig 7b the high and low lateral flow cases were similar prior to introducing the melt but differed slightly with deeper frost following the melt this led to a 2 day difference in complete soil thaw between the high and low flow cases consequently there is a similar lag between the peak water fluxes leaving the soil profile grey bars in fig 7c an even greater delay in deep subsurface drainage was seen with the no outcrop case here the deeper frost depths led to a 9 day delay in complete soil thaw and peak water fluxes 5 discussion 5 1 sensitivity to the hydraulic conductivity of the soil rock interface the ks of the lower soil node determined what proportion of bedrock runoff was needed to fit the measured vwc i e 1 cm hr vs 9 cm hr in fig 5 the bottom boundary theoretically represents a combination of the ks of the soil rock interface the discrete fractures and the bedrock matrix although the ks of discrete fractures can be up to 90 cm hr 2 5 10 4 m s the matrix is likely on the order of 4 10 5 cm hr 1 10 10 m s gleeson et al 2009 and the very low 5 10 4 specific yield of the bedrock milloy 2007 would not drain appreciable volumes of infiltrating water thus the primary control on draining most of the water away from the soil profile is likely along the slope of the soil rock interface previous studies have found flow velocities along this interface can be 1 3 orders of magnitude higher than surrounding soils graham et al 2010 sohrt et al 2014 zhao et al 2020 results here show that an interface with a ks equal to or 1 order of magnitude higher than the soil can simulate measured vwc dependent on soil characteristics if the interface has a low air entry potential 0 05 m the necessity of a low air entry potential suggests macropores between the soil and rock may be at play reitsma and kueper 1994 zhao et al 2020 this study demonstrates that hydraulic measurements of this interface are key for constraining a hydrologic model of local scale infiltration near outcrops in addition to more common hillslope simulations e g bockgård and niemi 2004 appels et al 2015 gardner et al 2020 these measurements however are challenging to obtain and typically require detailed experimental sprinkler equipments and dye tracers e g graham et al 2010 sohrt et al 2014 zhao et al 2020 thus a focus should be placed on obtaining hydraulic measurements of this nature as well as developing simplified field testing techniques for the soil rock interface for both high and low lateral flow cases an exact fit to the measured data was not achieved but this was not the primary objective of the simulations heterogeneities and hysteresis in the soil drainage curves that are not represented in these simulations could account for the differences between measured and simulated data producing similar fits with different hydraulic properties places additional limitations on the simulations better constraining the soil drainage parameters with field and lab measurements could likely have improved the model fit but the main goal of this study was to simulate the basic infiltration responses test the proposed conceptual model and evaluate the key processes that need to be implemented into more robust numerical models the system being modelled clearly requires a multi dimensional approach but the pseudo two dimensional method applied here provides a more tractable approach and a proof of concept for additional studies 5 2 activation of the soil rock interface the addition of lateral flow generally improved the fit to measured moisture content and better reflected the observed hydraulic head patterns in the bedrock fig 6 however throughout the groundwater recession that occurred from mid january to late february minor snowmelt and ros events did not result in water table fluctuations and modelled vwc was over estimated on an event basis wright and novakowski 2020b observed thick ice 5 6 cm at the base of the snowpack basal ice that formed from the freezing of ponded water on surface following the extreme rainfall event in early january basal ice forms from the percolation of snowmelt water to the base of the snowpack and can be found in a variety of environments lundberg et al 2016 peeters et al 2019 phillips et al 2016 woo et al 1982 including humid northern climates such as the study area sturm et al 1995 although shaw does an energy and water balance for the snowpack ponded water is not included as a result the associated reduction in infiltrability was not captured in the simulations and may account for the over estimation of midwinter vwc there may also be a precipitation snowmelt threshold that leads to sufficient saturation conditions to enable lateral flow along the soil rock contact much like the precipitation thresholds found at larger hillslope scales e g tromp van meerveld and mcdonnell 2006 hopp and mcdonnell 2009 graham et al 2010 an ice saturation threshold may also need to be met to deactivate flow along this interface for example mohammed et al 2021 found that with each additional midwinter snowmelt event infiltrability of macropores was reduced due to the refreezing of porewater as such the deactivation threshold may have been reached following the repeated snowmelt and ros events by mid february since it is hypothesized that the macropores along the soil rock contact are larger and more continuous than soil macropores the threshold for deactivation may be greater compared to soil macropores the induced midwinter snowmelt event in february fig 7 assumes the interface was activated and lateral infiltration could take place but it is difficult to determine if this would be the case without accounting for the full surface water and energy balance in a 2 d simulation the induced melt however was of similar intensity to observed late winter melts that did result in bedrock recharge which suggests an event threshold would hypothetically be met additionally the subsurface thermal implications of the melt event namely reduced snow depth would generally be independent of subsurface infiltration further field and modelling work however is needed to better understand the activation deactivation of the soil rock interface under repeated midwinter snowmelt and ros events under various climate change scenarios 5 3 hydrologic implications study findings extend to similar bedrock environments common throughout north america scandinavia russia and china richts et al 2011 where warming conditions are also leading to cryo hydrologic change ipcc 2019 findings suggest that in the absence of an outcrop limited bedrock recharge would have occurred under the simulated warm and rainy winter conditions although frost was relatively shallow in this case the high ice saturations generated from early winter rain and snowmelt were sufficient to inhibit vertical infiltration through the soil simulations can also be considered conservative since surface ice layers basal ice that would further reduce infiltrability were not accounted for this implies that even a thin soil veneer 75 cm over bedrock could be sufficient to limit midwinter bedrock recharge and increase surface runoff during midwinter melts this study supports the concept that bedrock outcrops can provide a pathway for rapid and localized midwinter recharge both via the soil rock interface at outcrop margins wright and novakowski 2020b and frost free fractures spence and woo 2002 thorne et al 1998 since the specific yield of the bedrock outcrop is low 5 10 4 inflow along the soil rock interface may lead to greater volumes of snowmelt partitioning into the subsurface and offers considerably higher storage for subsequent diffuse recharge than fractured rock alone under a colder climate scenario little recharge occurs in the winter because precipitation is stored on surface as snow until temperatures rise above freezing in spring since this study suggests a mechanism that permits winter infiltration and recharge it is reasonable to infer that with increased ros and midwinter melts under climate change winter recharge will increase relative to a cold climate scenario where temperatures consistently remain below freezing although bare bedrock represents only a small 5 proportion of landcover in the study watershed outcrops may be responsible for far greater winter recharge on a regional scale further work however is needed to assess the extent of lateral flow away from the outcrop and the radial influence it has on the underlying groundwater system additional midwinter melts decrease snow depth which alters the subsurface thermal regime by deepening frost lundberg et al 2016 and leading to delayed ground thaw fig 7 meltwater being stored in the overburden can contribute to recharge but much larger volumes of water are stored on surface as snow and ice thus the delay in ground thaw of saturated frozen ground delays infiltration deep percolation and recharge while increasing surface runoff this has implications for estimating seasonal annual recharge rates in vulnerable bedrock aquifers and for flood forecasting sharp declines in soil temperature that correspond to infiltration events could not be accounted for by modelling vertical advection which provides strong evidence for the soil rock interface as a pathway for lateral advective heat transport not only does this have implications for the timing of seasonal frost thaw and infiltration guan et al 2010b 2010a sjöberg et al 2016 but it has also been demonstrated that lateral flow can accelerate permafrost thaw e g rowland et al 2011 de grandpré et al 2012 kurylyk et al 2016 sjöberg et al 2016 lateral flow along the soil rock interface has been observed during spring freshet in subarctic shield catchments spence and woo 2003 2002 but its influence on permafrost thaw has not been explored warmer bedrock runoff flowing laterally along the soil rock interface and increased moisture content will likely influence the timing of seasonal frost thaw near outcrops and possibly affect rates of permafrost thaw in discontinuous permafrost shield environments such environments are undergoing a gradual transition from perennially to seasonally frozen ground due to rapidly rising annual average air temperatures box et al 2019 since field investigations in northern latitudes particularly in bedrock can be cost prohibitive the use of southern analogues i e space for time approach such as this study can help identify key processes requiring further investigation and inform future hydrologic changes in remote northern locations under continued global warming 6 conclusions hourly weather data collected over an unseasonably warm and rainy winter 2019 2020 was used as input in the physically based 1 d shaw model to simulate the thermal and hydrologic conditions of the surface and shallow 75 cm subsurface model scenarios were created to test a conceptual model representing midwinter infiltration along the soil rock interface as compared to measured field data additional objectives were to establish if midwinter recharge would occur in the absence of an outcrop and assess the hydrologic implications of an additional hypothetical midwinter melt event from the results of the numerical investigation the following conclusions were made 1 vertical midwinter infiltration through the soil profile was largely restricted by high 80 ice saturations near surface that resulted from rain on snow and snowmelt events during early winter evidence suggests that under wet winter conditions and in the absence of a bedrock outcrop deep percolation and bedrock recharge is limited to the spring freshet or sufficient midwinter warming events that result in complete ground thaw 2 simulations support the concept that the soil rock interface provides a key pathway for midwinter infiltration and bedrock recharge where it would otherwise be inhibited by low permeability frozen soils runoff generated from the bedrock outcrop provides lateral subsurface inflow which is controlled by the hydraulic conductivity of the soil rock interface 3 with all else equal the addition of a midwinter warming event results in a reduced snowpack which cools the subsurface and deepens frost the deepening of frost leads to a delay in infiltration deep percolation and bedrock recharge while increasing surface runoff if the soil rock contact is activated midwinter melt events would result in enhanced bedrock recharge not only do findings demonstrate the cryo hydrological processes that enable mid winter recharge but they also provide insight into how these processes may be influenced under repeated midwinter melts the hydrologic implications of increased midwinter melts apply to groundwater resource management and protection as well as flood forecasting and mitigation it is well known that outcrops can be important areas of localized bedrock recharge but studies to date have largely focused on rain dominated systems or the spring freshet this study supports the notions that outcrops can also be local areas of winter time recharge and that the winter season is becoming more hydrologically active in the northern hemisphere under climate change further work is needed however to assess the lateral extent of subsurface flow along the soil rock interface and the influence of this local recharge on larger groundwater systems new insights from this study indicate that the hydraulic conductivity of the soil rock interface is an important control on lateral inflow so focus should be placed on this measurement and the development of hydraulic field testing methods for the soil rock interface additionally the thresholds that enable lateral flow i e event size and ice saturation require further studies that encompass multi dimensional and physically based models nevertheless this numerical analysis was a critical step to provide a proof of concept for future investigations and provide new insight on modelling approaches for representing lateral flow along the soil rock interface findings extend to similar bedrock environments in the northern hemisphere that are essential for ecosystem functioning and freshwater supply and are rapidly changing under a warming climate credit authorship contribution statement stephanie n wright writing original draft writing review editing conceptualization formal analysis kent s novakowski supervision conceptualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors wish to thank m howroyd n pease and m davidson for their assistance in the field dr a mohammed for his insight on model configuration and simulation and dr g ferchinger for his technical support additional thanks to the miller family for site access this work was supported by the natural sciences and engineering research council of canada rgpin 05060 2016 and the dean s research fund faculty of engineering and applied science queen s university supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2022 104261 appendix supplementary materials image application 1 
127,a fully mixed finite element mfe model is developed for nonlinear flow and transport in unsaturated fractured porous media with matrix fracture and fracture fracture fluid and mass exchanges the model is based on the discrete fracture matrix dfm approach and assumes cross flow equilibrium in the fractures the mfe method is employed for the spatial discretization of both flow and transport on the 2d matrix elements as well as on the 1d fracture elements an upwind scheme is employed to avoid unphysical oscillations in the case of advection dominant transport the temporal discretization is performed using high order time integration methods and efficient automatic time stepping schemes via the mol two test problems dealing with flow and mass transport in saturated and unsaturated fractured porous media are simulated to show the validity of the new model by comparison against i a 1d 2d comsol finite element model and ii a 2d 2d discontinuous galerkin dg model where both fractures and matrix continua are discretized with small 2d mesh elements the robustness and efficiency of the developed 1d 2d mfe model are then investigated for a challenging problem dealing with infiltration of contaminated water into an initially dry soil involving a fracture network the new model yields stable results for advection dominated and advection dispersion transport configurations further the results of the 1d 2d mfe model are in very good agreement with those of the 2d 2d dg model for both configurations the simulation of infiltration of contaminated water into a dry fractured soil shows that the 1d 2d mfe model is within 15 times more efficient than the 2d 2d dg model which confirms the high benefit of using robust and efficient dfm models for the simulation of flow and transport in fractured porous media keywords fractured porous media discrete fracture matrix approach unsaturated flow advection dispersion equation mixed finite element upwind scheme 1 introduction flow and transport in fractured porous media are important in many applications such as water resource management wireman 2003 kavouri et al 2017 contaminant transport berkowitz 2002 brutz and rajaram 2017 klammler et al 2016 nuclear waste management follin and stigsson 2014 mattila and tammisto 2012 and oil and gas production li et al 2015 shen et al 2016 the flow and transport processes in fractured porous media can be significantly affected by the characteristics of the fractures such as location size orientation and aperture the fractures can be empty or contain a filling material berre et al 2019 in this work the fractures are considered filled with a porous medium with different properties from the porous matrix as in khoobor et al 2020 two approaches are commonly used for modeling flow in fractured porous media berre et al 2019 the first approach is based on an implicit representation of the fractures and includes both single continuum and multi continuum models in single continuum models the fractures are taken into account by calculating an equivalent permeability of the porous medium which depends on the properties of the fractures and the fracture network durlofsky 1991 liu et al 2016 in multi continuum models the fractured porous medium is represented by two or more superimposed media with their own flow and or transport equations among these the well known dual porosity model which considers superposition of a low permeability continuum representing the matrix with a high permeability continuum representing the fractures jourde et al 2002 kordilla et al 2012 the two continua are then linked by a linear exchange term more sophisticated multi continuum models have been developed for aquifers with high heterogeneities such as karst aquifers to include different levels of porosities and cavities kuhlman et al 2015 wu et al 2004 the second approach uses on an explicit representation of the fractures among this approach the discrete fracture network dfn model with dfn the geometry and properties of discrete fractures are explicitly incorporated as a central component controlling flow and transport discrete fracture matrix dfm models consider that flow and transport processes occur through both the porous matrix and the explicitly represented fractures as a consequence the dfm model is more appropriate for handling fractures in a permeable porous medium berre et al 2019 considering that the aperture of the fractures is small as compared to the matrix scale the main idea of dfm is to use the cross flow equilibrium concept across the fractures noorishad and mehran 1982 baca et al 1984 granet et al 1998 hoteit et al 2008 as a consequence the fractures can be discretized with elements of co dimension one with respect to the dimension of the surrounding matrix flemish et al 2018 martin et al 2005 such as 1d fracture elements with 2d matrix elements this simplification makes dfm models much more efficient than the single porosity 2d 2d model where 2d elements are used for both matrix and fracture continua note that the applicability of the 2d 2d models is often hampered by their expansive computational cost since they require very fine mesh elements to correctly discretize the fractures with small apertures hoteit and firoozabadi 2005 2006 employed dfm models assuming cross flow equilibrium between the fractures and the adjacent matrix gridcells by imposing the pressure at a fracture and at the adjacent gridcells to be equal although efficient this assumption still requires small mesh elements next to the fractures hoteit and firoozabadi 2008 to avoid this constraint hoteit and firoozabadi 2008 proposed solving the flow equation with the hybrid formulation of the mixed finite element mfe method this formulation has the pressure at the gridcell interfaces as degrees of freedom dof and hence the cross flow equilibrium can be directly assumed across the fractures hoteit and firoozabadi 2008 in this way the matrix pressure at an element edge and the pressure at the fracture which coincides with that edge are assumed to be equal as a consequence no constraints are required for the mesh discretization near the fractures hoteit and firoozabadi 2008 this powerful feature is extended in this work by developing a fully mfe model for both unsaturated flow and transport in the porous matrix and in the fracture continuum the mfe raviart and thomas 1977 chavent and jaffré 1986 is a robust numerical method for solving diffusion problems which has recently received attention in geosciences indeed with mfes the flux and the pressure unknowns are approximated simultaneously the mfe method ensures local mass balance and can easily handle general unstructured meshes younes et al 2010 further it yields an accurate velocity field in highly heterogeneous and anisotropic media durlofsky 1994 the hybridization procedure of the mfe method allows improving its efficiency by reducing the total number of unknowns and producing a final system with a positive symmetric definite matrix chavent and jaffré 1986 the unknowns in this case are the traces of the variable at the edges a lumped formulation of the mfe method has been developed by younes et al 2006 to improve the monotonicity of the solution and reduce the unphysical oscillations observed with transient problems belfort et al 2009 showed that the lumped formulation is more efficient and more robust than the standard one for the simulation of water infiltration into initially dry soils further contrarily to the standard mfe method the lumped formulation maintains the time derivative continuous and thus allows employment of high order time integration methods via the method of lines mol which can be very efficient for solving nonlinear problems fahs et al 2009 and younes et al 2009 although the mfe method is well adapted for diffusion type equations when applied for the advection dispersion transport equation the solution can exhibit strong unphysical oscillations because of the hyperbolic nature of the advection operator therefore the main objective of this work is to develop a stable mfe model for unsaturated flow and mass transport through both the 2d matrix and the 1d fracture elements both fluid and contaminant matrix fracture and fracture fracture exchanges are implicitly taken into account without using any transfer functions even for the case of several intersecting fractures to avoid instabilities caused by the hyperbolic advection term we use a robust monotonic upwind mfe scheme where the traces of concentration at edges are upwinded depending on the direction of the local velocity an implicit scheme is used for the time discretization of the flow and transport equations this alleviates restriction on the size of the time step from the cfl condition of explicit schemes for the sake of brevity the lumped hybrid mfe method employed in this work will also be denoted mfe modeling flow and transport in unsaturated fractured porous media is likely to be highly cpu consuming due to i the strongly nonlinear richards flow equation re ii the high contrast of permeability between the conductive fractures and the low permeable matrix and iii the presence of sharp wetting and or contaminant fronts these difficulties make the commonly used first order backward euler scheme combined with the heuristic time step management inappropriate to obtain accurate solutions in a reasonable cpu time to overcome these difficulties time integration is performed using high order time integration methods via the method of lines mol the mol allows versatile time step length and order of the temporal discretization to reduce the computational time while maintaining accuracy the mol was shown to be effective for the solution of the re in the unsaturated zone fahs et al 2009 khoobor et al 2020 and is used hereafter for the first time for coupled flow and transport through unsaturated fractured porous media this article is structured as follows in section 2 we recall the nonlinear mathematical models governing flow and advection dispersion transport processes in unsaturated porous media in section 3 we develop a robust fully mfe formulation for the solution of flow and transport both in the porous matrix and in the fracture continuum in section 4 numerical experiments are performed for flow and transport in saturated and unsaturated fractured porous media to investigate the validity and robustness of the new 1d 2d mfe model some conclusions are given in the last section of the article 2 governing equations the porous matrix is assumed permeable and the fractures are infilled by a porous medium whose physical characteristics are different from those of the porous matrix flow in variably saturated porous media both in the matrix and through the fractures is assumed to be ruled by the mass conservation of the fluid 1 θ t c h s s θ θ s h t q 0 and the darcy buckingham law 2 q k r k h where c h θ h is the specific moisture capacity l 1 ss is the specific mass storativity related to head changes l 1 θ is the current water content l3l 3 θ s is the saturated water content l3l 3 h h y is the freshwater head l h is the pressure head l y is the upward vertical coordinate l t is the time t q is the darcy velocity lt 1 kr is the relative conductivity k ρ g μ k is the hydraulic conductivity tensor lt 1 ρ is the fluid density ml 3 g is the gravity acceleration lt 2 μ is the fluid dynamic viscosity ml 1t 1 and k is the permeability of the rock matrix as a tensor or that of the fracture as a scalar l2 the transport of contaminants in the unsaturated porous matrix and through the unsaturated fractures is ruled by the advection dispersion equation 3 θ c t q c d c 0 where c is the relative concentration and d is the dispersion tensor given by 4 d d m i α l α t q q q α t q i in which α l and α t are the longitudinal and transverse dispersivities l dm is the pore water diffusion coefficient l2t 1 and i is the unit tensor the standard van genuchten 1980 model is used for the relationship between water content and pressure head 5 s e θ h θ r θ s θ r 1 1 α h n m h 0 1 h 0 where α l 1 and n are the van genuchten parameters m 1 1 n se is the effective saturation and θ r is the residual water content l3l 3 the conductivity saturation relationship is analytically expressed from the mualem 1976 model 6 k r s e 1 2 1 1 s e 1 m m 2 the nonlinear system 1 6 is solved numerically on i unstructured triangular 2d elements for the porous matrix and ii linear 1d elements for fracture branches all hydraulic and transport parameters in the system 1 6 are defined elementwise and therefore they can be different for each matrix or fracture element 3 the fully mfe numerical model in this session we recall the main stages for developing a robust mfe formulation for the solution of the flow and transport equations both in the porous matrix and in the fractures 3 1 discretization of the flow equation in the porous matrix with the mfe method the velocity q inside each triangular element e is approximated using the linear raviart thomas basis functions see fig 1 7 q j 1 3 q j e w j e where q j e is the flux across the edge ej of e and w j e 1 2 e x x j e y y j e is the raviart thomas basis functions raviart and thomas 1977 with x j e y j e the coordinates of the node j faced to the edge ej of e and e the area of e using w i e as a test function the variational formulation of the darcy law eq 2 writes 8 e k r 1 k 1 q w i e e h w i e e h w i e j e j h w i e η j e where η j e is the outward unit normal vector to the edge ej defining b e the elemental matrix of terms b i j e e k r 1 e k 1 e w j e w i e we obtain see younes et al 2004 for details 9 b e 1 48 e 3 ℓ i j 3 ℓ i k ℓ j k 3 ℓ i j ℓ i k ℓ j k ℓ i j 3 ℓ i k ℓ j k 3 ℓ i j ℓ i k ℓ j k 3 ℓ i j ℓ i k 3 ℓ j k ℓ i j ℓ i k 3 ℓ j k ℓ i j 3 ℓ i k ℓ j k ℓ i j ℓ i k 3 ℓ j k ℓ i j 3 ℓ i k 3 ℓ j k with ℓ i j r i j t k r 1 e k 1 e 1 r ij and r ij is the edge vector from the node i to the node j using eq 7 and properties of w i e the darcy eq 8 becomes 10 j b i j e q j e 1 e e h 1 e i e i h h e t h i e where he is the mean head at the element e and t h i e is the mean head at the edge ei inverting eq 10 provides the water flux q i e across the edge ei as 11 q i e δ i e h e j b i j 1 e t h j e where δ i e j b i j 1 e the lumped formulation of mfe is then used in the following steps in a first step integration of the mass conservation eq 1 over the element e assuming a steady state flow θ t 0 and substituting eq 11 yields 12 h e i δ i e δ e t h i e where δ e i δ i e hence the steady state flux q i e across the edge ei writes 13 q i e j δ i e δ j e δ e b i j 1 e t h j e in a second step a lumped region ri is constructed around each edge ei by joining the two nodes of ei to the element centers x e and x e of the elements e and e sharing the edge i fig 2 the domain is now partitioned into lumping regions ri hatched area in fig 2 assigned to the edge i formed by the two simplex regions s i e and s i e for an inner edge i and by the sole simplex region s i e for a boundary edge the simplex region s i e is defined by joining the centre of e with the nodes j and k forming the edge i the area of s i e is e 3 in a third step the integration of the transient mass conservation eq 1 over the lumped region ri yields see fig 2 for notations 14 e 3 r e d t h i e d t e 3 r e d t h l e d t q i j e q i k e q l j e q l k e 0 where r e c h e s s θ h e θ s is the accumulation coefficient in richards equation and q i j e the interior flux evaluated using the rt0 approximation of the velocity inside the element e given by eq 7 which yields 15 q i j e 1 3 q j e q i e substituting eqs 13 and 15 into eq 14 allows to write the mass conservation eq 14 over the lumping regions ri assigned to the edge i as a continuity of fluxes between two adjacent elements e and e sharing the edge i as follows 16 q i e q i e 0 q i e j δ i e δ j e δ e b i j 1 e t h j e e 3 r e d t h i e d t the flow system is formed by eq 16 for all the mesh edges which do not coincide with a fracture and solved for the mean head at edges thi by imposing continuity of the head at the interface of the elements t h i t h i e t h i e the obtained system is highly nonlinear since the local matrix b and the accumulation term r depend on the pressure head in the case of a dirichlet condition with a prescribed head himp at the boundary edge i eq 16 is replaced by thi himp if the boundary edge i has a prescribed flux qimp neumann boundary condition eq 16 becomes q i e q i m p 0 note that contrarily to the standard mfe method the time derivative remains continuous in eq 16 which facilitates employment of high order methods for the time discretization 3 2 spatial discretization of the flow in the presence of a fracture let s consider a fracture k of length ℓ k and aperture ek the fracture k coincides with the edge i shared by the adjacent matrix elements e and e see fig 3 the flow through the fracture occurs between it s two nodes of pressures n h 1 k and n h 2 k the flux q i e respectively q i e represents the matrix fracture fluid exchange between e respectively e and the fracture k the one dimensional flow through the fracture k is discretized with the mfe method which assumes a linear variation of the velocity qk inside k 17 q k q 1 k w 1 k q 2 k w 2 k with q j 1 2 k the flux leaving the node j 1 2 of the fracture k w 1 k x ℓ k e k ℓ k and w 2 k x e k ℓ k are the one dimensional velocity interpolation functions using the local coordinate x 0 ℓ k the mass conservation eq 1 integrated over the fracture k of length ℓ k and aperture ek yields 18 e k ℓ k r k d t h k d t q 1 k q 2 k q i e q i e 0 with thk the mean head in the fracture k and r k c h k s s k θ k θ s the accumulation coefficient related to k q i e and q i e are the water fluxes from the element e and e representing matrix fracture exchange the variational formulation of the darcy law eq 2 on the fracture k writes 19 j q j k 0 ℓ k w i k w j k k r k k f k 0 ℓ k h w i k integration by part leads to 20 j q j k 0 ℓ k w i k w j k k r k k f k e k t h k n h i k where n h i k corresponds to the head at the node i located at the extremity of the fracture k using numerical integration based on the trapezoidal rule for the calculation of the left term see koohbor et al 2020 yields 21 q i k e k k r k 2 k f k ℓ k t h k n h i k the cross flow equilibrium assumption is then employed by prescribing equality of the matrix edge head and the fracture head t h i e t h i e t h k thus substituting eqs 21 and 16 into eq 18 yields 22 j δ i e δ j e δ e b i j 1 e t h j e j δ i e δ j e δ e b i j 1 e t h j e e k k r k 2 k f k ℓ k 2 t h i e n h 1 k n h 2 k e 3 r e e 3 r e e k ℓ k r k d t h i e d t 0 to close the system of eq 22 the mass conservation is written at each intersection of fracture branches at the node i shared by k fracture branches we impose 23 k q i k 0 using eq 21 we obtain 24 k e k k r k 2 k f k ℓ k t h k n h i k 0 finally the global flow system is formed by eq 16 for all the edges which do not coincide with a fracture and by eq 22 else this system is supplemented by eq 24 for all the nodes of the fracture branches and assuming the continuity of the head n h i n h i k at the node i intersection of k fracture branches therefore the final flow system has the heads at the edges of the mesh plus the heads at the nodes of the fracture branches as unknowns 3 3 discretization of the advection dispersion transport equation in the porous matrix the transport of contaminants in the unsaturated porous matrix described by eq 3 writes 25 c θ t q θ c t q c d c 0 using the fluid mass conservation eq 1 the transport equation can be written in the following form 26 θ c t q c q 0 q d c the mfe method is now used for the spatial discretization of the transport equation to this aim the dispersion vector q is approximated inside each triangular element e with the raviart thomas vectorial basis functions as 27 q j q j e w j e where q j e e j q d η j e is the dispersive flux across the edge ej of the element e the variational formulation of eq 26 is written as 28 e d e 1 q w i e e c w i e which can take the following form 29 j b i j e q j e c e t c i e where ce is the mean concentration at the element e and t c i e is the trace of concentration at the edge ei of the element e and b is the elemental matrix of terms b i j e e d e 1 w j e w i e inverting eq 29 yields the dispersive flux across ei as 30 q i e j b i j 1 e c e t c j e an upwind lumped mfe scheme is used to avoid unphysical oscillations caused by the hyperbolic advection part of the transport equation the main steps of this scheme are as follows in a first step both advective and transient terms are removed from the first equation in the system of eq 26 yielding a steady state dispersive flux q i e expressed by similarly to eq 12 31 q i e j δ i e δ j e δ e t c j e j b i j 1 e t c j e with δ i e j b i j 1 e and δ e i δ i e in a second step the integration of the advection dispersion eq 26 over the lumped region ri writes see fig 2 32 e 3 θ e t c i e t q i j e t c i j e q i k e t c i k e q i j e q i k e t c i e q i e 0 where q i j e 1 3 q j e q i e is the interior flux between edges i and j see eq 15 the interior concentration t c i j e is calculated using the upstream edge concentration as 33 t c i j e τ i j e t c i e 1 τ i j e t c j e with τ i j e 1 for an outward flux q i j e 0 else τ i j e 0 thus if we note q t i e the total advection dispersion flux leaving the element e from the edge i eq 32 can be rewritten as the continuity of the total flux between two adjacent elements e and e sharing the edge i as 34 q t i e q t i e 0 q t i e j δ i e δ j e δ e b i j 1 e t c j e q i j e 1 τ i j e t c i e t c j e q i k e 1 τ i k e t c i e t c k e θ e e 3 t c i e t 3 4 spatial discretization of the advection dispersion transport equation through a fracture let s consider a fracture k of length ℓ k and aperture ek and x the local coordinate along k with x 0 at the first node of k and x ℓ k at the second node of k the diffusion coefficient dk through the fracture k is approximated by 35 d k α l k q k d m k where α l k is the longitudinal dispersivity through the fracture k d m k is the molecular diffusion through k and q k q 2 k q 1 k 2 e k is the mean velocity in the fracture k the dispersive flux q d c through the fracture is approximated using the mfe method similarly to eq 21 the dispersive flux q i k at the extremity i 1 2 of the fracture k writes 36 q i k 2 e k d k ℓ k t c k n c i where n c i is the concentration at the node i imposing the continuity of the dispersive fluxes arriving from all fracture branches sharing the node i see fig 4 writes 37 l 2 e l d l ℓ l t c l n c j 0 which yields 38 n c i l e l ℓ l d l t c l l e l ℓ l d l substituting eq 38 into the flux eq 36 yields 39 q i k 2 e k d k ℓ k t c k l e l ℓ l d l t c l l e l ℓ l d l the integration of the mass conservation equation over the fracture k which coincides with the edge i shared by the two matrix elements e and e writes 40 θ k e k 0 ℓ k c t e k 0 ℓ k q c e k 0 ℓ k c q e k 0 ℓ k q q t i e q t i e 0 the calculation of the different integrals yields 41 θ k e k ℓ k t c k t q 1 k c 1 k q 2 k c 2 k q 1 k q 2 k t c k q 1 k q 2 k q t i e q t i e where c i k is the concentration at the node i of the fracture k given by 42 c i k λ i k n c i i n k 1 λ i k n c i o u t in which n c i i n k t c k is the interior concentration and the parameter λ i k is used to select the upstream concentration it depends on the sign of q i k as 43 λ i k 1 i f q i k 0 0 i f q i k 0 hence in the case of an outflow at the node i of k the nodal concentration is c i k t c k whereas in the case of an inflow at the node i of the fracture k the nodal concentration is n c i o u t to calculate n c i o u t we use the contaminant conservation at the node i shared by l fractures which writes 44 k 1 l q i k c i k 0 using eqs 42 and 43 we obtain 45 n c i o u t k 1 l q i k λ i k t c k k 1 l q i k λ i k 1 note that the number of unknowns for the transport system to be solved does not depend on the number of fractures in the domain indeed the final transport system has the concentration at edges as unknowns and is constructed as follows for all edges i sharing two matrix elements e and e such that i does not coincide with a fracture k eq 34 is solved for the unknown edge concentration tci assuming continuity of edge concentration t c i t c i e t c i e for all edges i sharing two matrix elements e and e such that i coincides with a fracture k eq 41 in which we substitute eqs 34 39 42 43 and 45 is solved for the unknown edge concentration tci assuming that the concentration at the edge matrix and at the fracture are equal t c i t c i e t c i e t c k 3 5 the temporal discretization of the nonlinear flow transport system the final nonlinear flow transport system formed by eqs 16 22 and 24 for the flow and by eqs 34 and 41 for the transport is written in a single implicit system of ordinary differential equations odes of the general form 46 f t y y 0 where y t h i i 1 n b e d g e s n h i i 1 n b n o d e f r a c t u r e s t c i i 1 n b e d g e s is the vector of unknowns formed by i the head traces at all the edges of the mesh except boundary edges with prescribed head ii the head at all the nodes corresponding to the extremity of fracture branches and iii the concentration traces at all edges of the mesh except boundary edges with prescribed concentration thus the number of unknowns for the flow transport system is approximately twice the number of edges plus the number of fractures for the time discretization we use high order methods which are known to be more efficient and require less effort in the nonlinear solver compared to the lowest order methods farthing et al 2002 an efficient automatic time stepping scheme is employed to improve the computational efficiency while maintaining accuracy tocci et al 1997 kavetski et al 2001 the time integration is performed with the daspk time solver which uses the preconditioned krylov iterative method to solve the linear systems arising at each time step daspk is based on the fixed leading coefficient backward difference formulas flcbdf which has good stability properties and is well adapted for time integration of stiff problems kees and miller 2002 the nonlinear problem is linearized using the newton method with a numerical approximation of the jacobian matrix to improve efficiency the jacobian is reused for several time steps and is calculated by the solver only when necessary furthermore the column grouping technique hindmarsh 1982 is employed to reduce the computational time for the evaluation of the jacobian matrix by perturbing variables by group knowing the structure and sparsity of the jacobian during calculation the order up to fifth order of the time discretization and the time step size are adapted to improve efficiency while the relative and absolute convergence criteria are maintained under a fixed tolerance 10 6 in this work 4 numerical experiments in this section three test problems dealing with flow and mass transport in saturated and unsaturated fractured porous media are simulated to investigate the robustness of the new mfe code the first test case deals with flow and transport in a saturated porous medium involving a single fracture this test case is used to validate the developed 1d 2d mfe code against the solution obtained with comsol multiphysics 1d 2d model comosl uses the standard finite element fe method and an adaptive time stepping scheme the test problem is also simulated with a 2d 2d model where 2d triangular elements are employed for the spatial discretization of both the matrix and the fractures continua using a very fine mesh in order to correctly discretize the fracture branches with a small aperture we use the advanced 2d 2d dg model developed by younes et al 2021 based on the discontinuous galerkin dg finite element and the multipoint flux approximation methods and high order time integration techniques via the method of lines mol the second test case deals with flow and transport in a fractured unsaturated saturated porous medium the porous medium has initially wet conditions and involves a single fracture this test case is used to validate the developed 1d 2d mfe model against the solution obtained with the 2d 2d dg model in the case of unsaturated flow the last test case is a challenging problem dealing with flow and transport into an initially dry soil containing a fracture network this last problem is simulated to highlight the efficiency and robustness of the developed 1d 2d mfe model compared to the 2d 2d dg model 4 1 fractured saturated quarter five spot problem we consider a quadratic 2d domain quarter five spot configuration of size 0 1m 0 1m with impermeable walls except at the lower left and the upper right corners the source at the lower left corner is represented by a boundary flux qinj 10 3 m s at 0 x 0 03m y 0 x 0 0 y 0 03m the sink at the right upper corner is represented by a dirichlet boundary condition with a zero head at 0 97m x 1m y 1 x 1 0 97m y 1m the porous medium is formed by a homogeneous material with a diagonal fracture of 1mm aperture located between 0 2m 0 2m and 0 8m 0 8m the hydraulic and transport properties of the porous matrix and the fracture continuum are depicted in table 1 the initial conditions correspond to a domain free from pollutants the simulation is performed for a time of 3456s the problem is simulated with the new 1d 2d mfe model as well as with the 1d 2d comsol fe model and the 2d 2d dg model of younes et al 2021 in the latter the hydraulic and transport parameters used for the fractures in the 1d 2d approach are attributed to the 2d triangular elements located inside the fractures the 2d 2d dg model is used with a fine mesh with local mesh refinement around fractures the three models were used with the mol and a variable high order up to 5 time integration bdf method fig 5 shows that the three models yield almost similar concentration distributions which demonstrates the validity of the developed 1d 2d mfe model for simulating flow and transport in fractured saturated porous media 4 2 infiltration of contaminated water in a fractured unsaturated saturated porous medium this test case inspired by the laboratory experiments of vauclin et al 1979 was proposed by koohbor et al 2020 to investigate unsaturated flow in fractured porous media the problem is extended hereafter to tackle both flow and transport in the case of a homogeneous porous medium including a single inclined fracture the domain has a rectangular shape of 300 cm 200 cm with a water table located at 65cm from the bottom initial conditions correspond to a hydrostatic pressure distribution and a zero concentration in the domain boundary conditions are as follows contaminated water is infiltrated under a constant flux of 335cm day over the first 50cm of the soil surface the lower 65cm of the right side of the domain has a dirichlet boundary condition with a fixed head of 65cm a no flow boundary is prescribed for the rest of the boundaries the homogeneous porous medium includes an inclined fracture of 1cm aperture and 2m length located near the infiltration zone the hydraulic and transport parameters are depicted in table 2 the simulation of this problem cannot be performed with the 1d 2d comsol fe model since comsol cannot treat unsaturated flow in the fractures the problem is simulated with the 1d 2d mfe model as well as with the 2d 2d dg model and the 2d 2d fe model of comsol fig 6 depicts the water content and the concentration distributions at t 1000s obtained with the three models a good agreement is observed between the results of the three models for the volumetric water content as well as for the concentration contours fig 6 a more in depth comparison is then performed between the new 1d 2d mfe model and the 2d 2d dg model to this aim the fluid and contaminant mass fluxes at the outlet are calculated with both models over the simulation time of 55 h the results of the fig 7 show that the outlet fluid flux is almost constant after around 15 h which indicates that an almost steady state water content distribution is reached at this time a first contaminant front caused by the fast mobility of the contaminated water through the fractures is observed in the fig 7 after around 10 h a second slower and more dispersed contaminant front was occurred which was caused by the transport of the contaminant through the rock matrix the results of fgure 7 show a very good agreement between the 1d 2d mfe and the 2d 2d dg models for both fluid and contaminant outlet mass fluxes these results demonstrate the validity of the new 1d 2d mfe model for the simulation of flow and transport in fractured unsaturated porous media 4 3 infiltration of contaminated water in a fractured dry soil simulation of the infiltration of contaminated water into initially dry soils is known to be challenging because of the presence of sharp wetting fronts zha et al 2017 sharp fronts are often the origin of unphysical oscillations which can cause several convergence issues to investigate the efficiency of the developed model for such situations we simulate an infiltration problem adapted from koohbor et al 2020 the fractured porous medium has a rectangular shape of 350 cm in length and 200 cm in height fig 8 a left and right vertical boundaries are impermeable a pressure head of 1000 cm is imposed at the bottom of the domain water is injected at the right part of the surface 300cm x 350cm with a constant flow rate of 4 10 4 cm s the simulation is performed for a period of 2 105s clean water is injected for the first half period c 0 if t 105 s and contaminated water is injected for the second half period c 1 if t 105 s initial conditions correspond to a highly dry soil with a head of 1000 cm in both matrix and fracture continua all fractures have an aperture of 1 cm the hydraulic parameters of the two continua are depicted in table 3 the simulation of this last test case with the 2d 2d fe comsol model encountered several convergence issues because of the initial high dry conditions indeed the initial dry conditions are responsible of the appearance of several unphysical oscillations leading to the non convergence of the nonlinear flow transport model these difficulties are avoided with the 2d 2d dg model thanks to the incorporated advanced numerical methods see younes et al 2021 for more details as a consequence the results of the new 1d 2d mfe model are only compared to those of the 2d 2d dg model the final water content distribution obtained with the two models is depicted in fig 8 similar distributions are obtained with the two models as expected the infiltrated water invades the fracture network and high water saturation is observed in almost all fracture branches fig 8 because of their high saturated hydraulic conductivity which is around 2200 times higher than that of the matrix continuum two configurations are investigated the first configuration corresponds to a highly advective transport problem in this case all dispersivities of the matrix and the fractures are zero α l m α t m α l f 0 and a small molecular diffusion occurs in both continua d m m d m f 10 6 c m 2 s in the second configuration a more significant dispersion is considered for both continua with longitudinal and transverse dispersivities in the matrix respectively α l m 5 m and α t m 2 m the longitudinal dispersivity in the fractures is α l f 5 m the molecular diffusion in both continua is 10 5 c m 2 s for the 1d 2d model the domain is discretized using 15 400 triangles for the matrix continuum and 853 lines for the fracture branches without any constraint on the size of mesh elements next to the fractures fig 9 a the 2d 2d model is used on a fine mesh of 76 000 elements with local mesh refinement in the fractures in order to correctly discretize the flow and transport through the fracture branches with a small aperture of 1cm fig 9b two versions of the 1d 2d mfe model are employed for the simulations i the upwind scheme described above and ii a centered scheme where no upwinding is used for the advection operator in the matrix nor in the fractures the results of fig 10 show that the centered scheme provides similar results to the upwind scheme in the case of high dispersion fig 10d and e however in the case of advection dominated transport the centered scheme fails to provide accurate results and generates strong unphysical concentrations both in the matrix and in the fracture continuum fig 10b the results of the upwind 1d 2d mfe model are exempted from unphysical oscillations negative concentration are completely avoided for both advection dominated and advection dispersion configurations which demonstrates the robustness of the developed upwind 1d 2d mfe scheme furthermore the solution of the upwind 1d 2d mfe model is in good agreement with the solution of the 2d 2d dg model both in the case of advection dominated transport fig 10a vs 10c and in the case of advection dispersion transport fig 10d vs 10f the advantage of using a high order time discretization scheme is investgated by comparison against the first order conventional scheme the simulation using the upwind 1d 2d mfe model with a first order time discretization scheme requires 20 902 time steps and needs 6566s whereas the high order scheme requires only 3401 time steps and needs 375s thus the high order method is around four times faster than the first order method concerning the efficiency of the 1d 2d approach in comparison to the 2d 2d approach the 2d 2d dg model required 5259s for the whole simulation whereas the new 1d 2d mfe model requires only 375s thus the new 1d 2d mfe model is around 15 times more efficient than the 2d 2d dg model which highlights the great benefit of robust and accurate 1d 2d models to simulate flow and transport processes in unsaturated and saturated fractured porous media 5 conclusion a new model has been developed for nonlinear flow and transport in unsaturated fractured porous media with implicit matrix fracture and fracture fracture fluid and contaminant exchanges the model is based on the dfm approach which describes fractures and matrix explicitly cross flow equilibrium is assumed only across the fractures thanks to the mfe method which has been employed for the full spatial discretization of the flow and transport in both the matrix and the fracture continua the mfe method avoids the constraints on the mesh size next to the fractures and allows to approximate the matrix fracture and fracture fracture exchange without any transfer functions an upwind scheme is employed to avoid unphysical oscillations in the case of advection dominant transport the time integration is performed with variable high order methods via the mol an efficient automatic time stepping scheme is used to improve the computational efficiency while maintaining accuracy of the nonlinear solver three test problems dealing with flow and mass transport in saturated and unsaturated fractured porous media have been simulated to investigate the validity and robustness of the new 1d 2d mfe model the first test case deals with the fractured quarter five spot problem and concerns flow and transport in a saturated porous medium involving a single fracture the results of this test case with the 1d 2d mfe model were similar to those of the 1d 2d fe comsol model and that of the 2d 2d dg model which demonstrates the validity of the new model to simulate flow and transport in fractured saturated porous media the second test case deals with flow and transport in an unsaturated saturated porous medium including a single inclined fracture this test case has been simulated with the 1d 2d mfe model as well as with the 2d 2d dg model and the 2d 2d fe model of comsol since the 1d 2d fe model of comsol cannot treat unsaturated flow in fractures a very good agreement is obtained between the three models for both the volumetric water content and the concentration contours which demonstrates the validity of the new model for unsaturated fractured porous media the last test case is a challenging problem dealing with flow and transport in an initially dry soil containing a fracture network for this problem the 2d 2d fe comsol model encountered several convergence issues because of the initial high dry soil conditions the problem has been simulated using the 1d 2d mfe model using upwind and centered schemes the results show that both schemes yield accurate results in the case of high dispersion however in the case of advection dominated transport only the upwind scheme provides stable results the solution of the upwind 1d 2d mfe model is in good agreement with the solution of the 2d 2d dg model both in the case of advection dominated transport and in the case of advection dispersion transport the new 1d 2d mfe model is much more efficient than the 2d 2d dg model the new model allows a speedup of around 15 which confirms the usefulness of efficient and accurate models based on the dfm approach for the simulation of flow and transport in fractured porous media credit authorship contribution statement anis younes conceptualization methodology writing original draft hussein hoteit methodology writing review editing rainer helmig writing review editing marwan fahs conceptualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
127,a fully mixed finite element mfe model is developed for nonlinear flow and transport in unsaturated fractured porous media with matrix fracture and fracture fracture fluid and mass exchanges the model is based on the discrete fracture matrix dfm approach and assumes cross flow equilibrium in the fractures the mfe method is employed for the spatial discretization of both flow and transport on the 2d matrix elements as well as on the 1d fracture elements an upwind scheme is employed to avoid unphysical oscillations in the case of advection dominant transport the temporal discretization is performed using high order time integration methods and efficient automatic time stepping schemes via the mol two test problems dealing with flow and mass transport in saturated and unsaturated fractured porous media are simulated to show the validity of the new model by comparison against i a 1d 2d comsol finite element model and ii a 2d 2d discontinuous galerkin dg model where both fractures and matrix continua are discretized with small 2d mesh elements the robustness and efficiency of the developed 1d 2d mfe model are then investigated for a challenging problem dealing with infiltration of contaminated water into an initially dry soil involving a fracture network the new model yields stable results for advection dominated and advection dispersion transport configurations further the results of the 1d 2d mfe model are in very good agreement with those of the 2d 2d dg model for both configurations the simulation of infiltration of contaminated water into a dry fractured soil shows that the 1d 2d mfe model is within 15 times more efficient than the 2d 2d dg model which confirms the high benefit of using robust and efficient dfm models for the simulation of flow and transport in fractured porous media keywords fractured porous media discrete fracture matrix approach unsaturated flow advection dispersion equation mixed finite element upwind scheme 1 introduction flow and transport in fractured porous media are important in many applications such as water resource management wireman 2003 kavouri et al 2017 contaminant transport berkowitz 2002 brutz and rajaram 2017 klammler et al 2016 nuclear waste management follin and stigsson 2014 mattila and tammisto 2012 and oil and gas production li et al 2015 shen et al 2016 the flow and transport processes in fractured porous media can be significantly affected by the characteristics of the fractures such as location size orientation and aperture the fractures can be empty or contain a filling material berre et al 2019 in this work the fractures are considered filled with a porous medium with different properties from the porous matrix as in khoobor et al 2020 two approaches are commonly used for modeling flow in fractured porous media berre et al 2019 the first approach is based on an implicit representation of the fractures and includes both single continuum and multi continuum models in single continuum models the fractures are taken into account by calculating an equivalent permeability of the porous medium which depends on the properties of the fractures and the fracture network durlofsky 1991 liu et al 2016 in multi continuum models the fractured porous medium is represented by two or more superimposed media with their own flow and or transport equations among these the well known dual porosity model which considers superposition of a low permeability continuum representing the matrix with a high permeability continuum representing the fractures jourde et al 2002 kordilla et al 2012 the two continua are then linked by a linear exchange term more sophisticated multi continuum models have been developed for aquifers with high heterogeneities such as karst aquifers to include different levels of porosities and cavities kuhlman et al 2015 wu et al 2004 the second approach uses on an explicit representation of the fractures among this approach the discrete fracture network dfn model with dfn the geometry and properties of discrete fractures are explicitly incorporated as a central component controlling flow and transport discrete fracture matrix dfm models consider that flow and transport processes occur through both the porous matrix and the explicitly represented fractures as a consequence the dfm model is more appropriate for handling fractures in a permeable porous medium berre et al 2019 considering that the aperture of the fractures is small as compared to the matrix scale the main idea of dfm is to use the cross flow equilibrium concept across the fractures noorishad and mehran 1982 baca et al 1984 granet et al 1998 hoteit et al 2008 as a consequence the fractures can be discretized with elements of co dimension one with respect to the dimension of the surrounding matrix flemish et al 2018 martin et al 2005 such as 1d fracture elements with 2d matrix elements this simplification makes dfm models much more efficient than the single porosity 2d 2d model where 2d elements are used for both matrix and fracture continua note that the applicability of the 2d 2d models is often hampered by their expansive computational cost since they require very fine mesh elements to correctly discretize the fractures with small apertures hoteit and firoozabadi 2005 2006 employed dfm models assuming cross flow equilibrium between the fractures and the adjacent matrix gridcells by imposing the pressure at a fracture and at the adjacent gridcells to be equal although efficient this assumption still requires small mesh elements next to the fractures hoteit and firoozabadi 2008 to avoid this constraint hoteit and firoozabadi 2008 proposed solving the flow equation with the hybrid formulation of the mixed finite element mfe method this formulation has the pressure at the gridcell interfaces as degrees of freedom dof and hence the cross flow equilibrium can be directly assumed across the fractures hoteit and firoozabadi 2008 in this way the matrix pressure at an element edge and the pressure at the fracture which coincides with that edge are assumed to be equal as a consequence no constraints are required for the mesh discretization near the fractures hoteit and firoozabadi 2008 this powerful feature is extended in this work by developing a fully mfe model for both unsaturated flow and transport in the porous matrix and in the fracture continuum the mfe raviart and thomas 1977 chavent and jaffré 1986 is a robust numerical method for solving diffusion problems which has recently received attention in geosciences indeed with mfes the flux and the pressure unknowns are approximated simultaneously the mfe method ensures local mass balance and can easily handle general unstructured meshes younes et al 2010 further it yields an accurate velocity field in highly heterogeneous and anisotropic media durlofsky 1994 the hybridization procedure of the mfe method allows improving its efficiency by reducing the total number of unknowns and producing a final system with a positive symmetric definite matrix chavent and jaffré 1986 the unknowns in this case are the traces of the variable at the edges a lumped formulation of the mfe method has been developed by younes et al 2006 to improve the monotonicity of the solution and reduce the unphysical oscillations observed with transient problems belfort et al 2009 showed that the lumped formulation is more efficient and more robust than the standard one for the simulation of water infiltration into initially dry soils further contrarily to the standard mfe method the lumped formulation maintains the time derivative continuous and thus allows employment of high order time integration methods via the method of lines mol which can be very efficient for solving nonlinear problems fahs et al 2009 and younes et al 2009 although the mfe method is well adapted for diffusion type equations when applied for the advection dispersion transport equation the solution can exhibit strong unphysical oscillations because of the hyperbolic nature of the advection operator therefore the main objective of this work is to develop a stable mfe model for unsaturated flow and mass transport through both the 2d matrix and the 1d fracture elements both fluid and contaminant matrix fracture and fracture fracture exchanges are implicitly taken into account without using any transfer functions even for the case of several intersecting fractures to avoid instabilities caused by the hyperbolic advection term we use a robust monotonic upwind mfe scheme where the traces of concentration at edges are upwinded depending on the direction of the local velocity an implicit scheme is used for the time discretization of the flow and transport equations this alleviates restriction on the size of the time step from the cfl condition of explicit schemes for the sake of brevity the lumped hybrid mfe method employed in this work will also be denoted mfe modeling flow and transport in unsaturated fractured porous media is likely to be highly cpu consuming due to i the strongly nonlinear richards flow equation re ii the high contrast of permeability between the conductive fractures and the low permeable matrix and iii the presence of sharp wetting and or contaminant fronts these difficulties make the commonly used first order backward euler scheme combined with the heuristic time step management inappropriate to obtain accurate solutions in a reasonable cpu time to overcome these difficulties time integration is performed using high order time integration methods via the method of lines mol the mol allows versatile time step length and order of the temporal discretization to reduce the computational time while maintaining accuracy the mol was shown to be effective for the solution of the re in the unsaturated zone fahs et al 2009 khoobor et al 2020 and is used hereafter for the first time for coupled flow and transport through unsaturated fractured porous media this article is structured as follows in section 2 we recall the nonlinear mathematical models governing flow and advection dispersion transport processes in unsaturated porous media in section 3 we develop a robust fully mfe formulation for the solution of flow and transport both in the porous matrix and in the fracture continuum in section 4 numerical experiments are performed for flow and transport in saturated and unsaturated fractured porous media to investigate the validity and robustness of the new 1d 2d mfe model some conclusions are given in the last section of the article 2 governing equations the porous matrix is assumed permeable and the fractures are infilled by a porous medium whose physical characteristics are different from those of the porous matrix flow in variably saturated porous media both in the matrix and through the fractures is assumed to be ruled by the mass conservation of the fluid 1 θ t c h s s θ θ s h t q 0 and the darcy buckingham law 2 q k r k h where c h θ h is the specific moisture capacity l 1 ss is the specific mass storativity related to head changes l 1 θ is the current water content l3l 3 θ s is the saturated water content l3l 3 h h y is the freshwater head l h is the pressure head l y is the upward vertical coordinate l t is the time t q is the darcy velocity lt 1 kr is the relative conductivity k ρ g μ k is the hydraulic conductivity tensor lt 1 ρ is the fluid density ml 3 g is the gravity acceleration lt 2 μ is the fluid dynamic viscosity ml 1t 1 and k is the permeability of the rock matrix as a tensor or that of the fracture as a scalar l2 the transport of contaminants in the unsaturated porous matrix and through the unsaturated fractures is ruled by the advection dispersion equation 3 θ c t q c d c 0 where c is the relative concentration and d is the dispersion tensor given by 4 d d m i α l α t q q q α t q i in which α l and α t are the longitudinal and transverse dispersivities l dm is the pore water diffusion coefficient l2t 1 and i is the unit tensor the standard van genuchten 1980 model is used for the relationship between water content and pressure head 5 s e θ h θ r θ s θ r 1 1 α h n m h 0 1 h 0 where α l 1 and n are the van genuchten parameters m 1 1 n se is the effective saturation and θ r is the residual water content l3l 3 the conductivity saturation relationship is analytically expressed from the mualem 1976 model 6 k r s e 1 2 1 1 s e 1 m m 2 the nonlinear system 1 6 is solved numerically on i unstructured triangular 2d elements for the porous matrix and ii linear 1d elements for fracture branches all hydraulic and transport parameters in the system 1 6 are defined elementwise and therefore they can be different for each matrix or fracture element 3 the fully mfe numerical model in this session we recall the main stages for developing a robust mfe formulation for the solution of the flow and transport equations both in the porous matrix and in the fractures 3 1 discretization of the flow equation in the porous matrix with the mfe method the velocity q inside each triangular element e is approximated using the linear raviart thomas basis functions see fig 1 7 q j 1 3 q j e w j e where q j e is the flux across the edge ej of e and w j e 1 2 e x x j e y y j e is the raviart thomas basis functions raviart and thomas 1977 with x j e y j e the coordinates of the node j faced to the edge ej of e and e the area of e using w i e as a test function the variational formulation of the darcy law eq 2 writes 8 e k r 1 k 1 q w i e e h w i e e h w i e j e j h w i e η j e where η j e is the outward unit normal vector to the edge ej defining b e the elemental matrix of terms b i j e e k r 1 e k 1 e w j e w i e we obtain see younes et al 2004 for details 9 b e 1 48 e 3 ℓ i j 3 ℓ i k ℓ j k 3 ℓ i j ℓ i k ℓ j k ℓ i j 3 ℓ i k ℓ j k 3 ℓ i j ℓ i k ℓ j k 3 ℓ i j ℓ i k 3 ℓ j k ℓ i j ℓ i k 3 ℓ j k ℓ i j 3 ℓ i k ℓ j k ℓ i j ℓ i k 3 ℓ j k ℓ i j 3 ℓ i k 3 ℓ j k with ℓ i j r i j t k r 1 e k 1 e 1 r ij and r ij is the edge vector from the node i to the node j using eq 7 and properties of w i e the darcy eq 8 becomes 10 j b i j e q j e 1 e e h 1 e i e i h h e t h i e where he is the mean head at the element e and t h i e is the mean head at the edge ei inverting eq 10 provides the water flux q i e across the edge ei as 11 q i e δ i e h e j b i j 1 e t h j e where δ i e j b i j 1 e the lumped formulation of mfe is then used in the following steps in a first step integration of the mass conservation eq 1 over the element e assuming a steady state flow θ t 0 and substituting eq 11 yields 12 h e i δ i e δ e t h i e where δ e i δ i e hence the steady state flux q i e across the edge ei writes 13 q i e j δ i e δ j e δ e b i j 1 e t h j e in a second step a lumped region ri is constructed around each edge ei by joining the two nodes of ei to the element centers x e and x e of the elements e and e sharing the edge i fig 2 the domain is now partitioned into lumping regions ri hatched area in fig 2 assigned to the edge i formed by the two simplex regions s i e and s i e for an inner edge i and by the sole simplex region s i e for a boundary edge the simplex region s i e is defined by joining the centre of e with the nodes j and k forming the edge i the area of s i e is e 3 in a third step the integration of the transient mass conservation eq 1 over the lumped region ri yields see fig 2 for notations 14 e 3 r e d t h i e d t e 3 r e d t h l e d t q i j e q i k e q l j e q l k e 0 where r e c h e s s θ h e θ s is the accumulation coefficient in richards equation and q i j e the interior flux evaluated using the rt0 approximation of the velocity inside the element e given by eq 7 which yields 15 q i j e 1 3 q j e q i e substituting eqs 13 and 15 into eq 14 allows to write the mass conservation eq 14 over the lumping regions ri assigned to the edge i as a continuity of fluxes between two adjacent elements e and e sharing the edge i as follows 16 q i e q i e 0 q i e j δ i e δ j e δ e b i j 1 e t h j e e 3 r e d t h i e d t the flow system is formed by eq 16 for all the mesh edges which do not coincide with a fracture and solved for the mean head at edges thi by imposing continuity of the head at the interface of the elements t h i t h i e t h i e the obtained system is highly nonlinear since the local matrix b and the accumulation term r depend on the pressure head in the case of a dirichlet condition with a prescribed head himp at the boundary edge i eq 16 is replaced by thi himp if the boundary edge i has a prescribed flux qimp neumann boundary condition eq 16 becomes q i e q i m p 0 note that contrarily to the standard mfe method the time derivative remains continuous in eq 16 which facilitates employment of high order methods for the time discretization 3 2 spatial discretization of the flow in the presence of a fracture let s consider a fracture k of length ℓ k and aperture ek the fracture k coincides with the edge i shared by the adjacent matrix elements e and e see fig 3 the flow through the fracture occurs between it s two nodes of pressures n h 1 k and n h 2 k the flux q i e respectively q i e represents the matrix fracture fluid exchange between e respectively e and the fracture k the one dimensional flow through the fracture k is discretized with the mfe method which assumes a linear variation of the velocity qk inside k 17 q k q 1 k w 1 k q 2 k w 2 k with q j 1 2 k the flux leaving the node j 1 2 of the fracture k w 1 k x ℓ k e k ℓ k and w 2 k x e k ℓ k are the one dimensional velocity interpolation functions using the local coordinate x 0 ℓ k the mass conservation eq 1 integrated over the fracture k of length ℓ k and aperture ek yields 18 e k ℓ k r k d t h k d t q 1 k q 2 k q i e q i e 0 with thk the mean head in the fracture k and r k c h k s s k θ k θ s the accumulation coefficient related to k q i e and q i e are the water fluxes from the element e and e representing matrix fracture exchange the variational formulation of the darcy law eq 2 on the fracture k writes 19 j q j k 0 ℓ k w i k w j k k r k k f k 0 ℓ k h w i k integration by part leads to 20 j q j k 0 ℓ k w i k w j k k r k k f k e k t h k n h i k where n h i k corresponds to the head at the node i located at the extremity of the fracture k using numerical integration based on the trapezoidal rule for the calculation of the left term see koohbor et al 2020 yields 21 q i k e k k r k 2 k f k ℓ k t h k n h i k the cross flow equilibrium assumption is then employed by prescribing equality of the matrix edge head and the fracture head t h i e t h i e t h k thus substituting eqs 21 and 16 into eq 18 yields 22 j δ i e δ j e δ e b i j 1 e t h j e j δ i e δ j e δ e b i j 1 e t h j e e k k r k 2 k f k ℓ k 2 t h i e n h 1 k n h 2 k e 3 r e e 3 r e e k ℓ k r k d t h i e d t 0 to close the system of eq 22 the mass conservation is written at each intersection of fracture branches at the node i shared by k fracture branches we impose 23 k q i k 0 using eq 21 we obtain 24 k e k k r k 2 k f k ℓ k t h k n h i k 0 finally the global flow system is formed by eq 16 for all the edges which do not coincide with a fracture and by eq 22 else this system is supplemented by eq 24 for all the nodes of the fracture branches and assuming the continuity of the head n h i n h i k at the node i intersection of k fracture branches therefore the final flow system has the heads at the edges of the mesh plus the heads at the nodes of the fracture branches as unknowns 3 3 discretization of the advection dispersion transport equation in the porous matrix the transport of contaminants in the unsaturated porous matrix described by eq 3 writes 25 c θ t q θ c t q c d c 0 using the fluid mass conservation eq 1 the transport equation can be written in the following form 26 θ c t q c q 0 q d c the mfe method is now used for the spatial discretization of the transport equation to this aim the dispersion vector q is approximated inside each triangular element e with the raviart thomas vectorial basis functions as 27 q j q j e w j e where q j e e j q d η j e is the dispersive flux across the edge ej of the element e the variational formulation of eq 26 is written as 28 e d e 1 q w i e e c w i e which can take the following form 29 j b i j e q j e c e t c i e where ce is the mean concentration at the element e and t c i e is the trace of concentration at the edge ei of the element e and b is the elemental matrix of terms b i j e e d e 1 w j e w i e inverting eq 29 yields the dispersive flux across ei as 30 q i e j b i j 1 e c e t c j e an upwind lumped mfe scheme is used to avoid unphysical oscillations caused by the hyperbolic advection part of the transport equation the main steps of this scheme are as follows in a first step both advective and transient terms are removed from the first equation in the system of eq 26 yielding a steady state dispersive flux q i e expressed by similarly to eq 12 31 q i e j δ i e δ j e δ e t c j e j b i j 1 e t c j e with δ i e j b i j 1 e and δ e i δ i e in a second step the integration of the advection dispersion eq 26 over the lumped region ri writes see fig 2 32 e 3 θ e t c i e t q i j e t c i j e q i k e t c i k e q i j e q i k e t c i e q i e 0 where q i j e 1 3 q j e q i e is the interior flux between edges i and j see eq 15 the interior concentration t c i j e is calculated using the upstream edge concentration as 33 t c i j e τ i j e t c i e 1 τ i j e t c j e with τ i j e 1 for an outward flux q i j e 0 else τ i j e 0 thus if we note q t i e the total advection dispersion flux leaving the element e from the edge i eq 32 can be rewritten as the continuity of the total flux between two adjacent elements e and e sharing the edge i as 34 q t i e q t i e 0 q t i e j δ i e δ j e δ e b i j 1 e t c j e q i j e 1 τ i j e t c i e t c j e q i k e 1 τ i k e t c i e t c k e θ e e 3 t c i e t 3 4 spatial discretization of the advection dispersion transport equation through a fracture let s consider a fracture k of length ℓ k and aperture ek and x the local coordinate along k with x 0 at the first node of k and x ℓ k at the second node of k the diffusion coefficient dk through the fracture k is approximated by 35 d k α l k q k d m k where α l k is the longitudinal dispersivity through the fracture k d m k is the molecular diffusion through k and q k q 2 k q 1 k 2 e k is the mean velocity in the fracture k the dispersive flux q d c through the fracture is approximated using the mfe method similarly to eq 21 the dispersive flux q i k at the extremity i 1 2 of the fracture k writes 36 q i k 2 e k d k ℓ k t c k n c i where n c i is the concentration at the node i imposing the continuity of the dispersive fluxes arriving from all fracture branches sharing the node i see fig 4 writes 37 l 2 e l d l ℓ l t c l n c j 0 which yields 38 n c i l e l ℓ l d l t c l l e l ℓ l d l substituting eq 38 into the flux eq 36 yields 39 q i k 2 e k d k ℓ k t c k l e l ℓ l d l t c l l e l ℓ l d l the integration of the mass conservation equation over the fracture k which coincides with the edge i shared by the two matrix elements e and e writes 40 θ k e k 0 ℓ k c t e k 0 ℓ k q c e k 0 ℓ k c q e k 0 ℓ k q q t i e q t i e 0 the calculation of the different integrals yields 41 θ k e k ℓ k t c k t q 1 k c 1 k q 2 k c 2 k q 1 k q 2 k t c k q 1 k q 2 k q t i e q t i e where c i k is the concentration at the node i of the fracture k given by 42 c i k λ i k n c i i n k 1 λ i k n c i o u t in which n c i i n k t c k is the interior concentration and the parameter λ i k is used to select the upstream concentration it depends on the sign of q i k as 43 λ i k 1 i f q i k 0 0 i f q i k 0 hence in the case of an outflow at the node i of k the nodal concentration is c i k t c k whereas in the case of an inflow at the node i of the fracture k the nodal concentration is n c i o u t to calculate n c i o u t we use the contaminant conservation at the node i shared by l fractures which writes 44 k 1 l q i k c i k 0 using eqs 42 and 43 we obtain 45 n c i o u t k 1 l q i k λ i k t c k k 1 l q i k λ i k 1 note that the number of unknowns for the transport system to be solved does not depend on the number of fractures in the domain indeed the final transport system has the concentration at edges as unknowns and is constructed as follows for all edges i sharing two matrix elements e and e such that i does not coincide with a fracture k eq 34 is solved for the unknown edge concentration tci assuming continuity of edge concentration t c i t c i e t c i e for all edges i sharing two matrix elements e and e such that i coincides with a fracture k eq 41 in which we substitute eqs 34 39 42 43 and 45 is solved for the unknown edge concentration tci assuming that the concentration at the edge matrix and at the fracture are equal t c i t c i e t c i e t c k 3 5 the temporal discretization of the nonlinear flow transport system the final nonlinear flow transport system formed by eqs 16 22 and 24 for the flow and by eqs 34 and 41 for the transport is written in a single implicit system of ordinary differential equations odes of the general form 46 f t y y 0 where y t h i i 1 n b e d g e s n h i i 1 n b n o d e f r a c t u r e s t c i i 1 n b e d g e s is the vector of unknowns formed by i the head traces at all the edges of the mesh except boundary edges with prescribed head ii the head at all the nodes corresponding to the extremity of fracture branches and iii the concentration traces at all edges of the mesh except boundary edges with prescribed concentration thus the number of unknowns for the flow transport system is approximately twice the number of edges plus the number of fractures for the time discretization we use high order methods which are known to be more efficient and require less effort in the nonlinear solver compared to the lowest order methods farthing et al 2002 an efficient automatic time stepping scheme is employed to improve the computational efficiency while maintaining accuracy tocci et al 1997 kavetski et al 2001 the time integration is performed with the daspk time solver which uses the preconditioned krylov iterative method to solve the linear systems arising at each time step daspk is based on the fixed leading coefficient backward difference formulas flcbdf which has good stability properties and is well adapted for time integration of stiff problems kees and miller 2002 the nonlinear problem is linearized using the newton method with a numerical approximation of the jacobian matrix to improve efficiency the jacobian is reused for several time steps and is calculated by the solver only when necessary furthermore the column grouping technique hindmarsh 1982 is employed to reduce the computational time for the evaluation of the jacobian matrix by perturbing variables by group knowing the structure and sparsity of the jacobian during calculation the order up to fifth order of the time discretization and the time step size are adapted to improve efficiency while the relative and absolute convergence criteria are maintained under a fixed tolerance 10 6 in this work 4 numerical experiments in this section three test problems dealing with flow and mass transport in saturated and unsaturated fractured porous media are simulated to investigate the robustness of the new mfe code the first test case deals with flow and transport in a saturated porous medium involving a single fracture this test case is used to validate the developed 1d 2d mfe code against the solution obtained with comsol multiphysics 1d 2d model comosl uses the standard finite element fe method and an adaptive time stepping scheme the test problem is also simulated with a 2d 2d model where 2d triangular elements are employed for the spatial discretization of both the matrix and the fractures continua using a very fine mesh in order to correctly discretize the fracture branches with a small aperture we use the advanced 2d 2d dg model developed by younes et al 2021 based on the discontinuous galerkin dg finite element and the multipoint flux approximation methods and high order time integration techniques via the method of lines mol the second test case deals with flow and transport in a fractured unsaturated saturated porous medium the porous medium has initially wet conditions and involves a single fracture this test case is used to validate the developed 1d 2d mfe model against the solution obtained with the 2d 2d dg model in the case of unsaturated flow the last test case is a challenging problem dealing with flow and transport into an initially dry soil containing a fracture network this last problem is simulated to highlight the efficiency and robustness of the developed 1d 2d mfe model compared to the 2d 2d dg model 4 1 fractured saturated quarter five spot problem we consider a quadratic 2d domain quarter five spot configuration of size 0 1m 0 1m with impermeable walls except at the lower left and the upper right corners the source at the lower left corner is represented by a boundary flux qinj 10 3 m s at 0 x 0 03m y 0 x 0 0 y 0 03m the sink at the right upper corner is represented by a dirichlet boundary condition with a zero head at 0 97m x 1m y 1 x 1 0 97m y 1m the porous medium is formed by a homogeneous material with a diagonal fracture of 1mm aperture located between 0 2m 0 2m and 0 8m 0 8m the hydraulic and transport properties of the porous matrix and the fracture continuum are depicted in table 1 the initial conditions correspond to a domain free from pollutants the simulation is performed for a time of 3456s the problem is simulated with the new 1d 2d mfe model as well as with the 1d 2d comsol fe model and the 2d 2d dg model of younes et al 2021 in the latter the hydraulic and transport parameters used for the fractures in the 1d 2d approach are attributed to the 2d triangular elements located inside the fractures the 2d 2d dg model is used with a fine mesh with local mesh refinement around fractures the three models were used with the mol and a variable high order up to 5 time integration bdf method fig 5 shows that the three models yield almost similar concentration distributions which demonstrates the validity of the developed 1d 2d mfe model for simulating flow and transport in fractured saturated porous media 4 2 infiltration of contaminated water in a fractured unsaturated saturated porous medium this test case inspired by the laboratory experiments of vauclin et al 1979 was proposed by koohbor et al 2020 to investigate unsaturated flow in fractured porous media the problem is extended hereafter to tackle both flow and transport in the case of a homogeneous porous medium including a single inclined fracture the domain has a rectangular shape of 300 cm 200 cm with a water table located at 65cm from the bottom initial conditions correspond to a hydrostatic pressure distribution and a zero concentration in the domain boundary conditions are as follows contaminated water is infiltrated under a constant flux of 335cm day over the first 50cm of the soil surface the lower 65cm of the right side of the domain has a dirichlet boundary condition with a fixed head of 65cm a no flow boundary is prescribed for the rest of the boundaries the homogeneous porous medium includes an inclined fracture of 1cm aperture and 2m length located near the infiltration zone the hydraulic and transport parameters are depicted in table 2 the simulation of this problem cannot be performed with the 1d 2d comsol fe model since comsol cannot treat unsaturated flow in the fractures the problem is simulated with the 1d 2d mfe model as well as with the 2d 2d dg model and the 2d 2d fe model of comsol fig 6 depicts the water content and the concentration distributions at t 1000s obtained with the three models a good agreement is observed between the results of the three models for the volumetric water content as well as for the concentration contours fig 6 a more in depth comparison is then performed between the new 1d 2d mfe model and the 2d 2d dg model to this aim the fluid and contaminant mass fluxes at the outlet are calculated with both models over the simulation time of 55 h the results of the fig 7 show that the outlet fluid flux is almost constant after around 15 h which indicates that an almost steady state water content distribution is reached at this time a first contaminant front caused by the fast mobility of the contaminated water through the fractures is observed in the fig 7 after around 10 h a second slower and more dispersed contaminant front was occurred which was caused by the transport of the contaminant through the rock matrix the results of fgure 7 show a very good agreement between the 1d 2d mfe and the 2d 2d dg models for both fluid and contaminant outlet mass fluxes these results demonstrate the validity of the new 1d 2d mfe model for the simulation of flow and transport in fractured unsaturated porous media 4 3 infiltration of contaminated water in a fractured dry soil simulation of the infiltration of contaminated water into initially dry soils is known to be challenging because of the presence of sharp wetting fronts zha et al 2017 sharp fronts are often the origin of unphysical oscillations which can cause several convergence issues to investigate the efficiency of the developed model for such situations we simulate an infiltration problem adapted from koohbor et al 2020 the fractured porous medium has a rectangular shape of 350 cm in length and 200 cm in height fig 8 a left and right vertical boundaries are impermeable a pressure head of 1000 cm is imposed at the bottom of the domain water is injected at the right part of the surface 300cm x 350cm with a constant flow rate of 4 10 4 cm s the simulation is performed for a period of 2 105s clean water is injected for the first half period c 0 if t 105 s and contaminated water is injected for the second half period c 1 if t 105 s initial conditions correspond to a highly dry soil with a head of 1000 cm in both matrix and fracture continua all fractures have an aperture of 1 cm the hydraulic parameters of the two continua are depicted in table 3 the simulation of this last test case with the 2d 2d fe comsol model encountered several convergence issues because of the initial high dry conditions indeed the initial dry conditions are responsible of the appearance of several unphysical oscillations leading to the non convergence of the nonlinear flow transport model these difficulties are avoided with the 2d 2d dg model thanks to the incorporated advanced numerical methods see younes et al 2021 for more details as a consequence the results of the new 1d 2d mfe model are only compared to those of the 2d 2d dg model the final water content distribution obtained with the two models is depicted in fig 8 similar distributions are obtained with the two models as expected the infiltrated water invades the fracture network and high water saturation is observed in almost all fracture branches fig 8 because of their high saturated hydraulic conductivity which is around 2200 times higher than that of the matrix continuum two configurations are investigated the first configuration corresponds to a highly advective transport problem in this case all dispersivities of the matrix and the fractures are zero α l m α t m α l f 0 and a small molecular diffusion occurs in both continua d m m d m f 10 6 c m 2 s in the second configuration a more significant dispersion is considered for both continua with longitudinal and transverse dispersivities in the matrix respectively α l m 5 m and α t m 2 m the longitudinal dispersivity in the fractures is α l f 5 m the molecular diffusion in both continua is 10 5 c m 2 s for the 1d 2d model the domain is discretized using 15 400 triangles for the matrix continuum and 853 lines for the fracture branches without any constraint on the size of mesh elements next to the fractures fig 9 a the 2d 2d model is used on a fine mesh of 76 000 elements with local mesh refinement in the fractures in order to correctly discretize the flow and transport through the fracture branches with a small aperture of 1cm fig 9b two versions of the 1d 2d mfe model are employed for the simulations i the upwind scheme described above and ii a centered scheme where no upwinding is used for the advection operator in the matrix nor in the fractures the results of fig 10 show that the centered scheme provides similar results to the upwind scheme in the case of high dispersion fig 10d and e however in the case of advection dominated transport the centered scheme fails to provide accurate results and generates strong unphysical concentrations both in the matrix and in the fracture continuum fig 10b the results of the upwind 1d 2d mfe model are exempted from unphysical oscillations negative concentration are completely avoided for both advection dominated and advection dispersion configurations which demonstrates the robustness of the developed upwind 1d 2d mfe scheme furthermore the solution of the upwind 1d 2d mfe model is in good agreement with the solution of the 2d 2d dg model both in the case of advection dominated transport fig 10a vs 10c and in the case of advection dispersion transport fig 10d vs 10f the advantage of using a high order time discretization scheme is investgated by comparison against the first order conventional scheme the simulation using the upwind 1d 2d mfe model with a first order time discretization scheme requires 20 902 time steps and needs 6566s whereas the high order scheme requires only 3401 time steps and needs 375s thus the high order method is around four times faster than the first order method concerning the efficiency of the 1d 2d approach in comparison to the 2d 2d approach the 2d 2d dg model required 5259s for the whole simulation whereas the new 1d 2d mfe model requires only 375s thus the new 1d 2d mfe model is around 15 times more efficient than the 2d 2d dg model which highlights the great benefit of robust and accurate 1d 2d models to simulate flow and transport processes in unsaturated and saturated fractured porous media 5 conclusion a new model has been developed for nonlinear flow and transport in unsaturated fractured porous media with implicit matrix fracture and fracture fracture fluid and contaminant exchanges the model is based on the dfm approach which describes fractures and matrix explicitly cross flow equilibrium is assumed only across the fractures thanks to the mfe method which has been employed for the full spatial discretization of the flow and transport in both the matrix and the fracture continua the mfe method avoids the constraints on the mesh size next to the fractures and allows to approximate the matrix fracture and fracture fracture exchange without any transfer functions an upwind scheme is employed to avoid unphysical oscillations in the case of advection dominant transport the time integration is performed with variable high order methods via the mol an efficient automatic time stepping scheme is used to improve the computational efficiency while maintaining accuracy of the nonlinear solver three test problems dealing with flow and mass transport in saturated and unsaturated fractured porous media have been simulated to investigate the validity and robustness of the new 1d 2d mfe model the first test case deals with the fractured quarter five spot problem and concerns flow and transport in a saturated porous medium involving a single fracture the results of this test case with the 1d 2d mfe model were similar to those of the 1d 2d fe comsol model and that of the 2d 2d dg model which demonstrates the validity of the new model to simulate flow and transport in fractured saturated porous media the second test case deals with flow and transport in an unsaturated saturated porous medium including a single inclined fracture this test case has been simulated with the 1d 2d mfe model as well as with the 2d 2d dg model and the 2d 2d fe model of comsol since the 1d 2d fe model of comsol cannot treat unsaturated flow in fractures a very good agreement is obtained between the three models for both the volumetric water content and the concentration contours which demonstrates the validity of the new model for unsaturated fractured porous media the last test case is a challenging problem dealing with flow and transport in an initially dry soil containing a fracture network for this problem the 2d 2d fe comsol model encountered several convergence issues because of the initial high dry soil conditions the problem has been simulated using the 1d 2d mfe model using upwind and centered schemes the results show that both schemes yield accurate results in the case of high dispersion however in the case of advection dominated transport only the upwind scheme provides stable results the solution of the upwind 1d 2d mfe model is in good agreement with the solution of the 2d 2d dg model both in the case of advection dominated transport and in the case of advection dispersion transport the new 1d 2d mfe model is much more efficient than the 2d 2d dg model the new model allows a speedup of around 15 which confirms the usefulness of efficient and accurate models based on the dfm approach for the simulation of flow and transport in fractured porous media credit authorship contribution statement anis younes conceptualization methodology writing original draft hussein hoteit methodology writing review editing rainer helmig writing review editing marwan fahs conceptualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
128,scaling up highly heterogeneous aperture distributions of fractures into equivalent permeability tensors enables a substantial reduction in the computational cost of simulating fluid flow in fractured porous media by allowing the employment of coarser grids while keeping the accuracy of an explicit model this work proposes the adaptation and application of conditional generative adversarial networks cgan for upscaling the permeability of single fractures three different types of aperture distributions are used as input in this work layered media zinn harvey transformations and self affine fractals as output the model predicts the pressure inside the fracture which is used for calculation of the equivalent permeability tensor our results show that the framework employing cgan provides equivalent tensors that can capture accurately both the permeability angle and anisotropy of discrete fractures with a substantial reduction of the computational time when compared to traditional frameworks that rely on the numerical simulations keywords fractured porous media permeability tensor permeability anisotropy reduced order modelling 1 introduction on the modelling of fractures in porous media berkowitz 2002 berre et al 2019 there are two classes of methods a implicit methods borja and koliji 2009 choo and borja 2015 ashworth and doster 2019 in which both the fractures and the porous matrix are represented by two overlapping continua and a transfer function is used to model the interaction between them and b explicit methods martin et al 2005 nick and matthäi 2011 gläser et al 2017 in which two distinct grids are used for the fractures and the porous matrix and their interplay is represented explicitly an explicit method allows a more accurate representation of the fractures and subsequently its interplay with the porous matrix but at the expense of a higher computational cost implicit approaches ensure cheaper models and techniques were developed to increase the accuracy of the model ranjbar and hassanzadeh 2011 fahs et al 2014 wu et al 2020 however the existence of a representative elementary volume rev for fractured porous media and accurate homogeneous parameters for an implicit approach cannot be guaranteed since there may be no clear scale separation between pore scale fracture dimensions and macro scale berkowitz 2002 berre et al 2019 furthermore previous works have shown that averaging the heterogeneous aperture to scale up permeability results in an inaccurate representation of the fluid flow pattern nick et al 2011 this indicates the necessity of incorporating full aperture distributions rather than simplified aperture representations in reservoir scale flow models latham et al 2013 bisdom et al 2016 2017 nick and bisdom 2018 a strategy for reducing the computational cost involved in an exemplary representation of the aperture distribution is along with a lower dimensional representation of the fracture martin et al 2005 berre et al 2019 to upscale the heterogeneous aperture into a single permeability tensor durlofsky 1991 matthäii and nick 2009 lasseux et al 2021 thus permitting the employment of a coarser grid this methodology is mainly used if the matrix permeability is much lower than the equivalent permeability of the fracture matthäii and nick 2009 i e if the fracture does not act as barrier for the fluid flow to scale up the heterogeneous aperture into an equivalent permeability tensor we need to solve the fluid flow problem within the fracture this procedure is computationally expensive when dealing with multiple fractures in a porous medium which is the case of most naturally fractured rocks for accelerating the scaling up reduced order models are an alternative for approximating the solutions in a computationally cheaper representation leaning for example on approaches based on proper orthogonal decomposition pod winton et al 2011 pasetto et al 2011 ushijima and yeh 2017 xiao et al 2017 dey and dhar 2020 or non linear manifolds takbiri borujeni et al 2020 kadeethum et al 2022 zhong et al 2019 kadeethum et al 2021b reduced order models rely on the parametrization of the problem schilders et al 2008 hesthaven et al 2016 ballarin et al 2019 in which the parameters could correspond to material properties geometry and or boundary conditions following this paradigm allows to solve the parameterized problem according to the input aperture distribution with significantly smaller simulation time however the reduction of heterogeneous aperture distributions to a small number of parameters is challenging and sometimes almost impossible therefore discouraging the application of traditional pod based models winton et al 2011 pasetto et al 2011 ushijima and yeh 2017 xiao et al 2017 dey and dhar 2020 machine learning methods have recently been used successfully in the context of porous media applications chan and elsheikh 2018 rabbani and babaei 2019 mo et al 2019 chan and elsheikh 2020 tahmasebi et al 2020 singh et al 2021 gharib and davies 2021 and in particular for upscaling heterogeneity of the porous medium vesselinov et al 2017 santos et al 2020 andrianov and nick 2021 menke et al 2021 jouini et al 2021 among these methods conditional generative adversarial networks mirza and osindero 2014 are an alternative for the parametrization of heterogeneous material properties and reduced order modelling zhong et al 2019 kadeethum et al 2021b the main strength of such image to image translation framework isola et al 2017 is that it runs on a self training scheme without the need of any assumption on the input data distribution the application of cgans for reduced order modelling even with highly heterogeneous material properties was shown to have acceptable accuracy with respect to the full order model kadeethum et al 2021b the latter showcased the effectiveness of the cgan architecture in the context of data driven solutions of partial differential equations for both forward and inverse problems this paper proposes for the first time the application of cgan towards solving the fluid flow in fractured porous media aiming to accelerate the scaling up to equivalent permeability tensors for discrete modelling fracture networks the neural network used in this work is similar to the one employed by kadeethum et al 2021b for the prediction of pore pressure in deformable porous media however we advance the model to obtain the equivalent permeability tensor instead of only pressure distributions to this end to minimize the error in the equivalent permeability tensor obtained via cgan we employ a sobolev training approach czarnecki et al 2017 by modifying the loss function to also account for the loss in the distributions of gradient of pressure and their mean first the fluid flow problem is solved for a benchmark problem bear 1972 durlofsky 1991 with the finite element method kirby 2004 kirby and logg 2006 alnaes et al 2009 ølgaard and wells 2010 logg and wells 2010 logg et al 2012 alnæs et al 2014 alnaes et al 2015 and the numerical solutions are used for training the cgan model with modified wasserstein loss arjovsky et al 2017 gulrajani et al 2017 the accuracy of the cgan is tested and the obtained equivalent permeability tensors are verified against the analytical solution next the fluid flow problem is solved considering two types of aperture distributions zinn harvey transformation zinn and harvey 2003 müller and schüler 2021 and self affine schmittbuhl et al 1993 bouchaud 1997 méheust and schmittbuhl 2001 the accuracy of the cgan is tested under such conditions and an error analysis is performed the work presented here is novel in the application of the image to image translation concept for scaling up highly heterogeneous material properties more specifically aperture distributions of fractures in a porous medium we show that this framework can not only parameterize complex input fields but more importantly realistic inputs based in fractal distributions in addition the upscaled tensors obtained via this framework are able to capture accurately the anisotropic behaviour that such heterogeneous material properties impose on the fluid flow in porous media while speeding up the calculations this paper is organized as follows section 2 describes the problem we are interested in solving which involves the upscaling of the heterogeneous aperture distribution and outlines the proposed framework that relies on the cgan following section 3 introduces the cgan model used in this work and describes the architecture of the networks along with the new loss functions for their training with improved accuracy section 4 presents the results of the verification and accuracy tests with the cgan model in addition an error analysis is presented to discuss the applications of the proposed framework further 2 methodology this section describes the fluid flow in fractured porous media and presents the governing equations used in the present work we briefly discuss the numerical method used for generating the data set i e the full order model which employs a mixed finite element method referred to in this work as fem fom following we present the procedure for obtaining an equivalent permeability tensor for the fracture given two independent pressure distributions in the fracture we are interested in fractured porous media in which due to the large difference between the pore sizes of the matrix and the aperture sizes of the fractures the porous matrix ends up playing a minor role in the fluid transmission while the fractures are the primary channels for fluid flow in summary we are interested in the cases where the fractures do not act as barriers for fluid flow but rather as main flow channels in these cases the significant size difference between pores and fracture apertures may be described by a continuum composed of pores and mineral grains i e with no clear separation between pores and grains and by fractures forming discontinuities in this continuum in the explicit methods class two grids are used for fractures and porous matrix the fluid flow through the fractured porous medium might be modelled according to different approaches such as equi dimensional models and mixed dimensional models berre et al 2019 in contrast in the mixed dimensional models the porous matrix is modelled as a d dimensional entity while fractures are modelled as d 1 dimensional entities aiming to simplify the mixed dimensional models this paper proposes a framework for upscaling the heterogeneous aperture distribution into an equivalent permeability tensor in the tangential direction of the fracture which is only acceptable in cases where the matrix permeability is much lower than the equivalent permeability of the fracture matthäii and nick 2009 the application of such framework is illustrated fig 1 the extracted fracture subdomain is projected to a nearly parallel plane and the aperture distribution is upscaled to an equivalent permeability tensor which should capture the permeability anisotropy i e the ratio between the principal components of the tensor and angle i e the principal orientation in the fluid flow pattern due to the fracture bisdom et al 2016 2017 nick and bisdom 2018 another possible application is to reduce the computational cost of high fidelity fluid flow models i e accounting for full aperture distributions by allowing the employment of coarser grids with the equivalent permeability tensor this is illustrated by the lower panel of fig 1 hereafter the fracture projected subdomain will be called projected domain denoted by ω proj as the method employed in this paper considers only the fluid flow along the fracture our domain of interest for fluid flow modelling the governing equations are given by 1 mass conservation a v 0 2 poiseuille law v a 2 12 μ p 0 in which v x y is the fluid flow velocity along the fracture a x y is the spatially heterogeneous aperture μ is the fluid viscosity and p x y is the pressure our goal is to find p x y such that 3 1 12 μ a 3 x y p x y 0 x y ω proj 4 1 12 μ a 2 x y p x y n v x y ω proj v 5 p x y p x y ω proj p with ω proj v ω proj p ω proj and ω proj v ω proj p 0 and n being the outward unit vector normal to the boundary region our full order model is given by the solution of the governing equations using lagrange finite elements the weak form is to find p x y p in which 6 p p h ω proj p x y p x y ω proj p such that 7 ω proj a 3 12 μ p q d x ω proj v v q d s for all test functions q q whereas 8 q q h ω proj q x y 0 x y ω proj p we solve the fem fom in a square domain of 0 1 2 using a structured grid composed of 128 128 vertices with third order lagrange triangle elements the solution is consequently projected to the same grid with linear lagrange triangles to store in 128 128 square matrices the solution of the fem fom and following projection of the solution was carried out using the fenics kirby 2004 kirby and logg 2006 alnaes et al 2009 ølgaard and wells 2010 logg and wells 2010 logg et al 2012 alnæs et al 2014 alnaes et al 2015 computing platform the upscaling of the heterogeneous permeability field to an equivalent permeability tensor durlofsky 1991 bisdom et al 2017 is performed by first solving two independent problems given by eq 7 for the first problem we assume p 1000 pa on the left boundary and p 0 pa on the right boundary with no normal flux on top and bottom boundaries i e v 0 m s for the second problem we assume p 1000 pa on the bottom boundary and p 0 pa on the top with normal flux on the left and right boundaries we denote p 1 as the solution of the first problem and p 2 as the solution of the second problem furthermore we denote ψ as the arithmetic mean of a quantity ψ throughout the domain following we obtain the components of the equivalent permeability tensor k given by 9 k k x x k x y k y x k y y from the solution of the over determined linear system 10 x p 1 y p 1 0 0 0 0 x p 1 y p 1 x p 2 y p 2 0 0 0 0 x p 2 y p 2 0 1 1 0 k x x k x y k y x k y y μ u 1 v 1 u 2 v 2 0 where x p and y p are the components of the gradient of pressure p and u and v are the components of the fluid flow velocity vector v given by eq 2 finally the obtained equivalent permeability tensor k can be applied to the lower dimensional representation of the fracture subdomain as depicted in fig 1 to reduce eq 10 to a determined system and keep enforced symmetry on the tensor k we sum the 2 nd and 3 rd equations and we sum the 2 nd and 3 rd columns of system matrix to eliminate the last equation thus reducing the linear system to 11 x p 1 y p 1 0 x p 2 y p 2 x p 1 y p 1 0 x p 2 y p 2 k x x k x y k y y μ u 1 v 1 u 2 v 2 the upscaling framework used in this work is illustrated by the blue path in fig 2 given a heterogeneous aperture distribution we solve the two independent fluid flow problems considering the fem fom the pressure distributions are then used to calculate an equivalent permeability tensor the bottleneck of such procedure is the solution of the full order model for obtaining pressure since it presupposes the solution of linear systems with a large number of degrees of freedom the proposed framework uses a reduced order model based on conditional generative adversarial networks referred to in this paper as cgan rom to predict the pressure distributions used in the upscaling method via eq 11 thus reducing the overall time of such procedure the red path in fig 2 illustrates the proposed framework considering the cgan rom and this model is further discussed in section 3 as we are mainly concerned with the upscaling of the heterogeneous aperture distribution into an equivalent permeability tensor the framework here presented only accounts from the projected aperture distribution until the equivalent permeability tensor i e from a to k some steps involved in applying a broader framework to the numerical simulation of fluid flow in fractured porous media are not covered in this paper a broader framework needs to cover all the steps from the computational representation of the fractured porous media with 3d fractures and heterogeneous aperture distribution to the computational representation of the fractured porous media with 2d fractures and equivalent permeability tensor as shown in fig 1 this would include for example the reduction of the fracture from a 3d object to a 2d object while retaining its aperture distribution and the mapping from the 2d fracture to a representative square and back 3 reduced order model the cgan employed in this work is composed of two neural networks a generator and a discriminator the model is similar to the one used by kadeethum et al 2021b with a few differences which are outlined in this section the forward model has the logarithm base 10 of the aperture distribution i e log a as input this is due to the fact that the aperture fields span in a wide range of orders of magnitude which would result in a numerical issue when trying to fit the reduced order model to the data the output of the model are the two pressure distributions obtained from the solutions of the two independent problems i e p 1 and p 2 we denote the input as i i 1 i 2 i n the reference output o o 1 o 2 o n and the approximate output o ˆ o ˆ 1 o ˆ 2 o ˆ n where n is the size of the training set both input and real output are normalized by 12 i i i i min i max i min i 13 o i o i min o max o min o in this work the cgan rom is composed of one u net generator g i o ˆ ronneberger et al 2015 and one patch discriminator d i o o p demir and unal 2018 both implemented based on pytorch paszke et al 2019 framework here we denominate the reference output obtained via fem fom as real output namely o and we denominate the approximations produced by the generator as fake output namely o ˆ furthermore d i o o p is the patch matrix given by the discriminator considering the real output o and d i o ˆ o ˆ p ˆ is the patch matrix given by the discriminator considering the fake or approximate output o ˆ the goal is to provide a fake output g i o ˆ that is similar enough to the real output o such that d i o o d i o ˆ o ˆ both g and d are trained simultaneously in the form of a zero sum game this adversarial training procedure of generator and discriminator is outlined in fig 3 the generator has log a as input and outputs two fake pressure distributions p ˆ 1 and p ˆ 2 the components of the gradient of these fake distribution are calculated along with the gradient of the real pressure distributions the discriminator receives log a fake and real distributions and their gradients components and infers if the distributions are approximations produced by the generator or from the actual ground truth next the loss is calculated considering the outputs of the generator and the discriminator whereas the former seeks to minimize the loss and the latter seeks to maximize the loss if the loss increases the generator s weights are updated or if the loss decreases the discriminator s weights are updated the loss function will be further discussed but now we focus in the architectures of the generator and the discriminator fig 4 depicts the architectures of the generator and the patch discriminator used in this work based on u nets which have established applications in image segmentation ronneberger et al 2015 zhou et al 2018 alom et al 2019 similar to the generator employed in kadeethum et al 2021b our generator consists of six contracting blocks and six expanding blocks the discriminator uses the same contracting block the generator uses however only four are employed it is noteworthy that the discriminator s output is not a single value but an 8 8 patch matrix a patch matrix with all entries 0 represents a sure guess that the discriminator has received a fake output on the other hand a patch matrix with all entries 1 represents a sure guess that the discriminator has received a real output furthermore since we are interested in the equivalent permeability tensor given by eq 11 we want our model not only to provide good approximations of the pressure distributions but outputs such that the gradients are also good approximations hence the discriminator has as arguments input i with size 1 output o with size 2 and gradient of the output o with size 4 the detailed generator s architecture is described in table 1 the 1 st and 2 nd convolutional layers are responsible for the mapping from input channel with size 1 to hidden layers with size 32 and from hidden layers to output channel with size 2 respectively the former is not subject to any activation function while the latter uses the sigmoid activation function furthermore each contracting block uses leakyrelu activation functions while the expanding blocks are subject to relu activation functions table 2 describes the detailed architecture of the discriminator similar to the one employed by the generator the 1 st convolutional layer is responsible for mapping from the input channel with size 1 2 4 to the hidden layers with size 8 the 2 nd convolutional layer on the other hand maps from the contracted input channel with size 128 to the output channel with size 1 as shown by kadeethum et al 2021b wasserstein generative adversarial networks arjovsky et al 2017 gulrajani et al 2017 present the most stable root mean square error when compared to spectral normalization generative adversarial networks miyato et al 2018 in the context of predicting the solution of pdes therefore we employ the w loss arjovsky et al 2017 gulrajani et al 2017 to prevent the gan model from going into mode collapse or a vanishing gradient problem further details on the wasserstein gan employed in this study and comparison to the spectral normalization gan for the solution of pdes may be found in kadeethum et al 2021b since our primary interest is the upscaling of the heterogeneous aperture distribution we employ a sobolev training procedure czarnecki et al 2017 that takes into account the gradient of pressure the training of the cgan rom is equivalent to trying to satisfy the constraint 14 min g max d ℓ d g ℓ a d g λ r ℓ r g λ p p d where ℓ a is the adversarial loss ℓ r is the reconstruction loss and p is the gradient penalty regularization furthermore λ r and λ p are penalty constants for the reconstruction loss and for the gradient regularization respectively and we use λ r 500 and λ p 10 throughout this work the adversarial loss the reconstruction loss and gradient penalty are given by 15 ℓ a d g 1 b i 1 b d i i o i o i 1 b i 1 b d i i g i i g i i 16 ℓ r g i 1 b o i g i i o i g i i 1 2 o i g i i 17 p d 1 b i 1 b d i i o i o i 2 1 2 respectively where o ɛ o 1 ɛ o ˆ with ɛ selected randomly from a uniform distribution between 0 and 1 the adversarial loss ℓ a and the gradient penalty regularization p are used in the training of the discriminator whereas p is used to force the euclidean norm of the gradient of the discriminator to be at most one in contrast the reconstruction loss ℓ r is used in the training of the generator due to the construction of the loss functions eq 15 17 the discriminator tries to increase the loss as the first summation in eq 15 should converge to 1 and the second one should converge to 0 whereas the generator tries to decrease the loss as eq 16 should converge to 0 hence the equivalence with the constraint 14 4 results in this section we present the results for the accuracy of the cgan on the solution of the fluid flow model and on the obtaining of equivalent permeability tensors all the results presented here were obtained through the usage of dcc resources dtu computing center 2021 we start this section with the accuracy results for layered media the problem used as a benchmark for verification of the fem fom and the cgan rom next we discuss the results considering zinn harvey transformations to check how the cgan rom performs with material properties with higher contrasts we end this section comparing and discussing the upscaled results considering self affine distributions for generating the fracture walls 4 1 verification case layered fracture for verification of the upscaled permeability tensors we consider the model problem of a layered medium rotated by an arbitrary angle bear 1972 durlofsky 1991 the layers are equally spaced and the width of the small aperture region is taken to be 2 2 times that of the large aperture region furthermore we assume the aperture a constant equals 7 μ m and 1 μ m for the large and small aperture regions respectively we select this particular problem because it has a very simple analytical solution for the upscaled permeability tensor bear 1972 durlofsky 1991 the exact equivalent permeability tensor of the non rotated layered fracture considering the apertures highlighted above is given by 18 k 0 1 33 1 0 12 0 0 1 20 1 0 13 where the x and y components are given by the weighted arithmetic and harmonic means the equivalent permeability tensor of the layered medium rotated by an arbitrary angle is given by the rotation of eq 18 by the same angle bear 1972 durlofsky 1991 the cgan rom was trained with n 5 1 0 3 samples over 20 training states composed of 2 5 1 0 4 steps each and tested with m 500 samples over these training states hereafter we denote m as the size of the testing data set and as aforementioned n is the size of the training data set for generating the training and testing sets we considered layered media rotated by random angles between 0 and 180 whereas a total of n m 5 5 1 0 3 realizations were generated fig 5 shows the predictions of the cgan rom for p 1 and p 2 compared to the actual distributions given by the fem fom the samples were selected randomly from the testing data set considering the last training state i e after 5 1 0 5 training steps we can notice that the cgan rom provides good approximations for the pressure solutions of the fem fom as p 1 and p 2 are in the range 0 1000 pa and the absolute differences diff are in the range 0 20 pa which means the errors are around 2 the cgan rom in this case yields a 988 fold speed up we outline in table 3 the execution times for generating the training data set training the cgan rom and for running both fem fom and cgan rom it is important to point out that the speed up considered in this work accounts only for a single run of the fem fom versus a single run of the cgan rom and does not take into account the execution times for generating the training data set and for training the cgan these latter execution times are for instance affected by the writing reading speed of the storage system thus preventing an objective comparison between the aforementioned models the framework could be optimized for decreasing the influence of reading writing routines in the overall computational cost and the system could also be upgraded for optimal reading writing but that is outside of the scope of the present work however as a rule of thumb the application of the cgan rom for upscaling heterogeneous aperture distributions only makes sense when dealing with repeated simulations such as in uncertainty quantification for example in these cases the execution times for generating the training data set and training the cgan are paid off by the speed up provided by the model in the case of the layered medium the break even point i e the minimum number of simulations for upscaling such that it is worth training the cgan instead of using the full order model is at 1 93 1 0 4 realizations it is noteworthy that this break even point represents the worst case scenario since the training of the cgan might be stopped earlier as it shows the accuracy evaluation described below for evaluating the accuracy of the model on predicting the output variables the relative error for each sample was calculated by 19 e p k l 1 l p k l p ˆ k l l 1 l p k l where p k and p ˆ k represent the output pressure for the problem k given by the fem fom and by the cgan rom respectively and l 12 8 2 is the number of entries in the output variable p k fig 6 shows the relative error for all the samples in the testing data set along the training states that is every 2 5 1 0 4 training steps there is no apparent overfitting of the model as the error has a decaying trend with further training and the errors are smaller than 0 5 in the last training state i e after 5 1 0 5 training steps however we are interested in the upscaling of the fractures hence we need to check the accuracy of the cgan rom with respect to the equivalent permeability tensor we determine the equivalent permeability tensor for each sample in the testing set using the data generated with our fem fom and the values predicted by the cgan rom the upscaling is performed through the solution of the linear system in eq 11 considering the pressure field given by both fem fom and cgan rom although for this problem we have an exact solution for the upscaled tensor we measure the accuracy of the cgan rom with respect to the fem fom as the latter represents the ground truth for the former to evaluate the accuracy of the proposed framework for determining the upscaled tensor we first calculate the principal components k max and k min of the tensor and the principal orientation θ and we calculate the error on these separately the relative error on the maximum and minimum principal components for each sample was calculated by 20 e k i k i k ˆ i k i where k i and k ˆ i denote the maximum or minimum component of the tensor obtained considering the fem fom results and the cgan rom results respectively as for the error in the principal orientation we cannot use the same equation since the angle might be zero or very close to zero leading to unrealistic errors instead we evaluate the absolute error that is the difference between θ and θ ˆ i e considering the fem fom and the cgan rom fig 7 depicts the box plot of the errors on k max k min and θ again no apparent overfitting of the model can be observed with respect to the upscaling even though an oscillating behaviour is observed with further training the error decay has an overall decreasing trend for the last state the errors in the minimum component are smaller than 18 whereas the errors in the maximum component are smaller than 10 in addition the error in the principal orientation represents less than 0 2 affirming the accuracy of the cgan rom for upscaling aperture distributions such as the ones employed in the verification problem the relative errors in the minimum component are more significant than the relative errors in the maximum component for the layered medium problem this results from the fact that the minimum component here is always roughly 1 order of magnitude smaller than the maximum component due to the sharp discontinuities in the aperture distributions hence any deviation in the prediction represents a large amount in the relative error for the minimum component however this error does not represent a substantial difference in the anisotropy associated with such fractures this can be seen in fig 8 here we plot as ellipses the maximum and minimum components and the principal orientation of the tensors obtained through eq 11 via fem fom and cgan rom along with the principal components of the exact tensor given by eq 18 and rotation angle samples selected randomly from the testing data set were plotted the ellipses have the maximum component as the size of the major axis the minimum component as the size of the minor axis and the principal orientation as the angle of the major axis with the abscissa the aperture distribution is shown in meters while the maximum and minimum components are shown in square meters although the aperture distributions span through less than an order of magnitude the layered profile displays a large transmission difference in the directions of the maximum and the minimum components the fem fom is not very accurate at replicating this behaviour seen in the analytical solution especially in the direction of the maximum component and the cgan rom displays the same issue mimicking precisely the fem fom this could possibly be improved by employing more accurate numerical methods to solve the fluid flow model such as discontinuous galerkin liu et al 2009 or enriched galerkin methods kadeethum et al 2020 2021a the inaccuracy of the fem fom does not affect however the accuracy of the cgan rom 4 2 testing case zinn harvey transformation to test the cgan rom in cases containing high contrast and nearly discontinuous aperture distributions and containing channels with more complex geometries inside the fractures we employ zinn harvey transformations zinn and harvey 2003 müller and schüler 2021 for obtaining the aperture distribution in this case we first generate an unconditional gaussian distribution müller and schüler 2021 with mean 1 0 variance 1 0 and length scale 0 4 the distribution is then transformed using zinn harvey transformation zinn and harvey 2003 müller and schüler 2021 enhancing the connectivity in the high values of the original gaussian distribution while keeping the original mean and co variance and translated so there are no negative values in the distribution the aperture distribution inside the fractures was defined by 21 a x y μ a d x y 1 0 4 where d x y is the translated distribution obtained through the zinn harvey transformation and μ a 1 μ m is the reference aperture since our full order model cannot handle a 0 d was added by 10 4 in eq 21 with the input parameters for the zinn harvey transformation o d 1 d 1 0 4 d thus for d 0 a will be virtually zero while posing no complications to the full order model the cgan rom was trained with n 1 1 0 4 samples over 20 training states composed of 5 1 0 4 steps each and tested with m 1 1 0 3 samples over these training states that is a total of n m 1 1 1 0 4 realizations were generated fig 9 shows the predictions of the cgan rom and the actual values given by the fem fom for samples selected randomly from the test set the absolute difference is larger than the ones observed for the benchmark problem this is due to the fact the aperture distributions span through 4 5 orders of magnitude and display channel patterns the accuracy of the cgan rom for this problem is somewhat smaller than for the benchmark problem however the speed up is of 1013 fold in this case we present in table 4 the execution times for this test case the break even point for this test case is at 1 93 1 0 4 realizations the upper panel in fig 10 shows the relative error on the cgan rom s prediction along with the training states there is no apparent overfitting of the model e g there is no increasing trend in the error along the training states however the decay of the error stalls around 3 which means a reasonable accuracy may be reached with fewer training steps the error of the principal components and principal orientation is depicted in the lower panel in fig 10 the errors in the maximum and minimum components are smaller than 4 in the 5 th training state and the errors in the principal orientation are smaller than 3 for that state further training bestows an oscillating behaviour in the errors with somewhat of an increasing trend it is noteworthy that the error in the principal orientation are larger for zinn harvey transformations than the errors observed for the rotated layered media this results from the fact that the principal orientation for the zinn harvey test case comes entirely from the complex heterogeneity and channel patterns in contrast to the layered media in which the principal orientation is mainly due to the arbitrary rotation angle some equivalent permeability tensors along with the aperture distribution associated with these are illustrated in fig 11 we can see that the tensors obtained with the cgan rom framework mimic the same anisotropic behaviour of the tensors obtained with the fem fom framework even though the apertures are distributed across 4 5 orders of magnitude 4 3 testing case self affine fractal distributions for testing the cgan rom for upscaling discrete fractures we consider self affine fractal distributions as they are a good description of the topography of the fracture walls schmittbuhl et al 1993 bouchaud 1997 méheust and schmittbuhl 2001 for generating the walls of the discrete fractures we employ the diamond square algorithm mandelbrot 1982 barber 2018 with hurst exponent equals 0 8 måløy et al 1992 schmittbuhl et al 2008 dou et al 2013 2018 the aperture distribution inside the fractures was defined by 22 d x y h 1 x y h 2 x y 23 d ˆ x y d x y 2 σ d 24 a x y μ a d ˆ x y if d ˆ x y 1 0 4 1 0 4 if d ˆ x y 1 0 4 where h 1 x y and h 2 x y are the height distributions of the fracture walls μ a 1 μ m is the reference aperture and σ d is the standard deviation of the distribution d x y in this work we considered two independent topographies for the fracture walls we allowed the fracture aperture to go beyond the surface contact by making the areas of the walls that overlap each other i e where d ˆ x y 0 to vanish in eq 23 we added 2 standard deviations to the distribution d x y and defined d ˆ x y to reduce the overlapping surface area again since our full order model cannot handle a 0 all local apertures that would be smaller than 1 0 4 μ a were set to 1 0 4 μ a as shows eq 24 fig 12 depicts a self affine aperture distribution generated with this algorithm and the fracture walls used for generating this aperture distribution the cgan rom was trained with n 1 1 0 4 samples over 20 training states composed of 5 1 0 4 steps each and tested with m 1 1 0 3 samples over these training states which means n m 1 1 1 0 4 realizations were generated fig 13 shows the predictions of the cgan rom and the actual values given by the fem fom for samples selected randomly from the test set we can notice that the cgan rom provides good approximations in either high or low contrast aperture distributions the errors are larger than the ones obtained for the zinn harvey distributions this is because the self affine distributions present a larger variance in the aperture distributions than the previous cases the speed up on the other hand is of 1011 folds for self affine distributions table 5 details the execution times for this test case the break even point for the self affine test case is at 1 63 1 0 4 realizations the upper panel in fig 14 shows the relative error on the cgan rom s prediction along with the training states there is an apparent overfitting of the model after 5 5 1 0 5 training steps but the errors remain smaller than 5 the error of the principal components and principal orientation is depicted in the lower panel in fig 14 for the maximum and minimum components errors are less than 10 there is an overfitting of the model after 5 5 1 0 5 training steps as outlined above for which the errors in the components are smaller than 5 and the errors in the principal orientation are smaller than 3 this assures the capability of the cgan rom for upscaling heterogeneous aperture distribution in the modelling of discrete fractures again the errors in the maximum and minimum components are smaller than the ones observed for the layered media since the self affine distribution do not present sharp discontinuities in the aperture distribution however the principal orientation in this case depends on the heterogeneity of the aperture and the collapsed walls of the fracture thus presenting larger errors than the layered media test case some randomly selected equivalent permeability tensors along with the aperture distribution associated with these are illustrated in fig 15 we notice that the tensors obtained with the cgan rom framework are very close to the real ones even when the ratio between maximum and minimum component is enhanced or in more isotropic patterns furthermore this model works well for aperture distributions with high or low contrast thus allowing its application to different aperture distributions 5 conclusion in this work a framework based on conditional generative adversarial networks cgan was utilized for scaling up heterogeneous aperture distributions of fractures into equivalent permeability tensors and employed for reduced order modelling with applications on discrete fracture modelling the key findings of this study are as follows our cgan model is able to predict the full field pressure solutions with more than 97 of accuracy for all three test cases the equivalent permeability tensor obtained via cgan can capture accurately the anisotropy and the angle of the permeability tensor obtained via traditional numerical simulations the upscaled tensor matched the ground truth even for cases in which the aperture distribution spanned through 5 orders of magnitude our model after training allows a reduction of 3 orders of magnitude in the computational cost of upscaling permeability from highly heterogeneous aperture distributions the results of this work suggest a potential application of the cgan for scaling up aperture distributions from fracture networks however some important features would require further investigation for instance fracture intersections fracture matrix fluid transmission among others the speed up should be evaluated for larger systems with multiple fractures computer code availability the scripts used in this work are available at dtu s gitlab ferreira et al 2022 credit authorship contribution statement carlos a s ferreira conceptualization methodology software validation investigation formal analysis writing original draft visualization teeratorn kadeethum conceptualization methodology software writing review editing supervision nikolaos bouklas conceptualization resources writing review editing supervision funding acquisition hamidreza m nick conceptualization methodology resources writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements carlos a s ferreira and hamid m nick are both supported by the danish offshore technology centre dtu offshore and the research leading to the results in this paper has received funding from dtu offshore under the advanced water flooding program teeratorn kadeethum is supported by the us department of energy office of fossil energy and carbon management science informed machine learning to accelerate real time decisions carbon storage smart cs initiative sandia national laboratories is a multimission laboratory managed and operated by national technology and engineering solutions of sandia llc a wholly owned subsidiary of honeywell international inc for the u s department of energy s national nuclear security administration under contract de na 0003525 this paper describes objective technical results and analysis any subjective views or opinions that might be expressed in the paper do not necessarily represent the views of the u s department of energy or the united states government nikolaos bouklas acknowledges startup support from the sibley school of mechanical and aerospace engineering cornell university 
128,scaling up highly heterogeneous aperture distributions of fractures into equivalent permeability tensors enables a substantial reduction in the computational cost of simulating fluid flow in fractured porous media by allowing the employment of coarser grids while keeping the accuracy of an explicit model this work proposes the adaptation and application of conditional generative adversarial networks cgan for upscaling the permeability of single fractures three different types of aperture distributions are used as input in this work layered media zinn harvey transformations and self affine fractals as output the model predicts the pressure inside the fracture which is used for calculation of the equivalent permeability tensor our results show that the framework employing cgan provides equivalent tensors that can capture accurately both the permeability angle and anisotropy of discrete fractures with a substantial reduction of the computational time when compared to traditional frameworks that rely on the numerical simulations keywords fractured porous media permeability tensor permeability anisotropy reduced order modelling 1 introduction on the modelling of fractures in porous media berkowitz 2002 berre et al 2019 there are two classes of methods a implicit methods borja and koliji 2009 choo and borja 2015 ashworth and doster 2019 in which both the fractures and the porous matrix are represented by two overlapping continua and a transfer function is used to model the interaction between them and b explicit methods martin et al 2005 nick and matthäi 2011 gläser et al 2017 in which two distinct grids are used for the fractures and the porous matrix and their interplay is represented explicitly an explicit method allows a more accurate representation of the fractures and subsequently its interplay with the porous matrix but at the expense of a higher computational cost implicit approaches ensure cheaper models and techniques were developed to increase the accuracy of the model ranjbar and hassanzadeh 2011 fahs et al 2014 wu et al 2020 however the existence of a representative elementary volume rev for fractured porous media and accurate homogeneous parameters for an implicit approach cannot be guaranteed since there may be no clear scale separation between pore scale fracture dimensions and macro scale berkowitz 2002 berre et al 2019 furthermore previous works have shown that averaging the heterogeneous aperture to scale up permeability results in an inaccurate representation of the fluid flow pattern nick et al 2011 this indicates the necessity of incorporating full aperture distributions rather than simplified aperture representations in reservoir scale flow models latham et al 2013 bisdom et al 2016 2017 nick and bisdom 2018 a strategy for reducing the computational cost involved in an exemplary representation of the aperture distribution is along with a lower dimensional representation of the fracture martin et al 2005 berre et al 2019 to upscale the heterogeneous aperture into a single permeability tensor durlofsky 1991 matthäii and nick 2009 lasseux et al 2021 thus permitting the employment of a coarser grid this methodology is mainly used if the matrix permeability is much lower than the equivalent permeability of the fracture matthäii and nick 2009 i e if the fracture does not act as barrier for the fluid flow to scale up the heterogeneous aperture into an equivalent permeability tensor we need to solve the fluid flow problem within the fracture this procedure is computationally expensive when dealing with multiple fractures in a porous medium which is the case of most naturally fractured rocks for accelerating the scaling up reduced order models are an alternative for approximating the solutions in a computationally cheaper representation leaning for example on approaches based on proper orthogonal decomposition pod winton et al 2011 pasetto et al 2011 ushijima and yeh 2017 xiao et al 2017 dey and dhar 2020 or non linear manifolds takbiri borujeni et al 2020 kadeethum et al 2022 zhong et al 2019 kadeethum et al 2021b reduced order models rely on the parametrization of the problem schilders et al 2008 hesthaven et al 2016 ballarin et al 2019 in which the parameters could correspond to material properties geometry and or boundary conditions following this paradigm allows to solve the parameterized problem according to the input aperture distribution with significantly smaller simulation time however the reduction of heterogeneous aperture distributions to a small number of parameters is challenging and sometimes almost impossible therefore discouraging the application of traditional pod based models winton et al 2011 pasetto et al 2011 ushijima and yeh 2017 xiao et al 2017 dey and dhar 2020 machine learning methods have recently been used successfully in the context of porous media applications chan and elsheikh 2018 rabbani and babaei 2019 mo et al 2019 chan and elsheikh 2020 tahmasebi et al 2020 singh et al 2021 gharib and davies 2021 and in particular for upscaling heterogeneity of the porous medium vesselinov et al 2017 santos et al 2020 andrianov and nick 2021 menke et al 2021 jouini et al 2021 among these methods conditional generative adversarial networks mirza and osindero 2014 are an alternative for the parametrization of heterogeneous material properties and reduced order modelling zhong et al 2019 kadeethum et al 2021b the main strength of such image to image translation framework isola et al 2017 is that it runs on a self training scheme without the need of any assumption on the input data distribution the application of cgans for reduced order modelling even with highly heterogeneous material properties was shown to have acceptable accuracy with respect to the full order model kadeethum et al 2021b the latter showcased the effectiveness of the cgan architecture in the context of data driven solutions of partial differential equations for both forward and inverse problems this paper proposes for the first time the application of cgan towards solving the fluid flow in fractured porous media aiming to accelerate the scaling up to equivalent permeability tensors for discrete modelling fracture networks the neural network used in this work is similar to the one employed by kadeethum et al 2021b for the prediction of pore pressure in deformable porous media however we advance the model to obtain the equivalent permeability tensor instead of only pressure distributions to this end to minimize the error in the equivalent permeability tensor obtained via cgan we employ a sobolev training approach czarnecki et al 2017 by modifying the loss function to also account for the loss in the distributions of gradient of pressure and their mean first the fluid flow problem is solved for a benchmark problem bear 1972 durlofsky 1991 with the finite element method kirby 2004 kirby and logg 2006 alnaes et al 2009 ølgaard and wells 2010 logg and wells 2010 logg et al 2012 alnæs et al 2014 alnaes et al 2015 and the numerical solutions are used for training the cgan model with modified wasserstein loss arjovsky et al 2017 gulrajani et al 2017 the accuracy of the cgan is tested and the obtained equivalent permeability tensors are verified against the analytical solution next the fluid flow problem is solved considering two types of aperture distributions zinn harvey transformation zinn and harvey 2003 müller and schüler 2021 and self affine schmittbuhl et al 1993 bouchaud 1997 méheust and schmittbuhl 2001 the accuracy of the cgan is tested under such conditions and an error analysis is performed the work presented here is novel in the application of the image to image translation concept for scaling up highly heterogeneous material properties more specifically aperture distributions of fractures in a porous medium we show that this framework can not only parameterize complex input fields but more importantly realistic inputs based in fractal distributions in addition the upscaled tensors obtained via this framework are able to capture accurately the anisotropic behaviour that such heterogeneous material properties impose on the fluid flow in porous media while speeding up the calculations this paper is organized as follows section 2 describes the problem we are interested in solving which involves the upscaling of the heterogeneous aperture distribution and outlines the proposed framework that relies on the cgan following section 3 introduces the cgan model used in this work and describes the architecture of the networks along with the new loss functions for their training with improved accuracy section 4 presents the results of the verification and accuracy tests with the cgan model in addition an error analysis is presented to discuss the applications of the proposed framework further 2 methodology this section describes the fluid flow in fractured porous media and presents the governing equations used in the present work we briefly discuss the numerical method used for generating the data set i e the full order model which employs a mixed finite element method referred to in this work as fem fom following we present the procedure for obtaining an equivalent permeability tensor for the fracture given two independent pressure distributions in the fracture we are interested in fractured porous media in which due to the large difference between the pore sizes of the matrix and the aperture sizes of the fractures the porous matrix ends up playing a minor role in the fluid transmission while the fractures are the primary channels for fluid flow in summary we are interested in the cases where the fractures do not act as barriers for fluid flow but rather as main flow channels in these cases the significant size difference between pores and fracture apertures may be described by a continuum composed of pores and mineral grains i e with no clear separation between pores and grains and by fractures forming discontinuities in this continuum in the explicit methods class two grids are used for fractures and porous matrix the fluid flow through the fractured porous medium might be modelled according to different approaches such as equi dimensional models and mixed dimensional models berre et al 2019 in contrast in the mixed dimensional models the porous matrix is modelled as a d dimensional entity while fractures are modelled as d 1 dimensional entities aiming to simplify the mixed dimensional models this paper proposes a framework for upscaling the heterogeneous aperture distribution into an equivalent permeability tensor in the tangential direction of the fracture which is only acceptable in cases where the matrix permeability is much lower than the equivalent permeability of the fracture matthäii and nick 2009 the application of such framework is illustrated fig 1 the extracted fracture subdomain is projected to a nearly parallel plane and the aperture distribution is upscaled to an equivalent permeability tensor which should capture the permeability anisotropy i e the ratio between the principal components of the tensor and angle i e the principal orientation in the fluid flow pattern due to the fracture bisdom et al 2016 2017 nick and bisdom 2018 another possible application is to reduce the computational cost of high fidelity fluid flow models i e accounting for full aperture distributions by allowing the employment of coarser grids with the equivalent permeability tensor this is illustrated by the lower panel of fig 1 hereafter the fracture projected subdomain will be called projected domain denoted by ω proj as the method employed in this paper considers only the fluid flow along the fracture our domain of interest for fluid flow modelling the governing equations are given by 1 mass conservation a v 0 2 poiseuille law v a 2 12 μ p 0 in which v x y is the fluid flow velocity along the fracture a x y is the spatially heterogeneous aperture μ is the fluid viscosity and p x y is the pressure our goal is to find p x y such that 3 1 12 μ a 3 x y p x y 0 x y ω proj 4 1 12 μ a 2 x y p x y n v x y ω proj v 5 p x y p x y ω proj p with ω proj v ω proj p ω proj and ω proj v ω proj p 0 and n being the outward unit vector normal to the boundary region our full order model is given by the solution of the governing equations using lagrange finite elements the weak form is to find p x y p in which 6 p p h ω proj p x y p x y ω proj p such that 7 ω proj a 3 12 μ p q d x ω proj v v q d s for all test functions q q whereas 8 q q h ω proj q x y 0 x y ω proj p we solve the fem fom in a square domain of 0 1 2 using a structured grid composed of 128 128 vertices with third order lagrange triangle elements the solution is consequently projected to the same grid with linear lagrange triangles to store in 128 128 square matrices the solution of the fem fom and following projection of the solution was carried out using the fenics kirby 2004 kirby and logg 2006 alnaes et al 2009 ølgaard and wells 2010 logg and wells 2010 logg et al 2012 alnæs et al 2014 alnaes et al 2015 computing platform the upscaling of the heterogeneous permeability field to an equivalent permeability tensor durlofsky 1991 bisdom et al 2017 is performed by first solving two independent problems given by eq 7 for the first problem we assume p 1000 pa on the left boundary and p 0 pa on the right boundary with no normal flux on top and bottom boundaries i e v 0 m s for the second problem we assume p 1000 pa on the bottom boundary and p 0 pa on the top with normal flux on the left and right boundaries we denote p 1 as the solution of the first problem and p 2 as the solution of the second problem furthermore we denote ψ as the arithmetic mean of a quantity ψ throughout the domain following we obtain the components of the equivalent permeability tensor k given by 9 k k x x k x y k y x k y y from the solution of the over determined linear system 10 x p 1 y p 1 0 0 0 0 x p 1 y p 1 x p 2 y p 2 0 0 0 0 x p 2 y p 2 0 1 1 0 k x x k x y k y x k y y μ u 1 v 1 u 2 v 2 0 where x p and y p are the components of the gradient of pressure p and u and v are the components of the fluid flow velocity vector v given by eq 2 finally the obtained equivalent permeability tensor k can be applied to the lower dimensional representation of the fracture subdomain as depicted in fig 1 to reduce eq 10 to a determined system and keep enforced symmetry on the tensor k we sum the 2 nd and 3 rd equations and we sum the 2 nd and 3 rd columns of system matrix to eliminate the last equation thus reducing the linear system to 11 x p 1 y p 1 0 x p 2 y p 2 x p 1 y p 1 0 x p 2 y p 2 k x x k x y k y y μ u 1 v 1 u 2 v 2 the upscaling framework used in this work is illustrated by the blue path in fig 2 given a heterogeneous aperture distribution we solve the two independent fluid flow problems considering the fem fom the pressure distributions are then used to calculate an equivalent permeability tensor the bottleneck of such procedure is the solution of the full order model for obtaining pressure since it presupposes the solution of linear systems with a large number of degrees of freedom the proposed framework uses a reduced order model based on conditional generative adversarial networks referred to in this paper as cgan rom to predict the pressure distributions used in the upscaling method via eq 11 thus reducing the overall time of such procedure the red path in fig 2 illustrates the proposed framework considering the cgan rom and this model is further discussed in section 3 as we are mainly concerned with the upscaling of the heterogeneous aperture distribution into an equivalent permeability tensor the framework here presented only accounts from the projected aperture distribution until the equivalent permeability tensor i e from a to k some steps involved in applying a broader framework to the numerical simulation of fluid flow in fractured porous media are not covered in this paper a broader framework needs to cover all the steps from the computational representation of the fractured porous media with 3d fractures and heterogeneous aperture distribution to the computational representation of the fractured porous media with 2d fractures and equivalent permeability tensor as shown in fig 1 this would include for example the reduction of the fracture from a 3d object to a 2d object while retaining its aperture distribution and the mapping from the 2d fracture to a representative square and back 3 reduced order model the cgan employed in this work is composed of two neural networks a generator and a discriminator the model is similar to the one used by kadeethum et al 2021b with a few differences which are outlined in this section the forward model has the logarithm base 10 of the aperture distribution i e log a as input this is due to the fact that the aperture fields span in a wide range of orders of magnitude which would result in a numerical issue when trying to fit the reduced order model to the data the output of the model are the two pressure distributions obtained from the solutions of the two independent problems i e p 1 and p 2 we denote the input as i i 1 i 2 i n the reference output o o 1 o 2 o n and the approximate output o ˆ o ˆ 1 o ˆ 2 o ˆ n where n is the size of the training set both input and real output are normalized by 12 i i i i min i max i min i 13 o i o i min o max o min o in this work the cgan rom is composed of one u net generator g i o ˆ ronneberger et al 2015 and one patch discriminator d i o o p demir and unal 2018 both implemented based on pytorch paszke et al 2019 framework here we denominate the reference output obtained via fem fom as real output namely o and we denominate the approximations produced by the generator as fake output namely o ˆ furthermore d i o o p is the patch matrix given by the discriminator considering the real output o and d i o ˆ o ˆ p ˆ is the patch matrix given by the discriminator considering the fake or approximate output o ˆ the goal is to provide a fake output g i o ˆ that is similar enough to the real output o such that d i o o d i o ˆ o ˆ both g and d are trained simultaneously in the form of a zero sum game this adversarial training procedure of generator and discriminator is outlined in fig 3 the generator has log a as input and outputs two fake pressure distributions p ˆ 1 and p ˆ 2 the components of the gradient of these fake distribution are calculated along with the gradient of the real pressure distributions the discriminator receives log a fake and real distributions and their gradients components and infers if the distributions are approximations produced by the generator or from the actual ground truth next the loss is calculated considering the outputs of the generator and the discriminator whereas the former seeks to minimize the loss and the latter seeks to maximize the loss if the loss increases the generator s weights are updated or if the loss decreases the discriminator s weights are updated the loss function will be further discussed but now we focus in the architectures of the generator and the discriminator fig 4 depicts the architectures of the generator and the patch discriminator used in this work based on u nets which have established applications in image segmentation ronneberger et al 2015 zhou et al 2018 alom et al 2019 similar to the generator employed in kadeethum et al 2021b our generator consists of six contracting blocks and six expanding blocks the discriminator uses the same contracting block the generator uses however only four are employed it is noteworthy that the discriminator s output is not a single value but an 8 8 patch matrix a patch matrix with all entries 0 represents a sure guess that the discriminator has received a fake output on the other hand a patch matrix with all entries 1 represents a sure guess that the discriminator has received a real output furthermore since we are interested in the equivalent permeability tensor given by eq 11 we want our model not only to provide good approximations of the pressure distributions but outputs such that the gradients are also good approximations hence the discriminator has as arguments input i with size 1 output o with size 2 and gradient of the output o with size 4 the detailed generator s architecture is described in table 1 the 1 st and 2 nd convolutional layers are responsible for the mapping from input channel with size 1 to hidden layers with size 32 and from hidden layers to output channel with size 2 respectively the former is not subject to any activation function while the latter uses the sigmoid activation function furthermore each contracting block uses leakyrelu activation functions while the expanding blocks are subject to relu activation functions table 2 describes the detailed architecture of the discriminator similar to the one employed by the generator the 1 st convolutional layer is responsible for mapping from the input channel with size 1 2 4 to the hidden layers with size 8 the 2 nd convolutional layer on the other hand maps from the contracted input channel with size 128 to the output channel with size 1 as shown by kadeethum et al 2021b wasserstein generative adversarial networks arjovsky et al 2017 gulrajani et al 2017 present the most stable root mean square error when compared to spectral normalization generative adversarial networks miyato et al 2018 in the context of predicting the solution of pdes therefore we employ the w loss arjovsky et al 2017 gulrajani et al 2017 to prevent the gan model from going into mode collapse or a vanishing gradient problem further details on the wasserstein gan employed in this study and comparison to the spectral normalization gan for the solution of pdes may be found in kadeethum et al 2021b since our primary interest is the upscaling of the heterogeneous aperture distribution we employ a sobolev training procedure czarnecki et al 2017 that takes into account the gradient of pressure the training of the cgan rom is equivalent to trying to satisfy the constraint 14 min g max d ℓ d g ℓ a d g λ r ℓ r g λ p p d where ℓ a is the adversarial loss ℓ r is the reconstruction loss and p is the gradient penalty regularization furthermore λ r and λ p are penalty constants for the reconstruction loss and for the gradient regularization respectively and we use λ r 500 and λ p 10 throughout this work the adversarial loss the reconstruction loss and gradient penalty are given by 15 ℓ a d g 1 b i 1 b d i i o i o i 1 b i 1 b d i i g i i g i i 16 ℓ r g i 1 b o i g i i o i g i i 1 2 o i g i i 17 p d 1 b i 1 b d i i o i o i 2 1 2 respectively where o ɛ o 1 ɛ o ˆ with ɛ selected randomly from a uniform distribution between 0 and 1 the adversarial loss ℓ a and the gradient penalty regularization p are used in the training of the discriminator whereas p is used to force the euclidean norm of the gradient of the discriminator to be at most one in contrast the reconstruction loss ℓ r is used in the training of the generator due to the construction of the loss functions eq 15 17 the discriminator tries to increase the loss as the first summation in eq 15 should converge to 1 and the second one should converge to 0 whereas the generator tries to decrease the loss as eq 16 should converge to 0 hence the equivalence with the constraint 14 4 results in this section we present the results for the accuracy of the cgan on the solution of the fluid flow model and on the obtaining of equivalent permeability tensors all the results presented here were obtained through the usage of dcc resources dtu computing center 2021 we start this section with the accuracy results for layered media the problem used as a benchmark for verification of the fem fom and the cgan rom next we discuss the results considering zinn harvey transformations to check how the cgan rom performs with material properties with higher contrasts we end this section comparing and discussing the upscaled results considering self affine distributions for generating the fracture walls 4 1 verification case layered fracture for verification of the upscaled permeability tensors we consider the model problem of a layered medium rotated by an arbitrary angle bear 1972 durlofsky 1991 the layers are equally spaced and the width of the small aperture region is taken to be 2 2 times that of the large aperture region furthermore we assume the aperture a constant equals 7 μ m and 1 μ m for the large and small aperture regions respectively we select this particular problem because it has a very simple analytical solution for the upscaled permeability tensor bear 1972 durlofsky 1991 the exact equivalent permeability tensor of the non rotated layered fracture considering the apertures highlighted above is given by 18 k 0 1 33 1 0 12 0 0 1 20 1 0 13 where the x and y components are given by the weighted arithmetic and harmonic means the equivalent permeability tensor of the layered medium rotated by an arbitrary angle is given by the rotation of eq 18 by the same angle bear 1972 durlofsky 1991 the cgan rom was trained with n 5 1 0 3 samples over 20 training states composed of 2 5 1 0 4 steps each and tested with m 500 samples over these training states hereafter we denote m as the size of the testing data set and as aforementioned n is the size of the training data set for generating the training and testing sets we considered layered media rotated by random angles between 0 and 180 whereas a total of n m 5 5 1 0 3 realizations were generated fig 5 shows the predictions of the cgan rom for p 1 and p 2 compared to the actual distributions given by the fem fom the samples were selected randomly from the testing data set considering the last training state i e after 5 1 0 5 training steps we can notice that the cgan rom provides good approximations for the pressure solutions of the fem fom as p 1 and p 2 are in the range 0 1000 pa and the absolute differences diff are in the range 0 20 pa which means the errors are around 2 the cgan rom in this case yields a 988 fold speed up we outline in table 3 the execution times for generating the training data set training the cgan rom and for running both fem fom and cgan rom it is important to point out that the speed up considered in this work accounts only for a single run of the fem fom versus a single run of the cgan rom and does not take into account the execution times for generating the training data set and for training the cgan these latter execution times are for instance affected by the writing reading speed of the storage system thus preventing an objective comparison between the aforementioned models the framework could be optimized for decreasing the influence of reading writing routines in the overall computational cost and the system could also be upgraded for optimal reading writing but that is outside of the scope of the present work however as a rule of thumb the application of the cgan rom for upscaling heterogeneous aperture distributions only makes sense when dealing with repeated simulations such as in uncertainty quantification for example in these cases the execution times for generating the training data set and training the cgan are paid off by the speed up provided by the model in the case of the layered medium the break even point i e the minimum number of simulations for upscaling such that it is worth training the cgan instead of using the full order model is at 1 93 1 0 4 realizations it is noteworthy that this break even point represents the worst case scenario since the training of the cgan might be stopped earlier as it shows the accuracy evaluation described below for evaluating the accuracy of the model on predicting the output variables the relative error for each sample was calculated by 19 e p k l 1 l p k l p ˆ k l l 1 l p k l where p k and p ˆ k represent the output pressure for the problem k given by the fem fom and by the cgan rom respectively and l 12 8 2 is the number of entries in the output variable p k fig 6 shows the relative error for all the samples in the testing data set along the training states that is every 2 5 1 0 4 training steps there is no apparent overfitting of the model as the error has a decaying trend with further training and the errors are smaller than 0 5 in the last training state i e after 5 1 0 5 training steps however we are interested in the upscaling of the fractures hence we need to check the accuracy of the cgan rom with respect to the equivalent permeability tensor we determine the equivalent permeability tensor for each sample in the testing set using the data generated with our fem fom and the values predicted by the cgan rom the upscaling is performed through the solution of the linear system in eq 11 considering the pressure field given by both fem fom and cgan rom although for this problem we have an exact solution for the upscaled tensor we measure the accuracy of the cgan rom with respect to the fem fom as the latter represents the ground truth for the former to evaluate the accuracy of the proposed framework for determining the upscaled tensor we first calculate the principal components k max and k min of the tensor and the principal orientation θ and we calculate the error on these separately the relative error on the maximum and minimum principal components for each sample was calculated by 20 e k i k i k ˆ i k i where k i and k ˆ i denote the maximum or minimum component of the tensor obtained considering the fem fom results and the cgan rom results respectively as for the error in the principal orientation we cannot use the same equation since the angle might be zero or very close to zero leading to unrealistic errors instead we evaluate the absolute error that is the difference between θ and θ ˆ i e considering the fem fom and the cgan rom fig 7 depicts the box plot of the errors on k max k min and θ again no apparent overfitting of the model can be observed with respect to the upscaling even though an oscillating behaviour is observed with further training the error decay has an overall decreasing trend for the last state the errors in the minimum component are smaller than 18 whereas the errors in the maximum component are smaller than 10 in addition the error in the principal orientation represents less than 0 2 affirming the accuracy of the cgan rom for upscaling aperture distributions such as the ones employed in the verification problem the relative errors in the minimum component are more significant than the relative errors in the maximum component for the layered medium problem this results from the fact that the minimum component here is always roughly 1 order of magnitude smaller than the maximum component due to the sharp discontinuities in the aperture distributions hence any deviation in the prediction represents a large amount in the relative error for the minimum component however this error does not represent a substantial difference in the anisotropy associated with such fractures this can be seen in fig 8 here we plot as ellipses the maximum and minimum components and the principal orientation of the tensors obtained through eq 11 via fem fom and cgan rom along with the principal components of the exact tensor given by eq 18 and rotation angle samples selected randomly from the testing data set were plotted the ellipses have the maximum component as the size of the major axis the minimum component as the size of the minor axis and the principal orientation as the angle of the major axis with the abscissa the aperture distribution is shown in meters while the maximum and minimum components are shown in square meters although the aperture distributions span through less than an order of magnitude the layered profile displays a large transmission difference in the directions of the maximum and the minimum components the fem fom is not very accurate at replicating this behaviour seen in the analytical solution especially in the direction of the maximum component and the cgan rom displays the same issue mimicking precisely the fem fom this could possibly be improved by employing more accurate numerical methods to solve the fluid flow model such as discontinuous galerkin liu et al 2009 or enriched galerkin methods kadeethum et al 2020 2021a the inaccuracy of the fem fom does not affect however the accuracy of the cgan rom 4 2 testing case zinn harvey transformation to test the cgan rom in cases containing high contrast and nearly discontinuous aperture distributions and containing channels with more complex geometries inside the fractures we employ zinn harvey transformations zinn and harvey 2003 müller and schüler 2021 for obtaining the aperture distribution in this case we first generate an unconditional gaussian distribution müller and schüler 2021 with mean 1 0 variance 1 0 and length scale 0 4 the distribution is then transformed using zinn harvey transformation zinn and harvey 2003 müller and schüler 2021 enhancing the connectivity in the high values of the original gaussian distribution while keeping the original mean and co variance and translated so there are no negative values in the distribution the aperture distribution inside the fractures was defined by 21 a x y μ a d x y 1 0 4 where d x y is the translated distribution obtained through the zinn harvey transformation and μ a 1 μ m is the reference aperture since our full order model cannot handle a 0 d was added by 10 4 in eq 21 with the input parameters for the zinn harvey transformation o d 1 d 1 0 4 d thus for d 0 a will be virtually zero while posing no complications to the full order model the cgan rom was trained with n 1 1 0 4 samples over 20 training states composed of 5 1 0 4 steps each and tested with m 1 1 0 3 samples over these training states that is a total of n m 1 1 1 0 4 realizations were generated fig 9 shows the predictions of the cgan rom and the actual values given by the fem fom for samples selected randomly from the test set the absolute difference is larger than the ones observed for the benchmark problem this is due to the fact the aperture distributions span through 4 5 orders of magnitude and display channel patterns the accuracy of the cgan rom for this problem is somewhat smaller than for the benchmark problem however the speed up is of 1013 fold in this case we present in table 4 the execution times for this test case the break even point for this test case is at 1 93 1 0 4 realizations the upper panel in fig 10 shows the relative error on the cgan rom s prediction along with the training states there is no apparent overfitting of the model e g there is no increasing trend in the error along the training states however the decay of the error stalls around 3 which means a reasonable accuracy may be reached with fewer training steps the error of the principal components and principal orientation is depicted in the lower panel in fig 10 the errors in the maximum and minimum components are smaller than 4 in the 5 th training state and the errors in the principal orientation are smaller than 3 for that state further training bestows an oscillating behaviour in the errors with somewhat of an increasing trend it is noteworthy that the error in the principal orientation are larger for zinn harvey transformations than the errors observed for the rotated layered media this results from the fact that the principal orientation for the zinn harvey test case comes entirely from the complex heterogeneity and channel patterns in contrast to the layered media in which the principal orientation is mainly due to the arbitrary rotation angle some equivalent permeability tensors along with the aperture distribution associated with these are illustrated in fig 11 we can see that the tensors obtained with the cgan rom framework mimic the same anisotropic behaviour of the tensors obtained with the fem fom framework even though the apertures are distributed across 4 5 orders of magnitude 4 3 testing case self affine fractal distributions for testing the cgan rom for upscaling discrete fractures we consider self affine fractal distributions as they are a good description of the topography of the fracture walls schmittbuhl et al 1993 bouchaud 1997 méheust and schmittbuhl 2001 for generating the walls of the discrete fractures we employ the diamond square algorithm mandelbrot 1982 barber 2018 with hurst exponent equals 0 8 måløy et al 1992 schmittbuhl et al 2008 dou et al 2013 2018 the aperture distribution inside the fractures was defined by 22 d x y h 1 x y h 2 x y 23 d ˆ x y d x y 2 σ d 24 a x y μ a d ˆ x y if d ˆ x y 1 0 4 1 0 4 if d ˆ x y 1 0 4 where h 1 x y and h 2 x y are the height distributions of the fracture walls μ a 1 μ m is the reference aperture and σ d is the standard deviation of the distribution d x y in this work we considered two independent topographies for the fracture walls we allowed the fracture aperture to go beyond the surface contact by making the areas of the walls that overlap each other i e where d ˆ x y 0 to vanish in eq 23 we added 2 standard deviations to the distribution d x y and defined d ˆ x y to reduce the overlapping surface area again since our full order model cannot handle a 0 all local apertures that would be smaller than 1 0 4 μ a were set to 1 0 4 μ a as shows eq 24 fig 12 depicts a self affine aperture distribution generated with this algorithm and the fracture walls used for generating this aperture distribution the cgan rom was trained with n 1 1 0 4 samples over 20 training states composed of 5 1 0 4 steps each and tested with m 1 1 0 3 samples over these training states which means n m 1 1 1 0 4 realizations were generated fig 13 shows the predictions of the cgan rom and the actual values given by the fem fom for samples selected randomly from the test set we can notice that the cgan rom provides good approximations in either high or low contrast aperture distributions the errors are larger than the ones obtained for the zinn harvey distributions this is because the self affine distributions present a larger variance in the aperture distributions than the previous cases the speed up on the other hand is of 1011 folds for self affine distributions table 5 details the execution times for this test case the break even point for the self affine test case is at 1 63 1 0 4 realizations the upper panel in fig 14 shows the relative error on the cgan rom s prediction along with the training states there is an apparent overfitting of the model after 5 5 1 0 5 training steps but the errors remain smaller than 5 the error of the principal components and principal orientation is depicted in the lower panel in fig 14 for the maximum and minimum components errors are less than 10 there is an overfitting of the model after 5 5 1 0 5 training steps as outlined above for which the errors in the components are smaller than 5 and the errors in the principal orientation are smaller than 3 this assures the capability of the cgan rom for upscaling heterogeneous aperture distribution in the modelling of discrete fractures again the errors in the maximum and minimum components are smaller than the ones observed for the layered media since the self affine distribution do not present sharp discontinuities in the aperture distribution however the principal orientation in this case depends on the heterogeneity of the aperture and the collapsed walls of the fracture thus presenting larger errors than the layered media test case some randomly selected equivalent permeability tensors along with the aperture distribution associated with these are illustrated in fig 15 we notice that the tensors obtained with the cgan rom framework are very close to the real ones even when the ratio between maximum and minimum component is enhanced or in more isotropic patterns furthermore this model works well for aperture distributions with high or low contrast thus allowing its application to different aperture distributions 5 conclusion in this work a framework based on conditional generative adversarial networks cgan was utilized for scaling up heterogeneous aperture distributions of fractures into equivalent permeability tensors and employed for reduced order modelling with applications on discrete fracture modelling the key findings of this study are as follows our cgan model is able to predict the full field pressure solutions with more than 97 of accuracy for all three test cases the equivalent permeability tensor obtained via cgan can capture accurately the anisotropy and the angle of the permeability tensor obtained via traditional numerical simulations the upscaled tensor matched the ground truth even for cases in which the aperture distribution spanned through 5 orders of magnitude our model after training allows a reduction of 3 orders of magnitude in the computational cost of upscaling permeability from highly heterogeneous aperture distributions the results of this work suggest a potential application of the cgan for scaling up aperture distributions from fracture networks however some important features would require further investigation for instance fracture intersections fracture matrix fluid transmission among others the speed up should be evaluated for larger systems with multiple fractures computer code availability the scripts used in this work are available at dtu s gitlab ferreira et al 2022 credit authorship contribution statement carlos a s ferreira conceptualization methodology software validation investigation formal analysis writing original draft visualization teeratorn kadeethum conceptualization methodology software writing review editing supervision nikolaos bouklas conceptualization resources writing review editing supervision funding acquisition hamidreza m nick conceptualization methodology resources writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements carlos a s ferreira and hamid m nick are both supported by the danish offshore technology centre dtu offshore and the research leading to the results in this paper has received funding from dtu offshore under the advanced water flooding program teeratorn kadeethum is supported by the us department of energy office of fossil energy and carbon management science informed machine learning to accelerate real time decisions carbon storage smart cs initiative sandia national laboratories is a multimission laboratory managed and operated by national technology and engineering solutions of sandia llc a wholly owned subsidiary of honeywell international inc for the u s department of energy s national nuclear security administration under contract de na 0003525 this paper describes objective technical results and analysis any subjective views or opinions that might be expressed in the paper do not necessarily represent the views of the u s department of energy or the united states government nikolaos bouklas acknowledges startup support from the sibley school of mechanical and aerospace engineering cornell university 
129,persistent surface water pools within non perennial streams provide critical refuges for freshwater species by facilitating their survival during extended dry periods however our understanding of how pool water levels recede is limited hindering our ability to quantify and predict aquatic refuge persistence we characterise variations in water level recession rates based on one year of water level measurements in five non perennial streams most of the observations show that the water level recedes at a constant rate after streamflow ceases in our study streams a rate often significantly higher than that during low flow periods however water level recession rates varied considerably amongst cease to flow periods within pools in the same non perennial stream and between nearby streams the constancy of water level recession during a cease to flow period is applicable to other non perennial streams but a detailed understanding of the factors influencing recession rates is needed for prediction in ungauged streams and identifying persistent aquatic refuges across river networks keywords aquatic refuges flow intermittency sub surface flow resistance resilience eastern australia 1 introduction non perennial streams constitute more than half of the global river network acuña et al 2014 datry et al 2014 and play an essential role in maintaining biodiversity by providing habitats for multiple migratory and endemic species labbe and fausch 2000 leigh et al 2016 isolated riverine pools are a unique characteristic of non perennial streams when streamflow ceases and represent the transition from surface flow to riverbed desiccation in the absence of rainfall and groundwater contributions gallart et al 2017 riverine pools that persist provide critical refuges for freshwater species by facilitating their survival during extended dry periods bogan et al 2019 bond et al 2008 individuals that persist can then recolonise habitats when flows resume and play a key role in the long term population viability for many species arthington et al 2010 therefore understanding the persistence of riverine pools is critical for the conservation and management of freshwater biodiversity across river networks additionally some isolated pools are important water sources for humans and animals in arid regions bunn et al 2006 and have significant cultural aesthetic and recreational values finn and jackson 2011 a better understanding of pool persistence is useful for the management of these invaluable assets the persistence of a pool is determined by its water balance in the absence of rainfall a riverine pool may receive input from upstream surface or subsurface flows including groundwater discharge it loses water to evaporation transpiration by riparian vegetation and downstream surface and subsurface flow including infiltration to regional groundwater we need to understand how quickly pool water level recedes to predict the availability and persistence of aquatic refuge habitats however our understanding of the characteristics of pool water level recession during cease to flow periods is limited because 1 streamflow in non perennial streams and rivers is rarely gauged snelder et al 2013 2 traditional approaches to measuring streamflow e g flow gauging give little information on pool water level changes once flow ceases zimmer et al 2020 and 3 previous research mainly focused on surface water level change during streamflow recession periods tashie et al 2020 and groundwater level recession for major aquifers cuthbert 2014 while ignoring the period in between i e when surface flow ceases and hyporheic flow dominates amongst the limited number of studies that used water level measurement to investigate pool water balance e g montazeri and osti 2014 rau et al 2017 reported the qualitative characteristics of pool water level recession and related hydrograph shape along various parts of a stream reach to subsurface controls on groundwater redistribution they further observed that steady decreases in water level corresponded with groundwater movement away from the channel allowing the pools at the surface to dry cuthbert et al 2016 steady decreases are also visible in water table hydrographs presented in previous studies sensu costelloe et al 2007 shanafield and cook 2014 however none of these studies quantified spatial and temporal variations in pool water level recession during a cease to flow period water level changes in individual pools govern surface water availability in the river reach where these pools are located an understanding of pool surface water availability at the reach scale is important because river reaches and their associated sub catchments are usually the management unit that catchment managers use when making management prioritisation decisions such as for conservation management hermoso et al 2013 while surface water extent can be identified by methods including satellite imaging bishop taylor et al 2017 statistical modelling yu et al 2019 and on ground mapping moidu et al 2021 the application of these methods can be constrained due to a number of issues the application of satellite imaging is limited to wide river channels with little vegetation canopy statistical modelling often fails to reflect the continuous decrease of surface water extent within rivers in the absence of rainfall and on ground mapping is difficult to scale up to a large area alternatively temporal variations in surface water extent within a river reach may be quantified by first identifying the spatial arrangements and morphology of riverine pools with high resolution topographical data cavalli et al 2008 zimmermann et al 2008 and then applying appropriate rates of water level change to individual pools over time perry and bond 2009 the two steps were each carried out separately for different purposes in previous studies but their combination as a method to estimate temporal changes in surface water extent has never been applied partly due to our limited understanding of water level recession characteristics in isolated pools in this study we investigated the characteristics of surface water level recession based on one year of water level measurements in five pools within unpredictable non perennial streams sensu kennard et al 2010 we compared recession rates between flowing periods and cease to flow periods characterised water level recession properties in the pools during cease to flow periods and compared spatio temporal variations in recession rates between different cease to flow events and between nearby streams we also explored the applicability of the identified recession characteristics in estimating surface water extent in a non perennial stream with the new method i e a combination of the two steps this study helps to better understand the characteristics of water level recession in isolated pools and provides a critical foundation for future research and management decisions related to the ecological cultural aesthetic and recreational values of non perennial streams and rivers 2 methodology 2 1 characterising water level recession rates 2 1 1 pool water level monitoring to obtain water level data we continuously monitored five pools in gravel sand dominated non perennial streams in the upper bremer river catchment in eastern australia fig 1 this region is in a transitional temperate to subtropical climate with substantial inter annual and intra annual variation in discharge and has an average annual rainfall of 1063 mm yu et al 2019 rainfall and river discharge in this region are generally lowest from august to november and highest in january to march mackay et al 2014 the five study pools were located in different 2nd or 3rd order stream channels with catchment areas ranging from 5 79 to 45 3 km2 burrows et al 2017 and were named upper bremer river bremer coulson creek coulson reynolds creek reynolds warrill creek warrill and wild cattle creek wild cattle all five pools have gravel sand dominated substate with little clay two nearby stream gauges downstream on the bremer fig 1b observed an average zero flow period of 80 days 22 and 142 days 39 per year respectively the water level of the pools was recorded using pressure transducers level troll 500 non vented water level logger in situ ltd usa at 15 min intervals for a one year period from august 2015 to july 2016 the barometric pressure at each pool was also measured every 15 min with a separate logger baro troll in situ ltd usa to compensate depth records for changes due to local atmospheric pressure once compensated for atmospheric pressure the water pressure was converted to pool depth which was averaged to daily pool depth to remove diurnal fluctuations to help identify flowing and cease to flow periods surveillance cameras dtc 560 k faunatech australia were mounted on riparian trees facing the monitored pools and programmed to take a photo of each pool and its neighbouring streambed every two hours groundwater data was not available adjacent to the pools however shallow groundwater flow adjacent to the pools was noted during the field trips by manually digging into the stream sediments upstream downstream of the pools 2 1 2 recession rate estimation the cease to flow depth for each pool was identified by inspection of the photographic time series taken by the mounted cameras and field observations and was 0 35 m for bremer 0 21 m for coulson 0 46 m for reynolds 0 62 m for warrill and 0 66 m for wild cattle when pool water level was above its cease to flow depth we regarded surface water as flowing flowing period otherwise we regarded surface water as having ceased to flow cease to flow period we calculated daily water level recession rate as the difference of water levels between every two consecutive days in each falling limb of the monitored water level we compared the distribution of calculated recession rates for each pool between flowing and cease to flow periods and applied the wilcoxon test for the pool to evaluate whether their distribution difference was statistically significant at the level of 5 for each continuous falling limb of the monitored water level during a cease to flow period that was longer than five consecutive days we tried linear exponential and power law regression models for water level changes since the onset of the falling limb coefficient values of the best fit functions were calculated based on qr decomposition and conducted in the r software environment r core team 2020 preliminary results showed that overall linear models provided a better fit for the majority of recession periods although exponential and power law models performed slightly better than linear models for some recession periods table s1 so we used linear models in the subsequent analyses we set linear regression models to have an intercept of 0 on the y axis meaning the change in water level is 0 at the onset of the falling limb the slope of the regression model could thus be regarded as the average recession rate for the falling limb we conducted this analysis separately for multiple water level recession periods at each of the five pools if water level changes can be fitted with a linear regression model at the significant level of 5 this confirms that the recession rates of pool water level were constant during a falling limb we compared the estimated recession rates i e the regression slope values amongst different falling limbs within each pool to identify the temporal variations in recession rates we evaluated whether the recession rates were significantly different within and between the five sites using the welch s t test and the kruskal wallis h test respectively 2 2 estimating surface water extent the identified characteristics of pool water level recession rates in the upper bremer river catchment were tested in a 1 5 km long reach of kobble creek fig 1a another non perennial stream with similar gravel sand dominated substrate in the same hydro climatic region we aimed to evaluate whether constant water level recession rates occur in other non perennial streams and whether the calculated water level recession rates in the upper bremer river catchment are transferable to kobble creek to estimate surface water extent during cease to flow periods we applied a series of hypothetical water level recession rates with the minimum rate determined by observations in the upper bremer river catchment to all identified pools in the creek to estimate the remaining surface water extent the surface water extent denotes the proportion of the creek length that is covered by flowing or pool water if the pool water level did recede at a constant rate at kobble creek the estimated surface water extents in the creek under certain hypothetical recession rates should align well with that observed 2 2 1 surface water extent survey we measured surface water extent within the kobble creek study reach every two days between 9 and 21 february 2018 and took the last sampling on 22 february 2018 constituting a total of eight sampling occasions the survey began one day after a rainfall event that caused the creek to flow but on the first survey day the upstream part of the study reach had ceased to flow no rainfall occurred during the survey which was thus regarded as within one cease to flow period on each sampling occasion the survey team walked along the study reach and the same person made a waypoint with a hand held gps unit pollard garmin ltd usa at the beginning and end of each wet section i e flowing or pool presence within the reach with the survey data we estimated the creek surface water extent on each sample day 2 2 2 surface water extent estimation using constant recession rates we used high resolution 1 m dems to create longitudinal profile of the kobble creek study reach and identified a series of potential water pools and their morphological features i e cease to flow depth longitudinal pool length when streamflow ceases text s1 fig s1 the cease to flow depths of all identified pools ranged from 0 11 to 1 03 m median 0 22 m the longitudinal pool length ranged from 2 to 175 m median 4 m at the beginning of a cease to flow period all identified pools in the longitudinal profile were assumed to have remaining water up to the cease to flow depth fig s1 and the initial surface water extent was 94 we then applied a constant recession rate to draw down the water level of all identified pools at a daily time step to mimic the surface water shrinking process in non perennial streams after stream flow ceases we re calculated each pool length based on the updated water level on the next day we calculated the daily surface water extent of the study reach as the proportion of remaining pools length to the whole stream segment a pool becomes completely dry when the updated water level reaches its bottom this analysis was conducted using customised r scripts available from https doi org 10 5281 zenodo 5407598 we applied a series of constant recession rates ranging from 0 002 to 0 02 m d in an increment of 0 002 m d to estimate temporal changes in the surface water extent of the kobble creek study reach from 9 to 22 february 2018 we then compared the estimated surface water extent against that observed from field sampling to evaluate a whether other non perennial streams also have a constant cease to flow recession rate and b whether constant recession rates are transferrable to pools in nearby streams 3 results 3 1 difference in recession rates between flowing and cease to flow periods riverine pool water level changed over time increasing rapidly in response to rainfall and streamflow and receding in the absence of rainfall and streamflow fig 2 a during a flowing to cease to flow cycle water level recession rates tended to be high at the beginning of the flowing period and progressively decrease until streamflow ceases during the cease to flow period recession rates increased and became constantly higher than that during the low flow period until the pool became completely dry or streamflow resumed fig 2 the water level recession rates showed significant differences between the flowing and cease to flow periods for four of the five sites coulson w 2320 p 0 01 reynolds w 10 076 p 0 01 warrill w 7418 p 0 01 and wild cattle w 5574 p 0 01 fig 2b there was no significant difference in water level recession rates for the bremer river w 710 p 0 33 fig 2b 3 2 recession rates over cease to flow periods water levels of the five sites generally receded at a constant rate within a cease to flow period fig 3 although there was variability in recession rates within a cease to flow period e g warrill in fig 2 all fitted linear regression models for cease to flow periods across the five sites showed good performance with a minimum and median r2 value of 0 72 and 0 92 respectively lower r2 values occurred when the recession period was relatively short such as regression f at warrill fig 3 and regressions b and c at bremer fig s5 or when the water level receded at a slightly lower rate towards the end of a recession period however all linear models were statistically significant p 0 01 table 1 furthermore the recession rates varied over different cease to flow periods within the same pool for example at the warrill creek site water level recession rates were 0 013 m d and 0 058 m d during the b and e periods respectively fig 3 recession rates also differed significantly within each site and between the five sites h 14 49 p 0 01 with the warrill creek site showing the largest range from 0 013 to 0 058 m d fig 3 reynolds creek the least from 0 009 to 0 013 m d fig s2 and the other three sites in the middle figs s3 s5 3 3 estimating surface water extent using a constant recession rate the observed surface water extent at kobble creek progressively decreased from 85 to 16 over the period of 9 22 february 2018 figs 4 s6 the simulated surface water extent under a series of hypothetical constant water level recession rates from 0 002 to 0 02 m d all started from 94 but ended at between 8 recession rate 0 02 m d and 58 recession rate 0 002 m d they formed an envelope that covered much of the variation in observed surface water extent in particular the simulated surface water extent under recession rates between 0 010 and 0 014 m d reasonably captured the observed variation fig 4 4 discussion we showed that water level recession rates during cease to flow periods in non perennial streams were significantly different from that during streamflow periods for a given pool streamflow recession has been well studied in perennial streams and found to follow a predictable rate generally defined by a power law relationship relating streamflow decay to streamflow brutsaert and nieber 1977 the power law relationship suggests that during low flow periods the recession rate is very slow e g half flow periods of between 10 and 140 days nathan and mcmahon 1990 our study provides further insights into how the water level recedes during cease to flow periods and shows that the water level generally recedes at a constant rate that is higher than the recession rate during low flow periods it is also acknowledged that during some recession periods the pool water level at our study sites receded in a non linear e g exponential or power law manner the higher recession rate during cease to flow periods is probably because there was no surface flow supplying water to the pools while when rivers were flowing the pools would be replenished by surface flow the constant recession rates calculated for the five sites in this study ranging from 0 004 to 0 058 m d were comparable to those from previous studies table 2 our findings also highlight that water level recession rates can vary substantially amongst cease to flow periods within the same non perennial stream and between nearby streams for example in the warrill creek the recession rates varied by more than a factor of four across seven recession periods in a one year period while recession rates in reynolds creek pool varied by just over a factor of one over the same period while pool depth has been widely considered as a critical if not the only factor determining surface water persistence in the absence of rainfall cockayne 2021 costelloe and russell 2014 pool water losing mechanisms can be different from pool to pool for pools with a low permeability layer underneath perched surface water sensu bourke et al 2021 their connection to groundwater is limited and their water is primarily lost to evaporation from the pool and transpiration from riparian vegetation the occurrence and biological significance of such pools have been identified and well studied for rivers in inland australia bunn et al 2006 and their disconnection with groundwater were verified on the basis of pool hydrochemistry hamilton et al 2005 where shallow groundwater tables exist pools with highly permeable substrate are often connected with and supported by the water table in streambed sediments in the early stage of a cease to flow period through flow pools sensu bourke et al 2021 and thus are surface expressions of the water table evapotranspiration loss from these pools can be compensated by gains from the water reservoir in sediments bonada et al 2020 so that the water level recession in these pools is effectively controlled by the rate of groundwater redistribution in the subsurface rau et al 2017 the evapotranspiration estimate was approximately 5 mm per day in the upper bremer river catchment in the summer season based on awra l model simulations data available on http www bom gov au water landscape frost et al 2018 which is much less than the average recession rate of 23 mm per day across the five study sites the pool water levels during cease to flow periods declined sharply in most study streams and it is unlikely that such low rates of evapotranspiration quickly depleted the shallow groundwater therefore it is unlikely that evaporation alone is responsible for the recession rates observed in the studied pools which would suggest that the mechanism for pool occurrence at our sites is not simply surface water left over from streamflows that is disconnected from the groundwater although we cannot definitely determine the mechanism of pool occurrence for our study sites we hypothesize that the pools studied here are most likely through flow pools connected to and varying with the shallow alluvial aquifer beneath the streambed although it was not possible to measure groundwater levels at the study sites shallow groundwater flow adjacent to the pools was observed during field trips this shallow groundwater level would be expected to change over time and in space that is the sediment hydraulic properties largely control the aquifer response time cuthbert et al 2016 rau et al 2017 which explains how quickly mounded groundwater in the streambed could move away from the pools allowing their water levels to decline therefore the spatially and temporally varying recession rates in the five sites were likely due to heterogeneity within the streambed sediments flow events have been found to cause changes to the streambed sediments by scour and deposition as well as clogging hatch et al 2010 mccallum et al 2014 this helps explain the substantially varying water level recession rates during cease to flow periods within the same non perennial stream and between nearby streams further investigation into variation of local groundwater levels over space and time and characterisation of water chemistry would help to confirm the veracity of our hypothesis bourke et al 2021 previous research on water level recession found that the rate of groundwater decline should take an almost straight line form in early times of a recession period cuthbert 2014 importantly our research builds on this empirical understanding and indicates that the linearity of water level recession can start as early as the beginning of the hyporheic flow period when surface flow ceases with this information we are now able to draw a conceptual water level hydrograph throughout the full recession phase from the surface flow phase through the hyporheic flow phase to the groundwater recession phase fig 5 during the surface flow recession period water level recedes at a rate generally defined by a power law relationship relating streamflow decay to streamflow brutsaert and nieber 1977 and river channels are covered by surface runoff rau et al 2017 which often develop into pool riffle sequence during low flow periods through the hyporheic flow phase when surface flow ceases water level hydrograph in through flow pools takes a linear shape form with a constant recession rate when hyporheic flow ceases the bottom of through flow pools is usually above the water level pools thus dry rau et al 2017 and the groundwater recession phase begins and can be further divided into three sub phases linear phase transitional phase and exponential phase cuthbert 2014 during the groundwater recession linear phase water level hydrograph continues the linear shape but becomes convex downward into the transitional phase where the recession rate begins to decrease rapidly groundwater recession finally evolves to the exponential phase where water level hydrograph is further convex downward with recession rate decreased exponentially over time this study further tested the applicability of the new method i e a combination of identifying pool morphology in a river channel and then applying water level changes to each individual pool over time at kobble creek to estimate surface water extent at the reach scale in the test we applied a series of constant recession rates to draw down water level in isolated pools the test results not only confirmed that constant recession rate does apply to other intermittent streams but also supports the validity of the new method the application of the method requires accurate estimates of pool water level recession rate but it is currently challenging to obtain such estimates for riverine pools over a large spatial scale hindering the applicability of the method to ungauged streams we thus suggest future studies focus on calculation of pool water level recession rate such as considering the addition of shallow piezometers to monitor hydraulic head beneath the streambed for further information on hydraulic connection between surface and groundwater over time this study has established the precedent of constant recession in isolated pools connected to shallow groundwater therefore future work could use the beginning of the linear recession to estimate the cease to flow depth of the pools in estimating surface water extent at kobble creek two simplifications were made first all identified pools had the same water level recession rate and second all pools ceased to flow at the first cease to flow day these two simplifications were an unavoidable model simplification due to a lack of data to derive these coefficients according to field observations streamflow progressively ceased to flow from upstream to downstream in the 1 5 km section and it took around five days for the downstream pools became completely disconnected the phenomenon of progressive drying was also reported in other studies e g rau et al 2017 and if not accounted for as in this study has implications for estimating surface water extent since the downstream pools were still connected by streamflow at the early stage of a cease to flow period water level recession rates were slower at the bottom of the reach causing a slower reduction rate of overall surface water extent compared to the simulated this difference is well reflected in fig 4 whereby in the first few days the surface water extent was under estimated the effect of this simplification diminishes when the downstream pools became disconnected and the estimated and observed surface water extent displayed a similar reduction rate 5 conclusions this study characterises water level recession rates in isolated pools connected to shallow groundwater and confirms that water level recedes at a constant rate after streamflow ceases a rate usually significantly higher than the streamflow recession rate during low flow periods this study also outlines that there can be significant spatio temporal variation in water level recession rates amongst cease to flow periods and between nearby streams with the view of estimating reliable water level recession rates to predict the availability and persistence of aquatic refuge habitats our study calls for more research investigating hydraulic connection between surface and groundwater over time credit authorship contribution statement songyan yu conceptualization methodology formal analysis visualization writing original draft ryan m burrows conceptualization methodology data curation writing review editing margaret shanafield writing review editing mark j kennard conceptualization writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we thank boya zhang luke carpenter bundhoo dominic valdez clément nicoud and helena vogler for invaluable field assistance we also thank seqwater for providing the high resolution dems for the kobble creek funding for this project came from griffith university china scholarship council and the office of water science within the australian government department of the environment and energy finally we thank two anonymous reviewers and the editor for their helpful comments on the manuscript data statement both the water level monitoring data in the upper bremer river catchment and the observed surface water extent data in the kobble creek are archived at zenodo and available at https doi org 10 5281 zenodo 5407598 the high resolution dem data supporting the identification of the longitudinal profile of kobble creek are proprietary assets of the queensland government bulk water supply authority trading as seqwater australia and are not accessible to the public or research community people who intend to access the dem data may query seqwater via communications seqwater com au supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2022 104267 appendix supplementary materials image application 1 
129,persistent surface water pools within non perennial streams provide critical refuges for freshwater species by facilitating their survival during extended dry periods however our understanding of how pool water levels recede is limited hindering our ability to quantify and predict aquatic refuge persistence we characterise variations in water level recession rates based on one year of water level measurements in five non perennial streams most of the observations show that the water level recedes at a constant rate after streamflow ceases in our study streams a rate often significantly higher than that during low flow periods however water level recession rates varied considerably amongst cease to flow periods within pools in the same non perennial stream and between nearby streams the constancy of water level recession during a cease to flow period is applicable to other non perennial streams but a detailed understanding of the factors influencing recession rates is needed for prediction in ungauged streams and identifying persistent aquatic refuges across river networks keywords aquatic refuges flow intermittency sub surface flow resistance resilience eastern australia 1 introduction non perennial streams constitute more than half of the global river network acuña et al 2014 datry et al 2014 and play an essential role in maintaining biodiversity by providing habitats for multiple migratory and endemic species labbe and fausch 2000 leigh et al 2016 isolated riverine pools are a unique characteristic of non perennial streams when streamflow ceases and represent the transition from surface flow to riverbed desiccation in the absence of rainfall and groundwater contributions gallart et al 2017 riverine pools that persist provide critical refuges for freshwater species by facilitating their survival during extended dry periods bogan et al 2019 bond et al 2008 individuals that persist can then recolonise habitats when flows resume and play a key role in the long term population viability for many species arthington et al 2010 therefore understanding the persistence of riverine pools is critical for the conservation and management of freshwater biodiversity across river networks additionally some isolated pools are important water sources for humans and animals in arid regions bunn et al 2006 and have significant cultural aesthetic and recreational values finn and jackson 2011 a better understanding of pool persistence is useful for the management of these invaluable assets the persistence of a pool is determined by its water balance in the absence of rainfall a riverine pool may receive input from upstream surface or subsurface flows including groundwater discharge it loses water to evaporation transpiration by riparian vegetation and downstream surface and subsurface flow including infiltration to regional groundwater we need to understand how quickly pool water level recedes to predict the availability and persistence of aquatic refuge habitats however our understanding of the characteristics of pool water level recession during cease to flow periods is limited because 1 streamflow in non perennial streams and rivers is rarely gauged snelder et al 2013 2 traditional approaches to measuring streamflow e g flow gauging give little information on pool water level changes once flow ceases zimmer et al 2020 and 3 previous research mainly focused on surface water level change during streamflow recession periods tashie et al 2020 and groundwater level recession for major aquifers cuthbert 2014 while ignoring the period in between i e when surface flow ceases and hyporheic flow dominates amongst the limited number of studies that used water level measurement to investigate pool water balance e g montazeri and osti 2014 rau et al 2017 reported the qualitative characteristics of pool water level recession and related hydrograph shape along various parts of a stream reach to subsurface controls on groundwater redistribution they further observed that steady decreases in water level corresponded with groundwater movement away from the channel allowing the pools at the surface to dry cuthbert et al 2016 steady decreases are also visible in water table hydrographs presented in previous studies sensu costelloe et al 2007 shanafield and cook 2014 however none of these studies quantified spatial and temporal variations in pool water level recession during a cease to flow period water level changes in individual pools govern surface water availability in the river reach where these pools are located an understanding of pool surface water availability at the reach scale is important because river reaches and their associated sub catchments are usually the management unit that catchment managers use when making management prioritisation decisions such as for conservation management hermoso et al 2013 while surface water extent can be identified by methods including satellite imaging bishop taylor et al 2017 statistical modelling yu et al 2019 and on ground mapping moidu et al 2021 the application of these methods can be constrained due to a number of issues the application of satellite imaging is limited to wide river channels with little vegetation canopy statistical modelling often fails to reflect the continuous decrease of surface water extent within rivers in the absence of rainfall and on ground mapping is difficult to scale up to a large area alternatively temporal variations in surface water extent within a river reach may be quantified by first identifying the spatial arrangements and morphology of riverine pools with high resolution topographical data cavalli et al 2008 zimmermann et al 2008 and then applying appropriate rates of water level change to individual pools over time perry and bond 2009 the two steps were each carried out separately for different purposes in previous studies but their combination as a method to estimate temporal changes in surface water extent has never been applied partly due to our limited understanding of water level recession characteristics in isolated pools in this study we investigated the characteristics of surface water level recession based on one year of water level measurements in five pools within unpredictable non perennial streams sensu kennard et al 2010 we compared recession rates between flowing periods and cease to flow periods characterised water level recession properties in the pools during cease to flow periods and compared spatio temporal variations in recession rates between different cease to flow events and between nearby streams we also explored the applicability of the identified recession characteristics in estimating surface water extent in a non perennial stream with the new method i e a combination of the two steps this study helps to better understand the characteristics of water level recession in isolated pools and provides a critical foundation for future research and management decisions related to the ecological cultural aesthetic and recreational values of non perennial streams and rivers 2 methodology 2 1 characterising water level recession rates 2 1 1 pool water level monitoring to obtain water level data we continuously monitored five pools in gravel sand dominated non perennial streams in the upper bremer river catchment in eastern australia fig 1 this region is in a transitional temperate to subtropical climate with substantial inter annual and intra annual variation in discharge and has an average annual rainfall of 1063 mm yu et al 2019 rainfall and river discharge in this region are generally lowest from august to november and highest in january to march mackay et al 2014 the five study pools were located in different 2nd or 3rd order stream channels with catchment areas ranging from 5 79 to 45 3 km2 burrows et al 2017 and were named upper bremer river bremer coulson creek coulson reynolds creek reynolds warrill creek warrill and wild cattle creek wild cattle all five pools have gravel sand dominated substate with little clay two nearby stream gauges downstream on the bremer fig 1b observed an average zero flow period of 80 days 22 and 142 days 39 per year respectively the water level of the pools was recorded using pressure transducers level troll 500 non vented water level logger in situ ltd usa at 15 min intervals for a one year period from august 2015 to july 2016 the barometric pressure at each pool was also measured every 15 min with a separate logger baro troll in situ ltd usa to compensate depth records for changes due to local atmospheric pressure once compensated for atmospheric pressure the water pressure was converted to pool depth which was averaged to daily pool depth to remove diurnal fluctuations to help identify flowing and cease to flow periods surveillance cameras dtc 560 k faunatech australia were mounted on riparian trees facing the monitored pools and programmed to take a photo of each pool and its neighbouring streambed every two hours groundwater data was not available adjacent to the pools however shallow groundwater flow adjacent to the pools was noted during the field trips by manually digging into the stream sediments upstream downstream of the pools 2 1 2 recession rate estimation the cease to flow depth for each pool was identified by inspection of the photographic time series taken by the mounted cameras and field observations and was 0 35 m for bremer 0 21 m for coulson 0 46 m for reynolds 0 62 m for warrill and 0 66 m for wild cattle when pool water level was above its cease to flow depth we regarded surface water as flowing flowing period otherwise we regarded surface water as having ceased to flow cease to flow period we calculated daily water level recession rate as the difference of water levels between every two consecutive days in each falling limb of the monitored water level we compared the distribution of calculated recession rates for each pool between flowing and cease to flow periods and applied the wilcoxon test for the pool to evaluate whether their distribution difference was statistically significant at the level of 5 for each continuous falling limb of the monitored water level during a cease to flow period that was longer than five consecutive days we tried linear exponential and power law regression models for water level changes since the onset of the falling limb coefficient values of the best fit functions were calculated based on qr decomposition and conducted in the r software environment r core team 2020 preliminary results showed that overall linear models provided a better fit for the majority of recession periods although exponential and power law models performed slightly better than linear models for some recession periods table s1 so we used linear models in the subsequent analyses we set linear regression models to have an intercept of 0 on the y axis meaning the change in water level is 0 at the onset of the falling limb the slope of the regression model could thus be regarded as the average recession rate for the falling limb we conducted this analysis separately for multiple water level recession periods at each of the five pools if water level changes can be fitted with a linear regression model at the significant level of 5 this confirms that the recession rates of pool water level were constant during a falling limb we compared the estimated recession rates i e the regression slope values amongst different falling limbs within each pool to identify the temporal variations in recession rates we evaluated whether the recession rates were significantly different within and between the five sites using the welch s t test and the kruskal wallis h test respectively 2 2 estimating surface water extent the identified characteristics of pool water level recession rates in the upper bremer river catchment were tested in a 1 5 km long reach of kobble creek fig 1a another non perennial stream with similar gravel sand dominated substrate in the same hydro climatic region we aimed to evaluate whether constant water level recession rates occur in other non perennial streams and whether the calculated water level recession rates in the upper bremer river catchment are transferable to kobble creek to estimate surface water extent during cease to flow periods we applied a series of hypothetical water level recession rates with the minimum rate determined by observations in the upper bremer river catchment to all identified pools in the creek to estimate the remaining surface water extent the surface water extent denotes the proportion of the creek length that is covered by flowing or pool water if the pool water level did recede at a constant rate at kobble creek the estimated surface water extents in the creek under certain hypothetical recession rates should align well with that observed 2 2 1 surface water extent survey we measured surface water extent within the kobble creek study reach every two days between 9 and 21 february 2018 and took the last sampling on 22 february 2018 constituting a total of eight sampling occasions the survey began one day after a rainfall event that caused the creek to flow but on the first survey day the upstream part of the study reach had ceased to flow no rainfall occurred during the survey which was thus regarded as within one cease to flow period on each sampling occasion the survey team walked along the study reach and the same person made a waypoint with a hand held gps unit pollard garmin ltd usa at the beginning and end of each wet section i e flowing or pool presence within the reach with the survey data we estimated the creek surface water extent on each sample day 2 2 2 surface water extent estimation using constant recession rates we used high resolution 1 m dems to create longitudinal profile of the kobble creek study reach and identified a series of potential water pools and their morphological features i e cease to flow depth longitudinal pool length when streamflow ceases text s1 fig s1 the cease to flow depths of all identified pools ranged from 0 11 to 1 03 m median 0 22 m the longitudinal pool length ranged from 2 to 175 m median 4 m at the beginning of a cease to flow period all identified pools in the longitudinal profile were assumed to have remaining water up to the cease to flow depth fig s1 and the initial surface water extent was 94 we then applied a constant recession rate to draw down the water level of all identified pools at a daily time step to mimic the surface water shrinking process in non perennial streams after stream flow ceases we re calculated each pool length based on the updated water level on the next day we calculated the daily surface water extent of the study reach as the proportion of remaining pools length to the whole stream segment a pool becomes completely dry when the updated water level reaches its bottom this analysis was conducted using customised r scripts available from https doi org 10 5281 zenodo 5407598 we applied a series of constant recession rates ranging from 0 002 to 0 02 m d in an increment of 0 002 m d to estimate temporal changes in the surface water extent of the kobble creek study reach from 9 to 22 february 2018 we then compared the estimated surface water extent against that observed from field sampling to evaluate a whether other non perennial streams also have a constant cease to flow recession rate and b whether constant recession rates are transferrable to pools in nearby streams 3 results 3 1 difference in recession rates between flowing and cease to flow periods riverine pool water level changed over time increasing rapidly in response to rainfall and streamflow and receding in the absence of rainfall and streamflow fig 2 a during a flowing to cease to flow cycle water level recession rates tended to be high at the beginning of the flowing period and progressively decrease until streamflow ceases during the cease to flow period recession rates increased and became constantly higher than that during the low flow period until the pool became completely dry or streamflow resumed fig 2 the water level recession rates showed significant differences between the flowing and cease to flow periods for four of the five sites coulson w 2320 p 0 01 reynolds w 10 076 p 0 01 warrill w 7418 p 0 01 and wild cattle w 5574 p 0 01 fig 2b there was no significant difference in water level recession rates for the bremer river w 710 p 0 33 fig 2b 3 2 recession rates over cease to flow periods water levels of the five sites generally receded at a constant rate within a cease to flow period fig 3 although there was variability in recession rates within a cease to flow period e g warrill in fig 2 all fitted linear regression models for cease to flow periods across the five sites showed good performance with a minimum and median r2 value of 0 72 and 0 92 respectively lower r2 values occurred when the recession period was relatively short such as regression f at warrill fig 3 and regressions b and c at bremer fig s5 or when the water level receded at a slightly lower rate towards the end of a recession period however all linear models were statistically significant p 0 01 table 1 furthermore the recession rates varied over different cease to flow periods within the same pool for example at the warrill creek site water level recession rates were 0 013 m d and 0 058 m d during the b and e periods respectively fig 3 recession rates also differed significantly within each site and between the five sites h 14 49 p 0 01 with the warrill creek site showing the largest range from 0 013 to 0 058 m d fig 3 reynolds creek the least from 0 009 to 0 013 m d fig s2 and the other three sites in the middle figs s3 s5 3 3 estimating surface water extent using a constant recession rate the observed surface water extent at kobble creek progressively decreased from 85 to 16 over the period of 9 22 february 2018 figs 4 s6 the simulated surface water extent under a series of hypothetical constant water level recession rates from 0 002 to 0 02 m d all started from 94 but ended at between 8 recession rate 0 02 m d and 58 recession rate 0 002 m d they formed an envelope that covered much of the variation in observed surface water extent in particular the simulated surface water extent under recession rates between 0 010 and 0 014 m d reasonably captured the observed variation fig 4 4 discussion we showed that water level recession rates during cease to flow periods in non perennial streams were significantly different from that during streamflow periods for a given pool streamflow recession has been well studied in perennial streams and found to follow a predictable rate generally defined by a power law relationship relating streamflow decay to streamflow brutsaert and nieber 1977 the power law relationship suggests that during low flow periods the recession rate is very slow e g half flow periods of between 10 and 140 days nathan and mcmahon 1990 our study provides further insights into how the water level recedes during cease to flow periods and shows that the water level generally recedes at a constant rate that is higher than the recession rate during low flow periods it is also acknowledged that during some recession periods the pool water level at our study sites receded in a non linear e g exponential or power law manner the higher recession rate during cease to flow periods is probably because there was no surface flow supplying water to the pools while when rivers were flowing the pools would be replenished by surface flow the constant recession rates calculated for the five sites in this study ranging from 0 004 to 0 058 m d were comparable to those from previous studies table 2 our findings also highlight that water level recession rates can vary substantially amongst cease to flow periods within the same non perennial stream and between nearby streams for example in the warrill creek the recession rates varied by more than a factor of four across seven recession periods in a one year period while recession rates in reynolds creek pool varied by just over a factor of one over the same period while pool depth has been widely considered as a critical if not the only factor determining surface water persistence in the absence of rainfall cockayne 2021 costelloe and russell 2014 pool water losing mechanisms can be different from pool to pool for pools with a low permeability layer underneath perched surface water sensu bourke et al 2021 their connection to groundwater is limited and their water is primarily lost to evaporation from the pool and transpiration from riparian vegetation the occurrence and biological significance of such pools have been identified and well studied for rivers in inland australia bunn et al 2006 and their disconnection with groundwater were verified on the basis of pool hydrochemistry hamilton et al 2005 where shallow groundwater tables exist pools with highly permeable substrate are often connected with and supported by the water table in streambed sediments in the early stage of a cease to flow period through flow pools sensu bourke et al 2021 and thus are surface expressions of the water table evapotranspiration loss from these pools can be compensated by gains from the water reservoir in sediments bonada et al 2020 so that the water level recession in these pools is effectively controlled by the rate of groundwater redistribution in the subsurface rau et al 2017 the evapotranspiration estimate was approximately 5 mm per day in the upper bremer river catchment in the summer season based on awra l model simulations data available on http www bom gov au water landscape frost et al 2018 which is much less than the average recession rate of 23 mm per day across the five study sites the pool water levels during cease to flow periods declined sharply in most study streams and it is unlikely that such low rates of evapotranspiration quickly depleted the shallow groundwater therefore it is unlikely that evaporation alone is responsible for the recession rates observed in the studied pools which would suggest that the mechanism for pool occurrence at our sites is not simply surface water left over from streamflows that is disconnected from the groundwater although we cannot definitely determine the mechanism of pool occurrence for our study sites we hypothesize that the pools studied here are most likely through flow pools connected to and varying with the shallow alluvial aquifer beneath the streambed although it was not possible to measure groundwater levels at the study sites shallow groundwater flow adjacent to the pools was observed during field trips this shallow groundwater level would be expected to change over time and in space that is the sediment hydraulic properties largely control the aquifer response time cuthbert et al 2016 rau et al 2017 which explains how quickly mounded groundwater in the streambed could move away from the pools allowing their water levels to decline therefore the spatially and temporally varying recession rates in the five sites were likely due to heterogeneity within the streambed sediments flow events have been found to cause changes to the streambed sediments by scour and deposition as well as clogging hatch et al 2010 mccallum et al 2014 this helps explain the substantially varying water level recession rates during cease to flow periods within the same non perennial stream and between nearby streams further investigation into variation of local groundwater levels over space and time and characterisation of water chemistry would help to confirm the veracity of our hypothesis bourke et al 2021 previous research on water level recession found that the rate of groundwater decline should take an almost straight line form in early times of a recession period cuthbert 2014 importantly our research builds on this empirical understanding and indicates that the linearity of water level recession can start as early as the beginning of the hyporheic flow period when surface flow ceases with this information we are now able to draw a conceptual water level hydrograph throughout the full recession phase from the surface flow phase through the hyporheic flow phase to the groundwater recession phase fig 5 during the surface flow recession period water level recedes at a rate generally defined by a power law relationship relating streamflow decay to streamflow brutsaert and nieber 1977 and river channels are covered by surface runoff rau et al 2017 which often develop into pool riffle sequence during low flow periods through the hyporheic flow phase when surface flow ceases water level hydrograph in through flow pools takes a linear shape form with a constant recession rate when hyporheic flow ceases the bottom of through flow pools is usually above the water level pools thus dry rau et al 2017 and the groundwater recession phase begins and can be further divided into three sub phases linear phase transitional phase and exponential phase cuthbert 2014 during the groundwater recession linear phase water level hydrograph continues the linear shape but becomes convex downward into the transitional phase where the recession rate begins to decrease rapidly groundwater recession finally evolves to the exponential phase where water level hydrograph is further convex downward with recession rate decreased exponentially over time this study further tested the applicability of the new method i e a combination of identifying pool morphology in a river channel and then applying water level changes to each individual pool over time at kobble creek to estimate surface water extent at the reach scale in the test we applied a series of constant recession rates to draw down water level in isolated pools the test results not only confirmed that constant recession rate does apply to other intermittent streams but also supports the validity of the new method the application of the method requires accurate estimates of pool water level recession rate but it is currently challenging to obtain such estimates for riverine pools over a large spatial scale hindering the applicability of the method to ungauged streams we thus suggest future studies focus on calculation of pool water level recession rate such as considering the addition of shallow piezometers to monitor hydraulic head beneath the streambed for further information on hydraulic connection between surface and groundwater over time this study has established the precedent of constant recession in isolated pools connected to shallow groundwater therefore future work could use the beginning of the linear recession to estimate the cease to flow depth of the pools in estimating surface water extent at kobble creek two simplifications were made first all identified pools had the same water level recession rate and second all pools ceased to flow at the first cease to flow day these two simplifications were an unavoidable model simplification due to a lack of data to derive these coefficients according to field observations streamflow progressively ceased to flow from upstream to downstream in the 1 5 km section and it took around five days for the downstream pools became completely disconnected the phenomenon of progressive drying was also reported in other studies e g rau et al 2017 and if not accounted for as in this study has implications for estimating surface water extent since the downstream pools were still connected by streamflow at the early stage of a cease to flow period water level recession rates were slower at the bottom of the reach causing a slower reduction rate of overall surface water extent compared to the simulated this difference is well reflected in fig 4 whereby in the first few days the surface water extent was under estimated the effect of this simplification diminishes when the downstream pools became disconnected and the estimated and observed surface water extent displayed a similar reduction rate 5 conclusions this study characterises water level recession rates in isolated pools connected to shallow groundwater and confirms that water level recedes at a constant rate after streamflow ceases a rate usually significantly higher than the streamflow recession rate during low flow periods this study also outlines that there can be significant spatio temporal variation in water level recession rates amongst cease to flow periods and between nearby streams with the view of estimating reliable water level recession rates to predict the availability and persistence of aquatic refuge habitats our study calls for more research investigating hydraulic connection between surface and groundwater over time credit authorship contribution statement songyan yu conceptualization methodology formal analysis visualization writing original draft ryan m burrows conceptualization methodology data curation writing review editing margaret shanafield writing review editing mark j kennard conceptualization writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we thank boya zhang luke carpenter bundhoo dominic valdez clément nicoud and helena vogler for invaluable field assistance we also thank seqwater for providing the high resolution dems for the kobble creek funding for this project came from griffith university china scholarship council and the office of water science within the australian government department of the environment and energy finally we thank two anonymous reviewers and the editor for their helpful comments on the manuscript data statement both the water level monitoring data in the upper bremer river catchment and the observed surface water extent data in the kobble creek are archived at zenodo and available at https doi org 10 5281 zenodo 5407598 the high resolution dem data supporting the identification of the longitudinal profile of kobble creek are proprietary assets of the queensland government bulk water supply authority trading as seqwater australia and are not accessible to the public or research community people who intend to access the dem data may query seqwater via communications seqwater com au supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2022 104267 appendix supplementary materials image application 1 
