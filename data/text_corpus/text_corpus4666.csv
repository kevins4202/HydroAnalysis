index,text
23330,this paper aims at deriving velocity potential for the regular wave passing through a concentric porous cylinder system which has an arbitrary smooth section the wave interaction with the structures for instance wave force on them and wave elevation are discussed with different sections and wave properties in this study the efficiency and accuracy of present method was validated by comparing with the semi analytical method of sbfem first then an experiment with a quasi ellipse caisson was also performed to demonstrate the effectiveness and practical potential of present method finally a surface piercing concentric cylindrical system which consists of an impermeable inner cylinder and a coaxial single layered perforated cylinder was investigated by using present method the analysis shows that the maximum wave force on the inner cylinder is reduced to some extent with a noncircular perforated cylinder around it compared with circular cases while the wave run up is enlarged by the uneven spacing between the boundaries with the increasing of the wave number keywords analytical solution diffraction wave porous cylinder system experiment 1 introduction water wave interaction with offshore structures has attracted considerable interest by the scientists and engineers to reduce the wave action and protect the structures various types of fixed and floating breakwaters are settled around the structure to against the harsh environmental conditions owing to the complex wave structure interactions the breakwater tends to significantly affect the hydrodynamic performance of the offshore structure including the wave diffraction transmission energy dissipation wave run up the earliest attempt was performed on a perforated wall caisson with a perforated front wall backed up by an impermeable wall constructed at naples italy jarlan 1961 summering from the engineering experience in design and construction of vertical breakwaters for harbor protection franco 1994 given a brief description of the major failures and lessons learned from practical engineering because of its effective reduction of wave force and wave run up on the structures many researches were carried out to investigate the wave interaction with porous structures like porous plates walls slotted walls perforated wall caisson type breakwaters such breakwaters summarized by xiao et al 2016 included perforated wall breakwaters jarlan 1961 spar buoy breakwater fences liang et al 2004 flexible porous membrane barriers suresh kumar et al 2007 truss breakwaters uzaki et al 2011 pneumatic floating breakwaters he et al 2012 mat shaped floating breakwaters loukogeorgaki et al 2012 submerged flat plate breakwaters lalli et al 2012 and so on various types of the breakwater make the theoretical analysis difficultly be derived in a general formulation for each case early theory study was derived by sollitt and cross 1972 to predict the wave reflection and transmission with a permeable breakwater the reflection coefficient introduced by sahoo et al 2000 was one of most important parameter for the efficiency of the breakwater for the single or multi chamber perforated caissons it found that reflection coefficient is grateful affected by the b l where b is the chamber width and l is the incident wavelength a rich literature on the effect of the b l indicated that it would vary a lot for different practical cases detail introduction on this topic can be found from the review of huang et al 2011 the cylindrical structure is free widely use in the offshore structures for instance offshore wind turbine oil platform and bridge foundation a semi empirical method called morison equation morison et al 1950 is widely used to calculate the inline wave force on the small structure in oscillatory flow for the diffraction problem with a large body maccamy and fuchs 1954 proposed a linear analytical solution of wave action around a bottom mounted cylinder which neglect the effect of the viscosity of the water interactions of water waves with a porous vertical cylinder or concentric porous cylinder system also have been an active research topic for years wang and ren 1994 performed a theoretical investigation of wave interaction with a concentric surface piercing two cylinder system where the exterior cylinder is porous and considered to be thin in thickness and the interior cylinder is impermeable later this method was extended by darwiche et al 1994 and williams and li 1998 to a similar two cylinder system case but with the outer cylinder being porous in the vicinity of free surface and impermeable at some distance below the water surface and further with the inner cylinder mounted on a storage tank respectively for the multi pile problem williams and li 2000 extended the work of linton and evans 1990 to the interaction of water waves with arrays of bottom mounted surface piercing circular cylinders chen et al 2011 revisited this topic by using the null field integral equation in conjunction with the addition theorem and the fourier series the near trapped phenomenon of multi pile was also discussed with the effect of porous cylinders and disorder of layout for the other wave cases zhong and wang 2006 presented the analytical solution on the solitary waves interacting with a surface piercing concentric porous cylinder system it showed that the hydrodynamic is much dependent on the annular spacing between the outer porous cylinder and inter solid cylinder mandal et al 2013 2015 investigated the hydroelastic analysis of a cylinder system which consists of a rigid cylinder and an outer flexible porous cylinder in water of finite depth the wave cases for the single layer and two layer fluid having a free surface and an interface were considered to evaluate the wave action a new semi analytical method recently namely scaled boundary finite element method sbfem which used to solve soil structure interaction problems wolf 2003 has been successfully induced to deal with the linear wave diffraction problem around a porous structures liu and lin 2013 liu et al 2012 meng and zou 2012 song and tao 2007 2009 tao et al 2009 it also showed that this method can deal efficiently with the diffraction problem around the bottom mounted cylinder with an arbitrary section song et al 2010 another method using the dual boundary element method dbem coupled with the dual reciprocity method drm was employed by chuang et al 2015 to investigate wave scattering by a concentric porous cylinder system which consists of a circular inner cylinder and semicircular porous outer cylinder mounted on a conical shoal liu et al 2016 performed a general method to solve the linear diffraction wave around a uniform bottom mounted cylinder with arbitrary smooth section by expanding the radius function into a fourier series this method can be extended for the concentric porous cylinder system with the boundaries are arbitrary smooth the formulation of the present method is showed in 2 the efficiency and accuracy of present method was validated by comparing with the semi analytical method of sbfem as shown in 3 further an experiment was performed with a quasi ellipse caisson to demonstrate the practicability of present method in this section then a cylindrical system which consist of a circular inner cylinder and a cosine type outer cylinder was further investigated in 4 with the effect of wave attack angle layout of the system wave number and porous parameter the major found of this study is shown in the last section 2 mathematic model fig 1 shows the diagram of the water wave interaction with a concentric porous cylinder system for the two coordinate systems the x y or r θ planes are all set at the still water level swl and the origin is inside the cross section of the cylinder the z axis is perpendicular to the swl and positive upward the whole fluid domain is divided into several subdomains ω j j 1 2 n with the boundary of γ j j 1 2 n 1 the boundary which is considered to be thin in thickness is assumed to be arbitrary smooth and porous for convenience the interior subdomain of boundary γ j is named as ω j and the exterior subdomain of boundary γ j is named as ω j 1 in following analysis the cylinder is exposed to the plane wave with a frequency ω wave amplitude a and water depth h as mentioned above the radius function for the cross section can be expanded into the fourier series based on the assumption of the smooth cylinder surface therefore the radius function r j θ of the boundary γ i in the polar coordinate can be written as 1 r j θ n r b j n r e i n r θ j 1 2 n 1 where n r z b j n r is the fourier coefficients of r j θ and n is the number of subdomain then a surface function s j can be defined by 2 s j r θ d i s r n r b j n r e i n r θ j 1 2 n 1 in which d i s is the distance between s j and γ j in the radial direction as shown in fig 2 it indicates that boundary γ j can be represented by surface function s j as the value of d i s coming to zero the fluid is assumed to be inviscid and incompressible and the flow to be irrotational the velocity potential of the fluid in each subdomain satisfy laplace s equation and the corresponding boundary conditions herein the governing equation and boundary conditions for the velocity potential φ j in domain ω j is summarized as follows laplace s equation 3 2 φ j 0 j 1 2 n where r e r 1 r θ e θ z e z free surface condition z 0 k a 1 4 g φ j z 2 φ j t 2 0 j 1 2 n where g is the gravity acceleration seabed condition z h 5 φ j z 0 j 1 2 n surface condition on s j 0 6 γ j φ j n j φ j 1 n j w j r θ z t j 1 2 n 1 where n j is the normal vector on the surface γ j as shown in fig 1 w j r θ z t is the normal velocity of the fluid passing through the porous cylinder from region ω j 1 to region ω j chwang 1983 taylor 1956 w j r θ z t has the form of 7 w j θ z t γ j p j 1 p j ρ δ j ω f j i s j j 1 2 n 1 where f j is the linear porous resistance coefficient s j is the inertia coefficient γ j and δ j are the porosity and thickness for boundary γ j the hydrodynamic pressures p j r θ z t j 1 2 n related to the velocity potentials through the linearized bernoulli equation is 8 p j ρ φ j t j 1 2 n 1 substituting eq 8 into eq 7 it can obtain 9 w j r θ z t i k g j φ j 1 φ j j 1 2 n 1 where g j which is defined as g j γ j k δ j f j i s j yu 1995 denotes the porous effect parameter of boundary γ j ρ is the fluid density k and is the wave number of incident wave here we assume that g j 0 j 2 n 1 while the g 1 can be zero or positive according to eq 9 then the surface boundary shown by eq 6 can be rewritten as 10 γ j φ j n j φ j 1 n j i k g j φ j φ j 1 j 1 2 n 1 the total velocity potential in domain ω j can written into the summation of two parts of velocity potential φ j i and φ j d it is 11 φ j φ j i φ j d ϕ j i ϕ j d f z e i ω t j 1 2 n where 12 φ j i ϕ j i f z e i ω t φ j d ϕ j d f z e i ω t f z i g a ω cosh k z h cosh k h based on the previous study of wang and ren 1994 a general form for the ϕ j i and ϕ j d in domain ω j can be given by 13 ϕ j d r θ m a j m h m k r e i m θ j 1 2 n 14 ϕ j i r θ m b j m j m k r e i m θ j 1 2 n where a j m and b j m are the coefficients to be determined later j m and h m are the first kind of bessel function and first kind of hankel function respectively with the order of m in the fluid region of ω 1 the coefficient of a 1 m is set to the zero owing to the singularity of h m 0 in the fluid region of ω n the coefficient of b n m have the value of e i m π 2 β obtained from the incident wave which has an angle of β between the wave propagating direction and x axis as shown in fig 2 so the form ϕ n i r θ in domain ω n can be expressed as 15 ϕ n i r θ m j m k r e i m π 2 β e i m θ due to the character of hankel function the diffraction wave velocity potential φ n d in the outermost subdomain with the form of eq 14 also satisfied the sommerfeld radiation condition at the far field 16 lim r r φ n d r i k φ n d 0 on the boundary surface of γ j s j 0 the normal unit vector n j is 17 n j 1 1 1 r s j θ 2 1 1 r s j θ 0 j 1 2 n 1 where 18 s j θ n r i n r b j n r e i n r θ substituting eqs 9 11 and 16 into eq 6 surface condition on γ j turns into 19 ϕ j i ϕ j s r 1 r 2 s j θ ϕ j i ϕ j d θ ϕ j 1 i ϕ j 1 d r 1 r 2 s j θ ϕ j 1 i ϕ j 1 d θ i k g j ϕ j i ϕ j d ϕ j 1 i ϕ j 1 d to simplify the process of derivation the square of r j is also written as 20 r j 2 n r d j n r e i n r θ where d j n r is the fourier coefficients to determine the unknown coefficients shown in eqs 13 and 14 the hankel function bessel function and modified bessel functions and their derivation are also expanded into a fourier series with s j 0 as follows 21 h m k r j s j 0 q r h j m q r e i q r θ h m k r j s j 0 q r h j m q r e i q r θ 22 j m k r j s j 0 q r f j m q r e i q r θ j m k r j s j 0 q r f j m q r e i q r θ where f j m q r f j m q r h j m q r and h j m q r are the fourier coefficients and q r z the fourier coefficients shown in eqs 1 and 20 22 can be got from 23 ℜ n 1 2 π π π ψ θ e i n θ d θ where ℜ n is the coefficient of e i n θ for function of ψ θ to be expanded from the eqs 20 22 the surface condition shown in eq 19 can be easily derived as 24 m n r q r f j m q r n r b j n r m f j m q r d j n r k i k g j d j n r f j m q r b j m h j m q r n r b j n r m h j m q r d j n r k i k g j d j n r h j m q r a j m e i m n r q r θ m n r q r i k g j d j n r f j m q r b j 1 m i k g j d j n r h j m q r a j 1 m e i m n r q r θ 25 m n r q r i k g j d j n r f j m q r b j m i k g j d j n r h j m q r a j m e i m n r q r θ m n r q r f j m q r n r b j n r m f j m q r d j n r k i k g j d j n r f j m q r b j 1 m h j m q r n r b j n r m h j m q r d j n r k i k g j d j n r h j m q r a j 1 m e i m n r q r θ to solve these linear equations we need to truncate the fourier order m q r and n r with special numbers of m n q and n r in addition the total order of m which has the relation of m m n r q r was also truncated with the order of m therefore the scope for the order m is 26 m m 1 0 1 m then the eqs 24 and 25 can be rewritten into a linear system equation with the unknown coefficients a j m and b j m they are 27 l j b j m b j 0 b j m a j m a j 0 a j m e i m θ l j 1 b j 1 m b j 1 0 b j 1 m a j 1 m a j 1 0 a j 1 m e i m θ 28 l j b j m b j 0 b j m a j m a j 0 a j m e i m θ l j 1 b j 1 m b j 1 0 b j 1 m a j 1 m a j 1 0 a j 1 m e i m θ where l j and l j are the linear function of a j m and b j m the matrix form of eq 27 and eq 28 is 29 n j 1 c j 1 n j c j where n j 1 and n j are the coefficient matrix for the c j 1 and c j respectively the unknown coefficient matrix c j are 30 c j b j a j t 31 b j b j m b j 0 b j m t a j a j m a j 0 a j m t two cases are shown in the following formulation depending on whether value of g 1 are equal to zero or positive case 1 if g 1 0 the inverse matrix of n j 1 is always exist the eq 29 can be in turn written as 32 c j 1 π j c j in which π j is a translation matrix of matrix c j 1 and c j it can be obtained by 33 π j n j 1 1 n j from the eq 32 the connection of c n and c 1 is 34 c n π n 1 c n 1 π n 1 π n 2 π 1 c 1 π c 1 where π π n 1 π n 2 π 1 substituting eq 30 into eq 34 it can be rewritten as 35 b n a n π 11 π 12 π 21 π 22 b 1 a 1 where π 11 π 12 π 21 and π 22 are the sub matrix of π as matrix of b n and a 1 are already known from initial condition the matrix of b 1 and a n can be gained by 36 b 1 a n π 11 0 π 21 i 1 i π 12 0 π 22 b n a 1 finally the unknown matrix of c j j 2 3 n 1 can be calculated by using the relation of eq 32 and matrix of c 1 case 2 if g 1 0 the inverse matrix of n j 1 is always exist except n 2 and we have c 1 0 in this situation the connection of c n and c 2 is 37 c n π n 1 c n 1 π n 1 π n 2 π 2 c 2 π c 2 where π π n 1 π n 2 π 2 the eq 37 can be rewritten as 38 b n a n π 11 π 12 π 21 π 22 b 2 a 2 in which π 11 π 12 π 21 and π 22 are the sub matrix of π from the eqs 27 and 28 there has the relation on the boundary γ 1 as 39 n 2 c 2 n 11 n 12 n 21 n 22 b 2 a 2 0 in which n 11 n 12 n 21 and n 22 are the sub matrix of n 2 and we have n 11 n 12 0 then the relation between b 2 and a 2 can be obtained from eq 39 as 40 n 21 b 2 n 22 a 2 0 as matrix of b n is already known the matrix of b 2 a 2 and a n can be gained by using the eqs 38 and 40 it is 41 b 2 a 2 a n π 11 π 12 0 π 21 π 22 i n 21 n 22 0 1 i 0 0 b n then the unknown matrix of c j j 3 4 n 1 can be calculated by using the relation of eq 32 and matrix of c 2 once the coefficients of a j m and b j m are determined the velocity potential for all the domains can be given by means of eqs 13 and 14 the pressure can be obtained by using the eq 8 the wave force in the direction of n f which is the unit vector in the force direction can be given by 42 γ j f j 0 2 π s j 0 p j p j 1 n j n f d s d θ j 1 2 n 1 based on the derived velocity potentials the wave profiles in all subdomains are obtained from the linearized dynamic free surface boundary condition thus 43 ω j η j r θ t 1 g φ j t a ϕ j i ϕ j s e i ω t j 1 2 n in the following discussion the maximum dimensionless hydrodynamic force on the boundary γ i is defined as 44 f j f j a m ρ g a π b j 0 2 in which f j a m is the amplitude of f j b j 0 is the fourier coefficient of e i n θ n 0 for boundary γ j shown in the eq 1 the dimensionless wave run up on the boundary γ j can also be defined as 45 r e j max η j 1 r θ t s j 0 a j 1 2 n 1 46 r i j max η j r θ t s j 0 a j 1 2 n 1 in which r e j is dimensionless wave run up on the exterior side of boundary γ j and r i j is dimensionless wave run up on the interior side of boundary γ j 3 analytical results 3 1 convergence analysis as shown in eqs 24 and 25 the identifers m q r and n r are infinite and should be truncated at special numbers m n q and n r respectively in the solving process to give an example the system with two cylinders are shown in this section a form of radius function r j θ for the boundaries γ j used following can be given by 47 γ j r j θ a j 1 ε j cos m j θ φ j j 1 2 where a j ε j m j and φ j are constants to determine the geometry γ 1 represents inner cylinder and γ 2 represents outer cylinder an example is given in this section with the geometry parameters a 2 2 a 1 2 m m 1 m 2 1 ε 1 0 ε 2 0 2 φ 1 φ 2 π the wave propagates along the x axis with a wave number k 3 rad m the order of n r can be consequently set as 2 max m j by accurately considering the functions of r j θ and r j 2 θ to analyze the effect of truncated error of n q a relative error function is defined as follow 48 e ψ π π ψ θ q r n q n q ℜ q r e i q r θ 2 d θ π π ψ θ 2 d θ where ψ and ℜ q r are defined in eq 23 due to the limitation of space only the results of truncated error on γ 2 is given fig 3 illustrates the truncated error of h m k r h m k r j m k r and j m k r on this boundary as n q 4 m 2 4 it shows upward trends of truncated errors with the increase of m and h m k r shows larger truncated error than other three functions therefore the truncated error of h m k r should be small enough as the order m up to the max value m fig 4 shows the relation between the error function and n q with same geometry parameters with m 25 practical tries on several boundaries have found that the truncated errors can be neglected when e ψ is smaller than 5 table 1 shows the analytical results of wave force and wave run up on inner and outer cylinders versus different truncated order of m it can be clearly seen that the truncated order has less effect on the wave force which means the analytical results of wave force can convergent with a small value of m while the results of wave run up need a larger value and it in this case can be convergent when m 15 basing on above discussion and previous study of liu et al 2016 some rules can be summarized for choosing the truncated order of m n r and n q they are 1 the value of n r and n q are depended on the radius function of cross section 2 m should be determined by a convergence analysis it showed that the larger value of wave number k the larger truncated order of m is needed 3 2 validation by semi analytical method a concentric porous circular cylinder system consisting of two co axes vertical and surface piercing cylinders surrounded by a fluid of finite depth h is used to validate the present method three subdomains ω 1 ω 2 and ω 3 are divided by the circular boundaries γ 1 and γ 2 with the porous parameter of g 1 and g 2 respectively the radii for the circular boundaries γ 1 and γ 2 are a 1 and a 2 a monochromatic incident wave of small amplitude propagates in the direction of the positive x axis the wave force and wave run up on each boundary are considered in the following discussion fig 5 shows the comparative results of dimensionless wave force between present method and semi analytical method of sbfem tao et al 2009 the outer cylinder is porous with g 2 1 and the inner one is non porous with g 1 0 which means waves cannot flow into the interior of inner cylinder so this case can be solved by using the method of case 2 with initial boundary of b 1 the geometry parameters for the inner and outer circular cylinder are a 1 1 m and a 2 a 1 2 respectively the water depth used in the cases is h 15 m and wave exposure β 0 o is taken as its unit in the following discussion this figure shows that the dimensionless wave force in line x axis for the inner and outer cylinder of present method are coincide with those of sbfem fig 6 shows the comparative results of the max wave elevation at different location θ around cylinder between present method and the method provided by wang and ren 1994 the values for each parameter are a 1 2 m a 2 a 1 5 g 1 0 g 2 1 and h 15 m the wave effect parameter c w g ω 2 h 1 0 with the wave number k 0 08 rad m the results shows that the present method can give an accuracy solution for the wave run up 3 3 validation by experiment in this subsection an experiment test was performed at the wind tunnel and wave flume laboratory harbin institute of technology in china with a concentric cylinder system which consists of a quasi ellipse caisson and a perforated cylindrical wall the wave flume has a width of 5 m and a length of 50 m the water waves are generated by using a bottom hinged flap type wave maker installed at the one side of the flume the schematic of experiment model is shown in fig 7 both of the structure have an approximately elliptical section with a central rectangle and two external half circles detail geometry parameters shown in fig 7 for the cylinder system are shown in table 2 in this table s w and s p are the area for the wall and hole in a unit section δ is the thickness of the porous wall the regular wave generated by the wave maker propagated from the left to the right end with a water depth of 0 8 m seven different wave numbers with calibrated wave heights were tested on the model by two exposure β 0 and 90 respectively during the tests force balances were installed at the base of the model to measure the wave force and bending moment of the inner cylinder and outer cylinder respectively eight wave gauges were instrumented around the inner cylinder to measure the surface elevation around it at the same time twelve other wave gauges were also distributed around the outer cylinder to record the wave elevation in the wave flume as shown in fig 8 these signals were transferred to an ni pxi based data acquisition system to achieve synchronous collection of the test data at a sampling frequency of 200 hz the wave force on the inner and outer cylinder can be generally repeated between two different tests with the same wave parameters while for the wave run up around the inner cylinder it could be more sensitive to the initial condition of the water flume so the interval time between two tests is determined by the amplitude of surface elevation vibration when it is less than 1 mm a close up image of the test model is depicted in fig 8 the porosity γ 2 of the perforated wall is calculated by the area of s w and s p it is 49 γ 2 s p s w s p as waves passing through the thin porous wall they are accompanied by both energy dissipation and phase shift the wave energy dissipation due to the resistance effect of the porous wall is related to the real part of g 2 the phase shift due to the inertia effect of the wall is related the imaginary part of g 2 the porous effect parameter g 2 defined in eq 9 yu 1995 is 50 g 2 γ 2 k δ 2 f 2 i s 2 in which s 2 is related to the added mass coefficient c m and porosity γ 2 by 51 s 2 1 c m 1 γ 2 γ 2 as for the porous resistance coefficient f 2 li et al 2006 provided an empirical formula for the models 52 f 2 3338 7 δ 2 h 2 82 769 δ 2 h 8 711 in this study the value of δ 2 h is 0 00375 which is out of the applicable scope 0 0094 δ 2 h 0 05 of the eq 52 however as f 2 defined by this equation tends to be stable with the decrease of δ 2 h eq 52 can be used in this study to give a rough prediction of f 2 which equals to 8 97 for the presented model to investigate the effect of this parameter on the wave structure interaction the results of wave action with other three values f 2 8 f 2 10 and f 2 20 are also taken into consideration in the following analysis then the value of g 2 for the given perforated wall can be calculated from eq 50 with the known porous resistance coefficient f 2 and the inertial effect coefficient s 2 both of which can be obtained through eqs 51 and 52 however as the inertial effect of a thin porous plate is not significant a value of s 2 1 may be used safely for most practical problems li et al 2006 yu 1995 some authors even set s 2 to zero cho and kim 2000 chwang 1983 for the cases shown in this section there is less different between the analytical results with s 2 1 and s 2 0 so only the results s 2 1 is shown in the following the other parameters are m 30 n r 20 and n q 60 for the wave force a general increase of the dimensionless value was found from the measured data of the experiment with the increase of the wave steepness for both of the inner and outer cylinder fig 9 shows the comparative results of the wave force on the inner caisson and outer perforated cylinder with two kinds of wave exposures β 0 and 90 from the comparative results of f 2 8 f 2 8 97 and f 2 10 it is evidence that the resultant wave force on the inner structure is less sensitive to the value of f 2 especially for the case with a lower wave number it also suggests that the present method can give a reasonable results compared with the experimental results of wave force on the inner cylinder which can validates the effectiveness of the developed method for solving the linear wave diffraction problem with a complex cross section for the outer cylinder the difference between the experimental and analytical results obtained by f 2 8 97 is relatively large than that of the inner cylinder although the general tendency of the dimensionless wave force on it can be successfully predicted by the present method some reasons induced the difference such as the inhomogeneous porous for the perforated cylinder and wave breaking might prompt this phenomenon the comparative results also illustrate that a larger value of f 2 could achieve a better analytical result for the wave force on the outer cylinder however when the wave steepness becomes large a larger f 2 would be needed the comparative results of wave run up r ε around the inner caisson are shown in fig 10 which also shows an acceptable comparison between experimental tests and analytical solution unlike with the results of wave force the dimensionless wave run up shows no obvious tendency with the increase of wave steepness in summary the value of f 2 obtained from perforated wall tests can apply to the porous cylindrical system however it should be noted that the wave force on the perforated cylinder would be underestimated when the wave steepness is large 4 case study wave interaction with cosine type porous structures this section will deal with the plane waves interaction with a surface piercing concentric cylindrical system which consists of an impermeable inner circular cylinder and a coaxial single layered perforated cylinder in the following discussion eq 47 are also used to defined the boundary of the cylinders the parameter m 2 for the perforated cylinder is taken the value of 1 the values of water depth h is 5 m the detail value of geometry parameters can be found in the table 3 the truncated orders used in the section are m 25 n r 2 and n q 6 comparative results of total wave force on inner and outer cylinder is shown in fig 11 respectively with ε 2 0 2 g 2 1 and various value of β it illustrates that the maximum value of total wave force on the inner circular cylinder would occur with the value of k in the scope of 0 5 0 75 rad m and increase obviously with value of β from 0 o to 180 o as shown in fig 11 a after reaching the peak value the total wave force of inner cylinder experiences a general decrease trend with the increase of wave number for the wave force on outer cylinder the maximum values of these cases occur around with k 0 17 rad m and have slight different among them as shown in fig 11 b then they sees a sharply decrease until they reach their turning point on these points the value is almost to be zero for the circular case and are slight larger than zero for the non circular cases table 4 compares the maximum total wave force and corresponding wave number on the inner cylinder γ 1 and outer cylinder γ 2 versus different β the values of total wave force on inner cylinder are smaller than circular case as β 0 o and β 45 o and the corresponding wave number of them also slightly smaller than that of circular case for the other cases k max are equal to 0 57 rad m and f max is larger than the result of circular case by contrast the values of k max of outer cylinder with all β are equal to 0 17 rad m beside circular case and f max of noncircular cases are always larger that circular case comparative results of dimensionless wave run up with various β are shown in fig 12 the values of r i on the boundary of inner cylinder γ 1 are zero due to g 1 0 for the other values less regulation can be found from these figures due to the complex wave structure interaction however it can still indicate that the wave run up r i and r e on the boundary γ 1 and γ 2 have same value levels 1 2 with wave number in the scope of 0 3 rad m it also suggests that wave run up of non circular cases could be much larger than circular case in the range 2 3 rad m of wave number for different cases fig 13 presents two dimensional contour plots of the free surface elevation versus different values of β with k 3 0 rad m where yellow solid line represents the boundary of inner cylinder and green dash line represents boundary of outer cylinder it illustrates that free wave surface is symmetry along x axis with β 0 o and β 180 o due the symmetrical configuration of cylindrical system as shown in fig 13 a and e however it would lose the characters of symmetry with parameter of β 45 o β 90 o and β 135 o as shown in fig 13 b c and d and a more complex wave field can be found between the boundaries fig 14 shows the comparative results of total wave force on inner and outer cylinder with β 0 o g 2 1 and various value of ε 2 the circular case can be thought as the case of ε 2 0 reasonably this figure shows that the maximum value of total wave force has a general decrease trend of on inner cylinder and increase trend on outer cylinder with the increase of ε 2 respectively it also indicates that f on inner cylinder of non circular cases would be smaller than that of circular case in the scope of 0 1 rad m and larger in the scope of 2 3 rad m by contrast the total wave force f on outer cylinder of non circular cases shown an opposite regulation comparing with inner cylinder table 5 listed the maximum wave force f max on inner and outer cylinders and corresponding wave number k max it points that the wave number corresponding to maximum wave force on inner cylinder decrease with the increase of ε 2 and the maximum wave force is reduced by 13 with ε 2 0 3 however the values of k max are unchanged with different ε 2 and the value of f max is raised by 7 with ε 2 0 3 note e max have the relation of e max f ε max f c max f c max where f ε max and f c max are the maximum total wave force for non circular case and circular case respectively in fig 15 the wave run up r i and r e on the boundary γ 1 and γ 2 experienced by the concentric porous cylinder system with β 0 o are plotted versus the wave number k it is observed that the wave run up for the circular case with k in the scope of 0 1 5 rad m would larger than the results of non circular cases or approximate equal to them however as the k is in the range of 1 5 3 rad m the most of results for the non circular cases would larger than the results of circular case in fig 16 two dimensional contour plots of the free surface elevation are presented for different values of ε 2 with k 2 0 rad m from the color bar it is clear that a larger space ahead inner cylinder would cause a more complex wave field which sometimes could introduce a significant increase of wave run around cylinders fig 17 shows the total wave force on inner and outer cylinder with ε 2 0 2 and β 0 versus different porous parameter g 2 and wave number k it illustrated that the cases for different g 2 have a similar tendency various wave number k for both inner cylinder and outer cylinder furthermore the wave force on inner cylinder experienced a smaller wave force with the porous parameter of g 2 0 5 than other cases due to less wave energy pass through outer cylinder with the increase of g 2 the total wave force on inner cylinder would increase generally and that of outer cylinder show an opposite tendency two specific cases g 2 0 0 and g 2 are also shown in this figure to investigate the ultimate status of the wave force of the inner and outer cylinder the analysis results indicate that both of the wave force acting on the inner and outer cylinder are sensitive to a lower value of g 2 and convergence gradually to the green dot line as g 2 from the results shown in figs 11 14 and 17 we can find that at least one point exists in the results of the outer cylinder with k a 1 in the range of 0 3 which could lose the capacity of protection partly or entirely furthermore the analysis shows that the noncircular cross section would have more points like that in this range compared with the circular case as shown in fig 11 the wave numbers corresponding to these points are not only dependent on the ratio between wavelength and the gap between the boundaries but also on the shape of the cross section this issue will be further investigated in the future 5 conclusion this paper presented an analytical method for a concentric porous cylinder system with arbitrary smooth cross section by expanding the bessel functions and radius function into fourier series the unknown coefficients of velocity potential can be successfully solved by using the surface boundary of cylinders the truncated errors introduced by the present method were analyzed and the accuracy of this method was compared with the results of sfbem and experimental tests furthermore the analytical results with several types of cross section were given by compared with the circular cases the conclusion of this study can be summarized as following 1 present method based on the potential theory can successfully deal with the problem of wave action on a concentric porous cylinder system whose cross sections are arbitrary and smooth the introduced truncated error can be vanished by increasing the truncated order of m n r and n q in the solving process to obtain convergence results of wave run up larger truncated orders are needed compared with that of wave force on the structures 2 the experimental results demonstrated that the present method could achieve a good prediction of the wave force on the inner caisson and obtain acceptable results of wave force on the outer porous cylinder and of wave run up through adjusting the value of f 2 it also indicated that the empirical formulae of f 2 obtained from flat wall tests can provide a rough prediction 3 perforated cylinder with noncircular section could reduce the maximum dimensionless wave force on inner cylinder in some situations which has a larger annular spacing at upstream and smaller annular spacing at downstream between the inner and outer cylinders however the wave run up or amplitude of free surface could be enlarged because of the non symmetry character or large annular spacing of the concentric porous cylinder system especially for the large wave number cases acknowledgement financial support from the national natural science foundation of china 51725801 is greatly appreciated by the authors the authors also express the sincere thanks to graham macky for his useful comments 
23330,this paper aims at deriving velocity potential for the regular wave passing through a concentric porous cylinder system which has an arbitrary smooth section the wave interaction with the structures for instance wave force on them and wave elevation are discussed with different sections and wave properties in this study the efficiency and accuracy of present method was validated by comparing with the semi analytical method of sbfem first then an experiment with a quasi ellipse caisson was also performed to demonstrate the effectiveness and practical potential of present method finally a surface piercing concentric cylindrical system which consists of an impermeable inner cylinder and a coaxial single layered perforated cylinder was investigated by using present method the analysis shows that the maximum wave force on the inner cylinder is reduced to some extent with a noncircular perforated cylinder around it compared with circular cases while the wave run up is enlarged by the uneven spacing between the boundaries with the increasing of the wave number keywords analytical solution diffraction wave porous cylinder system experiment 1 introduction water wave interaction with offshore structures has attracted considerable interest by the scientists and engineers to reduce the wave action and protect the structures various types of fixed and floating breakwaters are settled around the structure to against the harsh environmental conditions owing to the complex wave structure interactions the breakwater tends to significantly affect the hydrodynamic performance of the offshore structure including the wave diffraction transmission energy dissipation wave run up the earliest attempt was performed on a perforated wall caisson with a perforated front wall backed up by an impermeable wall constructed at naples italy jarlan 1961 summering from the engineering experience in design and construction of vertical breakwaters for harbor protection franco 1994 given a brief description of the major failures and lessons learned from practical engineering because of its effective reduction of wave force and wave run up on the structures many researches were carried out to investigate the wave interaction with porous structures like porous plates walls slotted walls perforated wall caisson type breakwaters such breakwaters summarized by xiao et al 2016 included perforated wall breakwaters jarlan 1961 spar buoy breakwater fences liang et al 2004 flexible porous membrane barriers suresh kumar et al 2007 truss breakwaters uzaki et al 2011 pneumatic floating breakwaters he et al 2012 mat shaped floating breakwaters loukogeorgaki et al 2012 submerged flat plate breakwaters lalli et al 2012 and so on various types of the breakwater make the theoretical analysis difficultly be derived in a general formulation for each case early theory study was derived by sollitt and cross 1972 to predict the wave reflection and transmission with a permeable breakwater the reflection coefficient introduced by sahoo et al 2000 was one of most important parameter for the efficiency of the breakwater for the single or multi chamber perforated caissons it found that reflection coefficient is grateful affected by the b l where b is the chamber width and l is the incident wavelength a rich literature on the effect of the b l indicated that it would vary a lot for different practical cases detail introduction on this topic can be found from the review of huang et al 2011 the cylindrical structure is free widely use in the offshore structures for instance offshore wind turbine oil platform and bridge foundation a semi empirical method called morison equation morison et al 1950 is widely used to calculate the inline wave force on the small structure in oscillatory flow for the diffraction problem with a large body maccamy and fuchs 1954 proposed a linear analytical solution of wave action around a bottom mounted cylinder which neglect the effect of the viscosity of the water interactions of water waves with a porous vertical cylinder or concentric porous cylinder system also have been an active research topic for years wang and ren 1994 performed a theoretical investigation of wave interaction with a concentric surface piercing two cylinder system where the exterior cylinder is porous and considered to be thin in thickness and the interior cylinder is impermeable later this method was extended by darwiche et al 1994 and williams and li 1998 to a similar two cylinder system case but with the outer cylinder being porous in the vicinity of free surface and impermeable at some distance below the water surface and further with the inner cylinder mounted on a storage tank respectively for the multi pile problem williams and li 2000 extended the work of linton and evans 1990 to the interaction of water waves with arrays of bottom mounted surface piercing circular cylinders chen et al 2011 revisited this topic by using the null field integral equation in conjunction with the addition theorem and the fourier series the near trapped phenomenon of multi pile was also discussed with the effect of porous cylinders and disorder of layout for the other wave cases zhong and wang 2006 presented the analytical solution on the solitary waves interacting with a surface piercing concentric porous cylinder system it showed that the hydrodynamic is much dependent on the annular spacing between the outer porous cylinder and inter solid cylinder mandal et al 2013 2015 investigated the hydroelastic analysis of a cylinder system which consists of a rigid cylinder and an outer flexible porous cylinder in water of finite depth the wave cases for the single layer and two layer fluid having a free surface and an interface were considered to evaluate the wave action a new semi analytical method recently namely scaled boundary finite element method sbfem which used to solve soil structure interaction problems wolf 2003 has been successfully induced to deal with the linear wave diffraction problem around a porous structures liu and lin 2013 liu et al 2012 meng and zou 2012 song and tao 2007 2009 tao et al 2009 it also showed that this method can deal efficiently with the diffraction problem around the bottom mounted cylinder with an arbitrary section song et al 2010 another method using the dual boundary element method dbem coupled with the dual reciprocity method drm was employed by chuang et al 2015 to investigate wave scattering by a concentric porous cylinder system which consists of a circular inner cylinder and semicircular porous outer cylinder mounted on a conical shoal liu et al 2016 performed a general method to solve the linear diffraction wave around a uniform bottom mounted cylinder with arbitrary smooth section by expanding the radius function into a fourier series this method can be extended for the concentric porous cylinder system with the boundaries are arbitrary smooth the formulation of the present method is showed in 2 the efficiency and accuracy of present method was validated by comparing with the semi analytical method of sbfem as shown in 3 further an experiment was performed with a quasi ellipse caisson to demonstrate the practicability of present method in this section then a cylindrical system which consist of a circular inner cylinder and a cosine type outer cylinder was further investigated in 4 with the effect of wave attack angle layout of the system wave number and porous parameter the major found of this study is shown in the last section 2 mathematic model fig 1 shows the diagram of the water wave interaction with a concentric porous cylinder system for the two coordinate systems the x y or r θ planes are all set at the still water level swl and the origin is inside the cross section of the cylinder the z axis is perpendicular to the swl and positive upward the whole fluid domain is divided into several subdomains ω j j 1 2 n with the boundary of γ j j 1 2 n 1 the boundary which is considered to be thin in thickness is assumed to be arbitrary smooth and porous for convenience the interior subdomain of boundary γ j is named as ω j and the exterior subdomain of boundary γ j is named as ω j 1 in following analysis the cylinder is exposed to the plane wave with a frequency ω wave amplitude a and water depth h as mentioned above the radius function for the cross section can be expanded into the fourier series based on the assumption of the smooth cylinder surface therefore the radius function r j θ of the boundary γ i in the polar coordinate can be written as 1 r j θ n r b j n r e i n r θ j 1 2 n 1 where n r z b j n r is the fourier coefficients of r j θ and n is the number of subdomain then a surface function s j can be defined by 2 s j r θ d i s r n r b j n r e i n r θ j 1 2 n 1 in which d i s is the distance between s j and γ j in the radial direction as shown in fig 2 it indicates that boundary γ j can be represented by surface function s j as the value of d i s coming to zero the fluid is assumed to be inviscid and incompressible and the flow to be irrotational the velocity potential of the fluid in each subdomain satisfy laplace s equation and the corresponding boundary conditions herein the governing equation and boundary conditions for the velocity potential φ j in domain ω j is summarized as follows laplace s equation 3 2 φ j 0 j 1 2 n where r e r 1 r θ e θ z e z free surface condition z 0 k a 1 4 g φ j z 2 φ j t 2 0 j 1 2 n where g is the gravity acceleration seabed condition z h 5 φ j z 0 j 1 2 n surface condition on s j 0 6 γ j φ j n j φ j 1 n j w j r θ z t j 1 2 n 1 where n j is the normal vector on the surface γ j as shown in fig 1 w j r θ z t is the normal velocity of the fluid passing through the porous cylinder from region ω j 1 to region ω j chwang 1983 taylor 1956 w j r θ z t has the form of 7 w j θ z t γ j p j 1 p j ρ δ j ω f j i s j j 1 2 n 1 where f j is the linear porous resistance coefficient s j is the inertia coefficient γ j and δ j are the porosity and thickness for boundary γ j the hydrodynamic pressures p j r θ z t j 1 2 n related to the velocity potentials through the linearized bernoulli equation is 8 p j ρ φ j t j 1 2 n 1 substituting eq 8 into eq 7 it can obtain 9 w j r θ z t i k g j φ j 1 φ j j 1 2 n 1 where g j which is defined as g j γ j k δ j f j i s j yu 1995 denotes the porous effect parameter of boundary γ j ρ is the fluid density k and is the wave number of incident wave here we assume that g j 0 j 2 n 1 while the g 1 can be zero or positive according to eq 9 then the surface boundary shown by eq 6 can be rewritten as 10 γ j φ j n j φ j 1 n j i k g j φ j φ j 1 j 1 2 n 1 the total velocity potential in domain ω j can written into the summation of two parts of velocity potential φ j i and φ j d it is 11 φ j φ j i φ j d ϕ j i ϕ j d f z e i ω t j 1 2 n where 12 φ j i ϕ j i f z e i ω t φ j d ϕ j d f z e i ω t f z i g a ω cosh k z h cosh k h based on the previous study of wang and ren 1994 a general form for the ϕ j i and ϕ j d in domain ω j can be given by 13 ϕ j d r θ m a j m h m k r e i m θ j 1 2 n 14 ϕ j i r θ m b j m j m k r e i m θ j 1 2 n where a j m and b j m are the coefficients to be determined later j m and h m are the first kind of bessel function and first kind of hankel function respectively with the order of m in the fluid region of ω 1 the coefficient of a 1 m is set to the zero owing to the singularity of h m 0 in the fluid region of ω n the coefficient of b n m have the value of e i m π 2 β obtained from the incident wave which has an angle of β between the wave propagating direction and x axis as shown in fig 2 so the form ϕ n i r θ in domain ω n can be expressed as 15 ϕ n i r θ m j m k r e i m π 2 β e i m θ due to the character of hankel function the diffraction wave velocity potential φ n d in the outermost subdomain with the form of eq 14 also satisfied the sommerfeld radiation condition at the far field 16 lim r r φ n d r i k φ n d 0 on the boundary surface of γ j s j 0 the normal unit vector n j is 17 n j 1 1 1 r s j θ 2 1 1 r s j θ 0 j 1 2 n 1 where 18 s j θ n r i n r b j n r e i n r θ substituting eqs 9 11 and 16 into eq 6 surface condition on γ j turns into 19 ϕ j i ϕ j s r 1 r 2 s j θ ϕ j i ϕ j d θ ϕ j 1 i ϕ j 1 d r 1 r 2 s j θ ϕ j 1 i ϕ j 1 d θ i k g j ϕ j i ϕ j d ϕ j 1 i ϕ j 1 d to simplify the process of derivation the square of r j is also written as 20 r j 2 n r d j n r e i n r θ where d j n r is the fourier coefficients to determine the unknown coefficients shown in eqs 13 and 14 the hankel function bessel function and modified bessel functions and their derivation are also expanded into a fourier series with s j 0 as follows 21 h m k r j s j 0 q r h j m q r e i q r θ h m k r j s j 0 q r h j m q r e i q r θ 22 j m k r j s j 0 q r f j m q r e i q r θ j m k r j s j 0 q r f j m q r e i q r θ where f j m q r f j m q r h j m q r and h j m q r are the fourier coefficients and q r z the fourier coefficients shown in eqs 1 and 20 22 can be got from 23 ℜ n 1 2 π π π ψ θ e i n θ d θ where ℜ n is the coefficient of e i n θ for function of ψ θ to be expanded from the eqs 20 22 the surface condition shown in eq 19 can be easily derived as 24 m n r q r f j m q r n r b j n r m f j m q r d j n r k i k g j d j n r f j m q r b j m h j m q r n r b j n r m h j m q r d j n r k i k g j d j n r h j m q r a j m e i m n r q r θ m n r q r i k g j d j n r f j m q r b j 1 m i k g j d j n r h j m q r a j 1 m e i m n r q r θ 25 m n r q r i k g j d j n r f j m q r b j m i k g j d j n r h j m q r a j m e i m n r q r θ m n r q r f j m q r n r b j n r m f j m q r d j n r k i k g j d j n r f j m q r b j 1 m h j m q r n r b j n r m h j m q r d j n r k i k g j d j n r h j m q r a j 1 m e i m n r q r θ to solve these linear equations we need to truncate the fourier order m q r and n r with special numbers of m n q and n r in addition the total order of m which has the relation of m m n r q r was also truncated with the order of m therefore the scope for the order m is 26 m m 1 0 1 m then the eqs 24 and 25 can be rewritten into a linear system equation with the unknown coefficients a j m and b j m they are 27 l j b j m b j 0 b j m a j m a j 0 a j m e i m θ l j 1 b j 1 m b j 1 0 b j 1 m a j 1 m a j 1 0 a j 1 m e i m θ 28 l j b j m b j 0 b j m a j m a j 0 a j m e i m θ l j 1 b j 1 m b j 1 0 b j 1 m a j 1 m a j 1 0 a j 1 m e i m θ where l j and l j are the linear function of a j m and b j m the matrix form of eq 27 and eq 28 is 29 n j 1 c j 1 n j c j where n j 1 and n j are the coefficient matrix for the c j 1 and c j respectively the unknown coefficient matrix c j are 30 c j b j a j t 31 b j b j m b j 0 b j m t a j a j m a j 0 a j m t two cases are shown in the following formulation depending on whether value of g 1 are equal to zero or positive case 1 if g 1 0 the inverse matrix of n j 1 is always exist the eq 29 can be in turn written as 32 c j 1 π j c j in which π j is a translation matrix of matrix c j 1 and c j it can be obtained by 33 π j n j 1 1 n j from the eq 32 the connection of c n and c 1 is 34 c n π n 1 c n 1 π n 1 π n 2 π 1 c 1 π c 1 where π π n 1 π n 2 π 1 substituting eq 30 into eq 34 it can be rewritten as 35 b n a n π 11 π 12 π 21 π 22 b 1 a 1 where π 11 π 12 π 21 and π 22 are the sub matrix of π as matrix of b n and a 1 are already known from initial condition the matrix of b 1 and a n can be gained by 36 b 1 a n π 11 0 π 21 i 1 i π 12 0 π 22 b n a 1 finally the unknown matrix of c j j 2 3 n 1 can be calculated by using the relation of eq 32 and matrix of c 1 case 2 if g 1 0 the inverse matrix of n j 1 is always exist except n 2 and we have c 1 0 in this situation the connection of c n and c 2 is 37 c n π n 1 c n 1 π n 1 π n 2 π 2 c 2 π c 2 where π π n 1 π n 2 π 2 the eq 37 can be rewritten as 38 b n a n π 11 π 12 π 21 π 22 b 2 a 2 in which π 11 π 12 π 21 and π 22 are the sub matrix of π from the eqs 27 and 28 there has the relation on the boundary γ 1 as 39 n 2 c 2 n 11 n 12 n 21 n 22 b 2 a 2 0 in which n 11 n 12 n 21 and n 22 are the sub matrix of n 2 and we have n 11 n 12 0 then the relation between b 2 and a 2 can be obtained from eq 39 as 40 n 21 b 2 n 22 a 2 0 as matrix of b n is already known the matrix of b 2 a 2 and a n can be gained by using the eqs 38 and 40 it is 41 b 2 a 2 a n π 11 π 12 0 π 21 π 22 i n 21 n 22 0 1 i 0 0 b n then the unknown matrix of c j j 3 4 n 1 can be calculated by using the relation of eq 32 and matrix of c 2 once the coefficients of a j m and b j m are determined the velocity potential for all the domains can be given by means of eqs 13 and 14 the pressure can be obtained by using the eq 8 the wave force in the direction of n f which is the unit vector in the force direction can be given by 42 γ j f j 0 2 π s j 0 p j p j 1 n j n f d s d θ j 1 2 n 1 based on the derived velocity potentials the wave profiles in all subdomains are obtained from the linearized dynamic free surface boundary condition thus 43 ω j η j r θ t 1 g φ j t a ϕ j i ϕ j s e i ω t j 1 2 n in the following discussion the maximum dimensionless hydrodynamic force on the boundary γ i is defined as 44 f j f j a m ρ g a π b j 0 2 in which f j a m is the amplitude of f j b j 0 is the fourier coefficient of e i n θ n 0 for boundary γ j shown in the eq 1 the dimensionless wave run up on the boundary γ j can also be defined as 45 r e j max η j 1 r θ t s j 0 a j 1 2 n 1 46 r i j max η j r θ t s j 0 a j 1 2 n 1 in which r e j is dimensionless wave run up on the exterior side of boundary γ j and r i j is dimensionless wave run up on the interior side of boundary γ j 3 analytical results 3 1 convergence analysis as shown in eqs 24 and 25 the identifers m q r and n r are infinite and should be truncated at special numbers m n q and n r respectively in the solving process to give an example the system with two cylinders are shown in this section a form of radius function r j θ for the boundaries γ j used following can be given by 47 γ j r j θ a j 1 ε j cos m j θ φ j j 1 2 where a j ε j m j and φ j are constants to determine the geometry γ 1 represents inner cylinder and γ 2 represents outer cylinder an example is given in this section with the geometry parameters a 2 2 a 1 2 m m 1 m 2 1 ε 1 0 ε 2 0 2 φ 1 φ 2 π the wave propagates along the x axis with a wave number k 3 rad m the order of n r can be consequently set as 2 max m j by accurately considering the functions of r j θ and r j 2 θ to analyze the effect of truncated error of n q a relative error function is defined as follow 48 e ψ π π ψ θ q r n q n q ℜ q r e i q r θ 2 d θ π π ψ θ 2 d θ where ψ and ℜ q r are defined in eq 23 due to the limitation of space only the results of truncated error on γ 2 is given fig 3 illustrates the truncated error of h m k r h m k r j m k r and j m k r on this boundary as n q 4 m 2 4 it shows upward trends of truncated errors with the increase of m and h m k r shows larger truncated error than other three functions therefore the truncated error of h m k r should be small enough as the order m up to the max value m fig 4 shows the relation between the error function and n q with same geometry parameters with m 25 practical tries on several boundaries have found that the truncated errors can be neglected when e ψ is smaller than 5 table 1 shows the analytical results of wave force and wave run up on inner and outer cylinders versus different truncated order of m it can be clearly seen that the truncated order has less effect on the wave force which means the analytical results of wave force can convergent with a small value of m while the results of wave run up need a larger value and it in this case can be convergent when m 15 basing on above discussion and previous study of liu et al 2016 some rules can be summarized for choosing the truncated order of m n r and n q they are 1 the value of n r and n q are depended on the radius function of cross section 2 m should be determined by a convergence analysis it showed that the larger value of wave number k the larger truncated order of m is needed 3 2 validation by semi analytical method a concentric porous circular cylinder system consisting of two co axes vertical and surface piercing cylinders surrounded by a fluid of finite depth h is used to validate the present method three subdomains ω 1 ω 2 and ω 3 are divided by the circular boundaries γ 1 and γ 2 with the porous parameter of g 1 and g 2 respectively the radii for the circular boundaries γ 1 and γ 2 are a 1 and a 2 a monochromatic incident wave of small amplitude propagates in the direction of the positive x axis the wave force and wave run up on each boundary are considered in the following discussion fig 5 shows the comparative results of dimensionless wave force between present method and semi analytical method of sbfem tao et al 2009 the outer cylinder is porous with g 2 1 and the inner one is non porous with g 1 0 which means waves cannot flow into the interior of inner cylinder so this case can be solved by using the method of case 2 with initial boundary of b 1 the geometry parameters for the inner and outer circular cylinder are a 1 1 m and a 2 a 1 2 respectively the water depth used in the cases is h 15 m and wave exposure β 0 o is taken as its unit in the following discussion this figure shows that the dimensionless wave force in line x axis for the inner and outer cylinder of present method are coincide with those of sbfem fig 6 shows the comparative results of the max wave elevation at different location θ around cylinder between present method and the method provided by wang and ren 1994 the values for each parameter are a 1 2 m a 2 a 1 5 g 1 0 g 2 1 and h 15 m the wave effect parameter c w g ω 2 h 1 0 with the wave number k 0 08 rad m the results shows that the present method can give an accuracy solution for the wave run up 3 3 validation by experiment in this subsection an experiment test was performed at the wind tunnel and wave flume laboratory harbin institute of technology in china with a concentric cylinder system which consists of a quasi ellipse caisson and a perforated cylindrical wall the wave flume has a width of 5 m and a length of 50 m the water waves are generated by using a bottom hinged flap type wave maker installed at the one side of the flume the schematic of experiment model is shown in fig 7 both of the structure have an approximately elliptical section with a central rectangle and two external half circles detail geometry parameters shown in fig 7 for the cylinder system are shown in table 2 in this table s w and s p are the area for the wall and hole in a unit section δ is the thickness of the porous wall the regular wave generated by the wave maker propagated from the left to the right end with a water depth of 0 8 m seven different wave numbers with calibrated wave heights were tested on the model by two exposure β 0 and 90 respectively during the tests force balances were installed at the base of the model to measure the wave force and bending moment of the inner cylinder and outer cylinder respectively eight wave gauges were instrumented around the inner cylinder to measure the surface elevation around it at the same time twelve other wave gauges were also distributed around the outer cylinder to record the wave elevation in the wave flume as shown in fig 8 these signals were transferred to an ni pxi based data acquisition system to achieve synchronous collection of the test data at a sampling frequency of 200 hz the wave force on the inner and outer cylinder can be generally repeated between two different tests with the same wave parameters while for the wave run up around the inner cylinder it could be more sensitive to the initial condition of the water flume so the interval time between two tests is determined by the amplitude of surface elevation vibration when it is less than 1 mm a close up image of the test model is depicted in fig 8 the porosity γ 2 of the perforated wall is calculated by the area of s w and s p it is 49 γ 2 s p s w s p as waves passing through the thin porous wall they are accompanied by both energy dissipation and phase shift the wave energy dissipation due to the resistance effect of the porous wall is related to the real part of g 2 the phase shift due to the inertia effect of the wall is related the imaginary part of g 2 the porous effect parameter g 2 defined in eq 9 yu 1995 is 50 g 2 γ 2 k δ 2 f 2 i s 2 in which s 2 is related to the added mass coefficient c m and porosity γ 2 by 51 s 2 1 c m 1 γ 2 γ 2 as for the porous resistance coefficient f 2 li et al 2006 provided an empirical formula for the models 52 f 2 3338 7 δ 2 h 2 82 769 δ 2 h 8 711 in this study the value of δ 2 h is 0 00375 which is out of the applicable scope 0 0094 δ 2 h 0 05 of the eq 52 however as f 2 defined by this equation tends to be stable with the decrease of δ 2 h eq 52 can be used in this study to give a rough prediction of f 2 which equals to 8 97 for the presented model to investigate the effect of this parameter on the wave structure interaction the results of wave action with other three values f 2 8 f 2 10 and f 2 20 are also taken into consideration in the following analysis then the value of g 2 for the given perforated wall can be calculated from eq 50 with the known porous resistance coefficient f 2 and the inertial effect coefficient s 2 both of which can be obtained through eqs 51 and 52 however as the inertial effect of a thin porous plate is not significant a value of s 2 1 may be used safely for most practical problems li et al 2006 yu 1995 some authors even set s 2 to zero cho and kim 2000 chwang 1983 for the cases shown in this section there is less different between the analytical results with s 2 1 and s 2 0 so only the results s 2 1 is shown in the following the other parameters are m 30 n r 20 and n q 60 for the wave force a general increase of the dimensionless value was found from the measured data of the experiment with the increase of the wave steepness for both of the inner and outer cylinder fig 9 shows the comparative results of the wave force on the inner caisson and outer perforated cylinder with two kinds of wave exposures β 0 and 90 from the comparative results of f 2 8 f 2 8 97 and f 2 10 it is evidence that the resultant wave force on the inner structure is less sensitive to the value of f 2 especially for the case with a lower wave number it also suggests that the present method can give a reasonable results compared with the experimental results of wave force on the inner cylinder which can validates the effectiveness of the developed method for solving the linear wave diffraction problem with a complex cross section for the outer cylinder the difference between the experimental and analytical results obtained by f 2 8 97 is relatively large than that of the inner cylinder although the general tendency of the dimensionless wave force on it can be successfully predicted by the present method some reasons induced the difference such as the inhomogeneous porous for the perforated cylinder and wave breaking might prompt this phenomenon the comparative results also illustrate that a larger value of f 2 could achieve a better analytical result for the wave force on the outer cylinder however when the wave steepness becomes large a larger f 2 would be needed the comparative results of wave run up r ε around the inner caisson are shown in fig 10 which also shows an acceptable comparison between experimental tests and analytical solution unlike with the results of wave force the dimensionless wave run up shows no obvious tendency with the increase of wave steepness in summary the value of f 2 obtained from perforated wall tests can apply to the porous cylindrical system however it should be noted that the wave force on the perforated cylinder would be underestimated when the wave steepness is large 4 case study wave interaction with cosine type porous structures this section will deal with the plane waves interaction with a surface piercing concentric cylindrical system which consists of an impermeable inner circular cylinder and a coaxial single layered perforated cylinder in the following discussion eq 47 are also used to defined the boundary of the cylinders the parameter m 2 for the perforated cylinder is taken the value of 1 the values of water depth h is 5 m the detail value of geometry parameters can be found in the table 3 the truncated orders used in the section are m 25 n r 2 and n q 6 comparative results of total wave force on inner and outer cylinder is shown in fig 11 respectively with ε 2 0 2 g 2 1 and various value of β it illustrates that the maximum value of total wave force on the inner circular cylinder would occur with the value of k in the scope of 0 5 0 75 rad m and increase obviously with value of β from 0 o to 180 o as shown in fig 11 a after reaching the peak value the total wave force of inner cylinder experiences a general decrease trend with the increase of wave number for the wave force on outer cylinder the maximum values of these cases occur around with k 0 17 rad m and have slight different among them as shown in fig 11 b then they sees a sharply decrease until they reach their turning point on these points the value is almost to be zero for the circular case and are slight larger than zero for the non circular cases table 4 compares the maximum total wave force and corresponding wave number on the inner cylinder γ 1 and outer cylinder γ 2 versus different β the values of total wave force on inner cylinder are smaller than circular case as β 0 o and β 45 o and the corresponding wave number of them also slightly smaller than that of circular case for the other cases k max are equal to 0 57 rad m and f max is larger than the result of circular case by contrast the values of k max of outer cylinder with all β are equal to 0 17 rad m beside circular case and f max of noncircular cases are always larger that circular case comparative results of dimensionless wave run up with various β are shown in fig 12 the values of r i on the boundary of inner cylinder γ 1 are zero due to g 1 0 for the other values less regulation can be found from these figures due to the complex wave structure interaction however it can still indicate that the wave run up r i and r e on the boundary γ 1 and γ 2 have same value levels 1 2 with wave number in the scope of 0 3 rad m it also suggests that wave run up of non circular cases could be much larger than circular case in the range 2 3 rad m of wave number for different cases fig 13 presents two dimensional contour plots of the free surface elevation versus different values of β with k 3 0 rad m where yellow solid line represents the boundary of inner cylinder and green dash line represents boundary of outer cylinder it illustrates that free wave surface is symmetry along x axis with β 0 o and β 180 o due the symmetrical configuration of cylindrical system as shown in fig 13 a and e however it would lose the characters of symmetry with parameter of β 45 o β 90 o and β 135 o as shown in fig 13 b c and d and a more complex wave field can be found between the boundaries fig 14 shows the comparative results of total wave force on inner and outer cylinder with β 0 o g 2 1 and various value of ε 2 the circular case can be thought as the case of ε 2 0 reasonably this figure shows that the maximum value of total wave force has a general decrease trend of on inner cylinder and increase trend on outer cylinder with the increase of ε 2 respectively it also indicates that f on inner cylinder of non circular cases would be smaller than that of circular case in the scope of 0 1 rad m and larger in the scope of 2 3 rad m by contrast the total wave force f on outer cylinder of non circular cases shown an opposite regulation comparing with inner cylinder table 5 listed the maximum wave force f max on inner and outer cylinders and corresponding wave number k max it points that the wave number corresponding to maximum wave force on inner cylinder decrease with the increase of ε 2 and the maximum wave force is reduced by 13 with ε 2 0 3 however the values of k max are unchanged with different ε 2 and the value of f max is raised by 7 with ε 2 0 3 note e max have the relation of e max f ε max f c max f c max where f ε max and f c max are the maximum total wave force for non circular case and circular case respectively in fig 15 the wave run up r i and r e on the boundary γ 1 and γ 2 experienced by the concentric porous cylinder system with β 0 o are plotted versus the wave number k it is observed that the wave run up for the circular case with k in the scope of 0 1 5 rad m would larger than the results of non circular cases or approximate equal to them however as the k is in the range of 1 5 3 rad m the most of results for the non circular cases would larger than the results of circular case in fig 16 two dimensional contour plots of the free surface elevation are presented for different values of ε 2 with k 2 0 rad m from the color bar it is clear that a larger space ahead inner cylinder would cause a more complex wave field which sometimes could introduce a significant increase of wave run around cylinders fig 17 shows the total wave force on inner and outer cylinder with ε 2 0 2 and β 0 versus different porous parameter g 2 and wave number k it illustrated that the cases for different g 2 have a similar tendency various wave number k for both inner cylinder and outer cylinder furthermore the wave force on inner cylinder experienced a smaller wave force with the porous parameter of g 2 0 5 than other cases due to less wave energy pass through outer cylinder with the increase of g 2 the total wave force on inner cylinder would increase generally and that of outer cylinder show an opposite tendency two specific cases g 2 0 0 and g 2 are also shown in this figure to investigate the ultimate status of the wave force of the inner and outer cylinder the analysis results indicate that both of the wave force acting on the inner and outer cylinder are sensitive to a lower value of g 2 and convergence gradually to the green dot line as g 2 from the results shown in figs 11 14 and 17 we can find that at least one point exists in the results of the outer cylinder with k a 1 in the range of 0 3 which could lose the capacity of protection partly or entirely furthermore the analysis shows that the noncircular cross section would have more points like that in this range compared with the circular case as shown in fig 11 the wave numbers corresponding to these points are not only dependent on the ratio between wavelength and the gap between the boundaries but also on the shape of the cross section this issue will be further investigated in the future 5 conclusion this paper presented an analytical method for a concentric porous cylinder system with arbitrary smooth cross section by expanding the bessel functions and radius function into fourier series the unknown coefficients of velocity potential can be successfully solved by using the surface boundary of cylinders the truncated errors introduced by the present method were analyzed and the accuracy of this method was compared with the results of sfbem and experimental tests furthermore the analytical results with several types of cross section were given by compared with the circular cases the conclusion of this study can be summarized as following 1 present method based on the potential theory can successfully deal with the problem of wave action on a concentric porous cylinder system whose cross sections are arbitrary and smooth the introduced truncated error can be vanished by increasing the truncated order of m n r and n q in the solving process to obtain convergence results of wave run up larger truncated orders are needed compared with that of wave force on the structures 2 the experimental results demonstrated that the present method could achieve a good prediction of the wave force on the inner caisson and obtain acceptable results of wave force on the outer porous cylinder and of wave run up through adjusting the value of f 2 it also indicated that the empirical formulae of f 2 obtained from flat wall tests can provide a rough prediction 3 perforated cylinder with noncircular section could reduce the maximum dimensionless wave force on inner cylinder in some situations which has a larger annular spacing at upstream and smaller annular spacing at downstream between the inner and outer cylinders however the wave run up or amplitude of free surface could be enlarged because of the non symmetry character or large annular spacing of the concentric porous cylinder system especially for the large wave number cases acknowledgement financial support from the national natural science foundation of china 51725801 is greatly appreciated by the authors the authors also express the sincere thanks to graham macky for his useful comments 
23331,this paper presents a combined nonlinear model predictive control nmpc for position and velocity tracking of underactuated surface vessels and collision avoidance of static and dynamic objects into a single control scheme with sideslip angle compensation and environmental disturbances counteraction a three degree of freedom 3 dof dynamic model is used with only two control variables namely surge force and yaw moment external environmental forces are considered as constant or slowly varying disturbances with respect to the inertial frame and hence nonlinear for the body frame of the vessel nonlinear disturbance observer ndo is used to estimate these disturbances in order to be fed into the prediction model and enhance the robustness of the controller a nonlinear optimization problem is formulated to minimize the deviation of the vessel states from a time varying reference generated over a finite horizon by a virtual vessel sideslip angle is considered in the cost function formulation to account for tracking error caused by the transverse external force in the absence of sway control force collision avoidance is embedded into the trajectory tracking control problem as a time varying nonlinear constraint of position states to account for static and dynamic obstacles matlab simulations are used to assess the validity of the proposed technique keywords nonlinear model predictive control nmpc nonlinear disturbance obersver ndo collision avoidance trajectory tracking underactuated vessel 1 introduction path following techniques of vessels have gained a lot of interest from both academia and industry specially for the future expectations of using commercial autonomous vessels or adding an autopilot to assist the crew to make these techniques practical collision avoidance should be integrated in the control problem to guarantee safe maneuvering during the trip collision risk is increased in the presence of external forces such as those induced by wind and waves motivated by these requirements surface vessels should be able to keep the planned trajectory while avoiding collision of nearby objects and counteraction external disturbances the challenge is increased for underactuated surface vessels which are usually equipped with two independent aft thrusters or with one main aft thruster and a rudder and hence have only two control variables namely surge force and yaw moment in recent years trajectory tracking has been studied using various control techniques for instance dynamic surface control dsc technique is used in chwa 2011 for global tracking of underactuated vessel in a modular way that cascaded kinematic and dynamic linearizations can be achieved in peng et al 2013 wang et al 2014 an adaptive form of dsc is used for formation control of autonomous surface vehicles asvs moving in a leader follower formation under ocean disturbances in kahveci and ioannou 2013 an automatic adaptive steering control design for full actuated vessels is presented the adaptive law is combined with a control design including a linear quadratic controller lqr and a riccati based anti windup compensator the controller also takes into consideration input constraints wind and wave effects and parametric uncertainty in dong et al 2015 a trajectory tracking problem is addressed for a 3 dof underactuated unmanned surface vessel usv using a state feedback based backstepping control algorithm with relaxed persistent exciting pe conditions of yaw velocity in jiang and nijmeijer 1999 a recursive technique is presented for trajectory tracking of nonholonomic systems by the means of backstepping and is demonstrated by simulating an articulated vehicle and a knife edge system in do and pan 2004 a methodology for designing state and output feedback controller is presented by means of lyapunov s direct method and backstepping after model transformation to serret frenet frame although the aforementioned techniques give good trajectory tracking results collision avoidance of nearby objects is not addressed model predictive control mpc has got attention for trajectory tracking control problems because of its systematic ability to handle physical constraints of the system künhe et al 2005 in guerreiro et al 2014 nmpc is used for trajectory tracking of a full actuated autonomous surface craft asc in the presence of constant ocean currents in yan and wang 2012 mpc is applied for tracking problem of underactuated surface vessels employing the affine property of the system model the kinematic is simplified by applying frame transformation to make positions independent of the choice of the inertial frame nonlinear functions of the system are evaluated using optimal states obtained at the previous instant which leads to significant numerical errors for large horizons mayne 1016 in abdelaal et al 2015 nmpc is used for trajectory tracking of an underactuated vessels employing direct multiple shooting technique that leads to less numerical error the aforementioned mpc approaches do not cater for collision avoidance conventionally collision avoidance is treated as a controller independent planning problem that might not be achievable by the controller and hence degrades the safety of the vessel wang et al 1016 for instance an evolutionary algorithm is presented in smierzchalski 1999 to find a safe and optimal trajectory of surface vessels in a well known environment by using the vessel s kinematic model a more sophisticated evolutionary approach is presented in szlapczynski 2011 2012 szlapczynski and szlapczynska 2012 by adding specialized operators to shape the convergence of the optimization in zhuo 2014 a fuzzy logic approach is presented for collision avoidance of large ships by formulating the problem into an optimization problem and solving it using a particle swarm algorithm fuzzy neural inference network is also used in liu and shi 2005 for ship collision avoidance in wang et al 2017a collision avoidance is achieved in two steps a path planning collision avoidance and an mpc for following the generated path after linearizing the dynamics of the vessel in wang et al 2017b a collision avoidance dynamic support system is presented where a mathematical model of ship maneuvering motion and a pid heading controller are employed as well as dynamic calculation model of collision avoidance parameter a graph theoretic solution on an appropriately weighted directed graph representation of the navigation area is presented in ari et al 2013 the graph is obtained via 8 adjacency integer lattice discretization and utilization of the a algorithm although the aforementioned techniques demonstrate collision avoidance they either simplify or ignore the dynamics of the vessel and the effect of external environmental forces recently control techniques have been developed to include collision avoidance as an objective while designing the controllers in wang and ding 2014 mpc is used for the tracking and formation problem of multiagent linear systems with collision avoidance as a constraint for the optimization problem in alrifaee et al 2014 a centralized mpc is used for collision avoidance of networked vehicles by successively linearizing the nonlinear prediction model using taylor series in wang et al 1016 an mpc technique is applied for the nonlinear model of kinematically redundant space robot to approach an un cooperative target in complex space environment for the sake of deriving a linearized version of the space robot feedback linearization is used and hence collision avoidance can be formulated as a linear matrix inequality lmi the aforementioned model predictive techniques consider the collision avoidance but they lack handling of external disturbances for underactuated systems in johansen et al 2016 mpc is used for collision avoidance by pre computing a finite set of control behaviors and then simulating on line these behaviors to check which scenario gives the optimal trajectory the objective of this paper is to introduce the concept of integrating collision avoidance into the trajectory tracking controller based on mpc concepts to act as a last line of defense for autonomous vessels for such critical maneuvering accuracy is necessary and therefore comes the necessity of employing full planar motion nonlinear dynamics and effect of external disturbances in this paper a nonlinear state feedback control law is presented based on solving a finite horizon optimization problem at every instant and using the current state measurement as initial condition for the problem the problem takes into consideration the physical constraints of the vessel by systematically adding them to the optimization problem constraints collision avoidance constraints are added to the problem that force the vessel to deviate minimally from the defined path in case of predicting a collision while obeying some of the rules of the international regulations for preventing collisions at sea colregs external forces are taken into consideration as unmeasured disturbance and therefore the nmpc law is modified to include the disturbance estimated by ndo and handle the external transverse force component where there is no corresponding control force to counteract the output of the problem is an optimal sequence of length n of the vesselâ s force and moment the first element only is applied and then the whole process is repeated at the next instant the finite horizon optimization problem is discretized and then formulated as a quadratic problem qp which is solved by the aid of acado toolkit houska et al 2011 and qpoases solver qpoases homepage this paper is organized as follows section 2 describes the vessel nonlinear dynamics external disturbance modeling generation of the reference trajectory and clarifies the control objective controller synthesis is presented in section 3 a brief introduction of nmpc is given first followed by the nonlinear disturbance observer design a cost function modification is then presented to include sideslip angle along with the conditions required to guarantee stability of the nonlinear system collision avoidance compliance of some colregs rules discretization and implementation of the proposed approach the matlab based simulation results are given in section 4 section 5 concludes this paper 2 problem formulation the surface vessel model has 6 dof surge sway yaw heave roll and pitch which can be simplified to motion in surge sway and yaw under the following assumptions chwa 2011 1 the heave roll and pitch modes induced by wind and currents are negligible 2 the inertia added mass and hydrodynamic damping matrices are diagonal 3 the available control variables are surge force and yaw moment based on that the 3 dof model will be fossen 2011 1 x u cos ψ υ sin ψ y u sin ψ υ cos ψ ψ r u m 2 m 1 υ r d 1 m 1 u 1 m 1 τ u υ m 1 m 2 u r d 2 m 2 υ r m 1 m 2 m 3 u υ d 3 m 3 u 1 m 3 τ r here x and y are the positions ψ is the heading angle of the ship with respect to the earth fixed frame u and υ are the longitudinal and transverse linear velocities in surge body fixed x and sway body fixed y directions respectively and r is the angular velocity in yaw around body fixed z axis see fig 1 the parameters m 1 m 2 m 3 are the ship inertia including added mass effects and d 1 d 2 d 3 are the hydrodynamic damping coefficients external environmental forces induced by the wind and wave current are assumed to be constant with respect to the inertial reference frame and have three components surge sway and yaw therefore the vessel model written in a compact form will be modified to be 2 x f x g 1 x u g 2 b x w b where x x y ψ u υ r t ℜ 6 is the state vector u τ u τ r t ℜ 2 is the input vector of surge force and yaw moment only w b w u w υ w r t ℜ 3 is the external forces and moment vector acting on surge sway and yaw directions and expressed in the body fixed frame f x u cos ψ υ sin ψ u sin ψ υ cos ψ r m 2 m 1 υ r d 1 m 1 u m 1 m 2 u r d 2 m 2 υ m 1 m 2 m 3 u υ d 3 m 3 u ℜ 6 g 1 x 0 0 0 1 m 1 0 0 0 0 0 0 0 1 m 3 t ℜ 6 ℜ 2 and g 2 b x 0 0 0 1 m 1 0 0 0 0 0 0 1 m 2 0 0 0 0 0 0 1 m 3 t ℜ 6 ℜ 3 external environmental forces need to be expressed in the inertial reference frame to be independent from the heading angle of the vessel therefore the transformation matrix between body and inertial frames will be used as follows fossen 2011 3 w b cos ψ sin ψ 0 sin ψ cos ψ 0 0 0 1 w w ℜ 3 here w is the vector of external forces with respect to inertial reference frame combining 2 and 3 we obtain the model employed throughout the rest of the paper 4 x f x g 1 x u g 2 x w where g 2 x 0 0 0 cos ψ m 1 sin ψ m 2 0 0 0 0 sin ψ m 1 cos ψ m 2 0 0 0 0 0 0 1 m 3 t a time varying reference trajectory is generated by a virtual ship with the same dynamics as 2 but without the effect of external forces 5 x r f x r g 1 x r u r where x r x r y r ψ r u r υ r r r t denotes the generated reference states the same assumptions as in yan and wang 2012 are adopted throughout this paper assumption 1 all ship state variables position orientation and velocities are measurable or can be accurately estimated assumption 2 the reference velocities and positions are smooth over time hence the control objective is to steer the vessel states x y ψ u υ r to follow the reference states x r y r ψ r u r υ r r r while satisfying control input and collision avoidance constraints 3 controller synthesis 3 1 nonlinear model predictive control consider a continuous time invariant nonlinear state space model of the vessel in the form of 4 subject to the constraints 6 x t x u t u c x t u t c t 0 where x ℜ n is the state vector u ℜ m is the control vector f g 1 and g 2 are continuous nonlinear functions f 0 0 g 1 0 0 and g 2 0 0 x ℜ n and u ℜ m are compact sets and contain the origin in their interior points in general the scheme of mpc is to predict the future states over some finite prediction horizon using a nominal model as in 4 for the system and the last available measurement or accurate estimation of the states to get the optimum control action over a control horizon control vector the control horizon is less than or equal to the prediction horizon this control vector steers the system states to follow a time varying reference generated by a model of the form 5 thereafter the first element of the control vector is applied and the whole process is repeated at the next sample hence nmpc is considered as a nonlinear state feedback u k k x k obtained online from an optimal control problem that minimizes a least squares ls objective function penalizing the deviation of the system inputs and states from the reference trajectories it takes the form 7a min x t u t j x u t t 0 t p t 0 ℓ x t u t d t f x t p subject to 7b x t f x g 1 x u g 2 x w 7c x t x 7d u t u 7e c x t u t c where ℓ x t u t is the stage cost function and must satisfy the following conditions ℓ x r t u r t 0 ℓ x t u t 0 x t x u t u x t x r t f x t p is the terminal cost function t p 0 is length of both the prediction and control horizons and the external disturbance w is known or estimated the stage and terminal cost functions are usually defined as weighted norm of the states and control input errors yang and zheng 2014 8 ℓ x t u t x t x r t q u t u r t r 9 f x t p x t p x r t p p here q r p are positive semidefinite weighing matrices control variables are penalized because that makes the optimization problem easier and avoid control values of high energy grüne and pannek 2011 3 2 nonlinear disturbance observer external environmental forces might lead to a tracking error if they are not considered in the controller design hence a measurement or estimation of these disturbances is required the concept of disturbance observers do was introduced by ohnishi in 1987 nakao et al 1987 in many control loops the external disturbances can be modeled by an additive signal added to the control signal parsa and farrokhi 2010 in fossen 2000 a nonlinear disturbance observer is designed for vessels under the approximation that g 2 x g 2 ψ g 2 ψ ψ w where ψ w is the wave induced yaw disturbance which is suitable for the dynamic positioning application presented in that paper the sway force is estimated in aschemann and rauh 2010 while the surge and yaw disturbances are compensated using the integral term of the pid in this subsection a nonlinear observer is designed to estimate the three components of the disturbances without approximation of the matrix g 2 x knowing the disturbance value it can be compensated by adding an appropriate canceling signal that has the disturbance magnitude but in the opposite sign or equivalently in the case of mpc including it in the prediction model the main idea of disturbance observers is to estimate the equivalent disturbance by comparing the control input to the real system with the virtual control input to the nominal model the virtual control input is derived from the inverse of the nominal model nikoobin and haghighi 2009 the estimated value is fed back as a cancellation signal and then makes the whole system to behave like the nominal system for vessels external forces should be estimated as they are not measured in real time the combined structure of nmpc with disturbance observer is demonstrated in fig 2 since the vessel dynamics are highly nonlinear a nonlinear disturbance observer ndo presented in chen et al 2000 is used to estimate the unknown but constant or slowly time varying external forces consider the vessel nonlinear model as in 4 where x ℜ 6 u ℜ 2 and w b ℜ 3 it is assumed that f x g 1 x and g 2 x are smooth in terms of x li et al 2014 to estimate the unknown disturbance the following disturbance observer is suggested li et al 2014 chen 2004 10a z l x g 2 x z g 2 x p x f x g 1 x u 10b w ˆ z p x where z ℜ 3 is the internal state of the nonlinear observer and p x is the nonlinear function to be designed the nonlinear disturbance observer gain l x is determined by 11 l x p x x the estimation error is governed according to li et al 2014 12 e w w w l x g 2 x e w hence the ndo design can estimate unknown constant disturbances if the observer gain l x is chosen such that system 12 is asymptotically stable one possible choice for l x is 13 l x k w g 2 x 1 k w 0 0 0 0 0 0 m 1 u sin ψ m 2 υ cos ψ m 1 u cos ψ m 2 υ sin ψ 0 m 1 cos ψ m 1 sin ψ 0 m 2 sin ψ m 2 cos ψ 0 0 0 m 3 t k w is a scalar that determines the convergence rate of the observer and g 2 x 1 ℜ 3 ℜ 6 is the pseudo inverse of g 2 x by integrating 11 with respect to x p x will be 14 p x m 1 u cos ψ m 2 υ sin ψ m 1 u sin ψ m 2 υ cos ψ m 3 r this choice makes the observer estimation error linear with eigenvalues equal to the scalar k w 3 3 sideslip angle compensation in the case of undereducated vessels the controller can not reject the disturbance force component in the sway direction as there is no sway control force generated by the actuators of the vessel even if the disturbance value is known although the terms course and heading are used interchangeably in much of the literature on guidance navigation and control of marine craft fossen 2011 they are not equivalent and this leads to confusion here they are going to be used differently hence the following definitions adopted from fossen 2011 breivik and fossen 2004 are required to avoid this confusion see fig 3 definition 1 velocity vector it is the specification of the vessels s speed u u 2 υ 2 and orientation β tan 1 υ u with respect to the vessel s body reference frame definition 2 sideslip drift angle β the angle from x b axis to the velocity vector of the vessel positive rotation about the z i axis by the right hand screw convention definition 3 heading yaw angle ψ the angle from x i axis to the x b axis positive rotation about the z i axis by the right hand screw convention definition 4 course angle χ the angle from x i axis to the velocity vector of the vessel positive rotation about the z i axis by the right hand screw convention by these definitions it is clear that χ ψ β and in case of straight line motion the sideslip angle β will be zero and both heading and course angles will be equal except in case of external disturbance acting on the transverse direction in this case the sway velocity will not be zero and hence heading and course angle are not equal even for straight line motion in order to overcome the aforementioned limitation due to the absence of sway control force the heading angle ψ in the stage cost function 8 is going to be replaced with the course angle χ as the vessel will not be able to achieve zero tracking error for the heading angle in case of external disturbance in the sway direction this will lead to a non zero sideslip angle even if the ship is moving in straight line but will create a force component that rejects the sway disturbance occurred in the zero sideslip angle case based on that the control objective will be steering the vessel states to track the reference states except for the heading angle ψ and the vessel course angle χ to track the reference course angle χ r where χ r ψ r β r therefore the stage cost function will be modified to 15 ℓ x t u t x t x r t q u t u r t r where x x y χ u υ r t and x r t x r y r χ r u r υ r r r t this is motivated by the research done in fossen et al 2014 where sideslip angle is taken into account to cope with high wind and tide conditions and achieve higher tracking accuracy even for smaller ship speeds 3 4 collision avoidance conventionally collision avoidance is treated as controller independent planning problem wang et al 1016 the solution of the problem might not be achievable by the controller due to adverse environmental conditions and ignored vessel dynamics to overcome that and exploiting the nmpc ability to integrate state constraints systematically into its optimization problem obstacles are assumed to have circular shape and collision avoidance is translated into an inequality constraint integrated into the controller design of the form 16 x t x o i t 2 y t y o i t 2 r i where x t and y t are the prediction of the position for own vessel over the prediction horizon x o i t and y o i t are the prediction of the position for the i t h obstacle and r i is the safety radius measured from the center of the vessel the safety radius will be selected to be 17 r i r o i d s i l 2 where r o i is the radius of the circular envelop for the i t h obstacle l is the length of our vessel and d s i is the safety distance required between the vessel and the i t h obstacle if the obstacle is a ship the radius of its circular envelope will be selected to be half of its length due to lack of information about the encountered vessels acceleration the assumption of constant velocity is used in order to use the above collision avoidance constraint for moving vessels future motion prediction of encountered vessels is required it is assumed that own vessel is equipped with a radar or lidar that provides the controller with the position of the obstacles as well as an ais arpa system that provides necessary information such as velocity course and the length of the vessel the motion prediction of encountered vessels will be predicted using the constant velocity cv model presented in rong li and jilkov 2003 in this model the vessel is assumed to move in straight line with constant velocity the direction of motion is used as the course angle of the vessel χ it takes the form 18 x t x t 0 x δ t y t 0 y δ t arctan y x x t 0 y t 0 0 t 0 t t p where δ t t t 0 3 5 colregs compliance the maneuvering occurred due to the optimal solution of the nmpc problem 7 with the collision avoidance constraint 16 as a state constraint might be random in the sense of maneuvering direction and not necessarily compliant to the international regulations for preventing collisions at sea colregs colregs 1972 that set rules for the actions a vessel should follow when encountering other vessels at sea we will focus on the three typical situations head on overtaking and crossing which are described in rules number 13 14 and 15 of section 2 of colrges and depicted in fig 4 in a head on situation between two vessels both vessels must turn to the starboard side so that they pass on the port side of each other in an overtaking situation the overtaking vessel can turn to either starboard or port side according to the situation and starboard is chosen for our algorithm when two vessels are crossing each other the vessel which has the other on the starboard side must give way and avoid crossing ahead of her we here conclude that the vessel should prioritize maneuvering to starboard side therefore the optimization problem will be reformulated by adding a soft constraint on the rate of change of yaw moment to prioritize the ship maneuvering to the starboard side the final form of the optimization problem used is 19a min x t u t j x u t t 0 t p t 0 ℓ x t u t d t f x t p subject to 19b x t f x g 1 x u g 2 x w ˆ 19c u t u 19d x t x o i t 2 y t y o i t 2 r i 19e τ r s l k 0 19f s l k 0 where s l k is a positive slack variable used for softening the constraint 19e to give priority to negative yaw moment i e turning to starboard τ u m i n and τ u m a x are the minimum and maximum limits for surge force and τ r m i n and τ r m a x are the minimum and maximum limits for sway moment the stage cost function will be modified to add penalty on the slack variable as follows 20 ℓ x t u t x t x r t q u t u r t r s l k t s 3 6 stability of nmpc to guarantee asymptotic stability by using the control law u k k x k it is desirable to use infinite prediction and control horizons i e set n in 7 but it is not feasible to get the solution of the infinite horizon nonlinear optimization problem magni et al 2001 on the other hand stability can be guaranteed for finite horizon problems by suitably choosing a terminal cost f and a terminal attractive region ω this result has been studied in magni et al 2001 mayne et al 2000 ong et al 2006 chen and allgöwer 1998 and conditions required for that will be summarized as follow 1 u ℜ m is compact and x ℜ n is connected and contains the origin in the interior of u x 2 the vector field f ℜ n ℜ m ℜ n is locally lipschitz in x and satisfy f 0 0 0 3 the aforementioned conditions on ℓ are satisfied 4 the terminal penalty f is continuous with f 0 0 and the terminal attractive region satisfies ω x x f x e for some e 0 5 the nmpc problem has initially a feasible solution 6 for any x ω there exists a u u such that f x f x u ℓ x u 0 z ω for our problem the constraints on the states are only for the position so without loss of generality we can assume that the feasible set has always the origin in the interior by simple axis transformation control constraints are usually selected to be linear inequalities as shown in 21 and therefore the set u is compact although there are clear conditions for the asymptotic stability designing the terminal cost f and the attractive region ω is still an open problem and may make the online optimizations more difficult and time consuming to solve jadbabaie and hauser 2005 in grüne and pannek 2011 it was shown that asymptomatic stability can be guaranteed just by tuning p q and r closed loop stability is achieved for relatively long horizons without the need to use terminal cost or terminal constraint jadbabaie and hauser 2005 based on that cost function 7 with ℓ selected as in 15 will be used in this paper and without a terminal constraint 3 7 direct multiple shooting in order to solve the optimization problem 7 a direct multiple shooting technique bock and plitt 1984 derived from the solution of boundary value problems of differential equations is used the concept of this technique is based on uniform discretization of the horizon into n smaller intervals using one of the rungeâ kutta methods such that t 0 t 0 t 1 t n t p solving an initial value problem in each of the smaller intervals t j t j 1 and imposing additional matching conditions to form a solution on the whole horizon all rungeâ kutta variants provide first and second order differentiation techniques in order to compute sensitivities of the state trajectory with respect to initial states and control inputs other integrators are used in case of algebraic differential equations thereafter the problem constraints are evaluated on the grid nodes t j and the control vector has been parametrized as piecewise constant the result of this technique is a least squares nonlinear programming nlp with fixed dimensions that can be solved employing gauss newton method the ndo equation 10 is discretized at a sampling interval t s t p n using radau iia fifth order implicit method one of runge kutta methods for numerical solution of the ordinary differential equation this discrete model will be used for estimating the current value of the external disturbance that is assumed to be constant over the nmpc horizon of n elements based on that the nmpc ndo scheme is summarized as follow 1 set the time index t t 0 the prediction horizon t p sampling interval t s weight matrices q and r the observer convergence rate k w and the disturbance initial value w ˆ t 0 0 2 get the value of the states x 3 get the obstacles position x o i and y o i 4 solve the optimization problem 7 and get optimal input vector u t 0 u t n and the predicted states x t 0 x t n 5 apply only the first element u t 0 6 solve the ndo 10 to get the estimated value for the disturbance w ˆ t t s 7 wait for the next sample and set the time index t t t s then go to 2 3 8 acado toolkit acado toolkit houska and joachim 2014 is used for solving the underlying nmpc problem by generating a highly efficient c code used for real time implementation and matlab executable mex files used for simulation with matlab the main steps of the implementation are briefly described as follow the continuous state space model is symbolically defined using c code or the matlab interface then it is simplified employing automatic differentiation tools and using zero entries in the jacobian matrix the result is an efficient real time c code for the integration of the continuous nonlinear system which will be used for the prediction the optimization problem cost function and constraints are symbolically defined discretized by the aforementioned direct multiple shooting technique and the resulting large but sparse quadratic problem qp is condensed the discretized problem is then passed to a gauss newton iterative algorithm to get a tailored algorithm for solving the underlying qp problem finally qpoases solver which is designed based on embedded variant of the active set method is used to export c code using fixed dimensions and static memory 4 simulation results in this section simulation results are presented to demonstrate the validity and assess the performance of the proposed nmpc ndo scheme for tracking of the underactuated ship 1 with collision avoidance and under the disturbance of external forces simulation is done on matlab 2014b with the mex files exported using acado toolkit and qpoases these results have been obtained on a 3 3 ghz core i5 cpu with 8 gb ram the ship chosen for simulation is a monohull ship with a length of 32 m a mass of 118 10 3 k g and other parameters calculated by using vessel response veres a program that calculates the added mass and damping matrices for surface ships as in table 1 do et al 2002 the prediction horizon length is selected to be t p 200 s and the sampling interval is selected to be t s 5 which both lead to a discrete horizon of n 40 samples the matrices q and r are chosen to be diagonal to weight each state and control law independently with the values given in table 2 the ndo convergence rate is chosen to be k w 0 1 and the external disturbances with respect to inertial frame are w 11 k n 10 k n 5 k n m t four different scenarios are presented to assess the proposed technique the first one considers static obstacles and other three consider the typical collision situations head on overtaking and crossing in all of them own vessel has a straight line reference trajectory and its initial condition is x 0 100 100 0 5 0 0 t the reference trajectory is generated by the reference model 5 using the initial condition x r 0 0 0 π 4 5 0 0 t the constraints for the surge force and yaw moment are chosen to guarantee the compactness of u as follow 21 0 0 n τ u 135 10 3 n 22 10 0 10 8 n m τ r 10 0 10 8 n m 4 1 scenario 1 scenario 1 assess the validity of our approach for avoiding collision with static obstacles two obstacles are chosen to be at x o 1 y o 1 4000 m 4000 m and x o 2 y o 2 3000 m 5865 m the radii of the obstacles are assumed to be r o 1 100 m and r o 2 100 m and the required safety distances are selected to be 50 m and 50 m respectively this results in safety radii of r 1 150 m and r 2 150 m the tracking trajectory of the vessel is presented in fig 5 a and the surge sway and yaw velocities are presented in fig 5b 5c and 5d respectively the surge force and yaw moments are presented in fig 5g and h in the case without ndo the proposed technique of nmpc can track the trajectory with a small error but using the nmpc ndo scheme the vessel can track the desired trajectory with almost zero error in both cases collision avoidance constraints and surge force and yaw moment constraints are respected it is clear in fig 5e and 5f that the heading and course angles are not equal due to the transverse component of the environmental forces and the controller can not lead to zero tracking error for the heading angle but almost zero for the course angle as shown in fig 6 the local maximum deviations from the reference trajectory excluding the transient period at the beginning of the simulation occur twice while avoiding collision with both obstacles and at which the collision avoidance constraint is active they correspond to about 169 m and 161 m for the ndo case which are quite acceptable relative to the safety radii of 150 m and about 207 m and 173 m for the case of not using the ndo when the collision avoidance constraint is not active the maximum deviation for the cases with ndo and without ndo are 1 m and 55 m respectively for both cases the physical force and moment constraints are respected 4 2 scenario 2 in order to assess the performance of the proposed technique for avoiding collision with dynamic objects i e encountered vessels another vessel is assumed to confront with own vessel in a head on situation this vessel is assumed to have no collision avoidance scheme and its position and velocity are assumed to be measured or exchanged via a communication link the predicted trajectory is calculated using the constant velocity model 18 the encountered vessel is assumed to have a length of 60 m and safety distance of 40 m this results in a safety radius r 1 100 m the tracking trajectory of the vessel is presented in fig 7 a and the surge sway and yaw velocities are presented in fig 7b c and 7d respectively the surge force and yaw moments are presented in fig 7g and h it is shown in fig 9 that the trajectory tracking error of the nmpc ndo scheme is close to zero except during the collision avoidance maneuver which achieve a deviation of about 110 m which is considered small with respect to the 100 m safety radius on the other side the case of not using ndo leads to a distance error of 125 m and 84 m while collision constraint is active and not active respectively in both cases collision avoidance constraints and surge force and yaw moment constraints are respected regardless of using ndo the collision avoidance constraint in both schemes leads to a new collision free trajectory as close as possible to the reference trajectory the minimum distance d between the centers of both vessels is about 102 m as shown in fig 8 which demonstrates the ability to use our scheme as a last line of defense as this distance is slightly greater than the 100 m safety distance 4 3 scenario 3 in this scenario the overtaking situation is assessed by bringing the encountered vessel on the same path of own vessel but at a lower speed with the same simulation parameters as in scenario 1 as shown in fig 10 a own vessel maneuvers to the starboard side according to rule 13 of colregs then maneuvers back to the original trajectory after overtaking the other vessel the surge sway and yaw velocities are presented in fig 10b c and 10d respectively while fig 10e and f shows the heading and course angles in fig 10g and h the surge force and yaw moment generated by our nmpc scheme are shown the minimum distance d between both vessels is about 105 m 4 4 scenario 4 scenario 4 tackles the crossing situation where the encountered vessel has path perpendicular to the path of own vessel with a collision designed to occur at the position x y 4000 m 4000 m fig 11 show the states and the control action for this scenario it is shown in fig 11a that own ship obeys rule 15 of colregs by turning to the starboard side and passing at aft of the encountered vessel keeping a minimum distance d of about 115 m and then tracks the generated trajectory when the collision risk is over as the nmpc scheme does not have an integrator action and relies on the model for the calculating the control action tracking error is inevitable due to external disturbances and model uncertainty the ndo will estimate external disturbances and will act as an integrator for the control law as the vessel starts from an initial condition different from the reference in both scenarios the surge speed deviates the reference until the position error approaches zero which is achieved by increasing the position factors of the weighing matrix q over the velocity factors this speed deviation happens also in case of collision risk due to the collision avoidance maneuver the worst case execution time of the generated code on the aforementioned computer is about 4 ms which is extremely small compared to the 5 0 s sampling interval and facilitates implementation of the algorithm in real time 5 conclusion a robust nmpc scheme is presented for tracking of underactuated surface vessels with an integrated collisions avoidance technique a 3 dof model is used with only two control variables surge force and yaw moment employing a quadratic cost function real time efficient c code is generated using the acado toolkit and qpoases solver with collision avoidance as an inequality constraints for the optimization problem these constraints can handle both static and dynamic objects by satisfying the distance constraint between the predicted position of both the vessel and the obstacle over the horizon a mex file version of the code is called by matlab at each sampling interval to obtain the results external forces are modeled as unmeasured disturbances and are estimated using ndo to be fed into the nmpc prediction model simulation results show the ability of the proposed scheme to track both straight line and curved trajectories while satisfying control law constraints and achieving collision avoidance of encountered static or dynamic objects rules 13 14 and 15 of colregs are obeyed to avoid random behavior of the solver the combined nmpc ndo scheme shows good robustness to external forces that leads to almost zero tracking error the maximum execution time of the implemented algorithm is less than 4 ms which amounts to appr 0 08 of the sampling interval due to the efficient implementation of the optimization routines future research will aim at implementing that on oldenburg university s autonomous vessel named marine observation platform for surfaces mops that will also include the time delay and uncertain measurement of nearby objects into the controller synthesis including the 3 dof dynamics in the collision avoidance maneuvering makes the presented approach useful to act as a last line of defense specially in the situation of restricted maneuverability which will be also considered for future work it will as well account for a more sophisticated approaches for the prediction of encountered vessels motion 
23331,this paper presents a combined nonlinear model predictive control nmpc for position and velocity tracking of underactuated surface vessels and collision avoidance of static and dynamic objects into a single control scheme with sideslip angle compensation and environmental disturbances counteraction a three degree of freedom 3 dof dynamic model is used with only two control variables namely surge force and yaw moment external environmental forces are considered as constant or slowly varying disturbances with respect to the inertial frame and hence nonlinear for the body frame of the vessel nonlinear disturbance observer ndo is used to estimate these disturbances in order to be fed into the prediction model and enhance the robustness of the controller a nonlinear optimization problem is formulated to minimize the deviation of the vessel states from a time varying reference generated over a finite horizon by a virtual vessel sideslip angle is considered in the cost function formulation to account for tracking error caused by the transverse external force in the absence of sway control force collision avoidance is embedded into the trajectory tracking control problem as a time varying nonlinear constraint of position states to account for static and dynamic obstacles matlab simulations are used to assess the validity of the proposed technique keywords nonlinear model predictive control nmpc nonlinear disturbance obersver ndo collision avoidance trajectory tracking underactuated vessel 1 introduction path following techniques of vessels have gained a lot of interest from both academia and industry specially for the future expectations of using commercial autonomous vessels or adding an autopilot to assist the crew to make these techniques practical collision avoidance should be integrated in the control problem to guarantee safe maneuvering during the trip collision risk is increased in the presence of external forces such as those induced by wind and waves motivated by these requirements surface vessels should be able to keep the planned trajectory while avoiding collision of nearby objects and counteraction external disturbances the challenge is increased for underactuated surface vessels which are usually equipped with two independent aft thrusters or with one main aft thruster and a rudder and hence have only two control variables namely surge force and yaw moment in recent years trajectory tracking has been studied using various control techniques for instance dynamic surface control dsc technique is used in chwa 2011 for global tracking of underactuated vessel in a modular way that cascaded kinematic and dynamic linearizations can be achieved in peng et al 2013 wang et al 2014 an adaptive form of dsc is used for formation control of autonomous surface vehicles asvs moving in a leader follower formation under ocean disturbances in kahveci and ioannou 2013 an automatic adaptive steering control design for full actuated vessels is presented the adaptive law is combined with a control design including a linear quadratic controller lqr and a riccati based anti windup compensator the controller also takes into consideration input constraints wind and wave effects and parametric uncertainty in dong et al 2015 a trajectory tracking problem is addressed for a 3 dof underactuated unmanned surface vessel usv using a state feedback based backstepping control algorithm with relaxed persistent exciting pe conditions of yaw velocity in jiang and nijmeijer 1999 a recursive technique is presented for trajectory tracking of nonholonomic systems by the means of backstepping and is demonstrated by simulating an articulated vehicle and a knife edge system in do and pan 2004 a methodology for designing state and output feedback controller is presented by means of lyapunov s direct method and backstepping after model transformation to serret frenet frame although the aforementioned techniques give good trajectory tracking results collision avoidance of nearby objects is not addressed model predictive control mpc has got attention for trajectory tracking control problems because of its systematic ability to handle physical constraints of the system künhe et al 2005 in guerreiro et al 2014 nmpc is used for trajectory tracking of a full actuated autonomous surface craft asc in the presence of constant ocean currents in yan and wang 2012 mpc is applied for tracking problem of underactuated surface vessels employing the affine property of the system model the kinematic is simplified by applying frame transformation to make positions independent of the choice of the inertial frame nonlinear functions of the system are evaluated using optimal states obtained at the previous instant which leads to significant numerical errors for large horizons mayne 1016 in abdelaal et al 2015 nmpc is used for trajectory tracking of an underactuated vessels employing direct multiple shooting technique that leads to less numerical error the aforementioned mpc approaches do not cater for collision avoidance conventionally collision avoidance is treated as a controller independent planning problem that might not be achievable by the controller and hence degrades the safety of the vessel wang et al 1016 for instance an evolutionary algorithm is presented in smierzchalski 1999 to find a safe and optimal trajectory of surface vessels in a well known environment by using the vessel s kinematic model a more sophisticated evolutionary approach is presented in szlapczynski 2011 2012 szlapczynski and szlapczynska 2012 by adding specialized operators to shape the convergence of the optimization in zhuo 2014 a fuzzy logic approach is presented for collision avoidance of large ships by formulating the problem into an optimization problem and solving it using a particle swarm algorithm fuzzy neural inference network is also used in liu and shi 2005 for ship collision avoidance in wang et al 2017a collision avoidance is achieved in two steps a path planning collision avoidance and an mpc for following the generated path after linearizing the dynamics of the vessel in wang et al 2017b a collision avoidance dynamic support system is presented where a mathematical model of ship maneuvering motion and a pid heading controller are employed as well as dynamic calculation model of collision avoidance parameter a graph theoretic solution on an appropriately weighted directed graph representation of the navigation area is presented in ari et al 2013 the graph is obtained via 8 adjacency integer lattice discretization and utilization of the a algorithm although the aforementioned techniques demonstrate collision avoidance they either simplify or ignore the dynamics of the vessel and the effect of external environmental forces recently control techniques have been developed to include collision avoidance as an objective while designing the controllers in wang and ding 2014 mpc is used for the tracking and formation problem of multiagent linear systems with collision avoidance as a constraint for the optimization problem in alrifaee et al 2014 a centralized mpc is used for collision avoidance of networked vehicles by successively linearizing the nonlinear prediction model using taylor series in wang et al 1016 an mpc technique is applied for the nonlinear model of kinematically redundant space robot to approach an un cooperative target in complex space environment for the sake of deriving a linearized version of the space robot feedback linearization is used and hence collision avoidance can be formulated as a linear matrix inequality lmi the aforementioned model predictive techniques consider the collision avoidance but they lack handling of external disturbances for underactuated systems in johansen et al 2016 mpc is used for collision avoidance by pre computing a finite set of control behaviors and then simulating on line these behaviors to check which scenario gives the optimal trajectory the objective of this paper is to introduce the concept of integrating collision avoidance into the trajectory tracking controller based on mpc concepts to act as a last line of defense for autonomous vessels for such critical maneuvering accuracy is necessary and therefore comes the necessity of employing full planar motion nonlinear dynamics and effect of external disturbances in this paper a nonlinear state feedback control law is presented based on solving a finite horizon optimization problem at every instant and using the current state measurement as initial condition for the problem the problem takes into consideration the physical constraints of the vessel by systematically adding them to the optimization problem constraints collision avoidance constraints are added to the problem that force the vessel to deviate minimally from the defined path in case of predicting a collision while obeying some of the rules of the international regulations for preventing collisions at sea colregs external forces are taken into consideration as unmeasured disturbance and therefore the nmpc law is modified to include the disturbance estimated by ndo and handle the external transverse force component where there is no corresponding control force to counteract the output of the problem is an optimal sequence of length n of the vesselâ s force and moment the first element only is applied and then the whole process is repeated at the next instant the finite horizon optimization problem is discretized and then formulated as a quadratic problem qp which is solved by the aid of acado toolkit houska et al 2011 and qpoases solver qpoases homepage this paper is organized as follows section 2 describes the vessel nonlinear dynamics external disturbance modeling generation of the reference trajectory and clarifies the control objective controller synthesis is presented in section 3 a brief introduction of nmpc is given first followed by the nonlinear disturbance observer design a cost function modification is then presented to include sideslip angle along with the conditions required to guarantee stability of the nonlinear system collision avoidance compliance of some colregs rules discretization and implementation of the proposed approach the matlab based simulation results are given in section 4 section 5 concludes this paper 2 problem formulation the surface vessel model has 6 dof surge sway yaw heave roll and pitch which can be simplified to motion in surge sway and yaw under the following assumptions chwa 2011 1 the heave roll and pitch modes induced by wind and currents are negligible 2 the inertia added mass and hydrodynamic damping matrices are diagonal 3 the available control variables are surge force and yaw moment based on that the 3 dof model will be fossen 2011 1 x u cos ψ υ sin ψ y u sin ψ υ cos ψ ψ r u m 2 m 1 υ r d 1 m 1 u 1 m 1 τ u υ m 1 m 2 u r d 2 m 2 υ r m 1 m 2 m 3 u υ d 3 m 3 u 1 m 3 τ r here x and y are the positions ψ is the heading angle of the ship with respect to the earth fixed frame u and υ are the longitudinal and transverse linear velocities in surge body fixed x and sway body fixed y directions respectively and r is the angular velocity in yaw around body fixed z axis see fig 1 the parameters m 1 m 2 m 3 are the ship inertia including added mass effects and d 1 d 2 d 3 are the hydrodynamic damping coefficients external environmental forces induced by the wind and wave current are assumed to be constant with respect to the inertial reference frame and have three components surge sway and yaw therefore the vessel model written in a compact form will be modified to be 2 x f x g 1 x u g 2 b x w b where x x y ψ u υ r t ℜ 6 is the state vector u τ u τ r t ℜ 2 is the input vector of surge force and yaw moment only w b w u w υ w r t ℜ 3 is the external forces and moment vector acting on surge sway and yaw directions and expressed in the body fixed frame f x u cos ψ υ sin ψ u sin ψ υ cos ψ r m 2 m 1 υ r d 1 m 1 u m 1 m 2 u r d 2 m 2 υ m 1 m 2 m 3 u υ d 3 m 3 u ℜ 6 g 1 x 0 0 0 1 m 1 0 0 0 0 0 0 0 1 m 3 t ℜ 6 ℜ 2 and g 2 b x 0 0 0 1 m 1 0 0 0 0 0 0 1 m 2 0 0 0 0 0 0 1 m 3 t ℜ 6 ℜ 3 external environmental forces need to be expressed in the inertial reference frame to be independent from the heading angle of the vessel therefore the transformation matrix between body and inertial frames will be used as follows fossen 2011 3 w b cos ψ sin ψ 0 sin ψ cos ψ 0 0 0 1 w w ℜ 3 here w is the vector of external forces with respect to inertial reference frame combining 2 and 3 we obtain the model employed throughout the rest of the paper 4 x f x g 1 x u g 2 x w where g 2 x 0 0 0 cos ψ m 1 sin ψ m 2 0 0 0 0 sin ψ m 1 cos ψ m 2 0 0 0 0 0 0 1 m 3 t a time varying reference trajectory is generated by a virtual ship with the same dynamics as 2 but without the effect of external forces 5 x r f x r g 1 x r u r where x r x r y r ψ r u r υ r r r t denotes the generated reference states the same assumptions as in yan and wang 2012 are adopted throughout this paper assumption 1 all ship state variables position orientation and velocities are measurable or can be accurately estimated assumption 2 the reference velocities and positions are smooth over time hence the control objective is to steer the vessel states x y ψ u υ r to follow the reference states x r y r ψ r u r υ r r r while satisfying control input and collision avoidance constraints 3 controller synthesis 3 1 nonlinear model predictive control consider a continuous time invariant nonlinear state space model of the vessel in the form of 4 subject to the constraints 6 x t x u t u c x t u t c t 0 where x ℜ n is the state vector u ℜ m is the control vector f g 1 and g 2 are continuous nonlinear functions f 0 0 g 1 0 0 and g 2 0 0 x ℜ n and u ℜ m are compact sets and contain the origin in their interior points in general the scheme of mpc is to predict the future states over some finite prediction horizon using a nominal model as in 4 for the system and the last available measurement or accurate estimation of the states to get the optimum control action over a control horizon control vector the control horizon is less than or equal to the prediction horizon this control vector steers the system states to follow a time varying reference generated by a model of the form 5 thereafter the first element of the control vector is applied and the whole process is repeated at the next sample hence nmpc is considered as a nonlinear state feedback u k k x k obtained online from an optimal control problem that minimizes a least squares ls objective function penalizing the deviation of the system inputs and states from the reference trajectories it takes the form 7a min x t u t j x u t t 0 t p t 0 ℓ x t u t d t f x t p subject to 7b x t f x g 1 x u g 2 x w 7c x t x 7d u t u 7e c x t u t c where ℓ x t u t is the stage cost function and must satisfy the following conditions ℓ x r t u r t 0 ℓ x t u t 0 x t x u t u x t x r t f x t p is the terminal cost function t p 0 is length of both the prediction and control horizons and the external disturbance w is known or estimated the stage and terminal cost functions are usually defined as weighted norm of the states and control input errors yang and zheng 2014 8 ℓ x t u t x t x r t q u t u r t r 9 f x t p x t p x r t p p here q r p are positive semidefinite weighing matrices control variables are penalized because that makes the optimization problem easier and avoid control values of high energy grüne and pannek 2011 3 2 nonlinear disturbance observer external environmental forces might lead to a tracking error if they are not considered in the controller design hence a measurement or estimation of these disturbances is required the concept of disturbance observers do was introduced by ohnishi in 1987 nakao et al 1987 in many control loops the external disturbances can be modeled by an additive signal added to the control signal parsa and farrokhi 2010 in fossen 2000 a nonlinear disturbance observer is designed for vessels under the approximation that g 2 x g 2 ψ g 2 ψ ψ w where ψ w is the wave induced yaw disturbance which is suitable for the dynamic positioning application presented in that paper the sway force is estimated in aschemann and rauh 2010 while the surge and yaw disturbances are compensated using the integral term of the pid in this subsection a nonlinear observer is designed to estimate the three components of the disturbances without approximation of the matrix g 2 x knowing the disturbance value it can be compensated by adding an appropriate canceling signal that has the disturbance magnitude but in the opposite sign or equivalently in the case of mpc including it in the prediction model the main idea of disturbance observers is to estimate the equivalent disturbance by comparing the control input to the real system with the virtual control input to the nominal model the virtual control input is derived from the inverse of the nominal model nikoobin and haghighi 2009 the estimated value is fed back as a cancellation signal and then makes the whole system to behave like the nominal system for vessels external forces should be estimated as they are not measured in real time the combined structure of nmpc with disturbance observer is demonstrated in fig 2 since the vessel dynamics are highly nonlinear a nonlinear disturbance observer ndo presented in chen et al 2000 is used to estimate the unknown but constant or slowly time varying external forces consider the vessel nonlinear model as in 4 where x ℜ 6 u ℜ 2 and w b ℜ 3 it is assumed that f x g 1 x and g 2 x are smooth in terms of x li et al 2014 to estimate the unknown disturbance the following disturbance observer is suggested li et al 2014 chen 2004 10a z l x g 2 x z g 2 x p x f x g 1 x u 10b w ˆ z p x where z ℜ 3 is the internal state of the nonlinear observer and p x is the nonlinear function to be designed the nonlinear disturbance observer gain l x is determined by 11 l x p x x the estimation error is governed according to li et al 2014 12 e w w w l x g 2 x e w hence the ndo design can estimate unknown constant disturbances if the observer gain l x is chosen such that system 12 is asymptotically stable one possible choice for l x is 13 l x k w g 2 x 1 k w 0 0 0 0 0 0 m 1 u sin ψ m 2 υ cos ψ m 1 u cos ψ m 2 υ sin ψ 0 m 1 cos ψ m 1 sin ψ 0 m 2 sin ψ m 2 cos ψ 0 0 0 m 3 t k w is a scalar that determines the convergence rate of the observer and g 2 x 1 ℜ 3 ℜ 6 is the pseudo inverse of g 2 x by integrating 11 with respect to x p x will be 14 p x m 1 u cos ψ m 2 υ sin ψ m 1 u sin ψ m 2 υ cos ψ m 3 r this choice makes the observer estimation error linear with eigenvalues equal to the scalar k w 3 3 sideslip angle compensation in the case of undereducated vessels the controller can not reject the disturbance force component in the sway direction as there is no sway control force generated by the actuators of the vessel even if the disturbance value is known although the terms course and heading are used interchangeably in much of the literature on guidance navigation and control of marine craft fossen 2011 they are not equivalent and this leads to confusion here they are going to be used differently hence the following definitions adopted from fossen 2011 breivik and fossen 2004 are required to avoid this confusion see fig 3 definition 1 velocity vector it is the specification of the vessels s speed u u 2 υ 2 and orientation β tan 1 υ u with respect to the vessel s body reference frame definition 2 sideslip drift angle β the angle from x b axis to the velocity vector of the vessel positive rotation about the z i axis by the right hand screw convention definition 3 heading yaw angle ψ the angle from x i axis to the x b axis positive rotation about the z i axis by the right hand screw convention definition 4 course angle χ the angle from x i axis to the velocity vector of the vessel positive rotation about the z i axis by the right hand screw convention by these definitions it is clear that χ ψ β and in case of straight line motion the sideslip angle β will be zero and both heading and course angles will be equal except in case of external disturbance acting on the transverse direction in this case the sway velocity will not be zero and hence heading and course angle are not equal even for straight line motion in order to overcome the aforementioned limitation due to the absence of sway control force the heading angle ψ in the stage cost function 8 is going to be replaced with the course angle χ as the vessel will not be able to achieve zero tracking error for the heading angle in case of external disturbance in the sway direction this will lead to a non zero sideslip angle even if the ship is moving in straight line but will create a force component that rejects the sway disturbance occurred in the zero sideslip angle case based on that the control objective will be steering the vessel states to track the reference states except for the heading angle ψ and the vessel course angle χ to track the reference course angle χ r where χ r ψ r β r therefore the stage cost function will be modified to 15 ℓ x t u t x t x r t q u t u r t r where x x y χ u υ r t and x r t x r y r χ r u r υ r r r t this is motivated by the research done in fossen et al 2014 where sideslip angle is taken into account to cope with high wind and tide conditions and achieve higher tracking accuracy even for smaller ship speeds 3 4 collision avoidance conventionally collision avoidance is treated as controller independent planning problem wang et al 1016 the solution of the problem might not be achievable by the controller due to adverse environmental conditions and ignored vessel dynamics to overcome that and exploiting the nmpc ability to integrate state constraints systematically into its optimization problem obstacles are assumed to have circular shape and collision avoidance is translated into an inequality constraint integrated into the controller design of the form 16 x t x o i t 2 y t y o i t 2 r i where x t and y t are the prediction of the position for own vessel over the prediction horizon x o i t and y o i t are the prediction of the position for the i t h obstacle and r i is the safety radius measured from the center of the vessel the safety radius will be selected to be 17 r i r o i d s i l 2 where r o i is the radius of the circular envelop for the i t h obstacle l is the length of our vessel and d s i is the safety distance required between the vessel and the i t h obstacle if the obstacle is a ship the radius of its circular envelope will be selected to be half of its length due to lack of information about the encountered vessels acceleration the assumption of constant velocity is used in order to use the above collision avoidance constraint for moving vessels future motion prediction of encountered vessels is required it is assumed that own vessel is equipped with a radar or lidar that provides the controller with the position of the obstacles as well as an ais arpa system that provides necessary information such as velocity course and the length of the vessel the motion prediction of encountered vessels will be predicted using the constant velocity cv model presented in rong li and jilkov 2003 in this model the vessel is assumed to move in straight line with constant velocity the direction of motion is used as the course angle of the vessel χ it takes the form 18 x t x t 0 x δ t y t 0 y δ t arctan y x x t 0 y t 0 0 t 0 t t p where δ t t t 0 3 5 colregs compliance the maneuvering occurred due to the optimal solution of the nmpc problem 7 with the collision avoidance constraint 16 as a state constraint might be random in the sense of maneuvering direction and not necessarily compliant to the international regulations for preventing collisions at sea colregs colregs 1972 that set rules for the actions a vessel should follow when encountering other vessels at sea we will focus on the three typical situations head on overtaking and crossing which are described in rules number 13 14 and 15 of section 2 of colrges and depicted in fig 4 in a head on situation between two vessels both vessels must turn to the starboard side so that they pass on the port side of each other in an overtaking situation the overtaking vessel can turn to either starboard or port side according to the situation and starboard is chosen for our algorithm when two vessels are crossing each other the vessel which has the other on the starboard side must give way and avoid crossing ahead of her we here conclude that the vessel should prioritize maneuvering to starboard side therefore the optimization problem will be reformulated by adding a soft constraint on the rate of change of yaw moment to prioritize the ship maneuvering to the starboard side the final form of the optimization problem used is 19a min x t u t j x u t t 0 t p t 0 ℓ x t u t d t f x t p subject to 19b x t f x g 1 x u g 2 x w ˆ 19c u t u 19d x t x o i t 2 y t y o i t 2 r i 19e τ r s l k 0 19f s l k 0 where s l k is a positive slack variable used for softening the constraint 19e to give priority to negative yaw moment i e turning to starboard τ u m i n and τ u m a x are the minimum and maximum limits for surge force and τ r m i n and τ r m a x are the minimum and maximum limits for sway moment the stage cost function will be modified to add penalty on the slack variable as follows 20 ℓ x t u t x t x r t q u t u r t r s l k t s 3 6 stability of nmpc to guarantee asymptotic stability by using the control law u k k x k it is desirable to use infinite prediction and control horizons i e set n in 7 but it is not feasible to get the solution of the infinite horizon nonlinear optimization problem magni et al 2001 on the other hand stability can be guaranteed for finite horizon problems by suitably choosing a terminal cost f and a terminal attractive region ω this result has been studied in magni et al 2001 mayne et al 2000 ong et al 2006 chen and allgöwer 1998 and conditions required for that will be summarized as follow 1 u ℜ m is compact and x ℜ n is connected and contains the origin in the interior of u x 2 the vector field f ℜ n ℜ m ℜ n is locally lipschitz in x and satisfy f 0 0 0 3 the aforementioned conditions on ℓ are satisfied 4 the terminal penalty f is continuous with f 0 0 and the terminal attractive region satisfies ω x x f x e for some e 0 5 the nmpc problem has initially a feasible solution 6 for any x ω there exists a u u such that f x f x u ℓ x u 0 z ω for our problem the constraints on the states are only for the position so without loss of generality we can assume that the feasible set has always the origin in the interior by simple axis transformation control constraints are usually selected to be linear inequalities as shown in 21 and therefore the set u is compact although there are clear conditions for the asymptotic stability designing the terminal cost f and the attractive region ω is still an open problem and may make the online optimizations more difficult and time consuming to solve jadbabaie and hauser 2005 in grüne and pannek 2011 it was shown that asymptomatic stability can be guaranteed just by tuning p q and r closed loop stability is achieved for relatively long horizons without the need to use terminal cost or terminal constraint jadbabaie and hauser 2005 based on that cost function 7 with ℓ selected as in 15 will be used in this paper and without a terminal constraint 3 7 direct multiple shooting in order to solve the optimization problem 7 a direct multiple shooting technique bock and plitt 1984 derived from the solution of boundary value problems of differential equations is used the concept of this technique is based on uniform discretization of the horizon into n smaller intervals using one of the rungeâ kutta methods such that t 0 t 0 t 1 t n t p solving an initial value problem in each of the smaller intervals t j t j 1 and imposing additional matching conditions to form a solution on the whole horizon all rungeâ kutta variants provide first and second order differentiation techniques in order to compute sensitivities of the state trajectory with respect to initial states and control inputs other integrators are used in case of algebraic differential equations thereafter the problem constraints are evaluated on the grid nodes t j and the control vector has been parametrized as piecewise constant the result of this technique is a least squares nonlinear programming nlp with fixed dimensions that can be solved employing gauss newton method the ndo equation 10 is discretized at a sampling interval t s t p n using radau iia fifth order implicit method one of runge kutta methods for numerical solution of the ordinary differential equation this discrete model will be used for estimating the current value of the external disturbance that is assumed to be constant over the nmpc horizon of n elements based on that the nmpc ndo scheme is summarized as follow 1 set the time index t t 0 the prediction horizon t p sampling interval t s weight matrices q and r the observer convergence rate k w and the disturbance initial value w ˆ t 0 0 2 get the value of the states x 3 get the obstacles position x o i and y o i 4 solve the optimization problem 7 and get optimal input vector u t 0 u t n and the predicted states x t 0 x t n 5 apply only the first element u t 0 6 solve the ndo 10 to get the estimated value for the disturbance w ˆ t t s 7 wait for the next sample and set the time index t t t s then go to 2 3 8 acado toolkit acado toolkit houska and joachim 2014 is used for solving the underlying nmpc problem by generating a highly efficient c code used for real time implementation and matlab executable mex files used for simulation with matlab the main steps of the implementation are briefly described as follow the continuous state space model is symbolically defined using c code or the matlab interface then it is simplified employing automatic differentiation tools and using zero entries in the jacobian matrix the result is an efficient real time c code for the integration of the continuous nonlinear system which will be used for the prediction the optimization problem cost function and constraints are symbolically defined discretized by the aforementioned direct multiple shooting technique and the resulting large but sparse quadratic problem qp is condensed the discretized problem is then passed to a gauss newton iterative algorithm to get a tailored algorithm for solving the underlying qp problem finally qpoases solver which is designed based on embedded variant of the active set method is used to export c code using fixed dimensions and static memory 4 simulation results in this section simulation results are presented to demonstrate the validity and assess the performance of the proposed nmpc ndo scheme for tracking of the underactuated ship 1 with collision avoidance and under the disturbance of external forces simulation is done on matlab 2014b with the mex files exported using acado toolkit and qpoases these results have been obtained on a 3 3 ghz core i5 cpu with 8 gb ram the ship chosen for simulation is a monohull ship with a length of 32 m a mass of 118 10 3 k g and other parameters calculated by using vessel response veres a program that calculates the added mass and damping matrices for surface ships as in table 1 do et al 2002 the prediction horizon length is selected to be t p 200 s and the sampling interval is selected to be t s 5 which both lead to a discrete horizon of n 40 samples the matrices q and r are chosen to be diagonal to weight each state and control law independently with the values given in table 2 the ndo convergence rate is chosen to be k w 0 1 and the external disturbances with respect to inertial frame are w 11 k n 10 k n 5 k n m t four different scenarios are presented to assess the proposed technique the first one considers static obstacles and other three consider the typical collision situations head on overtaking and crossing in all of them own vessel has a straight line reference trajectory and its initial condition is x 0 100 100 0 5 0 0 t the reference trajectory is generated by the reference model 5 using the initial condition x r 0 0 0 π 4 5 0 0 t the constraints for the surge force and yaw moment are chosen to guarantee the compactness of u as follow 21 0 0 n τ u 135 10 3 n 22 10 0 10 8 n m τ r 10 0 10 8 n m 4 1 scenario 1 scenario 1 assess the validity of our approach for avoiding collision with static obstacles two obstacles are chosen to be at x o 1 y o 1 4000 m 4000 m and x o 2 y o 2 3000 m 5865 m the radii of the obstacles are assumed to be r o 1 100 m and r o 2 100 m and the required safety distances are selected to be 50 m and 50 m respectively this results in safety radii of r 1 150 m and r 2 150 m the tracking trajectory of the vessel is presented in fig 5 a and the surge sway and yaw velocities are presented in fig 5b 5c and 5d respectively the surge force and yaw moments are presented in fig 5g and h in the case without ndo the proposed technique of nmpc can track the trajectory with a small error but using the nmpc ndo scheme the vessel can track the desired trajectory with almost zero error in both cases collision avoidance constraints and surge force and yaw moment constraints are respected it is clear in fig 5e and 5f that the heading and course angles are not equal due to the transverse component of the environmental forces and the controller can not lead to zero tracking error for the heading angle but almost zero for the course angle as shown in fig 6 the local maximum deviations from the reference trajectory excluding the transient period at the beginning of the simulation occur twice while avoiding collision with both obstacles and at which the collision avoidance constraint is active they correspond to about 169 m and 161 m for the ndo case which are quite acceptable relative to the safety radii of 150 m and about 207 m and 173 m for the case of not using the ndo when the collision avoidance constraint is not active the maximum deviation for the cases with ndo and without ndo are 1 m and 55 m respectively for both cases the physical force and moment constraints are respected 4 2 scenario 2 in order to assess the performance of the proposed technique for avoiding collision with dynamic objects i e encountered vessels another vessel is assumed to confront with own vessel in a head on situation this vessel is assumed to have no collision avoidance scheme and its position and velocity are assumed to be measured or exchanged via a communication link the predicted trajectory is calculated using the constant velocity model 18 the encountered vessel is assumed to have a length of 60 m and safety distance of 40 m this results in a safety radius r 1 100 m the tracking trajectory of the vessel is presented in fig 7 a and the surge sway and yaw velocities are presented in fig 7b c and 7d respectively the surge force and yaw moments are presented in fig 7g and h it is shown in fig 9 that the trajectory tracking error of the nmpc ndo scheme is close to zero except during the collision avoidance maneuver which achieve a deviation of about 110 m which is considered small with respect to the 100 m safety radius on the other side the case of not using ndo leads to a distance error of 125 m and 84 m while collision constraint is active and not active respectively in both cases collision avoidance constraints and surge force and yaw moment constraints are respected regardless of using ndo the collision avoidance constraint in both schemes leads to a new collision free trajectory as close as possible to the reference trajectory the minimum distance d between the centers of both vessels is about 102 m as shown in fig 8 which demonstrates the ability to use our scheme as a last line of defense as this distance is slightly greater than the 100 m safety distance 4 3 scenario 3 in this scenario the overtaking situation is assessed by bringing the encountered vessel on the same path of own vessel but at a lower speed with the same simulation parameters as in scenario 1 as shown in fig 10 a own vessel maneuvers to the starboard side according to rule 13 of colregs then maneuvers back to the original trajectory after overtaking the other vessel the surge sway and yaw velocities are presented in fig 10b c and 10d respectively while fig 10e and f shows the heading and course angles in fig 10g and h the surge force and yaw moment generated by our nmpc scheme are shown the minimum distance d between both vessels is about 105 m 4 4 scenario 4 scenario 4 tackles the crossing situation where the encountered vessel has path perpendicular to the path of own vessel with a collision designed to occur at the position x y 4000 m 4000 m fig 11 show the states and the control action for this scenario it is shown in fig 11a that own ship obeys rule 15 of colregs by turning to the starboard side and passing at aft of the encountered vessel keeping a minimum distance d of about 115 m and then tracks the generated trajectory when the collision risk is over as the nmpc scheme does not have an integrator action and relies on the model for the calculating the control action tracking error is inevitable due to external disturbances and model uncertainty the ndo will estimate external disturbances and will act as an integrator for the control law as the vessel starts from an initial condition different from the reference in both scenarios the surge speed deviates the reference until the position error approaches zero which is achieved by increasing the position factors of the weighing matrix q over the velocity factors this speed deviation happens also in case of collision risk due to the collision avoidance maneuver the worst case execution time of the generated code on the aforementioned computer is about 4 ms which is extremely small compared to the 5 0 s sampling interval and facilitates implementation of the algorithm in real time 5 conclusion a robust nmpc scheme is presented for tracking of underactuated surface vessels with an integrated collisions avoidance technique a 3 dof model is used with only two control variables surge force and yaw moment employing a quadratic cost function real time efficient c code is generated using the acado toolkit and qpoases solver with collision avoidance as an inequality constraints for the optimization problem these constraints can handle both static and dynamic objects by satisfying the distance constraint between the predicted position of both the vessel and the obstacle over the horizon a mex file version of the code is called by matlab at each sampling interval to obtain the results external forces are modeled as unmeasured disturbances and are estimated using ndo to be fed into the nmpc prediction model simulation results show the ability of the proposed scheme to track both straight line and curved trajectories while satisfying control law constraints and achieving collision avoidance of encountered static or dynamic objects rules 13 14 and 15 of colregs are obeyed to avoid random behavior of the solver the combined nmpc ndo scheme shows good robustness to external forces that leads to almost zero tracking error the maximum execution time of the implemented algorithm is less than 4 ms which amounts to appr 0 08 of the sampling interval due to the efficient implementation of the optimization routines future research will aim at implementing that on oldenburg university s autonomous vessel named marine observation platform for surfaces mops that will also include the time delay and uncertain measurement of nearby objects into the controller synthesis including the 3 dof dynamics in the collision avoidance maneuvering makes the presented approach useful to act as a last line of defense specially in the situation of restricted maneuverability which will be also considered for future work it will as well account for a more sophisticated approaches for the prediction of encountered vessels motion 
23332,the paper describes a numerical 3d modelling method to develop quadrilateral meshes for panel method calculations with an integrated solution to obtaining the mass properties from the same grid it aims to offer a more precise and versatile alternative to the spreadsheet type approach repeatedly used in early design stages of marine structures the given formulae additionally serve to obtain the mass properties of an existing grid without additional software the input format is in the form of matrices and can be altered within a script first the modelling approach is described followed by the calculation of the mass properties of volume weight inertia and the centre of gravity after detailing the principles various examples that encompass different geometric forms such as a torus an offshore platform and a ship are provided to demonstrate the usage the results of the mass property calculations are validated through comparisons with ansys and rhino3d the hydrodynamic mesh is evaluated in wamit by comparing models made with the presented approach to multisurf and rhinoceros3d with its panelingtools plugin a measure of performance is also included to provide a basis for loop type design procedures that utilise the given method keywords geometric design mesh grid hydrodynamic properties offshore platforms 1 introduction initial design stages contain a significant number of unknowns in settled industries such as shipbuilding the process begins with the cumulative knowledge from previous experiences and may progress into improving an existing geometric form e g papanikolaou 2010 ventura and guedes soares 2011 conversely in novel applications such as floating offshore wind turbine platforms the most favourable implementation is still under discussion bagbanci et al 2015 2012 robertson et al 2013 for instance as of 2013 over 80 platform concepts were being evaluated globally bossler 2013 with diverse approaches to the design problem considering the variety of forms to start from the number of unknowns is equally high for a new concept in all cases mathematical modelling of static and dynamic behaviour requires a correct representation of the mass and inertia if the structure is afloat underwater geometry related hydrodynamic coefficients become an additional requirement these properties are closely linked with the geometry of the platform hence involving cad software to get reliable estimates the same reasons that make the use of these sophisticated tools and software favourable at later design stages present a complication at the earlier design stages when the knowledge is limited to a concept preparing a set of iterations of 3d models for parametric studies as in tracy 2007 can become tedious another problem arises from the specialisation of tools some codes are made to perform a specific calculation well while expecting input from another source for instance wamit lee and newman 2005 is a verified code in hydrodynamic calculations provided that the six by six mass matrix is correctly provided erred mass will lead to errors in estimated motion responses accordingly this data needs to be prepared externally the procedure needs to be repeated for each iteration of the concept to remedy this problem in new designs researchers usually revert to avoiding sophisticated 3d modelling tools entirely and rely on spreadsheet calculations and simplifications as outlined in chakrabarti 2005 and utilised in bachynski and moan 2012 and leimeister et al 2016 this case creates a substantial gap between the higher complexity surface models such as nurbs and the simple hand calculations on a spreadsheet the issue is not only present at initial stages but also repeats itself from another perspective for optimisation studies two interlinked sides need to be considered in this regard mass properties and hydrodynamics obtaining the mass and inertia on a spreadsheet is less problematic when a partial analytical solution exists accordingly one approach is to introduce simplifications to describe the model removing some of its parts effectively reducing it to a form that is broken down into solvable components e g cylinders andersen et al 2015 hall et al 2014 roddier et al 2010 this is not a generic solution as it is inapplicable for a body that cannot be expressed as a set of basic shapes regarding hydrodynamics a solution to the hydrodynamic coefficients can be obtained from tabular data for members clauss et al 1992 sarpkaya and isaacson 1981 however if the platform requires a potential flow solution they will be inaccurate as discussed in an experiment to code comparison by adam et al 2013 in that case it is still necessary to build a 3d model despite the preliminary hand calculations furthermore the entire breakdown and calculation process needs to be repeated if the structure is altered as the solution is specific to a given body from the point of optimisation another problem arises a recently published work describing the evaluation of semisubmersible hulls for weight and heave motion park et al 2015 states that one of its main contributions is including mass as an optimisation variable unlike previous studies which took it as a constant clauss and birk 1996 lee et al 2007 lee and lim 2008 starting from bezier b spline curves the study assumes that the mass equals a statistically obtained constant multiplied by the surface area of a simplified version of the 3d model the reduced geometry is given as a set of rectangular prisms without the curvatures and other details of the hydrodynamic model in essence the approach is a reversal to the spreadsheet calculation inside a complex system the inertia is not mentioned therefore the study is limited to the heave mode in a manner similar to birk 2008 it should also be noted that a shortcoming of statistical data is that they do not exist for novel structures e g wind turbine platforms wave energy converters in another study that considers both mass and inertia venzon et al 2014 assumes the mass and the radius of gyration to be based on percentages of the main dimensions and takes a fixed position for the centre of gravity the rationale behind this decision is not explained in the work for tension leg platforms using an assumption of mass as in lee et al 2007 is especially problematic considering the relation between the tendon tension and the structural weight in the absence of proper inertia estimations the pitching and rolling effects on tendon tension are also overlooked in this regard with a large number of dependencies it is clear that the mass properties should preferably be calculated as opposed to assumed while this estimation may be more complicated for structures designed for significantly variable cargo e g tankers bulk carriers oil and gas platforms a mass matrix can be obtained for fixed loading type structures with a higher precision e g floating wind turbine platforms from a purely hydrodynamics point of view once the mass properties are calculated the estimation of responses will require evaluating a suitably prepared mesh as in jafaryeganeh et al 2015 and rodrigues and guedes soares 2014 the coefficients of the equations of motion rely on the underwater geometry and even smaller changes reflect in motion dynamics sutulo et al 2010 uzunoglu et al 2016 hence simplifications also lead to consequences such as altering the natural frequencies uzunoglu and guedes soares 2015a in sum it is beneficial to devise a consolidated approach to the problem a solution would be to implement the estimations of mass properties into the 3d meshes used in hydrodynamics while keeping the file format compatible additionally the calculation method should be mathematically simple so that it can be implemented by other researchers in any programming language and should avoid commercial cad tools it is also preferable to use a numerical input format as it has advantages regarding parameterisation for iterative design in that regard specialised approaches exist for parameterising bodies such as ships ko et al 2011 however with an increased number of unknowns in fields such as the design of floating wind turbine platforms flexibility assumes a larger role hence the solution should not be limited to an individual hull form this work outlines this type of a numerical solution to creating a quadrilateral mesh and obtaining its mass properties for a more precise solution at early design stages while it is mainly intended as a replacement for the commonly used spreadsheet methods the mass calculations apply to any grid mesh matrix data are utilised to input the geometry partial solutions of a section of the model provide the mass and volume distribution in space integration for the entirety of the structure delivers the model weight volume and inertia the output is then fed to wamit to validate the model s use in hydrodynamic calculations while the tool was initially developed for the numerical design of offshore platforms for wind turbines uzunoglu and guedes soares 2016 2015b it allows modelling a wider range of structures to illustrate this point and its usage the examples throughout the text are diversified the validation of the code is performed through comparisons with rhino3d combined with its panelingtools plug in ansys and multisurf models for volume mass and hydrodynamic properties it should be noted that the number of software packages needed for comparisons also emphasizes the current lack of a consolidated solution the concluding section contains a measure of performance to evaluate the method s efficiency in providing the 3d model and mass properties to be used in a system that requires iterative model building 2 representation of a 3d geometry with quadrilaterals the quadrilateral meshes utilised in panel method tools such as wamit are defined by the x y and z coordinates of each panel s four vertices i e 12 values per panel when two of the adjacent four vertices coincide the polygon forms a triangle the entirety of the structure is then represented as a combination of individual panels the ordering of the vertices defines the surface normal direction using the right hand rule in fig 1 the coordinate system is presented the darker shaded arrow demonstrates the normal facing the fluid domain as required by wamit while the lighter shaded arrow is the inverted normal the inverse normal will be used to simplify mass property calculations the modelling process described below is divided into radius based and face based approaches radius based models encompass cylinders cones frustums spheres and similar shapes that can be described as a function of their radii at a given height face based models have a broader range of applications a triangular prism with an open bottom uses three faces a rectangular prism consists of six faces eventually the idea may be extended to a sphere as a set of connected quadrilateral panels in this context radius based models are a subset of face based models in practice having the radius based model option simplifies and speeds up the modelling for this reason both approaches are explained starting with the radius based approach 2 1 radius based approach consider a quadrant of a disc with the radius and the arc length divided as illustrated in fig 2 the polygon s z coordinates are identical resulting in a flat disc on the xy plane the input data of this case are the radius r the number of segments between two consecutive edges i e inner edge with a zero radius and the outer edge radius of r the z coordinate and the reference angle i e 90 for a quadrant φ c the number of segments on the radius s r and the arc s p are utilized to define the increments of r i n c and φ i n c respectively 1 φ i n c φ c s p 2 r i n c r i s r the information above suffices to express the location of the four vertices in the cartesian coordinate system as a function of equations 1 and 2 and set the origin to o x 0 y 0 3a x i 1 cos φ i φ i n c r i r i n c x 0 3b y i 1 sin φ i φ i n c r i r i n c y 0 3c z i 1 z i z i n c 4a x i 2 cos φ i r i r i n c x 0 4b y i 2 sin φ i r i r i n c y 0 4c z i 2 z i z i n c 5a x i 3 cos φ i r i x 0 5b y i 3 sin φ i r i y 0 5c z i 3 z i 6a x i 4 cos φ i φ i n c r i x 0 6b y i 4 sin φ i φ i n c r i y 0 6c z i 4 z i with the initial angle φ i and radius r i the quadrant in fig 2 a can be modeled iteratively the disc begins with a reference angle of φ i 0 and utilizes φ i n c 45 the next iteration arrives to φ i 1 0 45 this progression is identical for the radius adding an incremental value of z z i n c extends the application to cylinders an equal radius throughout the model with a height increment forms the walls of the cylinder quadrant in fig 2 b when the number of vertical sections in z axis is given in s z the incremental value of height results in 7 z i n c z i z i 1 s z mathematically the side walls and the base can be treated in an identical manner the base is a side wall that starts with a radius of zero and increases to r at a constant depth on the other hand the side walls are equivalents of the base with equal radii at different depths this approach results in reducing the sectioning input to a single variable 8 s z s r z i n c z i z i 1 s r a systematic input format to the formulation above is possible using matrices for n number of edges the radius the z location and the number of sections are summed up into a 3 n matrix each row of the matrix describes the radius and the depth of the edge i and the number of sections to build between two consecutive edges presented in this format a minimum of two rows i e 3 2 matrix defines a series of panels this matrix is termed as the p matrix i e panel matrix 9 p j r i d i s r r i 1 d i 1 s r 1 r n d n s n it is functional to separate the body wide properties from the p matrix the reference angle number of angular sections s p and the x and y origin 0 x 0 y 0 are external inputs as a local settings matrix l consolidating the panel matrix of body j into the local matrix the format takes the following form 10 l j p j s p φ c x 0 y 0 following the methodology above the panels in fig 1 at z 20 meters are represented by the following p and l matrices 11 p 1 0 20 2 5 20 2 12 l 1 p 1 s r 2 φ c 90 x 0 y 0 0 0 equation 11 reads as follows a surface is formed between an edge with a radius of zero and an edge with a radius of five both at 20 m the surface is subdivided into panels with two radial segments p 1 1 3 2 the value at p 1 2 3 2 is void as no edges follow in the third row l 1 defines that there are two angular sections revolving 90 the origin in x and y axes is x 0 y 0 0 0 to obtain the cylinder in fig 2 a third line is added to the p matrix and with an identical l 1 13 p 2 0 20 1 5 20 2 5 0 0 when modelling with increasing z or increasing r values equations 3 6 enforce surface normals to face the negative z positive x and positive y directions this setup is convenient for ocean engineering introducing multiple l and p matrices describes multiple bodies the process is summarized with a flowchart in fig 3 for j 1 m bodies 2 2 face based approach assume an arbitrary quadrilateral face with the vertices v 1 x 1 y 1 z 1 v 2 x 2 y 2 z 2 v 3 x 3 y 3 z 3 and v 4 x 4 y 4 z 4 the number of segments of the edges between v 1 to v 2 and v 2 to v 3 are provided and opposing sides are identically sectioned when the locations of the internal points are calculated a subdivided surface is obtained consider dividing a larger face into the three sub surfaces illustrated in fig 4 given the four initial vertices v 1 v 2 v 3 v 4 and the number of segments in the shorter dimension s 2 the polygon composed of v 1 v 2 v 23 and v 14 can be deducted from the formulae below 14a v s 1 v 1 v 4 v 1 s 2 n s u b 1 14b v s 2 v 2 v 3 v 2 s 2 n s u b 1 14c v s 3 v 2 v 3 v 2 s 2 n s u b 14d v s 4 v 1 v 4 v 1 s 2 n s u b the sub surfaces are numbered with n s u b the lowermost sub face in fig 4 results from equating n s u b 1 and s 2 3 15 v s 1 v s 2 v s 3 v s 4 v 1 v 2 v 23 v 14 when the number of segments in the longer dimension is denoted by s 1 a top edge increment i t and a bottom edge increment i b can be defined 16 i t v 23 v 14 s 1 i b v 2 v 1 s 1 it is then clear that iteratively dragging the two initial vertices v 1 and v 14 along the edges of the sub face by the increments i b and i t defines the vertices of individual panels the generalized formulae below deducts the coordinates using n p a n e l to indicate the panel number 17a v 1 p i v 1 i b n p a n e l 1 17b v 2 p i v 2 i b n p a n e l 17c v 3 p i v 14 i t n p a n e l 17d v 4 p i v 14 i t n p a n e l 1 a 4 3 matrix can contain the four vectors consisting of the x y and z coordinates of the vertices to define the segments between v 1 to v 2 and v 2 to v 3 i e s 1 and s 2 respectively an additional column is required as the opposing edges are sectioned identically two values remain in a 4 4 matrix for orienting the surface normals each panel has three possibilities for the x y z components of the surface normal vector the first two happen when the component direction is identical or the reverse of the axes orientation e g n 0 32 0 0 67 where the x component equals to 0 32 having the same orientation with the axis consequently defining an axis and the required normal vector direction in reference to the given axis normal is an effective way of ensuring the intended orientation the third case is when the surface normal component becomes zero e g a polygon flat on the xy plane where the values of the normals in x and y directions are zero under these circumstances only the remaining orientation e g z axis in the example above can be evaluated consequently it is beneficial to define two axes in p 3 4 and p 4 4 to be evaluated if one is zero this approach allows to use the same matrix multiple times without alterations when rotations are introduced let the input matrix take the following form 18 p x 1 y 1 z 1 s 1 x 2 y 2 z 2 s 2 x 3 y 3 z 3 o a x i s 1 x 4 y 4 z 4 o a x i s 2 the intended surface normals are set with o a x i s 1 and o a x i s 2 defining the normal vector n x f y f z f of a panel and mapping axes x y and z to the numbers k 1 2 3 respectively the operation below sets the orientation of the face in the intended direction 19a s g n o a x i s k s g n n o a x i s q f q f 19b s g n o a x i s k s g n n o a x i s q f θ q f the mathematical operator θ in equation 19 is introduced to flip the first three columns of the matrix upside down this operation is the equivalent of turning the points in the opposite order e g counter clockwise if they were defined clockwise initially the flip does not alter the number of sections between the vertices as they end up defining the same spacing therefore the fourth column is kept intact an example is provided for a unit square bottom face b f parallel to the xy plane with the normal intended to be set in z direction 20 b f 0 0 0 3 1 0 0 1 1 1 0 3 0 1 0 1 using the right hand rule and following the order in which the points are defined in b f the surface normal will be set originally in the z direction flipping the first three columns of the matrix upside down provides the following matrix with the surface normal set in the negative z direction as stated the additional value at p 4 4 is beneficial for iterative scripts where the panel definition is used at multiple times inside the model the code will not use it in this case 21 θ b f 0 1 0 3 1 1 0 1 1 0 0 3 0 0 0 1 the approach above builds the bodies as a collection of faces that are composed of sub faces as illustrated in the flowchart in fig 5 a cube is modelled with the top f t the bottom f b and the four sides f 1 f 2 f 3 f 4 the faces are collected into a local matrix l f to form a body 22 l f f 1 f 2 f 3 f 4 f t f b 2 3 rotation and translation in 3d space the same matrices can be used multiple times to simplify building the models for instance in the case of a cube a single matrix can be utilized if it can be moved and rotated in 3d space translating points is easily achieved by adding the x m y m and z m distances to the original matrix data and does not necessitate further discussion for the rotation the origin the axis and the angle are the requirements additionally the final position depends on the order when multiple rotations are performed e g about the z axis first then y and then z the solution to rotations of a point about the axes of the coordinate system the euler s rotation matrix is detailed in goldstein et al 2013 however regarding functionality rotating about an arbitrarily defined axis is easier for the user for instance alternative coordinate axes may be chosen as the centre of the base of a cylinder or the geometric centre of a rectangular prism for this purpose the solution can be extended onto rotations about an arbitrary point in the coordinate axes in this case the origin of the coordinate system is moved to the origin of the rotation this point is then used to perform the rotations about the new coordinate axes at the final stage the model is translated to its original location the equations below summarize the rotations of the point coordinates x y z about the point a b c by an angle θ in a given axis rotated coordinates are presented as x y z and the rotation axis is denoted by the subscript e g x x is rotation about the x axis 23 x x y x z x x 1 cosθ x cosθ b 1 cosθ y cosθ c z sinθ c 1 cosθ z cosθ y b sinθ 24 x y y y z y a 1 cosθ x cosθ c z sinθ y 1 cosθ y cosθ c 1 cosθ z cosθ a x sinθ 25 x z y z z z a 1 cosθ x cosθ b y s i n θ b 1 cosθ y cosθ x a sinθ z 1 cosθ z cosθ 2 4 multi body models symmetry and the consolidated input format up to this point the formulations focused on forming a single body the local matrices defined in equations 10 and 22 build parts of the geometry by collecting panel matrices together the number of arc segments and the reference angle are summed up as r a d i the type of modeling i e radius based or face based is clear by the size of the panel matrix radius based models are contained within 3 n matrices and face based geometries use 4 n rotations depend on the origin o r and the order r o along with the angles r x r y r x the translation distance m is required for moving the material density and the plate thickness ρ and t are required for weight and inertia calculations finally for the panel matrices indicated by p i the local matrix takes the following generalized form 26 l p 1 p 2 p i r a d i r x r y r x o r r o m t ρ the variables that apply to the entirety of the model can be integrated into a global settings matrix denoted by g with the same approach used for the local matrices that consolidate the panel matrices global matrices collect and integrate local matrices therefore structures composed of multiple bodies are made possible the symmetry information in x and y axes is included as boolean true or false input when the file name is added the global matrix is written as 27 g f i l e n a m e l j l j 1 l n x s y m m e t r y y s y m m e t r y in brief the modelling procedure is described as nesting panel matrices into local matrices that are nested into a single global matrix 28 m o d e l g l 1 p j p n l 2 p k p t l m p l p q 3 calculation of the mass properties of the mesh 3 1 centre of gravity and weight it is possible to borrow from the finite element approach by integrating the properties of individual panels throughout the structure to calculate the mass volume and inertia of the mesh the solution proposed below follows the same order the panel properties are described first followed by the structure s mass properties a polygon s centre of gravity in 3d space can be calculated with triangulation for a quadrilateral the triangulation equals removing a vertex vertices 1 2 3 and 1 3 4 are valid triangles in fig 6 repeating two adjacent vertices forms a line and the area of equal to zero therefore the formulation still applies for triangles expressed as quadrilaterals assume that the panels of the structure are thin sheets with zero thickness hence with an attributed area but zero volume the centre of mass of this polygon is the result of a weighted average of the two triangles forming the quadrilateral panel in this case the problem turns into locating the centroid of a 3d planar triangle considering that each vertex i is represented by v i x i y i z i the geometric center of a triangle c t r i is calculated as the intersection point of its medians 29 c t r i x c y c z c v 1 v 2 v 3 3 the area of the triangle is represented by a cross product of its two edges and the normal vector n 30 a t r i n v 2 v 1 v 3 v 1 2 a weighted average using equations 29 and 30 gives the center of geometry of the quadrilateral 31 c q u a d x c y c z c m 1 2 a t r i m c t r i m x c y c z c m 1 2 a t r i m the total area of the panel is the sum of the areas of the two triangles forming it 32 a p m 1 2 a t r i m to add the thickness into the calculations consider that a sheet of metal i e panel mesh is lying flat on a table i e fluid domain with the surface normal direction oriented towards the table the mesh represents the bottom surface in this case the location of the center of gravity is offset from the center of geometry of the face by the inverse of surface normal multiplied by the half of its thickness the surface normal can be calculated with newell s method newell et al 1972 sutherland et al 1974 for a polygon with m vertices the normal vector defined by n n x n y n z is obtained as follows 33a n x i 1 m y i y i 1 z i z i 1 33b n y i 1 m z i z i 1 x i x i 1 33c n z i 1 m x i x i 1 y i y i 1 panel method calculations require that the section facing the fluid domain be modeled e g the table in the example given above consequently the thickness faces inwards opposing the surface normal for this reason it becomes computationally efficient to calculate a reverse normal and use it in structural calculations the updated vector may also be implemented into equation 30 by negating it to avoid multiple calculations this normal can be termed the structural normal vector n s and is obtained by multiplying n with minus unity and normalizing 34 n s n n finally the center of mass c m as a function of the center of geometry of the panel c q u a d the thickness t and the structural surface normal n s becomes 35 c m x y z 0 5 t n s c q u a d x c y c z c the total weight of the panel m p is calculated using the area a p thickness t and the density ρ 36 m p a p t ρ the structure s total weight w t is found by summing up the weights of the panels 37 w t 1 m m p m through c m the location of each panel s center of gravity was known joining equations 35 and 37 locates the center of gravity of the structure c g x g y g z g 38 c g x g y g z g 1 m m p m c m m m p m 3 2 inertia using the location of the center of gravity c m x c y c z c and the mass m p the structural inertia is calculated about the x y and z axes as follows 39a i x x m m p m y c m 2 z c m 2 39b i y y m m p m x c m 2 z c m 2 39c i z z m m p m x c m 2 y c m 2 the products of inertia about the axes are provided as follows 40a i y z m m p m y c m z c m 40b i z x m m p m x c m z c m 40c i x y m m p m x c m y c m the inertial values about the center of gravity of the structure are obtained through the parallel axis theorem an alternative option is to replace the center of gravity in equations 39 and 40 with the values referenced from the center of gravity of the structure this approach is equal to temporarily translating the origin to the center of gravity 3 3 volume the enclosed volume of a structure can be calculated by integrating the projected areas of individual panels up to the xy xz or yz planes the distance between the plane and the panel is obtained from the center of geometry of the panel c quad directly multiplying the area by the distance to axis errs for the following reason consider a cube of 6 faces with the edge length of a one vertex is located at the origin the volume of the cube equals to a 3 however the sum of areas of the faces multiplied by the distance from the center of the panels to an axis yields 3 a 3 this error is corrected by taking the projection of each vertex onto the plane and calculating the area of projection times the distance to the planes of origin an example is given here for integrating towards the xy plane projection onto the xy plane is possible by setting the z coordinate of the 12 vertices to zero 41 p x y x 1 y 1 0 x 2 y 2 0 x 3 y 4 0 x 4 y 4 0 the unit normal of the xy plane is in the z direction 42 n x y 0 0 1 considering that each vertex i is represented by v i x i y i z i the projection area of each panel is calculated by 43 a proj n x y v 3 v 1 v 4 v 2 2 the distance between the panel s center of geometry and the xy plane i e c quad z is measured from the z value of the geometric center of the panel c quad multiplication of the area and the distance provides the volume coming from the panel in z direction 44 v o l z p a proj c quad z other directions are delivered by pairing n y z with c quad x and n x z with c quad y the resulting values are vol x and vol y respectively when the volume coming from each panel is known the total volume is obtained by integration 45 v o l z t 1 m v o l z p 4 examples of application several geometries are demonstrated in this section simple shapes such as the frustum are given with the matrices that create them for complex structures the method is described the idea of parameterization of the input data is applied and discussed the matrices below use an alternative notation to contract them the semicolon operator signifies the next row of the matrix global matrices only contain information related to file naming and symmetry hence they are omitted 4 1 examples of application for the radius based models previously equation 11 was given to describe a cylinder quadrant an extension of application is the frustum in fig 7 symmetry is used to revolve 360 the centre of origin is offset by x y 3 5 units 46 p f 0 20 5 3 250 20 5 2 0 10 0 0 5 47 l f p f a r c s e g m e n t s 10 r e f e r e n c e a n g l e 90 x 0 3 y 0 5 the idea of changing radii as a function of depth applies similarly to obtain a sphere the model starts at certain z value with zero radius as the height is incremented its radius increases until it equals the radius of the sphere subsequently the steps are reversed until zero radius is obtained 48 p s p h e r e 0 00 5 0 1 0 87 4 8 1 1 20 4 6 1 1 43 4 4 1 1 60 4 2 1 1 73 4 0 1 1 83 3 8 1 1 91 3 6 1 1 96 3 4 1 1 99 3 2 1 2 00 3 0 1 1 99 2 8 1 1 96 2 6 1 1 91 2 4 1 1 83 2 2 1 1 73 2 0 1 1 60 1 8 1 1 43 1 6 1 1 20 1 4 1 0 87 1 2 1 0 00 1 0 1 49 l s p h e r e p s p h e r e p o l a r s e c t i o n s 10 r e v a n g l e 90 x 0 0 y 0 0 equation 48 gives the sphere in fig 8 it can be largely simplified by parameterizing the sphere section s radius as a function of its height and scripting it out to obtain a torus through a similar parameterization consider the side walls of an upright cylinder when the radius of this wall is increased towards its centre and decreased back to its initial value at the extremities i e top and bottom a convex shape is obtained forming the outer ring of a torus the idea is reapplied with a decreasing radius resulting in the inner ring the shape is revolved about the origin to complete the model the p matrix of the outer ring is similar to the p matrix of the sphere in equation 48 with the minor radius r s p h e r e increased by the major radius r t o r u s with a center radius of 10 units the matrix is written as follows using the sphere s panel matrix of j 1 21 rows 50 p o u t e r 1 j j 1 21 p s p h e r e 1 j r t o r u s the radii of the inner ring as a function of the outer radii 51 p i n n e r 1 j j 1 21 p o u t e r 1 j 2 p o u t e r 1 j combining the matrices and rotating 45 in both the x and y axes delivers the torus in fig 9 52 l t o r u s p i n n e r p o u t e r p o l a r s e c t i o n s 10 r e v a n g l e 360 x r 45 y r 45 the same idea applies to all radius based shapes and borrows from the approach used by the revolve command available in most cad software a classic example of the command s usage is the glass shape given in fig 10 a multi body example can be given with the semisubmersible floating wind turbine platform robertson et al 2014 it comprises three buoyancy columns with altering radii and the turbine is located on the central column cross braces that connect the parts are rotated cylinders since all three buoyancy columns are identical only one p matrix with six rows suffices to model them they are sequentially repositioned in two l matrices defined with the following properties the column at the centerline utilizes 180 of revolution angle and is offset in the x direction the second column with the same panels is defined with a 360 revolution angle and is offset in both x and y axes a similar approach is taken for the braces by writing a single panel matrix for identical parts and relocating them by offsetting and rotating through multiple local matrix settings ultimately the l matrices are fed into the g matrix and y symmetry is set the resulting model is presented in fig 11 4 2 examples of application for the face based models a basic face based shape is a rectangular prism it consists of 6 faces modelled in their respective p matrices and put into a single l matrix let the edges of the box have the lengths of a units in the x axis b units in the y axis and c units in the z axis the origin is set to o 0 0 0 the six faces are written as follows 53a f t o p 0 0 0 10 a 0 0 10 a b 0 3 0 b 0 1 53b f b o t t o m 0 0 c 10 a 0 c 10 a b c 3 0 b c 1 53c f f r o n t a 0 0 10 a 0 c 10 a b c 1 a b 0 1 53d f b a c k 0 0 0 10 0 0 c 10 0 b c 1 0 b 0 1 53e f l e f t 0 b 0 10 a b 0 10 a b c 2 0 b c 1 53f f r i g h t 0 0 0 10 a 0 0 10 a 0 c 2 0 0 c 1 in equation 53 the surface normals of the box are defined the top face normal is oriented in the z direction f t o p 3 3 3 similarly f b o t t o m 3 3 3 denotes the reverse of the z axis orientation in place of writing out the six matrices using the move command and only adjusting the normals would reduce the matrices to three after setting a 15 b 5 and c 2 the resulting box is in fig 12 the versatility of modelling using faces stems from the possibility of parameterising and scripting the midship section in fig 13 is an extended example to the barge given above it may serve to obtain an estimate of weight and inertia of the section the components such as the deck and the bottom plates are quadrilaterals identical to the top and the bottom of the prism the stiffeners are added iteratively by offsetting the copy of a single stiffener multiple times the bilge is built with a function of radius the process may be summarized as repeating equation 53 with altered parameters within a script a ship s hull form is an alternative example a table of offsets used in naval architecture provides the width of a transversal section as a function of depth when the depth values of adjacent transversal sections are connected longitudinally the result is the ship s hull form the bulkheads in fig 14 may be added by connecting the opposing vertices transversally instead of longitudinally the hull form model may be used for hydrostatic and hydrodynamic calculations it is also possible to obtain the distributed weight of the hull along its length required for bending moment calculations brunelleschi s octagonal dome in florence is presented in fig 15 and illustrates an example from architecture in this case the changing radius of the dome is read from an external file which registers the real measurements of the dome a single side of the octagon is built copied and moved within a script the rotations are performed about the origin for the support system and about their first defined point for the edges sides 5 validation of mass property calculations and the panel method model the volume the centre of gravity the weight the inertia calculations and the panel method model are validated below models for the box and the frustum were built in ansys using shell elements to compare the weight and inertial data four nodes and four thicknesses define this element in the cases presented below the thickness is assumed to be identical over the area of the element with the values input at the four nodes the box model is represented as a collection of its six faces the frustum is constructed by sweeping the bottom edge towards the top edge along the height of the model rhino3d can open the meshes in gdf file format therefore it was used to get a comparison of volume the use of sectional volume i e the volume up to a certain depth which can be expanded onto sectional weight is discussed for the panel method comparison a cylinder model was built in rhino3d with the sizing described in tracy 2007 and both were run in wamit lee and newman 2005 units are omitted providing that they are consistent between software they are not indicators information relating to the described method s usage practices are mentioned when required 5 1 volume table 1 lists the results of volume calculations with parmod rhino and when possible analytical formulae the current approach is listed under the abbreviation of parmod parametric modeler the comparison of methods must be carried out on identical models when possible and a rounded shape represented by a collection of a finite number of panels loses some volume e g a cylinder divided into four segments is a diamond shape with a lower volume therefore comparisons are provided against rhino3d s measurements as opposed to the analytical values analytical values are included present an idea on the loss of volume due to panelling and serve to validate the geometry of the model itself in table 1 the glass the semisubmersible and the dome show slight differences the remaining results are identical despite the intuition the glass is the most complex shape in the list it has an inner surface modelled with the opposite surface normal of the outer surface it was purposefully built to measure the possible errors the difference in measurement is 2 21 percent in that case for the other two cases rhino3d could not measure when all areas are not enclosed therefore the models needed adjustments e g the dome had to be capped the values reflect the alterations in the models volume calculations as a function of depth are useful in stability studies of floating structures fig 16 delivers this type of computation for the box the figure also illustrates that to obtain a good distribution the number of sections should go past a certain value in the z direction the calculated volume is correct at the maximum depth intermediate values are lost as there is only a single section for integration see fig 12 bottom and top faces this figure shows that the direction with the most number of sections is preferable when getting the distributed values the semisubmersible s z integration is similar despite the cross braces resulting in an increased number of z sections the volumes at the water level i e 0 depth are identical for the x y and z integrations when all of the panels are considered 5 2 centre of gravity weight and inertia the centre of gravity weight and inertia comparisons are presented for the frustum and the box figs 7 and 12 using thicknesses of 0 05 and 0 06 respectively the density of steel was used as the material density value 7850 table 2 lists the weight and the centre of gravity estimations both results are identical to ansys the two sets of inertias are provided in tables 3 and 4 the inertial values are given for the origin and the centre of gravity cog for both cases the inertial values at the origin are identical when the inertia at the centre of gravity is examined the results differ around 0 5 percent it is probable that there is a difference in rounding of the values of the centre of gravity in that case the inertial values would reflect the difference when multiplied by the distance squared 5 3 panel method calculations in the field of hydrodynamics the coefficients play an important role and their calculation depends on the underwater geometry these added masses and potential damping values can be calculated from a suitably developed mesh the added masses are denoted by a while the potential damping is denoted by b the subscript 11 is used for the surge mode and 55 denotes pitch this section illustrates the usage without discussing modelling practices fig 17 presents the panel method calculation results of a cylinder mesh modelled in parmod and rhino3d a platform with a 19 m radius at a draft of 20 m located at a 200 m water depth was chosen for which a set of results are readily available tracy 2007 these data do not show differences between the parmod and rhino3d models in models of higher complexity it is likely that there will be certain differences depending on the modelling practice e g the number of panels and the results will reflect that fig 18 shows a comparison for the semisubmersible in fig 11 the multisurf set was published in coulling et al 2013 the values compare favourably with slight shifts in peak amplitudes 6 performance assessment average runtimes become important when the tool is used inside a larger system for design in an iterative setting it should require the minimal amount of time to deliver the model and its mass properties inside a loop the available time should preferably be reserved for other calculations such as the panel method code s runtime or any additional module therefore this section focuses only on the mass property and modelling times the goal of providing this data is to clarify that the approach is minimally resource intensive to avoid hindering the design process the performance depends on the number of panels used for the structure modern computers provide enough computational power to deliver fast results in simple arithmetic operations the bottlenecks prove to be file writing and the trigonometric functions used for rotations consequently a breakdown of modules is necessary to understand expected the runtime furthermore measuring the performance requires additional calculation time for that reason multiple measurements were taken with and without the performance measurement code the final runtime is given without the performance measurement code the modules assessments have to include the additional code s contribution therefore the totals are not equal details are presented in table 5 for the semisubmersible and the torus the torus also includes a rotated version rotating it 45 in both x and y axes ensures that each panel is rotated at least once therefore approximately there is a total of 9600 rotations performed as explained above file operations and rotations emerge as the degraders of performance overall 1 s per 1000 panels is a reasonable average runtime as seen in table 6 7 conclusions the work provided a numerical solution to the 3d modelling of structures obtaining their mass properties and providing a compatible mesh model for panel method calculations the input data was described based on matrices making it possible to script out geometries parameterization of a 3d model was explained to provide a basis for obtaining variations of a model in iterative calculations a range of examples was given to demonstrate the usage of the code the list included a frustum a sphere a torus glass a rectangular prism a midship section an offshore platform a ship hull and a dome to illustrate variety the code was evaluated on these samples to calculate the mass properties of weight inertia volume and the centre of gravity the results were used to validate the calculation method through comparisons with specialized software panel method validation was carried out on a cylinder and a semi submersible offshore platform overall this approach delivers mass data within a 0 5 margin compared to ansys volume calculations are in a similar range when compared to rhino3d evaluations in wamit for a cylinder the model prepared with a combination of rhino3d and panelingtools gave identical results with the presented method for a semisubmersible wind turbine platform prepared in multisurf the data compared favorably to published results the performance indicators summarise that the expected runtime was approximately 1 s per 1000 panels to provide mesh model and solve it for mass which is unlikely to be a hindrance to the design systems that would include this type of calculations accordingly this method can be integrated into early design states to replace spreadsheets and manual calculations or used for obtaining distributed mass properties from available mesh grids acknowledgements the work has been conducted within the strategic research plan of the centre for marine technology and ocean engineering which is financed by portuguese foundation for science and technology 
23332,the paper describes a numerical 3d modelling method to develop quadrilateral meshes for panel method calculations with an integrated solution to obtaining the mass properties from the same grid it aims to offer a more precise and versatile alternative to the spreadsheet type approach repeatedly used in early design stages of marine structures the given formulae additionally serve to obtain the mass properties of an existing grid without additional software the input format is in the form of matrices and can be altered within a script first the modelling approach is described followed by the calculation of the mass properties of volume weight inertia and the centre of gravity after detailing the principles various examples that encompass different geometric forms such as a torus an offshore platform and a ship are provided to demonstrate the usage the results of the mass property calculations are validated through comparisons with ansys and rhino3d the hydrodynamic mesh is evaluated in wamit by comparing models made with the presented approach to multisurf and rhinoceros3d with its panelingtools plugin a measure of performance is also included to provide a basis for loop type design procedures that utilise the given method keywords geometric design mesh grid hydrodynamic properties offshore platforms 1 introduction initial design stages contain a significant number of unknowns in settled industries such as shipbuilding the process begins with the cumulative knowledge from previous experiences and may progress into improving an existing geometric form e g papanikolaou 2010 ventura and guedes soares 2011 conversely in novel applications such as floating offshore wind turbine platforms the most favourable implementation is still under discussion bagbanci et al 2015 2012 robertson et al 2013 for instance as of 2013 over 80 platform concepts were being evaluated globally bossler 2013 with diverse approaches to the design problem considering the variety of forms to start from the number of unknowns is equally high for a new concept in all cases mathematical modelling of static and dynamic behaviour requires a correct representation of the mass and inertia if the structure is afloat underwater geometry related hydrodynamic coefficients become an additional requirement these properties are closely linked with the geometry of the platform hence involving cad software to get reliable estimates the same reasons that make the use of these sophisticated tools and software favourable at later design stages present a complication at the earlier design stages when the knowledge is limited to a concept preparing a set of iterations of 3d models for parametric studies as in tracy 2007 can become tedious another problem arises from the specialisation of tools some codes are made to perform a specific calculation well while expecting input from another source for instance wamit lee and newman 2005 is a verified code in hydrodynamic calculations provided that the six by six mass matrix is correctly provided erred mass will lead to errors in estimated motion responses accordingly this data needs to be prepared externally the procedure needs to be repeated for each iteration of the concept to remedy this problem in new designs researchers usually revert to avoiding sophisticated 3d modelling tools entirely and rely on spreadsheet calculations and simplifications as outlined in chakrabarti 2005 and utilised in bachynski and moan 2012 and leimeister et al 2016 this case creates a substantial gap between the higher complexity surface models such as nurbs and the simple hand calculations on a spreadsheet the issue is not only present at initial stages but also repeats itself from another perspective for optimisation studies two interlinked sides need to be considered in this regard mass properties and hydrodynamics obtaining the mass and inertia on a spreadsheet is less problematic when a partial analytical solution exists accordingly one approach is to introduce simplifications to describe the model removing some of its parts effectively reducing it to a form that is broken down into solvable components e g cylinders andersen et al 2015 hall et al 2014 roddier et al 2010 this is not a generic solution as it is inapplicable for a body that cannot be expressed as a set of basic shapes regarding hydrodynamics a solution to the hydrodynamic coefficients can be obtained from tabular data for members clauss et al 1992 sarpkaya and isaacson 1981 however if the platform requires a potential flow solution they will be inaccurate as discussed in an experiment to code comparison by adam et al 2013 in that case it is still necessary to build a 3d model despite the preliminary hand calculations furthermore the entire breakdown and calculation process needs to be repeated if the structure is altered as the solution is specific to a given body from the point of optimisation another problem arises a recently published work describing the evaluation of semisubmersible hulls for weight and heave motion park et al 2015 states that one of its main contributions is including mass as an optimisation variable unlike previous studies which took it as a constant clauss and birk 1996 lee et al 2007 lee and lim 2008 starting from bezier b spline curves the study assumes that the mass equals a statistically obtained constant multiplied by the surface area of a simplified version of the 3d model the reduced geometry is given as a set of rectangular prisms without the curvatures and other details of the hydrodynamic model in essence the approach is a reversal to the spreadsheet calculation inside a complex system the inertia is not mentioned therefore the study is limited to the heave mode in a manner similar to birk 2008 it should also be noted that a shortcoming of statistical data is that they do not exist for novel structures e g wind turbine platforms wave energy converters in another study that considers both mass and inertia venzon et al 2014 assumes the mass and the radius of gyration to be based on percentages of the main dimensions and takes a fixed position for the centre of gravity the rationale behind this decision is not explained in the work for tension leg platforms using an assumption of mass as in lee et al 2007 is especially problematic considering the relation between the tendon tension and the structural weight in the absence of proper inertia estimations the pitching and rolling effects on tendon tension are also overlooked in this regard with a large number of dependencies it is clear that the mass properties should preferably be calculated as opposed to assumed while this estimation may be more complicated for structures designed for significantly variable cargo e g tankers bulk carriers oil and gas platforms a mass matrix can be obtained for fixed loading type structures with a higher precision e g floating wind turbine platforms from a purely hydrodynamics point of view once the mass properties are calculated the estimation of responses will require evaluating a suitably prepared mesh as in jafaryeganeh et al 2015 and rodrigues and guedes soares 2014 the coefficients of the equations of motion rely on the underwater geometry and even smaller changes reflect in motion dynamics sutulo et al 2010 uzunoglu et al 2016 hence simplifications also lead to consequences such as altering the natural frequencies uzunoglu and guedes soares 2015a in sum it is beneficial to devise a consolidated approach to the problem a solution would be to implement the estimations of mass properties into the 3d meshes used in hydrodynamics while keeping the file format compatible additionally the calculation method should be mathematically simple so that it can be implemented by other researchers in any programming language and should avoid commercial cad tools it is also preferable to use a numerical input format as it has advantages regarding parameterisation for iterative design in that regard specialised approaches exist for parameterising bodies such as ships ko et al 2011 however with an increased number of unknowns in fields such as the design of floating wind turbine platforms flexibility assumes a larger role hence the solution should not be limited to an individual hull form this work outlines this type of a numerical solution to creating a quadrilateral mesh and obtaining its mass properties for a more precise solution at early design stages while it is mainly intended as a replacement for the commonly used spreadsheet methods the mass calculations apply to any grid mesh matrix data are utilised to input the geometry partial solutions of a section of the model provide the mass and volume distribution in space integration for the entirety of the structure delivers the model weight volume and inertia the output is then fed to wamit to validate the model s use in hydrodynamic calculations while the tool was initially developed for the numerical design of offshore platforms for wind turbines uzunoglu and guedes soares 2016 2015b it allows modelling a wider range of structures to illustrate this point and its usage the examples throughout the text are diversified the validation of the code is performed through comparisons with rhino3d combined with its panelingtools plug in ansys and multisurf models for volume mass and hydrodynamic properties it should be noted that the number of software packages needed for comparisons also emphasizes the current lack of a consolidated solution the concluding section contains a measure of performance to evaluate the method s efficiency in providing the 3d model and mass properties to be used in a system that requires iterative model building 2 representation of a 3d geometry with quadrilaterals the quadrilateral meshes utilised in panel method tools such as wamit are defined by the x y and z coordinates of each panel s four vertices i e 12 values per panel when two of the adjacent four vertices coincide the polygon forms a triangle the entirety of the structure is then represented as a combination of individual panels the ordering of the vertices defines the surface normal direction using the right hand rule in fig 1 the coordinate system is presented the darker shaded arrow demonstrates the normal facing the fluid domain as required by wamit while the lighter shaded arrow is the inverted normal the inverse normal will be used to simplify mass property calculations the modelling process described below is divided into radius based and face based approaches radius based models encompass cylinders cones frustums spheres and similar shapes that can be described as a function of their radii at a given height face based models have a broader range of applications a triangular prism with an open bottom uses three faces a rectangular prism consists of six faces eventually the idea may be extended to a sphere as a set of connected quadrilateral panels in this context radius based models are a subset of face based models in practice having the radius based model option simplifies and speeds up the modelling for this reason both approaches are explained starting with the radius based approach 2 1 radius based approach consider a quadrant of a disc with the radius and the arc length divided as illustrated in fig 2 the polygon s z coordinates are identical resulting in a flat disc on the xy plane the input data of this case are the radius r the number of segments between two consecutive edges i e inner edge with a zero radius and the outer edge radius of r the z coordinate and the reference angle i e 90 for a quadrant φ c the number of segments on the radius s r and the arc s p are utilized to define the increments of r i n c and φ i n c respectively 1 φ i n c φ c s p 2 r i n c r i s r the information above suffices to express the location of the four vertices in the cartesian coordinate system as a function of equations 1 and 2 and set the origin to o x 0 y 0 3a x i 1 cos φ i φ i n c r i r i n c x 0 3b y i 1 sin φ i φ i n c r i r i n c y 0 3c z i 1 z i z i n c 4a x i 2 cos φ i r i r i n c x 0 4b y i 2 sin φ i r i r i n c y 0 4c z i 2 z i z i n c 5a x i 3 cos φ i r i x 0 5b y i 3 sin φ i r i y 0 5c z i 3 z i 6a x i 4 cos φ i φ i n c r i x 0 6b y i 4 sin φ i φ i n c r i y 0 6c z i 4 z i with the initial angle φ i and radius r i the quadrant in fig 2 a can be modeled iteratively the disc begins with a reference angle of φ i 0 and utilizes φ i n c 45 the next iteration arrives to φ i 1 0 45 this progression is identical for the radius adding an incremental value of z z i n c extends the application to cylinders an equal radius throughout the model with a height increment forms the walls of the cylinder quadrant in fig 2 b when the number of vertical sections in z axis is given in s z the incremental value of height results in 7 z i n c z i z i 1 s z mathematically the side walls and the base can be treated in an identical manner the base is a side wall that starts with a radius of zero and increases to r at a constant depth on the other hand the side walls are equivalents of the base with equal radii at different depths this approach results in reducing the sectioning input to a single variable 8 s z s r z i n c z i z i 1 s r a systematic input format to the formulation above is possible using matrices for n number of edges the radius the z location and the number of sections are summed up into a 3 n matrix each row of the matrix describes the radius and the depth of the edge i and the number of sections to build between two consecutive edges presented in this format a minimum of two rows i e 3 2 matrix defines a series of panels this matrix is termed as the p matrix i e panel matrix 9 p j r i d i s r r i 1 d i 1 s r 1 r n d n s n it is functional to separate the body wide properties from the p matrix the reference angle number of angular sections s p and the x and y origin 0 x 0 y 0 are external inputs as a local settings matrix l consolidating the panel matrix of body j into the local matrix the format takes the following form 10 l j p j s p φ c x 0 y 0 following the methodology above the panels in fig 1 at z 20 meters are represented by the following p and l matrices 11 p 1 0 20 2 5 20 2 12 l 1 p 1 s r 2 φ c 90 x 0 y 0 0 0 equation 11 reads as follows a surface is formed between an edge with a radius of zero and an edge with a radius of five both at 20 m the surface is subdivided into panels with two radial segments p 1 1 3 2 the value at p 1 2 3 2 is void as no edges follow in the third row l 1 defines that there are two angular sections revolving 90 the origin in x and y axes is x 0 y 0 0 0 to obtain the cylinder in fig 2 a third line is added to the p matrix and with an identical l 1 13 p 2 0 20 1 5 20 2 5 0 0 when modelling with increasing z or increasing r values equations 3 6 enforce surface normals to face the negative z positive x and positive y directions this setup is convenient for ocean engineering introducing multiple l and p matrices describes multiple bodies the process is summarized with a flowchart in fig 3 for j 1 m bodies 2 2 face based approach assume an arbitrary quadrilateral face with the vertices v 1 x 1 y 1 z 1 v 2 x 2 y 2 z 2 v 3 x 3 y 3 z 3 and v 4 x 4 y 4 z 4 the number of segments of the edges between v 1 to v 2 and v 2 to v 3 are provided and opposing sides are identically sectioned when the locations of the internal points are calculated a subdivided surface is obtained consider dividing a larger face into the three sub surfaces illustrated in fig 4 given the four initial vertices v 1 v 2 v 3 v 4 and the number of segments in the shorter dimension s 2 the polygon composed of v 1 v 2 v 23 and v 14 can be deducted from the formulae below 14a v s 1 v 1 v 4 v 1 s 2 n s u b 1 14b v s 2 v 2 v 3 v 2 s 2 n s u b 1 14c v s 3 v 2 v 3 v 2 s 2 n s u b 14d v s 4 v 1 v 4 v 1 s 2 n s u b the sub surfaces are numbered with n s u b the lowermost sub face in fig 4 results from equating n s u b 1 and s 2 3 15 v s 1 v s 2 v s 3 v s 4 v 1 v 2 v 23 v 14 when the number of segments in the longer dimension is denoted by s 1 a top edge increment i t and a bottom edge increment i b can be defined 16 i t v 23 v 14 s 1 i b v 2 v 1 s 1 it is then clear that iteratively dragging the two initial vertices v 1 and v 14 along the edges of the sub face by the increments i b and i t defines the vertices of individual panels the generalized formulae below deducts the coordinates using n p a n e l to indicate the panel number 17a v 1 p i v 1 i b n p a n e l 1 17b v 2 p i v 2 i b n p a n e l 17c v 3 p i v 14 i t n p a n e l 17d v 4 p i v 14 i t n p a n e l 1 a 4 3 matrix can contain the four vectors consisting of the x y and z coordinates of the vertices to define the segments between v 1 to v 2 and v 2 to v 3 i e s 1 and s 2 respectively an additional column is required as the opposing edges are sectioned identically two values remain in a 4 4 matrix for orienting the surface normals each panel has three possibilities for the x y z components of the surface normal vector the first two happen when the component direction is identical or the reverse of the axes orientation e g n 0 32 0 0 67 where the x component equals to 0 32 having the same orientation with the axis consequently defining an axis and the required normal vector direction in reference to the given axis normal is an effective way of ensuring the intended orientation the third case is when the surface normal component becomes zero e g a polygon flat on the xy plane where the values of the normals in x and y directions are zero under these circumstances only the remaining orientation e g z axis in the example above can be evaluated consequently it is beneficial to define two axes in p 3 4 and p 4 4 to be evaluated if one is zero this approach allows to use the same matrix multiple times without alterations when rotations are introduced let the input matrix take the following form 18 p x 1 y 1 z 1 s 1 x 2 y 2 z 2 s 2 x 3 y 3 z 3 o a x i s 1 x 4 y 4 z 4 o a x i s 2 the intended surface normals are set with o a x i s 1 and o a x i s 2 defining the normal vector n x f y f z f of a panel and mapping axes x y and z to the numbers k 1 2 3 respectively the operation below sets the orientation of the face in the intended direction 19a s g n o a x i s k s g n n o a x i s q f q f 19b s g n o a x i s k s g n n o a x i s q f θ q f the mathematical operator θ in equation 19 is introduced to flip the first three columns of the matrix upside down this operation is the equivalent of turning the points in the opposite order e g counter clockwise if they were defined clockwise initially the flip does not alter the number of sections between the vertices as they end up defining the same spacing therefore the fourth column is kept intact an example is provided for a unit square bottom face b f parallel to the xy plane with the normal intended to be set in z direction 20 b f 0 0 0 3 1 0 0 1 1 1 0 3 0 1 0 1 using the right hand rule and following the order in which the points are defined in b f the surface normal will be set originally in the z direction flipping the first three columns of the matrix upside down provides the following matrix with the surface normal set in the negative z direction as stated the additional value at p 4 4 is beneficial for iterative scripts where the panel definition is used at multiple times inside the model the code will not use it in this case 21 θ b f 0 1 0 3 1 1 0 1 1 0 0 3 0 0 0 1 the approach above builds the bodies as a collection of faces that are composed of sub faces as illustrated in the flowchart in fig 5 a cube is modelled with the top f t the bottom f b and the four sides f 1 f 2 f 3 f 4 the faces are collected into a local matrix l f to form a body 22 l f f 1 f 2 f 3 f 4 f t f b 2 3 rotation and translation in 3d space the same matrices can be used multiple times to simplify building the models for instance in the case of a cube a single matrix can be utilized if it can be moved and rotated in 3d space translating points is easily achieved by adding the x m y m and z m distances to the original matrix data and does not necessitate further discussion for the rotation the origin the axis and the angle are the requirements additionally the final position depends on the order when multiple rotations are performed e g about the z axis first then y and then z the solution to rotations of a point about the axes of the coordinate system the euler s rotation matrix is detailed in goldstein et al 2013 however regarding functionality rotating about an arbitrarily defined axis is easier for the user for instance alternative coordinate axes may be chosen as the centre of the base of a cylinder or the geometric centre of a rectangular prism for this purpose the solution can be extended onto rotations about an arbitrary point in the coordinate axes in this case the origin of the coordinate system is moved to the origin of the rotation this point is then used to perform the rotations about the new coordinate axes at the final stage the model is translated to its original location the equations below summarize the rotations of the point coordinates x y z about the point a b c by an angle θ in a given axis rotated coordinates are presented as x y z and the rotation axis is denoted by the subscript e g x x is rotation about the x axis 23 x x y x z x x 1 cosθ x cosθ b 1 cosθ y cosθ c z sinθ c 1 cosθ z cosθ y b sinθ 24 x y y y z y a 1 cosθ x cosθ c z sinθ y 1 cosθ y cosθ c 1 cosθ z cosθ a x sinθ 25 x z y z z z a 1 cosθ x cosθ b y s i n θ b 1 cosθ y cosθ x a sinθ z 1 cosθ z cosθ 2 4 multi body models symmetry and the consolidated input format up to this point the formulations focused on forming a single body the local matrices defined in equations 10 and 22 build parts of the geometry by collecting panel matrices together the number of arc segments and the reference angle are summed up as r a d i the type of modeling i e radius based or face based is clear by the size of the panel matrix radius based models are contained within 3 n matrices and face based geometries use 4 n rotations depend on the origin o r and the order r o along with the angles r x r y r x the translation distance m is required for moving the material density and the plate thickness ρ and t are required for weight and inertia calculations finally for the panel matrices indicated by p i the local matrix takes the following generalized form 26 l p 1 p 2 p i r a d i r x r y r x o r r o m t ρ the variables that apply to the entirety of the model can be integrated into a global settings matrix denoted by g with the same approach used for the local matrices that consolidate the panel matrices global matrices collect and integrate local matrices therefore structures composed of multiple bodies are made possible the symmetry information in x and y axes is included as boolean true or false input when the file name is added the global matrix is written as 27 g f i l e n a m e l j l j 1 l n x s y m m e t r y y s y m m e t r y in brief the modelling procedure is described as nesting panel matrices into local matrices that are nested into a single global matrix 28 m o d e l g l 1 p j p n l 2 p k p t l m p l p q 3 calculation of the mass properties of the mesh 3 1 centre of gravity and weight it is possible to borrow from the finite element approach by integrating the properties of individual panels throughout the structure to calculate the mass volume and inertia of the mesh the solution proposed below follows the same order the panel properties are described first followed by the structure s mass properties a polygon s centre of gravity in 3d space can be calculated with triangulation for a quadrilateral the triangulation equals removing a vertex vertices 1 2 3 and 1 3 4 are valid triangles in fig 6 repeating two adjacent vertices forms a line and the area of equal to zero therefore the formulation still applies for triangles expressed as quadrilaterals assume that the panels of the structure are thin sheets with zero thickness hence with an attributed area but zero volume the centre of mass of this polygon is the result of a weighted average of the two triangles forming the quadrilateral panel in this case the problem turns into locating the centroid of a 3d planar triangle considering that each vertex i is represented by v i x i y i z i the geometric center of a triangle c t r i is calculated as the intersection point of its medians 29 c t r i x c y c z c v 1 v 2 v 3 3 the area of the triangle is represented by a cross product of its two edges and the normal vector n 30 a t r i n v 2 v 1 v 3 v 1 2 a weighted average using equations 29 and 30 gives the center of geometry of the quadrilateral 31 c q u a d x c y c z c m 1 2 a t r i m c t r i m x c y c z c m 1 2 a t r i m the total area of the panel is the sum of the areas of the two triangles forming it 32 a p m 1 2 a t r i m to add the thickness into the calculations consider that a sheet of metal i e panel mesh is lying flat on a table i e fluid domain with the surface normal direction oriented towards the table the mesh represents the bottom surface in this case the location of the center of gravity is offset from the center of geometry of the face by the inverse of surface normal multiplied by the half of its thickness the surface normal can be calculated with newell s method newell et al 1972 sutherland et al 1974 for a polygon with m vertices the normal vector defined by n n x n y n z is obtained as follows 33a n x i 1 m y i y i 1 z i z i 1 33b n y i 1 m z i z i 1 x i x i 1 33c n z i 1 m x i x i 1 y i y i 1 panel method calculations require that the section facing the fluid domain be modeled e g the table in the example given above consequently the thickness faces inwards opposing the surface normal for this reason it becomes computationally efficient to calculate a reverse normal and use it in structural calculations the updated vector may also be implemented into equation 30 by negating it to avoid multiple calculations this normal can be termed the structural normal vector n s and is obtained by multiplying n with minus unity and normalizing 34 n s n n finally the center of mass c m as a function of the center of geometry of the panel c q u a d the thickness t and the structural surface normal n s becomes 35 c m x y z 0 5 t n s c q u a d x c y c z c the total weight of the panel m p is calculated using the area a p thickness t and the density ρ 36 m p a p t ρ the structure s total weight w t is found by summing up the weights of the panels 37 w t 1 m m p m through c m the location of each panel s center of gravity was known joining equations 35 and 37 locates the center of gravity of the structure c g x g y g z g 38 c g x g y g z g 1 m m p m c m m m p m 3 2 inertia using the location of the center of gravity c m x c y c z c and the mass m p the structural inertia is calculated about the x y and z axes as follows 39a i x x m m p m y c m 2 z c m 2 39b i y y m m p m x c m 2 z c m 2 39c i z z m m p m x c m 2 y c m 2 the products of inertia about the axes are provided as follows 40a i y z m m p m y c m z c m 40b i z x m m p m x c m z c m 40c i x y m m p m x c m y c m the inertial values about the center of gravity of the structure are obtained through the parallel axis theorem an alternative option is to replace the center of gravity in equations 39 and 40 with the values referenced from the center of gravity of the structure this approach is equal to temporarily translating the origin to the center of gravity 3 3 volume the enclosed volume of a structure can be calculated by integrating the projected areas of individual panels up to the xy xz or yz planes the distance between the plane and the panel is obtained from the center of geometry of the panel c quad directly multiplying the area by the distance to axis errs for the following reason consider a cube of 6 faces with the edge length of a one vertex is located at the origin the volume of the cube equals to a 3 however the sum of areas of the faces multiplied by the distance from the center of the panels to an axis yields 3 a 3 this error is corrected by taking the projection of each vertex onto the plane and calculating the area of projection times the distance to the planes of origin an example is given here for integrating towards the xy plane projection onto the xy plane is possible by setting the z coordinate of the 12 vertices to zero 41 p x y x 1 y 1 0 x 2 y 2 0 x 3 y 4 0 x 4 y 4 0 the unit normal of the xy plane is in the z direction 42 n x y 0 0 1 considering that each vertex i is represented by v i x i y i z i the projection area of each panel is calculated by 43 a proj n x y v 3 v 1 v 4 v 2 2 the distance between the panel s center of geometry and the xy plane i e c quad z is measured from the z value of the geometric center of the panel c quad multiplication of the area and the distance provides the volume coming from the panel in z direction 44 v o l z p a proj c quad z other directions are delivered by pairing n y z with c quad x and n x z with c quad y the resulting values are vol x and vol y respectively when the volume coming from each panel is known the total volume is obtained by integration 45 v o l z t 1 m v o l z p 4 examples of application several geometries are demonstrated in this section simple shapes such as the frustum are given with the matrices that create them for complex structures the method is described the idea of parameterization of the input data is applied and discussed the matrices below use an alternative notation to contract them the semicolon operator signifies the next row of the matrix global matrices only contain information related to file naming and symmetry hence they are omitted 4 1 examples of application for the radius based models previously equation 11 was given to describe a cylinder quadrant an extension of application is the frustum in fig 7 symmetry is used to revolve 360 the centre of origin is offset by x y 3 5 units 46 p f 0 20 5 3 250 20 5 2 0 10 0 0 5 47 l f p f a r c s e g m e n t s 10 r e f e r e n c e a n g l e 90 x 0 3 y 0 5 the idea of changing radii as a function of depth applies similarly to obtain a sphere the model starts at certain z value with zero radius as the height is incremented its radius increases until it equals the radius of the sphere subsequently the steps are reversed until zero radius is obtained 48 p s p h e r e 0 00 5 0 1 0 87 4 8 1 1 20 4 6 1 1 43 4 4 1 1 60 4 2 1 1 73 4 0 1 1 83 3 8 1 1 91 3 6 1 1 96 3 4 1 1 99 3 2 1 2 00 3 0 1 1 99 2 8 1 1 96 2 6 1 1 91 2 4 1 1 83 2 2 1 1 73 2 0 1 1 60 1 8 1 1 43 1 6 1 1 20 1 4 1 0 87 1 2 1 0 00 1 0 1 49 l s p h e r e p s p h e r e p o l a r s e c t i o n s 10 r e v a n g l e 90 x 0 0 y 0 0 equation 48 gives the sphere in fig 8 it can be largely simplified by parameterizing the sphere section s radius as a function of its height and scripting it out to obtain a torus through a similar parameterization consider the side walls of an upright cylinder when the radius of this wall is increased towards its centre and decreased back to its initial value at the extremities i e top and bottom a convex shape is obtained forming the outer ring of a torus the idea is reapplied with a decreasing radius resulting in the inner ring the shape is revolved about the origin to complete the model the p matrix of the outer ring is similar to the p matrix of the sphere in equation 48 with the minor radius r s p h e r e increased by the major radius r t o r u s with a center radius of 10 units the matrix is written as follows using the sphere s panel matrix of j 1 21 rows 50 p o u t e r 1 j j 1 21 p s p h e r e 1 j r t o r u s the radii of the inner ring as a function of the outer radii 51 p i n n e r 1 j j 1 21 p o u t e r 1 j 2 p o u t e r 1 j combining the matrices and rotating 45 in both the x and y axes delivers the torus in fig 9 52 l t o r u s p i n n e r p o u t e r p o l a r s e c t i o n s 10 r e v a n g l e 360 x r 45 y r 45 the same idea applies to all radius based shapes and borrows from the approach used by the revolve command available in most cad software a classic example of the command s usage is the glass shape given in fig 10 a multi body example can be given with the semisubmersible floating wind turbine platform robertson et al 2014 it comprises three buoyancy columns with altering radii and the turbine is located on the central column cross braces that connect the parts are rotated cylinders since all three buoyancy columns are identical only one p matrix with six rows suffices to model them they are sequentially repositioned in two l matrices defined with the following properties the column at the centerline utilizes 180 of revolution angle and is offset in the x direction the second column with the same panels is defined with a 360 revolution angle and is offset in both x and y axes a similar approach is taken for the braces by writing a single panel matrix for identical parts and relocating them by offsetting and rotating through multiple local matrix settings ultimately the l matrices are fed into the g matrix and y symmetry is set the resulting model is presented in fig 11 4 2 examples of application for the face based models a basic face based shape is a rectangular prism it consists of 6 faces modelled in their respective p matrices and put into a single l matrix let the edges of the box have the lengths of a units in the x axis b units in the y axis and c units in the z axis the origin is set to o 0 0 0 the six faces are written as follows 53a f t o p 0 0 0 10 a 0 0 10 a b 0 3 0 b 0 1 53b f b o t t o m 0 0 c 10 a 0 c 10 a b c 3 0 b c 1 53c f f r o n t a 0 0 10 a 0 c 10 a b c 1 a b 0 1 53d f b a c k 0 0 0 10 0 0 c 10 0 b c 1 0 b 0 1 53e f l e f t 0 b 0 10 a b 0 10 a b c 2 0 b c 1 53f f r i g h t 0 0 0 10 a 0 0 10 a 0 c 2 0 0 c 1 in equation 53 the surface normals of the box are defined the top face normal is oriented in the z direction f t o p 3 3 3 similarly f b o t t o m 3 3 3 denotes the reverse of the z axis orientation in place of writing out the six matrices using the move command and only adjusting the normals would reduce the matrices to three after setting a 15 b 5 and c 2 the resulting box is in fig 12 the versatility of modelling using faces stems from the possibility of parameterising and scripting the midship section in fig 13 is an extended example to the barge given above it may serve to obtain an estimate of weight and inertia of the section the components such as the deck and the bottom plates are quadrilaterals identical to the top and the bottom of the prism the stiffeners are added iteratively by offsetting the copy of a single stiffener multiple times the bilge is built with a function of radius the process may be summarized as repeating equation 53 with altered parameters within a script a ship s hull form is an alternative example a table of offsets used in naval architecture provides the width of a transversal section as a function of depth when the depth values of adjacent transversal sections are connected longitudinally the result is the ship s hull form the bulkheads in fig 14 may be added by connecting the opposing vertices transversally instead of longitudinally the hull form model may be used for hydrostatic and hydrodynamic calculations it is also possible to obtain the distributed weight of the hull along its length required for bending moment calculations brunelleschi s octagonal dome in florence is presented in fig 15 and illustrates an example from architecture in this case the changing radius of the dome is read from an external file which registers the real measurements of the dome a single side of the octagon is built copied and moved within a script the rotations are performed about the origin for the support system and about their first defined point for the edges sides 5 validation of mass property calculations and the panel method model the volume the centre of gravity the weight the inertia calculations and the panel method model are validated below models for the box and the frustum were built in ansys using shell elements to compare the weight and inertial data four nodes and four thicknesses define this element in the cases presented below the thickness is assumed to be identical over the area of the element with the values input at the four nodes the box model is represented as a collection of its six faces the frustum is constructed by sweeping the bottom edge towards the top edge along the height of the model rhino3d can open the meshes in gdf file format therefore it was used to get a comparison of volume the use of sectional volume i e the volume up to a certain depth which can be expanded onto sectional weight is discussed for the panel method comparison a cylinder model was built in rhino3d with the sizing described in tracy 2007 and both were run in wamit lee and newman 2005 units are omitted providing that they are consistent between software they are not indicators information relating to the described method s usage practices are mentioned when required 5 1 volume table 1 lists the results of volume calculations with parmod rhino and when possible analytical formulae the current approach is listed under the abbreviation of parmod parametric modeler the comparison of methods must be carried out on identical models when possible and a rounded shape represented by a collection of a finite number of panels loses some volume e g a cylinder divided into four segments is a diamond shape with a lower volume therefore comparisons are provided against rhino3d s measurements as opposed to the analytical values analytical values are included present an idea on the loss of volume due to panelling and serve to validate the geometry of the model itself in table 1 the glass the semisubmersible and the dome show slight differences the remaining results are identical despite the intuition the glass is the most complex shape in the list it has an inner surface modelled with the opposite surface normal of the outer surface it was purposefully built to measure the possible errors the difference in measurement is 2 21 percent in that case for the other two cases rhino3d could not measure when all areas are not enclosed therefore the models needed adjustments e g the dome had to be capped the values reflect the alterations in the models volume calculations as a function of depth are useful in stability studies of floating structures fig 16 delivers this type of computation for the box the figure also illustrates that to obtain a good distribution the number of sections should go past a certain value in the z direction the calculated volume is correct at the maximum depth intermediate values are lost as there is only a single section for integration see fig 12 bottom and top faces this figure shows that the direction with the most number of sections is preferable when getting the distributed values the semisubmersible s z integration is similar despite the cross braces resulting in an increased number of z sections the volumes at the water level i e 0 depth are identical for the x y and z integrations when all of the panels are considered 5 2 centre of gravity weight and inertia the centre of gravity weight and inertia comparisons are presented for the frustum and the box figs 7 and 12 using thicknesses of 0 05 and 0 06 respectively the density of steel was used as the material density value 7850 table 2 lists the weight and the centre of gravity estimations both results are identical to ansys the two sets of inertias are provided in tables 3 and 4 the inertial values are given for the origin and the centre of gravity cog for both cases the inertial values at the origin are identical when the inertia at the centre of gravity is examined the results differ around 0 5 percent it is probable that there is a difference in rounding of the values of the centre of gravity in that case the inertial values would reflect the difference when multiplied by the distance squared 5 3 panel method calculations in the field of hydrodynamics the coefficients play an important role and their calculation depends on the underwater geometry these added masses and potential damping values can be calculated from a suitably developed mesh the added masses are denoted by a while the potential damping is denoted by b the subscript 11 is used for the surge mode and 55 denotes pitch this section illustrates the usage without discussing modelling practices fig 17 presents the panel method calculation results of a cylinder mesh modelled in parmod and rhino3d a platform with a 19 m radius at a draft of 20 m located at a 200 m water depth was chosen for which a set of results are readily available tracy 2007 these data do not show differences between the parmod and rhino3d models in models of higher complexity it is likely that there will be certain differences depending on the modelling practice e g the number of panels and the results will reflect that fig 18 shows a comparison for the semisubmersible in fig 11 the multisurf set was published in coulling et al 2013 the values compare favourably with slight shifts in peak amplitudes 6 performance assessment average runtimes become important when the tool is used inside a larger system for design in an iterative setting it should require the minimal amount of time to deliver the model and its mass properties inside a loop the available time should preferably be reserved for other calculations such as the panel method code s runtime or any additional module therefore this section focuses only on the mass property and modelling times the goal of providing this data is to clarify that the approach is minimally resource intensive to avoid hindering the design process the performance depends on the number of panels used for the structure modern computers provide enough computational power to deliver fast results in simple arithmetic operations the bottlenecks prove to be file writing and the trigonometric functions used for rotations consequently a breakdown of modules is necessary to understand expected the runtime furthermore measuring the performance requires additional calculation time for that reason multiple measurements were taken with and without the performance measurement code the final runtime is given without the performance measurement code the modules assessments have to include the additional code s contribution therefore the totals are not equal details are presented in table 5 for the semisubmersible and the torus the torus also includes a rotated version rotating it 45 in both x and y axes ensures that each panel is rotated at least once therefore approximately there is a total of 9600 rotations performed as explained above file operations and rotations emerge as the degraders of performance overall 1 s per 1000 panels is a reasonable average runtime as seen in table 6 7 conclusions the work provided a numerical solution to the 3d modelling of structures obtaining their mass properties and providing a compatible mesh model for panel method calculations the input data was described based on matrices making it possible to script out geometries parameterization of a 3d model was explained to provide a basis for obtaining variations of a model in iterative calculations a range of examples was given to demonstrate the usage of the code the list included a frustum a sphere a torus glass a rectangular prism a midship section an offshore platform a ship hull and a dome to illustrate variety the code was evaluated on these samples to calculate the mass properties of weight inertia volume and the centre of gravity the results were used to validate the calculation method through comparisons with specialized software panel method validation was carried out on a cylinder and a semi submersible offshore platform overall this approach delivers mass data within a 0 5 margin compared to ansys volume calculations are in a similar range when compared to rhino3d evaluations in wamit for a cylinder the model prepared with a combination of rhino3d and panelingtools gave identical results with the presented method for a semisubmersible wind turbine platform prepared in multisurf the data compared favorably to published results the performance indicators summarise that the expected runtime was approximately 1 s per 1000 panels to provide mesh model and solve it for mass which is unlikely to be a hindrance to the design systems that would include this type of calculations accordingly this method can be integrated into early design states to replace spreadsheets and manual calculations or used for obtaining distributed mass properties from available mesh grids acknowledgements the work has been conducted within the strategic research plan of the centre for marine technology and ocean engineering which is financed by portuguese foundation for science and technology 
23333,in this paper seakeeping performance of vessels is comparatively investigated by means of improved 2 5d theoretical calculation small scale model towing tank test and large scale free running model sea trial this study also provides a scheme of ship vertical motion stabilization technique by using semi submerged bow ssb appendages firstly an improved strip theory based 2 5d theoretical seakeeping algorithm which considers the viscous flow effects attributed to bow appendages is developed to estimate ship vertical motion responses in regular waves short term predictions are also made on the basis of spectral analysis theory to predict ship motion responses in irregular waves then corresponding small scale models are made and tested in a laboratory towing tank for both regular and irregular wave conditions to confirm the numerical results the tank testing results between different ship schemes are also compared to experimentally investigate the effects of ssb and fin on hull vertical motion stabilization furthermore large scale model sea trials are conducted in coastal waves for a final validation of the ship seakeeping performance in short crested sea waves finally comparisons of the results by different testing approaches are systematically made and analyzed keywords improved strip theory 2 5d potential flow theory seakeeping performance deep v monohull semi submerged bow ssb tank test large scale model sea trial 1 introduction currently seakeeping performance of ships is generally investigated by numerical calculation scaled model wave tank test and full scale sea trial in fact different methods have their own advantages and disadvantages generally numerical methods are widely used due to their convenience and effective merits and they are the preferred choice at ship preliminary design stage till now 2d strip theories are widely used since they were developed in the late 1950s the linear motions of hull at zero or low speed can be predicted by classical strip theories e g original strip method korvin kroukovsky and jacobs 1957 new strip method tasai and takagi 1969 rational strip theory ogilvie and tuck 1969 and s t f method salvesen et al 1970 however the 3d effects of free surface should be considered when predicting ship hydrodynamics at high speed thus the classical strip theories are no longer applicable since they are based on the low speed and high frequency basic assumption the high speed slender body theory 2 5d theory was initially proposed by chapman 1976 and then used to calculate ship motions in regular waves by faltinsen and zhao 1991 then many scholars have applied the 2 5d theory to predict ship motion and loads in waves at high forward speed due to its practicability and high efficiency compared with 3d theories ma et al 2004 li et al 2017 as a matter of fact some strong nonlinear hydro structure interaction problems are complex and difficult to be satisfactorily addressed by numerical calculation experiments do not only reflect what really happens on the ship but are also used to validate numerical algorithms maron and kapsenberg 2014 however there exist some challenges or disadvantages associated with the conventional experimental approaches for example small scale models are usually towed in hydrodynamic wave tanks where uni directional or multi directional waves are artificially generated by wave maker in fact realistic sea states acting on full scale ships are however nonlinear short crested waves romolo et al 2014 only a finite number of waves are suffered by model during one run distance along the towing tank scaling effects may be obvious by using small scaled models especially for ship resistance and propulsion measurement moreover seakeeping characteristics such as slamming event and green water on deck of ships in actual sea conditions are found to be quite different from those observed in laboratory environment especially for ships sailing in severe seas at high forward speed see fig 1 on the other hand the conduct of full scale sea trial needs enormous financial and labor resources andersen and jensen 2014 since the weather and sea state are neither controllable nor repeatable some high sea states expected for investigation of ship responses in extreme sea states are rarely observed thomas et al 2011 it is reported that the 2d long crested waves will over estimate ship motion and load responses compared with the 3d short crested waves in some conditions chen et al 2011 li and wen 2007 ji et al 2015 although some state of the art tank facilities allow the generation of multi directional irregular waves the pseudo random waves artificially generated by wave makers are more or less different from the natural sea waves realistic wind driven sea waves need enough space and time for fully evolution and they are associated with obvious nonlinear characteristics such as sharp crest and flat trough toffoli et al 2008 moreover the frequency range of realistic sea waves is characterized with broad band distribution which is difficult to be reproduced in tanks therefore it is of great necessity to investigate ship seakeeping performance that operating in actual sea conditions based on the above situations large scale model testing methodology was proposed this approach includes carrying out seakeeping tests by relatively larger scaled models in actual sea conditions in some sense this testing approach is a compromise between laboratory tank test and full scale ship sea trial and combines majority of their advantages jiao et al 2016a for example large scale model test is much more realistic than tank test since the sea state is more complex and real lloyd 1989 the self propelled model is possible to run at any arbitrary heading angles in a relative long sailing distance on the other hand the conduct of large scale model sea trial is much cheaper and easier compared with full scale sea trial large scale model measurement is especially meaningful as a final confirmation tool before the construction of ship prototype large scale model testing technique which provides reliable and valuable referred data during advanced ship design stage has been developed for years in some countries e g america france greece china and italy in order to investigate the performance of zumwalt class destroyer ddg 1000 the us navy developed a large steel model with a scale ratio of 1 4 which is about 45 m long 6 m wide and with a light displacement of over 90 tonnes a series of hydrodynamic tests were conducted and the human factors related to its greatly reduced crew size were simulated quintana et al 2007 the model was finally utilized for underwater explosion and floodability tests shi 2007 zhang et al 2017 a 1 12 large scale manned model of aircraft carrier charles de gaulle was built by the french navy which is about 20 m long and 20 tonnes mass some typical devices such as fin stabilizer and transverse stabilization system were fitted on the model for testing and evaluation a series of tests with respect to maneuverability seakeeping and propeller performance were conducted by the model in seaways jiao et al 2016b summarized the survey of large scale model research and development in china a large scale segmented ship model for wave load measurement is reported in details in the article the model is about 12 m long and with a displacement of about 4 6 tonnes grigoropoulos and katsaounis 2004 provided the measurement procedure of a large scale corvette model seakeeping tests at sea testing methodology scope of measurements and the advantages of testing large models are summarized in their article coraddu et al 2013 on behalf of and supported by the italian navy carried out manoeuvring test of a twin screw naval ship by large scale model in a flat volcanic lake to investigate the asymmetric behavior of the ship shaft lines during manoeuvre the model is about 7 2 m long and equipped with a dedicated testing system allowing the measurement of propulsion behavior the vertical motion stabilization of especially naval ships is a reason of great concern since crew and equipments need a stable platform to work effectively as a matter fact the reduction of pitch motion of hull is a challenging task due to the large longitudinal moment of inertia i θ of ship li 2003 sun et al 2016a the semi submerged bow ssb scheme was initially reported by kihara and tazawa 1985 and it was applied on small vessels of about 40 m long displacement of about 200 tonnes the motion stabilization effects of ssb have been demonstrated by both theoretical and experimental methods in their work our previous research also indicates that the ssb technique provides obvious advantages in improving ship vertical stability jiao et al 2015 for further improvement of hull vertical motion stability a novel scheme of ssb with twin fins mounted is presented in this paper this study confirms that the bow appendages ssb and fins are of great help in achieving vertical motion stabilization both numerically and experimentally in our research project in cooperation with the chinese navy we were committed to developing a kind of hybrid monohull with excellent integrated navigational performance the project was mainly aimed at achieving the following objectives develop a kind of deep v stealth monohull with low resistance and high seakeeping ability characteristics which has better seakeeping performance compared with the classical round bilge monohull investigate the effects of ssb on ship resistance and seakeeping performance by both numerical and experimental approaches develop a large scale model testing technique for ship seakeeping measurement in realistic 3d sea waves this testing technique is aimed at being applied as a final confirmation tool before prototype construction in this paper the seakeeping performance of hybrid hulls is comprehensively investigated by means of 2 5d seakeeping theoretical calculation tank model test and large scale model sea trial so as to achieve the above objectives the structure of the paper is arranged as follows the ship forms and their optimization procedure are described in section 2 an improved 2 5d potential flow theory based seakeeping algorithm which considers the viscous flow effects of ssb and fins is developed in section 3 then four small scale models towing tank tests are carried out and the results are presented in section 4 for a final confirmation of ship seakeeping ability in a realistic sea environment a suite of large scale model experimental system is established and sea trials are conducted in coastal area of china which is reported in section 5 the large scale model experimental results are analyzed in section 6 then systematically analyses and comparisons of results by different testing approaches are reported in section 7 finally main conclusions obtained from this study and recommendations for future research direction are summarized in section 8 2 ship form determination and description 2 1 hybrid hull optimization procedure in the related research project a conventional round bilge hull r0 is adopted as a reference then a series of deep v hulls v 1 v 2 v i are proposed a hull lines optimization algorithm is developed according to the framework as shown in fig 2 and it is applied on the deep v hulls a good balance between ship resistance and seakeeping performance is achieved through the optimization algorithm the radar cross section rcs of monohull is also estimated and evaluated to meet the hull stealth requirement flowchart of the series ship form determination is schematized in fig 3 the identified candidate hull through the first round optimization is named as v1 then a series of ssb schemes s1 s2 sj are designed and applied on v1 the preferred hull with the best ssb through the second round of optimization is named as v2 afterwards a series of fin schemes f1 f2 fk are designed and applied on v2 the preferred hull with the best ssb and fins through the third round of optimization is named as v3 it is noted that this paper mainly concentrates on the investigation of seakeeping performance of the developed hulls by both numerical and experimental approaches the effects of ssb and fins on vertical motion reduction are also systemically investigated 2 2 ship form description as aforementioned the developed deep v hulls v1 v2 and v3 are designed to be in accordance with the same main hull prototype they are however designed to be without or fitted with different bow appendages in order to investigate the influence of ssb and fins on vertical motion stabilization the status of the three hulls in terms of bow appendage is listed in table 1 for clarity the sketch of a ssb with fins is schematized in fig 4 it is noted that the fins are located at the baseline level height of hull and their forward point is at the maximum width position of ssb longitudinally the effects of vertical motion reduction of ssb and fins can be attributed to the viscous hydrodynamic damping force and lift force generated due to the relative vertical movement of bow appendages against the fluid the lift force is generated when the appendages are advancing with angle of attack mainly caused by pitch in fluid the motion stabilization is then achieved since the damping force and lift force are always opposite to the vertical movement direction of bow cai et al 2003 it is worth mentioning that the dimensions of ssb and fins should be elaborately and carefully designed and optimized by experiential and numerical methods sun et al 2014 and it is a challenging task to determine the ssb dimensions for a designated hull to achieve the best stability in this study the ssb is designed in accordance with naca 00 airfoil shape and the fins are in accordance with tsagi airfoil shape at any arbitrary longitudinal plane table 2 presents the parameters of the optimized ssb and fins the ratio of displacement of ssb to the whole hull design displacement is about 1 92 body plans of the round bilge type hull and deep v type hulls are presented in fig 5 a and b respectively it is noted that in fig 5 b the ssb is marked in blue lines and the fin is marked in green lines main dimensions of the ships are listed in table 3 3 numerical seakeeping method in order to numerically estimate the motion responses of hybrid monohull in regular waves an improved 2 5d theory based algorithm was developed the improvements were made by taking the viscous fluid effects and the hydrodynamic forces acting on bow appendages into consideration the viscous flow effects caused by ssb and fin are considered from the two aspects i the viscous hydrodynamic damping and lifting forces acting on the hull caused by ssb and fins are estimated by computational fluid dynamics cfd tool or empirical formula then a series of additional hydrodynamic coefficient terms are introduced into the basic motion governing equations ii the sectional hydrodynamic coefficients a 33 and b 33 i e added mass and damping coefficients in vertical displacement mode are acquired by means of cfd method to include the contribution of vortex related viscous forces to viscous damping 3 1 the improved strip theory in the potential flow theory the fluid is assumed to be ideal i e incompressible inviscid continuous and irrotational in this study the head wave condition is defined as 180 heading angle while 0 90 and 270 are for following wave port beam wave and starboard beam wave respectively as shown in fig 6 three coordinate systems are introduced to describe ship motion in waves i the space fixed system o xyz is an inertia system with the plane oxy lying on an undisturbed free surface ox directed with positive in the direction of which incident wave come and oz pointing vertically upward ii the plane movement system o xyz is a horizontal moving coordinate system with the same moving speed and direction as the ship forward speed u and wave heading β the origin o is coincident with the o initially and oz pointing vertically upward across the ship s center of gravity cog iii the body fixed system g x b y b z b is fixed on the ship the origin g is coincident with the cog of the hull body and the x b y b and z b axes are directed toward the bow the port side and the sky respectively this coordinate system is also coincident with the plane movement system when the ship is in a mean position for consistency the relationship between these three coordinate systems is expressed as follows 1 x y z cos β sin β 0 sin β cos β 0 0 0 1 x u t cos β y u t sin β z x b y b z b z g where t denotes the time z g denotes the vertical distance of cog of ship with respect to free surface according to the knowledge of linear strip theory the basic vertical movement governing equations of hull in regular waves under the plane movement system o xyz are expressed as follows 2 m a 33 η 3 b 33 η 3 c 33 η 3 a 35 η 5 b 35 η 5 c 35 η 5 f 3 e i ω e t 3 i 55 a 55 η 5 b 55 η 5 c 55 η 5 a 53 η 3 b 53 η 3 c 53 η 3 f 5 e i ω e t where m denotes ship mass i 55 denotes ship longitudinal moment of inertia η 3 denotes heave motion η 5 denotes pitch ω e denotes wave encounter frequency t denotes time f 3 denotes vertical external force acting on the hull f 5 denotes vertical external moment acting on the hull the hydrodynamic coefficients a ij and b ij i j 1 6 can be obtained by calculating the radiation force which is described in section 3 3 3 1 1 viscous effects of ssb the vertical viscous force acting on ssb per unit length is described as 4 d f ν x 1 2 ρ b x m c l u 2 c d w w d x where ρ denotes fluid density b m x denotes the breadth of ssb at longitudinal ordinate x in the body fixed coordinate system c l and c d respectively denotes vertical lift coefficient and drag coefficient of ssb u denotes ship forward speed w denotes the relative vertical velocity of ssb against the fluid to summarize the first term at the right hand side of eq 4 represents viscous hydrodynamic lift and the second term represents viscous hydrodynamic drag the lift coefficient is further expressed as follows 5 c l α 0 α t where α 0 denotes the lift coefficient ratio slope of lifting force with respect to angle of attack of ssb α t denotes the real time angle of attack in the plane movement coordinate system the relative vertical velocity w and angle of attack α t of ssb can be derived by eqs 6 and 7 respectively 6 w x η 3 x η 5 ζ w x 0 d 7 α t η 5 w u where d denotes the mean underwater depth of ssb baseline and the vertical velocity component of incident wave is expressed as follows 8 ζ w x y z φ i z e i ω e t i ω e ζ a e k z i k x cos β i k y sin β e i ω e t where φ i denotes velocity potential of incident wave ζ a denotes wave amplitude k denotes wave number β denotes ship heading angle thus the vertical velocity component of incident wave at mean baseline depth d can be obtained by substituting the coordinate point x 0 d into eq 8 in order to linearize the second order velocity time dependent term w w in eq 4 the fourier series expansion is applied and it can be simplified as follows 9 w w 8 3 π w a w where w a denotes the amplitude value of w response it is noted that the linearization process is aimed at enabling this term to be added into the linear overall motion governing equation for solution the total vertical viscous force acting on ssb body is obtained by integrating the sectional force along its whole longitudinal length which is expressed as 10 f ν 1 2 ρ l b m x α 0 u 2 η 5 u w d x 4 3 π ρ l b m x c d w a w d x by substituting eq 5 9 into eq 10 we get the total vertical force acting on ssb which is given as follows with a simplified format 11 f ν b 33 η 3 b 35 η 5 c 35 η 5 f 3 ν e i ω e t where the hydrodynamic coefficient terms b 33 b 35 b 35 and f3ν are given in appendix in a similar way the total vertical viscous moment acting on ssb is expressed as 12 m ν b 55 η 5 c 55 η 5 b 53 η 3 m 5 ν e i ω e t where the hydrodynamic coefficient terms b 55 b 53 c 55 and m5ν are given in appendix 3 1 2 viscous effects of fins the hydrodynamic lift force acting on a single fin is expressed as follows 13 l f 1 2 ρ u 2 s c l f where s denotes the projected area of fin on horizon plane c lf denotes the lift coefficient of fin which is obtained by cfd computation in this study in addition for future reference and convenience the value of c lf for typical elliptical type airfoil can be also estimated by the following empirical formula 14 c l f 5 7 1 2 ε α f 0 where α f0 denotes the lift coefficient ratio of fin ε is the effective aspect ratio the real time angle of attack of fin with respect to the oncoming flow is expressed as 15 α f t η 5 η 3 x f η 5 ζ w x f y f z f u where x f y f and z f are the coordinate of representative position at 1 4 chord length of the fin moreover the vertical drag force and vertical rigid body inertia with corresponding fluid force of fin can be obtained by the following eqs 16 and 17 respectively 16 d f 1 2 ρ s c d f w f w f 4 3 π ρ s c d f w f a w f 17 k f m f δ m f η 3 x f η 5 where w f denotes the real time relative vertical velocity of fin against fluid and w fa is the corresponding amplitude value m f denotes the mass of a fin δm f denotes the fluid added mass of fin in vertical movement mode based on eqs 13 16 and 17 the overall vertical hydrodynamic force and moment acting on twin fins are expressed by 18 f f l f d f k f l l f d f k f r 19 m f x f f f where subscript l or r denotes the fin at left or right side respectively by synthesizing eq 13 19 the hydrodynamic force and moment attributed to twin fins can be re written as 20 f f a 33 f η 3 b 33 f η 3 a 35 f η 5 b 35 f η 5 c 35 f η 5 f 3 f ν e i ω e t 21 m f a 55 f η 5 b 55 f η 5 c 55 f η 5 a 53 f η 3 b 53 f η 3 m 5 f ν e i ω e t where the hydrodynamic coefficient terms a f 33 b f 33 a f 35 b f 35 c f 35 f 3fν a f 55 b f 55 c f 55 a f 53 b f 53 and m 5fν are given in appendix 3 1 3 estimation of lift and drag coefficients of bow appendages the lift coefficient of ssb or fin is calculated by using the following equation 22 c l 2 l ρ u 2 s where s denotes projected area of appendage on the horizontal plane the lift force l is calculated by cfd method which is described as follows the lift of ssb or fin advancing with different angles of attack and at different forward speeds is calculated by the ansys fluent 13 0 software the unstructured volume meshes of fluid domain are generated with the help of the gambit 2 4 6 software see fig 7 a the velocity inlet and outflow surfaces are set to be in front of and behind the ssb respectively the side surfaces are set to be the wall boundary condition the lift force acting on the ssb can be obtained by solving the reynolds averaged navier stokes rans equations fig 7 b shows the simulated pressure distribution on the advancing ssb during steady flow state the lift of fin can be calculated using the same method the calculated and the linear fitted lift coefficients for ssb and fin are summarized in fig 8 the obtained lift coefficient ratios for ssb and fin are 1 083 and 2 153 angle of attack in radian respectively the drag coefficient of ssb and fin for moving in vertical direction can be estimated with the help of cfd tool by solving rans equations which is similar as the lift calculation method above mentioned however in this study the drag coefficients are estimated by empirical formula for convenience our previous study indicated that the results by empirical formula are reliable for application in this condition the drag coefficient largely depends on re number and turbulence intensity and the variation of drag coefficient is small in a wide range of re number molin 2002 the drag coefficient of fin c df can be approximately taken within 0 7 0 8 zhang and li 2006 moreover the following formula is used to estimate the drag coefficient of ssb 23 c d x 1 3 κ x 0 25 d x b x where κ x denotes sectional area ratio at longitudinal ordinate x b x denotes sectional breadth and d x denotes sectional height 3 2 calculation of hydrodynamic coefficients in heave mode by cfd in the classical potential flow theory 2d sectional hydrodynamic coefficients are usually acquired by means of source distribution method which provides satisfactory results for ships with simple lines plan the section shape of deep v hybrid hull with ssb is however complex and thus the viscous flow effects should be considered zhou et al 2015 han et al 2014 with this in mind a 2d hull section oscillation model is numerically setup by using the fluent software the sectional triangle meshes are generated with the help of the gambit software the free surface is modeled by a two phase volume of fluid vof technique to determine the vertical radiation force of the section oscillating in fluids the hull section is forced for vertical oscillation with fixed small amplitude at fixed frequency instructed by udf code using morphing grid technique the rans equations are solved by means of rng k ε turbulence model the computations were done over a wide range of oscillation frequency the sectional added mass and damping coefficients can be extracted from the calculated radiation force results by the following method the external force acting on a vertical oscillating section comprises two components 24 f f s f z where f s denotes hydrostatic restoring force and f z denotes radiation force they are respectively expressed by he following equations 25 f s ρ g b η 3 26 f z a 33 η 3 b 33 η 3 where ρ denpotes liquid density g denotes gravitational acceleration b denotes breadth of hull section at waterline level a 33 and b 33 denotes sectional added mass and damping coefficient in heave mode the vertical displacement of section can be expressed as follows 27 η 3 a sin ω t where a denotes amplitude of sectional oscillation ω denotes oscillating frequency t denotes time the time series of external force f in eq 24 can be obtained by cfd calculation which is also expressed as follows 28 f f a cos ω t θ 0 f a cos ω t cos θ 0 f a sin ω t sin θ 0 where f a and θ 0 respectively denotes amplitude value and initial phase of the variable force f which can be obtained by fitting the time series calculated by cfd code the added mass and damping coefficient in heave mode can be obtained by combining eq 24 28 and they are expressed as follows 29 a 33 ρ g b a f a sin θ 0 a ω 2 30 b 33 f a cos θ 0 a ω a comparison of the added mass and damping coefficient calculated by potential flow method and the above described viscous flow method is conducted sections at 1 3 stations of v3 are selected for comparison due to their complex shape body plans of sections 1 3 are presented in fig 9 it is noted that the fins are not included in cfd simulation since the vertical rigid body inertia force and the corresponding fluid force of fin have been calculated by eq 17 view of the numerical simulation of flow field by the ansys fluent is shown in fig 10 the calculation results by different methods are shown in fig 11 it can be observed that there exists distinct difference between damping coefficients by different methods for sections 1 and 2 the damping coefficients by viscous flow method are generally larger than those by potential flow method due to the contribution of vortex related components and the disparity increased with the increasing frequency the largest disparity of results appeared at section 2 due to the large proportion of ssb however the results for section 3 show good agreement between the two methods due to the small proportion of ssb moreover it is found that the results for section 4 20 show good agreement between the two methods and they are not presented due to space limitation reasons 3 3 the solution of motion equations by 2 5d theory the updated ship vertical movement equations after adding the hydrodynamic coefficients attributed to ssb and twin fins are presented as follows 31 m a 33 a 33 f η 3 b 33 b 33 b 33 f η 3 c 33 η 3 a 35 a 35 f η 5 b 35 b 35 b 35 f η 5 c 35 c 35 c 35 f η 5 f 3 f 3 ν f 3 f ν e i ω e t 32 i 55 a 55 a 55 f η 5 b 55 b 55 b 55 f η 5 c 55 c 55 c 55 f η 5 a 53 a 53 f η 3 b 53 b 53 b 53 f η 3 c 53 η 3 f 5 m 5 ν m 5 f ν e i ω e t in order to consider the forward speed of ship during simulation the high speed slender body theory was applied to solve the motion governing equations this theory is also called 2 5d theory since the free surface condition is 3d whereas the governing equation and body surface conditions are 2d it is assumed that the ship forward speed is high enough so that the wave making in front of ship can be ignored thus the brard number satisfies chen and noblesse 1998 noblesse et al 1999 33 τ ω e u g 2 27 the steady wave making potential фs is ignored in the theory the flow field velocity potential is decomposed into time dependent term and space dependent term 34 φ x y z t re φ x y z e i ω e t the fluctuating space dependent potential around the ship can be further decomposed and expressed as 35 φ x y z φ i x y z φ d x y z φ r x y z where ϕ i x y z denotes incident wave potential ϕ d x y z denotes diffraction potential ϕ r x y z denotes radiation potential furthermore they are re written by velocity potentials that are a response to unit wave amplitude or unit motion amplitude 36 φ i x y z ζ a φ 0 x y z 37 φ d x y z ζ a φ 7 x y z 38 φ r x y z j 1 6 i ω e η j a φ j x y z where ζ a denotes incident wave amplitude ω e denotes encounter frequency ϕ j j 1 2 6 denotes the jth mode component of radiation potential and j 1 2 6 respectively denotes surge sway heave roll pitch and yaw motion η ja denotes the magnitude of jth motion component and can be expressed by 39 η j t η j a e i ω e t j 1 6 the radiation or diffraction velocity potential ϕ j j 1 2 7 satisfies the following boundary conditions 40 2 φ j y 2 2 φ j z 2 0 i n ω f i ω e u x 2 g z φ j 0 z 0 φ j n i ω e n j u m j j 1 6 φ 0 n j 7 o n s b φ j φ j x 0 x x 0 φ j 0 z where ω f denotes liquid domain sb denotes body surface condition x 0 is longitudinal coordinate value of ship forward perpendicular by applying the assumption that the ship is slender and the component of normal vector of hull surface on x axis is very small compared with those on y and z axes n j and m j j 1 6 are expressed as follows 41 n 1 n 2 n 3 n 4 n 5 n 6 0 n 2 n 3 y n 3 z z g n 2 x n 3 x n 2 42 m 1 m 2 m 3 m 4 m 5 m 6 0 0 0 0 n 3 n 2 where 0 n 2 n 3 denotes the inward directed unit normal vector of one point on the 2d hull surface section m j j 1 6 denotes the second order differential of the steady potential ux фs it is noted that the effect of steady perturbation potential фs is ignored in this study the following transformations are adopted to simplify the velocity potential boundary conditions 43 t x x x 0 u 44 ψ j t y z φ j x y z e i ω e t x j 1 7 it is noted that the above transformations are aimed at simplifying the free surface boundary condition in eq 40 which includes the speed term u the transformation also ensures that the transformed free surface boundary condition is similar with that for the zero speed condition and could then be solved by 2d time domain free surface green function in fact the speed term u is however indirect included and considered in the introduced time domain function t x therefore the boundary conditions in eq 40 can be re written as follows 45 2 ψ j y 2 2 ψ j z 2 0 i n ω f 2 ψ j t 2 g ψ j z 0 z 0 ψ j n i ω e n j u m j e i ω e t x j 2 6 φ 0 n e i ω e t x j 7 o n s b t ψ j ψ j t 0 t 0 ψ j 0 z according to the body surface condition in eq 45 the radiation potentials can be further decomposed into 46 ψ j ψ j 0 u i ω e ψ j u j 2 6 where ψ j 0 and ψ j u satisfy the following body surface conditions 47 ψ j 0 n i ω e n j e i ω e t x ψ j u n i ω e m j e i ω e t x j 2 6 the radiation potentials can be simplified by considering the basic assumption that the steady wave making potential фs is small and its influence on body surface condition is not considered in addition by taking eq 41 42 into account the simplified radiation potentials are expressed in the following eq 48 therefore the radiation potentials ψ j can be obtained by solving the ψ j 0 48 ψ j ψ j 0 j 2 4 ψ 5 ψ 5 0 u i ω e ψ 3 0 ψ 6 ψ 6 0 u i ω e ψ 2 0 it is clear that the boundary condition problem in eq 45 is a issue of 2d time domain nonlinear motion issue without forward speed which considers the nonlinear instantaneous wetted body surface the initial condition is determined by the boundary conditions of the 2d section at fore x x 0 then the flow field and radiation potentials at different hull sections can be addressed in the order from fore section to aft section by time stepping approach in the literature work the grid and distributed source are applied on both free surface and body surface and the boundary conditions are usually addressed by simple green function in time domain however the simple green function method has drawbacks such as unstable expensive and time consumed in this study a 2d time domain free surface green function for infinite water depth case is used to formulate the integral equation on the 2d body surface which is expressed as follows 49 g p t q τ δ t τ ln r p q r p q h t τ g p q t τ where p and q are respectively field point and source point and their locations are p y z and q η ζ in geodetic coordinate respectively δ t denotes the dirac delta function h t denotes unit step function the transient effects of flow is considered in the term of ln r p q r p q and 50 r p q 2 y η 2 z ζ 2 51 r p q 2 y η 2 z ζ 2 the memory effect of 3d free surface is considered in the term of g p q t τ 52 g p q t τ 2 0 g k e k z ζ cos k y η sin g k t τ d k z 0 ζ 0 which satisfies the following boundary conditions 53 2 g 0 τ t 2 g τ 2 g g ζ 0 ζ 0 g t τ 0 g τ t τ 2 g z ζ r p q 2 2 g ζ ln r p q suppose that point p is in the fluid field ω f at time t point q is on the closed loop formed by the body surface boundary sb τ free surface boundary sf τ and infinity boundary s τ at time τ as shown in fig 12 a τ and b τ are the cross points of sb and sf at time τ the 2d time domain body surface boundary integral equation is finally expressed as follows 54 π ψ j p t s b t ln r p q r p q ψ j q t n q ψ j q t n q ln r p q r p q d s q 0 t d τ s b τ g ψ j q t n q ψ j q t g n q d s q 1 g 0 t d τ g ψ j τ ψ j g τ a t a b where the subscript a b means the difference of the equation values with respect to source point q at the two different points a and b the velocity potential ψ j p t is solved by source distribution method once the velocity potentials are obtained the hydrodynamic pressure for radiation and diffraction components acting on hull surface is expressed as follows 55 p j x y z ρ i ω e φ j u φ j x ρ e i ω e t ψ j t j 2 7 the radiation and diffraction forces are obtained by integrating the corresponding pressure over the wetted hull body surface the hydrodynamic coefficients are then obtained by the radiation force 56 a i j ρ ω e 2 l s x t cos ω e t x re ψ j t sin ω e t x im ψ j t n i d l d x b i j ρ ω e l s x t cos ω e t x im ψ j t sin ω e t x re ψ j t n i d l d x the diffraction force is obtained by 57 f d j s b p d n j d s ρ re l e i ω e t x d x s x t ψ d t n j d l e i ω e t the overall motion equations in eq 31 32 can be finally solved by either frequency domain method or time domain method it is noted that the hydrodynamic coefficients for heave mode adopted are those obtained by cfd calculation 4 small scale model towing tank tests to experimentally investigate the seakeeping performance of the ships small scale models towing tank tests were conducted another objective of the tank tests is to validate the effects of ssb and fin on vertical motion stabilization since the laboratory tank wave parameters are well controlled and repeatable compared with realistic sea waves four 1 40 small scaled models i e r0 v1 v2 and v3 were constructed corresponding to the prototypes comparative views of the two small scale models v1 and v3 are shown in fig 13 the tests were conducted in the towing tank of harbin engineering university which is 108 m long 7 m wide and 3 5 m deep both regular and irregular head wave tests were conducted in the tank a powered carriage running on rails along the tank with a maximum speed capacity of 6 5 m s and speed accuracy of 0 001 m s is used to tow the model during the model running the model forward speed is achieved by gravity pull applied which is transferred by the heave rod and acts at cog of the model the model is connected to a 4 degree of freedom 4 dof i e heave pitch roll and surge motion measurement instrument which restricts the model s transverse motion i e sway and yaw by its heave rod the sketch of model setup and the towing guidance and motion measurement instrument is shown in fig 14 a computer controlled single hydraulic flat plate wave maker is situated at one end of the tank and at the other end is a wave absorbing ramp the period of the waves generated by the wave maker ranges from 0 4 to 4 s the largest wave height capacity of the wave maker is 0 4 m for regular waves and significant wave height 0 32 m for irregular waves a resistive wave probe is fixed on the carriage 1 5 m ahead of the model bow to measure the oncoming wave elevation the incident wave elevation 4 dof motions and three vertical accelerations at bow middle and stern of model were measured by a data collector in the operation room onboard carriage the sampling frequency and low pass cut off frequency of the signals were set at 100 hz and 30 hz respectively views of the towing tank facilities are shown in fig 15 4 1 regular wave tests tank regular wave tests were conducted in head waves at various wave frequencies wave to ship waterline length λ l ranges from 0 5 to 2 5 to obtain the response amplitude operators raos of vertical motions the amplitude of incident waves is set at 31 25 mm 1 25 m at full scale as a compromise between identifying distinct model responses and obtaining the linear responses typical testing speeds of 1 464 m s 1 952 m s and 2 44 m s corresponding to full scale 18 knots 24 knots and 30 knots respectively are selected for testing the displacement froude numbers are 0 265 0 353 and 0 441 for speeds 18 knots 24 knots and 30 knots respectively 4 1 1 tank wall effects judgment it is known that tank wall effects should be considered while conducting model tests in narrow wave tanks according to the 27th ittc s recommended procedures and guidelines for seakeeping experiments ittc 2014 the critical wave frequency is obtained by formula 58 ω i n t c g l m f r where g denotes gravitational acceleration l m denotes model waterline length f r denotes displacement froude number and coefficient c is determined by b t l m ratio of tank width to model length and it can be obtained by referring to the diagram provided in the 27th ittc committee the minimum frequency suggested of the regular waves is obtained as follows 59 ω min 2 π g λ where λ denotes the largest length of regular waves tested in this study the critical wave frequency is ω int 1 814 rad s which is less than ω min 2 807 rad s this therefore satisfies the tank wall interference requirement 4 1 2 analysis of regular wave testing results the heave pitch and bow acceleration are selected as representative responses for analysis in this study the amplitude value for heave pitch and bow acceleration responses in regular waves can be read from the recorded time series then the response amplitudes at different incident wave frequencies are used to plot the rao curve the obtained heave pitch and bow acceleration raos of the four models at different speeds are summarized in fig 16 as seen from the overall results in most of the cases the vertical responses of v3 reduced evidently compared with r0 v1 and v2 particularly at the resonance frequency range λ l 0 8 1 5 in addition the effects of the ssb and fins on vertical motion stabilization increased with the increasing forward speed by comparing the curves in each figure it seems that r0 and v1 are almost of the same vertical response values in majority of the cases whereas the responses of v2 and v3 reduced obviously compared with r0 or v1 moreover it indicates that both the ssb and twin fins are of great help in improving the hull vertical motion stability when comparing v1 with v2 and v2 with v3 respectively it is also revealed that the contributions of ssb and twin fins to the vertical response reduction effects are almost equal for a further comparison of the results both mean and maximum values of response reduction rate with respect to v3 versus r0 v3 versus v1 and v3 versus v2 are listed in table 4 it is noted that the mean values are acquired by averaging the reduction rates at all the tested λ l points and the maximum values are obtained by picking the maximum reduction rate among all the λ l points as seen from the table the vertical responses of v3 obviously reduced compared with r0 v1 and v2 the mean pitch and acceleration reduction rates are in the range of 5 2 16 9 while heave within 1 7 8 7 the maximum reduction rates which usually happened in wave resonance frequency range λ l 0 8 1 5 are generally over 20 for majority of the cases on the other hand the response reduction rate generally increases with increasing sailing speed from 18 knots to 30 knots for both mean and maximum values this can be interpreted by the fact that the vertical oscillation velocity increases with the increasing of vessel forward speed and wave encounter frequency and the hydrodynamic damping force generated by the ssb and fins which is in the order of square of the vertical velocity see eqs 10 and 16 increases rapidly with the increasing vertical oscillation velocity of bow in waves to summarize the ssb and fins have considerable effects on vertical motion stabilization especially in harsh sailing conditions severe wave state high speed or both 4 2 irregular wave tests tank irregular wave results of the three models r0 v1 and v3 are reported in this section long crested random waves of significant wave heights 0 081 m and 0 125 m respectively corresponding to full scale 3 25 m level 5 sea state and 5 m level 6 sea state were generated according to issc target spectrum the full scale wave target periods are 8 5 s and 10 5 s respectively to be in accordance with the regular wave tests the three speeds 18 knots 24 knots and 30 knots at full scale were also tested for each of the irregular wave test scheme over 200 wave samples were encountered by the models which is realized by combining several runs together since the towing tank is not long enough 4 2 1 spectral analysis theory to obtain the frequency domain curve and the statistical parameters of wave ship motion and acceleration from the measured time series an auto correlation function based algorithm was used and corresponding code was developed the basic theory regarding the auto correlation function approach is described as follows yu 2003 the frequency domain variance spectrum is derived by performing the fourier transformation of the auto correlation function 60 s ω 2 π 0 r τ e i ω t d τ where s ω denotes the spectrum ω denotes circular frequency τ denotes the time interval and r τ denotes the auto correlation function the auto correlation function is derived as follows through the measured time series 61 r τ e η t η t τ where η t denotes the ordinate value of time series at the time t and function e denotes the acquiring of mathematical expectation in addition the auto correlation function can be re written by assuming that the variable processed is both ergodic and stationary random process 62 r τ lim t 1 t 0 t η t η t τ d t where t denotes the duration of the time series processed the time interval is represented by δt t n dividing the time duration t into n equal parts the mean representative time of the classified intervals in the order from the beginning to the end over the whole process range are t 1 t 2 t n respectively then using δt 2δt kδt to replace τ and substituting them into eq 62 the following equation of discrete form can be derived 63 r k t n 1 n k i 1 n k η i η i k k 0 1 2 m where m denotes the largest interval number the auto correlation values of r k for k 0 1 m can be obtained by eq 63 and then substituting these values into eq 60 besides trapezoidal quadrature method is used to obtain the spectrum 64 s ω i δ t π r 0 2 k 1 m 1 r k cos i k π m r m cos i π i 0 1 m due to the fact that the initial spectrum by eq 61 is not smooth the hamming smoothing is adopted to process the original spectrum the equations for smoothing can be derived by 65 s ω 0 0 54 s ω 0 0 46 s ω 1 s ω i 0 54 s ω i 0 23 s ω i 1 s ω i 1 i 1 2 m 1 s ω m 0 54 s ω m 0 46 s ω m 1 where s denotes the final spectrum after smoothing in addition the displacement spectrum e g heave can be derived by two quadratures of the acceleration spectrum using the following equation from which the wave surface evaluation and hull heave spectra can be obtained by processing the corresponding acceleration time series 66 s η ω i s η ω i ω i 4 i 0 1 m the single significant amplitude ssa value and root mean square rms value can be obtained based on the acquired spectral result they are respectively obtained by 67 a 1 3 2 05 m 0 68 a 1 25 m 0 where m 0 denotes the variance of the spectrum i e the area below the smoothed spectral curve 69 m 0 0 s ω d ω 4 2 2 analysis of the response spectra the model motion response spectra are obtained by processing the measured time series through the above spectral analysis method the comparison of heave pitch and bow acceleration spectra under different conditions between r0 v1 and v3 are summarized in fig 17 the frequency is the encounter frequency as seen from the spectral curves the difference between v3 and r0 or v1 is not very pronounced at 18 knots forward speed and wave state level 5 condition whereas the difference increases with the increasing forward speed or wave state or both on the other hand the difference between v1 and r0 is small in most of the cases which shows the same phenomenon as that observed from regular wave testing results moreover the response spectral peak frequency increases with increasing forward speed while it decreases slightly with increasing wave state due to the increase of mean wave period 4 2 3 analysis of statistical values fig 18 presents the calculated full scale ssa values for heave pitch and bow acceleration at different wave conditions and sailing speeds the results are calculated by using eq 67 based on the spectral curves in fig 17 herein the solid lines correspond to results in level 5 wave condition and the dashed lines correspond to level 6 wave condition as seen from the curves in fig 18 the ssa values of heave and bow acceleration saw a pronounced rise tendency over the increasing sailing speed from 18 knots to 30 knots while the rise tendency of pitch value seems to be much gentler with increasing speed it is found that v3 has the smallest ssa value for all the conditions and the relative motion reduction effect is more obvious at high speed 30 knots or under high wave condition level 6 it is also found that r0 and v1 have almost the same response ssa values in most of the conditions this reflects the same characteristics as those obtain from the regular wave tests it is noted that the response values of v1 are sometimes slightly larger than r0 at speed below 24 knots while being lower than r0 at speed 30 knots table 5 lists response reduction rates of v1 versus r0 v3 versus r0 and v3 versus v1 by comparing the ssa values in fig 18 as confirmed from the table v1 revealed better motion stability compared with r0 at high speed 30 knots or at high wave state level 6 the overall vertical motion performance of v3 improved remarkably compared with r0 and v1 for majority of the cases the response reduction rate increases over the increasing sailing speed from 18 knots to 30 knots or increases with the increasing wave state 4 3 comparison of numerical and experimental results 4 3 1 regular wave results the calculated raos for heave pitch and bow acceleration of r0 v1 and v3 by the improved 2 5d seakeeping theory are summarized in fig 19 the computation conditions are in accordance with regular wave test i e head waves at forward speeds 18 knots 24 knots and 30 knots in these graphs the calculated raos are also used to compare with regular wave test results the difference between calculated and measured regular wave results is shown in table 6 where both mean and maximum differences for all the λ l points in the curve are listed as seen from the comparison the results show good agreement between the calculation and measurement at speed 18 knots since the mean and maximum differences are less than 5 0 and 13 1 respectively while the calculation provides acceptable results with measurement at speed 24 and 30 knots conditions with mean and maximum difference less than 7 6 and 22 2 respectively on the other hand although the calculated values are not completely coincide with the measurement in some conditions the relative response values between different ships show the same trend between calculation and measurement thus the numerical approach is a very useful tool in ship preliminary design and optimization stage 4 3 2 irregular wave results ship motion responses in irregular waves are numerically predicted based on the calculated transfer functions in the linear spectral analysis theory it is assumed that the ship motions are the output of a system linear to the input waves which is expressed as follows 70 s ω e r a o e 2 s ζ ω e where s ζ ω e denotes wave spectrum in encounter frequency s ω e denotes encounter motion response spectrum and raoe denotes rao in encounter frequency the numerical predictions are made on r0 v1 and v3 corresponding to head waves at three forward speeds 18 knots 24 knots and 30 knots under wave states level 5 and level 6 significant wave height 3 25 m and 5 m respectively mean period 8 5 s and 10 5 s respectively which is in accordance with the experimental conditions the issc wave spectra are also adopted in the computation to systematically compare the results the ssa values in terms of heave pitch and bow acceleration by numerical and experimental methods are summarized in table 7 the comparison indicates that the calculated heave pitch and acceleration values are generally in good agreement with the tank model testing results since majority of the differences are lower than 10 however the exceptions are the acceleration at 30 knots under wave state level 5 the heave at 24 knots under wave state level 5 and the acceleration at 24 knots under wave state level 6 the differences of which are 10 82 11 11 and 11 77 respectively 5 large scale model experimental setup 5 1 model overview in order to further investigate the seakeeping behavior of the two hulls r0 and v3 in short crested sea waves two corresponding 1 19 large scale self propelled models were constructed the model hulls were constructed using fibre reinforced plastic frp with a mean thickness of 10 mm to make them robust enough so that the deformation of hull in waves becomes negligible transverse bulkheads are provided to make the compartments watertight strengthen the ship hull and make the model safe enough in rough seas a deck was placed above the cog on which ballast weights and equipment were attached fig 20 a and b show a comparative view of the two models and a stern view includes the rudders and propellers of r0 respectively fig 20 c and d show the local view of bow areas of r0 and v3 respectively 5 2 experimental system 5 2 1 sea wave buoy an in house developed wave buoy sun et al 2016b was used to measure the sea waves during large scale model sea trial fig 21 a shows general arrangement of the designed buoy an axial accelerometer shown in fig 21 b is fitted at cog of the buoy to measure the vertical acceleration in waves an iron chain is connected at the bottom of the buoy to lower its barycentre and improve its stability a spoiling flap is mounted on the middle of the buoy s outer surface to reduce the swing motion in waves the lower part of the buoy is designed to be immersed in water during measurement fig 21 c shows a view of the buoy during wave measurement at sea the diameter of the buoy was determined so as to ensure that the buoy could accurately respond the coastal wave surface elevation it is expected that the buoy moves synchronously with respect to the wave surface vertical elevation whereas the pitch and roll motions are not expected since they would pollute the vertical acceleration signal fig 22 shows the motion responses of buoy at different diameter induced by unit amplitude regular wave calculated by 3d frequency domain potential flow theory the buoy diameter was finally selected to be 0 4 m so as to respond the wave frequency range of interest and possibly prevent roll and pitch technique parameters regarding the buoy are listed in table 8 the sampling frequency of accelerometer was set at 50 hz during sea trial measurement 5 2 2 model equipment a large scale model testing system which includes a propulsion system remote control system and data acquisition system was developed and assembled to allow the conduct of field experiments jiao et al 2016c fig 23 illustrates the general layout of the large scale v3 model and onboard testing equipment to propel the model two brushless electric motors twin screw propellers and their connections are installed at the stern of model a remote control system has been developed in house which allows the model to be controlled by radio signal from an escort yacht framework of the model control system is concluded in fig 24 through the dedicated remote control system it is possible to control and adjust the model s forward speed and heading from the escort yacht in house developed data acquisition software is used to record the experimental data the data collector allows 16 channels sampling synchronously the measured signals include three angles i e heading pitch and roll and their angular rates and three vertical accelerations at bow middle and stern the exciting voltage detected by sensors is filtered by a second order low pass filter to remove high frequency noise over 30 hz and it is then converted to digital signal via a 12 bit analog digital ad converter the digital signal is transmitted to a dedicated computer hard disk for storage via the data acquisition software 5 3 experimental procedure prior to the sea trial campaign the models were tested in a calm water river the onboard experimental system was debugged and floating state checked during the river trial see fig 25 the relationship between model forward speed and motor speed was also calibrated in the river the sea trial campaign was conducted in a near shore bay at bohai sea which belongs to dalian china fig 26 shows a satellite view of the experimental campaign field large scale model tests were conducted about 5 km distance away from the beach as a compromise between the potential risks and the experimental requirements the average water depth is over 20 m which can be regarded as infinite water depth for model testing during the experiments the wind blew from nnw to the coast at a speed of about 1 5 m s the dominant wave propagation direction was in accordance with the wind direction to ensure the waves acting on model are fully developed wind generated waves moreover the experiment site is well sheltered so as to prevent swell waves the ocean current speed was less than 0 2 m s which is not considered in this study the large scale model experimental measurements involved in this study for the two models r0 and v3 and at two full scale forward speeds 18 knots and 24 knots were conducted within a relatively short period of time so as to ensure that the same wave states were suffered for all the testing conditions the in situ wave buoy was used to monitor the wave state information during measurement an auxiliary boat was used to carry move and redeploy the buoy after each wave measurement so as to confirm that the wave field is stable in the testing area during the sea trial the models are tested at different control strategies i e sea condition forward speed and heading as shown in fig 27 for each set of the wave condition and sailing speed six directional runs were conducted so that six different relative wave headings were experienced nielsen and stredulinsky 2012 during the measurement an auxiliary yacht which carries the crew ran and kept a distance from the model 6 analysis of large scale model sea trial data in this section testing results of the two large scale models are presented and analyzed experimental phenomena captured by video cameras are presented at first then large scale model experimental data collected is presented and analyzed by spectral method response spectral curves and statistic significant values are also compared between r0 and v3 6 1 general observations by video during the sea trial two video cameras were adopted to record model sailing state information one was mounted on the deck and the other was held by crew on the auxiliary boat some examples of the recorded testing phenomena are illustrated in fig 28 bow slamming and large amplitude pitch motion of r0 are observed in fig 28 a and b respectively fig 28 d and e present the sailing states of v3 at different headings severe slamming and green wave pile up phenomena of r0 and v3 captured by deck video are shown in fig 28 c and f respectively as seen from these photographs it is obvious that nonlinear wave structure interaction events such as slamming and green water on deck occurred the model s navigation attitude observed is more similar to actual vessels sailing state in seaways compared with the towing tank model test therefore large scale model trial at sea will help getting real and accurate results for ship motion and load responses in seaways 6 2 examples of collected data 6 2 1 the sea waves a group of wave measurements were taken by the wave buoy during the large scale model sea trial fig 29 a shows an example of the measured vertical acceleration of wave surface frequency domain information of the sea waves is acquired by the auto correlation function method described in section 4 2 1 fig 29 b shows an example of the acquired wave spectra compared with the issc theoretical target spectrum in dimensionless format according to the analysis result the sea state is stable enough during the whole measurement period and in the overall testing area the averaged significant wave height is 0 257 m 4 88 m corresponding to full scale ship and the averaged mean period is 2 53 s 11 03 s corresponding to full scale ship which is equivalent to sea state level 6 significant wave height 5 m 6 2 2 the model responses some examples of the measured time series of r0 in the above sea state are illustrated in fig 30 the corresponding model forward speed is about 2 12 m s 18 knots at full scale fig 30 a and b illustrate roll and pitch time series within 120 s respectively their corresponding angular rates are illustrated in fig 30 c and d respectively the heading angle is about 130 during this period as seen from fig 30 e example of acceleration time series at bow 0 station and middle ship 10 station is shown in fig 30 f the heave motion of the model can be obtained by spectral analysis method using the vertical acceleration data amidships which is described in section 4 2 1 6 2 3 uncertainty analyses according to the classification made in the report of the seakeeping committee in ittc 2017 seven groups of uncertainties were identified in seakeeping tests uncertainty of instruments uncertainty of model mass properties model geometry uncertainty uncertainty of the test setup calibration uncertainty measurement uncertainty and data reduction uncertainty the uncertainty of measured data should be considered especially for the large scale model experiments which are mainly attributed to the lack of control over the sea environment the uncertainties of the large scale model experimental setup and the comparisons with tank tests are analyzed in this section accurate measurement and description of the sea waves is the very first effort and the fundamental work for the evaluation of ship seakeeping performance in waves in the tank regular or long crested irregular waves of expected parameters e g wave height and period can be accurately produced by computerized wave maker the resistive wave probe fixed in tank also has a good accuracy in the measurement of wave elevation yu et al 2018 when it comes to the natural environment the actual sea waves have a strong randomicity and nonlinearity and they are characterized with broad band frequency distribution and direction spreading as mentioned in section 5 2 1 the dedicated accelerometer based wave buoy is only responsible for the measurement of sea waves in a certain range of frequency moreover the dominant wave direction is identified by visual observation and also based on wind direction and the judgment accuracy is within 10 therefore the estimated significant wave height wave period wave spectra and dominant direction are associated with uncertainty in addition to the measurement uncertainty the coastal and near shore waves may associate with shoaling diffraction refraction reflection and breaking effects although the data obtained by large scale model is realistic there are more uncertainties associated with the large scale model s responses measurement than tank model tests for example the laboratory carriage has a good speed accuracy of 0 001 m s and the model s course is well guided by the carriage and motion measurement system chen et al 2017 however the large scale model s forward speed fluctuates due to the influence of added resistance and impact loads in random waves the large scale model s heading which affects by the rudder efficiency and wave induced yaw motion fluctuates around the course bearing during navigation in seaways during the sea trial the fluctuation of navigational speed and heading angle of the large scale models are lower than 0 1 m s and 5 respectively in addition the transient slamming and green water loads acting on local structure also have some influence on heave pitch and acceleration the slamming loads have less effects on ship global pitch and heave motions while will cause high frequency components in vertical accelerations jiao and ren 2016 6 3 comparison of two large scale models responses in order to visualize the frequency domain information of large scale models responses spectral transformation is performed on the measured time series figs 31 and 32 shows the comparison of two models response spectra in terms of heave pitch roll and bow acceleration for head waves under sea state level 6 two representative ship speeds 18 knots and 24 knots 2 12 m s and 2 83 m s at model scale respectively are selected for analysis as seen from the curves the pitch and acceleration responses of r0 are larger than v3 it appears clearly that the spectral peak value of r0 is higher than that of v3 for all the cases moreover the spectral frequency distribution of r0 is generally wider than v3 especially for accelerations due to the 3d effects of sea waves the roll motion exists even the model sailing in head waves the roll response of v3 is much lower than r0 due to the larger roll damping coefficient of deep v shaped hull than round bilge hull additionally the full scale ssa values of heave pitch and bow acceleration are obtained based on the spectral analysis results which are summarized in fig 33 as seen from the ssa values with similar results observed from the spectral curves the response of v3 is generally smaller than r0 the heave ssa value of v3 at 18 knots and 24 knots decreases by 6 10 and 5 26 compared with r0 respectively the pitch value of v3 at 18 knots and 24 knots decreases by 14 71 and 14 34 compared with r0 respectively the bow acceleration value at 18 knots and 24 knots reduces by 17 23 and 22 42 respectively to summarize from the large scale model sea trial results it confirmed that the seakeeping behavior of deep v hybrid hull is largely improved compared with the round bilge hull therefore the objective of the large scale model experimental campaign is well achieved 7 comparison of large and small scale models testing results a comparison between the results by large scale model sea trial and small scale model towing tank test is undertaken to explore the difference in results caused by different environment configurations and incident wave fields to compare with the small scale model responses in 2d long crested tank waves large scale model responses induced by dominant component waves are estimated then the comparison between model responses induced by the oncoming waves is also made 7 1 comparison of response spectra the differences in spectral results caused by different testing approaches are analyzed in this section figs 34 36 show the comparative dimensionless response spectra of heave pitch and bow acceleration obtained by different scaled models the comparative responses are in the equivalent sea state level 6 and at two speeds 18 knots and 24 knots as seen from the dimensionless spectral curves the pitch spectra by small scale model are in good agreement with those by large scale model for all the cases an exception to the good agreement is that the peak value of small scale model pitch spectra is slightly higher than large scale one however the difference in heave and bow acceleration spectra between different models is remarkable it is clear that the spectral density of small scale model acceleration concentrates around the peak frequency with a narrow band distribution however spectral density of the large scale model acceleration disperses over a broad band frequency range this can be attributed to the 3d effects of sea waves it can be explained by the fact that the component sea waves have considerable influence on heave and acceleration while have little influence on pitch which is also turned out in section 7 2 3 7 2 comparison of response statistical values 7 2 1 description of sea waves by directional spectrum considering the fact that the incident wave fields for large and small scale model experiments are quite different the short crested sea waves should therefore be described by directional spectral density function however as stated in section 6 2 1 the single point wave buoy used during measurement could only provide the overall spectrum information which considers the contribution of component waves from all the directions in order to address the limitations of the current wave buoy a theoretical directional spreading function is adopted the directional wave spectrum is described by the combination of an overall spectrum s ζ ω from measurement and a theoretical directional spreading function d ω θ 71 s ω θ s ζ ω d ω θ where the theoretical direction function in this study is selected to be 72 d ω θ 2 cos 2 θ π π 2 θ π 2 0 e l s e w h e r e the simulated directional spectra by using the measured overall spectra in fig 29 b and the above theoretical directional spreading function are presented in fig 37 dominant waves are then extracted from the overall sea waves by substituting θ 0 into eq 71 72 the wave spectrum corresponding to the dominant sea waves is obtained by 73 s ω 0 2 s ζ ω π the full scale wave parameters for tank waves sea waves and dominant sea waves are summarized in table 9 in the table the wave parameters for tank waves and sea waves are calculated by using the wave time series while the parameters for dominant sea waves are derived by equation 73 using the overall sea wave parameters 7 2 2 direct comparison of ship ssa values the response statistical values of models by different testing methods are compared in this section fig 38 shows a direct comparison of full scale ship ssa values of vertical motion responses by large scale model sea trial and small scale model tank test under equivalent sea state level 6 as seen from the statistical results the vertical response values by small scale model tank test are generally 20 30 greater than large scale model sea trial results this is mainly caused by the difference in incident wave fields between short crested sea waves and long crested tank waves moreover the difference in pitch is smaller than heave and acceleration which indicates the same phenomenon as obtained from figs 34 36 7 2 3 comparison of ship ssa values in dominant waves to investigate the ship vertical motion responses induced by different wave schemes responses of ship under unit significant wave height are calculated table 10 lists the full scale ship responses induced by different incident wave schemes under unit significant wave height the response for sea wave and tank wave are obtained by dividing the ship response by the corresponding significant wave height directly while the response for dominant sea wave are obtained by dividing the large scale model response by the significant wave height of dominant sea waves for clarity fig 39 shows the comparison of ship responses induced by dominant sea waves and those induced by tank waves under unit significant wave height as seen from the results the vertical motion responses of large scale model under unit wave height induced by dominant waves are close to the small scale model tank test results therefore it is concluded that the hull vertical responses in short crested waves are mainly induced by dominant direction waves the component incident waves even though contributed to the overall wave height have less effect on hull vertical responses moreover it is concluded that the small scale model long crested irregular wave test overestimates the response of ship in a specified sea condition compared with the real condition the vertical motions by large scale models in 3d waves are more realistic thus the large scale model test is a potential tool which provides reliable results for the prediction of ship responses in actual sea waves 7 3 comprehensive comparison of motion reduction rate to comprehensively investigate the effects of bow appendages on motion stabilization response reduction rates of v3 with respect to r0 obtained by different approaches are summarized in table 11 it is noted that sea trial results are obtained based on the actual measured statistical ssa values in fig 38 the results indicate that good agreement in terms of response reduction rate among different approaches is achieved and vertical motions of v3 largely reduced compared with r0 therefore the objective of improving ship vertical motion stability by ssb and fins scheme is also well achieved 8 conclusions and recommendations in this paper a set of seakeeping analyses were undertaken on hybrid hulls by different approaches improved 2 5d theoretical calculation 1 40 small scale model laboratory towing tank test and 1 19 large scale model sea trial the results by different approaches were systematically analyzed and compared the scheme for improving ship vertical motion stability by using ssb and fins is made feasible the large scale model seakeeping measurement in realistic sea waves is also turned out to be feasible and applicable as a final confirmation tool for ship design and construction based on the work carried out in this study the following conclusions can be drawn 1 the improved strip theory based 2 5d seakeeping algorithm is capable of estimating the wave induced vertical motion responses of high speed hybrid hull equipped with ssb and fins the viscous flow effects caused by bow appendages can be well estimated by introducing the hydrodynamic terms into the motion governing equations it turned out that the proposed algorithm is very useful at ship preliminary design and optimization stage since the relative trend exhibits very good agreement between calculated and testing results for the ships 2 the objective of development of deep v hybrid hull for good seakeeping performance is well achieved as indicated from this study it clearly demonstrated that both ssb and fins are of significance in the reduction of ship vertical motions through both the numerical and experimental investigations in general the ssb and fins have more effects on pitch and acceleration stability than heave moreover the ssb scheme is of great help especially in rough conditions severe wave high speed or both 3 testing large scale models in 3d sea waves is more realistic than tank test according to the video recordings large scale models sailing attitude at sea is quite similar with full scale vessel sailing state in seaways the vertical responses of large scale model in 3d sea waves are generally smaller than long crested wave tank test even in an equivalent sea state which means that the conventional tank test may overestimate ship vertical motions and provides conservative results for ship design moreover the vertical motion responses of ship sailing in head sea waves are mainly induced by the dominant direction waves whereas the roll motion is mainly induced by the component sea waves 4 the large scale model testing technique turned out to be feasible as a supplement of the traditional tank test although with some disadvantages such as sea state uncontrollable large scale model testing approach is still a potential tool for the investigation of ship responses in actual seaways it should be mentioned that the conventional tank test certainly has its obvious advantages such as environment well controlled and testing conditions repeatable however some rarely occurring events and severe wave structure interaction phenomena happened on full scale ship can be hardly reproduced by tank model tests according to the research progress in naval architecture and ocean engineering testing large scale models in actual wave environment is a future development tendency in this paper spectral analysis technique is applied to analyze large scale models motion responses which is intrinsically linked to linear theory in our future work time domain extrapolation algorithm will be proposed to accurately predict full scale ship s nonlinear motion and load responses in severe waves on the basis of large scale model measurement data the difference of ship responses in laboratory tank and actual sea waves will also be distinguished by time domain nonlinear analysis technique and the advantages of conducting model tests in realistic sea waves will then be further demonstrated till now there has been no published paper reporting the comparison of large scale model testing results with full scale trial such research is also planned to be undertaken in our future work acknowledgements the authors would like to express their sincerely gratitude to all the graduate students at harbin engineering university heu who have made contributions throughout the preparation and conduct the model experiments and also thank the ship environment adaptability research center at heu for making the data available for analysis this work was developed within the scope of the national natural science foundation of china no 51679049 and the china postdoctoral science foundation no 2017m622696 which are also gratefully acknowledged for the financial supports received appendix the additional hydrodynamic coefficient terms with respect to the effects attributed to ssb and fins in the overall motion governing equations are as follows b 33 1 2 ρ α 0 u l b m x d x 4 3 π ρ c d l b m x w a d x b 35 b 53 1 2 ρ α 0 u l b m x x d x 4 3 π ρ c d l b m x w a x d x b 55 1 2 ρ α 0 u l b m x x 2 d x 4 3 π ρ c d l b m x w a x 2 d x c 35 1 2 ρ α 0 u 2 l b m x d x c 55 1 2 ρ α 0 u 2 l b m x x d x f 3 ν i 1 2 ρ ω e ζ a α 0 u l b m x e k d i k x cos β d x i 4 3 π ρ c d ω e ζ a l b m x w a e k d i k x cos β d x m 5 ν e i ω e t i 1 2 ρ ω e ζ a α 0 u l b m x x e k d i k x cos β d x i 4 3 π ρ c d ω e ζ a l b m x w a x e k d i k x cos β d x a 33 f 2 m f δ m f a 35 f a 53 f 2 m f δ m f x f a 55 f 2 m f δ m f x f 2 b 33 f ρ u s α f 0 4 3 π ρ c d f s w f a l w f a r b 35 f b 53 f ρ u s α f 0 x f 4 3 π ρ c d f s x f w f a l w f a r b 55 f ρ u s α f 0 x f 2 4 3 π ρ c d f s x f 2 w f a l w f a r c 35 f ρ u 2 s α f 0 c 55 f ρ u 2 s α f 0 x f f 3 f ν i ρ ω e ζ a u s α f 0 e k d f i k x f cos β cos k y f sin β i 4 3 π ρ ω e a s c d f e k d f i k x f cos β w f a l e i k y f l sin β w f a r e i k y f r sin β m 5 f ν i ρ ω e ζ a u s α f 0 x f e k d f i k x f cos β cos k y f sin β i 4 3 π ρ ω e ζ a s c d f x f e k d f i k x f cos β w f a l e i k y f l sin β w f a r e i k y f r sin β 
23333,in this paper seakeeping performance of vessels is comparatively investigated by means of improved 2 5d theoretical calculation small scale model towing tank test and large scale free running model sea trial this study also provides a scheme of ship vertical motion stabilization technique by using semi submerged bow ssb appendages firstly an improved strip theory based 2 5d theoretical seakeeping algorithm which considers the viscous flow effects attributed to bow appendages is developed to estimate ship vertical motion responses in regular waves short term predictions are also made on the basis of spectral analysis theory to predict ship motion responses in irregular waves then corresponding small scale models are made and tested in a laboratory towing tank for both regular and irregular wave conditions to confirm the numerical results the tank testing results between different ship schemes are also compared to experimentally investigate the effects of ssb and fin on hull vertical motion stabilization furthermore large scale model sea trials are conducted in coastal waves for a final validation of the ship seakeeping performance in short crested sea waves finally comparisons of the results by different testing approaches are systematically made and analyzed keywords improved strip theory 2 5d potential flow theory seakeeping performance deep v monohull semi submerged bow ssb tank test large scale model sea trial 1 introduction currently seakeeping performance of ships is generally investigated by numerical calculation scaled model wave tank test and full scale sea trial in fact different methods have their own advantages and disadvantages generally numerical methods are widely used due to their convenience and effective merits and they are the preferred choice at ship preliminary design stage till now 2d strip theories are widely used since they were developed in the late 1950s the linear motions of hull at zero or low speed can be predicted by classical strip theories e g original strip method korvin kroukovsky and jacobs 1957 new strip method tasai and takagi 1969 rational strip theory ogilvie and tuck 1969 and s t f method salvesen et al 1970 however the 3d effects of free surface should be considered when predicting ship hydrodynamics at high speed thus the classical strip theories are no longer applicable since they are based on the low speed and high frequency basic assumption the high speed slender body theory 2 5d theory was initially proposed by chapman 1976 and then used to calculate ship motions in regular waves by faltinsen and zhao 1991 then many scholars have applied the 2 5d theory to predict ship motion and loads in waves at high forward speed due to its practicability and high efficiency compared with 3d theories ma et al 2004 li et al 2017 as a matter of fact some strong nonlinear hydro structure interaction problems are complex and difficult to be satisfactorily addressed by numerical calculation experiments do not only reflect what really happens on the ship but are also used to validate numerical algorithms maron and kapsenberg 2014 however there exist some challenges or disadvantages associated with the conventional experimental approaches for example small scale models are usually towed in hydrodynamic wave tanks where uni directional or multi directional waves are artificially generated by wave maker in fact realistic sea states acting on full scale ships are however nonlinear short crested waves romolo et al 2014 only a finite number of waves are suffered by model during one run distance along the towing tank scaling effects may be obvious by using small scaled models especially for ship resistance and propulsion measurement moreover seakeeping characteristics such as slamming event and green water on deck of ships in actual sea conditions are found to be quite different from those observed in laboratory environment especially for ships sailing in severe seas at high forward speed see fig 1 on the other hand the conduct of full scale sea trial needs enormous financial and labor resources andersen and jensen 2014 since the weather and sea state are neither controllable nor repeatable some high sea states expected for investigation of ship responses in extreme sea states are rarely observed thomas et al 2011 it is reported that the 2d long crested waves will over estimate ship motion and load responses compared with the 3d short crested waves in some conditions chen et al 2011 li and wen 2007 ji et al 2015 although some state of the art tank facilities allow the generation of multi directional irregular waves the pseudo random waves artificially generated by wave makers are more or less different from the natural sea waves realistic wind driven sea waves need enough space and time for fully evolution and they are associated with obvious nonlinear characteristics such as sharp crest and flat trough toffoli et al 2008 moreover the frequency range of realistic sea waves is characterized with broad band distribution which is difficult to be reproduced in tanks therefore it is of great necessity to investigate ship seakeeping performance that operating in actual sea conditions based on the above situations large scale model testing methodology was proposed this approach includes carrying out seakeeping tests by relatively larger scaled models in actual sea conditions in some sense this testing approach is a compromise between laboratory tank test and full scale ship sea trial and combines majority of their advantages jiao et al 2016a for example large scale model test is much more realistic than tank test since the sea state is more complex and real lloyd 1989 the self propelled model is possible to run at any arbitrary heading angles in a relative long sailing distance on the other hand the conduct of large scale model sea trial is much cheaper and easier compared with full scale sea trial large scale model measurement is especially meaningful as a final confirmation tool before the construction of ship prototype large scale model testing technique which provides reliable and valuable referred data during advanced ship design stage has been developed for years in some countries e g america france greece china and italy in order to investigate the performance of zumwalt class destroyer ddg 1000 the us navy developed a large steel model with a scale ratio of 1 4 which is about 45 m long 6 m wide and with a light displacement of over 90 tonnes a series of hydrodynamic tests were conducted and the human factors related to its greatly reduced crew size were simulated quintana et al 2007 the model was finally utilized for underwater explosion and floodability tests shi 2007 zhang et al 2017 a 1 12 large scale manned model of aircraft carrier charles de gaulle was built by the french navy which is about 20 m long and 20 tonnes mass some typical devices such as fin stabilizer and transverse stabilization system were fitted on the model for testing and evaluation a series of tests with respect to maneuverability seakeeping and propeller performance were conducted by the model in seaways jiao et al 2016b summarized the survey of large scale model research and development in china a large scale segmented ship model for wave load measurement is reported in details in the article the model is about 12 m long and with a displacement of about 4 6 tonnes grigoropoulos and katsaounis 2004 provided the measurement procedure of a large scale corvette model seakeeping tests at sea testing methodology scope of measurements and the advantages of testing large models are summarized in their article coraddu et al 2013 on behalf of and supported by the italian navy carried out manoeuvring test of a twin screw naval ship by large scale model in a flat volcanic lake to investigate the asymmetric behavior of the ship shaft lines during manoeuvre the model is about 7 2 m long and equipped with a dedicated testing system allowing the measurement of propulsion behavior the vertical motion stabilization of especially naval ships is a reason of great concern since crew and equipments need a stable platform to work effectively as a matter fact the reduction of pitch motion of hull is a challenging task due to the large longitudinal moment of inertia i θ of ship li 2003 sun et al 2016a the semi submerged bow ssb scheme was initially reported by kihara and tazawa 1985 and it was applied on small vessels of about 40 m long displacement of about 200 tonnes the motion stabilization effects of ssb have been demonstrated by both theoretical and experimental methods in their work our previous research also indicates that the ssb technique provides obvious advantages in improving ship vertical stability jiao et al 2015 for further improvement of hull vertical motion stability a novel scheme of ssb with twin fins mounted is presented in this paper this study confirms that the bow appendages ssb and fins are of great help in achieving vertical motion stabilization both numerically and experimentally in our research project in cooperation with the chinese navy we were committed to developing a kind of hybrid monohull with excellent integrated navigational performance the project was mainly aimed at achieving the following objectives develop a kind of deep v stealth monohull with low resistance and high seakeeping ability characteristics which has better seakeeping performance compared with the classical round bilge monohull investigate the effects of ssb on ship resistance and seakeeping performance by both numerical and experimental approaches develop a large scale model testing technique for ship seakeeping measurement in realistic 3d sea waves this testing technique is aimed at being applied as a final confirmation tool before prototype construction in this paper the seakeeping performance of hybrid hulls is comprehensively investigated by means of 2 5d seakeeping theoretical calculation tank model test and large scale model sea trial so as to achieve the above objectives the structure of the paper is arranged as follows the ship forms and their optimization procedure are described in section 2 an improved 2 5d potential flow theory based seakeeping algorithm which considers the viscous flow effects of ssb and fins is developed in section 3 then four small scale models towing tank tests are carried out and the results are presented in section 4 for a final confirmation of ship seakeeping ability in a realistic sea environment a suite of large scale model experimental system is established and sea trials are conducted in coastal area of china which is reported in section 5 the large scale model experimental results are analyzed in section 6 then systematically analyses and comparisons of results by different testing approaches are reported in section 7 finally main conclusions obtained from this study and recommendations for future research direction are summarized in section 8 2 ship form determination and description 2 1 hybrid hull optimization procedure in the related research project a conventional round bilge hull r0 is adopted as a reference then a series of deep v hulls v 1 v 2 v i are proposed a hull lines optimization algorithm is developed according to the framework as shown in fig 2 and it is applied on the deep v hulls a good balance between ship resistance and seakeeping performance is achieved through the optimization algorithm the radar cross section rcs of monohull is also estimated and evaluated to meet the hull stealth requirement flowchart of the series ship form determination is schematized in fig 3 the identified candidate hull through the first round optimization is named as v1 then a series of ssb schemes s1 s2 sj are designed and applied on v1 the preferred hull with the best ssb through the second round of optimization is named as v2 afterwards a series of fin schemes f1 f2 fk are designed and applied on v2 the preferred hull with the best ssb and fins through the third round of optimization is named as v3 it is noted that this paper mainly concentrates on the investigation of seakeeping performance of the developed hulls by both numerical and experimental approaches the effects of ssb and fins on vertical motion reduction are also systemically investigated 2 2 ship form description as aforementioned the developed deep v hulls v1 v2 and v3 are designed to be in accordance with the same main hull prototype they are however designed to be without or fitted with different bow appendages in order to investigate the influence of ssb and fins on vertical motion stabilization the status of the three hulls in terms of bow appendage is listed in table 1 for clarity the sketch of a ssb with fins is schematized in fig 4 it is noted that the fins are located at the baseline level height of hull and their forward point is at the maximum width position of ssb longitudinally the effects of vertical motion reduction of ssb and fins can be attributed to the viscous hydrodynamic damping force and lift force generated due to the relative vertical movement of bow appendages against the fluid the lift force is generated when the appendages are advancing with angle of attack mainly caused by pitch in fluid the motion stabilization is then achieved since the damping force and lift force are always opposite to the vertical movement direction of bow cai et al 2003 it is worth mentioning that the dimensions of ssb and fins should be elaborately and carefully designed and optimized by experiential and numerical methods sun et al 2014 and it is a challenging task to determine the ssb dimensions for a designated hull to achieve the best stability in this study the ssb is designed in accordance with naca 00 airfoil shape and the fins are in accordance with tsagi airfoil shape at any arbitrary longitudinal plane table 2 presents the parameters of the optimized ssb and fins the ratio of displacement of ssb to the whole hull design displacement is about 1 92 body plans of the round bilge type hull and deep v type hulls are presented in fig 5 a and b respectively it is noted that in fig 5 b the ssb is marked in blue lines and the fin is marked in green lines main dimensions of the ships are listed in table 3 3 numerical seakeeping method in order to numerically estimate the motion responses of hybrid monohull in regular waves an improved 2 5d theory based algorithm was developed the improvements were made by taking the viscous fluid effects and the hydrodynamic forces acting on bow appendages into consideration the viscous flow effects caused by ssb and fin are considered from the two aspects i the viscous hydrodynamic damping and lifting forces acting on the hull caused by ssb and fins are estimated by computational fluid dynamics cfd tool or empirical formula then a series of additional hydrodynamic coefficient terms are introduced into the basic motion governing equations ii the sectional hydrodynamic coefficients a 33 and b 33 i e added mass and damping coefficients in vertical displacement mode are acquired by means of cfd method to include the contribution of vortex related viscous forces to viscous damping 3 1 the improved strip theory in the potential flow theory the fluid is assumed to be ideal i e incompressible inviscid continuous and irrotational in this study the head wave condition is defined as 180 heading angle while 0 90 and 270 are for following wave port beam wave and starboard beam wave respectively as shown in fig 6 three coordinate systems are introduced to describe ship motion in waves i the space fixed system o xyz is an inertia system with the plane oxy lying on an undisturbed free surface ox directed with positive in the direction of which incident wave come and oz pointing vertically upward ii the plane movement system o xyz is a horizontal moving coordinate system with the same moving speed and direction as the ship forward speed u and wave heading β the origin o is coincident with the o initially and oz pointing vertically upward across the ship s center of gravity cog iii the body fixed system g x b y b z b is fixed on the ship the origin g is coincident with the cog of the hull body and the x b y b and z b axes are directed toward the bow the port side and the sky respectively this coordinate system is also coincident with the plane movement system when the ship is in a mean position for consistency the relationship between these three coordinate systems is expressed as follows 1 x y z cos β sin β 0 sin β cos β 0 0 0 1 x u t cos β y u t sin β z x b y b z b z g where t denotes the time z g denotes the vertical distance of cog of ship with respect to free surface according to the knowledge of linear strip theory the basic vertical movement governing equations of hull in regular waves under the plane movement system o xyz are expressed as follows 2 m a 33 η 3 b 33 η 3 c 33 η 3 a 35 η 5 b 35 η 5 c 35 η 5 f 3 e i ω e t 3 i 55 a 55 η 5 b 55 η 5 c 55 η 5 a 53 η 3 b 53 η 3 c 53 η 3 f 5 e i ω e t where m denotes ship mass i 55 denotes ship longitudinal moment of inertia η 3 denotes heave motion η 5 denotes pitch ω e denotes wave encounter frequency t denotes time f 3 denotes vertical external force acting on the hull f 5 denotes vertical external moment acting on the hull the hydrodynamic coefficients a ij and b ij i j 1 6 can be obtained by calculating the radiation force which is described in section 3 3 3 1 1 viscous effects of ssb the vertical viscous force acting on ssb per unit length is described as 4 d f ν x 1 2 ρ b x m c l u 2 c d w w d x where ρ denotes fluid density b m x denotes the breadth of ssb at longitudinal ordinate x in the body fixed coordinate system c l and c d respectively denotes vertical lift coefficient and drag coefficient of ssb u denotes ship forward speed w denotes the relative vertical velocity of ssb against the fluid to summarize the first term at the right hand side of eq 4 represents viscous hydrodynamic lift and the second term represents viscous hydrodynamic drag the lift coefficient is further expressed as follows 5 c l α 0 α t where α 0 denotes the lift coefficient ratio slope of lifting force with respect to angle of attack of ssb α t denotes the real time angle of attack in the plane movement coordinate system the relative vertical velocity w and angle of attack α t of ssb can be derived by eqs 6 and 7 respectively 6 w x η 3 x η 5 ζ w x 0 d 7 α t η 5 w u where d denotes the mean underwater depth of ssb baseline and the vertical velocity component of incident wave is expressed as follows 8 ζ w x y z φ i z e i ω e t i ω e ζ a e k z i k x cos β i k y sin β e i ω e t where φ i denotes velocity potential of incident wave ζ a denotes wave amplitude k denotes wave number β denotes ship heading angle thus the vertical velocity component of incident wave at mean baseline depth d can be obtained by substituting the coordinate point x 0 d into eq 8 in order to linearize the second order velocity time dependent term w w in eq 4 the fourier series expansion is applied and it can be simplified as follows 9 w w 8 3 π w a w where w a denotes the amplitude value of w response it is noted that the linearization process is aimed at enabling this term to be added into the linear overall motion governing equation for solution the total vertical viscous force acting on ssb body is obtained by integrating the sectional force along its whole longitudinal length which is expressed as 10 f ν 1 2 ρ l b m x α 0 u 2 η 5 u w d x 4 3 π ρ l b m x c d w a w d x by substituting eq 5 9 into eq 10 we get the total vertical force acting on ssb which is given as follows with a simplified format 11 f ν b 33 η 3 b 35 η 5 c 35 η 5 f 3 ν e i ω e t where the hydrodynamic coefficient terms b 33 b 35 b 35 and f3ν are given in appendix in a similar way the total vertical viscous moment acting on ssb is expressed as 12 m ν b 55 η 5 c 55 η 5 b 53 η 3 m 5 ν e i ω e t where the hydrodynamic coefficient terms b 55 b 53 c 55 and m5ν are given in appendix 3 1 2 viscous effects of fins the hydrodynamic lift force acting on a single fin is expressed as follows 13 l f 1 2 ρ u 2 s c l f where s denotes the projected area of fin on horizon plane c lf denotes the lift coefficient of fin which is obtained by cfd computation in this study in addition for future reference and convenience the value of c lf for typical elliptical type airfoil can be also estimated by the following empirical formula 14 c l f 5 7 1 2 ε α f 0 where α f0 denotes the lift coefficient ratio of fin ε is the effective aspect ratio the real time angle of attack of fin with respect to the oncoming flow is expressed as 15 α f t η 5 η 3 x f η 5 ζ w x f y f z f u where x f y f and z f are the coordinate of representative position at 1 4 chord length of the fin moreover the vertical drag force and vertical rigid body inertia with corresponding fluid force of fin can be obtained by the following eqs 16 and 17 respectively 16 d f 1 2 ρ s c d f w f w f 4 3 π ρ s c d f w f a w f 17 k f m f δ m f η 3 x f η 5 where w f denotes the real time relative vertical velocity of fin against fluid and w fa is the corresponding amplitude value m f denotes the mass of a fin δm f denotes the fluid added mass of fin in vertical movement mode based on eqs 13 16 and 17 the overall vertical hydrodynamic force and moment acting on twin fins are expressed by 18 f f l f d f k f l l f d f k f r 19 m f x f f f where subscript l or r denotes the fin at left or right side respectively by synthesizing eq 13 19 the hydrodynamic force and moment attributed to twin fins can be re written as 20 f f a 33 f η 3 b 33 f η 3 a 35 f η 5 b 35 f η 5 c 35 f η 5 f 3 f ν e i ω e t 21 m f a 55 f η 5 b 55 f η 5 c 55 f η 5 a 53 f η 3 b 53 f η 3 m 5 f ν e i ω e t where the hydrodynamic coefficient terms a f 33 b f 33 a f 35 b f 35 c f 35 f 3fν a f 55 b f 55 c f 55 a f 53 b f 53 and m 5fν are given in appendix 3 1 3 estimation of lift and drag coefficients of bow appendages the lift coefficient of ssb or fin is calculated by using the following equation 22 c l 2 l ρ u 2 s where s denotes projected area of appendage on the horizontal plane the lift force l is calculated by cfd method which is described as follows the lift of ssb or fin advancing with different angles of attack and at different forward speeds is calculated by the ansys fluent 13 0 software the unstructured volume meshes of fluid domain are generated with the help of the gambit 2 4 6 software see fig 7 a the velocity inlet and outflow surfaces are set to be in front of and behind the ssb respectively the side surfaces are set to be the wall boundary condition the lift force acting on the ssb can be obtained by solving the reynolds averaged navier stokes rans equations fig 7 b shows the simulated pressure distribution on the advancing ssb during steady flow state the lift of fin can be calculated using the same method the calculated and the linear fitted lift coefficients for ssb and fin are summarized in fig 8 the obtained lift coefficient ratios for ssb and fin are 1 083 and 2 153 angle of attack in radian respectively the drag coefficient of ssb and fin for moving in vertical direction can be estimated with the help of cfd tool by solving rans equations which is similar as the lift calculation method above mentioned however in this study the drag coefficients are estimated by empirical formula for convenience our previous study indicated that the results by empirical formula are reliable for application in this condition the drag coefficient largely depends on re number and turbulence intensity and the variation of drag coefficient is small in a wide range of re number molin 2002 the drag coefficient of fin c df can be approximately taken within 0 7 0 8 zhang and li 2006 moreover the following formula is used to estimate the drag coefficient of ssb 23 c d x 1 3 κ x 0 25 d x b x where κ x denotes sectional area ratio at longitudinal ordinate x b x denotes sectional breadth and d x denotes sectional height 3 2 calculation of hydrodynamic coefficients in heave mode by cfd in the classical potential flow theory 2d sectional hydrodynamic coefficients are usually acquired by means of source distribution method which provides satisfactory results for ships with simple lines plan the section shape of deep v hybrid hull with ssb is however complex and thus the viscous flow effects should be considered zhou et al 2015 han et al 2014 with this in mind a 2d hull section oscillation model is numerically setup by using the fluent software the sectional triangle meshes are generated with the help of the gambit software the free surface is modeled by a two phase volume of fluid vof technique to determine the vertical radiation force of the section oscillating in fluids the hull section is forced for vertical oscillation with fixed small amplitude at fixed frequency instructed by udf code using morphing grid technique the rans equations are solved by means of rng k ε turbulence model the computations were done over a wide range of oscillation frequency the sectional added mass and damping coefficients can be extracted from the calculated radiation force results by the following method the external force acting on a vertical oscillating section comprises two components 24 f f s f z where f s denotes hydrostatic restoring force and f z denotes radiation force they are respectively expressed by he following equations 25 f s ρ g b η 3 26 f z a 33 η 3 b 33 η 3 where ρ denpotes liquid density g denotes gravitational acceleration b denotes breadth of hull section at waterline level a 33 and b 33 denotes sectional added mass and damping coefficient in heave mode the vertical displacement of section can be expressed as follows 27 η 3 a sin ω t where a denotes amplitude of sectional oscillation ω denotes oscillating frequency t denotes time the time series of external force f in eq 24 can be obtained by cfd calculation which is also expressed as follows 28 f f a cos ω t θ 0 f a cos ω t cos θ 0 f a sin ω t sin θ 0 where f a and θ 0 respectively denotes amplitude value and initial phase of the variable force f which can be obtained by fitting the time series calculated by cfd code the added mass and damping coefficient in heave mode can be obtained by combining eq 24 28 and they are expressed as follows 29 a 33 ρ g b a f a sin θ 0 a ω 2 30 b 33 f a cos θ 0 a ω a comparison of the added mass and damping coefficient calculated by potential flow method and the above described viscous flow method is conducted sections at 1 3 stations of v3 are selected for comparison due to their complex shape body plans of sections 1 3 are presented in fig 9 it is noted that the fins are not included in cfd simulation since the vertical rigid body inertia force and the corresponding fluid force of fin have been calculated by eq 17 view of the numerical simulation of flow field by the ansys fluent is shown in fig 10 the calculation results by different methods are shown in fig 11 it can be observed that there exists distinct difference between damping coefficients by different methods for sections 1 and 2 the damping coefficients by viscous flow method are generally larger than those by potential flow method due to the contribution of vortex related components and the disparity increased with the increasing frequency the largest disparity of results appeared at section 2 due to the large proportion of ssb however the results for section 3 show good agreement between the two methods due to the small proportion of ssb moreover it is found that the results for section 4 20 show good agreement between the two methods and they are not presented due to space limitation reasons 3 3 the solution of motion equations by 2 5d theory the updated ship vertical movement equations after adding the hydrodynamic coefficients attributed to ssb and twin fins are presented as follows 31 m a 33 a 33 f η 3 b 33 b 33 b 33 f η 3 c 33 η 3 a 35 a 35 f η 5 b 35 b 35 b 35 f η 5 c 35 c 35 c 35 f η 5 f 3 f 3 ν f 3 f ν e i ω e t 32 i 55 a 55 a 55 f η 5 b 55 b 55 b 55 f η 5 c 55 c 55 c 55 f η 5 a 53 a 53 f η 3 b 53 b 53 b 53 f η 3 c 53 η 3 f 5 m 5 ν m 5 f ν e i ω e t in order to consider the forward speed of ship during simulation the high speed slender body theory was applied to solve the motion governing equations this theory is also called 2 5d theory since the free surface condition is 3d whereas the governing equation and body surface conditions are 2d it is assumed that the ship forward speed is high enough so that the wave making in front of ship can be ignored thus the brard number satisfies chen and noblesse 1998 noblesse et al 1999 33 τ ω e u g 2 27 the steady wave making potential фs is ignored in the theory the flow field velocity potential is decomposed into time dependent term and space dependent term 34 φ x y z t re φ x y z e i ω e t the fluctuating space dependent potential around the ship can be further decomposed and expressed as 35 φ x y z φ i x y z φ d x y z φ r x y z where ϕ i x y z denotes incident wave potential ϕ d x y z denotes diffraction potential ϕ r x y z denotes radiation potential furthermore they are re written by velocity potentials that are a response to unit wave amplitude or unit motion amplitude 36 φ i x y z ζ a φ 0 x y z 37 φ d x y z ζ a φ 7 x y z 38 φ r x y z j 1 6 i ω e η j a φ j x y z where ζ a denotes incident wave amplitude ω e denotes encounter frequency ϕ j j 1 2 6 denotes the jth mode component of radiation potential and j 1 2 6 respectively denotes surge sway heave roll pitch and yaw motion η ja denotes the magnitude of jth motion component and can be expressed by 39 η j t η j a e i ω e t j 1 6 the radiation or diffraction velocity potential ϕ j j 1 2 7 satisfies the following boundary conditions 40 2 φ j y 2 2 φ j z 2 0 i n ω f i ω e u x 2 g z φ j 0 z 0 φ j n i ω e n j u m j j 1 6 φ 0 n j 7 o n s b φ j φ j x 0 x x 0 φ j 0 z where ω f denotes liquid domain sb denotes body surface condition x 0 is longitudinal coordinate value of ship forward perpendicular by applying the assumption that the ship is slender and the component of normal vector of hull surface on x axis is very small compared with those on y and z axes n j and m j j 1 6 are expressed as follows 41 n 1 n 2 n 3 n 4 n 5 n 6 0 n 2 n 3 y n 3 z z g n 2 x n 3 x n 2 42 m 1 m 2 m 3 m 4 m 5 m 6 0 0 0 0 n 3 n 2 where 0 n 2 n 3 denotes the inward directed unit normal vector of one point on the 2d hull surface section m j j 1 6 denotes the second order differential of the steady potential ux фs it is noted that the effect of steady perturbation potential фs is ignored in this study the following transformations are adopted to simplify the velocity potential boundary conditions 43 t x x x 0 u 44 ψ j t y z φ j x y z e i ω e t x j 1 7 it is noted that the above transformations are aimed at simplifying the free surface boundary condition in eq 40 which includes the speed term u the transformation also ensures that the transformed free surface boundary condition is similar with that for the zero speed condition and could then be solved by 2d time domain free surface green function in fact the speed term u is however indirect included and considered in the introduced time domain function t x therefore the boundary conditions in eq 40 can be re written as follows 45 2 ψ j y 2 2 ψ j z 2 0 i n ω f 2 ψ j t 2 g ψ j z 0 z 0 ψ j n i ω e n j u m j e i ω e t x j 2 6 φ 0 n e i ω e t x j 7 o n s b t ψ j ψ j t 0 t 0 ψ j 0 z according to the body surface condition in eq 45 the radiation potentials can be further decomposed into 46 ψ j ψ j 0 u i ω e ψ j u j 2 6 where ψ j 0 and ψ j u satisfy the following body surface conditions 47 ψ j 0 n i ω e n j e i ω e t x ψ j u n i ω e m j e i ω e t x j 2 6 the radiation potentials can be simplified by considering the basic assumption that the steady wave making potential фs is small and its influence on body surface condition is not considered in addition by taking eq 41 42 into account the simplified radiation potentials are expressed in the following eq 48 therefore the radiation potentials ψ j can be obtained by solving the ψ j 0 48 ψ j ψ j 0 j 2 4 ψ 5 ψ 5 0 u i ω e ψ 3 0 ψ 6 ψ 6 0 u i ω e ψ 2 0 it is clear that the boundary condition problem in eq 45 is a issue of 2d time domain nonlinear motion issue without forward speed which considers the nonlinear instantaneous wetted body surface the initial condition is determined by the boundary conditions of the 2d section at fore x x 0 then the flow field and radiation potentials at different hull sections can be addressed in the order from fore section to aft section by time stepping approach in the literature work the grid and distributed source are applied on both free surface and body surface and the boundary conditions are usually addressed by simple green function in time domain however the simple green function method has drawbacks such as unstable expensive and time consumed in this study a 2d time domain free surface green function for infinite water depth case is used to formulate the integral equation on the 2d body surface which is expressed as follows 49 g p t q τ δ t τ ln r p q r p q h t τ g p q t τ where p and q are respectively field point and source point and their locations are p y z and q η ζ in geodetic coordinate respectively δ t denotes the dirac delta function h t denotes unit step function the transient effects of flow is considered in the term of ln r p q r p q and 50 r p q 2 y η 2 z ζ 2 51 r p q 2 y η 2 z ζ 2 the memory effect of 3d free surface is considered in the term of g p q t τ 52 g p q t τ 2 0 g k e k z ζ cos k y η sin g k t τ d k z 0 ζ 0 which satisfies the following boundary conditions 53 2 g 0 τ t 2 g τ 2 g g ζ 0 ζ 0 g t τ 0 g τ t τ 2 g z ζ r p q 2 2 g ζ ln r p q suppose that point p is in the fluid field ω f at time t point q is on the closed loop formed by the body surface boundary sb τ free surface boundary sf τ and infinity boundary s τ at time τ as shown in fig 12 a τ and b τ are the cross points of sb and sf at time τ the 2d time domain body surface boundary integral equation is finally expressed as follows 54 π ψ j p t s b t ln r p q r p q ψ j q t n q ψ j q t n q ln r p q r p q d s q 0 t d τ s b τ g ψ j q t n q ψ j q t g n q d s q 1 g 0 t d τ g ψ j τ ψ j g τ a t a b where the subscript a b means the difference of the equation values with respect to source point q at the two different points a and b the velocity potential ψ j p t is solved by source distribution method once the velocity potentials are obtained the hydrodynamic pressure for radiation and diffraction components acting on hull surface is expressed as follows 55 p j x y z ρ i ω e φ j u φ j x ρ e i ω e t ψ j t j 2 7 the radiation and diffraction forces are obtained by integrating the corresponding pressure over the wetted hull body surface the hydrodynamic coefficients are then obtained by the radiation force 56 a i j ρ ω e 2 l s x t cos ω e t x re ψ j t sin ω e t x im ψ j t n i d l d x b i j ρ ω e l s x t cos ω e t x im ψ j t sin ω e t x re ψ j t n i d l d x the diffraction force is obtained by 57 f d j s b p d n j d s ρ re l e i ω e t x d x s x t ψ d t n j d l e i ω e t the overall motion equations in eq 31 32 can be finally solved by either frequency domain method or time domain method it is noted that the hydrodynamic coefficients for heave mode adopted are those obtained by cfd calculation 4 small scale model towing tank tests to experimentally investigate the seakeeping performance of the ships small scale models towing tank tests were conducted another objective of the tank tests is to validate the effects of ssb and fin on vertical motion stabilization since the laboratory tank wave parameters are well controlled and repeatable compared with realistic sea waves four 1 40 small scaled models i e r0 v1 v2 and v3 were constructed corresponding to the prototypes comparative views of the two small scale models v1 and v3 are shown in fig 13 the tests were conducted in the towing tank of harbin engineering university which is 108 m long 7 m wide and 3 5 m deep both regular and irregular head wave tests were conducted in the tank a powered carriage running on rails along the tank with a maximum speed capacity of 6 5 m s and speed accuracy of 0 001 m s is used to tow the model during the model running the model forward speed is achieved by gravity pull applied which is transferred by the heave rod and acts at cog of the model the model is connected to a 4 degree of freedom 4 dof i e heave pitch roll and surge motion measurement instrument which restricts the model s transverse motion i e sway and yaw by its heave rod the sketch of model setup and the towing guidance and motion measurement instrument is shown in fig 14 a computer controlled single hydraulic flat plate wave maker is situated at one end of the tank and at the other end is a wave absorbing ramp the period of the waves generated by the wave maker ranges from 0 4 to 4 s the largest wave height capacity of the wave maker is 0 4 m for regular waves and significant wave height 0 32 m for irregular waves a resistive wave probe is fixed on the carriage 1 5 m ahead of the model bow to measure the oncoming wave elevation the incident wave elevation 4 dof motions and three vertical accelerations at bow middle and stern of model were measured by a data collector in the operation room onboard carriage the sampling frequency and low pass cut off frequency of the signals were set at 100 hz and 30 hz respectively views of the towing tank facilities are shown in fig 15 4 1 regular wave tests tank regular wave tests were conducted in head waves at various wave frequencies wave to ship waterline length λ l ranges from 0 5 to 2 5 to obtain the response amplitude operators raos of vertical motions the amplitude of incident waves is set at 31 25 mm 1 25 m at full scale as a compromise between identifying distinct model responses and obtaining the linear responses typical testing speeds of 1 464 m s 1 952 m s and 2 44 m s corresponding to full scale 18 knots 24 knots and 30 knots respectively are selected for testing the displacement froude numbers are 0 265 0 353 and 0 441 for speeds 18 knots 24 knots and 30 knots respectively 4 1 1 tank wall effects judgment it is known that tank wall effects should be considered while conducting model tests in narrow wave tanks according to the 27th ittc s recommended procedures and guidelines for seakeeping experiments ittc 2014 the critical wave frequency is obtained by formula 58 ω i n t c g l m f r where g denotes gravitational acceleration l m denotes model waterline length f r denotes displacement froude number and coefficient c is determined by b t l m ratio of tank width to model length and it can be obtained by referring to the diagram provided in the 27th ittc committee the minimum frequency suggested of the regular waves is obtained as follows 59 ω min 2 π g λ where λ denotes the largest length of regular waves tested in this study the critical wave frequency is ω int 1 814 rad s which is less than ω min 2 807 rad s this therefore satisfies the tank wall interference requirement 4 1 2 analysis of regular wave testing results the heave pitch and bow acceleration are selected as representative responses for analysis in this study the amplitude value for heave pitch and bow acceleration responses in regular waves can be read from the recorded time series then the response amplitudes at different incident wave frequencies are used to plot the rao curve the obtained heave pitch and bow acceleration raos of the four models at different speeds are summarized in fig 16 as seen from the overall results in most of the cases the vertical responses of v3 reduced evidently compared with r0 v1 and v2 particularly at the resonance frequency range λ l 0 8 1 5 in addition the effects of the ssb and fins on vertical motion stabilization increased with the increasing forward speed by comparing the curves in each figure it seems that r0 and v1 are almost of the same vertical response values in majority of the cases whereas the responses of v2 and v3 reduced obviously compared with r0 or v1 moreover it indicates that both the ssb and twin fins are of great help in improving the hull vertical motion stability when comparing v1 with v2 and v2 with v3 respectively it is also revealed that the contributions of ssb and twin fins to the vertical response reduction effects are almost equal for a further comparison of the results both mean and maximum values of response reduction rate with respect to v3 versus r0 v3 versus v1 and v3 versus v2 are listed in table 4 it is noted that the mean values are acquired by averaging the reduction rates at all the tested λ l points and the maximum values are obtained by picking the maximum reduction rate among all the λ l points as seen from the table the vertical responses of v3 obviously reduced compared with r0 v1 and v2 the mean pitch and acceleration reduction rates are in the range of 5 2 16 9 while heave within 1 7 8 7 the maximum reduction rates which usually happened in wave resonance frequency range λ l 0 8 1 5 are generally over 20 for majority of the cases on the other hand the response reduction rate generally increases with increasing sailing speed from 18 knots to 30 knots for both mean and maximum values this can be interpreted by the fact that the vertical oscillation velocity increases with the increasing of vessel forward speed and wave encounter frequency and the hydrodynamic damping force generated by the ssb and fins which is in the order of square of the vertical velocity see eqs 10 and 16 increases rapidly with the increasing vertical oscillation velocity of bow in waves to summarize the ssb and fins have considerable effects on vertical motion stabilization especially in harsh sailing conditions severe wave state high speed or both 4 2 irregular wave tests tank irregular wave results of the three models r0 v1 and v3 are reported in this section long crested random waves of significant wave heights 0 081 m and 0 125 m respectively corresponding to full scale 3 25 m level 5 sea state and 5 m level 6 sea state were generated according to issc target spectrum the full scale wave target periods are 8 5 s and 10 5 s respectively to be in accordance with the regular wave tests the three speeds 18 knots 24 knots and 30 knots at full scale were also tested for each of the irregular wave test scheme over 200 wave samples were encountered by the models which is realized by combining several runs together since the towing tank is not long enough 4 2 1 spectral analysis theory to obtain the frequency domain curve and the statistical parameters of wave ship motion and acceleration from the measured time series an auto correlation function based algorithm was used and corresponding code was developed the basic theory regarding the auto correlation function approach is described as follows yu 2003 the frequency domain variance spectrum is derived by performing the fourier transformation of the auto correlation function 60 s ω 2 π 0 r τ e i ω t d τ where s ω denotes the spectrum ω denotes circular frequency τ denotes the time interval and r τ denotes the auto correlation function the auto correlation function is derived as follows through the measured time series 61 r τ e η t η t τ where η t denotes the ordinate value of time series at the time t and function e denotes the acquiring of mathematical expectation in addition the auto correlation function can be re written by assuming that the variable processed is both ergodic and stationary random process 62 r τ lim t 1 t 0 t η t η t τ d t where t denotes the duration of the time series processed the time interval is represented by δt t n dividing the time duration t into n equal parts the mean representative time of the classified intervals in the order from the beginning to the end over the whole process range are t 1 t 2 t n respectively then using δt 2δt kδt to replace τ and substituting them into eq 62 the following equation of discrete form can be derived 63 r k t n 1 n k i 1 n k η i η i k k 0 1 2 m where m denotes the largest interval number the auto correlation values of r k for k 0 1 m can be obtained by eq 63 and then substituting these values into eq 60 besides trapezoidal quadrature method is used to obtain the spectrum 64 s ω i δ t π r 0 2 k 1 m 1 r k cos i k π m r m cos i π i 0 1 m due to the fact that the initial spectrum by eq 61 is not smooth the hamming smoothing is adopted to process the original spectrum the equations for smoothing can be derived by 65 s ω 0 0 54 s ω 0 0 46 s ω 1 s ω i 0 54 s ω i 0 23 s ω i 1 s ω i 1 i 1 2 m 1 s ω m 0 54 s ω m 0 46 s ω m 1 where s denotes the final spectrum after smoothing in addition the displacement spectrum e g heave can be derived by two quadratures of the acceleration spectrum using the following equation from which the wave surface evaluation and hull heave spectra can be obtained by processing the corresponding acceleration time series 66 s η ω i s η ω i ω i 4 i 0 1 m the single significant amplitude ssa value and root mean square rms value can be obtained based on the acquired spectral result they are respectively obtained by 67 a 1 3 2 05 m 0 68 a 1 25 m 0 where m 0 denotes the variance of the spectrum i e the area below the smoothed spectral curve 69 m 0 0 s ω d ω 4 2 2 analysis of the response spectra the model motion response spectra are obtained by processing the measured time series through the above spectral analysis method the comparison of heave pitch and bow acceleration spectra under different conditions between r0 v1 and v3 are summarized in fig 17 the frequency is the encounter frequency as seen from the spectral curves the difference between v3 and r0 or v1 is not very pronounced at 18 knots forward speed and wave state level 5 condition whereas the difference increases with the increasing forward speed or wave state or both on the other hand the difference between v1 and r0 is small in most of the cases which shows the same phenomenon as that observed from regular wave testing results moreover the response spectral peak frequency increases with increasing forward speed while it decreases slightly with increasing wave state due to the increase of mean wave period 4 2 3 analysis of statistical values fig 18 presents the calculated full scale ssa values for heave pitch and bow acceleration at different wave conditions and sailing speeds the results are calculated by using eq 67 based on the spectral curves in fig 17 herein the solid lines correspond to results in level 5 wave condition and the dashed lines correspond to level 6 wave condition as seen from the curves in fig 18 the ssa values of heave and bow acceleration saw a pronounced rise tendency over the increasing sailing speed from 18 knots to 30 knots while the rise tendency of pitch value seems to be much gentler with increasing speed it is found that v3 has the smallest ssa value for all the conditions and the relative motion reduction effect is more obvious at high speed 30 knots or under high wave condition level 6 it is also found that r0 and v1 have almost the same response ssa values in most of the conditions this reflects the same characteristics as those obtain from the regular wave tests it is noted that the response values of v1 are sometimes slightly larger than r0 at speed below 24 knots while being lower than r0 at speed 30 knots table 5 lists response reduction rates of v1 versus r0 v3 versus r0 and v3 versus v1 by comparing the ssa values in fig 18 as confirmed from the table v1 revealed better motion stability compared with r0 at high speed 30 knots or at high wave state level 6 the overall vertical motion performance of v3 improved remarkably compared with r0 and v1 for majority of the cases the response reduction rate increases over the increasing sailing speed from 18 knots to 30 knots or increases with the increasing wave state 4 3 comparison of numerical and experimental results 4 3 1 regular wave results the calculated raos for heave pitch and bow acceleration of r0 v1 and v3 by the improved 2 5d seakeeping theory are summarized in fig 19 the computation conditions are in accordance with regular wave test i e head waves at forward speeds 18 knots 24 knots and 30 knots in these graphs the calculated raos are also used to compare with regular wave test results the difference between calculated and measured regular wave results is shown in table 6 where both mean and maximum differences for all the λ l points in the curve are listed as seen from the comparison the results show good agreement between the calculation and measurement at speed 18 knots since the mean and maximum differences are less than 5 0 and 13 1 respectively while the calculation provides acceptable results with measurement at speed 24 and 30 knots conditions with mean and maximum difference less than 7 6 and 22 2 respectively on the other hand although the calculated values are not completely coincide with the measurement in some conditions the relative response values between different ships show the same trend between calculation and measurement thus the numerical approach is a very useful tool in ship preliminary design and optimization stage 4 3 2 irregular wave results ship motion responses in irregular waves are numerically predicted based on the calculated transfer functions in the linear spectral analysis theory it is assumed that the ship motions are the output of a system linear to the input waves which is expressed as follows 70 s ω e r a o e 2 s ζ ω e where s ζ ω e denotes wave spectrum in encounter frequency s ω e denotes encounter motion response spectrum and raoe denotes rao in encounter frequency the numerical predictions are made on r0 v1 and v3 corresponding to head waves at three forward speeds 18 knots 24 knots and 30 knots under wave states level 5 and level 6 significant wave height 3 25 m and 5 m respectively mean period 8 5 s and 10 5 s respectively which is in accordance with the experimental conditions the issc wave spectra are also adopted in the computation to systematically compare the results the ssa values in terms of heave pitch and bow acceleration by numerical and experimental methods are summarized in table 7 the comparison indicates that the calculated heave pitch and acceleration values are generally in good agreement with the tank model testing results since majority of the differences are lower than 10 however the exceptions are the acceleration at 30 knots under wave state level 5 the heave at 24 knots under wave state level 5 and the acceleration at 24 knots under wave state level 6 the differences of which are 10 82 11 11 and 11 77 respectively 5 large scale model experimental setup 5 1 model overview in order to further investigate the seakeeping behavior of the two hulls r0 and v3 in short crested sea waves two corresponding 1 19 large scale self propelled models were constructed the model hulls were constructed using fibre reinforced plastic frp with a mean thickness of 10 mm to make them robust enough so that the deformation of hull in waves becomes negligible transverse bulkheads are provided to make the compartments watertight strengthen the ship hull and make the model safe enough in rough seas a deck was placed above the cog on which ballast weights and equipment were attached fig 20 a and b show a comparative view of the two models and a stern view includes the rudders and propellers of r0 respectively fig 20 c and d show the local view of bow areas of r0 and v3 respectively 5 2 experimental system 5 2 1 sea wave buoy an in house developed wave buoy sun et al 2016b was used to measure the sea waves during large scale model sea trial fig 21 a shows general arrangement of the designed buoy an axial accelerometer shown in fig 21 b is fitted at cog of the buoy to measure the vertical acceleration in waves an iron chain is connected at the bottom of the buoy to lower its barycentre and improve its stability a spoiling flap is mounted on the middle of the buoy s outer surface to reduce the swing motion in waves the lower part of the buoy is designed to be immersed in water during measurement fig 21 c shows a view of the buoy during wave measurement at sea the diameter of the buoy was determined so as to ensure that the buoy could accurately respond the coastal wave surface elevation it is expected that the buoy moves synchronously with respect to the wave surface vertical elevation whereas the pitch and roll motions are not expected since they would pollute the vertical acceleration signal fig 22 shows the motion responses of buoy at different diameter induced by unit amplitude regular wave calculated by 3d frequency domain potential flow theory the buoy diameter was finally selected to be 0 4 m so as to respond the wave frequency range of interest and possibly prevent roll and pitch technique parameters regarding the buoy are listed in table 8 the sampling frequency of accelerometer was set at 50 hz during sea trial measurement 5 2 2 model equipment a large scale model testing system which includes a propulsion system remote control system and data acquisition system was developed and assembled to allow the conduct of field experiments jiao et al 2016c fig 23 illustrates the general layout of the large scale v3 model and onboard testing equipment to propel the model two brushless electric motors twin screw propellers and their connections are installed at the stern of model a remote control system has been developed in house which allows the model to be controlled by radio signal from an escort yacht framework of the model control system is concluded in fig 24 through the dedicated remote control system it is possible to control and adjust the model s forward speed and heading from the escort yacht in house developed data acquisition software is used to record the experimental data the data collector allows 16 channels sampling synchronously the measured signals include three angles i e heading pitch and roll and their angular rates and three vertical accelerations at bow middle and stern the exciting voltage detected by sensors is filtered by a second order low pass filter to remove high frequency noise over 30 hz and it is then converted to digital signal via a 12 bit analog digital ad converter the digital signal is transmitted to a dedicated computer hard disk for storage via the data acquisition software 5 3 experimental procedure prior to the sea trial campaign the models were tested in a calm water river the onboard experimental system was debugged and floating state checked during the river trial see fig 25 the relationship between model forward speed and motor speed was also calibrated in the river the sea trial campaign was conducted in a near shore bay at bohai sea which belongs to dalian china fig 26 shows a satellite view of the experimental campaign field large scale model tests were conducted about 5 km distance away from the beach as a compromise between the potential risks and the experimental requirements the average water depth is over 20 m which can be regarded as infinite water depth for model testing during the experiments the wind blew from nnw to the coast at a speed of about 1 5 m s the dominant wave propagation direction was in accordance with the wind direction to ensure the waves acting on model are fully developed wind generated waves moreover the experiment site is well sheltered so as to prevent swell waves the ocean current speed was less than 0 2 m s which is not considered in this study the large scale model experimental measurements involved in this study for the two models r0 and v3 and at two full scale forward speeds 18 knots and 24 knots were conducted within a relatively short period of time so as to ensure that the same wave states were suffered for all the testing conditions the in situ wave buoy was used to monitor the wave state information during measurement an auxiliary boat was used to carry move and redeploy the buoy after each wave measurement so as to confirm that the wave field is stable in the testing area during the sea trial the models are tested at different control strategies i e sea condition forward speed and heading as shown in fig 27 for each set of the wave condition and sailing speed six directional runs were conducted so that six different relative wave headings were experienced nielsen and stredulinsky 2012 during the measurement an auxiliary yacht which carries the crew ran and kept a distance from the model 6 analysis of large scale model sea trial data in this section testing results of the two large scale models are presented and analyzed experimental phenomena captured by video cameras are presented at first then large scale model experimental data collected is presented and analyzed by spectral method response spectral curves and statistic significant values are also compared between r0 and v3 6 1 general observations by video during the sea trial two video cameras were adopted to record model sailing state information one was mounted on the deck and the other was held by crew on the auxiliary boat some examples of the recorded testing phenomena are illustrated in fig 28 bow slamming and large amplitude pitch motion of r0 are observed in fig 28 a and b respectively fig 28 d and e present the sailing states of v3 at different headings severe slamming and green wave pile up phenomena of r0 and v3 captured by deck video are shown in fig 28 c and f respectively as seen from these photographs it is obvious that nonlinear wave structure interaction events such as slamming and green water on deck occurred the model s navigation attitude observed is more similar to actual vessels sailing state in seaways compared with the towing tank model test therefore large scale model trial at sea will help getting real and accurate results for ship motion and load responses in seaways 6 2 examples of collected data 6 2 1 the sea waves a group of wave measurements were taken by the wave buoy during the large scale model sea trial fig 29 a shows an example of the measured vertical acceleration of wave surface frequency domain information of the sea waves is acquired by the auto correlation function method described in section 4 2 1 fig 29 b shows an example of the acquired wave spectra compared with the issc theoretical target spectrum in dimensionless format according to the analysis result the sea state is stable enough during the whole measurement period and in the overall testing area the averaged significant wave height is 0 257 m 4 88 m corresponding to full scale ship and the averaged mean period is 2 53 s 11 03 s corresponding to full scale ship which is equivalent to sea state level 6 significant wave height 5 m 6 2 2 the model responses some examples of the measured time series of r0 in the above sea state are illustrated in fig 30 the corresponding model forward speed is about 2 12 m s 18 knots at full scale fig 30 a and b illustrate roll and pitch time series within 120 s respectively their corresponding angular rates are illustrated in fig 30 c and d respectively the heading angle is about 130 during this period as seen from fig 30 e example of acceleration time series at bow 0 station and middle ship 10 station is shown in fig 30 f the heave motion of the model can be obtained by spectral analysis method using the vertical acceleration data amidships which is described in section 4 2 1 6 2 3 uncertainty analyses according to the classification made in the report of the seakeeping committee in ittc 2017 seven groups of uncertainties were identified in seakeeping tests uncertainty of instruments uncertainty of model mass properties model geometry uncertainty uncertainty of the test setup calibration uncertainty measurement uncertainty and data reduction uncertainty the uncertainty of measured data should be considered especially for the large scale model experiments which are mainly attributed to the lack of control over the sea environment the uncertainties of the large scale model experimental setup and the comparisons with tank tests are analyzed in this section accurate measurement and description of the sea waves is the very first effort and the fundamental work for the evaluation of ship seakeeping performance in waves in the tank regular or long crested irregular waves of expected parameters e g wave height and period can be accurately produced by computerized wave maker the resistive wave probe fixed in tank also has a good accuracy in the measurement of wave elevation yu et al 2018 when it comes to the natural environment the actual sea waves have a strong randomicity and nonlinearity and they are characterized with broad band frequency distribution and direction spreading as mentioned in section 5 2 1 the dedicated accelerometer based wave buoy is only responsible for the measurement of sea waves in a certain range of frequency moreover the dominant wave direction is identified by visual observation and also based on wind direction and the judgment accuracy is within 10 therefore the estimated significant wave height wave period wave spectra and dominant direction are associated with uncertainty in addition to the measurement uncertainty the coastal and near shore waves may associate with shoaling diffraction refraction reflection and breaking effects although the data obtained by large scale model is realistic there are more uncertainties associated with the large scale model s responses measurement than tank model tests for example the laboratory carriage has a good speed accuracy of 0 001 m s and the model s course is well guided by the carriage and motion measurement system chen et al 2017 however the large scale model s forward speed fluctuates due to the influence of added resistance and impact loads in random waves the large scale model s heading which affects by the rudder efficiency and wave induced yaw motion fluctuates around the course bearing during navigation in seaways during the sea trial the fluctuation of navigational speed and heading angle of the large scale models are lower than 0 1 m s and 5 respectively in addition the transient slamming and green water loads acting on local structure also have some influence on heave pitch and acceleration the slamming loads have less effects on ship global pitch and heave motions while will cause high frequency components in vertical accelerations jiao and ren 2016 6 3 comparison of two large scale models responses in order to visualize the frequency domain information of large scale models responses spectral transformation is performed on the measured time series figs 31 and 32 shows the comparison of two models response spectra in terms of heave pitch roll and bow acceleration for head waves under sea state level 6 two representative ship speeds 18 knots and 24 knots 2 12 m s and 2 83 m s at model scale respectively are selected for analysis as seen from the curves the pitch and acceleration responses of r0 are larger than v3 it appears clearly that the spectral peak value of r0 is higher than that of v3 for all the cases moreover the spectral frequency distribution of r0 is generally wider than v3 especially for accelerations due to the 3d effects of sea waves the roll motion exists even the model sailing in head waves the roll response of v3 is much lower than r0 due to the larger roll damping coefficient of deep v shaped hull than round bilge hull additionally the full scale ssa values of heave pitch and bow acceleration are obtained based on the spectral analysis results which are summarized in fig 33 as seen from the ssa values with similar results observed from the spectral curves the response of v3 is generally smaller than r0 the heave ssa value of v3 at 18 knots and 24 knots decreases by 6 10 and 5 26 compared with r0 respectively the pitch value of v3 at 18 knots and 24 knots decreases by 14 71 and 14 34 compared with r0 respectively the bow acceleration value at 18 knots and 24 knots reduces by 17 23 and 22 42 respectively to summarize from the large scale model sea trial results it confirmed that the seakeeping behavior of deep v hybrid hull is largely improved compared with the round bilge hull therefore the objective of the large scale model experimental campaign is well achieved 7 comparison of large and small scale models testing results a comparison between the results by large scale model sea trial and small scale model towing tank test is undertaken to explore the difference in results caused by different environment configurations and incident wave fields to compare with the small scale model responses in 2d long crested tank waves large scale model responses induced by dominant component waves are estimated then the comparison between model responses induced by the oncoming waves is also made 7 1 comparison of response spectra the differences in spectral results caused by different testing approaches are analyzed in this section figs 34 36 show the comparative dimensionless response spectra of heave pitch and bow acceleration obtained by different scaled models the comparative responses are in the equivalent sea state level 6 and at two speeds 18 knots and 24 knots as seen from the dimensionless spectral curves the pitch spectra by small scale model are in good agreement with those by large scale model for all the cases an exception to the good agreement is that the peak value of small scale model pitch spectra is slightly higher than large scale one however the difference in heave and bow acceleration spectra between different models is remarkable it is clear that the spectral density of small scale model acceleration concentrates around the peak frequency with a narrow band distribution however spectral density of the large scale model acceleration disperses over a broad band frequency range this can be attributed to the 3d effects of sea waves it can be explained by the fact that the component sea waves have considerable influence on heave and acceleration while have little influence on pitch which is also turned out in section 7 2 3 7 2 comparison of response statistical values 7 2 1 description of sea waves by directional spectrum considering the fact that the incident wave fields for large and small scale model experiments are quite different the short crested sea waves should therefore be described by directional spectral density function however as stated in section 6 2 1 the single point wave buoy used during measurement could only provide the overall spectrum information which considers the contribution of component waves from all the directions in order to address the limitations of the current wave buoy a theoretical directional spreading function is adopted the directional wave spectrum is described by the combination of an overall spectrum s ζ ω from measurement and a theoretical directional spreading function d ω θ 71 s ω θ s ζ ω d ω θ where the theoretical direction function in this study is selected to be 72 d ω θ 2 cos 2 θ π π 2 θ π 2 0 e l s e w h e r e the simulated directional spectra by using the measured overall spectra in fig 29 b and the above theoretical directional spreading function are presented in fig 37 dominant waves are then extracted from the overall sea waves by substituting θ 0 into eq 71 72 the wave spectrum corresponding to the dominant sea waves is obtained by 73 s ω 0 2 s ζ ω π the full scale wave parameters for tank waves sea waves and dominant sea waves are summarized in table 9 in the table the wave parameters for tank waves and sea waves are calculated by using the wave time series while the parameters for dominant sea waves are derived by equation 73 using the overall sea wave parameters 7 2 2 direct comparison of ship ssa values the response statistical values of models by different testing methods are compared in this section fig 38 shows a direct comparison of full scale ship ssa values of vertical motion responses by large scale model sea trial and small scale model tank test under equivalent sea state level 6 as seen from the statistical results the vertical response values by small scale model tank test are generally 20 30 greater than large scale model sea trial results this is mainly caused by the difference in incident wave fields between short crested sea waves and long crested tank waves moreover the difference in pitch is smaller than heave and acceleration which indicates the same phenomenon as obtained from figs 34 36 7 2 3 comparison of ship ssa values in dominant waves to investigate the ship vertical motion responses induced by different wave schemes responses of ship under unit significant wave height are calculated table 10 lists the full scale ship responses induced by different incident wave schemes under unit significant wave height the response for sea wave and tank wave are obtained by dividing the ship response by the corresponding significant wave height directly while the response for dominant sea wave are obtained by dividing the large scale model response by the significant wave height of dominant sea waves for clarity fig 39 shows the comparison of ship responses induced by dominant sea waves and those induced by tank waves under unit significant wave height as seen from the results the vertical motion responses of large scale model under unit wave height induced by dominant waves are close to the small scale model tank test results therefore it is concluded that the hull vertical responses in short crested waves are mainly induced by dominant direction waves the component incident waves even though contributed to the overall wave height have less effect on hull vertical responses moreover it is concluded that the small scale model long crested irregular wave test overestimates the response of ship in a specified sea condition compared with the real condition the vertical motions by large scale models in 3d waves are more realistic thus the large scale model test is a potential tool which provides reliable results for the prediction of ship responses in actual sea waves 7 3 comprehensive comparison of motion reduction rate to comprehensively investigate the effects of bow appendages on motion stabilization response reduction rates of v3 with respect to r0 obtained by different approaches are summarized in table 11 it is noted that sea trial results are obtained based on the actual measured statistical ssa values in fig 38 the results indicate that good agreement in terms of response reduction rate among different approaches is achieved and vertical motions of v3 largely reduced compared with r0 therefore the objective of improving ship vertical motion stability by ssb and fins scheme is also well achieved 8 conclusions and recommendations in this paper a set of seakeeping analyses were undertaken on hybrid hulls by different approaches improved 2 5d theoretical calculation 1 40 small scale model laboratory towing tank test and 1 19 large scale model sea trial the results by different approaches were systematically analyzed and compared the scheme for improving ship vertical motion stability by using ssb and fins is made feasible the large scale model seakeeping measurement in realistic sea waves is also turned out to be feasible and applicable as a final confirmation tool for ship design and construction based on the work carried out in this study the following conclusions can be drawn 1 the improved strip theory based 2 5d seakeeping algorithm is capable of estimating the wave induced vertical motion responses of high speed hybrid hull equipped with ssb and fins the viscous flow effects caused by bow appendages can be well estimated by introducing the hydrodynamic terms into the motion governing equations it turned out that the proposed algorithm is very useful at ship preliminary design and optimization stage since the relative trend exhibits very good agreement between calculated and testing results for the ships 2 the objective of development of deep v hybrid hull for good seakeeping performance is well achieved as indicated from this study it clearly demonstrated that both ssb and fins are of significance in the reduction of ship vertical motions through both the numerical and experimental investigations in general the ssb and fins have more effects on pitch and acceleration stability than heave moreover the ssb scheme is of great help especially in rough conditions severe wave high speed or both 3 testing large scale models in 3d sea waves is more realistic than tank test according to the video recordings large scale models sailing attitude at sea is quite similar with full scale vessel sailing state in seaways the vertical responses of large scale model in 3d sea waves are generally smaller than long crested wave tank test even in an equivalent sea state which means that the conventional tank test may overestimate ship vertical motions and provides conservative results for ship design moreover the vertical motion responses of ship sailing in head sea waves are mainly induced by the dominant direction waves whereas the roll motion is mainly induced by the component sea waves 4 the large scale model testing technique turned out to be feasible as a supplement of the traditional tank test although with some disadvantages such as sea state uncontrollable large scale model testing approach is still a potential tool for the investigation of ship responses in actual seaways it should be mentioned that the conventional tank test certainly has its obvious advantages such as environment well controlled and testing conditions repeatable however some rarely occurring events and severe wave structure interaction phenomena happened on full scale ship can be hardly reproduced by tank model tests according to the research progress in naval architecture and ocean engineering testing large scale models in actual wave environment is a future development tendency in this paper spectral analysis technique is applied to analyze large scale models motion responses which is intrinsically linked to linear theory in our future work time domain extrapolation algorithm will be proposed to accurately predict full scale ship s nonlinear motion and load responses in severe waves on the basis of large scale model measurement data the difference of ship responses in laboratory tank and actual sea waves will also be distinguished by time domain nonlinear analysis technique and the advantages of conducting model tests in realistic sea waves will then be further demonstrated till now there has been no published paper reporting the comparison of large scale model testing results with full scale trial such research is also planned to be undertaken in our future work acknowledgements the authors would like to express their sincerely gratitude to all the graduate students at harbin engineering university heu who have made contributions throughout the preparation and conduct the model experiments and also thank the ship environment adaptability research center at heu for making the data available for analysis this work was developed within the scope of the national natural science foundation of china no 51679049 and the china postdoctoral science foundation no 2017m622696 which are also gratefully acknowledged for the financial supports received appendix the additional hydrodynamic coefficient terms with respect to the effects attributed to ssb and fins in the overall motion governing equations are as follows b 33 1 2 ρ α 0 u l b m x d x 4 3 π ρ c d l b m x w a d x b 35 b 53 1 2 ρ α 0 u l b m x x d x 4 3 π ρ c d l b m x w a x d x b 55 1 2 ρ α 0 u l b m x x 2 d x 4 3 π ρ c d l b m x w a x 2 d x c 35 1 2 ρ α 0 u 2 l b m x d x c 55 1 2 ρ α 0 u 2 l b m x x d x f 3 ν i 1 2 ρ ω e ζ a α 0 u l b m x e k d i k x cos β d x i 4 3 π ρ c d ω e ζ a l b m x w a e k d i k x cos β d x m 5 ν e i ω e t i 1 2 ρ ω e ζ a α 0 u l b m x x e k d i k x cos β d x i 4 3 π ρ c d ω e ζ a l b m x w a x e k d i k x cos β d x a 33 f 2 m f δ m f a 35 f a 53 f 2 m f δ m f x f a 55 f 2 m f δ m f x f 2 b 33 f ρ u s α f 0 4 3 π ρ c d f s w f a l w f a r b 35 f b 53 f ρ u s α f 0 x f 4 3 π ρ c d f s x f w f a l w f a r b 55 f ρ u s α f 0 x f 2 4 3 π ρ c d f s x f 2 w f a l w f a r c 35 f ρ u 2 s α f 0 c 55 f ρ u 2 s α f 0 x f f 3 f ν i ρ ω e ζ a u s α f 0 e k d f i k x f cos β cos k y f sin β i 4 3 π ρ ω e a s c d f e k d f i k x f cos β w f a l e i k y f l sin β w f a r e i k y f r sin β m 5 f ν i ρ ω e ζ a u s α f 0 x f e k d f i k x f cos β cos k y f sin β i 4 3 π ρ ω e ζ a s c d f x f e k d f i k x f cos β w f a l e i k y f l sin β w f a r e i k y f r sin β 
23334,a vertical axis rotor design for wave energy conversion is discussed in this work the rotor has a number of cup blades laid out around its shaft in ocean waves water particles perform omnidirectional motion while exposed in waves and driven by omnidirectional flows the rotor performs unidirectional rotation about its vertically oriented shaft this rotor concept was tested in a wave flume under various rotor parameters and wave conditions results show that the rotor s unidirectional behavior is profound yet fluctuation of the unidirectional angular velocity broadly exists a parametric study further revealed relations between the rotor s mean angular velocity and some other parameters keywords wave energy converter wec vertical axis unidirectional rotor 1 introduction a huge variety of wave energy converter wec designs has long been proposed in the past clément et al 2002 serious technological wec development for utility scale applications started during the energy crisis in 1970s the publication of salter s paper in nature salter 1974 is often noted as a landmark yet promising technologies realized since then remain rare clément et al 2002 falcao 2010 drew et al 2009 to date only a very few wec technologies have been demonstrated in some pilot wave farm projects and the associated levelized cost of the generated electricity is far less competitive compared to that from solar and wind energies astariz and iglesias 2015 it is generally believed that a significant drop of the levelized cost relies on realization of transformative wec technologies the large family of wecs can be categorized in different ways employing different criteria some broadly used criteria include deployment site offshore versus onshore placing method surface floating versus seabed mounting wave wec relation point absorbers attenuators terminators and motion type heaving pitching or swaying oscillating water column overtopping etc falcao 2010 lopez et al 2013 due to the importance in characterizing the performance of wecs very recently the motion directionality has also been employed to classify wecs it splits the wecs into a unidirectional class and a reciprocating class yang 2014 a reciprocating wec features reciprocating motion linear and or angular of the whole wec or a unit of it directly driven by waves a huge majority of existing wec designs belongs to this class examples include powerbuoy oceanpowertechnologies com heaving up and down pelamis pizer et al 2005 reciprocating bending between segments defunct since november 2014 and oceanlinx greenwave falcao and henriques 2016 using the oscillating water column principle in comparison a unidirectional wec is distinctive in having a rotor that is directly driven by waves to perform unidirectional rotation without any intervening steps only a very few members from the large wec family are in the unidirectional class yang 2014 it has been a common approach that in development of a reciprocating wec the resonant principle is applied to improve the efficiency as a result the wec s efficiency is strongly wave frequency dependent in oceans waves usually possess a complex spectrum pierson and moskowits 1964 and the dominant frequency component or frequency band may change largely over time in response to such a change for the best efficiency the reciprocating wec s natural frequency needs to be adjusted accordingly this is usually done by employing some frequency tuning or phase control mechanisms hals et al 2011 falnes 2002 falcao 2008 hong et al 2014 however frequency tuning has its limitations compared to a wide range of the wave frequency and an employed mechanism adds complexity to the overall wec design behaving differently from the reciprocating wecs the unidirectional wecs do not involve resonance therefore upon hydrodynamic optimization a unidirectional wec can absorb energy from all the wave frequency components with no need in frequency tuning in addition the unidirectional rotation is directly achieved from the wave motion no other intervening mechanical means such as a hydraulic system zhang et al 2012 or a mechanical rectifier ai et al 2014 for motion conversion are ever needed as such the power take off system of the unidirectional wec and even the entire wec can be in a very simple structure simplicity leads to robustness in the very small unidirectional wec class most of the wec designs have the axis of the rotor horizontally placed the savonius wec ahmed et al 2013 and cycloidal wec siegel et al 2012 lay in this type the horizontal orientation of the rotor takes full advantage of the water s orbital motion in waves to enable unidirectional rotation if the horizontal axis is orthogonal to the wave propagation direction in practice however meeting and maintaining such an alignment requirement is not easy for two reasons i irregular waves exist most of the time and ii they have different wave frequency components that travel in different directions even if a dominant wave propagation direction could be defined and used this direction would still change from time to time that leads to another challenge automatic realignment of a wec of this type although both passive control a hydrodynamic approach and active control using sensors and motors would serve this purpose well employment of either approach would drastically complicate the overall wec structure to circumvent the alignment issue of horizontal axis unidirectional wecs an effective way is to make the rotor axis vertically oriented a vertical axis unidirectional wec is expected to respond to waves from any directions in exactly the same way which is similar to a vertical axis wind turbine nonetheless wave interaction with a vertical wec more specifically with the wec s vertical rotor is totally different from that with a horizontal one therefore a wec designed for horizontal use would most likely not work if oriented vertically to the best knowledge of the authors only one unidirectional wec specifically for vertical use has been developed to date it is called wave rotor rossen et al 2000 yet this wec stops rotating in irregular waves according to its developer therefore a simply structured vertical axis unidirectional wec that could work in all wave conditions is yet to be demonstrated in advancement of wec technologies of all kinds a main theme has been on the efficiency improvement nonetheless an increased efficiency is often times achieved by sacrificing a wec s simplicity a key factor to reduce capital operation and maintenance costs for this reason a comparison among a variety of wec technologies evidences that a wec with a high efficiency does not necessarily produce electricity at a low cost babarit 2015 it would not be a surprise to see a wec with a relatively low efficiency to still produce low cost electricity as long as the wec is simple enough in fact a vertical axis unidirectional rotary wec has a strong potential to become one of this kind for two reasons first it allows an extremely simple wec design it can be surface floating with no needs for realignment or any other active controls and the wave enabled unidirectional rotation is already the most favorable motion for direct energy conversion second it naturally possesses a broad frequency responsive range which promises a moderate if not high efficiency upon hydrodynamic optimization the present work aims to i realize a vertical axis unidirectional wec using a new design concept and ii augment the associated knowledge base with new findings the key component of the new wec is a rotor that performs unidirectional rotation about its vertical shaft when directly exposed in waves employing a couple of intuition based rotor designs without optimization experimental exploration in a wave flume is planned for demonstrating the proof of concept and gaining fundamental understanding the particular focus is given to the characterization of the rotor s angular velocity in this initial exploration the rotor efficiency is to be addressed in future research upon rotor optimization 2 conceptual development in realizing a vertical axis rotor for unidirectional rotation in waves a basic rotor was constructed first in an initial proof of concept study fig 1 a shows the basic rotor in waves the rotor parameters are schematically illustrated in fig 1b it consists of two sets of dual blades hemispherical shells mounted to a shaft through spokes at two axial locations the distance between the two axial locations is defined as the spacing s which can be varied by axially sliding one set of blades along the shaft at each axial location the two spokes forming one pair are coaxial between the two axial locations the two pairs of spokes are orthogonal the blade angle α is defined as the angle between a vertical plane and a blade s open end plane each pair of blades connected via two coaxial spokes always have opposite open end facing two diameters are defined the blade diameter d and the rotor diameter d the rotor diameter d can be varied by sliding cup blades along the spokes the basic rotor was mounted to a support through a shaft bearing casing assembly the assembly allowed free rotation of the rotor about the shaft at a low friction the assembly also allowed easy adjustment of the rotor s submersion level in water according to the parameter definition in fig 1b with s 0 and α 0 the rotor resembles a typical cup anemometer used in weather stations it has long been known that a vertical axis cup anemometer performs unidirectional rotation clockwise in fig 1b no matter in which horizontal direction winds blow pindado et al 2013 in steady horizontal water flows and regardless of flow directions the cup anemometer or more generally the cup rotor as in fig 1b should behave the same way as in winds in water waves however the rotor could behave differently due to the complex flow condition for example in simple deep waves water particles move along circular orbits in vertical planes with an additional stokes drift and the circular orbits shrink in size exponentially with increasing water depth pickard and pond 1983 in irregular waves water motion is even more complicated as a result of superposition of waves in different frequencies and propagation directions generally wave resulted water flows are omnidirectional and have two main features three dimensional patterns and constantly evolving flow directions then a question arises can such omnidirectional flows directly enable unidirectional rotation of the rotor in an attempt to answer this fundamental question and support the conceptual development of the rotor two flow rotor interaction scenarios are considered first two simple flows are employed in the two scenarios they are a horizontally oscillating flow and a vertically oscillating flow respectively superposition of such two oscillating flows at the same frequencies could generate an omnidirectional flow which would closely mimic water motion in simple waves therefore insights gained on the rotor responses in the two simple flows can be used to further interpret the rotor response in waves based on an aerodynamic study of cup anemometers a steady flow orthogonal to an anemometer axis always drive the anemometer to rotate in one specific direction only pindado et al 2013 in addition such a unidirectional behavior of the anemometer is not sensitive to the direction of the approaching flow as long as it is orthogonal to the axis then consider the vertical axis rotor in fig 1b being exposed in a horizontally oscillating water flow the flow can be discretized instant by instant at each instant the flow would drive the rotor to rotate clockwise which is similar to a cup anemometer in winds cumulatively from instant to instant the change of the horizontal flow would still be able to maintain the unidirectional rotation of the rotor therefore it is strongly believed that the rotor would perform unidirectional rotation in a horizontally oscillating flow when the same vertical axis rotor is exposed in a vertically oscillating flow the rotor sees an axially bidirectional flow up and down in realizing unidirectional rotation of the rotor under this flow condition like a well s rotor does raghunathan 1995 the cup blades are configured in an asymmetric fashion with an added angle α fig 1b such a layout is also expected not to jeopardize the rotor s unidirectional performance by much in the horizontal flow another consideration is that the direction of the rotor s unidirectional rotation achieved in the vertical flow should be consistent with that in the horizontal flow it is obvious that if the rotor in fig 1b indeed performs unidirectional rotation in each of the two simple flows as discussed in the foregoing it will undoubtedly perform unidirectional rotation in simple waves in fact all these scenarios have been validated experimentally at various rotor parameters in validation the rotor performance was first examined in still water in the wave flume the whole setup in fig 1a was carried manually by a person oscillated manually in each of the two specified directions approximately and maintained nearly vertically during each oscillation upon successful observation of profound and consistent unidirectional rotations of the rotor all the time the whole set up was then fixed in the wave flume with the rotor exposed in real waves fig 1a not surprisingly unidirectional rotations were witnessed again under various testing conditions while conducting manual operation of the rotor in still water an additional test is worth mentioning in this test a few trials were carried out by manually translating the whole setup along some improvised three dimensional trajectories that were arbitrary and complicated in all the trials clear and profound unidirectional rotations were observed such improvised translations of the rotor in still water may resemble to a certain extent the rotor in irregular waves with the dominant frequency component having a much large wave length compared to the rotor diameter d therefore it is likely that the rotor in fig 1b could still perform unidirectional rotation in irregular waves just like it does in simple waves 3 experimental system and approaches upon validation of the proof of concept a systematic experimental study was carried out in a wave flume to characterize the rotor s unidirectional performance 3 1 experimental setups and parameter ranges the wave flume employed has inner dimensions of 15 m long by 1 m wide by 1 3 m high the water depth was maintained at 1 m level two rotor types were explored in this experimental research the aforementioned basic rotor fig 1 and an advanced rotor fig 2 both rotor types employed identical hemispherical shells as blades these blades are herein referred to as cup blades each rotor type always had its shaft vertically oriented in waves the advanced rotor fig 2 was configured somewhat differently from the basic rotor fig 2a shows the advanced rotor in waves detailed structure and definition of some rotor parameters are shown in fig 2b the advanced rotor consists of multiple sets of quadruple blades along the shaft with each set having four cup blades evenly distributed circumferentially at a given axial location between two neighboring sets there is an angular difference of 45 in the shaft direction the two diameters d and d as well as the blade angle α and the open end facing are defined in the same way as for the basic rotor the spacing s is the axial distance between two neighboring rotor sets and the rotor length l is an axial measure between the highest point of a top blade and the lowest point of a bottom blade e g for a rotor having 4 sets of quadruple blades l 3s d the support system for the advanced rotor was also different from that for the basic rotor specifically a power take off simulator was added to the shaft bearing casing assembly as illustrated on the top portion of fig 2b the power take off simulator employed two discs in contact one disc was fastened to the fixed casing and the other to the rotating shaft different friction levels between the two discs were generated by evenly compressing three springs the relationship between the spring compression distance and the yielded resistant torque was then obtained through calibration using a very low friction weight pulley system adjustable resistant torque is important for rotor characterization at different levels of power extraction for parametric study of the basic rotor fig 1 a group of parameters were explored in certain ranges on wave conditions a fixed wave height h and two wave frequencies f w were chosen they were h 0 223 m and f w 0 593 hz 0 392 hz respectively on rotor parameters specifications are as follows d 304 8 mm 279 4 mm 254 mm 228 6 mm 203 2 mm d 76 2 mm wall thickness 0 4 mm s 25 4 mm 50 8 mm 101 6 mm 152 4 mm and α 0 15 30 45 60 75 90 these rotor parameters except for α are presented in dimensionless forms in figures and the context for all the experiments the rotor submersion was maintained at the same level the centerlines of the upper two spokes were 133 mm below the free surface in still water in testing the advanced rotor fig 2 the same wave height as for the basic rotor was employed it was h 0 223 m only one wave frequency f w 0 593 hz was employed the rotor parameters or parameter ranges are d 304 8 mm d 76 2 mm s 25 4 mm 50 8 mm 76 2 mm 101 6 mm 152 4 mm 304 8 mm and α 0 15 30 45 60 note that a change in the blade spacing s results in a change in the rotor length l during experiments the number of blade sets was varied between 1 and 4 different levels of the resistant torque were also employed as specified in a dimensionless form in some figures and the context the rotor submersion levels for all the testing cases were maintained the same the plane formed by centerlines of the top set of quadruple spokes is 133 mm beneath the free surface in still water 3 2 data acquisition and processing for data acquisition the main purpose was to obtain time traces of a rotor s angular velocity based on such data statistic characterization of the angular velocity can be further achieved serving this purpose a dial was coaxially fastened to the shaft of each rotor being tested the dial and rotor always rotated together the dial in the basic rotor setup is shown in fig 1a the rotating dial in reference to a fixed line was videotaped using an iphone 6 plus in slow motion mode framing rate 240 fps for each experimental run the recording time was approximately 60 s the videos were then manually read frame by frame at a sampling rate of 30 samples per second to obtain time traces of the angular displacement in the next step the corresponding angular velocity was derived by means of finite difference at the same sampling rate which resulted in a nyquist frequency of 15 hz the interested frequency range for the present research is below 1 2 hz as to be further discussed in section 4 in smoothing time traces of the angular velocity a low pass filter with a cut off frequency of 4 hz was applied in analyzing experimental results most parameters were presented in dimensionless forms the rotor diameter d was employed as the characteristic length to normalize the blade diameter d spacing s and rotor length l the yielded dimensionless forms were d d s d and l d respectively a rotor s instantaneous angular velocity ω was normalized as 1 ω π d ω 2 π f w h it represents the ratio of two tangential speeds one is the rotor s tip speed and the other is the free surface water speed along a circular orbit in deep waves the mean angular velocity ω and the fluctuation magnitude δ ω were normalized in exactly the same way they were denoted as ω π and δ ω π upon normalization to simulate power extraction by a rotor from waves a power take off simulator by means of mechanical friction was employed in the advanced rotor as shown in fig 2 the friction generated a resistant torque about the rotor shaft against the wave driven rotation of the advanced rotor this resistant torque γ was normalized as 2 γ π 64 π 2 f w 2 γ ρ g 2 h d 2 where ρ is the water density and g the gravitational acceleration it was derived by normalizing the resistant torque γ with a characteristic resistant torque the characteristic resistant torque was defined under two conditions i with the characteristic resistant torque applied on the rotor in simple deep waves without drift motion the rotor s average tip speed is the same as the wave driven water speed in circular motion at the free surface and ii the wave power carried by the incoming deep waves in a width that is equal to the rotor diameter d is fully extracted by the rotor at the defined average tip speed and characteristic resistant torque in i under each experimental condition explored in this research three repetitive runs were conducted with each run yielding a 60 second time trace of ω and a mean the three means were then used to calculate the average ω and the precision the values of ω π in all the figures throughout the paper are based on such an average the yielded precision in this research is moderate using the advanced rotor with four sets of blades as an example at f w 0 593 hz α 45 d d 0 25 and s d 0 33 the precision relative to the corresponding mean is 2 4 rotor characterization with a vertical axis rotor in waves the driving flow is omnidirectional yet the resulted rotor motion is unidirectional such a unidirectional feature is best represented by the rotor s angular velocity essentially without change in sign 4 1 basic rotor for all the tests on the basic rotor the wave height was fixed at h 0 223 m two wave frequencies were employed f w 0 593 hz 0 392 hz the mechanical friction from two ball bearings which were used to connect the rotor shaft to a support generated a low level resistant torque γ 0 007 n m which remained nearly constant in all the tests on the basic rotor the normalized resistant torque at f w 0 593 hz and d 304 8 mm is γ π 0 0008 fig 3 compares time traces of the rotor s angular velocity ω π at different values of the angle α with other parameters fixed the time t was normalized by the wave period t 1 f w overall these time traces demonstrate two common features unidirectionality in the angular velocity and fluctuation in its magnitude the fluctuation behavior of the angular velocity in fig 3 is better presented in fig 4 in terms of the amplitude spectra evidently the dominant fluctuation frequency is at f 2 f w for nearly all the cases and a much less dominant one is at f f w these two fluctuation components are directly related to the wave motion for the intuitive basic rotor design without any optimization although a flow in any direction pushes the rotor for unidirectional rotation the rotor does have preferred flow directions the horizontal directions therefore the rotor s angular velocity goes relatively fast when the flow is along a horizontal direction but becomes relatively slow when the flow gradually changes to a vertical direction the appearance of the dominant peak at f 2 f w is due to the occurrence of a favorable flow at a rate of two times per wave period in opposite directions the directional preference of the rotor can be minimized through design optimization in future research in addition to the two frequencies mentioned above there is a third peak in the spectra in the low frequency range f f w 0 17 0 25 fig 4 this peak is hardly noticeable at α 0 but becomes profound at α 15 30 45 and 60 it then goes overly dominant at α 75 the fluctuation of the angular velocity at this frequency is attributed to the continuously evolving correlation between the rotor s angular position α 0 makes it unique within one turn and the wave s phase angle such evolution is periodic after a certain number of the rotor turns and a different number of wave periods the same evolving correlation between the two angles repeats in each evolution period a most favorable correlation with the highest angular velocity and a least favorable one with the lowest angular velocity exist this fluctuation behavior is particularly strong at α 60 and 75 as shown in fig 3 it is noteworthy that at α 90 the rotor motion ceases when two adjacent cups with the same facing either all up or all down becomes aligned along the wave crest in this case there is nearly no resultant torque to drive the rotor due to the almost symmetric flow with respect to the rotor axis in rotor characterization the mean angular velocity is of great importance since it is related to the rotor s power extraction capability the fluctuation behavior of the rotor s angular velocity also broadly exists figs 5 7 show the effects of α d d and s d on the normalized mean angular velocity ω π at two values of f w the corresponding values of the normalized velocity fluctuation δ ω π measured by a standard deviation are also presented in figs 5 and 7 respectively in fig 5 with focus on four parameter combinations ω π generally follows an ascending to descending trend with increasing α for each combination but in the range 0 α 60 ω π only goes through a very mild change and ω π differences among the four combinations are small such a pattern can be clearly seen from the relatively flat solid line with all the data points closely scattered around it the solid line represents an average of ω π for the four combinations beyond α 60 however a quick drop of ω π is observed in contrast to ω π δ ω π has much lower values in 0 α 60 specifically δ ω π takes 15 25 of ω π only it is noteworthy that δ ω π continuously increases with increasing α till α 75 for wave energy conversion one would expect the rotor to run fast with low fluctuation the top solid line in fig 5 depicts a peak of ω π at α 45 indicating that the rotor runs fastest at this α the associated fluctuation δ ω π however is also relatively strong in comparison with other lower values of α by taking a closer look at α 45 ω π d d relation is plotted in fig 6 comparison between two values of f w is also made in general no remarkable change of ω π is observed in the examined range of d d the difference of ω π between the two values of f w is also very small yet a nearly linear descending trend is clear the effect of the blade spacing s d on ω π and δ ω π are shown in fig 7 four combinations of α and f w are compared in the range of 0 083 s d 0 5 at a fixed d d for the combination of α 45 and f w 0 392 hz ω π reaches a peak at s d 0 2 for the other three combinations however ω π descends monotonously overall for all the combinations the change of s d only causes a very mild change in ω π and δ ω π in wave rotor interaction when the two pairs of cups are placed at a small s d strong interaction among the cups will reduce their individual contribution to the overall torque for rotation changing to a larger s d surely helps to minimize cup interaction for a better efficiency nonetheless a larger s d forces the bottom two cups to stay deeper in waves where the water motion is much weaker therefore due to trade off ω π is not sensitive to s d in the examined range 4 2 advanced rotor to further examine the effects of the blade number blade layout and power take off on the rotor s unidirectional performance the advanced rotor in conjunction with the power take off simulator fig 2 was tested in waves only one wave frequency and one rotor diameter were examined on the advanced rotor they were f w 0 593 hz and d 304 8 mm respectively without the power take off simulator the mechanical friction generated by two roller bearings fig 2b yielded a minimum resistant torque of γ π 0 002 the power take off simulator provides additional resistant torque according to needs at the minimum γ π and a fixed s d fig 8 shows the ω π α relations top for the advanced rotor employing different numbers of blade sets and the δ ω π α relation bottom for the advanced rotor with two sets of blades in general the overall pattern resembles fig 5 for the basic rotor but all the data points are at a somewhat lower level this reduced level of ω π and δ ω π is mainly due to the increase of the minimum γ π from 0 0008 for the basic rotor ball bearings were employed to 0 002 for the advanced rotor roller bearings were used in a close look ω π for two sets of blades increases faster with α than for four sets of blades in 0 α 45 but due to the overall mild change all the three sets of data collapse into a narrow band therefore at the minimum γ π the effect of the blade number on ω π is trivial in the examined parameter ranges by using the power take off simulator to change the resistant torque on the rotor with different sets of blades the effect on the fluctuation of ω π is presented in fig 9 in the form of magnitude spectrum four cases are compared two rotor configurations two sets versus four sets of blades at two levels of γ π 0 002 and 0 014 angle α is fixed at α 45 it is evident that all the spectra are similar to the one in fig 4 for the basic rotor at α 45 no fundamental difference is observed the increased number of blade sets however does smooth the ω π fluctuation to a certain extent this can be seen by comparing the peak magnitudes at f f w 2 four sets of blades resulted in noticeably lower peaks fig 9c and d than two sets of blades fig 9a and b it is intuitive that increase in the resistant torque results in decrease in the angular velocity experiments have validated that such a descending trend is linear for a specified rotor configuration with all other parameters fixed as depicted in fig 10 in terms of ω π versus γ π fig 10 also shows that the descending trend for four sets of blades is noticeably slower than that for two sets of blades although no remarkable difference is observed between the two rotor configurations it is noteworthy that in presenting ω π fig 10 included error bars to show the standard deviation among repetitive runs in fact in all the ω π related figures throughout the paper ω π at each data point was an average of three repetitive runs each having an approximately 60 second long time trace of the angular velocity the standard deviation for ω π is not presented in other figures except for fig 10 since the lengths of error bars are generally no larger than the symbol sizes used in the figures at the minimum resistant torque and with all other parameters fixed change of the normalized rotor length l d results in change of ω π as shown in fig 11 for the rotor with two sets of blades a monotonous decrease of ω π is observed in the examined range 0 33 l d 1 25 and the change at lower values of l d is faster than at higher values for the rotor with four sets of blades it was only examined in 0 75 l d 1 25 to avoid a very crowded blade layout at low values of l d in this range values of ω π for both rotor configurations are nearly overlapped 5 conclusions in utilizing omnidirectional flow in waves to directly drive a vertical axis rotor for unidirectional rotation a rotor employing cup blades was proposed and characterized for wave energy conversion upon validation of proof of concept two rotor variations a basic rotor and an advanced rotor were experimentally examined in a wave flume results lead to a few major conclusions as specified in the following 1 for both rotors and under all testing conditions profound unidirectional rotation was achieved all the time 2 fluctuation in the rotors unidirectional angular velocity broadly exists with the strongest frequency component at 2f w 3 with no simulated power extraction and in the examined ranges of f w 0 392 hz and 0 593 hz α 0 60 d d 0 25 0 38 and s d 0 083 0 5 for the basic rotor or l d 0 33 1 25 for the advanced rotor the change in ω π caused by the change of each of these parameters is no more than 13 from the corresponding mean value and the angular velocity fluctuation δ ω π takes no more than 25 of the corresponding value for ω π 4 with simulated power extraction for the advanced rotor ω π decreases linearly with increasing γ π 
23334,a vertical axis rotor design for wave energy conversion is discussed in this work the rotor has a number of cup blades laid out around its shaft in ocean waves water particles perform omnidirectional motion while exposed in waves and driven by omnidirectional flows the rotor performs unidirectional rotation about its vertically oriented shaft this rotor concept was tested in a wave flume under various rotor parameters and wave conditions results show that the rotor s unidirectional behavior is profound yet fluctuation of the unidirectional angular velocity broadly exists a parametric study further revealed relations between the rotor s mean angular velocity and some other parameters keywords wave energy converter wec vertical axis unidirectional rotor 1 introduction a huge variety of wave energy converter wec designs has long been proposed in the past clément et al 2002 serious technological wec development for utility scale applications started during the energy crisis in 1970s the publication of salter s paper in nature salter 1974 is often noted as a landmark yet promising technologies realized since then remain rare clément et al 2002 falcao 2010 drew et al 2009 to date only a very few wec technologies have been demonstrated in some pilot wave farm projects and the associated levelized cost of the generated electricity is far less competitive compared to that from solar and wind energies astariz and iglesias 2015 it is generally believed that a significant drop of the levelized cost relies on realization of transformative wec technologies the large family of wecs can be categorized in different ways employing different criteria some broadly used criteria include deployment site offshore versus onshore placing method surface floating versus seabed mounting wave wec relation point absorbers attenuators terminators and motion type heaving pitching or swaying oscillating water column overtopping etc falcao 2010 lopez et al 2013 due to the importance in characterizing the performance of wecs very recently the motion directionality has also been employed to classify wecs it splits the wecs into a unidirectional class and a reciprocating class yang 2014 a reciprocating wec features reciprocating motion linear and or angular of the whole wec or a unit of it directly driven by waves a huge majority of existing wec designs belongs to this class examples include powerbuoy oceanpowertechnologies com heaving up and down pelamis pizer et al 2005 reciprocating bending between segments defunct since november 2014 and oceanlinx greenwave falcao and henriques 2016 using the oscillating water column principle in comparison a unidirectional wec is distinctive in having a rotor that is directly driven by waves to perform unidirectional rotation without any intervening steps only a very few members from the large wec family are in the unidirectional class yang 2014 it has been a common approach that in development of a reciprocating wec the resonant principle is applied to improve the efficiency as a result the wec s efficiency is strongly wave frequency dependent in oceans waves usually possess a complex spectrum pierson and moskowits 1964 and the dominant frequency component or frequency band may change largely over time in response to such a change for the best efficiency the reciprocating wec s natural frequency needs to be adjusted accordingly this is usually done by employing some frequency tuning or phase control mechanisms hals et al 2011 falnes 2002 falcao 2008 hong et al 2014 however frequency tuning has its limitations compared to a wide range of the wave frequency and an employed mechanism adds complexity to the overall wec design behaving differently from the reciprocating wecs the unidirectional wecs do not involve resonance therefore upon hydrodynamic optimization a unidirectional wec can absorb energy from all the wave frequency components with no need in frequency tuning in addition the unidirectional rotation is directly achieved from the wave motion no other intervening mechanical means such as a hydraulic system zhang et al 2012 or a mechanical rectifier ai et al 2014 for motion conversion are ever needed as such the power take off system of the unidirectional wec and even the entire wec can be in a very simple structure simplicity leads to robustness in the very small unidirectional wec class most of the wec designs have the axis of the rotor horizontally placed the savonius wec ahmed et al 2013 and cycloidal wec siegel et al 2012 lay in this type the horizontal orientation of the rotor takes full advantage of the water s orbital motion in waves to enable unidirectional rotation if the horizontal axis is orthogonal to the wave propagation direction in practice however meeting and maintaining such an alignment requirement is not easy for two reasons i irregular waves exist most of the time and ii they have different wave frequency components that travel in different directions even if a dominant wave propagation direction could be defined and used this direction would still change from time to time that leads to another challenge automatic realignment of a wec of this type although both passive control a hydrodynamic approach and active control using sensors and motors would serve this purpose well employment of either approach would drastically complicate the overall wec structure to circumvent the alignment issue of horizontal axis unidirectional wecs an effective way is to make the rotor axis vertically oriented a vertical axis unidirectional wec is expected to respond to waves from any directions in exactly the same way which is similar to a vertical axis wind turbine nonetheless wave interaction with a vertical wec more specifically with the wec s vertical rotor is totally different from that with a horizontal one therefore a wec designed for horizontal use would most likely not work if oriented vertically to the best knowledge of the authors only one unidirectional wec specifically for vertical use has been developed to date it is called wave rotor rossen et al 2000 yet this wec stops rotating in irregular waves according to its developer therefore a simply structured vertical axis unidirectional wec that could work in all wave conditions is yet to be demonstrated in advancement of wec technologies of all kinds a main theme has been on the efficiency improvement nonetheless an increased efficiency is often times achieved by sacrificing a wec s simplicity a key factor to reduce capital operation and maintenance costs for this reason a comparison among a variety of wec technologies evidences that a wec with a high efficiency does not necessarily produce electricity at a low cost babarit 2015 it would not be a surprise to see a wec with a relatively low efficiency to still produce low cost electricity as long as the wec is simple enough in fact a vertical axis unidirectional rotary wec has a strong potential to become one of this kind for two reasons first it allows an extremely simple wec design it can be surface floating with no needs for realignment or any other active controls and the wave enabled unidirectional rotation is already the most favorable motion for direct energy conversion second it naturally possesses a broad frequency responsive range which promises a moderate if not high efficiency upon hydrodynamic optimization the present work aims to i realize a vertical axis unidirectional wec using a new design concept and ii augment the associated knowledge base with new findings the key component of the new wec is a rotor that performs unidirectional rotation about its vertical shaft when directly exposed in waves employing a couple of intuition based rotor designs without optimization experimental exploration in a wave flume is planned for demonstrating the proof of concept and gaining fundamental understanding the particular focus is given to the characterization of the rotor s angular velocity in this initial exploration the rotor efficiency is to be addressed in future research upon rotor optimization 2 conceptual development in realizing a vertical axis rotor for unidirectional rotation in waves a basic rotor was constructed first in an initial proof of concept study fig 1 a shows the basic rotor in waves the rotor parameters are schematically illustrated in fig 1b it consists of two sets of dual blades hemispherical shells mounted to a shaft through spokes at two axial locations the distance between the two axial locations is defined as the spacing s which can be varied by axially sliding one set of blades along the shaft at each axial location the two spokes forming one pair are coaxial between the two axial locations the two pairs of spokes are orthogonal the blade angle α is defined as the angle between a vertical plane and a blade s open end plane each pair of blades connected via two coaxial spokes always have opposite open end facing two diameters are defined the blade diameter d and the rotor diameter d the rotor diameter d can be varied by sliding cup blades along the spokes the basic rotor was mounted to a support through a shaft bearing casing assembly the assembly allowed free rotation of the rotor about the shaft at a low friction the assembly also allowed easy adjustment of the rotor s submersion level in water according to the parameter definition in fig 1b with s 0 and α 0 the rotor resembles a typical cup anemometer used in weather stations it has long been known that a vertical axis cup anemometer performs unidirectional rotation clockwise in fig 1b no matter in which horizontal direction winds blow pindado et al 2013 in steady horizontal water flows and regardless of flow directions the cup anemometer or more generally the cup rotor as in fig 1b should behave the same way as in winds in water waves however the rotor could behave differently due to the complex flow condition for example in simple deep waves water particles move along circular orbits in vertical planes with an additional stokes drift and the circular orbits shrink in size exponentially with increasing water depth pickard and pond 1983 in irregular waves water motion is even more complicated as a result of superposition of waves in different frequencies and propagation directions generally wave resulted water flows are omnidirectional and have two main features three dimensional patterns and constantly evolving flow directions then a question arises can such omnidirectional flows directly enable unidirectional rotation of the rotor in an attempt to answer this fundamental question and support the conceptual development of the rotor two flow rotor interaction scenarios are considered first two simple flows are employed in the two scenarios they are a horizontally oscillating flow and a vertically oscillating flow respectively superposition of such two oscillating flows at the same frequencies could generate an omnidirectional flow which would closely mimic water motion in simple waves therefore insights gained on the rotor responses in the two simple flows can be used to further interpret the rotor response in waves based on an aerodynamic study of cup anemometers a steady flow orthogonal to an anemometer axis always drive the anemometer to rotate in one specific direction only pindado et al 2013 in addition such a unidirectional behavior of the anemometer is not sensitive to the direction of the approaching flow as long as it is orthogonal to the axis then consider the vertical axis rotor in fig 1b being exposed in a horizontally oscillating water flow the flow can be discretized instant by instant at each instant the flow would drive the rotor to rotate clockwise which is similar to a cup anemometer in winds cumulatively from instant to instant the change of the horizontal flow would still be able to maintain the unidirectional rotation of the rotor therefore it is strongly believed that the rotor would perform unidirectional rotation in a horizontally oscillating flow when the same vertical axis rotor is exposed in a vertically oscillating flow the rotor sees an axially bidirectional flow up and down in realizing unidirectional rotation of the rotor under this flow condition like a well s rotor does raghunathan 1995 the cup blades are configured in an asymmetric fashion with an added angle α fig 1b such a layout is also expected not to jeopardize the rotor s unidirectional performance by much in the horizontal flow another consideration is that the direction of the rotor s unidirectional rotation achieved in the vertical flow should be consistent with that in the horizontal flow it is obvious that if the rotor in fig 1b indeed performs unidirectional rotation in each of the two simple flows as discussed in the foregoing it will undoubtedly perform unidirectional rotation in simple waves in fact all these scenarios have been validated experimentally at various rotor parameters in validation the rotor performance was first examined in still water in the wave flume the whole setup in fig 1a was carried manually by a person oscillated manually in each of the two specified directions approximately and maintained nearly vertically during each oscillation upon successful observation of profound and consistent unidirectional rotations of the rotor all the time the whole set up was then fixed in the wave flume with the rotor exposed in real waves fig 1a not surprisingly unidirectional rotations were witnessed again under various testing conditions while conducting manual operation of the rotor in still water an additional test is worth mentioning in this test a few trials were carried out by manually translating the whole setup along some improvised three dimensional trajectories that were arbitrary and complicated in all the trials clear and profound unidirectional rotations were observed such improvised translations of the rotor in still water may resemble to a certain extent the rotor in irregular waves with the dominant frequency component having a much large wave length compared to the rotor diameter d therefore it is likely that the rotor in fig 1b could still perform unidirectional rotation in irregular waves just like it does in simple waves 3 experimental system and approaches upon validation of the proof of concept a systematic experimental study was carried out in a wave flume to characterize the rotor s unidirectional performance 3 1 experimental setups and parameter ranges the wave flume employed has inner dimensions of 15 m long by 1 m wide by 1 3 m high the water depth was maintained at 1 m level two rotor types were explored in this experimental research the aforementioned basic rotor fig 1 and an advanced rotor fig 2 both rotor types employed identical hemispherical shells as blades these blades are herein referred to as cup blades each rotor type always had its shaft vertically oriented in waves the advanced rotor fig 2 was configured somewhat differently from the basic rotor fig 2a shows the advanced rotor in waves detailed structure and definition of some rotor parameters are shown in fig 2b the advanced rotor consists of multiple sets of quadruple blades along the shaft with each set having four cup blades evenly distributed circumferentially at a given axial location between two neighboring sets there is an angular difference of 45 in the shaft direction the two diameters d and d as well as the blade angle α and the open end facing are defined in the same way as for the basic rotor the spacing s is the axial distance between two neighboring rotor sets and the rotor length l is an axial measure between the highest point of a top blade and the lowest point of a bottom blade e g for a rotor having 4 sets of quadruple blades l 3s d the support system for the advanced rotor was also different from that for the basic rotor specifically a power take off simulator was added to the shaft bearing casing assembly as illustrated on the top portion of fig 2b the power take off simulator employed two discs in contact one disc was fastened to the fixed casing and the other to the rotating shaft different friction levels between the two discs were generated by evenly compressing three springs the relationship between the spring compression distance and the yielded resistant torque was then obtained through calibration using a very low friction weight pulley system adjustable resistant torque is important for rotor characterization at different levels of power extraction for parametric study of the basic rotor fig 1 a group of parameters were explored in certain ranges on wave conditions a fixed wave height h and two wave frequencies f w were chosen they were h 0 223 m and f w 0 593 hz 0 392 hz respectively on rotor parameters specifications are as follows d 304 8 mm 279 4 mm 254 mm 228 6 mm 203 2 mm d 76 2 mm wall thickness 0 4 mm s 25 4 mm 50 8 mm 101 6 mm 152 4 mm and α 0 15 30 45 60 75 90 these rotor parameters except for α are presented in dimensionless forms in figures and the context for all the experiments the rotor submersion was maintained at the same level the centerlines of the upper two spokes were 133 mm below the free surface in still water in testing the advanced rotor fig 2 the same wave height as for the basic rotor was employed it was h 0 223 m only one wave frequency f w 0 593 hz was employed the rotor parameters or parameter ranges are d 304 8 mm d 76 2 mm s 25 4 mm 50 8 mm 76 2 mm 101 6 mm 152 4 mm 304 8 mm and α 0 15 30 45 60 note that a change in the blade spacing s results in a change in the rotor length l during experiments the number of blade sets was varied between 1 and 4 different levels of the resistant torque were also employed as specified in a dimensionless form in some figures and the context the rotor submersion levels for all the testing cases were maintained the same the plane formed by centerlines of the top set of quadruple spokes is 133 mm beneath the free surface in still water 3 2 data acquisition and processing for data acquisition the main purpose was to obtain time traces of a rotor s angular velocity based on such data statistic characterization of the angular velocity can be further achieved serving this purpose a dial was coaxially fastened to the shaft of each rotor being tested the dial and rotor always rotated together the dial in the basic rotor setup is shown in fig 1a the rotating dial in reference to a fixed line was videotaped using an iphone 6 plus in slow motion mode framing rate 240 fps for each experimental run the recording time was approximately 60 s the videos were then manually read frame by frame at a sampling rate of 30 samples per second to obtain time traces of the angular displacement in the next step the corresponding angular velocity was derived by means of finite difference at the same sampling rate which resulted in a nyquist frequency of 15 hz the interested frequency range for the present research is below 1 2 hz as to be further discussed in section 4 in smoothing time traces of the angular velocity a low pass filter with a cut off frequency of 4 hz was applied in analyzing experimental results most parameters were presented in dimensionless forms the rotor diameter d was employed as the characteristic length to normalize the blade diameter d spacing s and rotor length l the yielded dimensionless forms were d d s d and l d respectively a rotor s instantaneous angular velocity ω was normalized as 1 ω π d ω 2 π f w h it represents the ratio of two tangential speeds one is the rotor s tip speed and the other is the free surface water speed along a circular orbit in deep waves the mean angular velocity ω and the fluctuation magnitude δ ω were normalized in exactly the same way they were denoted as ω π and δ ω π upon normalization to simulate power extraction by a rotor from waves a power take off simulator by means of mechanical friction was employed in the advanced rotor as shown in fig 2 the friction generated a resistant torque about the rotor shaft against the wave driven rotation of the advanced rotor this resistant torque γ was normalized as 2 γ π 64 π 2 f w 2 γ ρ g 2 h d 2 where ρ is the water density and g the gravitational acceleration it was derived by normalizing the resistant torque γ with a characteristic resistant torque the characteristic resistant torque was defined under two conditions i with the characteristic resistant torque applied on the rotor in simple deep waves without drift motion the rotor s average tip speed is the same as the wave driven water speed in circular motion at the free surface and ii the wave power carried by the incoming deep waves in a width that is equal to the rotor diameter d is fully extracted by the rotor at the defined average tip speed and characteristic resistant torque in i under each experimental condition explored in this research three repetitive runs were conducted with each run yielding a 60 second time trace of ω and a mean the three means were then used to calculate the average ω and the precision the values of ω π in all the figures throughout the paper are based on such an average the yielded precision in this research is moderate using the advanced rotor with four sets of blades as an example at f w 0 593 hz α 45 d d 0 25 and s d 0 33 the precision relative to the corresponding mean is 2 4 rotor characterization with a vertical axis rotor in waves the driving flow is omnidirectional yet the resulted rotor motion is unidirectional such a unidirectional feature is best represented by the rotor s angular velocity essentially without change in sign 4 1 basic rotor for all the tests on the basic rotor the wave height was fixed at h 0 223 m two wave frequencies were employed f w 0 593 hz 0 392 hz the mechanical friction from two ball bearings which were used to connect the rotor shaft to a support generated a low level resistant torque γ 0 007 n m which remained nearly constant in all the tests on the basic rotor the normalized resistant torque at f w 0 593 hz and d 304 8 mm is γ π 0 0008 fig 3 compares time traces of the rotor s angular velocity ω π at different values of the angle α with other parameters fixed the time t was normalized by the wave period t 1 f w overall these time traces demonstrate two common features unidirectionality in the angular velocity and fluctuation in its magnitude the fluctuation behavior of the angular velocity in fig 3 is better presented in fig 4 in terms of the amplitude spectra evidently the dominant fluctuation frequency is at f 2 f w for nearly all the cases and a much less dominant one is at f f w these two fluctuation components are directly related to the wave motion for the intuitive basic rotor design without any optimization although a flow in any direction pushes the rotor for unidirectional rotation the rotor does have preferred flow directions the horizontal directions therefore the rotor s angular velocity goes relatively fast when the flow is along a horizontal direction but becomes relatively slow when the flow gradually changes to a vertical direction the appearance of the dominant peak at f 2 f w is due to the occurrence of a favorable flow at a rate of two times per wave period in opposite directions the directional preference of the rotor can be minimized through design optimization in future research in addition to the two frequencies mentioned above there is a third peak in the spectra in the low frequency range f f w 0 17 0 25 fig 4 this peak is hardly noticeable at α 0 but becomes profound at α 15 30 45 and 60 it then goes overly dominant at α 75 the fluctuation of the angular velocity at this frequency is attributed to the continuously evolving correlation between the rotor s angular position α 0 makes it unique within one turn and the wave s phase angle such evolution is periodic after a certain number of the rotor turns and a different number of wave periods the same evolving correlation between the two angles repeats in each evolution period a most favorable correlation with the highest angular velocity and a least favorable one with the lowest angular velocity exist this fluctuation behavior is particularly strong at α 60 and 75 as shown in fig 3 it is noteworthy that at α 90 the rotor motion ceases when two adjacent cups with the same facing either all up or all down becomes aligned along the wave crest in this case there is nearly no resultant torque to drive the rotor due to the almost symmetric flow with respect to the rotor axis in rotor characterization the mean angular velocity is of great importance since it is related to the rotor s power extraction capability the fluctuation behavior of the rotor s angular velocity also broadly exists figs 5 7 show the effects of α d d and s d on the normalized mean angular velocity ω π at two values of f w the corresponding values of the normalized velocity fluctuation δ ω π measured by a standard deviation are also presented in figs 5 and 7 respectively in fig 5 with focus on four parameter combinations ω π generally follows an ascending to descending trend with increasing α for each combination but in the range 0 α 60 ω π only goes through a very mild change and ω π differences among the four combinations are small such a pattern can be clearly seen from the relatively flat solid line with all the data points closely scattered around it the solid line represents an average of ω π for the four combinations beyond α 60 however a quick drop of ω π is observed in contrast to ω π δ ω π has much lower values in 0 α 60 specifically δ ω π takes 15 25 of ω π only it is noteworthy that δ ω π continuously increases with increasing α till α 75 for wave energy conversion one would expect the rotor to run fast with low fluctuation the top solid line in fig 5 depicts a peak of ω π at α 45 indicating that the rotor runs fastest at this α the associated fluctuation δ ω π however is also relatively strong in comparison with other lower values of α by taking a closer look at α 45 ω π d d relation is plotted in fig 6 comparison between two values of f w is also made in general no remarkable change of ω π is observed in the examined range of d d the difference of ω π between the two values of f w is also very small yet a nearly linear descending trend is clear the effect of the blade spacing s d on ω π and δ ω π are shown in fig 7 four combinations of α and f w are compared in the range of 0 083 s d 0 5 at a fixed d d for the combination of α 45 and f w 0 392 hz ω π reaches a peak at s d 0 2 for the other three combinations however ω π descends monotonously overall for all the combinations the change of s d only causes a very mild change in ω π and δ ω π in wave rotor interaction when the two pairs of cups are placed at a small s d strong interaction among the cups will reduce their individual contribution to the overall torque for rotation changing to a larger s d surely helps to minimize cup interaction for a better efficiency nonetheless a larger s d forces the bottom two cups to stay deeper in waves where the water motion is much weaker therefore due to trade off ω π is not sensitive to s d in the examined range 4 2 advanced rotor to further examine the effects of the blade number blade layout and power take off on the rotor s unidirectional performance the advanced rotor in conjunction with the power take off simulator fig 2 was tested in waves only one wave frequency and one rotor diameter were examined on the advanced rotor they were f w 0 593 hz and d 304 8 mm respectively without the power take off simulator the mechanical friction generated by two roller bearings fig 2b yielded a minimum resistant torque of γ π 0 002 the power take off simulator provides additional resistant torque according to needs at the minimum γ π and a fixed s d fig 8 shows the ω π α relations top for the advanced rotor employing different numbers of blade sets and the δ ω π α relation bottom for the advanced rotor with two sets of blades in general the overall pattern resembles fig 5 for the basic rotor but all the data points are at a somewhat lower level this reduced level of ω π and δ ω π is mainly due to the increase of the minimum γ π from 0 0008 for the basic rotor ball bearings were employed to 0 002 for the advanced rotor roller bearings were used in a close look ω π for two sets of blades increases faster with α than for four sets of blades in 0 α 45 but due to the overall mild change all the three sets of data collapse into a narrow band therefore at the minimum γ π the effect of the blade number on ω π is trivial in the examined parameter ranges by using the power take off simulator to change the resistant torque on the rotor with different sets of blades the effect on the fluctuation of ω π is presented in fig 9 in the form of magnitude spectrum four cases are compared two rotor configurations two sets versus four sets of blades at two levels of γ π 0 002 and 0 014 angle α is fixed at α 45 it is evident that all the spectra are similar to the one in fig 4 for the basic rotor at α 45 no fundamental difference is observed the increased number of blade sets however does smooth the ω π fluctuation to a certain extent this can be seen by comparing the peak magnitudes at f f w 2 four sets of blades resulted in noticeably lower peaks fig 9c and d than two sets of blades fig 9a and b it is intuitive that increase in the resistant torque results in decrease in the angular velocity experiments have validated that such a descending trend is linear for a specified rotor configuration with all other parameters fixed as depicted in fig 10 in terms of ω π versus γ π fig 10 also shows that the descending trend for four sets of blades is noticeably slower than that for two sets of blades although no remarkable difference is observed between the two rotor configurations it is noteworthy that in presenting ω π fig 10 included error bars to show the standard deviation among repetitive runs in fact in all the ω π related figures throughout the paper ω π at each data point was an average of three repetitive runs each having an approximately 60 second long time trace of the angular velocity the standard deviation for ω π is not presented in other figures except for fig 10 since the lengths of error bars are generally no larger than the symbol sizes used in the figures at the minimum resistant torque and with all other parameters fixed change of the normalized rotor length l d results in change of ω π as shown in fig 11 for the rotor with two sets of blades a monotonous decrease of ω π is observed in the examined range 0 33 l d 1 25 and the change at lower values of l d is faster than at higher values for the rotor with four sets of blades it was only examined in 0 75 l d 1 25 to avoid a very crowded blade layout at low values of l d in this range values of ω π for both rotor configurations are nearly overlapped 5 conclusions in utilizing omnidirectional flow in waves to directly drive a vertical axis rotor for unidirectional rotation a rotor employing cup blades was proposed and characterized for wave energy conversion upon validation of proof of concept two rotor variations a basic rotor and an advanced rotor were experimentally examined in a wave flume results lead to a few major conclusions as specified in the following 1 for both rotors and under all testing conditions profound unidirectional rotation was achieved all the time 2 fluctuation in the rotors unidirectional angular velocity broadly exists with the strongest frequency component at 2f w 3 with no simulated power extraction and in the examined ranges of f w 0 392 hz and 0 593 hz α 0 60 d d 0 25 0 38 and s d 0 083 0 5 for the basic rotor or l d 0 33 1 25 for the advanced rotor the change in ω π caused by the change of each of these parameters is no more than 13 from the corresponding mean value and the angular velocity fluctuation δ ω π takes no more than 25 of the corresponding value for ω π 4 with simulated power extraction for the advanced rotor ω π decreases linearly with increasing γ π 
