index,text
23300,data driven models are increasingly used in engineering design and analysis bayesian regularization artificial neural network brann and levenberg marquardt artificial neural network lmann are two widely used data driven models however their application to study the dispersion in complex geometry is not explored this study aims to investigate the suitability of brann and lmann in estimating dimension of flammable cloud in congested offshore platform a large number of numerical simulations are conducted using flacs part of these simulations results are used to training the network the trained network is subsequently used to predict the vapor cloud dimension and compared against remaining simulation results the predictive abilities of these network along with response surface method and frozen cloud approach fca are studied the comparative results indicate brann model with 20 hidden neurons is the most robust and precise the developed brann would serve an effective and tool for quick explosion risk analysis era keywords bayesian regularization artificial neuron network response surface method frozen cloud approach overfitting problem better generalization 1 introduction gas dispersion simulation of offshore platform plays an essential role for explosion risk analysis era as it can be conducted to identify credible gas cloud volume gas concentrations and cloud locations and the simulation results can be viewed as the input for different simulations norsok 2010 iso 19901 3 2015 generally it is not feasible and acceptable to perform limited dispersion simulations as part of era large set of simulations is cost prohibitive two popular techniques namely frozen cloud approach fca and response surface methodology rsm are often employed to predict the acceptable non simulation flammable cloud volume for range of conditions this improves the efficiency of the risk analysis based on a limited number of computationally fluid dynamics simulations fca was initially proposed by dnv then widely used by many gexcon 2015 hansen and middha 2008 qiao and zhang 2010 to predict the flammable cloud volume in this technique linear relations amongst gas concentration leak rate and the wind speed for each leak scenario are assumed and data of gas cloud volume from the non numerically simulated scenarios are then obtained generally fca contributes to saving time and financial cost of era it can provide good prediction results for leakages in ventilation dominated regions moreover it can easily determine the time series of flammable cloud volume however fca may determine poor estimation under specific leakage condition e g leakage in the fuel dominated region gexcon 2015 rsm was firstly adopted by cleaver cleaver et al 1999 and then widely used to predict the flammable cloud volume ferreira and vianna 2014 however conventional rsm may cause overfitting problem this means the generated correlations may have a worse generalization for new input data even though higher coefficient of determination r2 for training data can be obtained robustness of these correlations are not be guaranteed although specific statistical methods are used to keep correlation avoid overfitting problem jihao et al 2017 there seems to a room to further improve the robustness and accuracy artificial neural network ann which computer based algorithm appears to have a better prospect in terms of flammable cloud volume estimation ann consists of a set of processing units that allow signals to travel in parallel as well as serially by connecting various neural adedigba et al 2017 it can mimic the complex non linear relationships between the inputs and outputs among various types of anns back propagation bp algorithm is widely used which uses the derivative of an error function to find the direction that minimizes the error of the network and then updates the weights accordingly however conventional bp algorithm also may cause overfitting problem especially under limited simulation data different regularization techniques are developed to overcome the overfitting problem among these techniques levenberg marquardt lm and bayesian regularization br are widely used because of their respective advantages demuth and beale 2009 baghirli 2015 kayri 2016 recently various researchers from different areas have compared the predictability lmann and brann brann is identified as better generalization in most cases baghirli 2015 kayri 2016 gianola et al 2011 kaur and salaria 2013 ticknor 2013 however in terms of flammable cloud volume prediction the more robust and efficient one is unknown since anns are sensitive to statistical properties of the input and output datasets varied volume and statistical properties additional issue employing ann is that it is difficult to determine the suitable hidden neuron numbers with varied inputs for general application in other words if employing ann the engineers should initially determine the suitable hidden neuron numbers along with the various inputs during the training process this is much labor intensity this study aims to determine the efficient techniques to estimate the flammable cloud volume in complex geometry such as the offshore platform using the identified technique a robust model is to be developed to estimate the flammable cloud volume the developed model is tested on a fixed and floating offshore facility the developed model is integral part of the era 2 artificial neuron network 2 1 multilayer perception with back propagation algorithm fig 1 shows the architecture of multi layer perception mlp with bp algorithm which is the basis to develop the brann and lmann as can be seen this architecture consists of three layers namely input hidden and output layers the input layer contains n neurons presenting n factors affecting the flammable cloud volume in this study n 4 since 4 main factors namely leak rate wind speed wind direction and leak direction are considered the neurons in hidden layer are varied while the output layer only contains 1 neuron presenting the maximum flammable cloud volume 2 2 bayesian regularization and levenberg marquardt algorithms the conventional mlp with bp algorithm may cause the overfitting problem i e lower bias but larger variance as an alternative brann has better generalization capacity since it minimizes a combination of squared errors e d and weights e w and then determine the optimal weight and objective function parameters α β as probability kayri 2016 the objective function for brann is shown as 1 f β e d α e w in brann the initial weights are randomly set with these initial weights the density function for the weights can be updated according to baye s rule 2 p w d α β m p d w β m p w α m p d α β m where d is the training sample m is the particular neural network model architecture adopted and w is the vector of network weights p w α m is the prior distribution of weights which presents our knowledge of the weights before any data is collected p d w β m is the likelihood function which is the probability of the occurrence given the weights w p d α β m is a normalization factor which can be expressed as equation 7 as below if gaussian distribution is assumed to the noise of training set data and weights the probability densities can be calculated as below 3 p d w β m 1 z d β exp β e d π β n 2 exp β e d 4 p w α m 1 z w α exp β e w π α n 2 exp β e w if we substitute these probabilities into eq 2 we obtain 5 p w d α β m 1 z w α 1 z d β exp β e d α e w p d α β m 1 z f α β exp f w in this brann the optimal weights should maximize the posterior probability maximizing the posterior probability p w d α β m is equivalent to minimizing the regularized objective function f foresee and hagan 1997 the joint posterior density 6 p α β d m p d α β m p α β m p d m maximizing the joint posterior above is determined by maximizing the likelihood function p d α β m which can be calculated by 7 p d α β m p d w β m p w α m p w d α β m z f α β π β n 2 π α m 2 where n is the number of observations input target simulation pairs and m is the total number of network parameters furthermore the parameter z f α β depends on the hessian of the objective function foresee and hagan 1997 which can be calculated below 8 z f α β e f w max h max where the subscript max indicates maximum a posteriori the hessian matrix h is calculated from the jacobian j 9 h j t j where the jacobian matrix contains the first derivatives of the network errors with respect to network parameters the lm algorithm shaneh and butler 2006 can be used to iteratively update the synaptic weights as follows 10 w k 1 w k h μ i 1 j t e where k is the iteration number and μ is the damping parameter which is summed to every member of the approximate hessian diagonal before the system is solved for the gradient after the synaptic weights are updated and determined the optimal values for α and β at minimum point can be calculated by 11 η w α t r h 1 12 β m η 2 e d 13 α η 2 e w where m is the total number of parameters in the network the parameter η is a measure of how many parameters in the neural network are effectively used in reducing the error function 3 methodology of model development and testing this section presents the structured framework to compare three data driven numerical models to study dispersion in congested geometry fig 2 shows the detailed steps which will be followed in subsequent applications step 1 numerical modelling and conducting dispersion simulations step 2 dividing all the dispersion simulations into two sets namely developing set and checking set the developing set is used to develop varied models while the checking set is to check the generalization of developed models furthermore for brann the developing set can be further categorized into two sets i e training set and test set while in terms of lmann validation set is also needed to avoid the overfitting problem however for rsm the developing set only contains the training set step 3 setting the number of hidden neuron or the order of correlation equal to 1 and developing the corresponding models coefficient determination r2 between estimated results and simulation results of developing set is subsequently calculated once the maximum r2 arrives the model is determined step 4 the generated model is then used to predict those results of checking set accordingly coefficient determination r2 between estimated results and simulation results of checking set is calculated step 5 changing the number of hidden neuron or the order of correlation and repetitively conducting step 3 and step 4 until n is equal to n eventually both r2 of developing set and checking set of each step 3 and step 4 are viewed as the indicator for comparison of each technique 4 applications of different techniques case of fixed offshore production platform in this study flacs flame acceleration simulator which is verified to be one of the most industry recognized 3d cfd software is used to model gas dispersion and to provide the benchmark data qiao and zhang 2010 vianna and cant 2012 huser and kvernvold 2000 patankar 1980 hansen et al 2013 a typical fixed offshore platform is used as the 1st case to compare different predictive techniques the structure of this part is organized as below 4 1 presents the dispersion numerical modelling 4 2 focuses on analyzing dispersion results under varied simulation conditions 4 3 shows the predictive comparison between brann lmann and rsm 4 4 also compares the predictive results by brann with those by fca 4 1 numerical modelling the offshore platform studied here and its corresponding technical details are available elsewhere jihao et al 2017 the overall length width and height of this platform are 25 m x 60 m y 40 m z respectively it mainly comprises of two modules namely process module and accommodation the process module has the dimensions of length 25 m width 24 m and height 10 m it consists of 3 deck levels i e the lower level the middle level and the upper level in which the middle level is the focus of this study since it is occupied by most of equipment and confined by the steel plates and accommodation module on x and y side different parameters that may affect the simulation results such as gas composition leak position leak rate leak direction wind speed and wind direction are considered here the gas composition and leak position are same with those in jihao et al jihao et al 2017 while transient leakage condition is considered here the time varying leak rate is generated by considering esd and blowdown system the esd valve is assumed to close within 30s after the initial leak is detected the blowdown valve is then opened 50s after the esd valve closes accordingly the transient leakage profile is calculated based on the formulations in spouge 1999 fig 3 shows the all the corresponding leak profiles under varied initial leak rates i e 5 kg s 10 kg s 20 kg s 40 kg s 60 kg s and 80 kg s for the following dispersion analysis the rest parameters alter e g leak rate considers 6 directions i e x x y y z z wind speed considers 6 values i e 1 5 m s 3 m s 5 m s 7 m s and 12 m s in addition it is worth to be noted that for typical engineering application at least 8 wind directions should be simulated however only 4 representative values i e 00 900 1800 2700 are utilized in this study in order to conduct the following comparisons among each method 4 2 ventilation and dispersion simulation ventilation simulation aims to generate a ventilation distribution and further identify which segment has worse ventilation rates and is prone to generate larger flammable cloud subsequently dispersion simulations are performed which can be used to determine flammable cloud volume and locations for further era the detailed ventilation condition setting subsequent ventilation results and dispersion condition setting can be seen in jihao et al 2017 which would not be illustrated in this part based on varied simulation scenarios above 864 dispersion simulations 4 leak rates 4 wind speeds 4 wind directions 6 leak directions are totally performed in this part typical dispersion results considering transient leak rates are analyzed fig 4 shows transient equivalent stoichiometric cloud volumes q9 of varied leak rates under different wind speeds when leak direction is x and wind direction is 2700 it should be noted that q9 is automatically calculated based on the concentration ratio of non uniform flammable cloud gexcon 2015 fig 4a 4 f are transient q9 results of varied leak rates under wind speeds 1 5 m s 3 m s 5 m s 6 m s 7 m s and 12 m s respectively as can be seen at least two peaks of q9 can be seen for large leak rate e g 60 kg s 80 kg s under varied wind speeds while only peak occurs for small leak rate e g 5 kg s 10 kg s the maximum q9 for all cases are summarized into fig 5 as can be seen the maximum q9 consistently decreases along with the increase of wind speed under smaller leak rates i e 5 kg s and 10 kg s while for medium leak rates e g 20 kg s and 40 kg s the maximum q9 initially increases and the decreases furthermore a general increase of the maximum q9 can be seen under large leak rate i e 60 kg s and 80 kg s the phenomena is attributed that for large leak rate under smaller wind speed the cloud concentration of the rich regions is larger than the explosion upper limit futhermore under medium wind speed the cloud of the rich regions is diluted which increases the flammable cloud volume i e q9 however with the increase of the wind speed further dilution leads to the increase of the lean parts of the cloud which thereby decreases the flammable cloud volume 4 3 comparison among brann lmann and rsm the total 864 simulations are used to compare the predictive capacity among brann lmann and rsm 384 of the total simulations which are viewed as developing set are used to train different methods while the rest 480 named checking set is to check their generalization to new simulation data it is to be noted that the developing set are randomly divided into two subsets namely training set 85 samples of the developing set and test set 15 for brann however in addition to training set 70 and test set 15 validation set 15 is also used for lmann to avoid overfitting problem braatz and hisken 2017 for rsm the developing set only contains the training set which means all the simulation results in developing set are used to develop the rsm model among the analysis three layer neuron network is used the neurons in both input layer and hidden layer are altered while the output layer contains only one neuron presenting maximum flammable cloud volume q9 the activation function is tangent sigmoid in hidden layer while linear function is employed in output layer to check the generalization of different methods along with varied simulation data input neurons and to subsequently determine the empirically efficient hidden neuron numbers polynomial order for rsm 3 groups are categorized group 1 divides the total simulations into 24 parts and each part contains varied combinations of leak rate and wind speed with one combination of leak direction and wind direction the combinations of leak rate and wind speed include 36 simulation data in which 16 simulations are viewed as the input data i e 4 leak rates 5 kg s 20 kg s 60 kg s and 80 kg s and 4 wind speeds 1 5 m s 5 m s 7 m s and 12 m s in group 1 2 input neurons presenting leak rate and wind speed are employed while the hidden neurons are varied accordingly for different hidden neuron 24 architectures are developed for each ann method for example if 3 hidden neuron number are used for brann totally 72 architectures are developed group 2 divides the total simulations into 4 parts and each part includes varied combinations of leak rate wind speed and wind direction with 4 leak directions all the combinations contain 144 simulations in which 64 simulations are regarded as the input data i e 4 leak rates 5 kg s 20 kg s 60 kg s and 80 kg s 4 wind speeds 1 5 m s 5 m s 7 m s and 12 m s and 4 wind directions 00 900 1800 2700 for each leak direction for group 2 3 input neurons presenting leak rate wind speed and wind direction are employed and 6 architectures are developed for specific number of hidden neuron number group 3 includes all the simulations in which 384 simulations are viewed as the input data i e 4 leak rates 5 kg s 20 kg s 60 kg s and 80 kg s 4 wind speeds 1 5 m s 5 m s 7 m s and 12 m s 4 wind directions 00 900 1800 2700 and 6 leak directions x x y y z z for group 3 4 input neurons presenting leak rate wind speed wind direction and leak direction are used before training codification is performed to transform the original value of leak rate wind speed and wind direction between 1 and 1 in order to decrease the effect of the different order of original values on simulation results 6 leak directions are coded as 1 x 2 x 3 y 4 y 5 z 6 z for brann and lmann while for rsm they are coded to the matrix jihao et al 2017 matlab r2017b is employed to train each method for each ann method the training process is stopped provided 1 the maximum number of iterations is reached 2 the performance has an acceptable level 3 the estimation error is below the target or 4 the lm μ parameter becomes larger than 1010 according to the structured framework in section 3 both r2 of developing set and checking set of 3 groups along with varied hidden neurons or polynomial orders are determined as follows group 1 the comparative results of representative one of 24 parts for group 1 among brann lmann and rsm are shown in fig 6 the simulation scenarios for the developing set are those shown in fig 4 i e 4 leak rates 5 kg s 20 kg s 60 kg s and 80 kg s and 4 wind speeds 1 5 m s 5 m s 7 m s and 12 m s under leak direction x and wind direction is 270 the checking sets include those simulation scenarios in fig 5 i e 2 leak rates 20 kg s and 60 kg s with 6 wind speeds 1 5 m s 3 m s 5 m s 6 m s 7 m s and 12 m s and 2 wind speeds 3 m s and 6 m s with 4 leak rates 5 kg s 20 kg s 40 kg s and 80 kg s under identical combination of leak direction x and wind direction 2700 fig 6a shows the r2 results of developing set and checking set of brann as can be seen the coefficient determination r2 of developing set becomes steady and approaches 1 with the increase of neuron numbers in the hidden layer meanwhile one can see the r2 of checking set also becomes stable and comes close to 0 9 along with the incremental neuron numbers fig 6b presents the results by lmann from fig 6b one can see the coefficient determination r2 of developing set approximates 1 with the increase of hidden neurons while the r2 for checking set firstly increases to the maximum and then decreases that indicates lmann causes the overfitting problem along with increasing the hidden neurons fig 6c shows the results by rsm as can be seen the r2 of developing set consistently increases while the r2 of training set initially increases and then decreases along with the increase of the order of polynomial that means overfitting problem also occurs for rsm it is also worth noted that the maximum r2 of checking set of both lmann and rsm are smaller than that of brann under 20 hidden neurons accordingly from the above results one can conclude brann is more robust and accurate under 16 simulation inputs 2 input neurons group2 the comparative results of group 2 between brann lmann and rsm are shown as below fig 7 shows the results of one of 6 parts the simulation scenarios for developing set are 4 leak rates 5 kg s 20 kg s 60 kg s and 80 kg s 4 wind speeds 1 5 m s 5 m s 7 m s and 12 m s and 4 wind directions 00 900 1800 2700 under leak direction x the checking set includes those simulation scenarios of 2 leak rates 20 kg s and 60 kg s with 6 wind speeds 1 5 m s 3 m s 5 m s 6 m s 7 m s and 12 m s and 4 wind directions 00 900 1800 2700 leak rates 5 kg s 20 kg s 40 kg s and 80 kg s with 2 wind speeds 3 m s and 6 m s and 4 wind directions 00 900 1800 2700 under identical leak direction x alike to group 1 the comparison results of group 2 shows that brann presents better generalization and more robustness than lmann and rsm under 64 simulation inputs 3 input neurons fig 7a is the results of brann which indicates no distinct decrease of the r2 of checking set can be seen even though the r2 of developing set is closed to 1 under 20 hidden neuron numbers fig 7 b shows the results of lmann which demonstrates the obvious decrease of the r2 of checking set occurs after 10 hidden neuron numbers furthermore the results of rsm are presented in fig 7 c from fig 7 c one can see the obvious decrease of the r2 of checking set after the 4th order of polynomial moreover it is also worth noted that the maximum r2 of checking set of both lmann and rsm are smaller than that of brann under 20 hidden neurons accordingly from the above results one can conclude brann is more robust and accurate under 64 simulation inputs 3 input neurons group3 fig 8 shows the comparative results of group 3 between brann lmann and rsm the sample scenarios for developing set are set by 4 leak rates 5 kg s 20 kg s 60 kg s and 80 kg s 4 wind speeds 1 5 m s 5 m s 7 m s and 12 m s 4 wind directions 00 900 1800 2700 and 6 leak directions x x y y z z the extra scenarios for checking set are 2 leak rates 20 kg s and 60 kg s and 6 wind speeds 1 5 m s 3 m s 5 m s 6 m s 7 m s and 12 m s with 24 combinations of wind directions and leak directions 2 wind speeds 3 m s and 6 m s and 4 leak rates 5 kg s 20 kg s 40 kg s and 80 kg s with 24 combinations of wind directions and leak directions as can been brann is more robust and accurate than another two methods namely lmann and rsm under 384 simulation inputs 4 input neurons fig 8a shows the results of brann which indicates r2 of checking set consistently increases and arrives the maximum 0 93 under 20 hidden neurons fig 8b presents the results of lmann as can be seen the decrease of r2 of checking set can be obviously seen after 20 hidden neurons which indicates overfitting problem occurs of lmann fig 8c demonstrates the results of rsm similar to lmann a distinct decrease of r2 of checking set occurs after the 3rd polynomial order which also indicates the occurrence of overfitting for rsm furthermore the maximum r2 0 90 of lmann under 20 hidden neurons and that 0 88 of rsm under the 3th order of polynomial are smaller than that of brann under 20 hidden neurons above all one can conclude that brann is more robust and accurate under 384 simulation inputs 4 input neurons from figs 6 8 it is worth noting that brann seems to be more suitable and user friendly for engineering application regarding flammable cloud estimation since it is easier to find the reasonable hidden neuron number despite varied simulation inputs or input neuron numbers in order to check this conclusion 20 hidden neurons of brann are further employed for the following overall comparisons overall the overall comparative results from group 1 group 2 and group 3 are shown in table 1 coefficient determination r2 between all the simulation results 864 and predicted results are obtained for group 1 each ann or rsm of 24 parts is derived from the corresponding developing set and used to estimate the non simulation results of developing set and checking set then coefficient determination r2 between all the predicted results 864 deriving from the 24 parts and the simulation results 864 is calculated similar to group1 coefficient determination r2 under group 2 and group 3 can be further calculated it is worth noting that all the r2 of brann are developed based on 20 hidden neurons however for lmann and rsm the process to derive the r2 is relatively cumbersome since the sensitive analysis of neuron number in hidden layer or the order of the polynomial should be performed first then the optimal neuron numbers and order of the polynomial are determined to predict the non simulation results as can be seen in table 1 r2 derived by brann under 20 hidden layer is higher than that by lmann and rsm under optimal hidden neurons or order of polynomial that is due to the fact that compared to lmann brann can make full use of the limited simulations since it is not necessary to employ the validation set to avoid the overfitting problem relative to rsm brann can better mimic the complicated non linear relationship especially under such limited simulations it is therefore concluded that brann is more accurate and efficient compared to lmann and rsm additionally the 20 hidden neurons make the brann more user friendly in terms of flammable cloud estimation of this case study 4 4 comparison brann with fca since brann exhibits better generalization capacity in this part the authors conduct the comparison between brann with 20 hidden neurons and fca initially simulation under condition1 is performed subsequently 3 brann models generated by group 1 group 2 group 3 respectively and the fca are used to estimate the non simulation results under condition1 lastly the comparison between 3 brann models with fca is conducted while the simulation result under condition1 is viewed as the benchmark fca is proposed by dnv and it assumes that the fuel volume fraction is approximately proportional to the ratio e g leak rate ventilation rate for given dispersion or ventilation scenarios with this assumption if a q91 at leak rate a 1 and ventilation rate c 1 is estimated by using flacs to determine an unknown q92 at a different leak rate a 2 or ventilation rate c 2 the q92 is calculated by multiplying the q91 by a factor of a 2 c 1 a 1 c 2 gexcon 2015 fig 9 shows the comparison results between the simulation results and predicted results from these two methods when wind speed is 3 m s wind direction is 2700 and leak direction is x the results by fca when wind speed is 3 m s and the ventilation rate is 0 026 s 1 with varied leak rates i e 5 kg s 20 kg s 60 kg s 80 kg s are predicted by the given dispersion scenarios when wind speed is 1 5 m s multiplied by a factor of 0 5 when the ventilation rate is 0 013 s 1 additionally those results predicted by brann of group 1 16 simulation inputs group 2 64 simulation inputs and group 3 384 simulation inputs are also demonstrated in fig 9 as can be seen in fig 9 there is a significant difference between the simulation results and that by fca when wind speed is 1 5 m s under smaller leak rate i e 5 kg s comparatively those estimated results by brann with varied simulation inputs group 1 to group 3 are generally closer to those simulation results fig 10 also shows the comparison results of varied leak rates when wind speed is 6 m s wind direction is 2700 and leak direction is x a significant difference between the simulation results and that by fca when wind speed is 12 m s can be seen for all leak rates however the predicted results by brann with varied simulation inputs group 1 to group 3 and by fca when wind speed is 5 m s comparatively approach those simulation results 5 applications of different techniques case of floating drilling rig it is now known that brann with 20 hidden neurons is more robust and user friendly of those method i e lmann rsm and fca however in order to verify the conclusion the totally different platform namely the 7th generation semi submersible drilling rig is employed accordingly the comparison of those methods is conducted the structure of this part is organized as below 5 1 illustrates dispersion simulation modelling with flacs gexcon 2015 5 2 gives the ventilation and dispersion results under representative simulation conditions 5 3 shows the comparative results of brann lmann and rsm 5 4 further shows the comparative results between brann and fca 5 1 numerical modelling fig 11 shows the 3d view of this studied offshore platform the overall length width and height of the offshore platform are 115 m x 98 m y 120 m z respectively the platform consists of drilling module and accommodation module the drilling module is the focus of this study since it is prone to cause the natural gas blowing out in terms of both ventilation and dispersion simulations the simulation domain is x direction from 50 m to 150 m y direction from 50 m to 150 m and z direction from 0 m to 180 m the core region is x direction from 10 m to 110 m y direction from 0 m to 100 m and z direction 40 m 160 m the grid volume of core domain used for both ventilation simulations and dispersion simulations is 1 m and the stretched factor 1 2 is used from the core domain to simulation boundary based on convergence analysis of the grid volume it should be noted that for dispersion simulation grid refinements around the leak areas are performed to keep moderate calculation times while getting acceptable results based on the grid refinement guidance gexcon 2015 for both ventilation simulations and dispersion simulations wind is used on all inflow and parallel boundaries and nozzle is used at the outflow and sea surface boundaries in this case pasquill class d is used the atmospheric roughness length z 0 and the height relative to the ground z ref are set as 0 0002 and 10 m respectively additionally cflc 20 and cflv 2 are adopted which means sound wave propagates 2 control volumes while fluid flow propagates 20 cell volumes at one simulation time step length for the dispersion simulations the natural gas with a composition shows in table 2 is employed the leak position is assumed to the well bore on the north side since this wellbore is employed for the general drilling operation of this new 7th generation semi submersible offshore platform a constant leak rate i e 80 kg s is employed while the wind speed and wind direction are varied totally 20 dispersion simulations performed including 6 wind speeds i e 1 5 m s 3 m s 5 m s 6 m s 10 m s and 4 wind directions i e 00 900 1800 2700 5 2 dispersion simulations in this part representative dispersion results are analyzed fig 12 presents the dispersion results under wind speed is 5 m s and different wind directions fig 12a shows the q9 history profile under varied wind direction fig 12a 12 e demonstrate 3d plot of flammable cloud under 00 900 1800 2700 respectively at the time about 70s after leakage as can be seen in fig 12a the maximum q9 values under 900 and 2700 wind directions are comparatively larger that under 1800 because of the comparatively smaller ventilations furthermore the obstructions on the south side of the wellbore make significant contribution to the increment of q9 under wind direction 2700 5 3 comparison of brann with lmann and rsm total 20 simulations are simulated and then used for the predictive capacity comparison among brann lmann and rsm 12 of the total simulations are regarded as the developing set while the rest 8 simulations are used as the checking set for brann the developing set is randomly divided into two subsets namely training set 85 and test set 15 in terms of lmann the developing set consists of 3 subsets namely training set 70 test set 15 and validation set 15 noted that the developing set only includes the training set for rsm for both brann and lmann three layer neuron network is employed and tangent sigmoid activation function in hidden layer and linear function in output layer are adopted noted that 20 hidden neurons are directly used to develop the brann model still the coefficient determination r2 is regarded as the indicator for the comparison fig 13 shows the comparison results among brann lmann and rsm fig 13a is the coefficient determination r2 of developing set and checking set of lmann as can be seen the r2 of checking set initially increase and then decrease along with the increase of hidden neurons which indicates the overfitting problem occurs in despite of the validation set fig 13b shows the r2 of developing set and checking set of rsm from it one can see the r2 of checking set increases along with the incremental order of polynomial and the maximum r2 0 93 arrives under 5th order comparison between all the non simulation results predicted by varied model with highest r2 of checking set and the simulation results are summarized into fig 13c from fig 13c it is verified that brann with 20 hidden neurons is more efficient with such limited simulations of the 2nd offshore platform 5 4 comparison of brann with fca the results predicted by brann with 20 hidden neurons are further compared to those by fca fig 14 shows the comparison results between the simulation results and predicted results from these two methods when wind speed is 3 m s and 6 m s with varied wind directions fig 14a presents the results under 3 m s wind speed the results of 3 m s wind speed by fca are estimated according to 1 5 m s respectively from fig 14a a large deviation between those results by fca and simulation results can be seen for 4 wind directions fig 14b presents the results under 6 m s wind speed the results of 6 m s wind speed by fca are predicted based on 5 m s as is shows in fig 14b the deviations between those results by fca and simulation results under 00 and 1800 wind directions are comparatively larger generally from both fig 14a and b one can see the estimated results by brann with 20 hidden neurons are closer to the simulation results which further demonstrates the better generalization of brann compared to fca 6 conclusion this study presents detailed analysis of three data driven numerical simulation techniques two techniques are based on neural networks brann and lmann while third one is based on statistical analysis rsm a systematic methodology is adopted to train test and verify effectiveness of these techniques for dispersion modelling brann is identified to most efficient and robust numerical simulation technique for estimating flammable cloud dimensions a numerical model with 20 hidden neurons is proposed to study the dispersion of flammable cloud considering different operating parameters leak rate ventilation rate wind direction among others the developed methodology is applied to two case studies a fixed offshore platform and a semi submersible drilling rig this developed brann model consists of three layers namely input layer hidden layer and output layer the input layer contains n 4 input neurons which presents the combination of different operating parameters i e leak rate wind speed leak direction and wind direction the hidden layer comprises 20 hidden neurons while the output layer contains 1 output layer presents the flammable cloud volume besides the activation function is tangent sigmoid in hidden layer while linear function is employed in output layer from both case studies one can conclude that lmann and rsm are less robustness since the r2 of the checking set would significantly decrease along with the increase of the hidden neurons under certain simulation inputs input neurons moreover the maximum r2 of the checking set of lmann and rsm under the corresponding optimal hidden neuron or polynomial order are comparatively smaller than that of brann model in addition comparative results conducted between fca and brann demonstrate the less accuracy of fca under certain dispersion conditions and the robustness of the developed brann model the developed brann model supports the user friendly alternative to provide thousands of robust non simulation peak data for further eras further work should focus on improving this brann model by considering the transient variation of q9 q6 and flam acknowledgment this study was supported by national key r d program of china 2017yfc0804501 national key r d program of china 2016yfc0802305 the fundamental research funds for innovation program of seventh generation ultra deepwater drilling platform grant numbers 2016 24 the fundamental research funds for the central universities 18cx05010a fasial khan thankfully acknowledges the financial support provided natural sciences engineering council of canada nserc and canada research chair tier i program to help participate in this work 
23300,data driven models are increasingly used in engineering design and analysis bayesian regularization artificial neural network brann and levenberg marquardt artificial neural network lmann are two widely used data driven models however their application to study the dispersion in complex geometry is not explored this study aims to investigate the suitability of brann and lmann in estimating dimension of flammable cloud in congested offshore platform a large number of numerical simulations are conducted using flacs part of these simulations results are used to training the network the trained network is subsequently used to predict the vapor cloud dimension and compared against remaining simulation results the predictive abilities of these network along with response surface method and frozen cloud approach fca are studied the comparative results indicate brann model with 20 hidden neurons is the most robust and precise the developed brann would serve an effective and tool for quick explosion risk analysis era keywords bayesian regularization artificial neuron network response surface method frozen cloud approach overfitting problem better generalization 1 introduction gas dispersion simulation of offshore platform plays an essential role for explosion risk analysis era as it can be conducted to identify credible gas cloud volume gas concentrations and cloud locations and the simulation results can be viewed as the input for different simulations norsok 2010 iso 19901 3 2015 generally it is not feasible and acceptable to perform limited dispersion simulations as part of era large set of simulations is cost prohibitive two popular techniques namely frozen cloud approach fca and response surface methodology rsm are often employed to predict the acceptable non simulation flammable cloud volume for range of conditions this improves the efficiency of the risk analysis based on a limited number of computationally fluid dynamics simulations fca was initially proposed by dnv then widely used by many gexcon 2015 hansen and middha 2008 qiao and zhang 2010 to predict the flammable cloud volume in this technique linear relations amongst gas concentration leak rate and the wind speed for each leak scenario are assumed and data of gas cloud volume from the non numerically simulated scenarios are then obtained generally fca contributes to saving time and financial cost of era it can provide good prediction results for leakages in ventilation dominated regions moreover it can easily determine the time series of flammable cloud volume however fca may determine poor estimation under specific leakage condition e g leakage in the fuel dominated region gexcon 2015 rsm was firstly adopted by cleaver cleaver et al 1999 and then widely used to predict the flammable cloud volume ferreira and vianna 2014 however conventional rsm may cause overfitting problem this means the generated correlations may have a worse generalization for new input data even though higher coefficient of determination r2 for training data can be obtained robustness of these correlations are not be guaranteed although specific statistical methods are used to keep correlation avoid overfitting problem jihao et al 2017 there seems to a room to further improve the robustness and accuracy artificial neural network ann which computer based algorithm appears to have a better prospect in terms of flammable cloud volume estimation ann consists of a set of processing units that allow signals to travel in parallel as well as serially by connecting various neural adedigba et al 2017 it can mimic the complex non linear relationships between the inputs and outputs among various types of anns back propagation bp algorithm is widely used which uses the derivative of an error function to find the direction that minimizes the error of the network and then updates the weights accordingly however conventional bp algorithm also may cause overfitting problem especially under limited simulation data different regularization techniques are developed to overcome the overfitting problem among these techniques levenberg marquardt lm and bayesian regularization br are widely used because of their respective advantages demuth and beale 2009 baghirli 2015 kayri 2016 recently various researchers from different areas have compared the predictability lmann and brann brann is identified as better generalization in most cases baghirli 2015 kayri 2016 gianola et al 2011 kaur and salaria 2013 ticknor 2013 however in terms of flammable cloud volume prediction the more robust and efficient one is unknown since anns are sensitive to statistical properties of the input and output datasets varied volume and statistical properties additional issue employing ann is that it is difficult to determine the suitable hidden neuron numbers with varied inputs for general application in other words if employing ann the engineers should initially determine the suitable hidden neuron numbers along with the various inputs during the training process this is much labor intensity this study aims to determine the efficient techniques to estimate the flammable cloud volume in complex geometry such as the offshore platform using the identified technique a robust model is to be developed to estimate the flammable cloud volume the developed model is tested on a fixed and floating offshore facility the developed model is integral part of the era 2 artificial neuron network 2 1 multilayer perception with back propagation algorithm fig 1 shows the architecture of multi layer perception mlp with bp algorithm which is the basis to develop the brann and lmann as can be seen this architecture consists of three layers namely input hidden and output layers the input layer contains n neurons presenting n factors affecting the flammable cloud volume in this study n 4 since 4 main factors namely leak rate wind speed wind direction and leak direction are considered the neurons in hidden layer are varied while the output layer only contains 1 neuron presenting the maximum flammable cloud volume 2 2 bayesian regularization and levenberg marquardt algorithms the conventional mlp with bp algorithm may cause the overfitting problem i e lower bias but larger variance as an alternative brann has better generalization capacity since it minimizes a combination of squared errors e d and weights e w and then determine the optimal weight and objective function parameters α β as probability kayri 2016 the objective function for brann is shown as 1 f β e d α e w in brann the initial weights are randomly set with these initial weights the density function for the weights can be updated according to baye s rule 2 p w d α β m p d w β m p w α m p d α β m where d is the training sample m is the particular neural network model architecture adopted and w is the vector of network weights p w α m is the prior distribution of weights which presents our knowledge of the weights before any data is collected p d w β m is the likelihood function which is the probability of the occurrence given the weights w p d α β m is a normalization factor which can be expressed as equation 7 as below if gaussian distribution is assumed to the noise of training set data and weights the probability densities can be calculated as below 3 p d w β m 1 z d β exp β e d π β n 2 exp β e d 4 p w α m 1 z w α exp β e w π α n 2 exp β e w if we substitute these probabilities into eq 2 we obtain 5 p w d α β m 1 z w α 1 z d β exp β e d α e w p d α β m 1 z f α β exp f w in this brann the optimal weights should maximize the posterior probability maximizing the posterior probability p w d α β m is equivalent to minimizing the regularized objective function f foresee and hagan 1997 the joint posterior density 6 p α β d m p d α β m p α β m p d m maximizing the joint posterior above is determined by maximizing the likelihood function p d α β m which can be calculated by 7 p d α β m p d w β m p w α m p w d α β m z f α β π β n 2 π α m 2 where n is the number of observations input target simulation pairs and m is the total number of network parameters furthermore the parameter z f α β depends on the hessian of the objective function foresee and hagan 1997 which can be calculated below 8 z f α β e f w max h max where the subscript max indicates maximum a posteriori the hessian matrix h is calculated from the jacobian j 9 h j t j where the jacobian matrix contains the first derivatives of the network errors with respect to network parameters the lm algorithm shaneh and butler 2006 can be used to iteratively update the synaptic weights as follows 10 w k 1 w k h μ i 1 j t e where k is the iteration number and μ is the damping parameter which is summed to every member of the approximate hessian diagonal before the system is solved for the gradient after the synaptic weights are updated and determined the optimal values for α and β at minimum point can be calculated by 11 η w α t r h 1 12 β m η 2 e d 13 α η 2 e w where m is the total number of parameters in the network the parameter η is a measure of how many parameters in the neural network are effectively used in reducing the error function 3 methodology of model development and testing this section presents the structured framework to compare three data driven numerical models to study dispersion in congested geometry fig 2 shows the detailed steps which will be followed in subsequent applications step 1 numerical modelling and conducting dispersion simulations step 2 dividing all the dispersion simulations into two sets namely developing set and checking set the developing set is used to develop varied models while the checking set is to check the generalization of developed models furthermore for brann the developing set can be further categorized into two sets i e training set and test set while in terms of lmann validation set is also needed to avoid the overfitting problem however for rsm the developing set only contains the training set step 3 setting the number of hidden neuron or the order of correlation equal to 1 and developing the corresponding models coefficient determination r2 between estimated results and simulation results of developing set is subsequently calculated once the maximum r2 arrives the model is determined step 4 the generated model is then used to predict those results of checking set accordingly coefficient determination r2 between estimated results and simulation results of checking set is calculated step 5 changing the number of hidden neuron or the order of correlation and repetitively conducting step 3 and step 4 until n is equal to n eventually both r2 of developing set and checking set of each step 3 and step 4 are viewed as the indicator for comparison of each technique 4 applications of different techniques case of fixed offshore production platform in this study flacs flame acceleration simulator which is verified to be one of the most industry recognized 3d cfd software is used to model gas dispersion and to provide the benchmark data qiao and zhang 2010 vianna and cant 2012 huser and kvernvold 2000 patankar 1980 hansen et al 2013 a typical fixed offshore platform is used as the 1st case to compare different predictive techniques the structure of this part is organized as below 4 1 presents the dispersion numerical modelling 4 2 focuses on analyzing dispersion results under varied simulation conditions 4 3 shows the predictive comparison between brann lmann and rsm 4 4 also compares the predictive results by brann with those by fca 4 1 numerical modelling the offshore platform studied here and its corresponding technical details are available elsewhere jihao et al 2017 the overall length width and height of this platform are 25 m x 60 m y 40 m z respectively it mainly comprises of two modules namely process module and accommodation the process module has the dimensions of length 25 m width 24 m and height 10 m it consists of 3 deck levels i e the lower level the middle level and the upper level in which the middle level is the focus of this study since it is occupied by most of equipment and confined by the steel plates and accommodation module on x and y side different parameters that may affect the simulation results such as gas composition leak position leak rate leak direction wind speed and wind direction are considered here the gas composition and leak position are same with those in jihao et al jihao et al 2017 while transient leakage condition is considered here the time varying leak rate is generated by considering esd and blowdown system the esd valve is assumed to close within 30s after the initial leak is detected the blowdown valve is then opened 50s after the esd valve closes accordingly the transient leakage profile is calculated based on the formulations in spouge 1999 fig 3 shows the all the corresponding leak profiles under varied initial leak rates i e 5 kg s 10 kg s 20 kg s 40 kg s 60 kg s and 80 kg s for the following dispersion analysis the rest parameters alter e g leak rate considers 6 directions i e x x y y z z wind speed considers 6 values i e 1 5 m s 3 m s 5 m s 7 m s and 12 m s in addition it is worth to be noted that for typical engineering application at least 8 wind directions should be simulated however only 4 representative values i e 00 900 1800 2700 are utilized in this study in order to conduct the following comparisons among each method 4 2 ventilation and dispersion simulation ventilation simulation aims to generate a ventilation distribution and further identify which segment has worse ventilation rates and is prone to generate larger flammable cloud subsequently dispersion simulations are performed which can be used to determine flammable cloud volume and locations for further era the detailed ventilation condition setting subsequent ventilation results and dispersion condition setting can be seen in jihao et al 2017 which would not be illustrated in this part based on varied simulation scenarios above 864 dispersion simulations 4 leak rates 4 wind speeds 4 wind directions 6 leak directions are totally performed in this part typical dispersion results considering transient leak rates are analyzed fig 4 shows transient equivalent stoichiometric cloud volumes q9 of varied leak rates under different wind speeds when leak direction is x and wind direction is 2700 it should be noted that q9 is automatically calculated based on the concentration ratio of non uniform flammable cloud gexcon 2015 fig 4a 4 f are transient q9 results of varied leak rates under wind speeds 1 5 m s 3 m s 5 m s 6 m s 7 m s and 12 m s respectively as can be seen at least two peaks of q9 can be seen for large leak rate e g 60 kg s 80 kg s under varied wind speeds while only peak occurs for small leak rate e g 5 kg s 10 kg s the maximum q9 for all cases are summarized into fig 5 as can be seen the maximum q9 consistently decreases along with the increase of wind speed under smaller leak rates i e 5 kg s and 10 kg s while for medium leak rates e g 20 kg s and 40 kg s the maximum q9 initially increases and the decreases furthermore a general increase of the maximum q9 can be seen under large leak rate i e 60 kg s and 80 kg s the phenomena is attributed that for large leak rate under smaller wind speed the cloud concentration of the rich regions is larger than the explosion upper limit futhermore under medium wind speed the cloud of the rich regions is diluted which increases the flammable cloud volume i e q9 however with the increase of the wind speed further dilution leads to the increase of the lean parts of the cloud which thereby decreases the flammable cloud volume 4 3 comparison among brann lmann and rsm the total 864 simulations are used to compare the predictive capacity among brann lmann and rsm 384 of the total simulations which are viewed as developing set are used to train different methods while the rest 480 named checking set is to check their generalization to new simulation data it is to be noted that the developing set are randomly divided into two subsets namely training set 85 samples of the developing set and test set 15 for brann however in addition to training set 70 and test set 15 validation set 15 is also used for lmann to avoid overfitting problem braatz and hisken 2017 for rsm the developing set only contains the training set which means all the simulation results in developing set are used to develop the rsm model among the analysis three layer neuron network is used the neurons in both input layer and hidden layer are altered while the output layer contains only one neuron presenting maximum flammable cloud volume q9 the activation function is tangent sigmoid in hidden layer while linear function is employed in output layer to check the generalization of different methods along with varied simulation data input neurons and to subsequently determine the empirically efficient hidden neuron numbers polynomial order for rsm 3 groups are categorized group 1 divides the total simulations into 24 parts and each part contains varied combinations of leak rate and wind speed with one combination of leak direction and wind direction the combinations of leak rate and wind speed include 36 simulation data in which 16 simulations are viewed as the input data i e 4 leak rates 5 kg s 20 kg s 60 kg s and 80 kg s and 4 wind speeds 1 5 m s 5 m s 7 m s and 12 m s in group 1 2 input neurons presenting leak rate and wind speed are employed while the hidden neurons are varied accordingly for different hidden neuron 24 architectures are developed for each ann method for example if 3 hidden neuron number are used for brann totally 72 architectures are developed group 2 divides the total simulations into 4 parts and each part includes varied combinations of leak rate wind speed and wind direction with 4 leak directions all the combinations contain 144 simulations in which 64 simulations are regarded as the input data i e 4 leak rates 5 kg s 20 kg s 60 kg s and 80 kg s 4 wind speeds 1 5 m s 5 m s 7 m s and 12 m s and 4 wind directions 00 900 1800 2700 for each leak direction for group 2 3 input neurons presenting leak rate wind speed and wind direction are employed and 6 architectures are developed for specific number of hidden neuron number group 3 includes all the simulations in which 384 simulations are viewed as the input data i e 4 leak rates 5 kg s 20 kg s 60 kg s and 80 kg s 4 wind speeds 1 5 m s 5 m s 7 m s and 12 m s 4 wind directions 00 900 1800 2700 and 6 leak directions x x y y z z for group 3 4 input neurons presenting leak rate wind speed wind direction and leak direction are used before training codification is performed to transform the original value of leak rate wind speed and wind direction between 1 and 1 in order to decrease the effect of the different order of original values on simulation results 6 leak directions are coded as 1 x 2 x 3 y 4 y 5 z 6 z for brann and lmann while for rsm they are coded to the matrix jihao et al 2017 matlab r2017b is employed to train each method for each ann method the training process is stopped provided 1 the maximum number of iterations is reached 2 the performance has an acceptable level 3 the estimation error is below the target or 4 the lm μ parameter becomes larger than 1010 according to the structured framework in section 3 both r2 of developing set and checking set of 3 groups along with varied hidden neurons or polynomial orders are determined as follows group 1 the comparative results of representative one of 24 parts for group 1 among brann lmann and rsm are shown in fig 6 the simulation scenarios for the developing set are those shown in fig 4 i e 4 leak rates 5 kg s 20 kg s 60 kg s and 80 kg s and 4 wind speeds 1 5 m s 5 m s 7 m s and 12 m s under leak direction x and wind direction is 270 the checking sets include those simulation scenarios in fig 5 i e 2 leak rates 20 kg s and 60 kg s with 6 wind speeds 1 5 m s 3 m s 5 m s 6 m s 7 m s and 12 m s and 2 wind speeds 3 m s and 6 m s with 4 leak rates 5 kg s 20 kg s 40 kg s and 80 kg s under identical combination of leak direction x and wind direction 2700 fig 6a shows the r2 results of developing set and checking set of brann as can be seen the coefficient determination r2 of developing set becomes steady and approaches 1 with the increase of neuron numbers in the hidden layer meanwhile one can see the r2 of checking set also becomes stable and comes close to 0 9 along with the incremental neuron numbers fig 6b presents the results by lmann from fig 6b one can see the coefficient determination r2 of developing set approximates 1 with the increase of hidden neurons while the r2 for checking set firstly increases to the maximum and then decreases that indicates lmann causes the overfitting problem along with increasing the hidden neurons fig 6c shows the results by rsm as can be seen the r2 of developing set consistently increases while the r2 of training set initially increases and then decreases along with the increase of the order of polynomial that means overfitting problem also occurs for rsm it is also worth noted that the maximum r2 of checking set of both lmann and rsm are smaller than that of brann under 20 hidden neurons accordingly from the above results one can conclude brann is more robust and accurate under 16 simulation inputs 2 input neurons group2 the comparative results of group 2 between brann lmann and rsm are shown as below fig 7 shows the results of one of 6 parts the simulation scenarios for developing set are 4 leak rates 5 kg s 20 kg s 60 kg s and 80 kg s 4 wind speeds 1 5 m s 5 m s 7 m s and 12 m s and 4 wind directions 00 900 1800 2700 under leak direction x the checking set includes those simulation scenarios of 2 leak rates 20 kg s and 60 kg s with 6 wind speeds 1 5 m s 3 m s 5 m s 6 m s 7 m s and 12 m s and 4 wind directions 00 900 1800 2700 leak rates 5 kg s 20 kg s 40 kg s and 80 kg s with 2 wind speeds 3 m s and 6 m s and 4 wind directions 00 900 1800 2700 under identical leak direction x alike to group 1 the comparison results of group 2 shows that brann presents better generalization and more robustness than lmann and rsm under 64 simulation inputs 3 input neurons fig 7a is the results of brann which indicates no distinct decrease of the r2 of checking set can be seen even though the r2 of developing set is closed to 1 under 20 hidden neuron numbers fig 7 b shows the results of lmann which demonstrates the obvious decrease of the r2 of checking set occurs after 10 hidden neuron numbers furthermore the results of rsm are presented in fig 7 c from fig 7 c one can see the obvious decrease of the r2 of checking set after the 4th order of polynomial moreover it is also worth noted that the maximum r2 of checking set of both lmann and rsm are smaller than that of brann under 20 hidden neurons accordingly from the above results one can conclude brann is more robust and accurate under 64 simulation inputs 3 input neurons group3 fig 8 shows the comparative results of group 3 between brann lmann and rsm the sample scenarios for developing set are set by 4 leak rates 5 kg s 20 kg s 60 kg s and 80 kg s 4 wind speeds 1 5 m s 5 m s 7 m s and 12 m s 4 wind directions 00 900 1800 2700 and 6 leak directions x x y y z z the extra scenarios for checking set are 2 leak rates 20 kg s and 60 kg s and 6 wind speeds 1 5 m s 3 m s 5 m s 6 m s 7 m s and 12 m s with 24 combinations of wind directions and leak directions 2 wind speeds 3 m s and 6 m s and 4 leak rates 5 kg s 20 kg s 40 kg s and 80 kg s with 24 combinations of wind directions and leak directions as can been brann is more robust and accurate than another two methods namely lmann and rsm under 384 simulation inputs 4 input neurons fig 8a shows the results of brann which indicates r2 of checking set consistently increases and arrives the maximum 0 93 under 20 hidden neurons fig 8b presents the results of lmann as can be seen the decrease of r2 of checking set can be obviously seen after 20 hidden neurons which indicates overfitting problem occurs of lmann fig 8c demonstrates the results of rsm similar to lmann a distinct decrease of r2 of checking set occurs after the 3rd polynomial order which also indicates the occurrence of overfitting for rsm furthermore the maximum r2 0 90 of lmann under 20 hidden neurons and that 0 88 of rsm under the 3th order of polynomial are smaller than that of brann under 20 hidden neurons above all one can conclude that brann is more robust and accurate under 384 simulation inputs 4 input neurons from figs 6 8 it is worth noting that brann seems to be more suitable and user friendly for engineering application regarding flammable cloud estimation since it is easier to find the reasonable hidden neuron number despite varied simulation inputs or input neuron numbers in order to check this conclusion 20 hidden neurons of brann are further employed for the following overall comparisons overall the overall comparative results from group 1 group 2 and group 3 are shown in table 1 coefficient determination r2 between all the simulation results 864 and predicted results are obtained for group 1 each ann or rsm of 24 parts is derived from the corresponding developing set and used to estimate the non simulation results of developing set and checking set then coefficient determination r2 between all the predicted results 864 deriving from the 24 parts and the simulation results 864 is calculated similar to group1 coefficient determination r2 under group 2 and group 3 can be further calculated it is worth noting that all the r2 of brann are developed based on 20 hidden neurons however for lmann and rsm the process to derive the r2 is relatively cumbersome since the sensitive analysis of neuron number in hidden layer or the order of the polynomial should be performed first then the optimal neuron numbers and order of the polynomial are determined to predict the non simulation results as can be seen in table 1 r2 derived by brann under 20 hidden layer is higher than that by lmann and rsm under optimal hidden neurons or order of polynomial that is due to the fact that compared to lmann brann can make full use of the limited simulations since it is not necessary to employ the validation set to avoid the overfitting problem relative to rsm brann can better mimic the complicated non linear relationship especially under such limited simulations it is therefore concluded that brann is more accurate and efficient compared to lmann and rsm additionally the 20 hidden neurons make the brann more user friendly in terms of flammable cloud estimation of this case study 4 4 comparison brann with fca since brann exhibits better generalization capacity in this part the authors conduct the comparison between brann with 20 hidden neurons and fca initially simulation under condition1 is performed subsequently 3 brann models generated by group 1 group 2 group 3 respectively and the fca are used to estimate the non simulation results under condition1 lastly the comparison between 3 brann models with fca is conducted while the simulation result under condition1 is viewed as the benchmark fca is proposed by dnv and it assumes that the fuel volume fraction is approximately proportional to the ratio e g leak rate ventilation rate for given dispersion or ventilation scenarios with this assumption if a q91 at leak rate a 1 and ventilation rate c 1 is estimated by using flacs to determine an unknown q92 at a different leak rate a 2 or ventilation rate c 2 the q92 is calculated by multiplying the q91 by a factor of a 2 c 1 a 1 c 2 gexcon 2015 fig 9 shows the comparison results between the simulation results and predicted results from these two methods when wind speed is 3 m s wind direction is 2700 and leak direction is x the results by fca when wind speed is 3 m s and the ventilation rate is 0 026 s 1 with varied leak rates i e 5 kg s 20 kg s 60 kg s 80 kg s are predicted by the given dispersion scenarios when wind speed is 1 5 m s multiplied by a factor of 0 5 when the ventilation rate is 0 013 s 1 additionally those results predicted by brann of group 1 16 simulation inputs group 2 64 simulation inputs and group 3 384 simulation inputs are also demonstrated in fig 9 as can be seen in fig 9 there is a significant difference between the simulation results and that by fca when wind speed is 1 5 m s under smaller leak rate i e 5 kg s comparatively those estimated results by brann with varied simulation inputs group 1 to group 3 are generally closer to those simulation results fig 10 also shows the comparison results of varied leak rates when wind speed is 6 m s wind direction is 2700 and leak direction is x a significant difference between the simulation results and that by fca when wind speed is 12 m s can be seen for all leak rates however the predicted results by brann with varied simulation inputs group 1 to group 3 and by fca when wind speed is 5 m s comparatively approach those simulation results 5 applications of different techniques case of floating drilling rig it is now known that brann with 20 hidden neurons is more robust and user friendly of those method i e lmann rsm and fca however in order to verify the conclusion the totally different platform namely the 7th generation semi submersible drilling rig is employed accordingly the comparison of those methods is conducted the structure of this part is organized as below 5 1 illustrates dispersion simulation modelling with flacs gexcon 2015 5 2 gives the ventilation and dispersion results under representative simulation conditions 5 3 shows the comparative results of brann lmann and rsm 5 4 further shows the comparative results between brann and fca 5 1 numerical modelling fig 11 shows the 3d view of this studied offshore platform the overall length width and height of the offshore platform are 115 m x 98 m y 120 m z respectively the platform consists of drilling module and accommodation module the drilling module is the focus of this study since it is prone to cause the natural gas blowing out in terms of both ventilation and dispersion simulations the simulation domain is x direction from 50 m to 150 m y direction from 50 m to 150 m and z direction from 0 m to 180 m the core region is x direction from 10 m to 110 m y direction from 0 m to 100 m and z direction 40 m 160 m the grid volume of core domain used for both ventilation simulations and dispersion simulations is 1 m and the stretched factor 1 2 is used from the core domain to simulation boundary based on convergence analysis of the grid volume it should be noted that for dispersion simulation grid refinements around the leak areas are performed to keep moderate calculation times while getting acceptable results based on the grid refinement guidance gexcon 2015 for both ventilation simulations and dispersion simulations wind is used on all inflow and parallel boundaries and nozzle is used at the outflow and sea surface boundaries in this case pasquill class d is used the atmospheric roughness length z 0 and the height relative to the ground z ref are set as 0 0002 and 10 m respectively additionally cflc 20 and cflv 2 are adopted which means sound wave propagates 2 control volumes while fluid flow propagates 20 cell volumes at one simulation time step length for the dispersion simulations the natural gas with a composition shows in table 2 is employed the leak position is assumed to the well bore on the north side since this wellbore is employed for the general drilling operation of this new 7th generation semi submersible offshore platform a constant leak rate i e 80 kg s is employed while the wind speed and wind direction are varied totally 20 dispersion simulations performed including 6 wind speeds i e 1 5 m s 3 m s 5 m s 6 m s 10 m s and 4 wind directions i e 00 900 1800 2700 5 2 dispersion simulations in this part representative dispersion results are analyzed fig 12 presents the dispersion results under wind speed is 5 m s and different wind directions fig 12a shows the q9 history profile under varied wind direction fig 12a 12 e demonstrate 3d plot of flammable cloud under 00 900 1800 2700 respectively at the time about 70s after leakage as can be seen in fig 12a the maximum q9 values under 900 and 2700 wind directions are comparatively larger that under 1800 because of the comparatively smaller ventilations furthermore the obstructions on the south side of the wellbore make significant contribution to the increment of q9 under wind direction 2700 5 3 comparison of brann with lmann and rsm total 20 simulations are simulated and then used for the predictive capacity comparison among brann lmann and rsm 12 of the total simulations are regarded as the developing set while the rest 8 simulations are used as the checking set for brann the developing set is randomly divided into two subsets namely training set 85 and test set 15 in terms of lmann the developing set consists of 3 subsets namely training set 70 test set 15 and validation set 15 noted that the developing set only includes the training set for rsm for both brann and lmann three layer neuron network is employed and tangent sigmoid activation function in hidden layer and linear function in output layer are adopted noted that 20 hidden neurons are directly used to develop the brann model still the coefficient determination r2 is regarded as the indicator for the comparison fig 13 shows the comparison results among brann lmann and rsm fig 13a is the coefficient determination r2 of developing set and checking set of lmann as can be seen the r2 of checking set initially increase and then decrease along with the increase of hidden neurons which indicates the overfitting problem occurs in despite of the validation set fig 13b shows the r2 of developing set and checking set of rsm from it one can see the r2 of checking set increases along with the incremental order of polynomial and the maximum r2 0 93 arrives under 5th order comparison between all the non simulation results predicted by varied model with highest r2 of checking set and the simulation results are summarized into fig 13c from fig 13c it is verified that brann with 20 hidden neurons is more efficient with such limited simulations of the 2nd offshore platform 5 4 comparison of brann with fca the results predicted by brann with 20 hidden neurons are further compared to those by fca fig 14 shows the comparison results between the simulation results and predicted results from these two methods when wind speed is 3 m s and 6 m s with varied wind directions fig 14a presents the results under 3 m s wind speed the results of 3 m s wind speed by fca are estimated according to 1 5 m s respectively from fig 14a a large deviation between those results by fca and simulation results can be seen for 4 wind directions fig 14b presents the results under 6 m s wind speed the results of 6 m s wind speed by fca are predicted based on 5 m s as is shows in fig 14b the deviations between those results by fca and simulation results under 00 and 1800 wind directions are comparatively larger generally from both fig 14a and b one can see the estimated results by brann with 20 hidden neurons are closer to the simulation results which further demonstrates the better generalization of brann compared to fca 6 conclusion this study presents detailed analysis of three data driven numerical simulation techniques two techniques are based on neural networks brann and lmann while third one is based on statistical analysis rsm a systematic methodology is adopted to train test and verify effectiveness of these techniques for dispersion modelling brann is identified to most efficient and robust numerical simulation technique for estimating flammable cloud dimensions a numerical model with 20 hidden neurons is proposed to study the dispersion of flammable cloud considering different operating parameters leak rate ventilation rate wind direction among others the developed methodology is applied to two case studies a fixed offshore platform and a semi submersible drilling rig this developed brann model consists of three layers namely input layer hidden layer and output layer the input layer contains n 4 input neurons which presents the combination of different operating parameters i e leak rate wind speed leak direction and wind direction the hidden layer comprises 20 hidden neurons while the output layer contains 1 output layer presents the flammable cloud volume besides the activation function is tangent sigmoid in hidden layer while linear function is employed in output layer from both case studies one can conclude that lmann and rsm are less robustness since the r2 of the checking set would significantly decrease along with the increase of the hidden neurons under certain simulation inputs input neurons moreover the maximum r2 of the checking set of lmann and rsm under the corresponding optimal hidden neuron or polynomial order are comparatively smaller than that of brann model in addition comparative results conducted between fca and brann demonstrate the less accuracy of fca under certain dispersion conditions and the robustness of the developed brann model the developed brann model supports the user friendly alternative to provide thousands of robust non simulation peak data for further eras further work should focus on improving this brann model by considering the transient variation of q9 q6 and flam acknowledgment this study was supported by national key r d program of china 2017yfc0804501 national key r d program of china 2016yfc0802305 the fundamental research funds for innovation program of seventh generation ultra deepwater drilling platform grant numbers 2016 24 the fundamental research funds for the central universities 18cx05010a fasial khan thankfully acknowledges the financial support provided natural sciences engineering council of canada nserc and canada research chair tier i program to help participate in this work 
23301,recently the authors proposed the hybrid local domain free discretization and immersed boundary method ldfd ibm wu et al 2012 which can be used to solve the flow problem within complex domain with truly 2nd order accuracy wu 2017 as a non conforming mesh method ldfd ibm can be extended to handle the moving boundary problems in this paper the strategy of ldfd ibm for incompressible flows problems with moving boundary is presented the numerical tests are carried out to validate the method including the simulation of flows past single multiple moving objects keywords immersed boundary method ibm local domain free discretization ldfd moving boundary problem incompressible flow cartesian mesh method 1 introduction one of big challenges in computational fluid dynamics cfd is to simulate flows around moving complex bodies in classical numerical methods one usually resorts to the fitted body mesh strategies either using the fixed reference frame inertial reference frame or moving the reference frame with the moving body non inertial reference frame the first approach requires continuous re meshing around the body tezduyar et al 1992 which is very laborious and computationally expensive comparatively the second approach is more efficient and simpler for implementation and thus is often adopted in practice lu and dalton 1996 guilmineau and queutey 2002 however since the non inertial system is an accelerated reference system associated with the moving body in principle it cannot be applied to moving boundary problems with more than one bodies moving at different speeds to overcome these difficulties there are several numerical techniques were developed in the past decades for the simulation of flow in complex geometries with internal moving rigid bodies these methods can be roughly classified into two categories moving mesh methods and fixed mesh methods moving mesh methods represented by arbitrary lagrangian eulerian ale hirt et al 1974 method are basically deforming grid methods however the computational domain with highly complex geometry may result in distorted mesh and introduce errors therefore re meshing may still be needed in ale which is computationally expensive fixed mesh methods such as cartesian mesh methods can handle the moving boundary problems without the above mentioned drawbacks in these methods the fixed reference frame is adopted and the mesh is also fixed the moving objects are immersed in the fixed mesh and are allowed to move freely through the mesh lines one of the promising candidates is immersed boundary method peskin 1977 in this method the computational domain is covered by fixed eulerian mesh the solid boundary i e immersed boundary is represented by a set of lagrangian points the fluid flow equations are discretized on a cartesian mesh and a forcing term is added to the governing equations to compensate for the presence of any immersed boundaries as shown in eq 1 1 u t u u p 1 re δ u f b where an additional force f b is included in the momentum equation different ways of deriving the forcing term lead to different variants of ibm fadlun et al 2000 niu et al 2006 shu et al 2007 lee et al 2011 lee and you 2013 li et al 2016 etc according to mittal and iaccarino 2005 they can be divided into two categories i e the continuous forcing and discrete forcing approaches in the continuous forcing approach a smoothing technique such as dirac delta function peskin 2002 or a moving least square reconstruction process vanella and balaras 2009 is adopted in the information exchange between the lagrangian and eulerian points this approach can be implemented with relatively easy and well suited for elastic boundaries mittal and iaccarino 2005 these smoothing techniques may result in that the no slip boundary condition is not accurately satisfied niu et al 2006 the lack of high accuracy for the treatment near to the boundary may lead to smearing of boundary information therefore sharp representation of the immersed boundary becomes impossible this is usually not acceptable especially for the simulation of high reynolds number flows in which thin boundary layers need to be resolved accurately the discrete forcing approach on the other hand can capture the finer details of the immersed boundary thus the sharp representation can be obtained instead of forcing term being determined by a mechanical process force versus displacement or permeability as adopted in continuous forcing approach in discrete forcing approach the forcing term is derived from the estimating the velocity field and correcting the velocity of the mesh nodes near the immersed boundary to fit the boundary condition shu et al 2007 found that adding a body force in the momentum equations is equivalent to making a correction in the velocity field to enforce the no slip boundary condition the velocity correction should be considered as unknown which is determined by enforcing the no slip boundary condition because it is more suitable for flow with rigid boundaries and more stable in the implementation discrete forcing scheme gains its popularity recent years there are a lot of different discrete forcing schemes available in the literature mohd yusof 1997 uhlmann 2005 mittal et al 2008 yang and balaras 2006 roman et al 2009 nicolaou et al 2015 etc it is well known that when sharp interface immersed boundary method ibm is used for moving body problems there exists spurious force oscillations called sfos in most literatures near the solid bodies lee et al 2011 identified two main sources of spurious oscillations i temporal discontinuity for those mesh nodes where the solid becomes fluid or verse vice called change of status in present paper when the boundary is moving ii spatial discontinuity in the pressure field in order to reduce the sfos uhlmann 2005 used the combination of regularized delta function in direct forcing approach yang and balaras 2006 adopted a field extension technique in which the velocity and pressure at the grid nodes where change of status occurs were obtained by an extrapolation from adjacent fluid grid points seo and mittal 2011 applied cut cell method to improve local mass conservation and reduce sfos lee et al 2011 proposed the addition of a mass source sink inside the solid to suppress the sfos on collocated grids nicolaou et al 2015 adopted the same idea but applied it on staggered grids and throughout the solid region most of these methods based on the finite volume method therefore calculation of the flux of the status changed cells or re construction of new polyhedral cells near the moving boundary can be very complicated therefore a simple and stable scheme for moving boundary problems is still needed the original local domain free discretization ldfd developed by the authors shu and wu 2006 belongs to the discrete forcing ibm the concept of dfd method shu and wu 2002 is based on the mathematical fact that the solution inside the domain can be extended to the outside of the fluid domain in the ldfd cartesian mesh solver the second order finite difference fd schemes are adopted for numerical discretization the boundary conditions of the curved embedded boundaries are enforced by a local extrapolation process which determines the values of flow variables at the mesh nodes that are adjacent to embedded boundaries but locate on the outside of flow field the neumann boundary condition for the pressure can be implemented by calculation of the local momentum equation on the normal direction to the boundary with this idea one can solve the problems with complex geometries on a non conforming structured mesh with or without moving boundaries shu and wu 2006 wu and shu 2008 however the extrapolation and implementation of the pressure boundary condition may bring in complexity and numerical instabilities recently the authors presented the hybrid local domain free discretization and immersed boundary method ldfd ibm and successfully apply it to stationary bodies problems wu et al 2012 wu 2017 like the continuous forcing approach the discretization of ldfd ibm is applied to the whole calculation domain including the solid bodies the pressure is obtained naturally by solving the n s equations using the fractional step technique therefore no tedious process is needed to handle with the neumann boundary condition for the pressure along the normal direction of the solid boundary it is the advantage over many approaches in the category of discrete forcing ibm as a sharp interface immersed boundary method ldfd ibm also overcomes the drawback of the ibm based on the ghost cell or extrapolation point in which the extrapolation stencil has to be used on the contrary this method uses interpolation scheme to update velocity near the boundary and no slip boundary condition can be satisfied accurately it has been demonstrated that it has truly second order accuracy on the whole computational domain and can be applied to multiply bodies problem very well wu 2017 since ldfd ibm solves the n s equation on the whole domain regardless the solid and fluid there is no temporal and spatial discontinuities involved however the geometric and kinematic change of the moving interface between fluid and solid has to be considered it is interesting to investigate if ldfd ibm is a suitable candidate for the moving boundary problems in this paper the strategy of ldfd ibm for moving boundary problems is presented after that the method is applied to study the fluid dynamics of flows past single multiple moving objects 2 methodology and procedure of ldfd ibm for moving boundary problems 2 1 status changes in moving boundary problems ldfd ibm is a discretization scheme based on finite difference method in this paper it is applied on cartesian mesh which is illustrated by fig 1 in this method the fixed reference frame is adopted and the mesh is also fixed the moving objects are immersed in the fixed mesh and are allowed to move freely through the mesh lines for simplicity we assume that the mesh is uniform and the mesh spacing in both the x and y directions are the same suppose that the solution of a problem is expressed by u x y in fig 1 the solid curve represents the solid boundary at current time step and dashed curve represents the solid boundary at adjacent time step the mesh nodes inside the fluid domain named interior node are represented by solid circles such as c0 c1 in fig 1a while the mesh nodes outside the fluid domain named exterior nodes are represented by shaded circles such as e1 e2 in fig 1a there are two types of mesh nodes in the immediate neighborhood of solid boundary and we call them dependent points if the dependent point is located in the fluid domain it is termed an interior dependent point represented by empty square such as b1 b2 in fig 1a and if the dependent point is located outside of fluid domain it is termed an exterior dependent point represented by empty circle such as a1 a2 in fig 1a the small solid squares on the boundary are points intersected by the mesh lines and boundary curve which are called intersection points such as points p1 p2 p3 p4 in fig 1a if an intersection point coincides with a mesh node such as a4 and p4 in fig 1a the mesh node is considered as an exterior dependent point whose variable values are determined by the boundary conditions at solid object in ldfd ibm we use status of mesh node to identify if that the node is located in the fluid domain or in the solid body these statuses can be defined as see fig 1a status 1 represents the interior point which is in the fluid domain and not adjacent to the solid boundary such as c0 in fig 1a status 2 represents the interior dependent point near the immersed boundary and inside the fluid domain such as b2 in fig 1a status 3 represents the exterior dependent point near the immersed boundary but being inside of the solid body such as a2 in fig 1a status 4 represents the outside point which is located in the solid body but not adjacent to the solid boundary such as e2 in fig 1a from the implementation point of view the main difference between flows with stationary boundaries as shown in paper wu et al 2012 and flows with moving boundaries lies in the fact that during the computation the status of nodes changes in the latter but remains the same in the former this is because when the solid body is moving the position of the boundary on the cartesian mesh changes with the time as shown in fig 1 the position of boundary changes from x n at the time level n fig 1a to x n 1 at the time level n 1 fig 1b and consequently the status of the mesh nodes changes such as the statuses of mesh nodes a1 a2 a3 are changed when the boundary moves the movement of the solid objects causes the status change of mesh nodes in the domain for the moving boundary simulation the following two typical situations may occur situation 1 status changed from solid to fluid as shown in fig 1 a suppose the position of the boundary at the time level n is represented by the solid curve and the boundary at the time level n 1 is represented by the dashed curve from the time level n to n 1 the status of a2 is changed from solid an exterior dependent node at the time level n to fluid an interior dependent node at the time level n 1 i e statusn a2 3 status n 1 a2 2 consequently we have statusn b2 2 status n 1 b2 1 statusn d2 4 status n 1 d2 3 statusn c2 1 and statusn e2 4 keep no change situation 2 status changed from fluid to solid as shown in fig 1 b again the solid curve denotes the boundary at the time level n the dashed curve denotes the boundary at the time level n 1 then from the time level n to n 1 the status of a2 is changed from fluid interior dependent node at the time level n to solid exterior dependent node at the time level n 1 i e statusn a2 2 status n 1 a2 3 consequently statusn b2 1 status n 1 b2 2 statusn d2 3 status n 1 d2 4 statusn c2 1 and statusn e2 4 keep no change it is also found that the locations of intersection points are changed with the moving boundary as shown in fig 1b when the boundary at time level n which represented by the dashed curve moves to the position at time level n 1 represented by the solid line the intersection points such as points p1 p2 p3 p4 at the time level n change into points q1 q2 q3 q4 at the time level n 1 therefore it is necessary to calculate the position of the intersection points every time step to identify the status change of mesh nodes is an important step in ldfd ibm since ldfd ibm uses regular cartesian mesh so identification of the status of the mesh nodes is similar to the image processing operations in computer graphics cg where pixels in some region of an image are assigned a label or called change color there are some fast cg algorithms in cg available such as scan line polygon fill algorithm for two dimensional case and seed fill algorithm for three dimensional case foley 1996 in this paper the odd even parity method developed based on scan line polygon fill algorithm by the authors wu and shu 2008 is adopted to detect the status change of mesh nodes for the moving boundary problems 2 2 solution procedure of ldfd ibm for moving boundary problems similarly as in the case of stationary body wu 2017 the fractional step method is employed to couple the momentum equations and the continuity equation in solving the n s equations the solution procedure is also similar to the ldfd ibm method for stationary body problem wu 2017 as shown in the following here the time derivative is discretized via euler explicit scheme for the convenience of analysis the solution procedure is as shown in the following 2 u n 1 u n δ t h u n g p n 1 re l u n f b 3 u u n 1 δ t g p n combining the continuity equation d u n 1 0 and take gradient of eq 3 then the pressure poisson equation is derived to correct the velocity as 4 l p n 1 1 δ t d u finally the velocity u n 1 is updated by the solution of pressure equation 4 5 u n 1 u δ t g p n 1 where h denotes the discrete advection operator g is the discrete gradient operator l the discrete laplacian operator d is the divergence operator an additional force f b is compensation forcing term for the presence of the immersed boundaries in ibm it should be noted that in stationary body problem when solving eqs 2 5 the calculation of additional force f b is not required updating the velocities at the interior and exterior dependent points is equivalent to add the force f b implicitly wu 2017 however in the moving boundary problems due to the change of the position and velocity of the moving objects we have to adopt different strategy as indicated in ref lee et al 2011 the change of node status may result in the temporal discontinuity during the discretization of the time derivative for example when solid nodes become fluid nodes we need to know the flow variables values for these new fluid nodes at the previous time level this poses a challenge for the traditional discrete forcing ibm because they were solid nodes at that time and had no time history of the fluid variables such as velocity and pressure for the ldfd ibm because the variables at every mesh node are calculated by solving the governing equations they are the approximate solutions of n s equation at any time step the time history of variables for each node has been recorded therefore the temporal discontinuity is not to be a problem however due to the interface between solid and fluid is moved the changes of status and velocity of the mesh nodes have to be considered for the moving boundary problems it includes the simultaneous update of the velocity and the location of the moving boundaries in fig 1 suppose that at the time level n the boundary is located at position x n solid line in fig 1a with velocity u b n at the time level n 1 the boundary moves to position x n 1 solid line in fig 1b with velocity u b n 1 here we take a2 in fig 1 as example again from the time level n to n 1 the status of a2 is changed from an exterior dependent node solid at the time level n to an interior dependent node fluid at the time level n 1 i e statusn a2 3 status n 1 a2 2 here we consider the two following effects of moving object separately 1 the effect from the change of the position of the boundaries which we call the geometric effect since it only corresponds to the change of location of boundaries 2 the effect from the change of the velocity of the boundaries which we call the kinematic effect therefore the procedure of ldfd ibm for solving moving boundary problems i e how to solve the momentum equation eq 2 basically consists of two steps step 1 estimate the flow field by considering the change in the position of the moving object only in this step we only consider the geometric effect suppose that the solutions of n s equations such as u n and p n are known we modify the velocity field from u n to u ˆ n at time level n to account for the location change of the boundaries 1 change the status of mesh nodes according to the new position of boundary x n 1 as described in situation 1 in last section 2 keep the velocity unchanged for mesh nodes with status 1 i e interior nodes i e u ˆ n u n 3 set the velocity at mesh nodes with status 4 i e exterior nodes not adjacent to the boundary x n 1 and status 3 i e exterior dependent points to u b n i e u ˆ n u b n the velocity at boundary points which are the intersection of the boundary and the mesh lines i e lagrangian points in conventional ibm such as q2 in fig 1b is also set as u ˆ n u b n 4 to determine the velocity at those nodes with status 2 i e interior dependent nodes such as a2 in fig 1b use 3 point lagrange interpolation scheme below 6 u ˆ a 2 n y a 2 y b 2 y a 2 y c 2 y q 2 y b 2 y q 2 y c 2 u ˆ q 2 n y a 2 y c 2 y a 2 y q 2 y b 2 y c 2 y b 2 y q 2 u ˆ b 2 n y a 2 y q 2 y a 2 y b 2 y c 2 y q 2 y c 2 y b 2 u ˆ c 2 n from eq 6 it is found that there are three determining factors for the interpolation scheme i e the position of boundary x n 1 such as y q 2 the velocity at the mesh nodes with status 1 u ˆ n u n such as u ˆ b 2 n u b 2 n u ˆ c 2 n u c 2 n and the velocity at intersection points u ˆ n u b n such as u ˆ q 2 n u b n q 2 thus we can use interpolation x n 1 u n u b n to represent the interpolation value take mesh node a2 as an example if status a2 2 then interpolation x n 1 u n u b n can be written as 7 u ˆ a 2 n i n t e r p o l a t i o n x n 1 u n u b n x y a 2 y b 2 y a 2 y c 2 y q 2 n 1 y b 2 y q 2 n 1 y c 2 u b n q 2 y a 2 y c 2 y a 2 y q 2 n 1 y b 2 y c 2 y b 2 y q 2 n 1 u b 2 n y a 2 y q 2 n 1 y a 2 y b 2 y c 2 y q 2 n 1 y c 2 y b 2 u c 2 n v ˆ a 2 n i n t e r p o l a t i o n x n 1 u n u b n y y a 2 y b 2 y a 2 y c 2 y q 2 n 1 y b 2 y q 2 n 1 y c 2 v b n q 2 y a 2 y c 2 y a 2 y q 2 n 1 y b 2 y c 2 y b 2 y q 2 n 1 v b 2 n y a 2 y q 2 n 1 y a 2 y b 2 y c 2 y q 2 n 1 y c 2 y b 2 v c 2 n therefore the modified velocity field u ˆ n at time level n can be written as 8 u ˆ i n u i n if status i x n 1 1 i n t e r p o l a t i o n x n 1 u n u b n u b n if status i x n 1 2 if status i x n 1 3 or 4 it should be noted that the velocity at interior dependent points needs to be updated by interpolation such as eq 7 at least once either along the x direction or along the y direction if there are two intersection points in its vicinity one is on x direction the other is on y direction then two distinct approximate solutions may be obtained at a certain interior dependent point in our study to uniquely determine the value at these interior dependent points we choose to use the average of approximate solutions from the x and y directions based on this modified velocity field u ˆ n we estimate the velocity field u ˆ n 1 at time level n 1 by only considering the geometric effect of moving boundary via solving the following equation 9 u ˆ n 1 u ˆ n δ t h u n g p n 1 re l u n it should be noted that there is no force term presented in eq 9 i e in this step f b 0 in other words u ˆ n 1 is calculated only considering the location change of the boundary step 2 estimate the flow field by considering the change in the velocity of the moving object in this step we include the kinematic effect into consideration i e the velocity of the object is changed from u b n to u b n 1 at the same position x n 1 this effect can be represented by an additional force term f b calculated by 10 f b n 1 u b n 1 u ˆ n 1 δ t the approximate velocity field at time level n 1 u b n 1 is firstly obtained by the following equation 11 u b n 1 u i n if status i x n 1 1 i n t e r p o l a t i o n x n 1 u n u b n 1 if status i x n 1 2 u b n 1 if status i x n 1 3 or 4 where the formula of i n t e r p o l a t i o n x n 1 u n u b n 1 has the similar meaning as eq 7 still take a2 as an example the formula can be written as 12 u b n 1 a 2 i n t e r p o l a t i o n x n 1 u n u b n 1 x y a 2 y b 2 y a 2 y c 2 y q 2 n 1 y b 2 y q 2 n 1 y c 2 u b n 1 q 2 y a 2 y c 2 y a 2 y q 2 n 1 y b 2 y c 2 y b 2 y q 2 n 1 u b 2 n y a 2 y q 2 n 1 y a 2 y b 2 y c 2 y q 2 n 1 y c 2 y b 2 u c 2 n v b n 1 a 2 i n t e r p o l a t i o n x n 1 u n u b n 1 y y a 2 y b 2 y a 2 y c 2 y q 2 n 1 y b 2 y q 2 n 1 y c 2 v b n 1 q 2 y a 2 y c 2 y a 2 y q 2 n 1 y b 2 y c 2 y b 2 y q 2 n 1 v b 2 n y a 2 y q 2 n 1 y a 2 y b 2 y c 2 y q 2 n 1 y c 2 y b 2 v c 2 n finally we correct the velocity field at time level n 1 u n 1 by solving the momentum equation with the additional force f b 13 u n 1 u ˆ n 1 δ t h u ˆ n g p n 1 re l u ˆ n f b n 1 generally this solution procedure can be used for both the flow problems with moving and stationary boundaries for the flow problem with stationary boundaries since there is no status change for the mesh nodes u ˆ n u n eq 13 becomes the same as eq 9 therefore only in this situation step 1 and step 2 mentioned above can be combined into one step as described in simulation of flow past stationary objects by ldfd ibm in the authors previous papers wu 2017 note that the force term f b in eq 10 is simply a newtonian acceleration at time level n 1 if the trajectory of the moving object is prescribed say x x e t the acceleration of solid body can be obtained directly i e 14 a d 2 x e d t 2 eq 14 can be used to replace eq 10 as the force term in eq 13 for the exterior dependent nodes and exterior nodes because they are supposed to have the same speed as the moving object however when one considers more general cases we still need to calculate f b according to eq 10 after solving eq 13 one can follow the fractional step technique to obtain the velocity and pressure field at time level n 1 according to eq 3 5 wu 2017 thus the basic procedure of the ldfd ibm for solving moving boundary problems can be summarized by the following sequence advancing the solution from n to n 1 time level 1 use the solution at the n time level to initialize the velocity and pressure fields u n p n initially set f b as zero if t 0 2 determine the new position of the immersed object x n 1 if the trajectory of the moving object is prescribed this job can be easily done 3 determine the status of the mesh nodes when the moving object is at position x n 1 4 obtain the modified velocity field u ˆ n via eq 8 and solve for u ˆ n 1 from eq 9 without any force term 5 solve for u n 1 from eq 13 in which f b is added via eq 10 or eq 14 if the trajectory of the moving object is prescribed 6 solve eq 3 5 in the whole flow field to get u n 1 p n 1 3 application of ldfd ibm to moving boundary problems in this section the ldfd ibm s strategy for moving boundary problems is used to simulate flow problems with the single oscillating object as well as multiple moving bodies like in stationary boundary problems the application of ldfd ibm to the moving boundary problems uses the second order finite difference scheme for the approximation of spatial derivatives and the explicit three step formulation wu 2107 for the approximation of the time derivative 3 1 flow past an oscillating circular cylinder the problem of a cylinder oscillating laterally cross flow in the free stream is a classic flow problem with moving boundaries there are various experimental and numerical investigations available lu and dalton 1996 guilmineau and queutey 2002 the computational domain is shown in fig 2 where d is the diameter of the cylinder an initial uniform cartesian mesh of 161ⅹ121 is used as the background mesh after 8 levels of mesh refinement with stencil refinement technique described in the paper ding and shu 2006 the final mesh has a total of 54002 nodes as shown in fig 3 note that the finest mesh covers the area where the oscillating cylinder moves the circular cylinder is moved vertically with the speed v t 15 v t d y e d t where y e a e sin 2 π f e t with a e and f e are the oscillating amplitude and excitation frequency respectively f e is very important for the flow structure the synchronization phenomenon has been observed in the wake of the cylinder when the frequency of vortex shedding in the wake synchronizes with the frequency of an imposed perturbation i e this kind of synchronization occurs around f e f o 1 where f e is the excitation frequency and f o is the vortex shedding frequency from the stationary cylinder in this work ldfd ibm is used to perform calculations for re 185 a e d 0 2 where d is the diameter of the cylinder the range of f e f o 1 1 1 12 1 2 is considered all the simulations start from the flow past a non oscillating cylinder until the vortex shedding reaches to the stable state therefore the field information of the flow past a non oscillating cylinder at re 185 is obtained via the simulation of ldfd ibm for stationary case first as shown in table 1 the flow parameters agree with other experimental and numerical results very well from this the value of f o can be calculated and is used in the following simulation for the moving cylinder after that the simulation for the flow past an oscillating cylinder can be performed the boundary conditions of the problem are 1 at the inlet a free stream velocity profile is specified that is 16 u 1 v 0 2 on the cylinder surface no slip boundary condition is implemented by 17 u 0 v 0 3 on the top and bottom boundary the symmetric boundary condition is applied that is 18 u y 0 v 0 4 at the far field downstream boundary of the cylinder the zero gradient boundary condition is applied by 19 u x 0 v x 0 the time evolution of the flow field can be quantitatively represented by the variation of the drag and lift coefficients at the surface of body which are defined by 20 c d f d 1 2 ρ u 2 d c l f l 1 2 ρ u 2 d where d is the diameter of cylinder ρ is the fluid density and u is the characteristic velocity in this case it is the free stream velocity f d is the drag force and f l is the lift force acting on the circular cylinder in this study the dynamic force acting on surface of cylinder can be computed by integrating the local pressure and stress distributions along the cylinder surface which can be written as 21 f f x f y f d f l s b p n t n d s where p is the pressure n n x n y is the surface unit normal vector the subscripts x and y denote the x direction and y direction respectively t is the stress tensor and sb is the surface of solid body the drag force and lift force is the x and y component of the dynamic force as shown in eq 21 fig 4 6 show the drag and lift coefficients for different values of f e f o obtained by ldfd ibm it is found that the drag and lift coefficients exhibit regular signs of the influence of a higher harmonic wave as the excitation frequency increases the beating frequency decreases the common sfos exist in the simulating results from some discrete forcing ibm are much reduced in ldfd ibm table 2 compared the present results with those of guilmineau and queutey 2002 it is found that they are agree very well with each other it demonstrates that the moving boundary strategies of ldfd ibm is simple as well as stable 3 2 two cylinders moving with respect to each other to demonstrate the ability of present method to simulate flows past multiple moving objects the flow past two cylinders moving with respect to one another is selected this example was originally investigated numerically by russell and wang 2003 and xu and wang 2006 the initial geometry for this test is shown in fig 7 the computational parameters and the boundary conditions are the same as those in xu and wang 2006 the far field boundary conditions are rigid walls to avoid the impulsive start of the cylinders both cylinders are oscillated about their initial positions for two periods 16 s and then towards to each other at a speed corresponding to re 40 the motion of the lower cylinder is given by 22 x l c 4 π sin π t 4 0 t 16 t 16 16 t 32 and the motion of the upper cylinder is given by 23 x u c 16 4 π sin π t 4 0 t 16 32 t 16 t 32 in this simulation we used two different mesh sizes type i coarse mesh an initial uniform cartesian mesh of 241ⅹ121 is used as the background mesh the cartesian mesh is refined by the stencil adaptive mesh refinement algorithm introduced in ref ding and shu 2006 after 4 levels of mesh refinement the final mesh has a total of 145110 nodes the finest level of mesh covers the area where the oscillating cylinders move the mesh nodes distribution is shown in fig 8 type ii fine mesh an initial uniform cartesian mesh of 481ⅹ241 is used as the background mesh after 4 levels of mesh refinement the final mesh has a total of 574942 nodes the mesh nodes distribution is similar as fig 8 fig 9 shows the evolution of lift and drag coefficients calculated via eq 20 for the upper cylinder versus time the results from xu and wang 2006 are also included for comparison it is found that our results for c l number agree with those of xu and wang 2006 very well but for c d although the trend of the curve is similar as that of xu and wang 2006 there is a gap between present results and those from xu and wang 2006 to investigate the difference we conducted the grid independence study for our simulation it is found in fig 9 that very good agreement between two mesh sizes is observed for present method therefore the possibility of any errors caused by the mesh is eliminated since there exists no benchmark solution for this problem the difference between our results and those from xu and wang 2006 may due to the different implementation of the simulations or post processing of the results it is found from fig 9 that when two cylinders approach each other there is an increase in drag implying that the 2 cylinders are repulsive to each other when they move in close proximity there is a drop in drag which means that they are attractive to each other the drag then rises back when they move away figs 10 and 11 present the vorticity and pressure contours of ldfd ibm results when the two cylinders are closest to each other at t 24 and figs 12 and 13 shows the vorticity and pressure field at t 32 when the cylinders are separated from each other by a distance of 16 compared with the contours from xu and wang 2006 it is found that our results agree with those of xu and wang 2006 very well it demonstrates that performance of the present ldfd ibm moving boundary solvers for simulating the multi bodies moving problems is satisfied 4 conclusions the strategy of the ldfd ibm for simulating the moving boundary problems is presented in this paper the consideration of position and velocity of the moving boundaries and the status change of the mesh nodes plays a very important role in designing the solution procedures for moving boundary problems a two step forcing procedure is adopted in ldfd ibm to consider geometric changing effect as well as the kinematic changing effect of the moving objects compared with other discrete forcing ibm in which complicate procedures are needed to deal with those temporal and spatial discontinuity across the immersed boundaries ldfd ibm can be implemented easily and accurately the present method has been applied to some typical problems of flows with single multiple moving bodies the good agreement between present numerical results and available data in the literatures shows the good accuracy and robustness of ldfd ibm it demonstrates that ldfd ibm is a promising method to solve the moving boundary problems acknowledgements support from national natural science foundation of china grand no 11621202 and the fundamental research funds for the central universities grand no wk2090000009 are gratefully acknowledged 
23301,recently the authors proposed the hybrid local domain free discretization and immersed boundary method ldfd ibm wu et al 2012 which can be used to solve the flow problem within complex domain with truly 2nd order accuracy wu 2017 as a non conforming mesh method ldfd ibm can be extended to handle the moving boundary problems in this paper the strategy of ldfd ibm for incompressible flows problems with moving boundary is presented the numerical tests are carried out to validate the method including the simulation of flows past single multiple moving objects keywords immersed boundary method ibm local domain free discretization ldfd moving boundary problem incompressible flow cartesian mesh method 1 introduction one of big challenges in computational fluid dynamics cfd is to simulate flows around moving complex bodies in classical numerical methods one usually resorts to the fitted body mesh strategies either using the fixed reference frame inertial reference frame or moving the reference frame with the moving body non inertial reference frame the first approach requires continuous re meshing around the body tezduyar et al 1992 which is very laborious and computationally expensive comparatively the second approach is more efficient and simpler for implementation and thus is often adopted in practice lu and dalton 1996 guilmineau and queutey 2002 however since the non inertial system is an accelerated reference system associated with the moving body in principle it cannot be applied to moving boundary problems with more than one bodies moving at different speeds to overcome these difficulties there are several numerical techniques were developed in the past decades for the simulation of flow in complex geometries with internal moving rigid bodies these methods can be roughly classified into two categories moving mesh methods and fixed mesh methods moving mesh methods represented by arbitrary lagrangian eulerian ale hirt et al 1974 method are basically deforming grid methods however the computational domain with highly complex geometry may result in distorted mesh and introduce errors therefore re meshing may still be needed in ale which is computationally expensive fixed mesh methods such as cartesian mesh methods can handle the moving boundary problems without the above mentioned drawbacks in these methods the fixed reference frame is adopted and the mesh is also fixed the moving objects are immersed in the fixed mesh and are allowed to move freely through the mesh lines one of the promising candidates is immersed boundary method peskin 1977 in this method the computational domain is covered by fixed eulerian mesh the solid boundary i e immersed boundary is represented by a set of lagrangian points the fluid flow equations are discretized on a cartesian mesh and a forcing term is added to the governing equations to compensate for the presence of any immersed boundaries as shown in eq 1 1 u t u u p 1 re δ u f b where an additional force f b is included in the momentum equation different ways of deriving the forcing term lead to different variants of ibm fadlun et al 2000 niu et al 2006 shu et al 2007 lee et al 2011 lee and you 2013 li et al 2016 etc according to mittal and iaccarino 2005 they can be divided into two categories i e the continuous forcing and discrete forcing approaches in the continuous forcing approach a smoothing technique such as dirac delta function peskin 2002 or a moving least square reconstruction process vanella and balaras 2009 is adopted in the information exchange between the lagrangian and eulerian points this approach can be implemented with relatively easy and well suited for elastic boundaries mittal and iaccarino 2005 these smoothing techniques may result in that the no slip boundary condition is not accurately satisfied niu et al 2006 the lack of high accuracy for the treatment near to the boundary may lead to smearing of boundary information therefore sharp representation of the immersed boundary becomes impossible this is usually not acceptable especially for the simulation of high reynolds number flows in which thin boundary layers need to be resolved accurately the discrete forcing approach on the other hand can capture the finer details of the immersed boundary thus the sharp representation can be obtained instead of forcing term being determined by a mechanical process force versus displacement or permeability as adopted in continuous forcing approach in discrete forcing approach the forcing term is derived from the estimating the velocity field and correcting the velocity of the mesh nodes near the immersed boundary to fit the boundary condition shu et al 2007 found that adding a body force in the momentum equations is equivalent to making a correction in the velocity field to enforce the no slip boundary condition the velocity correction should be considered as unknown which is determined by enforcing the no slip boundary condition because it is more suitable for flow with rigid boundaries and more stable in the implementation discrete forcing scheme gains its popularity recent years there are a lot of different discrete forcing schemes available in the literature mohd yusof 1997 uhlmann 2005 mittal et al 2008 yang and balaras 2006 roman et al 2009 nicolaou et al 2015 etc it is well known that when sharp interface immersed boundary method ibm is used for moving body problems there exists spurious force oscillations called sfos in most literatures near the solid bodies lee et al 2011 identified two main sources of spurious oscillations i temporal discontinuity for those mesh nodes where the solid becomes fluid or verse vice called change of status in present paper when the boundary is moving ii spatial discontinuity in the pressure field in order to reduce the sfos uhlmann 2005 used the combination of regularized delta function in direct forcing approach yang and balaras 2006 adopted a field extension technique in which the velocity and pressure at the grid nodes where change of status occurs were obtained by an extrapolation from adjacent fluid grid points seo and mittal 2011 applied cut cell method to improve local mass conservation and reduce sfos lee et al 2011 proposed the addition of a mass source sink inside the solid to suppress the sfos on collocated grids nicolaou et al 2015 adopted the same idea but applied it on staggered grids and throughout the solid region most of these methods based on the finite volume method therefore calculation of the flux of the status changed cells or re construction of new polyhedral cells near the moving boundary can be very complicated therefore a simple and stable scheme for moving boundary problems is still needed the original local domain free discretization ldfd developed by the authors shu and wu 2006 belongs to the discrete forcing ibm the concept of dfd method shu and wu 2002 is based on the mathematical fact that the solution inside the domain can be extended to the outside of the fluid domain in the ldfd cartesian mesh solver the second order finite difference fd schemes are adopted for numerical discretization the boundary conditions of the curved embedded boundaries are enforced by a local extrapolation process which determines the values of flow variables at the mesh nodes that are adjacent to embedded boundaries but locate on the outside of flow field the neumann boundary condition for the pressure can be implemented by calculation of the local momentum equation on the normal direction to the boundary with this idea one can solve the problems with complex geometries on a non conforming structured mesh with or without moving boundaries shu and wu 2006 wu and shu 2008 however the extrapolation and implementation of the pressure boundary condition may bring in complexity and numerical instabilities recently the authors presented the hybrid local domain free discretization and immersed boundary method ldfd ibm and successfully apply it to stationary bodies problems wu et al 2012 wu 2017 like the continuous forcing approach the discretization of ldfd ibm is applied to the whole calculation domain including the solid bodies the pressure is obtained naturally by solving the n s equations using the fractional step technique therefore no tedious process is needed to handle with the neumann boundary condition for the pressure along the normal direction of the solid boundary it is the advantage over many approaches in the category of discrete forcing ibm as a sharp interface immersed boundary method ldfd ibm also overcomes the drawback of the ibm based on the ghost cell or extrapolation point in which the extrapolation stencil has to be used on the contrary this method uses interpolation scheme to update velocity near the boundary and no slip boundary condition can be satisfied accurately it has been demonstrated that it has truly second order accuracy on the whole computational domain and can be applied to multiply bodies problem very well wu 2017 since ldfd ibm solves the n s equation on the whole domain regardless the solid and fluid there is no temporal and spatial discontinuities involved however the geometric and kinematic change of the moving interface between fluid and solid has to be considered it is interesting to investigate if ldfd ibm is a suitable candidate for the moving boundary problems in this paper the strategy of ldfd ibm for moving boundary problems is presented after that the method is applied to study the fluid dynamics of flows past single multiple moving objects 2 methodology and procedure of ldfd ibm for moving boundary problems 2 1 status changes in moving boundary problems ldfd ibm is a discretization scheme based on finite difference method in this paper it is applied on cartesian mesh which is illustrated by fig 1 in this method the fixed reference frame is adopted and the mesh is also fixed the moving objects are immersed in the fixed mesh and are allowed to move freely through the mesh lines for simplicity we assume that the mesh is uniform and the mesh spacing in both the x and y directions are the same suppose that the solution of a problem is expressed by u x y in fig 1 the solid curve represents the solid boundary at current time step and dashed curve represents the solid boundary at adjacent time step the mesh nodes inside the fluid domain named interior node are represented by solid circles such as c0 c1 in fig 1a while the mesh nodes outside the fluid domain named exterior nodes are represented by shaded circles such as e1 e2 in fig 1a there are two types of mesh nodes in the immediate neighborhood of solid boundary and we call them dependent points if the dependent point is located in the fluid domain it is termed an interior dependent point represented by empty square such as b1 b2 in fig 1a and if the dependent point is located outside of fluid domain it is termed an exterior dependent point represented by empty circle such as a1 a2 in fig 1a the small solid squares on the boundary are points intersected by the mesh lines and boundary curve which are called intersection points such as points p1 p2 p3 p4 in fig 1a if an intersection point coincides with a mesh node such as a4 and p4 in fig 1a the mesh node is considered as an exterior dependent point whose variable values are determined by the boundary conditions at solid object in ldfd ibm we use status of mesh node to identify if that the node is located in the fluid domain or in the solid body these statuses can be defined as see fig 1a status 1 represents the interior point which is in the fluid domain and not adjacent to the solid boundary such as c0 in fig 1a status 2 represents the interior dependent point near the immersed boundary and inside the fluid domain such as b2 in fig 1a status 3 represents the exterior dependent point near the immersed boundary but being inside of the solid body such as a2 in fig 1a status 4 represents the outside point which is located in the solid body but not adjacent to the solid boundary such as e2 in fig 1a from the implementation point of view the main difference between flows with stationary boundaries as shown in paper wu et al 2012 and flows with moving boundaries lies in the fact that during the computation the status of nodes changes in the latter but remains the same in the former this is because when the solid body is moving the position of the boundary on the cartesian mesh changes with the time as shown in fig 1 the position of boundary changes from x n at the time level n fig 1a to x n 1 at the time level n 1 fig 1b and consequently the status of the mesh nodes changes such as the statuses of mesh nodes a1 a2 a3 are changed when the boundary moves the movement of the solid objects causes the status change of mesh nodes in the domain for the moving boundary simulation the following two typical situations may occur situation 1 status changed from solid to fluid as shown in fig 1 a suppose the position of the boundary at the time level n is represented by the solid curve and the boundary at the time level n 1 is represented by the dashed curve from the time level n to n 1 the status of a2 is changed from solid an exterior dependent node at the time level n to fluid an interior dependent node at the time level n 1 i e statusn a2 3 status n 1 a2 2 consequently we have statusn b2 2 status n 1 b2 1 statusn d2 4 status n 1 d2 3 statusn c2 1 and statusn e2 4 keep no change situation 2 status changed from fluid to solid as shown in fig 1 b again the solid curve denotes the boundary at the time level n the dashed curve denotes the boundary at the time level n 1 then from the time level n to n 1 the status of a2 is changed from fluid interior dependent node at the time level n to solid exterior dependent node at the time level n 1 i e statusn a2 2 status n 1 a2 3 consequently statusn b2 1 status n 1 b2 2 statusn d2 3 status n 1 d2 4 statusn c2 1 and statusn e2 4 keep no change it is also found that the locations of intersection points are changed with the moving boundary as shown in fig 1b when the boundary at time level n which represented by the dashed curve moves to the position at time level n 1 represented by the solid line the intersection points such as points p1 p2 p3 p4 at the time level n change into points q1 q2 q3 q4 at the time level n 1 therefore it is necessary to calculate the position of the intersection points every time step to identify the status change of mesh nodes is an important step in ldfd ibm since ldfd ibm uses regular cartesian mesh so identification of the status of the mesh nodes is similar to the image processing operations in computer graphics cg where pixels in some region of an image are assigned a label or called change color there are some fast cg algorithms in cg available such as scan line polygon fill algorithm for two dimensional case and seed fill algorithm for three dimensional case foley 1996 in this paper the odd even parity method developed based on scan line polygon fill algorithm by the authors wu and shu 2008 is adopted to detect the status change of mesh nodes for the moving boundary problems 2 2 solution procedure of ldfd ibm for moving boundary problems similarly as in the case of stationary body wu 2017 the fractional step method is employed to couple the momentum equations and the continuity equation in solving the n s equations the solution procedure is also similar to the ldfd ibm method for stationary body problem wu 2017 as shown in the following here the time derivative is discretized via euler explicit scheme for the convenience of analysis the solution procedure is as shown in the following 2 u n 1 u n δ t h u n g p n 1 re l u n f b 3 u u n 1 δ t g p n combining the continuity equation d u n 1 0 and take gradient of eq 3 then the pressure poisson equation is derived to correct the velocity as 4 l p n 1 1 δ t d u finally the velocity u n 1 is updated by the solution of pressure equation 4 5 u n 1 u δ t g p n 1 where h denotes the discrete advection operator g is the discrete gradient operator l the discrete laplacian operator d is the divergence operator an additional force f b is compensation forcing term for the presence of the immersed boundaries in ibm it should be noted that in stationary body problem when solving eqs 2 5 the calculation of additional force f b is not required updating the velocities at the interior and exterior dependent points is equivalent to add the force f b implicitly wu 2017 however in the moving boundary problems due to the change of the position and velocity of the moving objects we have to adopt different strategy as indicated in ref lee et al 2011 the change of node status may result in the temporal discontinuity during the discretization of the time derivative for example when solid nodes become fluid nodes we need to know the flow variables values for these new fluid nodes at the previous time level this poses a challenge for the traditional discrete forcing ibm because they were solid nodes at that time and had no time history of the fluid variables such as velocity and pressure for the ldfd ibm because the variables at every mesh node are calculated by solving the governing equations they are the approximate solutions of n s equation at any time step the time history of variables for each node has been recorded therefore the temporal discontinuity is not to be a problem however due to the interface between solid and fluid is moved the changes of status and velocity of the mesh nodes have to be considered for the moving boundary problems it includes the simultaneous update of the velocity and the location of the moving boundaries in fig 1 suppose that at the time level n the boundary is located at position x n solid line in fig 1a with velocity u b n at the time level n 1 the boundary moves to position x n 1 solid line in fig 1b with velocity u b n 1 here we take a2 in fig 1 as example again from the time level n to n 1 the status of a2 is changed from an exterior dependent node solid at the time level n to an interior dependent node fluid at the time level n 1 i e statusn a2 3 status n 1 a2 2 here we consider the two following effects of moving object separately 1 the effect from the change of the position of the boundaries which we call the geometric effect since it only corresponds to the change of location of boundaries 2 the effect from the change of the velocity of the boundaries which we call the kinematic effect therefore the procedure of ldfd ibm for solving moving boundary problems i e how to solve the momentum equation eq 2 basically consists of two steps step 1 estimate the flow field by considering the change in the position of the moving object only in this step we only consider the geometric effect suppose that the solutions of n s equations such as u n and p n are known we modify the velocity field from u n to u ˆ n at time level n to account for the location change of the boundaries 1 change the status of mesh nodes according to the new position of boundary x n 1 as described in situation 1 in last section 2 keep the velocity unchanged for mesh nodes with status 1 i e interior nodes i e u ˆ n u n 3 set the velocity at mesh nodes with status 4 i e exterior nodes not adjacent to the boundary x n 1 and status 3 i e exterior dependent points to u b n i e u ˆ n u b n the velocity at boundary points which are the intersection of the boundary and the mesh lines i e lagrangian points in conventional ibm such as q2 in fig 1b is also set as u ˆ n u b n 4 to determine the velocity at those nodes with status 2 i e interior dependent nodes such as a2 in fig 1b use 3 point lagrange interpolation scheme below 6 u ˆ a 2 n y a 2 y b 2 y a 2 y c 2 y q 2 y b 2 y q 2 y c 2 u ˆ q 2 n y a 2 y c 2 y a 2 y q 2 y b 2 y c 2 y b 2 y q 2 u ˆ b 2 n y a 2 y q 2 y a 2 y b 2 y c 2 y q 2 y c 2 y b 2 u ˆ c 2 n from eq 6 it is found that there are three determining factors for the interpolation scheme i e the position of boundary x n 1 such as y q 2 the velocity at the mesh nodes with status 1 u ˆ n u n such as u ˆ b 2 n u b 2 n u ˆ c 2 n u c 2 n and the velocity at intersection points u ˆ n u b n such as u ˆ q 2 n u b n q 2 thus we can use interpolation x n 1 u n u b n to represent the interpolation value take mesh node a2 as an example if status a2 2 then interpolation x n 1 u n u b n can be written as 7 u ˆ a 2 n i n t e r p o l a t i o n x n 1 u n u b n x y a 2 y b 2 y a 2 y c 2 y q 2 n 1 y b 2 y q 2 n 1 y c 2 u b n q 2 y a 2 y c 2 y a 2 y q 2 n 1 y b 2 y c 2 y b 2 y q 2 n 1 u b 2 n y a 2 y q 2 n 1 y a 2 y b 2 y c 2 y q 2 n 1 y c 2 y b 2 u c 2 n v ˆ a 2 n i n t e r p o l a t i o n x n 1 u n u b n y y a 2 y b 2 y a 2 y c 2 y q 2 n 1 y b 2 y q 2 n 1 y c 2 v b n q 2 y a 2 y c 2 y a 2 y q 2 n 1 y b 2 y c 2 y b 2 y q 2 n 1 v b 2 n y a 2 y q 2 n 1 y a 2 y b 2 y c 2 y q 2 n 1 y c 2 y b 2 v c 2 n therefore the modified velocity field u ˆ n at time level n can be written as 8 u ˆ i n u i n if status i x n 1 1 i n t e r p o l a t i o n x n 1 u n u b n u b n if status i x n 1 2 if status i x n 1 3 or 4 it should be noted that the velocity at interior dependent points needs to be updated by interpolation such as eq 7 at least once either along the x direction or along the y direction if there are two intersection points in its vicinity one is on x direction the other is on y direction then two distinct approximate solutions may be obtained at a certain interior dependent point in our study to uniquely determine the value at these interior dependent points we choose to use the average of approximate solutions from the x and y directions based on this modified velocity field u ˆ n we estimate the velocity field u ˆ n 1 at time level n 1 by only considering the geometric effect of moving boundary via solving the following equation 9 u ˆ n 1 u ˆ n δ t h u n g p n 1 re l u n it should be noted that there is no force term presented in eq 9 i e in this step f b 0 in other words u ˆ n 1 is calculated only considering the location change of the boundary step 2 estimate the flow field by considering the change in the velocity of the moving object in this step we include the kinematic effect into consideration i e the velocity of the object is changed from u b n to u b n 1 at the same position x n 1 this effect can be represented by an additional force term f b calculated by 10 f b n 1 u b n 1 u ˆ n 1 δ t the approximate velocity field at time level n 1 u b n 1 is firstly obtained by the following equation 11 u b n 1 u i n if status i x n 1 1 i n t e r p o l a t i o n x n 1 u n u b n 1 if status i x n 1 2 u b n 1 if status i x n 1 3 or 4 where the formula of i n t e r p o l a t i o n x n 1 u n u b n 1 has the similar meaning as eq 7 still take a2 as an example the formula can be written as 12 u b n 1 a 2 i n t e r p o l a t i o n x n 1 u n u b n 1 x y a 2 y b 2 y a 2 y c 2 y q 2 n 1 y b 2 y q 2 n 1 y c 2 u b n 1 q 2 y a 2 y c 2 y a 2 y q 2 n 1 y b 2 y c 2 y b 2 y q 2 n 1 u b 2 n y a 2 y q 2 n 1 y a 2 y b 2 y c 2 y q 2 n 1 y c 2 y b 2 u c 2 n v b n 1 a 2 i n t e r p o l a t i o n x n 1 u n u b n 1 y y a 2 y b 2 y a 2 y c 2 y q 2 n 1 y b 2 y q 2 n 1 y c 2 v b n 1 q 2 y a 2 y c 2 y a 2 y q 2 n 1 y b 2 y c 2 y b 2 y q 2 n 1 v b 2 n y a 2 y q 2 n 1 y a 2 y b 2 y c 2 y q 2 n 1 y c 2 y b 2 v c 2 n finally we correct the velocity field at time level n 1 u n 1 by solving the momentum equation with the additional force f b 13 u n 1 u ˆ n 1 δ t h u ˆ n g p n 1 re l u ˆ n f b n 1 generally this solution procedure can be used for both the flow problems with moving and stationary boundaries for the flow problem with stationary boundaries since there is no status change for the mesh nodes u ˆ n u n eq 13 becomes the same as eq 9 therefore only in this situation step 1 and step 2 mentioned above can be combined into one step as described in simulation of flow past stationary objects by ldfd ibm in the authors previous papers wu 2017 note that the force term f b in eq 10 is simply a newtonian acceleration at time level n 1 if the trajectory of the moving object is prescribed say x x e t the acceleration of solid body can be obtained directly i e 14 a d 2 x e d t 2 eq 14 can be used to replace eq 10 as the force term in eq 13 for the exterior dependent nodes and exterior nodes because they are supposed to have the same speed as the moving object however when one considers more general cases we still need to calculate f b according to eq 10 after solving eq 13 one can follow the fractional step technique to obtain the velocity and pressure field at time level n 1 according to eq 3 5 wu 2017 thus the basic procedure of the ldfd ibm for solving moving boundary problems can be summarized by the following sequence advancing the solution from n to n 1 time level 1 use the solution at the n time level to initialize the velocity and pressure fields u n p n initially set f b as zero if t 0 2 determine the new position of the immersed object x n 1 if the trajectory of the moving object is prescribed this job can be easily done 3 determine the status of the mesh nodes when the moving object is at position x n 1 4 obtain the modified velocity field u ˆ n via eq 8 and solve for u ˆ n 1 from eq 9 without any force term 5 solve for u n 1 from eq 13 in which f b is added via eq 10 or eq 14 if the trajectory of the moving object is prescribed 6 solve eq 3 5 in the whole flow field to get u n 1 p n 1 3 application of ldfd ibm to moving boundary problems in this section the ldfd ibm s strategy for moving boundary problems is used to simulate flow problems with the single oscillating object as well as multiple moving bodies like in stationary boundary problems the application of ldfd ibm to the moving boundary problems uses the second order finite difference scheme for the approximation of spatial derivatives and the explicit three step formulation wu 2107 for the approximation of the time derivative 3 1 flow past an oscillating circular cylinder the problem of a cylinder oscillating laterally cross flow in the free stream is a classic flow problem with moving boundaries there are various experimental and numerical investigations available lu and dalton 1996 guilmineau and queutey 2002 the computational domain is shown in fig 2 where d is the diameter of the cylinder an initial uniform cartesian mesh of 161ⅹ121 is used as the background mesh after 8 levels of mesh refinement with stencil refinement technique described in the paper ding and shu 2006 the final mesh has a total of 54002 nodes as shown in fig 3 note that the finest mesh covers the area where the oscillating cylinder moves the circular cylinder is moved vertically with the speed v t 15 v t d y e d t where y e a e sin 2 π f e t with a e and f e are the oscillating amplitude and excitation frequency respectively f e is very important for the flow structure the synchronization phenomenon has been observed in the wake of the cylinder when the frequency of vortex shedding in the wake synchronizes with the frequency of an imposed perturbation i e this kind of synchronization occurs around f e f o 1 where f e is the excitation frequency and f o is the vortex shedding frequency from the stationary cylinder in this work ldfd ibm is used to perform calculations for re 185 a e d 0 2 where d is the diameter of the cylinder the range of f e f o 1 1 1 12 1 2 is considered all the simulations start from the flow past a non oscillating cylinder until the vortex shedding reaches to the stable state therefore the field information of the flow past a non oscillating cylinder at re 185 is obtained via the simulation of ldfd ibm for stationary case first as shown in table 1 the flow parameters agree with other experimental and numerical results very well from this the value of f o can be calculated and is used in the following simulation for the moving cylinder after that the simulation for the flow past an oscillating cylinder can be performed the boundary conditions of the problem are 1 at the inlet a free stream velocity profile is specified that is 16 u 1 v 0 2 on the cylinder surface no slip boundary condition is implemented by 17 u 0 v 0 3 on the top and bottom boundary the symmetric boundary condition is applied that is 18 u y 0 v 0 4 at the far field downstream boundary of the cylinder the zero gradient boundary condition is applied by 19 u x 0 v x 0 the time evolution of the flow field can be quantitatively represented by the variation of the drag and lift coefficients at the surface of body which are defined by 20 c d f d 1 2 ρ u 2 d c l f l 1 2 ρ u 2 d where d is the diameter of cylinder ρ is the fluid density and u is the characteristic velocity in this case it is the free stream velocity f d is the drag force and f l is the lift force acting on the circular cylinder in this study the dynamic force acting on surface of cylinder can be computed by integrating the local pressure and stress distributions along the cylinder surface which can be written as 21 f f x f y f d f l s b p n t n d s where p is the pressure n n x n y is the surface unit normal vector the subscripts x and y denote the x direction and y direction respectively t is the stress tensor and sb is the surface of solid body the drag force and lift force is the x and y component of the dynamic force as shown in eq 21 fig 4 6 show the drag and lift coefficients for different values of f e f o obtained by ldfd ibm it is found that the drag and lift coefficients exhibit regular signs of the influence of a higher harmonic wave as the excitation frequency increases the beating frequency decreases the common sfos exist in the simulating results from some discrete forcing ibm are much reduced in ldfd ibm table 2 compared the present results with those of guilmineau and queutey 2002 it is found that they are agree very well with each other it demonstrates that the moving boundary strategies of ldfd ibm is simple as well as stable 3 2 two cylinders moving with respect to each other to demonstrate the ability of present method to simulate flows past multiple moving objects the flow past two cylinders moving with respect to one another is selected this example was originally investigated numerically by russell and wang 2003 and xu and wang 2006 the initial geometry for this test is shown in fig 7 the computational parameters and the boundary conditions are the same as those in xu and wang 2006 the far field boundary conditions are rigid walls to avoid the impulsive start of the cylinders both cylinders are oscillated about their initial positions for two periods 16 s and then towards to each other at a speed corresponding to re 40 the motion of the lower cylinder is given by 22 x l c 4 π sin π t 4 0 t 16 t 16 16 t 32 and the motion of the upper cylinder is given by 23 x u c 16 4 π sin π t 4 0 t 16 32 t 16 t 32 in this simulation we used two different mesh sizes type i coarse mesh an initial uniform cartesian mesh of 241ⅹ121 is used as the background mesh the cartesian mesh is refined by the stencil adaptive mesh refinement algorithm introduced in ref ding and shu 2006 after 4 levels of mesh refinement the final mesh has a total of 145110 nodes the finest level of mesh covers the area where the oscillating cylinders move the mesh nodes distribution is shown in fig 8 type ii fine mesh an initial uniform cartesian mesh of 481ⅹ241 is used as the background mesh after 4 levels of mesh refinement the final mesh has a total of 574942 nodes the mesh nodes distribution is similar as fig 8 fig 9 shows the evolution of lift and drag coefficients calculated via eq 20 for the upper cylinder versus time the results from xu and wang 2006 are also included for comparison it is found that our results for c l number agree with those of xu and wang 2006 very well but for c d although the trend of the curve is similar as that of xu and wang 2006 there is a gap between present results and those from xu and wang 2006 to investigate the difference we conducted the grid independence study for our simulation it is found in fig 9 that very good agreement between two mesh sizes is observed for present method therefore the possibility of any errors caused by the mesh is eliminated since there exists no benchmark solution for this problem the difference between our results and those from xu and wang 2006 may due to the different implementation of the simulations or post processing of the results it is found from fig 9 that when two cylinders approach each other there is an increase in drag implying that the 2 cylinders are repulsive to each other when they move in close proximity there is a drop in drag which means that they are attractive to each other the drag then rises back when they move away figs 10 and 11 present the vorticity and pressure contours of ldfd ibm results when the two cylinders are closest to each other at t 24 and figs 12 and 13 shows the vorticity and pressure field at t 32 when the cylinders are separated from each other by a distance of 16 compared with the contours from xu and wang 2006 it is found that our results agree with those of xu and wang 2006 very well it demonstrates that performance of the present ldfd ibm moving boundary solvers for simulating the multi bodies moving problems is satisfied 4 conclusions the strategy of the ldfd ibm for simulating the moving boundary problems is presented in this paper the consideration of position and velocity of the moving boundaries and the status change of the mesh nodes plays a very important role in designing the solution procedures for moving boundary problems a two step forcing procedure is adopted in ldfd ibm to consider geometric changing effect as well as the kinematic changing effect of the moving objects compared with other discrete forcing ibm in which complicate procedures are needed to deal with those temporal and spatial discontinuity across the immersed boundaries ldfd ibm can be implemented easily and accurately the present method has been applied to some typical problems of flows with single multiple moving bodies the good agreement between present numerical results and available data in the literatures shows the good accuracy and robustness of ldfd ibm it demonstrates that ldfd ibm is a promising method to solve the moving boundary problems acknowledgements support from national natural science foundation of china grand no 11621202 and the fundamental research funds for the central universities grand no wk2090000009 are gratefully acknowledged 
23302,full scale measurement model testing and a hybrid cfd method were used to characterize the underwater radiated noise urn of a ship at design speed the cfd method consists of a multiphase delayed detached eddy simulation and the ffowcs williams hawkings acoustic analogy the paper discusses the correlation of the noise spectra with the observed cavitation behavior and compares the measured full scale data with those predicted by the model testing and the cfd method the comparison shows that the sheet cavity and tip vortex cavitation tvc predicted by the model testing are in reasonably good agreement with the full scale observations the pressure pulses are somewhat higher than the full scale data overall the predicted urn has a good correlation with the noise spectra obtained from the sea trial the cfd method shows the potential to resolve turbulence eddy structures in the wake it captures the dynamic development of sheet cavitation and the collapse and rebound of tvc as observed in the model test and the sea trial but under predicts the extent of tvc the pressure pulses and tonal noise are in close agreement with the respective measured data for the first five orders of blade passing frequency the method underestimates the broadband noise level in the frequency range 50 112 hz where the tvc is expected to have an important contribution the maximum under prediction in this range is about 28 db at 72 hz at frequencies above 200 hz the broadband noise becomes more and more under predicted with increasing frequency keywords underwater radiated noise cavitation ffowcs williams and hawkings ddes propeller 1 introduction the radiated noise from maritime shipping and seismic exploration of oil gas industry has become a growing environmental concern due to the potentially adverse effects on marine fauna shipping noise dominates the background noise below 300 hz in the seas according to hildebrand 2009 arveson and vendittis 2000 states that noise from commercial ships increases the ambient noise level by 20 30 db in many parts of the oceans the shipping noise has increased by 10 db from the 1960 s to the 1990 s according to measurements in the usa reported in andrew et al 2002 and mcdonald et al 2006 this is an increase by 3 db per decade international maritime organization imo is paying increasing attention to many hydro acoustic effects due to ship transportation imo 2014 released a non mandatory guidelines for the reduction of underwater radiated noise from commercial shipping in 2014 there is no doubt about the importance to understand the ship generated noise and its radiation characteristics to control and mitigate the noise from ships and propellers during and after design equally important is the model testing techniques and the computational tools that can reliably predict the noise generated by ships at various operating conditions before they are built among the noise sources generated by a propeller driven ship the propeller is recognized as a dominant source contributing to urn in the low frequency range cavitation can further enhance the radiated noise level over a wide frequency spectrum experiments are necessary to provide quantification of the noise spectra under the controlled laboratory environment for scaled physical models it normally requires the use of a large cavitation tunnel and a well established test set up that is able to mimic the ship wake and the cavitation condition as experienced by a full scale ship moreover a scaling procedure is needed to scale up the measured model scale data to the corresponding ship scale this is why that the prognosis made by model testing needs to be validated against full scale data with increasing level of complexity and capability to model the underlying physics computational tools used for urn prediction may be categorized in the following order a empirical semi empirical methods b boundary element method based on potential flow theory where turbulence and viscosity effects are ignored c hybrid cfd method that decouples the sound propagation from its source generation allowing to separate the flow solution from the acoustic analysis the viscous flow field where the sound source is generated is solved by a cfd method with an appropriate turbulence model and the sound propagation is treated by an integral method based on acoustic analogy d direct numerical simulation dns to resolve the full spectra of noise the dns is by far the most costly method with respect to the grid resolution and cpu cores needed and it is still far beyond the affordability of engineering applications the hybrid method represents the state of the art approach for acoustic analysis depending on how various turbulence length scales are modelled or resolved the cfd method can be further classified as 1 reynolds averaged navier stokes rans method or unsteady rans urans method if the flow is treated unsteady 2 delayed detached eddy simulation ddes and 3 large eddy simulation les only the last two methods have the potential to resolve a variety of length scales of turbulence structures in the wake of hull and propeller the vorticity and turbulence structures in the wake of hull and propeller may give a significant contribution to the broadband noise even if such quadropole sources are less efficient sources than propeller cavitation monopole and non cavitating blade tonals dipole further the hull wake is very important for the cavitation dynamics therefore it is crucial to resolve these structures for a high fidelity cfd method aiming to predict a wide spectrum of tonal and broadband noise the les method requires very finesh and very small time step resolution as compared with the other methods the computing time and requirement on hardware can become prohibitive for calculation of a full scale ship including propeller cavitation phenomenon on the other hand the ddes method combines the advantages of rans or urans and les it resolves the flow with an les alike model in the crucial regions e g separation or wake region and solves the rest of the fluid domain with a rans or urans method in the present work we adopt a ddes method that uses a urans les combination coupled with the acoustic analogy based on a formulation of ffowcs williams and hawkings 1969 fwh the commercial software ansys fluent is used with regard to acoustic analogy a relatively new formulation of fwh integration called permeable or porous formulation and proposed first by di francescantonio 1997 is of particular interest it allows for the selection of source integral surfaces not only on solid body surfaces but also on permeable surfaces interior to fluid domain integration over a permeable surface allows to account for the contribution of non linear terms resulting from the instantaneous shear stress and vorticity content within a highly turbulent fluid domain enclosed by the permeable surface the wake of a ship hull and a propeller is such a kind of domain the methodology of hybrid cfd approach was originally developed for aero acoustic calculations at medium to high mach numbers its application in hydro acoustics is rather new and starts to grow only in recent years the application of the permeable formulation for non cavitating propellers was explored by testa et al 2008 and further investigated by ianniello et al 2013 2014a and 2014b in which the contribution of nonlinear quadrupole sources was emphasized and the inadequacy of urans methods to resolve turbulence structures was addressed more recent endeavors include the work of bensow and liefvendahl 2016 who developed an les fwh methodology for prediction of cavitating propeller radiated noise and compared with model test data lidtke et al 2016a 2016b who studied the feasibility of an les fwh approach for noise and cavitation modelling of hydrofoils and marine propellers and özden et al 2016 in which a urans fwh method was applied to predict noise created by a non cavitating submarine propeller behind a generic darpa suboff submarine there was however no validation for propeller noise in the wake in the last three papers in survey of open literature it is clear that too few noise data from sea trial is available for validation of predictive tools for full scale predictions in our previous work hallander et al 2012 a urans method coupled with fwh s acoustic analogy was applied to predict the noise generated by a full scale lng ship with a cavitating propeller although an overall agreement was achieved the study revealed an under prediction of radiated noise by 25 db of the measured full scale data it was realized that the inability to resolve turbulent wake structures of different length scales was the primary limitation of urans methods this becomes the drive to move from urans to ddes approach in the present work the eu fp7 framework project aquo achieving quieter oceans aquo 2012 formed dedicated work packages to conduct sea trials experiments in model scales improvement and validation of numerical methods to predict urn from propellers including cavitation effect and interaction with ship hull sspa was engaged in the model testing full scale measurement and numerical simulation of a coastal tanker equipped with a controllable pitch cp propeller running at a constant rpm the full scale data collected in this project offers an excellent opportunity for us to assess and validate the prediction made by model testing and computational methods prior to the model testing six representative loading conditions were defined in table 2 for the experiment campaign and the full scale measurement carried out later loading condition 1 lc1 represents the case at design speed and design draft and lc2 represents the condition at ballast draft in both cases the propeller suffers cavitation as is well known cavitation on propeller has a significant contribution to the radiated noise for numerical methods there are still a number of challenges in modelling the dynamics of cavitation phenomena and radiated noise because of the complex mechanism involving the turbulence fluctuations in the flow over a wide range of length and time scales from the predictive point of view it is very interesting to see how well the cavitation and its induced noise can be reproduced by the model testing and predicted by the numerical methods pressure pulses on hull plate become more pronounced when cavitation take place on blades hence prediction of pressure pulses is another topic of interest in the present study the validation of the model testing and cfd methods for this ship in model scale have been reported in hallander and johansson 2015 tani et al 2016 li et al 2014 2015a and 2015b this work is a continuation of previous validation work aiming to assess the prediction performance of the method for full scale ship in design speed while the model testing predictions have been validated many times with sea trial data before it is the first time attempt to validate the ddes fwh method for prediction of urn in full scale the paper is organized as follows the full scale measurement and the model testing setup are introduced in section 2 and 3 briefly followed by a description of the cfd method in section 4 section 5 is devoted to the comparison of results between the methods discussions are also made of the correlation between the propeller loading the noise signature and the observed cavitation behavior conclusions are drawn in section 6 2 on site full scale measurement 2 1 ship and propeller data the subject ship is an oil chemical tanker m t olympus operating along coastlines she is equipped with a four bladed controllable pitch cp propeller and powered by a single diesel engine running at a constant 120 rpm the main dimensions are given in table 1 2 2 measurement and post processing underwater radiated noise was measured at a flat seabed area of depth 40 60 m near lysekil on the swedish west coast during the urn measurements the ship did one port and one starboard passage at 15 kn lc1 and one port and one starboard passage at 11 kn lc5 three sparton phod 1 hydrophones were suspended to a float and moored on a 20 kg bottom weight at 43 m depth fig 1 a cables were run to the nearest point on land approximately 150 m away where the signals were converted and stored to a pc the losses of preamplifiers and cables were measured by insert voltage calibration speed shaft power rpm and propeller pitch were recorded to an on board data logging system synchronized to the urn recording system structural vibration were measured with accelerometers at some locations visualization of cavitation was provided by a standard video camera mounted in an underwater housing and attached to a clamp on the hull as marked by a yellow circle in fig 2 a pressure pulse sensor was mounted on the camera housing the analysis of the recorded urn data followed the measurement standard proposed in aquo d3 1 2014 to cover the directivity effects a rake of seven monitoring locations was defined on either side of the ship in parallel with the center line the locations relative to the acoustic center ac of the ship are illustrated in fig 1 b the ac is defined at the ship center line 10 m distance forward of aft perpendicular ap at the rudder stock the propeller generator plane is 3 0 m forward of ap and the main engine center is approximately 17 m forward of ap the average spectrum of sound pressure data in each data window and for each hydrophone was calculated using welch s method with 50 overlap and 2 s hamming windows spectra are presented as power spectral density psd unless otherwise indicated the spectra were corrected for the influence of background noise using previously measured background noise levels source level spectra were estimated by correcting for measured transmission loss source level spectra were averaged across hydrophones finally the mean spectra and directivity envelope spectra the maximum level at each frequency were calculated from all data windows for each condition for further detail see johansson et al 2015 comparisons in this paper with model testing and cfd predictions were made using the mean spectra due to logistical reasons and weather conditions the cavitation observation and pressure pulses were measured in ballast condition lc2 and lc6 in table 2 while the underwater radiated noise were measured at design draft lc1 and lc5 in table 2 2 3 characterization of urn spectra apart from propeller there are a few other noise sources onboard a ship in general the main and auxiliary engines are the most important ones while pumps electric motors and the flow noise induced in the turbulent boundary layer and the wake of the hull and appendages usually play a minor role for commercial ships the noise spectra measured in a sea trial is a superimposition of the signals arising from all these possible sources hence the noise spectra from a sea trial have always a very complex and varying nature to distinguish the noise contribution from different sources the peaks and components in the spectra were compared with the operation frequencies of onboard machineries and their expected noise character as a result the tonal and broadband noise from propeller and cavitation if any can be identified from this complex noise spectra an example of the source identification diagram in low frequency range is shown in fig 3 for the loading condition lc1 see table 2 since the shaft revolution rate was constant at 120 rpm in the tested cases and the propeller has 4 blades the blade passing frequency bpf or blade rate br frequency is 8 hz the propeller br tonal noise up to fifth order are clearly seen in fig 3 with peaks from other sources appearing in between it can be confirmed for this ship that the tones at harmonics of propeller bpf are the dominant noise in frequency below 60 hz it is also observed that the highest noise level occurs in the range 40 100 hz due to the additional contribution of cavitation noise in this loading condition more detail can be found in johansson et al 2015 and tani et al 2016 the urn amplitudes from propeller and main engine are generally stronger after cpa than before naturally the envelope is higher than the mean 3 model testing 3 1 loading conditions the two loading conditions lc1 and lc2 of relevance to the present study are given in table 2 together with other loading conditions in the table they represent the typical scenario of the ship s operational profiles lc1 and lc2 correspond to the loading of ncr power with 15 sea margin at design speed in design and in ballast draft respectively the cavitation number σ is defined at the depth of the propeller shaft using the advance velocity v a at propeller plane 3 2 test set up the complete ship model was mounted at even keel design draft in the large test section of sspa s cavitation tunnel see fig 4 this mounting is used for all draft conditions due to practical reasons according to sspa standard practice meshes were mounted on the aft part of the hull for the purpose of increasing the turbulence of the flow the propeller was painted in red according to sspa standard for cavitation tests this red paint adds a certain roughness ra of a few μm which stimulates the turbulence and reduces the cavitation intermittency the propeller model was powered by an ac motor and the thrust and torque were measured by a kempf remmers type r46 dynamometer the motor and dynamometer are submersible and were mounted inside the water filled model the tunnel water speed was kept constant at 4 5 m s during the tests and operating points were obtained varying propeller rpm in order to reach thrust identity reference point for the computation of ship cavitation index is propeller axis in accordance to sspa usual practice eight pressure transducers are flush mounted on the ship model right above the propeller to assemble the pressure pulses on the hull noise measurements were carried out using three hydrophones brüel kjær type 8 103 attached to wing profile swords mounted in the cavitation tunnel see fig 4 the propeller acoustical center ac was assumed to be at 0 blade position and r r 0 7 the location of pressure transducer and resulting distance between the ac and the hydrophones are sketched in fig 5 a and b the complete detail of the model test is reported in aquo deliverable d2 4 2014 and partly described in tani et al 2016 3 3 results presentation and scaling method for full scale prognosis the procedure for post processing and result presentation follows the ittc guidelines for model scale noise measurements ittc 2017 the sound pressure power spectral density φ f in pa2 hz is computed from each sound pressure signal p t using welch s method of averaging modified spectrograms the sound pressure level spl at receiver hydrophone location is equal to the sound pressure power spectral density level in 1 hz bandwidth 1 s p l f 10 log 10 φ f p r e f 2 db re 1 μpa 2 hz where the reference pressure is defined as p ref 1 μpa the background noise measurements were performed with a dummy hub on the shaft at corresponding loading conditions in terms of shaft speed and cavitation number the model scale frequency spectra to be scaled to full scale were corrected for background noise according to ittc 2017 the source level sl is defined as the spl corrected for the transmission loss tl 2 s l s p l t l db re 1 μpa 2 hz sspa normally assess tl by measuring the transfer function in the cavitation tunnel using a known sound source at different locations in the propeller disc e g briançon et al 2013 however in the actual measurements some equipment was broken and we did not have the time to replace and calibrate thus tl was estimated with spherical spreading 20 log 10 r where r is the distance between hydrophone acoustic center and the acoustic center of the propeller by experience from other tests e g tani et al 2016 we know that the application of spherical spreading can differ several db from a measured transfer function thus it is likely that the noise levels at low medium frequencies predicted from model tests should be increased by 5 6 db calculations of full scale spectra were based on the hydrophone k79 only due to signal to noise ratio reasons under the condition that cavitation number is retained the same for model and full scale the model scale noise signal is scaled to full scale one according to the following scaling law for the frequency 3 f s f m n s n m and for the source level for a continuous spectrum of constant bandwidth 4 s l s s l m 20 log 10 r m r s ρ s ρ m d s d m 3 n s n m 1 5 db re 1 μpa 2 hz where n shaft revolutions hz d propeller diameter m ρ water density kg m3 r propeller hydrophone relative distance in m the subscripts m and s denote model scale and full scale respectively for tonal components line spectra at low frequencies bark 1988 derived 5 s l s s l m 20 log 10 r m r s ρ s ρ m d s d m 3 n s n m 2 db re 1 μpa 2 hz this is valid under the assumption that the source is a monopole i e the sheet cavitation is the dominating source however the blade rate components also contains a contribution from the non cavitating noise generated by the blade which has a dipole character further the amplitudes of the tonal noise are sensitive to the choice of fft length used which gives the frequency resolution in the analysis thus one should be careful with presenting scaled tones in narrowband data ittc 2017 4 computational method 4 1 the ddes fwh methodology the detail formulations for the numerical methods used in the current study are described in ansys fluent s user manual 2014 and are not repeated only the solution idea is explained below ddes is a hybrid method that applies a urans to the near wall region and an les to the region of a separated flow or a wake provided that in the latter region the grid is fine enough to allow for a meaningful les resolution urans is also engaged in solving the flow in the far field where grid sizes grow large for turbulence modelling in the urans mode sst k ω turbulence model is employed in the les region the subgrid scale turbulent viscosity is determined by the transport equation for k and ω in a similar way to the sst k ω model the difference is that a special grid size based criterion is introduced into the dissipation term y k in the k equation to activate the switch between the urans and les mode the reformulated dissipation term reads 6 y k ρ β k ω s d d e s where ρ is the density of the multiphase mixture flow and β is a model constant β 0 09 the switch between the urans and the les mode depends on the local grid sizes and their relative distances to the wall boundary it is controlled by the shielding function s ddes in eq 6 expressed as 7 s d d e s m a x l t c d e s δ m a x 1 f d d e s 1 the c des is a calibration constant 0 61 used in the ddes model and δ max is the maximum local grid cell spacing of δ x δy δz the l t is the turbulent length scale defined in the urans solution the function f ddes is designed in such a way to give f ddes 1 inside the boundary layer and ensures that les mode will not be activated inside the boundary layer hence avoiding or delayed the undesirable grid induced separation and f ddes 0 away from the wall to regain the original form of des shielding function the permeable form of fwh s surface integration allows to account for the important contribution from the instantaneous shear stress and vorticity content both being quadrupole type of noise sources in a flow field that is enclosed by the permeable surface in the present work since a rectangular domain closely around the ship is defined as an les solution domain the surface of this domain becomes the natural choice for permeable surface this surface is shown in fig 6 by the small rectangle around the ship also seen in the cross section view in fig 7 as marked by red lines theoretically the quadrupole source contributions imbedded in the boundary layer and the wake of ship and propeller within the les domain are taken into account by the fwh s surface integration whereas the quadrupole contributions outside the les domain are neglected the location of the fwh integration surface and the size of les domain selected in the present work are based on our understanding to the flow region of importance to urn and also some experience from the early work with a urans fwh method hallander et al 2012 at present there is no consensus on how far away the fwh integration surface should be placed hence the influence of the permeable surface location is still subjected to further studies cavitation is modelled by solving an additional transport equation for the vapor volume fraction vof including a mass transfer model for the liquid and vapor phases the employed mass transfer model is based on zwart s formulation further details on the cavitation model and the formulation for the permeable form of fwh s surface integration are referred to fluent s user manual 2014 the numerical schemes used are as follows multiphase mixture flow incompressible solver pressure and velocity solved in a coupled manner bounded 2nd order central difference for convection terms in momentum equations quick scheme in other transport equations propeller rotation handled by sliding mesh technique bounded 2nd order implicit scheme for time derivative final time step 6 94 10 4 s corresponding to a blade rotation of 0 5 per time step 12 inner iterations within each time step with the above time step the courant number is less than unity as required by the les solution moreover the highest resolvable frequency of noise spectra becomes 720 hz a complete solution for urn is accomplished in three steps firstly an urans calculation is performed until that the flow is nearly converged and that a urans turbulent length scale is properly defined the running time corresponds to about 2 propeller revolutions this precursor urans calculation serves as the initial flow field to the ddes simulation secondly the ddes solver is switched on and the simulation goes on for a time equivalent to about 2 3 propeller revolutions with the present numerical settings the thrust and torque coefficient kt and kq normally reach their periodic convergence within this time frame lastly fwh s acoustic analogy is switched on to start numerical integration of sound pressure on the predefined permeable surfaces the simulations in the last step usually continue for about 5 8 propeller revolutions 4 2 computational domain and boundary conditions computations were performed for loading condition lc2 the computational domain and its boundaries are shown by the large rectangle in fig 6 the inlet boundary is located at 1l pp fore of fp and the outlet boundary 1 5l pp aft of ap the two sides and the bottom of the domain are placed 1l pp away from the central line respectively a smaller rectangular domain closely surrounding the hull is also visible in fig 6 it has two roles meshes are highly refined in this domain to facilitate an les resolution the domain boundaries serve as the permeable integral surfaces for the fwh acoustic integration the still water surface is defined as a symmetry boundary free surface effects are assumed to have negligible effect on radiated noise as is often treated so in the noise measurement in cavitation tunnels for simulation it is then mainly to avoid excessively large amount of grid refinement needed to resolve the free surface the boundary conditions and initial conditions are specified in table 3 4 3 computational meshes all meshes were of hexahedral type generated by ansys icemcfd the meshes were refined not only in the wall normal direction to achieve a y 1 but also in the streamwise and girthwise direction to fulfil grid requirement for the ddes method there were some difficulties with ansys icemcfd in generating a valid mesh near the free surface at stern for ship hulls at ballast draft with a rotating propeller this was the case for lc2 if the hull were placed at the ballast draft it would be almost impossible to accommodate a cylindrical grid domain the sliding mesh containing the propeller in the stern region the grids outside the cylindrical domain would also become highly skewed hence the free surface of the computational domain was raised upwards to a draft at 7 4 m closer to the design draft of 8 1 m in lc1 the trim was kept the same as in reality a grid cut off at the central plane is shown in fig 7 and the surface meshes for the blades and the rudder are displayed in fig 8 the total number of cells is about 47 million for lc2 due to the stringent requirement on grid resolution in the les zone and on courant number very small time step has to be used for an already very large sized grid it becomes unrealistic to perform a systematic grid refinement study for this kind of simulations only two mesh variations were exercised for the model scale cases at the beginning of the work the finer mesh was chosen for subsequent simulations in model scale the results with the fine mesh 35 million cells was presented in li et al 2014 validation including grid sensitivity studies for steady non cavitating and cavitating flows around propellers with ansys fluent s urans method have been performed earlier in our work in li 2006 and li et al 2006 2012 compared with the grids used in the previous work the grid spacing used in the present work was much finer and the total mesh size is about 9 10 times larger than what is normally used for a urans calculation including propeller geometry 5 results and discussions in this section the predicted and the observed cavitation behavior is studied first then the pressure pulses and urn predicted by the ddes fwh method and the model testing are compared with the full scale measured data their correlation with the observed cavitation is also discussed the same monitor locations as defined and used for post processing the sea trial data see fig 1b are used to acquire the receiver level noise in the simulations noise signal is presented at source level sl in form of power spectral density of sound pressure in narrow band frequency throughout the paper the full scale measurement is denoted by sea trial lc1 or lc2 the prediction by the model testing and the cfd is denoted as mt prognosis and ddes fwh respectively the pressure pulses are presented as single amplitude with respect to the order of blade passing frequency it should be mentioned that the cfd predicted urn in lc2 are compared with the full scale measured one in lc1 since no noise measurement was made during the sea trial for lc2 due to weather conditions and logistical reasons moreover there seems to be a fairly close similarity in the main characters between these two conditions that allows for such a cross comparison referring to the specification for lc1 and lc2 in table 2 the propeller has the same pitch ratio p d and same shaft power in the two conditions and the ship speed differs by ca 1 knot the main operational differences between lc1 and lc2 are the draft and trim while it is true that the radiated noise can be quite different between the design and the ballast draft condition due to the likely difference in the wake field and the difference in cavitation number for the subject ship however the model test results of wake measurement in the towing tank revealed that the wake field for lc1 and lc2 had a very similar pattern as documented in annex c of aquo d2 4 2014 during the cavitation tests it was observed that the cavitation characters for lc1 and lc2 were close to each other due to a rather limited difference in the hydrostatic pressure that affecting cavitation number caused by the difference in propeller immersion therefore we believe that the main characteristics in cavitation pressure pulses and radiated noise between lc1 and lc2 are similar to each other of course there must be local discrepancies and variations between these two conditions hence the model test urn data for both lc1 and lc2 are included in the comparison to reveal not only their similarity but also the local discrepancy 5 1 convergence of the ddes solution convergence histories of all the residuals are presented in fig 9 for a time period corresponding to the last four propeller revolutions as seen in the figure all the residuals seem to have reached their stabilized levels for the period compared with their initial value of one 1 not shown in fig 9 the residuals have decreased to different extent of lower levels the residuals for the momentum equation for x y and z velocity have dropped to the order of 10 9 the residuals for turbulence transport equation k and omega are well below 10 6 the residual for the continuity equation is under 10 4 they all demonstrate a well converged behavior the residual for the transport equation of vapor volume fraction vf vapor in fig 9 has dropped only to a level of 10 3 this is typical of use of quick scheme for the convection term in the vapor volume fraction equation therefore the iterative solution for the linearized equation system is considered to be well converged the time history of the cfd predicted thrust and torque coefficient kt and kq for the last four propeller revolutions are shown in fig 10 it can be seen that kt and kq vary around a mean value in a periodic manner with each period corresponding to the blade passing period of 0 125s also plotted in the figure dash lines are the measured values from the model testing during the noise measurement the averaged kt and kq predicted by the cfd method are compared with the measured data in table 4 showing a slight over prediction of kt by 1 3 and kq by 0 6 in addition to the global force like kt the convergence behavior of pressure pulse at a few transducer locations was also monitored fig 11 presents an example of the time history of pressure pulse signal at a location corresponding to the transducer location f see sketch in fig 5a in the model test again a periodic variation of pressure with the blade passing period of 0 125s is obviously present demonstrating the convergence behavior of local variables in the flow field note that each wave form of the periodically varying pressure is not identical from cycle to cycle and there exist small oscillations at the crest of the pressure signals these features are the consequence of cavitation dynamics during the collapse and rebound of the tvc to be discussed next due to same reason a tiny irregularity in the wave form of kt and kq curves could also be noticed in fig 10 there is no time history data for the lighthill tensor stored during the simulation judging from the convergence behavior of velocity and pressure field it is believed that the lighthill tensor should have reached a good convergence too as the tensor is essentially a function of velocity velocity gradient and turbulent viscosity overall it can be stated that the ddes fwh solution is well converged 5 2 cavitation behavior cavitation observed by the three methods are compared with each other in fig 12 for the blade angular position at θ 30 50 and 70 respectively note that the propeller is left handed rotating so the blade angle is defined to increase from θ 0 at 12 o clock position in the anti clockwise direction when seen from behind propeller the video from sea trial doesn t contain any blade position information hence the blade position from the sea trial is very approximate the cavitation is characterized as a narrow sheet cavity on the suction side starting from blade position at θ 0 at radius r 0 9r its extension varies as the blade passes the wake peak finally starting at blade position θ 50 the cavity rolls up into a cavitating tip vortex visible until θ 70 cavitation diminishes as the blade rotates beyond position θ 70 in general the sheet cavity predicted by the model testing and the simulation agrees well with that observed in the sea trial the sheet cavity predicted by the model testing reveals a bit more dynamics and intermittency especially at θ 0 whereas the sheet cavity predicted by ddes fwh is rather stable the blade position where it reaches its maximum extension differs somewhat from that observed in the model test furthermore both predictions seem to have under predicted the tip vortex cavity tvc in the full scale observation the tip vortex cavity survives farther downstream and looks stable but quite foamy in the model test a dynamically bursting behavior is noted and the tvc lasts about half of blade revolution but appears to vanish a bit earlier than the full scale tvc this behavior is typical in a cavitation tunnel test due to reynolds number scale effects on tvc in the simulation dynamic rebound and collapse of tvc volume is observed as the blade leaves the wake peak the extension of the predicted tvc is however substantially shorter than that observed in the sea trial and the model test as marked in red ovals in fig 12 with this in mind it is logical to expect that the part of broadband noise that is caused by tip vortex cavity will become under predicted by the simulation 5 3 pressure pulses the full scale pressure pulses were measured at only one location corresponding closely to the transducer location f in the model testing setup fig 5a the measured signal is compared with those predicted by the ddes fwh and by the model testing at transducer f in fig 13 the plot for the sea trial and cfd data includes pressure amplitudes at the harmonics order up to 12th whereas the data from the model test prediction is available up to 5th order only the agreement at the 1st and 6th harmonic mode is very good between the ddes fwh and the full scale data the amplitudes for the 2nd to 5th harmonics is slightly higher than the full scale ones starting from the 7th up to 11th order the amplitude is however considerably under predicted the reason of which is discussed in connection with the under prediction of broadband noise later the pressure pulses predicted by the model test follow the trend reasonably well too but the amplitudes are somewhat more over predicted at the 3rd 4th and 1st order harmonics whereas at the 5th order there is a perfect match 5 4 underwater radiated noise urn the source level psds predicted by the ddes fwh averaged over the signal obtained from all receiver locations are compared with the averaged source level full scale noise in fig 14 the figure yields an overview of the correlation between the predicted and the measured full scale noise in a frequency range up to 1 000 hz in log scale the same spectra in the low frequency range up to 200 hz are plotted in fig 15 to highlight the correlation in the most critical frequency range in this figure the vertical grid lines are drawn intentionally at the multiples of bpf to help distinguish the propeller tones at harmonics of bpf from tones induced by other onboard machinery as they are also present in the measured full scale spectra but not in the predictions from the cfd and the model test the predictions made by the model testing in figs 14 and 15 are based on eq 4 in order to scale the broadband cavitation noise correctly following characteristics of the full scale measured noise are observed at frequencies f below 48 hz the spectrum is mainly represented by tonal noise of various sources the highest level over the entire spectra occurs in the frequency range 48 100 hz and the spectrum appears to be a mixture of peaks and broadband noise the high level in this range is believed to be associated with both the sheet cavitation on blade and the intermittently bursting tvc during the model test some dynamics collapse and rebound of tvc immediately downstream the blade could be clearly observed the collapse of cavities must have contributed to the broadband noise it is however impossible to verify any dynamic behavior of tvc from the full scale video recordings as the video images only show a foamy and persistent tvc see fig 12 above 100 hz the signal mainly consists of broadband noise and the noise level falls off approximately as 20 log 10 f as expected for a cavitating propeller to have a clearer picture about the agreement of the tonal noise predicted by the three methods the tones are compared with each other in fig 16 for the first five bpfs note that the cfd data in fig 16 are picked up exactly at the multiples of bpf while for the test data in reality some tones might have shifted slightly e g modulation effects making them not occurring exactly at the bpfs this is why there is some difference between the tones presented in fig 16 and those peaks shown in fig 15 for the blade rate fundamental tone there is a minor difference in level between figs 15 and 16 caused by using a different scaling method as explained below in the model tests aquo deliverable d2 4 2014 we found that the first order pressure pulses at atmospheric pressure are about the same level as with cavitation this behavior is also observed in the noise measurements this indicates that the propeller loading rather than the sheet cavitation is the main source of pressure pulses and noise at blade rate this makes the scaling of tonal noise for the lowest blade rate orders especially at br very doubtful it is usually better to estimate the non cavitating tonal noise using potential flow codes or empirical data correlations even if the presentation of scaled tones are questionable they are included in fig 16 for comparison with the cfd and sea trial data the br fundamental presented in fig 16 are scaled by eq 5 while the higher orders are scaled by eq 4 this choice is made after comparisons using sspa in house potential flow code for tonal noise the model test prognosis agrees fairly well with the sea trial in the frequency range 16 48 hz with the spiky tones at the first five orders of bpf clearly seen in fig 15 there is a substantially large discrepancy between the model test and the sea trial in frequency below 20 hz this might be caused by two reasons first according to johansson et al 2015 in the frequency range f 20 hz the processed noise from the full scale measurement is influenced by a likely underestimation of transmission loss correction therefore the processed sea trial data is likely lower than the reality second it is known from experience that the noise measured by model testing at frequency lower than the blade rate fundamental is affected by a contribution from background noise predominantly caused by the impeller operation in the cavitation tunnel thus the experimentally measured signal in the very low frequency range is unrealistic furthermore the model test underestimates the noise level for frequencies f 48 hz the underestimation level varies between 10 db and 20 db at frequency higher than 48 hz spectra contents quickly changes from tonal dominance to broadband dominance the underestimation here may be related to a somewhat under predicted tvc that is typically the case in a cavitation tunnel test due to reynolds scale effects on tvc another possible cause is that we have underestimated tl in model scale by the assumption of spherical spreading as for the noise predicted by the ddes fwh shown in figs 15 and 16 the predicted tone at the 1st bpf is certainly higher than the measured the agreement with the measured tones at the 2nd 5th bpf is fairly good but is slightly higher starting at the 8th bpf and above in the frequency range f 64 hz the predicted tones are lower than the sea trial data for the same reason as stated in the previous paragraph the discrepancy between the prediction and the sea trial data in the low frequency range f 20 hz is probably due to an underestimated transmission loss for the sea trial data therefore the ddes fwh computed data may be closer to the reality in this range with regard to broadband noise in the frequency range f 112 200 hz there is a close agreement with the sea trial data at frequencies above 200 hz the broadband noise becomes more and more under predicted with increasing frequency on the other hand in the frequency range 50 112 hz there is a significant under prediction of broadband noise the maximum under prediction is about 28 db at 72 hz based on the source identification analysis of the full scale data in fig 3 the high level noise in this range is mainly attributed to the persistent tip vortex cavitation observed in the sea trial recall that the ddes fwh has under resolved the tvc in the simulation the under prediction of noise in this range is thus an expected outcome similar under prediction is also observed for the pressure pulses due to the same reason in fig 13 at the 7th 12th order of bpf compared with the model test in the frequency range 64 104 hz where tip vortex cavitation has a dominant contribution the noise predicted by the ddes fwh is remarkably lower recall the prediction difference in the tvc between the model testing and the cfd in 5 2 that the tvc in the model test lasted at least half of blade revolution whereas the tvc survived only a short distance behind the blade tip in the simulation it is then not strange to see a much under predicted broadband noise in the simulation it is very clear from the comparison that if the flow details and tip vortex cavitation are not sufficiently resolved in a cfd simulation the broadband noise induced by tvc will not be well predicted overall it can be summarized that urn levels predicted by the model testing and the ddes fwh correlate reasonably well with the spectra characteristics observed in the sea trial but both methods underestimate the noise by a level 10 20 db for the model testing and 10 28 db for the ddes fwh in the critical low frequency range 0 200 hz 5 5 wake flow an impression of how well the turbulence vortex structures of different length scale are resolved in the wake of ship and propeller can be obtained by visualizing the iso surface of q criterion the q criterion is defined as q 0 5 ω 2 s 2 s 2 in which s is the strain rate and ω the vorticity rate magnitude the wake flow at the stern and downstream the propeller are shown in fig 17 with a q 200 as seen in the figure the tip vortices of helical form and the turbulence vortex structures in the near downstream region appear to be well resolved the small length scale eddies at side of and behind the rudder are clearly seen however they disappear in a short distance downstream the rudder indicating an insufficient resolution farther downstream the shielding function s ddes in eq 7 is an indicator for les resolved region when s ddes 1 the contour plots of s ddes distribution on the central plane in the range 1 s ddes 10 is shown in fig 18 the region of s ddes below 1 and above 10 was cut off in the plot thus the hollows next to the dark blue area correspond to the urans region s ddes 1 whereas the rest of color filled region including the hollows next to the red area s ddes 10 are the well resolved les regions the plot shows that there is a thin urans regions attached to the ship hull wall meaning that the boundary layer was properly solved by urans as expected the plot also reveals that there are undesirable urans regions hollows downstream the rudder beneath the propeller and the bottom of hull where the meshes were too coarse to trigger an les solution since these region are located inside the fwh integration domain where an les solution is desired this figure gives useful information on where the grid refinement is needed to further improve the resolution in les intended region 6 conclusions in this work the characteristics of the underwater radiated noise generated by a coastal tanker under design loading condition were studied with three different methods on site full scale measurement model testing in a cavitation tunnel and a hybrid cfd method consisting of a multi phase ddes solution and fwh acoustic analogy the correlation between the measured noise spectra and the observed cavitation behavior and pressure pulses were discussed although the full scale urn data might be affected by various environmental factors and the measured spectra may contain noise contribution from other possible sources with appropriate post processing and source identification the full scale data has been very useful reference for characterizing the noise signature and for benchmarking the model testing and computational methods though pressure pulses were picked up only at one location it still yields valuable information on the near field pressure fluctuations however to use more transducers would be of course better the underwater video recording was taken in ballast draft and it is well known that it is difficult to get clear enough pictures of the cavitation behavior under such conditions due to the amount of bubbles in the water near the surface a frame rate higher than the 25 hz standard video is necessary to give better spatial resolution of the blade positions the model testing predicted the occurrence of sheet cavitation and tvc the behavior of cavitation was partly confirmed by the full scale observation the predicted pressure pulses were somewhat higher than the full scale data overall the model testing predicted urn had a good correlation with the characters of noise spectra in full scale the maximum difference over the entire spectra is about 20 db for ddes fwh method the predicted sheet cavity agreed well with the one observed in the sea trial and in the model test the tvc was captured in the simulation but its strength and extension were less than that observed in the sea trial the pressure pulses were in close agreement with the measured ones at the first six order of bpf but under predicted at higher order the tonal noise had a fairly good agreement with the measured signal at the first five bpf due to the under resolved tvc the simulation under predicted the noise level in the frequency range 50 112 hz where the tvc is expected to have an important contribution the maximum under prediction in this range was about 28 db at 72 hz at frequencies above 200 hz the broadband noise becomes more and more under predicted with increasing frequency the first impression on the use of ddes fwh method for full scale simulations is that the method has shown the potential to resolve turbulence eddy structures capture subtle cavitation detail and make reasonably good prediction for pressure pulses and radiated noise simulation for full scale ships is much more challenging than for model scale ships due to the extreme high reynolds number and a much wider spectra of turbulence scales that need to be resolved in view of that this is one loading condition for one ship we consider it too early to draw a conclusion on the method more validation study is needed to assess the applicability of the ddes fwh method for full scale simulations today the use of the ddes fwh method is also limited in frequency to a few hundred hz due to the time and space resolution that is reasonable to use but this is expected to increase in the future acknowledgements the work was carried out within project aquo achieve quieter oceans by shipping noise footprint reduction funded by the european commission project reference 314227 under fp7 sst 2012 rtd 1 appendix a supplementary data the following is the supplementary data related to this article fig 3 fig fig 3 fig appendix a supplementary data supplementary data related to this article can be found at https doi org 10 1016 j oceaneng 2018 03 027 
23302,full scale measurement model testing and a hybrid cfd method were used to characterize the underwater radiated noise urn of a ship at design speed the cfd method consists of a multiphase delayed detached eddy simulation and the ffowcs williams hawkings acoustic analogy the paper discusses the correlation of the noise spectra with the observed cavitation behavior and compares the measured full scale data with those predicted by the model testing and the cfd method the comparison shows that the sheet cavity and tip vortex cavitation tvc predicted by the model testing are in reasonably good agreement with the full scale observations the pressure pulses are somewhat higher than the full scale data overall the predicted urn has a good correlation with the noise spectra obtained from the sea trial the cfd method shows the potential to resolve turbulence eddy structures in the wake it captures the dynamic development of sheet cavitation and the collapse and rebound of tvc as observed in the model test and the sea trial but under predicts the extent of tvc the pressure pulses and tonal noise are in close agreement with the respective measured data for the first five orders of blade passing frequency the method underestimates the broadband noise level in the frequency range 50 112 hz where the tvc is expected to have an important contribution the maximum under prediction in this range is about 28 db at 72 hz at frequencies above 200 hz the broadband noise becomes more and more under predicted with increasing frequency keywords underwater radiated noise cavitation ffowcs williams and hawkings ddes propeller 1 introduction the radiated noise from maritime shipping and seismic exploration of oil gas industry has become a growing environmental concern due to the potentially adverse effects on marine fauna shipping noise dominates the background noise below 300 hz in the seas according to hildebrand 2009 arveson and vendittis 2000 states that noise from commercial ships increases the ambient noise level by 20 30 db in many parts of the oceans the shipping noise has increased by 10 db from the 1960 s to the 1990 s according to measurements in the usa reported in andrew et al 2002 and mcdonald et al 2006 this is an increase by 3 db per decade international maritime organization imo is paying increasing attention to many hydro acoustic effects due to ship transportation imo 2014 released a non mandatory guidelines for the reduction of underwater radiated noise from commercial shipping in 2014 there is no doubt about the importance to understand the ship generated noise and its radiation characteristics to control and mitigate the noise from ships and propellers during and after design equally important is the model testing techniques and the computational tools that can reliably predict the noise generated by ships at various operating conditions before they are built among the noise sources generated by a propeller driven ship the propeller is recognized as a dominant source contributing to urn in the low frequency range cavitation can further enhance the radiated noise level over a wide frequency spectrum experiments are necessary to provide quantification of the noise spectra under the controlled laboratory environment for scaled physical models it normally requires the use of a large cavitation tunnel and a well established test set up that is able to mimic the ship wake and the cavitation condition as experienced by a full scale ship moreover a scaling procedure is needed to scale up the measured model scale data to the corresponding ship scale this is why that the prognosis made by model testing needs to be validated against full scale data with increasing level of complexity and capability to model the underlying physics computational tools used for urn prediction may be categorized in the following order a empirical semi empirical methods b boundary element method based on potential flow theory where turbulence and viscosity effects are ignored c hybrid cfd method that decouples the sound propagation from its source generation allowing to separate the flow solution from the acoustic analysis the viscous flow field where the sound source is generated is solved by a cfd method with an appropriate turbulence model and the sound propagation is treated by an integral method based on acoustic analogy d direct numerical simulation dns to resolve the full spectra of noise the dns is by far the most costly method with respect to the grid resolution and cpu cores needed and it is still far beyond the affordability of engineering applications the hybrid method represents the state of the art approach for acoustic analysis depending on how various turbulence length scales are modelled or resolved the cfd method can be further classified as 1 reynolds averaged navier stokes rans method or unsteady rans urans method if the flow is treated unsteady 2 delayed detached eddy simulation ddes and 3 large eddy simulation les only the last two methods have the potential to resolve a variety of length scales of turbulence structures in the wake of hull and propeller the vorticity and turbulence structures in the wake of hull and propeller may give a significant contribution to the broadband noise even if such quadropole sources are less efficient sources than propeller cavitation monopole and non cavitating blade tonals dipole further the hull wake is very important for the cavitation dynamics therefore it is crucial to resolve these structures for a high fidelity cfd method aiming to predict a wide spectrum of tonal and broadband noise the les method requires very finesh and very small time step resolution as compared with the other methods the computing time and requirement on hardware can become prohibitive for calculation of a full scale ship including propeller cavitation phenomenon on the other hand the ddes method combines the advantages of rans or urans and les it resolves the flow with an les alike model in the crucial regions e g separation or wake region and solves the rest of the fluid domain with a rans or urans method in the present work we adopt a ddes method that uses a urans les combination coupled with the acoustic analogy based on a formulation of ffowcs williams and hawkings 1969 fwh the commercial software ansys fluent is used with regard to acoustic analogy a relatively new formulation of fwh integration called permeable or porous formulation and proposed first by di francescantonio 1997 is of particular interest it allows for the selection of source integral surfaces not only on solid body surfaces but also on permeable surfaces interior to fluid domain integration over a permeable surface allows to account for the contribution of non linear terms resulting from the instantaneous shear stress and vorticity content within a highly turbulent fluid domain enclosed by the permeable surface the wake of a ship hull and a propeller is such a kind of domain the methodology of hybrid cfd approach was originally developed for aero acoustic calculations at medium to high mach numbers its application in hydro acoustics is rather new and starts to grow only in recent years the application of the permeable formulation for non cavitating propellers was explored by testa et al 2008 and further investigated by ianniello et al 2013 2014a and 2014b in which the contribution of nonlinear quadrupole sources was emphasized and the inadequacy of urans methods to resolve turbulence structures was addressed more recent endeavors include the work of bensow and liefvendahl 2016 who developed an les fwh methodology for prediction of cavitating propeller radiated noise and compared with model test data lidtke et al 2016a 2016b who studied the feasibility of an les fwh approach for noise and cavitation modelling of hydrofoils and marine propellers and özden et al 2016 in which a urans fwh method was applied to predict noise created by a non cavitating submarine propeller behind a generic darpa suboff submarine there was however no validation for propeller noise in the wake in the last three papers in survey of open literature it is clear that too few noise data from sea trial is available for validation of predictive tools for full scale predictions in our previous work hallander et al 2012 a urans method coupled with fwh s acoustic analogy was applied to predict the noise generated by a full scale lng ship with a cavitating propeller although an overall agreement was achieved the study revealed an under prediction of radiated noise by 25 db of the measured full scale data it was realized that the inability to resolve turbulent wake structures of different length scales was the primary limitation of urans methods this becomes the drive to move from urans to ddes approach in the present work the eu fp7 framework project aquo achieving quieter oceans aquo 2012 formed dedicated work packages to conduct sea trials experiments in model scales improvement and validation of numerical methods to predict urn from propellers including cavitation effect and interaction with ship hull sspa was engaged in the model testing full scale measurement and numerical simulation of a coastal tanker equipped with a controllable pitch cp propeller running at a constant rpm the full scale data collected in this project offers an excellent opportunity for us to assess and validate the prediction made by model testing and computational methods prior to the model testing six representative loading conditions were defined in table 2 for the experiment campaign and the full scale measurement carried out later loading condition 1 lc1 represents the case at design speed and design draft and lc2 represents the condition at ballast draft in both cases the propeller suffers cavitation as is well known cavitation on propeller has a significant contribution to the radiated noise for numerical methods there are still a number of challenges in modelling the dynamics of cavitation phenomena and radiated noise because of the complex mechanism involving the turbulence fluctuations in the flow over a wide range of length and time scales from the predictive point of view it is very interesting to see how well the cavitation and its induced noise can be reproduced by the model testing and predicted by the numerical methods pressure pulses on hull plate become more pronounced when cavitation take place on blades hence prediction of pressure pulses is another topic of interest in the present study the validation of the model testing and cfd methods for this ship in model scale have been reported in hallander and johansson 2015 tani et al 2016 li et al 2014 2015a and 2015b this work is a continuation of previous validation work aiming to assess the prediction performance of the method for full scale ship in design speed while the model testing predictions have been validated many times with sea trial data before it is the first time attempt to validate the ddes fwh method for prediction of urn in full scale the paper is organized as follows the full scale measurement and the model testing setup are introduced in section 2 and 3 briefly followed by a description of the cfd method in section 4 section 5 is devoted to the comparison of results between the methods discussions are also made of the correlation between the propeller loading the noise signature and the observed cavitation behavior conclusions are drawn in section 6 2 on site full scale measurement 2 1 ship and propeller data the subject ship is an oil chemical tanker m t olympus operating along coastlines she is equipped with a four bladed controllable pitch cp propeller and powered by a single diesel engine running at a constant 120 rpm the main dimensions are given in table 1 2 2 measurement and post processing underwater radiated noise was measured at a flat seabed area of depth 40 60 m near lysekil on the swedish west coast during the urn measurements the ship did one port and one starboard passage at 15 kn lc1 and one port and one starboard passage at 11 kn lc5 three sparton phod 1 hydrophones were suspended to a float and moored on a 20 kg bottom weight at 43 m depth fig 1 a cables were run to the nearest point on land approximately 150 m away where the signals were converted and stored to a pc the losses of preamplifiers and cables were measured by insert voltage calibration speed shaft power rpm and propeller pitch were recorded to an on board data logging system synchronized to the urn recording system structural vibration were measured with accelerometers at some locations visualization of cavitation was provided by a standard video camera mounted in an underwater housing and attached to a clamp on the hull as marked by a yellow circle in fig 2 a pressure pulse sensor was mounted on the camera housing the analysis of the recorded urn data followed the measurement standard proposed in aquo d3 1 2014 to cover the directivity effects a rake of seven monitoring locations was defined on either side of the ship in parallel with the center line the locations relative to the acoustic center ac of the ship are illustrated in fig 1 b the ac is defined at the ship center line 10 m distance forward of aft perpendicular ap at the rudder stock the propeller generator plane is 3 0 m forward of ap and the main engine center is approximately 17 m forward of ap the average spectrum of sound pressure data in each data window and for each hydrophone was calculated using welch s method with 50 overlap and 2 s hamming windows spectra are presented as power spectral density psd unless otherwise indicated the spectra were corrected for the influence of background noise using previously measured background noise levels source level spectra were estimated by correcting for measured transmission loss source level spectra were averaged across hydrophones finally the mean spectra and directivity envelope spectra the maximum level at each frequency were calculated from all data windows for each condition for further detail see johansson et al 2015 comparisons in this paper with model testing and cfd predictions were made using the mean spectra due to logistical reasons and weather conditions the cavitation observation and pressure pulses were measured in ballast condition lc2 and lc6 in table 2 while the underwater radiated noise were measured at design draft lc1 and lc5 in table 2 2 3 characterization of urn spectra apart from propeller there are a few other noise sources onboard a ship in general the main and auxiliary engines are the most important ones while pumps electric motors and the flow noise induced in the turbulent boundary layer and the wake of the hull and appendages usually play a minor role for commercial ships the noise spectra measured in a sea trial is a superimposition of the signals arising from all these possible sources hence the noise spectra from a sea trial have always a very complex and varying nature to distinguish the noise contribution from different sources the peaks and components in the spectra were compared with the operation frequencies of onboard machineries and their expected noise character as a result the tonal and broadband noise from propeller and cavitation if any can be identified from this complex noise spectra an example of the source identification diagram in low frequency range is shown in fig 3 for the loading condition lc1 see table 2 since the shaft revolution rate was constant at 120 rpm in the tested cases and the propeller has 4 blades the blade passing frequency bpf or blade rate br frequency is 8 hz the propeller br tonal noise up to fifth order are clearly seen in fig 3 with peaks from other sources appearing in between it can be confirmed for this ship that the tones at harmonics of propeller bpf are the dominant noise in frequency below 60 hz it is also observed that the highest noise level occurs in the range 40 100 hz due to the additional contribution of cavitation noise in this loading condition more detail can be found in johansson et al 2015 and tani et al 2016 the urn amplitudes from propeller and main engine are generally stronger after cpa than before naturally the envelope is higher than the mean 3 model testing 3 1 loading conditions the two loading conditions lc1 and lc2 of relevance to the present study are given in table 2 together with other loading conditions in the table they represent the typical scenario of the ship s operational profiles lc1 and lc2 correspond to the loading of ncr power with 15 sea margin at design speed in design and in ballast draft respectively the cavitation number σ is defined at the depth of the propeller shaft using the advance velocity v a at propeller plane 3 2 test set up the complete ship model was mounted at even keel design draft in the large test section of sspa s cavitation tunnel see fig 4 this mounting is used for all draft conditions due to practical reasons according to sspa standard practice meshes were mounted on the aft part of the hull for the purpose of increasing the turbulence of the flow the propeller was painted in red according to sspa standard for cavitation tests this red paint adds a certain roughness ra of a few μm which stimulates the turbulence and reduces the cavitation intermittency the propeller model was powered by an ac motor and the thrust and torque were measured by a kempf remmers type r46 dynamometer the motor and dynamometer are submersible and were mounted inside the water filled model the tunnel water speed was kept constant at 4 5 m s during the tests and operating points were obtained varying propeller rpm in order to reach thrust identity reference point for the computation of ship cavitation index is propeller axis in accordance to sspa usual practice eight pressure transducers are flush mounted on the ship model right above the propeller to assemble the pressure pulses on the hull noise measurements were carried out using three hydrophones brüel kjær type 8 103 attached to wing profile swords mounted in the cavitation tunnel see fig 4 the propeller acoustical center ac was assumed to be at 0 blade position and r r 0 7 the location of pressure transducer and resulting distance between the ac and the hydrophones are sketched in fig 5 a and b the complete detail of the model test is reported in aquo deliverable d2 4 2014 and partly described in tani et al 2016 3 3 results presentation and scaling method for full scale prognosis the procedure for post processing and result presentation follows the ittc guidelines for model scale noise measurements ittc 2017 the sound pressure power spectral density φ f in pa2 hz is computed from each sound pressure signal p t using welch s method of averaging modified spectrograms the sound pressure level spl at receiver hydrophone location is equal to the sound pressure power spectral density level in 1 hz bandwidth 1 s p l f 10 log 10 φ f p r e f 2 db re 1 μpa 2 hz where the reference pressure is defined as p ref 1 μpa the background noise measurements were performed with a dummy hub on the shaft at corresponding loading conditions in terms of shaft speed and cavitation number the model scale frequency spectra to be scaled to full scale were corrected for background noise according to ittc 2017 the source level sl is defined as the spl corrected for the transmission loss tl 2 s l s p l t l db re 1 μpa 2 hz sspa normally assess tl by measuring the transfer function in the cavitation tunnel using a known sound source at different locations in the propeller disc e g briançon et al 2013 however in the actual measurements some equipment was broken and we did not have the time to replace and calibrate thus tl was estimated with spherical spreading 20 log 10 r where r is the distance between hydrophone acoustic center and the acoustic center of the propeller by experience from other tests e g tani et al 2016 we know that the application of spherical spreading can differ several db from a measured transfer function thus it is likely that the noise levels at low medium frequencies predicted from model tests should be increased by 5 6 db calculations of full scale spectra were based on the hydrophone k79 only due to signal to noise ratio reasons under the condition that cavitation number is retained the same for model and full scale the model scale noise signal is scaled to full scale one according to the following scaling law for the frequency 3 f s f m n s n m and for the source level for a continuous spectrum of constant bandwidth 4 s l s s l m 20 log 10 r m r s ρ s ρ m d s d m 3 n s n m 1 5 db re 1 μpa 2 hz where n shaft revolutions hz d propeller diameter m ρ water density kg m3 r propeller hydrophone relative distance in m the subscripts m and s denote model scale and full scale respectively for tonal components line spectra at low frequencies bark 1988 derived 5 s l s s l m 20 log 10 r m r s ρ s ρ m d s d m 3 n s n m 2 db re 1 μpa 2 hz this is valid under the assumption that the source is a monopole i e the sheet cavitation is the dominating source however the blade rate components also contains a contribution from the non cavitating noise generated by the blade which has a dipole character further the amplitudes of the tonal noise are sensitive to the choice of fft length used which gives the frequency resolution in the analysis thus one should be careful with presenting scaled tones in narrowband data ittc 2017 4 computational method 4 1 the ddes fwh methodology the detail formulations for the numerical methods used in the current study are described in ansys fluent s user manual 2014 and are not repeated only the solution idea is explained below ddes is a hybrid method that applies a urans to the near wall region and an les to the region of a separated flow or a wake provided that in the latter region the grid is fine enough to allow for a meaningful les resolution urans is also engaged in solving the flow in the far field where grid sizes grow large for turbulence modelling in the urans mode sst k ω turbulence model is employed in the les region the subgrid scale turbulent viscosity is determined by the transport equation for k and ω in a similar way to the sst k ω model the difference is that a special grid size based criterion is introduced into the dissipation term y k in the k equation to activate the switch between the urans and les mode the reformulated dissipation term reads 6 y k ρ β k ω s d d e s where ρ is the density of the multiphase mixture flow and β is a model constant β 0 09 the switch between the urans and the les mode depends on the local grid sizes and their relative distances to the wall boundary it is controlled by the shielding function s ddes in eq 6 expressed as 7 s d d e s m a x l t c d e s δ m a x 1 f d d e s 1 the c des is a calibration constant 0 61 used in the ddes model and δ max is the maximum local grid cell spacing of δ x δy δz the l t is the turbulent length scale defined in the urans solution the function f ddes is designed in such a way to give f ddes 1 inside the boundary layer and ensures that les mode will not be activated inside the boundary layer hence avoiding or delayed the undesirable grid induced separation and f ddes 0 away from the wall to regain the original form of des shielding function the permeable form of fwh s surface integration allows to account for the important contribution from the instantaneous shear stress and vorticity content both being quadrupole type of noise sources in a flow field that is enclosed by the permeable surface in the present work since a rectangular domain closely around the ship is defined as an les solution domain the surface of this domain becomes the natural choice for permeable surface this surface is shown in fig 6 by the small rectangle around the ship also seen in the cross section view in fig 7 as marked by red lines theoretically the quadrupole source contributions imbedded in the boundary layer and the wake of ship and propeller within the les domain are taken into account by the fwh s surface integration whereas the quadrupole contributions outside the les domain are neglected the location of the fwh integration surface and the size of les domain selected in the present work are based on our understanding to the flow region of importance to urn and also some experience from the early work with a urans fwh method hallander et al 2012 at present there is no consensus on how far away the fwh integration surface should be placed hence the influence of the permeable surface location is still subjected to further studies cavitation is modelled by solving an additional transport equation for the vapor volume fraction vof including a mass transfer model for the liquid and vapor phases the employed mass transfer model is based on zwart s formulation further details on the cavitation model and the formulation for the permeable form of fwh s surface integration are referred to fluent s user manual 2014 the numerical schemes used are as follows multiphase mixture flow incompressible solver pressure and velocity solved in a coupled manner bounded 2nd order central difference for convection terms in momentum equations quick scheme in other transport equations propeller rotation handled by sliding mesh technique bounded 2nd order implicit scheme for time derivative final time step 6 94 10 4 s corresponding to a blade rotation of 0 5 per time step 12 inner iterations within each time step with the above time step the courant number is less than unity as required by the les solution moreover the highest resolvable frequency of noise spectra becomes 720 hz a complete solution for urn is accomplished in three steps firstly an urans calculation is performed until that the flow is nearly converged and that a urans turbulent length scale is properly defined the running time corresponds to about 2 propeller revolutions this precursor urans calculation serves as the initial flow field to the ddes simulation secondly the ddes solver is switched on and the simulation goes on for a time equivalent to about 2 3 propeller revolutions with the present numerical settings the thrust and torque coefficient kt and kq normally reach their periodic convergence within this time frame lastly fwh s acoustic analogy is switched on to start numerical integration of sound pressure on the predefined permeable surfaces the simulations in the last step usually continue for about 5 8 propeller revolutions 4 2 computational domain and boundary conditions computations were performed for loading condition lc2 the computational domain and its boundaries are shown by the large rectangle in fig 6 the inlet boundary is located at 1l pp fore of fp and the outlet boundary 1 5l pp aft of ap the two sides and the bottom of the domain are placed 1l pp away from the central line respectively a smaller rectangular domain closely surrounding the hull is also visible in fig 6 it has two roles meshes are highly refined in this domain to facilitate an les resolution the domain boundaries serve as the permeable integral surfaces for the fwh acoustic integration the still water surface is defined as a symmetry boundary free surface effects are assumed to have negligible effect on radiated noise as is often treated so in the noise measurement in cavitation tunnels for simulation it is then mainly to avoid excessively large amount of grid refinement needed to resolve the free surface the boundary conditions and initial conditions are specified in table 3 4 3 computational meshes all meshes were of hexahedral type generated by ansys icemcfd the meshes were refined not only in the wall normal direction to achieve a y 1 but also in the streamwise and girthwise direction to fulfil grid requirement for the ddes method there were some difficulties with ansys icemcfd in generating a valid mesh near the free surface at stern for ship hulls at ballast draft with a rotating propeller this was the case for lc2 if the hull were placed at the ballast draft it would be almost impossible to accommodate a cylindrical grid domain the sliding mesh containing the propeller in the stern region the grids outside the cylindrical domain would also become highly skewed hence the free surface of the computational domain was raised upwards to a draft at 7 4 m closer to the design draft of 8 1 m in lc1 the trim was kept the same as in reality a grid cut off at the central plane is shown in fig 7 and the surface meshes for the blades and the rudder are displayed in fig 8 the total number of cells is about 47 million for lc2 due to the stringent requirement on grid resolution in the les zone and on courant number very small time step has to be used for an already very large sized grid it becomes unrealistic to perform a systematic grid refinement study for this kind of simulations only two mesh variations were exercised for the model scale cases at the beginning of the work the finer mesh was chosen for subsequent simulations in model scale the results with the fine mesh 35 million cells was presented in li et al 2014 validation including grid sensitivity studies for steady non cavitating and cavitating flows around propellers with ansys fluent s urans method have been performed earlier in our work in li 2006 and li et al 2006 2012 compared with the grids used in the previous work the grid spacing used in the present work was much finer and the total mesh size is about 9 10 times larger than what is normally used for a urans calculation including propeller geometry 5 results and discussions in this section the predicted and the observed cavitation behavior is studied first then the pressure pulses and urn predicted by the ddes fwh method and the model testing are compared with the full scale measured data their correlation with the observed cavitation is also discussed the same monitor locations as defined and used for post processing the sea trial data see fig 1b are used to acquire the receiver level noise in the simulations noise signal is presented at source level sl in form of power spectral density of sound pressure in narrow band frequency throughout the paper the full scale measurement is denoted by sea trial lc1 or lc2 the prediction by the model testing and the cfd is denoted as mt prognosis and ddes fwh respectively the pressure pulses are presented as single amplitude with respect to the order of blade passing frequency it should be mentioned that the cfd predicted urn in lc2 are compared with the full scale measured one in lc1 since no noise measurement was made during the sea trial for lc2 due to weather conditions and logistical reasons moreover there seems to be a fairly close similarity in the main characters between these two conditions that allows for such a cross comparison referring to the specification for lc1 and lc2 in table 2 the propeller has the same pitch ratio p d and same shaft power in the two conditions and the ship speed differs by ca 1 knot the main operational differences between lc1 and lc2 are the draft and trim while it is true that the radiated noise can be quite different between the design and the ballast draft condition due to the likely difference in the wake field and the difference in cavitation number for the subject ship however the model test results of wake measurement in the towing tank revealed that the wake field for lc1 and lc2 had a very similar pattern as documented in annex c of aquo d2 4 2014 during the cavitation tests it was observed that the cavitation characters for lc1 and lc2 were close to each other due to a rather limited difference in the hydrostatic pressure that affecting cavitation number caused by the difference in propeller immersion therefore we believe that the main characteristics in cavitation pressure pulses and radiated noise between lc1 and lc2 are similar to each other of course there must be local discrepancies and variations between these two conditions hence the model test urn data for both lc1 and lc2 are included in the comparison to reveal not only their similarity but also the local discrepancy 5 1 convergence of the ddes solution convergence histories of all the residuals are presented in fig 9 for a time period corresponding to the last four propeller revolutions as seen in the figure all the residuals seem to have reached their stabilized levels for the period compared with their initial value of one 1 not shown in fig 9 the residuals have decreased to different extent of lower levels the residuals for the momentum equation for x y and z velocity have dropped to the order of 10 9 the residuals for turbulence transport equation k and omega are well below 10 6 the residual for the continuity equation is under 10 4 they all demonstrate a well converged behavior the residual for the transport equation of vapor volume fraction vf vapor in fig 9 has dropped only to a level of 10 3 this is typical of use of quick scheme for the convection term in the vapor volume fraction equation therefore the iterative solution for the linearized equation system is considered to be well converged the time history of the cfd predicted thrust and torque coefficient kt and kq for the last four propeller revolutions are shown in fig 10 it can be seen that kt and kq vary around a mean value in a periodic manner with each period corresponding to the blade passing period of 0 125s also plotted in the figure dash lines are the measured values from the model testing during the noise measurement the averaged kt and kq predicted by the cfd method are compared with the measured data in table 4 showing a slight over prediction of kt by 1 3 and kq by 0 6 in addition to the global force like kt the convergence behavior of pressure pulse at a few transducer locations was also monitored fig 11 presents an example of the time history of pressure pulse signal at a location corresponding to the transducer location f see sketch in fig 5a in the model test again a periodic variation of pressure with the blade passing period of 0 125s is obviously present demonstrating the convergence behavior of local variables in the flow field note that each wave form of the periodically varying pressure is not identical from cycle to cycle and there exist small oscillations at the crest of the pressure signals these features are the consequence of cavitation dynamics during the collapse and rebound of the tvc to be discussed next due to same reason a tiny irregularity in the wave form of kt and kq curves could also be noticed in fig 10 there is no time history data for the lighthill tensor stored during the simulation judging from the convergence behavior of velocity and pressure field it is believed that the lighthill tensor should have reached a good convergence too as the tensor is essentially a function of velocity velocity gradient and turbulent viscosity overall it can be stated that the ddes fwh solution is well converged 5 2 cavitation behavior cavitation observed by the three methods are compared with each other in fig 12 for the blade angular position at θ 30 50 and 70 respectively note that the propeller is left handed rotating so the blade angle is defined to increase from θ 0 at 12 o clock position in the anti clockwise direction when seen from behind propeller the video from sea trial doesn t contain any blade position information hence the blade position from the sea trial is very approximate the cavitation is characterized as a narrow sheet cavity on the suction side starting from blade position at θ 0 at radius r 0 9r its extension varies as the blade passes the wake peak finally starting at blade position θ 50 the cavity rolls up into a cavitating tip vortex visible until θ 70 cavitation diminishes as the blade rotates beyond position θ 70 in general the sheet cavity predicted by the model testing and the simulation agrees well with that observed in the sea trial the sheet cavity predicted by the model testing reveals a bit more dynamics and intermittency especially at θ 0 whereas the sheet cavity predicted by ddes fwh is rather stable the blade position where it reaches its maximum extension differs somewhat from that observed in the model test furthermore both predictions seem to have under predicted the tip vortex cavity tvc in the full scale observation the tip vortex cavity survives farther downstream and looks stable but quite foamy in the model test a dynamically bursting behavior is noted and the tvc lasts about half of blade revolution but appears to vanish a bit earlier than the full scale tvc this behavior is typical in a cavitation tunnel test due to reynolds number scale effects on tvc in the simulation dynamic rebound and collapse of tvc volume is observed as the blade leaves the wake peak the extension of the predicted tvc is however substantially shorter than that observed in the sea trial and the model test as marked in red ovals in fig 12 with this in mind it is logical to expect that the part of broadband noise that is caused by tip vortex cavity will become under predicted by the simulation 5 3 pressure pulses the full scale pressure pulses were measured at only one location corresponding closely to the transducer location f in the model testing setup fig 5a the measured signal is compared with those predicted by the ddes fwh and by the model testing at transducer f in fig 13 the plot for the sea trial and cfd data includes pressure amplitudes at the harmonics order up to 12th whereas the data from the model test prediction is available up to 5th order only the agreement at the 1st and 6th harmonic mode is very good between the ddes fwh and the full scale data the amplitudes for the 2nd to 5th harmonics is slightly higher than the full scale ones starting from the 7th up to 11th order the amplitude is however considerably under predicted the reason of which is discussed in connection with the under prediction of broadband noise later the pressure pulses predicted by the model test follow the trend reasonably well too but the amplitudes are somewhat more over predicted at the 3rd 4th and 1st order harmonics whereas at the 5th order there is a perfect match 5 4 underwater radiated noise urn the source level psds predicted by the ddes fwh averaged over the signal obtained from all receiver locations are compared with the averaged source level full scale noise in fig 14 the figure yields an overview of the correlation between the predicted and the measured full scale noise in a frequency range up to 1 000 hz in log scale the same spectra in the low frequency range up to 200 hz are plotted in fig 15 to highlight the correlation in the most critical frequency range in this figure the vertical grid lines are drawn intentionally at the multiples of bpf to help distinguish the propeller tones at harmonics of bpf from tones induced by other onboard machinery as they are also present in the measured full scale spectra but not in the predictions from the cfd and the model test the predictions made by the model testing in figs 14 and 15 are based on eq 4 in order to scale the broadband cavitation noise correctly following characteristics of the full scale measured noise are observed at frequencies f below 48 hz the spectrum is mainly represented by tonal noise of various sources the highest level over the entire spectra occurs in the frequency range 48 100 hz and the spectrum appears to be a mixture of peaks and broadband noise the high level in this range is believed to be associated with both the sheet cavitation on blade and the intermittently bursting tvc during the model test some dynamics collapse and rebound of tvc immediately downstream the blade could be clearly observed the collapse of cavities must have contributed to the broadband noise it is however impossible to verify any dynamic behavior of tvc from the full scale video recordings as the video images only show a foamy and persistent tvc see fig 12 above 100 hz the signal mainly consists of broadband noise and the noise level falls off approximately as 20 log 10 f as expected for a cavitating propeller to have a clearer picture about the agreement of the tonal noise predicted by the three methods the tones are compared with each other in fig 16 for the first five bpfs note that the cfd data in fig 16 are picked up exactly at the multiples of bpf while for the test data in reality some tones might have shifted slightly e g modulation effects making them not occurring exactly at the bpfs this is why there is some difference between the tones presented in fig 16 and those peaks shown in fig 15 for the blade rate fundamental tone there is a minor difference in level between figs 15 and 16 caused by using a different scaling method as explained below in the model tests aquo deliverable d2 4 2014 we found that the first order pressure pulses at atmospheric pressure are about the same level as with cavitation this behavior is also observed in the noise measurements this indicates that the propeller loading rather than the sheet cavitation is the main source of pressure pulses and noise at blade rate this makes the scaling of tonal noise for the lowest blade rate orders especially at br very doubtful it is usually better to estimate the non cavitating tonal noise using potential flow codes or empirical data correlations even if the presentation of scaled tones are questionable they are included in fig 16 for comparison with the cfd and sea trial data the br fundamental presented in fig 16 are scaled by eq 5 while the higher orders are scaled by eq 4 this choice is made after comparisons using sspa in house potential flow code for tonal noise the model test prognosis agrees fairly well with the sea trial in the frequency range 16 48 hz with the spiky tones at the first five orders of bpf clearly seen in fig 15 there is a substantially large discrepancy between the model test and the sea trial in frequency below 20 hz this might be caused by two reasons first according to johansson et al 2015 in the frequency range f 20 hz the processed noise from the full scale measurement is influenced by a likely underestimation of transmission loss correction therefore the processed sea trial data is likely lower than the reality second it is known from experience that the noise measured by model testing at frequency lower than the blade rate fundamental is affected by a contribution from background noise predominantly caused by the impeller operation in the cavitation tunnel thus the experimentally measured signal in the very low frequency range is unrealistic furthermore the model test underestimates the noise level for frequencies f 48 hz the underestimation level varies between 10 db and 20 db at frequency higher than 48 hz spectra contents quickly changes from tonal dominance to broadband dominance the underestimation here may be related to a somewhat under predicted tvc that is typically the case in a cavitation tunnel test due to reynolds scale effects on tvc another possible cause is that we have underestimated tl in model scale by the assumption of spherical spreading as for the noise predicted by the ddes fwh shown in figs 15 and 16 the predicted tone at the 1st bpf is certainly higher than the measured the agreement with the measured tones at the 2nd 5th bpf is fairly good but is slightly higher starting at the 8th bpf and above in the frequency range f 64 hz the predicted tones are lower than the sea trial data for the same reason as stated in the previous paragraph the discrepancy between the prediction and the sea trial data in the low frequency range f 20 hz is probably due to an underestimated transmission loss for the sea trial data therefore the ddes fwh computed data may be closer to the reality in this range with regard to broadband noise in the frequency range f 112 200 hz there is a close agreement with the sea trial data at frequencies above 200 hz the broadband noise becomes more and more under predicted with increasing frequency on the other hand in the frequency range 50 112 hz there is a significant under prediction of broadband noise the maximum under prediction is about 28 db at 72 hz based on the source identification analysis of the full scale data in fig 3 the high level noise in this range is mainly attributed to the persistent tip vortex cavitation observed in the sea trial recall that the ddes fwh has under resolved the tvc in the simulation the under prediction of noise in this range is thus an expected outcome similar under prediction is also observed for the pressure pulses due to the same reason in fig 13 at the 7th 12th order of bpf compared with the model test in the frequency range 64 104 hz where tip vortex cavitation has a dominant contribution the noise predicted by the ddes fwh is remarkably lower recall the prediction difference in the tvc between the model testing and the cfd in 5 2 that the tvc in the model test lasted at least half of blade revolution whereas the tvc survived only a short distance behind the blade tip in the simulation it is then not strange to see a much under predicted broadband noise in the simulation it is very clear from the comparison that if the flow details and tip vortex cavitation are not sufficiently resolved in a cfd simulation the broadband noise induced by tvc will not be well predicted overall it can be summarized that urn levels predicted by the model testing and the ddes fwh correlate reasonably well with the spectra characteristics observed in the sea trial but both methods underestimate the noise by a level 10 20 db for the model testing and 10 28 db for the ddes fwh in the critical low frequency range 0 200 hz 5 5 wake flow an impression of how well the turbulence vortex structures of different length scale are resolved in the wake of ship and propeller can be obtained by visualizing the iso surface of q criterion the q criterion is defined as q 0 5 ω 2 s 2 s 2 in which s is the strain rate and ω the vorticity rate magnitude the wake flow at the stern and downstream the propeller are shown in fig 17 with a q 200 as seen in the figure the tip vortices of helical form and the turbulence vortex structures in the near downstream region appear to be well resolved the small length scale eddies at side of and behind the rudder are clearly seen however they disappear in a short distance downstream the rudder indicating an insufficient resolution farther downstream the shielding function s ddes in eq 7 is an indicator for les resolved region when s ddes 1 the contour plots of s ddes distribution on the central plane in the range 1 s ddes 10 is shown in fig 18 the region of s ddes below 1 and above 10 was cut off in the plot thus the hollows next to the dark blue area correspond to the urans region s ddes 1 whereas the rest of color filled region including the hollows next to the red area s ddes 10 are the well resolved les regions the plot shows that there is a thin urans regions attached to the ship hull wall meaning that the boundary layer was properly solved by urans as expected the plot also reveals that there are undesirable urans regions hollows downstream the rudder beneath the propeller and the bottom of hull where the meshes were too coarse to trigger an les solution since these region are located inside the fwh integration domain where an les solution is desired this figure gives useful information on where the grid refinement is needed to further improve the resolution in les intended region 6 conclusions in this work the characteristics of the underwater radiated noise generated by a coastal tanker under design loading condition were studied with three different methods on site full scale measurement model testing in a cavitation tunnel and a hybrid cfd method consisting of a multi phase ddes solution and fwh acoustic analogy the correlation between the measured noise spectra and the observed cavitation behavior and pressure pulses were discussed although the full scale urn data might be affected by various environmental factors and the measured spectra may contain noise contribution from other possible sources with appropriate post processing and source identification the full scale data has been very useful reference for characterizing the noise signature and for benchmarking the model testing and computational methods though pressure pulses were picked up only at one location it still yields valuable information on the near field pressure fluctuations however to use more transducers would be of course better the underwater video recording was taken in ballast draft and it is well known that it is difficult to get clear enough pictures of the cavitation behavior under such conditions due to the amount of bubbles in the water near the surface a frame rate higher than the 25 hz standard video is necessary to give better spatial resolution of the blade positions the model testing predicted the occurrence of sheet cavitation and tvc the behavior of cavitation was partly confirmed by the full scale observation the predicted pressure pulses were somewhat higher than the full scale data overall the model testing predicted urn had a good correlation with the characters of noise spectra in full scale the maximum difference over the entire spectra is about 20 db for ddes fwh method the predicted sheet cavity agreed well with the one observed in the sea trial and in the model test the tvc was captured in the simulation but its strength and extension were less than that observed in the sea trial the pressure pulses were in close agreement with the measured ones at the first six order of bpf but under predicted at higher order the tonal noise had a fairly good agreement with the measured signal at the first five bpf due to the under resolved tvc the simulation under predicted the noise level in the frequency range 50 112 hz where the tvc is expected to have an important contribution the maximum under prediction in this range was about 28 db at 72 hz at frequencies above 200 hz the broadband noise becomes more and more under predicted with increasing frequency the first impression on the use of ddes fwh method for full scale simulations is that the method has shown the potential to resolve turbulence eddy structures capture subtle cavitation detail and make reasonably good prediction for pressure pulses and radiated noise simulation for full scale ships is much more challenging than for model scale ships due to the extreme high reynolds number and a much wider spectra of turbulence scales that need to be resolved in view of that this is one loading condition for one ship we consider it too early to draw a conclusion on the method more validation study is needed to assess the applicability of the ddes fwh method for full scale simulations today the use of the ddes fwh method is also limited in frequency to a few hundred hz due to the time and space resolution that is reasonable to use but this is expected to increase in the future acknowledgements the work was carried out within project aquo achieve quieter oceans by shipping noise footprint reduction funded by the european commission project reference 314227 under fp7 sst 2012 rtd 1 appendix a supplementary data the following is the supplementary data related to this article fig 3 fig fig 3 fig appendix a supplementary data supplementary data related to this article can be found at https doi org 10 1016 j oceaneng 2018 03 027 
23303,when solving a vibroacoustic problem in a physical system a fundamental goal is to determine how energy is transmitted from a given source to any part of the system this enables the modifications needed to reduce noise or vibration levels in each system component numerical techniques such as finite element method fem and statistical energy analysis sea can predict the vibroacoustic behavior of the system yet they do not directly reveal which part of the system shall be modified the energy transmitted via the path that connects a source and a target subsystem component can be determined numerically finding the dominant paths that contribute the most to the total energy transmitted between a source and target is more art than science finding the dominant paths usually depends on an engineer s expertise and judgement thus a systematic approach to automatically identify those paths would be beneficial graph theory provides a solution to this problem because powerful path algorithms for graphs have already been developed in this study a systematic procedure for ranking the dominant energy paths in a vibroacoustic model is developed by using existing graph theory and sea graph approaches to extend the use and performance of this application specific approach which investigates the vibroacoustic behavior of a ship structure a research ship has been modelled via a sea model for mid and high frequency ranges then the structure borne energy transmission paths from a vibration source to the keel bottom underwater hull plates are determined and ranked by their energy output next the process identifies the structural elements that need to be modified to reduce the overall energy levels a parametric approach is then used to modify these ideal candidates using a representative fem model finally the modelling results verify that the path modified ship structure has reduced the structural vibration energy levels thus by using and extending the pre existing graph theory algorithm the vibroacoustic behavior of complex ship structures is predicted the energy output of each path is found and the problematic paths are modified during the ship design phase to ensure that vibration and noise levels are minimized keywords graph theory energy transmission path sea ship structure structure borne vibration 1 introduction the vibroacoustic behavior of a physical system can be modelled using several numerical methods one of the most common measures used to categorize them is the frequency range i e low frequency mid frequency and high frequency since each frequency range has its own characteristics and has a limited scope of validity deckers et al 2014 modelling strategies to resemble the vibroacoustic response of a system depends on the frequency range used in the low frequency range deterministic approaches like finite element method fem and boundary element method bem can be used to determine the vibration modes this is likely because there are few modes and they are well separated nevertheless in the high frequency range modal density and modal overlap are high and the physical system s vibroacoustic behavior is more sensitive to slight changes in the physical parameters due to the range s short wavelengths therefore since these variations must be considered predicting the response of a single system via deterministic techniques becomes meaningless instead calculating the average responses of a physical system is more rational consequently statistical approaches like the statistical energy analysis sea are the commonly used techniques for this frequency range because there is a large frequency gap between low and high frequency ranges the mid frequency range is too diverse for an exact description of the system s vibroacoustic response the vibroacoustic characteristics of the system may fall in between low and high frequency ranges or the system may not present uniform dynamic behavior to tackle this mid frequency range problem several numerical methods and strategies like the wave based methods wbm in deckers et al 2014 desmet 1998 the asymptotical scaled modal analysis asma in de rosa and franco 2008 the energy distribution methods in mace and shorter 2000 the statistical modal energy distribution analysis smeda in maxit and guyader 2001a 2001b 2003 the modal energy analysis modena approach in totaro and guyader 2013 the radiative energy transfer methods in le bot 2005 the dynamic energy analysis in chappel and tanner 2012 2014 and the fem sea hybrid methods in langley and cordiali 2009 shorter and langley 2005 have been developed numerical methods can also be used to solve noise and vibration problems seen in the automotive and marine industries usually these problems consist of a vibroacoustic source that generates an extreme energy level in the other part of the system normally named as target or receiver guasch and aragonès 2011 for instance in a ship s structure the diesel engine may interfere with the comfort levels of the crew s living and working spaces on the upper level decks to resolve these quality issues some parts of the system will need to be modified to decrease the energy level of the target to an adequate level analysis methods like fem bem and sea are used to predict the vibroacoustic response of a system at a given frequency band depending on the method used to model the vibroacoustic response quantities such as acoustic pressure or structural vibration velocity can be determined the results yield information about the vibroacoustic behavior of the system but does not directly provide a solution for the part of the system that needs to be modified by investigating the system response during postprocessing a general overview of the modifications is provided reviewed and applied this procedure does not guarantee the best modification to reduce energy levels of the targeted system component monte carlo numerical experiments may be employed to find components that need modifications the experiment defines thousands of unique scenarios with random and slightly modified parameters each parameter is kept within acceptable values and the best parameters that yield the best results are kept dinsmore and unglenieks 2005 this technique has a high computational cost without guaranteeing the best or optimal solution for the system one of the other approaches is to combine known optimization algorithms with sensitivity analyses then the optimization is achieved in two stages the objective function is minimized or maximized in the first stage and the parameters which are the most influential in the variation of the results are determined in the second stage this procedure has been applied to sea models by several researchers bartosch and eggner 2007 büssow and petersson 2007 chavan and manik 2005 these optimization approaches look for solutions that provide the best results but they do not attempt to discover the origin of the problem one of the key issues when modelling the vibroacoustic behavior of a system is specifying how energy is transmitted from a source where the external energy is known to a target where the resulting energy is determined and needs to be reduced the experimental methods traditionally used to solve these type of vibroacoustic energy minimization problems are known as transmission path analysis tpa and operational transfer path analysis otpa techniques bendat 1976a 1976b dodds and robson 1975 potter 1977 stahel et al 1980 tschudi 1991 verheij 1982 guasch 2009 guasch and magrans 2004 toome 2012 in the automobile industry this experimental technique is used extensively toome 2012 cremer 2005 klerk 2009a 2009b klerk and ossipov 2010 plunt 2005 wang 2000 kurado and yamazaki 2013 but for the marine sector the relatively large number of parameters and complexity of the ship structure result in many measurement difficulties additionally the energy transmission paths can be found numerically and the sea method is at the core of the path determination strategy the first description of the contribution of an energy transmission path between two subsystems was made in craik 1979 1996 additionally later works showed that the energy level in a subsystem can be recovered by adding the contribution of all the paths heading such subsystems craik 1996 magrans 1993 using graph theory to obtain the energy transmission paths in a sea model was first proposed in guasch and cortés 2009 a graph is a set of elements that share pairwise connections furthermore a sea model consists of subsystems and the interactions of power flow between them therefore the theoretical similarities between a graph and a sea system can be found in the premise of each method as mentioned in guasch and aragonès 2011 and in guasch and cortés 2009 the problem of reducing the energy of a set of target subsystems in a sea model could be solved in the general framework of graph theory as in gross and yellen 1999 carré 1979 diestel 2005 the work done in guasch and cortés 2009 shows that a sea model can obtain more information by establishing the connection between graph theory and the sea method via a sea graph 1 1 a graph that represents the sea system for noise and vibration control purposes as a possible application of graph theory to vibroacoustics a graph cut algorithm strategy that computes cuts in the graph separating source and target subsystems is implemented to achieve energy reduction at a target subsystem with the sole modification of a reduced set of loss factors guasch et al 2011 while determining the vibroacoustic behavior and energy transmission paths for a system another issue related to noise and vibration control arises when ranking source to target energy transmission paths ranking the energy transmission paths i e determining the relative importance of these paths is significant because a small set of dominant paths can carry a high percentage of the overall energy guasch and aragonès 2011 ranking energy transmission paths requires a systematic path search in a vibroacoustic system model and a systematic dominant energy path ranking approach as mentioned in guasch and aragonès 2011 the association between sea and graph theory was established in guasch and cortés 2009 by defining a generating matrix of the sea system series solution with the adjacency matrix of a graph designated as a sea graph a systematic procedure to determine the set of k ranked dominant energy paths in a sea model was addressed in guasch and aragonès 2011 using graph theory tools found in guasch and cortés 2009 the graph theory based systematic procedure for ranking the dominant energy paths developed in guasch and aragonès 2011 will be combined with a sea graph approach using the path detection algorithm in guasch and aragonès 2011 adapting this procedure for optimizing vibroacoustic behavior will be one of the main goals of this paper another goal is to extend the use and performance of this approach for investigating the vibroacoustic behavior of a ship s structure for this purpose the component in a ship s structure with the most impact on ship acoustics underwater noise will be modelled as a sea model for mid and high frequency ranges then the structure borne energy transmission paths are found each path extends between the effective vibration source of the gearbox system and the target of keel bottom underwater hull plates each path will be identified and ranked according to the energy contribution to the target the paths that yield the highest contribution are then determined as ideal candidates of ship structural elements to be modified to reduce the structural vibration on keel bottom and underwater noise accordingly finally a parametric fem model which represents a limited version of the analyzed ship structure is built this reduced parametric fem model is used to analyze the structural design modifications using the ideal parameters the sea model of the ship structure is then modified using the best acoustically improved structural modification parameters the modified ship structure is used to verify that the modified structural elements have reduced the energy levels in terms of structural vibration moreover the structure borne energy transmission paths for the modified ship structure are independently determined to comprehend how the structural modifications impact their behavior ships reveal problems when they provide both a workplace and a living environment for onboard personnel these personnel are often exposed to high noise and vibration levels for extended periods of time thus to have the capability to predict this vibroacoustic behavior during the design phase is critical to ensure that vibration and noise levels are minimized yücel 2009 connelly 1999 furthermore the underwater noise generated by commercial ships is known to significantly contribute to ambient noise which has a negative effect on marine life in the ocean mckenna et al 2012 silenv 2012 sound is one of the most important aspects to consider for improving and maintaining stealth in military applications recently growing interest has shown that underwater radiated noise is also problematic for civilian ships e g oceanographic and research ships and industrial ships e g merchant sailing in special sea protected environments mckenna et al 2012 silenv 2012 aquo 2012 2015 sonic 2012 2015 streamline 2014 the acoustic performance of these noise and vibration sources can be improved by using adequate and resilient mounting that has passive semi passive or active control damping mechanisms 2 2 passive control means where no external energy is applied to the vibrating system whereas semi passive and active control express mechanisms where the system is connected to energy conversion materials such as piezoelectric materials and magnetic transducers without energy input and where an intelligent feedback looks control devices i e sensors gain controller etc are included respectively to mitigate the vibration and noise problems related to underwater noise and to improve the comfort of onboard personnel the ship s structural design can be optimized to minimize structural vibration since this passive control mechanism can be carried out at the structural design phase of a ship the ship can be improved acoustically without the need for expensive and costly remedial work on a completed vessel thus maximum path search mps algorithm adapted for structural ship design can be regarded as a complementary method to optimization techniques like monte carlo or parametric methods this paper is organized as follows in section 2 the mps algorithm that finds the k dominant energy transmission paths between a source s and a target t in a sea problem is defined then to extend the performance and use of the algorithm to practical cases its methodology is carried out for the structural design of a ship in section 3 the adapted mps algorithm is applied to the problem of finding the structure borne energy transmission paths in a sea model of the ship s structure in section 4 a parametric study is performed then the sea model of the ship structure is analyzed to confirm that the modified ship structure has reduced structural vibration energy levels a set of modified structure borne energy transmission paths are also explicitly found in this section finally a summary of the work is provided in section 5 2 determination of the dominant energy transmission paths in sea via graph theory 2 1 sea formulation once the subsystems are divided and the parameters i e loss factors are defined a sea formulation facilitates the energy level determination for every subsystem via the power balance equations characterized by eq 1 1 w i j j i n w j i w i d j j i n w i j i j 1 n where w i represents the external power input w i d is the power lost due to the internal dissipation mechanisms n is the number of subsystems in the sea system and w i j is the power flow from subsystem i to subsystem j in eq 1 the left hand expression represents the power inputs of the subsystem and the right hand expression represents the power outputs of the subsystem in a sea model the parameters needed for each given frequency band are the loss factors there are three types of loss factors the coupling loss factor clf η i j is the ratio of energy transferred from subsystem i to subsystem j the internal or damping loss factor ilf η i d represents the ratio of energy lost as heat in subsystem i the total loss factor tlf η i that is the total energy lost in subsystem i is characterized by eq 2 2 η i η i d j j i n η i j where n is the total number of subsystems the dissipated power w i d is characterized by eq 3 3 w i d ω η i d e i the term ω is the center frequency of the frequency band and e i is the energy of the subsystem i the transmitted power is defined as follows 4 w i j ω η i j e i therefore the power flow between two subsystems can be provided as in eq 5 5 w i j w j i ω η i j e i n i n j e j where the consistency relationship resulting from coupling power proportionality cpp in sea method n i η i j n j η j i has been used as seen in eq 5 the power flow between two subsystems is proportional to the difference between their energy densities if expressions 3 and 4 are substituted into 1 the relationship is element wise characterized in eq 6 and in matrix form in eq 7 6 w i ω η i d e i ω j j i n η i j e i η j i e j 7 η 1 η 21 η 31 η n 1 η 12 η 2 η 32 η n 2 η 13 η 23 η 3 η n 3 η 1 n η 2 n η 3 n η n e 1 e 2 e 3 e n 1 ω w 1 w 2 w 3 w n the matrix found in eq 7 represents the loss factor matrix and is denoted by ℋ thus the system of equations in sea formulation can be defined as follows 8 ℋ e 1 ω w e 0 the term e is the unknown vector of subsystem energies and w is the external power inputs 2 2 energy transmission path analysis in sea finding the maximum energy transmission path in a sea model corresponds to the problem of finding the shortest path in a graph guasch and aragonès 2011 the shortest path problem is well understood and studied extensively several algorithms have also been developed guasch and aragonès 2011 the k shortest path problem was solved in the literature of different disciplines in two ways finding a set of simple paths 3 3 simple paths correspond to loopless and unconstrained paths which do not satisfy the optimality principle martins et al 1999 and finding paths with repeated vertices guasch and aragonès 2011 because the second type can find loops this method is suitable for the sea problem in the sea problem the k dominant energy transmission paths transmit energy from a source s to a target t with the help of loop paths guasch and aragonès 2011 the work in guasch and aragonès 2011 which finds the set of k dominant energy paths between a source and target in a sea model is in fact based on an adaptation of the mps algorithm first developed in martins et al 1999 in a typical sea problem energy is transmitted through paths and between subsystems thus a path in a sea model corresponds to an energy transmission path linking subsystem i to subsystem j the energy contribution of a path is computed via a product of the energy contributions of the direct paths i e first order paths constituting a path craik s definition guasch and aragonès 2011 craik 1990 1996 of the contribution of a n th order path p i j n from subsystem i to subsystem j is as follows 9 w p i j n η i h 1 η h 1 η h 1 η h 2 η h 2 η h n 1 j η j note that the weight of a first order path η i j η j will always be less than unity if the system is a weakly coupled system i e η i j η i as the order of the path increases its contribution gets smaller accordingly the contribution of very long paths tends to zero therefore there will be several paths with negligible contributions when compared to paths with a high amount of energy in eq 8 the system of equations in the sea formulation describe the relationship between the subsystem s energy and the total contribution of the paths leading to a target subsystem to find a solution the system of equations can be rewritten by a procedure other than taking inverse of the loss factor matrix ℋ first every row in the system of equations in matrix form 7 is divided by the corresponding diagonal element of ℋ second ℋ and vector e 0 are redefined respectively as ℋ d i a g 1 η i ℋ and e 0 d i a g 1 η i e 0 and then the matrix s is defined such that ℋ i s consequently the solution of the system of equations can be found via a neumann series expansion 10 e i s 1 e 0 n 0 s n e 0 if the spectral radius of s is less than unity thus the series converges which will always be the case in sea guasch and aragonès 2011 craik 1996 magrans 1993 the elements of s correspond to the first order energy transmission path from subsystem i to subsystem j as defined in eq 11 11 s i j 0 i j η j i η i i j furthermore as proven in magrans 1993 the n th power of s involves elements that result from the contributions of the n th power paths between every pair of subsystems considering that the path contribution results from a product of quantities less than unity then we can say the longer the path the lower its contribution i e i s i 0 therefore after some power of s matrix the path contribution to the total energy of the system is negligible this suggests that in some cases a substantial portion of the total energy at the target subsystem can be represented by a smaller group of paths and these paths belong to the small group called the dominant energy transmission paths 2 3 use of graph theory for providing energy transmission paths in sea the value of providing energy transmission paths in a vibroacoustic system has been demonstrated the subsystem energies can be decomposed in terms of energy transmission paths by means of the series expression in eq 10 however a direct method to provide such paths and to work with them is still missing the approach proposed in guasch and cortés 2009 suggests the use of graph theory to obtain the energy transmission paths in a sea model accordingly the problem of reducing the energy for a set of target subsystems in a sea model could be solved in the general framework of graph theory in this section a graph that represents a vibroacoustic system is developed so that the mps graph algorithm can be used to solve problems related to energy transmission paths first the graph that represents the sea system and is called the sea graph will be introduced as stated in guasch and cortés 2009 a sea graph 4 4 in a sea graph the nodes correspond to the sea subsystems and the arcs to the first order paths between those subsystems represented by g s e a u s e a e s e a is defined as a simple digraph 5 5 a graph whose arcs have a definite direction i e u i u j u j u i is called a directed graph or a digraph whereas a graph where u i u j u j u i is named undirected graph a graph is said to be symmetric if for every arc u i u j e exists an arc u j u i e s e a a graph which is anti reflexive and symmetric is called a simple graph such that every node u i in u s e a corresponds to a sea subsystem accordingly the directed arcs u i u j u j u i e s e a exist between subsystems u i and u j whenever they are coupled in the sea model the arc weights w i j and the path algebras are selected depending on the vibroacoustic problem to be solved guasch and cortés 2009 for the case where the most dominant energy transmission paths between a source subsystem and a target subsystem are located the arc weights w i j are identified with the contribution of the first order paths between subsystem i and subsystem j 12 w i j w i j η i j η j i f u i u j e s e a 0 i f u i u j e s e a note that the weighting matrix w 6 6 w can be also called weighting matrix in a sea graph coincides with the transposed generating matrix s t in the neumann series solution of the sea algebraic matrix system defined by eqs 10 and 11 furthermore the weight of a path belonging to a sea graph is defined to coincide with the craik s definition of a sea path in eq 9 13 w p u i 0 u i n n w u i 0 u i 1 w u i 1 u i 2 w u i 2 u i 3 w u i n 1 u i n η i 0 h 1 η h 1 η h 1 h 2 η h 2 η h n 1 h n η h n the next step of computing the dominant energy transmission paths using graph theory is to define the condition when a path has a higher energy value dominates than a distinct path for this purpose the highest energy contribution paths i e the maximum weight paths in terms of graph theory must be obtained given two paths p i j and q i j the condition of domination denotes that p s t dominates q s t if w p s t is greater than w q s t 14 p s t q s t w p s t w q s t to define the problem of determining the set of k dominant energy transmission paths in a sea model suppose two nodes 7 7 s is usually identified with a source subsystem where external energy is being input and t is identified with a target subsystem where energy is to be reduced guasch and aragonès 2011 s and t in a sea graph g s e a are given guasch and aragonès 2011 then to find the set p s t k p s t 1 p s t 2 p s t k p s t 8 8 p s t denotes the set of infinite transmission paths from a source subsystem s to a target subsystem t such that w p s t k w p s t k 1 k 1 k 1 w p s t k w q s t q s t p s t p s t k p s t k is found just before p s t k 1 k 1 k 1 as stated in guasch and aragonès 2011 the aim is to find a set of k paths such that the k th path in the set transmits more energy than the k 1 path first item such that any path in the set transmits more energy than any path not belonging to the set second item and such that all paths in the set are computed in order i e first the maximum energy transmission path p s t is found then the second dominant path then the third one and so on until the k th path third item suppose that a sea digraph g s e a u s e a e s e a with adjacency matrix w is given by the transpose of the generating matrix s of the neumann series solution of the sea system i e w s t as described in a theorem in guasch and aragonès 2011 there exists a finite and maximum energy transmission path from the source s to the target t in g s e a the theorem states that the set p s t k of k dominant paths exists thus each k path i e p s t k includes a finite number of nodes and each k path transmits a finite amount of energy the proof of this theorem depends on theorem 1 in martins et al 1999 but is adapted to the sea framework in guasch and aragonès 2011 the proof of this theorem and a related corollary are explained in full detail in guasch and aragonès 2011 and will not be reproduced here the mps algorithm to be used to compute the set of k dominant energy transmission paths in a sea model as mentioned above is generated in this study using matlab software for this purpose the pseudocode of the mps algorithm given in guasch and aragonès 2011 is employed to code our algorithm in matlab see guasch and aragonès 2011 for more details of the pseudocode of the mps algorithm reproduced in this study 3 dominant energy transmission paths for the local ship structure 3 1 description of sea model of the local ship structure the mps algorithm was tested by finding the dominant energy transmission paths for the realistic example of a 24 room test building found in guasch and aragonès 2011 valuable information about the energetic behavior of a sea model can be derived from the mps algorithm since ships have more detailed structural arrangements their structures are more complex compared to other structures like buildings due to this complication adapting the algorithm is a worthwhile effort to assess noise and vibration problems in ships at the design stage which has never been done before in this section the local part of a research ship structure will be modelled for mid and high frequency ranges then by using the mps algorithm the dominant energy transmission paths from the vibration source gearbox system to the target keel bottom plates will be determined and ranked these components are ideal structural ship elements that can be modified to reduce the structural vibration on keel bottom and underwater noise accordingly the local part of a research ship structure that dominates the ship acoustics underwater noise has been created as a sea model with the commercial package va one a vibro acoustic program see fig 1 the modelling strategy of this sea model is described as follows this model includes the foundation structure of the gearbox system which is considered a dominant vibration source and the keel bottom plates which are considered as the target structures the decks and bulkheads of the engine room which are secondary to the energy transmission paths are also included in the sea model the sea subsystems are uniform and ribbed flat plates and beams which represent the structural configuration of the engine room there are 1991 uniform or ribbed flat plates and 555 beams they have all been generated physically since the model was created with multi vibrational modes 9 9 a flat plate can be modelled with flexural bending plane tension compression and plane shear waves in va one whereas a beam can be created with flexural bending waves in two axial directions and tension compression and torsional waves i e flexural tension compression shear and torsional waves have all been considered then any flat plate is represented by three subsystems whereas any beam is represented by four subsystems thus the model is composed of 8193 subsystems in total considering the continuity of the vibration energy transmission path under the structural foundation the model boundaries have been extended by overlapping neighbor compartments and the engine room the principal noise and vibration sources for ships are typically composed of the main propulsion systems the auxiliary systems and the propellers for instance for naval ships this is particularly significant because the acoustic signature allows detection by submarines depending on the driving force frequencies of systems in general the noise and vibration sources on ships contain discrete components at specific frequencies when these frequencies coincide with the resonance frequencies of ship structures the latter may generate inadmissibly high vibration levels therefore to characterize the entire vibroacoustic system for onboard noise and vibration control the dominant energy transmission paths need to be computed at all possible coincident frequencies of systems and ship structures thus the energy transmission path analysis using the adapted mps algorithm has been performed for a sea graph corresponding to 1 3 octave frequency bands between 200 hz and 1000 hz for each analyzed condition therefore the mps algorithm has been carried out individually for the 1 3 octave center frequencies 200 hz 250 hz 315 hz 400 hz 500 hz 630 hz 800 hz and 1000 hz two separate conditions condition 1 and condition 2 have been considered as the source target configurations see fig 2 these conditions have been determined according to the following considerations one of the flat plates which is the dominant vibration energy generator of the gearbox system has been assigned to be the source s for both conditions the intention of each source target configuration is to find the structural vibration level on the hull shell structure which generates the underwater noise by transmitting vibrational energy to the sea water from the vibration source as a result the targets consider two different structural components of keel bottom in condition 1 the target structure has been selected as the shell plate near the keel line whereas in condition 2 the target structure has been selected as the shell plate between the keel line and ship draft furthermore to concurrently see the effects of the source target distance and the target position in the system the target structures of these conditions have been chosen for different port and starboard sides and close and stand off distances 3 2 determination of the number of k dominant energy transmission paths to determine the number of the dominant energy transmission paths in the computed total energy of the paths the relative percentage of each dominant path is considered as the order of computed dominant paths increases the energy transmitted by each individual path contributes less to the total energy transmitted in terms of energy levels this means that when the number of computed dominant paths reach a certain value the energy contribution of the next dominant path will be negligible due to the reduction of the path weight for this purpose the mps algorithm solutions of condition 1 and condition 2 for 500 hz have been taken for 300 and 500 sorted paths respectively then the relative percentage of the energy transmitted via an individual path is calculated for each condition as seen in fig 3 the first 150 and 300 sorted energy paths can be observed for condition 1 and condition 2 respectively these energy paths approximately represent the relative percentage of any subsequent path that no longer varies since the mps algorithm solutions for the remaining frequencies have shown the same tendency as the 500 hz case then these solutions can be used for k dominant energy transmission paths for all frequencies note that the first 150 and 300 sorted energy paths for condition 1 and condition 2 respectively roughly transmit more than 95 of the computed total energy of the paths to the target although the number of dominant paths to be computed have been decided according to their relative percentages the overall energy of the target will come from the primary vibration source of the model thus the energy transmitted via a set of dominant paths also justifies reaching the high percentage of the target energy the abrupt variation of the weights of the dominant energy transmission paths shown in fig 4 supports this inference the number of paths to be computed needs to satisfy the required energy level of paths that grows exponentially as seen in fig 3 as stated in guasch and aragonès 2011 this consequence is not unexpected since the neumann series expansion of the sea system solution states that an infinite number of paths will be accounted for guasch and cortés 2009 for condition 1 8 of the total transmitted energy is transferred via the maximum path which is the fifth order path linking the source and target plates 4 of the total transmitted energy is transferred via the 2nd dominant path which is the fifth order path finally 3 8 of the total transmitted energy is transferred via the 3rd dominant path which is also the fifth order path for condition 2 the orders and energy percentages transmitted with the maximum 2nd and 3rd dominant paths are the twelfth order thirteenth order and thirteenth order paths with 3 8 2 6 and 1 7 of the total transmitted energy respectively because of the short source target distance the orders of dominant paths in condition 1 are less than those in condition 2 while the weight and transmitted energy of dominant paths in condition 1 are much more than those in condition 2 consequently the energy transmitted through the first several dominant paths become more applicable in condition 1 however the high percentage of the overall energy at the target in condition 2 can be obtained via more dominant paths that are equally ordered and significant this outcome interprets and justifies that the mps algorithm solutions for condition 2 require more dominant energy transmission paths 500 than condition 1 300 to transmit the equivalent energy level through them 3 3 the mps algorithm solutions for dominant energy transmission paths by solving the adapted mps algorithm for instance for 500 hz the energy transmitted through the set of the first three dominant paths and the last dominant paths i e 150th for condition 1 and 300th for condition 2 are shown in fig 5 and fig 6 10 10 since they deface the view the type names of plates have not been included for condition 2 in fig 6 respectively examining the structural arrangements contained within the given dominant paths for both conditions see table 2 for type definitions the involvement of the paths varies slightly in terms of the structural element types the paths mainly consist of the sectional groups of elements located between the source and target structures the main reason that the paths are grouped with similar structural elements is because the sea model composition includes all types of vibration modes for both flat plates and beams after examining the wave types the flexural waves are more important in the first dominant paths for both conditions this outcome makes sense since the major part of the vibrational energy existing on ship structures generally spreads over the ship structure in the form of flexural waves considering the behavior of the dominant paths we can account for all types of structural elements of the ship this includes the assessment of the whole energy transmitted for each condition thus the complete set of structural elements appearing in 150 and 300 dominant paths for condition 1 and condition 2 respectively is shown in fig 7 for the frequency 500 hz the mps algorithm solutions that are carried out for the 1 3 octave center frequencies 200 hz 250 hz 315 hz 400 hz 630 hz 800 hz and 1000 hz are provided in appendix a the number of loss factors belonging to the dominant paths that will be changed to reduce the energy at the target structure will depend on several factors the loss factors depend on the number of dominant paths used to obtain a certain percentage of the target energy but also on the structural configuration of these dominant paths the characteristics of the structural elements that are involved in dominant paths reveal another strange correlation for example because of the computation of condition 1 for 500 hz one finds out that the longest path in the set of 150 dominant paths only uses 8 subsystems 11 11 the set of multi subsystems is made up of different vibration mod waves and is the single subsystem that represents the physical structural element excluding the source and targets furthermore the 150 dominant paths only involve 27 different subsystems thus the analysis of the 300 sorted dominant paths for condition 2 reveals that the longest path in the set is composed of 17 subsystems and the 300 dominant paths include 93 different subsystems the analyses of all sorted dominant paths for both conditions were carried out for all frequencies the results have revealed that the longest path in the sets has been made up of 8 subsystems for condition 1 and 17 subsystems for condition 2 the number of different subsystems involved 150 and 300 sorted dominant paths for condition 1 and condition 2 respectively and are summarized in table 1 note that the number of different subsystems for each condition occurred roughly at the same level for the full range of frequencies previous findings justify that the length of dominant paths or the involvement of different subsystems can be simply provided from the analysis outputs of ranked paths of the mps algorithm considering that all sorted dominant paths end up with a small number of different subsystems the dominant paths cover cycles in large quantities and that they do not separate considerably from the source and target subsystems in addition this behavior also suggests that these dominant paths involve a small number of different structural element types that need to be modified and that they consist of similar ship structural elements in general from this point of view subsystems can be grouped according to their structural element types in addition to the grouping behavior of dominant paths as stated before moreover subsystems can be classified according to the number of paths in which they appear guasch and aragonès 2011 this classification informs us about specifying the subsystems that need to be modified to ensure that the energy at the target can be reduced the loss factors belonging to these classified subsystems are involved in a largest number of paths and will be the best candidates to be modified for the reduction of the energy at the target structure guasch and aragonès 2011 since one of the main goals of this study is to reduce the structural vibration of the keel bottom and underwater noise by performing the adapted mps algorithm taking advantage of the classification of the dominant energy transmission paths found is crucial the ideal structural elements of the ship that need to be modified can be determined from the dominant paths first the ship s structural elements have been designated in accordance with the structure types as provided in table 2 the number of structural elements that were classified according to the number of paths in which they appear are listed in table 3 and table 4 for condition 1 and condition 2 respectively along with their percentages note that the set of multi subsystems that is made up of different vibration mod waves is the single subsystem that represents the physical structural element type 1 type 2 type 3 and type 4 are the best candidates to be modified for the reduction of the energy at the target structures this is the result of the numbers of paths and percentages determined when calculating the dominant energy transmission paths for both conditions these optimum candidates if modified properly are expected to reduce the structural vibration of the keel bottom and thus decreased underwater noise depending on the radiation efficiency between the underwater hull structure and the surrounding water consequently results show that very valuable information related to the structure borne energy transmission pattern can be derived from complex ship structures modelled with the sea method by using the adapted mps algorithm developed in this work 4 acquiring acoustically improved ship structures via the mps algorithm 4 1 structural modifications applied with a parametric study the acoustic properties of a ship are affected by the increasing flexural rigidity used during the ship s design phase this information may provide some practical design measures that can reduce the structural vibration the variation of the ship s flexural rigidity can improve with these changes but they also can deteriorate certain vibroacoustic characteristics such as mechanical impedance vibration conductivity sound radiation ability and sound insulation therefore modifying a single parameter e g the thickness of a plate structure or the dimensions of the ribs frames can not ensure that the ship s overall vibroacoustic characteristics can be improved instead they can be modified by using a parametric approach that takes care of all practical modification parameters belonging to dominant energy transmission paths which have a forceful impact on ship acoustics the modifications that need to be applied to a ship structure are restricted due to other ship design priorities such as strength requirements so they need to be adaptable at this stage the structure borne energy transmission paths that have been found via the adapted mps algorithm developed in this study will be considered this initial designation leads to the selection of indefinite parameters associated with a system s loss factors the structural elements of the paths are referred to modifiable items in a parametric study to interpret how the applied structural modifications impact the vibroacoustic characteristics of the ship structure at coinciding 12 12 when the frequencies of driving forces and the resonance frequencies of ship structures coincide the structural vibration may get inadmissibly high levels through decreasing of the mechanical impedance frequencies requires a narrow band frequency analysis that can be performed with one of the numerical methods such as fem the sea model which has been used to compute the dominant energy transmission path analysis using the adapted mps algorithm is transformed to the fem model via the commercial package of the ansys program for vibroacoustic analyses for narrow band frequency range between 200 hz and 1000 hz to focus on best candidates of the type 1 type 2 type 3 and type 4 structural elements a more representative structure of the foundation itself is created these elements will be modified to reduce the energy of the target structure this parametric model contains acoustic fluid elements demonstrating the acoustic medium needed to calculate quantities such as acoustic pressure the driving force load of the gearbox system for the ship service speed provided is applied on the source the foundation top plate type 4 this parametric fem model is shown in fig 8 the modification strategy to increase the stiffness and or vibration insulation in general causes the weight of the ship structure to increase which is not always acceptable in ship design therefore there is a trade off between the acoustic improvements and the ship structure that needs to be considered the variations to be applied to the thickness of a plate or the dimensions of ribs are determined by providing the minimum impact to the total ship weight the modified parameters which are selected as discrete values provided by the ship building industry for four types of structural elements are defined as in table 5 which provides a total of 144 modification cases the radiation of the sound emitted from a plate can be determined from knowledge of the plate s vibration and radiation properties the structural modifications applied to the parametric fem model will change both the velocity distributions on keel bottom plates type 1 and their radiation efficiencies if the sound power quantities for the modified structures are computed efficient and inefficient modification cases can also be obtained in terms of their sound powers therefore the competence of the modification cases is categorized via their sound power radiations which occur in the fluid domain of the parametric fem model the sound power is defined as 15 w s i d s s i n d s where i p v is the sound intensity vector p is the sound pressure v is the particle velocity i n is the sound intensity normal to the surface s and s is the area of surface enclosing the source in practical situations the relationship between sound pressure level sound power level and normal sound intensity level is not straightforward thus an accurate estimation of sound power level cannot be accessed by using sound pressure quantities however in two ideal cases the free field and a diffuse field sound power is explicitly related to the sound pressure the fluid domain in the parametric fem model is assumed to be deep water representing the free field in an acoustic medium thus the formulation that needs to be developed for the free field is employed in this study for a progressive wave there is a unique relationship between the mean squared sound pressure and the intensity in the direction of the wave propagation characterized by i p 2 ρ c where c is the speed of sound and ρ is the density of the acoustic medium splitting the surface s into n distinct pieces s n the discrete form of eq 15 becomes 16 w n 1 n i n s n free field n 1 n p n 2 s n ρ c the sound power level is estimated by the expression 17 l w 10 log w w 0 10 log n 1 n p n 2 s n ρ c w 0 db for each frequency eq 17 is employed to yield the sound power levels l w resulting from the computed sound pressures p n of acoustic fluid elements having s n areas after the vibroacoustic analyses are carried out for the parametric fem model corresponding to the 200 1000 hz frequency range 144 sound power levels have been computed and now represent each modification case twelve of the best structural design solutions among them are designated to demonstrate the influence of the modification parameters in terms of sound power levels the sound power level of the initial structural configuration is analyzed using modification cases and is compared with the best structural design solutions of the foundation structure by considering the engine room of a research ship see fig 9 and fig 10 the results show that modified structural elements reduce the structural vibration and the sound power level almost 4 db in the parametric model if the modification of the optimum design case strategy ensures acceptable weight increases to the structure then the local ship structure representing the engine room can be made in the same manner 4 2 vibroacoustic analyses of the sea model for the local ship structure now we can focus on analyzing the vibroacoustic response of the local ship structure to determine whether modifying this structure will result in a decrease of the structural vibration transmitted to the target structures the initial structural design of the engine room has been modified by applying the optimal structural design solution d9 w15 t100 b100 shown in fig 9 and fig 10 the structural modifications of type 2 type 3 and type 4 structural elements have been applied to the identified foundation regions while the type 1 structural element is altered with new rib dimensions throughout the underwater hull structure the plate thicknesses of type 2 and type 3 structural elements have been modified by 15 mm with respect to the plate thickness of 10 mm for the original geometry the type 4 parameters have been changed by 100 mm with respect to a thickness of 60 mm for the original geometry in addition the size of the stiffening ribs belonging to type 1 plates have been increased from hp80x5 to hp100x6 for the optimum design case note that the thickness of the type 1 plates is identical for both the initial and optimal design cases the initial and modified structural designs of the local ship structure are analyzed using sea method using the driving force load applied in fig 11 the structural vibration velocity results at both target plates and source plate have been plotted for a comparison of both structural designs our goal is to diminish the structural vibration of the underwater hull structure which is composed by two target plates when the vibration is generated at the source of the foundation top plate a comparison between the results that are obtained from the sea models of the initial and modified structural designs highlights advantages of using energy path based methods the structural vibration reduction throughout the frequency range for both conditions is investigated fig 11 a and b we observe that the structural vibration velocity in the corresponding foundation top plate subsystem is diminished throughout the frequency range fig 11 c given that the structural vibration reduction occurs in the source structure the applied vibrational energy at the source is sufficiently reduced this provides reduced energy transmission for all the targets and the contribution to their structural vibration reduces accordingly the overall structural vibration velocities and their associated reduction percentages obtained for the source and target subsystems in the whole frequency range are provided in table 6 as observed both condition 1 and condition 2 yield very similar reduction percentages with the first value being slightly superior to achieve the acoustically improved ship structure results taken from graph theory calculations have been used to determine modifications of the ship structure by employing a parametric study a strategy based on the computation of the mps algorithm can be adapted to diminish the energy transmitted from a source subsystem to a set of target subsystems in realistic frequency dependent ship structures 4 3 the mps algorithm solutions for the acoustically improved local ship structure after being modified the reduced sea system energy will tend to redistribute and reach the target subsystems via alternate transmission paths the mps algorithm can also be used for the modified ship structure by testing how the applied structural modifications may alter the characteristics of the dominants energy transmission paths by considering that the results found for 500 hz in the initial case may roughly represent the behavior of the dominant paths found for the full range of frequencies the mps algorithm are performed well with only 1 3 the octave center frequency of 500 hz by solving the adapted mps algorithm for the modified ship structure at 500 hz the energy transmitted through the set of 1 st and 3 rd dominant paths for both conditions are shown in fig 12 the involvement of the paths varies slightly in terms of the structural element types this is found by comparing the structural arrangements to those of the initial case for condition 1 see fig 5 nevertheless the dominant paths in the modified case for condition 2 consist of additional subsystems with respect to those in the initial case see fig 6 since the stand off source to target distance allows more structural elements to lie between the source and target structures in the dominant paths then the structural modifications in condition 2 influence the involvement of the dominant paths more than those in condition 1 the complete sets of structural elements that appear in the 150 and 300 dominant paths in modified case for condition 1 and condition 2 respectively consist of the same structural elements as in the initial case all but a few subsystems are excluded and therefore every new set is not illustrated here see fig 7 the main reason for the paths to be formed by grouping structural elements of the same kind is because the first four structural element types are the leading terms of the sea model furthermore the result of the modified case also confirms that all sorted dominant paths end up with a small number of unique subsystems as seen in the initial case the number of structural elements that are classified by the number of paths in which they appear is presented in table 7 for both conditions along with their percentages furthermore the energy transmitted for each condition is plotted with respect to the number of the dominant paths as shown in fig 13 an assessment is made for the total energy transmitted in each case note that the percentages of all subsystems involved vary slightly for both cases and conditions see tables 3 and 4 this result tells us that the ideal candidates that were modified are still influential in transmitting the energy from the source to the target in the system as seen in fig 13 the variation of the weights applied to the dominant paths confirms the reduced energy transmission in the modified case the structural modifications for both conditions yield very similar results the latter being only slightly superior the reduction percentages in terms of overall weight increase from 19 3 to 25 2 for condition 1 and condition 2 respectively the results show that the structural modifications diminish the energy transmitted from a source subsystem to a set of target subsystems by providing the reduced sea system energy this outcome is consistent with the reduced structural vibration velocities obtained for the source and target subsystems of the modified ship structure provided in table 6 5 conclusions in this study a systematic procedure for ranking dominant energy paths is developed by using the algorithm found in guasch and aragonès 2011 for the marine industry this work also aimed to extend the applicability and performance of this procedure by analyzing the vibroacoustic behavior of a ship structure in comparison to structures like buildings ship design has more detailed structural arrangements thus adapting the algorithm is a worthwhile effort to solve noise and vibration problems in more complex structures at the design stage which has never been done before by adapting the algorithm to structural ship design we can predict the vibroacoustic behavior during the design phase and ensure that vibration and noise levels are minimized this type of early response can facilitate simple and cheaper solutions to the vibration and noise problems avoiding the need for expensive and costly remedial work on a completed vessel in this study a parametric fem model which represents a restricted version of the analyzed ship structure has been built to analyze the structural modifications resulting from the mps algorithm solutions the sea model of the ship structure has been altered by using the best acoustically improved structural modification parameters then the modified ship structure can be tested to verify that the structural vibrations have reduced energy levels the solutions found by adapting the mps algorithm to structure borne energy transmission of a ship can be regarded as a complementary step to optimization techniques like monte carlo or parametric methods the outcomes of the algorithm can be considered as extending the sensitivity of parametric approaches on the other hand the mps algorithm exposed in this work to rank paths have only considered the mean values of loss factors for path comparison subsystem energy variability due to loss factor and input power uncertainties being ignored however due to the influence of the statistical nature of sea on path ranking the path classification strategy needs to not only take into account the mean values of the loss factors but also their variances to tackle with uncertainties that occur in sea recently possible solutions to such a problem have been developed by several researchers aragonès and guasch 2015 christen et al 2017 acri et al 2017 finally this study has justified that the mps algorithm can highlight the advantages of setting sea transmission path problems of ship structures thus the algorithm can become a helpful tool for noise and vibration analysis at the design stage of ships a process to design the ship structure which could start with the identification of the most dominant energy transmission paths from source to receiver target subsystems is feasible and can be combined with graph theory to develop a systematic approach an analysis could then be made to find the best structural element candidates that have the most significant energy transmission finally this structure s energy contribution can be modelled and reduced by applying practical modifications using parametric or optimization approaches acknowledgments many thanks to àngels aragonès for her directing advises related to graph theory algorithms based on her work i would like to thank my colleagues in istanbul technical university for their support and encouragement in this work appendix a the complete set of ship structural elements included in all sorted dominant paths fig a1 200 hz all ship structural elements found in all sorted dominant paths a condition 1 b condition 2 fig a1 fig a2 250 hz all ship structural elements found in all sorted dominant paths a condition 1 b condition 2 fig a2 fig a3 315 hz all ship structural elements found in all sorted dominant paths a condition 1 b condition 2 fig a3 fig a4 400 hz all ship structural elements found in all sorted dominant paths a condition 1 b condition 2 fig a4 fig a5 630 hz all ship structural elements found in all sorted dominant paths a condition 1 b condition 2 fig a5 fig a6 800 hz all ship structural elements found in all sorted dominant paths a condition 1 b condition 2 fig a6 fig a7 1000 hz all ship structural elements found in all sorted dominant paths a condition 1 b condition 2 fig a7 
23303,when solving a vibroacoustic problem in a physical system a fundamental goal is to determine how energy is transmitted from a given source to any part of the system this enables the modifications needed to reduce noise or vibration levels in each system component numerical techniques such as finite element method fem and statistical energy analysis sea can predict the vibroacoustic behavior of the system yet they do not directly reveal which part of the system shall be modified the energy transmitted via the path that connects a source and a target subsystem component can be determined numerically finding the dominant paths that contribute the most to the total energy transmitted between a source and target is more art than science finding the dominant paths usually depends on an engineer s expertise and judgement thus a systematic approach to automatically identify those paths would be beneficial graph theory provides a solution to this problem because powerful path algorithms for graphs have already been developed in this study a systematic procedure for ranking the dominant energy paths in a vibroacoustic model is developed by using existing graph theory and sea graph approaches to extend the use and performance of this application specific approach which investigates the vibroacoustic behavior of a ship structure a research ship has been modelled via a sea model for mid and high frequency ranges then the structure borne energy transmission paths from a vibration source to the keel bottom underwater hull plates are determined and ranked by their energy output next the process identifies the structural elements that need to be modified to reduce the overall energy levels a parametric approach is then used to modify these ideal candidates using a representative fem model finally the modelling results verify that the path modified ship structure has reduced the structural vibration energy levels thus by using and extending the pre existing graph theory algorithm the vibroacoustic behavior of complex ship structures is predicted the energy output of each path is found and the problematic paths are modified during the ship design phase to ensure that vibration and noise levels are minimized keywords graph theory energy transmission path sea ship structure structure borne vibration 1 introduction the vibroacoustic behavior of a physical system can be modelled using several numerical methods one of the most common measures used to categorize them is the frequency range i e low frequency mid frequency and high frequency since each frequency range has its own characteristics and has a limited scope of validity deckers et al 2014 modelling strategies to resemble the vibroacoustic response of a system depends on the frequency range used in the low frequency range deterministic approaches like finite element method fem and boundary element method bem can be used to determine the vibration modes this is likely because there are few modes and they are well separated nevertheless in the high frequency range modal density and modal overlap are high and the physical system s vibroacoustic behavior is more sensitive to slight changes in the physical parameters due to the range s short wavelengths therefore since these variations must be considered predicting the response of a single system via deterministic techniques becomes meaningless instead calculating the average responses of a physical system is more rational consequently statistical approaches like the statistical energy analysis sea are the commonly used techniques for this frequency range because there is a large frequency gap between low and high frequency ranges the mid frequency range is too diverse for an exact description of the system s vibroacoustic response the vibroacoustic characteristics of the system may fall in between low and high frequency ranges or the system may not present uniform dynamic behavior to tackle this mid frequency range problem several numerical methods and strategies like the wave based methods wbm in deckers et al 2014 desmet 1998 the asymptotical scaled modal analysis asma in de rosa and franco 2008 the energy distribution methods in mace and shorter 2000 the statistical modal energy distribution analysis smeda in maxit and guyader 2001a 2001b 2003 the modal energy analysis modena approach in totaro and guyader 2013 the radiative energy transfer methods in le bot 2005 the dynamic energy analysis in chappel and tanner 2012 2014 and the fem sea hybrid methods in langley and cordiali 2009 shorter and langley 2005 have been developed numerical methods can also be used to solve noise and vibration problems seen in the automotive and marine industries usually these problems consist of a vibroacoustic source that generates an extreme energy level in the other part of the system normally named as target or receiver guasch and aragonès 2011 for instance in a ship s structure the diesel engine may interfere with the comfort levels of the crew s living and working spaces on the upper level decks to resolve these quality issues some parts of the system will need to be modified to decrease the energy level of the target to an adequate level analysis methods like fem bem and sea are used to predict the vibroacoustic response of a system at a given frequency band depending on the method used to model the vibroacoustic response quantities such as acoustic pressure or structural vibration velocity can be determined the results yield information about the vibroacoustic behavior of the system but does not directly provide a solution for the part of the system that needs to be modified by investigating the system response during postprocessing a general overview of the modifications is provided reviewed and applied this procedure does not guarantee the best modification to reduce energy levels of the targeted system component monte carlo numerical experiments may be employed to find components that need modifications the experiment defines thousands of unique scenarios with random and slightly modified parameters each parameter is kept within acceptable values and the best parameters that yield the best results are kept dinsmore and unglenieks 2005 this technique has a high computational cost without guaranteeing the best or optimal solution for the system one of the other approaches is to combine known optimization algorithms with sensitivity analyses then the optimization is achieved in two stages the objective function is minimized or maximized in the first stage and the parameters which are the most influential in the variation of the results are determined in the second stage this procedure has been applied to sea models by several researchers bartosch and eggner 2007 büssow and petersson 2007 chavan and manik 2005 these optimization approaches look for solutions that provide the best results but they do not attempt to discover the origin of the problem one of the key issues when modelling the vibroacoustic behavior of a system is specifying how energy is transmitted from a source where the external energy is known to a target where the resulting energy is determined and needs to be reduced the experimental methods traditionally used to solve these type of vibroacoustic energy minimization problems are known as transmission path analysis tpa and operational transfer path analysis otpa techniques bendat 1976a 1976b dodds and robson 1975 potter 1977 stahel et al 1980 tschudi 1991 verheij 1982 guasch 2009 guasch and magrans 2004 toome 2012 in the automobile industry this experimental technique is used extensively toome 2012 cremer 2005 klerk 2009a 2009b klerk and ossipov 2010 plunt 2005 wang 2000 kurado and yamazaki 2013 but for the marine sector the relatively large number of parameters and complexity of the ship structure result in many measurement difficulties additionally the energy transmission paths can be found numerically and the sea method is at the core of the path determination strategy the first description of the contribution of an energy transmission path between two subsystems was made in craik 1979 1996 additionally later works showed that the energy level in a subsystem can be recovered by adding the contribution of all the paths heading such subsystems craik 1996 magrans 1993 using graph theory to obtain the energy transmission paths in a sea model was first proposed in guasch and cortés 2009 a graph is a set of elements that share pairwise connections furthermore a sea model consists of subsystems and the interactions of power flow between them therefore the theoretical similarities between a graph and a sea system can be found in the premise of each method as mentioned in guasch and aragonès 2011 and in guasch and cortés 2009 the problem of reducing the energy of a set of target subsystems in a sea model could be solved in the general framework of graph theory as in gross and yellen 1999 carré 1979 diestel 2005 the work done in guasch and cortés 2009 shows that a sea model can obtain more information by establishing the connection between graph theory and the sea method via a sea graph 1 1 a graph that represents the sea system for noise and vibration control purposes as a possible application of graph theory to vibroacoustics a graph cut algorithm strategy that computes cuts in the graph separating source and target subsystems is implemented to achieve energy reduction at a target subsystem with the sole modification of a reduced set of loss factors guasch et al 2011 while determining the vibroacoustic behavior and energy transmission paths for a system another issue related to noise and vibration control arises when ranking source to target energy transmission paths ranking the energy transmission paths i e determining the relative importance of these paths is significant because a small set of dominant paths can carry a high percentage of the overall energy guasch and aragonès 2011 ranking energy transmission paths requires a systematic path search in a vibroacoustic system model and a systematic dominant energy path ranking approach as mentioned in guasch and aragonès 2011 the association between sea and graph theory was established in guasch and cortés 2009 by defining a generating matrix of the sea system series solution with the adjacency matrix of a graph designated as a sea graph a systematic procedure to determine the set of k ranked dominant energy paths in a sea model was addressed in guasch and aragonès 2011 using graph theory tools found in guasch and cortés 2009 the graph theory based systematic procedure for ranking the dominant energy paths developed in guasch and aragonès 2011 will be combined with a sea graph approach using the path detection algorithm in guasch and aragonès 2011 adapting this procedure for optimizing vibroacoustic behavior will be one of the main goals of this paper another goal is to extend the use and performance of this approach for investigating the vibroacoustic behavior of a ship s structure for this purpose the component in a ship s structure with the most impact on ship acoustics underwater noise will be modelled as a sea model for mid and high frequency ranges then the structure borne energy transmission paths are found each path extends between the effective vibration source of the gearbox system and the target of keel bottom underwater hull plates each path will be identified and ranked according to the energy contribution to the target the paths that yield the highest contribution are then determined as ideal candidates of ship structural elements to be modified to reduce the structural vibration on keel bottom and underwater noise accordingly finally a parametric fem model which represents a limited version of the analyzed ship structure is built this reduced parametric fem model is used to analyze the structural design modifications using the ideal parameters the sea model of the ship structure is then modified using the best acoustically improved structural modification parameters the modified ship structure is used to verify that the modified structural elements have reduced the energy levels in terms of structural vibration moreover the structure borne energy transmission paths for the modified ship structure are independently determined to comprehend how the structural modifications impact their behavior ships reveal problems when they provide both a workplace and a living environment for onboard personnel these personnel are often exposed to high noise and vibration levels for extended periods of time thus to have the capability to predict this vibroacoustic behavior during the design phase is critical to ensure that vibration and noise levels are minimized yücel 2009 connelly 1999 furthermore the underwater noise generated by commercial ships is known to significantly contribute to ambient noise which has a negative effect on marine life in the ocean mckenna et al 2012 silenv 2012 sound is one of the most important aspects to consider for improving and maintaining stealth in military applications recently growing interest has shown that underwater radiated noise is also problematic for civilian ships e g oceanographic and research ships and industrial ships e g merchant sailing in special sea protected environments mckenna et al 2012 silenv 2012 aquo 2012 2015 sonic 2012 2015 streamline 2014 the acoustic performance of these noise and vibration sources can be improved by using adequate and resilient mounting that has passive semi passive or active control damping mechanisms 2 2 passive control means where no external energy is applied to the vibrating system whereas semi passive and active control express mechanisms where the system is connected to energy conversion materials such as piezoelectric materials and magnetic transducers without energy input and where an intelligent feedback looks control devices i e sensors gain controller etc are included respectively to mitigate the vibration and noise problems related to underwater noise and to improve the comfort of onboard personnel the ship s structural design can be optimized to minimize structural vibration since this passive control mechanism can be carried out at the structural design phase of a ship the ship can be improved acoustically without the need for expensive and costly remedial work on a completed vessel thus maximum path search mps algorithm adapted for structural ship design can be regarded as a complementary method to optimization techniques like monte carlo or parametric methods this paper is organized as follows in section 2 the mps algorithm that finds the k dominant energy transmission paths between a source s and a target t in a sea problem is defined then to extend the performance and use of the algorithm to practical cases its methodology is carried out for the structural design of a ship in section 3 the adapted mps algorithm is applied to the problem of finding the structure borne energy transmission paths in a sea model of the ship s structure in section 4 a parametric study is performed then the sea model of the ship structure is analyzed to confirm that the modified ship structure has reduced structural vibration energy levels a set of modified structure borne energy transmission paths are also explicitly found in this section finally a summary of the work is provided in section 5 2 determination of the dominant energy transmission paths in sea via graph theory 2 1 sea formulation once the subsystems are divided and the parameters i e loss factors are defined a sea formulation facilitates the energy level determination for every subsystem via the power balance equations characterized by eq 1 1 w i j j i n w j i w i d j j i n w i j i j 1 n where w i represents the external power input w i d is the power lost due to the internal dissipation mechanisms n is the number of subsystems in the sea system and w i j is the power flow from subsystem i to subsystem j in eq 1 the left hand expression represents the power inputs of the subsystem and the right hand expression represents the power outputs of the subsystem in a sea model the parameters needed for each given frequency band are the loss factors there are three types of loss factors the coupling loss factor clf η i j is the ratio of energy transferred from subsystem i to subsystem j the internal or damping loss factor ilf η i d represents the ratio of energy lost as heat in subsystem i the total loss factor tlf η i that is the total energy lost in subsystem i is characterized by eq 2 2 η i η i d j j i n η i j where n is the total number of subsystems the dissipated power w i d is characterized by eq 3 3 w i d ω η i d e i the term ω is the center frequency of the frequency band and e i is the energy of the subsystem i the transmitted power is defined as follows 4 w i j ω η i j e i therefore the power flow between two subsystems can be provided as in eq 5 5 w i j w j i ω η i j e i n i n j e j where the consistency relationship resulting from coupling power proportionality cpp in sea method n i η i j n j η j i has been used as seen in eq 5 the power flow between two subsystems is proportional to the difference between their energy densities if expressions 3 and 4 are substituted into 1 the relationship is element wise characterized in eq 6 and in matrix form in eq 7 6 w i ω η i d e i ω j j i n η i j e i η j i e j 7 η 1 η 21 η 31 η n 1 η 12 η 2 η 32 η n 2 η 13 η 23 η 3 η n 3 η 1 n η 2 n η 3 n η n e 1 e 2 e 3 e n 1 ω w 1 w 2 w 3 w n the matrix found in eq 7 represents the loss factor matrix and is denoted by ℋ thus the system of equations in sea formulation can be defined as follows 8 ℋ e 1 ω w e 0 the term e is the unknown vector of subsystem energies and w is the external power inputs 2 2 energy transmission path analysis in sea finding the maximum energy transmission path in a sea model corresponds to the problem of finding the shortest path in a graph guasch and aragonès 2011 the shortest path problem is well understood and studied extensively several algorithms have also been developed guasch and aragonès 2011 the k shortest path problem was solved in the literature of different disciplines in two ways finding a set of simple paths 3 3 simple paths correspond to loopless and unconstrained paths which do not satisfy the optimality principle martins et al 1999 and finding paths with repeated vertices guasch and aragonès 2011 because the second type can find loops this method is suitable for the sea problem in the sea problem the k dominant energy transmission paths transmit energy from a source s to a target t with the help of loop paths guasch and aragonès 2011 the work in guasch and aragonès 2011 which finds the set of k dominant energy paths between a source and target in a sea model is in fact based on an adaptation of the mps algorithm first developed in martins et al 1999 in a typical sea problem energy is transmitted through paths and between subsystems thus a path in a sea model corresponds to an energy transmission path linking subsystem i to subsystem j the energy contribution of a path is computed via a product of the energy contributions of the direct paths i e first order paths constituting a path craik s definition guasch and aragonès 2011 craik 1990 1996 of the contribution of a n th order path p i j n from subsystem i to subsystem j is as follows 9 w p i j n η i h 1 η h 1 η h 1 η h 2 η h 2 η h n 1 j η j note that the weight of a first order path η i j η j will always be less than unity if the system is a weakly coupled system i e η i j η i as the order of the path increases its contribution gets smaller accordingly the contribution of very long paths tends to zero therefore there will be several paths with negligible contributions when compared to paths with a high amount of energy in eq 8 the system of equations in the sea formulation describe the relationship between the subsystem s energy and the total contribution of the paths leading to a target subsystem to find a solution the system of equations can be rewritten by a procedure other than taking inverse of the loss factor matrix ℋ first every row in the system of equations in matrix form 7 is divided by the corresponding diagonal element of ℋ second ℋ and vector e 0 are redefined respectively as ℋ d i a g 1 η i ℋ and e 0 d i a g 1 η i e 0 and then the matrix s is defined such that ℋ i s consequently the solution of the system of equations can be found via a neumann series expansion 10 e i s 1 e 0 n 0 s n e 0 if the spectral radius of s is less than unity thus the series converges which will always be the case in sea guasch and aragonès 2011 craik 1996 magrans 1993 the elements of s correspond to the first order energy transmission path from subsystem i to subsystem j as defined in eq 11 11 s i j 0 i j η j i η i i j furthermore as proven in magrans 1993 the n th power of s involves elements that result from the contributions of the n th power paths between every pair of subsystems considering that the path contribution results from a product of quantities less than unity then we can say the longer the path the lower its contribution i e i s i 0 therefore after some power of s matrix the path contribution to the total energy of the system is negligible this suggests that in some cases a substantial portion of the total energy at the target subsystem can be represented by a smaller group of paths and these paths belong to the small group called the dominant energy transmission paths 2 3 use of graph theory for providing energy transmission paths in sea the value of providing energy transmission paths in a vibroacoustic system has been demonstrated the subsystem energies can be decomposed in terms of energy transmission paths by means of the series expression in eq 10 however a direct method to provide such paths and to work with them is still missing the approach proposed in guasch and cortés 2009 suggests the use of graph theory to obtain the energy transmission paths in a sea model accordingly the problem of reducing the energy for a set of target subsystems in a sea model could be solved in the general framework of graph theory in this section a graph that represents a vibroacoustic system is developed so that the mps graph algorithm can be used to solve problems related to energy transmission paths first the graph that represents the sea system and is called the sea graph will be introduced as stated in guasch and cortés 2009 a sea graph 4 4 in a sea graph the nodes correspond to the sea subsystems and the arcs to the first order paths between those subsystems represented by g s e a u s e a e s e a is defined as a simple digraph 5 5 a graph whose arcs have a definite direction i e u i u j u j u i is called a directed graph or a digraph whereas a graph where u i u j u j u i is named undirected graph a graph is said to be symmetric if for every arc u i u j e exists an arc u j u i e s e a a graph which is anti reflexive and symmetric is called a simple graph such that every node u i in u s e a corresponds to a sea subsystem accordingly the directed arcs u i u j u j u i e s e a exist between subsystems u i and u j whenever they are coupled in the sea model the arc weights w i j and the path algebras are selected depending on the vibroacoustic problem to be solved guasch and cortés 2009 for the case where the most dominant energy transmission paths between a source subsystem and a target subsystem are located the arc weights w i j are identified with the contribution of the first order paths between subsystem i and subsystem j 12 w i j w i j η i j η j i f u i u j e s e a 0 i f u i u j e s e a note that the weighting matrix w 6 6 w can be also called weighting matrix in a sea graph coincides with the transposed generating matrix s t in the neumann series solution of the sea algebraic matrix system defined by eqs 10 and 11 furthermore the weight of a path belonging to a sea graph is defined to coincide with the craik s definition of a sea path in eq 9 13 w p u i 0 u i n n w u i 0 u i 1 w u i 1 u i 2 w u i 2 u i 3 w u i n 1 u i n η i 0 h 1 η h 1 η h 1 h 2 η h 2 η h n 1 h n η h n the next step of computing the dominant energy transmission paths using graph theory is to define the condition when a path has a higher energy value dominates than a distinct path for this purpose the highest energy contribution paths i e the maximum weight paths in terms of graph theory must be obtained given two paths p i j and q i j the condition of domination denotes that p s t dominates q s t if w p s t is greater than w q s t 14 p s t q s t w p s t w q s t to define the problem of determining the set of k dominant energy transmission paths in a sea model suppose two nodes 7 7 s is usually identified with a source subsystem where external energy is being input and t is identified with a target subsystem where energy is to be reduced guasch and aragonès 2011 s and t in a sea graph g s e a are given guasch and aragonès 2011 then to find the set p s t k p s t 1 p s t 2 p s t k p s t 8 8 p s t denotes the set of infinite transmission paths from a source subsystem s to a target subsystem t such that w p s t k w p s t k 1 k 1 k 1 w p s t k w q s t q s t p s t p s t k p s t k is found just before p s t k 1 k 1 k 1 as stated in guasch and aragonès 2011 the aim is to find a set of k paths such that the k th path in the set transmits more energy than the k 1 path first item such that any path in the set transmits more energy than any path not belonging to the set second item and such that all paths in the set are computed in order i e first the maximum energy transmission path p s t is found then the second dominant path then the third one and so on until the k th path third item suppose that a sea digraph g s e a u s e a e s e a with adjacency matrix w is given by the transpose of the generating matrix s of the neumann series solution of the sea system i e w s t as described in a theorem in guasch and aragonès 2011 there exists a finite and maximum energy transmission path from the source s to the target t in g s e a the theorem states that the set p s t k of k dominant paths exists thus each k path i e p s t k includes a finite number of nodes and each k path transmits a finite amount of energy the proof of this theorem depends on theorem 1 in martins et al 1999 but is adapted to the sea framework in guasch and aragonès 2011 the proof of this theorem and a related corollary are explained in full detail in guasch and aragonès 2011 and will not be reproduced here the mps algorithm to be used to compute the set of k dominant energy transmission paths in a sea model as mentioned above is generated in this study using matlab software for this purpose the pseudocode of the mps algorithm given in guasch and aragonès 2011 is employed to code our algorithm in matlab see guasch and aragonès 2011 for more details of the pseudocode of the mps algorithm reproduced in this study 3 dominant energy transmission paths for the local ship structure 3 1 description of sea model of the local ship structure the mps algorithm was tested by finding the dominant energy transmission paths for the realistic example of a 24 room test building found in guasch and aragonès 2011 valuable information about the energetic behavior of a sea model can be derived from the mps algorithm since ships have more detailed structural arrangements their structures are more complex compared to other structures like buildings due to this complication adapting the algorithm is a worthwhile effort to assess noise and vibration problems in ships at the design stage which has never been done before in this section the local part of a research ship structure will be modelled for mid and high frequency ranges then by using the mps algorithm the dominant energy transmission paths from the vibration source gearbox system to the target keel bottom plates will be determined and ranked these components are ideal structural ship elements that can be modified to reduce the structural vibration on keel bottom and underwater noise accordingly the local part of a research ship structure that dominates the ship acoustics underwater noise has been created as a sea model with the commercial package va one a vibro acoustic program see fig 1 the modelling strategy of this sea model is described as follows this model includes the foundation structure of the gearbox system which is considered a dominant vibration source and the keel bottom plates which are considered as the target structures the decks and bulkheads of the engine room which are secondary to the energy transmission paths are also included in the sea model the sea subsystems are uniform and ribbed flat plates and beams which represent the structural configuration of the engine room there are 1991 uniform or ribbed flat plates and 555 beams they have all been generated physically since the model was created with multi vibrational modes 9 9 a flat plate can be modelled with flexural bending plane tension compression and plane shear waves in va one whereas a beam can be created with flexural bending waves in two axial directions and tension compression and torsional waves i e flexural tension compression shear and torsional waves have all been considered then any flat plate is represented by three subsystems whereas any beam is represented by four subsystems thus the model is composed of 8193 subsystems in total considering the continuity of the vibration energy transmission path under the structural foundation the model boundaries have been extended by overlapping neighbor compartments and the engine room the principal noise and vibration sources for ships are typically composed of the main propulsion systems the auxiliary systems and the propellers for instance for naval ships this is particularly significant because the acoustic signature allows detection by submarines depending on the driving force frequencies of systems in general the noise and vibration sources on ships contain discrete components at specific frequencies when these frequencies coincide with the resonance frequencies of ship structures the latter may generate inadmissibly high vibration levels therefore to characterize the entire vibroacoustic system for onboard noise and vibration control the dominant energy transmission paths need to be computed at all possible coincident frequencies of systems and ship structures thus the energy transmission path analysis using the adapted mps algorithm has been performed for a sea graph corresponding to 1 3 octave frequency bands between 200 hz and 1000 hz for each analyzed condition therefore the mps algorithm has been carried out individually for the 1 3 octave center frequencies 200 hz 250 hz 315 hz 400 hz 500 hz 630 hz 800 hz and 1000 hz two separate conditions condition 1 and condition 2 have been considered as the source target configurations see fig 2 these conditions have been determined according to the following considerations one of the flat plates which is the dominant vibration energy generator of the gearbox system has been assigned to be the source s for both conditions the intention of each source target configuration is to find the structural vibration level on the hull shell structure which generates the underwater noise by transmitting vibrational energy to the sea water from the vibration source as a result the targets consider two different structural components of keel bottom in condition 1 the target structure has been selected as the shell plate near the keel line whereas in condition 2 the target structure has been selected as the shell plate between the keel line and ship draft furthermore to concurrently see the effects of the source target distance and the target position in the system the target structures of these conditions have been chosen for different port and starboard sides and close and stand off distances 3 2 determination of the number of k dominant energy transmission paths to determine the number of the dominant energy transmission paths in the computed total energy of the paths the relative percentage of each dominant path is considered as the order of computed dominant paths increases the energy transmitted by each individual path contributes less to the total energy transmitted in terms of energy levels this means that when the number of computed dominant paths reach a certain value the energy contribution of the next dominant path will be negligible due to the reduction of the path weight for this purpose the mps algorithm solutions of condition 1 and condition 2 for 500 hz have been taken for 300 and 500 sorted paths respectively then the relative percentage of the energy transmitted via an individual path is calculated for each condition as seen in fig 3 the first 150 and 300 sorted energy paths can be observed for condition 1 and condition 2 respectively these energy paths approximately represent the relative percentage of any subsequent path that no longer varies since the mps algorithm solutions for the remaining frequencies have shown the same tendency as the 500 hz case then these solutions can be used for k dominant energy transmission paths for all frequencies note that the first 150 and 300 sorted energy paths for condition 1 and condition 2 respectively roughly transmit more than 95 of the computed total energy of the paths to the target although the number of dominant paths to be computed have been decided according to their relative percentages the overall energy of the target will come from the primary vibration source of the model thus the energy transmitted via a set of dominant paths also justifies reaching the high percentage of the target energy the abrupt variation of the weights of the dominant energy transmission paths shown in fig 4 supports this inference the number of paths to be computed needs to satisfy the required energy level of paths that grows exponentially as seen in fig 3 as stated in guasch and aragonès 2011 this consequence is not unexpected since the neumann series expansion of the sea system solution states that an infinite number of paths will be accounted for guasch and cortés 2009 for condition 1 8 of the total transmitted energy is transferred via the maximum path which is the fifth order path linking the source and target plates 4 of the total transmitted energy is transferred via the 2nd dominant path which is the fifth order path finally 3 8 of the total transmitted energy is transferred via the 3rd dominant path which is also the fifth order path for condition 2 the orders and energy percentages transmitted with the maximum 2nd and 3rd dominant paths are the twelfth order thirteenth order and thirteenth order paths with 3 8 2 6 and 1 7 of the total transmitted energy respectively because of the short source target distance the orders of dominant paths in condition 1 are less than those in condition 2 while the weight and transmitted energy of dominant paths in condition 1 are much more than those in condition 2 consequently the energy transmitted through the first several dominant paths become more applicable in condition 1 however the high percentage of the overall energy at the target in condition 2 can be obtained via more dominant paths that are equally ordered and significant this outcome interprets and justifies that the mps algorithm solutions for condition 2 require more dominant energy transmission paths 500 than condition 1 300 to transmit the equivalent energy level through them 3 3 the mps algorithm solutions for dominant energy transmission paths by solving the adapted mps algorithm for instance for 500 hz the energy transmitted through the set of the first three dominant paths and the last dominant paths i e 150th for condition 1 and 300th for condition 2 are shown in fig 5 and fig 6 10 10 since they deface the view the type names of plates have not been included for condition 2 in fig 6 respectively examining the structural arrangements contained within the given dominant paths for both conditions see table 2 for type definitions the involvement of the paths varies slightly in terms of the structural element types the paths mainly consist of the sectional groups of elements located between the source and target structures the main reason that the paths are grouped with similar structural elements is because the sea model composition includes all types of vibration modes for both flat plates and beams after examining the wave types the flexural waves are more important in the first dominant paths for both conditions this outcome makes sense since the major part of the vibrational energy existing on ship structures generally spreads over the ship structure in the form of flexural waves considering the behavior of the dominant paths we can account for all types of structural elements of the ship this includes the assessment of the whole energy transmitted for each condition thus the complete set of structural elements appearing in 150 and 300 dominant paths for condition 1 and condition 2 respectively is shown in fig 7 for the frequency 500 hz the mps algorithm solutions that are carried out for the 1 3 octave center frequencies 200 hz 250 hz 315 hz 400 hz 630 hz 800 hz and 1000 hz are provided in appendix a the number of loss factors belonging to the dominant paths that will be changed to reduce the energy at the target structure will depend on several factors the loss factors depend on the number of dominant paths used to obtain a certain percentage of the target energy but also on the structural configuration of these dominant paths the characteristics of the structural elements that are involved in dominant paths reveal another strange correlation for example because of the computation of condition 1 for 500 hz one finds out that the longest path in the set of 150 dominant paths only uses 8 subsystems 11 11 the set of multi subsystems is made up of different vibration mod waves and is the single subsystem that represents the physical structural element excluding the source and targets furthermore the 150 dominant paths only involve 27 different subsystems thus the analysis of the 300 sorted dominant paths for condition 2 reveals that the longest path in the set is composed of 17 subsystems and the 300 dominant paths include 93 different subsystems the analyses of all sorted dominant paths for both conditions were carried out for all frequencies the results have revealed that the longest path in the sets has been made up of 8 subsystems for condition 1 and 17 subsystems for condition 2 the number of different subsystems involved 150 and 300 sorted dominant paths for condition 1 and condition 2 respectively and are summarized in table 1 note that the number of different subsystems for each condition occurred roughly at the same level for the full range of frequencies previous findings justify that the length of dominant paths or the involvement of different subsystems can be simply provided from the analysis outputs of ranked paths of the mps algorithm considering that all sorted dominant paths end up with a small number of different subsystems the dominant paths cover cycles in large quantities and that they do not separate considerably from the source and target subsystems in addition this behavior also suggests that these dominant paths involve a small number of different structural element types that need to be modified and that they consist of similar ship structural elements in general from this point of view subsystems can be grouped according to their structural element types in addition to the grouping behavior of dominant paths as stated before moreover subsystems can be classified according to the number of paths in which they appear guasch and aragonès 2011 this classification informs us about specifying the subsystems that need to be modified to ensure that the energy at the target can be reduced the loss factors belonging to these classified subsystems are involved in a largest number of paths and will be the best candidates to be modified for the reduction of the energy at the target structure guasch and aragonès 2011 since one of the main goals of this study is to reduce the structural vibration of the keel bottom and underwater noise by performing the adapted mps algorithm taking advantage of the classification of the dominant energy transmission paths found is crucial the ideal structural elements of the ship that need to be modified can be determined from the dominant paths first the ship s structural elements have been designated in accordance with the structure types as provided in table 2 the number of structural elements that were classified according to the number of paths in which they appear are listed in table 3 and table 4 for condition 1 and condition 2 respectively along with their percentages note that the set of multi subsystems that is made up of different vibration mod waves is the single subsystem that represents the physical structural element type 1 type 2 type 3 and type 4 are the best candidates to be modified for the reduction of the energy at the target structures this is the result of the numbers of paths and percentages determined when calculating the dominant energy transmission paths for both conditions these optimum candidates if modified properly are expected to reduce the structural vibration of the keel bottom and thus decreased underwater noise depending on the radiation efficiency between the underwater hull structure and the surrounding water consequently results show that very valuable information related to the structure borne energy transmission pattern can be derived from complex ship structures modelled with the sea method by using the adapted mps algorithm developed in this work 4 acquiring acoustically improved ship structures via the mps algorithm 4 1 structural modifications applied with a parametric study the acoustic properties of a ship are affected by the increasing flexural rigidity used during the ship s design phase this information may provide some practical design measures that can reduce the structural vibration the variation of the ship s flexural rigidity can improve with these changes but they also can deteriorate certain vibroacoustic characteristics such as mechanical impedance vibration conductivity sound radiation ability and sound insulation therefore modifying a single parameter e g the thickness of a plate structure or the dimensions of the ribs frames can not ensure that the ship s overall vibroacoustic characteristics can be improved instead they can be modified by using a parametric approach that takes care of all practical modification parameters belonging to dominant energy transmission paths which have a forceful impact on ship acoustics the modifications that need to be applied to a ship structure are restricted due to other ship design priorities such as strength requirements so they need to be adaptable at this stage the structure borne energy transmission paths that have been found via the adapted mps algorithm developed in this study will be considered this initial designation leads to the selection of indefinite parameters associated with a system s loss factors the structural elements of the paths are referred to modifiable items in a parametric study to interpret how the applied structural modifications impact the vibroacoustic characteristics of the ship structure at coinciding 12 12 when the frequencies of driving forces and the resonance frequencies of ship structures coincide the structural vibration may get inadmissibly high levels through decreasing of the mechanical impedance frequencies requires a narrow band frequency analysis that can be performed with one of the numerical methods such as fem the sea model which has been used to compute the dominant energy transmission path analysis using the adapted mps algorithm is transformed to the fem model via the commercial package of the ansys program for vibroacoustic analyses for narrow band frequency range between 200 hz and 1000 hz to focus on best candidates of the type 1 type 2 type 3 and type 4 structural elements a more representative structure of the foundation itself is created these elements will be modified to reduce the energy of the target structure this parametric model contains acoustic fluid elements demonstrating the acoustic medium needed to calculate quantities such as acoustic pressure the driving force load of the gearbox system for the ship service speed provided is applied on the source the foundation top plate type 4 this parametric fem model is shown in fig 8 the modification strategy to increase the stiffness and or vibration insulation in general causes the weight of the ship structure to increase which is not always acceptable in ship design therefore there is a trade off between the acoustic improvements and the ship structure that needs to be considered the variations to be applied to the thickness of a plate or the dimensions of ribs are determined by providing the minimum impact to the total ship weight the modified parameters which are selected as discrete values provided by the ship building industry for four types of structural elements are defined as in table 5 which provides a total of 144 modification cases the radiation of the sound emitted from a plate can be determined from knowledge of the plate s vibration and radiation properties the structural modifications applied to the parametric fem model will change both the velocity distributions on keel bottom plates type 1 and their radiation efficiencies if the sound power quantities for the modified structures are computed efficient and inefficient modification cases can also be obtained in terms of their sound powers therefore the competence of the modification cases is categorized via their sound power radiations which occur in the fluid domain of the parametric fem model the sound power is defined as 15 w s i d s s i n d s where i p v is the sound intensity vector p is the sound pressure v is the particle velocity i n is the sound intensity normal to the surface s and s is the area of surface enclosing the source in practical situations the relationship between sound pressure level sound power level and normal sound intensity level is not straightforward thus an accurate estimation of sound power level cannot be accessed by using sound pressure quantities however in two ideal cases the free field and a diffuse field sound power is explicitly related to the sound pressure the fluid domain in the parametric fem model is assumed to be deep water representing the free field in an acoustic medium thus the formulation that needs to be developed for the free field is employed in this study for a progressive wave there is a unique relationship between the mean squared sound pressure and the intensity in the direction of the wave propagation characterized by i p 2 ρ c where c is the speed of sound and ρ is the density of the acoustic medium splitting the surface s into n distinct pieces s n the discrete form of eq 15 becomes 16 w n 1 n i n s n free field n 1 n p n 2 s n ρ c the sound power level is estimated by the expression 17 l w 10 log w w 0 10 log n 1 n p n 2 s n ρ c w 0 db for each frequency eq 17 is employed to yield the sound power levels l w resulting from the computed sound pressures p n of acoustic fluid elements having s n areas after the vibroacoustic analyses are carried out for the parametric fem model corresponding to the 200 1000 hz frequency range 144 sound power levels have been computed and now represent each modification case twelve of the best structural design solutions among them are designated to demonstrate the influence of the modification parameters in terms of sound power levels the sound power level of the initial structural configuration is analyzed using modification cases and is compared with the best structural design solutions of the foundation structure by considering the engine room of a research ship see fig 9 and fig 10 the results show that modified structural elements reduce the structural vibration and the sound power level almost 4 db in the parametric model if the modification of the optimum design case strategy ensures acceptable weight increases to the structure then the local ship structure representing the engine room can be made in the same manner 4 2 vibroacoustic analyses of the sea model for the local ship structure now we can focus on analyzing the vibroacoustic response of the local ship structure to determine whether modifying this structure will result in a decrease of the structural vibration transmitted to the target structures the initial structural design of the engine room has been modified by applying the optimal structural design solution d9 w15 t100 b100 shown in fig 9 and fig 10 the structural modifications of type 2 type 3 and type 4 structural elements have been applied to the identified foundation regions while the type 1 structural element is altered with new rib dimensions throughout the underwater hull structure the plate thicknesses of type 2 and type 3 structural elements have been modified by 15 mm with respect to the plate thickness of 10 mm for the original geometry the type 4 parameters have been changed by 100 mm with respect to a thickness of 60 mm for the original geometry in addition the size of the stiffening ribs belonging to type 1 plates have been increased from hp80x5 to hp100x6 for the optimum design case note that the thickness of the type 1 plates is identical for both the initial and optimal design cases the initial and modified structural designs of the local ship structure are analyzed using sea method using the driving force load applied in fig 11 the structural vibration velocity results at both target plates and source plate have been plotted for a comparison of both structural designs our goal is to diminish the structural vibration of the underwater hull structure which is composed by two target plates when the vibration is generated at the source of the foundation top plate a comparison between the results that are obtained from the sea models of the initial and modified structural designs highlights advantages of using energy path based methods the structural vibration reduction throughout the frequency range for both conditions is investigated fig 11 a and b we observe that the structural vibration velocity in the corresponding foundation top plate subsystem is diminished throughout the frequency range fig 11 c given that the structural vibration reduction occurs in the source structure the applied vibrational energy at the source is sufficiently reduced this provides reduced energy transmission for all the targets and the contribution to their structural vibration reduces accordingly the overall structural vibration velocities and their associated reduction percentages obtained for the source and target subsystems in the whole frequency range are provided in table 6 as observed both condition 1 and condition 2 yield very similar reduction percentages with the first value being slightly superior to achieve the acoustically improved ship structure results taken from graph theory calculations have been used to determine modifications of the ship structure by employing a parametric study a strategy based on the computation of the mps algorithm can be adapted to diminish the energy transmitted from a source subsystem to a set of target subsystems in realistic frequency dependent ship structures 4 3 the mps algorithm solutions for the acoustically improved local ship structure after being modified the reduced sea system energy will tend to redistribute and reach the target subsystems via alternate transmission paths the mps algorithm can also be used for the modified ship structure by testing how the applied structural modifications may alter the characteristics of the dominants energy transmission paths by considering that the results found for 500 hz in the initial case may roughly represent the behavior of the dominant paths found for the full range of frequencies the mps algorithm are performed well with only 1 3 the octave center frequency of 500 hz by solving the adapted mps algorithm for the modified ship structure at 500 hz the energy transmitted through the set of 1 st and 3 rd dominant paths for both conditions are shown in fig 12 the involvement of the paths varies slightly in terms of the structural element types this is found by comparing the structural arrangements to those of the initial case for condition 1 see fig 5 nevertheless the dominant paths in the modified case for condition 2 consist of additional subsystems with respect to those in the initial case see fig 6 since the stand off source to target distance allows more structural elements to lie between the source and target structures in the dominant paths then the structural modifications in condition 2 influence the involvement of the dominant paths more than those in condition 1 the complete sets of structural elements that appear in the 150 and 300 dominant paths in modified case for condition 1 and condition 2 respectively consist of the same structural elements as in the initial case all but a few subsystems are excluded and therefore every new set is not illustrated here see fig 7 the main reason for the paths to be formed by grouping structural elements of the same kind is because the first four structural element types are the leading terms of the sea model furthermore the result of the modified case also confirms that all sorted dominant paths end up with a small number of unique subsystems as seen in the initial case the number of structural elements that are classified by the number of paths in which they appear is presented in table 7 for both conditions along with their percentages furthermore the energy transmitted for each condition is plotted with respect to the number of the dominant paths as shown in fig 13 an assessment is made for the total energy transmitted in each case note that the percentages of all subsystems involved vary slightly for both cases and conditions see tables 3 and 4 this result tells us that the ideal candidates that were modified are still influential in transmitting the energy from the source to the target in the system as seen in fig 13 the variation of the weights applied to the dominant paths confirms the reduced energy transmission in the modified case the structural modifications for both conditions yield very similar results the latter being only slightly superior the reduction percentages in terms of overall weight increase from 19 3 to 25 2 for condition 1 and condition 2 respectively the results show that the structural modifications diminish the energy transmitted from a source subsystem to a set of target subsystems by providing the reduced sea system energy this outcome is consistent with the reduced structural vibration velocities obtained for the source and target subsystems of the modified ship structure provided in table 6 5 conclusions in this study a systematic procedure for ranking dominant energy paths is developed by using the algorithm found in guasch and aragonès 2011 for the marine industry this work also aimed to extend the applicability and performance of this procedure by analyzing the vibroacoustic behavior of a ship structure in comparison to structures like buildings ship design has more detailed structural arrangements thus adapting the algorithm is a worthwhile effort to solve noise and vibration problems in more complex structures at the design stage which has never been done before by adapting the algorithm to structural ship design we can predict the vibroacoustic behavior during the design phase and ensure that vibration and noise levels are minimized this type of early response can facilitate simple and cheaper solutions to the vibration and noise problems avoiding the need for expensive and costly remedial work on a completed vessel in this study a parametric fem model which represents a restricted version of the analyzed ship structure has been built to analyze the structural modifications resulting from the mps algorithm solutions the sea model of the ship structure has been altered by using the best acoustically improved structural modification parameters then the modified ship structure can be tested to verify that the structural vibrations have reduced energy levels the solutions found by adapting the mps algorithm to structure borne energy transmission of a ship can be regarded as a complementary step to optimization techniques like monte carlo or parametric methods the outcomes of the algorithm can be considered as extending the sensitivity of parametric approaches on the other hand the mps algorithm exposed in this work to rank paths have only considered the mean values of loss factors for path comparison subsystem energy variability due to loss factor and input power uncertainties being ignored however due to the influence of the statistical nature of sea on path ranking the path classification strategy needs to not only take into account the mean values of the loss factors but also their variances to tackle with uncertainties that occur in sea recently possible solutions to such a problem have been developed by several researchers aragonès and guasch 2015 christen et al 2017 acri et al 2017 finally this study has justified that the mps algorithm can highlight the advantages of setting sea transmission path problems of ship structures thus the algorithm can become a helpful tool for noise and vibration analysis at the design stage of ships a process to design the ship structure which could start with the identification of the most dominant energy transmission paths from source to receiver target subsystems is feasible and can be combined with graph theory to develop a systematic approach an analysis could then be made to find the best structural element candidates that have the most significant energy transmission finally this structure s energy contribution can be modelled and reduced by applying practical modifications using parametric or optimization approaches acknowledgments many thanks to àngels aragonès for her directing advises related to graph theory algorithms based on her work i would like to thank my colleagues in istanbul technical university for their support and encouragement in this work appendix a the complete set of ship structural elements included in all sorted dominant paths fig a1 200 hz all ship structural elements found in all sorted dominant paths a condition 1 b condition 2 fig a1 fig a2 250 hz all ship structural elements found in all sorted dominant paths a condition 1 b condition 2 fig a2 fig a3 315 hz all ship structural elements found in all sorted dominant paths a condition 1 b condition 2 fig a3 fig a4 400 hz all ship structural elements found in all sorted dominant paths a condition 1 b condition 2 fig a4 fig a5 630 hz all ship structural elements found in all sorted dominant paths a condition 1 b condition 2 fig a5 fig a6 800 hz all ship structural elements found in all sorted dominant paths a condition 1 b condition 2 fig a6 fig a7 1000 hz all ship structural elements found in all sorted dominant paths a condition 1 b condition 2 fig a7 
23304,this paper presents a numerical study on the kinematics of buoyant round jets in a wave environment a buoyant round jet was horizontally discharged at the mid depth in regular waves using three dimensional reynolds averaged navier stokes rans equations with the standard κ ε turbulence model three kinds of effluent with various densities were used for the jets the numerical results were compared with the experimental data with reasonable agreement observed the mechanism of the jet oscillation under different wave to jet momentum ratios was presented the effects of relative water depth the ratio of the wave height to the water depth and buoyancy on jet diffusion were considered among them the ratio of the wave height to the water depth appears to be the most important factor on jet diffusion processes under the conditions being considered finally the variations of the jet cross sectional profiles in the potential core region and the near field region were studied keywords water waves buoyant jet numerical study navier stokes equations model 1 introduction discharging jets into coastal areas is a common practice in many industrial applications for instance residential sewage hot water from power plants and brine from seawater desalination plants are discharged through marine outfalls located along a coastline the characteristics of the effluent e g density temperature and environmental forces e g currents tides and waves should be considered to understand the process of effluent dispersion for a neutrally round jet under a wave environment the diffusion characteristics have been quantified and qualified via laboratory measurements chyan and hwung 1993 mori and chang 2003 mossa 2004 ryu et al 2005 tam and li 2008 chang et al 2009 hsiao et al 2011 wang et al 2015 mori and chang 2003 observed various jet oscillation patterns under standing waves and classified them as symmetric asymmetric or discontinuous motions depending on the wave to jet momentum ratio ryu et al 2005 found that the effect of wave dispersion on jet diffusion under regular progressive waves is dominated by wave height not by wave phase the jet centerline velocity decays rapidly and the jet width increases with increasing wave height chang et al 2009 showed that the characteristics of the jet diffusion correlate closely with the wave to jet momentum ratio interestingly they found that the jet vertical width is smaller than the jet horizontal width in the potential core region but the opposite is true in the near field region hsiao et al 2011 quantified the mean and turbulence properties of a jet under regular progressive waves their results indicate that the mean jet width turbulence intensity and reynolds stress increased significantly when the jet was acted on by the waves however the mechanisms of jet oscillation and the variation of the jet width remain unclear a few studies have focused on the problem of a buoyant round jet in a current environment jirka 2004 2008 lam et al 2006 or a wavy environment chen et al 2009 lin et al 2013 jirka 2004 presented an integral model to predict the characteristics of turbulent buoyant jets in various flow fields jirka 2008 used the integral model to consider the effect of the discharge angle on a submerged negatively buoyant jet in a flat or sloping seabed lam et al 2006 measured the trajectory spreading and dilution of a jet in a counterflow via laser induced fluorescence chen et al 2009 utilized acoustic doppler velocimetry to measure the vertical velocity for a vertical buoyant round jet in random waves they found that the dilution rate increases with increasing wave effect lin et al 2013 measured the velocity field using particle image velocimetry for three kinds of buoyant jet in regular waves they reported that the buoyancy effect had a considerably smaller influence than the wave dispersion effect on the enhancement of jet diffusion due to limitations of measurement techniques and the use of an integral model a complete three dimensional 3d flow field for a buoyant jet in a wave environment is hard to obtain numerical modeling has been used as an alternative to investigate the problem with high quality results obtained for a jet discharging vertically in a wave environment chen et al 2008 simulated a neutrally buoyant vertical round jet under random waves using a 3d les model later chen et al 2012 extended the model to consider the buoyancy effect they found that the buoyant force weakens wave effect on the jet entrainment and mixing leading to a slower decay rate of the maximum velocity and a narrower jet width recently xu et al 2014 investigated the variation of the jet half width in random waves and regular waves using the les model and found that a jet has a smaller width in regular waves a jet discharged in the direction opposite that of wave propagation has been investigated chen et al 2015 2017 chen et al 2015 used a 3d rans equations model to discuss the wave effects for a neutrally buoyant horizontal round jet under regular waves they found that the jet vertical to horizontal width ratio is insensitive to the wave period with increasing wave height it decreased in the potential core region and increased in the near field region chen et al 2017 simulated a buoyant horizontal round jet in a stagnant environment they reported that the buoyant force influences the jet vertical to horizontal width ratio in the near field but not in the potential core region however the cause of vertical to horizontal width ratio for the buoyant jet in a wave environment remains unclear the objective of the present study is to investigate the kinematic characteristics of a buoyant round jet in a wave environment as mentioned previously the mechanisms of jet oscillating motion the characteristics of diffusion and the variation of the jet shape are not fully known especially in the lateral direction in this study the 3d features of buoyant jets are obtained using a 3d numerical model named flow 3d the model has been used to successfully simulate a neutrally buoyant jet in a wave environment chen et al 2015 and buoyant jets in a stagnant ambient environment chen et al 2017 the numerical model solves the rans equations combined with the standard κ ε turbulence model and the water surface deformation is captured using the volume of fluid method the setup of the numerical tank is based on a previous physical experiment hsiao et al 2011 lin et al 2013 the properties of jet diffusion and the cross sectional profile under the effect of buoyancy and waves are discussed due to a lack of a 3d velocity field in the experiment 2 numerical model 2 1 governing equations a three dimensional computational fluid dynamics code flow 3d solves navier stokes type equations embedded with various turbulence closure models in this study rans equations are solved with the standard κ ε turbulence model and the volume of fluid method is applied to track the water surface elevation hirt and nichols 1981 the interface between the fluid and solid boundaries is treated with the fractional area volume obstacle representation favor method which computes the open area and volume in each cell to define the area that is occupied by an obstacle the continuity equation the momentum equation with boussinesq approximation and the turbulent advection diffusion equation for density in tensor form are respectively 1 u i x i 0 2 u i t u j u i x j 1 ρ a p x i 1 ρ a x j μ u i x j u j x i ρ a u i u j g i δ ρ ρ a 3 ρ t ρ u i x i x i d m ρ x i u i ρ where x i represents coordinate directions i 1 2 3 for x y z directions respectively u i and p are the ensemble mean velocity component and mean fluid pressure respectively t is the time δ ρ is the density difference δ ρ ρ ρ a where ρ a is the density of the ambient fluid and ρ is the mean density of the fluid in a cell μ and d m are the fluid dynamic viscosity and molecular diffusivity of the fluid respectively g i is the gravity force field the reynolds stress term ρ u i u j is modeled by the standard κ ε turbulence model u i ρ u i ρ ν t s c t ρ x i is the turbulent fluxes of the mean density ρ ν t is the eddy viscosity and s c t is the turbulent schmidt number for more detailed information on the numerical model readers can refer to its manual flow science 2012 2 2 numerical setup the setup of the numerical tank which is based on a previous physical experiment hsiao et al 2011 lin et al 2013 is shown in fig 1 regular waves are generated at a constant water depth of h 33 cm from an inflow boundary by a given velocity and water surface elevation according to the stokes fifth order solution the flume is 210 0 cm 2l long l is the wavelength 50 0 cm wide and up to 40 0 cm deep the jet is discharged horizontally at mid depth h 2 from a tube with an inner diameter of d 0 62 cm a grid independent analysis was performed by using three different grid arrangements the grid sizes for the pipe s shape in the vertical and spanwise directions are d 5 named mesh 1 d 7 named mesh 2 and d 9 named mesh 3 besides the cells number in the region 10 y d z d 10 25 x d 65 is increased when a finer grid is utilized the total cells numbers are 7 3 million 9 5 million and 11 1 million respectively the grid independence is achieved for mesh 2 and for denser mesh besides the computational time was about eight days using 12 processors 3 2 ghz for mesh 3 and four days for mesh 2 which is used in this study the numerical sponge layer proposed by chen and hsiao 2016 is applied to prevent secondary wave reflections the absorption function is 4 f x 1 x x 1 3 x s 2 where x 1 represents the location at the beginning of the numerical sponge layer and x s represents the length of the numerical sponge layer the round jet is composed of a horizontal pipe and a source the former was simulated using the favor method and the latter was modeled using the mass flux method the mass flux method specifies an artificial particle velocity inside the computational domain the flow velocity u i and the particle velocity u p i from time step n to n 1 computed using an implicit particle fluid coupling method were used for modeling a source the approximate momentum equations are shown as eqs 5 and 6 they can be combined as eq 7 5 m f u i n 1 m f u i m p δ t k u p i n 1 u i n 1 6 m p u p i n 1 m p u p i m p δ t k u p i n 1 u i n 1 7 u i n 1 m f u i m p ω u p i m f m p ω where m f and m p are the fluid mass and the particle mass in a control volume k is a drag coefficient and ω δ t k 1 0 δ t k the tilde over the velocities indicates an estimate for the n 1 level velocity that contains all forces except for particle drag these velocities are computed explicitly by known in the time step n the coupling effect between fluid and particle is not considered ω 0 as a result u i n 1 equals u i therefore the mass flux method is used to specify a source inside the nozzle for modeling jets 2 3 model validation the experimental data reported by hsiao et al 2011 and lin et al 2013 are utilized to evaluate the capability of a numerical model simulating horizontal buoyant round jets in a wave environment the wave period t is 1 0 s and the incident wave height h is 3 0 cm at a depth of 33 0 cm the jet exit velocity u e is 1 28 m s three effluents of various densities are used for the jet the densities ρ e are as follows 0 98 g cm3 for positive buoyancy alcohol water d m 1 00 10 5 cm2 s 1 00 g cm3 for neutral buoyancy water and 1 02 g cm3 for negative buoyancy saltwater d m 1 61 10 5 cm2 s note that boussinesq approximation and the turbulent advection diffusion equation are unnecessary for neutrally buoyant jets because the effluent flow and the ambient fluid are the same fluid the values of s c t are determined by comparing the simulated results for the cases of a positively negatively buoyant jet discharging into a stagnant environment with the experimental data lin et al 2013 the result shows s c t 1 3 2 5 for the positively buoyant jets and s c t 2 5 5 0 for the negatively buoyant jets are in good agreement with the experimental data in this study the values s c t 1 6 and s c t 2 8 are adopted for positively and negatively buoyant jets respectively buoyant jets in a wave environment are validated by jet velocity and jet width the computed fluid velocity u i is decomposed into the jet velocity u j i and the wave velocity u w i which is determined from the condition without the jet the jet half width η 1 2 is usually used to describe the radial length scale of a round jet and the spread rate of the jet the half width is specified as the location z a x where the horizontal velocity of the jet u j is equal to half of the maximum horizontal velocity of the jet u c in a cross section i e u j u c 0 5 z a represents an axis parallel to the z axis and z a 0 indicates the centerline position of the jet where the horizontal velocity of the jet in a cross section is maximum since η 1 2 in a wave environment is asymmetrical the jet width 2 η 1 2 is the summation of the upper jet half width and the lower jet half width to quantify the jet diffusion in waves ryu et al 2005 hsiao et al 2011 lin et al 2013 figs 2 4 show the sectional horizontal velocity profiles in the potential core region and the near field region the velocity profiles are at a phase when the wave crest arrives at the jet exit for the neutrally buoyant jet the computed maximum horizontal velocities are slightly larger than the measurements in the near field region as shown in fig 2 the maximum velocity at x d 3 and 45 simulated by the model are 1 2 and 1 5 times greater than that in the experiment respectively this could be due to the fact that the standard κ ε turbulence model uses a constant turbulence length scale to limit the minimum turbulent dissipation for preventing unphysically small dissipation rates in general the parameter equals 7 of the hydraulic diameter d h however for this multi scale problem in this study the 0 07 d h is 0 043 cm for a tube with a 0 62 cm diameter but 3 983 cm for a wave flume with a 33 cm water depth and a 50 cm width these turbulence length scales were examined by the cases of a neutrally buoyant jet discharging into a stagnant environment and compared with the experimental data to determine a suitable value even though the jet velocity in the potential core and transition regions using the parameter equal to 0 043 cm show good agreement with the measured data the jet centerline velocity nearly does not decay in the near field region on the other hand the parameter equal to 3 983 cm shows a fairly good agreement with the experiment on the jet velocity and the decay rate of the maximum velocity in the near field figs 3 and 4 show the results of a positively and negatively buoyant jets respectively due to the density difference between the effluent flow and ambient fluid the jet moves to the water surface for the positively buoyant jet but moves to the seabed for the negatively buoyant jet the jet velocity for the buoyant jets is matched well between the experimental data and numerical results however there are some discrepancies between the numerical results and laboratory data this may be caused by the numerical parameters e g turbulence length scale turbulent schmidt number and the assumption in the eddy viscosity model and that may be improved by models with higher accuracy e g reynolds stress model large eddy simulation model fig 5 shows the variation of jet width 2 η 1 2 with the jet discharge direction when the buoyant jet is in stagnant and wave environments the modeled jet widths are in reasonably good agreement with the experimental values the total variation of jet width is shown by the model in the region from x d 0 to 10 there is no significant difference between cases after that the wave effect is noticeable but the buoyancy force has a relatively small effect interestingly a significant difference is shown when x d 27 for buoyant jets in a wave environment the jet widths for the cases under waves increase but the increasing ratio of the jet width depends on buoyant jet type the highest is for the positively buoyant jets and the lowest is for the negatively buoyant jets this trend is consistent with the influence degree of regular waves since regular waves at intermediate water depths are considered in this study the wave effect decays from the water surface to the seabed as a result the jet diffusion caused by wave motion for positively buoyant jets is larger than that for neutrally and negatively buoyant jets although some discrepancies between the numerical results and experimental data are observed the top hat profile in the potential core region the jet displacement due to wave and buoyancy and the variation of the jet width show reasonably good agreement with the experimental results 3 results and discussion 3 1 effect of wave to jet momentum ratio on jet oscillation mori and chang 2003 observed various jet oscillation patterns under standing waves to understand the effect and mechanism of the wave to jet momentum ratio r m on jet oscillating motion five wave heights h 1 2 3 4 5 cm with a constant wave period t 1 s were utilized for buoyant jets mori and chang 2003 shows r m can be expressed as eq 8 8 r m g k a 2 2 u e 2 where k is the wave number and a is the wave amplitude fig 6 shows a neutrally buoyant jet under various wave phases for r m 1 34e 03 3 01e 03 and 5 35e 03 the jet centerline and the jet half width are shown with the wave velocity field which was obtained for the cases without jets in the region from x d 0 to 20 the jet centerline is always continuous the position and orientation of the jet change due to wave motion when the wave phase changes from t t 0 to 0 5 the direction of wave velocity changes from left down to right down in this region therefore the jet shifts from a higher location to a lower location and the direction changes from the right up to right down then the direction of wave velocity changes from right up to left up during t t 0 5 to 1 0 i e t t 0 as a result the jet gradually returns to its original position at t t 0 even larger r m cause a stronger oscillation the jet centerline is still continuous and periodic in this region in contrast there is a significant difference between these cases in the region from x d 20 to 40 the jet oscillation appears asymmetrical for r m 3 01 e 03 and even discontinuous for r m 5 35 e 03 due to the variation of the wave velocity the fluid particle of waves has a right down velocity in this area at t t 0 3 but the vertical velocity distribution is nonuniform in space decreasing in the region from x d 20 to 40 therefore the part closer to the jet exit moves to the seabed but the part farther away mostly moves the downstream at t t 0 4 at this stage the jet is nearly separated at t t 0 4 a discontinuous point is observed at t t 0 5 since the part farther away moves in the direction right up and has a higher vertical velocity due to waves for positively and negatively buoyant jets similar phenomena were observed fig 7 shows the phase at t t 0 8 in the case of positively buoyant jets discontinuous motions are shown for r m 3 01 e 03 since the effect of waves on the jets is larger than the neutrally buoyant jets under the same r m as shown in fig 7 b for the buoyancy effect being considered in this study eq 8 is modified as shown in eq 9 the wave to jet momentum ratio including the buoyancy effect r m d depicts the discontinuous motion for the positively buoyant jets note that the wave enhances jet diffusion in the vertical direction especially for the buoyant jets in discontinuous motion will be discussed later therefore a depth resolving model is necessary to design the marine outfalls in practice 9 r m d g k a 2 ρ a 2 u e 2 ρ e 3 2 characteristics of jets in potential core and near field regions five various wave heights h 1 2 3 4 5 cm with a constant wave period t 1 s and another four incident wave periods t 0 8 0 9 1 1 1 2 s with a constant wave height h 3 cm were examined as listed in table 1 allowing the effects of buoyant force δ ρ ρ a 2 the ratio of the wave height to the water depth h h 0 03 0 15 and relative water depth kh 1 13 2 13 on jet diffusion to be taken into account note that r m d ranges from 3 28e 04 to 8 53e 03 the period averaged jet widths along the jet discharge direction are shown in fig 8 there is no apparent difference between different wave conditions when x d 20 except for r m d 8 36 e 03 the jet width for r m d 8 53 e 03 is larger than the others and with 17 wider than the case for r m d 0 at x d 6 the jet width then increases with increasing r m d when x d 20 interestingly the jet width is not monotonically increasing when 20 x d 40 for r m d 8 20 e 03 the rate of the jet width in space is decreased when 20 x d 30 and is increased until the maximum jet width occurs comparing with the jet in a stagnant environment the maximum jet width increased by 159 r m d 8 36 e 03 for the neutrally 124 r m d 8 53 e 03 for the positively and 118 r m d 8 20 e 03 for the negatively buoyant jets respectively when the jets under the waves it shows the buoyancy effect is significant with the increase of r m d the decreasing jet width is observed in the region from x d 40 to 60 since the jet width is a dimensionless parameter i e the dimensional jet width divided by the distance between the jet exit and the cross section it decreases even if the dimensional jet width remains the same on the other hand the boundary limits jet spreading in the vertical direction because the positively negatively buoyant jet moves gradually toward to the water surface seabed as a result the jet width decreases although the neutrally buoyant jets do not touch any boundary the reduction of jet width is still observed in the cases with a higher kh or h h as shown in fig 8 a for instance the jet widths for kh 1 13 and 2 13 at x d 50 are 0 37 and 0 30 respectively it shows that the jet diffusion due to the wave dispersion reaches a limitation note that the location where jets touch boundary is defined as u j u c 1 at boundary following chang et al 2009 the relation between r m d and the decay of centerline velocity as well as the relation between this ratio and the jet width in the near field region are discussed the decay of centerline velocity in the near field for a turbulent jet can be expressed as eq 10 pope 2000 10 u c u e b x x 0 d n where b and n are the decay coefficients and x 0 is the virtual origin of the jet the b for each case are obtained through curve fitting with n 1 0 and x 0 4d chang et al 2009 ryu et al 2005 the data from x d 30 to 40 is used to avoid the boundary effect from the bottom and water surface the coefficients of determination r squared r2 are above 0 91 for r m d 8 36 e 03 and above 0 85 for the others fig 9 shows the variation of the decay coefficient b and the jet width 2 η 1 2 under various wave to jet momentum ratios r m d and the experimental data measured by chang et al 2009 for a neutrally buoyant jet under regular waves are also shown as a reference the functions of the fitting line in fig 9 a is shown in eq 11 the coefficients c 1 c 2 are 76 2 3 6 for neutrally buoyant jets 48 1 3 5 for positively buoyant jets 83 4 3 7 for negatively buoyant jets and 69 0 3 6 for buoyant jets 11 b c 1 r m d c 2 fig 9 a shows the buoyant jets with a lighter density decay faster than the others for r m d 5 20 e 03 for h h 0 09 kh 1 47 the decay of the positively negatively buoyant jets increase 3 1 as comparing with the neutrally buoyant jets in contrast the cases with h h 0 15 kh 1 47 show that the decay decreases 4 for the positively buoyant jets and increases 1 for the negatively buoyant jets the b is smaller than chang et al 2009 results if r m d 4 6 e 03 but is inverse for r m d 4 6 e 03 it means the decay of the jet centerline velocity is faster than chang et al s experimental results for a smaller r m d and is slower for a larger r m d fig 9 b shows the jet width 2 η 1 2 for various r m d the function of the fitting line is shown in eq 12 the coefficients d 1 d 2 are 35 2 0 2 for neutrally buoyant jets 29 8 0 3 for positively buoyant jets 29 9 0 2 for negatively buoyant jets and 31 8 0 2 for buoyant jets the r squared values for each effluent are higher than 0 92 except for the positively buoyant jets and the fitting result from all data is 0 85 the empirical formula for jet width is suggested to be constructed separately for different buoyant jets since the r squared values obtained using all data decreased 12 2 η 1 2 d 1 r m d d 2 a comparison between the present and experimental results chang et al 2009 indicates that the results of jet width are significantly more consistent than those of the decay coefficient in the case of the a neutrally buoyant jet in a stagnant environment b 4 2 and x 0 0 63 d is obtained by numerical model the decay coefficient is slightly smaller than the value measured in hsiao et al 2011 s experiment b 4 5 and the virtual origin is also slightly different x 0 2 79 d on the other hand b 5 9 and x 0 4 d is observed by chang et al 2009 a clear distinction on the decay coefficient is noticed as a result the differences in the decay coefficient values could be due to the reynolds number of the turbulent jet is different malmstrom et al 1997 nevertheless such a difference does not make an apparent discrepancy on the jet width note that the variation trends of the fitting line have a minor change if x 0 obtaining from the free jets simulation is utilized 3 3 jet cross sectional profiles in potential core and near field regions in the previous sections the jet diffusion in the x z plane was discussed for describing the 3d features of a jet under wave forcing the jet shape in the y z plane is analyzed in this section following the definition in chang et al 2009 the jet vertical to horizontal width ratio d z d y was utilized to describe the jet shape under waves the d z and d y are the jet width in the vertical and horizontal direction respectively fig 10 shows the variation of the d z d y in one wave period in the potential core region for the buoyant jets at x 6d the d z d y is always less than unity and decreases with increasing h h when h h 0 12 for neutrally buoyant jets as shown in fig 10 a for h h 0 03 the minimum d z d y is about 0 9 the d z d y has a drastic change for h h 0 15 interestingly d z d y remains less than unity in the region form t t 0 43 to 0 90 and has a smallest value about 0 6 in these cases but the ratio is greater than unity under the other phases moreover the maximum value of d z d y is up to 1 3 a similar result is observed for the positively buoyant jets as shown in fig 10 b yet d z d y 1 is demonstrated for h h 0 12 on the other hand d z d y remains less than unity as h h 0 15 for the negatively buoyant jets as shown in fig 10 c the variation of the jet shape has apparently changed when h h 0 15 and h h 0 12 for the neutrally and positively buoyant jets respectively the result reveals that the kinematics of the buoyant jets in the potential core region is substantially changed fig 11 shows the jet shape and velocity field at x 6d for the neutrally buoyant jets in the y z plane and the case of a neutrally buoyant jet in a stagnant environment free jet is also shown as a reference for comparison fig 11 a shows the case for h h 0 09 kh 1 47 at t t 0 0 25 0 50 and 0 75 the strong shear velocity on the lateral sides of the jet is shown at t t 0 and 0 5 on the other hand such strong shear velocity is not observed at t t 0 25 and 0 75 besides the ratios of the upper to the lower jet half width at t t 0 0 25 0 50 and 0 75 are 1 2 1 0 0 8 and 1 0 respectively interestingly the upper lower half width is longer than the lower upper when the wave velocity in the vertical direction is positive negative therefore the primary reason for the jet shape with a wider horizontal width in the potential core region is the strong shear wave velocity around the jet in the vertical direction which is caused by the streamwise adverse pressure gradient around the jet as the case of a transverse jet in crossflow as a result the shear velocity increases the jet diffusion on the lateral sides of the jets note that d y and d z both increase under the waves but the increase of d y is more apparent for instance the d y and the d z are 1 7 and 1 4 times the jet width for the free jet at t t 0 figs 11 b and c show the phase at t t 0 125 and 0 625 the shear velocity around the jet is also found in these phases besides vortex pairs above below the jet are clear with increasing h h at t t 0 125 0 625 for h h 0 15 the wave velocity in the vertical direction is higher than the others besides the upward wave velocity leads the jet to a highly positive vertical velocity and thus greatly increases the jet diffusion in the vertical direction as shown in fig 11 b on the other hand the d z d y is smaller than the others at t t 0 625 the reason could be due to the magnitude of the vertical velocity decays in negative z direction therefore the wave velocity is not large enough to maintain the ratio different from the noticeable change in the jet shape in the potential core region the jet width in the vertical direction is always greater than the width in the horizontal direction under various phases as shown in fig 12 the d z d y at x 30d is slightly over unity for the smallest h h as expected for h h 0 15 the variation of d z d y has sharply changed under a wave period for each buoyant jet for instance the d z d y is about 1 56 at t t 0 26 yet about 2 60 at t t 0 34 for the neutrally buoyant jets as h h 0 15 as shown in fig 12 a because the jet velocities in the cross section discontinuously decrease from the maximum velocity and separate into two peaks in some phases that is discontinuous motion as mentioned in fig 6 as a result the jet width may suddenly change since u j u c 0 5 is sensitive in this situation fig 13 shows the jet shape and velocity field at x 30d for the neutrally buoyant jets in the y z plane the wave motion strongly increases d z and the upper jet half width is greater than the lower jet half width in the most phases this is because the effects of the wave on jet diffusion on the upper part of the jet are more prominent note that the jet shapes in the potential core and near field regions for the positively and negatively buoyant jets are not the same as that of the neutrally buoyant jet however the variation due to waves is similar the period and space averaged d z d y values are shown in fig 14 the value in a case is firstly averaged over one wave period then a mean value is obtained by averaging the data in the region from x d 1 to 6 for the potential core region and in the region from x d 30 to 40 for the near field region in the potential core region d z d y proportionally decreases with r m d and the buoyancy effect does not affect the jet shape except for r m d 5 46 e 03 the results are close to the experimental observation reported by chang et al 2009 when r m d 5 35 e 03 the jet shape under the higher r m d has a different feature as previously mentioned with regard to fig 10 in the near field region d z d y proportionally increases with r m d and the buoyant force leads to a larger smaller d z d y for positive negative buoyancy jets the functions of the fitting line in fig 14 are shown in eqs 13 and 14 in the potential core and near field region respectively the cases with d z d y 1 in the potential core region are excluded to construct the fitting line in the potential core region because the variation of the jet shape is different from the others the coefficients for each line e 1 e 2 f 1 f 2 are 13 0 0 9 235 0 1 1 for the neutrally buoyant jets 11 0 0 9 192 3 1 3 for the positively buoyant jets 13 1 0 9 207 8 1 0 for the negatively buoyant jets and 12 6 0 9 212 8 1 1 for the buoyant jets for neutrally buoyant jets the d z d y in the near field region calculated by eq 14 is almost the same value as the experimental results reported by chang et al 2009 at r m d 3 0 e 04 and 1 3 times at r m d 1 9 e 03 13 d z d y e 1 r m d e 2 14 d z d y f 1 r m d f 2 the r squared values are higher than 0 83 for different effluents in the potential core region and higher than 0 82 in the near field region the r squared value for all data is 0 90 in the potential core region and 0 84 in the near field region note that the fitting lines for the buoyant jets in the potential core region are similar in contrast the buoyancy effect in the near field region is visible a comparison of the positively and negatively buoyant jets to the neutrally buoyant jets shows the ratio increases 4 and decreases 10 at r m d 3 01 e 03 these results imply that the empirical formula of d z d y should be considered separately for different effluent fluids even though the momentum ratio including the density difference is considered in this study 4 conclusion in this paper the kinematics of buoyant round jets in a wave environment were numerically investigated the agreement between experimental data and numerical results for the buoyant round jets was reasonably good comprehensive validation including the horizontal velocity profiles over various distances from the exit of the jet and the variation of the jet width showed good agreements between laboratory data and numerical predictions jet oscillation under different wave to jet momentum ratios was discussed with increasing the ratio the oscillating motion changed from symmetrical motion to asymmetrical motion to discontinuous motion which is similar to the results reported by mori and chang 2003 for standing waves the oscillation is due to the vertical velocity distribution of the waves being nonuniform in space these motions were observed not only in the neutrally buoyant jets but also in the positively and negatively buoyant jets the wave to jet momentum ratio including the buoyancy effect depicts the difference in the jet oscillation between the buoyant jets with the same wave conditions various h h kh and effluent fluid densities were utilized to examine jet diffusion the period averaged jet width was insensitive to the external forcing in the potential core region in the near field region h h was an important factor for the jet width the effect of the buoyancy and kh on the jet diffusion is found to be insignificant compared to that of h h also we included the effect of the density difference between the effluent flow and the ambient fluid to the wave to jet momentum ratio r m d then empirical formulas for the period averaged decay coefficient the period averaged jet width and the period and space averaged vertical to horizontal width ratio d z d y for different r m d were proposed the results show that the formulas for the jet width and the d z d y in the near field region should be constructed separately for different buoyant jets the d z d y in the potential core region was smaller than unity under various phases as h h 0 12 for the neutrally buoyant jets the primary reason for the jet shape with a wider horizontal width in the potential core region is the strong shear wave velocity around the jet in the vertical direction which is caused by the streamwise adverse pressure gradient around the jet as the case of a transverse jet in crossflow the d y and d z both increase under the waves but the increase of d y is more apparent for h h 0 15 kh 1 47 d z d y various between 0 6 and 1 3 the reason could be due to the magnitude of the vertical velocity decays in negative z direction therefore the wave velocity is not large enough to maintain the ratio in the near field region d z is always greater than d y under various phases the wave motion strongly increases d z and the upper jet half width is greater than the lower jet half width in the most phases this is because the effects of the wave on jet diffusion on the upper part of the jet are more prominent acknowledgments this research was financially supported by the ministry of science and technology taiwan under grants most 106 2221 e 006 111 and most 107 3113 e 006 011 the authors are also grateful to the anonymous reviewers for their valuable comments and suggestions that greatly refine the quality of this paper 
23304,this paper presents a numerical study on the kinematics of buoyant round jets in a wave environment a buoyant round jet was horizontally discharged at the mid depth in regular waves using three dimensional reynolds averaged navier stokes rans equations with the standard κ ε turbulence model three kinds of effluent with various densities were used for the jets the numerical results were compared with the experimental data with reasonable agreement observed the mechanism of the jet oscillation under different wave to jet momentum ratios was presented the effects of relative water depth the ratio of the wave height to the water depth and buoyancy on jet diffusion were considered among them the ratio of the wave height to the water depth appears to be the most important factor on jet diffusion processes under the conditions being considered finally the variations of the jet cross sectional profiles in the potential core region and the near field region were studied keywords water waves buoyant jet numerical study navier stokes equations model 1 introduction discharging jets into coastal areas is a common practice in many industrial applications for instance residential sewage hot water from power plants and brine from seawater desalination plants are discharged through marine outfalls located along a coastline the characteristics of the effluent e g density temperature and environmental forces e g currents tides and waves should be considered to understand the process of effluent dispersion for a neutrally round jet under a wave environment the diffusion characteristics have been quantified and qualified via laboratory measurements chyan and hwung 1993 mori and chang 2003 mossa 2004 ryu et al 2005 tam and li 2008 chang et al 2009 hsiao et al 2011 wang et al 2015 mori and chang 2003 observed various jet oscillation patterns under standing waves and classified them as symmetric asymmetric or discontinuous motions depending on the wave to jet momentum ratio ryu et al 2005 found that the effect of wave dispersion on jet diffusion under regular progressive waves is dominated by wave height not by wave phase the jet centerline velocity decays rapidly and the jet width increases with increasing wave height chang et al 2009 showed that the characteristics of the jet diffusion correlate closely with the wave to jet momentum ratio interestingly they found that the jet vertical width is smaller than the jet horizontal width in the potential core region but the opposite is true in the near field region hsiao et al 2011 quantified the mean and turbulence properties of a jet under regular progressive waves their results indicate that the mean jet width turbulence intensity and reynolds stress increased significantly when the jet was acted on by the waves however the mechanisms of jet oscillation and the variation of the jet width remain unclear a few studies have focused on the problem of a buoyant round jet in a current environment jirka 2004 2008 lam et al 2006 or a wavy environment chen et al 2009 lin et al 2013 jirka 2004 presented an integral model to predict the characteristics of turbulent buoyant jets in various flow fields jirka 2008 used the integral model to consider the effect of the discharge angle on a submerged negatively buoyant jet in a flat or sloping seabed lam et al 2006 measured the trajectory spreading and dilution of a jet in a counterflow via laser induced fluorescence chen et al 2009 utilized acoustic doppler velocimetry to measure the vertical velocity for a vertical buoyant round jet in random waves they found that the dilution rate increases with increasing wave effect lin et al 2013 measured the velocity field using particle image velocimetry for three kinds of buoyant jet in regular waves they reported that the buoyancy effect had a considerably smaller influence than the wave dispersion effect on the enhancement of jet diffusion due to limitations of measurement techniques and the use of an integral model a complete three dimensional 3d flow field for a buoyant jet in a wave environment is hard to obtain numerical modeling has been used as an alternative to investigate the problem with high quality results obtained for a jet discharging vertically in a wave environment chen et al 2008 simulated a neutrally buoyant vertical round jet under random waves using a 3d les model later chen et al 2012 extended the model to consider the buoyancy effect they found that the buoyant force weakens wave effect on the jet entrainment and mixing leading to a slower decay rate of the maximum velocity and a narrower jet width recently xu et al 2014 investigated the variation of the jet half width in random waves and regular waves using the les model and found that a jet has a smaller width in regular waves a jet discharged in the direction opposite that of wave propagation has been investigated chen et al 2015 2017 chen et al 2015 used a 3d rans equations model to discuss the wave effects for a neutrally buoyant horizontal round jet under regular waves they found that the jet vertical to horizontal width ratio is insensitive to the wave period with increasing wave height it decreased in the potential core region and increased in the near field region chen et al 2017 simulated a buoyant horizontal round jet in a stagnant environment they reported that the buoyant force influences the jet vertical to horizontal width ratio in the near field but not in the potential core region however the cause of vertical to horizontal width ratio for the buoyant jet in a wave environment remains unclear the objective of the present study is to investigate the kinematic characteristics of a buoyant round jet in a wave environment as mentioned previously the mechanisms of jet oscillating motion the characteristics of diffusion and the variation of the jet shape are not fully known especially in the lateral direction in this study the 3d features of buoyant jets are obtained using a 3d numerical model named flow 3d the model has been used to successfully simulate a neutrally buoyant jet in a wave environment chen et al 2015 and buoyant jets in a stagnant ambient environment chen et al 2017 the numerical model solves the rans equations combined with the standard κ ε turbulence model and the water surface deformation is captured using the volume of fluid method the setup of the numerical tank is based on a previous physical experiment hsiao et al 2011 lin et al 2013 the properties of jet diffusion and the cross sectional profile under the effect of buoyancy and waves are discussed due to a lack of a 3d velocity field in the experiment 2 numerical model 2 1 governing equations a three dimensional computational fluid dynamics code flow 3d solves navier stokes type equations embedded with various turbulence closure models in this study rans equations are solved with the standard κ ε turbulence model and the volume of fluid method is applied to track the water surface elevation hirt and nichols 1981 the interface between the fluid and solid boundaries is treated with the fractional area volume obstacle representation favor method which computes the open area and volume in each cell to define the area that is occupied by an obstacle the continuity equation the momentum equation with boussinesq approximation and the turbulent advection diffusion equation for density in tensor form are respectively 1 u i x i 0 2 u i t u j u i x j 1 ρ a p x i 1 ρ a x j μ u i x j u j x i ρ a u i u j g i δ ρ ρ a 3 ρ t ρ u i x i x i d m ρ x i u i ρ where x i represents coordinate directions i 1 2 3 for x y z directions respectively u i and p are the ensemble mean velocity component and mean fluid pressure respectively t is the time δ ρ is the density difference δ ρ ρ ρ a where ρ a is the density of the ambient fluid and ρ is the mean density of the fluid in a cell μ and d m are the fluid dynamic viscosity and molecular diffusivity of the fluid respectively g i is the gravity force field the reynolds stress term ρ u i u j is modeled by the standard κ ε turbulence model u i ρ u i ρ ν t s c t ρ x i is the turbulent fluxes of the mean density ρ ν t is the eddy viscosity and s c t is the turbulent schmidt number for more detailed information on the numerical model readers can refer to its manual flow science 2012 2 2 numerical setup the setup of the numerical tank which is based on a previous physical experiment hsiao et al 2011 lin et al 2013 is shown in fig 1 regular waves are generated at a constant water depth of h 33 cm from an inflow boundary by a given velocity and water surface elevation according to the stokes fifth order solution the flume is 210 0 cm 2l long l is the wavelength 50 0 cm wide and up to 40 0 cm deep the jet is discharged horizontally at mid depth h 2 from a tube with an inner diameter of d 0 62 cm a grid independent analysis was performed by using three different grid arrangements the grid sizes for the pipe s shape in the vertical and spanwise directions are d 5 named mesh 1 d 7 named mesh 2 and d 9 named mesh 3 besides the cells number in the region 10 y d z d 10 25 x d 65 is increased when a finer grid is utilized the total cells numbers are 7 3 million 9 5 million and 11 1 million respectively the grid independence is achieved for mesh 2 and for denser mesh besides the computational time was about eight days using 12 processors 3 2 ghz for mesh 3 and four days for mesh 2 which is used in this study the numerical sponge layer proposed by chen and hsiao 2016 is applied to prevent secondary wave reflections the absorption function is 4 f x 1 x x 1 3 x s 2 where x 1 represents the location at the beginning of the numerical sponge layer and x s represents the length of the numerical sponge layer the round jet is composed of a horizontal pipe and a source the former was simulated using the favor method and the latter was modeled using the mass flux method the mass flux method specifies an artificial particle velocity inside the computational domain the flow velocity u i and the particle velocity u p i from time step n to n 1 computed using an implicit particle fluid coupling method were used for modeling a source the approximate momentum equations are shown as eqs 5 and 6 they can be combined as eq 7 5 m f u i n 1 m f u i m p δ t k u p i n 1 u i n 1 6 m p u p i n 1 m p u p i m p δ t k u p i n 1 u i n 1 7 u i n 1 m f u i m p ω u p i m f m p ω where m f and m p are the fluid mass and the particle mass in a control volume k is a drag coefficient and ω δ t k 1 0 δ t k the tilde over the velocities indicates an estimate for the n 1 level velocity that contains all forces except for particle drag these velocities are computed explicitly by known in the time step n the coupling effect between fluid and particle is not considered ω 0 as a result u i n 1 equals u i therefore the mass flux method is used to specify a source inside the nozzle for modeling jets 2 3 model validation the experimental data reported by hsiao et al 2011 and lin et al 2013 are utilized to evaluate the capability of a numerical model simulating horizontal buoyant round jets in a wave environment the wave period t is 1 0 s and the incident wave height h is 3 0 cm at a depth of 33 0 cm the jet exit velocity u e is 1 28 m s three effluents of various densities are used for the jet the densities ρ e are as follows 0 98 g cm3 for positive buoyancy alcohol water d m 1 00 10 5 cm2 s 1 00 g cm3 for neutral buoyancy water and 1 02 g cm3 for negative buoyancy saltwater d m 1 61 10 5 cm2 s note that boussinesq approximation and the turbulent advection diffusion equation are unnecessary for neutrally buoyant jets because the effluent flow and the ambient fluid are the same fluid the values of s c t are determined by comparing the simulated results for the cases of a positively negatively buoyant jet discharging into a stagnant environment with the experimental data lin et al 2013 the result shows s c t 1 3 2 5 for the positively buoyant jets and s c t 2 5 5 0 for the negatively buoyant jets are in good agreement with the experimental data in this study the values s c t 1 6 and s c t 2 8 are adopted for positively and negatively buoyant jets respectively buoyant jets in a wave environment are validated by jet velocity and jet width the computed fluid velocity u i is decomposed into the jet velocity u j i and the wave velocity u w i which is determined from the condition without the jet the jet half width η 1 2 is usually used to describe the radial length scale of a round jet and the spread rate of the jet the half width is specified as the location z a x where the horizontal velocity of the jet u j is equal to half of the maximum horizontal velocity of the jet u c in a cross section i e u j u c 0 5 z a represents an axis parallel to the z axis and z a 0 indicates the centerline position of the jet where the horizontal velocity of the jet in a cross section is maximum since η 1 2 in a wave environment is asymmetrical the jet width 2 η 1 2 is the summation of the upper jet half width and the lower jet half width to quantify the jet diffusion in waves ryu et al 2005 hsiao et al 2011 lin et al 2013 figs 2 4 show the sectional horizontal velocity profiles in the potential core region and the near field region the velocity profiles are at a phase when the wave crest arrives at the jet exit for the neutrally buoyant jet the computed maximum horizontal velocities are slightly larger than the measurements in the near field region as shown in fig 2 the maximum velocity at x d 3 and 45 simulated by the model are 1 2 and 1 5 times greater than that in the experiment respectively this could be due to the fact that the standard κ ε turbulence model uses a constant turbulence length scale to limit the minimum turbulent dissipation for preventing unphysically small dissipation rates in general the parameter equals 7 of the hydraulic diameter d h however for this multi scale problem in this study the 0 07 d h is 0 043 cm for a tube with a 0 62 cm diameter but 3 983 cm for a wave flume with a 33 cm water depth and a 50 cm width these turbulence length scales were examined by the cases of a neutrally buoyant jet discharging into a stagnant environment and compared with the experimental data to determine a suitable value even though the jet velocity in the potential core and transition regions using the parameter equal to 0 043 cm show good agreement with the measured data the jet centerline velocity nearly does not decay in the near field region on the other hand the parameter equal to 3 983 cm shows a fairly good agreement with the experiment on the jet velocity and the decay rate of the maximum velocity in the near field figs 3 and 4 show the results of a positively and negatively buoyant jets respectively due to the density difference between the effluent flow and ambient fluid the jet moves to the water surface for the positively buoyant jet but moves to the seabed for the negatively buoyant jet the jet velocity for the buoyant jets is matched well between the experimental data and numerical results however there are some discrepancies between the numerical results and laboratory data this may be caused by the numerical parameters e g turbulence length scale turbulent schmidt number and the assumption in the eddy viscosity model and that may be improved by models with higher accuracy e g reynolds stress model large eddy simulation model fig 5 shows the variation of jet width 2 η 1 2 with the jet discharge direction when the buoyant jet is in stagnant and wave environments the modeled jet widths are in reasonably good agreement with the experimental values the total variation of jet width is shown by the model in the region from x d 0 to 10 there is no significant difference between cases after that the wave effect is noticeable but the buoyancy force has a relatively small effect interestingly a significant difference is shown when x d 27 for buoyant jets in a wave environment the jet widths for the cases under waves increase but the increasing ratio of the jet width depends on buoyant jet type the highest is for the positively buoyant jets and the lowest is for the negatively buoyant jets this trend is consistent with the influence degree of regular waves since regular waves at intermediate water depths are considered in this study the wave effect decays from the water surface to the seabed as a result the jet diffusion caused by wave motion for positively buoyant jets is larger than that for neutrally and negatively buoyant jets although some discrepancies between the numerical results and experimental data are observed the top hat profile in the potential core region the jet displacement due to wave and buoyancy and the variation of the jet width show reasonably good agreement with the experimental results 3 results and discussion 3 1 effect of wave to jet momentum ratio on jet oscillation mori and chang 2003 observed various jet oscillation patterns under standing waves to understand the effect and mechanism of the wave to jet momentum ratio r m on jet oscillating motion five wave heights h 1 2 3 4 5 cm with a constant wave period t 1 s were utilized for buoyant jets mori and chang 2003 shows r m can be expressed as eq 8 8 r m g k a 2 2 u e 2 where k is the wave number and a is the wave amplitude fig 6 shows a neutrally buoyant jet under various wave phases for r m 1 34e 03 3 01e 03 and 5 35e 03 the jet centerline and the jet half width are shown with the wave velocity field which was obtained for the cases without jets in the region from x d 0 to 20 the jet centerline is always continuous the position and orientation of the jet change due to wave motion when the wave phase changes from t t 0 to 0 5 the direction of wave velocity changes from left down to right down in this region therefore the jet shifts from a higher location to a lower location and the direction changes from the right up to right down then the direction of wave velocity changes from right up to left up during t t 0 5 to 1 0 i e t t 0 as a result the jet gradually returns to its original position at t t 0 even larger r m cause a stronger oscillation the jet centerline is still continuous and periodic in this region in contrast there is a significant difference between these cases in the region from x d 20 to 40 the jet oscillation appears asymmetrical for r m 3 01 e 03 and even discontinuous for r m 5 35 e 03 due to the variation of the wave velocity the fluid particle of waves has a right down velocity in this area at t t 0 3 but the vertical velocity distribution is nonuniform in space decreasing in the region from x d 20 to 40 therefore the part closer to the jet exit moves to the seabed but the part farther away mostly moves the downstream at t t 0 4 at this stage the jet is nearly separated at t t 0 4 a discontinuous point is observed at t t 0 5 since the part farther away moves in the direction right up and has a higher vertical velocity due to waves for positively and negatively buoyant jets similar phenomena were observed fig 7 shows the phase at t t 0 8 in the case of positively buoyant jets discontinuous motions are shown for r m 3 01 e 03 since the effect of waves on the jets is larger than the neutrally buoyant jets under the same r m as shown in fig 7 b for the buoyancy effect being considered in this study eq 8 is modified as shown in eq 9 the wave to jet momentum ratio including the buoyancy effect r m d depicts the discontinuous motion for the positively buoyant jets note that the wave enhances jet diffusion in the vertical direction especially for the buoyant jets in discontinuous motion will be discussed later therefore a depth resolving model is necessary to design the marine outfalls in practice 9 r m d g k a 2 ρ a 2 u e 2 ρ e 3 2 characteristics of jets in potential core and near field regions five various wave heights h 1 2 3 4 5 cm with a constant wave period t 1 s and another four incident wave periods t 0 8 0 9 1 1 1 2 s with a constant wave height h 3 cm were examined as listed in table 1 allowing the effects of buoyant force δ ρ ρ a 2 the ratio of the wave height to the water depth h h 0 03 0 15 and relative water depth kh 1 13 2 13 on jet diffusion to be taken into account note that r m d ranges from 3 28e 04 to 8 53e 03 the period averaged jet widths along the jet discharge direction are shown in fig 8 there is no apparent difference between different wave conditions when x d 20 except for r m d 8 36 e 03 the jet width for r m d 8 53 e 03 is larger than the others and with 17 wider than the case for r m d 0 at x d 6 the jet width then increases with increasing r m d when x d 20 interestingly the jet width is not monotonically increasing when 20 x d 40 for r m d 8 20 e 03 the rate of the jet width in space is decreased when 20 x d 30 and is increased until the maximum jet width occurs comparing with the jet in a stagnant environment the maximum jet width increased by 159 r m d 8 36 e 03 for the neutrally 124 r m d 8 53 e 03 for the positively and 118 r m d 8 20 e 03 for the negatively buoyant jets respectively when the jets under the waves it shows the buoyancy effect is significant with the increase of r m d the decreasing jet width is observed in the region from x d 40 to 60 since the jet width is a dimensionless parameter i e the dimensional jet width divided by the distance between the jet exit and the cross section it decreases even if the dimensional jet width remains the same on the other hand the boundary limits jet spreading in the vertical direction because the positively negatively buoyant jet moves gradually toward to the water surface seabed as a result the jet width decreases although the neutrally buoyant jets do not touch any boundary the reduction of jet width is still observed in the cases with a higher kh or h h as shown in fig 8 a for instance the jet widths for kh 1 13 and 2 13 at x d 50 are 0 37 and 0 30 respectively it shows that the jet diffusion due to the wave dispersion reaches a limitation note that the location where jets touch boundary is defined as u j u c 1 at boundary following chang et al 2009 the relation between r m d and the decay of centerline velocity as well as the relation between this ratio and the jet width in the near field region are discussed the decay of centerline velocity in the near field for a turbulent jet can be expressed as eq 10 pope 2000 10 u c u e b x x 0 d n where b and n are the decay coefficients and x 0 is the virtual origin of the jet the b for each case are obtained through curve fitting with n 1 0 and x 0 4d chang et al 2009 ryu et al 2005 the data from x d 30 to 40 is used to avoid the boundary effect from the bottom and water surface the coefficients of determination r squared r2 are above 0 91 for r m d 8 36 e 03 and above 0 85 for the others fig 9 shows the variation of the decay coefficient b and the jet width 2 η 1 2 under various wave to jet momentum ratios r m d and the experimental data measured by chang et al 2009 for a neutrally buoyant jet under regular waves are also shown as a reference the functions of the fitting line in fig 9 a is shown in eq 11 the coefficients c 1 c 2 are 76 2 3 6 for neutrally buoyant jets 48 1 3 5 for positively buoyant jets 83 4 3 7 for negatively buoyant jets and 69 0 3 6 for buoyant jets 11 b c 1 r m d c 2 fig 9 a shows the buoyant jets with a lighter density decay faster than the others for r m d 5 20 e 03 for h h 0 09 kh 1 47 the decay of the positively negatively buoyant jets increase 3 1 as comparing with the neutrally buoyant jets in contrast the cases with h h 0 15 kh 1 47 show that the decay decreases 4 for the positively buoyant jets and increases 1 for the negatively buoyant jets the b is smaller than chang et al 2009 results if r m d 4 6 e 03 but is inverse for r m d 4 6 e 03 it means the decay of the jet centerline velocity is faster than chang et al s experimental results for a smaller r m d and is slower for a larger r m d fig 9 b shows the jet width 2 η 1 2 for various r m d the function of the fitting line is shown in eq 12 the coefficients d 1 d 2 are 35 2 0 2 for neutrally buoyant jets 29 8 0 3 for positively buoyant jets 29 9 0 2 for negatively buoyant jets and 31 8 0 2 for buoyant jets the r squared values for each effluent are higher than 0 92 except for the positively buoyant jets and the fitting result from all data is 0 85 the empirical formula for jet width is suggested to be constructed separately for different buoyant jets since the r squared values obtained using all data decreased 12 2 η 1 2 d 1 r m d d 2 a comparison between the present and experimental results chang et al 2009 indicates that the results of jet width are significantly more consistent than those of the decay coefficient in the case of the a neutrally buoyant jet in a stagnant environment b 4 2 and x 0 0 63 d is obtained by numerical model the decay coefficient is slightly smaller than the value measured in hsiao et al 2011 s experiment b 4 5 and the virtual origin is also slightly different x 0 2 79 d on the other hand b 5 9 and x 0 4 d is observed by chang et al 2009 a clear distinction on the decay coefficient is noticed as a result the differences in the decay coefficient values could be due to the reynolds number of the turbulent jet is different malmstrom et al 1997 nevertheless such a difference does not make an apparent discrepancy on the jet width note that the variation trends of the fitting line have a minor change if x 0 obtaining from the free jets simulation is utilized 3 3 jet cross sectional profiles in potential core and near field regions in the previous sections the jet diffusion in the x z plane was discussed for describing the 3d features of a jet under wave forcing the jet shape in the y z plane is analyzed in this section following the definition in chang et al 2009 the jet vertical to horizontal width ratio d z d y was utilized to describe the jet shape under waves the d z and d y are the jet width in the vertical and horizontal direction respectively fig 10 shows the variation of the d z d y in one wave period in the potential core region for the buoyant jets at x 6d the d z d y is always less than unity and decreases with increasing h h when h h 0 12 for neutrally buoyant jets as shown in fig 10 a for h h 0 03 the minimum d z d y is about 0 9 the d z d y has a drastic change for h h 0 15 interestingly d z d y remains less than unity in the region form t t 0 43 to 0 90 and has a smallest value about 0 6 in these cases but the ratio is greater than unity under the other phases moreover the maximum value of d z d y is up to 1 3 a similar result is observed for the positively buoyant jets as shown in fig 10 b yet d z d y 1 is demonstrated for h h 0 12 on the other hand d z d y remains less than unity as h h 0 15 for the negatively buoyant jets as shown in fig 10 c the variation of the jet shape has apparently changed when h h 0 15 and h h 0 12 for the neutrally and positively buoyant jets respectively the result reveals that the kinematics of the buoyant jets in the potential core region is substantially changed fig 11 shows the jet shape and velocity field at x 6d for the neutrally buoyant jets in the y z plane and the case of a neutrally buoyant jet in a stagnant environment free jet is also shown as a reference for comparison fig 11 a shows the case for h h 0 09 kh 1 47 at t t 0 0 25 0 50 and 0 75 the strong shear velocity on the lateral sides of the jet is shown at t t 0 and 0 5 on the other hand such strong shear velocity is not observed at t t 0 25 and 0 75 besides the ratios of the upper to the lower jet half width at t t 0 0 25 0 50 and 0 75 are 1 2 1 0 0 8 and 1 0 respectively interestingly the upper lower half width is longer than the lower upper when the wave velocity in the vertical direction is positive negative therefore the primary reason for the jet shape with a wider horizontal width in the potential core region is the strong shear wave velocity around the jet in the vertical direction which is caused by the streamwise adverse pressure gradient around the jet as the case of a transverse jet in crossflow as a result the shear velocity increases the jet diffusion on the lateral sides of the jets note that d y and d z both increase under the waves but the increase of d y is more apparent for instance the d y and the d z are 1 7 and 1 4 times the jet width for the free jet at t t 0 figs 11 b and c show the phase at t t 0 125 and 0 625 the shear velocity around the jet is also found in these phases besides vortex pairs above below the jet are clear with increasing h h at t t 0 125 0 625 for h h 0 15 the wave velocity in the vertical direction is higher than the others besides the upward wave velocity leads the jet to a highly positive vertical velocity and thus greatly increases the jet diffusion in the vertical direction as shown in fig 11 b on the other hand the d z d y is smaller than the others at t t 0 625 the reason could be due to the magnitude of the vertical velocity decays in negative z direction therefore the wave velocity is not large enough to maintain the ratio different from the noticeable change in the jet shape in the potential core region the jet width in the vertical direction is always greater than the width in the horizontal direction under various phases as shown in fig 12 the d z d y at x 30d is slightly over unity for the smallest h h as expected for h h 0 15 the variation of d z d y has sharply changed under a wave period for each buoyant jet for instance the d z d y is about 1 56 at t t 0 26 yet about 2 60 at t t 0 34 for the neutrally buoyant jets as h h 0 15 as shown in fig 12 a because the jet velocities in the cross section discontinuously decrease from the maximum velocity and separate into two peaks in some phases that is discontinuous motion as mentioned in fig 6 as a result the jet width may suddenly change since u j u c 0 5 is sensitive in this situation fig 13 shows the jet shape and velocity field at x 30d for the neutrally buoyant jets in the y z plane the wave motion strongly increases d z and the upper jet half width is greater than the lower jet half width in the most phases this is because the effects of the wave on jet diffusion on the upper part of the jet are more prominent note that the jet shapes in the potential core and near field regions for the positively and negatively buoyant jets are not the same as that of the neutrally buoyant jet however the variation due to waves is similar the period and space averaged d z d y values are shown in fig 14 the value in a case is firstly averaged over one wave period then a mean value is obtained by averaging the data in the region from x d 1 to 6 for the potential core region and in the region from x d 30 to 40 for the near field region in the potential core region d z d y proportionally decreases with r m d and the buoyancy effect does not affect the jet shape except for r m d 5 46 e 03 the results are close to the experimental observation reported by chang et al 2009 when r m d 5 35 e 03 the jet shape under the higher r m d has a different feature as previously mentioned with regard to fig 10 in the near field region d z d y proportionally increases with r m d and the buoyant force leads to a larger smaller d z d y for positive negative buoyancy jets the functions of the fitting line in fig 14 are shown in eqs 13 and 14 in the potential core and near field region respectively the cases with d z d y 1 in the potential core region are excluded to construct the fitting line in the potential core region because the variation of the jet shape is different from the others the coefficients for each line e 1 e 2 f 1 f 2 are 13 0 0 9 235 0 1 1 for the neutrally buoyant jets 11 0 0 9 192 3 1 3 for the positively buoyant jets 13 1 0 9 207 8 1 0 for the negatively buoyant jets and 12 6 0 9 212 8 1 1 for the buoyant jets for neutrally buoyant jets the d z d y in the near field region calculated by eq 14 is almost the same value as the experimental results reported by chang et al 2009 at r m d 3 0 e 04 and 1 3 times at r m d 1 9 e 03 13 d z d y e 1 r m d e 2 14 d z d y f 1 r m d f 2 the r squared values are higher than 0 83 for different effluents in the potential core region and higher than 0 82 in the near field region the r squared value for all data is 0 90 in the potential core region and 0 84 in the near field region note that the fitting lines for the buoyant jets in the potential core region are similar in contrast the buoyancy effect in the near field region is visible a comparison of the positively and negatively buoyant jets to the neutrally buoyant jets shows the ratio increases 4 and decreases 10 at r m d 3 01 e 03 these results imply that the empirical formula of d z d y should be considered separately for different effluent fluids even though the momentum ratio including the density difference is considered in this study 4 conclusion in this paper the kinematics of buoyant round jets in a wave environment were numerically investigated the agreement between experimental data and numerical results for the buoyant round jets was reasonably good comprehensive validation including the horizontal velocity profiles over various distances from the exit of the jet and the variation of the jet width showed good agreements between laboratory data and numerical predictions jet oscillation under different wave to jet momentum ratios was discussed with increasing the ratio the oscillating motion changed from symmetrical motion to asymmetrical motion to discontinuous motion which is similar to the results reported by mori and chang 2003 for standing waves the oscillation is due to the vertical velocity distribution of the waves being nonuniform in space these motions were observed not only in the neutrally buoyant jets but also in the positively and negatively buoyant jets the wave to jet momentum ratio including the buoyancy effect depicts the difference in the jet oscillation between the buoyant jets with the same wave conditions various h h kh and effluent fluid densities were utilized to examine jet diffusion the period averaged jet width was insensitive to the external forcing in the potential core region in the near field region h h was an important factor for the jet width the effect of the buoyancy and kh on the jet diffusion is found to be insignificant compared to that of h h also we included the effect of the density difference between the effluent flow and the ambient fluid to the wave to jet momentum ratio r m d then empirical formulas for the period averaged decay coefficient the period averaged jet width and the period and space averaged vertical to horizontal width ratio d z d y for different r m d were proposed the results show that the formulas for the jet width and the d z d y in the near field region should be constructed separately for different buoyant jets the d z d y in the potential core region was smaller than unity under various phases as h h 0 12 for the neutrally buoyant jets the primary reason for the jet shape with a wider horizontal width in the potential core region is the strong shear wave velocity around the jet in the vertical direction which is caused by the streamwise adverse pressure gradient around the jet as the case of a transverse jet in crossflow the d y and d z both increase under the waves but the increase of d y is more apparent for h h 0 15 kh 1 47 d z d y various between 0 6 and 1 3 the reason could be due to the magnitude of the vertical velocity decays in negative z direction therefore the wave velocity is not large enough to maintain the ratio in the near field region d z is always greater than d y under various phases the wave motion strongly increases d z and the upper jet half width is greater than the lower jet half width in the most phases this is because the effects of the wave on jet diffusion on the upper part of the jet are more prominent acknowledgments this research was financially supported by the ministry of science and technology taiwan under grants most 106 2221 e 006 111 and most 107 3113 e 006 011 the authors are also grateful to the anonymous reviewers for their valuable comments and suggestions that greatly refine the quality of this paper 
