index,text
21060,the aim of this work is twofold we analyze a dynamical model for the transversal motion of a vertical riser which is a long tube used in the petroleum industry for subsea well drilling operations and in other cases to bring the oil from the bottom to the sea surface after the analysis we propose a new numerical approach to solve the resulting system of coupled differential equations the proposed model in which transversal displacements are coupled with longitudinal ones is analyzed from a mathematical point of view where we proved the existence and uniqueness for the resulting system of differential equations a numerical model based on finite element method is discussed and successfully implemented in a matlab code the numerical results are compared to those obtained by a commercial computation code orcaflex orcina 2014 and also the experiments in both situations the obtained results are very satisfactory and encouraging ams mos subject classification 74k10 74h20 74h25 74h45 65n30 keywords euler bernoulli beam partial differential equations risers longitudinal forces finite element method 1 introduction the advance in the exploration of offshore petroleum fields placed in ultra deep water and the new challenges in pre salt region require innovative and safe solutions for offshore oil production systems the flow of the petroleum from a wellhead at the seabed to a floating production vessel at the sea surface is made by slender tubes named risers slender long tubes drilling risers are also applied for subsea wellbore drilling different configurations for riser systems have emerged as suitable technological and economical solutions for offshore petroleum exploration in ultra deep waters the study and development of methodologies for riser projects considering the uncertainties involved in the manufacturing process and the effects of meta ocean conditions such as waves current and platform motions is fundamental to increase the safety of the system the safety of a riser can be defined through its structural capacity to stand loads during its operation xia and daas 2008 the riser is under the influence of complex loading due to wave current platform motions its own weight and other operational loads such as the fluid flowing internally which can reduce the operational service life of the riser environmental loads on a riser as well as the forced dynamic behavior have a random nature riser failure can result in several undesirable consequences for the environment to the safety of personnel and to the sea surface production facility itself det norske veritas 2002 therefore the study of parameters that can cause failure in a riser is extremely important det norske veritas 2001 many studies have been conducted regarding risers in the past chakrabarti and frampton 1982 the studies in beginning usually accounted small deflection and deformation in two vertical planes kirk et al 1979 patel et al 1984 young et al 1978 further studies presented more complete model spanos et al 1990 and formulations in three dimensions with large deflections and deformations bernitsas 1982 bernitsas et al 1985 nowadays many applications based on those models are observed in the literature morooka et al 2004 morooka et al 2004 teixeira and morooka 2017 including effects from vortex induced vibration viv and internal flow in the riser athisakul et al 2011 bordalo and morooka 2018 i k chatjigeorgiou 2004 investigated a parametric excitation of a very slender marine structure a completely vertical structure with hinged connections at both ends in the static position is considered and uses a 3d dynamic equilibrium formulations that accounts the unstretched lagragian coordinates and found solution by a finite differences approximation scheme mazzilli et al 2008 presented a rigorous derivation of non linear equations governing the dynamics of an axially loaded beam where a structure is subjected to a uniformly distributed axial and a thrust force it was shown that the procedure effectively analyze the transversal vibration responses observing the modal responses and mode interactions where the developed analytical models have been verified with results from fem simulation li et al 2018 analyzed a non linear model for risers with large deformations in three dimensional space in chakrabarti and frampton 1982 and patel and seyed 1995 several mathematical models for the dynamic behavior of risers are reviewed some simpler models assume that the structure is essentially a long string while others assume that the riser offers some mechanical resistance to momentum thus possessing bending rigidity in this paper we analyzed a dynamical model for the transverse motion of a riser taking into account longitudinal forces that have origin not only in the self weight as in existing commercial software but also in the dynamic longitudinal forces this is the first step towards a more comprehensive model which would also include the effects of fluid viscosity fluid structure interactions hydrodynamic effects and current induced vibrations after rigorously proving the existence and uniqueness for the resulting system of differential equations concerning the motion of risers under transversal and longitudinal forces a new way of approaching numerically the equations of motion was proposed it is the most important contribution of this paper having established a rigorous analysis of the equations one can hope to solve inverse problems of identifying forces or defects in the structure in fact several articles have been dedicated to some inverse problems related to beams hasanov and baysal 2016 hasanov and kawano 2016 hasanov 2009 an outline of the paper is as follows in the next section we present the model and give a set of governing equations in the third section we prove the existence and uniqueness of the solution to the resulting coupled system of partial differential equations in the forth section we propose a numerical approximation based on the finite element method and give some comparison between our results and those obtained by an industrial code and also to those obtained by the experiments 2 governing equations a slender elongated vertical line structure is considered to represent the riser through the beam model for the sake of simplicity there is no internal fluid inside the riser pipe and for the modeling the pipe is taken solid made by a hypothetical homogeneous material the upper terminal connection of the structure with the sea surface vessel is taken pinned and the bottom terminal is free to move the transverse vertical plane view of the system with respect to the sea current direction is shown in fig 1 the longitudinal external loads is represented by p and the horizontal ones due to loads with oscillatory loads for instance waves or vortex induced vibrations is represented by q we consider a cable that is hanging down from the sea level we take as a reference a system that is fixed relative to a point on the earth at the sea level where the upper extremity of the cable is located at newtonian time t 0 the x axis is then fixed to be in the direction towards the center of the earth clearly even in the context of classical mechanics it is an approximation for the chosen system is not inertial due to the earth movements and therefore it is not inertial however being aware of limitations of it it is a useful approximation that greatly simplifies the analysis consider a portion of a long beam between x and x ξ where x represents the depth of a point and ξ is a small increment on x this portion of the beam is subjected to external forces per unit length p and q which generate longitudinal and transverse displacements v and u respectively in general q is due to the interaction between hydrodynamic forces and the movement of the cable on the other hand p is mainly due to the self weight of the riser per unit of depth which is dependent of the general shape of the line that the riser describes from the ship to the depths of the sea in fig 1 note particularly that the vector force f t r v which is the sum of the traction and the shearing force is not necessarily tangent to the geometrical line that represents the beam this is due to the presence of the bending stiffness for the mechanical model we opted to start from an integral formulation so that we can see more easily the simplifications by linearization that are going to be made by d alembert principle we have immediately that at each instant of time t it is true that the displacements u t x and v t x obey the following equations for the momentum m the shearing force v and traction force f t r which are also functions of time and space moreover p and q may be dependent on time t coordinate x transversal displacement u the tangent of the line at x u x the velocity u and the acceleration u in this work we shall designate time derivatives with a dot and space derivatives with a prime in our model the vertical force per unit length p is mainly due to the self weight of the cable and consequently on the length of the hanging part since the length of the cable is given by l x 0 x u x ξ 2 1 d ξ p is dependent on u x l x is the length of the cable from the origin at the upper extremity to the point of the cable at has coordinate x as shown in fig 1 since the cable may deviate from a perfect straight line pointing to the center of the earth in general l x x and l x 0 only when the cable is a straight line the horizontal force per unit length q is dependent on the velocity u and acceleration u of the riser in the transversal direction we observe that are dealing with a simplified model in which the cable is unstretched for an excellent discussion about it see mazzilli et al 2008 the sea current acts laterally on the riser and as a consequence external current loads deflect it horizontally due to the drag forces in the transverse direction to the sea current the riser will suffer oscillating fluid forces due to other kind of loads such as internal multi phase oil and gas mixture flow moreover there is the presence of vortex induced vibration due to the sea current in the present approach for the sake of simplicity and with the purpose to show effective representation of the analytical solution for the problem only the average value as a function of time and space is assumed for the lateral fluid forces to simplify notation in the next equation we consider only the spatial dependence the only exception in this notation is to make explicit the dependence of p on u x 1 v x ξ v x x x ξ q ζ d ζ x x ξ ρ 2 u t 2 d ζ 2 f t r x ξ f t r x x x ξ p ζ u x d ζ x x ξ ρ 2 v t 2 d ζ 3 m x ξ m x v x ξ ξ f t r x ξ u x ξ u x x x ξ ρ 2 u t 2 ζ ζ x d ζ x x ξ ρ 2 v t 2 ζ u ζ u x d ζ x x ξ q ζ ζ x d ζ x x ξ p ζ u x u ζ u x d ζ evaluating the first derivative with respect to ξ of all above equations at ξ 0 we obtain 4 v x t x q t x u u ρ 2 u t 2 t x 5 f t r x t x p t x u x ρ 2 v t 2 t x 6 m x t x v t x f t r t x u x t x 0 observe that by 6 contrary to the classical beam equation the third derivative of the transverse displacement does not give the shearing force v it gives the shearing force added to an extra term that is dependent on the longitudinal dynamics from 6 we obtain that 7 v x t x x f t r t x u x t x 2 m x 2 t x replacing 7 into 4 we get 8 ρ 2 u t 2 x 2 m x 2 t x x f t r t x u ξ t x q t x u u the constitutive equations are 9 f t r t x a e x v x t x 10 m t x e i x 2 u x 2 t x finally to specify the initial and boundary conditions we assume that the riser is of length l 0 and that we are studying its dynamics for t 0 t t 0 replacing 10 into 6 we obtain the equation of motion for the longitudinal displacements 11 ρ 2 v t 2 t x x a e x v x t x p t x u x t x 0 t 0 l subject to the following set of initial and boundary conditions 12 v 0 x 0 v t 0 x g 0 x 0 l v t 0 g t v x t l 0 t 0 where g is a given function defined on 0 t it represents the vertical movement of the ship at sea level now we turn our attention to the transversal movement replacing 9 and 10 into 8 we obtain the equation of motion of the transversal u component 13 ρ 2 u t 2 x 2 x 2 e i x 2 u x 2 t x x a e x v x t x f t r t x u x t x q t x u u subject to the following set of initial and boundary conditions 14 u 0 x 0 u t 0 x h 0 x 0 l 15 u t 0 h t u x t 0 0 t 0 16 e i l 2 u x 2 t l 0 t 0 17 x e i 2 u x 2 t l 0 t 0 where h is a given function defined on 0 t it represents the horizontal movement of the ship at sea level we note that as a direct consequence of 12 f t r t l u x t l 0 t 0 obs 1 functions g and h should satisfy the compatibility conditions 18 g 0 0 h 0 0 finally equations 11 and 13 form a system of equations to be solved it models the dynamical behavior of a beam when we consider transversal and longitudinal displacements 2 1 simplification of the dynamical model the coupled system of partial differential equations 11 and 13 is non linear we do some simplifications to facilitate the mathematical analysis of it the first simplification is to consider that the longitudinal and transversal rigidities a e and e i are positive constants regarding the external forces per unit length of cable p and q we assume that p t x u x γ e q u i v l 0 x 1 u x ξ 2 d ξ γ e q u i v l x where γ e q u i v 0 is the equivalent weight per unit length of the cable this equivalent weight takes into account the self weight of the cable the internal pressure inside the riser and the buoyancy force as detailed in sakugawa 2018 the transversal external force q is mainly due to marine currents and the phenomenon of vortex induced vibration sakugawa 2018 sakugawa and morooka 2017 we will assume that q has a random nature using the average value as a function of time and space in other words we will assume that q q t x the sea current which laterally reaches the riser along its length will deflect the elongated slender body due to drag in the transverse direction to the sea current the riser will experience cyclic forces due to generated vortices by the fluid flow the average value as a function of time and space is assumed for the transversal external force q with these simplifications the approximate motion equations become ρ 2 v t 2 t x x a e v x t x γ e q u i v l x 19 ρ 2 u t 2 x 2 x 2 e i 2 u x 2 t x x f t r t x u x t x q t x 20 f t r t x a e v x t x t x 0 t 0 l with the boundary and initial conditions 14 17 for u and 12 for v and compatibility conditions 18 the advantage of the last equations is that 19 is independent on the solution of 20 it is important to note that despite this fact the longitudinal movement or vertical movement of the riser influences the transversal displacement u governed by 20 specially near the buckling regime discussed in section 3 1 3 existence and uniqueness here we consider the problem of existence and uniqueness of a solution to the system of equations 19 and 20 it is of paramount importance to verify that they possess at least one solution and that if one exists it is the only one from a physical point of view we expect that a solution exists if we prove that the mathematical model of a physical problem does not have solutions then it must be regarded as an evidence that the model is incorrect furthermore in this section we verify that the solution which exists and is unique changes continuously as a function of the input data we start with a necessary condition for the solution v of 19 so that 20 has a solution this condition is physically related to the phenomenon of buckling 3 1 existence we follow the steps now classic described in evans 1991 to prove the existence of a solution to equation 20 subject to boundary conditions 15 and 16 in this section we will employ a scale of sobolev spaces more information can be found for example in evans 1991 the basic space is l 2 0 l the space of square integrable functions on 0 l which we may denote by h 0 0 l the space h n 0 l is the space of functions whose weak n th n 1 th 1 st derivatives belong to l 2 0 l and h 0 2 0 l is the space of functions that belong to h 2 0 l but their value and of their first derivative are null at the boundaries the spaces c and c 1 are respectively the space of continuous functions and the space of functions with continuous first derivatives the other spaces are going to be presented as they appear for the first time let u w b u w t the bilinear form defined for any functions u w h 0 2 0 l by b u w t 0 l e i 2 u x 2 2 w x 2 d x 0 l f t r t x u x w x d x we suppose that the physical parameters of the problem are such that there is a constant real positive real number α 0 such that 21 b u u t α u h 0 2 0 l 2 u h 0 2 0 l t 0 t furthermore we assume that f t r c 1 0 t 0 l and e i c 0 l obs 2 the mathematical condition 21 is related to the phenomenon of buckling in fact for instance if u x sin π x l and e i and f t r are positive constants from the definition of b given above we get b u u t e i 2 π 4 l 4 f t r 2 π 2 l 2 for 21 to be true it is necessary that b u u t 0 this condition leads in this example to the euler s critical compressive load p c r e i π 2 l 2 obs 3 it is not to be forgotten that condition 21 is also linked to the equation of longitudinal motion 9 since f t r t x a e v x t x t x multiplying equation 20 by w w and integrating in the interval 0 l we obtain the following variational formulation 22 ρ u w l 2 b u w t q w w w where l 2 stands for the natural l 2 inner product 3 1 1 energy estimate the first step is to obtain an energy estimate consider the set w defined by w w h 4 0 l w 0 w 0 w l w 3 0 0 where h 4 0 l is the sobolev space of functions whose weak fourth derivatives belong to l 2 0 l consider the eigenvalue problem for the operator p w l 2 0 l defined by p w 4 w x 4 clearly p is bounded and self adjoint operator then by the spectral theorem from its eigenvectors it is possible to build an orthonormal set s n n n in l 2 0 l that is also orthogonal in w now we form a galerkin approximation that as is going to be shown eventually will converge to the weak solution of 20 23 u m t k 1 m d m k t s k note that the coefficient d m k t depends on m but at t 0 they satisfy d m k 0 d m k 0 0 substitute u and v for u m t and s n in 22 to obtain a system of ordinary differential equations 24 d m n t k 1 m b s k s n t d m k t q s n n 1 m that has unique solution therefore we obtained a galerkin approximation to the variational problem 25 ρ u m w l 2 b u m w t q w w w it remains is to show that u m converges weakly to a solution of label eq principalmlinear the first step is to find an energy estimate which uses the gronwall lemma the gronwal lemma gronwall 1919 is very useful to prove to obtain explicit inequalities from implicit ones we recall its statement here lemma 4 let f g and χ real continuous functions defined in a b χ t 0 for t a b suppose that f t g t a t χ s f s d s t a b then f t g t a t χ s g s e s t χ σ d σ d s lemma 5 there exists a positive number c 0 independent of u m u m and q such that max t 0 t u m t h 0 2 0 l 2 u m t l 2 c q l 2 0 t l 2 0 l 2 proof the key idea is to make use of the gronwall inequality replace w by s n in 25 multiply the obtained equality by d m n t and sum from n 1 to n m to obtain u m u m b u m u m t q u m on the other hand we have the following easy identities u m u m 1 2 d d t u m l 2 b u m u m t 1 2 d d t 0 l e i 2 u m x 2 2 d x 1 2 d d t 0 l f t r t x u m x 2 d x 1 2 0 l f t r t x u m x 2 d x summing the above identities we obtain 1 2 d d t u m l 2 2 0 l e i 2 u m x 2 2 d x 0 l f t r t x u m x 2 d x q u m l 2 0 l f t r t x u m x 2 d x since f t r c 1 0 t 0 l and u m v there exists a positive number c 0 such that 0 l f t r t x u m x 2 d x c u m t h 0 2 0 l 2 t 0 t therefore 1 2 d d t u m l 2 0 l 2 b u m u m t c q l 2 0 l 2 u m t l 2 0 l 2 u m t h 0 2 0 l 2 t 0 t using condition 21 and renaming if necessary c 0 we get 1 2 d d t u m l 2 0 l 2 b u m u m t c q t l 2 0 l 2 u m t l 2 0 l 2 b u m u m t t 0 t now an application of the gronwall inequality gives after imposing the initial conditions u m t l 2 0 l 2 b u m u m t c 0 t q s l 2 0 l 2 d s t 0 t applying once again condition 21 we get max t 0 t u m t l 2 0 l 2 u m t h 0 2 0 l 2 c q l 2 0 t l 2 0 l 2 and then the desired result it remains to show that the semi norm is bounded more precisely lemma 6 there exists a positive number c 0 independent of w u u and q such that u m l 2 0 t h 2 0 l 2 c q l 2 0 t l 2 0 l 2 proof here we use the dual norm we therefore will give an estimate to sup w w w h 0 2 0 l 1 u m t w clearly it suffices to consider elements w span s n n 1 m from 25 one get u m t w q t w l 2 b u m w t then using the fact that b is continuous bi linear form we obtain u m t w c q t l 2 0 l w h 0 2 0 l u m t h 0 2 0 l w h 0 2 0 l w w for some c 0 therefore u m t h 2 0 l 2 c q t l 2 0 l 2 u m t h 0 2 0 l 2 integrating in t 0 t and applying lemma 5 we get finally u m l 2 0 t h 2 0 l 2 c q l 2 0 t l 2 0 l 2 we now have the tools to show the existence of a solution to problem 20 more precisely theorem 7 there is a weak solution to problem 20 that is there exists u l 2 0 t h 0 2 0 l with u l 2 0 t l 2 0 l and u l 2 0 t h 2 0 l that satisfies u v b u v t q v v h 0 2 0 l t 0 t a e and the initial conditions proof from lemmas 5 and 6 we see that any u m given by 25 and their time derivatives up to order 2 are bounded in hilbert spaces therefore there is a sequence u m m n such that u m u i n l 2 0 t h 0 2 0 l u m u i n l 2 0 t l 2 0 l u m u i n l 2 0 t h 2 0 l for some u l 2 0 t h 0 2 0 l to see that it is the same u in all those convergences it is enough to think in terms of elements in d let n a fixed integer and set v n k 1 n d m k t s k as u m is the variational solution of 25 we have m n 0 t u m v n b u m v n t d t 0 t q v n d t then by taking the limit as m we get 0 t u v n b u v n t d t 0 t q v n l 2 0 l d t since the set of all v n is dense in l 2 0 t h 0 2 0 l we finally see that u satisfies u v l 2 b u v t q v l 2 v h 0 2 0 l t 0 t a e since u obtained from 22 making m clearly satisfies the initial and boundary conditions we arrived at the end of the proof theorem 7 showed that effectively a weak solution exists this finishes the existence part now we investigate if the solution that exists is unique note that the fact that the solution is a weak one is not of major concern since in general the solutions that the finite element method seeks are of this kind 3 2 uniqueness theorem 8 there is at most one weak solution to problem 20 that is there is at most one u l 2 0 t h 0 2 0 l with u l 2 0 t l 2 0 l and u l 2 0 t h 2 0 l that satisfies u v b u v t q v l 2 0 l v h 0 2 0 l t 0 t a e and the initial conditions proof in the space considered the proof of this theorem is a simple consequence of lemmas 5 and 6 3 3 continuity with respect to the loading function lemmas 5 and 6 provide estimates that prove that the solution of our problem changes continuously with respect to the right hand side of equation 20 which represents the active loading in our problem 4 numerical approximation for a given t 0 l 0 we set i l 0 l and i t 0 t let g h l 2 0 t verifying the compatibility conditions 18 the problem to be approximated consists of two coupled systems of partial differential equations these are systems 11 subject to the initial and boundary conditions 12 for the unknown v representing the longitudinal component and 13 subject to the initial and boundary condition 14 17 for the unknown u representing the transversal component in what follows and in order to facilitate the reading of the part concerning the approximation of the solution we recall the continuous variational formulations to simplify notations for all t i t we set z t the function defined on i l which associates to x i l the real z t x 26 v t w v w h 1 0 l w 0 0 ρ d 2 d t 2 v t w l 2 a v v t w l v w w w v and 27 u t w u w h 2 0 l w 0 0 w x 0 0 ρ d 2 d t 2 u t w l 2 a u u t w l u w w w u where a v v t w 0 l a e d v t d x d w d x d x l v w 0 l p w d x a u u t w 0 l e i d 2 u t d x 2 d 2 w d x 2 d x 0 l f t r d u t d x d w d x d x l u w 0 l q w d x for evolution problems such 11 12 or 14 17 the finite element approximation is generally done in two steps a semi discretization in space which makes it possible to obtain a system of differential equations in time a discretization in time which makes it possible to obtain an algebraic system this system is solved at each iteration in time and makes it possible to obtain the approximate solutions of the unknowns v and u 4 1 a semi discrete scheme let n l a given integer and 0 x 0 x 1 x n l 1 l be a partition of i l into sub intervals k i x i x i 1 with constant length h l n l 1 let k n and p k k i the set of lagrange polynomial functions of degree less than or equal to k on k i the approximation of h 1 is usually obtained by simply using lagrange polynomials of degree less than or equal to k that are only continuous hence to approximate the space w v h 1 i l we use the lagrange finite element p 3 and define discrete finite dimensional space w v h as w v h w c 0 0 l w k i p 3 k i 0 i n l w 0 0 the discrete variational formulation of 26 is then given by 28 v h t w v h ρ d 2 d t 2 v h t w l 2 a v v h w l v w w w v h on the other hand approximating the sobolev space h 2 requires continuity of derivatives and leads to the introduction of hermite elements in which in addition to the values at the nodes values of the derivatives are used as degrees of freedom the simplest hermite type element is the p 3 polynomial see boffi brezzi fortin boffifranco and fortin 2013 hence to approximate the space w u h 2 i l we use the hermite finite element p 3 and define discrete space w u h as w u h w c 1 0 l w k i p 3 k i 0 i n l w 0 0 w x 0 0 the discrete variational formulation of 27 is then given by 29 u h t w u h ρ d 2 d t 2 u h t w l 2 a u u h t w l u w w w u h we must be careful that contrary to the space w v h the definition of w u h requires functions to belong to c 1 and not only c 0 this is what makes difference between hermite finite element and lagrange finite element let ϕ i 1 n 1 a basis of w v h and ψ i 1 n 2 a basis of w u h then v h t i 1 n 1 v h i t ϕ i u h t i 1 n 2 u h i t ψ i recall the lagrange ϕ i i 1 2 3 4 and hermite ψ i i 1 2 3 4 basic polynomial functions on the reference finite element 0 1 ϕ i x k 1 k i 4 x x k x i x k i 1 4 x 1 0 x 2 1 3 x 3 2 3 x 4 1 ψ 1 x x 1 2 1 2 x ψ 2 x x 2 3 2 x ψ 3 x x 2 3 2 x φ 4 x x 1 x 2 problems 28 and 29 can be written in the following second order differential equation systems 30 find v h t m v d 2 v h t d t 2 k v v h t b v v h 0 v 0 d v h d t 0 v 1 find u h t m u d 2 u h t d t 2 k u u h t b u u h 0 u 0 d u h d t 0 u 1 where the matrices m v m u k v k u b v and b u are given by m i j v 0 l ρ ϕ j ϕ i k i j v 0 l a e d ϕ j d x d ϕ i d x b i v 0 l p ϕ i b i u 0 l q ψ i m i j u 0 l ρ ψ j ψ i k i j u 0 l e i d 2 ψ j d x 2 d 2 ψ i d x 2 f t r x d ψ j d x d ψ i d x note that matrices m v m u are symmetric and positive definite they are then invertible matrices k v k u are symmetric and positive therefore differential systems 30 are well posed 4 2 a fully discrete scheme let us now describe the fully discrete scheme to do so we consider n t a given integer and 0 t 0 t 1 t n t 1 t be a partition of i t into sub intervals j n t n t n 1 with constant length δ t t n t 1 then t n n δ t let v h n and u h n denote approximations of v h t n and u h t n respectively to approximate the time derivatives in 28 and 29 we consider a centered finite differences d 2 d t 2 v h t v h n 1 2 v h n v h n 1 δ t 2 d 2 d t 2 u h t u h n 1 2 u h n u h n 1 δ t 2 given v h n 1 v h n u h n 1 and u h n the backward euler schemes see for example dautray lions dautray and lions 2000 writes 31 find v h n 1 w v h w w v h ρ v h n 1 w l 2 δ t 2 a v v h n 1 w δ t 2 l v w 2 ρ v h n w l 2 ρ v h n 1 w l 2 32 find u h n 1 w u h w w v h ρ u h n 1 w l 2 δ t 2 a u u h n 1 w δ t 2 l u w 2 ρ u h n w l 2 ρ u h n 1 w l 2 then we can easily show that problems 31 and 32 are respectively equivalent to the following algebraic systems 33 for v n v n 1 r n 1 known find v n 1 r n 1 m v δ t 2 k v v n 1 δ t 2 b v 2 m v v n m v v n 1 and 34 for u n u n 1 r n 2 known find u n 1 r n 2 m u δ t 2 k u u n 1 δ t 2 b 2 2 m u u n m u u n 1 4 3 numerical procedure algorithm the systems to be solved in 33 and 34 are at the heart of the numerical approximation of the continuous systems 12 13 and 14 18 this system is coupled because of the presence of the traction compression force f t r at each time step t n n δ t this force writes f t r t n x a e v x t n x using a centered discrete derivative of v 35 v x t n x k v t n x k h 2 v t n x k h 2 h where x k denotes the barycenter of the element mesh k finally to solve the algebraic systems 33 and 34 one needs first to solve the algebraic system 33 computes an approximation of the coupling term using 35 and then solve the algebraic system 34 until the convergence of procedure more precisely we developed a simple matlab procedure matlab ecl the full algorithm to get the approximation of the solution writes 4 3 1 algorithm 1 given physical and geometrical parameters 2 define the meshes for both variables v and u 3 initialization given v 0 v 1 u 0 and u 1 4 time iterations at each time step t n n δ t assemble the matrices m v k v b v solve the algebraic system 33 to get an approximation of v update the coupling force f t r t n using 35 assemble the matrices m u k u b u solve the algebraic system 34 to get an approximation of u calculate the relative errors 5 go to 4 if needed this calculation for the traction compression force f t r t n x is going to be employed in the simulation later in section 4 7 when compare the numerical results with those obtained in physical experiments 4 4 validation of the numerical scheme to validate the previous algorithm as well as the convergence of the iterative procedure we choose right hand sides functions p and q appearing in equations 12 and 14 respectively such that the corresponding exact solutions v and u are easy to obtain in our case these right hand sides p and q are given t x i t i l by p t x ρ x l 2 a e t 2 t x i t i l q t x ρ 12 e i x l 4 4 l 3 x t 2 a 6 i 4 x l 3 l 3 it is easy to verify that functions v and u given by 36 v t x t 2 2 x l 2 u t x t 2 24 e i x l 4 4 l 3 x are solutions of 11 and 13 respectively moreover they verify the boundary conditions 12 and 14 17 respectively note that for the previous choice of right hand sides p and q the functions g and h appearing in the boundary conditions 12 and 15 are respectively given by g t v t 0 l 2 2 t 2 h t u t 0 l 4 24 e i t 2 they indeed verify the compatibility conditions given in 19 moreover the coupling term f t r a e v x is given by f t r t x a e v x t x a e t 2 x l and verifies the following important properties 37 f t r t x 0 t x i t i l a n d f t r t l 0 having previously shown that the initial boundary value problems 11 12 and 13 16 admit one and only one solution our numerical procedure based on the previous algorithm must provide approximate solutions with small enough error let us consider the previous right hand sides p and q in the following the interval of study i l is assumed of given length l 1 575 the physical parameters are all set to 1 the spatial and temporal discretization parameters are given by n l 35 a n d δ t 0 01 the effectiveness of the numerical procedure is measured by the error of approximation in the case of an a priori known solution v u the upper part of fig 2 represents a comparison between the numerical solutions obtained with the procedure resulting from the new model developed above and the exact solutions given by 36 whereas the lower part represents the errors committed in approaching the exact solutions by the numerical solutions at the 95 th time step as shown in fig 2 the numerical solutions are very accurate up to 10 8 for the v component and 10 4 for the u component having successfully validated the numerical procedure on a test case where the solution is known we now test our numerical approach on the dynamic response of a vertical pipe 4 5 dynamic response of a vertical pipe in this section we study the dynamic behavior of a vertical riser in calm water tank the vertical pipe is assumed to be free at its lower end and subjected to a forced displacement at its upper part the imposed movements on the upper part intend to represent movements from the ship in the sea surface due to waves currents and wind experiments were carried out at the energy department of the faculty of mechanical engineering at the university of campinas furhter details of the experiments can be found in taha et al 2015 a small diameter pipe was developed as the physical model for the laboratory experiments the optical measurement system was used for capturing pipe movements in the tank the displacements along the length of the pipe are measured and the vibrations are analyzed the results obtained from the experiment allowed a better understanding of pipe behavior and better investigation of numerical simulation procedures using commercial software orcaflex orcina 2014 and the code developed according to our new model analyzed above 4 5 1 pipe model characteristics the pipe model is made by silicone with concentrated weight uniformly distributed along the length and it is internally water tight the external surface of the silicone tube is sufficiently smooth to neglect effect of roughness the length silicone made pipe model is l 1 575 m with external diameter d e 8 10 3 m and internal diameter d i 6 10 3 m and its mass in air per unit of length is m 2 45 10 2 kg m and the young modulus is e 2 3 10 6 pa each of the ten concentrated weights along the model has mass m w equal to 0 748 10 3 kg the time unit is the second the mean linear density of the pipe is given by ρ m l 10 m w l where the term 10 m w is due to the presence of ten small masses placed at each node as shown in fig 3 the physical parameters a and i are given by a π d e 2 d i 2 4 i π d e 4 d i 4 4 the discretization parameters are n l 16 h l n l 1 and δ t 0 01 s the boundary functions h and g that appear in 15 12 and 18 are given by h t 0 05 sin ω t ω 2 π 8 1 g t 0 we recall that g that appears in 12 for the first time is the vertical displacement imposed to the top extremity of the riser whereas h 15 is the horizontal displacement at the same point the vertical direction is the one pointing to the center of the earth equation 18 is a compatibility condition that h and g must satisfy the source terms p and q are given by p t x m g l x t x i t i l q t x 0 t x i t i l where g stands for the acceleration of gravity simulations have been done by using both the present procedure described above and orcaflex software that allow to model the pipe according to the lumped mass method fig 3 represents a scheme of the pipe model for simulation in the orcaflex software and one element of the model is highlighted due to the lumped mass method each element has its mass equally divided in their extremities each end node of the element is formed by half of the current element mass and half of the next mass element the connection between two adjacent elements is made by springs and shock absorbers whose function is to restrict transverse movements and rotations in shared node 4 6 comparison of the time domain responses matlab ecl vs orcaflex in this subsection we present a comparison of the results obtained by the present approach and those obtained by the orcaflex software we consider a force f t r that does not depend on time but only on the position more precisely the force f t r is 38 f t r t x ρ g l x t x i t i l forced sinusoidal oscillation in x direction with a period of 8 1 s has been considered numerical simulation using the present approach is compared to the results obtained by the orcaflex software the amplitudes of displacement have been normalized by the external diameter of the pipe fig 4 shows time series of the pipe response x horizontal direction at the node number 2 as we can see in this figure in the absence of the coupling term the results obtained by our approach are identical to those obtained by orcaflex software in fig 6 it is shown a comparison with experimental results see fig 5 4 7 comparison of the time domain responses matlab ecl vs experiment the results of our approach are also compared to those obtained by the experiments as we can see on fig 6 the results are quite close to the experiments however it can also be noted that we get a large difference for positions near the bottom end of the pipe this is essentially due to the fact that in our approach we have neglected the viscous damping effects on the other hand the curve on right part of the figure makes it possible to know throughout the length of the pipe what is the maximum and minimum value of the displacement clearly at least in the big part of the pipe the results obtained by our approach are very close to those obtained by the experiments once the curve is known for a set of combinations of situations and configurations it is very easy to dimension the beam 5 conclusion in this paper we rigorously analyzed a dynamical model for the transverse motion of a riser taking into account longitudinal forces that have origin not only in the self weight but also dynamic longitudinal forces in fact we proved the existence uniqueness and stability properties for the resulting system of coupled differential equations and we proposed a new way of approaching numerically the equations of motion the correctness of the proposed numerical method was verified against a closed form solution that satisfies the system of equations with initial and boundary conditions all this can be regarded as a first step towards a more comprehensive theoretical numerical model which would also include the effects of fluid viscosity fluid structure interactions hydrodynamic effects and currents induced vibrations in this work we also conducted experiments in a calm water tank which provided us with experimental data that were compared with our numerical simulation results and with those produced by a orcaflex orcina 2014 the comparison have shown very promising results concerning the evaluation of the dynamic behavior of a riser in water with our approach a straightforward extension of the proposed model can be derived for the three dimensional case we expect the material provided in this paper to be useful for engineers in the petroleum sector credit authorship contribution statement alexandre kawano conceptualization supervision writing original draft writing review editing abdelmalek zine conceptualization supervision software writing original draft writing review editing celso morooka conceptualization writing original draft writing review editing mohamed ichchou conceptualization writing original draft writing review editing declaration of competing interest the authors declare that they have no known compe5ng financial interests or personal rela5onships that could have appeared to influence the work reported in this paper acknowledgments the authors thank the support of fapesp proc 15 50461 0 also thanks to unicamp for the support through the french brazilian catedra program 
21060,the aim of this work is twofold we analyze a dynamical model for the transversal motion of a vertical riser which is a long tube used in the petroleum industry for subsea well drilling operations and in other cases to bring the oil from the bottom to the sea surface after the analysis we propose a new numerical approach to solve the resulting system of coupled differential equations the proposed model in which transversal displacements are coupled with longitudinal ones is analyzed from a mathematical point of view where we proved the existence and uniqueness for the resulting system of differential equations a numerical model based on finite element method is discussed and successfully implemented in a matlab code the numerical results are compared to those obtained by a commercial computation code orcaflex orcina 2014 and also the experiments in both situations the obtained results are very satisfactory and encouraging ams mos subject classification 74k10 74h20 74h25 74h45 65n30 keywords euler bernoulli beam partial differential equations risers longitudinal forces finite element method 1 introduction the advance in the exploration of offshore petroleum fields placed in ultra deep water and the new challenges in pre salt region require innovative and safe solutions for offshore oil production systems the flow of the petroleum from a wellhead at the seabed to a floating production vessel at the sea surface is made by slender tubes named risers slender long tubes drilling risers are also applied for subsea wellbore drilling different configurations for riser systems have emerged as suitable technological and economical solutions for offshore petroleum exploration in ultra deep waters the study and development of methodologies for riser projects considering the uncertainties involved in the manufacturing process and the effects of meta ocean conditions such as waves current and platform motions is fundamental to increase the safety of the system the safety of a riser can be defined through its structural capacity to stand loads during its operation xia and daas 2008 the riser is under the influence of complex loading due to wave current platform motions its own weight and other operational loads such as the fluid flowing internally which can reduce the operational service life of the riser environmental loads on a riser as well as the forced dynamic behavior have a random nature riser failure can result in several undesirable consequences for the environment to the safety of personnel and to the sea surface production facility itself det norske veritas 2002 therefore the study of parameters that can cause failure in a riser is extremely important det norske veritas 2001 many studies have been conducted regarding risers in the past chakrabarti and frampton 1982 the studies in beginning usually accounted small deflection and deformation in two vertical planes kirk et al 1979 patel et al 1984 young et al 1978 further studies presented more complete model spanos et al 1990 and formulations in three dimensions with large deflections and deformations bernitsas 1982 bernitsas et al 1985 nowadays many applications based on those models are observed in the literature morooka et al 2004 morooka et al 2004 teixeira and morooka 2017 including effects from vortex induced vibration viv and internal flow in the riser athisakul et al 2011 bordalo and morooka 2018 i k chatjigeorgiou 2004 investigated a parametric excitation of a very slender marine structure a completely vertical structure with hinged connections at both ends in the static position is considered and uses a 3d dynamic equilibrium formulations that accounts the unstretched lagragian coordinates and found solution by a finite differences approximation scheme mazzilli et al 2008 presented a rigorous derivation of non linear equations governing the dynamics of an axially loaded beam where a structure is subjected to a uniformly distributed axial and a thrust force it was shown that the procedure effectively analyze the transversal vibration responses observing the modal responses and mode interactions where the developed analytical models have been verified with results from fem simulation li et al 2018 analyzed a non linear model for risers with large deformations in three dimensional space in chakrabarti and frampton 1982 and patel and seyed 1995 several mathematical models for the dynamic behavior of risers are reviewed some simpler models assume that the structure is essentially a long string while others assume that the riser offers some mechanical resistance to momentum thus possessing bending rigidity in this paper we analyzed a dynamical model for the transverse motion of a riser taking into account longitudinal forces that have origin not only in the self weight as in existing commercial software but also in the dynamic longitudinal forces this is the first step towards a more comprehensive model which would also include the effects of fluid viscosity fluid structure interactions hydrodynamic effects and current induced vibrations after rigorously proving the existence and uniqueness for the resulting system of differential equations concerning the motion of risers under transversal and longitudinal forces a new way of approaching numerically the equations of motion was proposed it is the most important contribution of this paper having established a rigorous analysis of the equations one can hope to solve inverse problems of identifying forces or defects in the structure in fact several articles have been dedicated to some inverse problems related to beams hasanov and baysal 2016 hasanov and kawano 2016 hasanov 2009 an outline of the paper is as follows in the next section we present the model and give a set of governing equations in the third section we prove the existence and uniqueness of the solution to the resulting coupled system of partial differential equations in the forth section we propose a numerical approximation based on the finite element method and give some comparison between our results and those obtained by an industrial code and also to those obtained by the experiments 2 governing equations a slender elongated vertical line structure is considered to represent the riser through the beam model for the sake of simplicity there is no internal fluid inside the riser pipe and for the modeling the pipe is taken solid made by a hypothetical homogeneous material the upper terminal connection of the structure with the sea surface vessel is taken pinned and the bottom terminal is free to move the transverse vertical plane view of the system with respect to the sea current direction is shown in fig 1 the longitudinal external loads is represented by p and the horizontal ones due to loads with oscillatory loads for instance waves or vortex induced vibrations is represented by q we consider a cable that is hanging down from the sea level we take as a reference a system that is fixed relative to a point on the earth at the sea level where the upper extremity of the cable is located at newtonian time t 0 the x axis is then fixed to be in the direction towards the center of the earth clearly even in the context of classical mechanics it is an approximation for the chosen system is not inertial due to the earth movements and therefore it is not inertial however being aware of limitations of it it is a useful approximation that greatly simplifies the analysis consider a portion of a long beam between x and x ξ where x represents the depth of a point and ξ is a small increment on x this portion of the beam is subjected to external forces per unit length p and q which generate longitudinal and transverse displacements v and u respectively in general q is due to the interaction between hydrodynamic forces and the movement of the cable on the other hand p is mainly due to the self weight of the riser per unit of depth which is dependent of the general shape of the line that the riser describes from the ship to the depths of the sea in fig 1 note particularly that the vector force f t r v which is the sum of the traction and the shearing force is not necessarily tangent to the geometrical line that represents the beam this is due to the presence of the bending stiffness for the mechanical model we opted to start from an integral formulation so that we can see more easily the simplifications by linearization that are going to be made by d alembert principle we have immediately that at each instant of time t it is true that the displacements u t x and v t x obey the following equations for the momentum m the shearing force v and traction force f t r which are also functions of time and space moreover p and q may be dependent on time t coordinate x transversal displacement u the tangent of the line at x u x the velocity u and the acceleration u in this work we shall designate time derivatives with a dot and space derivatives with a prime in our model the vertical force per unit length p is mainly due to the self weight of the cable and consequently on the length of the hanging part since the length of the cable is given by l x 0 x u x ξ 2 1 d ξ p is dependent on u x l x is the length of the cable from the origin at the upper extremity to the point of the cable at has coordinate x as shown in fig 1 since the cable may deviate from a perfect straight line pointing to the center of the earth in general l x x and l x 0 only when the cable is a straight line the horizontal force per unit length q is dependent on the velocity u and acceleration u of the riser in the transversal direction we observe that are dealing with a simplified model in which the cable is unstretched for an excellent discussion about it see mazzilli et al 2008 the sea current acts laterally on the riser and as a consequence external current loads deflect it horizontally due to the drag forces in the transverse direction to the sea current the riser will suffer oscillating fluid forces due to other kind of loads such as internal multi phase oil and gas mixture flow moreover there is the presence of vortex induced vibration due to the sea current in the present approach for the sake of simplicity and with the purpose to show effective representation of the analytical solution for the problem only the average value as a function of time and space is assumed for the lateral fluid forces to simplify notation in the next equation we consider only the spatial dependence the only exception in this notation is to make explicit the dependence of p on u x 1 v x ξ v x x x ξ q ζ d ζ x x ξ ρ 2 u t 2 d ζ 2 f t r x ξ f t r x x x ξ p ζ u x d ζ x x ξ ρ 2 v t 2 d ζ 3 m x ξ m x v x ξ ξ f t r x ξ u x ξ u x x x ξ ρ 2 u t 2 ζ ζ x d ζ x x ξ ρ 2 v t 2 ζ u ζ u x d ζ x x ξ q ζ ζ x d ζ x x ξ p ζ u x u ζ u x d ζ evaluating the first derivative with respect to ξ of all above equations at ξ 0 we obtain 4 v x t x q t x u u ρ 2 u t 2 t x 5 f t r x t x p t x u x ρ 2 v t 2 t x 6 m x t x v t x f t r t x u x t x 0 observe that by 6 contrary to the classical beam equation the third derivative of the transverse displacement does not give the shearing force v it gives the shearing force added to an extra term that is dependent on the longitudinal dynamics from 6 we obtain that 7 v x t x x f t r t x u x t x 2 m x 2 t x replacing 7 into 4 we get 8 ρ 2 u t 2 x 2 m x 2 t x x f t r t x u ξ t x q t x u u the constitutive equations are 9 f t r t x a e x v x t x 10 m t x e i x 2 u x 2 t x finally to specify the initial and boundary conditions we assume that the riser is of length l 0 and that we are studying its dynamics for t 0 t t 0 replacing 10 into 6 we obtain the equation of motion for the longitudinal displacements 11 ρ 2 v t 2 t x x a e x v x t x p t x u x t x 0 t 0 l subject to the following set of initial and boundary conditions 12 v 0 x 0 v t 0 x g 0 x 0 l v t 0 g t v x t l 0 t 0 where g is a given function defined on 0 t it represents the vertical movement of the ship at sea level now we turn our attention to the transversal movement replacing 9 and 10 into 8 we obtain the equation of motion of the transversal u component 13 ρ 2 u t 2 x 2 x 2 e i x 2 u x 2 t x x a e x v x t x f t r t x u x t x q t x u u subject to the following set of initial and boundary conditions 14 u 0 x 0 u t 0 x h 0 x 0 l 15 u t 0 h t u x t 0 0 t 0 16 e i l 2 u x 2 t l 0 t 0 17 x e i 2 u x 2 t l 0 t 0 where h is a given function defined on 0 t it represents the horizontal movement of the ship at sea level we note that as a direct consequence of 12 f t r t l u x t l 0 t 0 obs 1 functions g and h should satisfy the compatibility conditions 18 g 0 0 h 0 0 finally equations 11 and 13 form a system of equations to be solved it models the dynamical behavior of a beam when we consider transversal and longitudinal displacements 2 1 simplification of the dynamical model the coupled system of partial differential equations 11 and 13 is non linear we do some simplifications to facilitate the mathematical analysis of it the first simplification is to consider that the longitudinal and transversal rigidities a e and e i are positive constants regarding the external forces per unit length of cable p and q we assume that p t x u x γ e q u i v l 0 x 1 u x ξ 2 d ξ γ e q u i v l x where γ e q u i v 0 is the equivalent weight per unit length of the cable this equivalent weight takes into account the self weight of the cable the internal pressure inside the riser and the buoyancy force as detailed in sakugawa 2018 the transversal external force q is mainly due to marine currents and the phenomenon of vortex induced vibration sakugawa 2018 sakugawa and morooka 2017 we will assume that q has a random nature using the average value as a function of time and space in other words we will assume that q q t x the sea current which laterally reaches the riser along its length will deflect the elongated slender body due to drag in the transverse direction to the sea current the riser will experience cyclic forces due to generated vortices by the fluid flow the average value as a function of time and space is assumed for the transversal external force q with these simplifications the approximate motion equations become ρ 2 v t 2 t x x a e v x t x γ e q u i v l x 19 ρ 2 u t 2 x 2 x 2 e i 2 u x 2 t x x f t r t x u x t x q t x 20 f t r t x a e v x t x t x 0 t 0 l with the boundary and initial conditions 14 17 for u and 12 for v and compatibility conditions 18 the advantage of the last equations is that 19 is independent on the solution of 20 it is important to note that despite this fact the longitudinal movement or vertical movement of the riser influences the transversal displacement u governed by 20 specially near the buckling regime discussed in section 3 1 3 existence and uniqueness here we consider the problem of existence and uniqueness of a solution to the system of equations 19 and 20 it is of paramount importance to verify that they possess at least one solution and that if one exists it is the only one from a physical point of view we expect that a solution exists if we prove that the mathematical model of a physical problem does not have solutions then it must be regarded as an evidence that the model is incorrect furthermore in this section we verify that the solution which exists and is unique changes continuously as a function of the input data we start with a necessary condition for the solution v of 19 so that 20 has a solution this condition is physically related to the phenomenon of buckling 3 1 existence we follow the steps now classic described in evans 1991 to prove the existence of a solution to equation 20 subject to boundary conditions 15 and 16 in this section we will employ a scale of sobolev spaces more information can be found for example in evans 1991 the basic space is l 2 0 l the space of square integrable functions on 0 l which we may denote by h 0 0 l the space h n 0 l is the space of functions whose weak n th n 1 th 1 st derivatives belong to l 2 0 l and h 0 2 0 l is the space of functions that belong to h 2 0 l but their value and of their first derivative are null at the boundaries the spaces c and c 1 are respectively the space of continuous functions and the space of functions with continuous first derivatives the other spaces are going to be presented as they appear for the first time let u w b u w t the bilinear form defined for any functions u w h 0 2 0 l by b u w t 0 l e i 2 u x 2 2 w x 2 d x 0 l f t r t x u x w x d x we suppose that the physical parameters of the problem are such that there is a constant real positive real number α 0 such that 21 b u u t α u h 0 2 0 l 2 u h 0 2 0 l t 0 t furthermore we assume that f t r c 1 0 t 0 l and e i c 0 l obs 2 the mathematical condition 21 is related to the phenomenon of buckling in fact for instance if u x sin π x l and e i and f t r are positive constants from the definition of b given above we get b u u t e i 2 π 4 l 4 f t r 2 π 2 l 2 for 21 to be true it is necessary that b u u t 0 this condition leads in this example to the euler s critical compressive load p c r e i π 2 l 2 obs 3 it is not to be forgotten that condition 21 is also linked to the equation of longitudinal motion 9 since f t r t x a e v x t x t x multiplying equation 20 by w w and integrating in the interval 0 l we obtain the following variational formulation 22 ρ u w l 2 b u w t q w w w where l 2 stands for the natural l 2 inner product 3 1 1 energy estimate the first step is to obtain an energy estimate consider the set w defined by w w h 4 0 l w 0 w 0 w l w 3 0 0 where h 4 0 l is the sobolev space of functions whose weak fourth derivatives belong to l 2 0 l consider the eigenvalue problem for the operator p w l 2 0 l defined by p w 4 w x 4 clearly p is bounded and self adjoint operator then by the spectral theorem from its eigenvectors it is possible to build an orthonormal set s n n n in l 2 0 l that is also orthogonal in w now we form a galerkin approximation that as is going to be shown eventually will converge to the weak solution of 20 23 u m t k 1 m d m k t s k note that the coefficient d m k t depends on m but at t 0 they satisfy d m k 0 d m k 0 0 substitute u and v for u m t and s n in 22 to obtain a system of ordinary differential equations 24 d m n t k 1 m b s k s n t d m k t q s n n 1 m that has unique solution therefore we obtained a galerkin approximation to the variational problem 25 ρ u m w l 2 b u m w t q w w w it remains is to show that u m converges weakly to a solution of label eq principalmlinear the first step is to find an energy estimate which uses the gronwall lemma the gronwal lemma gronwall 1919 is very useful to prove to obtain explicit inequalities from implicit ones we recall its statement here lemma 4 let f g and χ real continuous functions defined in a b χ t 0 for t a b suppose that f t g t a t χ s f s d s t a b then f t g t a t χ s g s e s t χ σ d σ d s lemma 5 there exists a positive number c 0 independent of u m u m and q such that max t 0 t u m t h 0 2 0 l 2 u m t l 2 c q l 2 0 t l 2 0 l 2 proof the key idea is to make use of the gronwall inequality replace w by s n in 25 multiply the obtained equality by d m n t and sum from n 1 to n m to obtain u m u m b u m u m t q u m on the other hand we have the following easy identities u m u m 1 2 d d t u m l 2 b u m u m t 1 2 d d t 0 l e i 2 u m x 2 2 d x 1 2 d d t 0 l f t r t x u m x 2 d x 1 2 0 l f t r t x u m x 2 d x summing the above identities we obtain 1 2 d d t u m l 2 2 0 l e i 2 u m x 2 2 d x 0 l f t r t x u m x 2 d x q u m l 2 0 l f t r t x u m x 2 d x since f t r c 1 0 t 0 l and u m v there exists a positive number c 0 such that 0 l f t r t x u m x 2 d x c u m t h 0 2 0 l 2 t 0 t therefore 1 2 d d t u m l 2 0 l 2 b u m u m t c q l 2 0 l 2 u m t l 2 0 l 2 u m t h 0 2 0 l 2 t 0 t using condition 21 and renaming if necessary c 0 we get 1 2 d d t u m l 2 0 l 2 b u m u m t c q t l 2 0 l 2 u m t l 2 0 l 2 b u m u m t t 0 t now an application of the gronwall inequality gives after imposing the initial conditions u m t l 2 0 l 2 b u m u m t c 0 t q s l 2 0 l 2 d s t 0 t applying once again condition 21 we get max t 0 t u m t l 2 0 l 2 u m t h 0 2 0 l 2 c q l 2 0 t l 2 0 l 2 and then the desired result it remains to show that the semi norm is bounded more precisely lemma 6 there exists a positive number c 0 independent of w u u and q such that u m l 2 0 t h 2 0 l 2 c q l 2 0 t l 2 0 l 2 proof here we use the dual norm we therefore will give an estimate to sup w w w h 0 2 0 l 1 u m t w clearly it suffices to consider elements w span s n n 1 m from 25 one get u m t w q t w l 2 b u m w t then using the fact that b is continuous bi linear form we obtain u m t w c q t l 2 0 l w h 0 2 0 l u m t h 0 2 0 l w h 0 2 0 l w w for some c 0 therefore u m t h 2 0 l 2 c q t l 2 0 l 2 u m t h 0 2 0 l 2 integrating in t 0 t and applying lemma 5 we get finally u m l 2 0 t h 2 0 l 2 c q l 2 0 t l 2 0 l 2 we now have the tools to show the existence of a solution to problem 20 more precisely theorem 7 there is a weak solution to problem 20 that is there exists u l 2 0 t h 0 2 0 l with u l 2 0 t l 2 0 l and u l 2 0 t h 2 0 l that satisfies u v b u v t q v v h 0 2 0 l t 0 t a e and the initial conditions proof from lemmas 5 and 6 we see that any u m given by 25 and their time derivatives up to order 2 are bounded in hilbert spaces therefore there is a sequence u m m n such that u m u i n l 2 0 t h 0 2 0 l u m u i n l 2 0 t l 2 0 l u m u i n l 2 0 t h 2 0 l for some u l 2 0 t h 0 2 0 l to see that it is the same u in all those convergences it is enough to think in terms of elements in d let n a fixed integer and set v n k 1 n d m k t s k as u m is the variational solution of 25 we have m n 0 t u m v n b u m v n t d t 0 t q v n d t then by taking the limit as m we get 0 t u v n b u v n t d t 0 t q v n l 2 0 l d t since the set of all v n is dense in l 2 0 t h 0 2 0 l we finally see that u satisfies u v l 2 b u v t q v l 2 v h 0 2 0 l t 0 t a e since u obtained from 22 making m clearly satisfies the initial and boundary conditions we arrived at the end of the proof theorem 7 showed that effectively a weak solution exists this finishes the existence part now we investigate if the solution that exists is unique note that the fact that the solution is a weak one is not of major concern since in general the solutions that the finite element method seeks are of this kind 3 2 uniqueness theorem 8 there is at most one weak solution to problem 20 that is there is at most one u l 2 0 t h 0 2 0 l with u l 2 0 t l 2 0 l and u l 2 0 t h 2 0 l that satisfies u v b u v t q v l 2 0 l v h 0 2 0 l t 0 t a e and the initial conditions proof in the space considered the proof of this theorem is a simple consequence of lemmas 5 and 6 3 3 continuity with respect to the loading function lemmas 5 and 6 provide estimates that prove that the solution of our problem changes continuously with respect to the right hand side of equation 20 which represents the active loading in our problem 4 numerical approximation for a given t 0 l 0 we set i l 0 l and i t 0 t let g h l 2 0 t verifying the compatibility conditions 18 the problem to be approximated consists of two coupled systems of partial differential equations these are systems 11 subject to the initial and boundary conditions 12 for the unknown v representing the longitudinal component and 13 subject to the initial and boundary condition 14 17 for the unknown u representing the transversal component in what follows and in order to facilitate the reading of the part concerning the approximation of the solution we recall the continuous variational formulations to simplify notations for all t i t we set z t the function defined on i l which associates to x i l the real z t x 26 v t w v w h 1 0 l w 0 0 ρ d 2 d t 2 v t w l 2 a v v t w l v w w w v and 27 u t w u w h 2 0 l w 0 0 w x 0 0 ρ d 2 d t 2 u t w l 2 a u u t w l u w w w u where a v v t w 0 l a e d v t d x d w d x d x l v w 0 l p w d x a u u t w 0 l e i d 2 u t d x 2 d 2 w d x 2 d x 0 l f t r d u t d x d w d x d x l u w 0 l q w d x for evolution problems such 11 12 or 14 17 the finite element approximation is generally done in two steps a semi discretization in space which makes it possible to obtain a system of differential equations in time a discretization in time which makes it possible to obtain an algebraic system this system is solved at each iteration in time and makes it possible to obtain the approximate solutions of the unknowns v and u 4 1 a semi discrete scheme let n l a given integer and 0 x 0 x 1 x n l 1 l be a partition of i l into sub intervals k i x i x i 1 with constant length h l n l 1 let k n and p k k i the set of lagrange polynomial functions of degree less than or equal to k on k i the approximation of h 1 is usually obtained by simply using lagrange polynomials of degree less than or equal to k that are only continuous hence to approximate the space w v h 1 i l we use the lagrange finite element p 3 and define discrete finite dimensional space w v h as w v h w c 0 0 l w k i p 3 k i 0 i n l w 0 0 the discrete variational formulation of 26 is then given by 28 v h t w v h ρ d 2 d t 2 v h t w l 2 a v v h w l v w w w v h on the other hand approximating the sobolev space h 2 requires continuity of derivatives and leads to the introduction of hermite elements in which in addition to the values at the nodes values of the derivatives are used as degrees of freedom the simplest hermite type element is the p 3 polynomial see boffi brezzi fortin boffifranco and fortin 2013 hence to approximate the space w u h 2 i l we use the hermite finite element p 3 and define discrete space w u h as w u h w c 1 0 l w k i p 3 k i 0 i n l w 0 0 w x 0 0 the discrete variational formulation of 27 is then given by 29 u h t w u h ρ d 2 d t 2 u h t w l 2 a u u h t w l u w w w u h we must be careful that contrary to the space w v h the definition of w u h requires functions to belong to c 1 and not only c 0 this is what makes difference between hermite finite element and lagrange finite element let ϕ i 1 n 1 a basis of w v h and ψ i 1 n 2 a basis of w u h then v h t i 1 n 1 v h i t ϕ i u h t i 1 n 2 u h i t ψ i recall the lagrange ϕ i i 1 2 3 4 and hermite ψ i i 1 2 3 4 basic polynomial functions on the reference finite element 0 1 ϕ i x k 1 k i 4 x x k x i x k i 1 4 x 1 0 x 2 1 3 x 3 2 3 x 4 1 ψ 1 x x 1 2 1 2 x ψ 2 x x 2 3 2 x ψ 3 x x 2 3 2 x φ 4 x x 1 x 2 problems 28 and 29 can be written in the following second order differential equation systems 30 find v h t m v d 2 v h t d t 2 k v v h t b v v h 0 v 0 d v h d t 0 v 1 find u h t m u d 2 u h t d t 2 k u u h t b u u h 0 u 0 d u h d t 0 u 1 where the matrices m v m u k v k u b v and b u are given by m i j v 0 l ρ ϕ j ϕ i k i j v 0 l a e d ϕ j d x d ϕ i d x b i v 0 l p ϕ i b i u 0 l q ψ i m i j u 0 l ρ ψ j ψ i k i j u 0 l e i d 2 ψ j d x 2 d 2 ψ i d x 2 f t r x d ψ j d x d ψ i d x note that matrices m v m u are symmetric and positive definite they are then invertible matrices k v k u are symmetric and positive therefore differential systems 30 are well posed 4 2 a fully discrete scheme let us now describe the fully discrete scheme to do so we consider n t a given integer and 0 t 0 t 1 t n t 1 t be a partition of i t into sub intervals j n t n t n 1 with constant length δ t t n t 1 then t n n δ t let v h n and u h n denote approximations of v h t n and u h t n respectively to approximate the time derivatives in 28 and 29 we consider a centered finite differences d 2 d t 2 v h t v h n 1 2 v h n v h n 1 δ t 2 d 2 d t 2 u h t u h n 1 2 u h n u h n 1 δ t 2 given v h n 1 v h n u h n 1 and u h n the backward euler schemes see for example dautray lions dautray and lions 2000 writes 31 find v h n 1 w v h w w v h ρ v h n 1 w l 2 δ t 2 a v v h n 1 w δ t 2 l v w 2 ρ v h n w l 2 ρ v h n 1 w l 2 32 find u h n 1 w u h w w v h ρ u h n 1 w l 2 δ t 2 a u u h n 1 w δ t 2 l u w 2 ρ u h n w l 2 ρ u h n 1 w l 2 then we can easily show that problems 31 and 32 are respectively equivalent to the following algebraic systems 33 for v n v n 1 r n 1 known find v n 1 r n 1 m v δ t 2 k v v n 1 δ t 2 b v 2 m v v n m v v n 1 and 34 for u n u n 1 r n 2 known find u n 1 r n 2 m u δ t 2 k u u n 1 δ t 2 b 2 2 m u u n m u u n 1 4 3 numerical procedure algorithm the systems to be solved in 33 and 34 are at the heart of the numerical approximation of the continuous systems 12 13 and 14 18 this system is coupled because of the presence of the traction compression force f t r at each time step t n n δ t this force writes f t r t n x a e v x t n x using a centered discrete derivative of v 35 v x t n x k v t n x k h 2 v t n x k h 2 h where x k denotes the barycenter of the element mesh k finally to solve the algebraic systems 33 and 34 one needs first to solve the algebraic system 33 computes an approximation of the coupling term using 35 and then solve the algebraic system 34 until the convergence of procedure more precisely we developed a simple matlab procedure matlab ecl the full algorithm to get the approximation of the solution writes 4 3 1 algorithm 1 given physical and geometrical parameters 2 define the meshes for both variables v and u 3 initialization given v 0 v 1 u 0 and u 1 4 time iterations at each time step t n n δ t assemble the matrices m v k v b v solve the algebraic system 33 to get an approximation of v update the coupling force f t r t n using 35 assemble the matrices m u k u b u solve the algebraic system 34 to get an approximation of u calculate the relative errors 5 go to 4 if needed this calculation for the traction compression force f t r t n x is going to be employed in the simulation later in section 4 7 when compare the numerical results with those obtained in physical experiments 4 4 validation of the numerical scheme to validate the previous algorithm as well as the convergence of the iterative procedure we choose right hand sides functions p and q appearing in equations 12 and 14 respectively such that the corresponding exact solutions v and u are easy to obtain in our case these right hand sides p and q are given t x i t i l by p t x ρ x l 2 a e t 2 t x i t i l q t x ρ 12 e i x l 4 4 l 3 x t 2 a 6 i 4 x l 3 l 3 it is easy to verify that functions v and u given by 36 v t x t 2 2 x l 2 u t x t 2 24 e i x l 4 4 l 3 x are solutions of 11 and 13 respectively moreover they verify the boundary conditions 12 and 14 17 respectively note that for the previous choice of right hand sides p and q the functions g and h appearing in the boundary conditions 12 and 15 are respectively given by g t v t 0 l 2 2 t 2 h t u t 0 l 4 24 e i t 2 they indeed verify the compatibility conditions given in 19 moreover the coupling term f t r a e v x is given by f t r t x a e v x t x a e t 2 x l and verifies the following important properties 37 f t r t x 0 t x i t i l a n d f t r t l 0 having previously shown that the initial boundary value problems 11 12 and 13 16 admit one and only one solution our numerical procedure based on the previous algorithm must provide approximate solutions with small enough error let us consider the previous right hand sides p and q in the following the interval of study i l is assumed of given length l 1 575 the physical parameters are all set to 1 the spatial and temporal discretization parameters are given by n l 35 a n d δ t 0 01 the effectiveness of the numerical procedure is measured by the error of approximation in the case of an a priori known solution v u the upper part of fig 2 represents a comparison between the numerical solutions obtained with the procedure resulting from the new model developed above and the exact solutions given by 36 whereas the lower part represents the errors committed in approaching the exact solutions by the numerical solutions at the 95 th time step as shown in fig 2 the numerical solutions are very accurate up to 10 8 for the v component and 10 4 for the u component having successfully validated the numerical procedure on a test case where the solution is known we now test our numerical approach on the dynamic response of a vertical pipe 4 5 dynamic response of a vertical pipe in this section we study the dynamic behavior of a vertical riser in calm water tank the vertical pipe is assumed to be free at its lower end and subjected to a forced displacement at its upper part the imposed movements on the upper part intend to represent movements from the ship in the sea surface due to waves currents and wind experiments were carried out at the energy department of the faculty of mechanical engineering at the university of campinas furhter details of the experiments can be found in taha et al 2015 a small diameter pipe was developed as the physical model for the laboratory experiments the optical measurement system was used for capturing pipe movements in the tank the displacements along the length of the pipe are measured and the vibrations are analyzed the results obtained from the experiment allowed a better understanding of pipe behavior and better investigation of numerical simulation procedures using commercial software orcaflex orcina 2014 and the code developed according to our new model analyzed above 4 5 1 pipe model characteristics the pipe model is made by silicone with concentrated weight uniformly distributed along the length and it is internally water tight the external surface of the silicone tube is sufficiently smooth to neglect effect of roughness the length silicone made pipe model is l 1 575 m with external diameter d e 8 10 3 m and internal diameter d i 6 10 3 m and its mass in air per unit of length is m 2 45 10 2 kg m and the young modulus is e 2 3 10 6 pa each of the ten concentrated weights along the model has mass m w equal to 0 748 10 3 kg the time unit is the second the mean linear density of the pipe is given by ρ m l 10 m w l where the term 10 m w is due to the presence of ten small masses placed at each node as shown in fig 3 the physical parameters a and i are given by a π d e 2 d i 2 4 i π d e 4 d i 4 4 the discretization parameters are n l 16 h l n l 1 and δ t 0 01 s the boundary functions h and g that appear in 15 12 and 18 are given by h t 0 05 sin ω t ω 2 π 8 1 g t 0 we recall that g that appears in 12 for the first time is the vertical displacement imposed to the top extremity of the riser whereas h 15 is the horizontal displacement at the same point the vertical direction is the one pointing to the center of the earth equation 18 is a compatibility condition that h and g must satisfy the source terms p and q are given by p t x m g l x t x i t i l q t x 0 t x i t i l where g stands for the acceleration of gravity simulations have been done by using both the present procedure described above and orcaflex software that allow to model the pipe according to the lumped mass method fig 3 represents a scheme of the pipe model for simulation in the orcaflex software and one element of the model is highlighted due to the lumped mass method each element has its mass equally divided in their extremities each end node of the element is formed by half of the current element mass and half of the next mass element the connection between two adjacent elements is made by springs and shock absorbers whose function is to restrict transverse movements and rotations in shared node 4 6 comparison of the time domain responses matlab ecl vs orcaflex in this subsection we present a comparison of the results obtained by the present approach and those obtained by the orcaflex software we consider a force f t r that does not depend on time but only on the position more precisely the force f t r is 38 f t r t x ρ g l x t x i t i l forced sinusoidal oscillation in x direction with a period of 8 1 s has been considered numerical simulation using the present approach is compared to the results obtained by the orcaflex software the amplitudes of displacement have been normalized by the external diameter of the pipe fig 4 shows time series of the pipe response x horizontal direction at the node number 2 as we can see in this figure in the absence of the coupling term the results obtained by our approach are identical to those obtained by orcaflex software in fig 6 it is shown a comparison with experimental results see fig 5 4 7 comparison of the time domain responses matlab ecl vs experiment the results of our approach are also compared to those obtained by the experiments as we can see on fig 6 the results are quite close to the experiments however it can also be noted that we get a large difference for positions near the bottom end of the pipe this is essentially due to the fact that in our approach we have neglected the viscous damping effects on the other hand the curve on right part of the figure makes it possible to know throughout the length of the pipe what is the maximum and minimum value of the displacement clearly at least in the big part of the pipe the results obtained by our approach are very close to those obtained by the experiments once the curve is known for a set of combinations of situations and configurations it is very easy to dimension the beam 5 conclusion in this paper we rigorously analyzed a dynamical model for the transverse motion of a riser taking into account longitudinal forces that have origin not only in the self weight but also dynamic longitudinal forces in fact we proved the existence uniqueness and stability properties for the resulting system of coupled differential equations and we proposed a new way of approaching numerically the equations of motion the correctness of the proposed numerical method was verified against a closed form solution that satisfies the system of equations with initial and boundary conditions all this can be regarded as a first step towards a more comprehensive theoretical numerical model which would also include the effects of fluid viscosity fluid structure interactions hydrodynamic effects and currents induced vibrations in this work we also conducted experiments in a calm water tank which provided us with experimental data that were compared with our numerical simulation results and with those produced by a orcaflex orcina 2014 the comparison have shown very promising results concerning the evaluation of the dynamic behavior of a riser in water with our approach a straightforward extension of the proposed model can be derived for the three dimensional case we expect the material provided in this paper to be useful for engineers in the petroleum sector credit authorship contribution statement alexandre kawano conceptualization supervision writing original draft writing review editing abdelmalek zine conceptualization supervision software writing original draft writing review editing celso morooka conceptualization writing original draft writing review editing mohamed ichchou conceptualization writing original draft writing review editing declaration of competing interest the authors declare that they have no known compe5ng financial interests or personal rela5onships that could have appeared to influence the work reported in this paper acknowledgments the authors thank the support of fapesp proc 15 50461 0 also thanks to unicamp for the support through the french brazilian catedra program 
21061,in the present work numerical simulation of structural damage subjected to the near field underwater explosion is carried out by coupling the sph and rkpm the fluid solver is established based on the compressible sph method while the dynamic response of the structure is calculated based on the rkpm shell formulation since large deformation with contact will occur in the underwater explosion problem a contact detection algorithm for the rkpm shell formulation is proposed the contact force is calculated based on the volume strain the fluid structure interaction solver is established by adopting the normal flux method in which the structure is treated as a moving solid boundary for the fluid domain while the fluid pressure is considered as the load act on the structure surface thus the numerical model for the simulation of structural damage analysis in the underwater explosion is obtained which is a part of the fslab software developed by the fsi laboratory of harbin engineering university finally several numerical examples are studied to verify the robustness and accuracy of the present numerical model keywords fluid structure interaction meshfree methods underwater explosion structural damage contact algorithm 1 introduction the underwater explosion can produce an extreme shock wave after that a secondary pressure wave is generated by the pulsation of the blast gas this extreme load will cause significant damage to the shell structure leblanc and shukla 2010 zong et al 2013 zhang et al 2015 the prediction of the damage extent of the ship structure subjected to the underwater explosion load is of great concern to the engineers since it can guide the design of the ship s defensive structure the experimental study and numerical study are the two primary approaches adopted in the research in this field costanzo 2011 li and rong 2012 due to the extremely high cost of the experiment the numerical methods are increasingly applied to underwater explosion problems qiankun and gangyi 2011 zhang et al 2012 the structural damage in underwater explosion involves the strong nonlinear coupling of the gas liquid and solid in the simulation of multi phase flow the traditional mesh based methods need an additional algorithm to capture the multi phase interface such as volume fluid method and level set khalloufi et al 2016 karnakov et al 2020 on the contrary the meshfree sph smooth particle hydrodynamics method is based on the lagrangian description which can automatically track the material interface sun et al 2017 besides it can be applied in the simulation of large deformation problems since its spatial discretization does not rely on the mesh liu and liu 2003 the sph is firstly be applied in the simulation of the underwater explosion problems by liu et al 2003 after that zong et al 2013 simulate the shock wave and bubble dynamics by combining the sph method and bem boundary element method ming et al 2016 study the structural damage subjected to the contact underwater explosion by coupling the sph method and fem finite element method however there is a limitation when the sph method applied in the simulation of the underwater explosion that is the particle distribution will be very sparse as the blast gas expands rapidly which results in the difficulty of the simulation of bubble dynamics considering this we focus on the near field underwater explosion or contact underwater explosion problems in the present work since in these situations the influence of the bubble load is relatively small in the simulation of the dynamic response of the structure the fem is the most wildly used however when dealing with the large deformation problem it often suffered from the mesh distortion problem the meshfree methods do not rely on the mesh which made them get rid of this drawback caleyron et al 2012 moreover it can easily model the crack discontinuity just by changing the connection between particles which makes it very suitable for the simulation of crack propagation problems in present work the reproducing kernel particle method rkpm liu et al 1995 is adopted to calculate the structural response which has been widely applied in the simulation of crack propagation problems for instance li and simonsen 2005 proposed a 2d visibility criterion based on which the crack growth in the ductile material is simulated under the plane strain hypothesis ren and li 2012 developed a 3d visibility criterion for the crack propagation simulation in 3d thin shell structure in the above research the 3d continuum approach is adopted to model the shell which has difficulty in modeling the complex engineering shell structures to solve this problem the rkpm shell formulation for dynamic analysis is proposed by peng et al 2018 moreover recently peng et al 2020 proposed a 3d visibility criterion and the crack growth in both ductile and brittle material are studied this numerical model is adopted in the present work by coupling the sph method and rkpm a fully meshfree fsi solver is established since we only use one layer of particles to discretize the shell structures the interaction between the fluid and structure can not be modeled by the approaches presented in antoci et al 2007 or khayyer et al 2018 in their work the structure is modeled based on the continuum description therefore in the present work we adopt the normal flux method de leffe et al 2009 the fluid structure interface is regarded as a moving solid boundary for the fluid domain and the fluid pressure is treated as the surface load act on the shell meanwhile when large deformation occurs when structure subjected to the underwater explosion load the structural contact phenomenon will occur in the present study a contact detection algorithm for the rkpm shell is proposed based on the linked list search algorithm liu and liu 2003 and the contact force is calculated based on the volume strain finally several numerical examples are studied and the robustness and accuracy of the present numerical model are verified the paper is organized as follows in section 2 the fluid solver based on sph and structure solver based on rkpm is introduced besides a contact algorithm for rkpm shell formulation is proposed the fluid structure interaction solver by coupling the sph method and rkpm is presented in section 3 several numerical examples are studied in section 4 to verify the robustness and accuracy of the present numerical model lastly the conclusion of the present study is presented in section 5 2 numerial model in this section the numerical model for the tree dimensional fluid structure interaction based on sph and rkpm is presented 2 1 fluid solver based on sph the fluid pressure should be obtained fristly to calculate the load act on the structures for the underwater explosion problem the compressiblility of the fluid should be considered and the fluid viscosity can be ignored ming et al 2016 therefore the fluid dynamics is governed by the euler equations here the sph method is employed to solve the fluid variables and the governing equations can be descritized by the sph particle approximation as follows d ρ i d t ρ i j v j v i i w i j v j d v i d t 1 ρ i j p i p j i w i j v j α c 0 h ρ 0 ρ i j π i j i w i j v j 1 d e i d t p i ρ i j v j v i i w i j v j 1 2 α c 0 h ρ 0 ρ i j π i j i w i j v j v i v j where ρ v p and e are the fluid density velocity pressure and internal energy respectively v denotes the volume of sph particles c 0 is the initial velocity i denotes the gradient oprator w i j w x i x j h denotes the kernel function in which the smoothing length h determinates the size of the support domain in present study the improved gaussian kernel grenier et al 2009 is adopted and we set h 1 2 δ x where δ x denotes the local particle spacing the last term in the momentum and energy conservation equation are the diffusion term introduced by the artificial viscosity monaghan and gingold 1983 the coefficients α in those term control the magnitude of the diffusion term which ranges from 0 01 to 1 for different problems monaghan 1988 marrone 2012 in present work we set α 0 1 the term π i j in the diffusion terms are defined as follows 2 π i j v i v j x i x j x i j 2 0 01 h 2 v i j x i j 0 0 otherwise where v i j v i v j and x i j x i x j the above governing equation is enclosed with the equation of state eos that connect the fluid density and pressure in the simulation of underwater explosion problem we mainly consider two kinds of fluid water and tnt for water the mie gruneisen liu and liu 2003 equation of state is adopted to calculate the pressure when the water is in the compression state the pressure is obtained by the following expression 3 p ρ 0 c 0 2 λ 1 1 γ 0 2 λ a 2 λ 2 1 s 1 1 λ s 2 λ 2 1 λ s 3 λ 3 1 λ 2 2 γ 0 a λ e where λ ρ ρ 0 1 ρ 0 is the reference density c 0 is the coresponding sound speed γ 0 denotes the gruneisen coefficient a denotes the volume correction coefficient s 1 s 2 and s 3 are the fitting coefficients the value of the material parameters are summarized in table 1 otherwise when the water is in the expanded state the pressure is obtained by 4 p ρ 0 c 0 2 λ γ 0 a λ e for tnt the jones wilkins lee jwl liu and liu 2003 equation of state is adopted the pressure of the blast gas is given by 5 p a 1 ω η r 1 e r 1 η b 1 ω η r 2 e r 2 η ω η ρ 0 e where η ρ ρ 0 denote the ratio of the density of blast gas to the initial density of tnt a b r 1 r 2 and ω are the fitting coefficients the material parameters are listed in table 2 in which e 0 denotes the initial energy of per unit mass in the simulation the donation of the explosive is implemented by change the eos p p 0 to jwl eos when x x 0 d v t where d v is the detonation velocity t denotes the simulation time finally we use the leap frog scheme liu and liu 2003 to update the fluid variables and the time increment limited by 6 δ t 0 2 min h min c 0 v max h min v max in the simulation of underwater explosion the particle spacing changes voilently the following equation is adopted to update the smoothing length 7 h i n 1 h i n 1 d h i n ρ i n d ρ i n d t δ t where d is the spatial dimension of the problem h i n and ρ i n are the smoothing length and density of particle i at n th time step respectively 2 2 three dimensional shell model based on rkpm when the ship structures subjected to the near field underwater explosion load large deformation or even fracture will occur since the meshfree methods have advantages in dealing with the crack propagation problems the meshfree rkpm is employed in this paper to solve the dynamic response of the structures 2 2 1 governing equation for the rkpm shell in present work the ship structure is treated as the stiffened shell structures using the principle of virtual power the galerkin weak formulation of the governing equation peng et al 2018 can be expressed as 8 ω 0 ρ 0 v δ v d ω 0 ω 0 ρ 0 b δ v d ω 0 γ 0 t t 0 δ v d γ 0 t ω 0 p δ v x d ω 0 0 where ρ 0 is the initial density of the structure b denotes the body force p is the first piola kirchhoff stress t is the traction force act on the traction boundary γ 0 t v is the velocity of an abitrary point in the shell which can be approxiamted by the nodal velocity and angular velocity 9 v ξ η ζ i n i v i t h 2 n i ω i y i where t h denotes the thickness of the shell n i is the rkpm shape function n i ζ n i ω and y are the angluar velocity and fiber vector respectively the virtual velocity δ v has the same structure with the velocity field by substituting the discretized expressions of the velocity and virtual velocity into the governing equation we can be finally obtian the following govening equations 10 m i u i f i ext f i int 11 j i ω i m i ext m i int where the subscript ext and int denote the external and internal forces f or moment m respectively m i and j i is lumped mass and interia of particle i for the detail expression of each term in the above governing equations readers may refer to peng et al 2018 2 2 2 the constitutive model for ductile material since steel is often used in the ship structures here the constitutive model for the ductile material is presented firstly the trial kirchhoff stress in n 1 time step is obtained by using the hughes winget method hughes and winget 1980 which is expressed as follows 12 τ n 1 t r i a l q n 1 τ n q n 1 t τ n 1 j δ t where τ represents the effective stress q n 1 i 3 1 2 w n 1 1 i 3 1 2 w n 1 in which w is the skew symmetric parts of the spatial velocity gradient v x and i 3 is the rank 3 identity matrix τ n 1 j c e l j d n 1 e denotes the zaremba jaumann rate of kirchhoff stress belytschko et al 2013 at the n 1 time step d e denotes the elastic part of the rate of deformation tensor and for shell element we have 13 c e l j i j k l e ν 1 ν 2 δ i j δ k l g δ i k δ j l δ i l δ j k where e is the young s modulus g is the shear modulus and ν denotes the poisson s ratio once the trial stress is obtained the von mises yield function is calculated 14 φ n 1 t r i a l φ τ n 1 t r i a l p n s τ e q κ p n s 3 2 ξ n 1 t r i a l ξ n 1 t r i a l κ p n s where ξ n 1 t r i a l is the stress deviator tensor and κ p n s denotes the yield stress p n s is the accumulate plastic strain at n time step if φ n 1 t r i a l 0 the material is not yield then we set n 1 1 d n n 1 t r i a l d n is the damage variable at n time step otherwise the material is in the plastic loading state then the stress tensor should be returned on the yield surface 15 τ n 1 k τ n 1 t r i a l 2 g d e q p n 1 k n n 1 t r i a l δ t where d e q p γ 1 d in which γ denotes the plastic multiplier n 3 ξ 2 τ e q remain unchange in the plastic iteration process then the yield function in the k th iteration can be obtained φ n 1 k φ τ n 1 k p n 1 s k in which p n 1 s k p n s γ n 1 k δ t 1 d n 1 k 1 thus we can use the lemaitre model lemaitre 1985 to update the damage variable d n 1 k as follows 16 d n 1 k d n d c ε p r ε p d 2 3 1 ν 3 1 2 ν τ m 2 τ e q 2 n 1 k δ p n 1 s k f d p n s 0 d n otherwise where d c is the critical damage and ε p r is the rupture equivalent plastic strain ε p d denotes the threshold equivalent plastic strain in which f d p n s denotes the damage criterion and 17 f d p n s 2 3 1 ν 3 1 2 ν τ m τ e q 2 p n s ε p d to return the stress state to the yield surface we need to find the stress state that holds φ n 1 k 0 in which the only unknown variable is the plastic multiplier γ thus we can use the newton iteration to update the plastic multiplier 18 γ n 1 k 1 γ n 1 k φ γ φ n 1 k when we obtain the value of γ n 1 k 1 then we can update the yield function φ n 1 k and the iteration is terminated when φ n 1 k 10 2 the first piola kirchhoff stress in the governing euqations is calculated by p f 1 τ and which will be transform into the global coordinate system peng et al 2018 in the present study we assume that the crack tip must be the stress points that completely damaged and the crack path is represented by the piecewise line that connects those crack tips for the detail of the crack initiation and propagation algorithm readers may refer to our previous study peng et al 2020 2 3 contact algorithm for rkpm shell when ship structure subjected to the near field underwater explosion large deformation will occur which will lead the shell structure contact with each other the contact algorithm for the shell should be established to simulate the contact between the shell structures firstly we develop a contact detection algorithm to determinate if the shell contact to other shell or not we consider that i and j is contacted if the relative position between stress point i and node j satisfy the following relation 19 d n x j i e 3 l i t h 20 x j i e 1 l i 2 x j i e 2 l i 2 χ h where x j i x j x i e i l i i 1 2 3 are the three basic vectors of the local coordinate system at stress point i and t h denotes the thickness of the shell as shown in fig 1 a h denotes the smoothing length χ is a constant and we set χ 0 75 to implement the above criterion we need to search the node near each stress point here the linked list search scheme liu and liu 2003 is adopted to accelerate the contact detection algorithm moreover we should avoid the contact between the stress point and its nearest four nodes that form an integration cell as shown in fig 1 b the stress point relative position between stress point i and node j 1 j 4 can satisfy the above contact detection criterion but they are not in contact when node j is contact with stress point i the contact force should be applied to prevent the shell from nonphysical penetration and the friction force between the shell should be considered firstly the volume strain is calculated based on the penetration distance and then the normal contact force is obtained by multiplying the strain with the bulk modulus and the area of the stress point benson and hallquist 1990 finally we have 21 f j i n k s k t h d n t h s i where k s is a scaling coefficient here k s 0 1 is taken k is the bulk modulus s i denotes the area of the stress point i in the shell reference surface for the friction force the direction of the force is calculated by 22 t j i v j i v n e 3 l i v j i v n e 3 l i where v n v j i e 3 l i is the relative velcotiy between i and j in the normal direction in which v j i v j v i the magnitude of the friction force is obtained by 23 f j i t 1 μ f n 24 f j i t 2 k s k v j i v n e 3 l i δ t d n s where μ denotes the friction coefficient finally the contact force act on node j by stress point i is 25 f j i min f j i t 1 f j i t 2 t j i f n sign x j i 0 e 3 l i e 3 l i where x j i 0 denotes the relative position vector when node j and stress point i begin to contact and sign x j i 0 e 3 l i is defined as 26 sign x j i 0 e 3 l i 1 x j i 0 e 3 l i 0 1 x j i 0 e 3 l i 0 note that in the above equation x j i 0 should be recorded when the stress point i and node j begin to contact if x j i 0 is replaced by the current relative position between i and j which will result in the wrong direction of the normal contact force if the shell penetrates each other as shown in fig 2 when the node j is in contact with more than one stress point the contact force for node j is the average value of the force of all contact pairs 3 fluid structure interaction model to consider the fluid structure interaction the so called normal flux method de leffe et al 2009 is adopted thus when the support domain of the fluid particle i is truncated by the fsi interface as shown in fig 3 the surface integration in the sph gradient approximation is considered 27 f x ω f ω f x w x x d v γ f x w x x n d s ω f f x w x x d v where denotes the gradient operator at x therefore the sph particle approximation for the gradient of a function f x is expressed as 28 f x i k f x k w x k x i n k s k j f x j i w x j x i v j where j denotes the fluid particle in the support domain of i k denotes the stress points on the fsi interface s k is the area of the stress point and n k denotes the normal of the fsi interface that outward the fluid domain specifically when we calculated the velocity divergence and pressure gradient in the fluid governing equation 1 the surface integration should be considered and we have 29 v i k v i k n k w i k s k j v i j i w i j v j 30 p i k p i k n k w i k s k j p i j i w i j v j where v i k v k v i and p i k p i p k 2 in which p k is the pressure act on the stress point k of the shell and can be expressed as follows 31 p k 1 γ k i p i ρ i c i v i k e 3 l k w i k v i γ k i w i k v i where p i denotes the pressure of fluid particle i that near the fsi interface by substituting the above velocity divergence and pressure gradient into eq 2 1 finally the fluid governing equation including fluid structure interaction is obtained we have 32 d ρ i d t ρ i k v i k w i k n k s k j v i j i w i j v j d v i d t 1 ρ i k p i k w i k n k s k j p i j i w i j v j α c 0 h ρ 0 ρ i j π i j i w i j v j d e i d t p i ρ i k v i k w i k n k s k j v i j i w i j v j 1 2 α c 0 h ρ 0 ρ i j π i j v j v i i φ i j v j the surface integration term in the above momentum equation provides a repulsive force to the fluid particle i which will prevent the fluid particle from penetrating the fsi interface for the structure the fluid influence is considered as a pressure load that acts on the interface therefore the traction force on stress point k can be expressed as t k 0 p k e 3 l k where p k is calculated by eq 31 finally the external force in the rkpm shell governing equation 10 is calculated by 34 f i e x t γ p e 3 l n i d s in the above expression i denotes the rkpm shell node k denotes the stress points n i is the rkpm shape function the above integration is calculated by the so called stress point integration then we have 35 f i e x t k p k e 3 l k n i k s k the external moment caused by fluid pressure is ignored peng et al 2018 to illustrate the numerical implementation process of the present fluid structure interaction solver and facilitate the reproduction of the present numerical model the flow chart of the fluid structure interaction program is presented in fig 4 4 numerical examples in this part several numerical examples are studied to verify the robustness and accuracy of the presented numerical model in all the simulation three integration point is employed in the shell thickness direction one stress point in each integration cell and the bilinear shape function are adopted peng et al 2018 since the shape function s order is higher than the integration order it can be treated as the so called reduced integration and the shear locking problem is eliminated meanwhile according to the study by belytschko et al 2000 the adoption of the stress points integration can allow us to get rid of the rank deficiency problem in meshfree methods 4 1 the pinched cylindrical shell under a concentrated force firstly the elastic plastic response of a cylindrical shell under concentrated force extrusion is simulated the two ends of the cylindrical shell are simply supported that is the radial displacement is set to zero but the axial direction can move freely the dimensions of the shell and material parameters are summarized in fig 5 the material damage is ignored and the linear hardening model is employed the hardening modulus is set to e p 3 0 10 8 pa uniform particle spacing is adopted the total number of particles is 5084 the time increment is set as 5 10 6 s rkpm is used to simulate the shell deformation with and without contact and the same problems are also calculated by fem abaqus the displacement history of the loaded point calculated by rkpm is plotted in fig 6 in which the fem result is chosen as reference we can see from the figure that the results obtain by rkpm and fem are in good agreement whether self contact is considered or not moreover if the self contact is taken into account the loaded point s displacement will not exceed 0 3 m equal to the cylinder radius since the shells can not penetrate each other the effectiveness of the present contact algorithm is verified the final deformed configuration of the cylinder shell obtained by rkpm and fem is presented in fig 7 in which the contours of displacement is plotted from the figure we can see that when contact is ignored the shell penetrates each other in contrast the load point can not penetrate each other when self contact is considered moreover the deformed shape of the cylinder shell obtained by rkpm and fem are in good agreement although the deformation is considerable the particle distribution is regular with no instability observed 4 2 dynamic bulking of a square tube in this section the dynamic bulking of a square tube is simulated the large plastic deformation and self contact phenomenons are involved in this numerical example which is a suitable case to test the robustness of the numerical method the dimensions of the geometry and the material parameters is summarized in fig 8 in the simulation the bottom edge of the tube is fixed and a initial velocity is given to the upper bound of the tube meanwhile at 0 0675 m away from the bottom edge a 0 05 mm initial displacement disturbance along the shell normal direction is exerted to simulate the structural defect and trigger the buckling we ignore the material damage and the linear hardening model is adopted the hardening modulus is set as 1 gpa considering the symmetry of the geometry only one quarter of the geometry is modeled uniform particle spacing is adopted the total number of particle is 2700 the fixed time increment is set as δ t 2 0 10 7 s the deformed configuration of the square tube at several typical time is shown in fig 9 in which the contours of the equivalent plastic strain is plotted from the figure we can see that when the simulation begins the large horizontal displacement of the square tube occurs near the section where the small disturbance is applied this initial horizontal displacement triggers the dynamic buckling and the bearing capacity of the square tube decreases rapidly after that under the velocity impact the square tube continues to deform wrinkle and collide in the simulation the shell surfaces is contact with each other in the wrinkle regions and no penetration is taken place which verifies the effectiveness of the present contact algorithm for rkpm shell meanwhile large plastic deformation occurs in the wrinkle regions the results shows that the particle distribution is very regular and no instability is observed the robustness of rkpm shell in large deformation contact problem is verified 4 3 three point bending of an aluminum hat profile the three point bending of an aluminum hat profile is simulated in this section to verify the effectiveness and accuracy of the present contact algorithm this problem comes from the experimental study by chen 2001 the dimensions of the calculation model are presented in fig 10 in calculation the bottom of the aluminum profile is supported by two cylinders and the top of the aluminum profile is extruded a punch the punch s downward velocity is linearly accelerated to 1 m s within 0 005s and then remains unchanged besides in the simulation the cylinder supports the punch and aluminum profile are modeled by rkpm shell element and all shell thickness except the bottom of the profile shown in fig 10 are set as t h 0 002 m the cylinder supports and punch are treated as a rigid body only the deformation of the aluminum profile is considered the aluminum density is ρ 2700 kg m 3 young s modulus is set as e 7 0 10 10 pa poisson s ratio is set as ν 0 33 the linear hardening model is adopted to model the plastic response of the hat profile and the initial yield stress is κ 0 108 mpa the hardening modulus is set as e p 560 mpa the ultimate strength is σ u 237 mpa in the simulation the material damage is not considered uniform particle spacing with δ x 0 004 m is adopted and the total number of the aluminum profile is 10 478 fixed time increment δ t 5 10 7 s is applied the deformed configuration of the aluminum profile at several typical times is presented in fig 11 from the figure we can see that depression in the middle of the top of the profile when the simulation begins with the increase of the punch displacement the corner of the profile is wrinkled and buckled meanwhile the particle distribution during the whole loading process is very regular and no instability is observed in fig 12 the force displacement curve of the punch is presented in which the experimental result and fem result chen 2001 are chosen as reference from the figure we can see that the reaction force act on the punch increases to the maximum value quickly with the increase of the punch displacement at the beginning of the simulation then the corner of the aluminum profile is buckled and the bearing capacity of the profile decreases which results in the decline of the reaction force act on the punch the result obtained by rkpm is in good agreement with the experimental data however in the experiment study the downward velocity of the punch is 0 2 mm s in the present study the velocity is set as 1 m s to accelerate the numerical simulation therefore the oscillation of the force act on punch obtained by rkpm is relatively larger finally the deformation configuration at the end of the simulation is presented in fig 13 the rkpm result is compared with the experimental result chen 2001 it can be seen that the deformation shape calculated by rkpm is in good agreement with the experimental results which verifies the accuracy and effectiveness of the present rkpm contact algorithm 4 4 large deformation of plate subjected to the underwater explosion in this section large deformation of a plate that subjected to near field underwater explosion load is studied based on sph rkpm this numerical example is taken from the experimental study of ramajeyathilagam and vendhan 2004 the problem description and material parameters are summarized in fig 14 a 0 3m 0 25 m plate is placed in the center of the fluid free surface and the plate thickness is 0 002 m in calculation 0 0234 kg tnt is placed at 0 15 m below the center of the plate the jwl equation of state is adopted and the corresponding paramters is summarized in table 2 for the water mie gruneisen equation of state is adopted the corresponding paramter is summarized in table 1 the plate is made by commercial mild steel the initial yield stress is σ y 0 300 mpa the linear hardening model is adopted the hardening modulus is set as e p 250 mpa the damage evolution of the plate is control by eq 16 and the corresponding parameters are set as ε p d 0 32 ε p r 0 36 d c 0 21 the cowper symonds model hernandez et al 2013 is employed to model the strain rate effect we have 36 κ p s 1 ε e q p c 1 n κ p s where κ p s denotes the yield stress when strain rate effect is not considered for mild steel we set c 40 and n 5 in the simulation the fixed time increment δ t 3 10 7 s is taken in fig 15 the deformation of the plate and the pressure field of the fluid domain when t 96 ms are shown the final deformation of the plate obtained by sph rkpm is compared with the experimental result ramajeyathilagam and vendhan 2004 in fig 16 in which the contours of displacement is plotted from the comparison we can see that subjected to the near field underwater explosion load the plate has undergone large deformation and the deformed shape of the plate obtained by sph rkpm matches well with the experimental result meanwhile on the right side of fig 16 the influence of the strain rate effect is presented from this it can be seen that when the strain rate effect is ignored the deformation will increase significantly which indicates that the strain rate effect can not be ignored in the strong impact problems the time history of the plate center s deflection is plotted in fig 17 we can see from the figure that the plate s deflection will not continue to increase and the residual deformation occurs meanwhile the deflection will increase considerably if the strain rate effect is not considered finally the deflection of the point on the two symmetry axes of the plate is shown in fig 18 in which the result obtained by sph rkpm is compared with the experimental results and the numerical results obtained by ls dyna ramajeyathilagam and vendhan 2004 from the comparison we can see that the present numerical result agrees well with the reference results the accuracy of the current fsi model in dealing with structural damage loaded by the underwater explosion is verified 4 5 circular plate subjected to contact underwater explosion the fracture of a circular plate subjected to contact underwater explosion is studied in this section this numerical example is taken from the experimental study by rajendran and narasimhan 2001 the dimension of the problem and the material parameters are presented in fig 19 the radius of the plate is 0 145 m and the thickness is 0 004 m in the simulation the plate with the radius equal to 0 2 m is modeled and then the particles outside 0 145 m away from the center are clamped as shown in fig 19 the total particle number of the plate is 8151 for the fluid domain the particle spacing for water is 0 004 m while for tnt is 0 002 m and the total particle number of fluid is 394 476 in the experimental study 19 g pek 1 explosives is adopted therefore in the calculation we place 22 3 g tnt right below the center of the circular plate the plate is made by low alloy high strength steel the material paramter in the damage model is chosen as ε p d 0 2 ε p r 0 28 and d c 0 32 the strain rate effect is control by the cowper symonds model in which the material constant is set as c 40 n 5 the fixed time increment is adopted which is set as δ t 5 10 8 s when the shock wave propagates to the clamped boundary at t 65 μ s the pressure field of the fluid domain and the stress field of the plate are presented in fig 20 from which we can see that the blast gas expands rapidly as soon as the explosive is detonated and then the center of the plate is jacked up which results in great local deformation the equivalent stress of the center of the plate is considerable and several particles are damaged completely the initial crack path is formed the deformation configurations of the circular plate when t 0 1 ms 0 2 ms 0 4 ms 0 6 ms 0 8 ms and 1 0 ms are given in fig 21 in which the contours of the mises equivalent stress is plotted besides in this figure the blast gas is denoted by the gray particles from this figure we can see that the petal shaped crack path of the plate is formed when the center of the plate subjected to the initial blast shock wave after that the shock wave propagates outward and the blast gas continues to expand which leads to the crack path propagates along with the initial crack path direction the final fracture configuration of the circular plate calculated by the sph rkpm is compared with the experimental result rajendran and narasimhan 2001 in which the influence of the strain rate effect is given meanwhile the contours of the mises equivalent stress is plotted in the deformed configuration obtained by sph rkpm from the comparison we can see that the numerical result agrees well with the experimental result to some extent however due to the uncertainty in the experiment the crack path in the experimental study is not symmetry the radius of the crack path half of the maximum distance between the crack tip measured in the experiment is 0 12 m using the same standard the crack radius obtained by sph rkpm is 0 106 m the error between the numerical and experimental results is less than 12 the accuracy of the present numerical mothod is verified meanwhile from numeircal results presented in fig 22 we can see that without considering the strain rate effect the plate cracks into more petals which indicates that the strain rate effect can greatly reinforce the material in the strong impact problems the difference between the numerical and experimental results may be caused by the simplification of the material model or the decrease of the accuracy in the later stage of the simulation in fig 23 the particle distribution of the blast gas at t 1 ms is presented from which we can see that due to the lagiangain property of the sph method the particle spacing of the blast gas is quite large which will increase the error of the calculated pressure load this problem needs to be further studied in future work 4 6 ship hull subjected to contact underwater explosion load in this section the damage of a ship hull subjected to near field underwater explosion load is studied this numerical example is taken from the experimental study by zhu et al 2004 the geometric dimensions of the ship hull are shown in fig 24 there are two kinds of material is adopted in the ship hull for the defensive longitudinal bulkhead and the deck the low alloy steel is adopted and the other part of the ship hull is made by the normal carbon constructional steel the material parameters for these two kinds of steel can be found in peng et al 2019 the material damage evolution is controlled by eq 16 for the normal steel we set ε p d 0 20 ε p r 0 28 and d c 0 3 and for the low alloy steel we set ε p d 0 20 ε p r 0 28 and d c 0 4 the average particle spacing for the structure and water is set as 0 01 m to ensure the particle spacing of the blast gas not too large after expansion the initial particle spacing for tnt is set as 0 005 m the total number of particles for structure and fluid are 101 987 and 923 970 in the longitudinal direction the tnt is located in the middle of the ship hull and in the cross section its location is shown in fig 24 a the fixed time increment is adopted which is set as δ t 4 10 7 s in fig 25 the pressure field of the fluid and the deformed configuration of the ship hull at t 0 1 ms is presented the contours of the accumulated plastic strain are plotted on the deformation configuration of the structure it can be seen from the figure that after the tnt is detonated the blast gas expands rapidly meanwhile the ship hull plate is sunken under the strong shock wave besides the plastic strain of the structure particle reaches the rupture equivalent plastic strain which indicates that the initial crack is formed after that the blast gas and the fragments of the ship hull move to collide the water filled cabin the final deformed configuration of the ship hull obtained by sph rkpm is compared with the experimental result in fig 26 from which we can see that the concave shape calculated by sph rkpm is in good agreement with the experimental result the dimensions of the crack hole obtained by sph rkpm are compared with the experimental results in table 3 the area of the crack hole is in good agreement with the experimental results but the crack hole shape has a slight difference in fig 27 the deformation configurations of the ship hull at several typical time is presented from which we can see that there are cracks on the hull plate the front and back bulkheads of the water cabin the defensive lognitudinal bulkhead has large deformation but not cracked moreover the ship bottom and deck are warped which is consistent with the deformation characteristics in the experiment study zhu et al 2004 the effectiveness and applicability of the present numerical method in the simulation of complex ship structures subjected to underwater explosion are verified 5 conclusions in present work the numerical model for the simulation of structural damage subjected to near field underwater explosion based on sph and rkpm is proposed the normal flux method is adopted to establish the fluid structure interaction solver the structure is treated as the moving solid boundary for the fluid and the fluid pressure is considered the surface load act on the shell surface since the shell structures will contact each other when large deformation occurs in the underwater explosion problem the contact detection algorithm for the rkpm shell is presented meanwhile the contact force formulation is obtained based on the volume strain firstly several large deformation problems with contact are studied the effectiveness and accuracy of the present contact algorithm for the rkpm shell are verified besides the numerical result indicates that the rkpm shell formulation is very robust in dealing with large deformation problems then the damage and fracture of the structure subjected to the near field underwater explosion are studied the numerical results agree well with the experimental results which verify the accuracy and effectiveness of the sph rkpm fsi solver applied in the underwater explosion problem the present numerical model is a part of the fslab software developed by the fsi laboratory of harbin engineering university which lays a foundation for the design of the ship s defensive structure credit authorship contribution statement yu xiang peng methodology coding writing a man zhang supervision fu ren ming writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors thank the national science foundation for distinguished young scholars of china 51925904 the national natural science foundation of china 51909042 52088102 and china postdoctoral science foundation 2020m670888 for their support 
21061,in the present work numerical simulation of structural damage subjected to the near field underwater explosion is carried out by coupling the sph and rkpm the fluid solver is established based on the compressible sph method while the dynamic response of the structure is calculated based on the rkpm shell formulation since large deformation with contact will occur in the underwater explosion problem a contact detection algorithm for the rkpm shell formulation is proposed the contact force is calculated based on the volume strain the fluid structure interaction solver is established by adopting the normal flux method in which the structure is treated as a moving solid boundary for the fluid domain while the fluid pressure is considered as the load act on the structure surface thus the numerical model for the simulation of structural damage analysis in the underwater explosion is obtained which is a part of the fslab software developed by the fsi laboratory of harbin engineering university finally several numerical examples are studied to verify the robustness and accuracy of the present numerical model keywords fluid structure interaction meshfree methods underwater explosion structural damage contact algorithm 1 introduction the underwater explosion can produce an extreme shock wave after that a secondary pressure wave is generated by the pulsation of the blast gas this extreme load will cause significant damage to the shell structure leblanc and shukla 2010 zong et al 2013 zhang et al 2015 the prediction of the damage extent of the ship structure subjected to the underwater explosion load is of great concern to the engineers since it can guide the design of the ship s defensive structure the experimental study and numerical study are the two primary approaches adopted in the research in this field costanzo 2011 li and rong 2012 due to the extremely high cost of the experiment the numerical methods are increasingly applied to underwater explosion problems qiankun and gangyi 2011 zhang et al 2012 the structural damage in underwater explosion involves the strong nonlinear coupling of the gas liquid and solid in the simulation of multi phase flow the traditional mesh based methods need an additional algorithm to capture the multi phase interface such as volume fluid method and level set khalloufi et al 2016 karnakov et al 2020 on the contrary the meshfree sph smooth particle hydrodynamics method is based on the lagrangian description which can automatically track the material interface sun et al 2017 besides it can be applied in the simulation of large deformation problems since its spatial discretization does not rely on the mesh liu and liu 2003 the sph is firstly be applied in the simulation of the underwater explosion problems by liu et al 2003 after that zong et al 2013 simulate the shock wave and bubble dynamics by combining the sph method and bem boundary element method ming et al 2016 study the structural damage subjected to the contact underwater explosion by coupling the sph method and fem finite element method however there is a limitation when the sph method applied in the simulation of the underwater explosion that is the particle distribution will be very sparse as the blast gas expands rapidly which results in the difficulty of the simulation of bubble dynamics considering this we focus on the near field underwater explosion or contact underwater explosion problems in the present work since in these situations the influence of the bubble load is relatively small in the simulation of the dynamic response of the structure the fem is the most wildly used however when dealing with the large deformation problem it often suffered from the mesh distortion problem the meshfree methods do not rely on the mesh which made them get rid of this drawback caleyron et al 2012 moreover it can easily model the crack discontinuity just by changing the connection between particles which makes it very suitable for the simulation of crack propagation problems in present work the reproducing kernel particle method rkpm liu et al 1995 is adopted to calculate the structural response which has been widely applied in the simulation of crack propagation problems for instance li and simonsen 2005 proposed a 2d visibility criterion based on which the crack growth in the ductile material is simulated under the plane strain hypothesis ren and li 2012 developed a 3d visibility criterion for the crack propagation simulation in 3d thin shell structure in the above research the 3d continuum approach is adopted to model the shell which has difficulty in modeling the complex engineering shell structures to solve this problem the rkpm shell formulation for dynamic analysis is proposed by peng et al 2018 moreover recently peng et al 2020 proposed a 3d visibility criterion and the crack growth in both ductile and brittle material are studied this numerical model is adopted in the present work by coupling the sph method and rkpm a fully meshfree fsi solver is established since we only use one layer of particles to discretize the shell structures the interaction between the fluid and structure can not be modeled by the approaches presented in antoci et al 2007 or khayyer et al 2018 in their work the structure is modeled based on the continuum description therefore in the present work we adopt the normal flux method de leffe et al 2009 the fluid structure interface is regarded as a moving solid boundary for the fluid domain and the fluid pressure is treated as the surface load act on the shell meanwhile when large deformation occurs when structure subjected to the underwater explosion load the structural contact phenomenon will occur in the present study a contact detection algorithm for the rkpm shell is proposed based on the linked list search algorithm liu and liu 2003 and the contact force is calculated based on the volume strain finally several numerical examples are studied and the robustness and accuracy of the present numerical model are verified the paper is organized as follows in section 2 the fluid solver based on sph and structure solver based on rkpm is introduced besides a contact algorithm for rkpm shell formulation is proposed the fluid structure interaction solver by coupling the sph method and rkpm is presented in section 3 several numerical examples are studied in section 4 to verify the robustness and accuracy of the present numerical model lastly the conclusion of the present study is presented in section 5 2 numerial model in this section the numerical model for the tree dimensional fluid structure interaction based on sph and rkpm is presented 2 1 fluid solver based on sph the fluid pressure should be obtained fristly to calculate the load act on the structures for the underwater explosion problem the compressiblility of the fluid should be considered and the fluid viscosity can be ignored ming et al 2016 therefore the fluid dynamics is governed by the euler equations here the sph method is employed to solve the fluid variables and the governing equations can be descritized by the sph particle approximation as follows d ρ i d t ρ i j v j v i i w i j v j d v i d t 1 ρ i j p i p j i w i j v j α c 0 h ρ 0 ρ i j π i j i w i j v j 1 d e i d t p i ρ i j v j v i i w i j v j 1 2 α c 0 h ρ 0 ρ i j π i j i w i j v j v i v j where ρ v p and e are the fluid density velocity pressure and internal energy respectively v denotes the volume of sph particles c 0 is the initial velocity i denotes the gradient oprator w i j w x i x j h denotes the kernel function in which the smoothing length h determinates the size of the support domain in present study the improved gaussian kernel grenier et al 2009 is adopted and we set h 1 2 δ x where δ x denotes the local particle spacing the last term in the momentum and energy conservation equation are the diffusion term introduced by the artificial viscosity monaghan and gingold 1983 the coefficients α in those term control the magnitude of the diffusion term which ranges from 0 01 to 1 for different problems monaghan 1988 marrone 2012 in present work we set α 0 1 the term π i j in the diffusion terms are defined as follows 2 π i j v i v j x i x j x i j 2 0 01 h 2 v i j x i j 0 0 otherwise where v i j v i v j and x i j x i x j the above governing equation is enclosed with the equation of state eos that connect the fluid density and pressure in the simulation of underwater explosion problem we mainly consider two kinds of fluid water and tnt for water the mie gruneisen liu and liu 2003 equation of state is adopted to calculate the pressure when the water is in the compression state the pressure is obtained by the following expression 3 p ρ 0 c 0 2 λ 1 1 γ 0 2 λ a 2 λ 2 1 s 1 1 λ s 2 λ 2 1 λ s 3 λ 3 1 λ 2 2 γ 0 a λ e where λ ρ ρ 0 1 ρ 0 is the reference density c 0 is the coresponding sound speed γ 0 denotes the gruneisen coefficient a denotes the volume correction coefficient s 1 s 2 and s 3 are the fitting coefficients the value of the material parameters are summarized in table 1 otherwise when the water is in the expanded state the pressure is obtained by 4 p ρ 0 c 0 2 λ γ 0 a λ e for tnt the jones wilkins lee jwl liu and liu 2003 equation of state is adopted the pressure of the blast gas is given by 5 p a 1 ω η r 1 e r 1 η b 1 ω η r 2 e r 2 η ω η ρ 0 e where η ρ ρ 0 denote the ratio of the density of blast gas to the initial density of tnt a b r 1 r 2 and ω are the fitting coefficients the material parameters are listed in table 2 in which e 0 denotes the initial energy of per unit mass in the simulation the donation of the explosive is implemented by change the eos p p 0 to jwl eos when x x 0 d v t where d v is the detonation velocity t denotes the simulation time finally we use the leap frog scheme liu and liu 2003 to update the fluid variables and the time increment limited by 6 δ t 0 2 min h min c 0 v max h min v max in the simulation of underwater explosion the particle spacing changes voilently the following equation is adopted to update the smoothing length 7 h i n 1 h i n 1 d h i n ρ i n d ρ i n d t δ t where d is the spatial dimension of the problem h i n and ρ i n are the smoothing length and density of particle i at n th time step respectively 2 2 three dimensional shell model based on rkpm when the ship structures subjected to the near field underwater explosion load large deformation or even fracture will occur since the meshfree methods have advantages in dealing with the crack propagation problems the meshfree rkpm is employed in this paper to solve the dynamic response of the structures 2 2 1 governing equation for the rkpm shell in present work the ship structure is treated as the stiffened shell structures using the principle of virtual power the galerkin weak formulation of the governing equation peng et al 2018 can be expressed as 8 ω 0 ρ 0 v δ v d ω 0 ω 0 ρ 0 b δ v d ω 0 γ 0 t t 0 δ v d γ 0 t ω 0 p δ v x d ω 0 0 where ρ 0 is the initial density of the structure b denotes the body force p is the first piola kirchhoff stress t is the traction force act on the traction boundary γ 0 t v is the velocity of an abitrary point in the shell which can be approxiamted by the nodal velocity and angular velocity 9 v ξ η ζ i n i v i t h 2 n i ω i y i where t h denotes the thickness of the shell n i is the rkpm shape function n i ζ n i ω and y are the angluar velocity and fiber vector respectively the virtual velocity δ v has the same structure with the velocity field by substituting the discretized expressions of the velocity and virtual velocity into the governing equation we can be finally obtian the following govening equations 10 m i u i f i ext f i int 11 j i ω i m i ext m i int where the subscript ext and int denote the external and internal forces f or moment m respectively m i and j i is lumped mass and interia of particle i for the detail expression of each term in the above governing equations readers may refer to peng et al 2018 2 2 2 the constitutive model for ductile material since steel is often used in the ship structures here the constitutive model for the ductile material is presented firstly the trial kirchhoff stress in n 1 time step is obtained by using the hughes winget method hughes and winget 1980 which is expressed as follows 12 τ n 1 t r i a l q n 1 τ n q n 1 t τ n 1 j δ t where τ represents the effective stress q n 1 i 3 1 2 w n 1 1 i 3 1 2 w n 1 in which w is the skew symmetric parts of the spatial velocity gradient v x and i 3 is the rank 3 identity matrix τ n 1 j c e l j d n 1 e denotes the zaremba jaumann rate of kirchhoff stress belytschko et al 2013 at the n 1 time step d e denotes the elastic part of the rate of deformation tensor and for shell element we have 13 c e l j i j k l e ν 1 ν 2 δ i j δ k l g δ i k δ j l δ i l δ j k where e is the young s modulus g is the shear modulus and ν denotes the poisson s ratio once the trial stress is obtained the von mises yield function is calculated 14 φ n 1 t r i a l φ τ n 1 t r i a l p n s τ e q κ p n s 3 2 ξ n 1 t r i a l ξ n 1 t r i a l κ p n s where ξ n 1 t r i a l is the stress deviator tensor and κ p n s denotes the yield stress p n s is the accumulate plastic strain at n time step if φ n 1 t r i a l 0 the material is not yield then we set n 1 1 d n n 1 t r i a l d n is the damage variable at n time step otherwise the material is in the plastic loading state then the stress tensor should be returned on the yield surface 15 τ n 1 k τ n 1 t r i a l 2 g d e q p n 1 k n n 1 t r i a l δ t where d e q p γ 1 d in which γ denotes the plastic multiplier n 3 ξ 2 τ e q remain unchange in the plastic iteration process then the yield function in the k th iteration can be obtained φ n 1 k φ τ n 1 k p n 1 s k in which p n 1 s k p n s γ n 1 k δ t 1 d n 1 k 1 thus we can use the lemaitre model lemaitre 1985 to update the damage variable d n 1 k as follows 16 d n 1 k d n d c ε p r ε p d 2 3 1 ν 3 1 2 ν τ m 2 τ e q 2 n 1 k δ p n 1 s k f d p n s 0 d n otherwise where d c is the critical damage and ε p r is the rupture equivalent plastic strain ε p d denotes the threshold equivalent plastic strain in which f d p n s denotes the damage criterion and 17 f d p n s 2 3 1 ν 3 1 2 ν τ m τ e q 2 p n s ε p d to return the stress state to the yield surface we need to find the stress state that holds φ n 1 k 0 in which the only unknown variable is the plastic multiplier γ thus we can use the newton iteration to update the plastic multiplier 18 γ n 1 k 1 γ n 1 k φ γ φ n 1 k when we obtain the value of γ n 1 k 1 then we can update the yield function φ n 1 k and the iteration is terminated when φ n 1 k 10 2 the first piola kirchhoff stress in the governing euqations is calculated by p f 1 τ and which will be transform into the global coordinate system peng et al 2018 in the present study we assume that the crack tip must be the stress points that completely damaged and the crack path is represented by the piecewise line that connects those crack tips for the detail of the crack initiation and propagation algorithm readers may refer to our previous study peng et al 2020 2 3 contact algorithm for rkpm shell when ship structure subjected to the near field underwater explosion large deformation will occur which will lead the shell structure contact with each other the contact algorithm for the shell should be established to simulate the contact between the shell structures firstly we develop a contact detection algorithm to determinate if the shell contact to other shell or not we consider that i and j is contacted if the relative position between stress point i and node j satisfy the following relation 19 d n x j i e 3 l i t h 20 x j i e 1 l i 2 x j i e 2 l i 2 χ h where x j i x j x i e i l i i 1 2 3 are the three basic vectors of the local coordinate system at stress point i and t h denotes the thickness of the shell as shown in fig 1 a h denotes the smoothing length χ is a constant and we set χ 0 75 to implement the above criterion we need to search the node near each stress point here the linked list search scheme liu and liu 2003 is adopted to accelerate the contact detection algorithm moreover we should avoid the contact between the stress point and its nearest four nodes that form an integration cell as shown in fig 1 b the stress point relative position between stress point i and node j 1 j 4 can satisfy the above contact detection criterion but they are not in contact when node j is contact with stress point i the contact force should be applied to prevent the shell from nonphysical penetration and the friction force between the shell should be considered firstly the volume strain is calculated based on the penetration distance and then the normal contact force is obtained by multiplying the strain with the bulk modulus and the area of the stress point benson and hallquist 1990 finally we have 21 f j i n k s k t h d n t h s i where k s is a scaling coefficient here k s 0 1 is taken k is the bulk modulus s i denotes the area of the stress point i in the shell reference surface for the friction force the direction of the force is calculated by 22 t j i v j i v n e 3 l i v j i v n e 3 l i where v n v j i e 3 l i is the relative velcotiy between i and j in the normal direction in which v j i v j v i the magnitude of the friction force is obtained by 23 f j i t 1 μ f n 24 f j i t 2 k s k v j i v n e 3 l i δ t d n s where μ denotes the friction coefficient finally the contact force act on node j by stress point i is 25 f j i min f j i t 1 f j i t 2 t j i f n sign x j i 0 e 3 l i e 3 l i where x j i 0 denotes the relative position vector when node j and stress point i begin to contact and sign x j i 0 e 3 l i is defined as 26 sign x j i 0 e 3 l i 1 x j i 0 e 3 l i 0 1 x j i 0 e 3 l i 0 note that in the above equation x j i 0 should be recorded when the stress point i and node j begin to contact if x j i 0 is replaced by the current relative position between i and j which will result in the wrong direction of the normal contact force if the shell penetrates each other as shown in fig 2 when the node j is in contact with more than one stress point the contact force for node j is the average value of the force of all contact pairs 3 fluid structure interaction model to consider the fluid structure interaction the so called normal flux method de leffe et al 2009 is adopted thus when the support domain of the fluid particle i is truncated by the fsi interface as shown in fig 3 the surface integration in the sph gradient approximation is considered 27 f x ω f ω f x w x x d v γ f x w x x n d s ω f f x w x x d v where denotes the gradient operator at x therefore the sph particle approximation for the gradient of a function f x is expressed as 28 f x i k f x k w x k x i n k s k j f x j i w x j x i v j where j denotes the fluid particle in the support domain of i k denotes the stress points on the fsi interface s k is the area of the stress point and n k denotes the normal of the fsi interface that outward the fluid domain specifically when we calculated the velocity divergence and pressure gradient in the fluid governing equation 1 the surface integration should be considered and we have 29 v i k v i k n k w i k s k j v i j i w i j v j 30 p i k p i k n k w i k s k j p i j i w i j v j where v i k v k v i and p i k p i p k 2 in which p k is the pressure act on the stress point k of the shell and can be expressed as follows 31 p k 1 γ k i p i ρ i c i v i k e 3 l k w i k v i γ k i w i k v i where p i denotes the pressure of fluid particle i that near the fsi interface by substituting the above velocity divergence and pressure gradient into eq 2 1 finally the fluid governing equation including fluid structure interaction is obtained we have 32 d ρ i d t ρ i k v i k w i k n k s k j v i j i w i j v j d v i d t 1 ρ i k p i k w i k n k s k j p i j i w i j v j α c 0 h ρ 0 ρ i j π i j i w i j v j d e i d t p i ρ i k v i k w i k n k s k j v i j i w i j v j 1 2 α c 0 h ρ 0 ρ i j π i j v j v i i φ i j v j the surface integration term in the above momentum equation provides a repulsive force to the fluid particle i which will prevent the fluid particle from penetrating the fsi interface for the structure the fluid influence is considered as a pressure load that acts on the interface therefore the traction force on stress point k can be expressed as t k 0 p k e 3 l k where p k is calculated by eq 31 finally the external force in the rkpm shell governing equation 10 is calculated by 34 f i e x t γ p e 3 l n i d s in the above expression i denotes the rkpm shell node k denotes the stress points n i is the rkpm shape function the above integration is calculated by the so called stress point integration then we have 35 f i e x t k p k e 3 l k n i k s k the external moment caused by fluid pressure is ignored peng et al 2018 to illustrate the numerical implementation process of the present fluid structure interaction solver and facilitate the reproduction of the present numerical model the flow chart of the fluid structure interaction program is presented in fig 4 4 numerical examples in this part several numerical examples are studied to verify the robustness and accuracy of the presented numerical model in all the simulation three integration point is employed in the shell thickness direction one stress point in each integration cell and the bilinear shape function are adopted peng et al 2018 since the shape function s order is higher than the integration order it can be treated as the so called reduced integration and the shear locking problem is eliminated meanwhile according to the study by belytschko et al 2000 the adoption of the stress points integration can allow us to get rid of the rank deficiency problem in meshfree methods 4 1 the pinched cylindrical shell under a concentrated force firstly the elastic plastic response of a cylindrical shell under concentrated force extrusion is simulated the two ends of the cylindrical shell are simply supported that is the radial displacement is set to zero but the axial direction can move freely the dimensions of the shell and material parameters are summarized in fig 5 the material damage is ignored and the linear hardening model is employed the hardening modulus is set to e p 3 0 10 8 pa uniform particle spacing is adopted the total number of particles is 5084 the time increment is set as 5 10 6 s rkpm is used to simulate the shell deformation with and without contact and the same problems are also calculated by fem abaqus the displacement history of the loaded point calculated by rkpm is plotted in fig 6 in which the fem result is chosen as reference we can see from the figure that the results obtain by rkpm and fem are in good agreement whether self contact is considered or not moreover if the self contact is taken into account the loaded point s displacement will not exceed 0 3 m equal to the cylinder radius since the shells can not penetrate each other the effectiveness of the present contact algorithm is verified the final deformed configuration of the cylinder shell obtained by rkpm and fem is presented in fig 7 in which the contours of displacement is plotted from the figure we can see that when contact is ignored the shell penetrates each other in contrast the load point can not penetrate each other when self contact is considered moreover the deformed shape of the cylinder shell obtained by rkpm and fem are in good agreement although the deformation is considerable the particle distribution is regular with no instability observed 4 2 dynamic bulking of a square tube in this section the dynamic bulking of a square tube is simulated the large plastic deformation and self contact phenomenons are involved in this numerical example which is a suitable case to test the robustness of the numerical method the dimensions of the geometry and the material parameters is summarized in fig 8 in the simulation the bottom edge of the tube is fixed and a initial velocity is given to the upper bound of the tube meanwhile at 0 0675 m away from the bottom edge a 0 05 mm initial displacement disturbance along the shell normal direction is exerted to simulate the structural defect and trigger the buckling we ignore the material damage and the linear hardening model is adopted the hardening modulus is set as 1 gpa considering the symmetry of the geometry only one quarter of the geometry is modeled uniform particle spacing is adopted the total number of particle is 2700 the fixed time increment is set as δ t 2 0 10 7 s the deformed configuration of the square tube at several typical time is shown in fig 9 in which the contours of the equivalent plastic strain is plotted from the figure we can see that when the simulation begins the large horizontal displacement of the square tube occurs near the section where the small disturbance is applied this initial horizontal displacement triggers the dynamic buckling and the bearing capacity of the square tube decreases rapidly after that under the velocity impact the square tube continues to deform wrinkle and collide in the simulation the shell surfaces is contact with each other in the wrinkle regions and no penetration is taken place which verifies the effectiveness of the present contact algorithm for rkpm shell meanwhile large plastic deformation occurs in the wrinkle regions the results shows that the particle distribution is very regular and no instability is observed the robustness of rkpm shell in large deformation contact problem is verified 4 3 three point bending of an aluminum hat profile the three point bending of an aluminum hat profile is simulated in this section to verify the effectiveness and accuracy of the present contact algorithm this problem comes from the experimental study by chen 2001 the dimensions of the calculation model are presented in fig 10 in calculation the bottom of the aluminum profile is supported by two cylinders and the top of the aluminum profile is extruded a punch the punch s downward velocity is linearly accelerated to 1 m s within 0 005s and then remains unchanged besides in the simulation the cylinder supports the punch and aluminum profile are modeled by rkpm shell element and all shell thickness except the bottom of the profile shown in fig 10 are set as t h 0 002 m the cylinder supports and punch are treated as a rigid body only the deformation of the aluminum profile is considered the aluminum density is ρ 2700 kg m 3 young s modulus is set as e 7 0 10 10 pa poisson s ratio is set as ν 0 33 the linear hardening model is adopted to model the plastic response of the hat profile and the initial yield stress is κ 0 108 mpa the hardening modulus is set as e p 560 mpa the ultimate strength is σ u 237 mpa in the simulation the material damage is not considered uniform particle spacing with δ x 0 004 m is adopted and the total number of the aluminum profile is 10 478 fixed time increment δ t 5 10 7 s is applied the deformed configuration of the aluminum profile at several typical times is presented in fig 11 from the figure we can see that depression in the middle of the top of the profile when the simulation begins with the increase of the punch displacement the corner of the profile is wrinkled and buckled meanwhile the particle distribution during the whole loading process is very regular and no instability is observed in fig 12 the force displacement curve of the punch is presented in which the experimental result and fem result chen 2001 are chosen as reference from the figure we can see that the reaction force act on the punch increases to the maximum value quickly with the increase of the punch displacement at the beginning of the simulation then the corner of the aluminum profile is buckled and the bearing capacity of the profile decreases which results in the decline of the reaction force act on the punch the result obtained by rkpm is in good agreement with the experimental data however in the experiment study the downward velocity of the punch is 0 2 mm s in the present study the velocity is set as 1 m s to accelerate the numerical simulation therefore the oscillation of the force act on punch obtained by rkpm is relatively larger finally the deformation configuration at the end of the simulation is presented in fig 13 the rkpm result is compared with the experimental result chen 2001 it can be seen that the deformation shape calculated by rkpm is in good agreement with the experimental results which verifies the accuracy and effectiveness of the present rkpm contact algorithm 4 4 large deformation of plate subjected to the underwater explosion in this section large deformation of a plate that subjected to near field underwater explosion load is studied based on sph rkpm this numerical example is taken from the experimental study of ramajeyathilagam and vendhan 2004 the problem description and material parameters are summarized in fig 14 a 0 3m 0 25 m plate is placed in the center of the fluid free surface and the plate thickness is 0 002 m in calculation 0 0234 kg tnt is placed at 0 15 m below the center of the plate the jwl equation of state is adopted and the corresponding paramters is summarized in table 2 for the water mie gruneisen equation of state is adopted the corresponding paramter is summarized in table 1 the plate is made by commercial mild steel the initial yield stress is σ y 0 300 mpa the linear hardening model is adopted the hardening modulus is set as e p 250 mpa the damage evolution of the plate is control by eq 16 and the corresponding parameters are set as ε p d 0 32 ε p r 0 36 d c 0 21 the cowper symonds model hernandez et al 2013 is employed to model the strain rate effect we have 36 κ p s 1 ε e q p c 1 n κ p s where κ p s denotes the yield stress when strain rate effect is not considered for mild steel we set c 40 and n 5 in the simulation the fixed time increment δ t 3 10 7 s is taken in fig 15 the deformation of the plate and the pressure field of the fluid domain when t 96 ms are shown the final deformation of the plate obtained by sph rkpm is compared with the experimental result ramajeyathilagam and vendhan 2004 in fig 16 in which the contours of displacement is plotted from the comparison we can see that subjected to the near field underwater explosion load the plate has undergone large deformation and the deformed shape of the plate obtained by sph rkpm matches well with the experimental result meanwhile on the right side of fig 16 the influence of the strain rate effect is presented from this it can be seen that when the strain rate effect is ignored the deformation will increase significantly which indicates that the strain rate effect can not be ignored in the strong impact problems the time history of the plate center s deflection is plotted in fig 17 we can see from the figure that the plate s deflection will not continue to increase and the residual deformation occurs meanwhile the deflection will increase considerably if the strain rate effect is not considered finally the deflection of the point on the two symmetry axes of the plate is shown in fig 18 in which the result obtained by sph rkpm is compared with the experimental results and the numerical results obtained by ls dyna ramajeyathilagam and vendhan 2004 from the comparison we can see that the present numerical result agrees well with the reference results the accuracy of the current fsi model in dealing with structural damage loaded by the underwater explosion is verified 4 5 circular plate subjected to contact underwater explosion the fracture of a circular plate subjected to contact underwater explosion is studied in this section this numerical example is taken from the experimental study by rajendran and narasimhan 2001 the dimension of the problem and the material parameters are presented in fig 19 the radius of the plate is 0 145 m and the thickness is 0 004 m in the simulation the plate with the radius equal to 0 2 m is modeled and then the particles outside 0 145 m away from the center are clamped as shown in fig 19 the total particle number of the plate is 8151 for the fluid domain the particle spacing for water is 0 004 m while for tnt is 0 002 m and the total particle number of fluid is 394 476 in the experimental study 19 g pek 1 explosives is adopted therefore in the calculation we place 22 3 g tnt right below the center of the circular plate the plate is made by low alloy high strength steel the material paramter in the damage model is chosen as ε p d 0 2 ε p r 0 28 and d c 0 32 the strain rate effect is control by the cowper symonds model in which the material constant is set as c 40 n 5 the fixed time increment is adopted which is set as δ t 5 10 8 s when the shock wave propagates to the clamped boundary at t 65 μ s the pressure field of the fluid domain and the stress field of the plate are presented in fig 20 from which we can see that the blast gas expands rapidly as soon as the explosive is detonated and then the center of the plate is jacked up which results in great local deformation the equivalent stress of the center of the plate is considerable and several particles are damaged completely the initial crack path is formed the deformation configurations of the circular plate when t 0 1 ms 0 2 ms 0 4 ms 0 6 ms 0 8 ms and 1 0 ms are given in fig 21 in which the contours of the mises equivalent stress is plotted besides in this figure the blast gas is denoted by the gray particles from this figure we can see that the petal shaped crack path of the plate is formed when the center of the plate subjected to the initial blast shock wave after that the shock wave propagates outward and the blast gas continues to expand which leads to the crack path propagates along with the initial crack path direction the final fracture configuration of the circular plate calculated by the sph rkpm is compared with the experimental result rajendran and narasimhan 2001 in which the influence of the strain rate effect is given meanwhile the contours of the mises equivalent stress is plotted in the deformed configuration obtained by sph rkpm from the comparison we can see that the numerical result agrees well with the experimental result to some extent however due to the uncertainty in the experiment the crack path in the experimental study is not symmetry the radius of the crack path half of the maximum distance between the crack tip measured in the experiment is 0 12 m using the same standard the crack radius obtained by sph rkpm is 0 106 m the error between the numerical and experimental results is less than 12 the accuracy of the present numerical mothod is verified meanwhile from numeircal results presented in fig 22 we can see that without considering the strain rate effect the plate cracks into more petals which indicates that the strain rate effect can greatly reinforce the material in the strong impact problems the difference between the numerical and experimental results may be caused by the simplification of the material model or the decrease of the accuracy in the later stage of the simulation in fig 23 the particle distribution of the blast gas at t 1 ms is presented from which we can see that due to the lagiangain property of the sph method the particle spacing of the blast gas is quite large which will increase the error of the calculated pressure load this problem needs to be further studied in future work 4 6 ship hull subjected to contact underwater explosion load in this section the damage of a ship hull subjected to near field underwater explosion load is studied this numerical example is taken from the experimental study by zhu et al 2004 the geometric dimensions of the ship hull are shown in fig 24 there are two kinds of material is adopted in the ship hull for the defensive longitudinal bulkhead and the deck the low alloy steel is adopted and the other part of the ship hull is made by the normal carbon constructional steel the material parameters for these two kinds of steel can be found in peng et al 2019 the material damage evolution is controlled by eq 16 for the normal steel we set ε p d 0 20 ε p r 0 28 and d c 0 3 and for the low alloy steel we set ε p d 0 20 ε p r 0 28 and d c 0 4 the average particle spacing for the structure and water is set as 0 01 m to ensure the particle spacing of the blast gas not too large after expansion the initial particle spacing for tnt is set as 0 005 m the total number of particles for structure and fluid are 101 987 and 923 970 in the longitudinal direction the tnt is located in the middle of the ship hull and in the cross section its location is shown in fig 24 a the fixed time increment is adopted which is set as δ t 4 10 7 s in fig 25 the pressure field of the fluid and the deformed configuration of the ship hull at t 0 1 ms is presented the contours of the accumulated plastic strain are plotted on the deformation configuration of the structure it can be seen from the figure that after the tnt is detonated the blast gas expands rapidly meanwhile the ship hull plate is sunken under the strong shock wave besides the plastic strain of the structure particle reaches the rupture equivalent plastic strain which indicates that the initial crack is formed after that the blast gas and the fragments of the ship hull move to collide the water filled cabin the final deformed configuration of the ship hull obtained by sph rkpm is compared with the experimental result in fig 26 from which we can see that the concave shape calculated by sph rkpm is in good agreement with the experimental result the dimensions of the crack hole obtained by sph rkpm are compared with the experimental results in table 3 the area of the crack hole is in good agreement with the experimental results but the crack hole shape has a slight difference in fig 27 the deformation configurations of the ship hull at several typical time is presented from which we can see that there are cracks on the hull plate the front and back bulkheads of the water cabin the defensive lognitudinal bulkhead has large deformation but not cracked moreover the ship bottom and deck are warped which is consistent with the deformation characteristics in the experiment study zhu et al 2004 the effectiveness and applicability of the present numerical method in the simulation of complex ship structures subjected to underwater explosion are verified 5 conclusions in present work the numerical model for the simulation of structural damage subjected to near field underwater explosion based on sph and rkpm is proposed the normal flux method is adopted to establish the fluid structure interaction solver the structure is treated as the moving solid boundary for the fluid and the fluid pressure is considered the surface load act on the shell surface since the shell structures will contact each other when large deformation occurs in the underwater explosion problem the contact detection algorithm for the rkpm shell is presented meanwhile the contact force formulation is obtained based on the volume strain firstly several large deformation problems with contact are studied the effectiveness and accuracy of the present contact algorithm for the rkpm shell are verified besides the numerical result indicates that the rkpm shell formulation is very robust in dealing with large deformation problems then the damage and fracture of the structure subjected to the near field underwater explosion are studied the numerical results agree well with the experimental results which verify the accuracy and effectiveness of the sph rkpm fsi solver applied in the underwater explosion problem the present numerical model is a part of the fslab software developed by the fsi laboratory of harbin engineering university which lays a foundation for the design of the ship s defensive structure credit authorship contribution statement yu xiang peng methodology coding writing a man zhang supervision fu ren ming writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors thank the national science foundation for distinguished young scholars of china 51925904 the national natural science foundation of china 51909042 52088102 and china postdoctoral science foundation 2020m670888 for their support 
21062,non planar composite π joints are receiving increasing attention in marine engineering efficient two dimensional 2d finite element fe methods which can accurately predicted the failure behavior of this kind of joint are critically meaningful for structural design emphasizing low computational time and easy operation a material model is developed here from which the equivalent engineering constants of plies with various angles can be obtained based on the material model a 2d fe model is built to determine distributions of the shear and peel strain in a single lap adhesively bonded joint the strain distribution results from the 2d fe model agree well with experimental results validating the accuracy of the material model in addition 2d fe modelling of the non planar composite π joint under tensile loading is developed by combining the proposed material model and progressive damage method the damage behavior and ultimate failure load are predicted and good agreements present between the numerical and experimental results totally the reduced computational method combining the 2d fe model and progressive damage method is efficient and simple can provide an accurate simulation of the damage behavior of complex composite bonded structures and has good prospects for engineering applications keywords material model composite π joint failure prediction 1 introduction integrated adhesive composite structures which could take advantage of the composite material mechanics characteristics enable the potential benefit of lower weight and assembly cost and higher performance of composite structures and thus have drawn great attention in the day of extensive application of composite in marine and aerospace structures hirwani and panda 2018 lei et al 2016 silva and nunes 2014 composite bonded sandwich panels have also been applied in high performance marine ships hoo fatt and sirivolu 2017 such as the ship hulls of knm skjøld of royal norwegian navy visby corvettes of royal swedish navy and la fayette class frigates of french navy and propellers propulsors and propulsion shafts along with secondary structures for numerous naval vessels mitra 2010 non planar adhesively bonded composite joints which have the abilities to connect two orthogonally placed members are effective means to realize the marine structural integrity and being increasingly used he 2011 comparing with the bolted joints the load distribution of load is more uniform in bonded joints with less stress concentrations and bonded joints usually present better fatigue resistance gonçalves et al 2002 however the adhesive joints are especially prone to failure at bonded connections due to the material s heterogeneity and geometry s discontinuities in addition the difficulty in predicting joint strength and optimizing structural geometries may somewhat limit their application thus accurate numerical methods capable of predicting the structural failure behavior and strength are necessary for the design and optimization of joints due to the complication both in structures and loadings feih and shercliff 2005a li and lee sullivan 2001 analytical approaches have been proposed to calculate the distributions of stress and strain in composite bonded joints with simple configurations however many assumptions and simplifications are required which make them not applicable for joints with complex configuration such as the studied non planar composite π joints numerous fe and experimental investigations about adhesively bonded sandwich panels have been conducted in literatures bull and edgren proposed a plastic micro buckling method to predict the residual strength of sandwich structures and performed a parametric study on the impact damage resistance and the residual strength of sandwich panels with carbon fiber vinylester faces and pvc foam core bull and edgren 2004 compressive response and failure modes of corrugated core sandwich manufactured by hot press moulding and then bonded to face sheets were experimentally and numerically analyzed by rejab and cantwell 2013 using 3d non linear fe model panigrahi and pradhan 2009 studied influence of the through the width delamination on the delamination behavior of single lap composite joints similarly li et al 2020 also used 3d nonlinear progressive damage fe method to predict the failure strength and modes of hybrid single lap joints castagnetti et al 2010 proposed a fe modelling procedure for analyzing the failure of adhesively t joints kumari and sinha 2002 developed a thick shell element for composite and studied the influence of some critical design parameters including the stacking sequence and the filler area and curvature of filler radius on the ultimate load of t joints bearing pull loading shenoi and hawkins 1992 further highlighted that the mechanical properties of composite t joints under bending loading was greatly affected by the geometry and material type and found that the curved parts were critical for the joints load bearing capability feih and shercliff 2005a 2005b predicted the failure behavior in single l composite peel joints bearing both tensile and bending loadings by a damage model with numerical stabilities optimization on the joints was achieved by changing the filler shape and stacking sequence of the l shaped part kupski et al 2019 investigated the influence of adherend stacking sequence on the tensile failure of bonded joints by experimental and numerical investigations in addition it is well known that there are different types of non planar adhesively bonded joints such as hat joints ji et al 2014 sápi et al 2019 l joints feih and shercliff 2005a t joints da silva and adams 2002 di bella et al 2010 marcadon et al 2006 and π joints as shown in fig 1 which can be applied for the non planar connections of different parts of the ship hull to achieve structural integrity among them the composite π joints were firstly proposed in the rocss robust composite sandwich structures project sheahen et al 1998 and further improved in the cai composite affordability initiative project kan and kane 2002 have already successful applications on the f 35 fighter however experimental and simulated researches reported in open literatures are relatively less than other types of joints some researchers fu et al 2012 zhang et al 2014 zhao et al 2010 have conducted some researches on the composite π joint through progressive damage method failure process of composite π joints bearing tensile load was revealed by numerical analysis zhao et al 2010 the effects of joint configuration stacking sequence and geometric size on the failure process and the strength of composite π joints under bending load were studied and an optimal design scheme of joints was obtained fu et al 2012 zhang et al 2014 the influences of interlaminar reinforcement by stitching on the mechanical capability of composite π joint bearing tensile load was studied and it was found that stitching technique can result in a remarkable improvement on the rupture load zhang et al 2011 considering the peculiar failure characteristics of the deltoid fillers of the composite π joint a modification on the maximum stress criterion for failure evaluation was proposed and corresponding material degradation model was developed for composite π joints zhao et al 2012 the internal load distribution of composite π joints was revealed by a 3d progressive damage analysis model and the failure mechanism of joints was further revealed zhao et al 2013a furthermore the cohesive zone model was applied to model the delaminations between preforms and cracks in the deltoid filler in the non planar woven composite π joint zhao et al 2013b however the cohesive zone model is mostly limited to small scale model due to computational limits in terms of high number of cohesive elements and 3d solid modelling strategy gaiotti et al 2020 in addition zhang et al 2015 proposed an engineering method to evaluate the damages in complex non planar composite π joints they focused on the critical curved parts and used the average failure index as damage indicator to predict the joint ultimate strength all above researches are based on the accurate 3d fe model of composite π joints however complex configuration of π joints and complicated layered structure of composites laminate bring large amount of work of building the 3d fe model and a high computational effort due to refined mesh díaz et al 2010 which makes the 3d fe model not suitable for engineering application considering simple and efficient numerical methods are important for the practical engineering the aim of the work is thus to establish a reduced computational method for the prediction of the damage behavior and strength of composite π joints the novelty of this work is that a 2d material model based on orthotropic elastic mechanics and the assumption of plane strain is established combining with the progressive damage method an effective numerical framework is proposed which can bring accurate predictions on the failure behavior of composite π joints in a simple and efficient way the accuracy of the material model on calculating the distribution of stress strain along the central surface of the bond layer in the single lap adhesive joint is validated subsequently non planar composite π joints fabricated by cfrp prepregs are designed and static tensile tests are carried out the proposed material model is applied in a 2d fe model integrating the progressive damage method to predict the damage behavior and joint failure strength the comparisons between test results and numerical results in terms of failure mechanism and load displacement response are used to validate the applicability of the numerical method in this study 2 materials and methods 2 1 description of the composite π joint the detailed configuration and geometry parameters of the studied composite π joint which uses the unidirectional t700 qy8911 composite materials are shown in fig 2 the non planar adhesively bonded π joint allows the connections between laminated panels and honeycomb sandwich panels with cfrp skins and different materials for core kevlar honeycomb core and gfrp core table 1 lists the geometric sizes of joints the π shaped over laminate consists l shaped prepreg and u shaped prepreg which are both made of carbon prepreg with stacking sequence of 45 0 45 the π shaped over laminate is firstly co cured with the skin and secondary bonded with the pre cured web plates along the vertical direction fig 3 shows the detailed lay up information about the π over laminate the skin and the web are sandwiched structures with 8 plies of unidirectional carbon fiber reinforced plastics ud cfrp on both sides the thickness of the web core is 4 5 mm two types of material are used in the web core for the part from the top of web core downwards to a location with a distance of 50 mm the used material is glass fiber reinforced plastic gfrp for clamping facilitation the material used for the rest part of the web core is kevlar honeycomb with a hexagon cell size of 2 mm the thickness of the skin core is 3 mm and the used material is gfrp the stacking sequences of the face sheets in the web and the skin are 90 90 45 45 s and 45 0 45 90 s respectively the two fillers are formed by prepregs of the unidirectional t700 qy8911 composite materials and the fiber is arranged in the joints transverse direction table 2 lists the basic material properties of the ud cfrp lamina fig 4 illustrates the experimental scheme of the static tensile test on composite π joints the tests are carried out on a hydraulic testing machine instron 8803 with a capacity of 10 kn a tensile load with displacement controlling mode is applied at the top end of the web at an even loading speed of 1 2 mm min to conduct the tensile test the π joint should be fixed here the both end of skin plates are clamped by two rigid plates which are connected to the rigid brackets by bolts the centers of both rigid plates have a distance of 160 mm three samples are tested and loaded until the ultimate failure occurs the displacement of the crosshead and the applied load are automatically recorded by the self equipped sensors 2 2 analysis method combining 2d material model and pdm a ply by ply discretized 2d fe modelling is combined with the progressive damage method for a fast and efficient failure prediction of composite joints to achieve this a 2d material model is developed which can provide equivalent material engineering constants for the modelling of composite plies with various fiber angles details on the 2d material model can be found in the appendix in progressive damage method the failure evaluation criterion and material degradation model are two important aspects liao et al 2020 in this study the failure evaluation criterion based on maximum stress as shown in eq 1 is used to evaluate the damages in composite π joints using this failure evaluation criterion the fiber failure intralaminar failure interlaminar failure and shear out failure can be assessed the interlaminar failure i e the delamination can be evaluated by comparing the value of σ 3 with the strength in the through thickness direction in addition the initial damage and the delamination will be influenced by the adhesive around the critical deltoid areas the load at which a material in the joints first fails in any above failure forms is the initial damage load 1 fiber failure σ 1 x t 1 σ 1 0 σ 1 x c 1 σ 1 0 intralaminar failure σ 2 y t 1 σ 2 0 σ 2 y c 1 σ 2 0 interlaminar failure σ 3 z t 1 σ 3 0 σ 3 z c 1 σ 3 0 shear out failure τ 12 s 12 1 τ 13 s 13 1 τ 23 s 23 1 as regarded to the material degradation model camanho material degradation model camanho and matthews 1999 is adopted and the model is as following 2 m a t r i x t e n s i l e s h e a r o u t f a i l u r e e 2 d d 2 t e 2 g 12 d d 4 t g 12 g 23 d d 4 t g 23 f i b e r t e n s i l e f a i l u r e e 1 d d 1 t e 1 m a t r i x c o m p r e s s i o n s h e a r o u t f a i l u r e e 2 d d 2 c e 2 g 12 d d 4 c g 12 g 23 d d 4 c g 23 f i b e r c o m p r e s s i o n f a i l u r e e 1 d d 1 c e 1 where d 1 t 0 07 d 2 t d 4 t 0 2 d 1 c 0 14 d 2 c d 4 c 0 4 the superscripts t and c mean the tensile case and the compressive case respectively the d means the degraded material property because the fem in this study is a 2d model and the stresses from the 2d fe model refer to the off axis coordinate system o xyz which corresponds to the geometry configuration of composite π joints while the failure evaluation criterion and the material degradation rules are specific to stresses and material engineer constants of the principle axes so the failure evaluation criterion and the material degradation rules should be transposed to the 2d plane for further analysis for the lamina with a ply angle of 0 the failure modes involve the fiber failure the inter laminate matrix failure and the shear out failure of τ 13 for the lamina with a ply angle of 90 the failure modes involve the intralaminar and interlaminar matrix failure and shear out failure of τ 23 when considering the lamina with a ply angle of 45 the situation becomes complex as the fiber of the lamina is oblique referred to the 2d plane in this study the stresses of the lamina with a ply angle of 45 are transposed to the three principle axes so the fiber failure the intralaminar and interlaminar matrix matrix failure and shear out failure of τ 13 and τ 23 can be included as detailed in the appendix the matrix element can be expressed as 3 d 1 1 e 1 2 e 1 e 2 ν 1 2 2 d 1 2 d 2 1 e 1 e 2 ν 1 2 e 1 e 2 ν 1 2 2 d 2 2 e 1 e 2 e 1 e 2 ν 1 2 2 d 3 3 g 1 2 the relation between the poisson s ratio and the equivalent elastic modulus of 2d equivalent material parameters is as following 4 e 1 e 2 ν 1 2 ν 2 1 if defining λ e 1 e 2 ν 1 2 2 e 1 1 ν 1 2 ν 2 1 d 1 1 d 1 2 d 2 1 d 2 2 and d 3 3 can be expressed as 5 d 1 1 e 1 1 ν 1 2 ν 2 1 d 1 2 d 2 1 e 2 ν 1 2 1 ν 1 2 ν 2 1 d 2 2 e 2 1 ν 1 2 ν 2 1 d 3 3 g 1 2 by introducing β 1 ν 1 2 ν 2 1 the following equations can be obtained 6 d 1 1 e 1 β d 1 2 d 2 1 e 2 ν 1 2 β d 2 2 e 2 β d 3 3 g 1 2 as the poisson s ratio is small so β 1 therefore the d 1 1 d 2 2 d 3 3 d 1 2 mainly depend on the e 1 e 2 g 1 2 e 2 and ν 1 2 respectively the stress failure criterion and material degradation rules for laminas with different ply angles used in the 2d progressive damage analysis are listed in table 3 in the umat subroutine the degradation of the material constitutive relation is realized by multiplying the element of the equivalent stiffness matrix d i j in the 2d plane by the corresponding degradation coefficient 3 verification on the two dimensional material model before applying the analysis method for failure prediction in composite joints the 2d material model is firstly verified in this section by comparing the numerical results with experimental results of a single lap adhesive joints the joints have the same joint configuration as the one studied by tsai and morton 1995 with the material model mentioned above the 2d fem of single lap adhesive joints can be established 3 1 joint configuration and fe model fig 5 shows the joint configuration and geometric sizes of single lap adhesively bonded joints the length l is 101 6 mm the width b is 25 4 mm and the overlap length 2c is 25 4 mm the material of the upper and lower composite adherends are graphite epoxy xas 914c the basic material constants are as follows e 1 138 gpa e 2 e 3 9 4 gpa v 12 v 13 v 23 0 31 g 12 g 13 g 23 6 7 gpa the thickness of each ply is 0 25 mm epoxy adhesive hexcel redux 308a with a thickness of 0 13 mm is used for adhesive layers whose elastic modulus is 3 0 gpa and poisson ratio is 0 31 a 20 mm long left end of the lower arm is clamped the right end of the upper arm is pulled in the length direction of a joint with a displacement of 10 mm according to the proposed material model as presented in section 2 1 equivalent engineering constants can be calculated and listed in table 4 for plies with different orientations a 2d numerical model of single lap adhesively joints is built when establishing the 2d numerical model equivalent material properties for different composite layers are assigned to each ply section respectively in addition various mesh densities are defined for different joint s regions in order to ensure the results are mesh independent mesh sizes are refined at the overlap region and at the regions around two ends of adhesive where serious stress concentration may exist the mesh sizes at other regions are relatively coarser to save computational cost four elements are set in the adhesive layer through the thickness direction 3 2 results and discussions when analyzing the single lap adhesively bonded joint most early studies focus on the adhesive layer because the adhesive quality is not good at that time failures in adhesively bonded joints are almost caused by the damages in the adhesive which is the weakest part thus in this study the shear strain and the peel strain of the middle plane of the adhesive layer are studied the results of the shear strain and the peel strain are extracted from the 2d numerical model and compared with the experimental results as shown in fig 6 from this figure it is obvious that the shear strain is always negative at the whole overlap and has a nonlinear relation with x c with the increase of x c the strain initially increases slowly from a low value of about 0 29 towards the end of adhesive the slope of the strain curve increases and the strain quickly arrives a maximum value of 3 1 good agreements exist between the shear strain distribution at the middle plane of the adhesive layer from the 2d fe model and tests in addition the maximum value of the shear strain from the 2d model is very close to the experimental one only 0 4 lower fig 6 also shows the peel strain at the middle plane of the adhesive layer from the 2d fe model and its comparison with the experiment result the peel strain is constant at a value of 0 01 within the range of 0 x c 0 35 with further increase of x c the strain increases slowly until a maximum value of 0 21 at x c 0 9 subsequently the strain decreases to zero and later quickly increases to a large positive value of 0 3 at the end of adhesive it can be seen that the peel strain distributions of the adhesive layer from the 2d fe model also show great agreements with the experimental results and the maximum peel strain from the 2d fe model is very close to the experimental one totally the 2d numerical model adopting the two dimensional material model can accurately reveal the strain distribution in the adhesive layer of the single lap adhesively bonded joint 4 failure prediction of non planar composite π joint in this section a 2d numerical model is established for composite π joints under static tensile loading by using the equivalent engineering constants calculated by the material model proposed in section 2 a progressive damage analysis is conducted with a user defined material subroutine in order to determine the joints failure strength the 2d equivalent maximum stress criterion proposed for the lamina with different ply angles is applied and a material degradation method based on the camanho s material degradation model is adopted as listed in table 3 the elastic response ultimate failure load and post elastic behavior of composite π joints are predicted and compared with experimental results 4 1 the fe analysis model a 2d fe model is established in commercial fe software abaqus which adopts the cpe4 elements in 2d fe model the composite laminate is modelled ply by ply using the 2d equivalent engineering constants of each lamina as listed in table 5 one element is set for each composite ply and four elements for the adhesive layer along the thickness direction in order to capture accurate inter laminate stress the bonding region of the straight legs and the horizontal legs i e the intersection of the joint including two triangle areas including fillers is the critical part of the out of plane π joint thus special attention should be paid to its modelling to avoid the effect of large angular and aspect ratio distortions of the elements the mesh in the intersection of joints is refined to ensure that the mesh subdivision has almost no effect on the stress concentration finally a fine mesh as shown in fig 7 is adopted the constraints of the 2d fe model are set according to the realistic loading conditions the displacement control mode load is simulated by applying a gradually increased pull off displacement loading at the top surface of the straight leg to achieve this the constraint type equation is employed to couple the top surface of the straight leg with a reference point on the top surface which allows the reference point and the top surface with identical degrees of freedom a certain displacement is then set at the reference point along the z axis direction the nodes on the two ends of the skin plate about 20 mm length are fixed to represent the clamping arrangement used during tests fig 7 illustrates the fe model and the loading and boundary conditions of the composite π joint based on the section 2 a progressive damage analysis for the 2d fe model by compiling a user defined material subroutine in abaqus is conducted to determine the ultimate failure load of joints 4 2 experimental results three specimens are tested to understand the mechanical behavior of composite π joint under tensile loading they are loaded continuously until the ultimate failure the damage and failure procedures of the tests are recorded by video and photographs in order to relate the failure events to the load displacement curve initial damage is characterized by noise emitted during loading and a trivial load drop in the load displacement curve final failure is observed and characterized by the maximum load on the load displacement curve fig 8 shows the experimental load displacement curves at the elastic stage the load increases linearly with the applied displacement when damages occur in the joint non linearity exhibits on the load displacement curve and the load increases slowly with stiffness reduction from the initial to the final failure when the maximum load is arrived the load decreases quickly after the ultimate failure happening in the joint the ultimate loads and displacements of the three samples recorded in the experiment are summarized in table 6 the average value of the ultimate loads is 3 78 kn and the standard deviation s d is 0 28 kn the average value of the displacements corresponding to the ultimate failure is 4 34 mm with a s d of 0 08 mm although the three specimens are made by the same manufacturing and processing technique and there is no detected defect during the nondestructive testing the experimental data shows a certain degree of scatter this suggests that there are many factors that will have influence on the initial damage and growth mechanism due to the complex geometry of the composite π joint local variations in material disposition and uncertain material properties from location to location to reflect the determinate and random factors in the tests the average experimental value is provided to verify the following numerical prediction fig 9 further shows the damage states of one representative specimen at the initial the middle and the final failure stages during the experiment the specimen fails initially by delamination within the interface between right l shaped prepreg and the filler with slight cracking and then the crack shown in fig 9 a can be observed the point of crack generation is difficult to identify due to the speed at which the failure occurs subsequently the crack grows toward the base prepreg some wrinkles can be observed on the outer surface of the right l prepreg corner with further increase of load the crack grows slowly in the filler with continued crackling and tearing sounds subsequently a new crack between the left l prepreg and filler occurs more opening cracks and further propagation in the right part of joint can be observed obviously as shown in fig 9 b final failure of the joint occurs when the right crack penetrates throughout the filler and the base prepreg delaminates as shown in fig 9 c of the back face of the joint 4 3 numerical results numerical results are also shown in fig 8 for comparison the red curve illustrates the numerical load displacement relationship the responses from the numerical and experimental results agree well at the linear elastic stage linear elastic load displacement response at the initial stage implies the joint carries displacement load steadily the numerical curve is smooth without some trivial drop off as in the experimental curve when the initial damage is detected subsequently with the increasing displacement loading the structural stiffness gradually decreases due to damage initiation and growth the joint continues to carry higher load until a maximum load of 3 85 kn finally a sudden huge load drop occurs due to the catastrophic failure with dramatic reduction in joint stiffness indicating the final failure of composite joints it can be seen that trivial differences exist at the following damage evolution stage totally the failure behavior of the composite π joint predicted by fem agrees favorably with the experimental data during the whole process summaries of the final failure load and corresponding displacement predicted by the numerical model are presented in table 6 and compared with the experimental values the ultimate failure load of the numerical prediction is 3 85 kn with a corresponding displacement of 4 26 mm good agreements between the experimental and numerical results have been achieved with relative errors less than 2 the ultimate failure load of numerical prediction is slightly larger than the mean value of the experimental results this maybe resulted by some defects existing in the real joint structure while the fe model is an ideal model of the real structure totally the numerical method proposed in this study is capable for accurately predicting the failure behavior and strength in composite π joints furthermore numerical results show that the initial damage occurs at the interface the l prepreg and the filler as observed in experiments fig 10 shows the final deformation shape of the composite π joint and the failure status of the typical part of π joint obtained by the fe analysis the gray region indicates the failed parts the damage states are symmetric about the center axis of the joint the damages in the deltoid fillers l shaped prepreg and the interface between the skin and the base prepreg are obvious to be observed which agree well with the experimental results the analysis method developed in this study is efficient with less computation time while without lowering the accuracy this reduction of freedom degrees of the model is particularly remarkable if compared with the 3d fe model although reduced computational time can be achieved by 2d fe model the presence of internal defects and failure along the panel width are not able to be considered better results could be obtained considering the whole stress strain curve of the investigated materials however experimental results usually exhibits some scatters and the predicted results locates within the range of the experiment results which is suitable for the engineering application in conclusion the proposed analysis method is simple efficient and accurate to predict the failure behavior in composite bonded structures it is worthwhile to point that the extended finite element method xfem abdullah et al 2017 zhao et al 2017 and cohesive zone model czm cao et al 2020 gong et al 2017 2020 kaushik and ghosh 2019 yin et al 2020 have been gradually applied for modelling the intra inter laminar damages in composite structures which should be interesting to combine both methods for the failure predictions of composite joints in the future work in addition due to the complex mechanical behavior and many influencing factors theoretical approaches for the failure prediction of the non planar composite π joints are lack of which is still a challenge 5 conclusions this paper presents a reduced computational method based on standard numerical techniques to predict failure behavior in non planar bonded structures a 2d material model is proposed and a ply by ply discretized 2d numerical model of a single lap adhesive joint is built by using equivalent engineering constants calculated by the material model to validate the proposed material model the distributions of the shear strain and the peel strain of the middle adhesive layer extracted from the 2d numerical model are compared with the experimental results good agreements are obtained which initially verifies the accuracy of the 2d material model in addition a 2d numerical model for the non planar composite π joint under static tensile load is established which uses the equivalent engineering constants calculated by the 2d material model the elastic response ultimate failure load and post elastic loading softening behavior of composite π joints are well predicted combining a progressive damage analysis the reduced computational method has much less degree of freedoms and runs faster than a full 3d fe model thus this efficient method is simple and efficient for the failure prediction in complex non planar bonded structures and has good prospect for engineering applications credit authorship contribution statement yongxiang zhang methodology software writing original draft linfei jiang investigation formal analysis writing original draft yu gong conceptualization writing review editing funding acquisition project administration supervision hao liu resources formal analysis jian zhao formal analysis methodology writing review editing sue ren resources formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research work is supported by the national natural science foundation of china project no 11902054 and the chongqing natural science foundation project nos cstc2018jcyjax0235 cstc2019jsyj yzysbax0015 and cstc2019jscx zdztzxx0028 the fundamental research funds for the central universities project no 2020cdjgfhk009 the laboratory of pression manufacturing technology of the china academy of engineering physics project no zm18004 the aeronautical science foundation of china project no 201909038001 the innovation foundation of sast project no sast202020 the natural science foundation of shanghai project no 20zr1462600 and the foundation of state key laboratory of automotive simulation and control project no 20201202 appendix the two dimensional material model used in this study is based on the orthotropic elastic mechanics theory and the plane strain assumption zhao et al 2014 for an arbitrary unidirectional composite ply there is three principal axes as shown in fig 11 a i e the 1 axis 2 axis and 3 axis which are along the longitudinal the transverse and the interlaminar direction respectively the off axis coordinate system o xyz corresponds to the structural geometry configuration including x axis y axis and z axis which are along the length direction the width direction and the thickness direction according to the orthotropic elastic mechanics theory a single ply of the composite laminate in the coordinate system o 123 can be regarded as transverse isotropic material its constitutive relation can be expressed by a 1 ε 1 ε 2 ε 3 γ 23 γ 31 γ 12 s 11 s 12 s 12 0 0 0 s 21 s 22 s 23 0 0 0 s 21 s 32 s 22 0 0 0 0 0 0 2 s 22 s 23 0 0 0 0 0 0 s 66 0 0 0 0 0 0 s 66 σ 1 σ 2 σ 3 τ 23 τ 31 τ 12 where s ij i j 1 2 3 4 5 6 are the compliance matrix elements which are related to the basic material constants of the composite lamina e 1 e 2 ν 12 ν 23 and g 12 the eq a 1 can be simplified into the following form a 2 ε s σ if the referenced coordinate system is changed from the o 123 to the o xyz the new constitutive relation can be expressed by a 3 ε s σ where ε ε x ε y ε z γ yz γ zx γ xy t and σ σ x σ y σ z σ yz σ zx σ xy t are the off axis strain and the off axis stress vectors in the o xyz respectively the compliance matrix s is the off axis compliance matrix and can be expressed by a 4 s t ε 1 s t σ where s t σ and t ε are the compliance matrix the stress transformation matrix and the strain transformation matrix respectively t σ and t ε can be expressed by a 5 t σ m 2 n 2 0 0 0 2 m n n 2 m 2 0 0 0 2 m n 0 0 1 0 0 0 0 0 0 m n 0 0 0 0 n m 0 m n m n 0 0 0 m 2 n 2 t ε m 2 n 2 0 0 0 m n n 2 m 2 0 0 0 m n 0 0 1 0 0 0 0 0 0 m n 0 0 0 0 n m 0 2 m n 2 m n 0 0 0 m 2 n 2 in the above equation m cosθ n sinθ the definition of the ply orientation angle θ is shown in fig 11 a the eq a 3 can be transposed as a 6 σ s 1 ε c ε in the off axis coordinate system o xyz as shown in fig 11 b a ply of composite laminate is an orthotropic body where the x o y is its symmetric plane the off axis compliance matrix s and stiffness matrix c have the following forms a 7 s s 11 s 12 s 13 0 0 s 16 s 12 s 22 s 23 0 0 s 26 s 13 s 23 s 33 0 0 s 36 0 0 0 s 44 s 45 0 0 0 0 s 45 s 55 0 s 16 s 26 s 36 0 0 s 66 c c 11 c 12 c 13 0 0 c 16 c 21 c 22 c 23 0 0 c 26 c 31 c 32 c 33 0 0 c 36 0 0 0 c 44 c 45 0 0 0 0 c 54 c 55 0 c 61 c 62 c 63 0 0 c 66 the transverse middle plane of the composite ply satisfies the plane strain condition sørensen et al 2008 therefore for the composite ply the out of plane strain in the x o y plane is zero a 8 ε y 0 γ y z 0 γ x y 0 substituting eq a 8 into eq a 6 the constitutive relation in the x o z plane can reduce to a 9 σ x σ z τ x z c 11 c 13 0 c 31 c 33 0 0 0 c 55 ε x ε z γ x z inverting eq a 9 the relation between the strain and the stress could be expressed by a 10 ε x ε z γ x z s 11 s 12 0 s 12 s 22 0 0 0 s 33 σ x σ z τ x z where s ij i j 1 2 3 is a group of compliance coefficients of the compliance matrix in the plane of x o z the constitutive relation as eq a 10 could be used for 2d element which is the stress strain relation in terms of the off axis coordinate system x o z which is applicable for the elements in the transverse middle plane of the composite laminated adherend in plain stress elements as shown in fig 11 c an equivalent coordinate with equivalent principal axis 1 and axis 2 is established the constitute relationship in the plain stress element is expressed as a 11 σ 1 σ 2 τ 1 2 d 1 1 d 1 2 0 d 2 1 d 2 2 0 0 0 d 3 3 ε 1 ε 2 γ 1 2 introducing e 1 e 2 ν 1 2 and g 1 2 as equivalent engineering constants respectively corresponding to equivalent principal axis 1 and axis 2 considering the symmetry of the stiffness matrix a stress strain relationship can be derived from eq a 11 a 12 ε 1 ε 2 γ 1 2 1 e 1 ν 1 2 e 1 0 ν 1 2 e 1 1 e 2 0 0 0 1 g 1 2 σ 1 σ 2 τ 1 2 comparing eq a 10 with eq a 12 and making the components in both compliance matrixes same we can obtain a 13 e 1 1 s 11 e 2 1 s 22 ν 1 2 s 12 s 11 g 1 2 1 s 33 where the e 1 e 2 ν 1 2 and g 1 2 are equivalent engineering constants of composite layers in transverse middle plane the material model presented as eq a 13 is applicable when the assumption of plane strain is satisfied 
21062,non planar composite π joints are receiving increasing attention in marine engineering efficient two dimensional 2d finite element fe methods which can accurately predicted the failure behavior of this kind of joint are critically meaningful for structural design emphasizing low computational time and easy operation a material model is developed here from which the equivalent engineering constants of plies with various angles can be obtained based on the material model a 2d fe model is built to determine distributions of the shear and peel strain in a single lap adhesively bonded joint the strain distribution results from the 2d fe model agree well with experimental results validating the accuracy of the material model in addition 2d fe modelling of the non planar composite π joint under tensile loading is developed by combining the proposed material model and progressive damage method the damage behavior and ultimate failure load are predicted and good agreements present between the numerical and experimental results totally the reduced computational method combining the 2d fe model and progressive damage method is efficient and simple can provide an accurate simulation of the damage behavior of complex composite bonded structures and has good prospects for engineering applications keywords material model composite π joint failure prediction 1 introduction integrated adhesive composite structures which could take advantage of the composite material mechanics characteristics enable the potential benefit of lower weight and assembly cost and higher performance of composite structures and thus have drawn great attention in the day of extensive application of composite in marine and aerospace structures hirwani and panda 2018 lei et al 2016 silva and nunes 2014 composite bonded sandwich panels have also been applied in high performance marine ships hoo fatt and sirivolu 2017 such as the ship hulls of knm skjøld of royal norwegian navy visby corvettes of royal swedish navy and la fayette class frigates of french navy and propellers propulsors and propulsion shafts along with secondary structures for numerous naval vessels mitra 2010 non planar adhesively bonded composite joints which have the abilities to connect two orthogonally placed members are effective means to realize the marine structural integrity and being increasingly used he 2011 comparing with the bolted joints the load distribution of load is more uniform in bonded joints with less stress concentrations and bonded joints usually present better fatigue resistance gonçalves et al 2002 however the adhesive joints are especially prone to failure at bonded connections due to the material s heterogeneity and geometry s discontinuities in addition the difficulty in predicting joint strength and optimizing structural geometries may somewhat limit their application thus accurate numerical methods capable of predicting the structural failure behavior and strength are necessary for the design and optimization of joints due to the complication both in structures and loadings feih and shercliff 2005a li and lee sullivan 2001 analytical approaches have been proposed to calculate the distributions of stress and strain in composite bonded joints with simple configurations however many assumptions and simplifications are required which make them not applicable for joints with complex configuration such as the studied non planar composite π joints numerous fe and experimental investigations about adhesively bonded sandwich panels have been conducted in literatures bull and edgren proposed a plastic micro buckling method to predict the residual strength of sandwich structures and performed a parametric study on the impact damage resistance and the residual strength of sandwich panels with carbon fiber vinylester faces and pvc foam core bull and edgren 2004 compressive response and failure modes of corrugated core sandwich manufactured by hot press moulding and then bonded to face sheets were experimentally and numerically analyzed by rejab and cantwell 2013 using 3d non linear fe model panigrahi and pradhan 2009 studied influence of the through the width delamination on the delamination behavior of single lap composite joints similarly li et al 2020 also used 3d nonlinear progressive damage fe method to predict the failure strength and modes of hybrid single lap joints castagnetti et al 2010 proposed a fe modelling procedure for analyzing the failure of adhesively t joints kumari and sinha 2002 developed a thick shell element for composite and studied the influence of some critical design parameters including the stacking sequence and the filler area and curvature of filler radius on the ultimate load of t joints bearing pull loading shenoi and hawkins 1992 further highlighted that the mechanical properties of composite t joints under bending loading was greatly affected by the geometry and material type and found that the curved parts were critical for the joints load bearing capability feih and shercliff 2005a 2005b predicted the failure behavior in single l composite peel joints bearing both tensile and bending loadings by a damage model with numerical stabilities optimization on the joints was achieved by changing the filler shape and stacking sequence of the l shaped part kupski et al 2019 investigated the influence of adherend stacking sequence on the tensile failure of bonded joints by experimental and numerical investigations in addition it is well known that there are different types of non planar adhesively bonded joints such as hat joints ji et al 2014 sápi et al 2019 l joints feih and shercliff 2005a t joints da silva and adams 2002 di bella et al 2010 marcadon et al 2006 and π joints as shown in fig 1 which can be applied for the non planar connections of different parts of the ship hull to achieve structural integrity among them the composite π joints were firstly proposed in the rocss robust composite sandwich structures project sheahen et al 1998 and further improved in the cai composite affordability initiative project kan and kane 2002 have already successful applications on the f 35 fighter however experimental and simulated researches reported in open literatures are relatively less than other types of joints some researchers fu et al 2012 zhang et al 2014 zhao et al 2010 have conducted some researches on the composite π joint through progressive damage method failure process of composite π joints bearing tensile load was revealed by numerical analysis zhao et al 2010 the effects of joint configuration stacking sequence and geometric size on the failure process and the strength of composite π joints under bending load were studied and an optimal design scheme of joints was obtained fu et al 2012 zhang et al 2014 the influences of interlaminar reinforcement by stitching on the mechanical capability of composite π joint bearing tensile load was studied and it was found that stitching technique can result in a remarkable improvement on the rupture load zhang et al 2011 considering the peculiar failure characteristics of the deltoid fillers of the composite π joint a modification on the maximum stress criterion for failure evaluation was proposed and corresponding material degradation model was developed for composite π joints zhao et al 2012 the internal load distribution of composite π joints was revealed by a 3d progressive damage analysis model and the failure mechanism of joints was further revealed zhao et al 2013a furthermore the cohesive zone model was applied to model the delaminations between preforms and cracks in the deltoid filler in the non planar woven composite π joint zhao et al 2013b however the cohesive zone model is mostly limited to small scale model due to computational limits in terms of high number of cohesive elements and 3d solid modelling strategy gaiotti et al 2020 in addition zhang et al 2015 proposed an engineering method to evaluate the damages in complex non planar composite π joints they focused on the critical curved parts and used the average failure index as damage indicator to predict the joint ultimate strength all above researches are based on the accurate 3d fe model of composite π joints however complex configuration of π joints and complicated layered structure of composites laminate bring large amount of work of building the 3d fe model and a high computational effort due to refined mesh díaz et al 2010 which makes the 3d fe model not suitable for engineering application considering simple and efficient numerical methods are important for the practical engineering the aim of the work is thus to establish a reduced computational method for the prediction of the damage behavior and strength of composite π joints the novelty of this work is that a 2d material model based on orthotropic elastic mechanics and the assumption of plane strain is established combining with the progressive damage method an effective numerical framework is proposed which can bring accurate predictions on the failure behavior of composite π joints in a simple and efficient way the accuracy of the material model on calculating the distribution of stress strain along the central surface of the bond layer in the single lap adhesive joint is validated subsequently non planar composite π joints fabricated by cfrp prepregs are designed and static tensile tests are carried out the proposed material model is applied in a 2d fe model integrating the progressive damage method to predict the damage behavior and joint failure strength the comparisons between test results and numerical results in terms of failure mechanism and load displacement response are used to validate the applicability of the numerical method in this study 2 materials and methods 2 1 description of the composite π joint the detailed configuration and geometry parameters of the studied composite π joint which uses the unidirectional t700 qy8911 composite materials are shown in fig 2 the non planar adhesively bonded π joint allows the connections between laminated panels and honeycomb sandwich panels with cfrp skins and different materials for core kevlar honeycomb core and gfrp core table 1 lists the geometric sizes of joints the π shaped over laminate consists l shaped prepreg and u shaped prepreg which are both made of carbon prepreg with stacking sequence of 45 0 45 the π shaped over laminate is firstly co cured with the skin and secondary bonded with the pre cured web plates along the vertical direction fig 3 shows the detailed lay up information about the π over laminate the skin and the web are sandwiched structures with 8 plies of unidirectional carbon fiber reinforced plastics ud cfrp on both sides the thickness of the web core is 4 5 mm two types of material are used in the web core for the part from the top of web core downwards to a location with a distance of 50 mm the used material is glass fiber reinforced plastic gfrp for clamping facilitation the material used for the rest part of the web core is kevlar honeycomb with a hexagon cell size of 2 mm the thickness of the skin core is 3 mm and the used material is gfrp the stacking sequences of the face sheets in the web and the skin are 90 90 45 45 s and 45 0 45 90 s respectively the two fillers are formed by prepregs of the unidirectional t700 qy8911 composite materials and the fiber is arranged in the joints transverse direction table 2 lists the basic material properties of the ud cfrp lamina fig 4 illustrates the experimental scheme of the static tensile test on composite π joints the tests are carried out on a hydraulic testing machine instron 8803 with a capacity of 10 kn a tensile load with displacement controlling mode is applied at the top end of the web at an even loading speed of 1 2 mm min to conduct the tensile test the π joint should be fixed here the both end of skin plates are clamped by two rigid plates which are connected to the rigid brackets by bolts the centers of both rigid plates have a distance of 160 mm three samples are tested and loaded until the ultimate failure occurs the displacement of the crosshead and the applied load are automatically recorded by the self equipped sensors 2 2 analysis method combining 2d material model and pdm a ply by ply discretized 2d fe modelling is combined with the progressive damage method for a fast and efficient failure prediction of composite joints to achieve this a 2d material model is developed which can provide equivalent material engineering constants for the modelling of composite plies with various fiber angles details on the 2d material model can be found in the appendix in progressive damage method the failure evaluation criterion and material degradation model are two important aspects liao et al 2020 in this study the failure evaluation criterion based on maximum stress as shown in eq 1 is used to evaluate the damages in composite π joints using this failure evaluation criterion the fiber failure intralaminar failure interlaminar failure and shear out failure can be assessed the interlaminar failure i e the delamination can be evaluated by comparing the value of σ 3 with the strength in the through thickness direction in addition the initial damage and the delamination will be influenced by the adhesive around the critical deltoid areas the load at which a material in the joints first fails in any above failure forms is the initial damage load 1 fiber failure σ 1 x t 1 σ 1 0 σ 1 x c 1 σ 1 0 intralaminar failure σ 2 y t 1 σ 2 0 σ 2 y c 1 σ 2 0 interlaminar failure σ 3 z t 1 σ 3 0 σ 3 z c 1 σ 3 0 shear out failure τ 12 s 12 1 τ 13 s 13 1 τ 23 s 23 1 as regarded to the material degradation model camanho material degradation model camanho and matthews 1999 is adopted and the model is as following 2 m a t r i x t e n s i l e s h e a r o u t f a i l u r e e 2 d d 2 t e 2 g 12 d d 4 t g 12 g 23 d d 4 t g 23 f i b e r t e n s i l e f a i l u r e e 1 d d 1 t e 1 m a t r i x c o m p r e s s i o n s h e a r o u t f a i l u r e e 2 d d 2 c e 2 g 12 d d 4 c g 12 g 23 d d 4 c g 23 f i b e r c o m p r e s s i o n f a i l u r e e 1 d d 1 c e 1 where d 1 t 0 07 d 2 t d 4 t 0 2 d 1 c 0 14 d 2 c d 4 c 0 4 the superscripts t and c mean the tensile case and the compressive case respectively the d means the degraded material property because the fem in this study is a 2d model and the stresses from the 2d fe model refer to the off axis coordinate system o xyz which corresponds to the geometry configuration of composite π joints while the failure evaluation criterion and the material degradation rules are specific to stresses and material engineer constants of the principle axes so the failure evaluation criterion and the material degradation rules should be transposed to the 2d plane for further analysis for the lamina with a ply angle of 0 the failure modes involve the fiber failure the inter laminate matrix failure and the shear out failure of τ 13 for the lamina with a ply angle of 90 the failure modes involve the intralaminar and interlaminar matrix failure and shear out failure of τ 23 when considering the lamina with a ply angle of 45 the situation becomes complex as the fiber of the lamina is oblique referred to the 2d plane in this study the stresses of the lamina with a ply angle of 45 are transposed to the three principle axes so the fiber failure the intralaminar and interlaminar matrix matrix failure and shear out failure of τ 13 and τ 23 can be included as detailed in the appendix the matrix element can be expressed as 3 d 1 1 e 1 2 e 1 e 2 ν 1 2 2 d 1 2 d 2 1 e 1 e 2 ν 1 2 e 1 e 2 ν 1 2 2 d 2 2 e 1 e 2 e 1 e 2 ν 1 2 2 d 3 3 g 1 2 the relation between the poisson s ratio and the equivalent elastic modulus of 2d equivalent material parameters is as following 4 e 1 e 2 ν 1 2 ν 2 1 if defining λ e 1 e 2 ν 1 2 2 e 1 1 ν 1 2 ν 2 1 d 1 1 d 1 2 d 2 1 d 2 2 and d 3 3 can be expressed as 5 d 1 1 e 1 1 ν 1 2 ν 2 1 d 1 2 d 2 1 e 2 ν 1 2 1 ν 1 2 ν 2 1 d 2 2 e 2 1 ν 1 2 ν 2 1 d 3 3 g 1 2 by introducing β 1 ν 1 2 ν 2 1 the following equations can be obtained 6 d 1 1 e 1 β d 1 2 d 2 1 e 2 ν 1 2 β d 2 2 e 2 β d 3 3 g 1 2 as the poisson s ratio is small so β 1 therefore the d 1 1 d 2 2 d 3 3 d 1 2 mainly depend on the e 1 e 2 g 1 2 e 2 and ν 1 2 respectively the stress failure criterion and material degradation rules for laminas with different ply angles used in the 2d progressive damage analysis are listed in table 3 in the umat subroutine the degradation of the material constitutive relation is realized by multiplying the element of the equivalent stiffness matrix d i j in the 2d plane by the corresponding degradation coefficient 3 verification on the two dimensional material model before applying the analysis method for failure prediction in composite joints the 2d material model is firstly verified in this section by comparing the numerical results with experimental results of a single lap adhesive joints the joints have the same joint configuration as the one studied by tsai and morton 1995 with the material model mentioned above the 2d fem of single lap adhesive joints can be established 3 1 joint configuration and fe model fig 5 shows the joint configuration and geometric sizes of single lap adhesively bonded joints the length l is 101 6 mm the width b is 25 4 mm and the overlap length 2c is 25 4 mm the material of the upper and lower composite adherends are graphite epoxy xas 914c the basic material constants are as follows e 1 138 gpa e 2 e 3 9 4 gpa v 12 v 13 v 23 0 31 g 12 g 13 g 23 6 7 gpa the thickness of each ply is 0 25 mm epoxy adhesive hexcel redux 308a with a thickness of 0 13 mm is used for adhesive layers whose elastic modulus is 3 0 gpa and poisson ratio is 0 31 a 20 mm long left end of the lower arm is clamped the right end of the upper arm is pulled in the length direction of a joint with a displacement of 10 mm according to the proposed material model as presented in section 2 1 equivalent engineering constants can be calculated and listed in table 4 for plies with different orientations a 2d numerical model of single lap adhesively joints is built when establishing the 2d numerical model equivalent material properties for different composite layers are assigned to each ply section respectively in addition various mesh densities are defined for different joint s regions in order to ensure the results are mesh independent mesh sizes are refined at the overlap region and at the regions around two ends of adhesive where serious stress concentration may exist the mesh sizes at other regions are relatively coarser to save computational cost four elements are set in the adhesive layer through the thickness direction 3 2 results and discussions when analyzing the single lap adhesively bonded joint most early studies focus on the adhesive layer because the adhesive quality is not good at that time failures in adhesively bonded joints are almost caused by the damages in the adhesive which is the weakest part thus in this study the shear strain and the peel strain of the middle plane of the adhesive layer are studied the results of the shear strain and the peel strain are extracted from the 2d numerical model and compared with the experimental results as shown in fig 6 from this figure it is obvious that the shear strain is always negative at the whole overlap and has a nonlinear relation with x c with the increase of x c the strain initially increases slowly from a low value of about 0 29 towards the end of adhesive the slope of the strain curve increases and the strain quickly arrives a maximum value of 3 1 good agreements exist between the shear strain distribution at the middle plane of the adhesive layer from the 2d fe model and tests in addition the maximum value of the shear strain from the 2d model is very close to the experimental one only 0 4 lower fig 6 also shows the peel strain at the middle plane of the adhesive layer from the 2d fe model and its comparison with the experiment result the peel strain is constant at a value of 0 01 within the range of 0 x c 0 35 with further increase of x c the strain increases slowly until a maximum value of 0 21 at x c 0 9 subsequently the strain decreases to zero and later quickly increases to a large positive value of 0 3 at the end of adhesive it can be seen that the peel strain distributions of the adhesive layer from the 2d fe model also show great agreements with the experimental results and the maximum peel strain from the 2d fe model is very close to the experimental one totally the 2d numerical model adopting the two dimensional material model can accurately reveal the strain distribution in the adhesive layer of the single lap adhesively bonded joint 4 failure prediction of non planar composite π joint in this section a 2d numerical model is established for composite π joints under static tensile loading by using the equivalent engineering constants calculated by the material model proposed in section 2 a progressive damage analysis is conducted with a user defined material subroutine in order to determine the joints failure strength the 2d equivalent maximum stress criterion proposed for the lamina with different ply angles is applied and a material degradation method based on the camanho s material degradation model is adopted as listed in table 3 the elastic response ultimate failure load and post elastic behavior of composite π joints are predicted and compared with experimental results 4 1 the fe analysis model a 2d fe model is established in commercial fe software abaqus which adopts the cpe4 elements in 2d fe model the composite laminate is modelled ply by ply using the 2d equivalent engineering constants of each lamina as listed in table 5 one element is set for each composite ply and four elements for the adhesive layer along the thickness direction in order to capture accurate inter laminate stress the bonding region of the straight legs and the horizontal legs i e the intersection of the joint including two triangle areas including fillers is the critical part of the out of plane π joint thus special attention should be paid to its modelling to avoid the effect of large angular and aspect ratio distortions of the elements the mesh in the intersection of joints is refined to ensure that the mesh subdivision has almost no effect on the stress concentration finally a fine mesh as shown in fig 7 is adopted the constraints of the 2d fe model are set according to the realistic loading conditions the displacement control mode load is simulated by applying a gradually increased pull off displacement loading at the top surface of the straight leg to achieve this the constraint type equation is employed to couple the top surface of the straight leg with a reference point on the top surface which allows the reference point and the top surface with identical degrees of freedom a certain displacement is then set at the reference point along the z axis direction the nodes on the two ends of the skin plate about 20 mm length are fixed to represent the clamping arrangement used during tests fig 7 illustrates the fe model and the loading and boundary conditions of the composite π joint based on the section 2 a progressive damage analysis for the 2d fe model by compiling a user defined material subroutine in abaqus is conducted to determine the ultimate failure load of joints 4 2 experimental results three specimens are tested to understand the mechanical behavior of composite π joint under tensile loading they are loaded continuously until the ultimate failure the damage and failure procedures of the tests are recorded by video and photographs in order to relate the failure events to the load displacement curve initial damage is characterized by noise emitted during loading and a trivial load drop in the load displacement curve final failure is observed and characterized by the maximum load on the load displacement curve fig 8 shows the experimental load displacement curves at the elastic stage the load increases linearly with the applied displacement when damages occur in the joint non linearity exhibits on the load displacement curve and the load increases slowly with stiffness reduction from the initial to the final failure when the maximum load is arrived the load decreases quickly after the ultimate failure happening in the joint the ultimate loads and displacements of the three samples recorded in the experiment are summarized in table 6 the average value of the ultimate loads is 3 78 kn and the standard deviation s d is 0 28 kn the average value of the displacements corresponding to the ultimate failure is 4 34 mm with a s d of 0 08 mm although the three specimens are made by the same manufacturing and processing technique and there is no detected defect during the nondestructive testing the experimental data shows a certain degree of scatter this suggests that there are many factors that will have influence on the initial damage and growth mechanism due to the complex geometry of the composite π joint local variations in material disposition and uncertain material properties from location to location to reflect the determinate and random factors in the tests the average experimental value is provided to verify the following numerical prediction fig 9 further shows the damage states of one representative specimen at the initial the middle and the final failure stages during the experiment the specimen fails initially by delamination within the interface between right l shaped prepreg and the filler with slight cracking and then the crack shown in fig 9 a can be observed the point of crack generation is difficult to identify due to the speed at which the failure occurs subsequently the crack grows toward the base prepreg some wrinkles can be observed on the outer surface of the right l prepreg corner with further increase of load the crack grows slowly in the filler with continued crackling and tearing sounds subsequently a new crack between the left l prepreg and filler occurs more opening cracks and further propagation in the right part of joint can be observed obviously as shown in fig 9 b final failure of the joint occurs when the right crack penetrates throughout the filler and the base prepreg delaminates as shown in fig 9 c of the back face of the joint 4 3 numerical results numerical results are also shown in fig 8 for comparison the red curve illustrates the numerical load displacement relationship the responses from the numerical and experimental results agree well at the linear elastic stage linear elastic load displacement response at the initial stage implies the joint carries displacement load steadily the numerical curve is smooth without some trivial drop off as in the experimental curve when the initial damage is detected subsequently with the increasing displacement loading the structural stiffness gradually decreases due to damage initiation and growth the joint continues to carry higher load until a maximum load of 3 85 kn finally a sudden huge load drop occurs due to the catastrophic failure with dramatic reduction in joint stiffness indicating the final failure of composite joints it can be seen that trivial differences exist at the following damage evolution stage totally the failure behavior of the composite π joint predicted by fem agrees favorably with the experimental data during the whole process summaries of the final failure load and corresponding displacement predicted by the numerical model are presented in table 6 and compared with the experimental values the ultimate failure load of the numerical prediction is 3 85 kn with a corresponding displacement of 4 26 mm good agreements between the experimental and numerical results have been achieved with relative errors less than 2 the ultimate failure load of numerical prediction is slightly larger than the mean value of the experimental results this maybe resulted by some defects existing in the real joint structure while the fe model is an ideal model of the real structure totally the numerical method proposed in this study is capable for accurately predicting the failure behavior and strength in composite π joints furthermore numerical results show that the initial damage occurs at the interface the l prepreg and the filler as observed in experiments fig 10 shows the final deformation shape of the composite π joint and the failure status of the typical part of π joint obtained by the fe analysis the gray region indicates the failed parts the damage states are symmetric about the center axis of the joint the damages in the deltoid fillers l shaped prepreg and the interface between the skin and the base prepreg are obvious to be observed which agree well with the experimental results the analysis method developed in this study is efficient with less computation time while without lowering the accuracy this reduction of freedom degrees of the model is particularly remarkable if compared with the 3d fe model although reduced computational time can be achieved by 2d fe model the presence of internal defects and failure along the panel width are not able to be considered better results could be obtained considering the whole stress strain curve of the investigated materials however experimental results usually exhibits some scatters and the predicted results locates within the range of the experiment results which is suitable for the engineering application in conclusion the proposed analysis method is simple efficient and accurate to predict the failure behavior in composite bonded structures it is worthwhile to point that the extended finite element method xfem abdullah et al 2017 zhao et al 2017 and cohesive zone model czm cao et al 2020 gong et al 2017 2020 kaushik and ghosh 2019 yin et al 2020 have been gradually applied for modelling the intra inter laminar damages in composite structures which should be interesting to combine both methods for the failure predictions of composite joints in the future work in addition due to the complex mechanical behavior and many influencing factors theoretical approaches for the failure prediction of the non planar composite π joints are lack of which is still a challenge 5 conclusions this paper presents a reduced computational method based on standard numerical techniques to predict failure behavior in non planar bonded structures a 2d material model is proposed and a ply by ply discretized 2d numerical model of a single lap adhesive joint is built by using equivalent engineering constants calculated by the material model to validate the proposed material model the distributions of the shear strain and the peel strain of the middle adhesive layer extracted from the 2d numerical model are compared with the experimental results good agreements are obtained which initially verifies the accuracy of the 2d material model in addition a 2d numerical model for the non planar composite π joint under static tensile load is established which uses the equivalent engineering constants calculated by the 2d material model the elastic response ultimate failure load and post elastic loading softening behavior of composite π joints are well predicted combining a progressive damage analysis the reduced computational method has much less degree of freedoms and runs faster than a full 3d fe model thus this efficient method is simple and efficient for the failure prediction in complex non planar bonded structures and has good prospect for engineering applications credit authorship contribution statement yongxiang zhang methodology software writing original draft linfei jiang investigation formal analysis writing original draft yu gong conceptualization writing review editing funding acquisition project administration supervision hao liu resources formal analysis jian zhao formal analysis methodology writing review editing sue ren resources formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research work is supported by the national natural science foundation of china project no 11902054 and the chongqing natural science foundation project nos cstc2018jcyjax0235 cstc2019jsyj yzysbax0015 and cstc2019jscx zdztzxx0028 the fundamental research funds for the central universities project no 2020cdjgfhk009 the laboratory of pression manufacturing technology of the china academy of engineering physics project no zm18004 the aeronautical science foundation of china project no 201909038001 the innovation foundation of sast project no sast202020 the natural science foundation of shanghai project no 20zr1462600 and the foundation of state key laboratory of automotive simulation and control project no 20201202 appendix the two dimensional material model used in this study is based on the orthotropic elastic mechanics theory and the plane strain assumption zhao et al 2014 for an arbitrary unidirectional composite ply there is three principal axes as shown in fig 11 a i e the 1 axis 2 axis and 3 axis which are along the longitudinal the transverse and the interlaminar direction respectively the off axis coordinate system o xyz corresponds to the structural geometry configuration including x axis y axis and z axis which are along the length direction the width direction and the thickness direction according to the orthotropic elastic mechanics theory a single ply of the composite laminate in the coordinate system o 123 can be regarded as transverse isotropic material its constitutive relation can be expressed by a 1 ε 1 ε 2 ε 3 γ 23 γ 31 γ 12 s 11 s 12 s 12 0 0 0 s 21 s 22 s 23 0 0 0 s 21 s 32 s 22 0 0 0 0 0 0 2 s 22 s 23 0 0 0 0 0 0 s 66 0 0 0 0 0 0 s 66 σ 1 σ 2 σ 3 τ 23 τ 31 τ 12 where s ij i j 1 2 3 4 5 6 are the compliance matrix elements which are related to the basic material constants of the composite lamina e 1 e 2 ν 12 ν 23 and g 12 the eq a 1 can be simplified into the following form a 2 ε s σ if the referenced coordinate system is changed from the o 123 to the o xyz the new constitutive relation can be expressed by a 3 ε s σ where ε ε x ε y ε z γ yz γ zx γ xy t and σ σ x σ y σ z σ yz σ zx σ xy t are the off axis strain and the off axis stress vectors in the o xyz respectively the compliance matrix s is the off axis compliance matrix and can be expressed by a 4 s t ε 1 s t σ where s t σ and t ε are the compliance matrix the stress transformation matrix and the strain transformation matrix respectively t σ and t ε can be expressed by a 5 t σ m 2 n 2 0 0 0 2 m n n 2 m 2 0 0 0 2 m n 0 0 1 0 0 0 0 0 0 m n 0 0 0 0 n m 0 m n m n 0 0 0 m 2 n 2 t ε m 2 n 2 0 0 0 m n n 2 m 2 0 0 0 m n 0 0 1 0 0 0 0 0 0 m n 0 0 0 0 n m 0 2 m n 2 m n 0 0 0 m 2 n 2 in the above equation m cosθ n sinθ the definition of the ply orientation angle θ is shown in fig 11 a the eq a 3 can be transposed as a 6 σ s 1 ε c ε in the off axis coordinate system o xyz as shown in fig 11 b a ply of composite laminate is an orthotropic body where the x o y is its symmetric plane the off axis compliance matrix s and stiffness matrix c have the following forms a 7 s s 11 s 12 s 13 0 0 s 16 s 12 s 22 s 23 0 0 s 26 s 13 s 23 s 33 0 0 s 36 0 0 0 s 44 s 45 0 0 0 0 s 45 s 55 0 s 16 s 26 s 36 0 0 s 66 c c 11 c 12 c 13 0 0 c 16 c 21 c 22 c 23 0 0 c 26 c 31 c 32 c 33 0 0 c 36 0 0 0 c 44 c 45 0 0 0 0 c 54 c 55 0 c 61 c 62 c 63 0 0 c 66 the transverse middle plane of the composite ply satisfies the plane strain condition sørensen et al 2008 therefore for the composite ply the out of plane strain in the x o y plane is zero a 8 ε y 0 γ y z 0 γ x y 0 substituting eq a 8 into eq a 6 the constitutive relation in the x o z plane can reduce to a 9 σ x σ z τ x z c 11 c 13 0 c 31 c 33 0 0 0 c 55 ε x ε z γ x z inverting eq a 9 the relation between the strain and the stress could be expressed by a 10 ε x ε z γ x z s 11 s 12 0 s 12 s 22 0 0 0 s 33 σ x σ z τ x z where s ij i j 1 2 3 is a group of compliance coefficients of the compliance matrix in the plane of x o z the constitutive relation as eq a 10 could be used for 2d element which is the stress strain relation in terms of the off axis coordinate system x o z which is applicable for the elements in the transverse middle plane of the composite laminated adherend in plain stress elements as shown in fig 11 c an equivalent coordinate with equivalent principal axis 1 and axis 2 is established the constitute relationship in the plain stress element is expressed as a 11 σ 1 σ 2 τ 1 2 d 1 1 d 1 2 0 d 2 1 d 2 2 0 0 0 d 3 3 ε 1 ε 2 γ 1 2 introducing e 1 e 2 ν 1 2 and g 1 2 as equivalent engineering constants respectively corresponding to equivalent principal axis 1 and axis 2 considering the symmetry of the stiffness matrix a stress strain relationship can be derived from eq a 11 a 12 ε 1 ε 2 γ 1 2 1 e 1 ν 1 2 e 1 0 ν 1 2 e 1 1 e 2 0 0 0 1 g 1 2 σ 1 σ 2 τ 1 2 comparing eq a 10 with eq a 12 and making the components in both compliance matrixes same we can obtain a 13 e 1 1 s 11 e 2 1 s 22 ν 1 2 s 12 s 11 g 1 2 1 s 33 where the e 1 e 2 ν 1 2 and g 1 2 are equivalent engineering constants of composite layers in transverse middle plane the material model presented as eq a 13 is applicable when the assumption of plane strain is satisfied 
21063,reliable onboard stability assessment for a damaged ship is of great importance to ship operators this paper presents a practical method to calculate ship s damage stability directly from the full three dimensional 3d geometric models in which the method of lost buoyancy is used first the computational database is established by cutting the 3d models of hull and compartments in transverse direction according to ship s frame distance table then trapezoidal rule integration method is adopted to calculate ship s volumetric data after that the centre of gravity of liquid loads is calculated using newton s iterative method finally ship s equilibrium state of balanced trim and draft for a given heel angle is determined using a successive linear method and the right level could be obtained lloyd s register lr test cases for iacs ur l5 type 1 2 and 3 are used to verify the proposed method in every stage of the test program the method achieves a high accuracy result and thus can be used onboard to calculate intact stability and damage stability of ships by direct application of preprogrammed damage cases especially for bulk carriers and tankers graphical abstract image 1 keywords damage stability floatability lost buoyancy method numerical method for ship motion deterministic damage stability assessment 1 introduction although remarkable efforts have been made to improve the safety of ships in recent decades maritime accidents still occur a total of 7391 serious maritime accidents occurred from 2000 to 2012 according to eliopoulou et al 2016 in most maritime accidents such as collisions groundings etc the hull is breached which causes flooding of various compartments the ship subsequently changes her draft and trim heels loses some stability or even capsizes therefore reliable onboard damage analysis is of great importance to ship operators before sailing and during a real accident calculation of ship s damage stability has constituted a large amount of the research effort in recent years papanikolaou 2007 reviewed scientific and regulatory developments around the damage stability of ships aimed to address serious concerns regarding the adopted probabilistic formulation for the calculation of the survival probability of passenger ships the european commission fp7 dg research funded a research project named goal based damage stability goalds 2009 2012 papanikolaou et al 2013 outlined the objectives the methodology of work and the main results of this project choi et al 2014 studied the methodologies available for damage safety assessment considering environmental conditions and their application fernández 2015 proposed a comparative analysis of the different criteria of stability after damage boulougouris et al 2016b described limitations of the current semi empirical deterministic criteria on which a combatant s damage stability is assessed and presented a new probabilistic approach to assess the damage stability of a naval combatant boulougouris et al 2016a provided some elaborations on the current state of affairs with regards to operational measures relating to damage stability and safety cichowicz and murphy 2016 presented an alternative to the solas formulation for assessing damage survivability of passenger ships ruponen and lindroth 2016 presented an advanced approach using time domain flooding simulation for calculation of the intermediate stages of flooding within the context of the safety of life at sea solas 2009 regulations krüger 2016 used numerical tools to compute intermediate stages of flooding during design and to carry out numerical investigation of marine casualties bačkalov et al 2016 and manderbacka et al 2019 provided extensive reviews of the findings published in the international conference on the stability of ships and ocean vehicles stab and the international ship stability workshop issw proceedings from 2009 to 2018 ruponen et al 2017 presented a new approach to breach assessment based on measurement data from flood level sensors ruponen et al 2018 used three alternative methods including conventional method time domain flooding simulation with damaged compartments treated as lost buoyancy and simulation with the breach modelled as openings to develop a more realistic assessment of the intermediate stages of flooding andrei et al 2018 analysed the damage stability of a multipurpose cargo ship in some particular flooding situations hu et al 2019 investigated two methods that can be used to research the capsizing probability in the time domain which mainly focuses on the nonlinear righting lever gz curve solution mauro et al 2019 generated a database of compressed natural gas ships starting from a baseline hull and described two approaches to identify the compliance of a ship with the intact stability regulations based on the ship s main geometrical quantities ruponen et al 2019 presented a new approach for analysing the level of survivability for a passenger ship in the event of collision damage to be used onboard methods for ship s damage analysis must fulfill the related requirements of statutory regulations e g solas chapter ii 1 imo 2017 the international convention for the prevention of pollution from ships marpol annex i regulation 28 marpol 2016 etc the international maritime organization imo has released the guidelines for verification of damage stability for different kinds of ships e g msc 1 circ 1461 for tankers imo 2013 msc 1 circ 1589 for passenger ships imo 2018 etc the international association of classification societies iacs defines four different types of calculations performed by stability software in the unified regulations regarding onboard computers for stability calculations iacs 2017 it should be noted that type 3 software is to include pre defined relevant damage cases while type 4 is associated with a loading condition and actual flooding case and thus can provide operational information for safe return to port srtp however only stability software installed on passenger ships covered by the srtp and built after 2014 is required to have the capability of srtp imo 2018 nowadays major classification societies provide procedures to evaluate and authorize the stability software for use onboard specific ships based on iacs 2017 although several commercial loading computer software have been developed and used onboard to help ship operators to assess ship s damage stability the detail of the calculation methods used in these software has rarely been published this paper presents a deterministic method to assess ship s damage stability especially for bulk carriers and liquid tankers the proposed method calculates ship s damage stability directly from ship s three dimensional 3d design data the establishment of computational database is presented firstly then the integration method is introduced next the method for calculating the centre of gravity of liquid loads is given after that the method for the assessment of ship s damage stability in flooding condition is proposed finally lloyd s register lr test cases for iacs ur l5 type 1 2 and 3 are presented with discussion and analysis of the results 2 mathematical formulations 2 1 establishment of computational database computational database is the foundation of high accuracy calculation of ship s damage stability the conventional numerical representation of hull form is the table of offsets which is a pair of 2d tables showing curve and surface coordinates at locations specified in the lines plan normally the table of offsets contains half breadths measured at the stations and on the waterlines appearing in the lines plan therefore it is not dense enough to support the accurate calculation of ship s damage stability this paper addresses this problem by using a denser table of offsets which is based on 3d models of the hull and compartments designed by the shanghai merchant ship design and research institute sdari in sdari all buoyant parts of the ship including the hull tanks void spaces etc are modelled as a 3d mesh in stl file format i e having stl as the file extension which can be exported from common computer aided design cad software the stl file format is supported by nearly all major cad systems and has been widely used by most rapid prototyping systems this format is generated from a precise cad model using a process known as tessellation which generates triangles to approximate the cad model the stl file can be of ascii or binary format in each file triangular surfaces are described by a set of x y and z coordinates for each of the three vertices and a unit normal vector different 3d models of a 38 000 dwt chemical tanker sc aquarius designed by sdari are illustrated in fig 1 transverse sections are the standard representation of the envelope of a vessel for purposes of hydrostatic analysis with the 3d stl hull model raw transverse sections of the hull at each frame can be obtained by cutting the hull model in transverse direction according to ship s frame distance table along the x coordinates of structural frames similarly raw transverse sections of compartments at each frame are acquired by cutting the 3d models of the compartments in transverse direction as illustrated in fig 2 since the stl models are represented by triangle meshes these raw transverse sections are actually collections of piecewise linear curves in different transverse planes and inevitably have lots of redundant vertices which will reduce the computational efficiency of assessing a ship s damage stability in this paper a simultaneous curve simplification algorithm presented by dyken et al 2009 is used to address this problem this algorithm is based on measuring the distance between points and curves using variations over the euclidean norm in addition to relationships between points and curves which can be efficiently found by using triangulations the distance between the curve and its approximation is within a prescribed tolerance so as to keep the original information in this way simplified transverse sections of the hull and compartments are obtained by using fewer segments than the raw transverse sections take transverse section at frame 58 of the chemical tanker sc aquarius as an example the number of the points in this section is simplified from 140 to 57 with the threshold of 0 005m where almost 60 of the points in the raw transverse section is removed as shown in fig 3 the final step which is also the most important one in the establishment of the computational database is to make sure that it is appropriate for the assessment of ship s damage stability in this paper the acceptable tolerance proposed by iacs is adopted according to iacs 2017 programs which use hull form models as their basis for stability calculations shall have tolerances for the printouts of basic calculated data established against either data from the approved stability information or data obtained using the approval authority s model the acceptable tolerance for different kinds of data may differ from one another e g 2 for displacement the maximum of 1 or 50 cm for longitudinal centre of buoyancy from ap etc 2 2 numerical integration since the computational database is composed of discrete transverse sections at ship frame stations numerical integration is inevitably used to calculate ship s displacement volume of water in flooded compartment etc it should also be mentioned that ship s frame stations are not uniformly distributed along the x coordinates of structural frames normally the frame distance dfr in midship is slightly larger than that in bow or stern parts of frame distance table of the chemical tanker sc aquarius is shown in table 1 many different methods have been applied and used in an attempt to solve numerical integration for unequal data space among them trapezoidal rule and simpson s rule are widely used according to the finding of dhali et al 2019 trapezoidal rule gives comparable result with simpson s 1 3 rule and much better than simpson s 3 8 rule for unequal data space in most cases however it s more convenient to use trapezoidal rule since simpson s 1 3 rule can only be used when the interval number is even therefore trapezoidal rule is used for numerical integration in this paper of which we give an overview here given a set of data points x 0 y 0 x 1 y 1 x n y n of a function y f x where f x is not known explicitly using trapezoidal rule dhali et al 2019 the value of definite integral can be described as follows 1 x 0 x n y d x 1 2 x 1 x 0 y 0 x 2 x 0 y 1 x n x n 2 y n 1 x n x n 1 y n based on the computational database trapezoidal rule integration method is used to calculate the volumetric data of ship s hull and compartments with an acceptable tolerance comparisons of calculated volumetric data with those provide by the loading manual of the chemical tanker sc aquarius at different draft are shown in table 2 in which volt is the total volume of ship s displacement including shell thickness etc from this table it can be seen that the maximum relative error is only 0 1 which is far below 2 the related acceptable tolerance of iacs 2017 2 3 calculation of centre of gravity of liquid loads when the hull is breached water floods the compartments in the ship s hull which subsequently changes the ship s flotation and stability to analyse ship s damage stability reliably using either the lost buoyancy method or the added weight method it is essential to calculate how much water floods the compartment and to determine the centre of gravity of the flood water in case that a damaged compartment is loaded with liquid loads there might be a flow between the flooded compartment and the sea if the surface of the liquid is higher than that of the external water surface the part of the liquid which is above the external water surface will run out of the compartment gradually otherwise the compartments will be filled with sea water in the equilibrium state it is assumed that the liquid is totally replaced by sea water and the density of the cargo is changed to that of the sea water which in turn changes the ship s flotation for intact compartments with partial liquid loads the real physical shift of liquid loads must also be taken into account in the process of calculating the gz curve since the free liquid surface is always horizontal no matter how the ship is heeling or trimming the shift of liquid cargo in a cargo hold of chemical tanker sc aquarius is illustrated in fig 4 in the above two cases the key point is to determine the height of the liquid surface of the liquid holds under the ship s free flotation after that the new centre of gravity can be obtained using a numerical method the volume of the liquid load in an intact compartment is kept constant in this process which can be described as follows 2 f 1 h v v 0 0 where h is the height of the surface of liquid holds in the direction which is vertical to the sea water surface v is the calculated volume of liquid holds using the height of liquid holds v 0 is the original value of the volume of liquid holds in this paper newton s iterative method is used to solve this nonlinear equation kelley 2003 the idea is to set an initial value of the height of liquid holds firstly then use the first order derivative or jacobin matrix to update the value again and again until the value converges using taylor expansion at point h k which is the result of h in step k eqn 2 can be rewritten as follows 3 d f h k h h k f h k v 0 k 0 1 2 where d f h k d v d h s h and s h is the liquid surface projection area on the base plane therefore the updated value of the height of the surface of liquid holds in the next step would be 4 h k 1 h k v 0 f h k s h given the ship s flotation and the volume of liquid holds initial height of liquid holds is obtained by interpolation with the tank capacity table assuming the ship is in mean draft which makes the iterative process stable and fast then the calculated volume of liquid holds in this step is obtained by numerical integration after that the relative error between the new volume and the true volume of liquid holds is calculated and then used to decide whether the algorithm stops or not if the relative error is sufficiently small the algorithm outputs the height of the liquid holds and then stops otherwise the algorithm changes the height with the ratio of the volume error to the liquid surface projection area and reruns the algorithm until the relative error is acceptable the flowchart of this algorithm is shown in fig 5 experiments show that this method is fast and robust with the final result normally obtained in 3 5 iterations this contributes much to the computational efficiency of methods to assess a ship s damage stability since there can be a lot of liquid holds which need to be considered during the flooding process 2 4 assessment of ship s damage stability in a flooding condition unlike the calculation of ship s intact stability which is trivial the assessment of ship s damage stability is complex since the flow between the flooded compartment and the sea makes the ship s flotation and the flood water coupled the movement of liquid holds makes the situation even more complicated once the initial load condition and damage cases are defined ship s damage stability is normally evaluated by firstly fixing the heel angle then balancing the trim angle free trim and the draft and finally calculating the gz curves in the fixed heel angles it is essential that the trim angle should be balanced in the calculation of the gz curve in order to avoid over optimistic results as pointed out by pawłowski 2016 and ruponen et al 2018 by repeating this procedure for a range of heel angles the righting lever curve can be obtained in practice two different methods for analysis of damage stability are commonly used the method of lost buoyancy and the method of added weight tupper 2013 in the method of lost buoyancy the buoyancy of flooded compartments is reduced with the permeability taken into account and this method is more suitable for the final stage of flooding in damage cases ruponen et al 2018 so this paper uses the method of lost buoyancy to assess a ship s stability in the equilibrium state of damage condition for a given fixed heel angle the equilibrium state of balanced trim and draft can be described as follows 5 f 1 t m ψ ρ v s δ 0 f 2 t m ψ x b x g y b y g sin θ cos θ tan ψ z b z g cos θ cos θ tan ψ 0 where t m and ψ are the draft and trim angle of the ship respectively ρ is sea water density v s is the submerged volume δ is the ship s displacement x g y g and z g are the centres of gravity x b y b and z b are the centres of buoyancy θ is the given heel angle of the ship a successive linear method is used to solve nonlinear equation eqn 5 this equation can be recast in vector form as described in eqn 6 note that the tangent value of trim angle instead of trim angle is used as a variable to be determined for the convenience of solving this problem 6 f x f 1 x f 2 x 0 where x t m tan ψ using taylor expansion at point x k eqn 6 can be recast as follows 7 f 1 x k t m f 1 x k tan ψ f 2 x k t m f 2 x k tan ψ δ t m k δ tan ψ k f 1 x f 2 x 0 where the jacobian matrix in eqn 7 can be calculated similarly to the method proposed in our previous work shen et al 2020 after the equilibrium state of balanced trim and draft has been determined the right level could be calculated the flowchart of calculating right level in damage cases is shown in fig 6 in this paper the thresholds for the increments of draft and tangent value of trim angle are set to 0 001m and 0 001 respectively according to our experiments this method could converge in 3 9 iterations another thing should be mentioned is the assessment of ship s stability in different intermediate stages and phases during the flooding process as pointed out by papanikolaou 2007 transient flooding phenomena which are relevant to the damage stability of a ship should also be considered in an assessment procedure imo 2017 states that for each damage scenario the damage extent and location determine the initial stage of flooding calculations should be performed in stages each stage comprising of at least two intermediate filling phases in addition to the full phase per flooded space the concept of stage is related to the damage case describing the internal structure of the flooding process the flow between liquid holds and the sea can be divided into stages such that the flooding will proceed through a set of successive intermediate equilibrium conditions to the final equilibrium condition meanwhile flooding stages can be divided into several intermediate calculation phases which allow for inspection of flooding during the flooding stages in general the flooding process can be divided into three main phases which are the phase of transient flooding the phase of progressive flooding and a steady final state ruponen et al 2007 in recent years many techniques have been developed to allow for a more realistic assessment of the flooding process as proposed by manderbacka et al 2015 manderbacka and ruponen 2016 hashimoto et al 2017 cheng et al 2017 and zhang et al 2020 etc despite these facts the stability criteria in the regulations still mainly rely on the characteristics of the stability curve ruponen et al 2018 therefore the conventional approach is used in this paper to assess the stability during the flooding process in practice there are two methods used in defining different phases one is using height difference and the other one is using volume change ruponen et al 2018 suggested by lr the latter method is used in this paper in which the total volume of flooding water or flow out from liquid holds in a stage is equally distributed to all phases of that stage 3 test cases and discussion as a classification society lr provides the approval of strength and stability calculation programs lr 2018a since the goal of this paper is to assess ship s damage stability mainly for bulk carriers and tankers the proposed method has only been evaluated of lr test cases for iacs ur l5 type 1 2 and 3 the assessment of type 3 takes into account imo mcs 1 circ 1461 covering tankers under marpol the international code for the construction and equipment of ships carrying dangerous chemicals in bulk ibc code and the international code for the construction and equipment of ships carrying liquefied gases in bulk igc code according to lr 2018a there are three types of approval covered in this program namely general approval specific ship approval and enhanced specific ship approval among them general approval involves a rigorous assessment of a number of sample ships and the functionality of the software and the user guidance therefore the procedure of general approval is adopted to verify the proposed method the general approval process for stability calculation programs is a staged assessment in which includes three different stages are designed to test different points meanwhile different test hull forms are used in different stages to assess the damage stability lr 2018b two test hull forms provided by lr 2018b are used in the first two stages in the final stage a 38 000 dwt chemical tanker sc aquarius designed by sdari in 2015 is selected as the test ship tests in all three stages of the program provided by lr are performed strictly 3 1 stage one the test hull form used in stage one is a simple 30 m 30 m square box hull of 15m depth moulded dimensions no plate thickness to be added with a cruciform internal subdivision longitudinally along the centreline and breadthwise at amidships to form 4 equally sized spaces as shown in fig 7 meanwhile structural permeability is taken as 1 0 with a permeability of 0 95 used for damage assessment lr 2018b the damage cases adopted in this paper are described as follows lr 2018b 1 damage case 1 damage to the forward port space only in all cases the solid kg for the loaded vessel is 5 0m all 4 spaces are loaded equally with filling levels according to the table overleaf with cargo specific gravity sg of either 0 60 or 0 80 as noted 2 damage case 2 damage to both spaces on the port side in all cases the solid kg for the loaded vessel is 3 0m all 4 spaces are loaded equally with filling levels according to the table overleaf with cargo specific gravity of either 0 60 or 0 80 as noted there are 34 damage conditions provided by lr 2018b but only standard results under 4 certain damaged conditions are given as shown in table 3 under these damaged conditions comparisons of calculated gz with that provided by lr with heel angles from 0 to 70 are illustrated in fig 8 tests on stage one are intended to demonstrate that the modelling processes of the method are adequate for simple shapes and that appropriate calculations are performed for inflow into damaged spaces outflow of contents and assessment of critical point locations they also provide confirmation of a number of basic methodology issues which are influential on program results from fig 8 it can be seen that the calculated gz in all these four damage scenarios agree very well with the standard results actually the maximum absolute difference between the calculated gz and that provided by lr is only 0 02m which verifies the proposed method in stage one 3 2 stage two the hull form used in stage two is 200m in length 30m in breadth and 15m in depth moulded dimensions no plate thickness to be added lr 2018b the cross section of the hull is semi circular frame spacing is a nominal 1 0m with frame 0 at the ap and frame 200 at the fp the arrangement incorporates a tank top forward of frame 30 with a flat profile at 2 8m above the baseline spanning from the centreline to 3 8m off the centreline then continuing outboard at 45 to the horizontal until intersecting with a longitudinal wing bulkhead at 10 2m off the centreline thus at 9 2m above the baseline also the hull is transversely subdivided at frames 10 30 34 40 80 100 wing and db spaces only 120 cargo spaces only 150 180 and 190 as shown in fig 9 structural permeability is taken as 1 0 based on lightship particulars of 10 000 tones lightweight lcg at amidships and kg at 14m above baseline three load conditions are developed but only the standard results of two damage cases in load condition 01 are given in lr 2018b as illustrated in table 4 comparisons of calculated gz with those provided by lr with heel angle from 0 to 70 are illustrated in fig 10 in this stage the program is required to examine the relevant damage cases required by typical regulations and assess compliance against the regulatory requirements from fig 10 it can be seen that the calculated gz in these two cases also agree very well with the standard results in these two damage scenarios the maximum absolute difference between the calculated gz and that provided by lr is only 0 01m which verifies the proposed method on a more extensively subdivided hull form 3 3 stage three in stage three tests are carried out on a 38 000 dwt chemical tanker sc aquarius designed by sdari the principal particulars of sc aquarius are given in table 5 the 3d design models of the hull and some compartments of this chemical tanker are illustrated in fig 1 sdari 2015a gives the damage stability calculation result under 22 load conditions each of which has 160 damage cases in this paper results are presented only for one characteristic loading condition namely load03 which is a normal ballast condition arrival at 10 bunker the ship s parameters under this initial load condition are shown in table 6 according to sdari 2015b the three most critical damage cases sd18s sd55p and bd50 as illustrated in figs 11 13 are selected to analyse the damage stability furthermore the flooding process of each damage case contains only one stage which is divided into five phases according to sdari 2015a comparisons of calculated ship s intact stability damage stability and floatability of the equilibrium state in these three damage cases under load condition load03 with those provided by sdari 2015a are shown in fig 14 meanwhile the calculated flotation including draft heel angle and trim agree well with those provided by sdari 2015a in the equilibrium state of these damage cases as illustrated in tables 7 9 for simplicity but without loss of generality only comparisons of the calculated damage stability in the intermediate phase 3 under the damage scenario of load condition load03 and damage case sd18s with those provided by sdari 2015a are presented as shown in fig 15 in stage three the program is required to confirm that the proposed method has the ability to address all appropriate damage considerations from fig 14 it can be seen clearly that the gz values of heel angle from 0 to 75 are almost the same as the corresponding data provided by sdari 2015a in the intact condition and the equilibrium state of selected damage conditions from tables 7 9 it also can be seen that the calculated equilibrium state in three different damage cases are very close to that provided by sdari 2015a with the maximum absolute difference of draft trim and heel angle no more than 0 01m 0 03m and 0 06 respectively also fig 15 shows that the calculated damage stability in intermediate phases can also achieve high accuracy results in this way the proposed method is verified in stage three of the lr test 4 conclusions accurate analysis of ship s damage stability is both important and challenging this paper presents a practical method for the assessment of ship s damage stability directly from the 3d design models of ship s hull and compartments the proposed approach has been evaluated by lr test cases for iacs ur l5 type 1 2 and 3 in each stage of the approval program this method achieves a high accuracy result compared with those provided by lr or sdari and thus can be used onboard to calculate intact stability and damage stability of ships by direct application of preprogrammed damage cases especially for bulk carriers and tankers in the process of developing this method some points are worth noting as follows 1 computational database is the foundation for the high precision calculation of ship s damage stability it must meet the following requirements first the database should be capable of providing enough information on ship s hull and compartments which are necessary for calculating the ship s flotation the parameters of flooding water etc next the database should not have too much redundant data for the sake of computational efficiency finally the database must be appropriate for the assessment of a ship s damage stability 2 the effect of the movement of liquid loads has been taken into account in calculating the damage stability of a ship with high computational efficiency since there may be too many liquid holds to be considered newton s iterative method is used to determine the height of liquid surface of liquid holds under any ship s flotation then the new centre of gravity of the liquid load can be obtained using numerical integration this method is fast and robust and the final result can generally be obtained in 3 5 iterations 3 as pointed out by papanikolaou 2007 imo 2017 and lr 2018a the assessment of ship s stability should be done in different intermediate stages and phases during the flooding process the method of lost buoyancy is used in assessing ship s damaged stability in the final stage of flooding in damage cases while the method of volume change is used to assess the damage stability in different phases they all work well with acceptable calculated results although the proposed method has considered the calculation of ship s damage stability in different intermediate stages and phases during the flooding process the flooding process in damaged compartments is actually more complicated to make a more realistic assessment of ship s damage stability onboard progressive flooding in the time domain which considers the internal structure of the compartments should be considered in future work credit authorship contribution statement xiaofeng sun conceptualization methodology software writing review editing yingang ni data curation chunlei liu methodology software writing original draft zhizhou wang data curation yong yin supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments financial support for research on intelligent ship testing and verification from the ministry of industry and information technology of the people s republic of china is gratefully acknowledged the authors would like to thank mr john standing a senior stability specialist of the lr and his colleagues for their hard work on testing the proposed method 
21063,reliable onboard stability assessment for a damaged ship is of great importance to ship operators this paper presents a practical method to calculate ship s damage stability directly from the full three dimensional 3d geometric models in which the method of lost buoyancy is used first the computational database is established by cutting the 3d models of hull and compartments in transverse direction according to ship s frame distance table then trapezoidal rule integration method is adopted to calculate ship s volumetric data after that the centre of gravity of liquid loads is calculated using newton s iterative method finally ship s equilibrium state of balanced trim and draft for a given heel angle is determined using a successive linear method and the right level could be obtained lloyd s register lr test cases for iacs ur l5 type 1 2 and 3 are used to verify the proposed method in every stage of the test program the method achieves a high accuracy result and thus can be used onboard to calculate intact stability and damage stability of ships by direct application of preprogrammed damage cases especially for bulk carriers and tankers graphical abstract image 1 keywords damage stability floatability lost buoyancy method numerical method for ship motion deterministic damage stability assessment 1 introduction although remarkable efforts have been made to improve the safety of ships in recent decades maritime accidents still occur a total of 7391 serious maritime accidents occurred from 2000 to 2012 according to eliopoulou et al 2016 in most maritime accidents such as collisions groundings etc the hull is breached which causes flooding of various compartments the ship subsequently changes her draft and trim heels loses some stability or even capsizes therefore reliable onboard damage analysis is of great importance to ship operators before sailing and during a real accident calculation of ship s damage stability has constituted a large amount of the research effort in recent years papanikolaou 2007 reviewed scientific and regulatory developments around the damage stability of ships aimed to address serious concerns regarding the adopted probabilistic formulation for the calculation of the survival probability of passenger ships the european commission fp7 dg research funded a research project named goal based damage stability goalds 2009 2012 papanikolaou et al 2013 outlined the objectives the methodology of work and the main results of this project choi et al 2014 studied the methodologies available for damage safety assessment considering environmental conditions and their application fernández 2015 proposed a comparative analysis of the different criteria of stability after damage boulougouris et al 2016b described limitations of the current semi empirical deterministic criteria on which a combatant s damage stability is assessed and presented a new probabilistic approach to assess the damage stability of a naval combatant boulougouris et al 2016a provided some elaborations on the current state of affairs with regards to operational measures relating to damage stability and safety cichowicz and murphy 2016 presented an alternative to the solas formulation for assessing damage survivability of passenger ships ruponen and lindroth 2016 presented an advanced approach using time domain flooding simulation for calculation of the intermediate stages of flooding within the context of the safety of life at sea solas 2009 regulations krüger 2016 used numerical tools to compute intermediate stages of flooding during design and to carry out numerical investigation of marine casualties bačkalov et al 2016 and manderbacka et al 2019 provided extensive reviews of the findings published in the international conference on the stability of ships and ocean vehicles stab and the international ship stability workshop issw proceedings from 2009 to 2018 ruponen et al 2017 presented a new approach to breach assessment based on measurement data from flood level sensors ruponen et al 2018 used three alternative methods including conventional method time domain flooding simulation with damaged compartments treated as lost buoyancy and simulation with the breach modelled as openings to develop a more realistic assessment of the intermediate stages of flooding andrei et al 2018 analysed the damage stability of a multipurpose cargo ship in some particular flooding situations hu et al 2019 investigated two methods that can be used to research the capsizing probability in the time domain which mainly focuses on the nonlinear righting lever gz curve solution mauro et al 2019 generated a database of compressed natural gas ships starting from a baseline hull and described two approaches to identify the compliance of a ship with the intact stability regulations based on the ship s main geometrical quantities ruponen et al 2019 presented a new approach for analysing the level of survivability for a passenger ship in the event of collision damage to be used onboard methods for ship s damage analysis must fulfill the related requirements of statutory regulations e g solas chapter ii 1 imo 2017 the international convention for the prevention of pollution from ships marpol annex i regulation 28 marpol 2016 etc the international maritime organization imo has released the guidelines for verification of damage stability for different kinds of ships e g msc 1 circ 1461 for tankers imo 2013 msc 1 circ 1589 for passenger ships imo 2018 etc the international association of classification societies iacs defines four different types of calculations performed by stability software in the unified regulations regarding onboard computers for stability calculations iacs 2017 it should be noted that type 3 software is to include pre defined relevant damage cases while type 4 is associated with a loading condition and actual flooding case and thus can provide operational information for safe return to port srtp however only stability software installed on passenger ships covered by the srtp and built after 2014 is required to have the capability of srtp imo 2018 nowadays major classification societies provide procedures to evaluate and authorize the stability software for use onboard specific ships based on iacs 2017 although several commercial loading computer software have been developed and used onboard to help ship operators to assess ship s damage stability the detail of the calculation methods used in these software has rarely been published this paper presents a deterministic method to assess ship s damage stability especially for bulk carriers and liquid tankers the proposed method calculates ship s damage stability directly from ship s three dimensional 3d design data the establishment of computational database is presented firstly then the integration method is introduced next the method for calculating the centre of gravity of liquid loads is given after that the method for the assessment of ship s damage stability in flooding condition is proposed finally lloyd s register lr test cases for iacs ur l5 type 1 2 and 3 are presented with discussion and analysis of the results 2 mathematical formulations 2 1 establishment of computational database computational database is the foundation of high accuracy calculation of ship s damage stability the conventional numerical representation of hull form is the table of offsets which is a pair of 2d tables showing curve and surface coordinates at locations specified in the lines plan normally the table of offsets contains half breadths measured at the stations and on the waterlines appearing in the lines plan therefore it is not dense enough to support the accurate calculation of ship s damage stability this paper addresses this problem by using a denser table of offsets which is based on 3d models of the hull and compartments designed by the shanghai merchant ship design and research institute sdari in sdari all buoyant parts of the ship including the hull tanks void spaces etc are modelled as a 3d mesh in stl file format i e having stl as the file extension which can be exported from common computer aided design cad software the stl file format is supported by nearly all major cad systems and has been widely used by most rapid prototyping systems this format is generated from a precise cad model using a process known as tessellation which generates triangles to approximate the cad model the stl file can be of ascii or binary format in each file triangular surfaces are described by a set of x y and z coordinates for each of the three vertices and a unit normal vector different 3d models of a 38 000 dwt chemical tanker sc aquarius designed by sdari are illustrated in fig 1 transverse sections are the standard representation of the envelope of a vessel for purposes of hydrostatic analysis with the 3d stl hull model raw transverse sections of the hull at each frame can be obtained by cutting the hull model in transverse direction according to ship s frame distance table along the x coordinates of structural frames similarly raw transverse sections of compartments at each frame are acquired by cutting the 3d models of the compartments in transverse direction as illustrated in fig 2 since the stl models are represented by triangle meshes these raw transverse sections are actually collections of piecewise linear curves in different transverse planes and inevitably have lots of redundant vertices which will reduce the computational efficiency of assessing a ship s damage stability in this paper a simultaneous curve simplification algorithm presented by dyken et al 2009 is used to address this problem this algorithm is based on measuring the distance between points and curves using variations over the euclidean norm in addition to relationships between points and curves which can be efficiently found by using triangulations the distance between the curve and its approximation is within a prescribed tolerance so as to keep the original information in this way simplified transverse sections of the hull and compartments are obtained by using fewer segments than the raw transverse sections take transverse section at frame 58 of the chemical tanker sc aquarius as an example the number of the points in this section is simplified from 140 to 57 with the threshold of 0 005m where almost 60 of the points in the raw transverse section is removed as shown in fig 3 the final step which is also the most important one in the establishment of the computational database is to make sure that it is appropriate for the assessment of ship s damage stability in this paper the acceptable tolerance proposed by iacs is adopted according to iacs 2017 programs which use hull form models as their basis for stability calculations shall have tolerances for the printouts of basic calculated data established against either data from the approved stability information or data obtained using the approval authority s model the acceptable tolerance for different kinds of data may differ from one another e g 2 for displacement the maximum of 1 or 50 cm for longitudinal centre of buoyancy from ap etc 2 2 numerical integration since the computational database is composed of discrete transverse sections at ship frame stations numerical integration is inevitably used to calculate ship s displacement volume of water in flooded compartment etc it should also be mentioned that ship s frame stations are not uniformly distributed along the x coordinates of structural frames normally the frame distance dfr in midship is slightly larger than that in bow or stern parts of frame distance table of the chemical tanker sc aquarius is shown in table 1 many different methods have been applied and used in an attempt to solve numerical integration for unequal data space among them trapezoidal rule and simpson s rule are widely used according to the finding of dhali et al 2019 trapezoidal rule gives comparable result with simpson s 1 3 rule and much better than simpson s 3 8 rule for unequal data space in most cases however it s more convenient to use trapezoidal rule since simpson s 1 3 rule can only be used when the interval number is even therefore trapezoidal rule is used for numerical integration in this paper of which we give an overview here given a set of data points x 0 y 0 x 1 y 1 x n y n of a function y f x where f x is not known explicitly using trapezoidal rule dhali et al 2019 the value of definite integral can be described as follows 1 x 0 x n y d x 1 2 x 1 x 0 y 0 x 2 x 0 y 1 x n x n 2 y n 1 x n x n 1 y n based on the computational database trapezoidal rule integration method is used to calculate the volumetric data of ship s hull and compartments with an acceptable tolerance comparisons of calculated volumetric data with those provide by the loading manual of the chemical tanker sc aquarius at different draft are shown in table 2 in which volt is the total volume of ship s displacement including shell thickness etc from this table it can be seen that the maximum relative error is only 0 1 which is far below 2 the related acceptable tolerance of iacs 2017 2 3 calculation of centre of gravity of liquid loads when the hull is breached water floods the compartments in the ship s hull which subsequently changes the ship s flotation and stability to analyse ship s damage stability reliably using either the lost buoyancy method or the added weight method it is essential to calculate how much water floods the compartment and to determine the centre of gravity of the flood water in case that a damaged compartment is loaded with liquid loads there might be a flow between the flooded compartment and the sea if the surface of the liquid is higher than that of the external water surface the part of the liquid which is above the external water surface will run out of the compartment gradually otherwise the compartments will be filled with sea water in the equilibrium state it is assumed that the liquid is totally replaced by sea water and the density of the cargo is changed to that of the sea water which in turn changes the ship s flotation for intact compartments with partial liquid loads the real physical shift of liquid loads must also be taken into account in the process of calculating the gz curve since the free liquid surface is always horizontal no matter how the ship is heeling or trimming the shift of liquid cargo in a cargo hold of chemical tanker sc aquarius is illustrated in fig 4 in the above two cases the key point is to determine the height of the liquid surface of the liquid holds under the ship s free flotation after that the new centre of gravity can be obtained using a numerical method the volume of the liquid load in an intact compartment is kept constant in this process which can be described as follows 2 f 1 h v v 0 0 where h is the height of the surface of liquid holds in the direction which is vertical to the sea water surface v is the calculated volume of liquid holds using the height of liquid holds v 0 is the original value of the volume of liquid holds in this paper newton s iterative method is used to solve this nonlinear equation kelley 2003 the idea is to set an initial value of the height of liquid holds firstly then use the first order derivative or jacobin matrix to update the value again and again until the value converges using taylor expansion at point h k which is the result of h in step k eqn 2 can be rewritten as follows 3 d f h k h h k f h k v 0 k 0 1 2 where d f h k d v d h s h and s h is the liquid surface projection area on the base plane therefore the updated value of the height of the surface of liquid holds in the next step would be 4 h k 1 h k v 0 f h k s h given the ship s flotation and the volume of liquid holds initial height of liquid holds is obtained by interpolation with the tank capacity table assuming the ship is in mean draft which makes the iterative process stable and fast then the calculated volume of liquid holds in this step is obtained by numerical integration after that the relative error between the new volume and the true volume of liquid holds is calculated and then used to decide whether the algorithm stops or not if the relative error is sufficiently small the algorithm outputs the height of the liquid holds and then stops otherwise the algorithm changes the height with the ratio of the volume error to the liquid surface projection area and reruns the algorithm until the relative error is acceptable the flowchart of this algorithm is shown in fig 5 experiments show that this method is fast and robust with the final result normally obtained in 3 5 iterations this contributes much to the computational efficiency of methods to assess a ship s damage stability since there can be a lot of liquid holds which need to be considered during the flooding process 2 4 assessment of ship s damage stability in a flooding condition unlike the calculation of ship s intact stability which is trivial the assessment of ship s damage stability is complex since the flow between the flooded compartment and the sea makes the ship s flotation and the flood water coupled the movement of liquid holds makes the situation even more complicated once the initial load condition and damage cases are defined ship s damage stability is normally evaluated by firstly fixing the heel angle then balancing the trim angle free trim and the draft and finally calculating the gz curves in the fixed heel angles it is essential that the trim angle should be balanced in the calculation of the gz curve in order to avoid over optimistic results as pointed out by pawłowski 2016 and ruponen et al 2018 by repeating this procedure for a range of heel angles the righting lever curve can be obtained in practice two different methods for analysis of damage stability are commonly used the method of lost buoyancy and the method of added weight tupper 2013 in the method of lost buoyancy the buoyancy of flooded compartments is reduced with the permeability taken into account and this method is more suitable for the final stage of flooding in damage cases ruponen et al 2018 so this paper uses the method of lost buoyancy to assess a ship s stability in the equilibrium state of damage condition for a given fixed heel angle the equilibrium state of balanced trim and draft can be described as follows 5 f 1 t m ψ ρ v s δ 0 f 2 t m ψ x b x g y b y g sin θ cos θ tan ψ z b z g cos θ cos θ tan ψ 0 where t m and ψ are the draft and trim angle of the ship respectively ρ is sea water density v s is the submerged volume δ is the ship s displacement x g y g and z g are the centres of gravity x b y b and z b are the centres of buoyancy θ is the given heel angle of the ship a successive linear method is used to solve nonlinear equation eqn 5 this equation can be recast in vector form as described in eqn 6 note that the tangent value of trim angle instead of trim angle is used as a variable to be determined for the convenience of solving this problem 6 f x f 1 x f 2 x 0 where x t m tan ψ using taylor expansion at point x k eqn 6 can be recast as follows 7 f 1 x k t m f 1 x k tan ψ f 2 x k t m f 2 x k tan ψ δ t m k δ tan ψ k f 1 x f 2 x 0 where the jacobian matrix in eqn 7 can be calculated similarly to the method proposed in our previous work shen et al 2020 after the equilibrium state of balanced trim and draft has been determined the right level could be calculated the flowchart of calculating right level in damage cases is shown in fig 6 in this paper the thresholds for the increments of draft and tangent value of trim angle are set to 0 001m and 0 001 respectively according to our experiments this method could converge in 3 9 iterations another thing should be mentioned is the assessment of ship s stability in different intermediate stages and phases during the flooding process as pointed out by papanikolaou 2007 transient flooding phenomena which are relevant to the damage stability of a ship should also be considered in an assessment procedure imo 2017 states that for each damage scenario the damage extent and location determine the initial stage of flooding calculations should be performed in stages each stage comprising of at least two intermediate filling phases in addition to the full phase per flooded space the concept of stage is related to the damage case describing the internal structure of the flooding process the flow between liquid holds and the sea can be divided into stages such that the flooding will proceed through a set of successive intermediate equilibrium conditions to the final equilibrium condition meanwhile flooding stages can be divided into several intermediate calculation phases which allow for inspection of flooding during the flooding stages in general the flooding process can be divided into three main phases which are the phase of transient flooding the phase of progressive flooding and a steady final state ruponen et al 2007 in recent years many techniques have been developed to allow for a more realistic assessment of the flooding process as proposed by manderbacka et al 2015 manderbacka and ruponen 2016 hashimoto et al 2017 cheng et al 2017 and zhang et al 2020 etc despite these facts the stability criteria in the regulations still mainly rely on the characteristics of the stability curve ruponen et al 2018 therefore the conventional approach is used in this paper to assess the stability during the flooding process in practice there are two methods used in defining different phases one is using height difference and the other one is using volume change ruponen et al 2018 suggested by lr the latter method is used in this paper in which the total volume of flooding water or flow out from liquid holds in a stage is equally distributed to all phases of that stage 3 test cases and discussion as a classification society lr provides the approval of strength and stability calculation programs lr 2018a since the goal of this paper is to assess ship s damage stability mainly for bulk carriers and tankers the proposed method has only been evaluated of lr test cases for iacs ur l5 type 1 2 and 3 the assessment of type 3 takes into account imo mcs 1 circ 1461 covering tankers under marpol the international code for the construction and equipment of ships carrying dangerous chemicals in bulk ibc code and the international code for the construction and equipment of ships carrying liquefied gases in bulk igc code according to lr 2018a there are three types of approval covered in this program namely general approval specific ship approval and enhanced specific ship approval among them general approval involves a rigorous assessment of a number of sample ships and the functionality of the software and the user guidance therefore the procedure of general approval is adopted to verify the proposed method the general approval process for stability calculation programs is a staged assessment in which includes three different stages are designed to test different points meanwhile different test hull forms are used in different stages to assess the damage stability lr 2018b two test hull forms provided by lr 2018b are used in the first two stages in the final stage a 38 000 dwt chemical tanker sc aquarius designed by sdari in 2015 is selected as the test ship tests in all three stages of the program provided by lr are performed strictly 3 1 stage one the test hull form used in stage one is a simple 30 m 30 m square box hull of 15m depth moulded dimensions no plate thickness to be added with a cruciform internal subdivision longitudinally along the centreline and breadthwise at amidships to form 4 equally sized spaces as shown in fig 7 meanwhile structural permeability is taken as 1 0 with a permeability of 0 95 used for damage assessment lr 2018b the damage cases adopted in this paper are described as follows lr 2018b 1 damage case 1 damage to the forward port space only in all cases the solid kg for the loaded vessel is 5 0m all 4 spaces are loaded equally with filling levels according to the table overleaf with cargo specific gravity sg of either 0 60 or 0 80 as noted 2 damage case 2 damage to both spaces on the port side in all cases the solid kg for the loaded vessel is 3 0m all 4 spaces are loaded equally with filling levels according to the table overleaf with cargo specific gravity of either 0 60 or 0 80 as noted there are 34 damage conditions provided by lr 2018b but only standard results under 4 certain damaged conditions are given as shown in table 3 under these damaged conditions comparisons of calculated gz with that provided by lr with heel angles from 0 to 70 are illustrated in fig 8 tests on stage one are intended to demonstrate that the modelling processes of the method are adequate for simple shapes and that appropriate calculations are performed for inflow into damaged spaces outflow of contents and assessment of critical point locations they also provide confirmation of a number of basic methodology issues which are influential on program results from fig 8 it can be seen that the calculated gz in all these four damage scenarios agree very well with the standard results actually the maximum absolute difference between the calculated gz and that provided by lr is only 0 02m which verifies the proposed method in stage one 3 2 stage two the hull form used in stage two is 200m in length 30m in breadth and 15m in depth moulded dimensions no plate thickness to be added lr 2018b the cross section of the hull is semi circular frame spacing is a nominal 1 0m with frame 0 at the ap and frame 200 at the fp the arrangement incorporates a tank top forward of frame 30 with a flat profile at 2 8m above the baseline spanning from the centreline to 3 8m off the centreline then continuing outboard at 45 to the horizontal until intersecting with a longitudinal wing bulkhead at 10 2m off the centreline thus at 9 2m above the baseline also the hull is transversely subdivided at frames 10 30 34 40 80 100 wing and db spaces only 120 cargo spaces only 150 180 and 190 as shown in fig 9 structural permeability is taken as 1 0 based on lightship particulars of 10 000 tones lightweight lcg at amidships and kg at 14m above baseline three load conditions are developed but only the standard results of two damage cases in load condition 01 are given in lr 2018b as illustrated in table 4 comparisons of calculated gz with those provided by lr with heel angle from 0 to 70 are illustrated in fig 10 in this stage the program is required to examine the relevant damage cases required by typical regulations and assess compliance against the regulatory requirements from fig 10 it can be seen that the calculated gz in these two cases also agree very well with the standard results in these two damage scenarios the maximum absolute difference between the calculated gz and that provided by lr is only 0 01m which verifies the proposed method on a more extensively subdivided hull form 3 3 stage three in stage three tests are carried out on a 38 000 dwt chemical tanker sc aquarius designed by sdari the principal particulars of sc aquarius are given in table 5 the 3d design models of the hull and some compartments of this chemical tanker are illustrated in fig 1 sdari 2015a gives the damage stability calculation result under 22 load conditions each of which has 160 damage cases in this paper results are presented only for one characteristic loading condition namely load03 which is a normal ballast condition arrival at 10 bunker the ship s parameters under this initial load condition are shown in table 6 according to sdari 2015b the three most critical damage cases sd18s sd55p and bd50 as illustrated in figs 11 13 are selected to analyse the damage stability furthermore the flooding process of each damage case contains only one stage which is divided into five phases according to sdari 2015a comparisons of calculated ship s intact stability damage stability and floatability of the equilibrium state in these three damage cases under load condition load03 with those provided by sdari 2015a are shown in fig 14 meanwhile the calculated flotation including draft heel angle and trim agree well with those provided by sdari 2015a in the equilibrium state of these damage cases as illustrated in tables 7 9 for simplicity but without loss of generality only comparisons of the calculated damage stability in the intermediate phase 3 under the damage scenario of load condition load03 and damage case sd18s with those provided by sdari 2015a are presented as shown in fig 15 in stage three the program is required to confirm that the proposed method has the ability to address all appropriate damage considerations from fig 14 it can be seen clearly that the gz values of heel angle from 0 to 75 are almost the same as the corresponding data provided by sdari 2015a in the intact condition and the equilibrium state of selected damage conditions from tables 7 9 it also can be seen that the calculated equilibrium state in three different damage cases are very close to that provided by sdari 2015a with the maximum absolute difference of draft trim and heel angle no more than 0 01m 0 03m and 0 06 respectively also fig 15 shows that the calculated damage stability in intermediate phases can also achieve high accuracy results in this way the proposed method is verified in stage three of the lr test 4 conclusions accurate analysis of ship s damage stability is both important and challenging this paper presents a practical method for the assessment of ship s damage stability directly from the 3d design models of ship s hull and compartments the proposed approach has been evaluated by lr test cases for iacs ur l5 type 1 2 and 3 in each stage of the approval program this method achieves a high accuracy result compared with those provided by lr or sdari and thus can be used onboard to calculate intact stability and damage stability of ships by direct application of preprogrammed damage cases especially for bulk carriers and tankers in the process of developing this method some points are worth noting as follows 1 computational database is the foundation for the high precision calculation of ship s damage stability it must meet the following requirements first the database should be capable of providing enough information on ship s hull and compartments which are necessary for calculating the ship s flotation the parameters of flooding water etc next the database should not have too much redundant data for the sake of computational efficiency finally the database must be appropriate for the assessment of a ship s damage stability 2 the effect of the movement of liquid loads has been taken into account in calculating the damage stability of a ship with high computational efficiency since there may be too many liquid holds to be considered newton s iterative method is used to determine the height of liquid surface of liquid holds under any ship s flotation then the new centre of gravity of the liquid load can be obtained using numerical integration this method is fast and robust and the final result can generally be obtained in 3 5 iterations 3 as pointed out by papanikolaou 2007 imo 2017 and lr 2018a the assessment of ship s stability should be done in different intermediate stages and phases during the flooding process the method of lost buoyancy is used in assessing ship s damaged stability in the final stage of flooding in damage cases while the method of volume change is used to assess the damage stability in different phases they all work well with acceptable calculated results although the proposed method has considered the calculation of ship s damage stability in different intermediate stages and phases during the flooding process the flooding process in damaged compartments is actually more complicated to make a more realistic assessment of ship s damage stability onboard progressive flooding in the time domain which considers the internal structure of the compartments should be considered in future work credit authorship contribution statement xiaofeng sun conceptualization methodology software writing review editing yingang ni data curation chunlei liu methodology software writing original draft zhizhou wang data curation yong yin supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments financial support for research on intelligent ship testing and verification from the ministry of industry and information technology of the people s republic of china is gratefully acknowledged the authors would like to thank mr john standing a senior stability specialist of the lr and his colleagues for their hard work on testing the proposed method 
21064,peregrine breather solution with its peak amplification factor of 3 located at x 0 and t 0 fig 1 fig 2 flow chart of synthesizing the hybrid surface elevation fig 2 fig 3 a initial surface elevation of the peregrine breather solution 6 m away from the theoretical focusing point b the first crest amplification of three times the carrier wave amplitude compared with the theoretical prediction fig 3 fig 4 evolution of the peregrine breather solution space time representation for the surface elevation scaled by a a theoretical prediction from nls equation b numerical simulation in the fully nonlinear equation fig 4 fig 5 spatial evolutions of the scaled maximal wave crest amplitude c trough amplitude t crest to trough height h and envelope amplitude e within the middle unstable breather packet a theoretical prediction from nls equation b numerical simulation in the fully nonlinear equation with circle denoting scaled crest first attaining 3 and asterisk marking its peak value crest to trough height is scaled by 2a while the other variables are scaled by a fig 5 fig 6 extreme value of the wave crest amplitude a and the corresponding evolutionary distance b derived in the fully nonlinear simulation as a function of the initial wave steepness the left and right ordinates in a are corresponding to the nondimensional scaled by the initial carrier wave amplitude and dimensional crest height respectively the evolutionary distance in b is scaled by the theoretical value l t 6 m fig 6 fig 7 initial discrete amplitude spectra of peregrine breather solution x 6 m and jonswap background wave before partition of energy fig 7 fig 8 initial wave series bottom synthesized by the linear superposition of peregrine breather solution middle and the irregular background wave top fig 8 fig 9 spatial evolution of the hybrid jonswap peregrine waves with the specific abnormal wave appeared x 5 3 m in case a and disappeared in case b the unstable peregrine packet is marked between the two red dashed lines note that in case b another unexpected rogue wave appears x 6 4 m in the group bounded by the blue dotted and red dashed lines for interpretation of the references to colour in this figure legend the reader is referred to the web version of this article fig 9 fig 10 probability density functions of the maximum wave height a attained within the wave group containing the unstable peregrine breather packet and the corresponding evolutionary distance b required to achieve the extreme value note that the smooth line is fitted according to the bar diagram fig 10 fig 11 a chart of abnormal waves b the maximum height attained versus the initial wave group energy fig 11 investigation on abnormal wave dynamics in regular and irregular sea states h d zhang methodology software writing original draft a b x j wang data curation visualization a b h d shi conceptualization supervision project administration a b c guedes soares resources writing review editing c a department of ocean engineering college of engineering ocean university of china 266100 qingdao china department of ocean engineering college of engineering ocean university of china qingdao 266100 china department of ocean engineering college of engineering ocean university of china 266100 qingdao china b shandong provincial key laboratory of ocean engineering ocean university of china 266100 qingdao china shandong provincial key laboratory of ocean engineering ocean university of china qingdao 266100 china shandong provincial key laboratory of ocean engineering ocean university of china 266100 qingdao china c centre for marine technology and engineering centec instituto superior técnico universidade de lisboa portugal centre for marine technology and engineering centec instituto superior técnico universidade de lisboa portugal centre for marine technology and engineering centec instituto superior tecnico universidade de lisboa portugal corresponding author shandong provincial key laboratory of ocean engineering ocean university of china 266100 qingdao china shandong provincial key laboratory of ocean engineering ocean university of china qingdao 266100 china peregrine breather solution of the nonlinear schrödinger nls equation can be treated as one of the excellent backbone models for abnormal wave in the ocean fully nonlinear numerical simulations performed with the higher order spectral method reveal that its maximum amplification factor can be larger than the theoretical prediction in the regular background wave and that such breather dynamics has a high probability to persist even in a chaotic environment evidently in both cases the maximum wave height attainable and the corresponding spatial evolutionary distance required are significantly affected by the initial background waves in fact whether the abnormal wave induced by breather dynamics can be generated is mainly a localized behaviour strongly dependent on the initial wave group energy as well as the detailed structure of this group keywords peregrine breather solution abnormal wave nonlinear wave focusing maximum amplitude amplification factor evolutionary distance 1 introduction extremely large surface waves also referred to as abnormal or rogue waves can suddenly appear on the sea surface without any forewarning being potential to cause devastating impact on marine structures such as ships offshore platforms and renewable energy devices klein et al 2016 such extreme events can indeed occur in nature with a lot of evidences e g the draupner and andrea events given in the published literatures essentially the energy source for the generation of abnormal wave can be traced back to the wind that is why this type of waves are frequently observed in stormy weather such natural evolutionary process has been successfully reproduced in an annular flume that has the peculiarity of being fetch unlimited toffoli et al 2017 due to the complex external environments different abnormal waves can be formed even in the same storm fujimoto et al 2019 thus it is very difficult to identify the mechanism involved in this process besides the well known linear dispersive focusing the rogue wave can also be triggered by some other factors such as the adverse current e g toffoli et al 2015 or the swell in crossing sea state e g gramstad et al 2018 although various physical mechanisms have been proposed to explain the formation of abnormal waves in the past decades there is still no consensus on this issue fedele et al 2016 recently the competing hypothesis of nonlinear focusing arised from third order quasi resonant four wave interaction has attracted great scientific interest and received intensive study because this unified mechanism exists not only in hydrodynamics but also in the other nonlinear dispersive medias such as optics dudley et al 2019 onorato et al 2013b it is well known that this type of nonlinear interaction and associated modulational instability inherent to the cubic nonlinear schrödinger nls equation can describe most features of abnormal waves reasonably well e g klein et al 2020 therefore the backbone structure in modelling rogue waves can resort to the analytical solutions of nls equation of which the most promising candidate is the doubly localized peregrine breather solution since it only oscillates once in spatiotemporal space in conformity with the reality besides laboratory observation has confirmed that a finite number of regular background waves is capable of triggering the corresponding breather dynamics in spite of its theoretical restriction of infinite modulation period alberello et al 2018 chabchoub et al 2011 due to the significant asymmetric widening of wave spectrum in laboratory experiment a larger maximum amplification factor with an elongated evolutionary distance can be detected as well shemer and alperovich 2013 in the framework of weakly nonlinear wave theory the peregrine breather solution is characterized by the maximum amplitude amplification index of three regardless of water depth suggesting that given enough evolutionary distance the maximum crest amplitude attained can always be treble the initial one dong et al 2018 miguel onorato et al 2013a even in the presence of strong wind forcing the peregrine breather evolution dynamics is still persistent chabchoub et al 2013 in the case of propagating over an adverse uniform current the modification of the peregrine soliton is just the enhancement of its amplitude with the focusing location shifted upstream liao et al 2018 showing its physical robustness to the various external perturbations in the fully nonlinear simulation performed with the conformal mapping method zhang et al 2017 2019 it is demonstrated that with the increased maximum crest height up to the onset of wave breaking the crest propagation speed of the peregrine breather wave decreases distinctly while the water particle speed at the crest starts to increase shemer and ee 2015 the shape of the maximal crest wave attainable seems to be almost universal and the evolutionary tendency is qualitatively similar to the theoretical prediction slunyaev and shrira 2013 in a realistic ocean environment the abnormal wave tends to appear in an irregular background wave field e g bitner gregersen et al 2018 bitner gregersen and toffoli 2014 thus to quantify the limitations of this model it is necessary to investigate the persistency of breather dynamics in a more complex configuration this kind of experiment has been performed in the wave flume with the peregrine breather solution embedded into a jonswap wave field chabchoub 2016 as expected one huge wave that meets the definition of abnormal wave emerges from the unstable breather packet hence expanding the scope of its application to real ocean wave however the original work only involves one specific case considering the high variability and uncertainty in irregular sea states more tests are required to fully understand the influence of chaotic background waves on the development of breather dynamics aiming to quantify its persistence in various chaotic environments one systematic numerical study based on the fully nonlinear enhanced spectral boundary integral esbi method has been conducted by wang et al 2018 different sea states identified by the wave steepness and spectral width of initial background waves are taken into account but the method of synthesizing the initial condition is slightly different from that used by chabchoub 2016 consequently it only indicates the nonlinear interaction between two different wave systems without recognizing which system the abnormal wave emerges from in this paper the initial hybrid surface wave is constructed with the same method as that of chabchoub 2016 and its evolutionary process is governed by euler equations solved with the higher order spectral method which is accurate enough and very efficient to perform a large number of random simulations for reliable statistical analysis the main concern herein is the influence of irregular background waves on triggering abnormal wave which will be investigated from a statistical point of view meanwhile for a better understanding of the peregrine breather dynamics the corresponding evolutionary tendency in regular background waves has to be discussed first this paper is laid out as follows firstly in 2 the wave model employed in numerical simulation and the hybrid surface elevation synthesized for initial condition are briefly reviewed in 3 the persistence of peregrine breather dynamics in regular and irregular background waves are investigated in detail finally some important conclusions are drawn in 4 2 basic theory for the ideal fluid that is incompressible irrotational and inviscid the evolution of weakly nonlinear unidirectional deepwater surface wave can be modelled to the leading order in nonlinearity by the following scaled form of nls equation 1 i a t a x x 2 a 2 a 0 integrated by means of the inverse scattering technique many analytic solutions can be derived one of which is the doubly localized peregrine breather peregrine 1983 2 a p x t 1 4 16 i t 1 16 t 2 4 x 2 exp 2 i t in order to get an intuitive feeling for its physical properties the scaled form of peregrine breather solution within a moving frame is presented in fig 1 using the corresponding transformation equation the scaled solution can be written back to the dimensional form chabchoub et al 2011 chabchoub and grimshaw 2016 3 a p x t a 0 exp i k 0 2 a 0 2 ω 0 2 t 4 1 i k 0 2 a 0 2 ω 0 t 1 2 2 k 0 2 a 0 x c g t 2 k 0 4 a 0 4 ω 0 2 t 2 1 after specifying the values for the parameters of carrier wave it is straightforward to derive the theoretical surface elevation to the first order with the following expression 4 η p re a p x t exp i k 0 x ω 0 t as a matter of fact this formula not only determines the initial breather wave profile in the following numerical simulations but also predicts the theoretical enhancement at the prescribed location for the purpose of incorporating the peregrine breather wave into a chaotic wave field the following linear superposition method is employed 5 η h t η p t η j t where η j is the irregular background wave 6 η j t n 1 n 2 s ω n δ ω cos ω n t ϕ n in eq 6 wave phase ϕ n is a random number uniformly distributed in the interval 0 2π and s ω n is given by the jonswap power spectrum 7 s ω α ω 5 exp 5 4 ω ω p 4 γ exp ω ω p 2 2 σ 2 ω p 2 the detailed description on these parameters in the above wave spectrum can be easily found in numerous published works and will be omitted herein for brevity it is worthy of note that this type of spectrum has been applied to study the dynamics of abnormal waves appeared in random sea states before onorato et al 2001 the difference is that in this work the peak domain of jonswap spectrum is removed and replaced by the peregrine energy when constructing the hybrid surface elevation in other words with this sleight of hand it is easier to identify the dynamics responsible for the generation of abnormal waves in order to clearly explain the procedure to construct the hybrid surface elevation the corresponding flow chart is given in fig 2 to make a balance between accuracy and efficiency in the numerical simulation the well known higher order spectral method hos is employed in this paper dommermuth and yue 1987 west et al 1987 the corresponding kinematic and dynamic boundary conditions are given as 8 η t h ψ h η w 1 h η 2 0 9 ψ t g η 1 2 h ψ 2 1 2 w 2 1 h η 2 0 where w and ψ represent the vertical velocity and velocity potential at the free surface η respectively t is time and h denotes the horizontal gradient operator in the x y plane as before the split step method is adopted to solve eqs 8 and 9 in a word the linear part is integrated analytically and the nonlinear part is solved numerically with the fourth order runge kutta method to accelerate the numerical procedure modified scheme can be used to address the stiffness of high frequency part in the nonlinear system ducrozet et al 2016b in addition to suppress the influence of nonlinearity at the wavemaker the technique of goullet and choi 2011 can be utilized in the numerical scheme in fact this method has been validated before by comparing numerical simulation with laboratory observation of kuznetsov ma breather solution even in the presence of wave breaking it is still qualified after removing the energy dissipation with an empirical method seiffert and ducrozet 2018 an alternative to this simple numerical scheme is to use a real numerical wave tank i e including a wavemaker an absorbing zone etc however as revealed in the previous research ducrozet et al 2016a it is equivalent to reproduce rogue wave in periodic simulation and in numerical wave tanks this work uses the periodic simulation and thus involves how to carry out the numerical simulation and extract the temporal surface elevation from spatial series the method adopted herein is explained in detail in the work of slunyaev et al 2014 in the following numerical simulations the spatial domain is about 55 m 100l 0 with the spatial grid size dx 0 027 m thus there are more than 20 data points within one dominant wavelength when evaluating the nonlinear terms in physical space the aliasing error is removed by automatically increasing the spatial resolution via fourier interpolation method in addition the time step is dt t 0 80 and the evolutionary process lasts 270t 0 long enough to guarantee that the spatial propagation distance is over 15 m note that l0 and t 0 are dominant wavelength and wave period respectively 3 peregrine breather dynamics according to the weakly nonlinear nls theory the evolutionary process of breather wave depends on the product of two physical parameters i e the wave steepness and the number of waves in one modulation see e g babanin et al 2019 slunyaev and shrira 2013 and reference therein in the following section both parameters are selected to guarantee the maximum wave amplitude attainable to be equal to three in theory and the same peregrine breather solution will be developed in both regular and irregular background waves 3 1 regular background waves in fig 3 one case is presented to demonstrate that the wave crest height can reach three times the initial carrier wave amplitude even within the framework of fully nonlinear potential equations the initial surface elevation is essentially sinusoidal depicted in fig 3 a with the amplitude of carrier wave a 0 75 cm and the peak frequency ω 0 10 68 rad s leading to the steepness ak 0 0 087 under deepwater condition these values are set in purpose to continue the study of corresponding laboratory experiment chabchoub 2016 where its initial setting is to allow for sufficient distance to develop such evolution while ignoring the effect of surface tension as shown in fig 3 b a significant increase in the amplitude can be observed in the middle part of this periodic wave which will disappear and approach the amplitude of background wave if far away enough from the location of nonlinear focusing according to the analytical peregrine breather solution the amplitude of carrier wave can be amplified as large as 3 times the initial one red dotted line the same amplification factor is also detected in the fully nonlinear numerical simulation solid black line but the symmetric profile in nls theory cannot be reproduced any more in line with the corresponding laboratory observation chabchoub et al 2011 to further explore the difference between the nls and fully nonlinear breathers their whole evolutionary processes are presented separately in fig 4 apparently the propagation speed of the fully nonlinear breather is underestimated by the linear wave group velocity c g revealed by the forward movement of the middle unstable packet in fig 4 b it seems that this group speed is gradually increased during the nonlinear focusing process x 9 1 m and after that it slowly returns to the linear one once again for both evolutionary processes it is clearly seen that the localized wave group contracts considerably and sucks energy sequentially from the back and front waves the dramatic difference is that for the fully nonlinear breather most of the accumulated energy is contributed by the back waves with the corresponding energy transfer process irreversible in part in order to clearly demonstrate the whole amplification process of the middle unstable breather packet the spatial variations of its maximal wave crest amplitude trough amplitude crest to trough height and envelope amplitude are depicted in fig 5 respectively as stated in the weakly nonlinear wave theory see fig 5 a the maximum height of wave envelope as well as of wave crest can reach three times the carrier wave amplitude at the prescribed location i e x 6 m moreover it is indicated that the crest and trough amplitudes as well as the crest to trough height are not monotonically increased as the envelope amplitude but periodically modulated in the course of evolution compared to the nls theory the periodic modulation can also be observed in fig 5 b but the distance of focus increases significantly in the fully nonlinear numerical simulation taking the wave crest amplitude as an example it needs a much longer evolutionary distance x 9 1 m to attain the global peak value marked by asterisk in fig 5 b apparently the noticeable delay of the peak amplitude amplification mainly arises from the elongated about 11 individual modulation period moreover the peak amplification index or the maximum dimensionless height is larger than the theoretical value of 3 for both wave crest and wave envelop while it is smaller than the theoretical prediction for wave trough and wave height interestingly enough the amplification factor of wave crest amplitude attains 3 for the first time at the location of x 5 6 m see circle in fig 5 b and its detailed profile in fig 3 b very close to the theoretical location of x 6 m note that due to the insufficient growth in wave trough amplitude the envelop amplitude is not smoothly increased in the fully nonlinear focusing process it has to be mentioned that in both weakly and fully nonlinear cases the evolutionary processes of the maximal wave crest and trough amplitudes are out of phase this could be explained by the law of conservation i e the energy is exchanged iteratively between the highest crest and deepest trough consequently it can be inferred and also confirmed herein that in each modulation period the local peak values of the crest amplitude trough amplitude and crest to trough height are attained at close but different locations in line with the previous observation slunyaev and shrira 2013 for completeness the extreme value of wave crest amplitude obtained in the fully nonlinear simulation is given in fig 6 a as a function of different initial wave steepness which is realized by varying the carrier wave amplitude without changing its frequency to avoid the influence of wave breaking the upper boundary of initial wave steepness is set to be 0 145 evidently the dimensional extreme crest height in each case is proportional to the initial wave steepness whereas the nondimensional one is more complex i e being increased first and then decreased a little unstable around the peak value it can be further concluded that the maximum amplification factor of the surface elevation attained by the nonbreaking peregrine breather wave is 3 3 a little bit smaller than 3 4 given by tanaka 1990 who examined the biggest wave the modulational instability can produce for a given uniform wave train regarding the spatial distance required for the development of extreme wave crest no clear trend can be observed in fig 6 b this is mainly caused by the nonlinear effect which can influence not only the matching process of the initial conditions but also the evolutionary process of breather dynamics thus the growing distance is becoming more sophisticated with the increased nonlinearity in the numerical simulation anyway the required distance is always larger than the theoretical one with a mean value of 1 48l t marked by the red line in fig 6 b thus it can be inferred that all discrepancies appeared herein between theoretical predictions and numerical experiments mainly stem from the higher order linear and nonlinear effects ignored in the simplified nonlinear schrödinger equation the conjecture can also be partly confirmed by the work of shemer and alperovich 2013 who conducted the same laboratory experiment on peregrine breather solution showing a better agreement with the simulation of dysthe equation higher order nls rather than that of nonlinear schrödinger equation considering that the above discussion only focuses on the peregrine breather solution it cannot be inferred that the nls equation is generically inaccurate as reported in the work of slunyaev et al 2013 the perfectly stable envelope soliton with very large carrier steepness up to 0 30 i e one analytical solution of nls equation has been observed in both numerical simulation and laboratory experiment moreover gradually reducing the carrier wave steepness tends to result in a better and progressive agreement between simulations and nls theory this is recently confirmed by waseda et al 2019 who numerically solved the hydrodynamic euler equation to study the long term evolution of a water wave modulated wave train in the optical regime i e very small steepness and spectral bandwidth anyway the dynamics disclosed by the peregrine soliton still can shed some light on the formation of abnormal waves now it raises a new open question as to whether this kind of breather can exist in the real ocean environment which will be considered in the next section 3 2 irregular background waves it is well known that abnormal waves can appear in the ocean wave field that is chaotic most of the time chabchoub 2016 performed one experimental study confirming that extreme wave in an irregular jonswap wave field can be tracked back to originate from the peregrine breather solution to be consistent with and continue the previous laboratory experiment chabchoub 2016 the same technique and associated parameters in synthesizing the initial condition are used in the following study briefly speaking the initial peregrine soliton is exactly the same as that presented in fig 3 a i e the amplitude of carrier wave a 0 75 cm and the peak frequency ω 0 10 68 rad s the initial irregular background wave is randomly constructed from the retained jonswap spectrum before partition of energy the original spectral parameters are the significant wave height h s 3 cm the peak frequency ω p 10 68 rad s and the peak enhancement factor γ 6 following the procedure introduced in 2 the hybrid initial wave series can be readily derived to better understand the flow chart given in fig 2 the initial discrete amplitude spectra of peregrine breather solution x 6 m and jonswap wave before partition of energy are illustrated in fig 7 as well one typical example is presented in fig 8 where the unstable peregrine breather packet is visibly embedded in the middle of the irregular background waves see the bottom to mimic the randomness in reality the random phase model is used when constructing the jonswap surface elevation i e the amplitudes of wave components fixed while the phases randomly selected from the interval 0 2π the randomness introduced herein is enough to provide various irregular background waves and thus leads to a certain degree of uncertainty on the hybrid initial time series consequently resulting in different evolutionary tendencies without loss of generality two representative evolutionary tendencies of the unstable peregrine packet that cloaked in the irregular waves are depicted in fig 9 as shown in fig 9 a the initial wave group 0 1 m away from the wavemaker in space that contains the unstable peregrine packet bounded between two vertical red dashed lines does not present any significant difference from the other initial wave groups at the beginning later an intensive focusing of wave energy can be detected in this group eventually forming the peregrine type extreme wave at the location of 5 3 m of which the height calculated with zero up crossing method can reach 6 39 cm with the surrounding significant wave height just 2 57 cm as a matter of fact this peregrine type extreme wave is also the maximum wave in the whole wave field it can be treated as an abnormal or rogue wave considering that its abnormality index defined as the ratio of maximum wave height to significant wave height has already exceeded two in addition it is very clear that the wave energy piled up to generate the peregrine type extreme wave is mainly absorbed from the surrounding waves within the same wave group being consistent with the phenomenon observed in regular background waves in fig 4 it has to be stressed that the maximum wave height attained as well as the corresponding evolutionary distance required in this case is quite different from that observed in the laboratory experiment of chabchoub 2016 because the original irregular background waves cannot be exactly reproduced in this work in fig 9 b the peregrine type evolution in the middle of the wave series becomes indiscernible seemingly due to the less wave energy enclosed in the initial wave group anyway the modulational instability in peregrine breather has been suppressed to a certain degree by the irregular background waves interestingly enough another extreme wave event appears in the front wave group that is bounded by the blue dotted and red dashed lines the dynamics involved therein is not clear but one thing is for sure the formation of abnormal wave is a localized behaviour without significant energy exchange among different wave groups even in the presence of strong nonlinearity this property can pave the way for a data driven prediction scheme for the forecast of extreme wave that is the critical elementary wave group ewg is identified first from the irregular wave sequence and the extreme event can be predicted based on the database precomputed by for example dysthe model cousins et al 2019 farazmand and sapsis 2017 comparing to the corresponding evolutionary process in regular background waves the growth of peregrine type wave in irregular sea state seems to be more random it can be said that the variability is induced by the randomness of initial irregular background waves which can either enhance or suppress the breather evolution dynamics since the influence of irregular background waves is somewhat uncertain and variable the evolutionary tendency of peregrine type wave must be estimated from a statistical point of view for a reliable analysis an ensemble consisting of 1000 cases randomly synthesized with the monte carlo simulation method has been constructed in this paper in order to easily distinguish the abnormal wave generated by the peregrine soliton from that generated by the random wave train alone only the wave series bounded between 40s and 48s is used for statistical analysis but the significant wave height is still evaluated based on the entire wave series the probability density functions of the maximum wave height and the corresponding evolutionary distance are given in fig 10 where only the wave groups containing the unstable peregrine breather packet are taken into account fig 10 a indicates that the peregrine type wave can evolve either into or not into the abnormal wave evaluated by 2h s moreover the maximum wave height attained approaches gaussian distribution with the mean value close to 2 2h s in line with the central limit theorem however in fig 10 b the probability distribution of the corresponding evolutionary distance scaled by the theoretical prediction l t 6 m is non gaussian and the abscissa covers the entire spatial domain in the numerical simulation after removing all cases of not generating abnormal waves the similar probability distribution function can still be derived for the spatial evolutionary distance not presented herein for brevity as a result it will be very difficult to catch the location of extreme event highlighting the well known property of appear from nowhere for rogue waves more specifically the chance to observe this unstable peregrine breather packet embedded in various irregular background waves to evolve into an abnormal wave is 62 see fig 11 a nearly two thirds of these wave can persist in their evolutionary tendencies corroborating the robustness of breather dynamics in explaining the formation of abnormal waves in irregular sea states since the generation of rogue wave is a localized behaviour it can be inferred that the maximum crest to trough height that can be achieved strongly depends on the energy of the embedded wave group extracting all cases with the abnormal wave developed by the peregrine breather dynamics and calculating the initial wave group energy by the variance of the surface elevation seiffert et al 2017 a linear regression model can be detected in fig 11 b generally speaking the synthesized wave group with more initial energy tends to generate a larger abnormal wave but the limiting height that can be attained is strongly determined by the detailed structure of the individual group as revealed by fig 11 b the difference can be as large as 0 5 h for the same initial group energy 4 conclusions as the prototype of extreme wave event the evolutionary tendencies of the unstable peregrine breather packet are researched in this paper not only in the regular background waves but also in the 2d irregular background waves only the maximum amplification factor and the corresponding evolutionary distance are fully discussed herein because these two variables are most useful in engineering application especially when conducting the laboratory experiment related to the transient response of floating structure to abnormal waves in the focusing process with the regular background waves the peregrine breather packet contracts considerably and absorbs energy from the surrounding environment mainly from the back waves with this energy transfer process partially irreversible due to the conservation of wave energy the growing processes of maximal crest and trough amplitudes within the unstable breather packet are out of phase consequently the abnormal wave cannot appear with the highest crest and deepest trough simultaneously in contrast to the nls theory the individual modulation period of wave amplitude is enlarged in the fully nonlinear simulation and thus elongates the whole evolutionary process the increased crest and decreased trough amplitudes reduce the smoothness of growing process of maximum wave envelope the chaotic background waves characterized by the jonswap wave spectrum significantly influence the evolutionary tendency of the unstable peregrine breather packet from a statistical point of view the breather dynamics considered herein can still persist in most cases substantiating its physical robustness to external perturbations however the evolutionary speed is changed randomly and the spatial location of maximum wave height becomes arbitrary making the abnormal wave appeared from nowhere the maximum crest to trough height attained by the peregrine type wave packet in irregular background waves is mainly determined by the energy of the surrounding waves which normally belong to the same wave group no significant interaction with other wave groups can be detected since the formation of abnormal wave is a localized behaviour it is possible to predict the extreme event by identifying the critical elementary wave groups and calculating their initial energy however to get the exact amplification factor is still challenging because it also depends on the detailed structure of the individual wave group note that the study in this paper is only limited to one specific case the probability of focusing persistence should be determined by the particular combination of the phases and the relative strength between breather solution and irregular background wave to get a comprehensive and complete conclusion on the evolutionary property of peregrine type wave packet embedded in irregular background waves a series of different combinations between them should be considered which will be our further research credit authorship contribution statement h d zhang methodology software writing original draft x j wang data curation visualization h d shi conceptualization supervision project administration c guedes soares resources writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors gratefully acknowledge the financial supports provided by the national natural science foundation of china under the grant 51809244 and 51709246 respectively the natural science foundation of shandong province under the grant zr2019bee042 is also acknowledged the authors sincerely thank the anonymous referees for constructive suggestions on improving the original manuscript 
21064,peregrine breather solution with its peak amplification factor of 3 located at x 0 and t 0 fig 1 fig 2 flow chart of synthesizing the hybrid surface elevation fig 2 fig 3 a initial surface elevation of the peregrine breather solution 6 m away from the theoretical focusing point b the first crest amplification of three times the carrier wave amplitude compared with the theoretical prediction fig 3 fig 4 evolution of the peregrine breather solution space time representation for the surface elevation scaled by a a theoretical prediction from nls equation b numerical simulation in the fully nonlinear equation fig 4 fig 5 spatial evolutions of the scaled maximal wave crest amplitude c trough amplitude t crest to trough height h and envelope amplitude e within the middle unstable breather packet a theoretical prediction from nls equation b numerical simulation in the fully nonlinear equation with circle denoting scaled crest first attaining 3 and asterisk marking its peak value crest to trough height is scaled by 2a while the other variables are scaled by a fig 5 fig 6 extreme value of the wave crest amplitude a and the corresponding evolutionary distance b derived in the fully nonlinear simulation as a function of the initial wave steepness the left and right ordinates in a are corresponding to the nondimensional scaled by the initial carrier wave amplitude and dimensional crest height respectively the evolutionary distance in b is scaled by the theoretical value l t 6 m fig 6 fig 7 initial discrete amplitude spectra of peregrine breather solution x 6 m and jonswap background wave before partition of energy fig 7 fig 8 initial wave series bottom synthesized by the linear superposition of peregrine breather solution middle and the irregular background wave top fig 8 fig 9 spatial evolution of the hybrid jonswap peregrine waves with the specific abnormal wave appeared x 5 3 m in case a and disappeared in case b the unstable peregrine packet is marked between the two red dashed lines note that in case b another unexpected rogue wave appears x 6 4 m in the group bounded by the blue dotted and red dashed lines for interpretation of the references to colour in this figure legend the reader is referred to the web version of this article fig 9 fig 10 probability density functions of the maximum wave height a attained within the wave group containing the unstable peregrine breather packet and the corresponding evolutionary distance b required to achieve the extreme value note that the smooth line is fitted according to the bar diagram fig 10 fig 11 a chart of abnormal waves b the maximum height attained versus the initial wave group energy fig 11 investigation on abnormal wave dynamics in regular and irregular sea states h d zhang methodology software writing original draft a b x j wang data curation visualization a b h d shi conceptualization supervision project administration a b c guedes soares resources writing review editing c a department of ocean engineering college of engineering ocean university of china 266100 qingdao china department of ocean engineering college of engineering ocean university of china qingdao 266100 china department of ocean engineering college of engineering ocean university of china 266100 qingdao china b shandong provincial key laboratory of ocean engineering ocean university of china 266100 qingdao china shandong provincial key laboratory of ocean engineering ocean university of china qingdao 266100 china shandong provincial key laboratory of ocean engineering ocean university of china 266100 qingdao china c centre for marine technology and engineering centec instituto superior técnico universidade de lisboa portugal centre for marine technology and engineering centec instituto superior técnico universidade de lisboa portugal centre for marine technology and engineering centec instituto superior tecnico universidade de lisboa portugal corresponding author shandong provincial key laboratory of ocean engineering ocean university of china 266100 qingdao china shandong provincial key laboratory of ocean engineering ocean university of china qingdao 266100 china peregrine breather solution of the nonlinear schrödinger nls equation can be treated as one of the excellent backbone models for abnormal wave in the ocean fully nonlinear numerical simulations performed with the higher order spectral method reveal that its maximum amplification factor can be larger than the theoretical prediction in the regular background wave and that such breather dynamics has a high probability to persist even in a chaotic environment evidently in both cases the maximum wave height attainable and the corresponding spatial evolutionary distance required are significantly affected by the initial background waves in fact whether the abnormal wave induced by breather dynamics can be generated is mainly a localized behaviour strongly dependent on the initial wave group energy as well as the detailed structure of this group keywords peregrine breather solution abnormal wave nonlinear wave focusing maximum amplitude amplification factor evolutionary distance 1 introduction extremely large surface waves also referred to as abnormal or rogue waves can suddenly appear on the sea surface without any forewarning being potential to cause devastating impact on marine structures such as ships offshore platforms and renewable energy devices klein et al 2016 such extreme events can indeed occur in nature with a lot of evidences e g the draupner and andrea events given in the published literatures essentially the energy source for the generation of abnormal wave can be traced back to the wind that is why this type of waves are frequently observed in stormy weather such natural evolutionary process has been successfully reproduced in an annular flume that has the peculiarity of being fetch unlimited toffoli et al 2017 due to the complex external environments different abnormal waves can be formed even in the same storm fujimoto et al 2019 thus it is very difficult to identify the mechanism involved in this process besides the well known linear dispersive focusing the rogue wave can also be triggered by some other factors such as the adverse current e g toffoli et al 2015 or the swell in crossing sea state e g gramstad et al 2018 although various physical mechanisms have been proposed to explain the formation of abnormal waves in the past decades there is still no consensus on this issue fedele et al 2016 recently the competing hypothesis of nonlinear focusing arised from third order quasi resonant four wave interaction has attracted great scientific interest and received intensive study because this unified mechanism exists not only in hydrodynamics but also in the other nonlinear dispersive medias such as optics dudley et al 2019 onorato et al 2013b it is well known that this type of nonlinear interaction and associated modulational instability inherent to the cubic nonlinear schrödinger nls equation can describe most features of abnormal waves reasonably well e g klein et al 2020 therefore the backbone structure in modelling rogue waves can resort to the analytical solutions of nls equation of which the most promising candidate is the doubly localized peregrine breather solution since it only oscillates once in spatiotemporal space in conformity with the reality besides laboratory observation has confirmed that a finite number of regular background waves is capable of triggering the corresponding breather dynamics in spite of its theoretical restriction of infinite modulation period alberello et al 2018 chabchoub et al 2011 due to the significant asymmetric widening of wave spectrum in laboratory experiment a larger maximum amplification factor with an elongated evolutionary distance can be detected as well shemer and alperovich 2013 in the framework of weakly nonlinear wave theory the peregrine breather solution is characterized by the maximum amplitude amplification index of three regardless of water depth suggesting that given enough evolutionary distance the maximum crest amplitude attained can always be treble the initial one dong et al 2018 miguel onorato et al 2013a even in the presence of strong wind forcing the peregrine breather evolution dynamics is still persistent chabchoub et al 2013 in the case of propagating over an adverse uniform current the modification of the peregrine soliton is just the enhancement of its amplitude with the focusing location shifted upstream liao et al 2018 showing its physical robustness to the various external perturbations in the fully nonlinear simulation performed with the conformal mapping method zhang et al 2017 2019 it is demonstrated that with the increased maximum crest height up to the onset of wave breaking the crest propagation speed of the peregrine breather wave decreases distinctly while the water particle speed at the crest starts to increase shemer and ee 2015 the shape of the maximal crest wave attainable seems to be almost universal and the evolutionary tendency is qualitatively similar to the theoretical prediction slunyaev and shrira 2013 in a realistic ocean environment the abnormal wave tends to appear in an irregular background wave field e g bitner gregersen et al 2018 bitner gregersen and toffoli 2014 thus to quantify the limitations of this model it is necessary to investigate the persistency of breather dynamics in a more complex configuration this kind of experiment has been performed in the wave flume with the peregrine breather solution embedded into a jonswap wave field chabchoub 2016 as expected one huge wave that meets the definition of abnormal wave emerges from the unstable breather packet hence expanding the scope of its application to real ocean wave however the original work only involves one specific case considering the high variability and uncertainty in irregular sea states more tests are required to fully understand the influence of chaotic background waves on the development of breather dynamics aiming to quantify its persistence in various chaotic environments one systematic numerical study based on the fully nonlinear enhanced spectral boundary integral esbi method has been conducted by wang et al 2018 different sea states identified by the wave steepness and spectral width of initial background waves are taken into account but the method of synthesizing the initial condition is slightly different from that used by chabchoub 2016 consequently it only indicates the nonlinear interaction between two different wave systems without recognizing which system the abnormal wave emerges from in this paper the initial hybrid surface wave is constructed with the same method as that of chabchoub 2016 and its evolutionary process is governed by euler equations solved with the higher order spectral method which is accurate enough and very efficient to perform a large number of random simulations for reliable statistical analysis the main concern herein is the influence of irregular background waves on triggering abnormal wave which will be investigated from a statistical point of view meanwhile for a better understanding of the peregrine breather dynamics the corresponding evolutionary tendency in regular background waves has to be discussed first this paper is laid out as follows firstly in 2 the wave model employed in numerical simulation and the hybrid surface elevation synthesized for initial condition are briefly reviewed in 3 the persistence of peregrine breather dynamics in regular and irregular background waves are investigated in detail finally some important conclusions are drawn in 4 2 basic theory for the ideal fluid that is incompressible irrotational and inviscid the evolution of weakly nonlinear unidirectional deepwater surface wave can be modelled to the leading order in nonlinearity by the following scaled form of nls equation 1 i a t a x x 2 a 2 a 0 integrated by means of the inverse scattering technique many analytic solutions can be derived one of which is the doubly localized peregrine breather peregrine 1983 2 a p x t 1 4 16 i t 1 16 t 2 4 x 2 exp 2 i t in order to get an intuitive feeling for its physical properties the scaled form of peregrine breather solution within a moving frame is presented in fig 1 using the corresponding transformation equation the scaled solution can be written back to the dimensional form chabchoub et al 2011 chabchoub and grimshaw 2016 3 a p x t a 0 exp i k 0 2 a 0 2 ω 0 2 t 4 1 i k 0 2 a 0 2 ω 0 t 1 2 2 k 0 2 a 0 x c g t 2 k 0 4 a 0 4 ω 0 2 t 2 1 after specifying the values for the parameters of carrier wave it is straightforward to derive the theoretical surface elevation to the first order with the following expression 4 η p re a p x t exp i k 0 x ω 0 t as a matter of fact this formula not only determines the initial breather wave profile in the following numerical simulations but also predicts the theoretical enhancement at the prescribed location for the purpose of incorporating the peregrine breather wave into a chaotic wave field the following linear superposition method is employed 5 η h t η p t η j t where η j is the irregular background wave 6 η j t n 1 n 2 s ω n δ ω cos ω n t ϕ n in eq 6 wave phase ϕ n is a random number uniformly distributed in the interval 0 2π and s ω n is given by the jonswap power spectrum 7 s ω α ω 5 exp 5 4 ω ω p 4 γ exp ω ω p 2 2 σ 2 ω p 2 the detailed description on these parameters in the above wave spectrum can be easily found in numerous published works and will be omitted herein for brevity it is worthy of note that this type of spectrum has been applied to study the dynamics of abnormal waves appeared in random sea states before onorato et al 2001 the difference is that in this work the peak domain of jonswap spectrum is removed and replaced by the peregrine energy when constructing the hybrid surface elevation in other words with this sleight of hand it is easier to identify the dynamics responsible for the generation of abnormal waves in order to clearly explain the procedure to construct the hybrid surface elevation the corresponding flow chart is given in fig 2 to make a balance between accuracy and efficiency in the numerical simulation the well known higher order spectral method hos is employed in this paper dommermuth and yue 1987 west et al 1987 the corresponding kinematic and dynamic boundary conditions are given as 8 η t h ψ h η w 1 h η 2 0 9 ψ t g η 1 2 h ψ 2 1 2 w 2 1 h η 2 0 where w and ψ represent the vertical velocity and velocity potential at the free surface η respectively t is time and h denotes the horizontal gradient operator in the x y plane as before the split step method is adopted to solve eqs 8 and 9 in a word the linear part is integrated analytically and the nonlinear part is solved numerically with the fourth order runge kutta method to accelerate the numerical procedure modified scheme can be used to address the stiffness of high frequency part in the nonlinear system ducrozet et al 2016b in addition to suppress the influence of nonlinearity at the wavemaker the technique of goullet and choi 2011 can be utilized in the numerical scheme in fact this method has been validated before by comparing numerical simulation with laboratory observation of kuznetsov ma breather solution even in the presence of wave breaking it is still qualified after removing the energy dissipation with an empirical method seiffert and ducrozet 2018 an alternative to this simple numerical scheme is to use a real numerical wave tank i e including a wavemaker an absorbing zone etc however as revealed in the previous research ducrozet et al 2016a it is equivalent to reproduce rogue wave in periodic simulation and in numerical wave tanks this work uses the periodic simulation and thus involves how to carry out the numerical simulation and extract the temporal surface elevation from spatial series the method adopted herein is explained in detail in the work of slunyaev et al 2014 in the following numerical simulations the spatial domain is about 55 m 100l 0 with the spatial grid size dx 0 027 m thus there are more than 20 data points within one dominant wavelength when evaluating the nonlinear terms in physical space the aliasing error is removed by automatically increasing the spatial resolution via fourier interpolation method in addition the time step is dt t 0 80 and the evolutionary process lasts 270t 0 long enough to guarantee that the spatial propagation distance is over 15 m note that l0 and t 0 are dominant wavelength and wave period respectively 3 peregrine breather dynamics according to the weakly nonlinear nls theory the evolutionary process of breather wave depends on the product of two physical parameters i e the wave steepness and the number of waves in one modulation see e g babanin et al 2019 slunyaev and shrira 2013 and reference therein in the following section both parameters are selected to guarantee the maximum wave amplitude attainable to be equal to three in theory and the same peregrine breather solution will be developed in both regular and irregular background waves 3 1 regular background waves in fig 3 one case is presented to demonstrate that the wave crest height can reach three times the initial carrier wave amplitude even within the framework of fully nonlinear potential equations the initial surface elevation is essentially sinusoidal depicted in fig 3 a with the amplitude of carrier wave a 0 75 cm and the peak frequency ω 0 10 68 rad s leading to the steepness ak 0 0 087 under deepwater condition these values are set in purpose to continue the study of corresponding laboratory experiment chabchoub 2016 where its initial setting is to allow for sufficient distance to develop such evolution while ignoring the effect of surface tension as shown in fig 3 b a significant increase in the amplitude can be observed in the middle part of this periodic wave which will disappear and approach the amplitude of background wave if far away enough from the location of nonlinear focusing according to the analytical peregrine breather solution the amplitude of carrier wave can be amplified as large as 3 times the initial one red dotted line the same amplification factor is also detected in the fully nonlinear numerical simulation solid black line but the symmetric profile in nls theory cannot be reproduced any more in line with the corresponding laboratory observation chabchoub et al 2011 to further explore the difference between the nls and fully nonlinear breathers their whole evolutionary processes are presented separately in fig 4 apparently the propagation speed of the fully nonlinear breather is underestimated by the linear wave group velocity c g revealed by the forward movement of the middle unstable packet in fig 4 b it seems that this group speed is gradually increased during the nonlinear focusing process x 9 1 m and after that it slowly returns to the linear one once again for both evolutionary processes it is clearly seen that the localized wave group contracts considerably and sucks energy sequentially from the back and front waves the dramatic difference is that for the fully nonlinear breather most of the accumulated energy is contributed by the back waves with the corresponding energy transfer process irreversible in part in order to clearly demonstrate the whole amplification process of the middle unstable breather packet the spatial variations of its maximal wave crest amplitude trough amplitude crest to trough height and envelope amplitude are depicted in fig 5 respectively as stated in the weakly nonlinear wave theory see fig 5 a the maximum height of wave envelope as well as of wave crest can reach three times the carrier wave amplitude at the prescribed location i e x 6 m moreover it is indicated that the crest and trough amplitudes as well as the crest to trough height are not monotonically increased as the envelope amplitude but periodically modulated in the course of evolution compared to the nls theory the periodic modulation can also be observed in fig 5 b but the distance of focus increases significantly in the fully nonlinear numerical simulation taking the wave crest amplitude as an example it needs a much longer evolutionary distance x 9 1 m to attain the global peak value marked by asterisk in fig 5 b apparently the noticeable delay of the peak amplitude amplification mainly arises from the elongated about 11 individual modulation period moreover the peak amplification index or the maximum dimensionless height is larger than the theoretical value of 3 for both wave crest and wave envelop while it is smaller than the theoretical prediction for wave trough and wave height interestingly enough the amplification factor of wave crest amplitude attains 3 for the first time at the location of x 5 6 m see circle in fig 5 b and its detailed profile in fig 3 b very close to the theoretical location of x 6 m note that due to the insufficient growth in wave trough amplitude the envelop amplitude is not smoothly increased in the fully nonlinear focusing process it has to be mentioned that in both weakly and fully nonlinear cases the evolutionary processes of the maximal wave crest and trough amplitudes are out of phase this could be explained by the law of conservation i e the energy is exchanged iteratively between the highest crest and deepest trough consequently it can be inferred and also confirmed herein that in each modulation period the local peak values of the crest amplitude trough amplitude and crest to trough height are attained at close but different locations in line with the previous observation slunyaev and shrira 2013 for completeness the extreme value of wave crest amplitude obtained in the fully nonlinear simulation is given in fig 6 a as a function of different initial wave steepness which is realized by varying the carrier wave amplitude without changing its frequency to avoid the influence of wave breaking the upper boundary of initial wave steepness is set to be 0 145 evidently the dimensional extreme crest height in each case is proportional to the initial wave steepness whereas the nondimensional one is more complex i e being increased first and then decreased a little unstable around the peak value it can be further concluded that the maximum amplification factor of the surface elevation attained by the nonbreaking peregrine breather wave is 3 3 a little bit smaller than 3 4 given by tanaka 1990 who examined the biggest wave the modulational instability can produce for a given uniform wave train regarding the spatial distance required for the development of extreme wave crest no clear trend can be observed in fig 6 b this is mainly caused by the nonlinear effect which can influence not only the matching process of the initial conditions but also the evolutionary process of breather dynamics thus the growing distance is becoming more sophisticated with the increased nonlinearity in the numerical simulation anyway the required distance is always larger than the theoretical one with a mean value of 1 48l t marked by the red line in fig 6 b thus it can be inferred that all discrepancies appeared herein between theoretical predictions and numerical experiments mainly stem from the higher order linear and nonlinear effects ignored in the simplified nonlinear schrödinger equation the conjecture can also be partly confirmed by the work of shemer and alperovich 2013 who conducted the same laboratory experiment on peregrine breather solution showing a better agreement with the simulation of dysthe equation higher order nls rather than that of nonlinear schrödinger equation considering that the above discussion only focuses on the peregrine breather solution it cannot be inferred that the nls equation is generically inaccurate as reported in the work of slunyaev et al 2013 the perfectly stable envelope soliton with very large carrier steepness up to 0 30 i e one analytical solution of nls equation has been observed in both numerical simulation and laboratory experiment moreover gradually reducing the carrier wave steepness tends to result in a better and progressive agreement between simulations and nls theory this is recently confirmed by waseda et al 2019 who numerically solved the hydrodynamic euler equation to study the long term evolution of a water wave modulated wave train in the optical regime i e very small steepness and spectral bandwidth anyway the dynamics disclosed by the peregrine soliton still can shed some light on the formation of abnormal waves now it raises a new open question as to whether this kind of breather can exist in the real ocean environment which will be considered in the next section 3 2 irregular background waves it is well known that abnormal waves can appear in the ocean wave field that is chaotic most of the time chabchoub 2016 performed one experimental study confirming that extreme wave in an irregular jonswap wave field can be tracked back to originate from the peregrine breather solution to be consistent with and continue the previous laboratory experiment chabchoub 2016 the same technique and associated parameters in synthesizing the initial condition are used in the following study briefly speaking the initial peregrine soliton is exactly the same as that presented in fig 3 a i e the amplitude of carrier wave a 0 75 cm and the peak frequency ω 0 10 68 rad s the initial irregular background wave is randomly constructed from the retained jonswap spectrum before partition of energy the original spectral parameters are the significant wave height h s 3 cm the peak frequency ω p 10 68 rad s and the peak enhancement factor γ 6 following the procedure introduced in 2 the hybrid initial wave series can be readily derived to better understand the flow chart given in fig 2 the initial discrete amplitude spectra of peregrine breather solution x 6 m and jonswap wave before partition of energy are illustrated in fig 7 as well one typical example is presented in fig 8 where the unstable peregrine breather packet is visibly embedded in the middle of the irregular background waves see the bottom to mimic the randomness in reality the random phase model is used when constructing the jonswap surface elevation i e the amplitudes of wave components fixed while the phases randomly selected from the interval 0 2π the randomness introduced herein is enough to provide various irregular background waves and thus leads to a certain degree of uncertainty on the hybrid initial time series consequently resulting in different evolutionary tendencies without loss of generality two representative evolutionary tendencies of the unstable peregrine packet that cloaked in the irregular waves are depicted in fig 9 as shown in fig 9 a the initial wave group 0 1 m away from the wavemaker in space that contains the unstable peregrine packet bounded between two vertical red dashed lines does not present any significant difference from the other initial wave groups at the beginning later an intensive focusing of wave energy can be detected in this group eventually forming the peregrine type extreme wave at the location of 5 3 m of which the height calculated with zero up crossing method can reach 6 39 cm with the surrounding significant wave height just 2 57 cm as a matter of fact this peregrine type extreme wave is also the maximum wave in the whole wave field it can be treated as an abnormal or rogue wave considering that its abnormality index defined as the ratio of maximum wave height to significant wave height has already exceeded two in addition it is very clear that the wave energy piled up to generate the peregrine type extreme wave is mainly absorbed from the surrounding waves within the same wave group being consistent with the phenomenon observed in regular background waves in fig 4 it has to be stressed that the maximum wave height attained as well as the corresponding evolutionary distance required in this case is quite different from that observed in the laboratory experiment of chabchoub 2016 because the original irregular background waves cannot be exactly reproduced in this work in fig 9 b the peregrine type evolution in the middle of the wave series becomes indiscernible seemingly due to the less wave energy enclosed in the initial wave group anyway the modulational instability in peregrine breather has been suppressed to a certain degree by the irregular background waves interestingly enough another extreme wave event appears in the front wave group that is bounded by the blue dotted and red dashed lines the dynamics involved therein is not clear but one thing is for sure the formation of abnormal wave is a localized behaviour without significant energy exchange among different wave groups even in the presence of strong nonlinearity this property can pave the way for a data driven prediction scheme for the forecast of extreme wave that is the critical elementary wave group ewg is identified first from the irregular wave sequence and the extreme event can be predicted based on the database precomputed by for example dysthe model cousins et al 2019 farazmand and sapsis 2017 comparing to the corresponding evolutionary process in regular background waves the growth of peregrine type wave in irregular sea state seems to be more random it can be said that the variability is induced by the randomness of initial irregular background waves which can either enhance or suppress the breather evolution dynamics since the influence of irregular background waves is somewhat uncertain and variable the evolutionary tendency of peregrine type wave must be estimated from a statistical point of view for a reliable analysis an ensemble consisting of 1000 cases randomly synthesized with the monte carlo simulation method has been constructed in this paper in order to easily distinguish the abnormal wave generated by the peregrine soliton from that generated by the random wave train alone only the wave series bounded between 40s and 48s is used for statistical analysis but the significant wave height is still evaluated based on the entire wave series the probability density functions of the maximum wave height and the corresponding evolutionary distance are given in fig 10 where only the wave groups containing the unstable peregrine breather packet are taken into account fig 10 a indicates that the peregrine type wave can evolve either into or not into the abnormal wave evaluated by 2h s moreover the maximum wave height attained approaches gaussian distribution with the mean value close to 2 2h s in line with the central limit theorem however in fig 10 b the probability distribution of the corresponding evolutionary distance scaled by the theoretical prediction l t 6 m is non gaussian and the abscissa covers the entire spatial domain in the numerical simulation after removing all cases of not generating abnormal waves the similar probability distribution function can still be derived for the spatial evolutionary distance not presented herein for brevity as a result it will be very difficult to catch the location of extreme event highlighting the well known property of appear from nowhere for rogue waves more specifically the chance to observe this unstable peregrine breather packet embedded in various irregular background waves to evolve into an abnormal wave is 62 see fig 11 a nearly two thirds of these wave can persist in their evolutionary tendencies corroborating the robustness of breather dynamics in explaining the formation of abnormal waves in irregular sea states since the generation of rogue wave is a localized behaviour it can be inferred that the maximum crest to trough height that can be achieved strongly depends on the energy of the embedded wave group extracting all cases with the abnormal wave developed by the peregrine breather dynamics and calculating the initial wave group energy by the variance of the surface elevation seiffert et al 2017 a linear regression model can be detected in fig 11 b generally speaking the synthesized wave group with more initial energy tends to generate a larger abnormal wave but the limiting height that can be attained is strongly determined by the detailed structure of the individual group as revealed by fig 11 b the difference can be as large as 0 5 h for the same initial group energy 4 conclusions as the prototype of extreme wave event the evolutionary tendencies of the unstable peregrine breather packet are researched in this paper not only in the regular background waves but also in the 2d irregular background waves only the maximum amplification factor and the corresponding evolutionary distance are fully discussed herein because these two variables are most useful in engineering application especially when conducting the laboratory experiment related to the transient response of floating structure to abnormal waves in the focusing process with the regular background waves the peregrine breather packet contracts considerably and absorbs energy from the surrounding environment mainly from the back waves with this energy transfer process partially irreversible due to the conservation of wave energy the growing processes of maximal crest and trough amplitudes within the unstable breather packet are out of phase consequently the abnormal wave cannot appear with the highest crest and deepest trough simultaneously in contrast to the nls theory the individual modulation period of wave amplitude is enlarged in the fully nonlinear simulation and thus elongates the whole evolutionary process the increased crest and decreased trough amplitudes reduce the smoothness of growing process of maximum wave envelope the chaotic background waves characterized by the jonswap wave spectrum significantly influence the evolutionary tendency of the unstable peregrine breather packet from a statistical point of view the breather dynamics considered herein can still persist in most cases substantiating its physical robustness to external perturbations however the evolutionary speed is changed randomly and the spatial location of maximum wave height becomes arbitrary making the abnormal wave appeared from nowhere the maximum crest to trough height attained by the peregrine type wave packet in irregular background waves is mainly determined by the energy of the surrounding waves which normally belong to the same wave group no significant interaction with other wave groups can be detected since the formation of abnormal wave is a localized behaviour it is possible to predict the extreme event by identifying the critical elementary wave groups and calculating their initial energy however to get the exact amplification factor is still challenging because it also depends on the detailed structure of the individual wave group note that the study in this paper is only limited to one specific case the probability of focusing persistence should be determined by the particular combination of the phases and the relative strength between breather solution and irregular background wave to get a comprehensive and complete conclusion on the evolutionary property of peregrine type wave packet embedded in irregular background waves a series of different combinations between them should be considered which will be our further research credit authorship contribution statement h d zhang methodology software writing original draft x j wang data curation visualization h d shi conceptualization supervision project administration c guedes soares resources writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors gratefully acknowledge the financial supports provided by the national natural science foundation of china under the grant 51809244 and 51709246 respectively the natural science foundation of shandong province under the grant zr2019bee042 is also acknowledged the authors sincerely thank the anonymous referees for constructive suggestions on improving the original manuscript 
