index,text
22920,this study presents a methodology to verify the notion that wave measurements could be less accurate near the coast when they are provided by altimetry radars on board satellites the methodology is based on comparing significant wave height hs data from the ra 2 altimetry radar on board envisat satellite european space agency against points from a gulf of cadiz database that were propagated through smc software sistema de modelado costero nine years of swell waves were analysed 2002 2010 the results show a rmse of only 0 19 m correlation coefficient of r 0 96 in deep waters but this decreases within 10 km of the coastline reaching a value of 1 12 m r 0 16 at 5 km from the coast keywords satellite altimetry wave height propagation coast 1 introduction measurements of significant wave height hs and its variability in coastal areas are used for many purposes e g sediment transport analysis coastal wave setup storm surges including validation calibration of models for wave forecasting atmospheric modelling and ocean circulation these applications are useful for a wide range of purposes such as structural design engineering on the high seas coastal zone protection improvements in ship route security and planning of ocean operations satellite radar altimetry is designed to provide accurate information on sea surface height hs and wind speed at the sea surface over the open ocean however vignudelli et al 2011 and references therein suggested that altimetry measurements could be less accurate in coastal areas these issues are due to two main factors the contamination of waveforms due to land or very calm waters entering the radar footprint gómez enri et al 2010 and inaccurate tidal and wet tropospheric corrections caballero et al 2014 access to accurate information on coastal sea conditions is of great importance because of the socioeconomic and strategic interest of the coastal zone this calls for new processing strategies to generate optimised altimetric products suited to the diverse applications in challenging conditions many studies have focused on validation of the hs data given by satellite radar altimetry using in situ observations e g faugere et al 2006 passaro et al 2015 kudryavtseva and soomere 2017 but few have focused on the influence of the proximity to the coast although it has been set out that altimeter measurements are of lower accuracy near the coast queffeulou and bentamy 2007 bouffard et al 2008 vignudelli et al 2011 hareef baba shaeb et al 2015 with the objective of proving the reliability of altimetry data near the coast the aim of this paper is to present a methodology for assessing comparisons between the hs data given by altimetry data and that propagated from numerical models of virtual buoy data this study analyses a particular area of the gulf of cadiz sw of spain over nine years 1 1 study area the study area is located in the southwest of the iberian peninsula in the gulf of cadiz spain fig 1 a and b it is a mesotidal area with a tidal range of about 4 m and significant waves from the w sw quadrant laiz et al 2013 even though the winds from e se have high speed and persistence they lack the fetch length necessary to generate waves of similar heights to the w sw waves muñoz perez and abarca 2009 fig 1c shows the wave rose of the study area obtained from the rom 0 3 91 wave climate on the spanish coast ministry of public works 1991 higher probability of waves that come from the fourth quadrant w nnw can be seen in this wave rose the ra 2 altimetry radar on board envisat european satellite has two tracks that cross at the continental shelf of the gulf of cadiz fig 1b one corresponds to the descending pass 223 from land to sea from north to south and the other to the ascending pass 187 from sea to land from south to north 2 database and methodology 2 1 altimetry data an estimated hs based on the reprocessed altimetry radar signal ra 2 of the esa envisat satellite was used in this study data were obtained from the new full mission reprocessing fmr v3 0 ftp ra2 ftp ds eo esa int geophysical data record product the along track spatial resolution of the dataset was 1 hz equivalent to a distance between two consecutive measurements of 7 km the temporal resolution was 35 days 2 2 virtual buoy data simar database comes from the hindcast of dynamic processes of the ocean and coastal areas of europe hipocas project see the puertos del estado de españa website at www puertos es this wave database was obtained through numerical wave modelling wam from wind time series wam is a third generation spectral model that solves the equation of energy balance without a priori hypotheses about the spectral shape of the waves therefore the data are virtual and do not come from direct measures of the nature however this database has been validated by numerous studies and has been used in many practical applications along the spanish coasts tomas et al 2004 the simar database contains data generated every hour since 1958 the wave data are given in open water and undefined depths conditions where they comply with the following relationship 1 h lo 2 0 78 t2 where h is depth t is period and lo is wave length in deep water off shore the simar point with the code 5034017 was selected for this study which can be found freely at www puertos es the point location is 6 67 west and 36 67 north fig 1 the parameters chosen to carry out the wave propagation were the hs m the average period t s and the average wave direction θ 2 3 data filtering the altimetry database contained data for 140 passes of the satellite from 2002 to 2010 of these 47 were not considered because of null values the hourly points included sea and swell data wave thus of the 93 valid data points in the 2002 2010 period the 53 passes that corresponded to swell waves were selected 43 descending and 10 ascending passes we used the ocean depth land elevation field available in the product and considered only ocean measurements 2 4 wave propagation sistema de modelado costero smc software was used to perform the wave propagation this software was made by hidraulic institute of cantabria supervised by the spanish ministry of the environment in this way the hs data from the simar database could be propagated to the points located along the satellite passes shown in fig 1 to carry out a comparison with the altimetry data the smc software creates propagation nets in the study area to allow the software to calculate where and in which direction the wave propagates and in how many data points it provides information to that end data from simar the hs average period and average wave direction were added to the software on a wave editor once the wave is calculated and propagated the smc connects with another software surfer 8 that provides a graphical output of the study area with wave height data 2 5 statistical analysis we used two statistical parameters to compare both datasets i the linear correlation coefficient r between altimetry hs and propagated hs values and ii the root mean square error rmse 3 results and discussion table 1 shows the enumeration assigned to each point of the satellite passes as well as the average point depth and its average distance to the coastline in kilometres the points were enumerated according to the distance to the coastline and were classified into 6 zones fig 2 compares altimetry hs propagated hs in the different zones the correlation coefficients r are represented in fig 3 as a function of the distance to the coastline with a confidence interval of 95 of the linear adjustments of the compared data in fig 2 fig 3 shows that r is high and significant far from the coast from 10 km to deep waters close to the coast zone a r is low the results presented in this study agree with those by caballero et al 2014 who noted that the accuracy of satellite measurements is 0 5 m it can be seen that there is a 0 5 m difference between the data provided from altimetry and the propagated simar data more than 95 of all the data fall into the range of 0 5 m except for those nearest to the coastline zone a where only 60 of the data are within that range furthermore the slope of the linear regression is 0 36 67 underestimation in zone a while it is 0 78 in zone f only 22 underestimation finally the rmse decreases as the distance to the shore increases from 1 12 m in zone a to 0 19 m in deep waters therefore the accuracy of the estimation for data in zones further the coastline is much better than in the nearest area 4 conclusions the accuracy of altimetry radar measurements in zones near the coast has been assessed in previous works see vignudelli et al 2011 and references therein in this work simar virtual buoy data was propagated through numerical modelling with smc software and compared to hs data from altimetry measurements in the gulf of cadiz the linear correlation coefficient between the altimetric and propagated hs data was much lower near the coastline r 0 16 in this particular case the correlation coefficient increased at distances further than 10 km to the coastline with r 0 96 in deep waters it was observed that 95 of these data were within 0 5 m of the adjusted linear correlation altimetry hs propagated hs whereas only 60 of the data from the zone near the coast was inside the 0 5 m range the rms error between the hs measurements from envisat and propagated numerical model of hs decrease from 1 12 m in coastal area to only 0 20 m in deep waters our analysis was focused on using an official product at a low posting rate 1 hz about 7 km between two consecutive measurements a more detailed study at a higher along track spatial resolution 20 hz and using products from dedicated coastal retracking approaches would be an asset 
22920,this study presents a methodology to verify the notion that wave measurements could be less accurate near the coast when they are provided by altimetry radars on board satellites the methodology is based on comparing significant wave height hs data from the ra 2 altimetry radar on board envisat satellite european space agency against points from a gulf of cadiz database that were propagated through smc software sistema de modelado costero nine years of swell waves were analysed 2002 2010 the results show a rmse of only 0 19 m correlation coefficient of r 0 96 in deep waters but this decreases within 10 km of the coastline reaching a value of 1 12 m r 0 16 at 5 km from the coast keywords satellite altimetry wave height propagation coast 1 introduction measurements of significant wave height hs and its variability in coastal areas are used for many purposes e g sediment transport analysis coastal wave setup storm surges including validation calibration of models for wave forecasting atmospheric modelling and ocean circulation these applications are useful for a wide range of purposes such as structural design engineering on the high seas coastal zone protection improvements in ship route security and planning of ocean operations satellite radar altimetry is designed to provide accurate information on sea surface height hs and wind speed at the sea surface over the open ocean however vignudelli et al 2011 and references therein suggested that altimetry measurements could be less accurate in coastal areas these issues are due to two main factors the contamination of waveforms due to land or very calm waters entering the radar footprint gómez enri et al 2010 and inaccurate tidal and wet tropospheric corrections caballero et al 2014 access to accurate information on coastal sea conditions is of great importance because of the socioeconomic and strategic interest of the coastal zone this calls for new processing strategies to generate optimised altimetric products suited to the diverse applications in challenging conditions many studies have focused on validation of the hs data given by satellite radar altimetry using in situ observations e g faugere et al 2006 passaro et al 2015 kudryavtseva and soomere 2017 but few have focused on the influence of the proximity to the coast although it has been set out that altimeter measurements are of lower accuracy near the coast queffeulou and bentamy 2007 bouffard et al 2008 vignudelli et al 2011 hareef baba shaeb et al 2015 with the objective of proving the reliability of altimetry data near the coast the aim of this paper is to present a methodology for assessing comparisons between the hs data given by altimetry data and that propagated from numerical models of virtual buoy data this study analyses a particular area of the gulf of cadiz sw of spain over nine years 1 1 study area the study area is located in the southwest of the iberian peninsula in the gulf of cadiz spain fig 1 a and b it is a mesotidal area with a tidal range of about 4 m and significant waves from the w sw quadrant laiz et al 2013 even though the winds from e se have high speed and persistence they lack the fetch length necessary to generate waves of similar heights to the w sw waves muñoz perez and abarca 2009 fig 1c shows the wave rose of the study area obtained from the rom 0 3 91 wave climate on the spanish coast ministry of public works 1991 higher probability of waves that come from the fourth quadrant w nnw can be seen in this wave rose the ra 2 altimetry radar on board envisat european satellite has two tracks that cross at the continental shelf of the gulf of cadiz fig 1b one corresponds to the descending pass 223 from land to sea from north to south and the other to the ascending pass 187 from sea to land from south to north 2 database and methodology 2 1 altimetry data an estimated hs based on the reprocessed altimetry radar signal ra 2 of the esa envisat satellite was used in this study data were obtained from the new full mission reprocessing fmr v3 0 ftp ra2 ftp ds eo esa int geophysical data record product the along track spatial resolution of the dataset was 1 hz equivalent to a distance between two consecutive measurements of 7 km the temporal resolution was 35 days 2 2 virtual buoy data simar database comes from the hindcast of dynamic processes of the ocean and coastal areas of europe hipocas project see the puertos del estado de españa website at www puertos es this wave database was obtained through numerical wave modelling wam from wind time series wam is a third generation spectral model that solves the equation of energy balance without a priori hypotheses about the spectral shape of the waves therefore the data are virtual and do not come from direct measures of the nature however this database has been validated by numerous studies and has been used in many practical applications along the spanish coasts tomas et al 2004 the simar database contains data generated every hour since 1958 the wave data are given in open water and undefined depths conditions where they comply with the following relationship 1 h lo 2 0 78 t2 where h is depth t is period and lo is wave length in deep water off shore the simar point with the code 5034017 was selected for this study which can be found freely at www puertos es the point location is 6 67 west and 36 67 north fig 1 the parameters chosen to carry out the wave propagation were the hs m the average period t s and the average wave direction θ 2 3 data filtering the altimetry database contained data for 140 passes of the satellite from 2002 to 2010 of these 47 were not considered because of null values the hourly points included sea and swell data wave thus of the 93 valid data points in the 2002 2010 period the 53 passes that corresponded to swell waves were selected 43 descending and 10 ascending passes we used the ocean depth land elevation field available in the product and considered only ocean measurements 2 4 wave propagation sistema de modelado costero smc software was used to perform the wave propagation this software was made by hidraulic institute of cantabria supervised by the spanish ministry of the environment in this way the hs data from the simar database could be propagated to the points located along the satellite passes shown in fig 1 to carry out a comparison with the altimetry data the smc software creates propagation nets in the study area to allow the software to calculate where and in which direction the wave propagates and in how many data points it provides information to that end data from simar the hs average period and average wave direction were added to the software on a wave editor once the wave is calculated and propagated the smc connects with another software surfer 8 that provides a graphical output of the study area with wave height data 2 5 statistical analysis we used two statistical parameters to compare both datasets i the linear correlation coefficient r between altimetry hs and propagated hs values and ii the root mean square error rmse 3 results and discussion table 1 shows the enumeration assigned to each point of the satellite passes as well as the average point depth and its average distance to the coastline in kilometres the points were enumerated according to the distance to the coastline and were classified into 6 zones fig 2 compares altimetry hs propagated hs in the different zones the correlation coefficients r are represented in fig 3 as a function of the distance to the coastline with a confidence interval of 95 of the linear adjustments of the compared data in fig 2 fig 3 shows that r is high and significant far from the coast from 10 km to deep waters close to the coast zone a r is low the results presented in this study agree with those by caballero et al 2014 who noted that the accuracy of satellite measurements is 0 5 m it can be seen that there is a 0 5 m difference between the data provided from altimetry and the propagated simar data more than 95 of all the data fall into the range of 0 5 m except for those nearest to the coastline zone a where only 60 of the data are within that range furthermore the slope of the linear regression is 0 36 67 underestimation in zone a while it is 0 78 in zone f only 22 underestimation finally the rmse decreases as the distance to the shore increases from 1 12 m in zone a to 0 19 m in deep waters therefore the accuracy of the estimation for data in zones further the coastline is much better than in the nearest area 4 conclusions the accuracy of altimetry radar measurements in zones near the coast has been assessed in previous works see vignudelli et al 2011 and references therein in this work simar virtual buoy data was propagated through numerical modelling with smc software and compared to hs data from altimetry measurements in the gulf of cadiz the linear correlation coefficient between the altimetric and propagated hs data was much lower near the coastline r 0 16 in this particular case the correlation coefficient increased at distances further than 10 km to the coastline with r 0 96 in deep waters it was observed that 95 of these data were within 0 5 m of the adjusted linear correlation altimetry hs propagated hs whereas only 60 of the data from the zone near the coast was inside the 0 5 m range the rms error between the hs measurements from envisat and propagated numerical model of hs decrease from 1 12 m in coastal area to only 0 20 m in deep waters our analysis was focused on using an official product at a low posting rate 1 hz about 7 km between two consecutive measurements a more detailed study at a higher along track spatial resolution 20 hz and using products from dedicated coastal retracking approaches would be an asset 
22921,the aim of this paper is to investigate uncertainties present during operation of offshore wind ow energy assets with a view to inform risk control policies for hedging of the incurring losses the parametric framework developed is subsequently applied across a number of different locations in the south east coast of the uk so as to demonstrate the effect of weather conditions and resulting downtime on a number of operational key performance indicators kpis such as downtime due to planned and unplanned interventions wind farm availability operation and maintenance o m costs and power production losses higher availability levels were observed in areas closer to shore of the specified region while the distribution of o m cost per mwh generated demonstrated a general trade off of higher power generation in locations farther from shore due to better wind speed profiles and higher o m costs as a result of the decreasing vessels accessibility the proposed methodology aspires to contribute to the development of better informed risk control policies through parametrically estimating the probability of exceedance curve of the production losses of an ow farm and indicating appropriate thresholds to be considered so as not to exceed a maximum level of risk keywords offshore wind energy o m cost modelling loss of revenue weather related risks risk control 1 introduction most relevant decisions throughout planning construction and operation of offshore wind ow energy assets made by market agents involve a significant level of risk due to technical conditions and project externalities ioannou et al 2017a b mathematically risk can be expressed as the product of the probability of occurrence of an event and the consequences associated with its outcome risk probability consequence while according to iso 2009 risk is defined as the effect of uncertainty on a project s objectives generally loss of revenue risk as a result of project delays turbine components damage losses during transport construction and operation can substantially affect the value of the asset during the construction phase unfavourable weather can result in delay of the commissioning date due to lack of accessibility of installation vessels which bear specific working limits for various marine operations during the operation phase in the occurrence of a failure weather related risks can increase the total downtime of the wind farm by impeding the access of the support vessels dispatched to perform maintenance activities leading to revenue losses both cases can lead to significant impact in cash flows and the project s ability to meet debt service requirements within the context of this study weather related risks refer to the effect i e potential energy production losses of the random nature of key sea state variables namely the wave height and wind speed whose exceedance beyond a threshold can influence the operability of the asset i e due to limited accessibility for maintenance in order to estimate the loss of revenue risk the downtime of the asset needs to be estimated as accurately as possible through modelling the planned and unplanned maintenance activities during the o m phase of the asset the development of high fidelity models would assist in the calculation of the total availability power production losses and o m costs throughout the service life of the asset which typically account for approximately 30 of the levelised cost of electricity lcoe in ow energy carroll et al 2016a ioannou et al 2018 most ow o m models currently available are used to inform project developers owners on the expected costs and performance of their assets they typically use turbine and balance of plant bop reliability data coupled with meteorological prediction models in order to predict the operational state of the wind farm throughout its service life and the maintenance activities required in general existing models and tools allow the modelling and simulation at a wind farm level considering various failure types for each wind turbine each failure type belongs to a certain maintenance category which determines the weather limitations and vessel crew and time needed for the repair the repair is performed when the simulated weather conditions allow for it so that the faulty turbines do not produce power until the repair is finished the models also keep track of availability of vessels crews and spare parts such that the influence of the availability vessels and crews on the availability and maintenance costs of the overall plant can be assessed common outputs of such models comprise the downtimes per subsystem failure type and per maintenance stage the wind farm turbine availability the total number of failures occurred the number of spare parts and the revenue losses among others commonly available o m models include the ecn o m tool rademakers et al 2009 and the nowicob tool hofmann and sperstad 2013 welte et al 2017 among others asgarpour m v d p 2014 dinwoodie et al 2013 feuchtwang and infield 2013 rangel ramirez and j d s 2008 scheu et al 2012 a comprehensive review of ow o m models is provided in hofmann 2011 martin et al 2016 while a benchmarking study comparing verifying four o m simulation models namely the strathclyde cdt nowicob uis sim model and ecume by means of a reference wind farm is presented in dinwoodie et al 2015 the present paper aims to inform risk control policies addressing weather related uncertainties during the operational phase of ow energy investments for hedging of the incurring losses the novelty of the present work lies on 1 the visualisation through scatter plots of o m relevant kpis of ow energy projects installed in a region of interest through the application of an in house parametric o m model and 2 the estimation of the probability of exceedance of a certain production loss threshold due to weather related uncertainties allowing insurers to quantify the entailed risk the proposed framework is parametrically applied in a reference region so as to demonstrate the effect of weather conditions and resulting downtime on a number of operational key performance indicators kpis such as wind farm availability o m costs per produced mwh and power production losses the proposed framework for calculating o m kpis incorporates latest databases of failure rates and cost components throughout the o m phase of the wind farm while it also allows rapid simulations for a number of locations within a region allowing development and visualisation of parametric expressions above analysis aspires to contribute to the development of better informed revenue loss risk control policies through parametrically estimating the probability of exceedance of a specified revenue loss threshold the rest of the paper is set out as follows section 2 presents an overview of risk control options available for renewable energy assets along with an introduction to key reliability concepts widely used in the o m cost analysis of ow turbines section 3 presents the framework developed for the calculation of operational kpis subsequently results from the application of the framework to a baseline wind farm installed at a specific location are presented in section 4 followed by the parametric estimation and illustration of o m related kpis across a number of locations in the south east coast of the uk furthermore this section expands the applicability of the proposed method to estimate the expected production losses due to the downtime of the wind farm and estimate the probability of exceedance of a pre determined threshold which would activate a potential risk control policy finally section 5 summarises the findings of this work 2 power production uncertainties and risk control options 2 1 risk control options for renewable energy assets investing in renewable energy assets e g an offshore wind farm owf is typically subjected to downside risks which is the combination of the probability of occurrence of a negative event and its associated financial effect international standardisation organisation 2009 the likelihood and impact of negative events are reflected in the financing costs quantified by the weighted average cost of capital wacc of the technology higher investment risk tends to increase both the bank s interest rates and the equity owners return expectations furthermore considering the fact that renewable energy technologies are typically capital intensive investments their lifecycle costs are very sensitive to an increase in financing expenditures schmidt 2014 it can therefore be concluded that financial risk mitigation can play an important role in reducing the lcoe of the technology general risk control options include i risk retention ii risk avoidance iii risk mitigation and iv risk transfer companies retain a risk when they have determined that transferring the risk is costlier than covering all or part of the losses out of their reserve budget also called self insurance or when they decide to consciously take a risk to potentially achieve a higher gain avoiding the risk implies deciding not to get involved in a high risk investment or operating within a geographic or operational region where the underlying hazard is not present mitigating the risk involves limiting the impact of a risk by taking appropriate measures finally risk transfer involves the contractual shifting of a risk from one party to another usually from the project owner to one or more insurance providers as far as the risk insurance market of ow energy is concerned there is currently a number of commercial risk control products that are expanding as the technology becomes more established unep 2004 construction is a phase of the lifecycle of an ow asset which involves considerable risks mainly due to the likely occurrence of incidents during the transportation and or installation of wind turbines and bop components such risks can be mitigated through effective project management and contracting however project owners tend to seek to extend their risk coverage to protect their investment against delay in start up dsu or the advanced loss of profit alop incurred through the inability of the construction contractor to commission the project on time developers can claim back lost revenues resulting from delays in construction swiss re bloomberg new energy finance 2013 another common risk transfer product available is the construction all risks car covering physical loss and damage during the construction phase of a project unep 2004 following the construction of the wind farm project owners often rely on manufacturer yield availability warranties by signing an o m contract that guarantees a certain uptime or availability level if the minimum yield levels are not met the o m contractor will be liable for availability liquidated damages lds clifford chance 2017 the o m contract comprises the most common risk control method ensuring the provision of spare parts and maintenance labour the loss of revenue due to component failure or natural catastrophy is critical for ow owners u s department of energy 2013 in example faults in the transformer of the offshore substation which from a reliability perspective is the weak link of the wind farm may result in the shut down of the whole wind farm inducing large financial losses it is therefore common apart from the manufacturer s warranties which usually last for 5 years after which the contract can either be renewed or the owner proceeds with alternative o m risk coverage ways to undertake business interruption bi coverage to insure against losses that are not already covered by o m contracts loss of revenue can also be induced by severe weather preventing vessels to access ow turbines to perform scheduled or unscheduled maintenance in such cases the owner of the asset can purchase an insurance product to hedge the financial impact of adverse weather on the project these risk control products dealing with the inability of the operations and maintenance contractor to gain access to the owf facility through short or sustained periods of unusually high waves can be financially mitigated through the use of parametric finite risk products these products are called parametric because they are triggered by a weather related parameter such as the significant wave height or the wind speed swiss re bloomberg new energy finance 2013 such products are gaining popularity as investors become more risk averse 2 2 the concept of availability the service life of the wind farm asset typically consists of uptime and downtime periods with uptime representing the intervals during which the turbine is able to produce energy and downtime the time that the turbine stops working as a result of a subsystem failure until the turbine is restored time based availability a t i m e eq 1 can be defined as the ratio of the total uptime of the wind farm to the total time in consideration sum of uptime and downtime while production based availability a p r o d u c t i o n eq 2 is estimated as the ratio of the energy actually produced to the amount of energy that would ideally be produced based on actual wind speeds and site conditions dnv gl 2017 scheu et al 2017 1 a t i m e u p t i m e u p t i m e d o w n t i m e 2 a p r o d u c t i o n a c t u a l e n e r g y p r o d u c e d e n e r g y p r o d u c t i o n p o t e n t i a l fig 1 demonstrates the mean time to failure mttf which equals the uptime period when the turbine is able to produce power and the mean time to repair mttr which reflects the total downtime of the wind farm and includes a number of activities related to planned and unplanned maintenance activities listed during the downtime can be divided into passive and active downtime passive downtime is related to the activities required until the execution of the actual maintenance activity active downtime improving availability can be achieved through decreasing passive downtime through better planning 3 development of an efficient model for calculating operational kpis 3 1 overview of the model the proposed model structure was determined following a state of the art literature review of existing o m models which allowed for the comprehensive modelling of the decisions made during the o m phase of the asset the main modules of the integrated o m analysis framework are 1 the failure modelling module 2 the weather modelling module and 3 the cost modelling module the failure modelling module is further divided into the mttf estimation namely the uptime of the asset and the mttr estimation throughout the planned and unplanned maintenance operations namely the downtime of the asset the mean time to failure calculation is based on the annual failure rates while the planned and unplanned maintenance operations require data related to the resources required for the repairs resulting downtime depends on the availability of the required vessels technicians weather window spare parts mission organisation time duration of navigation and repair as well as the required number of technicians shifts the weather modelling module enables the prediction of the future sea states namely future significant wave heights and wind speeds this module can therefore determine the expected power generation when the wind turbine is in operation through the turbine s power curve and the predicted wind speeds the expected power generation in turn is introduced into the o m cost module to estimate the actual loss of revenue taking into account both the downtime and the expected wind speeds weather conditions play an important role in the total downtime of the wind farm as when the related parameters surpass the set wave height and wind speed limits of the vessels travelling to wind turbines and accessing them becomes impossible therefore unfavourable weather conditions will delay repairs and thus will increase downtime and decrease the wind farm s availability the cost modelling module takes into account the actual duration of all stages required to perform the repair and maintenance operations and uses vessel and crew day rates along with material costs to predict the total o m cost other outputs of the model are the time based and production based availability and the power production losses it should be noted that the development of decisions for the different steps of the model have taken into consideration not only the accuracy of the calculation but also the computational efficiency required so as to allow a serial execution of simulations which is relevant to the comparative analysis which is the aim of this study a high level verification based on the results of published cases has been performed while further calibration of the model for more accurate results can take place through a specific case study 3 2 failure modelling module 3 2 1 estimation of mean time to repair mttr the mttf is equivalent to the uptime of the turbine and it can be calculated through the failure rates of the subsystems as illustrated in fig 2 with the orange coloured boxes u2u8 all symbols are summarised in the appendix in this study the repair categorisation of reliawind project garrad hassan 2007 was adopted which classifies repair classes of subsystems into minor repairs major repairs and major replacements a total of 19 subsystems of the wind turbine were considered while data used for the application of the model on failure rates average repair times average material costs and number of required personnel were retrieved from carroll et al 2016b as shown in fig 2 the mttf of each turbine t r is initially calculated based on the failure rates of their subsystems s u2u5 assuming that the reliability of the turbine follows an exponential distribution the probability of failure pof can be expressed as 3 p o f t r 1 r e l i a b i l i t y 1 e λ t r t 4 t m t t f t r 1 λ t r l n 1 p o f t r where λ t r s 1 s u b s y s t λ s is the sum of the failure rates of each turbine s subsystems in series monte carlo simulation is then performed to generate numerous random pof and subsequently returns an average m t t f t r value for each wind turbine once the mttfs are calculated equation 5 can be used to estimate the probability of occurrence of each subsystem s failure u6 as 5 p o f s 1 e λ s m t t f s where λ s k 1 r e p a i r c l a s s λ k is the sum of the failure rates of the different repair classes k of the subsystems namely the minor repairs major repairs and major replacements and m t t f s is the mttf of each subsystem once the probabilities of each subsystem s failure are known the model performs random weighted sampling u7 to determine which subsystem will fail once the mttf has elapsed along with the repair class which is also randomly selected following the same logical process apart from the mttf calculation the model calculates the absolute time set of the simulation t a b s t r which is interpreted as the actual time from the beginning to the end of life of the wind farm and is composed by the mttf and the calculated downtimes u8 the duration of the individual activities during planned and unplanned maintenance are added to the absolute time set enabling the calculation of the uptime and downtime of the turbine and registering the time when a certain failure happens 3 3 2 planned and unplanned maintenance unplanned corrective maintenance is carried out following the occurrence of a failure on the turbine or the bop which may affect several turbines the procedure after the occurrence of a new failure is illustrated in fig 2 with the green coloured boxes u9 28 once a failure has occurred on the first turbine i e when the mttf elapses the unplanned maintenance is initiated u9 and the turbine instantaneously shuts down the required resources namely the number and type of main and special vessels number of crew and materials depending on the subsystem and the repair class are then registered for the specific turbine u13 the maintenance process begins with the availability check of the required main and support vessels u14 15 followed by the check of the required number of crew u16 17 and subsequently the spare parts u18 19 it is assumed that a predetermined number of vessels can operate in the wind farm which will be available to access the wind turbine that failed if the weather conditions allow so and the same applies for the predetermined number of personnel and spare parts needed for the repair if however all predetermined available vessels crew spare parts are occupied the failure remains unresolved and the check is repeated once the required number of vessels crew spare parts are released from the previous mission all required resources can also be inserted by the user as per each subsystem and repair class once the required vessels crew and spare parts are available the weather conditions are checked u20 21 the weather window is sufficient as long as the significant wave height and the wind speed conditions at the wind farm site which are forecasted with a 3 h time step are below the operational threshold limits of the vessels commissioned throughout the whole intended time offshore although this assumption may be a little conservative consideration of higher resolution sea state forecasts that would enable shorter term forecasting would significantly increase the complexity and computational effort of the model nevertheless the parametric analysis featured in this work requires multiple simulations to be realised hence increasing the computational effort would render the model non fit for purpose subsequently the organisation of the mission u23 including the mobilisation of the vessel s if required take place once the crew accesses the subsystem that failed the repair is carried out u24 it is assumed that one work shift lasts for up to 12 h which includes the total repair time transitioning from harbour to the site and vice versa as well as a mid shift break in case that more than one shifts are required the crew returns to harbour and the mission restarts 12 h later u25 when the damage is restored the wind turbine starts producing power again and the mttf of the subsystem is reset to its original value finally the transit back to the harbour and the demobilisation time need to be accounted to estimate the end of the mission when the vessel and crew becomes available for the next mission which will affect activities described in u14 17 at that point the absolute time of each wind turbine is revised by adding the durations of all previous unplanned maintenance activities namely the waiting time for vessel crew spares availability the lack of weather window the organisation time of the mission and the crew rest navigation and repair activities as shown in fig 2 u26 above process is repeated for all wind turbines u10 once the absolute total time set of each turbine equals the predetermined service life of the wind farm u11 the simulation stops and o m related key performance indicators such as total uptime downtime availability and o m cost per mwh generated can be derived u27 28 planned maintenance else calendar based maintenance operations are carried out periodically and deal not only with one subsystem of the wind turbine but with groups of or all subsystems of each wind turbine during each charter planned maintenance can be scheduled ahead of time during periods of favourable weather conditions when delays to missions due to exceedance of vessels safety limits weather window downtime are not likely to occur so that the availability of the wind turbine and amount of generated electricity is affected the least possible the same applies for vessels crew and spare parts unavailability downtimes in this analysis calendar based maintenance is assumed to take place every one year t p l m a i n t with a deviation of 1 month to simulate the real life operations downtime due to planned maintenance is assumed to originate exclusively from the navigation and repair time together with the potential downtime due to crew rest as shown in fig 3 an iteration process takes place until all wind turbines t r have been maintained p5 and reached the end of their service life by monitoring the absolute time set of each turbine which considers the mttf and the downtime due to planned and unplanned maintenance in this analysis it is assumed that planned maintenance can only restore minor repairs i e once each mission terminates the mean time to failure of minor repairs is reset it is expected that unplanned maintenance will incur higher downtimes in relation to planned maintenance considering the longer expected downtimes and types of maintenance activities 3 3 weather modelling as described in the previous sections predicting weather conditions for the operational lifetime of an owf is crucial to predict its availability if wave height and wind speed conditions exceed vessels safety thresholds transit from harbour to the wind farm is not possible leading to delays in performing repairs thus increasing downtime and decreasing the wind farm s availability scheu et al 2018 commonly used methods for generating sea state time series comprise gaussian and langanian approaches for short term wave modelling autoregressive moving average arma methods and markov based models in this study the markov chain process was chosen due to the fact that it works well for long term forecasting and can capture persistence of sea state parameters additionally it is a method widely applied in literature anastasiou and tsekos 1996 hofmann and sperstad 2013 scheu et al 2012 and can handle conditional probability distributions overall steps of the discrete time markov chain process used for the weather forecasting method are illustrated in fig 2 with the purple coloured boxes u29 34 to this end historic weather datasets from 1992 to 2017 with a 3 h time step were retrieved from btm argoss database btm argoss 2017 discrete time markov chains method is based on having a finite number of states in a system and estimating the probability p i j of state i to evolve into state j markov probability matrices are generated for each month to account for seasonality as shown below 6 p s e a s t a t e p a r a m e t e r m o n t h p 11 p 12 p 1 n p 21 p 22 p 2 n p n 1 p n 2 p n n m o n t h where p i j equals the number of transitions of sea state parameter i to j divided by the total number of times state i appears as such initially the weather data is discretised with a specified resolution fig 2 u30 a time step of 3 h is considered for the forecast during which wind speed and wave height are assumed to remain constant based on the probabilities of each transition matrix the wave height for the starting month is randomly selected and successively all sea state conditions are predicted as a function of the previous state and the transition probability 3 4 cost modelling the cost modelling module gathers the data recorded during each iteration which are required to estimate the o m cost for unplanned maintenance of wind turbines the time that a failure occurs is registered with reference starting point the beginning of operation of the wind farm further the subsystem that failed and the type of failure will define the required main and support vessels to match the correct day rates and the number of crew members required for the repair downtimes of crew unavailability spare parts unavailability weather window navigation time and demobilisation time are taken into account and assigned to the respective day rates of vessels crew cost of materials mobilisation and demobilisation costs to estimate the total o m cost 4 results and discussion 4 1 baseline wind farm 4 1 1 characteristics of wind farm the baseline case is a representative wind farm located in european waters and its characteristics are summarised in table 1 the integrated o m cost estimation framework was applied to the baseline wind farm and across a number of different locations in a region by the south east coast of the uk weather data were obtained from the btm argos database for a set of 204 different locations with latitude and longitude coordinates ranging between 0 000 2 667 and 50 000 53 667 respectively covering the south east coast of the uk as illustrated in fig 4 this region was selected due to its high concentration of currently operating and under construction round 1 2 and 3 wind farms the crown estate 2017 existing ports near the afore mentioned set of 204 different locations of the focus region were identified from 4c offshore 4c offshore 2018 and their coordinates are summarised in table 2 it was assumed that these ports provide their adjacent wind farms with maintenance support services to this end the distances of all ports from all potential owf locations were calculated and the port having the shortest distance from a particular owf location was assumed to be the base port of this location serving its maintenance operations 4 1 2 assumptions on the operating cost components cost components taken into consideration in the present study comprise the cost of main and support vessels crew and materials herein material is anything that is used or replaced in the turbine from consumable materials to whole replacement parts such as full generators the required cost parameters of the maintenance vessels are summarised in table 3 the material costs are adopted from carroll et al s publication carroll et al 2016b while the vessel and crew day rates as well as the cost of materials used in the present study were adopted from a recent publication of the authors ioannou et al 2018 all costs were assumed to be fixed throughout the 25 service life of the asset so as to reduce the complexity of the model to estimate the revenue loss due to the downtime of the wind farm a fixed price of 100 mwh was assumed throughout the 25 year service life of the wind farm asset 4 2 risk based revenue loss modelling 4 2 1 operation and maintenance results for a specific location the model was initially applied for the prediction of the operational kpis of the baseline wind farm installed in a single location with coordinates 0 000 50 334 for the modelling of the future weather conditions on location 0 000 50 334 weather data obtained from btm argoss were discretised with a resolution of 0 2 m for wave height and 1 m s for wind speed data resulting in a finite number of possible values namely 33 ranging from 0 to 6 4 m and 25 values ranging from 0 to 24 m s respectively the mean wave height of the dataset was calculated 1 08 m and mean wind speed 10 m above sea level 6 83 m s the power output for the 25 years of operation of each of the 140 turbines as well as the breakdown of downtimes are illustrated in fig 5 and fig 6 respectively total power produced was calculated 38872 gwh and the total downtime 2 7887 106 h with a power based availability of 90 1 and a time based availability of 88 9 the downtime due to weather unsuitability had the highest share of the total downtime 25 1 followed by the repair time 22 2 and the spare availability downtime 16 8 the temporal o m costs throughout the service life of the wind farm are shown in fig 7 for unplanned maintenance of both wind turbines and the bop as well as for planned maintenance total wind farm o m cost during the entire service life was estimated at 686 5 million due to the difficulty in obtaining long term data from operational wind farms as a result of the newly developed industry and the motivation of turbine manufacturers and operators to keep their competitive advantage by not distributing information related to reliability and cost validation of o m models is a difficult task furthermore available benchmarking studies such as the one made in dinwoodie et al 2015 highlight significant differences in the calculated o m kpis across four o m tools compared in their study however an attempt was made by the authors to compare results of the developed model with results derived as part of the recent work of martin et al s martin et al 2016 which also studied the operational availability of wind farms located in the south east cost of the uk and performed simulations for three owf case studies mean annual wave height 1 02 m and wind speed 10 m above sea level 7 15 m s were also relatively close to the reference case study of the present work the range of availability was estimated between 84 and 92 with an average of 89 results have shown acceptable agreement as both studies have shown relatively lower values of availability compared to generic values reported in literature which is due to the overall weather potential of the region it also has to be noted that deviations between the two models can be justified due to the more up to date failure rate databases used in the present study 4 2 2 parametric estimation of operational kpis subsequently the model was applied for 204 locations in the south east coast of the uk illustrated in fig 4 using the respective historic weather data for each set of coordinates retrieved from the btm argoss database a convergence study was conducted to determine the size of the monte carlo sample for the calculation of mttf of each turbine and the model iterations to ensure the robustness and efficiency of the model the averaging of the outputs derived from 1000 monte carlo simulations and 5 iterations of the code were determined to allow for the generation of robust results accordingly a number of location specific colour coded plots illustrating resulting operational kpis across the whole region were generated the production based wind farm availability results are plotted in fig 8 a for each of the 204 sets of coordinates under investigation higher availability levels can be observed in areas closer to the coast of the specified region noting that half a degree is equivalent to a distance of approximately 56 km this can be attributed to the smaller distances between the port and the wind farm site as well as the lower magnitudes of significant wave height and wind speed limits improving the accessibility of the maintenance vessels for the performance of unplanned maintenance hence reducing the total downtime of the asset results demonstrate a smooth transition from high availability values in locations closer to the coast to gradually decreasing farther from shore nevertheless a number of outliers can be observed for example in the location point 2 000 53 334 where an availability peak is noted this can be explained as the result of measurement uncertainty of the historic met ocean data fig 8 b illustrates the breakdown of downtimes for the location with the lowest and highest availability weather downtime appears to have the greatest contribution to the total downtime for the lowest availability location while repair time is the main contributor for the highest availability location fig 9 illustrates the total undiscounted o m cost per produced mwh revealing a more uniform distribution of unit cost in relation to the availability values across the different locations this is due to a trade off of higher power generation due to better wind speed profiles and higher o m costs due to decreasing accessibility of vessels for maintenance operations for example a hypothetical wind farm installed at point 1 000 51 500 appears to reach an availability level of 92 6 fig 8 a in return of high unit costs amounting to 24 5 mwh fig 9 as a result of the poor wind speed profile resulting in low power production nevertheless exceptions of this observation can be found for example in the areas positioned in the southern part of the specified region where high availability together with relatively low unit costs can be observed this observation can potentially lead to the conclusion that these regions can offer a good balance of availability versus costs however it has to be noted that other factors such as geotechnical conditions environmental impact assessment studies and other parameters need to be taken into account before determining the suitability of a location for the installation of a wind farm mytilinou et al 2018 mytilinou and kolios 2019 finally the expected total power production loss due to the wind farm downtime is plotted in fig 9 production loss reflects the total revenue loss due to downtime as it is calculated by subtracting the power produced during uptime from the potential power produced both during uptime and downtime wind speed profile of the location is also taken into consideration it is therefore a parameter with a great impact on the financial performance of the investment the revenue loss plot was found to follow a similar to the availability plot pattern with locations closer to shore indicating lower revenue potential losses due to the reduced downtime of the wind farm 4 2 3 weather related risk control policy options traditional insurance products available for renewable energy projects typically protect against natural disasters such as storms earthquakes and hurricanes grossi et al 2005 as well as physical losses and damages to the plant asset during the construction and operating phases unep 2004 furthermore academic literature on the effects of weather related risks on ow energy projects also focuses on analysing the effect of extreme weather events barabadi et al 2016 becerra et al 2018 lamraoui et al 2014 however risk management against the effect of seasonal fluctuations in climatic conditions such as variation in wind speeds temperature and wave height is becoming more relevant as investors are inclined to reduce their risk exposure weather related risk hedging products are usually financial contracts which can be executed in the form of insurance or weather derivatives structured as swaps futures and options that are based on a weather related index li 2018 in the case of ow significant wave height and wind speed could be relevant weather related indices the seller of the weather derivative bears the risk of potential financial losses as a result of the weather conditions in exchange of an upfront premium if the pre determined limit of the index is surpassed over a specified period the project owner is compensated the downtime financial losses the index based policy structure has the advantage of simplicity although there may exist some ambiguity in terms of the actual financial impact caused by the exceedance of the specified threshold in the case of ow for example exceedance of the threshold of the significant wave height limit over a specified period of time may not necessarily lead to financial losses on the contrary power production loss due to downtime could be a risk index easier to translate into resulting revenue losses over a period of time while relevant data can be retrieved by the supervisory control and data acquisition scada systems installed in the wind farm fig 11 illustrates the cumulative power production losses summed on a monthly period over the service life of the baseline wind farm installed in the location 0 000 50 334 a threshold of 45000 mwh power production loss over the period of a month was assumed above which the buyer of the risk transfer product is compensated for the revenue loss corresponding to this threshold the estimation of the premium should be based on the probability of exceedance of the specific limit with a 5 6 monthly probability of exceedance the risk of the investor is estimated in terms of production losses 45000 5 6 2520 mwh assuming a fixed price of 100 mwh the maximum premium that the buyer would be willing to pay is therefore 252000 per month the exceedance probability ep curve is used by insurers to estimate the probable maximum loss pml for a portfolio of investments in a given period of time the pml is a bespoke risk metric and is associated with a probability of exceedance reflecting the insurer s acceptable level of risk as such the insurer can use the ep curve to determine the magnitude of loss at the desired probability of exceedance level in fig 12 the monthly ep curve of the reference wind farm is demonstrated the ep curve can also assist the distribution of losses between stakeholders as such the project owner would retain the first part of the loss i e the deductibles for example losses up to 45000 mwh while the insurer covers monthly production losses occurring in excess of this amount setting the above threshold of monthly power production losses i e 45000 mwh across all sets of coordinates of the designated region the distribution of the exceedance probabilities is illustrated in fig 13 for areas closer to the coast the probability of exceedance does not surpass the level of 6 while in areas farther from shore probability reaches 18 comparing the scatter plot of probability of the production loss exceedance threshold with the production losses one in fig 10 it becomes evident that the amount of power production losses throughout the service life of the asset is not necessarily proportional to the entailed risk of surpassing a threshold set on a monthly or even annual basis this map can provide a basis for screening which locations are likely to incur higher insurance premiums for weather related parametric risk control products insurance policies are typically valid for a specified period of time defined in the insurance policy contract varying from a few weeks to a number of years it can thus be deduced that the magnitude of risk transferred to a third party greatly depends on the coverage period set by the contract specifically for ow energy assets the persistence of the weather conditions can be detrimental on the resulting financial losses and by extension on the compensation required by the risk control policy above application assumed that the risk control policy will be activated once the cumulative energy production losses within a reference period of one month surpass a specified threshold 45000 mwh through the ep curve appropriate production loss thresholds can be identified by insurers so as not to surpass a maximum risk level over the reference period of the risk control policy adjusting their exposure to risk up to a desired level 5 conclusions there is a number of industries whose operations can be impacted by the varying weather conditions and the ow industry is certainly one of them although the traditional weather related risk transfer products available are mainly employed to protect against catastrophic events there is currently an increasing interest in hedging against seasonal weather fluctuation risks in order to minimise their impact on the financial performance of the investment protection against weather risk was originally included as a clause embedded in contracts for unforeseen weather conditions but is now becoming a bespoke financial instrument to hedge the risk of the resulting financial losses currently offered by insurance companies and brokers willis towers watson 2018 in this paper uncertainties present in the operational stage of ow investments are investigated systematically with a view to inform risk control policies for hedging of the incurring losses for the estimation of operational kpis the latest databases of location specific environmental conditions failure rates and required repair resources are integrated together with discrete time markov chains for forecasting future sea states the model is firstly applied to a reference wind farm installed in a specific location to test the applicability of the model and verify its results then the model is applied to a set of locations in the south east coast of the uk to derive scatter plots of aforementioned kpis such as cost per mwh and power production losses indicating the effect of weather and maintenance downtime throughout the o m phase of the asset s lifecycle further to the calculation of power production losses the probability of exceedance of a specified power production loss threshold was estimated across all locations of the south east coast deriving insights regarding the distribution of the risk level of financial losses due to weather and maintenance downtime across the designated region it was observed that there is a trend for higher production based availability levels in areas closer to the coast of the specified region furthermore the scatter plot of o m cost per mwh generated demonstrated a more uniform pattern across the different locations indicating that there is a trade off of higher power generation in locations farther from shore due to better wind speed profiles and higher o m costs as a result of the decreasing accessibility of vessels for performing maintenance operations production losses distribution was found to follow a pattern similar to the availability one with locations closer to shore displaying lower potential production losses due to the reduced downtime of the wind farm production losses can reflect the total revenue loss due to downtime to this end it was chosen as the most relevant parameter to demonstrate the financial risk induced by weather and maintenance downtime it was highlighted that the amount of power production losses throughout the service life of the asset is not necessarily proportional to the entailed risk of surpassing a set threshold in order for the developed model to be versatile allowing for iterative simulations a number of assumptions were considered which are acceptable for the comparative nature of the present study these assumptions could be further considered in future studies which could focus on absolute calculation of kpis for example the weather limits considered for each vessel can be modelled in greater detail distinguishing the limits for the vessel transit and the repair of the failure furthermore from the repair identification until the asset becomes unfunctional i e stops working some residual capacity still exists future work could focus on modelling this concept considering pf intervals finally the proposed methodology can be used by insurers and relevant stakeholders to produce the ep curve of the production losses of an owf indicating appropriate thresholds to be considered for a specific reference period e g cumulative monthly weekly or yearly production losses so as not to exceed a maximum level of risk in this way risk control policies can be better informed allowing the insurers to adjust their exposure to risk up to a desired level acknowledgment this work was supported by grant ep l016303 1 for cranfield university the university of strathclyde and the university of oxford centre for doctoral training in renewable energy marine structures rems http www rems cdt ac uk from the uk engineering and physical sciences research council epsrc this work has also received funding from supergen wind hub grant number ep l014106 1 appendix nomenclature indices i j different sea states k repair class minor repairs major repairs and major replacements n number of sea states considered s subsystem of turbine t r turbine variables a p r o d u c t i o n time based availability a t i m e production based availability m t t f s mttf of subsystem s h m t t f t r mttf of turbine t r h p o f t r probability of failure of turbine t r p i j probability state i evolves into state j t a b s t r absolute time set of the simulation h t c r e w downtime due to unavailability of crew h t d e m demobilisation and transit back to the harbour time h t o r g downtime due to mission organisation h t r e p a i r downtime for crew rest travel and repair time h t s p a r e s downtime due to unavailability of spares h t v e s downtime due to unavailability of main and support vessel h t w e a t h e r downtime due to unavailability of weather window h λ k failure rate of repair class k failures turbine year λ s failure rate of subsystem s failures turbine year λ t r failure rate of turbine t r failures turbine year abbreviations alop advanced loss of profit bi business interruption bop balance of plant dsu delay in start up ep exceedance probability kpis key performance indicators lcoe levelised cost of electricity lds liquidated damages owf offshore wind farm pml probable maximum loss wacc weighted average cost of capital 
22921,the aim of this paper is to investigate uncertainties present during operation of offshore wind ow energy assets with a view to inform risk control policies for hedging of the incurring losses the parametric framework developed is subsequently applied across a number of different locations in the south east coast of the uk so as to demonstrate the effect of weather conditions and resulting downtime on a number of operational key performance indicators kpis such as downtime due to planned and unplanned interventions wind farm availability operation and maintenance o m costs and power production losses higher availability levels were observed in areas closer to shore of the specified region while the distribution of o m cost per mwh generated demonstrated a general trade off of higher power generation in locations farther from shore due to better wind speed profiles and higher o m costs as a result of the decreasing vessels accessibility the proposed methodology aspires to contribute to the development of better informed risk control policies through parametrically estimating the probability of exceedance curve of the production losses of an ow farm and indicating appropriate thresholds to be considered so as not to exceed a maximum level of risk keywords offshore wind energy o m cost modelling loss of revenue weather related risks risk control 1 introduction most relevant decisions throughout planning construction and operation of offshore wind ow energy assets made by market agents involve a significant level of risk due to technical conditions and project externalities ioannou et al 2017a b mathematically risk can be expressed as the product of the probability of occurrence of an event and the consequences associated with its outcome risk probability consequence while according to iso 2009 risk is defined as the effect of uncertainty on a project s objectives generally loss of revenue risk as a result of project delays turbine components damage losses during transport construction and operation can substantially affect the value of the asset during the construction phase unfavourable weather can result in delay of the commissioning date due to lack of accessibility of installation vessels which bear specific working limits for various marine operations during the operation phase in the occurrence of a failure weather related risks can increase the total downtime of the wind farm by impeding the access of the support vessels dispatched to perform maintenance activities leading to revenue losses both cases can lead to significant impact in cash flows and the project s ability to meet debt service requirements within the context of this study weather related risks refer to the effect i e potential energy production losses of the random nature of key sea state variables namely the wave height and wind speed whose exceedance beyond a threshold can influence the operability of the asset i e due to limited accessibility for maintenance in order to estimate the loss of revenue risk the downtime of the asset needs to be estimated as accurately as possible through modelling the planned and unplanned maintenance activities during the o m phase of the asset the development of high fidelity models would assist in the calculation of the total availability power production losses and o m costs throughout the service life of the asset which typically account for approximately 30 of the levelised cost of electricity lcoe in ow energy carroll et al 2016a ioannou et al 2018 most ow o m models currently available are used to inform project developers owners on the expected costs and performance of their assets they typically use turbine and balance of plant bop reliability data coupled with meteorological prediction models in order to predict the operational state of the wind farm throughout its service life and the maintenance activities required in general existing models and tools allow the modelling and simulation at a wind farm level considering various failure types for each wind turbine each failure type belongs to a certain maintenance category which determines the weather limitations and vessel crew and time needed for the repair the repair is performed when the simulated weather conditions allow for it so that the faulty turbines do not produce power until the repair is finished the models also keep track of availability of vessels crews and spare parts such that the influence of the availability vessels and crews on the availability and maintenance costs of the overall plant can be assessed common outputs of such models comprise the downtimes per subsystem failure type and per maintenance stage the wind farm turbine availability the total number of failures occurred the number of spare parts and the revenue losses among others commonly available o m models include the ecn o m tool rademakers et al 2009 and the nowicob tool hofmann and sperstad 2013 welte et al 2017 among others asgarpour m v d p 2014 dinwoodie et al 2013 feuchtwang and infield 2013 rangel ramirez and j d s 2008 scheu et al 2012 a comprehensive review of ow o m models is provided in hofmann 2011 martin et al 2016 while a benchmarking study comparing verifying four o m simulation models namely the strathclyde cdt nowicob uis sim model and ecume by means of a reference wind farm is presented in dinwoodie et al 2015 the present paper aims to inform risk control policies addressing weather related uncertainties during the operational phase of ow energy investments for hedging of the incurring losses the novelty of the present work lies on 1 the visualisation through scatter plots of o m relevant kpis of ow energy projects installed in a region of interest through the application of an in house parametric o m model and 2 the estimation of the probability of exceedance of a certain production loss threshold due to weather related uncertainties allowing insurers to quantify the entailed risk the proposed framework is parametrically applied in a reference region so as to demonstrate the effect of weather conditions and resulting downtime on a number of operational key performance indicators kpis such as wind farm availability o m costs per produced mwh and power production losses the proposed framework for calculating o m kpis incorporates latest databases of failure rates and cost components throughout the o m phase of the wind farm while it also allows rapid simulations for a number of locations within a region allowing development and visualisation of parametric expressions above analysis aspires to contribute to the development of better informed revenue loss risk control policies through parametrically estimating the probability of exceedance of a specified revenue loss threshold the rest of the paper is set out as follows section 2 presents an overview of risk control options available for renewable energy assets along with an introduction to key reliability concepts widely used in the o m cost analysis of ow turbines section 3 presents the framework developed for the calculation of operational kpis subsequently results from the application of the framework to a baseline wind farm installed at a specific location are presented in section 4 followed by the parametric estimation and illustration of o m related kpis across a number of locations in the south east coast of the uk furthermore this section expands the applicability of the proposed method to estimate the expected production losses due to the downtime of the wind farm and estimate the probability of exceedance of a pre determined threshold which would activate a potential risk control policy finally section 5 summarises the findings of this work 2 power production uncertainties and risk control options 2 1 risk control options for renewable energy assets investing in renewable energy assets e g an offshore wind farm owf is typically subjected to downside risks which is the combination of the probability of occurrence of a negative event and its associated financial effect international standardisation organisation 2009 the likelihood and impact of negative events are reflected in the financing costs quantified by the weighted average cost of capital wacc of the technology higher investment risk tends to increase both the bank s interest rates and the equity owners return expectations furthermore considering the fact that renewable energy technologies are typically capital intensive investments their lifecycle costs are very sensitive to an increase in financing expenditures schmidt 2014 it can therefore be concluded that financial risk mitigation can play an important role in reducing the lcoe of the technology general risk control options include i risk retention ii risk avoidance iii risk mitigation and iv risk transfer companies retain a risk when they have determined that transferring the risk is costlier than covering all or part of the losses out of their reserve budget also called self insurance or when they decide to consciously take a risk to potentially achieve a higher gain avoiding the risk implies deciding not to get involved in a high risk investment or operating within a geographic or operational region where the underlying hazard is not present mitigating the risk involves limiting the impact of a risk by taking appropriate measures finally risk transfer involves the contractual shifting of a risk from one party to another usually from the project owner to one or more insurance providers as far as the risk insurance market of ow energy is concerned there is currently a number of commercial risk control products that are expanding as the technology becomes more established unep 2004 construction is a phase of the lifecycle of an ow asset which involves considerable risks mainly due to the likely occurrence of incidents during the transportation and or installation of wind turbines and bop components such risks can be mitigated through effective project management and contracting however project owners tend to seek to extend their risk coverage to protect their investment against delay in start up dsu or the advanced loss of profit alop incurred through the inability of the construction contractor to commission the project on time developers can claim back lost revenues resulting from delays in construction swiss re bloomberg new energy finance 2013 another common risk transfer product available is the construction all risks car covering physical loss and damage during the construction phase of a project unep 2004 following the construction of the wind farm project owners often rely on manufacturer yield availability warranties by signing an o m contract that guarantees a certain uptime or availability level if the minimum yield levels are not met the o m contractor will be liable for availability liquidated damages lds clifford chance 2017 the o m contract comprises the most common risk control method ensuring the provision of spare parts and maintenance labour the loss of revenue due to component failure or natural catastrophy is critical for ow owners u s department of energy 2013 in example faults in the transformer of the offshore substation which from a reliability perspective is the weak link of the wind farm may result in the shut down of the whole wind farm inducing large financial losses it is therefore common apart from the manufacturer s warranties which usually last for 5 years after which the contract can either be renewed or the owner proceeds with alternative o m risk coverage ways to undertake business interruption bi coverage to insure against losses that are not already covered by o m contracts loss of revenue can also be induced by severe weather preventing vessels to access ow turbines to perform scheduled or unscheduled maintenance in such cases the owner of the asset can purchase an insurance product to hedge the financial impact of adverse weather on the project these risk control products dealing with the inability of the operations and maintenance contractor to gain access to the owf facility through short or sustained periods of unusually high waves can be financially mitigated through the use of parametric finite risk products these products are called parametric because they are triggered by a weather related parameter such as the significant wave height or the wind speed swiss re bloomberg new energy finance 2013 such products are gaining popularity as investors become more risk averse 2 2 the concept of availability the service life of the wind farm asset typically consists of uptime and downtime periods with uptime representing the intervals during which the turbine is able to produce energy and downtime the time that the turbine stops working as a result of a subsystem failure until the turbine is restored time based availability a t i m e eq 1 can be defined as the ratio of the total uptime of the wind farm to the total time in consideration sum of uptime and downtime while production based availability a p r o d u c t i o n eq 2 is estimated as the ratio of the energy actually produced to the amount of energy that would ideally be produced based on actual wind speeds and site conditions dnv gl 2017 scheu et al 2017 1 a t i m e u p t i m e u p t i m e d o w n t i m e 2 a p r o d u c t i o n a c t u a l e n e r g y p r o d u c e d e n e r g y p r o d u c t i o n p o t e n t i a l fig 1 demonstrates the mean time to failure mttf which equals the uptime period when the turbine is able to produce power and the mean time to repair mttr which reflects the total downtime of the wind farm and includes a number of activities related to planned and unplanned maintenance activities listed during the downtime can be divided into passive and active downtime passive downtime is related to the activities required until the execution of the actual maintenance activity active downtime improving availability can be achieved through decreasing passive downtime through better planning 3 development of an efficient model for calculating operational kpis 3 1 overview of the model the proposed model structure was determined following a state of the art literature review of existing o m models which allowed for the comprehensive modelling of the decisions made during the o m phase of the asset the main modules of the integrated o m analysis framework are 1 the failure modelling module 2 the weather modelling module and 3 the cost modelling module the failure modelling module is further divided into the mttf estimation namely the uptime of the asset and the mttr estimation throughout the planned and unplanned maintenance operations namely the downtime of the asset the mean time to failure calculation is based on the annual failure rates while the planned and unplanned maintenance operations require data related to the resources required for the repairs resulting downtime depends on the availability of the required vessels technicians weather window spare parts mission organisation time duration of navigation and repair as well as the required number of technicians shifts the weather modelling module enables the prediction of the future sea states namely future significant wave heights and wind speeds this module can therefore determine the expected power generation when the wind turbine is in operation through the turbine s power curve and the predicted wind speeds the expected power generation in turn is introduced into the o m cost module to estimate the actual loss of revenue taking into account both the downtime and the expected wind speeds weather conditions play an important role in the total downtime of the wind farm as when the related parameters surpass the set wave height and wind speed limits of the vessels travelling to wind turbines and accessing them becomes impossible therefore unfavourable weather conditions will delay repairs and thus will increase downtime and decrease the wind farm s availability the cost modelling module takes into account the actual duration of all stages required to perform the repair and maintenance operations and uses vessel and crew day rates along with material costs to predict the total o m cost other outputs of the model are the time based and production based availability and the power production losses it should be noted that the development of decisions for the different steps of the model have taken into consideration not only the accuracy of the calculation but also the computational efficiency required so as to allow a serial execution of simulations which is relevant to the comparative analysis which is the aim of this study a high level verification based on the results of published cases has been performed while further calibration of the model for more accurate results can take place through a specific case study 3 2 failure modelling module 3 2 1 estimation of mean time to repair mttr the mttf is equivalent to the uptime of the turbine and it can be calculated through the failure rates of the subsystems as illustrated in fig 2 with the orange coloured boxes u2u8 all symbols are summarised in the appendix in this study the repair categorisation of reliawind project garrad hassan 2007 was adopted which classifies repair classes of subsystems into minor repairs major repairs and major replacements a total of 19 subsystems of the wind turbine were considered while data used for the application of the model on failure rates average repair times average material costs and number of required personnel were retrieved from carroll et al 2016b as shown in fig 2 the mttf of each turbine t r is initially calculated based on the failure rates of their subsystems s u2u5 assuming that the reliability of the turbine follows an exponential distribution the probability of failure pof can be expressed as 3 p o f t r 1 r e l i a b i l i t y 1 e λ t r t 4 t m t t f t r 1 λ t r l n 1 p o f t r where λ t r s 1 s u b s y s t λ s is the sum of the failure rates of each turbine s subsystems in series monte carlo simulation is then performed to generate numerous random pof and subsequently returns an average m t t f t r value for each wind turbine once the mttfs are calculated equation 5 can be used to estimate the probability of occurrence of each subsystem s failure u6 as 5 p o f s 1 e λ s m t t f s where λ s k 1 r e p a i r c l a s s λ k is the sum of the failure rates of the different repair classes k of the subsystems namely the minor repairs major repairs and major replacements and m t t f s is the mttf of each subsystem once the probabilities of each subsystem s failure are known the model performs random weighted sampling u7 to determine which subsystem will fail once the mttf has elapsed along with the repair class which is also randomly selected following the same logical process apart from the mttf calculation the model calculates the absolute time set of the simulation t a b s t r which is interpreted as the actual time from the beginning to the end of life of the wind farm and is composed by the mttf and the calculated downtimes u8 the duration of the individual activities during planned and unplanned maintenance are added to the absolute time set enabling the calculation of the uptime and downtime of the turbine and registering the time when a certain failure happens 3 3 2 planned and unplanned maintenance unplanned corrective maintenance is carried out following the occurrence of a failure on the turbine or the bop which may affect several turbines the procedure after the occurrence of a new failure is illustrated in fig 2 with the green coloured boxes u9 28 once a failure has occurred on the first turbine i e when the mttf elapses the unplanned maintenance is initiated u9 and the turbine instantaneously shuts down the required resources namely the number and type of main and special vessels number of crew and materials depending on the subsystem and the repair class are then registered for the specific turbine u13 the maintenance process begins with the availability check of the required main and support vessels u14 15 followed by the check of the required number of crew u16 17 and subsequently the spare parts u18 19 it is assumed that a predetermined number of vessels can operate in the wind farm which will be available to access the wind turbine that failed if the weather conditions allow so and the same applies for the predetermined number of personnel and spare parts needed for the repair if however all predetermined available vessels crew spare parts are occupied the failure remains unresolved and the check is repeated once the required number of vessels crew spare parts are released from the previous mission all required resources can also be inserted by the user as per each subsystem and repair class once the required vessels crew and spare parts are available the weather conditions are checked u20 21 the weather window is sufficient as long as the significant wave height and the wind speed conditions at the wind farm site which are forecasted with a 3 h time step are below the operational threshold limits of the vessels commissioned throughout the whole intended time offshore although this assumption may be a little conservative consideration of higher resolution sea state forecasts that would enable shorter term forecasting would significantly increase the complexity and computational effort of the model nevertheless the parametric analysis featured in this work requires multiple simulations to be realised hence increasing the computational effort would render the model non fit for purpose subsequently the organisation of the mission u23 including the mobilisation of the vessel s if required take place once the crew accesses the subsystem that failed the repair is carried out u24 it is assumed that one work shift lasts for up to 12 h which includes the total repair time transitioning from harbour to the site and vice versa as well as a mid shift break in case that more than one shifts are required the crew returns to harbour and the mission restarts 12 h later u25 when the damage is restored the wind turbine starts producing power again and the mttf of the subsystem is reset to its original value finally the transit back to the harbour and the demobilisation time need to be accounted to estimate the end of the mission when the vessel and crew becomes available for the next mission which will affect activities described in u14 17 at that point the absolute time of each wind turbine is revised by adding the durations of all previous unplanned maintenance activities namely the waiting time for vessel crew spares availability the lack of weather window the organisation time of the mission and the crew rest navigation and repair activities as shown in fig 2 u26 above process is repeated for all wind turbines u10 once the absolute total time set of each turbine equals the predetermined service life of the wind farm u11 the simulation stops and o m related key performance indicators such as total uptime downtime availability and o m cost per mwh generated can be derived u27 28 planned maintenance else calendar based maintenance operations are carried out periodically and deal not only with one subsystem of the wind turbine but with groups of or all subsystems of each wind turbine during each charter planned maintenance can be scheduled ahead of time during periods of favourable weather conditions when delays to missions due to exceedance of vessels safety limits weather window downtime are not likely to occur so that the availability of the wind turbine and amount of generated electricity is affected the least possible the same applies for vessels crew and spare parts unavailability downtimes in this analysis calendar based maintenance is assumed to take place every one year t p l m a i n t with a deviation of 1 month to simulate the real life operations downtime due to planned maintenance is assumed to originate exclusively from the navigation and repair time together with the potential downtime due to crew rest as shown in fig 3 an iteration process takes place until all wind turbines t r have been maintained p5 and reached the end of their service life by monitoring the absolute time set of each turbine which considers the mttf and the downtime due to planned and unplanned maintenance in this analysis it is assumed that planned maintenance can only restore minor repairs i e once each mission terminates the mean time to failure of minor repairs is reset it is expected that unplanned maintenance will incur higher downtimes in relation to planned maintenance considering the longer expected downtimes and types of maintenance activities 3 3 weather modelling as described in the previous sections predicting weather conditions for the operational lifetime of an owf is crucial to predict its availability if wave height and wind speed conditions exceed vessels safety thresholds transit from harbour to the wind farm is not possible leading to delays in performing repairs thus increasing downtime and decreasing the wind farm s availability scheu et al 2018 commonly used methods for generating sea state time series comprise gaussian and langanian approaches for short term wave modelling autoregressive moving average arma methods and markov based models in this study the markov chain process was chosen due to the fact that it works well for long term forecasting and can capture persistence of sea state parameters additionally it is a method widely applied in literature anastasiou and tsekos 1996 hofmann and sperstad 2013 scheu et al 2012 and can handle conditional probability distributions overall steps of the discrete time markov chain process used for the weather forecasting method are illustrated in fig 2 with the purple coloured boxes u29 34 to this end historic weather datasets from 1992 to 2017 with a 3 h time step were retrieved from btm argoss database btm argoss 2017 discrete time markov chains method is based on having a finite number of states in a system and estimating the probability p i j of state i to evolve into state j markov probability matrices are generated for each month to account for seasonality as shown below 6 p s e a s t a t e p a r a m e t e r m o n t h p 11 p 12 p 1 n p 21 p 22 p 2 n p n 1 p n 2 p n n m o n t h where p i j equals the number of transitions of sea state parameter i to j divided by the total number of times state i appears as such initially the weather data is discretised with a specified resolution fig 2 u30 a time step of 3 h is considered for the forecast during which wind speed and wave height are assumed to remain constant based on the probabilities of each transition matrix the wave height for the starting month is randomly selected and successively all sea state conditions are predicted as a function of the previous state and the transition probability 3 4 cost modelling the cost modelling module gathers the data recorded during each iteration which are required to estimate the o m cost for unplanned maintenance of wind turbines the time that a failure occurs is registered with reference starting point the beginning of operation of the wind farm further the subsystem that failed and the type of failure will define the required main and support vessels to match the correct day rates and the number of crew members required for the repair downtimes of crew unavailability spare parts unavailability weather window navigation time and demobilisation time are taken into account and assigned to the respective day rates of vessels crew cost of materials mobilisation and demobilisation costs to estimate the total o m cost 4 results and discussion 4 1 baseline wind farm 4 1 1 characteristics of wind farm the baseline case is a representative wind farm located in european waters and its characteristics are summarised in table 1 the integrated o m cost estimation framework was applied to the baseline wind farm and across a number of different locations in a region by the south east coast of the uk weather data were obtained from the btm argos database for a set of 204 different locations with latitude and longitude coordinates ranging between 0 000 2 667 and 50 000 53 667 respectively covering the south east coast of the uk as illustrated in fig 4 this region was selected due to its high concentration of currently operating and under construction round 1 2 and 3 wind farms the crown estate 2017 existing ports near the afore mentioned set of 204 different locations of the focus region were identified from 4c offshore 4c offshore 2018 and their coordinates are summarised in table 2 it was assumed that these ports provide their adjacent wind farms with maintenance support services to this end the distances of all ports from all potential owf locations were calculated and the port having the shortest distance from a particular owf location was assumed to be the base port of this location serving its maintenance operations 4 1 2 assumptions on the operating cost components cost components taken into consideration in the present study comprise the cost of main and support vessels crew and materials herein material is anything that is used or replaced in the turbine from consumable materials to whole replacement parts such as full generators the required cost parameters of the maintenance vessels are summarised in table 3 the material costs are adopted from carroll et al s publication carroll et al 2016b while the vessel and crew day rates as well as the cost of materials used in the present study were adopted from a recent publication of the authors ioannou et al 2018 all costs were assumed to be fixed throughout the 25 service life of the asset so as to reduce the complexity of the model to estimate the revenue loss due to the downtime of the wind farm a fixed price of 100 mwh was assumed throughout the 25 year service life of the wind farm asset 4 2 risk based revenue loss modelling 4 2 1 operation and maintenance results for a specific location the model was initially applied for the prediction of the operational kpis of the baseline wind farm installed in a single location with coordinates 0 000 50 334 for the modelling of the future weather conditions on location 0 000 50 334 weather data obtained from btm argoss were discretised with a resolution of 0 2 m for wave height and 1 m s for wind speed data resulting in a finite number of possible values namely 33 ranging from 0 to 6 4 m and 25 values ranging from 0 to 24 m s respectively the mean wave height of the dataset was calculated 1 08 m and mean wind speed 10 m above sea level 6 83 m s the power output for the 25 years of operation of each of the 140 turbines as well as the breakdown of downtimes are illustrated in fig 5 and fig 6 respectively total power produced was calculated 38872 gwh and the total downtime 2 7887 106 h with a power based availability of 90 1 and a time based availability of 88 9 the downtime due to weather unsuitability had the highest share of the total downtime 25 1 followed by the repair time 22 2 and the spare availability downtime 16 8 the temporal o m costs throughout the service life of the wind farm are shown in fig 7 for unplanned maintenance of both wind turbines and the bop as well as for planned maintenance total wind farm o m cost during the entire service life was estimated at 686 5 million due to the difficulty in obtaining long term data from operational wind farms as a result of the newly developed industry and the motivation of turbine manufacturers and operators to keep their competitive advantage by not distributing information related to reliability and cost validation of o m models is a difficult task furthermore available benchmarking studies such as the one made in dinwoodie et al 2015 highlight significant differences in the calculated o m kpis across four o m tools compared in their study however an attempt was made by the authors to compare results of the developed model with results derived as part of the recent work of martin et al s martin et al 2016 which also studied the operational availability of wind farms located in the south east cost of the uk and performed simulations for three owf case studies mean annual wave height 1 02 m and wind speed 10 m above sea level 7 15 m s were also relatively close to the reference case study of the present work the range of availability was estimated between 84 and 92 with an average of 89 results have shown acceptable agreement as both studies have shown relatively lower values of availability compared to generic values reported in literature which is due to the overall weather potential of the region it also has to be noted that deviations between the two models can be justified due to the more up to date failure rate databases used in the present study 4 2 2 parametric estimation of operational kpis subsequently the model was applied for 204 locations in the south east coast of the uk illustrated in fig 4 using the respective historic weather data for each set of coordinates retrieved from the btm argoss database a convergence study was conducted to determine the size of the monte carlo sample for the calculation of mttf of each turbine and the model iterations to ensure the robustness and efficiency of the model the averaging of the outputs derived from 1000 monte carlo simulations and 5 iterations of the code were determined to allow for the generation of robust results accordingly a number of location specific colour coded plots illustrating resulting operational kpis across the whole region were generated the production based wind farm availability results are plotted in fig 8 a for each of the 204 sets of coordinates under investigation higher availability levels can be observed in areas closer to the coast of the specified region noting that half a degree is equivalent to a distance of approximately 56 km this can be attributed to the smaller distances between the port and the wind farm site as well as the lower magnitudes of significant wave height and wind speed limits improving the accessibility of the maintenance vessels for the performance of unplanned maintenance hence reducing the total downtime of the asset results demonstrate a smooth transition from high availability values in locations closer to the coast to gradually decreasing farther from shore nevertheless a number of outliers can be observed for example in the location point 2 000 53 334 where an availability peak is noted this can be explained as the result of measurement uncertainty of the historic met ocean data fig 8 b illustrates the breakdown of downtimes for the location with the lowest and highest availability weather downtime appears to have the greatest contribution to the total downtime for the lowest availability location while repair time is the main contributor for the highest availability location fig 9 illustrates the total undiscounted o m cost per produced mwh revealing a more uniform distribution of unit cost in relation to the availability values across the different locations this is due to a trade off of higher power generation due to better wind speed profiles and higher o m costs due to decreasing accessibility of vessels for maintenance operations for example a hypothetical wind farm installed at point 1 000 51 500 appears to reach an availability level of 92 6 fig 8 a in return of high unit costs amounting to 24 5 mwh fig 9 as a result of the poor wind speed profile resulting in low power production nevertheless exceptions of this observation can be found for example in the areas positioned in the southern part of the specified region where high availability together with relatively low unit costs can be observed this observation can potentially lead to the conclusion that these regions can offer a good balance of availability versus costs however it has to be noted that other factors such as geotechnical conditions environmental impact assessment studies and other parameters need to be taken into account before determining the suitability of a location for the installation of a wind farm mytilinou et al 2018 mytilinou and kolios 2019 finally the expected total power production loss due to the wind farm downtime is plotted in fig 9 production loss reflects the total revenue loss due to downtime as it is calculated by subtracting the power produced during uptime from the potential power produced both during uptime and downtime wind speed profile of the location is also taken into consideration it is therefore a parameter with a great impact on the financial performance of the investment the revenue loss plot was found to follow a similar to the availability plot pattern with locations closer to shore indicating lower revenue potential losses due to the reduced downtime of the wind farm 4 2 3 weather related risk control policy options traditional insurance products available for renewable energy projects typically protect against natural disasters such as storms earthquakes and hurricanes grossi et al 2005 as well as physical losses and damages to the plant asset during the construction and operating phases unep 2004 furthermore academic literature on the effects of weather related risks on ow energy projects also focuses on analysing the effect of extreme weather events barabadi et al 2016 becerra et al 2018 lamraoui et al 2014 however risk management against the effect of seasonal fluctuations in climatic conditions such as variation in wind speeds temperature and wave height is becoming more relevant as investors are inclined to reduce their risk exposure weather related risk hedging products are usually financial contracts which can be executed in the form of insurance or weather derivatives structured as swaps futures and options that are based on a weather related index li 2018 in the case of ow significant wave height and wind speed could be relevant weather related indices the seller of the weather derivative bears the risk of potential financial losses as a result of the weather conditions in exchange of an upfront premium if the pre determined limit of the index is surpassed over a specified period the project owner is compensated the downtime financial losses the index based policy structure has the advantage of simplicity although there may exist some ambiguity in terms of the actual financial impact caused by the exceedance of the specified threshold in the case of ow for example exceedance of the threshold of the significant wave height limit over a specified period of time may not necessarily lead to financial losses on the contrary power production loss due to downtime could be a risk index easier to translate into resulting revenue losses over a period of time while relevant data can be retrieved by the supervisory control and data acquisition scada systems installed in the wind farm fig 11 illustrates the cumulative power production losses summed on a monthly period over the service life of the baseline wind farm installed in the location 0 000 50 334 a threshold of 45000 mwh power production loss over the period of a month was assumed above which the buyer of the risk transfer product is compensated for the revenue loss corresponding to this threshold the estimation of the premium should be based on the probability of exceedance of the specific limit with a 5 6 monthly probability of exceedance the risk of the investor is estimated in terms of production losses 45000 5 6 2520 mwh assuming a fixed price of 100 mwh the maximum premium that the buyer would be willing to pay is therefore 252000 per month the exceedance probability ep curve is used by insurers to estimate the probable maximum loss pml for a portfolio of investments in a given period of time the pml is a bespoke risk metric and is associated with a probability of exceedance reflecting the insurer s acceptable level of risk as such the insurer can use the ep curve to determine the magnitude of loss at the desired probability of exceedance level in fig 12 the monthly ep curve of the reference wind farm is demonstrated the ep curve can also assist the distribution of losses between stakeholders as such the project owner would retain the first part of the loss i e the deductibles for example losses up to 45000 mwh while the insurer covers monthly production losses occurring in excess of this amount setting the above threshold of monthly power production losses i e 45000 mwh across all sets of coordinates of the designated region the distribution of the exceedance probabilities is illustrated in fig 13 for areas closer to the coast the probability of exceedance does not surpass the level of 6 while in areas farther from shore probability reaches 18 comparing the scatter plot of probability of the production loss exceedance threshold with the production losses one in fig 10 it becomes evident that the amount of power production losses throughout the service life of the asset is not necessarily proportional to the entailed risk of surpassing a threshold set on a monthly or even annual basis this map can provide a basis for screening which locations are likely to incur higher insurance premiums for weather related parametric risk control products insurance policies are typically valid for a specified period of time defined in the insurance policy contract varying from a few weeks to a number of years it can thus be deduced that the magnitude of risk transferred to a third party greatly depends on the coverage period set by the contract specifically for ow energy assets the persistence of the weather conditions can be detrimental on the resulting financial losses and by extension on the compensation required by the risk control policy above application assumed that the risk control policy will be activated once the cumulative energy production losses within a reference period of one month surpass a specified threshold 45000 mwh through the ep curve appropriate production loss thresholds can be identified by insurers so as not to surpass a maximum risk level over the reference period of the risk control policy adjusting their exposure to risk up to a desired level 5 conclusions there is a number of industries whose operations can be impacted by the varying weather conditions and the ow industry is certainly one of them although the traditional weather related risk transfer products available are mainly employed to protect against catastrophic events there is currently an increasing interest in hedging against seasonal weather fluctuation risks in order to minimise their impact on the financial performance of the investment protection against weather risk was originally included as a clause embedded in contracts for unforeseen weather conditions but is now becoming a bespoke financial instrument to hedge the risk of the resulting financial losses currently offered by insurance companies and brokers willis towers watson 2018 in this paper uncertainties present in the operational stage of ow investments are investigated systematically with a view to inform risk control policies for hedging of the incurring losses for the estimation of operational kpis the latest databases of location specific environmental conditions failure rates and required repair resources are integrated together with discrete time markov chains for forecasting future sea states the model is firstly applied to a reference wind farm installed in a specific location to test the applicability of the model and verify its results then the model is applied to a set of locations in the south east coast of the uk to derive scatter plots of aforementioned kpis such as cost per mwh and power production losses indicating the effect of weather and maintenance downtime throughout the o m phase of the asset s lifecycle further to the calculation of power production losses the probability of exceedance of a specified power production loss threshold was estimated across all locations of the south east coast deriving insights regarding the distribution of the risk level of financial losses due to weather and maintenance downtime across the designated region it was observed that there is a trend for higher production based availability levels in areas closer to the coast of the specified region furthermore the scatter plot of o m cost per mwh generated demonstrated a more uniform pattern across the different locations indicating that there is a trade off of higher power generation in locations farther from shore due to better wind speed profiles and higher o m costs as a result of the decreasing accessibility of vessels for performing maintenance operations production losses distribution was found to follow a pattern similar to the availability one with locations closer to shore displaying lower potential production losses due to the reduced downtime of the wind farm production losses can reflect the total revenue loss due to downtime to this end it was chosen as the most relevant parameter to demonstrate the financial risk induced by weather and maintenance downtime it was highlighted that the amount of power production losses throughout the service life of the asset is not necessarily proportional to the entailed risk of surpassing a set threshold in order for the developed model to be versatile allowing for iterative simulations a number of assumptions were considered which are acceptable for the comparative nature of the present study these assumptions could be further considered in future studies which could focus on absolute calculation of kpis for example the weather limits considered for each vessel can be modelled in greater detail distinguishing the limits for the vessel transit and the repair of the failure furthermore from the repair identification until the asset becomes unfunctional i e stops working some residual capacity still exists future work could focus on modelling this concept considering pf intervals finally the proposed methodology can be used by insurers and relevant stakeholders to produce the ep curve of the production losses of an owf indicating appropriate thresholds to be considered for a specific reference period e g cumulative monthly weekly or yearly production losses so as not to exceed a maximum level of risk in this way risk control policies can be better informed allowing the insurers to adjust their exposure to risk up to a desired level acknowledgment this work was supported by grant ep l016303 1 for cranfield university the university of strathclyde and the university of oxford centre for doctoral training in renewable energy marine structures rems http www rems cdt ac uk from the uk engineering and physical sciences research council epsrc this work has also received funding from supergen wind hub grant number ep l014106 1 appendix nomenclature indices i j different sea states k repair class minor repairs major repairs and major replacements n number of sea states considered s subsystem of turbine t r turbine variables a p r o d u c t i o n time based availability a t i m e production based availability m t t f s mttf of subsystem s h m t t f t r mttf of turbine t r h p o f t r probability of failure of turbine t r p i j probability state i evolves into state j t a b s t r absolute time set of the simulation h t c r e w downtime due to unavailability of crew h t d e m demobilisation and transit back to the harbour time h t o r g downtime due to mission organisation h t r e p a i r downtime for crew rest travel and repair time h t s p a r e s downtime due to unavailability of spares h t v e s downtime due to unavailability of main and support vessel h t w e a t h e r downtime due to unavailability of weather window h λ k failure rate of repair class k failures turbine year λ s failure rate of subsystem s failures turbine year λ t r failure rate of turbine t r failures turbine year abbreviations alop advanced loss of profit bi business interruption bop balance of plant dsu delay in start up ep exceedance probability kpis key performance indicators lcoe levelised cost of electricity lds liquidated damages owf offshore wind farm pml probable maximum loss wacc weighted average cost of capital 
22922,the power capture performance of an interconnected two raft wave energy converter wec is investigated in this paper the equations of motion for the hinged wec are established using a discrete module beam bending based hydroelasticity method a mathematical model is then derived for the optimization of power take off systems which is capable of taking into account both different raft length ratios and structural flexibility levels based on this mathematical model the combined effects of raft length ratios and structural flexibility on the power absorption of the hinged two raft wec are explored in detail a small fore aft raft length ratio is beneficial to power capture in relatively short waves and the performance is further enhanced by the increase of structural flexibility for relatively long waves two rafts of equal length may be the optimal condition while the energy absorption is weakened by the structural flexibility the critical wave number normalized by the length scale of the rafts categorizes the effect of structural flexibility on power capture into constructive larger wave number than the critical value and destructive smaller wave number regions and it is not very sensitive to geometric features of the wec such as the width of two rafts and the gap between them keywords wave energy attenuator structural flexibility raft length power take off optimization power capture performance 1 introduction due to the considerable level of available energy and high power density of water waves interest in ocean wave energy utilization is continuously growing it is estimated that ocean waves can carry few terra watt of power which is the order of primary energy demand consumption in the world falnes 2007 wave energy has a remarkably higher power density than solar and wind energy but its development is much less mature than the latter two types of energy until now various types of wave energy converter wec concepts have been proposed to capture energy from ocean waves such as point absorber zhang et al 2015 2016 2018 oscillating water column falcao and henriques 2016 overtopping device kofoed et al 2006 and interconnected raft type wec zheng et al 2015 etc among these types of devices the interconnected raft wec which is an attenuator type wec and usually deployed in ocean regions of high power density lies parallel to the dominant wave direction and uses the relative rotation between adjacent interconnected floats to drive the power take off pto system to convert wave energy into electricity the early notable research on the interconnected raft type wec was carried out by haren 1979 and haren and mei 1981 1982 in which a comprehensive theoretical study was performed on the power capture performance of wave contouring rafts i e cockerell raft by using a two dimensional linear potential flow model and simplifying the hydraulic pto as a linear pto unit they analysed a single raft hinged at a wall in long waves multiple rafts of varying lengths in shallow water and three raft system in both shallow and deep water waves in the following years another type of hinged raft wec which is known as mccabe wave pump was developed by kraemer 2001 who maximized the relative pitch motion by adjusting the ratio of raft length to wave length pelamis wec is another successful application of the interconnected raft type wec in offshore regions yemm and henderson 2012 it is a slender semi submerged articulated cylindrical device with a compliant spread mooring system that allows the device to weathervane to the wave direction pelamis wec can capture wave energy by utilizing the relative pitch and yaw motion between adjacent pontoons around the joints retzler 2006 and henderson 2006 investigated the slow drift dynamics and hydraulic pto systems for the pelamis wec respectively by modelling the pelamis like wec as a continuous flexible structure thiam et al 2010 2014 used a generalized euler bernoulli beam theory to derive an approximation for the maximum possible power extraction in addition to the above mentioned three traditional interconnected raft type wecs i e cockerell raft mccabe wave pump and pelamis some other raft type wave energy device concepts have also been proposed and developed in recent years such as dexa zanuttigh et al 2010 m4 wec eatock taylor et al 2016 sun et al 2017b and seapower 2017 these devices have a similar trend that the configuration becomes more and more simple and reliable with only two or equivalently two floats hinged together a simple configuration helps reduce the complexity and thus enhance the structural integrity and survivability of the system in harsh sea conditions the optimization of pto systems for maximizing the power capture is of great significance for the deployment and commercialisation of interconnected raft type wecs theoretical studies on the maximum power absorbed by interconnected floats were conducted by newmann 1979 stansell and pizer 2013 and zheng et al 2016a in which the captured power was calculated as the difference between the excitation power and radiated power no pto is specified however the complexity of the derived pto poses a challenge to put the above mentioned theoretical optimizations into reality more recently by simplifying the pto as a linear damper zheng et al 2016b derived a theoretical model for evaluating the maximum wave energy extraction by two hinged floats of the same length using the linear three dimensional wave diffraction radiation theory this mathematical model was further extended by zheng and zhang 2017 for wave power capture capacity of two floats of arbitrary length which often exists widely in wave energy development in the above mentioned analysis each float is taken as a rigid body when considering its hydrodynamic interaction with waves this assumption may be reasonable for some types of wec such as point absorbers for which the structural flexibility may be ignored however for hinged raft wec its dimension in the longitudinal direction which is parallel to the incident wave direction may be comparable to wave length and much larger than those in other directions as a result the structure may be regarded as a beam whose structural flexibility or deformation may be important when the structural flexibility of a floating system in waves is considered the traditional hydrodynamics theory based on the rigid body assumption is no longer valid the hydroelasticity theory in which the coupling between fluid motion and structural deformation is taken into account is used to calculate the dynamic response of a flexible structure in waves traditional mode superposition based hydroelasticity method calculates the response of a floating system in waves by superposing the hydrodynamic coefficients for both rigid and flexible oscillation modes of the flexible body wu 1984 unlike the mode superposition approach lu et al 2016 proposed a discrete module beam bending based method for hydroelastic analysis in this method a continuous flexible structure is divided into several rigid submodules which are connected by beam elements to account for structural deformation the approach proposed by lu et al 2016 was extended by sun et al 2017a for a hinged flexible structure and by zhang and lu 2018 for a flexible structure of complicated geometric features zhang et al 2018a developed a time domain discrete module beam bending hydroelasticity method for dealing with the dynamic response of a very large floating structure vlfs which is subjected to both waves and unsteady external loads zhang et al 2018b investigated effects of structural flexibility on the maximum wave energy conversion by two interconnected floats of the same length in regular waves with the aid of the discrete module beam bending hydroelasticity method lu et al 2016 zhang et al 2018b extended the mathematical model for pto optimization derived by zheng et al 2016b to be capable of taking structural flexibility into account in that work both the length and the structural flexibility of two floats are set to be identical which indicates that the proposed model is unable to solve the pto optimization problem of two floats with more complex combinations of geometrical and physical parameters for example two floats of different structural flexibility levels and raft length ratios in this paper we aim to investigate the power capture performance of a hinged two raft wec with different raft length ratios and structural flexibility levels first we develop a numerical framework for modelling a hinged flexible wec based on a discrete module beam bending hydroelasticity method then a theoretical model of pto optimization for the maximum power capture has been derived to account for both raft length ratios and structural flexibility levels finally within the established numerical framework together with the optimized pto a thorough and detailed investigation is conducted on the combined effects of raft length ratios and structural flexibility on the power absorption of the wec 2 description of the interconnected two raft wec the interconnected two raft wec adopted in the present study is similar to that in zheng et al 2016b and zhang et al 2018a and it is briefly described here fig 1 gives a schematic of the two raft wec it consists of two elliptical cylinders which are horizontally placed on the water surface and hinged together by a joint the lengths of the fore and aft rafts which are in the upstream and downstream of incident waves respectively are denoted as l 1 and l 2 respectively the cross sections are the same for two rafts with a major axis a and a minor axis b the gap between two floats is l s c pto i pto and k pto are the pto damping coefficient inertia and stiffness respectively in our analysis the inertia and stiffness of the pto are ignored and only the damping is considered the water density and depth are denoted as ρ and d respectively a global cartesian coordinate system is defined with x o y plane located at the still water surface and z axis being positive upwards the origin o of the global coordinate system is set at the geometric centre of the fore raft the angle between the incident wave direction and the longitudinal axis x axis is denoted as β each float has six degrees of freedom i e three translational displacements including surge sway and heave and three angular displacements including roll pitch and yaw for convenience the authors would like to concentrate on wave conditions with incident wave angle β 0 due to the symmetry of the floats only three modes of oscillation i e surge heave and pitch are considered the radiuses of gyration corresponding to the pitch motion of the fore and aft rafts are denoted as r 1 and r 2 respectively each raft of the wec is a flexible body for a beam like flexible structure the bending stiffness is e i a where e is the elastic modulus and i a is the cross section area moment of inertia of the beam in the present study the cross section of each raft is an ellipse with i a 1 64 π a b 3 with respect to y axis we vary the bending stiffness e i a of a flexible structure by changing the value of the elastic modulus e it should be noted that in practical condition the bending stiffness can also be changed by choosing different values of the cross section area moment of inertia of the structure the elastic moduli for the fore and aft rafts of the wec are denoted as e 1 and e 2 respectively 3 derivation of the mathematical model for pto optimization in this section we use the discrete module beam bending based hydroelasticity method proposed by lu et al 2016 to derive the theoretical model for pto optimization of a hinged two raft wec with structural flexibility considered see fig 1 this derivation will extend the mathematical model in zhang et al 2018b to be applicable for interconnected two floats of different structural flexibility levels and length ratios 3 1 the equations of motion for the hinged two raft wec following lu s approach each raft of the wec is first discretised into several rigid submodules for example the numbers of submodules for the fore and aft rafts are n 1 and n 2 n 1 n 2 n respectively see fig 2 the total external force exerted on the centre of gravity for each submodule is thus expressed as 1 f t f e f a f rd f hs f in f pto f sj by assuming that all submodules are freely floating multi rigid body hydrodynamics is used to obtain wave excitation force f e added mass force f a ω 2 a ω x where ω is wave frequency a ω the added mass and x the displacement vector for all submodules and radiation damping force f rd i ω b ω x where i is the imaginary unit that satisfies i 2 1 and b ω the radiation damping the hydrostatic restoring force f hs c x c is a coefficient matrix is obtained based on hydrostatics the inertia force is expressed as f in ω 2 m x where m is the mass matrix the force caused by the pto damping is denoted as f pto i ω b pto x with b pto being the pto damping matrix the pto damping force is only exerted on the n 1 th and n 1 1 th submodules which are adjacent to the joint a displacement constraint condition has been introduced by the joint for the n 1 th and n 1 1 th submodules following zhang et al 2018b this displacement continuity condition is expressed as a j x 0 where a j is the interconnection matrix of displacement continuity at the joint the force on the centres of the n 1 th and n 1 1 th submodules caused by the joint is calculated as f sj a j t f j where f j is the force of the joint and t represents the transpose of a matrix subsequently each submodule is simplified as a generalized lumped mass at its centre of gravity by doing so we assume that all forces and physical properties such as mass and moment of inertia are concentrated on and represented by the lumped masses the adjacent lumped masses are connected by a beam element to account for the structural deformation the physical properties of which are derived from the flexible structure the forces on the lumped masses caused by structural deformation are expressed as f st k st x where k st is the stiffness matrix of the entire structure and is given by overlaying the beam element stiffness matrix according to the standard process of finite element method the expressions for all above mentioned matrices are given in appendix a finally the equations of motion for a hinged two raft wec in regular waves are established in frequency domain by considering both the equilibrium of forces for each lumped mass and the displacement continuity condition at the joint 2 ω 2 m a ω i ω b ω b pto c k st a j t a j 0 3 n 2 3 n 2 x f j 3 n 2 1 f e 0 3 n 2 1 it should be noted that in eq 2 the drag force which may have some effects on the motion of the float see eatock taylor et al 2016 is neglected following sun et al 2017b the effect of mooring force is also not considered 3 2 the theoretical model for pto optimization of a flexible hinged two raft wec the displacement vector x and the force at the hinge connection f j can be obtained from eq 2 as follows 3 x f j 3 n 2 1 s 1 f e 0 3 n 2 1 where s ω 2 m a ω i ω b ω b pto c k st a j t a j 0 3 n 2 3 n 2 the relative pitch motion between the n 1 th and n 1 1 th submodules is written as 4 δ θ θ n 1 θ n 1 1 h t s 1 f e 0 where θ n 1 and θ n 1 1 are the pitch displacement of centres of gravity of the n 1 th and n 1 1 th submodules respectively h 0 1 3 n 1 1 0 0 1 0 0 1 0 1 3 n 2 1 0 0 t the time averaged power absorbed by the pto system is given as follows 5 p 1 2 ω 2 c pto re δ θ δ θ 1 2 ω 2 c pto δ θ δ θ 1 2 ω 2 c pto s 1 f e 0 h h t s 1 f e 0 where the superscript represents the complex conjugate transpose as indicated by zhang et al 2018b the symmetric real matrix hh t can be transformed to be a diagonal matrix by 6 h h t q λ q where q is a real orthogonal matrix with the column being eigenvectors of hh t and λ is a real diagonal matrix having the eigenvalues of the matrix hh t the expressions for q and λ are given as follows 7 q i 3 n 1 1 3 n 1 1 0 3 n 1 1 3 0 3 n 1 1 3 n 2 1 0 3 n 1 1 1 0 4 3 n 1 1 q 4 3 1 0 4 3 n 2 1 q 4 1 2 0 3 n 2 1 3 n 1 1 0 3 n 2 1 3 i 3 n 2 1 3 n 2 1 0 3 n 2 1 1 3 n 2 3 n 2 8 λ 0 3 n 1 3 n 1 0 3 n 1 1 0 1 3 n 1 2 3 n 2 3 n 2 where i represents an identity matrix and the components q 1 and q 2 of q are given as follows 9 q 4 3 1 0 0 2 0 5 0 1 0 1 0 0 0 0 2 0 5 q 4 1 2 2 0 5 0 0 2 0 5 further the real diagonal matrix λ is re expressed as 10 λ π π where π 0 1 3 n 1 2 by combining eqs 5 10 the time averaged power can be reformulated as 11 p 1 2 ω 2 c pto s 1 f e 0 q π π q s 1 f e 0 1 2 ω 2 c pto π s q 1 f e 0 π s q 1 f e 0 1 2 ω 2 c pto π s q 1 f e 0 2 the matrix sq can be partitioned into four blocks a 0 b c 0 and d 0 whose sizes are 3n 1 3n 1 3n 1 1 1 3n 1 and 1 1 respectively then we have the inverse of sq 12 s q 1 a 0 b c 0 d 0 1 a 0 1 a 0 1 b d 0 c 0 a 0 1 b 1 c 0 a 0 1 a 0 1 b d 0 c 0 a 0 1 b 1 d 0 c 0 a 0 1 b 1 c 0 a 0 1 d 0 c 0 a 0 1 b 1 where 13 a 0 i 0 3 n 1 3 n 2 s 0 q i 0 3 n 2 3 n 1 b b 0 2 i ω c pto 0 1 3 n 1 1 1 0 0 1 0 1 3 n 2 2 t b 0 i 0 3 n 1 3 n 2 s 0 q 0 1 3 n 2 1 c 0 0 1 1 3 n 2 s 0 q i 0 3 n 2 3 n 1 d 0 l 1 n 1 l 2 n 2 2 2 s 0 s c pto 0 here the subscript 0 means that the matrix is independent of c pto eq 11 indicates that the solution of the last row of the matrix sq 1 is much concerned as π is a row vector with a non zero element in the last column the results are expressed as 14 d 0 c 0 a 0 1 b 1 c 0 a 0 1 d 0 c 0 a 0 1 b 1 c 0 a 0 1 b d 0 1 c 0 a 0 1 1 with 15 c 0 a 0 1 b d 0 c 0 a 0 1 b 0 2 i ω c pto 0 1 3 n 1 1 1 0 0 1 0 1 3 n 2 2 t d 0 a 0 i ω c pto b 0 where a 0 and b 0 are two complex parameters which are independent of c pto and are given as follows 16 a 0 2 c 0 a 0 1 0 1 3 n 1 1 1 0 0 1 0 1 3 n 2 2 t b 0 c 0 a 0 1 b 0 d 0 the time averaged power absorbed by the wec indicated by eq 11 can be re expressed using eqs 12 16 17 p c 0 a 0 1 f e 0 2 ω 2 c pto a 0 i ω c pto b 0 2 there is a maximum value when p c pto 0 which occurs if the following condition is satisfied 18 c pto b 0 a 0 ω c opt with this optimized pto damping the power absorbed by the wec is expressed as 19 p opt 1 2 c 0 a 0 1 f e 0 2 ω a 0 b 0 im a 0 b 0 the corresponding relative pitch displacement amplitude for this optimization is thus obtained by substituting eq 18 into eq 4 20 δ θ opt 2 c 0 a 0 1 f e 0 b 0 i a 0 a 0 b 0 note that the results above are obtained without any consideration of displacement limitations in practice the relative motion of two floats should be restricted to avoid impacting each other here we consider the constraints of the relative pitch motion at the hinge connection 21 δ θ 2 δ θ δ θ δ 2 where δ is the upper limit of the relative pitch displacement at the hinge connection we denote the optimal power absorbed by the wec under motion constraint as p opt c for δ θ δ θ δ 2 we have the optimal power p opt c p opt see eq 19 with δ θ δ θ opt see eq 20 if δ θ δ θ δ 2 the optimized power should be obtained subject to the constraint condition δ θ δ θ δ 2 this optimal power can be calculated by formulating a new function q with the introduction of a lagrange multiplier μ 22 q p 1 2 μ δ θ δ θ δ 2 1 2 ω 2 c pto δ θ δ θ 1 2 μ δ θ δ θ δ 2 c 0 a 0 1 f e 0 2 ω 2 c pto μ a 0 i ω c pto b 0 2 1 2 μ δ 2 then the optimal power with optimal pto damping subject to the constraint condition δ θ δ θ δ 2 can be calculated by 23 q c pto 0 q μ 0 from which we have 24 c pto 1 a 0 2 ω 2 c 0 a 0 1 f e 0 2 a 0 2 δ 2 re a 0 b 0 2 im a 0 b 0 c opt c the optimal power absorbed by the wec with optimized pto damping coefficient under the constraint is given as follows 25 p opt c 1 2 ω 2 c opt c δ θ 2 1 2 δ 2 ω a 0 2 2 c 0 a 0 1 f e 0 2 a 0 2 δ 2 re a 0 b 0 2 im a 0 b 0 4 validation of the theoretical model the physical and geometric properties for the two raft wec following zheng and zhang 2017 are listed as follows the total length of fore and aft rafts is l 1 l 2 2 l 40 m where l is the average length of the fore and aft rafts the major and minor axis of the elliptical cross section are a 5 m and b 2 5 m respectively the spacing between two rafts is l s 1 m the density of each floater is ρ 0 512 5 kg m3 the density of water is ρ 1025 kg m3 the acceleration due to gravity is g 9 81 m s2 the water depth is d 20 m the amplitude and period of incident regular wave are a 1 m and t respectively the wave excitation forces and hydrodynamic coefficients including added mass and radiation damping were calculated using the potential flow code hydrostar veritas 2010 following zhang et al 2018b variables are written in dimensionless form 26 d d l c c pto g d ρ g a l 4 t t g d l r 2 r l δ θ δ θ l a e e ρ g l the averaged power capture width ratio is written as 27 ω p p in a where p in is the input power by incident waves of unit width of wave front the expression of which can be found in falnes 2002 the average power capture width ratio for p opt and p opt c is obtained in a similar way which are notated by ω opt and ω opt c respectively it is noted that wave power capture width ratio ω is a performance indicator for the wave energy conversion efficiency which represents the proportion of incident wave energy that is absorbed by the device for lu s approach a larger number of submodules corresponds to a more accurate modelling of structural deformation this number may be small for large wave length because only low order oscillation modes are excited convergence test should be performed for the number of submodules used for a flexible structure even if the overall longitudinal moment of inertia is kept unchanged different distributions of mass along the float leads to different hydroelastic response and thus different absorbed power see fig 4 in zhang et al 2018b for simplicity the mass of each raft is taken to be uniformly distributed unless otherwise specified following zheng and zhang 2017 a wide range of fore and aft raft length ratio l 1 l 2 is chosen to examine its effect on the power capture performance of the interconnected two raft wec as the mass of each raft is uniformly distributed the mass and rotary inertia of each raft will vary with the length ratio accordingly the validation of the theoretical model is performed in two steps the first step is to do the convergence test of the hydroelastic analysis i e determining the number of submodules for each raft the second step is then to validate the theoretical model for pto optimization derived in section 3 2 zheng and zhang 2017 gave the variation of the optimum power capture width ratio ω opt and optimized pto damping c opt with raft length ratios l 1 l 2 see fig 6 in the reference five different ratios were considered i e l 1 l 2 7 33 10 30 15 25 20 20 and 25 15 by doing convergence test the number of submodules for the hydroelastic analysis is summarized in table 1 if the structural stiffness in the hydroelastic model is set to be a large value each raft can be taken as a rigid structure and the results obtained using the present model should agree with those calculated by zheng and zhang 2017 each raft of the wec can be taken as a rigid body by choosing elastic modulus e 1 1010 pa or e e ρ g l 4 97 10 4 see zhang et al 2018b results of ω opt and c opt are given in fig 3 good agreement is obtained between two models 5 results and discussions 5 1 performance of a hinged two raft wec for an interconnected two raft wec both the length and structural flexibility for fore and aft rafts may be different for a given combination of length ratio and structural flexibility we may have the contour plot of the variation of power capture width ratio with respect to wave length and pto damping which enables us to have a detailed look at how the raft length ratio and structural flexibility affect the power capture performance of the hinged wec as an example fig 4 shows the power capture width ratio ω contours of the hinged wec with l 1 l 2 10 30 and different structural flexibility levels or elastic modulus two different values of elastic modulus are considered i e e 1 1010 pa corresponding to rigid body condition and e 2 107 pa the corresponding non dimensional values are e 4 97 10 4 and e 99 45 these two values of elastic modulus lead to four different combinations of structural flexibility levels for two rafts although the case where two rafts have different structural flexibility levels is not as common as two rigid or two flexible rafts it is still worthwhile and will not take much effort analysing all these possible combinations from the point of view of theoretical study fig 4 a shows the contour of ω for a hinged wec composed of two rigid rafts e 1 e 2 4 97 10 4 this contour plot agrees well with that given by zheng and zhang 2017 see fig 4 a in the reference it can be seen from fig 4 a that for any certain k l or wave length there is an optimized pto damping to maximize the power absorption of interconnected two rigid rafts for very long waves small k l values the power capture width ratio is quite small the maximum power absorption is ω max 1 263 which is obtained with k l 3 5 and c 0 005 using the stiffness approximation method sam proposed by zhang et al 2018b more details can be referred to this reference we can determine whether this optimization occurs at the resonance condition the result is shown in fig 5 a the total number of submodules used for the hydroelastic analysis is 8 and for each submodule three degrees of freedom i e surge heave and pitch are considered which means there are totally 24 natural oscillation modes and frequencies available in fig 5 a we just choose the natural frequencies corresponding to the mode shapes which are responsible for wave energy absorption i e there are relative rotary motion around the hinge connection it can be seen that the curve of incident wave frequency has no intersection with that for natural frequencies which means that no resonance occurs with k l being between 0 5 and 6 5 fig 4 b shows the power capture width ratio ω contour for a hinged wec composed of two flexible rafts the maximum power capture width ratio ω max is around 0 6 which is much smaller than that for a hinged two rigid raft wec fig 5 b indicates that this maximum power capture width ratio also occurs at the off resonance region despite of reduction of the maximum power capture width ratio the introduction of structural flexibility can enhance power capture for relatively small incident wave length k l 5 5 besides the flexible wec is more sensitive to the variation of pto damping than the rigid wec the power capture width ratio contours indicated by fig 4 c and fig 4 d are similar to those represented by fig 4 b and fig 4 a respectively this may be because the length of fore raft is small compared with wave length even the shortest wave length is about twice the fore raft length and thus the rigid modes i e heave and pitch of the fore aft are the principal modes that are excited by incident waves in order to prove this explanation we consider a raft with free free ends the physical and geometrical properties of which are identical to the fore raft of the hinged wec i e 10m in length we consider the shortest wave length 20 m adopted in calculation of the power capture width contour in fig 4 the flexible cylinder is discretised into 4 submodules for the hydroelastic analysis see fig 6 for a flexible cylinder with free free ends there is an analytical solution of mode shapes see appendix b after calculating the hydroelastic response of the flexible cylinder in regular waves using lu s approach the weight for each mode shape can be determined using a least squares minimization routine more details can be found in appendix b the first seven mode shapes and the corresponding weights for a flexible elliptical cylinder 10m in length induced by a regular wave 20m long are shown in fig 7 it can be seen that the dominant modes are rigid motion modes i e heave and pitch while the weights for flexible modes can be neglected variation of the power capture width ratio with raft length ratio l 1 l 2 and pto damping c for the wave condition k l 1 7 is given in fig 8 in which l 1 l 2 is expressed in the logarithmic form the optimal pto damping for each raft length ratio is also shown in fig 8 which is represented by the red dotted line the contour plot for two rigid rafts agrees well with that given by zheng and zhang 2017 see fig 5 a in the reference except that the present plot does not show the contour line of 0 3 the reason may be due to the limited number of the raft length ratios used in the present study the length ratio leading to ω being larger than 0 3 may not be included it can be seen from fig 8 a that both the contour plot of power capture width and the optimized pto damping present symmetry relative to l 1 l 2 1 0 or 10 10 for a long incident wave the two wecs composed of two rigid rafts with inverse raft length ratios can be seen as a given wec under waves propagating in opposite directions a mathematical explanation of this symmetry property can refer to zheng and zhang 2017 if we replace two rigid rafts of the wec by two flexible rafts see fig 8 b the symmetry property is maintained as the structural flexibility levels of two rafts are identical however the power capture width ratio ω for this two flexible rafts wec is much smaller than that for two rigid rafts although the optimized length ratios for these two conditions are both l 1 l 2 1 0 besides the optimal pto damping corresponding to the optimized power capture width ratio ω opt for each raft length ratio is also smaller than that for two rigid rafts wec fig 8 c and d show the power capture width ratio contour for a wec with another two different combinations of structural flexibility levels i e rigid fore raft plus flexible aft raft fig 8 c and flexible fore raft plus rigid aft raft fig 8 d the maximum power capture width ratios for these two conditions are smaller than that for two rigid rafts but significantly larger than that for two flexible rafts as the structural flexibility levels are different both the power capture width ratio and optimized pto damping are asymmetric relative to the length ratio l 1 l 2 1 0 for a one rigid one flexible raft wec the optimization for power capture can be achieved by setting the raft with short length to be flexible and the raft with large length to be rigid 5 2 optimization of a hinged two raft wec with different raft length ratios and structural flexibility levels for two interconnected rafts with any specified fore aft raft length ratio and structural flexibility level there is an optimal pto damping to maximize the power capture the optimized absorbed power together with the corresponding pto damping and the relative pitch motion are given by eqs 18 20 in section 3 2 fig 9 summarizes the variation of the optimized power capture width ratio ω opt and the corresponding optimal pto damping c opt and optimal relative pitch motion amplitude δ θ opt with kl for interconnected two rafts with different raft length ratios l 1 l 2 and structural flexibility levels the structural flexibility levels for two rafts are set to be identical it is noted that the structural flexibility is chosen within a relatively large range i e e from approximately 50000 to 0 25 which may not be normal for most wecs however from the point of view of theoretical study it may be beneficial to explore the effects of structural flexibility in a relatively large range in addition small structural flexibility is still possible to be realized by using other materials than steel structure as shown in fig 9 a with k l increasing from 0 5 to 6 5 all ω opt for the wecs with different raft length ratio and structural flexibility first increase and then decrease after reaching peak values ω max for a wec with a given l 1 l 2 compared with the rigid body condition e 4 97 10 4 the introduction of structural flexibility reduces the power width ratio for relatively long waves but has a positive effect for short waves for long waves for example k l 4 a higher structural flexibility or a smaller structural elasticity e corresponds to a smaller power capture width ratio however an opposite trend is found for relatively short waves k l 5 we denote a critical normalized wave number i e k l c as the value corresponding to the intersection of the power capture width ratio curve for rigid and flexible body condition in terms of the effect of structural flexibility on power absorption k l c separates a constructive region k l k l c from a destructive region k l k l c overall k l c is within 4 6 which corresponds to the ratio of wave length to half of the total length of two rafts being within 1 1 5 the values of k l c decrease with the increase of the fore aft raft length ratio it can be seen that for l 1 l 2 20 20 the critical wave numbers are the same for different structural flexibility levels which indicates that at this point the optimal power capture width ratio is not affected by the structural flexibility see also zhang et al 2018b for other length ratios k l c are different for different structural flexibility levels due to the asymmetry of the fore and aft raft length however for the fore raft length being larger than the aft one i e l 1 l 2 25 15 k l c are also very close for different structural flexibility levels fig 9 b shows the variation of the optimal pto damping with k l for different raft length ratios and structural flexibility levels all c opt decrease with the increase of k l for a given raft length ratio the more flexible the rafts the smaller the optimal pto damping it is noted that for a given structural flexibility level the two c opt k l curves for l 1 l 2 15 25 and l 1 l 2 25 15 overlap relative to each other which coincides well with the symmetry properties as shown in fig 8 a and b the reason for this overlapping phenomenon for two rigid raft wec has been explained mathematically by zheng and zhang 2017 they mentioned that the expression for the optimal pto damping see eq 18 in section 3 2 has no wave excitation force term involved this feature still maintains for a flexible wec with two rafts of identical structural flexibility if the structural flexibility levels are different for two rafts this overlapping feature may not exist see fig 8 c and d the variation of the optimal relative pitch motion amplitude δ θ opt with kl is given in fig 9 c with the increase of kl δ θ opt first increases reaches the maximum value and then decreases the effects of structural flexibility on the optimal relative pitch motion can also be categorized into two different zones by comparing kl with a critical value k l c 1 which is the intersection of δ θ opt k l curves between a rigid wec and a flexible wec when k l k l c 1 the introduction of structural flexibility decreases the optimal relative pitch motion an opposite trend is observed for k l k l c 1 the better power capture performance for a flexible wec in short waves is caused by its larger relative motion amplitude compared with a rigid wec interestingly the critical relative wave number k l c 1 for the optimal relative pitch motion is smaller than the critical value k l c for the optimal power capture width ratio next we will consider the optimized power capture width ratio for interconnected two raft wecs with different combinations of structural flexibility levels for two rafts we consider three different structural flexibility levels i e e 4 97 10 4 rigid body condition 2 49 and 0 25 two different flexible body conditions as shown in fig 10 for l 1 l 2 7 33 and 10 30 the optimized power capture width ratios ωopt are almost identical for the fore raft being rigid or flexible this is consistent with the contour plot for power capture width ratio shown in fig 4 the reason is that the length of the fore raft 7m and 10m is short compared with the incident wave length and rigid motion modes dominate as a result there are only two valid combinations including rigid fore raft plus rigid aft raft and rigid fore raft plus flexible aft raft for e 2 49 flexible aft raft the power capture width ratio is smaller than that for a two rigid raft wec in the whole range of kl when the flexible raft becomes more flexible e 0 25 the kl corresponding to the maximum capture width ratio ωmax is shifted to a higher value making the optimized power capture width ratio for a flexible wec higher than that for a rigid wec for short wavelength for raft length being larger than 15m flexible modes will also be excited and thus there are some differences of the power capture width ratio for rigid and flexible rafts especially for a higher structural flexibility level e 0 25 for example for l 1 l 2 15 25 and e 4 97 10 4 or 0 25 the maximum power capture width ratio ωmax decreases in the following order rigid fore raft plus rigid aft raft flexible fore raft plus rigid aft raft rigid fore raft plus flexible aft raft flexible fore raft plus flexible aft raft for l 1 l 2 25 15 when the fore raft is rigid the structural flexibility for the aft raft has little effect on kl corresponding to the maximum power capture width ratio ωmax this trend is different from that for smaller raft length ratio i e l 1 l 2 7 33 for a given set of structural flexibility levels e 4 97 10 4 and 0 25 variation of the structural flexibility combination from rigid fore raft plus flexible aft raft to flexible fore raft plus rigid aft raft leads to a shift of the kl corresponding to the maximum power capture width ratio ωmax to a larger value the above mentioned results are obtained with no constraint put on the relative motion between two rafts these results may be reasonable for small amplitude of the relative motion however for large relative motion some constraints are needed to put on the relative motion of two rafts in order to protect the rafts from collision or to avoid exceeding the stroke of the hydraulic cylinders fig 11 gives the optimized power capture width ratio ωopt and the corresponding pto damping coefficients of the flexible two raft wec with motion constraint considered it is noted that a non dimensional upper limit of the relative rotation around the hinge δ is defined as δ δ l a by comparing fig 11 with fig 9 it can be concluded that the introduction of constraint will lead to the reduction of the optimized capture width ratio where the corresponding optimized relative motion exceeds the upper limit the constraint will lead to an increase of the optimal pto damping altering the feature of c opt k l curve from being continuously concave to being partly convex for relatively small fore aft raft length ratios for example l 1 l 2 7 33 or 10 30 the constructive effect of structural flexibility on power capture performance at relatively short wave length region where the kl value is relatively large is counteracted by the constraint on the relative motion the reason is that this constructive effect of structural flexibility is mainly due to a larger amplitude of the relative motion see fig 9 which may exceed the given upper limit for relatively large raft length ratios as the amplitude of the relative motion for large kl is within the upper limit the constructive effect of the structural flexibility still exists for a certain range of kl of large value under motion constraint 5 3 discussion on kl c for a wec with two rafts of identical length and structural flexibility in this section we investigate how the critical wave number kl c will be affected by different geometric parameters first we look at the variation of k l c with the gap l s between two rafts see fig 1 we choose a set of different values of l s from 0 5m to 3m and normalize it by half of the total length of two rafts l the other parameters are kept unchanged the results are given in fig 12 the variation of ω opt with k l for a given gap can be seen in fig c1 in appendix c it can be seen from fig 12 that the critical normalized wave number decreases almost linearly with the increase of the gap value with l s l varying from 0 025 to 0 15 the value of k l c decreases from 4 88 to 4 49 or equivalently λ l c varies from 1 29 to 1 40 despite of the decreasing trend with gap the critical normalized wave number is not very sensitive to the gap the total variation of the critical wave number is within 10 when the gap value increases up to 6 times next we choose different values of the major axis a of the elliptical section to investigate its effect on the critical normalized wave number the length of each raft is set as l 20 m the minor axis b 2 5m and the gap l s 1 m the variation of ω opt with k l for a given value of the major axis a can be seen in fig c2 in appendix c as shown in fig 13 the critical normalized wave number decreases with the increase of the width i e the major axis of the elliptical cross section of the float again it can be seen that the critical wave number is not sensitive to the width of the float 5 conclusions this paper investigates the power capture performance of a hinged two raft wave energy converter the discrete module beam bending based hydroelasticity method is used to establish the equations of motion for the hinged wec a mathematical model is then derived for pto optimization which is applicable for a hinged wec with different fore aft raft lengths and structural flexibility levels based on this model the combined effects of raft length ratio and structural flexibility on the power capture performance of an interconnected two raft wave energy converter are explored basically hinged flexible rafts are bad for wave energy absorption more findings are summarized as follows 1 two rafts with identical length may be the optimal condition for power absorption in relatively long waves while the performance is weakened by increasing the structural flexibility of two rafts 2 both the decrease of the fore aft raft length ratio and the increase of structural flexibility lead to increase of power absorption in a shorter wave condition 3 a critical normalized wave number k l c 4 6 k is wave number and l is half of the total raft length categorizes the effects of structural flexibility on power capture performance into constructive k l k l c and destructive k l k l c regions the critical normalized wave number is not sensitive to the geometric parameters of the wec such as the width of two rafts and the gap between them to make these findings more intuitive to readers we consider a hinged wec with the following parameters the total length of two rafts is 2l 40m the gap between them is 1m the major and minor axis of the elliptical cross section of each raft is 5 and 2 5m respectively and the water depth is 20m the critical wave length λ c is around 25m therefore structural flexibility has a constructive effect on power absorption for waves shorter than 25m whereas this effect is negative for waves longer than 25m it should be noted that these findings are achieved within the framework of linear hydroelastic analysis and thus may be inaccurate for a wave energy converter under extreme wave conditions where nonlinearity becomes important and should be considered the drag force is also neglected in the present numerical model which may have some influences on the dynamic response and power absorption of the wec near the resonance region as indicated by eatock taylor et al 2016 acknowledgement the authors are grateful that comments and suggestions provided by the anonymous reviewers helped to improve the quality of the paper the authors would like to acknowledge the support by ministry of industry and information technology of china project no 2016 546 appendix a the expressions for all the matrices in eq 2 are given as follows a1 m m 1 m 2 m n 3 n 3 n where m j j 1 2 n is the mass or moment of inertia matrix for the jth submodule and its dimension is 3 3 a2 c c 1 c 2 c n 3 n 3 n where c j j 1 2 n is the hydrostatic restoring coefficient matrix for the jth submodule the expression of which is given as follows a3 c 0 0 0 0 ρ g a w j ρ g a w j x f j 0 ρ g a w j x f j ρ g v w j g m l j 3 3 here a w j is the waterplane area for the jth submodule v w j is the displaced volume of water x f j is the x coordinate of the centre of flotation g m l j is the longitudinal metacentric height a4 a ω a 1 1 a 1 2 a 1 n a 2 1 a 2 2 a 2 n a n 1 a n 2 a n n 3 n 3 n where a k j k j 1 2 n is the added mass matrix of the kth submodule induced by the motion of the jth submodule and its dimension is 3 3 a5 b ω b 1 1 b 1 2 b 1 n b 2 1 b 2 2 b 2 n b n 1 b n 2 b n n 3 n 3 n where b k j k j 1 2 n is the radiation damping matrix of the kth submodule induced by the motion of the jth submodule and its dimension is 3 3 a6 b pto 0 3 n 1 1 3 n 1 1 0 3 n 1 1 6 0 3 n 1 1 3 n 2 1 0 6 3 n 1 1 b pto 0 6 3 n 2 1 0 3 n 2 1 3 n 1 1 0 3 n 2 1 6 0 3 n 2 1 3 n 2 1 3 n 3 n where b pto is given as follows a7 b pto 0 0 0 0 0 0 0 0 0 0 0 0 0 0 c pto 0 0 c pto 0 0 0 0 0 0 0 0 0 0 0 0 0 0 c pto 0 0 c pto a8 x x 1 t x 2 t x n t t where x j x j z j θ j t j 1 2 n is the displacement vector for the jth submodule a9 f e f e 1 t f e 2 t f e n t t where f e j f e x j f e z j m y j t j 1 2 n is the wave excitation force vector for the jth submodule a10 a j 0 2 3 n 1 3 1 0 0 1 0 0 0 1 l 1 n 1 l s 2 0 1 l 2 n 2 l s 2 0 2 3 n 2 3 2 3 n a11 f j f j x f j z t where f j x and f j z are the forces on the hinge connector in x and z direction respectively a12 k st k 0 1 1 k 1 1 1 k 1 1 2 k 1 2 1 k 1 2 2 k 2 2 2 k n 1 1 n 1 n 1 k n 1 2 n 1 1 n 1 1 k n 1 2 n 1 1 n 1 2 k n 1 2 n 1 2 n 1 1 k n 1 2 n 1 2 n 1 2 k n 1 3 n 1 2 n 1 2 k n n n k n 1 n n 3 n 3 n where k q i j q 0 1 2 n 1 i q o r q 1 j q o r q 1 is the submatrix the size is 3 3 of the stiffness matrix k q whose size is 6 6 for the qth imaginary beam located between the centre of gravity of the qth and q 1 th submodules and k q can be calculated using approach proposed in lu et al 2016 with the aid of the software ansys ansys 2013 k 0 1 1 is the equivalent stiffness submatrix of beam element 0 exerted on the lumped mass 1 and k n 1 n n is the equivalent stiffness submatrix of beam element n 1 exerted on the lumped mass n their expressions are given as follows a13 k 0 1 1 k 0 1 0 k 0 0 0 1 k 0 0 1 k 0 1 1 a14 k n 1 n n k n 1 n 1 n 2 k n 1 n 2 n 2 1 k n 1 n 2 n 1 k n 1 n 1 n 1 appendix b here we will show how to obtain the response amplitude weight of each natural orthonormal mode of vertical vibration for a beam based on the hydroelastic response using the method proposed by lu et al 2016 a freely vibrating beam satisfying the following equations b1 e i 4 w x 4 μ 2 w t 2 where w is the vertical deflection of the beam and μ is the mass per unit length of the beam for a given frequency of vibration ω the vertical deflection w may be expressed as b2 w x t re w ˆ x e i ω t then we can solve an ordinary differential equation b3 e i d 4 w ˆ d x 4 μ ω 2 w ˆ 0 the general solution of the above equation which is also the natural mode of the beam is b4 w ˆ n x a cos α n x b sin α n x c cosh α n x d sinh α n x n 1 2 for a free free beam see fig b1 there is no any support at two ends of the beam then the natural mode of the free free beam is given as follows b5 w ˆ n x cos α n x cosh α n x k n sin α n x sinh α n x where k n cos α n l cosh α n l sin α n l sinh α n l l is the length of the beam and α n l denotes the nth solution of the eigenvalue equation given by b6 1 cosh α n l cos α n l 0 if we consider the rigid motion of the beam i e heave and pitch motion then the natural oscillation mode is given by b7 w ˆ n x 1 n 1 1 2 x l n 2 0 5 cos α n x cosh α n x k n sin α n x sinh α n x n 3 it should be noted that in the expression b7 the mode shapes for all orders have been normalized by their own maximum values along the beam therefore for each mode in expression b7 the maximum absolute value is 1 this manipulation makes it convenient for comparing the weights of each mode i e the contribution of each mode to the total response under waves suppose that the continuous beam is discretised into m submodules for hydroelstic analysis using the method proposed by lu et al 2016 for each submodule s centre the complex amplitudes of the heave vertical displacement and pitch displacement are solved as a j and θ j respectively j 1 2 m then the complex amplitude a j and θ j are projected onto a finite dimensional space spanned by the dominant natural modes of vibration i e b8 a j s 1 n ξ s w s x j for j 1 2 m b9 θ j s 1 n ξ s d d x w s x j for j 1 2 m where x j denote the location of the centre of the jth submodule n is the total number of modes considered generally the total number of modes used for representing the hydroelastic response of the flexible structure calculating using lu s method satisfies the expression n 2 m it should be noted that the number of flexural modes excited depends on the relative properties of the incident wave and the beam higher order oscillation modes are excited as the incident wave length to beam length becomes smaller the weight for each oscillation mode ξ s is determined via a least squares minimization routine we construct a function of the weight ξ s as follows b10 f ξ 1 ξ 2 ξ n j 1 m a j s 1 n ξ s w s x j 2 j 1 m θ j s 1 n ξ s d d x w s x j 2 then we seek the value of ξ s to make the smallest value of the function f ξ 1 ξ 2 ξ n which should satisfies the following expressions b11 ξ k f ξ 1 ξ 2 ξ n 0 k 1 2 n if we denote mat n 2 m as b12 mat n 2 m w 1 x 1 w 1 x m d w 1 x 1 d x d w 1 x m d x w 2 x 1 w 2 x m d w 2 x 1 d x d w 2 x m d x w n x 1 w n x m d w n x 1 d x d w n x m d x eq b11 can be re expressed in the matrix form as follows b13 mat n 2 m mat n 2 m t ξ 1 ξ n mat n 2 m a 1 a m θ 1 θ m where t indicates the transpose of a matrix then the weight for each oscillation mode of the flexible structures is calculated as b14 ξ 1 ξ n mat n 2 m mat n 2 m t 1 mat n 2 m a 1 a m θ 1 θ m fig b1 a free free beam with the length of l fig b1 appendix c fig c1 the variation of the optimized power capture width ratio with kl for a wec l 1 l 2 20 20 and e 1 e 2 e with different values of the gap l s 2 fig c1 fig c2 the variation of the optimized power capture width ratio with kl for a wec l 1 l 2 20 20 and e 1 e 2 e with different values of the major axis a of the elliptical cross section 3 fig c2 
22922,the power capture performance of an interconnected two raft wave energy converter wec is investigated in this paper the equations of motion for the hinged wec are established using a discrete module beam bending based hydroelasticity method a mathematical model is then derived for the optimization of power take off systems which is capable of taking into account both different raft length ratios and structural flexibility levels based on this mathematical model the combined effects of raft length ratios and structural flexibility on the power absorption of the hinged two raft wec are explored in detail a small fore aft raft length ratio is beneficial to power capture in relatively short waves and the performance is further enhanced by the increase of structural flexibility for relatively long waves two rafts of equal length may be the optimal condition while the energy absorption is weakened by the structural flexibility the critical wave number normalized by the length scale of the rafts categorizes the effect of structural flexibility on power capture into constructive larger wave number than the critical value and destructive smaller wave number regions and it is not very sensitive to geometric features of the wec such as the width of two rafts and the gap between them keywords wave energy attenuator structural flexibility raft length power take off optimization power capture performance 1 introduction due to the considerable level of available energy and high power density of water waves interest in ocean wave energy utilization is continuously growing it is estimated that ocean waves can carry few terra watt of power which is the order of primary energy demand consumption in the world falnes 2007 wave energy has a remarkably higher power density than solar and wind energy but its development is much less mature than the latter two types of energy until now various types of wave energy converter wec concepts have been proposed to capture energy from ocean waves such as point absorber zhang et al 2015 2016 2018 oscillating water column falcao and henriques 2016 overtopping device kofoed et al 2006 and interconnected raft type wec zheng et al 2015 etc among these types of devices the interconnected raft wec which is an attenuator type wec and usually deployed in ocean regions of high power density lies parallel to the dominant wave direction and uses the relative rotation between adjacent interconnected floats to drive the power take off pto system to convert wave energy into electricity the early notable research on the interconnected raft type wec was carried out by haren 1979 and haren and mei 1981 1982 in which a comprehensive theoretical study was performed on the power capture performance of wave contouring rafts i e cockerell raft by using a two dimensional linear potential flow model and simplifying the hydraulic pto as a linear pto unit they analysed a single raft hinged at a wall in long waves multiple rafts of varying lengths in shallow water and three raft system in both shallow and deep water waves in the following years another type of hinged raft wec which is known as mccabe wave pump was developed by kraemer 2001 who maximized the relative pitch motion by adjusting the ratio of raft length to wave length pelamis wec is another successful application of the interconnected raft type wec in offshore regions yemm and henderson 2012 it is a slender semi submerged articulated cylindrical device with a compliant spread mooring system that allows the device to weathervane to the wave direction pelamis wec can capture wave energy by utilizing the relative pitch and yaw motion between adjacent pontoons around the joints retzler 2006 and henderson 2006 investigated the slow drift dynamics and hydraulic pto systems for the pelamis wec respectively by modelling the pelamis like wec as a continuous flexible structure thiam et al 2010 2014 used a generalized euler bernoulli beam theory to derive an approximation for the maximum possible power extraction in addition to the above mentioned three traditional interconnected raft type wecs i e cockerell raft mccabe wave pump and pelamis some other raft type wave energy device concepts have also been proposed and developed in recent years such as dexa zanuttigh et al 2010 m4 wec eatock taylor et al 2016 sun et al 2017b and seapower 2017 these devices have a similar trend that the configuration becomes more and more simple and reliable with only two or equivalently two floats hinged together a simple configuration helps reduce the complexity and thus enhance the structural integrity and survivability of the system in harsh sea conditions the optimization of pto systems for maximizing the power capture is of great significance for the deployment and commercialisation of interconnected raft type wecs theoretical studies on the maximum power absorbed by interconnected floats were conducted by newmann 1979 stansell and pizer 2013 and zheng et al 2016a in which the captured power was calculated as the difference between the excitation power and radiated power no pto is specified however the complexity of the derived pto poses a challenge to put the above mentioned theoretical optimizations into reality more recently by simplifying the pto as a linear damper zheng et al 2016b derived a theoretical model for evaluating the maximum wave energy extraction by two hinged floats of the same length using the linear three dimensional wave diffraction radiation theory this mathematical model was further extended by zheng and zhang 2017 for wave power capture capacity of two floats of arbitrary length which often exists widely in wave energy development in the above mentioned analysis each float is taken as a rigid body when considering its hydrodynamic interaction with waves this assumption may be reasonable for some types of wec such as point absorbers for which the structural flexibility may be ignored however for hinged raft wec its dimension in the longitudinal direction which is parallel to the incident wave direction may be comparable to wave length and much larger than those in other directions as a result the structure may be regarded as a beam whose structural flexibility or deformation may be important when the structural flexibility of a floating system in waves is considered the traditional hydrodynamics theory based on the rigid body assumption is no longer valid the hydroelasticity theory in which the coupling between fluid motion and structural deformation is taken into account is used to calculate the dynamic response of a flexible structure in waves traditional mode superposition based hydroelasticity method calculates the response of a floating system in waves by superposing the hydrodynamic coefficients for both rigid and flexible oscillation modes of the flexible body wu 1984 unlike the mode superposition approach lu et al 2016 proposed a discrete module beam bending based method for hydroelastic analysis in this method a continuous flexible structure is divided into several rigid submodules which are connected by beam elements to account for structural deformation the approach proposed by lu et al 2016 was extended by sun et al 2017a for a hinged flexible structure and by zhang and lu 2018 for a flexible structure of complicated geometric features zhang et al 2018a developed a time domain discrete module beam bending hydroelasticity method for dealing with the dynamic response of a very large floating structure vlfs which is subjected to both waves and unsteady external loads zhang et al 2018b investigated effects of structural flexibility on the maximum wave energy conversion by two interconnected floats of the same length in regular waves with the aid of the discrete module beam bending hydroelasticity method lu et al 2016 zhang et al 2018b extended the mathematical model for pto optimization derived by zheng et al 2016b to be capable of taking structural flexibility into account in that work both the length and the structural flexibility of two floats are set to be identical which indicates that the proposed model is unable to solve the pto optimization problem of two floats with more complex combinations of geometrical and physical parameters for example two floats of different structural flexibility levels and raft length ratios in this paper we aim to investigate the power capture performance of a hinged two raft wec with different raft length ratios and structural flexibility levels first we develop a numerical framework for modelling a hinged flexible wec based on a discrete module beam bending hydroelasticity method then a theoretical model of pto optimization for the maximum power capture has been derived to account for both raft length ratios and structural flexibility levels finally within the established numerical framework together with the optimized pto a thorough and detailed investigation is conducted on the combined effects of raft length ratios and structural flexibility on the power absorption of the wec 2 description of the interconnected two raft wec the interconnected two raft wec adopted in the present study is similar to that in zheng et al 2016b and zhang et al 2018a and it is briefly described here fig 1 gives a schematic of the two raft wec it consists of two elliptical cylinders which are horizontally placed on the water surface and hinged together by a joint the lengths of the fore and aft rafts which are in the upstream and downstream of incident waves respectively are denoted as l 1 and l 2 respectively the cross sections are the same for two rafts with a major axis a and a minor axis b the gap between two floats is l s c pto i pto and k pto are the pto damping coefficient inertia and stiffness respectively in our analysis the inertia and stiffness of the pto are ignored and only the damping is considered the water density and depth are denoted as ρ and d respectively a global cartesian coordinate system is defined with x o y plane located at the still water surface and z axis being positive upwards the origin o of the global coordinate system is set at the geometric centre of the fore raft the angle between the incident wave direction and the longitudinal axis x axis is denoted as β each float has six degrees of freedom i e three translational displacements including surge sway and heave and three angular displacements including roll pitch and yaw for convenience the authors would like to concentrate on wave conditions with incident wave angle β 0 due to the symmetry of the floats only three modes of oscillation i e surge heave and pitch are considered the radiuses of gyration corresponding to the pitch motion of the fore and aft rafts are denoted as r 1 and r 2 respectively each raft of the wec is a flexible body for a beam like flexible structure the bending stiffness is e i a where e is the elastic modulus and i a is the cross section area moment of inertia of the beam in the present study the cross section of each raft is an ellipse with i a 1 64 π a b 3 with respect to y axis we vary the bending stiffness e i a of a flexible structure by changing the value of the elastic modulus e it should be noted that in practical condition the bending stiffness can also be changed by choosing different values of the cross section area moment of inertia of the structure the elastic moduli for the fore and aft rafts of the wec are denoted as e 1 and e 2 respectively 3 derivation of the mathematical model for pto optimization in this section we use the discrete module beam bending based hydroelasticity method proposed by lu et al 2016 to derive the theoretical model for pto optimization of a hinged two raft wec with structural flexibility considered see fig 1 this derivation will extend the mathematical model in zhang et al 2018b to be applicable for interconnected two floats of different structural flexibility levels and length ratios 3 1 the equations of motion for the hinged two raft wec following lu s approach each raft of the wec is first discretised into several rigid submodules for example the numbers of submodules for the fore and aft rafts are n 1 and n 2 n 1 n 2 n respectively see fig 2 the total external force exerted on the centre of gravity for each submodule is thus expressed as 1 f t f e f a f rd f hs f in f pto f sj by assuming that all submodules are freely floating multi rigid body hydrodynamics is used to obtain wave excitation force f e added mass force f a ω 2 a ω x where ω is wave frequency a ω the added mass and x the displacement vector for all submodules and radiation damping force f rd i ω b ω x where i is the imaginary unit that satisfies i 2 1 and b ω the radiation damping the hydrostatic restoring force f hs c x c is a coefficient matrix is obtained based on hydrostatics the inertia force is expressed as f in ω 2 m x where m is the mass matrix the force caused by the pto damping is denoted as f pto i ω b pto x with b pto being the pto damping matrix the pto damping force is only exerted on the n 1 th and n 1 1 th submodules which are adjacent to the joint a displacement constraint condition has been introduced by the joint for the n 1 th and n 1 1 th submodules following zhang et al 2018b this displacement continuity condition is expressed as a j x 0 where a j is the interconnection matrix of displacement continuity at the joint the force on the centres of the n 1 th and n 1 1 th submodules caused by the joint is calculated as f sj a j t f j where f j is the force of the joint and t represents the transpose of a matrix subsequently each submodule is simplified as a generalized lumped mass at its centre of gravity by doing so we assume that all forces and physical properties such as mass and moment of inertia are concentrated on and represented by the lumped masses the adjacent lumped masses are connected by a beam element to account for the structural deformation the physical properties of which are derived from the flexible structure the forces on the lumped masses caused by structural deformation are expressed as f st k st x where k st is the stiffness matrix of the entire structure and is given by overlaying the beam element stiffness matrix according to the standard process of finite element method the expressions for all above mentioned matrices are given in appendix a finally the equations of motion for a hinged two raft wec in regular waves are established in frequency domain by considering both the equilibrium of forces for each lumped mass and the displacement continuity condition at the joint 2 ω 2 m a ω i ω b ω b pto c k st a j t a j 0 3 n 2 3 n 2 x f j 3 n 2 1 f e 0 3 n 2 1 it should be noted that in eq 2 the drag force which may have some effects on the motion of the float see eatock taylor et al 2016 is neglected following sun et al 2017b the effect of mooring force is also not considered 3 2 the theoretical model for pto optimization of a flexible hinged two raft wec the displacement vector x and the force at the hinge connection f j can be obtained from eq 2 as follows 3 x f j 3 n 2 1 s 1 f e 0 3 n 2 1 where s ω 2 m a ω i ω b ω b pto c k st a j t a j 0 3 n 2 3 n 2 the relative pitch motion between the n 1 th and n 1 1 th submodules is written as 4 δ θ θ n 1 θ n 1 1 h t s 1 f e 0 where θ n 1 and θ n 1 1 are the pitch displacement of centres of gravity of the n 1 th and n 1 1 th submodules respectively h 0 1 3 n 1 1 0 0 1 0 0 1 0 1 3 n 2 1 0 0 t the time averaged power absorbed by the pto system is given as follows 5 p 1 2 ω 2 c pto re δ θ δ θ 1 2 ω 2 c pto δ θ δ θ 1 2 ω 2 c pto s 1 f e 0 h h t s 1 f e 0 where the superscript represents the complex conjugate transpose as indicated by zhang et al 2018b the symmetric real matrix hh t can be transformed to be a diagonal matrix by 6 h h t q λ q where q is a real orthogonal matrix with the column being eigenvectors of hh t and λ is a real diagonal matrix having the eigenvalues of the matrix hh t the expressions for q and λ are given as follows 7 q i 3 n 1 1 3 n 1 1 0 3 n 1 1 3 0 3 n 1 1 3 n 2 1 0 3 n 1 1 1 0 4 3 n 1 1 q 4 3 1 0 4 3 n 2 1 q 4 1 2 0 3 n 2 1 3 n 1 1 0 3 n 2 1 3 i 3 n 2 1 3 n 2 1 0 3 n 2 1 1 3 n 2 3 n 2 8 λ 0 3 n 1 3 n 1 0 3 n 1 1 0 1 3 n 1 2 3 n 2 3 n 2 where i represents an identity matrix and the components q 1 and q 2 of q are given as follows 9 q 4 3 1 0 0 2 0 5 0 1 0 1 0 0 0 0 2 0 5 q 4 1 2 2 0 5 0 0 2 0 5 further the real diagonal matrix λ is re expressed as 10 λ π π where π 0 1 3 n 1 2 by combining eqs 5 10 the time averaged power can be reformulated as 11 p 1 2 ω 2 c pto s 1 f e 0 q π π q s 1 f e 0 1 2 ω 2 c pto π s q 1 f e 0 π s q 1 f e 0 1 2 ω 2 c pto π s q 1 f e 0 2 the matrix sq can be partitioned into four blocks a 0 b c 0 and d 0 whose sizes are 3n 1 3n 1 3n 1 1 1 3n 1 and 1 1 respectively then we have the inverse of sq 12 s q 1 a 0 b c 0 d 0 1 a 0 1 a 0 1 b d 0 c 0 a 0 1 b 1 c 0 a 0 1 a 0 1 b d 0 c 0 a 0 1 b 1 d 0 c 0 a 0 1 b 1 c 0 a 0 1 d 0 c 0 a 0 1 b 1 where 13 a 0 i 0 3 n 1 3 n 2 s 0 q i 0 3 n 2 3 n 1 b b 0 2 i ω c pto 0 1 3 n 1 1 1 0 0 1 0 1 3 n 2 2 t b 0 i 0 3 n 1 3 n 2 s 0 q 0 1 3 n 2 1 c 0 0 1 1 3 n 2 s 0 q i 0 3 n 2 3 n 1 d 0 l 1 n 1 l 2 n 2 2 2 s 0 s c pto 0 here the subscript 0 means that the matrix is independent of c pto eq 11 indicates that the solution of the last row of the matrix sq 1 is much concerned as π is a row vector with a non zero element in the last column the results are expressed as 14 d 0 c 0 a 0 1 b 1 c 0 a 0 1 d 0 c 0 a 0 1 b 1 c 0 a 0 1 b d 0 1 c 0 a 0 1 1 with 15 c 0 a 0 1 b d 0 c 0 a 0 1 b 0 2 i ω c pto 0 1 3 n 1 1 1 0 0 1 0 1 3 n 2 2 t d 0 a 0 i ω c pto b 0 where a 0 and b 0 are two complex parameters which are independent of c pto and are given as follows 16 a 0 2 c 0 a 0 1 0 1 3 n 1 1 1 0 0 1 0 1 3 n 2 2 t b 0 c 0 a 0 1 b 0 d 0 the time averaged power absorbed by the wec indicated by eq 11 can be re expressed using eqs 12 16 17 p c 0 a 0 1 f e 0 2 ω 2 c pto a 0 i ω c pto b 0 2 there is a maximum value when p c pto 0 which occurs if the following condition is satisfied 18 c pto b 0 a 0 ω c opt with this optimized pto damping the power absorbed by the wec is expressed as 19 p opt 1 2 c 0 a 0 1 f e 0 2 ω a 0 b 0 im a 0 b 0 the corresponding relative pitch displacement amplitude for this optimization is thus obtained by substituting eq 18 into eq 4 20 δ θ opt 2 c 0 a 0 1 f e 0 b 0 i a 0 a 0 b 0 note that the results above are obtained without any consideration of displacement limitations in practice the relative motion of two floats should be restricted to avoid impacting each other here we consider the constraints of the relative pitch motion at the hinge connection 21 δ θ 2 δ θ δ θ δ 2 where δ is the upper limit of the relative pitch displacement at the hinge connection we denote the optimal power absorbed by the wec under motion constraint as p opt c for δ θ δ θ δ 2 we have the optimal power p opt c p opt see eq 19 with δ θ δ θ opt see eq 20 if δ θ δ θ δ 2 the optimized power should be obtained subject to the constraint condition δ θ δ θ δ 2 this optimal power can be calculated by formulating a new function q with the introduction of a lagrange multiplier μ 22 q p 1 2 μ δ θ δ θ δ 2 1 2 ω 2 c pto δ θ δ θ 1 2 μ δ θ δ θ δ 2 c 0 a 0 1 f e 0 2 ω 2 c pto μ a 0 i ω c pto b 0 2 1 2 μ δ 2 then the optimal power with optimal pto damping subject to the constraint condition δ θ δ θ δ 2 can be calculated by 23 q c pto 0 q μ 0 from which we have 24 c pto 1 a 0 2 ω 2 c 0 a 0 1 f e 0 2 a 0 2 δ 2 re a 0 b 0 2 im a 0 b 0 c opt c the optimal power absorbed by the wec with optimized pto damping coefficient under the constraint is given as follows 25 p opt c 1 2 ω 2 c opt c δ θ 2 1 2 δ 2 ω a 0 2 2 c 0 a 0 1 f e 0 2 a 0 2 δ 2 re a 0 b 0 2 im a 0 b 0 4 validation of the theoretical model the physical and geometric properties for the two raft wec following zheng and zhang 2017 are listed as follows the total length of fore and aft rafts is l 1 l 2 2 l 40 m where l is the average length of the fore and aft rafts the major and minor axis of the elliptical cross section are a 5 m and b 2 5 m respectively the spacing between two rafts is l s 1 m the density of each floater is ρ 0 512 5 kg m3 the density of water is ρ 1025 kg m3 the acceleration due to gravity is g 9 81 m s2 the water depth is d 20 m the amplitude and period of incident regular wave are a 1 m and t respectively the wave excitation forces and hydrodynamic coefficients including added mass and radiation damping were calculated using the potential flow code hydrostar veritas 2010 following zhang et al 2018b variables are written in dimensionless form 26 d d l c c pto g d ρ g a l 4 t t g d l r 2 r l δ θ δ θ l a e e ρ g l the averaged power capture width ratio is written as 27 ω p p in a where p in is the input power by incident waves of unit width of wave front the expression of which can be found in falnes 2002 the average power capture width ratio for p opt and p opt c is obtained in a similar way which are notated by ω opt and ω opt c respectively it is noted that wave power capture width ratio ω is a performance indicator for the wave energy conversion efficiency which represents the proportion of incident wave energy that is absorbed by the device for lu s approach a larger number of submodules corresponds to a more accurate modelling of structural deformation this number may be small for large wave length because only low order oscillation modes are excited convergence test should be performed for the number of submodules used for a flexible structure even if the overall longitudinal moment of inertia is kept unchanged different distributions of mass along the float leads to different hydroelastic response and thus different absorbed power see fig 4 in zhang et al 2018b for simplicity the mass of each raft is taken to be uniformly distributed unless otherwise specified following zheng and zhang 2017 a wide range of fore and aft raft length ratio l 1 l 2 is chosen to examine its effect on the power capture performance of the interconnected two raft wec as the mass of each raft is uniformly distributed the mass and rotary inertia of each raft will vary with the length ratio accordingly the validation of the theoretical model is performed in two steps the first step is to do the convergence test of the hydroelastic analysis i e determining the number of submodules for each raft the second step is then to validate the theoretical model for pto optimization derived in section 3 2 zheng and zhang 2017 gave the variation of the optimum power capture width ratio ω opt and optimized pto damping c opt with raft length ratios l 1 l 2 see fig 6 in the reference five different ratios were considered i e l 1 l 2 7 33 10 30 15 25 20 20 and 25 15 by doing convergence test the number of submodules for the hydroelastic analysis is summarized in table 1 if the structural stiffness in the hydroelastic model is set to be a large value each raft can be taken as a rigid structure and the results obtained using the present model should agree with those calculated by zheng and zhang 2017 each raft of the wec can be taken as a rigid body by choosing elastic modulus e 1 1010 pa or e e ρ g l 4 97 10 4 see zhang et al 2018b results of ω opt and c opt are given in fig 3 good agreement is obtained between two models 5 results and discussions 5 1 performance of a hinged two raft wec for an interconnected two raft wec both the length and structural flexibility for fore and aft rafts may be different for a given combination of length ratio and structural flexibility we may have the contour plot of the variation of power capture width ratio with respect to wave length and pto damping which enables us to have a detailed look at how the raft length ratio and structural flexibility affect the power capture performance of the hinged wec as an example fig 4 shows the power capture width ratio ω contours of the hinged wec with l 1 l 2 10 30 and different structural flexibility levels or elastic modulus two different values of elastic modulus are considered i e e 1 1010 pa corresponding to rigid body condition and e 2 107 pa the corresponding non dimensional values are e 4 97 10 4 and e 99 45 these two values of elastic modulus lead to four different combinations of structural flexibility levels for two rafts although the case where two rafts have different structural flexibility levels is not as common as two rigid or two flexible rafts it is still worthwhile and will not take much effort analysing all these possible combinations from the point of view of theoretical study fig 4 a shows the contour of ω for a hinged wec composed of two rigid rafts e 1 e 2 4 97 10 4 this contour plot agrees well with that given by zheng and zhang 2017 see fig 4 a in the reference it can be seen from fig 4 a that for any certain k l or wave length there is an optimized pto damping to maximize the power absorption of interconnected two rigid rafts for very long waves small k l values the power capture width ratio is quite small the maximum power absorption is ω max 1 263 which is obtained with k l 3 5 and c 0 005 using the stiffness approximation method sam proposed by zhang et al 2018b more details can be referred to this reference we can determine whether this optimization occurs at the resonance condition the result is shown in fig 5 a the total number of submodules used for the hydroelastic analysis is 8 and for each submodule three degrees of freedom i e surge heave and pitch are considered which means there are totally 24 natural oscillation modes and frequencies available in fig 5 a we just choose the natural frequencies corresponding to the mode shapes which are responsible for wave energy absorption i e there are relative rotary motion around the hinge connection it can be seen that the curve of incident wave frequency has no intersection with that for natural frequencies which means that no resonance occurs with k l being between 0 5 and 6 5 fig 4 b shows the power capture width ratio ω contour for a hinged wec composed of two flexible rafts the maximum power capture width ratio ω max is around 0 6 which is much smaller than that for a hinged two rigid raft wec fig 5 b indicates that this maximum power capture width ratio also occurs at the off resonance region despite of reduction of the maximum power capture width ratio the introduction of structural flexibility can enhance power capture for relatively small incident wave length k l 5 5 besides the flexible wec is more sensitive to the variation of pto damping than the rigid wec the power capture width ratio contours indicated by fig 4 c and fig 4 d are similar to those represented by fig 4 b and fig 4 a respectively this may be because the length of fore raft is small compared with wave length even the shortest wave length is about twice the fore raft length and thus the rigid modes i e heave and pitch of the fore aft are the principal modes that are excited by incident waves in order to prove this explanation we consider a raft with free free ends the physical and geometrical properties of which are identical to the fore raft of the hinged wec i e 10m in length we consider the shortest wave length 20 m adopted in calculation of the power capture width contour in fig 4 the flexible cylinder is discretised into 4 submodules for the hydroelastic analysis see fig 6 for a flexible cylinder with free free ends there is an analytical solution of mode shapes see appendix b after calculating the hydroelastic response of the flexible cylinder in regular waves using lu s approach the weight for each mode shape can be determined using a least squares minimization routine more details can be found in appendix b the first seven mode shapes and the corresponding weights for a flexible elliptical cylinder 10m in length induced by a regular wave 20m long are shown in fig 7 it can be seen that the dominant modes are rigid motion modes i e heave and pitch while the weights for flexible modes can be neglected variation of the power capture width ratio with raft length ratio l 1 l 2 and pto damping c for the wave condition k l 1 7 is given in fig 8 in which l 1 l 2 is expressed in the logarithmic form the optimal pto damping for each raft length ratio is also shown in fig 8 which is represented by the red dotted line the contour plot for two rigid rafts agrees well with that given by zheng and zhang 2017 see fig 5 a in the reference except that the present plot does not show the contour line of 0 3 the reason may be due to the limited number of the raft length ratios used in the present study the length ratio leading to ω being larger than 0 3 may not be included it can be seen from fig 8 a that both the contour plot of power capture width and the optimized pto damping present symmetry relative to l 1 l 2 1 0 or 10 10 for a long incident wave the two wecs composed of two rigid rafts with inverse raft length ratios can be seen as a given wec under waves propagating in opposite directions a mathematical explanation of this symmetry property can refer to zheng and zhang 2017 if we replace two rigid rafts of the wec by two flexible rafts see fig 8 b the symmetry property is maintained as the structural flexibility levels of two rafts are identical however the power capture width ratio ω for this two flexible rafts wec is much smaller than that for two rigid rafts although the optimized length ratios for these two conditions are both l 1 l 2 1 0 besides the optimal pto damping corresponding to the optimized power capture width ratio ω opt for each raft length ratio is also smaller than that for two rigid rafts wec fig 8 c and d show the power capture width ratio contour for a wec with another two different combinations of structural flexibility levels i e rigid fore raft plus flexible aft raft fig 8 c and flexible fore raft plus rigid aft raft fig 8 d the maximum power capture width ratios for these two conditions are smaller than that for two rigid rafts but significantly larger than that for two flexible rafts as the structural flexibility levels are different both the power capture width ratio and optimized pto damping are asymmetric relative to the length ratio l 1 l 2 1 0 for a one rigid one flexible raft wec the optimization for power capture can be achieved by setting the raft with short length to be flexible and the raft with large length to be rigid 5 2 optimization of a hinged two raft wec with different raft length ratios and structural flexibility levels for two interconnected rafts with any specified fore aft raft length ratio and structural flexibility level there is an optimal pto damping to maximize the power capture the optimized absorbed power together with the corresponding pto damping and the relative pitch motion are given by eqs 18 20 in section 3 2 fig 9 summarizes the variation of the optimized power capture width ratio ω opt and the corresponding optimal pto damping c opt and optimal relative pitch motion amplitude δ θ opt with kl for interconnected two rafts with different raft length ratios l 1 l 2 and structural flexibility levels the structural flexibility levels for two rafts are set to be identical it is noted that the structural flexibility is chosen within a relatively large range i e e from approximately 50000 to 0 25 which may not be normal for most wecs however from the point of view of theoretical study it may be beneficial to explore the effects of structural flexibility in a relatively large range in addition small structural flexibility is still possible to be realized by using other materials than steel structure as shown in fig 9 a with k l increasing from 0 5 to 6 5 all ω opt for the wecs with different raft length ratio and structural flexibility first increase and then decrease after reaching peak values ω max for a wec with a given l 1 l 2 compared with the rigid body condition e 4 97 10 4 the introduction of structural flexibility reduces the power width ratio for relatively long waves but has a positive effect for short waves for long waves for example k l 4 a higher structural flexibility or a smaller structural elasticity e corresponds to a smaller power capture width ratio however an opposite trend is found for relatively short waves k l 5 we denote a critical normalized wave number i e k l c as the value corresponding to the intersection of the power capture width ratio curve for rigid and flexible body condition in terms of the effect of structural flexibility on power absorption k l c separates a constructive region k l k l c from a destructive region k l k l c overall k l c is within 4 6 which corresponds to the ratio of wave length to half of the total length of two rafts being within 1 1 5 the values of k l c decrease with the increase of the fore aft raft length ratio it can be seen that for l 1 l 2 20 20 the critical wave numbers are the same for different structural flexibility levels which indicates that at this point the optimal power capture width ratio is not affected by the structural flexibility see also zhang et al 2018b for other length ratios k l c are different for different structural flexibility levels due to the asymmetry of the fore and aft raft length however for the fore raft length being larger than the aft one i e l 1 l 2 25 15 k l c are also very close for different structural flexibility levels fig 9 b shows the variation of the optimal pto damping with k l for different raft length ratios and structural flexibility levels all c opt decrease with the increase of k l for a given raft length ratio the more flexible the rafts the smaller the optimal pto damping it is noted that for a given structural flexibility level the two c opt k l curves for l 1 l 2 15 25 and l 1 l 2 25 15 overlap relative to each other which coincides well with the symmetry properties as shown in fig 8 a and b the reason for this overlapping phenomenon for two rigid raft wec has been explained mathematically by zheng and zhang 2017 they mentioned that the expression for the optimal pto damping see eq 18 in section 3 2 has no wave excitation force term involved this feature still maintains for a flexible wec with two rafts of identical structural flexibility if the structural flexibility levels are different for two rafts this overlapping feature may not exist see fig 8 c and d the variation of the optimal relative pitch motion amplitude δ θ opt with kl is given in fig 9 c with the increase of kl δ θ opt first increases reaches the maximum value and then decreases the effects of structural flexibility on the optimal relative pitch motion can also be categorized into two different zones by comparing kl with a critical value k l c 1 which is the intersection of δ θ opt k l curves between a rigid wec and a flexible wec when k l k l c 1 the introduction of structural flexibility decreases the optimal relative pitch motion an opposite trend is observed for k l k l c 1 the better power capture performance for a flexible wec in short waves is caused by its larger relative motion amplitude compared with a rigid wec interestingly the critical relative wave number k l c 1 for the optimal relative pitch motion is smaller than the critical value k l c for the optimal power capture width ratio next we will consider the optimized power capture width ratio for interconnected two raft wecs with different combinations of structural flexibility levels for two rafts we consider three different structural flexibility levels i e e 4 97 10 4 rigid body condition 2 49 and 0 25 two different flexible body conditions as shown in fig 10 for l 1 l 2 7 33 and 10 30 the optimized power capture width ratios ωopt are almost identical for the fore raft being rigid or flexible this is consistent with the contour plot for power capture width ratio shown in fig 4 the reason is that the length of the fore raft 7m and 10m is short compared with the incident wave length and rigid motion modes dominate as a result there are only two valid combinations including rigid fore raft plus rigid aft raft and rigid fore raft plus flexible aft raft for e 2 49 flexible aft raft the power capture width ratio is smaller than that for a two rigid raft wec in the whole range of kl when the flexible raft becomes more flexible e 0 25 the kl corresponding to the maximum capture width ratio ωmax is shifted to a higher value making the optimized power capture width ratio for a flexible wec higher than that for a rigid wec for short wavelength for raft length being larger than 15m flexible modes will also be excited and thus there are some differences of the power capture width ratio for rigid and flexible rafts especially for a higher structural flexibility level e 0 25 for example for l 1 l 2 15 25 and e 4 97 10 4 or 0 25 the maximum power capture width ratio ωmax decreases in the following order rigid fore raft plus rigid aft raft flexible fore raft plus rigid aft raft rigid fore raft plus flexible aft raft flexible fore raft plus flexible aft raft for l 1 l 2 25 15 when the fore raft is rigid the structural flexibility for the aft raft has little effect on kl corresponding to the maximum power capture width ratio ωmax this trend is different from that for smaller raft length ratio i e l 1 l 2 7 33 for a given set of structural flexibility levels e 4 97 10 4 and 0 25 variation of the structural flexibility combination from rigid fore raft plus flexible aft raft to flexible fore raft plus rigid aft raft leads to a shift of the kl corresponding to the maximum power capture width ratio ωmax to a larger value the above mentioned results are obtained with no constraint put on the relative motion between two rafts these results may be reasonable for small amplitude of the relative motion however for large relative motion some constraints are needed to put on the relative motion of two rafts in order to protect the rafts from collision or to avoid exceeding the stroke of the hydraulic cylinders fig 11 gives the optimized power capture width ratio ωopt and the corresponding pto damping coefficients of the flexible two raft wec with motion constraint considered it is noted that a non dimensional upper limit of the relative rotation around the hinge δ is defined as δ δ l a by comparing fig 11 with fig 9 it can be concluded that the introduction of constraint will lead to the reduction of the optimized capture width ratio where the corresponding optimized relative motion exceeds the upper limit the constraint will lead to an increase of the optimal pto damping altering the feature of c opt k l curve from being continuously concave to being partly convex for relatively small fore aft raft length ratios for example l 1 l 2 7 33 or 10 30 the constructive effect of structural flexibility on power capture performance at relatively short wave length region where the kl value is relatively large is counteracted by the constraint on the relative motion the reason is that this constructive effect of structural flexibility is mainly due to a larger amplitude of the relative motion see fig 9 which may exceed the given upper limit for relatively large raft length ratios as the amplitude of the relative motion for large kl is within the upper limit the constructive effect of the structural flexibility still exists for a certain range of kl of large value under motion constraint 5 3 discussion on kl c for a wec with two rafts of identical length and structural flexibility in this section we investigate how the critical wave number kl c will be affected by different geometric parameters first we look at the variation of k l c with the gap l s between two rafts see fig 1 we choose a set of different values of l s from 0 5m to 3m and normalize it by half of the total length of two rafts l the other parameters are kept unchanged the results are given in fig 12 the variation of ω opt with k l for a given gap can be seen in fig c1 in appendix c it can be seen from fig 12 that the critical normalized wave number decreases almost linearly with the increase of the gap value with l s l varying from 0 025 to 0 15 the value of k l c decreases from 4 88 to 4 49 or equivalently λ l c varies from 1 29 to 1 40 despite of the decreasing trend with gap the critical normalized wave number is not very sensitive to the gap the total variation of the critical wave number is within 10 when the gap value increases up to 6 times next we choose different values of the major axis a of the elliptical section to investigate its effect on the critical normalized wave number the length of each raft is set as l 20 m the minor axis b 2 5m and the gap l s 1 m the variation of ω opt with k l for a given value of the major axis a can be seen in fig c2 in appendix c as shown in fig 13 the critical normalized wave number decreases with the increase of the width i e the major axis of the elliptical cross section of the float again it can be seen that the critical wave number is not sensitive to the width of the float 5 conclusions this paper investigates the power capture performance of a hinged two raft wave energy converter the discrete module beam bending based hydroelasticity method is used to establish the equations of motion for the hinged wec a mathematical model is then derived for pto optimization which is applicable for a hinged wec with different fore aft raft lengths and structural flexibility levels based on this model the combined effects of raft length ratio and structural flexibility on the power capture performance of an interconnected two raft wave energy converter are explored basically hinged flexible rafts are bad for wave energy absorption more findings are summarized as follows 1 two rafts with identical length may be the optimal condition for power absorption in relatively long waves while the performance is weakened by increasing the structural flexibility of two rafts 2 both the decrease of the fore aft raft length ratio and the increase of structural flexibility lead to increase of power absorption in a shorter wave condition 3 a critical normalized wave number k l c 4 6 k is wave number and l is half of the total raft length categorizes the effects of structural flexibility on power capture performance into constructive k l k l c and destructive k l k l c regions the critical normalized wave number is not sensitive to the geometric parameters of the wec such as the width of two rafts and the gap between them to make these findings more intuitive to readers we consider a hinged wec with the following parameters the total length of two rafts is 2l 40m the gap between them is 1m the major and minor axis of the elliptical cross section of each raft is 5 and 2 5m respectively and the water depth is 20m the critical wave length λ c is around 25m therefore structural flexibility has a constructive effect on power absorption for waves shorter than 25m whereas this effect is negative for waves longer than 25m it should be noted that these findings are achieved within the framework of linear hydroelastic analysis and thus may be inaccurate for a wave energy converter under extreme wave conditions where nonlinearity becomes important and should be considered the drag force is also neglected in the present numerical model which may have some influences on the dynamic response and power absorption of the wec near the resonance region as indicated by eatock taylor et al 2016 acknowledgement the authors are grateful that comments and suggestions provided by the anonymous reviewers helped to improve the quality of the paper the authors would like to acknowledge the support by ministry of industry and information technology of china project no 2016 546 appendix a the expressions for all the matrices in eq 2 are given as follows a1 m m 1 m 2 m n 3 n 3 n where m j j 1 2 n is the mass or moment of inertia matrix for the jth submodule and its dimension is 3 3 a2 c c 1 c 2 c n 3 n 3 n where c j j 1 2 n is the hydrostatic restoring coefficient matrix for the jth submodule the expression of which is given as follows a3 c 0 0 0 0 ρ g a w j ρ g a w j x f j 0 ρ g a w j x f j ρ g v w j g m l j 3 3 here a w j is the waterplane area for the jth submodule v w j is the displaced volume of water x f j is the x coordinate of the centre of flotation g m l j is the longitudinal metacentric height a4 a ω a 1 1 a 1 2 a 1 n a 2 1 a 2 2 a 2 n a n 1 a n 2 a n n 3 n 3 n where a k j k j 1 2 n is the added mass matrix of the kth submodule induced by the motion of the jth submodule and its dimension is 3 3 a5 b ω b 1 1 b 1 2 b 1 n b 2 1 b 2 2 b 2 n b n 1 b n 2 b n n 3 n 3 n where b k j k j 1 2 n is the radiation damping matrix of the kth submodule induced by the motion of the jth submodule and its dimension is 3 3 a6 b pto 0 3 n 1 1 3 n 1 1 0 3 n 1 1 6 0 3 n 1 1 3 n 2 1 0 6 3 n 1 1 b pto 0 6 3 n 2 1 0 3 n 2 1 3 n 1 1 0 3 n 2 1 6 0 3 n 2 1 3 n 2 1 3 n 3 n where b pto is given as follows a7 b pto 0 0 0 0 0 0 0 0 0 0 0 0 0 0 c pto 0 0 c pto 0 0 0 0 0 0 0 0 0 0 0 0 0 0 c pto 0 0 c pto a8 x x 1 t x 2 t x n t t where x j x j z j θ j t j 1 2 n is the displacement vector for the jth submodule a9 f e f e 1 t f e 2 t f e n t t where f e j f e x j f e z j m y j t j 1 2 n is the wave excitation force vector for the jth submodule a10 a j 0 2 3 n 1 3 1 0 0 1 0 0 0 1 l 1 n 1 l s 2 0 1 l 2 n 2 l s 2 0 2 3 n 2 3 2 3 n a11 f j f j x f j z t where f j x and f j z are the forces on the hinge connector in x and z direction respectively a12 k st k 0 1 1 k 1 1 1 k 1 1 2 k 1 2 1 k 1 2 2 k 2 2 2 k n 1 1 n 1 n 1 k n 1 2 n 1 1 n 1 1 k n 1 2 n 1 1 n 1 2 k n 1 2 n 1 2 n 1 1 k n 1 2 n 1 2 n 1 2 k n 1 3 n 1 2 n 1 2 k n n n k n 1 n n 3 n 3 n where k q i j q 0 1 2 n 1 i q o r q 1 j q o r q 1 is the submatrix the size is 3 3 of the stiffness matrix k q whose size is 6 6 for the qth imaginary beam located between the centre of gravity of the qth and q 1 th submodules and k q can be calculated using approach proposed in lu et al 2016 with the aid of the software ansys ansys 2013 k 0 1 1 is the equivalent stiffness submatrix of beam element 0 exerted on the lumped mass 1 and k n 1 n n is the equivalent stiffness submatrix of beam element n 1 exerted on the lumped mass n their expressions are given as follows a13 k 0 1 1 k 0 1 0 k 0 0 0 1 k 0 0 1 k 0 1 1 a14 k n 1 n n k n 1 n 1 n 2 k n 1 n 2 n 2 1 k n 1 n 2 n 1 k n 1 n 1 n 1 appendix b here we will show how to obtain the response amplitude weight of each natural orthonormal mode of vertical vibration for a beam based on the hydroelastic response using the method proposed by lu et al 2016 a freely vibrating beam satisfying the following equations b1 e i 4 w x 4 μ 2 w t 2 where w is the vertical deflection of the beam and μ is the mass per unit length of the beam for a given frequency of vibration ω the vertical deflection w may be expressed as b2 w x t re w ˆ x e i ω t then we can solve an ordinary differential equation b3 e i d 4 w ˆ d x 4 μ ω 2 w ˆ 0 the general solution of the above equation which is also the natural mode of the beam is b4 w ˆ n x a cos α n x b sin α n x c cosh α n x d sinh α n x n 1 2 for a free free beam see fig b1 there is no any support at two ends of the beam then the natural mode of the free free beam is given as follows b5 w ˆ n x cos α n x cosh α n x k n sin α n x sinh α n x where k n cos α n l cosh α n l sin α n l sinh α n l l is the length of the beam and α n l denotes the nth solution of the eigenvalue equation given by b6 1 cosh α n l cos α n l 0 if we consider the rigid motion of the beam i e heave and pitch motion then the natural oscillation mode is given by b7 w ˆ n x 1 n 1 1 2 x l n 2 0 5 cos α n x cosh α n x k n sin α n x sinh α n x n 3 it should be noted that in the expression b7 the mode shapes for all orders have been normalized by their own maximum values along the beam therefore for each mode in expression b7 the maximum absolute value is 1 this manipulation makes it convenient for comparing the weights of each mode i e the contribution of each mode to the total response under waves suppose that the continuous beam is discretised into m submodules for hydroelstic analysis using the method proposed by lu et al 2016 for each submodule s centre the complex amplitudes of the heave vertical displacement and pitch displacement are solved as a j and θ j respectively j 1 2 m then the complex amplitude a j and θ j are projected onto a finite dimensional space spanned by the dominant natural modes of vibration i e b8 a j s 1 n ξ s w s x j for j 1 2 m b9 θ j s 1 n ξ s d d x w s x j for j 1 2 m where x j denote the location of the centre of the jth submodule n is the total number of modes considered generally the total number of modes used for representing the hydroelastic response of the flexible structure calculating using lu s method satisfies the expression n 2 m it should be noted that the number of flexural modes excited depends on the relative properties of the incident wave and the beam higher order oscillation modes are excited as the incident wave length to beam length becomes smaller the weight for each oscillation mode ξ s is determined via a least squares minimization routine we construct a function of the weight ξ s as follows b10 f ξ 1 ξ 2 ξ n j 1 m a j s 1 n ξ s w s x j 2 j 1 m θ j s 1 n ξ s d d x w s x j 2 then we seek the value of ξ s to make the smallest value of the function f ξ 1 ξ 2 ξ n which should satisfies the following expressions b11 ξ k f ξ 1 ξ 2 ξ n 0 k 1 2 n if we denote mat n 2 m as b12 mat n 2 m w 1 x 1 w 1 x m d w 1 x 1 d x d w 1 x m d x w 2 x 1 w 2 x m d w 2 x 1 d x d w 2 x m d x w n x 1 w n x m d w n x 1 d x d w n x m d x eq b11 can be re expressed in the matrix form as follows b13 mat n 2 m mat n 2 m t ξ 1 ξ n mat n 2 m a 1 a m θ 1 θ m where t indicates the transpose of a matrix then the weight for each oscillation mode of the flexible structures is calculated as b14 ξ 1 ξ n mat n 2 m mat n 2 m t 1 mat n 2 m a 1 a m θ 1 θ m fig b1 a free free beam with the length of l fig b1 appendix c fig c1 the variation of the optimized power capture width ratio with kl for a wec l 1 l 2 20 20 and e 1 e 2 e with different values of the gap l s 2 fig c1 fig c2 the variation of the optimized power capture width ratio with kl for a wec l 1 l 2 20 20 and e 1 e 2 e with different values of the major axis a of the elliptical cross section 3 fig c2 
22923,a modeling method based on the wave superposition method is studied in this paper different underwater acoustic propagation models are used in the near and far field taking the acoustic radiation field calculation of an elastic spherical shell as an example the near and far field can be analyzed as a unified system using this method many studies use fem bem finite element method boundary element method to calculate acoustic radiation fields of elastic structures but only a few of these methods can be applied when considering finite ocean depth seafloor reflection loss and sound velocity profile in this study the green function is calculated differently in the near and far field to significantly simplify calculations the virtual source method is used to calculate the acoustic radiation field in the near field and source strength while the normal mode method is used in the far field the results are compared with those obtained using the comsol finite element software which showed that this method was both computationally efficient and accurate based on numerical examples the influence of sea surface seafloor and sound velocity on the acoustic radiation field of elastic structures in an ocean acoustic environment is quantitatively analyzed keywords elastic spherical shell finite depth ocean fluid solid coupling acoustic radiation acoustic propagation wave superposition method 1 introduction the calculation methods of fluid structure interaction vibration acoustic radiation and propagation of structures have wide ranging engineering applications such as in the identification of radiation noise of ships and underwater vehicles however researchers have gone into the two different research directions of vibration and acoustic radiation of elastic structures in water and the propagation of soundwaves in ocean acoustic environments an efficient integrated computing method suitable for complicated ocean acoustic environments is urgently needed applied independently the two research directions are inadequate water is usually assumed to be an ideal acoustic medium and problems considering a sound velocity profile are difficult to resolve the other direction focuses on the propagation behavior of point sources and there has been little research on fluid structure interaction vibration acoustic radiation and acoustic propagation of elastic structures in fact the two directions are correlated and must be considered simultaneously since related theoretical and computational methods have been developed progress in calculation accuracy and efficiency by improving the method itself is inclined to decrease in this paper we propose an efficient integrated calculation method for fluid structure interaction vibration acoustic radiation and propagation in ocean acoustic environments the idea is to separately apply appropriate acoustic propagation models in the near and far fields this method can solve acoustic radiation problems in complicated ocean acoustic environments with sound velocity profiles since the 1960s a large amount of literature has been published to solve acoustic radiation and acoustic scattering of structures in the infinite water region using analytical methods diercks and hickling 1967 hickling 1964 skelton and james 1997 these studies provide an intuitive and clear physical model to understand the phenomena of vibration acoustic radiation and acoustic scattering of elastic structures in water however the analytical method has difficulty producing accurate calculation results in complicated ocean acoustic conditions some studies may solve the analytic solutions when a finite ocean depth seafloor reflection loss and sound velocity profile are all considered however these analytic solutions are very difficult or time consuming to solve particularly when complicated ocean environment is considered at present with the development of computer technology the numerical calculation method is widely used to analyze the vibration characteristics of engineering structures and resultant problems of acoustic radiation numerical simulation of vibration and acoustic characteristics of underwater elastic structures usually requires consideration of fluid structure interaction especially for thin elastic structures in engineering the fluid structure coupled vibration behavior of elastic structures is often analyzed using the finite element method fem because it is relatively flexible and suitable for larger models zienkiewicz and taylor 2005 for the study of acoustic radiation fields in waters although fem can be used to calculate acoustic radiation in infinite or semi infinite waters with some new techniques such as the perfect matching layer pml berenger 1994 darvish et al 2018 there are still some problems for example calculating far field acoustic propagation will require an extremely large number of calculations hence fem and the boundary element method bem have been among those preferred to solve problems of underwater vibration and acoustic characteristics everstine and henderson 1990 bem has been successfully applied to various engineering problems such as soundwaves fu et al 2014 yang et al 2015 and seismic waves lin et al 2018 the boundary integral method is much more efficient than fem when the problems solved over a large volume however the boundary integral has singularity and uniqueness at the characteristic frequency cannot be guaranteed improper handling can easily distort the calculation results at high frequencies chen et al 2016 investigated the structural acoustic radiation problem of cylindrical shell structures with complicated acoustic boundary conditions by the double reflection method and verified the method using fem bem the wave superposition method is another numerical method that is derived from the acoustic boundary integral equation based on the superposition principle of solid mechanics koopmann et al 1989 proposed a wave superposition method to calculate boundary integrals equivalently to determine the acoustic radiation field the wave superposition method s main feature is to locate several virtual simple source points source strengths of which are to be solved in the interior of the acoustic radiator the layout is flexible which can effectively avoid the singular integral problem miller et al 1991 wang and guo 2016 obtained the structural responses of a submerged stiffened submarine hull by the coupled precise transfer matrix method and wave superposition method zou et al 2013 2014a studied an acoustic radiation problem in a shallow sea and used acoustic elastic theory and a simple source method to analyze the acoustic radiation field of two three dimensional hull structures in the pekeris waveguide to deal with the irregular frequency problem in analysis zou et al 2018 used a closed virtual impedance surface cvis method most of the theory and applications in three dimensional sono elasticity have been summarized wu et al 2016 the theory of acoustic propagation in an ocean underwater acoustic environment is generally classified as computational ocean acoustics and there have been related achievements in the last half century in the wave superposition method several virtual simple sources such as point acoustic sources are placed in the interior of an acoustic radiator knowledge from computational ocean acoustics is needed to calculate the source strengths of these sources and the acoustic radiation field outside the acoustic radiator jensen et al 2011 provided a detailed summary of widely used models such as ray normal mode and parabola in computational ocean acoustics there have been many recent achievements in the field of acoustic propagation in water of finite depth wang et al 2015 discussed low frequency acoustic propagation which is independent of the distance in a shallow sea through simulation the influence of seawater and seafloor density on transmission loss was analyzed and an acoustic propagation model considering random environmental disturbance and rough sea surface was established sprague and luczkovich 2016 used the finite difference time domain fdtd to study the propagation of transient soundwaves in a very shallow sea and compared the computational efficiency of two coordinate systems the computation time required for cylindrical coordinates is short but they require axial symmetry three dimensional cartesian coordinates do not require symmetry and have high general applicability but computation is time consuming petrov and petrova 2016 used the modal expansion method to solve the problem of acoustic propagation in shallow seas the acoustic pressure field generated by the resonant point sources in a non uniform three dimensional waveguide was obtained parabolic equation theory was used to obtain the far field approximate expression of amplitude clark 2017 studied the horizontal propagation of soundwaves in unknown sea conditions wang et al 2017 researched a fast calculation method of acoustic propagation after multiple reflections on the sea surface and seafloor in a noisy environment the differences in fluid structure interaction vibration acoustic radiation and acoustic propagation in ocean acoustic environments and the boundary characteristics of the sea surface and seafloor can all affect the acoustic radiation field of elastic structures considering the calculation of fluid structure interaction vibration acoustic radiation and propagation in an ocean acoustic environment it is beneficial to directly study the quantitative laws of acoustic radiation fields of structures at the same time research on the acoustic radiation fields of elastic structures in acoustic environments considering sound velocity profiles is still lacking although fem can be used to calculate the results the computation time increases dramatically with the calculated range therefore the range that can be calculated is limited which leads to many restrictions on its use it is necessary to develop new calculation methods to reduce computational complexity and increase efficiency this paper s main innovation is to use the green function corresponding to the acoustic propagation model of a specific ocean acoustic environment to simplify calculations by calculating differently in the near and far field the virtual source method is used to calculate the source strength and acoustic radiation field in the near field which can simplify the calculation while the normal mode method is used in the far field this greatly reduces the computational complexity and improves the computational feasibility the radiation fields in the near and far field of the elastic spherical shell are calculated in the finite depth of four cases the uniform layer positive velocity gradient negative velocity gradient and negative thermocline velocity gradient to verify the method its results are compared with those of comsol fem software the influence of the sea surface seafloor and sound velocity profile on the acoustic radiation field of elastic structures in ocean acoustic environments is analyzed by quantitative calculation 2 fluid solid coupling equation and wave superposition method for elastic spherical shell a spherical coordinate system taking the elastic shell center as the origin and o z as the polar axis is considered as shown in fig 1 this elastic spherical shell immersed in water is affected by the outflow field in the spherical coordinate system the displacement components corresponding to the coordinates r θ and φ are respectively u r u θ and u φ because of its axial symmetry the vibration displacement in the direction of the spherical shell is 0 u φ 0 and u r r θ t and u θ r θ t are not relevant to φ if the excitation is also axisymmetric for convenience w and u are used to represent u r r θ t and u θ r θ t respectively in this paper we assume the waveguide interfaces are parallel to the x y plane analyzing the vibration of the elastic spherical shell according to its stress and strain the dynamic equation about w and u can be obtained as junger and feit 1986 follows 1 1 β 2 2 θ 2 cot θ θ ν cot 2 θ r 2 c p 2 2 t 2 u β 2 3 θ 3 β 2 cot θ 2 θ 2 1 ν β 2 ν cot 2 θ θ w r 2 ρ s h c p 2 f θ β 2 3 θ 3 2 β 2 cot θ 2 θ 2 1 ν 1 β 2 β 2 cot 2 θ θ cot θ β 2 2 ν cot 2 θ 1 ν u β 2 4 θ 4 2 β 2 cot θ 3 θ 3 β 2 1 ν cot 2 θ 2 θ 2 β 2 cot θ 2 ν cot 2 θ θ 2 1 ν r 2 c p 2 2 t 2 w r 2 ρ s h c p 2 p f r where r h and ρ s are respectively the radius thickness and volume density of the spherical shell ν is poisson s ratio β 2 h 2 12 r 2 represents the contribution of bending stress c p e 1 ν ρ s 1 2 ν 1 ν is the velocity of the longitudinal waves e is the young modulus p r θ t r r is the sound pressure of the outer flow field on the spherical shell and f r f θ are the external forces acting on the spherical shell in the radial and circumferential directions respectively we simplify eq 1 and change a function of time by fourier transform to the frequency domain through the following changes 2 η cos θ 3 η 2 d d η 1 η 2 d d η 4 ω 2 ω r c p 2 substituting the harmonic time factor e i ω t into eqs 2 4 where ω is the angular frequency eq 1 can be simplified to 5 l 11 u l 12 w ω 2 u r 2 ρ s h c p 2 f θ ω l 21 u l 22 w ω 2 w r 2 ρ s h c p 2 p r θ ω r r f r ω the forms of the differential operators in eq 5 are 6 l 11 1 β 2 1 η 2 d 2 d η 2 1 η 2 1 ν l 12 1 η 2 β 2 1 ν 1 ν d d η β 2 d d η η 2 l 21 β 2 1 ν 1 ν d 2 d η 2 1 η 2 β 2 η 2 d d η 1 η 2 l 22 β 2 η 4 β 2 1 ν η 2 2 1 ν for axisymmetric cases the radial and circumferential vibration displacements of the spherical shell can be expressed as junger and feit 1986 7 w θ n 0 w n p n η u θ n 0 u n 1 η 2 d p n η d η where p n η is a legendre polynomial and w n u n are unknown generalized coordinates if the center of the shell is at the origin of the spherical polar coordinate system and the r coordinate points outward from the center of the shell according to the compatibility condition of fluid structure coupling at a wetted surface the boundary condition between the spherical shell and outer flow field is 8 φ r r r i ω w where φ is the velocity potential of soundwaves the wave superposition method is used to solve the coupling effect between a spherical shell and outer flow field and acoustic radiation wsm is based on the idea that the acoustic field of a complex radiation body can be superimposed by a series of simple acoustic sources in the radiation body these simple acoustic sources establish a continuous distribution in the radiation body we place a cylinder in that radiation body and the radius tends to 0 r 0 the simple acoustic sources are continuously distributed in the cylinder because the cylinder is included in the original radiation body there is no singularity problem using discrete points to replace continuous simple sources and distributing the source points on the z axis and field points on the perimeter of the spherical shell the radius of the ball is r as shown in fig 2 the number of field points and source points are both n j the x and y coordinates of the source points are 0 and the z coordinate of the n j th n j 1 2 n j point is 9 z n j 0 r 1 2 n j 1 n j the x and z coordinates of the n j th field point are 10 x n j r sin n j 0 5 π n j 11 z n j r cos n j 0 5 π n j the kind of distribution of source points and field points is served as an example and other arrangements can also be used if these source points are axisymmetric about the z axis in wsm wave superposition method these strength of source points are solved by boundary condition of dynamic response excited by external force each strength of source points includes information of magnitude and phase because strength is expressed in complex number based on the wave superposition method the velocity potential of soundwaves in the outer flow field caused by the n th mode of the spherical shell is 12 φ n r n j 1 n j q n j r 0 g r r 0 where q n j r 0 is the unknown source strength of the n th source point r denotes position vectors of field points and r 0 denotes position vectors of source points according to eqs 8 and 12 and the orthogonality of legendre polynomials an equation can be obtained from the boundary conditions as 13 i ω p n η n j 1 n j q n j r 0 g r r 0 n r where r is on the surface of the spherical shell and g r r 0 n r represents the normal partial derivative of the green function at the outer surface of the spherical shell the source strength can be solved by eq 13 the computational efficiency depends on the form of the green function therefore different green functions are necessary in the near and far fields to improve computational efficiency if a green function is obtained by the virtual source method its form will be an analytical formula which is convenient to obtain values of g r r 0 n r the virtual source method is used to calculate the acoustic radiation field in the near field and the source strength while the normal mode method is used in the far field the details are described below the velocity potential of the outer flow field can be linearly superposed by velocity potential caused by vibration of different modal orders of the spherical shell 14 φ r n 0 w n φ n r n 0 w n n j 1 n j q n j r 0 g r r 0 the relationship between velocity potential and sound pressure at the outflow field is 15 p r i ω ρ 0 φ r where ρ 0 is the density of seawater at the location of the spherical shell the sound pressure acting on the spherical shell takes the form of a legendre polynomial expansion as 16 p r n 0 w n m 1 a m n p m η then the undetermined coefficient a m n can be obtained by eqs 12 and 14 16 and the orthogonality of the legendre polynomials as 17 a m n 2 m 1 2 i ω ρ 0 π n j n j 1 n j φ n r p m η sin n j 0 5 π n j for the n j th field point η cos n j 0 5 π n j substituting eq 7 and 16 into eq 5 and using the orthogonality of legendre polynomials the fluid structure coupling dynamic equation can be stated as 18 l 11 n u n l 12 n w n r 2 ρ s h c p 2 f θ n l 21 n u n l 22 n w n m 0 b n m w m r 2 ρ s h c p 2 f r n where l 11 n ω 2 1 β 2 ν λ n 1 l 12 n β 2 ν λ n 1 1 ν l 21 n λ n β 2 ν λ n 1 1 ν l 22 n ω 2 2 1 ν β 2 λ n ν λ n 1 λ n n n 1 and b n m a n m r 2 ρ s h c p 2 f θ n and f r n are the external forces in generalized coordinates in form of u n and w n acting on the spherical shell in the radial and circumferential directions respectively and f n 2 n 1 2 1 1 f n η p n η d η junger and feit 1986 if the external force acts on θ π bottom of the shell and is a unit nodal force in the radial direction then f r δ θ π 2 π r 2 sin θ where δ is the dirac function and the components of f n in eq 18 are f θ n 0 and f r n 2 n 1 2 p n 1 2 π r 2 considering up to the n th mode the matrix equation is 19 l 110 l 120 l 210 l 220 b 0 n 0 0 0 b n 0 0 0 0 l 11 n l 12 n l 21 n l 22 n u 0 w 0 u n w n 0 r 2 ρ s h c p 2 1 2 p n 1 2 π r 2 0 r 2 ρ s h c p 2 2 n 1 2 p n 1 2 π r 2 after solving the generalized coordinate response w n by the matrix equation the sound pressure of the outer flow field can be obtained by substituting it into eq 16 3 calculation of the green function 3 1 virtual source method the source strengths of a virtual source are solved by eq 13 and g r r 0 n r is necessary in the process when considering the virtual source method to obtain the green function this analytical green function facilitates the efficient calculation of g r r 0 n r in recent work zou et al 2014a zou 2014b the virtual source method was used in a pekeris waveguide to obtain source strengths of simple sources with the simple source method this corresponds to the continuous reflection of a soundwave on the seafloor and sea surface the acoustic reflection coefficient of the sea surface is generally taken as 1 reflection and refraction of plane waves occurs at the seafloor and the acoustic reflection coefficient in two actual sea conditions zou 2014b 20 v α cos θ β 2 sin 2 θ α cos θ β 2 sin 2 θ 1 sin θ β sin θ β has been studied where θ is the incident angle α ρ 1 ρ 0 β c 0 c 1 ρ 0 is the density of the seawater ρ 1 is the density of the seafloor sediment and c 0 c 1 are the velocity of sound in seawater and sediment respectively the parameters of the two sea conditions are shown in table 1 the reflection coefficient of plane waves at different angles is calculated using eq 20 as shown in fig 3 from fig 3 we can conclude that when the incident angle θ is in the range of 0 50 the acoustic reflection coefficient is approximately a constant and generally in range of 0 1 0 6 in our calculations we must calculate the reflection coefficient v by considering the acoustic environment parameters and θ 0 the sound propagation can be regarded as a mirrored imaginary virtual source chain which is constantly reflected on the sea surface and seafloor as shown in fig 4 a when soundwaves from a point source are transmitted through a single reflection to a field point and the incident angle is less than 50 the incident angle through multiple reflection will be also less than 50 the green function is 21 g r n 0 v n e i k r n 1 r n 1 v e i k r n 2 r n 2 e i k r n 3 r n 3 v e i k r n 4 r n 4 where r n 1 r 2 2 n h z z 0 2 r n 2 r 2 2 n h 2 h 2 z z 0 2 r n 3 r 2 2 n h 2 h 1 z z 0 2 r n 4 r 2 2 n 1 h z z 0 2 n is the order number of virtual sources series so that different paths including in this green function is 4n r is the horizontal distance of the sound source to the receiving point h is the depth of seawater and h 1 and h 2 are distances between the sound source to the sea surface and seafloor respectively in conclusion the virtual source method is applicable when r 2 h 2 z 0 z tan 50 1 19 which can be derived from θ 0 50 in the following paragraph we will explain how the condition come from as a prerequisite we can simply derive that the incident angle for a single reflection path is less than that for a multiple reflection path therefore if the incident angle for a single reflection is less than 50 all the incident angles for multiple reflection will be less than 50 the condition incident angle for a single reflection is less than 50 is equal to r h tan 50 where h 2 h 2 z 0 z and the geometrical relations are shown in fig 4 b so that the applicable condition is r 2 h 2 z 0 z 1 19 it is qualitatively understandable that the acoustic radiation field of structures in the near field is not sensitive to the sound velocity profile of the seawater therefore in the near field the sound propagation characteristics of a point sound source in the positive velocity gradient negative velocity gradient and negative thermocline velocity gradient can be seen to be similar to those in a uniform layer and although the multiple scattering is somewhat important in near field we use a simplified model to not consider multiple scattering neglecting in addition the following calculation results prove that these simplifications have little influence on accuracy thus eq 21 can be used to calculate the green function not just in a uniform layer but for a more complicated sound velocity profile the form of the green function is an analytical formula which is convenient for obtaining values of g r r 0 n r substituting g r r 0 n r in eq 13 the source strengths of the virtual points in an acoustic radiator can be solved in the near field a simple model is adopted so that the green function is a simpler analytical formula that avoids complex derivation calculations and does not affect the accuracy of the result if we also find a suitable model in the far field to express the green function then we can analyze the near and far field as a unified system 3 2 normal mode method in the far field we must obtain a model suitable for far field propagation of a point source which is the corresponding green function then superposing the acoustic field of each point source the acoustic radiation field in the far field can be obtained the normal mode method can handle problems in more complicated sound velocity profiles and it guarantees the accuracy of calculation in this paper we concretely adopt the finite difference method with high efficiency according to the current derivation and conclusion jensen et al 2011 using a finite difference in the depth direction of seawater and boundary conditions of seawater and seafloor sediments the algebraic eigenvalue problem is simplified to 22 az h 2 k r 2 z where a is the characteristic matrix related to the sound velocity profile and boundary conditions z is a column vector composed of characteristic functions on finite difference grid points h is the depth of each grid and k r is the transverse wave number the above eigenvalue problem is solved by bisection search and the corresponding eigenfunctions are obtained by the inverse interaction method jensen et al 2011 the obtained eigenvalues and corresponding normalized eigenfunctions are substituted in the equation jensen et al 2011 23 p r z i 4 ρ 0 z m z s z m z h 0 1 k r m r where z m is the eigenfunction the elements of z k r m is the corresponding eigenvalue z s is the z coordinate of the corresponding source r z is the coordinate of the point to be sought and h 0 1 is the zero order hankel function of first kind then the green function corresponding to the acoustic propagation of a point source in the far field can be obtained in the calculation the leaky wave is not considered for improving the computational efficiency so this method will cause deviation if used in the near field therefore the virtual source and normal mode methods are complementary in the near and far field according to the general understanding of this problem beyond a distance which can be seen as the far field the complex root part complex root is corresponding to leaky wave have little effect on the results in other words it is appropriate to consider only normal modes corresponding to the real roots beyond that distance porter 1992 stated that it is accurate enough if the distance between the source point and observation point is over 10 times the depth of ocean water the accuracy in the transition region between the near and far field can be improved by considering the complex root part and leaky wave part 4 calculation verification and analysis of a spherical shell 4 1 comparison verification in a finite depth of water external force acts on θ π bottom of the shell and there is a unit nodal force in the radial direction as described in section 2 the results will be compared with those from comsol finite element software to verify the correctness of the described method the depth of seawater is 20 m and the density of seawater is 1 025 kg m 3 the depth of the elastic spherical shell is 5 m the radius is 0 5 m and the thickness is 0 0009 m the material of the shell is steel the young modulus of elasticity is 2 1 10 11 n m 2 the poisson s ratio is 0 3 and the density of the material is 7800 kg m 3 the structural damping factor of the shell is 0 002 four kinds of sound velocity profiles in seawater are considered these are the uniform layer positive velocity gradient negative velocity gradient and negative thermocline velocity gradient in the case of a uniform layer the sound velocity in seawater is 1510 m s the sound velocity profiles for other cases in seawater are presented in fig 5 the density of sediment is 2600 kg m 3 and the sound velocity in sediment is 1620 m s the unit nodal force at θ π is a normal harmonic concentrated exciting force acting at the point of the bottom of the spherical shell and the amplitude of the force is 1 n distributions of source and field points are shown in fig 2 of the second chapter in the wave superposition method n j 80 source points are on the z axis and field points are on the surface of the spherical shell the radiated sound pressure in a uniform layer positive velocity gradient negative velocity gradient and negative thermocline velocity gradient are calculated by two methods the sound pressure levels spls calculated by these methods are compared the relation between the sound pressure and sound pressure level is 24 spl 20 log 10 p p r e f db where p r e f 10 6 pa in the near field the depth of the observation point is 5 m and the horizontal distance between the observation point and shell is 2 m which satisfies r 2 h 2 z 0 z tan 50 1 19 all the sound velocity profiles are simplified to a uniform layer because the acoustic radiation field of structures in the near field is not sensitive to the sound velocity profile of the seawater in calculating the green function in the near field by the method described above the results in four sound velocity profiles will be totally the same while the result obtained by comsol will be calculated in a negative velocity gradient the results will be compared in order to see whether we can simplify sound velocity profiles to a uniform layer in the near field by the proposed method the acoustic reflection coefficient is solved by eq 20 and v 0 4626 comsol employs an axisymmetric two dimensional model the largest mesh in seawater is 0 5 m less than 1 6 of the wavelength and is smaller in the near field of the shell inside the shell a mesh size is chosen to be 1 30 of the shell diameter perfectly matched layers pmls are used at the boundary to simulate the semi infinite space the comsol model is shown in fig 6 the spl results at observation point 2 5 are compared in fig 7 where the exciting frequency range is 50 hz 300 hz from fig 7 we know that the lines obtained from the wave superposition method and fem negative velocity gradient is considered are nearly the same on the one hand it shows that the computational accuracy of this method in the near field is guaranteed on the other hand the acoustic radiation field in the near field is basically uninfluenced by the sound velocity profiles the low frequency acoustic propagation in shallow water is not independent of distance however at sufficiently low frequencies these effects become minimal and can often by ignored therefore using the integrated method described in this paper to calculate the radiated sound field will greatly increase computational efficiency in the far field the depth of the observation point is 15 m and the horizontal distance between the observation point and shell is 1000 m which satisfies 10 times the depth the spl excited by the vibrational elastic spherical shell at the observation point in four kinds of sound velocity profiles is calculated the acoustic reflection coefficient v is 0 4626 the horizontal distance is 1000 m because the amount of calculation is too large for pcs if the observation point is far from the shell this is a limitation of fem itself employing analysis by the wave superposition method and fem the spl results at observation point 1000 15 are obtained by the two methods and compared in fig 8 where the exciting frequency range is 50 hz 300 hz the solid lines are from the method of this paper and the dotted lines are from comsol from fig 8 we know that the groups of lines are approximately coincident there is still deviation in some positions because we consider only unattenuated normal waves real roots in calculation of the green function in fact the attenuated normal waves other complex roots still cannot be completely ignored at this distance and the computational accuracy is still slightly affected from fig 8 when the exciting frequency is less than 52 hz the sound pressure at the observation point is 0 neglecting numerical error this reflects the cutoff effect of the acoustic propagation jensen et al 2011 and the cutoff frequency is near 52 hz the resonance peaks appear near 290 hz showing that the frequency range is enough to reflect the acoustic radiation characteristics of the elastic spherical shell although comsol can draw the distribution maps by itself to avoid different color tables from two kinds of software to influence the color of the distribution maps the same figure will look quite different when drawn by comsol and matlab because of the different color tables used by the two applications the following distribution maps will all be drawn by matlab for example consider the near field when the exciting frequency is 100 hz and the depth of the shell is 5 m the other conditions are the same as above distribution maps of spl at 0 50 m are shown in fig 9 demonstrating that the distribution map obtained from our method is similar to that from comsol for example the thermocline velocity gradient is shown in fig 5 c for the far field when the exciting frequency is 200 hz and the sound velocity profile is negative the depth of the shell is 5 m the other conditions are the same as above fig 10 shows distribution maps of spl at 800 1000 m from which we know that the distribution decreases from the position near the source to far from the source the distribution map in the far field obtained by our method is also similar to that from comsol 4 2 different submerging depths in a negative thermocline velocity gradient we shall now discuss different shell depths or submerging depths using the example of a negative thermocline velocity gradient the depth of seawater is 20 m we consider submerging depths of 5 m 10 m and 15 m the other conditions are the same as in section 4 1 the spl results at the observation point 1 000 15 are shown in fig 11 there are two conclusions from fig 11 first the spl lines from different submerging depths are different because both the direct part and reflection influence the results and the submerging depth has a large influence on the reflection part second at the resonance frequency the spl results from different submerging depths are almost the same i e submerging depths have little influence on results at the resonance frequency when resonance occurs the direct part has a leading influence on results and the scales of submerging depths are small compared to the horizontal distance for different submerging depths for example in the near field 0 50 m with an exciting frequency of 300 hz the distribution maps of spl are shown in fig 12 we can see the different shapes of interference fringes in these three figures obtained from different submerging depths these interference fringes are caused by the reflection of soundwaves at the sea surface and seafloor the submerging depth of the shell influencing the distances to the sea surface and seafloor plays a role in the acoustic radiation field of the elastic shell 4 3 different sound velocity profiles we now discuss acoustic radiation fields with different sound velocity profiles the depth of seawater is 20 m and the submerging depth is 5 m the other conditions are the same as in section 4 1 the spl results at observation point 800 10 are shown in fig 13 we can intuitively see the differences in the spl results obtained from three sound velocity profiles at the observation point which change with the exciting frequency from fig 13 in the low frequency range less than 180 hz the results of the spl obtained with the three sound velocity profiles are almost the same even in the far field this demonstrates that the acoustic radiation field is insensitive to the sound velocity profiles in this range at 200 250 hz the minimal point of the positive velocity gradient appears at 230 hz and the minimal point of the other profiles appears at 238 hz the spl of the positive velocity gradient has an extreme point under 300 hz while the lines of the negative velocity gradient and negative thermocline velocity gradient are still decreasing at this frequency however all the lines for the three sound velocity profiles reach their maximal values at the resonance frequency in conclusion sound velocity profiles influence the positions of the extreme points except at the resonance frequency fig 14 shows distribution maps of spl at 800 1000 m with different sound velocity profiles when the exciting frequency is 250 hz the differences between the three sound speed profiles are extremely clear showing that the sound speed profile should be considered when we calculate acoustic radiation in the far field 5 conclusions we have proposed an integrated calculation method of fluid structure interaction vibration acoustic radiation and propagation from an elastic spherical shell in an ocean acoustic environment for arbitrary sound velocity profiles we have examined complicated sound velocity profiles considering a finite depth ocean and seafloor reflection loss the near and far field can still be analyzed as a unified system by our method in particular reliable results can be obtained even though the calculation range is huge to avoid the tedious calculations due to the complex form of the green function and to analyze the near and far field as a unified system we have proposed to calculate the green function differently in the near and far field which significantly simplifies calculations the virtual source method is used to calculate the acoustic radiation field in the near field which can simplify the derivation calculation while the normal method is used in the far field as a result the computational complexity is greatly reduced and the computational feasibility is significantly improved acoustic radiation fields of elastic spherical shells in different sound velocity profiles are calculated the results from our method and fem are in good agreement verifying the validity of this method the results show that 80 source points on the inner axis of a spherical shell are enough to achieve a high computational accuracy when compared with fem our method has obvious advantages in solving the radiation sound field of elastic spherical shells in complicated ocean acoustic environments the influence of sea surface seafloor and sound velocity profile on the acoustic radiation field of elastic structures in ocean acoustic environments is analyzed by quantitative calculation while intuitive distribution maps of spl are given the sea surface seafloor and sound velocity profiles have different degrees of influence on the acoustic radiation field of an elastic spherical shell the submerging depth and exciting frequency will affect the acoustic radiation characteristics of elastic structures in the lower frequency range the acoustic field is not so insensitive to sound velocity profiles whether in the near or far field at sufficiently low frequencies the effects can often by ignored in the higher frequency range interference fringes will be clearer in distribution maps because of the sea surface and seafloor when the exciting frequency equals the resonance frequency the submerging depth and sound velocity profiles have little influence on the acoustic field in subsequent research more reasonable methods of acoustic propagation can be adopted to overcome the influence of leaking waves so as to improve the accuracy of calculation although only a finite depth ocean is discussed in this paper as long as the green function is replaced according to the actual working conditions the acoustic radiation field of elastic structures in a more complicated ocean acoustic environment can be calculated using this idea acknowledgments this work was supported by national key research progress project of china 2017yfb0202701 and national natural science foundation of china 11772304 51709241 we thank letpub www letpub com for its linguistic assistance during the preparation of this manuscript appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 02 032 
22923,a modeling method based on the wave superposition method is studied in this paper different underwater acoustic propagation models are used in the near and far field taking the acoustic radiation field calculation of an elastic spherical shell as an example the near and far field can be analyzed as a unified system using this method many studies use fem bem finite element method boundary element method to calculate acoustic radiation fields of elastic structures but only a few of these methods can be applied when considering finite ocean depth seafloor reflection loss and sound velocity profile in this study the green function is calculated differently in the near and far field to significantly simplify calculations the virtual source method is used to calculate the acoustic radiation field in the near field and source strength while the normal mode method is used in the far field the results are compared with those obtained using the comsol finite element software which showed that this method was both computationally efficient and accurate based on numerical examples the influence of sea surface seafloor and sound velocity on the acoustic radiation field of elastic structures in an ocean acoustic environment is quantitatively analyzed keywords elastic spherical shell finite depth ocean fluid solid coupling acoustic radiation acoustic propagation wave superposition method 1 introduction the calculation methods of fluid structure interaction vibration acoustic radiation and propagation of structures have wide ranging engineering applications such as in the identification of radiation noise of ships and underwater vehicles however researchers have gone into the two different research directions of vibration and acoustic radiation of elastic structures in water and the propagation of soundwaves in ocean acoustic environments an efficient integrated computing method suitable for complicated ocean acoustic environments is urgently needed applied independently the two research directions are inadequate water is usually assumed to be an ideal acoustic medium and problems considering a sound velocity profile are difficult to resolve the other direction focuses on the propagation behavior of point sources and there has been little research on fluid structure interaction vibration acoustic radiation and acoustic propagation of elastic structures in fact the two directions are correlated and must be considered simultaneously since related theoretical and computational methods have been developed progress in calculation accuracy and efficiency by improving the method itself is inclined to decrease in this paper we propose an efficient integrated calculation method for fluid structure interaction vibration acoustic radiation and propagation in ocean acoustic environments the idea is to separately apply appropriate acoustic propagation models in the near and far fields this method can solve acoustic radiation problems in complicated ocean acoustic environments with sound velocity profiles since the 1960s a large amount of literature has been published to solve acoustic radiation and acoustic scattering of structures in the infinite water region using analytical methods diercks and hickling 1967 hickling 1964 skelton and james 1997 these studies provide an intuitive and clear physical model to understand the phenomena of vibration acoustic radiation and acoustic scattering of elastic structures in water however the analytical method has difficulty producing accurate calculation results in complicated ocean acoustic conditions some studies may solve the analytic solutions when a finite ocean depth seafloor reflection loss and sound velocity profile are all considered however these analytic solutions are very difficult or time consuming to solve particularly when complicated ocean environment is considered at present with the development of computer technology the numerical calculation method is widely used to analyze the vibration characteristics of engineering structures and resultant problems of acoustic radiation numerical simulation of vibration and acoustic characteristics of underwater elastic structures usually requires consideration of fluid structure interaction especially for thin elastic structures in engineering the fluid structure coupled vibration behavior of elastic structures is often analyzed using the finite element method fem because it is relatively flexible and suitable for larger models zienkiewicz and taylor 2005 for the study of acoustic radiation fields in waters although fem can be used to calculate acoustic radiation in infinite or semi infinite waters with some new techniques such as the perfect matching layer pml berenger 1994 darvish et al 2018 there are still some problems for example calculating far field acoustic propagation will require an extremely large number of calculations hence fem and the boundary element method bem have been among those preferred to solve problems of underwater vibration and acoustic characteristics everstine and henderson 1990 bem has been successfully applied to various engineering problems such as soundwaves fu et al 2014 yang et al 2015 and seismic waves lin et al 2018 the boundary integral method is much more efficient than fem when the problems solved over a large volume however the boundary integral has singularity and uniqueness at the characteristic frequency cannot be guaranteed improper handling can easily distort the calculation results at high frequencies chen et al 2016 investigated the structural acoustic radiation problem of cylindrical shell structures with complicated acoustic boundary conditions by the double reflection method and verified the method using fem bem the wave superposition method is another numerical method that is derived from the acoustic boundary integral equation based on the superposition principle of solid mechanics koopmann et al 1989 proposed a wave superposition method to calculate boundary integrals equivalently to determine the acoustic radiation field the wave superposition method s main feature is to locate several virtual simple source points source strengths of which are to be solved in the interior of the acoustic radiator the layout is flexible which can effectively avoid the singular integral problem miller et al 1991 wang and guo 2016 obtained the structural responses of a submerged stiffened submarine hull by the coupled precise transfer matrix method and wave superposition method zou et al 2013 2014a studied an acoustic radiation problem in a shallow sea and used acoustic elastic theory and a simple source method to analyze the acoustic radiation field of two three dimensional hull structures in the pekeris waveguide to deal with the irregular frequency problem in analysis zou et al 2018 used a closed virtual impedance surface cvis method most of the theory and applications in three dimensional sono elasticity have been summarized wu et al 2016 the theory of acoustic propagation in an ocean underwater acoustic environment is generally classified as computational ocean acoustics and there have been related achievements in the last half century in the wave superposition method several virtual simple sources such as point acoustic sources are placed in the interior of an acoustic radiator knowledge from computational ocean acoustics is needed to calculate the source strengths of these sources and the acoustic radiation field outside the acoustic radiator jensen et al 2011 provided a detailed summary of widely used models such as ray normal mode and parabola in computational ocean acoustics there have been many recent achievements in the field of acoustic propagation in water of finite depth wang et al 2015 discussed low frequency acoustic propagation which is independent of the distance in a shallow sea through simulation the influence of seawater and seafloor density on transmission loss was analyzed and an acoustic propagation model considering random environmental disturbance and rough sea surface was established sprague and luczkovich 2016 used the finite difference time domain fdtd to study the propagation of transient soundwaves in a very shallow sea and compared the computational efficiency of two coordinate systems the computation time required for cylindrical coordinates is short but they require axial symmetry three dimensional cartesian coordinates do not require symmetry and have high general applicability but computation is time consuming petrov and petrova 2016 used the modal expansion method to solve the problem of acoustic propagation in shallow seas the acoustic pressure field generated by the resonant point sources in a non uniform three dimensional waveguide was obtained parabolic equation theory was used to obtain the far field approximate expression of amplitude clark 2017 studied the horizontal propagation of soundwaves in unknown sea conditions wang et al 2017 researched a fast calculation method of acoustic propagation after multiple reflections on the sea surface and seafloor in a noisy environment the differences in fluid structure interaction vibration acoustic radiation and acoustic propagation in ocean acoustic environments and the boundary characteristics of the sea surface and seafloor can all affect the acoustic radiation field of elastic structures considering the calculation of fluid structure interaction vibration acoustic radiation and propagation in an ocean acoustic environment it is beneficial to directly study the quantitative laws of acoustic radiation fields of structures at the same time research on the acoustic radiation fields of elastic structures in acoustic environments considering sound velocity profiles is still lacking although fem can be used to calculate the results the computation time increases dramatically with the calculated range therefore the range that can be calculated is limited which leads to many restrictions on its use it is necessary to develop new calculation methods to reduce computational complexity and increase efficiency this paper s main innovation is to use the green function corresponding to the acoustic propagation model of a specific ocean acoustic environment to simplify calculations by calculating differently in the near and far field the virtual source method is used to calculate the source strength and acoustic radiation field in the near field which can simplify the calculation while the normal mode method is used in the far field this greatly reduces the computational complexity and improves the computational feasibility the radiation fields in the near and far field of the elastic spherical shell are calculated in the finite depth of four cases the uniform layer positive velocity gradient negative velocity gradient and negative thermocline velocity gradient to verify the method its results are compared with those of comsol fem software the influence of the sea surface seafloor and sound velocity profile on the acoustic radiation field of elastic structures in ocean acoustic environments is analyzed by quantitative calculation 2 fluid solid coupling equation and wave superposition method for elastic spherical shell a spherical coordinate system taking the elastic shell center as the origin and o z as the polar axis is considered as shown in fig 1 this elastic spherical shell immersed in water is affected by the outflow field in the spherical coordinate system the displacement components corresponding to the coordinates r θ and φ are respectively u r u θ and u φ because of its axial symmetry the vibration displacement in the direction of the spherical shell is 0 u φ 0 and u r r θ t and u θ r θ t are not relevant to φ if the excitation is also axisymmetric for convenience w and u are used to represent u r r θ t and u θ r θ t respectively in this paper we assume the waveguide interfaces are parallel to the x y plane analyzing the vibration of the elastic spherical shell according to its stress and strain the dynamic equation about w and u can be obtained as junger and feit 1986 follows 1 1 β 2 2 θ 2 cot θ θ ν cot 2 θ r 2 c p 2 2 t 2 u β 2 3 θ 3 β 2 cot θ 2 θ 2 1 ν β 2 ν cot 2 θ θ w r 2 ρ s h c p 2 f θ β 2 3 θ 3 2 β 2 cot θ 2 θ 2 1 ν 1 β 2 β 2 cot 2 θ θ cot θ β 2 2 ν cot 2 θ 1 ν u β 2 4 θ 4 2 β 2 cot θ 3 θ 3 β 2 1 ν cot 2 θ 2 θ 2 β 2 cot θ 2 ν cot 2 θ θ 2 1 ν r 2 c p 2 2 t 2 w r 2 ρ s h c p 2 p f r where r h and ρ s are respectively the radius thickness and volume density of the spherical shell ν is poisson s ratio β 2 h 2 12 r 2 represents the contribution of bending stress c p e 1 ν ρ s 1 2 ν 1 ν is the velocity of the longitudinal waves e is the young modulus p r θ t r r is the sound pressure of the outer flow field on the spherical shell and f r f θ are the external forces acting on the spherical shell in the radial and circumferential directions respectively we simplify eq 1 and change a function of time by fourier transform to the frequency domain through the following changes 2 η cos θ 3 η 2 d d η 1 η 2 d d η 4 ω 2 ω r c p 2 substituting the harmonic time factor e i ω t into eqs 2 4 where ω is the angular frequency eq 1 can be simplified to 5 l 11 u l 12 w ω 2 u r 2 ρ s h c p 2 f θ ω l 21 u l 22 w ω 2 w r 2 ρ s h c p 2 p r θ ω r r f r ω the forms of the differential operators in eq 5 are 6 l 11 1 β 2 1 η 2 d 2 d η 2 1 η 2 1 ν l 12 1 η 2 β 2 1 ν 1 ν d d η β 2 d d η η 2 l 21 β 2 1 ν 1 ν d 2 d η 2 1 η 2 β 2 η 2 d d η 1 η 2 l 22 β 2 η 4 β 2 1 ν η 2 2 1 ν for axisymmetric cases the radial and circumferential vibration displacements of the spherical shell can be expressed as junger and feit 1986 7 w θ n 0 w n p n η u θ n 0 u n 1 η 2 d p n η d η where p n η is a legendre polynomial and w n u n are unknown generalized coordinates if the center of the shell is at the origin of the spherical polar coordinate system and the r coordinate points outward from the center of the shell according to the compatibility condition of fluid structure coupling at a wetted surface the boundary condition between the spherical shell and outer flow field is 8 φ r r r i ω w where φ is the velocity potential of soundwaves the wave superposition method is used to solve the coupling effect between a spherical shell and outer flow field and acoustic radiation wsm is based on the idea that the acoustic field of a complex radiation body can be superimposed by a series of simple acoustic sources in the radiation body these simple acoustic sources establish a continuous distribution in the radiation body we place a cylinder in that radiation body and the radius tends to 0 r 0 the simple acoustic sources are continuously distributed in the cylinder because the cylinder is included in the original radiation body there is no singularity problem using discrete points to replace continuous simple sources and distributing the source points on the z axis and field points on the perimeter of the spherical shell the radius of the ball is r as shown in fig 2 the number of field points and source points are both n j the x and y coordinates of the source points are 0 and the z coordinate of the n j th n j 1 2 n j point is 9 z n j 0 r 1 2 n j 1 n j the x and z coordinates of the n j th field point are 10 x n j r sin n j 0 5 π n j 11 z n j r cos n j 0 5 π n j the kind of distribution of source points and field points is served as an example and other arrangements can also be used if these source points are axisymmetric about the z axis in wsm wave superposition method these strength of source points are solved by boundary condition of dynamic response excited by external force each strength of source points includes information of magnitude and phase because strength is expressed in complex number based on the wave superposition method the velocity potential of soundwaves in the outer flow field caused by the n th mode of the spherical shell is 12 φ n r n j 1 n j q n j r 0 g r r 0 where q n j r 0 is the unknown source strength of the n th source point r denotes position vectors of field points and r 0 denotes position vectors of source points according to eqs 8 and 12 and the orthogonality of legendre polynomials an equation can be obtained from the boundary conditions as 13 i ω p n η n j 1 n j q n j r 0 g r r 0 n r where r is on the surface of the spherical shell and g r r 0 n r represents the normal partial derivative of the green function at the outer surface of the spherical shell the source strength can be solved by eq 13 the computational efficiency depends on the form of the green function therefore different green functions are necessary in the near and far fields to improve computational efficiency if a green function is obtained by the virtual source method its form will be an analytical formula which is convenient to obtain values of g r r 0 n r the virtual source method is used to calculate the acoustic radiation field in the near field and the source strength while the normal mode method is used in the far field the details are described below the velocity potential of the outer flow field can be linearly superposed by velocity potential caused by vibration of different modal orders of the spherical shell 14 φ r n 0 w n φ n r n 0 w n n j 1 n j q n j r 0 g r r 0 the relationship between velocity potential and sound pressure at the outflow field is 15 p r i ω ρ 0 φ r where ρ 0 is the density of seawater at the location of the spherical shell the sound pressure acting on the spherical shell takes the form of a legendre polynomial expansion as 16 p r n 0 w n m 1 a m n p m η then the undetermined coefficient a m n can be obtained by eqs 12 and 14 16 and the orthogonality of the legendre polynomials as 17 a m n 2 m 1 2 i ω ρ 0 π n j n j 1 n j φ n r p m η sin n j 0 5 π n j for the n j th field point η cos n j 0 5 π n j substituting eq 7 and 16 into eq 5 and using the orthogonality of legendre polynomials the fluid structure coupling dynamic equation can be stated as 18 l 11 n u n l 12 n w n r 2 ρ s h c p 2 f θ n l 21 n u n l 22 n w n m 0 b n m w m r 2 ρ s h c p 2 f r n where l 11 n ω 2 1 β 2 ν λ n 1 l 12 n β 2 ν λ n 1 1 ν l 21 n λ n β 2 ν λ n 1 1 ν l 22 n ω 2 2 1 ν β 2 λ n ν λ n 1 λ n n n 1 and b n m a n m r 2 ρ s h c p 2 f θ n and f r n are the external forces in generalized coordinates in form of u n and w n acting on the spherical shell in the radial and circumferential directions respectively and f n 2 n 1 2 1 1 f n η p n η d η junger and feit 1986 if the external force acts on θ π bottom of the shell and is a unit nodal force in the radial direction then f r δ θ π 2 π r 2 sin θ where δ is the dirac function and the components of f n in eq 18 are f θ n 0 and f r n 2 n 1 2 p n 1 2 π r 2 considering up to the n th mode the matrix equation is 19 l 110 l 120 l 210 l 220 b 0 n 0 0 0 b n 0 0 0 0 l 11 n l 12 n l 21 n l 22 n u 0 w 0 u n w n 0 r 2 ρ s h c p 2 1 2 p n 1 2 π r 2 0 r 2 ρ s h c p 2 2 n 1 2 p n 1 2 π r 2 after solving the generalized coordinate response w n by the matrix equation the sound pressure of the outer flow field can be obtained by substituting it into eq 16 3 calculation of the green function 3 1 virtual source method the source strengths of a virtual source are solved by eq 13 and g r r 0 n r is necessary in the process when considering the virtual source method to obtain the green function this analytical green function facilitates the efficient calculation of g r r 0 n r in recent work zou et al 2014a zou 2014b the virtual source method was used in a pekeris waveguide to obtain source strengths of simple sources with the simple source method this corresponds to the continuous reflection of a soundwave on the seafloor and sea surface the acoustic reflection coefficient of the sea surface is generally taken as 1 reflection and refraction of plane waves occurs at the seafloor and the acoustic reflection coefficient in two actual sea conditions zou 2014b 20 v α cos θ β 2 sin 2 θ α cos θ β 2 sin 2 θ 1 sin θ β sin θ β has been studied where θ is the incident angle α ρ 1 ρ 0 β c 0 c 1 ρ 0 is the density of the seawater ρ 1 is the density of the seafloor sediment and c 0 c 1 are the velocity of sound in seawater and sediment respectively the parameters of the two sea conditions are shown in table 1 the reflection coefficient of plane waves at different angles is calculated using eq 20 as shown in fig 3 from fig 3 we can conclude that when the incident angle θ is in the range of 0 50 the acoustic reflection coefficient is approximately a constant and generally in range of 0 1 0 6 in our calculations we must calculate the reflection coefficient v by considering the acoustic environment parameters and θ 0 the sound propagation can be regarded as a mirrored imaginary virtual source chain which is constantly reflected on the sea surface and seafloor as shown in fig 4 a when soundwaves from a point source are transmitted through a single reflection to a field point and the incident angle is less than 50 the incident angle through multiple reflection will be also less than 50 the green function is 21 g r n 0 v n e i k r n 1 r n 1 v e i k r n 2 r n 2 e i k r n 3 r n 3 v e i k r n 4 r n 4 where r n 1 r 2 2 n h z z 0 2 r n 2 r 2 2 n h 2 h 2 z z 0 2 r n 3 r 2 2 n h 2 h 1 z z 0 2 r n 4 r 2 2 n 1 h z z 0 2 n is the order number of virtual sources series so that different paths including in this green function is 4n r is the horizontal distance of the sound source to the receiving point h is the depth of seawater and h 1 and h 2 are distances between the sound source to the sea surface and seafloor respectively in conclusion the virtual source method is applicable when r 2 h 2 z 0 z tan 50 1 19 which can be derived from θ 0 50 in the following paragraph we will explain how the condition come from as a prerequisite we can simply derive that the incident angle for a single reflection path is less than that for a multiple reflection path therefore if the incident angle for a single reflection is less than 50 all the incident angles for multiple reflection will be less than 50 the condition incident angle for a single reflection is less than 50 is equal to r h tan 50 where h 2 h 2 z 0 z and the geometrical relations are shown in fig 4 b so that the applicable condition is r 2 h 2 z 0 z 1 19 it is qualitatively understandable that the acoustic radiation field of structures in the near field is not sensitive to the sound velocity profile of the seawater therefore in the near field the sound propagation characteristics of a point sound source in the positive velocity gradient negative velocity gradient and negative thermocline velocity gradient can be seen to be similar to those in a uniform layer and although the multiple scattering is somewhat important in near field we use a simplified model to not consider multiple scattering neglecting in addition the following calculation results prove that these simplifications have little influence on accuracy thus eq 21 can be used to calculate the green function not just in a uniform layer but for a more complicated sound velocity profile the form of the green function is an analytical formula which is convenient for obtaining values of g r r 0 n r substituting g r r 0 n r in eq 13 the source strengths of the virtual points in an acoustic radiator can be solved in the near field a simple model is adopted so that the green function is a simpler analytical formula that avoids complex derivation calculations and does not affect the accuracy of the result if we also find a suitable model in the far field to express the green function then we can analyze the near and far field as a unified system 3 2 normal mode method in the far field we must obtain a model suitable for far field propagation of a point source which is the corresponding green function then superposing the acoustic field of each point source the acoustic radiation field in the far field can be obtained the normal mode method can handle problems in more complicated sound velocity profiles and it guarantees the accuracy of calculation in this paper we concretely adopt the finite difference method with high efficiency according to the current derivation and conclusion jensen et al 2011 using a finite difference in the depth direction of seawater and boundary conditions of seawater and seafloor sediments the algebraic eigenvalue problem is simplified to 22 az h 2 k r 2 z where a is the characteristic matrix related to the sound velocity profile and boundary conditions z is a column vector composed of characteristic functions on finite difference grid points h is the depth of each grid and k r is the transverse wave number the above eigenvalue problem is solved by bisection search and the corresponding eigenfunctions are obtained by the inverse interaction method jensen et al 2011 the obtained eigenvalues and corresponding normalized eigenfunctions are substituted in the equation jensen et al 2011 23 p r z i 4 ρ 0 z m z s z m z h 0 1 k r m r where z m is the eigenfunction the elements of z k r m is the corresponding eigenvalue z s is the z coordinate of the corresponding source r z is the coordinate of the point to be sought and h 0 1 is the zero order hankel function of first kind then the green function corresponding to the acoustic propagation of a point source in the far field can be obtained in the calculation the leaky wave is not considered for improving the computational efficiency so this method will cause deviation if used in the near field therefore the virtual source and normal mode methods are complementary in the near and far field according to the general understanding of this problem beyond a distance which can be seen as the far field the complex root part complex root is corresponding to leaky wave have little effect on the results in other words it is appropriate to consider only normal modes corresponding to the real roots beyond that distance porter 1992 stated that it is accurate enough if the distance between the source point and observation point is over 10 times the depth of ocean water the accuracy in the transition region between the near and far field can be improved by considering the complex root part and leaky wave part 4 calculation verification and analysis of a spherical shell 4 1 comparison verification in a finite depth of water external force acts on θ π bottom of the shell and there is a unit nodal force in the radial direction as described in section 2 the results will be compared with those from comsol finite element software to verify the correctness of the described method the depth of seawater is 20 m and the density of seawater is 1 025 kg m 3 the depth of the elastic spherical shell is 5 m the radius is 0 5 m and the thickness is 0 0009 m the material of the shell is steel the young modulus of elasticity is 2 1 10 11 n m 2 the poisson s ratio is 0 3 and the density of the material is 7800 kg m 3 the structural damping factor of the shell is 0 002 four kinds of sound velocity profiles in seawater are considered these are the uniform layer positive velocity gradient negative velocity gradient and negative thermocline velocity gradient in the case of a uniform layer the sound velocity in seawater is 1510 m s the sound velocity profiles for other cases in seawater are presented in fig 5 the density of sediment is 2600 kg m 3 and the sound velocity in sediment is 1620 m s the unit nodal force at θ π is a normal harmonic concentrated exciting force acting at the point of the bottom of the spherical shell and the amplitude of the force is 1 n distributions of source and field points are shown in fig 2 of the second chapter in the wave superposition method n j 80 source points are on the z axis and field points are on the surface of the spherical shell the radiated sound pressure in a uniform layer positive velocity gradient negative velocity gradient and negative thermocline velocity gradient are calculated by two methods the sound pressure levels spls calculated by these methods are compared the relation between the sound pressure and sound pressure level is 24 spl 20 log 10 p p r e f db where p r e f 10 6 pa in the near field the depth of the observation point is 5 m and the horizontal distance between the observation point and shell is 2 m which satisfies r 2 h 2 z 0 z tan 50 1 19 all the sound velocity profiles are simplified to a uniform layer because the acoustic radiation field of structures in the near field is not sensitive to the sound velocity profile of the seawater in calculating the green function in the near field by the method described above the results in four sound velocity profiles will be totally the same while the result obtained by comsol will be calculated in a negative velocity gradient the results will be compared in order to see whether we can simplify sound velocity profiles to a uniform layer in the near field by the proposed method the acoustic reflection coefficient is solved by eq 20 and v 0 4626 comsol employs an axisymmetric two dimensional model the largest mesh in seawater is 0 5 m less than 1 6 of the wavelength and is smaller in the near field of the shell inside the shell a mesh size is chosen to be 1 30 of the shell diameter perfectly matched layers pmls are used at the boundary to simulate the semi infinite space the comsol model is shown in fig 6 the spl results at observation point 2 5 are compared in fig 7 where the exciting frequency range is 50 hz 300 hz from fig 7 we know that the lines obtained from the wave superposition method and fem negative velocity gradient is considered are nearly the same on the one hand it shows that the computational accuracy of this method in the near field is guaranteed on the other hand the acoustic radiation field in the near field is basically uninfluenced by the sound velocity profiles the low frequency acoustic propagation in shallow water is not independent of distance however at sufficiently low frequencies these effects become minimal and can often by ignored therefore using the integrated method described in this paper to calculate the radiated sound field will greatly increase computational efficiency in the far field the depth of the observation point is 15 m and the horizontal distance between the observation point and shell is 1000 m which satisfies 10 times the depth the spl excited by the vibrational elastic spherical shell at the observation point in four kinds of sound velocity profiles is calculated the acoustic reflection coefficient v is 0 4626 the horizontal distance is 1000 m because the amount of calculation is too large for pcs if the observation point is far from the shell this is a limitation of fem itself employing analysis by the wave superposition method and fem the spl results at observation point 1000 15 are obtained by the two methods and compared in fig 8 where the exciting frequency range is 50 hz 300 hz the solid lines are from the method of this paper and the dotted lines are from comsol from fig 8 we know that the groups of lines are approximately coincident there is still deviation in some positions because we consider only unattenuated normal waves real roots in calculation of the green function in fact the attenuated normal waves other complex roots still cannot be completely ignored at this distance and the computational accuracy is still slightly affected from fig 8 when the exciting frequency is less than 52 hz the sound pressure at the observation point is 0 neglecting numerical error this reflects the cutoff effect of the acoustic propagation jensen et al 2011 and the cutoff frequency is near 52 hz the resonance peaks appear near 290 hz showing that the frequency range is enough to reflect the acoustic radiation characteristics of the elastic spherical shell although comsol can draw the distribution maps by itself to avoid different color tables from two kinds of software to influence the color of the distribution maps the same figure will look quite different when drawn by comsol and matlab because of the different color tables used by the two applications the following distribution maps will all be drawn by matlab for example consider the near field when the exciting frequency is 100 hz and the depth of the shell is 5 m the other conditions are the same as above distribution maps of spl at 0 50 m are shown in fig 9 demonstrating that the distribution map obtained from our method is similar to that from comsol for example the thermocline velocity gradient is shown in fig 5 c for the far field when the exciting frequency is 200 hz and the sound velocity profile is negative the depth of the shell is 5 m the other conditions are the same as above fig 10 shows distribution maps of spl at 800 1000 m from which we know that the distribution decreases from the position near the source to far from the source the distribution map in the far field obtained by our method is also similar to that from comsol 4 2 different submerging depths in a negative thermocline velocity gradient we shall now discuss different shell depths or submerging depths using the example of a negative thermocline velocity gradient the depth of seawater is 20 m we consider submerging depths of 5 m 10 m and 15 m the other conditions are the same as in section 4 1 the spl results at the observation point 1 000 15 are shown in fig 11 there are two conclusions from fig 11 first the spl lines from different submerging depths are different because both the direct part and reflection influence the results and the submerging depth has a large influence on the reflection part second at the resonance frequency the spl results from different submerging depths are almost the same i e submerging depths have little influence on results at the resonance frequency when resonance occurs the direct part has a leading influence on results and the scales of submerging depths are small compared to the horizontal distance for different submerging depths for example in the near field 0 50 m with an exciting frequency of 300 hz the distribution maps of spl are shown in fig 12 we can see the different shapes of interference fringes in these three figures obtained from different submerging depths these interference fringes are caused by the reflection of soundwaves at the sea surface and seafloor the submerging depth of the shell influencing the distances to the sea surface and seafloor plays a role in the acoustic radiation field of the elastic shell 4 3 different sound velocity profiles we now discuss acoustic radiation fields with different sound velocity profiles the depth of seawater is 20 m and the submerging depth is 5 m the other conditions are the same as in section 4 1 the spl results at observation point 800 10 are shown in fig 13 we can intuitively see the differences in the spl results obtained from three sound velocity profiles at the observation point which change with the exciting frequency from fig 13 in the low frequency range less than 180 hz the results of the spl obtained with the three sound velocity profiles are almost the same even in the far field this demonstrates that the acoustic radiation field is insensitive to the sound velocity profiles in this range at 200 250 hz the minimal point of the positive velocity gradient appears at 230 hz and the minimal point of the other profiles appears at 238 hz the spl of the positive velocity gradient has an extreme point under 300 hz while the lines of the negative velocity gradient and negative thermocline velocity gradient are still decreasing at this frequency however all the lines for the three sound velocity profiles reach their maximal values at the resonance frequency in conclusion sound velocity profiles influence the positions of the extreme points except at the resonance frequency fig 14 shows distribution maps of spl at 800 1000 m with different sound velocity profiles when the exciting frequency is 250 hz the differences between the three sound speed profiles are extremely clear showing that the sound speed profile should be considered when we calculate acoustic radiation in the far field 5 conclusions we have proposed an integrated calculation method of fluid structure interaction vibration acoustic radiation and propagation from an elastic spherical shell in an ocean acoustic environment for arbitrary sound velocity profiles we have examined complicated sound velocity profiles considering a finite depth ocean and seafloor reflection loss the near and far field can still be analyzed as a unified system by our method in particular reliable results can be obtained even though the calculation range is huge to avoid the tedious calculations due to the complex form of the green function and to analyze the near and far field as a unified system we have proposed to calculate the green function differently in the near and far field which significantly simplifies calculations the virtual source method is used to calculate the acoustic radiation field in the near field which can simplify the derivation calculation while the normal method is used in the far field as a result the computational complexity is greatly reduced and the computational feasibility is significantly improved acoustic radiation fields of elastic spherical shells in different sound velocity profiles are calculated the results from our method and fem are in good agreement verifying the validity of this method the results show that 80 source points on the inner axis of a spherical shell are enough to achieve a high computational accuracy when compared with fem our method has obvious advantages in solving the radiation sound field of elastic spherical shells in complicated ocean acoustic environments the influence of sea surface seafloor and sound velocity profile on the acoustic radiation field of elastic structures in ocean acoustic environments is analyzed by quantitative calculation while intuitive distribution maps of spl are given the sea surface seafloor and sound velocity profiles have different degrees of influence on the acoustic radiation field of an elastic spherical shell the submerging depth and exciting frequency will affect the acoustic radiation characteristics of elastic structures in the lower frequency range the acoustic field is not so insensitive to sound velocity profiles whether in the near or far field at sufficiently low frequencies the effects can often by ignored in the higher frequency range interference fringes will be clearer in distribution maps because of the sea surface and seafloor when the exciting frequency equals the resonance frequency the submerging depth and sound velocity profiles have little influence on the acoustic field in subsequent research more reasonable methods of acoustic propagation can be adopted to overcome the influence of leaking waves so as to improve the accuracy of calculation although only a finite depth ocean is discussed in this paper as long as the green function is replaced according to the actual working conditions the acoustic radiation field of elastic structures in a more complicated ocean acoustic environment can be calculated using this idea acknowledgments this work was supported by national key research progress project of china 2017yfb0202701 and national natural science foundation of china 11772304 51709241 we thank letpub www letpub com for its linguistic assistance during the preparation of this manuscript appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 02 032 
22924,to solve the auto berthing control problem for underactuated marine ships subject to unknown dynamics and external disturbances under the circumstance of the restricted waters in port firstly an additional control method is adopted to solve the underacruated problem secondly a robust neural network nn adaptive approach based on the navigation dynamic deep rooted information dri is proposed to reconstruct the lumped uncertainties caused by unknown ship dynamics and external disturbances meanwhile the dynamic surface control dsc and the minimum learning parameter mlp techniques are used to reduce the computational load of the adaptive nn control scheme considering the input saturation effects of control actuator rudder propeller etc and the coupling characteristics of uncertainties this approach integrates neural network weights approximation errors and external disturbance term as the composite uncertain parameters which is estimated online by parameter adaptive technique finally simulations are carried out on an underactuated model ship to verify the effectiveness of the proposed auto berthing control scheme keywords underactuated marine ship auto berthing neural network deep rooted information 1 introduction with the development of intelligent merchant ships more and more attentions have been paid to the research of auto berthing control which is one of the intelligent techniques of marine ships the research of auto berthing control began in the early 1990s the main challenge for achieving the auto berthing control of marine ships focuses on the underactuated characteristics among which only surge force and yaw moment are available in such ships whereas there are three degrees of freedom yaw sway and surge direction padideh et al 2016 it is also well known that the marine ships in the automatic berthing mode are a class of underactuated mechanical systems with nonintegrable dynamics which is not transformable into a driftless system zhang 2015 rødseth 2017 since the auto berthing problem involves the low velocity motion of ships in shallow water the more information needs to be involved the maneuverability of the marine ships will deteriorate making the control problem more challenging zhang 2012 zhang et al 2017 thus it is necessary to conduct further researches on the auto berthing control for the ships with unknown ship dynamics and external disturbances in the restricted waters since artificial neural networks ann consists of several interconnected simple nonlinear systems that are typically modeled by the transfer function it has the capability to replicate human brains and perform the same action that a human brain does in any particular situation ahmed 2015 thus the neural network can be used to solve the problems of auto berthing control inspired by the unique features of the ann this paper employs the ann to design the auto berthing controller for the first time in yamato et al 1990 further a parallel auto berthing ann control scheme combined with the expert system was proposed in hasegawa et al 1993 and im et al 2001 to replace the previous single control scheme to control the rudder angle and the propeller respectively besides a motion recognition method using ann to detect the transverse velocity and turning angular velocity of the ship was proposed to achieve auto berthing in the direction of parallel wind directions see im and hasegawa 2002 note that the focus of the studies was on the sample data generated by human experience and standard operation schemes but the consistency of the two schemes is difficult to be guaranteed meanwhile some designs lack versatility such as the design of virtual navigation lines there was not such a line in the ship berthing practice in im et al 2007 to improve the applicability of the auto berthing algorithm to certain ports im et al 2007 proposed the selective auto berthing controller that is the berthing waters were divided into several partitions and different control strategies were used in different regions the control strategies aforementioned do not take into account the problem of sample data consistency for that mizuno et al 2007 proposed the ann nonlinear programming method based on minimum time manipulation to solve the problem of marine ship maneuvering under equality and inequality constraints whereafter this method was used to solve the consistency problem of sample data xu and hasegawa 2012 however this method has many constraints and is prone to rudder angle jitter to solve the issue ahmed and hasegawa designed auto berthing controllers combining nn technique with virtual window theory nonlinear programming and pd control algorithm whose effectiveness was shown adopting a self propelled modules in ahmed et al 2013 ahmed et al 2012 and ahmed et al 2015 it should be pointed out that the proposed control strategy still needs to employ a virtual berthing navigation line to achieve auto berthing control in addition the nn used in these methods needs offline training which is hard to satisfy the real time requirement of the auto berthing practice in order to increase the applicability of nn controller for auto berthing a nn controller by using the head up coordinate system is proposed to automatically control the ship into the berth in different ports without retraining the nn structure im and nguyen 2018 the aforementioned studies still have less consideration of the problem of the dynamic uncertainty and the unknown disturbances of the underactuated marine ship caused by shallow water low velocity quay wall effects and relatively enhanced wind flow etc the adaptive nn technique which can be used to train the online parameters is a powerful method employed to solve this problem by using the unsupervised learning mode nguyen and jung 2007 used the adaptive ann controller online training instead of off line training to train the control signal of the rudder and the propeller respectively liu 2010 designed an adaptive nn controller which partially solved the auto berthing control by the path following method with ship model uncertainty and external disturbances for the underactuated ship motivated by the above mentioned observations this paper develops an adaptive nn auto berthing control method for underactuated marine ship with dynamic uncertainty and external disturbances which is based on the novel deep rooted information dri song 2015 and performed by using the additional control method do 2010 dynamic surface control dsc and the minimum learning parameter mlp techniques the main contributions of this paper can be summarized as follows 1 a novel auto berthing control scheme is proposed for underactuated marine ships subject to unknown dynamics and external disturbances using dri additional control method adaptive nn with mlp technique and dsc techniques to the best of the authors knowledge there were few similar results in existing literature 2 our proposed control law is inexpensive in calculated load and simple in constitution specifically only 4 unknown parameters need to be updated online even if the nn technique is involved 3 the simulations of auto berthing control are carried out by using turn around way which is useful for engineering practice that is critical and important to verify the robustness of the proposed control few results have used this experimental method the rest of this paper is organized as follows in section 2 problem description and ship mathematical model are given section 3 is devoted to coordinate transformations additional control for the underactuated ship in section 4 based on adaptive nn and dri the controller is designed in section 5 the numerical simulations are given to illustrate the effectiveness of the proposed approach section 6 contains the conclusions 2 problem description to facilitate the design of the auto berthing controller for the underactuated ship the nonlinear dynamic equation of the 3 dof u v and r plane motion is used as shown in 1 this model based on the maneuvering modeling group mmg modeling concept is employed to describe the motion characteristics of the general marine ship in jia 1999 1 m m x u m m y v r x h x p x r m m y v m m x u r y h y p y r i z z j z z r n h n p n r where m m x m y i zz and j zz are ship mass added mass inertia moment and additional inertia moment respectively x y n are the external forces and moments in different directions of the body fixed frame respectively u v r are the ship s surge sway and yaw velocities variables u v r t subscript h p and r are bare hull propeller and rudder respectively under the interference of external environment the system state of 1 can be transformed into fossen 2011 2 x u cos ψ v sin ψ y u sin ψ v cos ψ ψ r u m v m u v r f u υ m u t u m u d u v m u m v u r f v υ m v d v r m u m v m r u v f r υ m r t r m r d r where the high order fluid dynamics items are 3 f u υ x u u u u x v r v r x v v v 2 x r r r 2 f v υ y v v y r r y v v v v y r r r r y v v r v 2 r y v r r v r 2 f r υ n v v n r r n v v v v n r r r r n v v r v 2 r n v r r v r 2 where t u and t r are the control inputs the surge force and yaw moment m u m m x m v m m y m r i z j z x y ψ are the variables of the ship s position coordinates and heading angle and υ u v r t denotes the velocity vector in the body fixed frame d u d v and d r represent the unpredictable unknown external environment disturbances force torque vector in the 3 dof plane induced by wind waves and sea current effects the longitudinal viscous hydrodynamic factors x u u x vv x vr and x rr the linear viscous hydrodynamic factors y v y r n v and n r the nonlinear viscous hydrodynamic factors y v v y r r y vvr y vrr n v v n r r n vvr and n vrr are determined by the kijima empirical formulas in zhang 2015 however sometimes it is difficult to obtain the accurate ship parameters when a ship is berthing at a slow speed then in this paper let the model parameters m x m y m r x u u u u x v r v r x v v v 2 x r r r 2 y v v y r r y v v v v y r r r r y v v r v 2 r y v r r v r 2 and n v v n r r n v v v v n r r r r n v v r v 2 r n v r r v r 2 be all unknown in the ship berthing practice we set the actual berthing system is controllable under the disturbance of the external environment therefore the following assumptions are made based on the berthing characteristics of the conventional merchant ships assumption 1 1 f i υ and m i i u v r are unknown 2 the external disturbances d i i u v r are unknown yet bounded that is there exist unknown positive constants d u d v and d r satisfying d u d u d v d v and d r d r due to its excellent approximation performance in the field of control engineering the radial basis function neural network rbfnn is often used to deal with nonlinear equations in the model what is more its linear nature of weights can make the learning algorithm relatively simple in this paper the rbfnn is used to approximate nonlinear smooth functions the rbfnn is usually composed of hidden layer and output layer of which the hidden layer is to map the input space to a new space and the output layer is a linear combination of new space see cui 2016 let the unknown smooth function vector be denoted as w t s x x ω r n is the network input according to the universal approximation theorem wang et al 2005 if the number of network nodes is sufficiently large the continuous function defined on a tight set w t s x can be approached with arbitrary precision therefore we can use rbfnn to approximate a smooth continuous function zhu et al 2018 4 f x w t s x where f x r n r w w 1 w 2 w l t r l l 1 are nn nodes the rbf vector s x s 1 x s 2 x s l x t r n represents the activation function s i x i 1 2 n usually uses a gaussian function as shown in 5 5 s i x exp x μ i t x μ i η i 2 where μ i μ i μ i μ i t represents the function center value η i represents gaussian function width lemma 1 chen 2010 a tight set ω r n is defined for any given smooth continuous function 6 h x w t s x ε x ω where ε is the approximate error ε 0 for x ω ε ε w is an ideal approximation weight vector usually the ideal nn weight vector w is an unknown vector and needs to be estimated it can be understood that we can get the w when ε is minimized in x ω r n then 7 w arg min w r l sup x ω h x w t s x assumption 2 in a compact set ω x r n the weight w of rbfnn are bounded that is w w m with w m being a positive constant 3 coordinate transformations to solve the mismatch problem of lateral drive vector for the underactuated ship a lateral drive vector α is constructed through coordinate transformation and additional control parameter design here we call α an additional control do 2010 8 ω r ψ d x y r ψ e f 1 α f 2 α ω d r ψ d x d y d ψ e ψ ψ d f 3 α ω e ω ω d where r cos sin sin cos represents the rotational matrix function from the geographic coordinates to the ship coordinates f i α i 1 2 3 is differentiable functions of α such that f i α λ i for all α r with λ i being a positive constant let γ e x x d y y d according to 8 we can get 9 γ e r 1 ψ d ω e r ψ e f 1 α f 2 α ψ ψ d ψ e f 3 α from 9 the following inequalities hold 10 γ e ω e f 1 α f 2 α ψ ψ d ψ e f 3 α due to f i α λ i the function f i α is bounded for all α r which means that we just need to design control laws t u and t r such that ψ e and ω e are able to converge to zero meanwhile the ship velocities u v r are bounded then the control objective is solved differentiating both sides of 8 we get 11 ω e r ψ d x y r ψ d x y r ψ e f 1 α f 2 α r ψ e f 1 α α f 2 α α ω d r ψ d x y r ψ d cos ψ sin ψ r ψ e f 1 α f 2 α u α r ψ d v sin ψ v cos ψ r ψ e f 1 α f 2 α ψ e ω d then 12 ω e θ u α λ 1 λ 2 ψ e ω d ψ e r ψ d f 3 α α θ r ψ d cos ψ sin ψ r ψ e f 1 α f 2 α λ 1 r ψ d x y r ψ d v sin ψ v cos ψ λ 2 r ψ e f 1 α f 2 α where f 1 α f 1 α α i 1 2 and r sin cos cos sin to be prepared for the control design in section 4 we now specify the functions f i α i 1 2 3 such that they are bounded differentiable and make the matrix θ invertible expanding the first equation of 12 then 13 θ cos ψ ψ d cos ψ e f 1 α sin ψ e f 2 α sin ψ ψ d sin ψ e f 1 α cos ψ e f 2 α recalling 8 and 13 yields 14 det θ sin f 3 α f 1 α cos f 3 α f 2 α to ensure the det θ nonzero for all α we design the functions f i α i 1 2 3 as 15 f 1 α ω 1 sin α sin f 3 α f 3 α f 2 α ω 1 sin α 1 cos f 3 α f 3 α f 3 α ω 2 cos α where ω 1 and ω 2 are the design parameters satisfying ω 1 0 and ω 2 0 π 2 according to the 15 we have f 1 α ω 1 f 2 α ω 1 f 3 α ω 2 substituting 15 into 14 yields 16 det θ ω 1 ω 2 1 tan 2 α 1 cos f 3 α based on the above analysis the inverse matrix of the θ to be used in the next section as follows 17 θ 1 1 det θ sin ψ e f 1 α cos ψ e f 2 α cos ψ e f 1 α sin ψ e f 2 α sin ψ ψ d cos ψ ψ d 4 control design the application of nn based on dri to reconstruct uncertain modal dynamics and unknown disturbances and the introduction of dsc techniques and mlp reduce the computational load the details are as follows step 1 the following lyapunov function candidate can be chosen 18 v 1 1 2 ω e t ω e 1 2 ψ e 2 taking the time derivative of v 1 and using 12 one can get 19 v 1 ω e t ω e ψ e ψ e ω e t θ u α λ 1 λ 2 ψ e ω d ψ e r φ d f 3 α α we choose the following virtual control law for u and r 20 α u α θ 1 k u ω e λ 1 ω d α r k r ψ e ψ d f 3 α α where k u is a positive definite symmetric matrix and k r is a positive constant here dsc technology is used to avoid the computational load caused by derivation let the virtual control laws pass through the first order filter as follows 21 e β u β u α u e β r β r α r where β u and β r are the state of the first order filter and e is the time constant define the errors u e u β u r e r β r y u β u α u y r β r α r and then substituting error variables u e r e y u and y r into 19 yields 22 v 1 ω e t θ u e y u α u α λ 1 λ 2 ψ e ω d ψ e r e y r α r ψ d f 3 α α ω e t θ u e y u 0 k u ω e λ 2 ψ e ψ e r e y r k ψ r ω e t θ u e y u 0 ω e t k u ω e k ψ r ω e t λ 2 r ψ d f 3 α α ψ e r e y r substituting 20 into 22 one can obtain 23 v 1 ω e t θ u e y u 0 ω e t k u ω e k r ψ e 2 ω e t λ 2 r k r ψ e α r ψ e r e y r from the definition r e r β r and y r β r α r we can get r α r r e y r and then substituting it into 23 yields 24 v 1 ω e t θ u e y u 0 ω e t k u ω e k r ψ e 2 ω e t λ 2 r e y r k r ψ e ψ e r e y r ω e t k u ω e k r ψ e 2 ω e t θ u e y u 0 k r λ 2 ψ e ψ e ω e t λ 2 r e y r step 2 differentiating the u e u β u and r e r β r then substituting them into 2 results in 25 u e m v m u v r f u υ m u t n m u d u β u r e m u m v m r u v f r υ m r t r m r d r β r let h u υ m v m u v r f u υ m u and h r υ m u m v m r u v f r υ m r they cannot be directly employed for the control design since m u m v m r f u υ and f r υ are unknown from assumption 1 therefore in view of lemma 1 two rbfnns are used to approximate the unknown nonlinear functions h u υ and h r υ as follows 26 h u υ w 1 t ϑ 1 υ ε 1 h r υ w 2 t ϑ 2 υ ε 2 where w 1 and w 2 are the nn weight matrix ϑ 1 υ and ϑ 2 υ are nn basic functions ε 1 and ε 2 are the nn errors respectively substituting 26 into 25 gives 27 u e w 1 t ϑ 1 υ ε 1 t u m u d u β u r e w 2 t ϑ 2 υ ε 2 t r m r d r β r according to 27 we choose the control laws as follows 28 t u λ ˆ χ χ k 1 u e a 1 u e θ ˆ φ 1 2 υ β u t r ω ˆ δ δ k 2 r e a 2 r e θ ˆ 2 φ 2 2 υ β r θ ˆ 1 a 1 φ 1 2 υ u e 2 δ 1 θ ˆ 1 θ ˆ 2 a 2 φ 2 2 υ r e 2 δ 2 θ ˆ 2 λ ˆ b 1 χ u e b 1 λ ˆ ω ˆ b 2 δ r e b 2 ω ˆ where δ 1 δ 2 a 1 a 2 b 1 b 2 b 1 and b 2 are all positive design constants construct the following lyapunov function candidate 29 v 2 v 1 1 2 u e 2 1 2 r e 2 1 2 y u 2 1 2 y r 2 1 2 θ 1 2 θ 2 2 1 2 b 1 m u λ 2 1 2 b 2 m r ω 2 where θ i θ i θ ˆ i i 1 2 λ m u λ ˆ and ω m r ω ˆ taking the time derivative of 29 along the solutions of 24 and 27 yields 30 v 2 ω e t k u ω e k r ψ e 2 ω e t θ u e y u 0 k r λ 2 ψ e ψ e ω e t λ 2 r e y r u e w 1 t ϑ 1 υ ε 1 t n m u d u β u r e w 1 t ϑ 2 υ ε 2 t r m r d r β r y u y u y r y r θ 1 θ ˆ 1 θ 2 θ ˆ 2 1 2 b 1 m u λ λ ˆ 1 2 b 2 m r ω ω ˆ according to assumptions 1 2 and referring to the design idea of adaptive nn approach based on dri in song et al 2015 we employ the rbfnn approximation technology and mlp technique as follows 31 w 1 t ϑ 1 υ ε 1 d u w 1 t ϑ 1 υ ε 1 d u θ 1 ϕ 1 υ w 2 t ϑ 2 υ ε 2 d r w 2 t ϑ 2 υ ε 2 d r θ 2 ϕ 2 υ where θ 1 max w 1 t ε 1 d u and θ 2 max w 2 t ε 2 d r are the virtual parameters ϕ i υ ϑ i υ 1 i 1 2 is the computable core function we call ϕ i υ as core function for it contains the deep rooted information of the system that is easily computable due to its independence of system parameters song et al 2015 zhu and du 2018 remark in 26 two rbfnns are applied to approximate unknown nonlinear functions h u υ and h r υ respectively we know that the external disturbance can not be approximated by nn since it is the unknown input for marine ships in addition the influence of the external disturbance and h i υ i u r on the system dynamic is inseparable therefore it is not appropriate to handle the external disturbance and the h i υ separately to overcome this difficulty we adopt the dri and mlp techniques and the total uncertainties are transformed into the form of linear parameterization like as shown in 31 in this way only two unknown parameters θ 1 and θ 2 need to be online updated in our work from which the number of updating parameters is significantly reduced and is independent of the number of nn nodes thus our proposed method not only solves the difficulty aforementioned but also reduces the computational burden of control scheme synthesizing 30 and 31 yields 32 v 2 ω e t k u ω e k ψ r ω e t θ u e y u 0 k r λ 2 ψ e ψ e ω e t λ 2 r e y u e t u m u β u θ 1 φ 1 υ u e r e t r m r β r θ 2 φ 2 υ r e y u y u y r y r θ 1 a 1 φ 1 2 υ u e 2 θ 2 a 2 φ 2 2 υ r e 2 δ 1 θ 1 θ ˆ 1 δ 2 θ 2 θ ˆ 2 b 1 b 1 m u λ λ ˆ b 2 b 2 m r ω ω ˆ according to young s inequality we have 33 θ 1 ϕ 1 υ u e a 1 θ 1 ϕ 1 2 υ u e 2 θ 1 4 a 1 34 θ 2 ϕ 2 υ r e a 2 θ 2 ϕ 2 2 υ r e 2 θ 2 4 a 2 35 θ 1 θ ˆ 1 θ 1 θ 1 θ ˆ 1 θ 1 2 2 θ 1 2 2 36 θ 2 θ ˆ 2 θ 2 θ 2 θ ˆ 2 θ 2 2 2 θ 2 2 2 37 λ λ ˆ λ m u λ λ 2 2 m u 2 2 38 ω ω ˆ ω m r ω ω 2 2 m r 2 2 39 ω e t θ u e y u 0 k r λ 2 ψ e ω e t r ψ d cos ψ sin ψ u e y u k r ω e t λ 2 ψ e 1 0 5 k r f 1 α f 2 α 2 ω e t ω e 0 5 y u 2 0 5 ψ e 2 0 5 u e 2 40 ψ e ω e t λ 2 r e y r ψ e 2 f 1 α f 2 α 2 ω e t ω e r e 2 y r 2 where a 1 and a 2 are the designed positive constants substituting 31 38 into 30 yields 41 v 2 ω e t k u 1 1 0 5 k r f 1 α f 2 α 2 i 2 ω e k r 1 5 ψ e 2 δ 1 θ 1 2 2 δ 2 θ 2 2 2 k 1 u e 2 k 2 1 r e 2 b 1 λ 2 2 m u b 1 b 2 ω 2 2 m r b 2 y u 0 5 y u y u y r y r y r δ 1 θ 1 4 a 1 δ 2 θ 2 4 a 2 θ 1 2 2 θ 2 2 2 b 1 m u 2 b 1 b 2 m r 2 b 2 differentiating y u β u α u and y r β r α r we have 42 y u 1 e y u α u 1 e y u b u x d y d ψ d x d y d ψ d x d y d ψ d x y u v u v 43 y r 1 e y r α r 1 e y r b r x d y d ψ d x d y d ψ d x d y d ψ d ψ r where b u x d y d ψ d x d y d ψ d x d y d ψ d x y u v u v and b r x d y d ψ d x d y d ψ d x d y d ψ d ψ r are continuous smooth functions with b i b m i i u r and b m i being the maximum value of b i substituting 42 43 into 41 results in 44 v 2 ω e t k u 1 1 0 5 k r f 1 α f 2 α 2 i 2 ω e k r 1 5 ψ e 2 δ 1 θ 1 2 2 δ 2 θ 2 2 2 k 1 u e 2 k 2 1 r e 2 b 1 λ 2 2 b 1 b 2 ω 2 2 b 2 y u b u 1 1 e y r 2 y r b r θ 1 4 a 1 θ 2 4 a 2 δ 1 θ 1 2 2 δ 2 θ 2 2 2 b 1 m u 2 b 1 b 2 m r 2 b 2 according to young s inequality we can get y i b i 1 y i 2 b m i 2 4 by choosing the appropriate design parameter e i and ω i 0 we can get 1 e i 1 b m i 2 4 ω i then 45 v 2 ω e t k u 1 1 0 5 k r f 1 α f 2 α 2 i 2 ω e k r 1 5 ψ e 2 δ 1 θ 1 2 2 δ 2 θ 2 2 2 k 1 u e 2 k 2 1 r e 2 b 1 λ 2 2 m u b 1 b 2 ω 2 2 m r b 2 ω u y u 2 ω r y r 2 θ 1 4 a 1 θ 2 4 a 2 δ 1 θ 1 2 2 δ 2 θ 2 2 2 2 b 1 m u 2 b 1 b 2 m r 2 b 2 μ v 2 c where μ min 2 λ min k u 1 1 0 5 k r f 1 α f 2 α 2 i 2 b 1 b 2 δ 1 δ 2 2 k r 1 5 k 1 k 2 1 δ 1 δ 2 ω u ω u c θ 1 4 a 1 θ 2 4 a 2 δ 1 θ 1 2 2 δ 2 θ 2 2 2 2 b 1 m u 2 b 1 b 2 m r 2 b 2 the design parameters k u k r and k 2 satisfy 46 λ min k u 1 1 0 5 k r f 1 α f 2 α 2 k r 1 5 k 2 1 other design parameters are positive constants the proof is completed 5 simulations to illustrate the effectiveness of the control law the cybership 2 ship model of the norwegian university of science and technology is used as a controlled object for the simulation experiments the loa length of all of the ship model is l 1 255 m and the mass is m 23 8 kg for other hydrodynamic parameters see skjetne et al 2005 it is noted that the force of the propeller and the rudder moment are bounded for the real ship then there is a control input saturation control vector for control system 47 t s i t i m t i t i m t i t i m t i t i m t i m t i t i m where i u r t i m 0 is the boundary of the control input we choose the control input saturation as t u m 2 n t r m 1 5 n m park 2017 in berthing practice it is more difficult to berth by using turn around way for the underactuated ships to verify the robustness and applicability of the proposed control scheme the turn around way auto berthing method is adopted 5 1 simulation with unknown model parameters the initial parameters of the ship berthing are chosen as x 0 5 l y 0 5 l ψ 0 0 rad u 0 0 5 m s v 0 0 5 m s r 0 0 5 rad s berthing target status are x d 0 l y d 0 l ψ d π rad since the turning moment torque required for turn around way auto berthing is generally large the initial values of u v and r are set to 0 5 for achieving the auto berthing of the underactuated ship generally speaking the berthing operations are performed well if the berthing positions and the berthing angles are arranged well and the initial states of v and r are stable to 0 in the berthing practice in this simulation the initial states of v and r are not 0 which means the initial state of auto berthing is the three degree of freedom coupled motion which increases the difficulty for auto berthing therefore the initial setting can further verify the robustness of the proposed control law considering that the model parameters m u m v m r f u υ and f r υ are all unknown the design parameters are chosen as k u diag k 1 k 2 diag 5 6 k r k 3 25 δ 1 4 10 5 δ 2 2 10 4 a 1 0 01 a 2 0 01 b 1 0 02 b 2 0 001 b 1 1 10 5 and b 2 1 10 6 e 0 01 ω 1 0 1 and ω 2 0 25 the curves of actual position x y and heading angle ψ versus time are shown in fig 1 the lateral position of the vessel arrives at the berth position x d 0 at 26s but the longitudinal position y d 0 has not yet reached the target value and needs to be fine tuned through the propeller reversal until at 50 s to further verify the stability of the controller this paper extends the simulation time to 300s the heading angle curve shows that the heading is stabilized at 180 from 0 during the 0 s 90 s fig 2 shows the curve of ship centerline position indicated by a red line in x y plant as shown in fig 2 the given conditions of u 0 0 5 m s v 0 0 5 m s and r 0 0 5 rad s are equivalent to adding an additional torque to the ship then the ship can quickly complete the starboard side turn within a limited distance in the next moment the ship swiftly turns to starboard shipside within the limited distance under the action of inertia later the ship arrives at the designated berthing position by fine tuning fig 3 shows the curves of surge velocity u sway velocity v and yaw rate r versus time the propeller needs to be accelerated to achieve the auto berthing by turning to starboard when the initial u is 0 5 m s obviously the u accelerates during 0 3 44 s and reaches a peak value of 0 78 m s at 3 44 s then slows down to nearly 0 m s at 50 s and remains stable since the sway speed v does not need to be too large in the process of ship turning whose value gradually decreases it decreases from 0 5 m s to 0 m s during 0 3 s then the direction of the sway is changed due to the ship s inertia the v reaches to 0 2 m s at 6 3 s and gradually decreases and stabilizes with 0 m s since the given initial yaw rate r is 0 5 rad s it gradually decreases to 0 1 rad s during the period of 0 s 1 2 s and increases to 0 23 rad s at 2 6 s it gradually stabilizes at 0 rad s at around 50 s fig 4 shows the curves of surge control force t u and yaw control force moment t r versus time t u reaches the saturation upper bound 2 n in 0 3 44 s and reaches the saturation lower bound of 2 n during 3 6 7 25 s and then gradually stabilizes at around 0 n t r reaches the saturation upper bound 1 5 n m during 0 2 s and then decreases to 0 n m at 3 s since the heading is controlled by the reverse rudder angle then t r increases in a reverse direction and reaches 0 91 n m at 5 s considering that the effect of rudder decreases at low speed the tug boats or and bow thrusters are used for berthing operation in real ship s berthing finally it is adjusted back and stabilizes at around 0 n m at 42 s fig 5 shows that the values of the adaptive parameters θ ˆ 1 and θ ˆ 2 are stable at 2 12 and 3 55 respectively which indicates that the control system is stable in summary from figs 1 5 we can see that the ship has better automatic berthing performance since the actual berthing engineering by ship turn around way is difficult the ship motion control process given by this simulation meets the requirements of navigation practice meanwhile the control accuracy meets the engineering needs 5 2 simulation with time varying disturbance to further verify the anti disturbances ability of the control law on the basis of the previous section the bounded disturbances includes the constant valued disturbances and the sine function time varying disturbances are chosen in this section as 48 d 0 1 0 01 sin 1 1 t 1 5 sin 0 8 t 0 001 1 2 sin 0 1 t 1 5 sin 0 1 t 0 1 0 02 sin 2 t 4 sin t n to facilitate comparison the ship parameters the initial values of position velocity and design parameters are chosen from the 5 1 section the simulation results are shown in figs 6 10 the curves of actual position x y and heading angle ψ versus time are shown in fig 6 the lateral position of the vessel arrives at the berth position x d 0 at 58 s but the longitudinal position y d 0 has not yet reached the target value and needs to be fine tuned through the propeller reversal until 210 s the heading angle ψ curve shows that the heading is stabilized at 180 from 0 during 0 s 90 s therefore the berthing time with time varying disturbances is significantly longer than non disturbances case of fig 1 the ship centerline position indicated by a red line changes smoothly as shown in fig 7 but compared with figs 2 and 7 has a smaller inflection point in the x y plane coordinates 1 5 l 2 3 l the main reason for this phenomenon is that the ship trajectory is affected by bounded disturbances moreover the location of this point coincides with the characteristics of the ship s position x y in fig 6 fig 8 shows that the propeller needs to be accelerated to achieve the auto berthing by turning to starboard when the initial u 0 5 m s obviously the u accelerates during 0 s 2 82 s and reaches a peak value of 0 786 m s at 2 82 s then slows down to nearly 0 m s at 56 s and remains stable since the sway speed v does not need to be large in the process of ship turning its value gradually decreases it decreases from 0 5 m s to 0 m s during 0 s 2 5 s then the direction of the sway is changed due to the ship s inertia the v reaches to 0 2 m s at 6 s then decreases and stabilizes with 0 m s gradually since the given initial yaw rate r is 0 5 rad s it gradually decreases to 0 2 rad s during the period of 0 s 0 9 s and increases to 0 23 rad s at 1 5 s it gradually stabilizes at 0 rad s at around 50 s compared with fig 3 the variation times of u v and r i e reaching the maximum value or stable value with disturbances are earlier than that of the undisturbed case this shows that the controller has robustness under external disturbances fig 9 shows the curves of surge control force t u and yaw control moment t r versus time t u reaches the saturation upper bound of 2 n during 0 s 2 8 s and reaches the saturation lower bound of 2 n during 3 s 7 7 s then due to the bounded disturbances the value is stable between 0 1 n and 0 066 n during 40 s 300 s v 0 reaches the saturation upper bound 1 5 n m during 0 s 1 1 s then decreases to 0 n m at 2 4 s since the heading is controlled by the reverse rudder angle then t r increases in a reverse direction and reaches 1 015 n m at 4 6 s finally it is adjusted back and is almost stable during 42 s 300 s obviously we can see that the t u and t r make control input fluctuate by the external disturbances fig 10 shows that the values of the adaptive parameters θ ˆ 1 and θ ˆ 2 are stable at 1 72 and 2 33 respectively which indicates that the control system is stable in summary from figs 6 10 we can see that under the external time variant disturbances the ship has good auto berthing performances which are consistent with the navigation practices and verify the effectiveness of the proposed control law furthermore to verify the applicability of our proposed scheme we change the initial conditions of ship position and velocity and keep the berthing target status and design parameters of the control law unchanged in simulation the initial conditions are taken as x 0 6 5 l y 0 5 85 l ψ 0 0 rad u 0 0 55 m s v 0 0 55 m s r 0 0 55 rad s the simulation results are shown in figs 11 and 12 fig 11 shows that the lateral position of the vessel arrives at the berth position x d 0 at 60 s but the longitudinal position y d 0 has not yet reached the target value and needs to be fine tuned through the propeller reversal until 250 s the heading angle ψ curve shows that the heading is stabilized at 180 from 0 during 0 s 95 s fig 12 shows the curves of surge control force t u and yaw control force moment t r versus time since the heading is controlled by the reverse rudder angle then t r increases in a reverse direction and reaches 1 36 n m at 5 5 s finally it is adjusted back and is almost stable during 50 s 300 s obviously we can see that the t u and t r make control input fluctuate by external disturbances in summary from figs 6 9 11 and 12 we can see that even if the initial conditions change the ship has good auto berthing performances under the external time variant disturbances thus the results show that the proposed control low has robustness to verify that the proposed control law can reduce the computational load the laboratory computers are used for the load tests of simulation in section 5 2 as shown of the test results in table 1 the computer memories used in the proposed algorithm is obviously reduced on average by 70 066 the main reason for this result is that the nn algorithm needs 122 adaptive parameters while the proposed algorithm only adopts 4 parameters θ 1 θ 2 λ ˆ and ω ˆ therefore the effect of the computational load reduction is obvious 6 conclusions to solve the problems of dynamic uncertainties and unknown bounded disturbances in the auto berthing control of the underactuated ship this paper uses the additional control method to solve the underacruated problem while a robust neural networks nn adaptive approach based on the navigation dynamic deep rooted information dri is proposed to reconstruct the dynamic and unknown disturbances moreover the dsc and mlp techniques are used to solve the computational load problem of adaptive nn control finally the simulation experiments with actuators input saturation are carried out to verify the effectiveness of the proposed algorithm however the auto berthing control method by using turn around way is a very complex engineering problem in the future the following work need to be carried out 1 it needs to be prove that the proposed control method does not apply to all the initial berthing position for the underactuated marine ship by using engineering practices and simulation experiments that is the safety zone of initial position for auto berthing control needs to be determined 2 it should be considered that the rudder effect can not be guaranteed when the underactuated ship is berthing at low speed in this work then the switching control of tugboats or thrusters can be further discussed 3 the control input is expressed by force moment rather than the propeller revolution rudder angle in this paper however the propeller revolution and rudder angle are more practical for ship officers and engineers in the berthing practice then taking the propeller revolution rudder angle as the control input is worth studying in addition the control scheme proposed can also be used for marine ship path following control and dynamic positioning control acknowledgments we are grateful to the reviewers for their valuable comments and suggestions to improve the quality of this article the authors would like to acknowledge the support from the key research and development projects of shandong province 2018ggx105014 2018ggx105003 2018ggx105002 and projects of shandong province higher educational science and technology program j18ka010 j18ka043 and a project of shandong province transportation science and technology program 2018b69 shandong jiaotong university phd startup foundation of scientific research and shandong jiaotong university climbing research innovation team program 
22924,to solve the auto berthing control problem for underactuated marine ships subject to unknown dynamics and external disturbances under the circumstance of the restricted waters in port firstly an additional control method is adopted to solve the underacruated problem secondly a robust neural network nn adaptive approach based on the navigation dynamic deep rooted information dri is proposed to reconstruct the lumped uncertainties caused by unknown ship dynamics and external disturbances meanwhile the dynamic surface control dsc and the minimum learning parameter mlp techniques are used to reduce the computational load of the adaptive nn control scheme considering the input saturation effects of control actuator rudder propeller etc and the coupling characteristics of uncertainties this approach integrates neural network weights approximation errors and external disturbance term as the composite uncertain parameters which is estimated online by parameter adaptive technique finally simulations are carried out on an underactuated model ship to verify the effectiveness of the proposed auto berthing control scheme keywords underactuated marine ship auto berthing neural network deep rooted information 1 introduction with the development of intelligent merchant ships more and more attentions have been paid to the research of auto berthing control which is one of the intelligent techniques of marine ships the research of auto berthing control began in the early 1990s the main challenge for achieving the auto berthing control of marine ships focuses on the underactuated characteristics among which only surge force and yaw moment are available in such ships whereas there are three degrees of freedom yaw sway and surge direction padideh et al 2016 it is also well known that the marine ships in the automatic berthing mode are a class of underactuated mechanical systems with nonintegrable dynamics which is not transformable into a driftless system zhang 2015 rødseth 2017 since the auto berthing problem involves the low velocity motion of ships in shallow water the more information needs to be involved the maneuverability of the marine ships will deteriorate making the control problem more challenging zhang 2012 zhang et al 2017 thus it is necessary to conduct further researches on the auto berthing control for the ships with unknown ship dynamics and external disturbances in the restricted waters since artificial neural networks ann consists of several interconnected simple nonlinear systems that are typically modeled by the transfer function it has the capability to replicate human brains and perform the same action that a human brain does in any particular situation ahmed 2015 thus the neural network can be used to solve the problems of auto berthing control inspired by the unique features of the ann this paper employs the ann to design the auto berthing controller for the first time in yamato et al 1990 further a parallel auto berthing ann control scheme combined with the expert system was proposed in hasegawa et al 1993 and im et al 2001 to replace the previous single control scheme to control the rudder angle and the propeller respectively besides a motion recognition method using ann to detect the transverse velocity and turning angular velocity of the ship was proposed to achieve auto berthing in the direction of parallel wind directions see im and hasegawa 2002 note that the focus of the studies was on the sample data generated by human experience and standard operation schemes but the consistency of the two schemes is difficult to be guaranteed meanwhile some designs lack versatility such as the design of virtual navigation lines there was not such a line in the ship berthing practice in im et al 2007 to improve the applicability of the auto berthing algorithm to certain ports im et al 2007 proposed the selective auto berthing controller that is the berthing waters were divided into several partitions and different control strategies were used in different regions the control strategies aforementioned do not take into account the problem of sample data consistency for that mizuno et al 2007 proposed the ann nonlinear programming method based on minimum time manipulation to solve the problem of marine ship maneuvering under equality and inequality constraints whereafter this method was used to solve the consistency problem of sample data xu and hasegawa 2012 however this method has many constraints and is prone to rudder angle jitter to solve the issue ahmed and hasegawa designed auto berthing controllers combining nn technique with virtual window theory nonlinear programming and pd control algorithm whose effectiveness was shown adopting a self propelled modules in ahmed et al 2013 ahmed et al 2012 and ahmed et al 2015 it should be pointed out that the proposed control strategy still needs to employ a virtual berthing navigation line to achieve auto berthing control in addition the nn used in these methods needs offline training which is hard to satisfy the real time requirement of the auto berthing practice in order to increase the applicability of nn controller for auto berthing a nn controller by using the head up coordinate system is proposed to automatically control the ship into the berth in different ports without retraining the nn structure im and nguyen 2018 the aforementioned studies still have less consideration of the problem of the dynamic uncertainty and the unknown disturbances of the underactuated marine ship caused by shallow water low velocity quay wall effects and relatively enhanced wind flow etc the adaptive nn technique which can be used to train the online parameters is a powerful method employed to solve this problem by using the unsupervised learning mode nguyen and jung 2007 used the adaptive ann controller online training instead of off line training to train the control signal of the rudder and the propeller respectively liu 2010 designed an adaptive nn controller which partially solved the auto berthing control by the path following method with ship model uncertainty and external disturbances for the underactuated ship motivated by the above mentioned observations this paper develops an adaptive nn auto berthing control method for underactuated marine ship with dynamic uncertainty and external disturbances which is based on the novel deep rooted information dri song 2015 and performed by using the additional control method do 2010 dynamic surface control dsc and the minimum learning parameter mlp techniques the main contributions of this paper can be summarized as follows 1 a novel auto berthing control scheme is proposed for underactuated marine ships subject to unknown dynamics and external disturbances using dri additional control method adaptive nn with mlp technique and dsc techniques to the best of the authors knowledge there were few similar results in existing literature 2 our proposed control law is inexpensive in calculated load and simple in constitution specifically only 4 unknown parameters need to be updated online even if the nn technique is involved 3 the simulations of auto berthing control are carried out by using turn around way which is useful for engineering practice that is critical and important to verify the robustness of the proposed control few results have used this experimental method the rest of this paper is organized as follows in section 2 problem description and ship mathematical model are given section 3 is devoted to coordinate transformations additional control for the underactuated ship in section 4 based on adaptive nn and dri the controller is designed in section 5 the numerical simulations are given to illustrate the effectiveness of the proposed approach section 6 contains the conclusions 2 problem description to facilitate the design of the auto berthing controller for the underactuated ship the nonlinear dynamic equation of the 3 dof u v and r plane motion is used as shown in 1 this model based on the maneuvering modeling group mmg modeling concept is employed to describe the motion characteristics of the general marine ship in jia 1999 1 m m x u m m y v r x h x p x r m m y v m m x u r y h y p y r i z z j z z r n h n p n r where m m x m y i zz and j zz are ship mass added mass inertia moment and additional inertia moment respectively x y n are the external forces and moments in different directions of the body fixed frame respectively u v r are the ship s surge sway and yaw velocities variables u v r t subscript h p and r are bare hull propeller and rudder respectively under the interference of external environment the system state of 1 can be transformed into fossen 2011 2 x u cos ψ v sin ψ y u sin ψ v cos ψ ψ r u m v m u v r f u υ m u t u m u d u v m u m v u r f v υ m v d v r m u m v m r u v f r υ m r t r m r d r where the high order fluid dynamics items are 3 f u υ x u u u u x v r v r x v v v 2 x r r r 2 f v υ y v v y r r y v v v v y r r r r y v v r v 2 r y v r r v r 2 f r υ n v v n r r n v v v v n r r r r n v v r v 2 r n v r r v r 2 where t u and t r are the control inputs the surge force and yaw moment m u m m x m v m m y m r i z j z x y ψ are the variables of the ship s position coordinates and heading angle and υ u v r t denotes the velocity vector in the body fixed frame d u d v and d r represent the unpredictable unknown external environment disturbances force torque vector in the 3 dof plane induced by wind waves and sea current effects the longitudinal viscous hydrodynamic factors x u u x vv x vr and x rr the linear viscous hydrodynamic factors y v y r n v and n r the nonlinear viscous hydrodynamic factors y v v y r r y vvr y vrr n v v n r r n vvr and n vrr are determined by the kijima empirical formulas in zhang 2015 however sometimes it is difficult to obtain the accurate ship parameters when a ship is berthing at a slow speed then in this paper let the model parameters m x m y m r x u u u u x v r v r x v v v 2 x r r r 2 y v v y r r y v v v v y r r r r y v v r v 2 r y v r r v r 2 and n v v n r r n v v v v n r r r r n v v r v 2 r n v r r v r 2 be all unknown in the ship berthing practice we set the actual berthing system is controllable under the disturbance of the external environment therefore the following assumptions are made based on the berthing characteristics of the conventional merchant ships assumption 1 1 f i υ and m i i u v r are unknown 2 the external disturbances d i i u v r are unknown yet bounded that is there exist unknown positive constants d u d v and d r satisfying d u d u d v d v and d r d r due to its excellent approximation performance in the field of control engineering the radial basis function neural network rbfnn is often used to deal with nonlinear equations in the model what is more its linear nature of weights can make the learning algorithm relatively simple in this paper the rbfnn is used to approximate nonlinear smooth functions the rbfnn is usually composed of hidden layer and output layer of which the hidden layer is to map the input space to a new space and the output layer is a linear combination of new space see cui 2016 let the unknown smooth function vector be denoted as w t s x x ω r n is the network input according to the universal approximation theorem wang et al 2005 if the number of network nodes is sufficiently large the continuous function defined on a tight set w t s x can be approached with arbitrary precision therefore we can use rbfnn to approximate a smooth continuous function zhu et al 2018 4 f x w t s x where f x r n r w w 1 w 2 w l t r l l 1 are nn nodes the rbf vector s x s 1 x s 2 x s l x t r n represents the activation function s i x i 1 2 n usually uses a gaussian function as shown in 5 5 s i x exp x μ i t x μ i η i 2 where μ i μ i μ i μ i t represents the function center value η i represents gaussian function width lemma 1 chen 2010 a tight set ω r n is defined for any given smooth continuous function 6 h x w t s x ε x ω where ε is the approximate error ε 0 for x ω ε ε w is an ideal approximation weight vector usually the ideal nn weight vector w is an unknown vector and needs to be estimated it can be understood that we can get the w when ε is minimized in x ω r n then 7 w arg min w r l sup x ω h x w t s x assumption 2 in a compact set ω x r n the weight w of rbfnn are bounded that is w w m with w m being a positive constant 3 coordinate transformations to solve the mismatch problem of lateral drive vector for the underactuated ship a lateral drive vector α is constructed through coordinate transformation and additional control parameter design here we call α an additional control do 2010 8 ω r ψ d x y r ψ e f 1 α f 2 α ω d r ψ d x d y d ψ e ψ ψ d f 3 α ω e ω ω d where r cos sin sin cos represents the rotational matrix function from the geographic coordinates to the ship coordinates f i α i 1 2 3 is differentiable functions of α such that f i α λ i for all α r with λ i being a positive constant let γ e x x d y y d according to 8 we can get 9 γ e r 1 ψ d ω e r ψ e f 1 α f 2 α ψ ψ d ψ e f 3 α from 9 the following inequalities hold 10 γ e ω e f 1 α f 2 α ψ ψ d ψ e f 3 α due to f i α λ i the function f i α is bounded for all α r which means that we just need to design control laws t u and t r such that ψ e and ω e are able to converge to zero meanwhile the ship velocities u v r are bounded then the control objective is solved differentiating both sides of 8 we get 11 ω e r ψ d x y r ψ d x y r ψ e f 1 α f 2 α r ψ e f 1 α α f 2 α α ω d r ψ d x y r ψ d cos ψ sin ψ r ψ e f 1 α f 2 α u α r ψ d v sin ψ v cos ψ r ψ e f 1 α f 2 α ψ e ω d then 12 ω e θ u α λ 1 λ 2 ψ e ω d ψ e r ψ d f 3 α α θ r ψ d cos ψ sin ψ r ψ e f 1 α f 2 α λ 1 r ψ d x y r ψ d v sin ψ v cos ψ λ 2 r ψ e f 1 α f 2 α where f 1 α f 1 α α i 1 2 and r sin cos cos sin to be prepared for the control design in section 4 we now specify the functions f i α i 1 2 3 such that they are bounded differentiable and make the matrix θ invertible expanding the first equation of 12 then 13 θ cos ψ ψ d cos ψ e f 1 α sin ψ e f 2 α sin ψ ψ d sin ψ e f 1 α cos ψ e f 2 α recalling 8 and 13 yields 14 det θ sin f 3 α f 1 α cos f 3 α f 2 α to ensure the det θ nonzero for all α we design the functions f i α i 1 2 3 as 15 f 1 α ω 1 sin α sin f 3 α f 3 α f 2 α ω 1 sin α 1 cos f 3 α f 3 α f 3 α ω 2 cos α where ω 1 and ω 2 are the design parameters satisfying ω 1 0 and ω 2 0 π 2 according to the 15 we have f 1 α ω 1 f 2 α ω 1 f 3 α ω 2 substituting 15 into 14 yields 16 det θ ω 1 ω 2 1 tan 2 α 1 cos f 3 α based on the above analysis the inverse matrix of the θ to be used in the next section as follows 17 θ 1 1 det θ sin ψ e f 1 α cos ψ e f 2 α cos ψ e f 1 α sin ψ e f 2 α sin ψ ψ d cos ψ ψ d 4 control design the application of nn based on dri to reconstruct uncertain modal dynamics and unknown disturbances and the introduction of dsc techniques and mlp reduce the computational load the details are as follows step 1 the following lyapunov function candidate can be chosen 18 v 1 1 2 ω e t ω e 1 2 ψ e 2 taking the time derivative of v 1 and using 12 one can get 19 v 1 ω e t ω e ψ e ψ e ω e t θ u α λ 1 λ 2 ψ e ω d ψ e r φ d f 3 α α we choose the following virtual control law for u and r 20 α u α θ 1 k u ω e λ 1 ω d α r k r ψ e ψ d f 3 α α where k u is a positive definite symmetric matrix and k r is a positive constant here dsc technology is used to avoid the computational load caused by derivation let the virtual control laws pass through the first order filter as follows 21 e β u β u α u e β r β r α r where β u and β r are the state of the first order filter and e is the time constant define the errors u e u β u r e r β r y u β u α u y r β r α r and then substituting error variables u e r e y u and y r into 19 yields 22 v 1 ω e t θ u e y u α u α λ 1 λ 2 ψ e ω d ψ e r e y r α r ψ d f 3 α α ω e t θ u e y u 0 k u ω e λ 2 ψ e ψ e r e y r k ψ r ω e t θ u e y u 0 ω e t k u ω e k ψ r ω e t λ 2 r ψ d f 3 α α ψ e r e y r substituting 20 into 22 one can obtain 23 v 1 ω e t θ u e y u 0 ω e t k u ω e k r ψ e 2 ω e t λ 2 r k r ψ e α r ψ e r e y r from the definition r e r β r and y r β r α r we can get r α r r e y r and then substituting it into 23 yields 24 v 1 ω e t θ u e y u 0 ω e t k u ω e k r ψ e 2 ω e t λ 2 r e y r k r ψ e ψ e r e y r ω e t k u ω e k r ψ e 2 ω e t θ u e y u 0 k r λ 2 ψ e ψ e ω e t λ 2 r e y r step 2 differentiating the u e u β u and r e r β r then substituting them into 2 results in 25 u e m v m u v r f u υ m u t n m u d u β u r e m u m v m r u v f r υ m r t r m r d r β r let h u υ m v m u v r f u υ m u and h r υ m u m v m r u v f r υ m r they cannot be directly employed for the control design since m u m v m r f u υ and f r υ are unknown from assumption 1 therefore in view of lemma 1 two rbfnns are used to approximate the unknown nonlinear functions h u υ and h r υ as follows 26 h u υ w 1 t ϑ 1 υ ε 1 h r υ w 2 t ϑ 2 υ ε 2 where w 1 and w 2 are the nn weight matrix ϑ 1 υ and ϑ 2 υ are nn basic functions ε 1 and ε 2 are the nn errors respectively substituting 26 into 25 gives 27 u e w 1 t ϑ 1 υ ε 1 t u m u d u β u r e w 2 t ϑ 2 υ ε 2 t r m r d r β r according to 27 we choose the control laws as follows 28 t u λ ˆ χ χ k 1 u e a 1 u e θ ˆ φ 1 2 υ β u t r ω ˆ δ δ k 2 r e a 2 r e θ ˆ 2 φ 2 2 υ β r θ ˆ 1 a 1 φ 1 2 υ u e 2 δ 1 θ ˆ 1 θ ˆ 2 a 2 φ 2 2 υ r e 2 δ 2 θ ˆ 2 λ ˆ b 1 χ u e b 1 λ ˆ ω ˆ b 2 δ r e b 2 ω ˆ where δ 1 δ 2 a 1 a 2 b 1 b 2 b 1 and b 2 are all positive design constants construct the following lyapunov function candidate 29 v 2 v 1 1 2 u e 2 1 2 r e 2 1 2 y u 2 1 2 y r 2 1 2 θ 1 2 θ 2 2 1 2 b 1 m u λ 2 1 2 b 2 m r ω 2 where θ i θ i θ ˆ i i 1 2 λ m u λ ˆ and ω m r ω ˆ taking the time derivative of 29 along the solutions of 24 and 27 yields 30 v 2 ω e t k u ω e k r ψ e 2 ω e t θ u e y u 0 k r λ 2 ψ e ψ e ω e t λ 2 r e y r u e w 1 t ϑ 1 υ ε 1 t n m u d u β u r e w 1 t ϑ 2 υ ε 2 t r m r d r β r y u y u y r y r θ 1 θ ˆ 1 θ 2 θ ˆ 2 1 2 b 1 m u λ λ ˆ 1 2 b 2 m r ω ω ˆ according to assumptions 1 2 and referring to the design idea of adaptive nn approach based on dri in song et al 2015 we employ the rbfnn approximation technology and mlp technique as follows 31 w 1 t ϑ 1 υ ε 1 d u w 1 t ϑ 1 υ ε 1 d u θ 1 ϕ 1 υ w 2 t ϑ 2 υ ε 2 d r w 2 t ϑ 2 υ ε 2 d r θ 2 ϕ 2 υ where θ 1 max w 1 t ε 1 d u and θ 2 max w 2 t ε 2 d r are the virtual parameters ϕ i υ ϑ i υ 1 i 1 2 is the computable core function we call ϕ i υ as core function for it contains the deep rooted information of the system that is easily computable due to its independence of system parameters song et al 2015 zhu and du 2018 remark in 26 two rbfnns are applied to approximate unknown nonlinear functions h u υ and h r υ respectively we know that the external disturbance can not be approximated by nn since it is the unknown input for marine ships in addition the influence of the external disturbance and h i υ i u r on the system dynamic is inseparable therefore it is not appropriate to handle the external disturbance and the h i υ separately to overcome this difficulty we adopt the dri and mlp techniques and the total uncertainties are transformed into the form of linear parameterization like as shown in 31 in this way only two unknown parameters θ 1 and θ 2 need to be online updated in our work from which the number of updating parameters is significantly reduced and is independent of the number of nn nodes thus our proposed method not only solves the difficulty aforementioned but also reduces the computational burden of control scheme synthesizing 30 and 31 yields 32 v 2 ω e t k u ω e k ψ r ω e t θ u e y u 0 k r λ 2 ψ e ψ e ω e t λ 2 r e y u e t u m u β u θ 1 φ 1 υ u e r e t r m r β r θ 2 φ 2 υ r e y u y u y r y r θ 1 a 1 φ 1 2 υ u e 2 θ 2 a 2 φ 2 2 υ r e 2 δ 1 θ 1 θ ˆ 1 δ 2 θ 2 θ ˆ 2 b 1 b 1 m u λ λ ˆ b 2 b 2 m r ω ω ˆ according to young s inequality we have 33 θ 1 ϕ 1 υ u e a 1 θ 1 ϕ 1 2 υ u e 2 θ 1 4 a 1 34 θ 2 ϕ 2 υ r e a 2 θ 2 ϕ 2 2 υ r e 2 θ 2 4 a 2 35 θ 1 θ ˆ 1 θ 1 θ 1 θ ˆ 1 θ 1 2 2 θ 1 2 2 36 θ 2 θ ˆ 2 θ 2 θ 2 θ ˆ 2 θ 2 2 2 θ 2 2 2 37 λ λ ˆ λ m u λ λ 2 2 m u 2 2 38 ω ω ˆ ω m r ω ω 2 2 m r 2 2 39 ω e t θ u e y u 0 k r λ 2 ψ e ω e t r ψ d cos ψ sin ψ u e y u k r ω e t λ 2 ψ e 1 0 5 k r f 1 α f 2 α 2 ω e t ω e 0 5 y u 2 0 5 ψ e 2 0 5 u e 2 40 ψ e ω e t λ 2 r e y r ψ e 2 f 1 α f 2 α 2 ω e t ω e r e 2 y r 2 where a 1 and a 2 are the designed positive constants substituting 31 38 into 30 yields 41 v 2 ω e t k u 1 1 0 5 k r f 1 α f 2 α 2 i 2 ω e k r 1 5 ψ e 2 δ 1 θ 1 2 2 δ 2 θ 2 2 2 k 1 u e 2 k 2 1 r e 2 b 1 λ 2 2 m u b 1 b 2 ω 2 2 m r b 2 y u 0 5 y u y u y r y r y r δ 1 θ 1 4 a 1 δ 2 θ 2 4 a 2 θ 1 2 2 θ 2 2 2 b 1 m u 2 b 1 b 2 m r 2 b 2 differentiating y u β u α u and y r β r α r we have 42 y u 1 e y u α u 1 e y u b u x d y d ψ d x d y d ψ d x d y d ψ d x y u v u v 43 y r 1 e y r α r 1 e y r b r x d y d ψ d x d y d ψ d x d y d ψ d ψ r where b u x d y d ψ d x d y d ψ d x d y d ψ d x y u v u v and b r x d y d ψ d x d y d ψ d x d y d ψ d ψ r are continuous smooth functions with b i b m i i u r and b m i being the maximum value of b i substituting 42 43 into 41 results in 44 v 2 ω e t k u 1 1 0 5 k r f 1 α f 2 α 2 i 2 ω e k r 1 5 ψ e 2 δ 1 θ 1 2 2 δ 2 θ 2 2 2 k 1 u e 2 k 2 1 r e 2 b 1 λ 2 2 b 1 b 2 ω 2 2 b 2 y u b u 1 1 e y r 2 y r b r θ 1 4 a 1 θ 2 4 a 2 δ 1 θ 1 2 2 δ 2 θ 2 2 2 b 1 m u 2 b 1 b 2 m r 2 b 2 according to young s inequality we can get y i b i 1 y i 2 b m i 2 4 by choosing the appropriate design parameter e i and ω i 0 we can get 1 e i 1 b m i 2 4 ω i then 45 v 2 ω e t k u 1 1 0 5 k r f 1 α f 2 α 2 i 2 ω e k r 1 5 ψ e 2 δ 1 θ 1 2 2 δ 2 θ 2 2 2 k 1 u e 2 k 2 1 r e 2 b 1 λ 2 2 m u b 1 b 2 ω 2 2 m r b 2 ω u y u 2 ω r y r 2 θ 1 4 a 1 θ 2 4 a 2 δ 1 θ 1 2 2 δ 2 θ 2 2 2 2 b 1 m u 2 b 1 b 2 m r 2 b 2 μ v 2 c where μ min 2 λ min k u 1 1 0 5 k r f 1 α f 2 α 2 i 2 b 1 b 2 δ 1 δ 2 2 k r 1 5 k 1 k 2 1 δ 1 δ 2 ω u ω u c θ 1 4 a 1 θ 2 4 a 2 δ 1 θ 1 2 2 δ 2 θ 2 2 2 2 b 1 m u 2 b 1 b 2 m r 2 b 2 the design parameters k u k r and k 2 satisfy 46 λ min k u 1 1 0 5 k r f 1 α f 2 α 2 k r 1 5 k 2 1 other design parameters are positive constants the proof is completed 5 simulations to illustrate the effectiveness of the control law the cybership 2 ship model of the norwegian university of science and technology is used as a controlled object for the simulation experiments the loa length of all of the ship model is l 1 255 m and the mass is m 23 8 kg for other hydrodynamic parameters see skjetne et al 2005 it is noted that the force of the propeller and the rudder moment are bounded for the real ship then there is a control input saturation control vector for control system 47 t s i t i m t i t i m t i t i m t i t i m t i m t i t i m where i u r t i m 0 is the boundary of the control input we choose the control input saturation as t u m 2 n t r m 1 5 n m park 2017 in berthing practice it is more difficult to berth by using turn around way for the underactuated ships to verify the robustness and applicability of the proposed control scheme the turn around way auto berthing method is adopted 5 1 simulation with unknown model parameters the initial parameters of the ship berthing are chosen as x 0 5 l y 0 5 l ψ 0 0 rad u 0 0 5 m s v 0 0 5 m s r 0 0 5 rad s berthing target status are x d 0 l y d 0 l ψ d π rad since the turning moment torque required for turn around way auto berthing is generally large the initial values of u v and r are set to 0 5 for achieving the auto berthing of the underactuated ship generally speaking the berthing operations are performed well if the berthing positions and the berthing angles are arranged well and the initial states of v and r are stable to 0 in the berthing practice in this simulation the initial states of v and r are not 0 which means the initial state of auto berthing is the three degree of freedom coupled motion which increases the difficulty for auto berthing therefore the initial setting can further verify the robustness of the proposed control law considering that the model parameters m u m v m r f u υ and f r υ are all unknown the design parameters are chosen as k u diag k 1 k 2 diag 5 6 k r k 3 25 δ 1 4 10 5 δ 2 2 10 4 a 1 0 01 a 2 0 01 b 1 0 02 b 2 0 001 b 1 1 10 5 and b 2 1 10 6 e 0 01 ω 1 0 1 and ω 2 0 25 the curves of actual position x y and heading angle ψ versus time are shown in fig 1 the lateral position of the vessel arrives at the berth position x d 0 at 26s but the longitudinal position y d 0 has not yet reached the target value and needs to be fine tuned through the propeller reversal until at 50 s to further verify the stability of the controller this paper extends the simulation time to 300s the heading angle curve shows that the heading is stabilized at 180 from 0 during the 0 s 90 s fig 2 shows the curve of ship centerline position indicated by a red line in x y plant as shown in fig 2 the given conditions of u 0 0 5 m s v 0 0 5 m s and r 0 0 5 rad s are equivalent to adding an additional torque to the ship then the ship can quickly complete the starboard side turn within a limited distance in the next moment the ship swiftly turns to starboard shipside within the limited distance under the action of inertia later the ship arrives at the designated berthing position by fine tuning fig 3 shows the curves of surge velocity u sway velocity v and yaw rate r versus time the propeller needs to be accelerated to achieve the auto berthing by turning to starboard when the initial u is 0 5 m s obviously the u accelerates during 0 3 44 s and reaches a peak value of 0 78 m s at 3 44 s then slows down to nearly 0 m s at 50 s and remains stable since the sway speed v does not need to be too large in the process of ship turning whose value gradually decreases it decreases from 0 5 m s to 0 m s during 0 3 s then the direction of the sway is changed due to the ship s inertia the v reaches to 0 2 m s at 6 3 s and gradually decreases and stabilizes with 0 m s since the given initial yaw rate r is 0 5 rad s it gradually decreases to 0 1 rad s during the period of 0 s 1 2 s and increases to 0 23 rad s at 2 6 s it gradually stabilizes at 0 rad s at around 50 s fig 4 shows the curves of surge control force t u and yaw control force moment t r versus time t u reaches the saturation upper bound 2 n in 0 3 44 s and reaches the saturation lower bound of 2 n during 3 6 7 25 s and then gradually stabilizes at around 0 n t r reaches the saturation upper bound 1 5 n m during 0 2 s and then decreases to 0 n m at 3 s since the heading is controlled by the reverse rudder angle then t r increases in a reverse direction and reaches 0 91 n m at 5 s considering that the effect of rudder decreases at low speed the tug boats or and bow thrusters are used for berthing operation in real ship s berthing finally it is adjusted back and stabilizes at around 0 n m at 42 s fig 5 shows that the values of the adaptive parameters θ ˆ 1 and θ ˆ 2 are stable at 2 12 and 3 55 respectively which indicates that the control system is stable in summary from figs 1 5 we can see that the ship has better automatic berthing performance since the actual berthing engineering by ship turn around way is difficult the ship motion control process given by this simulation meets the requirements of navigation practice meanwhile the control accuracy meets the engineering needs 5 2 simulation with time varying disturbance to further verify the anti disturbances ability of the control law on the basis of the previous section the bounded disturbances includes the constant valued disturbances and the sine function time varying disturbances are chosen in this section as 48 d 0 1 0 01 sin 1 1 t 1 5 sin 0 8 t 0 001 1 2 sin 0 1 t 1 5 sin 0 1 t 0 1 0 02 sin 2 t 4 sin t n to facilitate comparison the ship parameters the initial values of position velocity and design parameters are chosen from the 5 1 section the simulation results are shown in figs 6 10 the curves of actual position x y and heading angle ψ versus time are shown in fig 6 the lateral position of the vessel arrives at the berth position x d 0 at 58 s but the longitudinal position y d 0 has not yet reached the target value and needs to be fine tuned through the propeller reversal until 210 s the heading angle ψ curve shows that the heading is stabilized at 180 from 0 during 0 s 90 s therefore the berthing time with time varying disturbances is significantly longer than non disturbances case of fig 1 the ship centerline position indicated by a red line changes smoothly as shown in fig 7 but compared with figs 2 and 7 has a smaller inflection point in the x y plane coordinates 1 5 l 2 3 l the main reason for this phenomenon is that the ship trajectory is affected by bounded disturbances moreover the location of this point coincides with the characteristics of the ship s position x y in fig 6 fig 8 shows that the propeller needs to be accelerated to achieve the auto berthing by turning to starboard when the initial u 0 5 m s obviously the u accelerates during 0 s 2 82 s and reaches a peak value of 0 786 m s at 2 82 s then slows down to nearly 0 m s at 56 s and remains stable since the sway speed v does not need to be large in the process of ship turning its value gradually decreases it decreases from 0 5 m s to 0 m s during 0 s 2 5 s then the direction of the sway is changed due to the ship s inertia the v reaches to 0 2 m s at 6 s then decreases and stabilizes with 0 m s gradually since the given initial yaw rate r is 0 5 rad s it gradually decreases to 0 2 rad s during the period of 0 s 0 9 s and increases to 0 23 rad s at 1 5 s it gradually stabilizes at 0 rad s at around 50 s compared with fig 3 the variation times of u v and r i e reaching the maximum value or stable value with disturbances are earlier than that of the undisturbed case this shows that the controller has robustness under external disturbances fig 9 shows the curves of surge control force t u and yaw control moment t r versus time t u reaches the saturation upper bound of 2 n during 0 s 2 8 s and reaches the saturation lower bound of 2 n during 3 s 7 7 s then due to the bounded disturbances the value is stable between 0 1 n and 0 066 n during 40 s 300 s v 0 reaches the saturation upper bound 1 5 n m during 0 s 1 1 s then decreases to 0 n m at 2 4 s since the heading is controlled by the reverse rudder angle then t r increases in a reverse direction and reaches 1 015 n m at 4 6 s finally it is adjusted back and is almost stable during 42 s 300 s obviously we can see that the t u and t r make control input fluctuate by the external disturbances fig 10 shows that the values of the adaptive parameters θ ˆ 1 and θ ˆ 2 are stable at 1 72 and 2 33 respectively which indicates that the control system is stable in summary from figs 6 10 we can see that under the external time variant disturbances the ship has good auto berthing performances which are consistent with the navigation practices and verify the effectiveness of the proposed control law furthermore to verify the applicability of our proposed scheme we change the initial conditions of ship position and velocity and keep the berthing target status and design parameters of the control law unchanged in simulation the initial conditions are taken as x 0 6 5 l y 0 5 85 l ψ 0 0 rad u 0 0 55 m s v 0 0 55 m s r 0 0 55 rad s the simulation results are shown in figs 11 and 12 fig 11 shows that the lateral position of the vessel arrives at the berth position x d 0 at 60 s but the longitudinal position y d 0 has not yet reached the target value and needs to be fine tuned through the propeller reversal until 250 s the heading angle ψ curve shows that the heading is stabilized at 180 from 0 during 0 s 95 s fig 12 shows the curves of surge control force t u and yaw control force moment t r versus time since the heading is controlled by the reverse rudder angle then t r increases in a reverse direction and reaches 1 36 n m at 5 5 s finally it is adjusted back and is almost stable during 50 s 300 s obviously we can see that the t u and t r make control input fluctuate by external disturbances in summary from figs 6 9 11 and 12 we can see that even if the initial conditions change the ship has good auto berthing performances under the external time variant disturbances thus the results show that the proposed control low has robustness to verify that the proposed control law can reduce the computational load the laboratory computers are used for the load tests of simulation in section 5 2 as shown of the test results in table 1 the computer memories used in the proposed algorithm is obviously reduced on average by 70 066 the main reason for this result is that the nn algorithm needs 122 adaptive parameters while the proposed algorithm only adopts 4 parameters θ 1 θ 2 λ ˆ and ω ˆ therefore the effect of the computational load reduction is obvious 6 conclusions to solve the problems of dynamic uncertainties and unknown bounded disturbances in the auto berthing control of the underactuated ship this paper uses the additional control method to solve the underacruated problem while a robust neural networks nn adaptive approach based on the navigation dynamic deep rooted information dri is proposed to reconstruct the dynamic and unknown disturbances moreover the dsc and mlp techniques are used to solve the computational load problem of adaptive nn control finally the simulation experiments with actuators input saturation are carried out to verify the effectiveness of the proposed algorithm however the auto berthing control method by using turn around way is a very complex engineering problem in the future the following work need to be carried out 1 it needs to be prove that the proposed control method does not apply to all the initial berthing position for the underactuated marine ship by using engineering practices and simulation experiments that is the safety zone of initial position for auto berthing control needs to be determined 2 it should be considered that the rudder effect can not be guaranteed when the underactuated ship is berthing at low speed in this work then the switching control of tugboats or thrusters can be further discussed 3 the control input is expressed by force moment rather than the propeller revolution rudder angle in this paper however the propeller revolution and rudder angle are more practical for ship officers and engineers in the berthing practice then taking the propeller revolution rudder angle as the control input is worth studying in addition the control scheme proposed can also be used for marine ship path following control and dynamic positioning control acknowledgments we are grateful to the reviewers for their valuable comments and suggestions to improve the quality of this article the authors would like to acknowledge the support from the key research and development projects of shandong province 2018ggx105014 2018ggx105003 2018ggx105002 and projects of shandong province higher educational science and technology program j18ka010 j18ka043 and a project of shandong province transportation science and technology program 2018b69 shandong jiaotong university phd startup foundation of scientific research and shandong jiaotong university climbing research innovation team program 
