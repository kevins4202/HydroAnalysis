index,text
7140,water use efficiency wue at the whole plant level plays as an important role as an indicator of both the water use strategy of the plant and the ecophysiological processes linking the carbon and water cycles however the variation in the annual pattern of wue the interannual trends and the regulating factors of wue in rubber plantations remain poorly understood here we used a four year 2013 2016 continuous biometric survey along with sap flow data recorded at a monthly resolution to examine the annual and interannual dynamics of wue and the relationships of wue with environmental and biological factors in rubber hevea brasiliensis plantations in southwest china the results showed that 1 there was no definitive pattern in wue between april and december but the peak wue values generally occurred around august 2 the multi year mean wue was 2 34 0 19 g c kg 1 h2o and a negative correlation of wue to photosynthetically active radiation was found at the interannual scale r 0 962 p 0 05 and 3 a moderate significant and parabolic relationship of wue with air temperature r 2 0 40 net radiation r 2 0 37 and growth rate of the diameter at breast height r 2 0 35 was observed at the monthly scale during the growing season p 0 001 these findings indicate that wue might be regulated by factors affecting the carbon sequestration rather than water consumption and it will provide a deeper understanding of the ecohydrological and coupled processes between the carbon and water cycles of rubber plants keywords biometric survey carbon gain coupled process sap flow water consumption 1 introduction the structure and function of terrestrial ecosystems are affected by anthropogenic impacts e g land transformation vitousek 1997 despite the environmental consequences associated with the conversion of rainforest into rubber tree hevea brasiliensis plantations more than 500 000 ha of rubber plantations in tropical southeast asia have been created over several decades to meet market demands mann 2009 ziegler et al 2009 approximately 40 of these plantations occur in the xishuangbanna prefecture southwest china there have been reports that since the establishment of these plantations local people have faced water shortages during the dry season which seldom occurred prior li et al 2008 qiu 2010 rubber plantations are often considered the cause of such shortages and have acquired the reputation of being water pumps due to perceived high levels of water consumption and strong negative impacts on local water resources giambelluca et al 2016 lin et al 2016 tan et al 2011 consequently the coupled processes between the carbon and water cycles are gaining increasing amounts of attention water use efficiency wue is used to describe the coupled processes of assimilating carbon from the atmosphere and transpiring water to the atmosphere dewit 1958 wue is a common indicator of the relative rates of these coupled processes baldocchi 1994 beer et al 2009 dewit 1958 ponton et al 2006 yang et al 2013 yu et al 2004 and has been widely used to evaluate the impacts of plant growth on water resources or to evaluate the water costs of components of the terrestrial carbon sink tong et al 2014 moreover wue can indicate the water use strategy of plants in different environments donovan and ehleringer 1991 tong et al 2014 although the application of this important index is partially limited because it has been defined in various ways mcvicar et al 2002 stanhill 1986 and is measured at a variety of spatial and temporal scales using different methods arneth et al 2006 bchir et al 2016 beer et al 2009 goulden et al 1996 nock et al 2011 these limitations are overcome when the wue is clearly defined in the present study both the carbon gain estimated from biometric surveys and biomass models withhighly accurate and broadly applicable ketterings et al 2001 tang et al 2009 and the water consumption evaluated using simple accurate and long term continuous sap flow observations granier et al 1990 saugier et al 1997 at the whole plant scale and on a monthly time scale were applied to assess the degree of the coupling between the carbon and water cycles despite the belief that rubber plantations cause water shortages little is known regarding the coupling between the carbon and water cycles in the case of rubber trees although the plantations represent a substantial carbon sink in this part of china chen et al 2011 song et al 2016 our specific objectives were 1 to analyse the dynamic patterns of wue during the growing season and the interannual trend of wue in rubber plantations and 2 to explore the environmental and biological factors that control the variation in monthly wue the results obtained from this study will i provide a baseline for subsequent studies on alternative cropping systems in the area and ii enable foresters and hydrologists to make rational decisions about the management of forests in water catchments in the study region and elsewhere in the tropics 2 materials and methods 2 1 study area our study site was in the xishuangbanna tropical botanical garden xtbg 21 55 30 n 101 15 59 e yunnan province southwest china fig 1 the original tropical forest of the xishuangbanna prefecture is an extension of the tropical forest of southeast asia zhu and yan 2009 but in recent years much of this forest has been replaced with rubber plantations the climate is strongly seasonal two air masses alternate throughout the year zhang 1963 the multi year 1994 2008 mean annual rainfall is 1504 mm and approximately 87 of the rainfall occurs during the rainy season the tropical southern monsoon from the indian ocean delivers most typically 75 of the region s annual rainfall from may to october the remaining rainfall occurs during the dry season which is dominated by the dry and cold air of the southern edges of the subtropical jet stream tan et al 2010 2011 the mean monthly rainfall during the dry season which is sometimes divided into the fog cool between november and february and dry hot march and april seasons zhang 1963 is less than 40 mm the mean annual temperature is 21 7 c and the mean monthly values range from 15 9 to 25 7 c tan et al 2010 the general topography consists of hilly terrain and lateritic soil ph 5 6 derived from siliceous rocks the characteristics of the four plots of the rubber plantations are shown in table 1 the rubber trees were planted 2 m apart in rows of mixed spacing between 4 m and 12 m the main rubber tapping period was from may to november fertilization with mineral fertilizer containing 15 n as nh2 2co 15 p as nh4h2po4 and 15 k as kcl was performed in april and july of each year zhou et al 2016 understory weeds and seedlings were removed by hand or using herbicides the rubber trees strongly responded to cold stress with a pattern of intense defoliation and dormancy for approximately 50 days between january and february as well as a slow recovery from dormancy in march unpublished data figs 3b c and s1 table s1 therefore we defined the growing season of rubber trees in southwest china as april to december thus defining the non growing season as january to march and our analyses related to monthly wue were restricted to these months 2 2 data collection 2 2 1 observations of environmental factors environmental variables including precipitation pre mm air temperature ta c photosynthetically active radiation par mol m 2 and net radiation rn mw m 2 were measured by sensors mounted on a 55 m tall micrometeorological tower that was established in xtbg in 2009 the microclimatic instruments included a rain gauge rain gauge 52203 r m young co usa and sensors for rn cnr 1 kipp zonen ned and par lqs70 10 apogee usa at a height of 28 6 m the water vapourpressuredeficit vpd hpa was calculated from ta and relative humidity which were monitored by a hydrothermograph hmp45c vaisala finland at a height of 28 6 m the surface soil water content swc was monitored using a soil water reflectometer cs616 l campbell sci usa at a depth of 5 cm all meteorological data were collected using a data logger cr1000 campbell sci usa every 30 min and averaged or summed to correspond with the monthly biometric survey and sap flow data 2 2 2 biomass measurements we randomly selected six rubber trees in each plot and observed their monthly growth of the diameter at breast height dbh m using metal bands we collected the litterfall by establishing ten randomly placed litter traps area of 0 5 m2 each to obtain the total dry weight of litterfall l g and measured the leaf area index lai m2 m 2 plant canopy analysers lai 2000 2200 licor usa near each litter trap we expressed the growth rate of the dbh dr as 1 d r i d b h i d b h i 1 d b h i 1 100 where dri is the growth rate of dbh in a specific month from january to december in a stated year and where dbhi and dbhi 1 m represent the dbh value of the corresponding month and last value of that month respectively additionally the dry weight of litterfall for rubber trees lw kg tree 1 was calculated as 2 l w i l i 2000 1000 n where lwi is the dry weight of litterfall kg tree 1 in a specific month li is the total dry weight of litterfall g in that month and n is the planting density trees ha 1 of the rubber plantations see table 1 to estimate the biomass of rubber trees we used the general regression equation from our previous reports tang et al 2009 as follows 3 w 0 136 dbh 2 437 where w is the total biomass per rubber tree kg according to the studies of pang 2009 and wang et al 2011 the mean carbon content of rubber trees and rubber latex are 48 6 and 30 0 respectively thus the incremental carbon sequestration δc kg tree 1 can be calculated from the following equation 4 δ c i w i w i 1 l w i 0 486 w l a t e x 0 30 n i where δci is the incremental carbon sequestration kg tree 1 in a specific month wi and wi 1 represent the biomass kg tree 1 value of the corresponding month and the last value of that month respectively wlatex is the total rubber latex kg that rubber trees can produce per tree per year according to multi year observations the yields of latex are 18 kg tree 1 year 1 and ni is the weight coefficient for specific months from may to november which is calculated in accordance with the incremental dbh during the same period by the following equation 5 n i d b h i d b h i 1 δ dbh i where dbhi and dbhi 1 represent the dbh m values for specific months from may to november and δdbh is the difference in dbh between the months of november and may 2 2 3 sap flow measurements the sap flow density of the same six rubber trees in each plot was measured using custom made heat dissipation sensors granier 1985 pairs of 20 mm long and 2 mm wide heating probes were inserted into the same facing side of the trunks of each rubber tree at a 1 3 m height above the stem base and were shielded from solar radiation thermal gradients and rainfall by reflective insulation the upper probe was heated with a constant power of 0 2 w and the lower probe was not heated and served as a reference for the upper probe with a distance of approximately 10 cm between the two sensor probes to avoid thermal interference the temperature difference between the two probes was recorded with copper constantan thermocouples using a data logger cr10x cr10xtd campbell sci usa to collect the data averaged and stored every 30 min after which the difference was used to calculate the sap flow density js g m 2 s 1 which was estimated according to the empirical calibration equation reported by granier 1985 6 j s 119 k 1 231 where k is a temperature constant determined as follows 7 k δ t m δ t δ t where δtm is the maximum temperature difference c at which time the sap flow density has reached its minimum value for a period typically 7 days in a row and δt is the instantaneous temperature difference c between the two sensor probes here to obtain the sapwood area as m2 we used our previous reported correlation relationship zhao et al 2014 as follows 8 a s 0 18776 dbh 0 01638 accordingly the instantaneous transpiration rate er g s 1 of a rubber tree was calculated as follows 9 e r j s a s then the transpiration e kg h2o tree 1 was calculated as follows 10 e i e r i 60 60 24 d i 1000 where ei is the transpiration in a specific month kg h2o tree 1 month 1 e ri is the mean transpiration rate of a rubber tree in that month g s 1 and di is the number of days in that month 2 2 4 calculation of wue the wue of a rubber tree was calculated from the water consumption per unit of carbon gain at the single tree scale tu 2007 during a specific period month season or year following previous authors el aou ouad et al 2015 medrano et al 2015 the calculation formula was as follows 11 w u e i δ c i 1000 e i where wuei is the water use efficiency g c kg 1 h2o in a specific month δc i is the incremental carbon sequestration in that month kg c tree 1 month 1 and ei is the transpiration in that month kg h2o tree 1 month 1 thus we obtained the annual wue and the monthly wue during the growing season from april to december using the above calculations 2 3 data analysis correlation analysis of the four annual mean values of wue and environmental and biological factors was performed using pearson correlation and 2 tailed tests of significance were used linear fitting and multiple linear regression analysis of wue and environmental and biological factors on a monthly time scale during the growing season between april and december were performed with significance testing with f statistics and plotted using origin 8 0 software 3 results 3 1 variations in annual and interannual wue and related factors during the four years of observations p re t a and swc each showed a pronounced annual pattern with the highest values occurring in the middle of the growing season fig 2 the lowest swc value occurred in april but the highest value was in august reflecting the variability in p re vpd par and r n fluctuated due to the tropical monsoonal p re from may to october vpd increased sharply in response to low p re and t a during the non growing season but decreased gradually following the onset of the growing season both par and r n increased smoothly as the solarazimuthangle increased there was a significant annual pattern in d r its values were greater than 0 10 per month during the growing season from april to december but close to zero during the non growing season fig 3b j s showed the same pattern as d r with both d r and j s peaking twice during the growing season fig 3b and c we found that unlike d r or j s wue did not exhibit a regular pattern generally it gradually increased from may until peaking around august during the four years of observations fig 3 among the four years of observations the annual wue ranged from 1 97 to 2 87 g c kg 1 h2o and the multi year mean value was 2 34 g c kg 1 h2o table 2 the annual swc t a vpd r n lai d r and j s changed little with mean values of 29 27 22 1 c 6 71 hpa 3730 mw m 2 year 1 3 04 m2 m 2 2 45 and 13 54 g m 2 s 1 respectively however there was large interannual variation in p re and par with values of 1315 269 mm year 1 and 8297 306 mol photons m 2 year 1 respectively during the four years of observations wue had a negative but non significant correlation with p re similar to the relationships of wue with j s and d r p 0 05 however wue significantly decreased with increasing par p 0 05 3 2 relationships between wue and related factors at the monthly scale wue showed a significant parabolic relationship with swc t a vpd par r n and p re p 0 01 but the coefficients of determination r 2 were generally low fig 4 relatively stronger and highly significant relationships were observed between wue and t a with a coefficient of determination of r 2 0 40 and between wue and r n with a coefficient of determination of r 2 0 37 p 0 001 fig 4b and e the maximum monthly wue occurred when swc t a vpd par r n and p re reached 30 8 27 c 7 6 hpa 833 mol photons m 2 month 1 340 mw m 2 month 1 and 260 mm month 1 respectively fig 4 in addition wue showed a positive correlation with t a and par withcoefficients of 0 60 and 0 50 respectively p 0 01 fig 4b and d regarding the biological factors js and dr tended to increase with lai with slopes of js and dr to lai were 2 83 and 0 66 respectively fig 5 a and c however dr exhibited a significant parabolic relationship with js with dr explaining approximately 46 of the variance in js p 0 001 fig 5b during the growing season from april to december the monthly dr and js showed similar relationships with wue with the monthly wue first increasing andthendecreasing with increasing dr and js however thesetransformations occurred when the monthly dr and js were approximately 0 45 and 15 g m 2 s 1 respectively p 0 001 fig 5e and f furthermore wue increased with dr with acorrelation coefficient of 0 57 p 0 001 fig 5e wue showed a trend of increase with increasing lai although the relationship was very weak and non significant r 2 0 02 p 0 2135 fig 5d multiple linear regressions of wue as a function of environmental and or biological factors were performed the results are shown in table 3 regardless of whether the environmental and biological factors were considered separately or together these factors could only explain approximately 35 of the variation in wue generally although these regressions were significant p 0 05 moreover the degree of interpretation in the variation in wue among these regressions was equal to or smaller than the degree that could be explained by individual variables i e ta rn and dr figs 4 and 5 table 3 4 discussion 4 1 patterns of annual and interannual wue no clear pattern of wue on a monthly time scale during the growing season from april to december was observed in this study but a peak wue occurred around august during the four years of observations fig 3 which is similar to the results generated in another study based on stable isotope methods wu et al 2016 in general the coupling between the carbon and water cycles of rubber trees gradually strengthened beginning in may perhaps to permit more carbon gain to produce fruit around august as the rubber trees develop leaves rapidly in march fig s1 and then produce flowers around april priyadarshan 2017 the wue data of selected evergreen broadleaved and tropical forests are summarized in tables 4 the mean wue of broadleaved forests is 2 78 g c kg 1 h2o which is close to the mean value reported by beer et al 2009 the mean wue of tropical forests is 2 87 g c kg 1 h2o which is much smaller than that reported by tan et al 2015 the low variation of wue among broadleaved forests might be due to the similarities among these forests in leaf morphology and structure e g they all have broad leaves with a strongly reflective glabrous surface furthermore these forests presumably evolve where there is an adequate supply of water without the need for strong water conserving mechanisms tan et al 2015 perhaps due to the advantages of a favourable thermal environment and an ample supply of water the average wue from tropical forests 2 87 g c kg 1 h2o is much higher than the multi annual mean value reported here for the rubber plantations in southwest china 2 34 g c kg 1 h2o table 2 this latter value is greater than the range of 0 67 2 01 g c kg 1 h2o reported previously for rubber plantations dey and vijayakumar 2005 nugawela et al 1995 priyadarshan 2017 rodrigo et al 2005 furthermore this value is much lower than the nine year average wue of 3 16 g c kg 1 h2o obtained previously in a primary tropical rainforest very close to the present study site tan et al 2015 this low value of wue might due to the origin of rubber trees in the wet tropics the over saturation in soil moisture did not favour carbon gain nugawela et al 1995 priyadarshan 2017 rubber trees have previously been shown to consume more water than other tree species in tropical forests giambelluca et al 2016 lin et al 2016 tan et al 2011 and the gross primary production of tropical forests has been reported to be greater than that of rubber plantations malhi et al 1999 song et al 2014 tan et al 2010 the response of wue to drought is a highly debated topic ehleringer and cooper 1988 liu et al 2015 niu et al 2007 wolf et al 2013 but we are able to tentatively infer how plants or whole ecosystems might react to drought by comparing data between dry and normal years a decrease in transpiration can lead to an increase in wue if photosynthesis can still maintain at a high level during a drought krishnan et al 2006 wolf et al 2013 although this possibility is debated beer et al 2009 reichstein et al 2007 liu et al 2015 concluded that moderate and extreme droughts reduced the annual wue in southern china while severe droughts slightly increased it in addition higher wue is observed under drier conditions ehleringer and cooper 1988 liu et al 2015 although previous studies reported that the spatial pattern of wue is mainly controlled by pre and that a strong relationship exists between annual wue and pre niu et al 2007 xiao et al 2013 yu et al 2008 a negative and non significant correlation r 0 332 table 2 was observed between annual wue and pre in the present study this result might be due to the short period four years of observations which may have been insufficient to reflect the pattern of interannual change the year 2014 was much drier 983 mm than the others table 2 however 2014 was not considered as a drought year per se and the decrease in pre in 2014 likely did not result in an increase in wue as the annual mean swc remained largely stable among the four years of observations table 2 additionally the rubber plants might adjust their strategy of water use to reduce transpiration loss and thereby avoid the effects of water stress priyadarshan 2017 interestingly rubber trees have a well developed root system to facilitate the uptake of deep ground water which they might use during dry seasons or years carr 2012 lin et al 2016 wu et al 2016 zhao et al 2014 4 2 factors controlling wue on the monthly time scale one difficulty in analysing wue on a monthly time scale involves the fact that growth may take place using carbohydrate reserves that were accumulated by photosynthesis in previous months the results of the analyses at the monthly scale for the growing season between april and december should therefore be viewed as suggestive rather than definitive however these results are valuable since little was previously known about the patterns of wue and related factors in rubber plantations and a limited amount of work had been conducted due to challenges involved in assessing growth and water use in hevea rubber plants priyadarshan 2017 to investigate the possible controls of wue in the present case environmental variables were related to wue by curve fitting fig 4 previous studies reported strong relationships of wue with both ta and pre at the interannual scale niu et al 2007 xiao et al 2013 yu et al 2008 however in the current study the only environmental variables to show significant relationships with wue were ta and rn which showed moderately strong parabolic relationships with wue at the monthly time scale fig 4b and e the net flux of radiant energy rn is often closely correlated with ta thus it is not surprising that wue was similarly correlated with ta and rn however wue generally increased as ta increased fig 4b similar to reports in temperate and subtropical forests song et al 2017 zhu et al 2014 but in contrast to findings in tropical and subtropical forests tan et al 2015 zhu et al 2014 moreover the increases in ta and par might have enhanced wue on a monthly scale whereas the other environmental factors were only weakly correlated with wue or had suppressing effects on wue fig 4 a potential explanation for these results is that these other factors controlled wue on a smaller time scale for example tan et al 2015 and yang et al 2009 reported that the wue strongly depended on vpd on the daily time scale however the strong correlation between wue and ta might reflect the expansion of rubber cultivation to sub optimal areas where the effect of swc or pre on growth dr is smaller than that of ta table s2 in addition neither the thermal environment nor the water supply was superior to that of native regions priyadarshan 2017 regarding the biological factors wue showed a stronger correlation with dr than that with lai at the monthly scale fig 5 this result conflicts with reports that lai was the crucial factor controlling wue beer et al 2009 hu et al 2012 although lai was more strongly correlated with js than that with dr fig 5a and c it showed no significant relationship with wue fig 5d the power of all the factors together in explaining the variation in wue was smaller than the power of the individual variables fig 4 table 3 i e ta which is an environmental factor both ta and dr could explain most of the variance in wue and ta was found to be the most correlated with dr figs 4b and 5e table s2 thus ta might control dr and hence wue since dr and js generally reflect the extent of carbon gain and transpiration of rubber trees respectively wue showed a stronger correlation with dr than with the remaining biological factors although it tended to be compromised when js exceed a certain threshold fig 5e and f furthermore wue and dr generally exhibited the strongest correlations with ta fig 4b table s2 these findings indicate that the coupling processes between the carbon and water cycles wue of the rubber plantations were mainly controlled by factors i e ta rn and par that affect the carbon sequestration rather than water consumption in southwest china 5 conclusions a pattern in annual wue characterized by peak values generally occurring around august was observed during the growing season from april to december the multi year mean wue of rubber plantations was markedly lower than the annual mean wue values reported for evergreen broadleaved and tropical forests however no definitive interannual pattern of wue was observed other than a negative correlation between wue and par wue was controlled more by ta rn and dr than by other factors regarding the biological factors dr was more correlated with ta as well as it could explain more of the variation in wue than js our results indicate that the coupling processes between the carbon and water cycles of the rubber plantations might be mainly controlled by factors that affect the carbon sequestration rather than water consumption in southwest china while the latter might tend to decrease the strength of the coupling processes when it exceeded a certain threshold acknowledgements we thank four anonymous reviewers and the journal of hydrology editorial team for helping improve this manuscript and we thank donghai yang xianhui tang ruiwu zhou huizhu mo huiling guan yun deng and hui chen for their assistance with the fieldwork this work was supported by xishuangbanna station for tropical rain forest ecosystem studies xstre and the public technology service center xtbg chinese academy of sciences cas this work was funded by the ministry of science and technology of china 2016yfc0502105 the national science foundation of china u1602234 31770528 41671209 the cas 135 project 2017xtbg t01 and the chinese academy of sciences president s international fellowship initiative 2017vca0036 appendix a supplementary data supplementary data associated with this article can be found in the online version at https doi org 10 1016 j jhydrol 2018 05 026 appendix a supplementary data supplementary data 1 
7140,water use efficiency wue at the whole plant level plays as an important role as an indicator of both the water use strategy of the plant and the ecophysiological processes linking the carbon and water cycles however the variation in the annual pattern of wue the interannual trends and the regulating factors of wue in rubber plantations remain poorly understood here we used a four year 2013 2016 continuous biometric survey along with sap flow data recorded at a monthly resolution to examine the annual and interannual dynamics of wue and the relationships of wue with environmental and biological factors in rubber hevea brasiliensis plantations in southwest china the results showed that 1 there was no definitive pattern in wue between april and december but the peak wue values generally occurred around august 2 the multi year mean wue was 2 34 0 19 g c kg 1 h2o and a negative correlation of wue to photosynthetically active radiation was found at the interannual scale r 0 962 p 0 05 and 3 a moderate significant and parabolic relationship of wue with air temperature r 2 0 40 net radiation r 2 0 37 and growth rate of the diameter at breast height r 2 0 35 was observed at the monthly scale during the growing season p 0 001 these findings indicate that wue might be regulated by factors affecting the carbon sequestration rather than water consumption and it will provide a deeper understanding of the ecohydrological and coupled processes between the carbon and water cycles of rubber plants keywords biometric survey carbon gain coupled process sap flow water consumption 1 introduction the structure and function of terrestrial ecosystems are affected by anthropogenic impacts e g land transformation vitousek 1997 despite the environmental consequences associated with the conversion of rainforest into rubber tree hevea brasiliensis plantations more than 500 000 ha of rubber plantations in tropical southeast asia have been created over several decades to meet market demands mann 2009 ziegler et al 2009 approximately 40 of these plantations occur in the xishuangbanna prefecture southwest china there have been reports that since the establishment of these plantations local people have faced water shortages during the dry season which seldom occurred prior li et al 2008 qiu 2010 rubber plantations are often considered the cause of such shortages and have acquired the reputation of being water pumps due to perceived high levels of water consumption and strong negative impacts on local water resources giambelluca et al 2016 lin et al 2016 tan et al 2011 consequently the coupled processes between the carbon and water cycles are gaining increasing amounts of attention water use efficiency wue is used to describe the coupled processes of assimilating carbon from the atmosphere and transpiring water to the atmosphere dewit 1958 wue is a common indicator of the relative rates of these coupled processes baldocchi 1994 beer et al 2009 dewit 1958 ponton et al 2006 yang et al 2013 yu et al 2004 and has been widely used to evaluate the impacts of plant growth on water resources or to evaluate the water costs of components of the terrestrial carbon sink tong et al 2014 moreover wue can indicate the water use strategy of plants in different environments donovan and ehleringer 1991 tong et al 2014 although the application of this important index is partially limited because it has been defined in various ways mcvicar et al 2002 stanhill 1986 and is measured at a variety of spatial and temporal scales using different methods arneth et al 2006 bchir et al 2016 beer et al 2009 goulden et al 1996 nock et al 2011 these limitations are overcome when the wue is clearly defined in the present study both the carbon gain estimated from biometric surveys and biomass models withhighly accurate and broadly applicable ketterings et al 2001 tang et al 2009 and the water consumption evaluated using simple accurate and long term continuous sap flow observations granier et al 1990 saugier et al 1997 at the whole plant scale and on a monthly time scale were applied to assess the degree of the coupling between the carbon and water cycles despite the belief that rubber plantations cause water shortages little is known regarding the coupling between the carbon and water cycles in the case of rubber trees although the plantations represent a substantial carbon sink in this part of china chen et al 2011 song et al 2016 our specific objectives were 1 to analyse the dynamic patterns of wue during the growing season and the interannual trend of wue in rubber plantations and 2 to explore the environmental and biological factors that control the variation in monthly wue the results obtained from this study will i provide a baseline for subsequent studies on alternative cropping systems in the area and ii enable foresters and hydrologists to make rational decisions about the management of forests in water catchments in the study region and elsewhere in the tropics 2 materials and methods 2 1 study area our study site was in the xishuangbanna tropical botanical garden xtbg 21 55 30 n 101 15 59 e yunnan province southwest china fig 1 the original tropical forest of the xishuangbanna prefecture is an extension of the tropical forest of southeast asia zhu and yan 2009 but in recent years much of this forest has been replaced with rubber plantations the climate is strongly seasonal two air masses alternate throughout the year zhang 1963 the multi year 1994 2008 mean annual rainfall is 1504 mm and approximately 87 of the rainfall occurs during the rainy season the tropical southern monsoon from the indian ocean delivers most typically 75 of the region s annual rainfall from may to october the remaining rainfall occurs during the dry season which is dominated by the dry and cold air of the southern edges of the subtropical jet stream tan et al 2010 2011 the mean monthly rainfall during the dry season which is sometimes divided into the fog cool between november and february and dry hot march and april seasons zhang 1963 is less than 40 mm the mean annual temperature is 21 7 c and the mean monthly values range from 15 9 to 25 7 c tan et al 2010 the general topography consists of hilly terrain and lateritic soil ph 5 6 derived from siliceous rocks the characteristics of the four plots of the rubber plantations are shown in table 1 the rubber trees were planted 2 m apart in rows of mixed spacing between 4 m and 12 m the main rubber tapping period was from may to november fertilization with mineral fertilizer containing 15 n as nh2 2co 15 p as nh4h2po4 and 15 k as kcl was performed in april and july of each year zhou et al 2016 understory weeds and seedlings were removed by hand or using herbicides the rubber trees strongly responded to cold stress with a pattern of intense defoliation and dormancy for approximately 50 days between january and february as well as a slow recovery from dormancy in march unpublished data figs 3b c and s1 table s1 therefore we defined the growing season of rubber trees in southwest china as april to december thus defining the non growing season as january to march and our analyses related to monthly wue were restricted to these months 2 2 data collection 2 2 1 observations of environmental factors environmental variables including precipitation pre mm air temperature ta c photosynthetically active radiation par mol m 2 and net radiation rn mw m 2 were measured by sensors mounted on a 55 m tall micrometeorological tower that was established in xtbg in 2009 the microclimatic instruments included a rain gauge rain gauge 52203 r m young co usa and sensors for rn cnr 1 kipp zonen ned and par lqs70 10 apogee usa at a height of 28 6 m the water vapourpressuredeficit vpd hpa was calculated from ta and relative humidity which were monitored by a hydrothermograph hmp45c vaisala finland at a height of 28 6 m the surface soil water content swc was monitored using a soil water reflectometer cs616 l campbell sci usa at a depth of 5 cm all meteorological data were collected using a data logger cr1000 campbell sci usa every 30 min and averaged or summed to correspond with the monthly biometric survey and sap flow data 2 2 2 biomass measurements we randomly selected six rubber trees in each plot and observed their monthly growth of the diameter at breast height dbh m using metal bands we collected the litterfall by establishing ten randomly placed litter traps area of 0 5 m2 each to obtain the total dry weight of litterfall l g and measured the leaf area index lai m2 m 2 plant canopy analysers lai 2000 2200 licor usa near each litter trap we expressed the growth rate of the dbh dr as 1 d r i d b h i d b h i 1 d b h i 1 100 where dri is the growth rate of dbh in a specific month from january to december in a stated year and where dbhi and dbhi 1 m represent the dbh value of the corresponding month and last value of that month respectively additionally the dry weight of litterfall for rubber trees lw kg tree 1 was calculated as 2 l w i l i 2000 1000 n where lwi is the dry weight of litterfall kg tree 1 in a specific month li is the total dry weight of litterfall g in that month and n is the planting density trees ha 1 of the rubber plantations see table 1 to estimate the biomass of rubber trees we used the general regression equation from our previous reports tang et al 2009 as follows 3 w 0 136 dbh 2 437 where w is the total biomass per rubber tree kg according to the studies of pang 2009 and wang et al 2011 the mean carbon content of rubber trees and rubber latex are 48 6 and 30 0 respectively thus the incremental carbon sequestration δc kg tree 1 can be calculated from the following equation 4 δ c i w i w i 1 l w i 0 486 w l a t e x 0 30 n i where δci is the incremental carbon sequestration kg tree 1 in a specific month wi and wi 1 represent the biomass kg tree 1 value of the corresponding month and the last value of that month respectively wlatex is the total rubber latex kg that rubber trees can produce per tree per year according to multi year observations the yields of latex are 18 kg tree 1 year 1 and ni is the weight coefficient for specific months from may to november which is calculated in accordance with the incremental dbh during the same period by the following equation 5 n i d b h i d b h i 1 δ dbh i where dbhi and dbhi 1 represent the dbh m values for specific months from may to november and δdbh is the difference in dbh between the months of november and may 2 2 3 sap flow measurements the sap flow density of the same six rubber trees in each plot was measured using custom made heat dissipation sensors granier 1985 pairs of 20 mm long and 2 mm wide heating probes were inserted into the same facing side of the trunks of each rubber tree at a 1 3 m height above the stem base and were shielded from solar radiation thermal gradients and rainfall by reflective insulation the upper probe was heated with a constant power of 0 2 w and the lower probe was not heated and served as a reference for the upper probe with a distance of approximately 10 cm between the two sensor probes to avoid thermal interference the temperature difference between the two probes was recorded with copper constantan thermocouples using a data logger cr10x cr10xtd campbell sci usa to collect the data averaged and stored every 30 min after which the difference was used to calculate the sap flow density js g m 2 s 1 which was estimated according to the empirical calibration equation reported by granier 1985 6 j s 119 k 1 231 where k is a temperature constant determined as follows 7 k δ t m δ t δ t where δtm is the maximum temperature difference c at which time the sap flow density has reached its minimum value for a period typically 7 days in a row and δt is the instantaneous temperature difference c between the two sensor probes here to obtain the sapwood area as m2 we used our previous reported correlation relationship zhao et al 2014 as follows 8 a s 0 18776 dbh 0 01638 accordingly the instantaneous transpiration rate er g s 1 of a rubber tree was calculated as follows 9 e r j s a s then the transpiration e kg h2o tree 1 was calculated as follows 10 e i e r i 60 60 24 d i 1000 where ei is the transpiration in a specific month kg h2o tree 1 month 1 e ri is the mean transpiration rate of a rubber tree in that month g s 1 and di is the number of days in that month 2 2 4 calculation of wue the wue of a rubber tree was calculated from the water consumption per unit of carbon gain at the single tree scale tu 2007 during a specific period month season or year following previous authors el aou ouad et al 2015 medrano et al 2015 the calculation formula was as follows 11 w u e i δ c i 1000 e i where wuei is the water use efficiency g c kg 1 h2o in a specific month δc i is the incremental carbon sequestration in that month kg c tree 1 month 1 and ei is the transpiration in that month kg h2o tree 1 month 1 thus we obtained the annual wue and the monthly wue during the growing season from april to december using the above calculations 2 3 data analysis correlation analysis of the four annual mean values of wue and environmental and biological factors was performed using pearson correlation and 2 tailed tests of significance were used linear fitting and multiple linear regression analysis of wue and environmental and biological factors on a monthly time scale during the growing season between april and december were performed with significance testing with f statistics and plotted using origin 8 0 software 3 results 3 1 variations in annual and interannual wue and related factors during the four years of observations p re t a and swc each showed a pronounced annual pattern with the highest values occurring in the middle of the growing season fig 2 the lowest swc value occurred in april but the highest value was in august reflecting the variability in p re vpd par and r n fluctuated due to the tropical monsoonal p re from may to october vpd increased sharply in response to low p re and t a during the non growing season but decreased gradually following the onset of the growing season both par and r n increased smoothly as the solarazimuthangle increased there was a significant annual pattern in d r its values were greater than 0 10 per month during the growing season from april to december but close to zero during the non growing season fig 3b j s showed the same pattern as d r with both d r and j s peaking twice during the growing season fig 3b and c we found that unlike d r or j s wue did not exhibit a regular pattern generally it gradually increased from may until peaking around august during the four years of observations fig 3 among the four years of observations the annual wue ranged from 1 97 to 2 87 g c kg 1 h2o and the multi year mean value was 2 34 g c kg 1 h2o table 2 the annual swc t a vpd r n lai d r and j s changed little with mean values of 29 27 22 1 c 6 71 hpa 3730 mw m 2 year 1 3 04 m2 m 2 2 45 and 13 54 g m 2 s 1 respectively however there was large interannual variation in p re and par with values of 1315 269 mm year 1 and 8297 306 mol photons m 2 year 1 respectively during the four years of observations wue had a negative but non significant correlation with p re similar to the relationships of wue with j s and d r p 0 05 however wue significantly decreased with increasing par p 0 05 3 2 relationships between wue and related factors at the monthly scale wue showed a significant parabolic relationship with swc t a vpd par r n and p re p 0 01 but the coefficients of determination r 2 were generally low fig 4 relatively stronger and highly significant relationships were observed between wue and t a with a coefficient of determination of r 2 0 40 and between wue and r n with a coefficient of determination of r 2 0 37 p 0 001 fig 4b and e the maximum monthly wue occurred when swc t a vpd par r n and p re reached 30 8 27 c 7 6 hpa 833 mol photons m 2 month 1 340 mw m 2 month 1 and 260 mm month 1 respectively fig 4 in addition wue showed a positive correlation with t a and par withcoefficients of 0 60 and 0 50 respectively p 0 01 fig 4b and d regarding the biological factors js and dr tended to increase with lai with slopes of js and dr to lai were 2 83 and 0 66 respectively fig 5 a and c however dr exhibited a significant parabolic relationship with js with dr explaining approximately 46 of the variance in js p 0 001 fig 5b during the growing season from april to december the monthly dr and js showed similar relationships with wue with the monthly wue first increasing andthendecreasing with increasing dr and js however thesetransformations occurred when the monthly dr and js were approximately 0 45 and 15 g m 2 s 1 respectively p 0 001 fig 5e and f furthermore wue increased with dr with acorrelation coefficient of 0 57 p 0 001 fig 5e wue showed a trend of increase with increasing lai although the relationship was very weak and non significant r 2 0 02 p 0 2135 fig 5d multiple linear regressions of wue as a function of environmental and or biological factors were performed the results are shown in table 3 regardless of whether the environmental and biological factors were considered separately or together these factors could only explain approximately 35 of the variation in wue generally although these regressions were significant p 0 05 moreover the degree of interpretation in the variation in wue among these regressions was equal to or smaller than the degree that could be explained by individual variables i e ta rn and dr figs 4 and 5 table 3 4 discussion 4 1 patterns of annual and interannual wue no clear pattern of wue on a monthly time scale during the growing season from april to december was observed in this study but a peak wue occurred around august during the four years of observations fig 3 which is similar to the results generated in another study based on stable isotope methods wu et al 2016 in general the coupling between the carbon and water cycles of rubber trees gradually strengthened beginning in may perhaps to permit more carbon gain to produce fruit around august as the rubber trees develop leaves rapidly in march fig s1 and then produce flowers around april priyadarshan 2017 the wue data of selected evergreen broadleaved and tropical forests are summarized in tables 4 the mean wue of broadleaved forests is 2 78 g c kg 1 h2o which is close to the mean value reported by beer et al 2009 the mean wue of tropical forests is 2 87 g c kg 1 h2o which is much smaller than that reported by tan et al 2015 the low variation of wue among broadleaved forests might be due to the similarities among these forests in leaf morphology and structure e g they all have broad leaves with a strongly reflective glabrous surface furthermore these forests presumably evolve where there is an adequate supply of water without the need for strong water conserving mechanisms tan et al 2015 perhaps due to the advantages of a favourable thermal environment and an ample supply of water the average wue from tropical forests 2 87 g c kg 1 h2o is much higher than the multi annual mean value reported here for the rubber plantations in southwest china 2 34 g c kg 1 h2o table 2 this latter value is greater than the range of 0 67 2 01 g c kg 1 h2o reported previously for rubber plantations dey and vijayakumar 2005 nugawela et al 1995 priyadarshan 2017 rodrigo et al 2005 furthermore this value is much lower than the nine year average wue of 3 16 g c kg 1 h2o obtained previously in a primary tropical rainforest very close to the present study site tan et al 2015 this low value of wue might due to the origin of rubber trees in the wet tropics the over saturation in soil moisture did not favour carbon gain nugawela et al 1995 priyadarshan 2017 rubber trees have previously been shown to consume more water than other tree species in tropical forests giambelluca et al 2016 lin et al 2016 tan et al 2011 and the gross primary production of tropical forests has been reported to be greater than that of rubber plantations malhi et al 1999 song et al 2014 tan et al 2010 the response of wue to drought is a highly debated topic ehleringer and cooper 1988 liu et al 2015 niu et al 2007 wolf et al 2013 but we are able to tentatively infer how plants or whole ecosystems might react to drought by comparing data between dry and normal years a decrease in transpiration can lead to an increase in wue if photosynthesis can still maintain at a high level during a drought krishnan et al 2006 wolf et al 2013 although this possibility is debated beer et al 2009 reichstein et al 2007 liu et al 2015 concluded that moderate and extreme droughts reduced the annual wue in southern china while severe droughts slightly increased it in addition higher wue is observed under drier conditions ehleringer and cooper 1988 liu et al 2015 although previous studies reported that the spatial pattern of wue is mainly controlled by pre and that a strong relationship exists between annual wue and pre niu et al 2007 xiao et al 2013 yu et al 2008 a negative and non significant correlation r 0 332 table 2 was observed between annual wue and pre in the present study this result might be due to the short period four years of observations which may have been insufficient to reflect the pattern of interannual change the year 2014 was much drier 983 mm than the others table 2 however 2014 was not considered as a drought year per se and the decrease in pre in 2014 likely did not result in an increase in wue as the annual mean swc remained largely stable among the four years of observations table 2 additionally the rubber plants might adjust their strategy of water use to reduce transpiration loss and thereby avoid the effects of water stress priyadarshan 2017 interestingly rubber trees have a well developed root system to facilitate the uptake of deep ground water which they might use during dry seasons or years carr 2012 lin et al 2016 wu et al 2016 zhao et al 2014 4 2 factors controlling wue on the monthly time scale one difficulty in analysing wue on a monthly time scale involves the fact that growth may take place using carbohydrate reserves that were accumulated by photosynthesis in previous months the results of the analyses at the monthly scale for the growing season between april and december should therefore be viewed as suggestive rather than definitive however these results are valuable since little was previously known about the patterns of wue and related factors in rubber plantations and a limited amount of work had been conducted due to challenges involved in assessing growth and water use in hevea rubber plants priyadarshan 2017 to investigate the possible controls of wue in the present case environmental variables were related to wue by curve fitting fig 4 previous studies reported strong relationships of wue with both ta and pre at the interannual scale niu et al 2007 xiao et al 2013 yu et al 2008 however in the current study the only environmental variables to show significant relationships with wue were ta and rn which showed moderately strong parabolic relationships with wue at the monthly time scale fig 4b and e the net flux of radiant energy rn is often closely correlated with ta thus it is not surprising that wue was similarly correlated with ta and rn however wue generally increased as ta increased fig 4b similar to reports in temperate and subtropical forests song et al 2017 zhu et al 2014 but in contrast to findings in tropical and subtropical forests tan et al 2015 zhu et al 2014 moreover the increases in ta and par might have enhanced wue on a monthly scale whereas the other environmental factors were only weakly correlated with wue or had suppressing effects on wue fig 4 a potential explanation for these results is that these other factors controlled wue on a smaller time scale for example tan et al 2015 and yang et al 2009 reported that the wue strongly depended on vpd on the daily time scale however the strong correlation between wue and ta might reflect the expansion of rubber cultivation to sub optimal areas where the effect of swc or pre on growth dr is smaller than that of ta table s2 in addition neither the thermal environment nor the water supply was superior to that of native regions priyadarshan 2017 regarding the biological factors wue showed a stronger correlation with dr than that with lai at the monthly scale fig 5 this result conflicts with reports that lai was the crucial factor controlling wue beer et al 2009 hu et al 2012 although lai was more strongly correlated with js than that with dr fig 5a and c it showed no significant relationship with wue fig 5d the power of all the factors together in explaining the variation in wue was smaller than the power of the individual variables fig 4 table 3 i e ta which is an environmental factor both ta and dr could explain most of the variance in wue and ta was found to be the most correlated with dr figs 4b and 5e table s2 thus ta might control dr and hence wue since dr and js generally reflect the extent of carbon gain and transpiration of rubber trees respectively wue showed a stronger correlation with dr than with the remaining biological factors although it tended to be compromised when js exceed a certain threshold fig 5e and f furthermore wue and dr generally exhibited the strongest correlations with ta fig 4b table s2 these findings indicate that the coupling processes between the carbon and water cycles wue of the rubber plantations were mainly controlled by factors i e ta rn and par that affect the carbon sequestration rather than water consumption in southwest china 5 conclusions a pattern in annual wue characterized by peak values generally occurring around august was observed during the growing season from april to december the multi year mean wue of rubber plantations was markedly lower than the annual mean wue values reported for evergreen broadleaved and tropical forests however no definitive interannual pattern of wue was observed other than a negative correlation between wue and par wue was controlled more by ta rn and dr than by other factors regarding the biological factors dr was more correlated with ta as well as it could explain more of the variation in wue than js our results indicate that the coupling processes between the carbon and water cycles of the rubber plantations might be mainly controlled by factors that affect the carbon sequestration rather than water consumption in southwest china while the latter might tend to decrease the strength of the coupling processes when it exceeded a certain threshold acknowledgements we thank four anonymous reviewers and the journal of hydrology editorial team for helping improve this manuscript and we thank donghai yang xianhui tang ruiwu zhou huizhu mo huiling guan yun deng and hui chen for their assistance with the fieldwork this work was supported by xishuangbanna station for tropical rain forest ecosystem studies xstre and the public technology service center xtbg chinese academy of sciences cas this work was funded by the ministry of science and technology of china 2016yfc0502105 the national science foundation of china u1602234 31770528 41671209 the cas 135 project 2017xtbg t01 and the chinese academy of sciences president s international fellowship initiative 2017vca0036 appendix a supplementary data supplementary data associated with this article can be found in the online version at https doi org 10 1016 j jhydrol 2018 05 026 appendix a supplementary data supplementary data 1 
7141,weather and climatic characterization of rainfall extremes is both of scientific and societal value for hydrometeorological risk management yet discrimination of local and large scale forcing remains challenging in data scarce environments here we present an analysis framework that separates weather regime and climate controls using data driven process identification the approach is based on signal to noise separation methods and explanatory extreme value ev modeling of multisite rainfall extremes the ev models integrate the temporal component of the weather climate driver using semi automatic parameter identification at weather scale the ev models are combined with a state based markov model to represent the spatiotemporal structure of rainfall as weather states at climate scale the ev models are used to search for drivers leading to the shift of weather patterns the drivers are brought out in a climate to weather signal subspace built via dimension reduction of climate model reconstructions we apply the framework to a complex terrain region the western andean ridge in ecuador and peru 0 6 s using ground data from the second half of the 20th century overall we show that the framework which does not make any prior assumption on the explanatory power of the weather and climate drivers allows identification of well known and new features of the regional climate in a purely data driven fashion thus the approach shows potential to identify weather controls on precipitation extremes in data scarce and orographically complex regions in which model reconstructions are the only climate proxies keywords rainfall extremes extreme value analysis multivariate analysis climatology complex terrain andes 1 introduction discrimination between climatic and weather drivers of heavy precipitation events is both of scientific and societal value particularly for hydro meteorological risk management for example improved prediction of extreme precipitation events in operational seasonal forecasting by means of dynamical climate models requires to understand whether a specific extreme event can be attributed to a specific weather regime or mode of climate variability world meteorological organization 2013 also the cost effective design of storm drainage facilities and financial compensating mechanisms e g rainfall based index insurance that build within the seasonal to interannual time range requires this scientific understanding in mountainous regions heavy precipitation events are often influenced by synoptic to meso scale conditions and orographic effects rotunno and houze 2007 neiman et al 2002 piaget et al 2015 the western andean ridge war in the tropical andes of ecuador and peru is a core of mixed climate influences as is both part of the climate divide and the gateway for pacific and amazonian influences emck 2007 rollenbeck and bendix 2011 there rainfall extremes are response to the cross season weather regime variability which is disrupted by climate anomalies such as el niño southern oscillation enso the war is suspected to modulate the year roundly weather mechanisms governing the distribution of rainfall intensities but their underlying physical ground is not yet understood due to a paucity of detailed studies and lack of long term meteo data a recurrent problem in many regions in the global south accordingly the discrimination of the weather and climate drivers of rainfall extremes over such data scarce orographic barrier remains rather evasive from both physical and data analysis perspectives present theories describing the regional climate patterns associated to heavy rainfall occurrence in the war and neighboring regions emerged from event based analysis during the el niño en episodes of the last decades for example horel and cornejo garrido 1986 goldberg et al 1987 and bendix and bendix 1998 discriminated two mechanisms that may generate convective systems i a local circulation driven by the differential land heating and ii extended instability regarding the ocean atmospheric setting linked to spatial differences in heavy rainfall during the en events bendix and bendix 2006 extracted 6 en like weather types all these theories are merely en snapshots of the regional climate in fact every en event is different and its diversity currently hotly debated arises from the interplay between ocean and atmospheric circulation chen et al 2015 this implies that the weather variability characterizing each event depends on the specific pattern of each en disturbance in the war a test of the climatological forcing hypothesis of extreme weather occurrences requires a statistical analysis framework that recognises in year and interannual oscillations and isolates abnormal extremes several statistical methods are found in literature for exploring relationships between climate forcing and hydrometeorological variables at the forefront multivariate techniques have been proven useful for analyzing covariance and isolating linear relationships between explanatory and response variables two well established methods are canonical correlation analysis cca hotelling 1936 and maximum covariance analysis mca wilks 2006 these methods tend to use dimension reduction techniques such as the singular value decomposition to isolate the leading spatial and temporal patterns and use those patterns to generate pairs of stationary spatial patterns whose temporal covariation produces the highest correlation cca and covariance mca in a least square error sense such approaches are appropriate for diagnosis and prediction of hydrometeorological variables aiming at the bulk statistical properties of normally gaussian distributed variables but are not ideally suited for exploring extremal properties in the tails of the joint distribution of the response variables extreme value ev theory provides the theoretical framework to investigate the extreme behavior of large geophysical extreme events since the seminal work by coles 2001 and katz et al 2002 many have used time varying ev models to analyze the natural variability of rainfall extremes across time scales in the spatial setting ev models whose parameters are common to all locations or are related to site covariates have shown to yield more robust estimates than single site models e g buishand 1991 sveinsson et al 2001 tye and cooley 2015 show that borrowing strength across multi site data improves the generalized ev parameter estimates also spatial models based on max stable processes allow characterization of spatial dependence of rainfall extremes e g shang et al 2011 thibaud et al 2013 when time varying ev models make use of covariates e g harmonic functions to represent cyclical effects and or a prescribed climate index to represent climate effects two conflating problems are commonly found in model development i they need prescription of a number of harmonic functions to allow making inferences from a simplified model ii they require automatic parameter estimation algorithms to explore complex parameterizations that might arise from a large pool of explanatory variables the prescription of the number of harmonic functions might over simplify the underlying seasonal process and the use of climate indexes might not provide explanatory power as they do not necessarily represent the climatic influence over a specific region renard and lall 2014 the second problem optimal parameter estimation suitable for non stationary generalized ev models ngev has been addressed by using step wise algorithms that combines forward selection and backward elimination procedures menéndez et al 2009 and automatic selection algorithms that identify only one parameter at a time based on a score perturbation criterion mínguez et al 2010 this automatic selection method enables to explore a large number of model parameterizations to discriminate weather and climate precursors of extremes however the issue on how to constrain the automatic parameter selection to yield statistical information on the process of interest is an important step in advancing the exploitation of this semi assisted modeling approach particularly on the face of mixed weather and climate influences here we present a statistical analysis framework to mine climate data and separate weather and climate controls using data driven process identification the framework integrates the temporal component of the weather climate driver into an explanatory ngev model this model enables to investigate the climatological forcing hypothesis leading to anomalous rainfall extremes the approach is applied to a latitudinal transect of the tropical andes in ecuador peru a region of mixed climatological influences but aims to be applicable in other regions these include data scarce settings where the climatological forcing can be inferred from climate model reconstructions 2 data 2 1 rainfall data daily time series 68 stations available for january 1964 december 2010 24 h totals starting at 19 00 local standard time lst were provided by the ecuadorian and peruvian meteo hydrological national services inamhi and senamhi and quality controlled by ochoa et al 2014 from this dataset 16 stations 200 2830 masl placed on the innermost plateaus in each catchment table 1 fig 1 b c were chosen these stations record year roundly synoptic activity due to their altitude and latitudinal distribution in this subset monthly maxima of daily precipitation pmax were extracted at each station fig 2 shows pmax series of representative stations the climate forcing e g driven by sea surface temperature sst anomalies is not conspicuous masked by seasonality at every location 2 2 climate data gridded monthly time series 1964 2010 of extended reconstructed sst version 3 smith et al 2008 were taken from noaa s climate prediction center this is a global dataset of merged land air and sst reconstruction with 2 latitude longitude resolution based on historical observations available since 1960 optimum interpolation analysis blended with advanced very high resolution radiometer sst version 2 reynolds et al 2007 with a 0 25 spatial and daily resolution available since september 1981 was also examined for comparative purposes ncep ncar reanalyses wind field data kalnay et al 1996 were used for synoptic investigation monthly aggregated wind fields with a horizontal grid spacing of 2 5 were extracted at two pressure levels 850 and 300 hpa the limitation of the reanalyses data is obvious and statements at the edge of the synoptic scale should be made carefully nevertheless combined with in situ measurements reanalyses data are invaluable in placing the local weather in the synoptic context especially in regions lacking synoptic long term meteorological observations 3 methods the overall workflow is presented in fig 3 the analysis framework builds on signal to noise separation methods hermus et al 2007 and involves two modeling levels seasonal and interannual variability of rainfall extremes the rainfall extremes are modelled by means of ngev distributions that separate weather climate drivers using a semi automatic parameter identification spi algorithm mínguez et al 2010 at weather seasonal level the strategy relies on modeling quasi stationary weather regimes using a finite set of harmonic functions this way the seasonal ngev models represent low pass filter models for high frequency variability isolating climate modes and can also be regarded as a spatial smoothing for local weather phenomena they further enable a cross season regimen diagnosis based on an existing weather state characterization pineda and willems 2015 the second level uses the full discriminatory power of the spi algorithm to search for climatic drivers of low frequency variability into a common climate to weather signal subspace to constrain model identification as means to yield information on the process of interest we search for ocean atmospheric counterpart drivers into an enhanced signal subspace built onto an ensemble of explanatory variables the climate to weather signal enhancement is obtained by projecting the filter seasonal models onto a subspace of signals that resembles the observational sample subspace in dimensionality the dimension and basis vectors of the signal subspace are derived by eigen singular value decomposition evd svd wilks 2006 of the noisy multisite pmax and climate observation matrices respectively 3 1 climate to weather signal separation method subspace based signal to noise separation methods assume that every enhanced signal vector s can be written as a linear combination of p q linearly independent basis functions mi i 1 p 1 s m y where m is a q p matrix containing the basis functions and y is a length p column vector containing only the weights under these assumptions the d dimensional observational space can be split into two subspaces a p dimensional signal noise and a q p dimensional subspace that contains only noise the orthogonal decomposition into signal and noise subspaces can be performed by an evd more generally by an svd of the noisy observation matrix hermus et al 2007 let ps n pmax1 1 pmax2 t pmaxn t n 1 n stations and t 1 t observations be a multivariate vector of multisite monthly maxima of daily precipitation pmax samples representing the noisy observation matrix e g n 16 and t 552 months over the war and ps the multivariate vector containing the clean climate signal and pn the zero mean white noise that is assumed to be uncorrelated with the clean climate signal then the observational noisy sample can be expressed as 2 p s n p s p n further let r be the autocorrelation matrix of ps n the evd of ps n is then given by 3 p s n v λ v t with λ a diagonal matrix containing the eigenvalues λ j and v an orthonormal matrix containing the eigenvectors v then the order of the p dimension might be assumed being equal to the number of positive eigenvalues of r or to a value such that the energy of the enhanced signal is as close as possible to an estimate of the clean signal energy see section 3 1 in hermus et al 2007 the order of the q dimension is more difficult to setup a priori due to limitations for making an estimate of the noise variance however in general it should be greater than the order of p such that the separation into signal and noise subspaces is possible depending on the nature of embedded noise a conservative choice is to set q equal to 2 p or 3 2 p van huffel 1993 hermus et al 2007 fig 4 shows the scree plot for the evd of ps n the spectrum of noisy eigenvalues λ j exponential decay of λ stretches out up to the 15th dimension empirical orthogonal function eof accordingly the enhanced climate to weather signal will be contained in a high dimensional signal to noise vector subspace spanned by linear combinations of the basis functions contained in the matrix m eq 1 the assumption of a low rank linear model for the enhanced signal and the availability of an estimate of the noise correlation matrix enable to perform a filtering operation by which the clean signal is obtained several optimization criteria exist to perform the signal enhancement see hermus et al 2007 of particular relevance for the signal enhancement of the matrix ps n is the svd based method van huffel 1993 in which the p dominant singular values of ps n are mapped onto the original clean singular values of ps in the proposed framework such svd based noise reduction operation is analogous to the spi learning process in a prescribed parameter subspace see section 3 3 whose dimension is estimated using information of the ps n matrix 3 2 non stationary gev model we propose a nested ngev model that encompasses traditional ev models for non stationary variables coles 2001 the pmax series observed in month t follow a gev distribution with time varying gev location μ t scale α t 0 and shape ξ t parameters the cumulative distribution function cdf of pmax is given by 4 f t pmax exp 1 ξ t pmax μ t σ t 1 ξ t ξ t 0 exp exp pmax μ t σ t ξ t 0 the gev distribution includes three families the gumbel family ξ 0 the fréchet family ξ 0 and the weibull family ξ 0 the ngev model fit at each site includes only seasonal μ t s and interannual μ t i effects in the time varying location and scale parameters 5 and 6 the shape parameter is constrained to represent only seasonal effects 7 it is well established that this parameter shows large scales of variability hence long term increasing decreasing trends are not considered thus 5 μ t μ t s μ t i 6 σ t σ t s σ t i 7 ξ t ξ t s 3 2 1 weather seasonal ngev model the seasonal ngev model formulation by mínguez et al 2010 is used to summarize the spectrum of high frequency weather regimes in terms of harmonic models of slowly varying amplitude the formulations in eqs 8 10 allow the spi algorithm to identify the optimal number of harmonic functions to be included in the time dependent parameters mathematically the model is expressed as follows 8 μ t s β 0 i 1 p μ β 2 i 1 cos i ω t β 2 i sin i ω t 9 log σ t s 0 i 1 p σ 2 i 1 cos i ω t 2 i sin i ω t 10 ξ t s γ 0 i 1 p ξ γ 2 i 1 cos i ω t γ 2 i sin i ω t where t is given in years β 0 α 0 and γ 0 are the mean values of the gev parameters β α and γ βi αi and γi i 0 are the amplitudes of the harmonics ω 2π year 1 pμ pσ and pξ determine the number of optimal sinusoidal harmonics in a year 3 2 2 climate interannual ngev model in general terms the climate to weather subspace can be constructed by i inferring the subspace s order from the noisy observation matrix eq 3 and ii setting up its basis vectors as to capture the spectrum of energized basis vectors representing climate drivers this will ultimately shape the properties of the desired underlying climate signals in the war nearby ssts variability is a natural proxy candidate for moist convection while winds of the lower and upper troposphere represent large scale atmospheric moisture import section 4 3 thus the basis vectors of the climate to weather signal to noise subspace q dimensional order are derived via a svd of observed ocean and atmospheric anomalies as follows 1 yearly anomaly composites sep aug are constructed for the sep 1964 aug 2010 period for ssts and wind fields zonal u and meridional v components interpolated to 0 25 resolution at two pressure levels 300 hpa and 850hpa representing the upper and lower circulations respectively to construct these composites the sep aug climatology is firstly subtracted from each monthly sst u v field n 552 months for each grid point and then standardized yielding yearly sst u v anomalies ssta ua and va in this way these ssta ua and va composites represent interannual deviations from the in year cycle 2 svd is performed separately for each ssta ua and va composite we conduct the svd analysis based on the covariance matrix of the re gridded anomaly fields let x t x 1 t x 2 t x p t be a n p data matrix where x i t i 1 p t 1 n is a vector containing n monthly anomalies of the i th centered predictor and p is the number of predictors for example for ssta p 162 grid points cover the region 6 n 14 s 106 w coastal line the eofs are then obtained by 11 ssta i t j 1 p e z j t i 1 p t 1 n where zj are the eof score series and e is the j th eigenvector of the covariance matrix 12 s 1 n 1 x t x a crucial assumption here is that yearly ocean atmosphere anomalies can be linearly decoupled into signal and noise this hold for ssta few interpretable eofs but it is not straightforward for the atmospheric circulation see appendix b 2 which needs to be supported by a truncation criterion see north et al 1982 fig 5 shows the probability density function of the ssta eof scores the energy of the eof scores dissipates from the clean climate signal to zero mean weather like white noise the eof scores were truncated to eofmax 7 being the maximum number of eofs containing non random signal this yields an assembled m q q matrix q 5 eofmax containing the basis vectors for the climate to weather signal subspace in this reduced subspace we let the spi algorithm to separate climate from weather parameters by restricting the climate signal to occupy only the signal subspace while nulling its components in the noise subspace note that we only make assumptions on the nature of the climate drivers any noise filtering technique requires assumptions on the interfering signals but we do not make any prior assumption on their power as explanatory covariates based on the above considerations and under the assumption of a low rank linear model for climate signal and weather white noise we propose the following nested explanatory ngev model parameterization 13 μ t μ t s j 1 eof max β eofj ssta j t β eofj ua j t β eofj va j t 14 log σ t t s j 1 eof max eofj ssta j t eofj ua j t eofj va j t where t is given in year the parameters βeofj and αeofj represent the influence on the location and scale parameters per unit of standardized ssta j zonal ua j and meridional va j components of the lower and upper circulation on a particular instant t for any ngev model including pμ pσ pξ harmonic functions i 1 pμ pσ pξ and eofj time coefficients of the svd j 1 eof max the parameter vector θ can be represented by 15 θ β 0 β i β eofj ssta β eofj ua 850 β eofj va 850 β eofj ua 300 β eofj va 300 α 0 α i α eofj ssta α eofj ua 850 α eofj va 850 α eofj ua 300 α eofj va 300 γ 0 γ i the instantaneous quantile pq associated with the return period 1 q can be calculated using 16 p q μ t σ t ξ t μ t σ t ξ t 1 log 1 q ξ t ξ t 0 μ t σ t log log 1 q ξ t 0 where the probability q is given by ft p 1 q approximate standard error for the estimators and confidence intervals for parameters are obtained using standard likelihood theory coles 2001 see appendix a 3 3 climate to weather separation algorithm the spi algorithm by mínguez et al 2010 selects the parameters which minimize the akaike information criterion aic using the maximum likelihood method within an iterative scheme the selection is based on sensitivity analysis which makes use of local derivative information to identify the parameter producing the largest perturbation at each iteration we use the spi algorithm to learn weather climate parameters because of the following reasons i at weather scale it fits the best harmonic ngev model to data by adding to the stationary null model one harmonic two parameters per iteration until no further decrease of the aic is achieved the upper cut off for parameterization being score test statistics this defines a pseudo only noise model subspace orthogonal to the clean signal subspace ii at climate scale the construction of the perturbation criteria allows selecting the parameter that potentially produce the greater decrement of the aic per iteration and corresponds to the one with maximum score test statistics this selection is possible because an optimal solution of the log likelihood function can be derived and different sets of possible parameters θ 1 θ 2 θ l scrutinized see section 3 1 in mínguez et al 2010 thus the spi algorithm is well posed to bring out model parameters in a multivariate vector subspace of covariates which more in general can be seen as the svd based noise reduction operation van huffel 1993 to enhance damped exponential signals embedded in white noise of the ps n matrix 3 4 performance we assess both at site ngev models using criteria for explanatory modeling shmueli 2010 and its performance as svd filter models while the former can be deemed as an at site assessment the latter enables to identify model structures and make inference from their coefficients which in turn allows to explore the interfering signals in the tail of the join distribution of ps n model validation and selection proceeds as follows i validation of ngev model to assess model fitting we use adapted probability and quantile goodness of fit diagnostic plots méndez et al 2007 coles 2001 we also asses the generalization power i e predictive qualities of the explanatory ngev models using leave one year out cross validation metrics this is carried out in the following manner 1 the first response p q 1 and covariates ssta1 ua1 and va1 are removed from the observed datasets 2 the ngev model is fitted to the remaining n 1 responses and covariates 3 the covariates ssta1 ua1 and va1 are used to estimate the first quantile response from the model developed in 2 and 4 the process is repeated for each of the remaining paired responses and covariates the cross validation was constructed for each saturated ith order climate model ii empirical validation of svd filter models in practice the assessment of signal enhancement methods assumes that both clean and noise observation matrices are observable this allows derivation of theoretical estimators to quantify the efficiency of any noise reduction filter against an upper bound of performance in our implementation it would be ideal to derive such a theoretical estimator and benchmark the svd noise filtering operation against a metric of optimal performance this is however not possible without the possibility of observing in real world data the clean climate signal the ps matrix we therefore assess the amount of noise removal by computing empirical signal to noise snr ratios using the ensemble of instantaneous quantile pq responses yield by the weather and climate models empirical snrs are calculated using 17 snr σ signal 2 σ noise 2 where σ noise 2 and σ signal 2 are computed from the multivariate vectors of pq seasonal and interannual responses generated by the saturated weather models white noise assumption and the ith order climate filter models respectively iii selection we use an adapted likelihood ratio test towler et al 2010 to discern model structures among competing nested models let us consider a model m i s i i 1 n a sub model of the saturated ith seasonal interannual m i 1 s i and llhi m i s i and llhi 1 m i 1 s i are the maximized values of the log likelihood for the sub and saturated models respectively the deviance d statistic can be calculated as 18 d 2 llh i 1 m i 1 s llh i m i s if d cα where cα is the 1 α quantile of the χ k 2 distribution then m i s i can be rejected in favor of m i 1 s i here α is the level of significance χ k 2 is as large sample approximation and k are the degrees of freedom associated with the test nested models are tested at the α 0 05 significance level against the corresponding sub models for each test the degrees of freedom for the climate and seasonal models are k 1 and 2 with cα values of 3 84 and 5 99 respectively also the climate model s performance was evaluated against corresponding null models e g model including ssts vs seasonal only model see table 2 to assess how well the coupling of ocean and atmospheric covariates captures the extremes 3 5 weather and climate characterization the interannual variation in the time dependent quantile δpq can be calculated as 19 δ p q p qc p qs where pqc is the climate and pqs the seasonal dependent quantile calculated using only the seasonal parameterization both pqc and pqs are simulated from strictly hindcast models that is using the parameterization withheld from the saturated models in 8 10 and 13 14 which represent the time dependent quantile response to the spectrum of weather and climate drivers next we use the seasonal dependent quantile pqs in conjunction with a weather state characterization derived by calibrating a hidden markov model hmm to a network of daily rainfall observations including those in the war pineda and willems 2015 to elucidate in season regime fluctuations the hmm decomposes the observed spatio temporal rainfall variability over a network of observations via a discrete set of hidden states each state comprises a set of rainfall probabilities and wet day distribution functions for all locations in the network the states proceed on a daily time step following a first order markov process these characteristics enable the hmm to represent both spatial covariance over the network and persistence of large scale weather patterns which can be associated with the states it is thus well suited for the representation of daily rainfall in climate regimes that can be characterized in terms of variably persistent large scale weather patterns the use of weather states which implicitly account for spatial covariance in the form of the rainfall patterns associated with each state is consistent with a nonlinear dynamical view of the weather within climate in which the states represent basins of attraction toward which trajectories in the climate phase space are drawn lorenz 1963 palmer 1999 pineda and willems 2015 argue the existence of four hidden hygrothermal moisture states in the war hereafter called weather types wts which capture the in season rainfall spatiotemporal structure they reported these moisture states as the number of days falling in each wt here to quantify wt fluctuations the number of days was normalized to pqs and split into sub seasons to characterize climate drivers leading to the amplification dampening of wts we assess statistical significant spi identified parameters in terms of effect sizes and spatial consistence this latter is done by normalizing the parameters by their corresponding eof standard deviation then they are mapped and linked with their corresponding eof structures to allow interpretation of the synoptic driver 4 case study 4 1 the western andean ridge war and the regional climate setting the war 0 6 s is a transect of the tropical andes of unique characteristics the two meridional oriented ranges merge into one mass of rugged lower elevation peaks at 4 s the so called andean depression fig 1c the ridges down to the coast branches a series of heterogeneously oriented catchments we apply the framework on 11 west facing catchments along the war each one representative for a catchment weather regime the war is lower bounded by the region which recorded the greatest annual rainfall anomalies during en episodes fig 1a b rossel and cadier 2009 4 2 weather regimes in the war weather regimes might be differently accentuated during normal years and episodes of surplus deficit of oceanic moisture driven by sst anomalies in the eastern equatorial pacific bendix 2000 pineda and willems 2015 propose the following wts i excess ii deficit of moisture offshore of the war the wet dry states wt1 wt2 iii advection embedded in easterlies emanating from the amazonia the transitional wet dry state wt3 and iv moisture export from the inter tropical converge zone itcz displacement and eastward expansion of the south american monsoon the dynamically noise state wt4 4 3 regional climate large scale moist convection is primarily organized by the itcz which varies approximately in synchrony with the nearby ssts the spatial domain in which ssts variability influence heavy rainfall events spans from 6 n 14 s and 106 w coastal line e g bendix 2000 bendix and bendix 2006 pineda et al 2013 this domain embraces the eastern equatorial pacific where the en and humbolt currents meet the en 1 2 and a great portion of the en 3 regions bendix et al 2011 trenberth 1997 to obtain a synoptic scale perspective for the atmospheric circulation the domain 8 n 15 s and 65 105 w was selected takahashi 2004 and douglas et al 2009 showed that heavy rainfall in the war s coastal area had a strong westerly wind component whose anomalies extended 3500 1000 km off the coast a description of the regional climatology is presented in emck 2007 and more generally for the tropical atmospheric circulation in peters and ritcher 2014 table 3 summarizes results of the svd analysis on composite anomalies of the extended reconstructed sst and ncep ncar reanalyses of horizontal wind fields of the lower 850 hpa and upper 300 hpa troposphere we rank the spatial patterns fig 17 of the most conspicuous eofs emerging from the svd analysis of ssts lower and upper wind anomalies as i weak moderate the el niño en type ii strong the en type iii normal rainy season and iv cold upwelling like sstas for example the eof3 score series of ssta fig 6 shows that the highest amplitudes and their persistence correspond to the 1997 98 and 1982 83 ens a greater description and interpretation of the major climate patterns influencing the war is presented in appendix b 5 results and discussion 5 1 ngev model validation fig 7 shows the fitted ngev models to the monthly maxima of daily precipitation pmax on a key high altitude station sus highlighting unusual rainfall extremes during 14 en events after the inclusion of covariates ssta ua and va into the saturated best interannual model the estimation of high rainfall intensities e g en outliers improves clearly confidence bands are wider for the best interannual model against the more parsimonious best seasonal model quantile plots for the best seasonal and interannual models fig 8 shows that both weather and climate models perform well with respect to the given data there is improvement for most of the models incorporating climate covariates especially for high rainfall intensities fig 9 shows the spi parameter identification sequence and results of the leave one year out cross validation for the ith order increasing climate models pearson s correlations between the cross validated quantiles pq and observations are lower than their cross validated counterparts computed from the null weather model mi seas 0 694 0 691 0 588 0 719 0 66 0 672 0 619 and 0 612 for pto sma cor cal chi pal sus and gir respectively thus correlations decrease with model order implying some degree of overfitting this is not surprising when assessing predictive power of explanatory models since a parsimonious but less true model can have a higher predictive validity than truer but less parsimonious model this is because the former seeks to minimize the combination of bias and variance errors occasionally sacrificing theoretical accuracy see section 1 5 in shmueli 2010 by definition explanatory models are intended to fit data for theory building rather than to describe data structure parsimoniously as it would be awaited from predictive models nevertheless even in the presence of high order saturated or overfitted models pearson s correlation computed on the holdout datasets remains above 0 50 showing that explanatory models hold also some predictive qualities fig 10 shows estimates of the percentage of snr removal after application of the ith order increasing climate filter model models empirical snrs values larger than 100 show the gain on signal detachment with respect to the weather noise models m0 the sst filter model shows a large snr value because the ensemble of instantaneous quantile pq responses yielded by sst only filter models accounts for much of variability energy see fig 5 of the embedded signal in the ps n thus we consider such snr as the optimal estimator to benchmark the efficiency of noise reduction yielded by sst plus wind filter models for the ensemble of quantile responses generated by the coupled sst plus wind models the percentage of detached signal is lower due to the noise added for the models incorporating winds we note that the percentage of snr removal reaches an inflection point at about m10 then after the gain in signal detachment is minimal in any case at the highest order model m25 the gain on signal detachment is about half of the one obtained for the sst only filter model which we consider as a proxy for optimal signal detachment 5 2 selection of covariates figs 11 and 12 shows the spi parameter identification sequence and the significance p values of seasonal and interannual parameters against model order obtained from the likelihood ratio test for nested models e g single harmonic model m1 vs null stationary model m0 for the seasonal models and single climatic term m1 vs null weather model m0 for the climate models the number of parameters increases by two per added sinusoidal harmonic and one per added climatic term for the weather and climate models respectively in general terms likelihood ratio test statistics p values provides the basis to include trim covariates in nested models in the proposed framework however the selection of meaningful variables is performed in a constrained manner guided by the statistical significance of causal covariates and also by the size and spatial consistence of their coefficients this renders the theoretical justification for analysing covariates effects on the tails of the joint distribution of ps n section 5 3 table 2 shows the performance of different nested ngev model levels and the likelihood ratio test between saturated and null sub models models including sst and wind parameters are found significant and outperform sub models however for pal and sus the inclusion of both sets of covariates yields models with the same number of parameters as those obtained by models including only winds thus the latter models show overfitting effects when ssts are disregarded in most cases sub models show the highest pearson s correlation between the hindcasted time dependent 50 year return period quantile pmax50 and observations by construction the ngev models result in complex parameterizations harmonic terms for seasonality and mixed climatic terms for interannual variability while the first one accounts for the stochastic nature of weather the second one represents the deterministic sea and or wind signal hidden in the tail of the distributions of ps n namely climate covariates identified this way result from a regression fitting into a high dimensional orthogonal to the weather subspace note that some might argue such climate to weather subspace for parameter learning is over specified and prone to overfit models when exploring the pool of causal covariates as mentioned above overfitting is indeed plausible in this modeling approach as it arises from the methodological assumptions the existence of low rank linear model for climate signal this has however not damming effects for the modeling framework since the goal is to test all causal hypothesis upon theoretical constructs besides the spi algorithm attempts to minimize overfitting effects by selecting the parameter that potentially produce the greater decrement of the aic the most influent one in each fitting iteration and at the end it provides with t statistics standard errors and the log likelihood function for each parameter estimate from which one can compute likelihood ratio tests to justify inclusion exclusion of covariates and so infer the true structure of the models 5 3 weather drivers of seasonal variability figs 13a c and 14 illustrate the dec may weather type characterization in terms of the thermally driven wt1 transitional wet dry wt3 and dynamically noise wt4 wet states and the dry state wt2 at dec jan feb mar and apr may sub seasons table 4 shows the parameters of the saturated seasonal models for pmax below we discuss model structural differences fig 15 left panels in terms of i the seasonal pmax50 ii the mean intensity of pmax seasonal location parameter and iii the dispersion of the underlying process seasonal scale parameter the seasonal shape parameter reflecting the strength of the in year variability is presented only for information on the tail behaviour 5 3 1 northern war 0 1 5 s the mean intensity of pmax50 fluctuates in the range of about 120 170 mm within jan apr e g in pto this inter month variability is captured by complex parameterizations for μ t at pto and σ t at sma the ξ t shows a bounded tail ξ 0 during the entire rainy season terrain elevation only attenuates the mean intensity μ t e g chi whereas the in year variability σ t remains similar to that seen in lowlands this reveals a dec may season lasting distribution of rainfall extremes we argue that i this is due to deep convection embedded in the itcz wt4 and high frequency re evaporation cycles driving wet dry spells wt3 over the war s top e g sma in fig 14 and ii this mechanism holds in the northern valleys 0 1 5 s where north and south catchment boundaries are less pronounced fig 1 5 3 2 central war 2 2 5 s mean rainfall extremes are lower pmax50 peaks of about 75 mm with the largest amplitude centred within feb mar the parameter μ t describes a prominent feb mar sub season at pal the parameters σ t and ξ t represent early fluctuations in sep oct and light tail behaviour respectively the simplest model is encountered for sus with only 1 harmonic for the σ t and a near zero value for the ξ t describing a smooth annual cycle note that sus lies in a uniquely west east oriented catchment we will later show when unveiling the synoptic drivers that in this particular catchment rainfall extreme anomalies are driven by year round mixed wind circulation patterns 5 3 3 southern war 3 15 5 s highland stations on the inner war axis are described by the model structure at gir the parameters μ t σ t and ξ t shifting to negative values within nov dec show a quasi bimodal distribution featuring the occurrence of thunderstorms at the beginning of the rainy season and likely triggered by overhead sun in end of sep oct emck 2007 the μ t at gir fig 13d shows that mountain valleys in jubones catchment are spots of low rainfall intensities conversely west of the inner war axis at 3 5 5 s deep convective regimes weaken because the high concentration of peaks branching v shaped valleys inhibits large scale organized convection e g contraction of the wt4 in pte fig 14 hence zar ala and sto exhibit symmetric and enhanced peaks in feb mar which are attenuated in the andean depression e g zar and sto emck 2007 reported a high concentration of convective showers nearby ala within feb apr which we prove being more local and thermally driven wt1 rather than of oceanic or large scale organized genesis 5 4 climate drivers of interannual variability in principle the climate forcing should emerge from a subspace of highly correlated signals which in our implementation are eof time coefficients of ocean atmospheric circulation anomalies retrieved by the spi algorithm by preserving the climate signal sea and or wind component on low order models while nulling weather terms on high order models table 5 shows the absolute values of the identified location and scale parameters for ssta u va 850 hpa and u va 300 hpa fig 16 shows normalized parameter coefficients for the interannual pmax50 they represent the contribution of each standardized eof score to the location and scale parameters and are visualized as absolute values for ssta and vectors for u va 850 hpa and u va 300 hpa below we describe statistical significant and spatial coherent parameters together with the time dependent 50 year return period quantile s interannual variation δpmax50 fig 15 right panel to illustrate conspicuous drivers identified by the framework as well as to formulate statistically informed hypothesizes on the climate forcing 5 4 1 northern war 0 1 5 s pto in vinces catchment shows the largest interannual variation δpmax50 driven by low level southerly winds crossing the equator beta eof7 typical for weak en situations bendix and bendix 2006 bendix et al 2011 these winds would convey moisture of the weak moderate en ssta type beta eof1 towards the northern war at sma the largest anomaly originates from the low level meridional wind component of the normal rainy season beta eof3 whereas the strong and weak moderate en ssta type alpha eof3 and eof1 contributes marginally thus moist instability originated from strong ssta gradients off the war s coast appears dimly along the low ridge valley line it lacks of advection wind driver most importantly the ns oriented cordillera 2500 masl becomes a veritable barrier because it channels parallel to the war south easterlies from the south pacific high and deflects to the north weakened equatorial monsoonal westerlies that appear during dec jan cor in babahoyo pallatanga catchments shows positive δpmax50 in november each 1 4 years which strengthens with altitude e g pal and chi in these stations a mixture of upper level wind situations emerges in the dispersion parameters the most consistent being the zonal component of the normal rainy season alpha eof7 while the weak moderate en ssta beta eof1 in cor and alpha eof1 in chi fuels positive anomalies the normal rainy season ssta beta eof4 appears as the second driver in cor by contrast at the lowland station cal the strong en ssta beta eof3 becomes the major driver of positive anomalies followed by the normal rainy season ssta beta eof4 and the low level circulation identifies the meridional component of north westerlies beta eof6 a normal rainy season like subtype we hypothesize this latter is a weakly reversed low level circulation indicating either land sea breeze phenomena goldberg et al 1987 bendix and bendix 1998 or a local circulation nearby the gulf of guayaquil transporting moisture to the central war in any case the surplus of oceanic moisture unique for the strong ens seems primarily advected at the lowlands bounded by the ridges at cal 5 4 2 central war 2 2 5 s the δpmax50 in sus and gir cañar and jubones catchments reveals year round wind driven forcing at sus the largest exogenous influence occurs at the beginning of nov dec we find the zonal component of a strong en like wind situation beta eof1 being the major driver of positive anomalies superimposed on this equatorial convergent trades of the normal rainy season beta eof3 also contribute followed by the en like south westerlies beta eof7 the ssta shows only a minor contribution from the weak moderate en type alpha eof1 we suggest it co exists only with well developed westerlies e g eof1 low level flow when the unique catchment orientation almost perpendicular to the war boosts this ocean wind channeled forcing all these concurrent low level wind drivers explain the in year extreme rainfall anomalies fig 7 the abundance of mixed winds both equatorial monsoonal westerlies in djf and en like winds help to explain why such enhancement strengths at the beginning of the rainy season 5 4 3 southern war 3 15 5 s the situation radically changes in the andean depression the variability is explained by seasonal forcing e g zar in puyango tumbes ala in alamor and sto in piura despite being exposed to amazonian circulation no single interannual variation ascribed to our hypothetical regional climate forcing was identified we hypothesize the high density of low protruding peaks 1500 2000 masl in the andean depression detaches local regimes from regional ssts patterns and dampen meridionally low level airflows leaving local hygrothermal gradients as the only control of the high in season rainfall intensities and their anomalies 6 summary and conclusions the increasing volume of climate data from observations and analysis products presents the end user community in data sparse regions with unprecedented data analysis challenges and opportunities in this paper a statistical framework to mine climate data for the study of climate weather drivers of multisite rainfall extremes is presented the unique feature of this framework is that no assumption on the explanatory power of the climate covariates is made a priori they instead are brought out in a reduced climate to weather signal subspace the framework builds on ngev models which characterizes in season variability by means of harmonic models and weather type partitioning the climate forcing is decoded into a common signal subspace built via singular value decomposition of the underlying drivers using semi automatic parameter identification spi algorithm the proposed ngev models performs well with respect to the given data individually and also as an svd filter bank model because it yields a signal detachment of about half of the one that could obtained from a pseudo optimal filter model in a case study application over the western andean ridge war the framework unveils extremal properties in the tails of the joint distribution of multisite rainfall extremes by discriminating meaningful local and large scale climatic drivers which otherwise would have been overlooked by existing gaussian based multivariate regression techniques as result conspicuous drivers of rainfall extremes emerge as well as novel insights which add to event based studies available in literature e g bendix 2000 and bendix and bendix 2006 north of 2 5 catchments are found more influenced by large scale organized convection in which oceanic moist given by the en development is primary distributed by terrain blocked low level flows the advection drivers are essentially southerlies which convey weak moderate en ssta moist to the war s northernmost edges strong en sst anomalies signals only appear in the central war 1 5 2 s their associated moisture seems locally advected at lowlands this somehow redefines the long standing idea that strong sst anomalies influence is topographically bounded by the war s relief e g bendix 2000 and rossel and cadier 2009 south of 2 5 s the war seems detached of regional ocean atmospheric patterns there local to meso scale forcing dominates and shows a twofold pattern overall we show that the meridional component of the tropical airflow is what matters for moist convection distribution leading to high rainfall intensities alongside the war and that the zonal wind component of the en types e g the reversal of the walker circulation which has been traditionally stressed in several en event based studies is not evidenced in the inland continent moreover by contrast to mid latitude western coastal mountain ranges neiman et al 2002 the southern war seems to dampen meridional airflows rather than favouring pathways for zonal large scale moisture transport leaving local hygrothermal gradients to control rainfall extremes anomalies more importantly the detection of these climatic drivers in a purely data driven manner renders validity to the approach here presented since our approach is based on signal to noise separation methods it inherits its core assumptions the existence of a low rank linear model for climate signals and uncorrelated noise for the weather like forcing and the choice of the parameter optimization criteria to perform the separation in the former a crucial assumption is that atmospheric circulation can be linearly decomposed this holds for the tropical atmosphere under study in which air masses are fairly homogenous but in general this is not the case in reality atmospheric dynamics is mostly nonlinear then the use of statistical linear decomposition might yield patterns that do not have necessary physical meaning their merit is mostly descriptive in the latter the spi a likelihood based optimization algorithm assumes that components of the climate signal can be nulled into a white noise subspace this fundamental assumption requires special consideration on case by case applications however the intelligibility and transparency of a regression type method such as the spi algorithm plus a minimal criterion for validating parameter consistence against current understanding of the climate forcing are the instrumental tools they should turn the present approach an appropriate framework to mine climate data and characterize rainfall extremes in other geographic regions acknowledgements the authors thank prof j bendix philipps universität marburg and the associate editor and reviewer s comments that helped to improve the quality of this manuscript l pineda was funded by an emecw grant of the european commission for doctoral studies in ku leuven and contract no 1673 15 with utpl the first author thanks the national services of meteorology and hydrology of ecuador inamhi and peru senamhi for making station data available climate data was downloaded from the international research institute for climate and society of columbia university http iridl ldeo columbia edu the spi algorithm used in this paper is available at doi http doi org 10 1016 j envsoft 2010 05 008 appendix a confidence intervals for a large sample size n and assuming that the proposed model is valid let l and θ denote the log likelihood and the maximum likelihood ml estimator respectively then the distribution of θ is approximately multivariate normal with mean θ the true parameter values and covariance matrix given by the inverse of the observed information matrix i defined by 20 i θ 2 l θ θ i θ j i j 1 p evaluated at θ θ if an arbitrary term in the inverse of i θ is sij the square root of the diagonal entry sii is approximately the standard error se θ i of the ml estimator θ i therefore confidence intervals for θ i can be obtained in the form θ i z se θ i θ i z se θ i where z 0 95 1 96 gives a 95 confidence interval see tables 4 and 5 appendix b climate drivers interpretation b 1 ssta patterns the eof1 structures show a warm water tongue over the en 1 2 and 3 regions and its score shows a pearson s correlation equals to 0 78 with en 1 2 index thus this situation shows the climatological source of oceanic moisture for the war given by ssta development of the weak moderate en type the eof3 and eof5 illustrate contrasting ssta patterns the eof3 shows the warmest anomalies off the continent e g the southward shift of the highest isotherm sst 28 c from the equator to 10 s bendix 2000 and its score confirms that the highest amplitudes and their persistence correspond to the 1997 98 and 1982 83 ens in which a great amount of sensible and latent heating was available for convection the eof5 structures show zonal ssta gradients with a warm tongue approaching the coastal line bounded by cold water emerging from the upwelling region off the peruvian coast while the temporal score for this eof5 provides weak evidence of la niña ln conditions their structures resemble ln patterns over the central pacific larkin and harrison 2002 for the sake of classification we regard the eof5 as cold upwelling like waters the eof4 resembles sst latitudinal gradients which occur during the normal rainy season of ecuador when poor positive ssts development still cause intensification of precipitation bendix and bendix 2006 emck 2007 but also during weak ens as shown in 1992 by bendix 2000 however we consider the eof4 as the normal rainy season type a comparison with a svd analysis conducted on noaa optimum interpolated sst advanced very high resolution radiometer yields similar eofs up to the eof5 b 2 atmosphere circulation b 2 1 lower troposphere 850 hpa the eof1 scores of the zonal and meridional anomalies ua va reveal an en like flavour its structures show westerly anomalies 0 6 s that extends over the continent takahashi 2004 and douglas et al 2009 reported this flow type over the war s vicinity and schwing et al 2002 described similar circulation over the equatorial pacific during the 1997 98 en thus this situation represents a strong en lower level circulation type the eof3 of ua va show a low level flow situation matching the normal rainy season circulation bendix and laurer 1992 explain that during the normal rainy season the ne trade winds can be deflected to nw by the andes and the change in the coriolis parameters superimposed on this wind field direction shift warmer equatorial ssts interacting with weakened ne trades may allow monsoonal currents to reach the ecuadorian coast these landward north of the equator westerly winds appear in the eof3 structures such currents let local westerlies transporting moisture eastward emck 2007 by which the war receives larger quantities the eof7 structures show low level trades along the peruvian and ecuadorian coast likely originating in the south pacific anticyclone southerly winds crossing the equator have been described to characterize the en lower circulation type bendix and bendix 2006 but they also may occur during the normal rainy season the highest structures that appear almost parallel to the peruvian coast 4 12 s suggest that this circulation type is funnelled by the peruvian andes b 2 2 upper troposphere 300 hpa the eof1 of the zonal and meridional anomalies show well developed easterlies together with its low level eof1 counterpart both situations represent the reversal of the walker circulation which has been traditionally argued to be a distinctive feature during several moderate and strong en e g wyrtki 1975 the eof7 depicts a circulation pattern consistent with the normal rainy season this is an upper divergence over the amazon region with well developed easterlies over the ecuadorian and colombian borders that extend off shore the northern ecuadorian coast the south easterly upper flow over the en 1 2 region and the war will result from the bend of the warm anticyclone suppressed likely by the large action ratio of the sub tropical jet bendix and lauer 1992 similar situation is shown for the upper level flow by bendix and bendix 2006 for the normal rainy season the remaining eofs could not be associated with documented atmospheric circulation situations time lagged correlation analysis showed that one month lagged eofs for sstas and contemporaneous eofs for the ua and va synchronize the best with pmax at the war s gateway even though we could not document most of the eofs of ua va850 and ua va300 we used all one month lagged eofs for sstas and contemporaneous ones for winds to build the enhanced climate to weather signal subspace as they explain a substantial fraction of the energy in the surrounding climate forcing 
7141,weather and climatic characterization of rainfall extremes is both of scientific and societal value for hydrometeorological risk management yet discrimination of local and large scale forcing remains challenging in data scarce environments here we present an analysis framework that separates weather regime and climate controls using data driven process identification the approach is based on signal to noise separation methods and explanatory extreme value ev modeling of multisite rainfall extremes the ev models integrate the temporal component of the weather climate driver using semi automatic parameter identification at weather scale the ev models are combined with a state based markov model to represent the spatiotemporal structure of rainfall as weather states at climate scale the ev models are used to search for drivers leading to the shift of weather patterns the drivers are brought out in a climate to weather signal subspace built via dimension reduction of climate model reconstructions we apply the framework to a complex terrain region the western andean ridge in ecuador and peru 0 6 s using ground data from the second half of the 20th century overall we show that the framework which does not make any prior assumption on the explanatory power of the weather and climate drivers allows identification of well known and new features of the regional climate in a purely data driven fashion thus the approach shows potential to identify weather controls on precipitation extremes in data scarce and orographically complex regions in which model reconstructions are the only climate proxies keywords rainfall extremes extreme value analysis multivariate analysis climatology complex terrain andes 1 introduction discrimination between climatic and weather drivers of heavy precipitation events is both of scientific and societal value particularly for hydro meteorological risk management for example improved prediction of extreme precipitation events in operational seasonal forecasting by means of dynamical climate models requires to understand whether a specific extreme event can be attributed to a specific weather regime or mode of climate variability world meteorological organization 2013 also the cost effective design of storm drainage facilities and financial compensating mechanisms e g rainfall based index insurance that build within the seasonal to interannual time range requires this scientific understanding in mountainous regions heavy precipitation events are often influenced by synoptic to meso scale conditions and orographic effects rotunno and houze 2007 neiman et al 2002 piaget et al 2015 the western andean ridge war in the tropical andes of ecuador and peru is a core of mixed climate influences as is both part of the climate divide and the gateway for pacific and amazonian influences emck 2007 rollenbeck and bendix 2011 there rainfall extremes are response to the cross season weather regime variability which is disrupted by climate anomalies such as el niño southern oscillation enso the war is suspected to modulate the year roundly weather mechanisms governing the distribution of rainfall intensities but their underlying physical ground is not yet understood due to a paucity of detailed studies and lack of long term meteo data a recurrent problem in many regions in the global south accordingly the discrimination of the weather and climate drivers of rainfall extremes over such data scarce orographic barrier remains rather evasive from both physical and data analysis perspectives present theories describing the regional climate patterns associated to heavy rainfall occurrence in the war and neighboring regions emerged from event based analysis during the el niño en episodes of the last decades for example horel and cornejo garrido 1986 goldberg et al 1987 and bendix and bendix 1998 discriminated two mechanisms that may generate convective systems i a local circulation driven by the differential land heating and ii extended instability regarding the ocean atmospheric setting linked to spatial differences in heavy rainfall during the en events bendix and bendix 2006 extracted 6 en like weather types all these theories are merely en snapshots of the regional climate in fact every en event is different and its diversity currently hotly debated arises from the interplay between ocean and atmospheric circulation chen et al 2015 this implies that the weather variability characterizing each event depends on the specific pattern of each en disturbance in the war a test of the climatological forcing hypothesis of extreme weather occurrences requires a statistical analysis framework that recognises in year and interannual oscillations and isolates abnormal extremes several statistical methods are found in literature for exploring relationships between climate forcing and hydrometeorological variables at the forefront multivariate techniques have been proven useful for analyzing covariance and isolating linear relationships between explanatory and response variables two well established methods are canonical correlation analysis cca hotelling 1936 and maximum covariance analysis mca wilks 2006 these methods tend to use dimension reduction techniques such as the singular value decomposition to isolate the leading spatial and temporal patterns and use those patterns to generate pairs of stationary spatial patterns whose temporal covariation produces the highest correlation cca and covariance mca in a least square error sense such approaches are appropriate for diagnosis and prediction of hydrometeorological variables aiming at the bulk statistical properties of normally gaussian distributed variables but are not ideally suited for exploring extremal properties in the tails of the joint distribution of the response variables extreme value ev theory provides the theoretical framework to investigate the extreme behavior of large geophysical extreme events since the seminal work by coles 2001 and katz et al 2002 many have used time varying ev models to analyze the natural variability of rainfall extremes across time scales in the spatial setting ev models whose parameters are common to all locations or are related to site covariates have shown to yield more robust estimates than single site models e g buishand 1991 sveinsson et al 2001 tye and cooley 2015 show that borrowing strength across multi site data improves the generalized ev parameter estimates also spatial models based on max stable processes allow characterization of spatial dependence of rainfall extremes e g shang et al 2011 thibaud et al 2013 when time varying ev models make use of covariates e g harmonic functions to represent cyclical effects and or a prescribed climate index to represent climate effects two conflating problems are commonly found in model development i they need prescription of a number of harmonic functions to allow making inferences from a simplified model ii they require automatic parameter estimation algorithms to explore complex parameterizations that might arise from a large pool of explanatory variables the prescription of the number of harmonic functions might over simplify the underlying seasonal process and the use of climate indexes might not provide explanatory power as they do not necessarily represent the climatic influence over a specific region renard and lall 2014 the second problem optimal parameter estimation suitable for non stationary generalized ev models ngev has been addressed by using step wise algorithms that combines forward selection and backward elimination procedures menéndez et al 2009 and automatic selection algorithms that identify only one parameter at a time based on a score perturbation criterion mínguez et al 2010 this automatic selection method enables to explore a large number of model parameterizations to discriminate weather and climate precursors of extremes however the issue on how to constrain the automatic parameter selection to yield statistical information on the process of interest is an important step in advancing the exploitation of this semi assisted modeling approach particularly on the face of mixed weather and climate influences here we present a statistical analysis framework to mine climate data and separate weather and climate controls using data driven process identification the framework integrates the temporal component of the weather climate driver into an explanatory ngev model this model enables to investigate the climatological forcing hypothesis leading to anomalous rainfall extremes the approach is applied to a latitudinal transect of the tropical andes in ecuador peru a region of mixed climatological influences but aims to be applicable in other regions these include data scarce settings where the climatological forcing can be inferred from climate model reconstructions 2 data 2 1 rainfall data daily time series 68 stations available for january 1964 december 2010 24 h totals starting at 19 00 local standard time lst were provided by the ecuadorian and peruvian meteo hydrological national services inamhi and senamhi and quality controlled by ochoa et al 2014 from this dataset 16 stations 200 2830 masl placed on the innermost plateaus in each catchment table 1 fig 1 b c were chosen these stations record year roundly synoptic activity due to their altitude and latitudinal distribution in this subset monthly maxima of daily precipitation pmax were extracted at each station fig 2 shows pmax series of representative stations the climate forcing e g driven by sea surface temperature sst anomalies is not conspicuous masked by seasonality at every location 2 2 climate data gridded monthly time series 1964 2010 of extended reconstructed sst version 3 smith et al 2008 were taken from noaa s climate prediction center this is a global dataset of merged land air and sst reconstruction with 2 latitude longitude resolution based on historical observations available since 1960 optimum interpolation analysis blended with advanced very high resolution radiometer sst version 2 reynolds et al 2007 with a 0 25 spatial and daily resolution available since september 1981 was also examined for comparative purposes ncep ncar reanalyses wind field data kalnay et al 1996 were used for synoptic investigation monthly aggregated wind fields with a horizontal grid spacing of 2 5 were extracted at two pressure levels 850 and 300 hpa the limitation of the reanalyses data is obvious and statements at the edge of the synoptic scale should be made carefully nevertheless combined with in situ measurements reanalyses data are invaluable in placing the local weather in the synoptic context especially in regions lacking synoptic long term meteorological observations 3 methods the overall workflow is presented in fig 3 the analysis framework builds on signal to noise separation methods hermus et al 2007 and involves two modeling levels seasonal and interannual variability of rainfall extremes the rainfall extremes are modelled by means of ngev distributions that separate weather climate drivers using a semi automatic parameter identification spi algorithm mínguez et al 2010 at weather seasonal level the strategy relies on modeling quasi stationary weather regimes using a finite set of harmonic functions this way the seasonal ngev models represent low pass filter models for high frequency variability isolating climate modes and can also be regarded as a spatial smoothing for local weather phenomena they further enable a cross season regimen diagnosis based on an existing weather state characterization pineda and willems 2015 the second level uses the full discriminatory power of the spi algorithm to search for climatic drivers of low frequency variability into a common climate to weather signal subspace to constrain model identification as means to yield information on the process of interest we search for ocean atmospheric counterpart drivers into an enhanced signal subspace built onto an ensemble of explanatory variables the climate to weather signal enhancement is obtained by projecting the filter seasonal models onto a subspace of signals that resembles the observational sample subspace in dimensionality the dimension and basis vectors of the signal subspace are derived by eigen singular value decomposition evd svd wilks 2006 of the noisy multisite pmax and climate observation matrices respectively 3 1 climate to weather signal separation method subspace based signal to noise separation methods assume that every enhanced signal vector s can be written as a linear combination of p q linearly independent basis functions mi i 1 p 1 s m y where m is a q p matrix containing the basis functions and y is a length p column vector containing only the weights under these assumptions the d dimensional observational space can be split into two subspaces a p dimensional signal noise and a q p dimensional subspace that contains only noise the orthogonal decomposition into signal and noise subspaces can be performed by an evd more generally by an svd of the noisy observation matrix hermus et al 2007 let ps n pmax1 1 pmax2 t pmaxn t n 1 n stations and t 1 t observations be a multivariate vector of multisite monthly maxima of daily precipitation pmax samples representing the noisy observation matrix e g n 16 and t 552 months over the war and ps the multivariate vector containing the clean climate signal and pn the zero mean white noise that is assumed to be uncorrelated with the clean climate signal then the observational noisy sample can be expressed as 2 p s n p s p n further let r be the autocorrelation matrix of ps n the evd of ps n is then given by 3 p s n v λ v t with λ a diagonal matrix containing the eigenvalues λ j and v an orthonormal matrix containing the eigenvectors v then the order of the p dimension might be assumed being equal to the number of positive eigenvalues of r or to a value such that the energy of the enhanced signal is as close as possible to an estimate of the clean signal energy see section 3 1 in hermus et al 2007 the order of the q dimension is more difficult to setup a priori due to limitations for making an estimate of the noise variance however in general it should be greater than the order of p such that the separation into signal and noise subspaces is possible depending on the nature of embedded noise a conservative choice is to set q equal to 2 p or 3 2 p van huffel 1993 hermus et al 2007 fig 4 shows the scree plot for the evd of ps n the spectrum of noisy eigenvalues λ j exponential decay of λ stretches out up to the 15th dimension empirical orthogonal function eof accordingly the enhanced climate to weather signal will be contained in a high dimensional signal to noise vector subspace spanned by linear combinations of the basis functions contained in the matrix m eq 1 the assumption of a low rank linear model for the enhanced signal and the availability of an estimate of the noise correlation matrix enable to perform a filtering operation by which the clean signal is obtained several optimization criteria exist to perform the signal enhancement see hermus et al 2007 of particular relevance for the signal enhancement of the matrix ps n is the svd based method van huffel 1993 in which the p dominant singular values of ps n are mapped onto the original clean singular values of ps in the proposed framework such svd based noise reduction operation is analogous to the spi learning process in a prescribed parameter subspace see section 3 3 whose dimension is estimated using information of the ps n matrix 3 2 non stationary gev model we propose a nested ngev model that encompasses traditional ev models for non stationary variables coles 2001 the pmax series observed in month t follow a gev distribution with time varying gev location μ t scale α t 0 and shape ξ t parameters the cumulative distribution function cdf of pmax is given by 4 f t pmax exp 1 ξ t pmax μ t σ t 1 ξ t ξ t 0 exp exp pmax μ t σ t ξ t 0 the gev distribution includes three families the gumbel family ξ 0 the fréchet family ξ 0 and the weibull family ξ 0 the ngev model fit at each site includes only seasonal μ t s and interannual μ t i effects in the time varying location and scale parameters 5 and 6 the shape parameter is constrained to represent only seasonal effects 7 it is well established that this parameter shows large scales of variability hence long term increasing decreasing trends are not considered thus 5 μ t μ t s μ t i 6 σ t σ t s σ t i 7 ξ t ξ t s 3 2 1 weather seasonal ngev model the seasonal ngev model formulation by mínguez et al 2010 is used to summarize the spectrum of high frequency weather regimes in terms of harmonic models of slowly varying amplitude the formulations in eqs 8 10 allow the spi algorithm to identify the optimal number of harmonic functions to be included in the time dependent parameters mathematically the model is expressed as follows 8 μ t s β 0 i 1 p μ β 2 i 1 cos i ω t β 2 i sin i ω t 9 log σ t s 0 i 1 p σ 2 i 1 cos i ω t 2 i sin i ω t 10 ξ t s γ 0 i 1 p ξ γ 2 i 1 cos i ω t γ 2 i sin i ω t where t is given in years β 0 α 0 and γ 0 are the mean values of the gev parameters β α and γ βi αi and γi i 0 are the amplitudes of the harmonics ω 2π year 1 pμ pσ and pξ determine the number of optimal sinusoidal harmonics in a year 3 2 2 climate interannual ngev model in general terms the climate to weather subspace can be constructed by i inferring the subspace s order from the noisy observation matrix eq 3 and ii setting up its basis vectors as to capture the spectrum of energized basis vectors representing climate drivers this will ultimately shape the properties of the desired underlying climate signals in the war nearby ssts variability is a natural proxy candidate for moist convection while winds of the lower and upper troposphere represent large scale atmospheric moisture import section 4 3 thus the basis vectors of the climate to weather signal to noise subspace q dimensional order are derived via a svd of observed ocean and atmospheric anomalies as follows 1 yearly anomaly composites sep aug are constructed for the sep 1964 aug 2010 period for ssts and wind fields zonal u and meridional v components interpolated to 0 25 resolution at two pressure levels 300 hpa and 850hpa representing the upper and lower circulations respectively to construct these composites the sep aug climatology is firstly subtracted from each monthly sst u v field n 552 months for each grid point and then standardized yielding yearly sst u v anomalies ssta ua and va in this way these ssta ua and va composites represent interannual deviations from the in year cycle 2 svd is performed separately for each ssta ua and va composite we conduct the svd analysis based on the covariance matrix of the re gridded anomaly fields let x t x 1 t x 2 t x p t be a n p data matrix where x i t i 1 p t 1 n is a vector containing n monthly anomalies of the i th centered predictor and p is the number of predictors for example for ssta p 162 grid points cover the region 6 n 14 s 106 w coastal line the eofs are then obtained by 11 ssta i t j 1 p e z j t i 1 p t 1 n where zj are the eof score series and e is the j th eigenvector of the covariance matrix 12 s 1 n 1 x t x a crucial assumption here is that yearly ocean atmosphere anomalies can be linearly decoupled into signal and noise this hold for ssta few interpretable eofs but it is not straightforward for the atmospheric circulation see appendix b 2 which needs to be supported by a truncation criterion see north et al 1982 fig 5 shows the probability density function of the ssta eof scores the energy of the eof scores dissipates from the clean climate signal to zero mean weather like white noise the eof scores were truncated to eofmax 7 being the maximum number of eofs containing non random signal this yields an assembled m q q matrix q 5 eofmax containing the basis vectors for the climate to weather signal subspace in this reduced subspace we let the spi algorithm to separate climate from weather parameters by restricting the climate signal to occupy only the signal subspace while nulling its components in the noise subspace note that we only make assumptions on the nature of the climate drivers any noise filtering technique requires assumptions on the interfering signals but we do not make any prior assumption on their power as explanatory covariates based on the above considerations and under the assumption of a low rank linear model for climate signal and weather white noise we propose the following nested explanatory ngev model parameterization 13 μ t μ t s j 1 eof max β eofj ssta j t β eofj ua j t β eofj va j t 14 log σ t t s j 1 eof max eofj ssta j t eofj ua j t eofj va j t where t is given in year the parameters βeofj and αeofj represent the influence on the location and scale parameters per unit of standardized ssta j zonal ua j and meridional va j components of the lower and upper circulation on a particular instant t for any ngev model including pμ pσ pξ harmonic functions i 1 pμ pσ pξ and eofj time coefficients of the svd j 1 eof max the parameter vector θ can be represented by 15 θ β 0 β i β eofj ssta β eofj ua 850 β eofj va 850 β eofj ua 300 β eofj va 300 α 0 α i α eofj ssta α eofj ua 850 α eofj va 850 α eofj ua 300 α eofj va 300 γ 0 γ i the instantaneous quantile pq associated with the return period 1 q can be calculated using 16 p q μ t σ t ξ t μ t σ t ξ t 1 log 1 q ξ t ξ t 0 μ t σ t log log 1 q ξ t 0 where the probability q is given by ft p 1 q approximate standard error for the estimators and confidence intervals for parameters are obtained using standard likelihood theory coles 2001 see appendix a 3 3 climate to weather separation algorithm the spi algorithm by mínguez et al 2010 selects the parameters which minimize the akaike information criterion aic using the maximum likelihood method within an iterative scheme the selection is based on sensitivity analysis which makes use of local derivative information to identify the parameter producing the largest perturbation at each iteration we use the spi algorithm to learn weather climate parameters because of the following reasons i at weather scale it fits the best harmonic ngev model to data by adding to the stationary null model one harmonic two parameters per iteration until no further decrease of the aic is achieved the upper cut off for parameterization being score test statistics this defines a pseudo only noise model subspace orthogonal to the clean signal subspace ii at climate scale the construction of the perturbation criteria allows selecting the parameter that potentially produce the greater decrement of the aic per iteration and corresponds to the one with maximum score test statistics this selection is possible because an optimal solution of the log likelihood function can be derived and different sets of possible parameters θ 1 θ 2 θ l scrutinized see section 3 1 in mínguez et al 2010 thus the spi algorithm is well posed to bring out model parameters in a multivariate vector subspace of covariates which more in general can be seen as the svd based noise reduction operation van huffel 1993 to enhance damped exponential signals embedded in white noise of the ps n matrix 3 4 performance we assess both at site ngev models using criteria for explanatory modeling shmueli 2010 and its performance as svd filter models while the former can be deemed as an at site assessment the latter enables to identify model structures and make inference from their coefficients which in turn allows to explore the interfering signals in the tail of the join distribution of ps n model validation and selection proceeds as follows i validation of ngev model to assess model fitting we use adapted probability and quantile goodness of fit diagnostic plots méndez et al 2007 coles 2001 we also asses the generalization power i e predictive qualities of the explanatory ngev models using leave one year out cross validation metrics this is carried out in the following manner 1 the first response p q 1 and covariates ssta1 ua1 and va1 are removed from the observed datasets 2 the ngev model is fitted to the remaining n 1 responses and covariates 3 the covariates ssta1 ua1 and va1 are used to estimate the first quantile response from the model developed in 2 and 4 the process is repeated for each of the remaining paired responses and covariates the cross validation was constructed for each saturated ith order climate model ii empirical validation of svd filter models in practice the assessment of signal enhancement methods assumes that both clean and noise observation matrices are observable this allows derivation of theoretical estimators to quantify the efficiency of any noise reduction filter against an upper bound of performance in our implementation it would be ideal to derive such a theoretical estimator and benchmark the svd noise filtering operation against a metric of optimal performance this is however not possible without the possibility of observing in real world data the clean climate signal the ps matrix we therefore assess the amount of noise removal by computing empirical signal to noise snr ratios using the ensemble of instantaneous quantile pq responses yield by the weather and climate models empirical snrs are calculated using 17 snr σ signal 2 σ noise 2 where σ noise 2 and σ signal 2 are computed from the multivariate vectors of pq seasonal and interannual responses generated by the saturated weather models white noise assumption and the ith order climate filter models respectively iii selection we use an adapted likelihood ratio test towler et al 2010 to discern model structures among competing nested models let us consider a model m i s i i 1 n a sub model of the saturated ith seasonal interannual m i 1 s i and llhi m i s i and llhi 1 m i 1 s i are the maximized values of the log likelihood for the sub and saturated models respectively the deviance d statistic can be calculated as 18 d 2 llh i 1 m i 1 s llh i m i s if d cα where cα is the 1 α quantile of the χ k 2 distribution then m i s i can be rejected in favor of m i 1 s i here α is the level of significance χ k 2 is as large sample approximation and k are the degrees of freedom associated with the test nested models are tested at the α 0 05 significance level against the corresponding sub models for each test the degrees of freedom for the climate and seasonal models are k 1 and 2 with cα values of 3 84 and 5 99 respectively also the climate model s performance was evaluated against corresponding null models e g model including ssts vs seasonal only model see table 2 to assess how well the coupling of ocean and atmospheric covariates captures the extremes 3 5 weather and climate characterization the interannual variation in the time dependent quantile δpq can be calculated as 19 δ p q p qc p qs where pqc is the climate and pqs the seasonal dependent quantile calculated using only the seasonal parameterization both pqc and pqs are simulated from strictly hindcast models that is using the parameterization withheld from the saturated models in 8 10 and 13 14 which represent the time dependent quantile response to the spectrum of weather and climate drivers next we use the seasonal dependent quantile pqs in conjunction with a weather state characterization derived by calibrating a hidden markov model hmm to a network of daily rainfall observations including those in the war pineda and willems 2015 to elucidate in season regime fluctuations the hmm decomposes the observed spatio temporal rainfall variability over a network of observations via a discrete set of hidden states each state comprises a set of rainfall probabilities and wet day distribution functions for all locations in the network the states proceed on a daily time step following a first order markov process these characteristics enable the hmm to represent both spatial covariance over the network and persistence of large scale weather patterns which can be associated with the states it is thus well suited for the representation of daily rainfall in climate regimes that can be characterized in terms of variably persistent large scale weather patterns the use of weather states which implicitly account for spatial covariance in the form of the rainfall patterns associated with each state is consistent with a nonlinear dynamical view of the weather within climate in which the states represent basins of attraction toward which trajectories in the climate phase space are drawn lorenz 1963 palmer 1999 pineda and willems 2015 argue the existence of four hidden hygrothermal moisture states in the war hereafter called weather types wts which capture the in season rainfall spatiotemporal structure they reported these moisture states as the number of days falling in each wt here to quantify wt fluctuations the number of days was normalized to pqs and split into sub seasons to characterize climate drivers leading to the amplification dampening of wts we assess statistical significant spi identified parameters in terms of effect sizes and spatial consistence this latter is done by normalizing the parameters by their corresponding eof standard deviation then they are mapped and linked with their corresponding eof structures to allow interpretation of the synoptic driver 4 case study 4 1 the western andean ridge war and the regional climate setting the war 0 6 s is a transect of the tropical andes of unique characteristics the two meridional oriented ranges merge into one mass of rugged lower elevation peaks at 4 s the so called andean depression fig 1c the ridges down to the coast branches a series of heterogeneously oriented catchments we apply the framework on 11 west facing catchments along the war each one representative for a catchment weather regime the war is lower bounded by the region which recorded the greatest annual rainfall anomalies during en episodes fig 1a b rossel and cadier 2009 4 2 weather regimes in the war weather regimes might be differently accentuated during normal years and episodes of surplus deficit of oceanic moisture driven by sst anomalies in the eastern equatorial pacific bendix 2000 pineda and willems 2015 propose the following wts i excess ii deficit of moisture offshore of the war the wet dry states wt1 wt2 iii advection embedded in easterlies emanating from the amazonia the transitional wet dry state wt3 and iv moisture export from the inter tropical converge zone itcz displacement and eastward expansion of the south american monsoon the dynamically noise state wt4 4 3 regional climate large scale moist convection is primarily organized by the itcz which varies approximately in synchrony with the nearby ssts the spatial domain in which ssts variability influence heavy rainfall events spans from 6 n 14 s and 106 w coastal line e g bendix 2000 bendix and bendix 2006 pineda et al 2013 this domain embraces the eastern equatorial pacific where the en and humbolt currents meet the en 1 2 and a great portion of the en 3 regions bendix et al 2011 trenberth 1997 to obtain a synoptic scale perspective for the atmospheric circulation the domain 8 n 15 s and 65 105 w was selected takahashi 2004 and douglas et al 2009 showed that heavy rainfall in the war s coastal area had a strong westerly wind component whose anomalies extended 3500 1000 km off the coast a description of the regional climatology is presented in emck 2007 and more generally for the tropical atmospheric circulation in peters and ritcher 2014 table 3 summarizes results of the svd analysis on composite anomalies of the extended reconstructed sst and ncep ncar reanalyses of horizontal wind fields of the lower 850 hpa and upper 300 hpa troposphere we rank the spatial patterns fig 17 of the most conspicuous eofs emerging from the svd analysis of ssts lower and upper wind anomalies as i weak moderate the el niño en type ii strong the en type iii normal rainy season and iv cold upwelling like sstas for example the eof3 score series of ssta fig 6 shows that the highest amplitudes and their persistence correspond to the 1997 98 and 1982 83 ens a greater description and interpretation of the major climate patterns influencing the war is presented in appendix b 5 results and discussion 5 1 ngev model validation fig 7 shows the fitted ngev models to the monthly maxima of daily precipitation pmax on a key high altitude station sus highlighting unusual rainfall extremes during 14 en events after the inclusion of covariates ssta ua and va into the saturated best interannual model the estimation of high rainfall intensities e g en outliers improves clearly confidence bands are wider for the best interannual model against the more parsimonious best seasonal model quantile plots for the best seasonal and interannual models fig 8 shows that both weather and climate models perform well with respect to the given data there is improvement for most of the models incorporating climate covariates especially for high rainfall intensities fig 9 shows the spi parameter identification sequence and results of the leave one year out cross validation for the ith order increasing climate models pearson s correlations between the cross validated quantiles pq and observations are lower than their cross validated counterparts computed from the null weather model mi seas 0 694 0 691 0 588 0 719 0 66 0 672 0 619 and 0 612 for pto sma cor cal chi pal sus and gir respectively thus correlations decrease with model order implying some degree of overfitting this is not surprising when assessing predictive power of explanatory models since a parsimonious but less true model can have a higher predictive validity than truer but less parsimonious model this is because the former seeks to minimize the combination of bias and variance errors occasionally sacrificing theoretical accuracy see section 1 5 in shmueli 2010 by definition explanatory models are intended to fit data for theory building rather than to describe data structure parsimoniously as it would be awaited from predictive models nevertheless even in the presence of high order saturated or overfitted models pearson s correlation computed on the holdout datasets remains above 0 50 showing that explanatory models hold also some predictive qualities fig 10 shows estimates of the percentage of snr removal after application of the ith order increasing climate filter model models empirical snrs values larger than 100 show the gain on signal detachment with respect to the weather noise models m0 the sst filter model shows a large snr value because the ensemble of instantaneous quantile pq responses yielded by sst only filter models accounts for much of variability energy see fig 5 of the embedded signal in the ps n thus we consider such snr as the optimal estimator to benchmark the efficiency of noise reduction yielded by sst plus wind filter models for the ensemble of quantile responses generated by the coupled sst plus wind models the percentage of detached signal is lower due to the noise added for the models incorporating winds we note that the percentage of snr removal reaches an inflection point at about m10 then after the gain in signal detachment is minimal in any case at the highest order model m25 the gain on signal detachment is about half of the one obtained for the sst only filter model which we consider as a proxy for optimal signal detachment 5 2 selection of covariates figs 11 and 12 shows the spi parameter identification sequence and the significance p values of seasonal and interannual parameters against model order obtained from the likelihood ratio test for nested models e g single harmonic model m1 vs null stationary model m0 for the seasonal models and single climatic term m1 vs null weather model m0 for the climate models the number of parameters increases by two per added sinusoidal harmonic and one per added climatic term for the weather and climate models respectively in general terms likelihood ratio test statistics p values provides the basis to include trim covariates in nested models in the proposed framework however the selection of meaningful variables is performed in a constrained manner guided by the statistical significance of causal covariates and also by the size and spatial consistence of their coefficients this renders the theoretical justification for analysing covariates effects on the tails of the joint distribution of ps n section 5 3 table 2 shows the performance of different nested ngev model levels and the likelihood ratio test between saturated and null sub models models including sst and wind parameters are found significant and outperform sub models however for pal and sus the inclusion of both sets of covariates yields models with the same number of parameters as those obtained by models including only winds thus the latter models show overfitting effects when ssts are disregarded in most cases sub models show the highest pearson s correlation between the hindcasted time dependent 50 year return period quantile pmax50 and observations by construction the ngev models result in complex parameterizations harmonic terms for seasonality and mixed climatic terms for interannual variability while the first one accounts for the stochastic nature of weather the second one represents the deterministic sea and or wind signal hidden in the tail of the distributions of ps n namely climate covariates identified this way result from a regression fitting into a high dimensional orthogonal to the weather subspace note that some might argue such climate to weather subspace for parameter learning is over specified and prone to overfit models when exploring the pool of causal covariates as mentioned above overfitting is indeed plausible in this modeling approach as it arises from the methodological assumptions the existence of low rank linear model for climate signal this has however not damming effects for the modeling framework since the goal is to test all causal hypothesis upon theoretical constructs besides the spi algorithm attempts to minimize overfitting effects by selecting the parameter that potentially produce the greater decrement of the aic the most influent one in each fitting iteration and at the end it provides with t statistics standard errors and the log likelihood function for each parameter estimate from which one can compute likelihood ratio tests to justify inclusion exclusion of covariates and so infer the true structure of the models 5 3 weather drivers of seasonal variability figs 13a c and 14 illustrate the dec may weather type characterization in terms of the thermally driven wt1 transitional wet dry wt3 and dynamically noise wt4 wet states and the dry state wt2 at dec jan feb mar and apr may sub seasons table 4 shows the parameters of the saturated seasonal models for pmax below we discuss model structural differences fig 15 left panels in terms of i the seasonal pmax50 ii the mean intensity of pmax seasonal location parameter and iii the dispersion of the underlying process seasonal scale parameter the seasonal shape parameter reflecting the strength of the in year variability is presented only for information on the tail behaviour 5 3 1 northern war 0 1 5 s the mean intensity of pmax50 fluctuates in the range of about 120 170 mm within jan apr e g in pto this inter month variability is captured by complex parameterizations for μ t at pto and σ t at sma the ξ t shows a bounded tail ξ 0 during the entire rainy season terrain elevation only attenuates the mean intensity μ t e g chi whereas the in year variability σ t remains similar to that seen in lowlands this reveals a dec may season lasting distribution of rainfall extremes we argue that i this is due to deep convection embedded in the itcz wt4 and high frequency re evaporation cycles driving wet dry spells wt3 over the war s top e g sma in fig 14 and ii this mechanism holds in the northern valleys 0 1 5 s where north and south catchment boundaries are less pronounced fig 1 5 3 2 central war 2 2 5 s mean rainfall extremes are lower pmax50 peaks of about 75 mm with the largest amplitude centred within feb mar the parameter μ t describes a prominent feb mar sub season at pal the parameters σ t and ξ t represent early fluctuations in sep oct and light tail behaviour respectively the simplest model is encountered for sus with only 1 harmonic for the σ t and a near zero value for the ξ t describing a smooth annual cycle note that sus lies in a uniquely west east oriented catchment we will later show when unveiling the synoptic drivers that in this particular catchment rainfall extreme anomalies are driven by year round mixed wind circulation patterns 5 3 3 southern war 3 15 5 s highland stations on the inner war axis are described by the model structure at gir the parameters μ t σ t and ξ t shifting to negative values within nov dec show a quasi bimodal distribution featuring the occurrence of thunderstorms at the beginning of the rainy season and likely triggered by overhead sun in end of sep oct emck 2007 the μ t at gir fig 13d shows that mountain valleys in jubones catchment are spots of low rainfall intensities conversely west of the inner war axis at 3 5 5 s deep convective regimes weaken because the high concentration of peaks branching v shaped valleys inhibits large scale organized convection e g contraction of the wt4 in pte fig 14 hence zar ala and sto exhibit symmetric and enhanced peaks in feb mar which are attenuated in the andean depression e g zar and sto emck 2007 reported a high concentration of convective showers nearby ala within feb apr which we prove being more local and thermally driven wt1 rather than of oceanic or large scale organized genesis 5 4 climate drivers of interannual variability in principle the climate forcing should emerge from a subspace of highly correlated signals which in our implementation are eof time coefficients of ocean atmospheric circulation anomalies retrieved by the spi algorithm by preserving the climate signal sea and or wind component on low order models while nulling weather terms on high order models table 5 shows the absolute values of the identified location and scale parameters for ssta u va 850 hpa and u va 300 hpa fig 16 shows normalized parameter coefficients for the interannual pmax50 they represent the contribution of each standardized eof score to the location and scale parameters and are visualized as absolute values for ssta and vectors for u va 850 hpa and u va 300 hpa below we describe statistical significant and spatial coherent parameters together with the time dependent 50 year return period quantile s interannual variation δpmax50 fig 15 right panel to illustrate conspicuous drivers identified by the framework as well as to formulate statistically informed hypothesizes on the climate forcing 5 4 1 northern war 0 1 5 s pto in vinces catchment shows the largest interannual variation δpmax50 driven by low level southerly winds crossing the equator beta eof7 typical for weak en situations bendix and bendix 2006 bendix et al 2011 these winds would convey moisture of the weak moderate en ssta type beta eof1 towards the northern war at sma the largest anomaly originates from the low level meridional wind component of the normal rainy season beta eof3 whereas the strong and weak moderate en ssta type alpha eof3 and eof1 contributes marginally thus moist instability originated from strong ssta gradients off the war s coast appears dimly along the low ridge valley line it lacks of advection wind driver most importantly the ns oriented cordillera 2500 masl becomes a veritable barrier because it channels parallel to the war south easterlies from the south pacific high and deflects to the north weakened equatorial monsoonal westerlies that appear during dec jan cor in babahoyo pallatanga catchments shows positive δpmax50 in november each 1 4 years which strengthens with altitude e g pal and chi in these stations a mixture of upper level wind situations emerges in the dispersion parameters the most consistent being the zonal component of the normal rainy season alpha eof7 while the weak moderate en ssta beta eof1 in cor and alpha eof1 in chi fuels positive anomalies the normal rainy season ssta beta eof4 appears as the second driver in cor by contrast at the lowland station cal the strong en ssta beta eof3 becomes the major driver of positive anomalies followed by the normal rainy season ssta beta eof4 and the low level circulation identifies the meridional component of north westerlies beta eof6 a normal rainy season like subtype we hypothesize this latter is a weakly reversed low level circulation indicating either land sea breeze phenomena goldberg et al 1987 bendix and bendix 1998 or a local circulation nearby the gulf of guayaquil transporting moisture to the central war in any case the surplus of oceanic moisture unique for the strong ens seems primarily advected at the lowlands bounded by the ridges at cal 5 4 2 central war 2 2 5 s the δpmax50 in sus and gir cañar and jubones catchments reveals year round wind driven forcing at sus the largest exogenous influence occurs at the beginning of nov dec we find the zonal component of a strong en like wind situation beta eof1 being the major driver of positive anomalies superimposed on this equatorial convergent trades of the normal rainy season beta eof3 also contribute followed by the en like south westerlies beta eof7 the ssta shows only a minor contribution from the weak moderate en type alpha eof1 we suggest it co exists only with well developed westerlies e g eof1 low level flow when the unique catchment orientation almost perpendicular to the war boosts this ocean wind channeled forcing all these concurrent low level wind drivers explain the in year extreme rainfall anomalies fig 7 the abundance of mixed winds both equatorial monsoonal westerlies in djf and en like winds help to explain why such enhancement strengths at the beginning of the rainy season 5 4 3 southern war 3 15 5 s the situation radically changes in the andean depression the variability is explained by seasonal forcing e g zar in puyango tumbes ala in alamor and sto in piura despite being exposed to amazonian circulation no single interannual variation ascribed to our hypothetical regional climate forcing was identified we hypothesize the high density of low protruding peaks 1500 2000 masl in the andean depression detaches local regimes from regional ssts patterns and dampen meridionally low level airflows leaving local hygrothermal gradients as the only control of the high in season rainfall intensities and their anomalies 6 summary and conclusions the increasing volume of climate data from observations and analysis products presents the end user community in data sparse regions with unprecedented data analysis challenges and opportunities in this paper a statistical framework to mine climate data for the study of climate weather drivers of multisite rainfall extremes is presented the unique feature of this framework is that no assumption on the explanatory power of the climate covariates is made a priori they instead are brought out in a reduced climate to weather signal subspace the framework builds on ngev models which characterizes in season variability by means of harmonic models and weather type partitioning the climate forcing is decoded into a common signal subspace built via singular value decomposition of the underlying drivers using semi automatic parameter identification spi algorithm the proposed ngev models performs well with respect to the given data individually and also as an svd filter bank model because it yields a signal detachment of about half of the one that could obtained from a pseudo optimal filter model in a case study application over the western andean ridge war the framework unveils extremal properties in the tails of the joint distribution of multisite rainfall extremes by discriminating meaningful local and large scale climatic drivers which otherwise would have been overlooked by existing gaussian based multivariate regression techniques as result conspicuous drivers of rainfall extremes emerge as well as novel insights which add to event based studies available in literature e g bendix 2000 and bendix and bendix 2006 north of 2 5 catchments are found more influenced by large scale organized convection in which oceanic moist given by the en development is primary distributed by terrain blocked low level flows the advection drivers are essentially southerlies which convey weak moderate en ssta moist to the war s northernmost edges strong en sst anomalies signals only appear in the central war 1 5 2 s their associated moisture seems locally advected at lowlands this somehow redefines the long standing idea that strong sst anomalies influence is topographically bounded by the war s relief e g bendix 2000 and rossel and cadier 2009 south of 2 5 s the war seems detached of regional ocean atmospheric patterns there local to meso scale forcing dominates and shows a twofold pattern overall we show that the meridional component of the tropical airflow is what matters for moist convection distribution leading to high rainfall intensities alongside the war and that the zonal wind component of the en types e g the reversal of the walker circulation which has been traditionally stressed in several en event based studies is not evidenced in the inland continent moreover by contrast to mid latitude western coastal mountain ranges neiman et al 2002 the southern war seems to dampen meridional airflows rather than favouring pathways for zonal large scale moisture transport leaving local hygrothermal gradients to control rainfall extremes anomalies more importantly the detection of these climatic drivers in a purely data driven manner renders validity to the approach here presented since our approach is based on signal to noise separation methods it inherits its core assumptions the existence of a low rank linear model for climate signals and uncorrelated noise for the weather like forcing and the choice of the parameter optimization criteria to perform the separation in the former a crucial assumption is that atmospheric circulation can be linearly decomposed this holds for the tropical atmosphere under study in which air masses are fairly homogenous but in general this is not the case in reality atmospheric dynamics is mostly nonlinear then the use of statistical linear decomposition might yield patterns that do not have necessary physical meaning their merit is mostly descriptive in the latter the spi a likelihood based optimization algorithm assumes that components of the climate signal can be nulled into a white noise subspace this fundamental assumption requires special consideration on case by case applications however the intelligibility and transparency of a regression type method such as the spi algorithm plus a minimal criterion for validating parameter consistence against current understanding of the climate forcing are the instrumental tools they should turn the present approach an appropriate framework to mine climate data and characterize rainfall extremes in other geographic regions acknowledgements the authors thank prof j bendix philipps universität marburg and the associate editor and reviewer s comments that helped to improve the quality of this manuscript l pineda was funded by an emecw grant of the european commission for doctoral studies in ku leuven and contract no 1673 15 with utpl the first author thanks the national services of meteorology and hydrology of ecuador inamhi and peru senamhi for making station data available climate data was downloaded from the international research institute for climate and society of columbia university http iridl ldeo columbia edu the spi algorithm used in this paper is available at doi http doi org 10 1016 j envsoft 2010 05 008 appendix a confidence intervals for a large sample size n and assuming that the proposed model is valid let l and θ denote the log likelihood and the maximum likelihood ml estimator respectively then the distribution of θ is approximately multivariate normal with mean θ the true parameter values and covariance matrix given by the inverse of the observed information matrix i defined by 20 i θ 2 l θ θ i θ j i j 1 p evaluated at θ θ if an arbitrary term in the inverse of i θ is sij the square root of the diagonal entry sii is approximately the standard error se θ i of the ml estimator θ i therefore confidence intervals for θ i can be obtained in the form θ i z se θ i θ i z se θ i where z 0 95 1 96 gives a 95 confidence interval see tables 4 and 5 appendix b climate drivers interpretation b 1 ssta patterns the eof1 structures show a warm water tongue over the en 1 2 and 3 regions and its score shows a pearson s correlation equals to 0 78 with en 1 2 index thus this situation shows the climatological source of oceanic moisture for the war given by ssta development of the weak moderate en type the eof3 and eof5 illustrate contrasting ssta patterns the eof3 shows the warmest anomalies off the continent e g the southward shift of the highest isotherm sst 28 c from the equator to 10 s bendix 2000 and its score confirms that the highest amplitudes and their persistence correspond to the 1997 98 and 1982 83 ens in which a great amount of sensible and latent heating was available for convection the eof5 structures show zonal ssta gradients with a warm tongue approaching the coastal line bounded by cold water emerging from the upwelling region off the peruvian coast while the temporal score for this eof5 provides weak evidence of la niña ln conditions their structures resemble ln patterns over the central pacific larkin and harrison 2002 for the sake of classification we regard the eof5 as cold upwelling like waters the eof4 resembles sst latitudinal gradients which occur during the normal rainy season of ecuador when poor positive ssts development still cause intensification of precipitation bendix and bendix 2006 emck 2007 but also during weak ens as shown in 1992 by bendix 2000 however we consider the eof4 as the normal rainy season type a comparison with a svd analysis conducted on noaa optimum interpolated sst advanced very high resolution radiometer yields similar eofs up to the eof5 b 2 atmosphere circulation b 2 1 lower troposphere 850 hpa the eof1 scores of the zonal and meridional anomalies ua va reveal an en like flavour its structures show westerly anomalies 0 6 s that extends over the continent takahashi 2004 and douglas et al 2009 reported this flow type over the war s vicinity and schwing et al 2002 described similar circulation over the equatorial pacific during the 1997 98 en thus this situation represents a strong en lower level circulation type the eof3 of ua va show a low level flow situation matching the normal rainy season circulation bendix and laurer 1992 explain that during the normal rainy season the ne trade winds can be deflected to nw by the andes and the change in the coriolis parameters superimposed on this wind field direction shift warmer equatorial ssts interacting with weakened ne trades may allow monsoonal currents to reach the ecuadorian coast these landward north of the equator westerly winds appear in the eof3 structures such currents let local westerlies transporting moisture eastward emck 2007 by which the war receives larger quantities the eof7 structures show low level trades along the peruvian and ecuadorian coast likely originating in the south pacific anticyclone southerly winds crossing the equator have been described to characterize the en lower circulation type bendix and bendix 2006 but they also may occur during the normal rainy season the highest structures that appear almost parallel to the peruvian coast 4 12 s suggest that this circulation type is funnelled by the peruvian andes b 2 2 upper troposphere 300 hpa the eof1 of the zonal and meridional anomalies show well developed easterlies together with its low level eof1 counterpart both situations represent the reversal of the walker circulation which has been traditionally argued to be a distinctive feature during several moderate and strong en e g wyrtki 1975 the eof7 depicts a circulation pattern consistent with the normal rainy season this is an upper divergence over the amazon region with well developed easterlies over the ecuadorian and colombian borders that extend off shore the northern ecuadorian coast the south easterly upper flow over the en 1 2 region and the war will result from the bend of the warm anticyclone suppressed likely by the large action ratio of the sub tropical jet bendix and lauer 1992 similar situation is shown for the upper level flow by bendix and bendix 2006 for the normal rainy season the remaining eofs could not be associated with documented atmospheric circulation situations time lagged correlation analysis showed that one month lagged eofs for sstas and contemporaneous eofs for the ua and va synchronize the best with pmax at the war s gateway even though we could not document most of the eofs of ua va850 and ua va300 we used all one month lagged eofs for sstas and contemporaneous ones for winds to build the enhanced climate to weather signal subspace as they explain a substantial fraction of the energy in the surrounding climate forcing 
7142,many recent studies propose wavelet based hydrological and water resources forecasting models that have been incorrectly developed and that cannot properly be used for real world forecasting problems the incorrect development of these wavelet based forecasting models occurs during wavelet decomposition the process of extracting high and low frequency information into different sub time series known as wavelet and scaling coefficients respectively and as a result introduces error into the forecast model inputs the source of this error is due to the boundary condition that is associated with wavelet decomposition and the wavelet and scaling coefficients and is linked to three main issues 1 using future data i e data from the future that is not available 2 inappropriately selecting decomposition levels and wavelet filters and 3 not carefully partitioning calibration and validation data by not addressing these boundary conditions during wavelet decomposition incorrectly developed wavelet based forecasting models often result in much better performance than what is realistically achievable we demonstrate that the discrete wavelet transform dwt multiresolution analysis dwt mra and maximal overlap discrete wavelet transform modwt multiresolution analysis modwt mra two commonly adopted wavelet decomposition methods used in the development of hydrological and water resources wavelet based forecasting models suffer from these boundary conditions and cannot be used properly for real world forecasting however by following a proposed set of best correct practices we show that the modwt and à trous algorithm at can be used to correctly forecast target e g hydrological and water resources processes in real world scenarios in this vein we contribute a set of best practices which focusses on deriving boundary corrected wavelet and scaling coefficients from time series data overcoming the boundary condition issues and providing hydrological and water resources modellers with a justified and coherent strategy for developing wavelet based forecasting models that may be used for real world forecasting problems we coalesce these best practices into a new forecasting framework named wavelet data driven forecasting framework wddff that uses a combination of input variable selection and data driven models to convert boundary corrected wavelet and scaling coefficients into forecasts of a target process through a real world urban water demand forecasting experiment in montreal canada we demonstrate the superiority of wddff against benchmark forecasting models such as non wavelet based random walk multiple linear regression extreme learning machine and second order volterra series models for the same case study we also show how the wddff provides realistic and accurate forecasts while a recently proposed wavelet based forecasting model that adopts the invalid modwt mra for wavelet decomposition provides incorrect and unrealistic forecasts we conclude that wddff is a useful tool for forecasting real world hydrological and water resources processes that overcomes the limitations of many earlier wavelet based forecasting methods and should be explored further for forecasting different processes such as streamflow rainfall evaporation etc keywords time series forecasting wavelets best practices hydrology water resources 1 introduction the presence of multiple periodicities transients and or trends in hydrological and water resources time series often present difficulties to traditional data driven time series machine learning computational intelligence etc solomatine and ostfeld 2008 forecasting methods e g autoregressive integrated moving average arima multiple linear regression mlr artificial neural networks ann etc adamowski et al 2012 the fact that the wavelet transform wt or wavelets for short can decompose this information wavelet decomposition into separate high and low frequency sub time series wavelet and scaling coefficients and provide a more coherent structure of the complex time series and related variables to a data driven model has often lead to significant improvements in forecast accuracy and for that reason has made it a popular tool in hydrological and water resources forecasting fahimi et al 2017 recent reviews afan et al 2016 dixit et al 2016 fahimi et al 2017 nourani et al 2014 sang 2013 yaseen et al 2015 have highlighted the popularity of wavelet based forecasting in hydrology and water resources for example using scopus nourani et al 2014 cited around 100 papers on this topic between 2003 and 2013 while at the time of writing this paper we identified around 110 papers between 2014 and 2018 however despite the growing popularity of wavelet based time series forecasts in hydrology and water resources the proper design and interpretation of wavelet based forecasts has not always been carefully scrutinized often resulting in the design of forecasts that are invalid and that cannot be used in real world scenarios du et al 2017 zhang et al 2015 see sections 2 and 3 for details and section 5 for a real world example the largest misinterpretation regarding wavelet based forecasts and a significant impediment to their use in real world forecasting problems is related to wavelet decomposition where isolation and extraction of relevant features from a given time series using wt occurs and the inadvertent addition of error into the wavelet and scaling coefficients sub time series produced by the wt the main source responsible for generating this error in the wavelet and scaling coefficients is caused by what is known as the boundary condition bc or boundary treatment aussem et al 1998 bakshi 1999 maheswaran and khosa 2012a below we briefly review the basics of wavelet decomposition and then attempt a high level discussion of the bc before a more detailed treatment in the next section essentially wavelet decomposition can be understood as a convolution which can be likened to quantifying the similarity between a wavelet filter and a given time series resulting in a set of wavelet and scaling coefficients which contain high and low frequency information from the original time series the high and low frequency content of the wavelet and scaling coefficients depends on 1 the decomposition level which represents the different scales of change in the time series and 2 the wavelet filter whose width and shape determines the type of features that can be extracted from the time series e g trends transients periodicities polynomial behaviour etc maheswaran and khosa 2012a now the bc arises during wavelet decomposition when one seeks to calculate wavelet or scaling coefficients at a particular time and scale that cannot be calculated correctly i e without introducing error because the entire range of time series observations that are required in the calculation are not available we will refine this explanation later with some detailed examples different wt e g continuous wavelet transform cwt discrete wavelet transform dwt the maximal overlap dwt mowdt and à trous algorithm at slightly vary in how wavelet decomposition is carried out and this as will be discussed in detail in the next section leads to important differences in how one is to evaluate and treat the bc associated with a particular wt before providing technical details it is important to take note that the bc if not properly treated will add error into the wavelet and scaling coefficients in three distinct ways 1 through the inclusion of future data i e time series observations at future times t are used in the calculation of wavelet or scaling coefficients at time t see section 2 3 1 2 the improper selection of decomposition levels and wavelet filters i e decomposition levels that are too high and or wavelet filters that are too wide for a given time series see section 2 3 2 and 3 the incorrect partitioning of data into calibration and validation sets i e due to issues 1 and 2 above the calibration wavelet and scaling coefficients may include information from the time series observations that belong to the validation dataset and vice versa see section 2 3 3 before proceeding we must make clear two key items 1 we make an important distinction between error introduced to a wavelet based forecasting model via the bc and errors encountered in general modeling problems error due to the bc is avoidable if proper precautions which will be discussed in detail in the next section are taken while typical sources of error e g due to model parameterization initial conditions model structure etc are inherent in any modeling exercise i e whether wt are used or not this work is only focussed on the former 2 real world wavelet based forecasting is defined in this study as the use of a wavelet based forecasting model that is calibrated on a sequential historical record i e for t 0 1 n c 1 where n c is the number of calibration records and subsequently used to generate forecasts for a validation record i e for t n c n c 1 n c n v 1 where n v is the number of validation records where the validation record is unknown at the time of model calibration and becomes available to the forecaster only one record at a time i e at t n c 1 only time series records t 0 1 n c 1 are known to the forecaster while time series records t n c 2 n c 3 n c n v 1 remain unknown since they would not be available to the forecaster in a real world scenario by assuming this definition for real world wavelet based forecasting wavelet decomposition must be carried out on the validation records sequentially as would be the case in a real world scenario when new data becomes available to the forecaster only after it has been observed measured i e in real time it is the opinion of the authors that this is the correct way to treat the development of wavelet based forecasting models for use in real world scenarios in advance of our detailed exploration of each of the bc related problems i e the future data issue improper selection of decomposition levels and wavelet filters and calibration and validation set partitioning in the next section it is important to note that when any of these sources of error are included in the wavelet coefficients and subsequently used within a wavelet based forecasting model error is introduced and carried throughout the entire model development and testing stages model calibration and validation respectively this error which is difficult to characterize since it is related to many different factors e g the type of wt the decomposition level wavelet filter and dataset partitioning can lead to unrealistic forecasts and is the result of the incorrect development of a wavelet based forecasting model by neglecting to address the bc du et al 2017 by not addressing each of the bc one cannot use wt correctly for real world forecasting problems i e without introducing error due to the bc therefore if one is to correctly develop a wavelet based forecasting model it is important to understand how wavelet decomposition is related to the wt e g dwt modwt or at selected by the forecaster and how to adjust for the resulting bc of significance we note and will show in the next section that the most popular wt the dwt used in hydrology and water resources wavelet based forecasting studies e g altunkaynak and nigussie 2017 deo et al 2017c dixit et al 2016 fahimi et al 2017 nourani et al 2014 rezaie balf et al 2017 samadianfard et al 2018 cannot be corrected in terms of the above mentioned bc and therefore should not be used for real world forecasting applications du et al 2017 as pointed out in du et al 2017 since the dwt does not address any of the boundary conditions during wavelet decomposition the incorrectly developed dwt based forecasting models often result in much better performance than what is realistically achievable this is an important issue since an estimated 90 of papers 191 210 identified on scopus between 2003 and 2018 use the dwt for hydrological and water resources wavelet based forecasting applications however we will show how the bc associated with both the modwt and at can be straightforwardly addressed once the bc related adjustments have been made both the modwt and at can be used correctly for real world forecasting problems to illustrate the importance of the bc and its connection to these wt we compare and contrast the dwt modwt and at algorithms showing where the bc arises for each method and how it can be addressed for the modwt and at but not the dwt allowing for the proper development of wavelet based forecasting models for real world use interestingly the comparison of the bc related issues arising from each of these wt i e dwt modwt and at in terms of wavelet based forecasting applications has yet to be carried out in the literature since a large majority of studies mentioned in numerous review articles on wavelet based forecasting in hydrology and water resources afan et al 2016 dixit et al 2016 fahimi et al 2017 nourani et al 2014 yaseen et al 2015 including more recent studies bachour et al 2016 barzegar et al 2018 2017 baydaroğlu et al 2017 maslova et al 2016 prasad et al 2017 rezaie balf et al 2017 samadianfard et al 2018 seo et al 2017 shi et al 2018 yadav and eliza 2017 yu et al 2018 propose wavelet based forecasting models that cannot be used in real world forecasting problems due to different combinations of the bc related issues mentioned above we feel that it is very important to address this gap in the literature therefore we make it our goal to explore and address the above mentioned bc related problems connected to dwt modwt and at enabling the correct development of wavelet based forecasts that may be used for real world applications to meet this goal we contribute to the literature in two main ways 1 by developing a set of best and correct practices for wavelet based forecasting that addresses each of the three bc related problems e g future data selection of decomposition levels and wavelet filters and calibration and validation set partitioning through careful analysis of different wt i e the dwt modwt and at and their wavelet decomposition procedure and 2 adopting our proposed best practices in a new wavelet based forecasting framework that can be utilized in real world forecasting scenarios both contributions are important for the field of hydrology and water resources since most wavelet based forecasting models developed in hydrological and water resources studies are incorrect and there currently does not exist 1 a comprehensive study of the differences between the dwt modwt and at in terms of each bc 2 best practices that addresses each of the bc and 3 a general forecasting framework incorporating a set of best correct practices that can be applied alongside any type of data driven model and be used for real world wavelet based forecasting scenarios these important contributions are realized through the following steps 1 we systematically review wavelet decomposition for the most popular wt used in hydrological and water resources forecasting the dwt modwt and at by focussing on the three bc related issues i e future data selection of decomposition levels and wavelet filters and calibration and validation set partitioning in terms of both theory and practical application showing how they are commonly misunderstood and misused resulting in invalid forecasts 2 we then introduce a set of best correct practices to address each of the bc related issues that ultimately results in the calculation of what we term boundary corrected wavelet and scaling coefficients 3 we show how boundary corrected wavelet and scaling coefficients can be determined through two different wt the modwt and at that until now have not been studied together in the wavelet based forecasting literature 4 we review the differences between the modwt and at in terms of their wavelet decomposition strategies discovering that for forecasting applications the modwt can only be used for pre processing input data while the at can be used for pre processing both target and input data to the best of our knowledge this finding has been overlooked in the wavelet based forecasting literature 5 we develop a new wavelet based forecasting framework wavelet data driven forecasting framework wddff that adopts our best practices and uses the boundary corrected wavelet coefficients derived from either the modwt or at and any data driven model e g arima mlr ann etc to forecast a target process and 6 we use wddff in a real world daily urban water demand uwd forecasting exercise in montreal canada demonstrating its usefulness and potential for forecasting real world hydrological and water resources time series to introduce our proposed best correct practices for wavelet based forecasting and the wddff the rest of this work is arranged in the following order in section 2 we introduce the different wavelet decomposition approaches commonly used in wavelet based hydrological and water resources forecasting models discuss how the bc related issues apply to each wavelet decomposition approach and show how these issues can be solved in section 3 we show how the solutions to each of the bc related issues can be formulated as a set of best practices and then used within a new wavelet based forecasting framework wddff section 4 explains our real world forecasting experiment used to demonstrate the usefulness of wddff section 5 focusses on the results of our experiment and discusses their significance finally section 6 concludes the study by highlighting its main contributions originality and suggesting avenues for future research 2 theoretical basis for best correct practices in wavelet based forecasting 2 1 an overview of the different wavelet transforms used in hydrology and water resources for wavelet based forecasting our focus in this sub section is on the theoretical details of and comparison between the dwt modwt and at we chose to focus on these three wt since the dwt is the most commonly used in hydrology and water resources wavelet based forecasting and as we will show below results in incorrect forecasts and because the modwt and at are the only wt that can be used correctly for real world forecasting in table 1 we have provided the equations eqs 1 9 needed to perform wavelet decomposition using the dwt 1 2 modwt 4 5 and at 7 8 aussem et al 1998 maheswaran and khosa 2012a percival and walden 2000 eqs 3 6 and 9 can be used to reconstruct the time series i e back to its original values via the dwt modwt and at respectively we note that we have not included the cwt in our discussion at it suffers from the same bc related issues as the dwt less the dyadic condition mentioned below typically requires many ad hoc corrections when used for forecasting and is computationally expensive adamowski 2008a 2008b nourani et al 2009b rathinasamy et al 2014 previously studied details concerning the wavelet decomposition process that results in the dwt modwt and at wavelet w j w j and w j t a and scaling coefficients v j v j and v j t a where j 1 2 j and j is the decomposition level including information on their properties and those of their wavelet and scaling filters can be found in section a of our supplementary material instead we focus on the key differences between the dwt modwt and at wavelet and scaling coefficients to prepare our discussion on how each of the bc related issues i e future data selection of decomposition levels and wavelet filters and calibration and validation set partitioning are related to each wt the key difference between the dwt and the modwt and at is that the dwt involves decimation therefore dwt wavelet and scaling coefficients at a given level j have 2 j fewer coefficients than at scale j 1 the decimation of the dwt causes several major issues for wavelet based forecasting applications thus making it invalid for real world forecasting problems 1 it requires the time series to be an integer multiple of 2 j 2 it is shift invariant and 3 it is sensitive to adding new data points maheswaran and khosa 2012a percival and walden 2000 walden 2001 each point is explained in more detail in section a of our supplementary material the drawbacks of the dwt mentioned in points 1 3 can be overcome through the modwt and at by simply rescaling the wavelet h l and scaling filters g l used by the dwt as follows h l h l 2 and g l g l 2 the re scaling of the dwt filters conserves energy and obviates the need to sub sample in the modwt and at i e dyadic sub sampling is avoided resulting in wavelet and scaling coefficients that are the same length as the original time series walden 2001 from table 1 eqs 5 and 6 it is clear that the modwt and at share the same scaling coefficients since they are calculated using the same low pass filter g however their wavelet coefficients differ the modwt uses a high pass filter h to calculate its wavelet coefficients while the at calculates its wavelet coefficients at scale j by differencing the scaling coefficients at levels j and j 1 therefore the at permits an additive reconstruction of a given time series eq 9 while the modwt must apply an iterative reconstruction of the time series through the reverse pyramid algorithm eq 8 this interesting result has important consequences for forecasting applications and is discussed later in this section now that we have noted the key differences between the dwt modwt and at in terms of wavelet decomposition and reconstruction we can now look at how the wavelet and scaling coefficients produced by the different wt have been used and misused in hydrology and water resources wavelet based forecasting studies afterwards our discussion will focus on the implications of the bc related to each wt in terms of wavelet based forecasting 2 2 use and misuse of wavelet and scaling coefficients in hydrology and water resources wavelet based forecasting since the dwt wavelet w 1 w 2 w j and scaling coefficients v j are decimated at each scale those adopting the dwt for wavelet based forecasting must use multiresolution analysis mra mallat 1989 to convert the decimated wavelet and scaling coefficients into detail d 1 d 2 d j and approximation coefficients s j respectively that are of the same length as the original time series afterwards the detail s and approximation coefficients are used as input to a given forecasting model kişi 2011 we refer to the conversion of wavelet and scaling coefficients to detail and approximation coefficients respectively as dwt based mra or dwt mra although it is often referred to in the literature as simply dwt sang 2013 or mra dixit et al 2016 similar to the dwt mra the same process can be followed for the modwt to produce the modwt mra detail s d 1 d 2 d j and approximation coefficients s j percival and walden 2000 an interesting characteristic of the dwt mra and modwt mra is that similar to the at the detail s and approximation coefficients provide an additive reconstruction of the time series because of this property the at wavelet and scaling coefficients are often referred to as detail and approximation coefficients in the literature aussem et al 1998 maheswaran and khosa 2012a the additive reconstruction property of the dwt mra modwt mra and at is given as aussem et al 1998 percival and walden 2000 10 x t j 1 j d j t s j t j 1 j d j t s j t j 1 j w j t a v j t a however unlike the at the dwt mra and modwt mra suffer from a serious drawback in terms of their usefulness in real world forecasting applications they require future data in order to calculate detail and or approximation coefficients at a given point in time we give a detailed example showing why this occurs in the next sub section an inadvertent misunderstanding of this important drawback has led to the detail s and approximation coefficients derived from both the dwt mra and modwt mra being commonly used in hydrological and water resources wavelet based forecasting models resulting in invalid forecasts e g alizadeh et al 2017 bachour et al 2016 barzegar et al 2018 2017 ebrahimi and rajaee 2017 ghazvinei et al 2017 he et al 2015 maslova et al 2016 patil and deo 2017 prasad et al 2017 seo et al 2017 shoaib et al 2018 yang et al 2014 while the wavelet or detail and scaling or approximation coefficients derived by the at have been used in a number of studies adamowski and chan 2011 belayneh et al 2016b bogner and kalas 2008 djerbouai and souag gamane 2016 khalil et al 2015 maheswaran and khosa 2012b rathinasamy et al 2013 it is surprising to note given that the modwt mra detail s and approximation coefficients have been used in several studies that the modwt wavelet and scaling coefficients have yet to be used in any hydrological or water resources wavelet based forecasting studies therefore this study introduces the first use of the modwt wavelet and scaling coefficients for wavelet based forecasting of hydrological and water resources the two most common ways in which the detail s and approximations from the dwt mra modwt mra and at are used for wavelet based forecasting are 1 decomposing only the explanatory variables into detail s and approximation coefficients and forecasting the target directly alizadeh and kavianpour 2015 kişi 2011 samadianfard et al 2018 also known as the direct approach nguyen and nabney 2010 2 decomposing both target and explanatory variables into detail s and approximation coefficients and forecasting each decomposed target series detail or approximation separately using the decomposed explanatory variables and then aggregating the separate target series predictions using additive reconstruction eq 10 barzegar et al 2017 shafaei and kisi 2016 yadav and eliza 2017 also known as the multicomponent approach nguyen and nabney 2010 another similar but less popular approach is to use another model e g ann to reconstruct the separate target series predictions instead of eq 10 cannas et al 2006 kim and valdés 2003 this approach is unnecessary since it adds additional errors to the forecast due to the use of a model for reconstruction instead of the simple additive reconstruction offered by eq 10 it is significant to note that both wavelet based forecasting approaches i e the direct and multicomponent methods can lead to different levels of forecast accuracy and it is therefore important to consider both approaches in order to identify the best possible forecast for a given dataset nguyen and nabney 2010 a result that is confirmed later in this paper section 5 and which is seldom considered in wavelet based hydrological and water resources forecasting studies we will also show later that both the multicomponent and direct approaches can be used by the at for real world wavelet based forecasting while only the direct approach is applicable to the modwt we now discuss how the different bc related issues i e the future data issue inappropriately selecting decomposition levels and wavelet filters and not carefully partitioning calibration and validation data affect each of these wavelet based forecasting approaches and propose our solutions to these problems 2 3 boundary condition related issues and solutions in wavelet based forecasting it is important to re iterate that our intention is to circumvent the use of wavelet and scaling coefficients impacted by bc and to only use boundary corrected wavelet and scaling coefficients that do not suffer from any boundary condition for wavelet based forecasting by meeting these conditions boundary corrected wavelet and scaling coefficients can be used correctly for real world forecasting applications we start by showing how the future data issue is related to the dwt mra and modwt mra and how it is avoided by the modwt and at 2 3 1 the future data issue the future data issue occurs when a given wt e g dwt mra and modwt mra requires time series observations existing after ahead of time t in order to perform wavelet decomposition on a time series observation at time t in other words data from the future of the time series t is required to calculate a wavelet or scaling coefficient in the present at t it becomes obvious that if time series observations t are unavailable to the forecaster which is the case in real world scenarios then they are unable to perform wavelet decomposition at time t it is therefore of great importance that wt that do not use future data such as the modwt and at are adopted in real world wavelet based forecasting models and those that require future data such as the dwt mra and modwt mra are avoided in table 2 we give a very simple example showing how the future data bc issue occurs in the dwt mra and modwt mra and how it is avoided by the modwt and at using the formulae from table 1 in this example we consider a time series of length 32 n 32 a wavelet filter of length four l 4 e g the daubechies 4 filter see section a of the supplementary material and a decomposition level of one j 1 we calculate the first level detail coefficient at time index 16 t 16 for the dwt mra d 1 16 modwt mra d 1 16 and at d 1 16 a using eqs 7 9 see also section a of the supplementary material for how the dwt mra and modwt mra detail coefficients are calculated fig 1 provides a graphical depiction of the future data issue showing which of the original time series observations are used for calculating the detail coefficients at t 16 by the dwt mra modwt mra and at note that the modwt uses the same observations as the at when calculating its wavelet and scaling coefficients noting that x t v 0 t we can clearly see that both the dwt mra and modwt mra require information from v 0 x as far into the future as t 19 to calculate d 1 16 and d 1 16 respectively however the at does not require future information to exist as it requires only the present time index or earlier i e t 16 to calculate d 1 16 a which is equivalent to w 1 16 a note also that the modwt wavelet coefficient w 1 16 has the same requirement as the at in this regard to borrow a definition from linear filtering the at and modwt are causal algorithms as they do not require any future information to calculate their value at a given time index since this is not the case for the dwt mra and modwt mra they are non causal algorithms bašta 2014 maheswaran and khosa 2012a another important point that we explore in more detail in section 2 3 3 is related to the calibration and validation set partitioning bc problem using the same example if we consider that the first 17 time series observations as calibration records and the remaining 15 as validation records one can immediately realize that if we were to treat forecasts over the validation record in real time as in a real world problem one would not even have enough data to issue a forecast at time t 16 for t 16 using the dwt mra and modwt mra however the at and modwt do not suffer from this issue as they do not require information in advance of t 16 and could therefore be used to make a forecast for t 16 at time t 16 this very important issue is overlooked in the vast majority of studies considering wavelet based forecasting models 2 3 2 the future data solution the solution to the future data issue is simple for any wavelet based forecasting model the non causal dwt mra and modwt mra that use future data should be avoided and the causal at or modwt algorithms should be used instead since they do not use future data a relevant question to ask is are there any catches to using the at and modwt for real world forecasting the answer is yes and the catches to using the at and modwt are as follows 1 the modwt cannot be used with the multicomponent approach as it does not provide an additive reconstruction via eq 10 2 the decomposition level and wavelet filter must be appropriately selected and 3 a suitable number of calibration and validation records should be used we discuss the proper selection of the decomposition level and wavelet filter in the next sub section and show how the second and third points are intimately tied to one another in section 2 3 3 2 3 3 the improper selection of decomposition level s and wavelet filter s issue the bc due to decomposition level and wavelet filter selection introduces error into the wavelet and scaling coefficients at the beginning and potentially end of the time series depending on the wt see below according to the following formula bašta 2014 maslova et al 2016 percival and walden 2000 11 l j 2 j 1 l 1 1 where l j represents the number of wavelet and scaling coefficients affected by the bc for decomposition level j and a wavelet filter of length l for the at and modwt only the beginning of the time series i e for t 0 1 l j 1 is affected by the bc due to the selected decomposition level and wavelet filter while the first and last l j wavelet and scaling coefficients are affected i e t 0 1 l j 1 and t n 1 n 2 n l j 1 for the dwt mra and modwt mra percival and walden 2000 the bc issue related to decomposition level and wavelet filter selection can be seen in table 1 e g refer to t 2 j 1 l mod n for the modwt and at algorithms where the modulo operator mod is used to represent circular convolution also referred to in the literature as the circularity boundary condition and is necessary in order to calculate wavelet detail and scaling approximation coefficients that require observations for t 0 t 0 and t n 1 bašta 2014 percival and walden 2000 it is important to consider the significance of the bc issue related to decomposition level and wavelet filter selection when one selects a wavelet filter that is too wide long and chooses a decomposition level that is too high it leaves very few wavelet and scaling coefficients free from bc related uncertainty from which to calibrate a wavelet based forecasting model aussem et al 1998 this important item is often overlooked in numerous hydrological and water resources forecasting studies employing wt where the common approach is to neglect the error introduced in those wavelet coefficients and to use the incorrect coefficients as input to a data driven model e g as in barzegar et al 2017 karbasi 2017 nourani and saeidifarzad 2017 and shoaib et al 2018 when the correct approach is to not include those coefficients in the forecast and only use those wavelet and scaling coefficients that can be calculated with certainty aussem et al 1998 bašta 2014 renaud et al 2003 2005 the common practice of ignoring the error introduced due to improper selection of decomposition levels and wavelet filters in wavelet based forecasting can be better understood through an example a popular wavelet filter used in wavelet based hydrological and water resources forecasting studies akrami et al 2014 barzegar et al 2017 ebrahimi and rajaee 2017 mirbagheri et al 2010 rajaee 2011 ravansalar and rajaee 2015 rezaie balf et al 2017 sahay and srivastava 2014 shoaib et al 2016a b that very seldom should be used except for cases considering a very large number of time series records and low decomposition levels is the discrete meyer dmey wavelet filter with a filter length l of 102 coefficients as an example the dmey wavelet filter has been used to forecast a monthly precipitation time series that included only 350 historical records using the dwt mra at a decomposition level of three nourani et al 2009a using the dmey with a three level decomposition produces 708 boundary coefficients i e l 3 2 3 1 102 1 1 708 at the beginning and end of the time series 1416 in total this is more than quadruple the amount of time series records that were available which means that not only was the entire calibration dataset filled with wavelet and scaling coefficients that included errors due to the bc but also the entire validation set the model reported coefficient of determination scores of 0 935 and 0 890 on the calibration and validation partitions respectively however these results are difficult to interpret in terms of model generalization since both datasets used wavelet and scaling coefficients that were incorrect not only due to the future data issue but also due to the improper selection of decomposition level and wavelet filter in addition to the references mentioned earlier in this paragraph other very similar cases are present in the literature e g krishna 2013 moosavi et al 2013 shirmohammadi et al 2013 sehgal et al 2014 and shoaib et al 2015 where unrealistically wide wavelet filters were used with high decomposition levels causing most calibration and validation records to be tainted with error while the literature includes so called boundary condition correction methods to counteract the selection of high and wide decomposition level s and wavelet filter s respectively such as those employed for the dwt mra and modwt mra karthikeyan and kumar 2013 maslova et al 2016 percival et al 2011 the future data issue still remains for these methods which makes them not usable in real world forecasting studies we do not delve into bc correction methods as our goal is to avoid adding any error due to bc into our wavelet based forecasting models realistically any bc correction method adds some form of error since it is inherently a model in itself instead we propose an alternative approach in the next sub section and show how to properly address decomposition level and wavelet filter bc related error for the at and modwt algorithms 2 3 4 the solution for properly selecting decomposition level s and wavelet filter s the proper selection of decomposition level s and wavelet filter s is a three step process 1 choose either the modwt or at for wavelet decomposition 2 select a decomposition level and wavelet filter and 3 remove the first l j wavelet and scaling coefficients as determined by eq 11 resulting in boundary corrected wavelet and scaling coefficients the final bc related issue to address is related to the partitioning of data into calibration and validation sets since this item is tied to decomposition level and wavelet filter selection through the number of boundary affected coefficients as determined via eq 11 recall our example of the dmey wavelet filter above we will show below that it is imperative to select decomposition level s and wavelet filter s in conjunction with careful dataset partitioning 2 3 5 the dataset partitioning issue a common practice in hydrological and water resources wavelet based forecasting studies adopting the dwt mra and modwt mra is to decompose both calibration and validation data separately to overcome the future data issue barzegar et al 2018 2017 deo et al 2017c prasad et al 2017 however this is a misunderstanding of the future data issue as described in this study since we have shown that at any given time the dwt mra and modwt mra require future data to compute detail and approximation coefficients in reality if the calibration and validation data are decomposed separately this causes problems at the boundaries of each partition where 1 the calibration data must wrap around and use wavelet and scaling coefficients at the beginning of the time series as surrogates to calculate the boundary coefficients at the end of the calibration dataset and 2 the earlier boundary coefficients of the validation set use the wavelet and scaling coefficients at the end of the validation record as surrogate values for calculating their values du et al 2017 karthikeyan and kumar 2013 zhang et al 2015 we clearly show this to be the case by drawing on our example in table 2 assuming that the first 17 records are used for calibration and the remaining 15 for validation if the dwt mra or modwt mra is used and the calibration and validation data are first partitioned and then decomposed separately in the calculation of d 1 16 or d 1 16 i e the final calibration record v 0 19 would be swapped for v 0 2 since v 0 19 mod 17 v 0 2 as its surrogate v 0 18 for v 0 1 v 0 17 for v 0 0 etc considering d 1 17 or d 1 17 i e the first validation record v 0 16 which is required to calculate d 1 17 or d 1 17 would no longer be taken as v 0 16 but would be replaced by v 0 32 as its surrogate similarly v 0 15 would be replaced by v 0 31 as its surrogate and so on it is very clear that the dwt mra and modwt mra cause significant problems when attempting to calibrate and validate real world wavelet based forecasting models it is worth re iterating that this issue with the dwt mra and modwt mra can be circumvented by adopting the modwt and at algorithms for wavelet decomposition of the calibration and validation records and is discussed in more detail below 2 3 6 the solution for correctly partitioning a dataset our solution for correctly partitioning data in wavelet based forecasting models is founded on two key principles 1 avoiding the case where there are more boundary coefficients than available time series records as discussed in 2 3 2 and 2 providing enough time series records from which to calibrate and validate a wavelet based forecast these two principles can be broken down in a set of steps 1 adopt either the modwt or at since they are causal filters that do not have any dependence on future data 2 select a maximum decomposition level j max and a variety of wavelet filters of suitable length see section a of the supplementary material for examples the value j max and a series of wavelet filters can be selected by applying eq 11 to determine the number of boundary affected coefficients and ensuring that l j n 3 remove the first l j wavelet and scaling coefficients from the beginning of the wavelet and scaling coefficients i e the boundary affected coefficients obtaining the boundary corrected wavelet and scaling coefficients such that there are at least enough calibration records unaffected by the boundary condition providing the wavelet based forecasting model with enough records for calibrating the explanatory variables to the target variable 4 after calibration apply the modwt or at to the validation set one record at a time and calculate the forecast for each validation record and 5 repeat steps 1 to 3 until one has identified suitable decomposition levels and wavelet filters for forecasting a given target process it may be useful to perform an initial exploratory analysis by selecting both a maximum decomposition level and wavelet filter length by cycling through a combination of each pair to identify suitable candidates suitable candidate decomposition levels and wavelet filters should be identified by the modeller s preference which is usually a function of a trade off between model accuracy on the validation records and computational efficiency e g based on a tolerance that is appropriate to the modeller another key point connected to data partitioning of the calibration and validation records is to ensure that any data scaling applied to the explanatory and target variables prior to their input to a data driven model a useful practice for ensuring that certain inputs are not favoured due to a larger range in comparison with other inputs but instead due to their intrinsic relationships with the target process is to apply the scaling properties e g maximum and minimum values mean and standard deviation etc from the calibration data to both calibration and validation data and to not perform this separately otherwise the calibrated model parameters might not generalize properly to unseen data hastie et al 2009 while this is a fundamental concept we mention it here since to the best of our knowledge we have not yet seen this important issue discussed in studies on wavelet based hydrological and water resources forecasting 3 best correct practices and the wavelet data driven forecasting framework the solutions to the bc related issues discussed in the last section e g the future data issue selection of decomposition levels and wavelet filters and calibration and validation set partitioning can now be formulated into a general wavelet based forecasting framework wavelet data driven forecasting framework wddff we first summarize the best practices adopted within wddff and then discuss the building blocks of wddff that can be varied based on the forecasters preferences e g type of wt at or modwt wavelet filter selection data driven model selection etc 3 1 best practices adopted by the wavelet data driven forecasting framework the wddff is based on the following best practices 1 adopting either the at or modwt for wavelet decomposition 2 using the at or modwt to calculate boundary corrected wavelet and scaling coefficients see section 2 3 2 and 2 3 3 which is carried out according to a the selection of a decomposition level and wavelet filter such that j max and l results in l j n i e according to eq 11 and b removing the first l j boundary effected coefficients from the beginning of the wavelet and scaling coefficients such that after partitioning the dataset into calibration and validation partitions there are at least enough calibration records unaffected by the boundary condition 3 using the boundary corrected wavelet and scaling coefficients to calibrate the wavelet based forecasting model 4 validating the wavelet based forecasting model by applying the at or modwt to the validation set one record at a time and ensuring that the forecasting model s performance and computational efficiency meet the forecasters requirements else repeat steps 1 3 until a suitable forecasting model is obtained 3 2 the building blocks of the wavelet data driven forecasting framework by assuming that the best practices described above are followed for wavelet based forecasting the main building blocks of the wddff can be broken down into 1 selecting a wavelet based forecasting method section 3 2 1 2 input variable selection for wavelet and scaling coefficients section 3 2 2 and 3 selection of a data driven model section 3 2 3 we discuss each of these items in detail in the sub sections below and summarize these steps in a flowchart fig 2 3 2 1 pre processing data the first step in the wddff is to pre process the data to begin the forecast lead time is set and the explanatory and target variables i e input and output respectively are partitioned into calibration and validation sets depending on the wavelet based forecasting method see sub section 2 2 and 3 2 1 1 the explanatory variables are decomposed using the modwt or at direct approach or both explanatory and target variables are decomposed using the at multicomponent approach 3 2 1 1 different wavelet based forecasting methods since the at can be used in either a direct or a multicomponent forecasting approach i e both explanatory and target variables are decomposed and the target forecast is obtained through additive reconstruction eq 10 while the modwt can only be used in a direct forecasting approach i e only explanatory variables are decomposed and the target is forecasted directly see section 2 2 one can develop a wide variety of wavelet based forecasts under the wddff both direct and multicomponent approaches are important to consider as they can differ in forecast accuracy and it is thus significant to explore both approaches in order to obtain the best overall forecasting model for a given dataset this also gives the modeller access to different models that may be assessed in terms of trade offs between computational efficiency and forecast accuracy or for ensemble modeling rathinasamy et al 2013 using the direct and multicomponent approaches we define six different ways in which the wddff may be used to develop wavelet based forecasts via the modwt and at although there potentially exists other approaches we focus on only these approaches since they are straightforward to apply and encompass the different direct and multicomponent wavelet based forecasting approaches studied thus far in hydrology and water resources 1 single method 1 a direct approach wavelet decomposed explanatory variables are used as input and the target variable as output for a given data driven model 2 within method 2 a multicomponent approach forecast each set of wavelet and scaling coefficients for the target variable using the wavelet and scaling coefficients from the explanatory variables at the same levels i e the first level wavelet coefficients for the target are forecasted using the first level wavelet coefficients from the explanatory variables the second level wavelet coefficients for the target are forecasted using the second level wavelet coefficients from the explanatory variables and so on we name this method within since only wavelet and scaling coefficients within the same level are used in the forecasts 3 across method 3 a multicomponent approach forecast each set of wavelet and scaling coefficients for the target process using the wavelet and scaling coefficients from the explanatory variables for all levels i e the first level wavelet coefficients for the target are forecasted using the first second third etc level wavelet coefficients including the scaling coefficients from the explanatory variables we name this method across since wavelet and scaling coefficients from the explanatory variables across the different levels are used in the forecasts of the wavelet and scaling coefficients of the target process at each level 4 single hybrid method 4 a direct approach the same as method 1 but the original un decomposed explanatory variables are also used as input 5 within hybrid method 5 a multicomponent approach the same as method 2 but the original un decomposed explanatory variables are also used as input for each of the target variable s wavelet and scaling coefficients 6 across hybrid method 6 a multicomponent approach the same as method 3 but the original un decomposed explanatory variables are also used as input for each of the target variable s wavelet and scaling coefficients eight different wavelet based forecasting approaches can be used six using the at and two using the modwt both within and across based multicomponent approaches method 2 3 5 and 6 can only be used with the at since it is the only wt amongst modwt and at that can be reconstructed additively i e via eq 10 the reason for including the original un decomposed explanatory variables along with wavelet decomposed explanatory variables is because the original time series contain coarse global details while the wavelet decomposed time series contain specific localized details together they provide a more comprehensive structure view of the overall process that is being forecasted and this has been shown to increase forecast performance in earlier wavelet based forecasting studies adamowski 2008a 2008b aggarwal et al 2008 nguyen and nabney 2010 voronin and partanen 2013 we stress that method 1 6 solely adopt boundary corrected wavelet and scaling coefficients derived by modwt and at methods 1 3 are generalizations of methods 4 6 with the difference being that non wavelet decomposed data is not considered in methods 1 3 since the original data is available we feel that its predictive ability in concert with that of the wavelet decomposed data should be explored in order to develop the best forecast model adamowski 2008b nguyen and nabney 2010 method 1 has been used in numerous studies by the present authors e g adamowski and sun 2010 adamowski and chan 2011 adamowski et al 2012 campisi pinto et al 2013 belayneh et al 2014 belayneh et al 2016a belayneh et al 2016b and khalil et al 2015 and others e g benaouda et al 2006 maheswaran and khosa 2012a li and cheng 2014 djerbouai and souag gamane 2016 but in these studies solely the at was adopted and the modwt was not explored methods 4 and 5 were considered by nguyen and nabney 2010 with methods 1 and 2 being specific cases of these methods while a variant of method 3 in addition to method 1 was considered by murtagh et al 2004 where the authors included lower level higher frequency wavelet coefficients as predictors for scales at the same level or above while our approach includes the potential to use higher level lower frequency wavelet coefficients as predictors for lower level coefficients and vice versa we are not aware of any studies that have proposed method 6 or compared each of the proposed eight different varieties of wavelet decomposition forecasting strategies i e six different methods methods 1 6 with eight different modes methods 1 6 apply to at and methods 1 and 4 apply to the modwt 3 2 2 input variable selection for wavelet and scaling coefficients after decomposing the input output dataset according to the wavelet based forecasting method in the previous stage input variable selection is used to identify only those wavelet and scaling coefficients pertinent to the forecasting model input variable selection provides a systematic means for selecting which variables are useful in predicting a target process and can enable an automatic selection of relevant variables that consider relevancy and redundancy amongst potential candidates quilty et al 2016 performing input variable selection using wavelet decomposed data is not a new concept alsberg et al 1998 recent approaches have investigated using partial correlation input selection pcis tran et al 2016 mutual information mi rana and koprinska 2016 and conditional or partial mi cmi or pmi he et al 2015 li et al 2016 for selecting the best wavelet decomposed inputs for wavelet based forecasting as part of wddff we opt to select which boundary corrected wavelet and scaling coefficients are to be used in forecasting the target process by adopting the input variable selection methods discussed in quilty et al 2016 we considered two input variable selection methods the edgeworth approximations based cmi ea approach and pcis to maintain brevity readers should consult quilty et al 2016 for details on the ea method the ea method uses information theoretic concepts e g multivariate differential entropy to estimate cmi for multivariate datasets and is therefore well suited for capturing nonlinear dependence while the pcis method is based on partial correlation using the typical linear pearson correlation and is limited to identifying only linear relationships galelli et al 2014 in general other input variable selection algorithms can be used instead of ea or pcis within the wddff andersen and bro 2010 creaco et al 2016 fernando et al 2009 galelli and castelletti 2013 kariwala et al 2013 taormina et al 2016 we selected the ea method instead of other similar nonlinear methods such as partial mutual information selection fernando et al 2009 k nearest neighbours based conditional mutual information tsimpiris et al 2012 partial information sharma et al 2016 etc since it has been shown to be computationally efficient and provides similar if not better results for a number of benchmark input variable selection problems quilty et al 2016 pcis is adopted because it is a classic input variable selection method for linear and nonlinear regression problems to the best of our knowledge we are the first to apply a conditional mutual information approach for wavelet based input variable selection using the modwt and at we now discuss the data driven methods that can be used alongside the selected boundary corrected wavelet and scaling coefficients to provide forecasts for a target process 3 2 3 data driven model selection the wavelet based inputs boundary corrected wavelet and scaling coefficients selected in the last stage are used together with the target variable which may also be a set of wavelet and scaling coefficients i e if the multicomponent wavelet based forecasting approach is adopted see section 3 2 1 1 in nonlinear and linear regression frameworks to map inputs to target forecasts we used the extreme learning machine huang et al 2006 stulp and sigaud 2015 and the second order volterra sov model labat et al 1999 maheswaran and khosa 2012a as the nonlinear regression methods and multiple linear regression mlr as the linear model we adopted these three methods as they are easy to program they can be formulated as linear least squares problems are computationally efficient and have performed very well in our experience for hydrological and water resources forecasting applications using wavelet and non wavelet based approaches we do not provide theoretical details for these models as they can be found in a number of our earlier works deo et al 2017a quilty et al 2016 rathinasamy et al 2014 2013 yaseen et al 2016 as with the input variable selection methods other regression models may easily be substituted for elm sov and mlr popular methods such as kriging fuzzy logic support vector regression model trees multivariate adaptive regression splines k nearest neighbours partial information genetic programming etc altunkaynak et al 2003 deo et al 2017b garg et al 2014 goyal et al 2014 kisi 2016 lee et al 2017 rahimikhoob 2016 sharma et al 2016 may be used within wddff ea is paired with the nonlinear regression models elm and sov and pcis is paired with the mlr model we now summarize the key facets of wddff before describing the case study used for demonstrating the usefulness of wddff for real world forecasting studies 3 3 summary of the wavelet data driven forecasting framework our proposed wddff takes into account best practices for wavelet based forecasting by overcoming boundary condition related issues during wavelet decomposition that if not addressed would render a wavelet based forecast invalid for real world application such as in many existing wavelet based forecasting frameworks in the literature 1 avoiding the use of future data 2 selection of suitable decomposition levels and appropriate wavelet filters and 3 proper dataset partitioning additionally wddff incorporates different approaches for using wavelet decomposed data i e boundary corrected wavelet and scaling coefficients in wavelet based forecasting models i e via direct and multicomponent approaches see section 3 2 1 1 allowing one to identify the best wavelet based forecast for a given input output dataset which is often overlooked but important to consider wddff can be summarized as follows 1 wddff uses the modwt and at algorithms which do not consider future data in calculating wavelet and scaling coefficients at a particular time 2 decomposition levels and wavelet filters are selected such that they provide enough data for calibrating the wavelet based forecasting model without including any boundary coefficients i e after wavelet decomposition of the input output dataset we remove any boundary coefficients prior to calibrating our forecasts we only use boundary corrected wavelet and scaling coefficients in our forecasts and such that they provide suitable forecasting performance on a validation set based on forecasting accuracy and computational efficiency suited to the user s preference and 3 direct and multicomponent wavelet based forecasting approaches can be adopted methods 1 6 listed in section 3 2 1 1 allowing one to identify a forecasting approach that provides the best accuracy for a given dataset a input variable selection is used to select which boundary corrected wavelet and scaling coefficients should be used in the wavelet based forecasting model and b data driven methods are used to convert the selected boundary corrected wavelet and scaling coefficients from the last step into target variable forecasts 4 experimental setup here we first introduce the study area used in our experiments before discussing how the general methodology for the wddff is specifically adapted to our study area afterwards we discuss the details of the different experiments that were designed to demonstrate the usefulness of wddff for real world wavelet based hydrological and water resources forecasting problems to keep this work succinct we refer readers to our supplementary material for specific experiment details briefly our proposed wddff is tested on an urban water demand uwd forecasting case study in montreal quebec where we forecasted average daily uwd u for lead times 1 3 5 7 and 14 days common to water utility functions e g optimization of planning design management and operations recent uwd forecast studies have focussed on forecasting montreal s uwd adamowski et al 2012 tiwari and adamowski 2013 adamowski et al 2012 forecasted daily summer demands i e may to august at one day lead times using mlr multiple nonlinear regression autoregressive integrated moving average arima ann and wavelet ann wt ann based on the at however the boundary condition at the beginning of the time series was not taken into account in the wa ann model the authors found that the wa ann provided the best one day ahead forecast in the summer demand period between the years 2001 2009 tiwari and adamowski 2013 compared arima arima with exogenous variables arimax ann bootstrap ann bann wt ann and wavelet bann wt bann for forecasting average uwd at daily 1 3 5 7 and 14 and monthly 1 and 2 lead times between february 27 1999 and august 6 2010 the authors used the dwt mra to develop their wavelet based models and found that the wt bann models provided the best overall forecasts in both studies historical average daily uwd total daily rainfall and maximum daily air temperature were used as explanatory variables we incorporated the explanatory variables of historical average daily uwd u total daily rainfall r maximum daily air temperature t and the daily antecedent precipitation index a to forecast the target variable average daily uwd at lead times of 1 3 5 7 and 14 days ahead we collected average daily uwd u from the city of montreal and daily meteorological variables r and t from environment canada the antecedent precipitation index a was calculated from daily rainfall see the supplementary material within the period february 27 1999 to august 6 2010 4179 daily records 4 1 methodology for wavelet data driven forecasting framework the general workflow fig 2 that was followed for developing the wddff forecasts for our uwd forecasting case study in montreal canada is summarized below specific details may be found in section c of our supplementary material 4 1 1 pre processing data the target variable u was set to lead times of 1 3 5 7 and 14 days ahead each explanatory variable u r t and a was time lagged up to 14 days in the past to allow historical information to be exploited through input variable selection see section c of our supplementary material calibration and validation sets were partitioned as follows february 27 1999 to december 31 2007 for calibration 3230 records and january 1 2008 to august 6 2010 for validation 949 records we found this data partitioning to provide good performance as it afforded us with enough records for calibration and a reasonable amount of data over two and a half years to validate the performance of the wddff out of sample wavelet decomposition using the modwt and at algorithms was used to calculate boundary corrected wavelet and scaling coefficients and was carried out using each of the six wavelet based forecasting methods described in section 3 2 1 1 i e single method 1 within method 2 across method 3 single hybrid method 4 within hybrid method 5 and across hybrid method 6 the maximum decomposition level was set to six j max 6 and we considered wavelet filters up to length 14 l 14 see section c of our supplementary material for further details on how j max was determined and why these wavelet filters were selected the different wavelet families and their filters that were used in our study are as follows their coefficients can be found in the supplementary material haar haar daubechies d1 same as haar d2 d3 d4 d5 d6 d7 symlets sym4 sym6 coiflets coif1 coif2 fejer korovkin fk4 fk6 fk8 fk14 least asymmetric la8 la12 la14 and best localized bl14 crowley 2007 nielsen 2001 olhede and walden 2004 percival and walden 2000 rathinasamy et al 2013 zhang et al 2016 since the largest widest wavelet filter had 14 filter coefficients d7 sym7 fk14 la14 and bl14 and we used a maximum decomposition level of six there were l j 2 j 1 l 1 1 820 boundary affected coefficients therefore we removed the first 820 records from the beginning of our input output datasets creating the boundary corrected wavelet and scaling coefficients prior to selecting input variables and before model calibration to eliminate the effect of the boundary condition on our forecasts see section 2 3 3 since explanatory variables were time lagged up to 14 days forecast leads times of 1 3 5 7 and 14 day were explored and we removed the first 820 boundary coefficients from each dataset the original calibration set of 3230 records was reduced to a total of 2395 2393 2391 2389 and 2382 calibration records for the 1 3 5 7 and 14 day ahead forecasts respectively therefore 949 validation records were used for evaluating each lead time forecast out of sample i e each lead time forecast had the exact same validation set for the target variable 4 1 2 input variable selection for wavelet and scaling coefficients the edgeworth approximation based conditional mutual information and partial correlation input section input variable selection methods quilty et al 2016 were used for selecting wavelet and scaling coefficients as inputs for the different data driven models within wddff see section c of our supplementary material for further details 4 1 3 data driven models the extreme learning machine second order volterra and multiple linear regression were selected as the data driven models that were fed wavelet and scaling coefficient inputs according to the ea and pcis input variable selection methods the data driven models using wavelet decomposed inputs are appended with a w i e welm is a wavelet based extreme learning machine while wmlr is a wavelet based multiple linear regression model the ea method was used to select inputs for the nonlinear models elm and sov while pcis was used to select inputs for the mlr non wavelet based models were used as a benchmark for the wavelet based models developed using wddff a random walk rw without wavelet based inputs was also considered as a benchmark model therefore the following models were considered input variable selection method model ea welm ea wsov pcis wmlr ea elm ea sov pcis mlr and rw 4 1 4 forecast calibration and evaluation the elm sov and mlr based models were calibrated using linear least squares forecasts were evaluated over the validation set an estimate of out of sample or generalization performance using metrics commonly adopted in hydrological and water resources forecasting studies nash sutcliffe efficiency index the root mean square error rmse and mean absolute percentage error mape adamowski et al 2012 moriasi et al 2007 quilty et al 2016 see section b of our supplementary material for further details 4 2 experimental details in order to demonstrate the usefulness of wddff for wavelet based hydrological and water resources forecasting we focussed on three main experiments using the daily uwd dataset from montreal to highlight how the best practices adopted by wddff can be used for identifying the best performing wavelet based forecast among a variety of alternatives based on different decomposition levels wavelet filters and forecasting strategies direct and multicomponent i e optimal decomposition levels wavelet filters and forecasting approaches and to show its added value in comparison to a recent and invalid in terms of real world applications wavelet based forecasting framework that adopts the modwt mra bachour et al 2016 barzegar et al 2018 2017 maslova et al 2016 prasad et al 2017 yang et al 2014 the three different experiments are as follows 1 best performing models for the different wavelet based forecasts contained within the wddff see section 3 3 1 1 and 4 1 we identified which wavelet decomposition algorithm modwt or at wavelet based forecasting approach direct or multicomponent and method 1 6 single within across single hybrid within hybrid or across hybrid performed best 2 best decomposition levels and wavelet filters of the best wddff based forecasts we showed that certain decomposition levels and wavelet filters were most useful in providing the best forecast accuracy some visible trends stood out 3 wddff vs modwt mra our proposed wddff in comparison to a current and invalid wavelet based hydrological and water resources forecasting approach modwt mra barzegar et al 2018 2017 he et al 2015 prasad et al 2017 yang et al 2014 that we have demonstrated throughout this work to include future data and that should be optimistically biased in terms of forecast accuracy a sign of its incorrectness provided more realistic forecast performance than modwt mra wddff s usefulness and realistic performance for real world forecasting problems was clearly shown these experiments were chosen to demonstrate that 1 wddff can result in widely different performance for different settings e g direct or multicomponent approaches but for our case study wddff always provided the best performance against benchmark models e g mlr elm sov and rw 2 wddff had the tendency to provide the best performance for a given decomposition level and wavelet filter combination and 3 wddff should be preferred over the modwt mra based including the dwt mra based forecasts currently adopted within many wavelet based hydrological and water resources forecasting studies as it provided realistic performance while modwt mra provided incorrect invalid performance for the dataset that we studied 5 results and discussion the results of our uwd forecasting experiment for the different daily lead times 1 3 5 7 and 14 can be found in table 3 1 day lead time while the remaining results 3 5 7 and 14 day lead times are given in section d of our supplementary material we included only the best forecasts for each model type due to the large amount of models 14 420 in total see section c of our supplementary material and reported their results for the validation partition although the calibration performance is similar to the validation performance affirming the stable generalization properties of the different forecasts the best model for a particular lead time forecast is in bold face within our tabulated results scatter plots for the best wavelet and non wavelet based models are shown in fig 3 5 1 best performing models the modwt single hybrid class of wddff wavelet based forecasts particularly the wmlr model provided the best performance across the explored lead times thus for this dataset it is the best of the eight different wavelet decomposition forecasting strategies see section 3 2 1 1 and 4 2 when comparing the best wavelet based forecasts against the non wavelet based forecasts table 3 fig 3 and tables in section d of our supplementary material we may notice that as the lead time increases the difference in performance generally becomes more pronounced with the biggest gains in performance being realized for the 14 day lead time this is a very promising quality of the wddff against the non wavelet based methods for the montreal uwd dataset as longer lead time forecasts can be used to constantly monitor sustainability planning and construction initiatives with reasonable foresight such as projecting expected water use during droughts or the amount of supply required to a site or pressure zone that would be beneficial in setting water use restrictions or allocating temporary services for water main maintenance or construction since the modwt single hybrid class of models provided the best forecasts for each lead time it suggests for this dataset that including both wavelet decomposed inputs and non wavelet decomposed inputs can increase forecast performance considerably in comparison to alternate cases where only wavelet decomposed or non wavelet decomposed inputs are solely used this has also been the case in earlier wavelet based forecasting studies adamowski 2008b nguyen and nabney 2010 voronin and partanen 2013 however the use of the un decomposed inputs alongside wavelet decomposed inputs is very rarely explored within hydrology and water resources furthermore the superiority of the wmlr models shows that the linear wavelet based models perform better than the nonlinear wavelet based models for all lead times while the nonlinear models tend to perform best when wavelet decomposed data are not used as inputs the reason behind this can be argued similarly to the discussion in koutsoyiannis et al 2010 where the authors provided evidence that while most hydrological and water resources processes are naturally nonlinear when they are observed from the standpoint of their changes across different time scales there tends to be a linear relationship between the original time series and the time series when viewed at its different scales of change one can also notice that in certain cases the non wavelet based forecasts outperformed some of the wddff forecasts for instance at the 1 day lead time the nonlinear non wavelet based forecasts outperform the nonlinear wddff models that use the at single modwt single and at within wavelet decomposition forecasting strategies for 3 5 7 and 14 day lead times the nonlinear non wavelet based forecasts outperform the nonlinear wddff models that use the modwt single wavelet decomposition forecasting strategy other similar cases can be inferred from table 3 and section d of the supplementary material these results highlight the importance of exploring a wide variety of different combinations of wavelet decomposition strategies modwt and at decomposition levels and wavelet filters and approaches for incorporating wavelet decomposed data in forecast development e g direct and multicomponent if this is not done it is possible to make generalized statements such as wavelet decomposed inputs are not necessarily as useful as the original un decomposed time series for forecasting purposes zhang et al 2015 5 2 best performing decomposition levels and wavelet filters it can also be noted that a decomposition level of six and wavelet filters of length 14 provided the best performance for each lead time forecast see table 3 and section d of the supplementary material fig 4 shows the u time series decomposed by the modwt and at algorithms using the la14 filter the wavelet filter used in the best performing wddff forecasts at lead times 1 3 5 and 7 we can see that using a decomposition level of six with the la14 filter results in smooth scaling coefficients that track inter annual annual and intra annual changes that are free of unnatural artefacts such as blocks sharks fins triangles etc percival and walden 2000 sec 5 11 it can also be seen that the at algorithm exhibits much larger variation across the wavelet coefficients than the modwt the at solely uses low pass filtering producing an additive decomposition while the modwt uses high pass filtering to compute the wavelet coefficients resulting in an energy based decomposition aussem et al 1998 percival 2008 percival and walden 2000 the scaling coefficients in fig 4 re affirms our earlier statement that the scaling coefficients produced by the modwt and at are the same for a 1 day lead time fig 5 shows the performance of the best wddff and non wavelet based models for the last 366 time series records in the validation set a pronounced weekly cycle is evident in the uwd time series the weekly cycle is well captured by the la14 and bl14 wavelet filters within the proposed wddff due to their larger support width that is a multiple of a weekly periodicity for daily time series when compared to shorter wavelet filters such as the haar which lend themselves well to capturing larger periods as opposed to smaller wavelet filters that are more suited to picking out transient events in fig 5 b one can notice the lower variation in the wmlr wddff residuals when compared to the non wavelet based sov forecast giving further evidence to support the use of wddff over the benchmark models one may argue that certain wavelet based forecasting approaches e g method 1 6 see section 3 2 1 1 produce similar results and that they do not help to clearly identify a best model or a significant difference in performance between competitors for example let us consider the 1 day lead time 3 5 7 and 14 day lead times have a wider gap between the best performing model and its competitors in terms of rmse mape and nash scores one can see that at this lead time many similar forecast results are achieved in terms of the nash score e g compare the at single modwt single at across at single hybrid modwt single hybrid and at across hybrid wmlr models in table 3 however one important point to note is that the optimal decomposition level and wavelet filter selected for each of these different wavelet based forecasting approaches that score similarly e g in terms of nash tend to be different e g wmlr at single hybrid uses a decomposition level of three and the coif1 wavelet filter while the modwt single hybrid uses a decomposition level of six and the la14 wavelet filter and both models performance differ by a small margin i e 0 002 in terms of nash this can be looked at positively by noting that methods that produced similar results but used different decomposition levels and wavelet filters could be assessed in terms of a trade off between computational efficiency and model accuracy we argue that without performing such a comprehensive exploration of these different wavelet based forecasting approaches method 1 6 see section 3 2 1 1 which has not yet been explored in such depth within the hydrology and water resources fields one could not identify such cases therefore our proposed wddff can be used as an exploratory analysis tool to identify optimal wavelet based forecasting strategies i e decomposition levels wavelet filters and forecasting approaches method 1 6 trading off between computational efficiency and model accuracy using wddff as an exploratory analysis tool can be useful before selecting a single or group of model s for issuing forecasts using newly received data such as for operational or planning tasks e g opening of dam gates identifying suitable crops to alleviate food shortages due to an impending drought etc we now compare wddff against a modwt mra based forecasting approach to show how the wddff forecasts are realistic and accurate while the modwt mra forecasts are unrealistic and cannot be used properly for real world forecasting 5 3 comparing wavelet data driven forecasting framework against a forecasting model using the modwt mra in fig 6 we have shown how misinterpretation of the modwt by applying the modwt mra for forecasting as in kriechbaumer et al 2014 xiao et al 2014 yang et al 2014 zhu et al 2014 bachour et al 2016 barzegar et al 2018 2017 and prasad et al 2017 can lead to invalid forecast performance fig 6 a shows the results of the best 1 day lead time forecast s residual on the validation set for the wddff which used the modwt single hybrid approach and compares it against a modwt mra single hybrid approach fig 6 b while we do not recommend this forecasting strategy we simply adjusted the former by adopting the modwt mra to decompose the target and explanatory variables instead of the modwt the same wavelet filter la14 decomposition level six and model type wmlr were used by both modwt and modwt mra based forecasts since the modwt does not incorporate future information the entire dataset can be decomposed at once without invoking error due to the bc in the wavelet and scaling coefficients however the modwt mra requires future data when calculating detail and approximation coefficients at any given time since decomposing the calibration and validation set separately when using the modwt mra causes wrap around effects see section 2 3 1 1 we first decomposed the calibration data to obtain the calibration detail and approximation coefficients and then we decomposed the calibration and validation data together and extracted the detail and approximation coefficients associated with the validation indices to obtain the modwt mra based validation detail and approximation coefficients in order to minimize the wrap around effects see section c of our supplementary material or refer to eqs 2 3 5 and 6 in table 1 despite the fact that other studies commonly decompose both calibration and validation data separately e g barzegar et al 2018 and prasad et al 2017 which only exacerbates the bc related uncertainty see section 2 3 3 our adjustment improved modwt mra performance a similar approach to our adjustment of the usual and incorrect manner in which the modwt mra has been used in forecasting studies was also adopted in the dwt mra based forecasting experiments in du et al 2017 where they demonstrated the incorrect forecasts produced by the dwt mra for a real world monthly rainfall forecasting problem which qualitatively resembles the results of the modwt mra based forecasts in this study the modwt mra based forecast achieved a nash score of 0 940 which nears 1 0 when the poor quality forecasts at the end of the record are removed significantly better than the modwt 0 916 we may notice that the modwt mra has negligible forecast error until it reaches the most recent time series observations where it utterly fails to provide a representative forecast since it requires data from the future which is replaced by surrogates see section 2 3 3 to accurately compute its detail and approximation components which are obviously unavailable to us while the modwt which does not require future data to calculate the wavelet and scaling coefficients at the same time positions has stable performance with errors ranging approximately between 100 megalitres per day here we can clearly see the risks in applying the modwt mra in forecasting studies it truly cannot be used correctly for real time forecasting 6 summary and conclusions many wavelet based water resources forecasting models summarized in recent reviews afan et al 2016 dixit et al 2016 fahimi et al 2017 nourani et al 2014 sang 2013 yaseen et al 2015 cannot be used for real world forecasting problems since they are incorrectly developed due to misunderstanding certain problems related to wavelet decomposition and the boundary condition 1 the future data issue 2 inappropriately selecting decomposition levels and wavelet filters and 3 not carefully partitioning calibration and validation data by not addressing these boundary conditions during wavelet decomposition the incorrectly developed wavelet based forecasting models often result in much better performance than what is achievable in reality du et al 2017 for an example see section 5 3 to address these important and prevalent errors we developed a set of best practices that were holistically combined into a new wavelet based forecasting framework the wavelet data driven forecasting framework wddff that can be used to overcome these errors and that can be used for real world hydrological and water resources forecasting problems see section 2 and 3 using a real world daily urban water demand forecasting experiment in montreal canada we showed that wddff outperformed benchmark methods such as non wavelet based multiple linear regression extreme learning machines and a second order volterra model and provided more realistic and correct performance when compared against a recent wavelet based forecasting strategy that adopted the maximal overlap discrete wavelet transform based multiresolution analysis modwt mra bachour et al 2016 barzegar et al 2017 he et al 2015 prasad et al 2017 seo et al 2017 yang et al 2014 and that showed unrealistic and incorrect performance during validation in addition to providing an approach that overcomes the errors mentioned above thus allowing it to be used for real world forecasting applications a useful property of our proposed wddff is that it uses two different wavelet decomposition algorithms maximal overlap discrete wavelet transform modwt and à trous algorithm at two different wavelet based forecasting approaches direct and multicomponent and has several methods single within across single hybrid within hybrid or across hybrid see section 3 2 1 1 for adopting wavelet decomposed data in the forecast design typically in hydrological and water resources forecasting studies only a single wavelet decomposition algorithm e g modwt mra forecasting approach e g direct and method e g single is used for our experiments the combination of different wavelet decomposition algorithms wavelet based forecasting approaches and methods were demonstrated to provide significantly different performances when compared against one another highlighting the usefulness and supporting the practice of exploring different strategies for incorporating wavelet decomposed data in wavelet based hydrological and water resources forecasting models by addressing common pitfalls and errors of wavelet based forecasts for real world hydrological and water resources problems and providing a number of different strategies for using wavelet decomposed data in the forecast design wddff can be considered a promising new method for hydrological and water resources forecasting and we expect its use to grow within hydrology and water resources and potentially other domains before discussing future research endeavours we summarize below our main original contributions 1 since the wavelet based forecasting literature in general and specifically hydrology and water resources does not contain any studies concerning best and correct practices for real world wavelet based forecasting models this paper represents the first to comprehensively a compare correct modwt and at and incorrect dwt mra and modwt mra wavelet decomposition methods for real world forecasting see section 1 and 2 2 b study the different boundary conditions that need to be properly addressed in order to correctly use a wavelet based forecasting model in real world problems i e use of future data improper selection of decomposition levels and wavelet filters and improperly partitioning calibration and validation data see sections 1 2 3 2 4 and 2 5 c propose in addition to a set of best practices that addresses each boundary condition a general wavelet based data driven forecasting framework i e wddff that can adopt any data driven model and input variable selection routine two wavelet decomposition algorithms modwt and at two wavelet based forecasting approaches direct and multicomponent and several methods single within across single hybrid within hybrid or across hybrid for decomposing and including both target and explanatory data in the forecast design see sections 2 2 3 2 1 1 and 3 3 and d evaluate the forecasting performance of wddff on a real world water resources forecasting problem using different combinations of the wavelet decomposition algorithms wavelet based forecasting approaches and methods see section 5 2 this study is the first to discuss and compare the differences between the modwt and at wavelet and scaling coefficients in terms of theory see section 2 1 and forecasting performance see section 5 2 this is also the first study to use the modwt wavelet and scaling coefficients directly i e instead of the modwt mra detail and approximation coefficients for hydrological or water resources forecasting see section 2 2 3 this is the first study to apply a conditional mutual information based input variable selection approach for identifying which modwt and at based wavelet and scaling coefficients to use in a data driven forecasting model see section 3 2 2 future research will focus on converting wddff from a deterministic forecast into a stochastic forecast such a model has already been developed by the authors and will be published under the name stochastic wavelet data driven forecasting framework swddff allowing for the forecasts from this method to be used to forecast systems subject to uncertainty and which may be useful for complementary objectives such as risk assessment chen et al 2013 yung et al 2011 one may expand wddff and swddff by adopting singular spectrum analysis ssa to afford yet another method for taking into consideration the periodic and transient nature of hydrological and water resources processes an interesting study would be to swap wavelets for ssa within our proposed wddff and compare performances between both methods finally since wddff was only studied for a single water resources process since this work served as an introduction to the new method further research is required to explore its usefulness for forecasting other hydrological and water resources processes e g streamflow rainfall evaporation etc acknowledgements the authors are grateful to the associate editor and anonymous reviewers for their constructive comments that have significantly improved the quality of this work we thank the city of montreal for providing the urban water demand data used in this study requests for urban water demand and meteorological data used in this study should be made through the city of montreal or obtained from environment canada at climate weather gc ca respectively our appreciation is extended to maheswaran rathinasamy for his helpful discussions regarding the à trous algorithm and its relation to the boundary condition problem funding for this research was provided by nserc discovery and accelerator grants held by jan adamowski appendix a supplementary data supplementary data associated with this article can be found in the online version at https doi org 10 1016 j jhydrol 2018 05 003 appendix a supplementary data supplementary data 1 
7142,many recent studies propose wavelet based hydrological and water resources forecasting models that have been incorrectly developed and that cannot properly be used for real world forecasting problems the incorrect development of these wavelet based forecasting models occurs during wavelet decomposition the process of extracting high and low frequency information into different sub time series known as wavelet and scaling coefficients respectively and as a result introduces error into the forecast model inputs the source of this error is due to the boundary condition that is associated with wavelet decomposition and the wavelet and scaling coefficients and is linked to three main issues 1 using future data i e data from the future that is not available 2 inappropriately selecting decomposition levels and wavelet filters and 3 not carefully partitioning calibration and validation data by not addressing these boundary conditions during wavelet decomposition incorrectly developed wavelet based forecasting models often result in much better performance than what is realistically achievable we demonstrate that the discrete wavelet transform dwt multiresolution analysis dwt mra and maximal overlap discrete wavelet transform modwt multiresolution analysis modwt mra two commonly adopted wavelet decomposition methods used in the development of hydrological and water resources wavelet based forecasting models suffer from these boundary conditions and cannot be used properly for real world forecasting however by following a proposed set of best correct practices we show that the modwt and à trous algorithm at can be used to correctly forecast target e g hydrological and water resources processes in real world scenarios in this vein we contribute a set of best practices which focusses on deriving boundary corrected wavelet and scaling coefficients from time series data overcoming the boundary condition issues and providing hydrological and water resources modellers with a justified and coherent strategy for developing wavelet based forecasting models that may be used for real world forecasting problems we coalesce these best practices into a new forecasting framework named wavelet data driven forecasting framework wddff that uses a combination of input variable selection and data driven models to convert boundary corrected wavelet and scaling coefficients into forecasts of a target process through a real world urban water demand forecasting experiment in montreal canada we demonstrate the superiority of wddff against benchmark forecasting models such as non wavelet based random walk multiple linear regression extreme learning machine and second order volterra series models for the same case study we also show how the wddff provides realistic and accurate forecasts while a recently proposed wavelet based forecasting model that adopts the invalid modwt mra for wavelet decomposition provides incorrect and unrealistic forecasts we conclude that wddff is a useful tool for forecasting real world hydrological and water resources processes that overcomes the limitations of many earlier wavelet based forecasting methods and should be explored further for forecasting different processes such as streamflow rainfall evaporation etc keywords time series forecasting wavelets best practices hydrology water resources 1 introduction the presence of multiple periodicities transients and or trends in hydrological and water resources time series often present difficulties to traditional data driven time series machine learning computational intelligence etc solomatine and ostfeld 2008 forecasting methods e g autoregressive integrated moving average arima multiple linear regression mlr artificial neural networks ann etc adamowski et al 2012 the fact that the wavelet transform wt or wavelets for short can decompose this information wavelet decomposition into separate high and low frequency sub time series wavelet and scaling coefficients and provide a more coherent structure of the complex time series and related variables to a data driven model has often lead to significant improvements in forecast accuracy and for that reason has made it a popular tool in hydrological and water resources forecasting fahimi et al 2017 recent reviews afan et al 2016 dixit et al 2016 fahimi et al 2017 nourani et al 2014 sang 2013 yaseen et al 2015 have highlighted the popularity of wavelet based forecasting in hydrology and water resources for example using scopus nourani et al 2014 cited around 100 papers on this topic between 2003 and 2013 while at the time of writing this paper we identified around 110 papers between 2014 and 2018 however despite the growing popularity of wavelet based time series forecasts in hydrology and water resources the proper design and interpretation of wavelet based forecasts has not always been carefully scrutinized often resulting in the design of forecasts that are invalid and that cannot be used in real world scenarios du et al 2017 zhang et al 2015 see sections 2 and 3 for details and section 5 for a real world example the largest misinterpretation regarding wavelet based forecasts and a significant impediment to their use in real world forecasting problems is related to wavelet decomposition where isolation and extraction of relevant features from a given time series using wt occurs and the inadvertent addition of error into the wavelet and scaling coefficients sub time series produced by the wt the main source responsible for generating this error in the wavelet and scaling coefficients is caused by what is known as the boundary condition bc or boundary treatment aussem et al 1998 bakshi 1999 maheswaran and khosa 2012a below we briefly review the basics of wavelet decomposition and then attempt a high level discussion of the bc before a more detailed treatment in the next section essentially wavelet decomposition can be understood as a convolution which can be likened to quantifying the similarity between a wavelet filter and a given time series resulting in a set of wavelet and scaling coefficients which contain high and low frequency information from the original time series the high and low frequency content of the wavelet and scaling coefficients depends on 1 the decomposition level which represents the different scales of change in the time series and 2 the wavelet filter whose width and shape determines the type of features that can be extracted from the time series e g trends transients periodicities polynomial behaviour etc maheswaran and khosa 2012a now the bc arises during wavelet decomposition when one seeks to calculate wavelet or scaling coefficients at a particular time and scale that cannot be calculated correctly i e without introducing error because the entire range of time series observations that are required in the calculation are not available we will refine this explanation later with some detailed examples different wt e g continuous wavelet transform cwt discrete wavelet transform dwt the maximal overlap dwt mowdt and à trous algorithm at slightly vary in how wavelet decomposition is carried out and this as will be discussed in detail in the next section leads to important differences in how one is to evaluate and treat the bc associated with a particular wt before providing technical details it is important to take note that the bc if not properly treated will add error into the wavelet and scaling coefficients in three distinct ways 1 through the inclusion of future data i e time series observations at future times t are used in the calculation of wavelet or scaling coefficients at time t see section 2 3 1 2 the improper selection of decomposition levels and wavelet filters i e decomposition levels that are too high and or wavelet filters that are too wide for a given time series see section 2 3 2 and 3 the incorrect partitioning of data into calibration and validation sets i e due to issues 1 and 2 above the calibration wavelet and scaling coefficients may include information from the time series observations that belong to the validation dataset and vice versa see section 2 3 3 before proceeding we must make clear two key items 1 we make an important distinction between error introduced to a wavelet based forecasting model via the bc and errors encountered in general modeling problems error due to the bc is avoidable if proper precautions which will be discussed in detail in the next section are taken while typical sources of error e g due to model parameterization initial conditions model structure etc are inherent in any modeling exercise i e whether wt are used or not this work is only focussed on the former 2 real world wavelet based forecasting is defined in this study as the use of a wavelet based forecasting model that is calibrated on a sequential historical record i e for t 0 1 n c 1 where n c is the number of calibration records and subsequently used to generate forecasts for a validation record i e for t n c n c 1 n c n v 1 where n v is the number of validation records where the validation record is unknown at the time of model calibration and becomes available to the forecaster only one record at a time i e at t n c 1 only time series records t 0 1 n c 1 are known to the forecaster while time series records t n c 2 n c 3 n c n v 1 remain unknown since they would not be available to the forecaster in a real world scenario by assuming this definition for real world wavelet based forecasting wavelet decomposition must be carried out on the validation records sequentially as would be the case in a real world scenario when new data becomes available to the forecaster only after it has been observed measured i e in real time it is the opinion of the authors that this is the correct way to treat the development of wavelet based forecasting models for use in real world scenarios in advance of our detailed exploration of each of the bc related problems i e the future data issue improper selection of decomposition levels and wavelet filters and calibration and validation set partitioning in the next section it is important to note that when any of these sources of error are included in the wavelet coefficients and subsequently used within a wavelet based forecasting model error is introduced and carried throughout the entire model development and testing stages model calibration and validation respectively this error which is difficult to characterize since it is related to many different factors e g the type of wt the decomposition level wavelet filter and dataset partitioning can lead to unrealistic forecasts and is the result of the incorrect development of a wavelet based forecasting model by neglecting to address the bc du et al 2017 by not addressing each of the bc one cannot use wt correctly for real world forecasting problems i e without introducing error due to the bc therefore if one is to correctly develop a wavelet based forecasting model it is important to understand how wavelet decomposition is related to the wt e g dwt modwt or at selected by the forecaster and how to adjust for the resulting bc of significance we note and will show in the next section that the most popular wt the dwt used in hydrology and water resources wavelet based forecasting studies e g altunkaynak and nigussie 2017 deo et al 2017c dixit et al 2016 fahimi et al 2017 nourani et al 2014 rezaie balf et al 2017 samadianfard et al 2018 cannot be corrected in terms of the above mentioned bc and therefore should not be used for real world forecasting applications du et al 2017 as pointed out in du et al 2017 since the dwt does not address any of the boundary conditions during wavelet decomposition the incorrectly developed dwt based forecasting models often result in much better performance than what is realistically achievable this is an important issue since an estimated 90 of papers 191 210 identified on scopus between 2003 and 2018 use the dwt for hydrological and water resources wavelet based forecasting applications however we will show how the bc associated with both the modwt and at can be straightforwardly addressed once the bc related adjustments have been made both the modwt and at can be used correctly for real world forecasting problems to illustrate the importance of the bc and its connection to these wt we compare and contrast the dwt modwt and at algorithms showing where the bc arises for each method and how it can be addressed for the modwt and at but not the dwt allowing for the proper development of wavelet based forecasting models for real world use interestingly the comparison of the bc related issues arising from each of these wt i e dwt modwt and at in terms of wavelet based forecasting applications has yet to be carried out in the literature since a large majority of studies mentioned in numerous review articles on wavelet based forecasting in hydrology and water resources afan et al 2016 dixit et al 2016 fahimi et al 2017 nourani et al 2014 yaseen et al 2015 including more recent studies bachour et al 2016 barzegar et al 2018 2017 baydaroğlu et al 2017 maslova et al 2016 prasad et al 2017 rezaie balf et al 2017 samadianfard et al 2018 seo et al 2017 shi et al 2018 yadav and eliza 2017 yu et al 2018 propose wavelet based forecasting models that cannot be used in real world forecasting problems due to different combinations of the bc related issues mentioned above we feel that it is very important to address this gap in the literature therefore we make it our goal to explore and address the above mentioned bc related problems connected to dwt modwt and at enabling the correct development of wavelet based forecasts that may be used for real world applications to meet this goal we contribute to the literature in two main ways 1 by developing a set of best and correct practices for wavelet based forecasting that addresses each of the three bc related problems e g future data selection of decomposition levels and wavelet filters and calibration and validation set partitioning through careful analysis of different wt i e the dwt modwt and at and their wavelet decomposition procedure and 2 adopting our proposed best practices in a new wavelet based forecasting framework that can be utilized in real world forecasting scenarios both contributions are important for the field of hydrology and water resources since most wavelet based forecasting models developed in hydrological and water resources studies are incorrect and there currently does not exist 1 a comprehensive study of the differences between the dwt modwt and at in terms of each bc 2 best practices that addresses each of the bc and 3 a general forecasting framework incorporating a set of best correct practices that can be applied alongside any type of data driven model and be used for real world wavelet based forecasting scenarios these important contributions are realized through the following steps 1 we systematically review wavelet decomposition for the most popular wt used in hydrological and water resources forecasting the dwt modwt and at by focussing on the three bc related issues i e future data selection of decomposition levels and wavelet filters and calibration and validation set partitioning in terms of both theory and practical application showing how they are commonly misunderstood and misused resulting in invalid forecasts 2 we then introduce a set of best correct practices to address each of the bc related issues that ultimately results in the calculation of what we term boundary corrected wavelet and scaling coefficients 3 we show how boundary corrected wavelet and scaling coefficients can be determined through two different wt the modwt and at that until now have not been studied together in the wavelet based forecasting literature 4 we review the differences between the modwt and at in terms of their wavelet decomposition strategies discovering that for forecasting applications the modwt can only be used for pre processing input data while the at can be used for pre processing both target and input data to the best of our knowledge this finding has been overlooked in the wavelet based forecasting literature 5 we develop a new wavelet based forecasting framework wavelet data driven forecasting framework wddff that adopts our best practices and uses the boundary corrected wavelet coefficients derived from either the modwt or at and any data driven model e g arima mlr ann etc to forecast a target process and 6 we use wddff in a real world daily urban water demand uwd forecasting exercise in montreal canada demonstrating its usefulness and potential for forecasting real world hydrological and water resources time series to introduce our proposed best correct practices for wavelet based forecasting and the wddff the rest of this work is arranged in the following order in section 2 we introduce the different wavelet decomposition approaches commonly used in wavelet based hydrological and water resources forecasting models discuss how the bc related issues apply to each wavelet decomposition approach and show how these issues can be solved in section 3 we show how the solutions to each of the bc related issues can be formulated as a set of best practices and then used within a new wavelet based forecasting framework wddff section 4 explains our real world forecasting experiment used to demonstrate the usefulness of wddff section 5 focusses on the results of our experiment and discusses their significance finally section 6 concludes the study by highlighting its main contributions originality and suggesting avenues for future research 2 theoretical basis for best correct practices in wavelet based forecasting 2 1 an overview of the different wavelet transforms used in hydrology and water resources for wavelet based forecasting our focus in this sub section is on the theoretical details of and comparison between the dwt modwt and at we chose to focus on these three wt since the dwt is the most commonly used in hydrology and water resources wavelet based forecasting and as we will show below results in incorrect forecasts and because the modwt and at are the only wt that can be used correctly for real world forecasting in table 1 we have provided the equations eqs 1 9 needed to perform wavelet decomposition using the dwt 1 2 modwt 4 5 and at 7 8 aussem et al 1998 maheswaran and khosa 2012a percival and walden 2000 eqs 3 6 and 9 can be used to reconstruct the time series i e back to its original values via the dwt modwt and at respectively we note that we have not included the cwt in our discussion at it suffers from the same bc related issues as the dwt less the dyadic condition mentioned below typically requires many ad hoc corrections when used for forecasting and is computationally expensive adamowski 2008a 2008b nourani et al 2009b rathinasamy et al 2014 previously studied details concerning the wavelet decomposition process that results in the dwt modwt and at wavelet w j w j and w j t a and scaling coefficients v j v j and v j t a where j 1 2 j and j is the decomposition level including information on their properties and those of their wavelet and scaling filters can be found in section a of our supplementary material instead we focus on the key differences between the dwt modwt and at wavelet and scaling coefficients to prepare our discussion on how each of the bc related issues i e future data selection of decomposition levels and wavelet filters and calibration and validation set partitioning are related to each wt the key difference between the dwt and the modwt and at is that the dwt involves decimation therefore dwt wavelet and scaling coefficients at a given level j have 2 j fewer coefficients than at scale j 1 the decimation of the dwt causes several major issues for wavelet based forecasting applications thus making it invalid for real world forecasting problems 1 it requires the time series to be an integer multiple of 2 j 2 it is shift invariant and 3 it is sensitive to adding new data points maheswaran and khosa 2012a percival and walden 2000 walden 2001 each point is explained in more detail in section a of our supplementary material the drawbacks of the dwt mentioned in points 1 3 can be overcome through the modwt and at by simply rescaling the wavelet h l and scaling filters g l used by the dwt as follows h l h l 2 and g l g l 2 the re scaling of the dwt filters conserves energy and obviates the need to sub sample in the modwt and at i e dyadic sub sampling is avoided resulting in wavelet and scaling coefficients that are the same length as the original time series walden 2001 from table 1 eqs 5 and 6 it is clear that the modwt and at share the same scaling coefficients since they are calculated using the same low pass filter g however their wavelet coefficients differ the modwt uses a high pass filter h to calculate its wavelet coefficients while the at calculates its wavelet coefficients at scale j by differencing the scaling coefficients at levels j and j 1 therefore the at permits an additive reconstruction of a given time series eq 9 while the modwt must apply an iterative reconstruction of the time series through the reverse pyramid algorithm eq 8 this interesting result has important consequences for forecasting applications and is discussed later in this section now that we have noted the key differences between the dwt modwt and at in terms of wavelet decomposition and reconstruction we can now look at how the wavelet and scaling coefficients produced by the different wt have been used and misused in hydrology and water resources wavelet based forecasting studies afterwards our discussion will focus on the implications of the bc related to each wt in terms of wavelet based forecasting 2 2 use and misuse of wavelet and scaling coefficients in hydrology and water resources wavelet based forecasting since the dwt wavelet w 1 w 2 w j and scaling coefficients v j are decimated at each scale those adopting the dwt for wavelet based forecasting must use multiresolution analysis mra mallat 1989 to convert the decimated wavelet and scaling coefficients into detail d 1 d 2 d j and approximation coefficients s j respectively that are of the same length as the original time series afterwards the detail s and approximation coefficients are used as input to a given forecasting model kişi 2011 we refer to the conversion of wavelet and scaling coefficients to detail and approximation coefficients respectively as dwt based mra or dwt mra although it is often referred to in the literature as simply dwt sang 2013 or mra dixit et al 2016 similar to the dwt mra the same process can be followed for the modwt to produce the modwt mra detail s d 1 d 2 d j and approximation coefficients s j percival and walden 2000 an interesting characteristic of the dwt mra and modwt mra is that similar to the at the detail s and approximation coefficients provide an additive reconstruction of the time series because of this property the at wavelet and scaling coefficients are often referred to as detail and approximation coefficients in the literature aussem et al 1998 maheswaran and khosa 2012a the additive reconstruction property of the dwt mra modwt mra and at is given as aussem et al 1998 percival and walden 2000 10 x t j 1 j d j t s j t j 1 j d j t s j t j 1 j w j t a v j t a however unlike the at the dwt mra and modwt mra suffer from a serious drawback in terms of their usefulness in real world forecasting applications they require future data in order to calculate detail and or approximation coefficients at a given point in time we give a detailed example showing why this occurs in the next sub section an inadvertent misunderstanding of this important drawback has led to the detail s and approximation coefficients derived from both the dwt mra and modwt mra being commonly used in hydrological and water resources wavelet based forecasting models resulting in invalid forecasts e g alizadeh et al 2017 bachour et al 2016 barzegar et al 2018 2017 ebrahimi and rajaee 2017 ghazvinei et al 2017 he et al 2015 maslova et al 2016 patil and deo 2017 prasad et al 2017 seo et al 2017 shoaib et al 2018 yang et al 2014 while the wavelet or detail and scaling or approximation coefficients derived by the at have been used in a number of studies adamowski and chan 2011 belayneh et al 2016b bogner and kalas 2008 djerbouai and souag gamane 2016 khalil et al 2015 maheswaran and khosa 2012b rathinasamy et al 2013 it is surprising to note given that the modwt mra detail s and approximation coefficients have been used in several studies that the modwt wavelet and scaling coefficients have yet to be used in any hydrological or water resources wavelet based forecasting studies therefore this study introduces the first use of the modwt wavelet and scaling coefficients for wavelet based forecasting of hydrological and water resources the two most common ways in which the detail s and approximations from the dwt mra modwt mra and at are used for wavelet based forecasting are 1 decomposing only the explanatory variables into detail s and approximation coefficients and forecasting the target directly alizadeh and kavianpour 2015 kişi 2011 samadianfard et al 2018 also known as the direct approach nguyen and nabney 2010 2 decomposing both target and explanatory variables into detail s and approximation coefficients and forecasting each decomposed target series detail or approximation separately using the decomposed explanatory variables and then aggregating the separate target series predictions using additive reconstruction eq 10 barzegar et al 2017 shafaei and kisi 2016 yadav and eliza 2017 also known as the multicomponent approach nguyen and nabney 2010 another similar but less popular approach is to use another model e g ann to reconstruct the separate target series predictions instead of eq 10 cannas et al 2006 kim and valdés 2003 this approach is unnecessary since it adds additional errors to the forecast due to the use of a model for reconstruction instead of the simple additive reconstruction offered by eq 10 it is significant to note that both wavelet based forecasting approaches i e the direct and multicomponent methods can lead to different levels of forecast accuracy and it is therefore important to consider both approaches in order to identify the best possible forecast for a given dataset nguyen and nabney 2010 a result that is confirmed later in this paper section 5 and which is seldom considered in wavelet based hydrological and water resources forecasting studies we will also show later that both the multicomponent and direct approaches can be used by the at for real world wavelet based forecasting while only the direct approach is applicable to the modwt we now discuss how the different bc related issues i e the future data issue inappropriately selecting decomposition levels and wavelet filters and not carefully partitioning calibration and validation data affect each of these wavelet based forecasting approaches and propose our solutions to these problems 2 3 boundary condition related issues and solutions in wavelet based forecasting it is important to re iterate that our intention is to circumvent the use of wavelet and scaling coefficients impacted by bc and to only use boundary corrected wavelet and scaling coefficients that do not suffer from any boundary condition for wavelet based forecasting by meeting these conditions boundary corrected wavelet and scaling coefficients can be used correctly for real world forecasting applications we start by showing how the future data issue is related to the dwt mra and modwt mra and how it is avoided by the modwt and at 2 3 1 the future data issue the future data issue occurs when a given wt e g dwt mra and modwt mra requires time series observations existing after ahead of time t in order to perform wavelet decomposition on a time series observation at time t in other words data from the future of the time series t is required to calculate a wavelet or scaling coefficient in the present at t it becomes obvious that if time series observations t are unavailable to the forecaster which is the case in real world scenarios then they are unable to perform wavelet decomposition at time t it is therefore of great importance that wt that do not use future data such as the modwt and at are adopted in real world wavelet based forecasting models and those that require future data such as the dwt mra and modwt mra are avoided in table 2 we give a very simple example showing how the future data bc issue occurs in the dwt mra and modwt mra and how it is avoided by the modwt and at using the formulae from table 1 in this example we consider a time series of length 32 n 32 a wavelet filter of length four l 4 e g the daubechies 4 filter see section a of the supplementary material and a decomposition level of one j 1 we calculate the first level detail coefficient at time index 16 t 16 for the dwt mra d 1 16 modwt mra d 1 16 and at d 1 16 a using eqs 7 9 see also section a of the supplementary material for how the dwt mra and modwt mra detail coefficients are calculated fig 1 provides a graphical depiction of the future data issue showing which of the original time series observations are used for calculating the detail coefficients at t 16 by the dwt mra modwt mra and at note that the modwt uses the same observations as the at when calculating its wavelet and scaling coefficients noting that x t v 0 t we can clearly see that both the dwt mra and modwt mra require information from v 0 x as far into the future as t 19 to calculate d 1 16 and d 1 16 respectively however the at does not require future information to exist as it requires only the present time index or earlier i e t 16 to calculate d 1 16 a which is equivalent to w 1 16 a note also that the modwt wavelet coefficient w 1 16 has the same requirement as the at in this regard to borrow a definition from linear filtering the at and modwt are causal algorithms as they do not require any future information to calculate their value at a given time index since this is not the case for the dwt mra and modwt mra they are non causal algorithms bašta 2014 maheswaran and khosa 2012a another important point that we explore in more detail in section 2 3 3 is related to the calibration and validation set partitioning bc problem using the same example if we consider that the first 17 time series observations as calibration records and the remaining 15 as validation records one can immediately realize that if we were to treat forecasts over the validation record in real time as in a real world problem one would not even have enough data to issue a forecast at time t 16 for t 16 using the dwt mra and modwt mra however the at and modwt do not suffer from this issue as they do not require information in advance of t 16 and could therefore be used to make a forecast for t 16 at time t 16 this very important issue is overlooked in the vast majority of studies considering wavelet based forecasting models 2 3 2 the future data solution the solution to the future data issue is simple for any wavelet based forecasting model the non causal dwt mra and modwt mra that use future data should be avoided and the causal at or modwt algorithms should be used instead since they do not use future data a relevant question to ask is are there any catches to using the at and modwt for real world forecasting the answer is yes and the catches to using the at and modwt are as follows 1 the modwt cannot be used with the multicomponent approach as it does not provide an additive reconstruction via eq 10 2 the decomposition level and wavelet filter must be appropriately selected and 3 a suitable number of calibration and validation records should be used we discuss the proper selection of the decomposition level and wavelet filter in the next sub section and show how the second and third points are intimately tied to one another in section 2 3 3 2 3 3 the improper selection of decomposition level s and wavelet filter s issue the bc due to decomposition level and wavelet filter selection introduces error into the wavelet and scaling coefficients at the beginning and potentially end of the time series depending on the wt see below according to the following formula bašta 2014 maslova et al 2016 percival and walden 2000 11 l j 2 j 1 l 1 1 where l j represents the number of wavelet and scaling coefficients affected by the bc for decomposition level j and a wavelet filter of length l for the at and modwt only the beginning of the time series i e for t 0 1 l j 1 is affected by the bc due to the selected decomposition level and wavelet filter while the first and last l j wavelet and scaling coefficients are affected i e t 0 1 l j 1 and t n 1 n 2 n l j 1 for the dwt mra and modwt mra percival and walden 2000 the bc issue related to decomposition level and wavelet filter selection can be seen in table 1 e g refer to t 2 j 1 l mod n for the modwt and at algorithms where the modulo operator mod is used to represent circular convolution also referred to in the literature as the circularity boundary condition and is necessary in order to calculate wavelet detail and scaling approximation coefficients that require observations for t 0 t 0 and t n 1 bašta 2014 percival and walden 2000 it is important to consider the significance of the bc issue related to decomposition level and wavelet filter selection when one selects a wavelet filter that is too wide long and chooses a decomposition level that is too high it leaves very few wavelet and scaling coefficients free from bc related uncertainty from which to calibrate a wavelet based forecasting model aussem et al 1998 this important item is often overlooked in numerous hydrological and water resources forecasting studies employing wt where the common approach is to neglect the error introduced in those wavelet coefficients and to use the incorrect coefficients as input to a data driven model e g as in barzegar et al 2017 karbasi 2017 nourani and saeidifarzad 2017 and shoaib et al 2018 when the correct approach is to not include those coefficients in the forecast and only use those wavelet and scaling coefficients that can be calculated with certainty aussem et al 1998 bašta 2014 renaud et al 2003 2005 the common practice of ignoring the error introduced due to improper selection of decomposition levels and wavelet filters in wavelet based forecasting can be better understood through an example a popular wavelet filter used in wavelet based hydrological and water resources forecasting studies akrami et al 2014 barzegar et al 2017 ebrahimi and rajaee 2017 mirbagheri et al 2010 rajaee 2011 ravansalar and rajaee 2015 rezaie balf et al 2017 sahay and srivastava 2014 shoaib et al 2016a b that very seldom should be used except for cases considering a very large number of time series records and low decomposition levels is the discrete meyer dmey wavelet filter with a filter length l of 102 coefficients as an example the dmey wavelet filter has been used to forecast a monthly precipitation time series that included only 350 historical records using the dwt mra at a decomposition level of three nourani et al 2009a using the dmey with a three level decomposition produces 708 boundary coefficients i e l 3 2 3 1 102 1 1 708 at the beginning and end of the time series 1416 in total this is more than quadruple the amount of time series records that were available which means that not only was the entire calibration dataset filled with wavelet and scaling coefficients that included errors due to the bc but also the entire validation set the model reported coefficient of determination scores of 0 935 and 0 890 on the calibration and validation partitions respectively however these results are difficult to interpret in terms of model generalization since both datasets used wavelet and scaling coefficients that were incorrect not only due to the future data issue but also due to the improper selection of decomposition level and wavelet filter in addition to the references mentioned earlier in this paragraph other very similar cases are present in the literature e g krishna 2013 moosavi et al 2013 shirmohammadi et al 2013 sehgal et al 2014 and shoaib et al 2015 where unrealistically wide wavelet filters were used with high decomposition levels causing most calibration and validation records to be tainted with error while the literature includes so called boundary condition correction methods to counteract the selection of high and wide decomposition level s and wavelet filter s respectively such as those employed for the dwt mra and modwt mra karthikeyan and kumar 2013 maslova et al 2016 percival et al 2011 the future data issue still remains for these methods which makes them not usable in real world forecasting studies we do not delve into bc correction methods as our goal is to avoid adding any error due to bc into our wavelet based forecasting models realistically any bc correction method adds some form of error since it is inherently a model in itself instead we propose an alternative approach in the next sub section and show how to properly address decomposition level and wavelet filter bc related error for the at and modwt algorithms 2 3 4 the solution for properly selecting decomposition level s and wavelet filter s the proper selection of decomposition level s and wavelet filter s is a three step process 1 choose either the modwt or at for wavelet decomposition 2 select a decomposition level and wavelet filter and 3 remove the first l j wavelet and scaling coefficients as determined by eq 11 resulting in boundary corrected wavelet and scaling coefficients the final bc related issue to address is related to the partitioning of data into calibration and validation sets since this item is tied to decomposition level and wavelet filter selection through the number of boundary affected coefficients as determined via eq 11 recall our example of the dmey wavelet filter above we will show below that it is imperative to select decomposition level s and wavelet filter s in conjunction with careful dataset partitioning 2 3 5 the dataset partitioning issue a common practice in hydrological and water resources wavelet based forecasting studies adopting the dwt mra and modwt mra is to decompose both calibration and validation data separately to overcome the future data issue barzegar et al 2018 2017 deo et al 2017c prasad et al 2017 however this is a misunderstanding of the future data issue as described in this study since we have shown that at any given time the dwt mra and modwt mra require future data to compute detail and approximation coefficients in reality if the calibration and validation data are decomposed separately this causes problems at the boundaries of each partition where 1 the calibration data must wrap around and use wavelet and scaling coefficients at the beginning of the time series as surrogates to calculate the boundary coefficients at the end of the calibration dataset and 2 the earlier boundary coefficients of the validation set use the wavelet and scaling coefficients at the end of the validation record as surrogate values for calculating their values du et al 2017 karthikeyan and kumar 2013 zhang et al 2015 we clearly show this to be the case by drawing on our example in table 2 assuming that the first 17 records are used for calibration and the remaining 15 for validation if the dwt mra or modwt mra is used and the calibration and validation data are first partitioned and then decomposed separately in the calculation of d 1 16 or d 1 16 i e the final calibration record v 0 19 would be swapped for v 0 2 since v 0 19 mod 17 v 0 2 as its surrogate v 0 18 for v 0 1 v 0 17 for v 0 0 etc considering d 1 17 or d 1 17 i e the first validation record v 0 16 which is required to calculate d 1 17 or d 1 17 would no longer be taken as v 0 16 but would be replaced by v 0 32 as its surrogate similarly v 0 15 would be replaced by v 0 31 as its surrogate and so on it is very clear that the dwt mra and modwt mra cause significant problems when attempting to calibrate and validate real world wavelet based forecasting models it is worth re iterating that this issue with the dwt mra and modwt mra can be circumvented by adopting the modwt and at algorithms for wavelet decomposition of the calibration and validation records and is discussed in more detail below 2 3 6 the solution for correctly partitioning a dataset our solution for correctly partitioning data in wavelet based forecasting models is founded on two key principles 1 avoiding the case where there are more boundary coefficients than available time series records as discussed in 2 3 2 and 2 providing enough time series records from which to calibrate and validate a wavelet based forecast these two principles can be broken down in a set of steps 1 adopt either the modwt or at since they are causal filters that do not have any dependence on future data 2 select a maximum decomposition level j max and a variety of wavelet filters of suitable length see section a of the supplementary material for examples the value j max and a series of wavelet filters can be selected by applying eq 11 to determine the number of boundary affected coefficients and ensuring that l j n 3 remove the first l j wavelet and scaling coefficients from the beginning of the wavelet and scaling coefficients i e the boundary affected coefficients obtaining the boundary corrected wavelet and scaling coefficients such that there are at least enough calibration records unaffected by the boundary condition providing the wavelet based forecasting model with enough records for calibrating the explanatory variables to the target variable 4 after calibration apply the modwt or at to the validation set one record at a time and calculate the forecast for each validation record and 5 repeat steps 1 to 3 until one has identified suitable decomposition levels and wavelet filters for forecasting a given target process it may be useful to perform an initial exploratory analysis by selecting both a maximum decomposition level and wavelet filter length by cycling through a combination of each pair to identify suitable candidates suitable candidate decomposition levels and wavelet filters should be identified by the modeller s preference which is usually a function of a trade off between model accuracy on the validation records and computational efficiency e g based on a tolerance that is appropriate to the modeller another key point connected to data partitioning of the calibration and validation records is to ensure that any data scaling applied to the explanatory and target variables prior to their input to a data driven model a useful practice for ensuring that certain inputs are not favoured due to a larger range in comparison with other inputs but instead due to their intrinsic relationships with the target process is to apply the scaling properties e g maximum and minimum values mean and standard deviation etc from the calibration data to both calibration and validation data and to not perform this separately otherwise the calibrated model parameters might not generalize properly to unseen data hastie et al 2009 while this is a fundamental concept we mention it here since to the best of our knowledge we have not yet seen this important issue discussed in studies on wavelet based hydrological and water resources forecasting 3 best correct practices and the wavelet data driven forecasting framework the solutions to the bc related issues discussed in the last section e g the future data issue selection of decomposition levels and wavelet filters and calibration and validation set partitioning can now be formulated into a general wavelet based forecasting framework wavelet data driven forecasting framework wddff we first summarize the best practices adopted within wddff and then discuss the building blocks of wddff that can be varied based on the forecasters preferences e g type of wt at or modwt wavelet filter selection data driven model selection etc 3 1 best practices adopted by the wavelet data driven forecasting framework the wddff is based on the following best practices 1 adopting either the at or modwt for wavelet decomposition 2 using the at or modwt to calculate boundary corrected wavelet and scaling coefficients see section 2 3 2 and 2 3 3 which is carried out according to a the selection of a decomposition level and wavelet filter such that j max and l results in l j n i e according to eq 11 and b removing the first l j boundary effected coefficients from the beginning of the wavelet and scaling coefficients such that after partitioning the dataset into calibration and validation partitions there are at least enough calibration records unaffected by the boundary condition 3 using the boundary corrected wavelet and scaling coefficients to calibrate the wavelet based forecasting model 4 validating the wavelet based forecasting model by applying the at or modwt to the validation set one record at a time and ensuring that the forecasting model s performance and computational efficiency meet the forecasters requirements else repeat steps 1 3 until a suitable forecasting model is obtained 3 2 the building blocks of the wavelet data driven forecasting framework by assuming that the best practices described above are followed for wavelet based forecasting the main building blocks of the wddff can be broken down into 1 selecting a wavelet based forecasting method section 3 2 1 2 input variable selection for wavelet and scaling coefficients section 3 2 2 and 3 selection of a data driven model section 3 2 3 we discuss each of these items in detail in the sub sections below and summarize these steps in a flowchart fig 2 3 2 1 pre processing data the first step in the wddff is to pre process the data to begin the forecast lead time is set and the explanatory and target variables i e input and output respectively are partitioned into calibration and validation sets depending on the wavelet based forecasting method see sub section 2 2 and 3 2 1 1 the explanatory variables are decomposed using the modwt or at direct approach or both explanatory and target variables are decomposed using the at multicomponent approach 3 2 1 1 different wavelet based forecasting methods since the at can be used in either a direct or a multicomponent forecasting approach i e both explanatory and target variables are decomposed and the target forecast is obtained through additive reconstruction eq 10 while the modwt can only be used in a direct forecasting approach i e only explanatory variables are decomposed and the target is forecasted directly see section 2 2 one can develop a wide variety of wavelet based forecasts under the wddff both direct and multicomponent approaches are important to consider as they can differ in forecast accuracy and it is thus significant to explore both approaches in order to obtain the best overall forecasting model for a given dataset this also gives the modeller access to different models that may be assessed in terms of trade offs between computational efficiency and forecast accuracy or for ensemble modeling rathinasamy et al 2013 using the direct and multicomponent approaches we define six different ways in which the wddff may be used to develop wavelet based forecasts via the modwt and at although there potentially exists other approaches we focus on only these approaches since they are straightforward to apply and encompass the different direct and multicomponent wavelet based forecasting approaches studied thus far in hydrology and water resources 1 single method 1 a direct approach wavelet decomposed explanatory variables are used as input and the target variable as output for a given data driven model 2 within method 2 a multicomponent approach forecast each set of wavelet and scaling coefficients for the target variable using the wavelet and scaling coefficients from the explanatory variables at the same levels i e the first level wavelet coefficients for the target are forecasted using the first level wavelet coefficients from the explanatory variables the second level wavelet coefficients for the target are forecasted using the second level wavelet coefficients from the explanatory variables and so on we name this method within since only wavelet and scaling coefficients within the same level are used in the forecasts 3 across method 3 a multicomponent approach forecast each set of wavelet and scaling coefficients for the target process using the wavelet and scaling coefficients from the explanatory variables for all levels i e the first level wavelet coefficients for the target are forecasted using the first second third etc level wavelet coefficients including the scaling coefficients from the explanatory variables we name this method across since wavelet and scaling coefficients from the explanatory variables across the different levels are used in the forecasts of the wavelet and scaling coefficients of the target process at each level 4 single hybrid method 4 a direct approach the same as method 1 but the original un decomposed explanatory variables are also used as input 5 within hybrid method 5 a multicomponent approach the same as method 2 but the original un decomposed explanatory variables are also used as input for each of the target variable s wavelet and scaling coefficients 6 across hybrid method 6 a multicomponent approach the same as method 3 but the original un decomposed explanatory variables are also used as input for each of the target variable s wavelet and scaling coefficients eight different wavelet based forecasting approaches can be used six using the at and two using the modwt both within and across based multicomponent approaches method 2 3 5 and 6 can only be used with the at since it is the only wt amongst modwt and at that can be reconstructed additively i e via eq 10 the reason for including the original un decomposed explanatory variables along with wavelet decomposed explanatory variables is because the original time series contain coarse global details while the wavelet decomposed time series contain specific localized details together they provide a more comprehensive structure view of the overall process that is being forecasted and this has been shown to increase forecast performance in earlier wavelet based forecasting studies adamowski 2008a 2008b aggarwal et al 2008 nguyen and nabney 2010 voronin and partanen 2013 we stress that method 1 6 solely adopt boundary corrected wavelet and scaling coefficients derived by modwt and at methods 1 3 are generalizations of methods 4 6 with the difference being that non wavelet decomposed data is not considered in methods 1 3 since the original data is available we feel that its predictive ability in concert with that of the wavelet decomposed data should be explored in order to develop the best forecast model adamowski 2008b nguyen and nabney 2010 method 1 has been used in numerous studies by the present authors e g adamowski and sun 2010 adamowski and chan 2011 adamowski et al 2012 campisi pinto et al 2013 belayneh et al 2014 belayneh et al 2016a belayneh et al 2016b and khalil et al 2015 and others e g benaouda et al 2006 maheswaran and khosa 2012a li and cheng 2014 djerbouai and souag gamane 2016 but in these studies solely the at was adopted and the modwt was not explored methods 4 and 5 were considered by nguyen and nabney 2010 with methods 1 and 2 being specific cases of these methods while a variant of method 3 in addition to method 1 was considered by murtagh et al 2004 where the authors included lower level higher frequency wavelet coefficients as predictors for scales at the same level or above while our approach includes the potential to use higher level lower frequency wavelet coefficients as predictors for lower level coefficients and vice versa we are not aware of any studies that have proposed method 6 or compared each of the proposed eight different varieties of wavelet decomposition forecasting strategies i e six different methods methods 1 6 with eight different modes methods 1 6 apply to at and methods 1 and 4 apply to the modwt 3 2 2 input variable selection for wavelet and scaling coefficients after decomposing the input output dataset according to the wavelet based forecasting method in the previous stage input variable selection is used to identify only those wavelet and scaling coefficients pertinent to the forecasting model input variable selection provides a systematic means for selecting which variables are useful in predicting a target process and can enable an automatic selection of relevant variables that consider relevancy and redundancy amongst potential candidates quilty et al 2016 performing input variable selection using wavelet decomposed data is not a new concept alsberg et al 1998 recent approaches have investigated using partial correlation input selection pcis tran et al 2016 mutual information mi rana and koprinska 2016 and conditional or partial mi cmi or pmi he et al 2015 li et al 2016 for selecting the best wavelet decomposed inputs for wavelet based forecasting as part of wddff we opt to select which boundary corrected wavelet and scaling coefficients are to be used in forecasting the target process by adopting the input variable selection methods discussed in quilty et al 2016 we considered two input variable selection methods the edgeworth approximations based cmi ea approach and pcis to maintain brevity readers should consult quilty et al 2016 for details on the ea method the ea method uses information theoretic concepts e g multivariate differential entropy to estimate cmi for multivariate datasets and is therefore well suited for capturing nonlinear dependence while the pcis method is based on partial correlation using the typical linear pearson correlation and is limited to identifying only linear relationships galelli et al 2014 in general other input variable selection algorithms can be used instead of ea or pcis within the wddff andersen and bro 2010 creaco et al 2016 fernando et al 2009 galelli and castelletti 2013 kariwala et al 2013 taormina et al 2016 we selected the ea method instead of other similar nonlinear methods such as partial mutual information selection fernando et al 2009 k nearest neighbours based conditional mutual information tsimpiris et al 2012 partial information sharma et al 2016 etc since it has been shown to be computationally efficient and provides similar if not better results for a number of benchmark input variable selection problems quilty et al 2016 pcis is adopted because it is a classic input variable selection method for linear and nonlinear regression problems to the best of our knowledge we are the first to apply a conditional mutual information approach for wavelet based input variable selection using the modwt and at we now discuss the data driven methods that can be used alongside the selected boundary corrected wavelet and scaling coefficients to provide forecasts for a target process 3 2 3 data driven model selection the wavelet based inputs boundary corrected wavelet and scaling coefficients selected in the last stage are used together with the target variable which may also be a set of wavelet and scaling coefficients i e if the multicomponent wavelet based forecasting approach is adopted see section 3 2 1 1 in nonlinear and linear regression frameworks to map inputs to target forecasts we used the extreme learning machine huang et al 2006 stulp and sigaud 2015 and the second order volterra sov model labat et al 1999 maheswaran and khosa 2012a as the nonlinear regression methods and multiple linear regression mlr as the linear model we adopted these three methods as they are easy to program they can be formulated as linear least squares problems are computationally efficient and have performed very well in our experience for hydrological and water resources forecasting applications using wavelet and non wavelet based approaches we do not provide theoretical details for these models as they can be found in a number of our earlier works deo et al 2017a quilty et al 2016 rathinasamy et al 2014 2013 yaseen et al 2016 as with the input variable selection methods other regression models may easily be substituted for elm sov and mlr popular methods such as kriging fuzzy logic support vector regression model trees multivariate adaptive regression splines k nearest neighbours partial information genetic programming etc altunkaynak et al 2003 deo et al 2017b garg et al 2014 goyal et al 2014 kisi 2016 lee et al 2017 rahimikhoob 2016 sharma et al 2016 may be used within wddff ea is paired with the nonlinear regression models elm and sov and pcis is paired with the mlr model we now summarize the key facets of wddff before describing the case study used for demonstrating the usefulness of wddff for real world forecasting studies 3 3 summary of the wavelet data driven forecasting framework our proposed wddff takes into account best practices for wavelet based forecasting by overcoming boundary condition related issues during wavelet decomposition that if not addressed would render a wavelet based forecast invalid for real world application such as in many existing wavelet based forecasting frameworks in the literature 1 avoiding the use of future data 2 selection of suitable decomposition levels and appropriate wavelet filters and 3 proper dataset partitioning additionally wddff incorporates different approaches for using wavelet decomposed data i e boundary corrected wavelet and scaling coefficients in wavelet based forecasting models i e via direct and multicomponent approaches see section 3 2 1 1 allowing one to identify the best wavelet based forecast for a given input output dataset which is often overlooked but important to consider wddff can be summarized as follows 1 wddff uses the modwt and at algorithms which do not consider future data in calculating wavelet and scaling coefficients at a particular time 2 decomposition levels and wavelet filters are selected such that they provide enough data for calibrating the wavelet based forecasting model without including any boundary coefficients i e after wavelet decomposition of the input output dataset we remove any boundary coefficients prior to calibrating our forecasts we only use boundary corrected wavelet and scaling coefficients in our forecasts and such that they provide suitable forecasting performance on a validation set based on forecasting accuracy and computational efficiency suited to the user s preference and 3 direct and multicomponent wavelet based forecasting approaches can be adopted methods 1 6 listed in section 3 2 1 1 allowing one to identify a forecasting approach that provides the best accuracy for a given dataset a input variable selection is used to select which boundary corrected wavelet and scaling coefficients should be used in the wavelet based forecasting model and b data driven methods are used to convert the selected boundary corrected wavelet and scaling coefficients from the last step into target variable forecasts 4 experimental setup here we first introduce the study area used in our experiments before discussing how the general methodology for the wddff is specifically adapted to our study area afterwards we discuss the details of the different experiments that were designed to demonstrate the usefulness of wddff for real world wavelet based hydrological and water resources forecasting problems to keep this work succinct we refer readers to our supplementary material for specific experiment details briefly our proposed wddff is tested on an urban water demand uwd forecasting case study in montreal quebec where we forecasted average daily uwd u for lead times 1 3 5 7 and 14 days common to water utility functions e g optimization of planning design management and operations recent uwd forecast studies have focussed on forecasting montreal s uwd adamowski et al 2012 tiwari and adamowski 2013 adamowski et al 2012 forecasted daily summer demands i e may to august at one day lead times using mlr multiple nonlinear regression autoregressive integrated moving average arima ann and wavelet ann wt ann based on the at however the boundary condition at the beginning of the time series was not taken into account in the wa ann model the authors found that the wa ann provided the best one day ahead forecast in the summer demand period between the years 2001 2009 tiwari and adamowski 2013 compared arima arima with exogenous variables arimax ann bootstrap ann bann wt ann and wavelet bann wt bann for forecasting average uwd at daily 1 3 5 7 and 14 and monthly 1 and 2 lead times between february 27 1999 and august 6 2010 the authors used the dwt mra to develop their wavelet based models and found that the wt bann models provided the best overall forecasts in both studies historical average daily uwd total daily rainfall and maximum daily air temperature were used as explanatory variables we incorporated the explanatory variables of historical average daily uwd u total daily rainfall r maximum daily air temperature t and the daily antecedent precipitation index a to forecast the target variable average daily uwd at lead times of 1 3 5 7 and 14 days ahead we collected average daily uwd u from the city of montreal and daily meteorological variables r and t from environment canada the antecedent precipitation index a was calculated from daily rainfall see the supplementary material within the period february 27 1999 to august 6 2010 4179 daily records 4 1 methodology for wavelet data driven forecasting framework the general workflow fig 2 that was followed for developing the wddff forecasts for our uwd forecasting case study in montreal canada is summarized below specific details may be found in section c of our supplementary material 4 1 1 pre processing data the target variable u was set to lead times of 1 3 5 7 and 14 days ahead each explanatory variable u r t and a was time lagged up to 14 days in the past to allow historical information to be exploited through input variable selection see section c of our supplementary material calibration and validation sets were partitioned as follows february 27 1999 to december 31 2007 for calibration 3230 records and january 1 2008 to august 6 2010 for validation 949 records we found this data partitioning to provide good performance as it afforded us with enough records for calibration and a reasonable amount of data over two and a half years to validate the performance of the wddff out of sample wavelet decomposition using the modwt and at algorithms was used to calculate boundary corrected wavelet and scaling coefficients and was carried out using each of the six wavelet based forecasting methods described in section 3 2 1 1 i e single method 1 within method 2 across method 3 single hybrid method 4 within hybrid method 5 and across hybrid method 6 the maximum decomposition level was set to six j max 6 and we considered wavelet filters up to length 14 l 14 see section c of our supplementary material for further details on how j max was determined and why these wavelet filters were selected the different wavelet families and their filters that were used in our study are as follows their coefficients can be found in the supplementary material haar haar daubechies d1 same as haar d2 d3 d4 d5 d6 d7 symlets sym4 sym6 coiflets coif1 coif2 fejer korovkin fk4 fk6 fk8 fk14 least asymmetric la8 la12 la14 and best localized bl14 crowley 2007 nielsen 2001 olhede and walden 2004 percival and walden 2000 rathinasamy et al 2013 zhang et al 2016 since the largest widest wavelet filter had 14 filter coefficients d7 sym7 fk14 la14 and bl14 and we used a maximum decomposition level of six there were l j 2 j 1 l 1 1 820 boundary affected coefficients therefore we removed the first 820 records from the beginning of our input output datasets creating the boundary corrected wavelet and scaling coefficients prior to selecting input variables and before model calibration to eliminate the effect of the boundary condition on our forecasts see section 2 3 3 since explanatory variables were time lagged up to 14 days forecast leads times of 1 3 5 7 and 14 day were explored and we removed the first 820 boundary coefficients from each dataset the original calibration set of 3230 records was reduced to a total of 2395 2393 2391 2389 and 2382 calibration records for the 1 3 5 7 and 14 day ahead forecasts respectively therefore 949 validation records were used for evaluating each lead time forecast out of sample i e each lead time forecast had the exact same validation set for the target variable 4 1 2 input variable selection for wavelet and scaling coefficients the edgeworth approximation based conditional mutual information and partial correlation input section input variable selection methods quilty et al 2016 were used for selecting wavelet and scaling coefficients as inputs for the different data driven models within wddff see section c of our supplementary material for further details 4 1 3 data driven models the extreme learning machine second order volterra and multiple linear regression were selected as the data driven models that were fed wavelet and scaling coefficient inputs according to the ea and pcis input variable selection methods the data driven models using wavelet decomposed inputs are appended with a w i e welm is a wavelet based extreme learning machine while wmlr is a wavelet based multiple linear regression model the ea method was used to select inputs for the nonlinear models elm and sov while pcis was used to select inputs for the mlr non wavelet based models were used as a benchmark for the wavelet based models developed using wddff a random walk rw without wavelet based inputs was also considered as a benchmark model therefore the following models were considered input variable selection method model ea welm ea wsov pcis wmlr ea elm ea sov pcis mlr and rw 4 1 4 forecast calibration and evaluation the elm sov and mlr based models were calibrated using linear least squares forecasts were evaluated over the validation set an estimate of out of sample or generalization performance using metrics commonly adopted in hydrological and water resources forecasting studies nash sutcliffe efficiency index the root mean square error rmse and mean absolute percentage error mape adamowski et al 2012 moriasi et al 2007 quilty et al 2016 see section b of our supplementary material for further details 4 2 experimental details in order to demonstrate the usefulness of wddff for wavelet based hydrological and water resources forecasting we focussed on three main experiments using the daily uwd dataset from montreal to highlight how the best practices adopted by wddff can be used for identifying the best performing wavelet based forecast among a variety of alternatives based on different decomposition levels wavelet filters and forecasting strategies direct and multicomponent i e optimal decomposition levels wavelet filters and forecasting approaches and to show its added value in comparison to a recent and invalid in terms of real world applications wavelet based forecasting framework that adopts the modwt mra bachour et al 2016 barzegar et al 2018 2017 maslova et al 2016 prasad et al 2017 yang et al 2014 the three different experiments are as follows 1 best performing models for the different wavelet based forecasts contained within the wddff see section 3 3 1 1 and 4 1 we identified which wavelet decomposition algorithm modwt or at wavelet based forecasting approach direct or multicomponent and method 1 6 single within across single hybrid within hybrid or across hybrid performed best 2 best decomposition levels and wavelet filters of the best wddff based forecasts we showed that certain decomposition levels and wavelet filters were most useful in providing the best forecast accuracy some visible trends stood out 3 wddff vs modwt mra our proposed wddff in comparison to a current and invalid wavelet based hydrological and water resources forecasting approach modwt mra barzegar et al 2018 2017 he et al 2015 prasad et al 2017 yang et al 2014 that we have demonstrated throughout this work to include future data and that should be optimistically biased in terms of forecast accuracy a sign of its incorrectness provided more realistic forecast performance than modwt mra wddff s usefulness and realistic performance for real world forecasting problems was clearly shown these experiments were chosen to demonstrate that 1 wddff can result in widely different performance for different settings e g direct or multicomponent approaches but for our case study wddff always provided the best performance against benchmark models e g mlr elm sov and rw 2 wddff had the tendency to provide the best performance for a given decomposition level and wavelet filter combination and 3 wddff should be preferred over the modwt mra based including the dwt mra based forecasts currently adopted within many wavelet based hydrological and water resources forecasting studies as it provided realistic performance while modwt mra provided incorrect invalid performance for the dataset that we studied 5 results and discussion the results of our uwd forecasting experiment for the different daily lead times 1 3 5 7 and 14 can be found in table 3 1 day lead time while the remaining results 3 5 7 and 14 day lead times are given in section d of our supplementary material we included only the best forecasts for each model type due to the large amount of models 14 420 in total see section c of our supplementary material and reported their results for the validation partition although the calibration performance is similar to the validation performance affirming the stable generalization properties of the different forecasts the best model for a particular lead time forecast is in bold face within our tabulated results scatter plots for the best wavelet and non wavelet based models are shown in fig 3 5 1 best performing models the modwt single hybrid class of wddff wavelet based forecasts particularly the wmlr model provided the best performance across the explored lead times thus for this dataset it is the best of the eight different wavelet decomposition forecasting strategies see section 3 2 1 1 and 4 2 when comparing the best wavelet based forecasts against the non wavelet based forecasts table 3 fig 3 and tables in section d of our supplementary material we may notice that as the lead time increases the difference in performance generally becomes more pronounced with the biggest gains in performance being realized for the 14 day lead time this is a very promising quality of the wddff against the non wavelet based methods for the montreal uwd dataset as longer lead time forecasts can be used to constantly monitor sustainability planning and construction initiatives with reasonable foresight such as projecting expected water use during droughts or the amount of supply required to a site or pressure zone that would be beneficial in setting water use restrictions or allocating temporary services for water main maintenance or construction since the modwt single hybrid class of models provided the best forecasts for each lead time it suggests for this dataset that including both wavelet decomposed inputs and non wavelet decomposed inputs can increase forecast performance considerably in comparison to alternate cases where only wavelet decomposed or non wavelet decomposed inputs are solely used this has also been the case in earlier wavelet based forecasting studies adamowski 2008b nguyen and nabney 2010 voronin and partanen 2013 however the use of the un decomposed inputs alongside wavelet decomposed inputs is very rarely explored within hydrology and water resources furthermore the superiority of the wmlr models shows that the linear wavelet based models perform better than the nonlinear wavelet based models for all lead times while the nonlinear models tend to perform best when wavelet decomposed data are not used as inputs the reason behind this can be argued similarly to the discussion in koutsoyiannis et al 2010 where the authors provided evidence that while most hydrological and water resources processes are naturally nonlinear when they are observed from the standpoint of their changes across different time scales there tends to be a linear relationship between the original time series and the time series when viewed at its different scales of change one can also notice that in certain cases the non wavelet based forecasts outperformed some of the wddff forecasts for instance at the 1 day lead time the nonlinear non wavelet based forecasts outperform the nonlinear wddff models that use the at single modwt single and at within wavelet decomposition forecasting strategies for 3 5 7 and 14 day lead times the nonlinear non wavelet based forecasts outperform the nonlinear wddff models that use the modwt single wavelet decomposition forecasting strategy other similar cases can be inferred from table 3 and section d of the supplementary material these results highlight the importance of exploring a wide variety of different combinations of wavelet decomposition strategies modwt and at decomposition levels and wavelet filters and approaches for incorporating wavelet decomposed data in forecast development e g direct and multicomponent if this is not done it is possible to make generalized statements such as wavelet decomposed inputs are not necessarily as useful as the original un decomposed time series for forecasting purposes zhang et al 2015 5 2 best performing decomposition levels and wavelet filters it can also be noted that a decomposition level of six and wavelet filters of length 14 provided the best performance for each lead time forecast see table 3 and section d of the supplementary material fig 4 shows the u time series decomposed by the modwt and at algorithms using the la14 filter the wavelet filter used in the best performing wddff forecasts at lead times 1 3 5 and 7 we can see that using a decomposition level of six with the la14 filter results in smooth scaling coefficients that track inter annual annual and intra annual changes that are free of unnatural artefacts such as blocks sharks fins triangles etc percival and walden 2000 sec 5 11 it can also be seen that the at algorithm exhibits much larger variation across the wavelet coefficients than the modwt the at solely uses low pass filtering producing an additive decomposition while the modwt uses high pass filtering to compute the wavelet coefficients resulting in an energy based decomposition aussem et al 1998 percival 2008 percival and walden 2000 the scaling coefficients in fig 4 re affirms our earlier statement that the scaling coefficients produced by the modwt and at are the same for a 1 day lead time fig 5 shows the performance of the best wddff and non wavelet based models for the last 366 time series records in the validation set a pronounced weekly cycle is evident in the uwd time series the weekly cycle is well captured by the la14 and bl14 wavelet filters within the proposed wddff due to their larger support width that is a multiple of a weekly periodicity for daily time series when compared to shorter wavelet filters such as the haar which lend themselves well to capturing larger periods as opposed to smaller wavelet filters that are more suited to picking out transient events in fig 5 b one can notice the lower variation in the wmlr wddff residuals when compared to the non wavelet based sov forecast giving further evidence to support the use of wddff over the benchmark models one may argue that certain wavelet based forecasting approaches e g method 1 6 see section 3 2 1 1 produce similar results and that they do not help to clearly identify a best model or a significant difference in performance between competitors for example let us consider the 1 day lead time 3 5 7 and 14 day lead times have a wider gap between the best performing model and its competitors in terms of rmse mape and nash scores one can see that at this lead time many similar forecast results are achieved in terms of the nash score e g compare the at single modwt single at across at single hybrid modwt single hybrid and at across hybrid wmlr models in table 3 however one important point to note is that the optimal decomposition level and wavelet filter selected for each of these different wavelet based forecasting approaches that score similarly e g in terms of nash tend to be different e g wmlr at single hybrid uses a decomposition level of three and the coif1 wavelet filter while the modwt single hybrid uses a decomposition level of six and the la14 wavelet filter and both models performance differ by a small margin i e 0 002 in terms of nash this can be looked at positively by noting that methods that produced similar results but used different decomposition levels and wavelet filters could be assessed in terms of a trade off between computational efficiency and model accuracy we argue that without performing such a comprehensive exploration of these different wavelet based forecasting approaches method 1 6 see section 3 2 1 1 which has not yet been explored in such depth within the hydrology and water resources fields one could not identify such cases therefore our proposed wddff can be used as an exploratory analysis tool to identify optimal wavelet based forecasting strategies i e decomposition levels wavelet filters and forecasting approaches method 1 6 trading off between computational efficiency and model accuracy using wddff as an exploratory analysis tool can be useful before selecting a single or group of model s for issuing forecasts using newly received data such as for operational or planning tasks e g opening of dam gates identifying suitable crops to alleviate food shortages due to an impending drought etc we now compare wddff against a modwt mra based forecasting approach to show how the wddff forecasts are realistic and accurate while the modwt mra forecasts are unrealistic and cannot be used properly for real world forecasting 5 3 comparing wavelet data driven forecasting framework against a forecasting model using the modwt mra in fig 6 we have shown how misinterpretation of the modwt by applying the modwt mra for forecasting as in kriechbaumer et al 2014 xiao et al 2014 yang et al 2014 zhu et al 2014 bachour et al 2016 barzegar et al 2018 2017 and prasad et al 2017 can lead to invalid forecast performance fig 6 a shows the results of the best 1 day lead time forecast s residual on the validation set for the wddff which used the modwt single hybrid approach and compares it against a modwt mra single hybrid approach fig 6 b while we do not recommend this forecasting strategy we simply adjusted the former by adopting the modwt mra to decompose the target and explanatory variables instead of the modwt the same wavelet filter la14 decomposition level six and model type wmlr were used by both modwt and modwt mra based forecasts since the modwt does not incorporate future information the entire dataset can be decomposed at once without invoking error due to the bc in the wavelet and scaling coefficients however the modwt mra requires future data when calculating detail and approximation coefficients at any given time since decomposing the calibration and validation set separately when using the modwt mra causes wrap around effects see section 2 3 1 1 we first decomposed the calibration data to obtain the calibration detail and approximation coefficients and then we decomposed the calibration and validation data together and extracted the detail and approximation coefficients associated with the validation indices to obtain the modwt mra based validation detail and approximation coefficients in order to minimize the wrap around effects see section c of our supplementary material or refer to eqs 2 3 5 and 6 in table 1 despite the fact that other studies commonly decompose both calibration and validation data separately e g barzegar et al 2018 and prasad et al 2017 which only exacerbates the bc related uncertainty see section 2 3 3 our adjustment improved modwt mra performance a similar approach to our adjustment of the usual and incorrect manner in which the modwt mra has been used in forecasting studies was also adopted in the dwt mra based forecasting experiments in du et al 2017 where they demonstrated the incorrect forecasts produced by the dwt mra for a real world monthly rainfall forecasting problem which qualitatively resembles the results of the modwt mra based forecasts in this study the modwt mra based forecast achieved a nash score of 0 940 which nears 1 0 when the poor quality forecasts at the end of the record are removed significantly better than the modwt 0 916 we may notice that the modwt mra has negligible forecast error until it reaches the most recent time series observations where it utterly fails to provide a representative forecast since it requires data from the future which is replaced by surrogates see section 2 3 3 to accurately compute its detail and approximation components which are obviously unavailable to us while the modwt which does not require future data to calculate the wavelet and scaling coefficients at the same time positions has stable performance with errors ranging approximately between 100 megalitres per day here we can clearly see the risks in applying the modwt mra in forecasting studies it truly cannot be used correctly for real time forecasting 6 summary and conclusions many wavelet based water resources forecasting models summarized in recent reviews afan et al 2016 dixit et al 2016 fahimi et al 2017 nourani et al 2014 sang 2013 yaseen et al 2015 cannot be used for real world forecasting problems since they are incorrectly developed due to misunderstanding certain problems related to wavelet decomposition and the boundary condition 1 the future data issue 2 inappropriately selecting decomposition levels and wavelet filters and 3 not carefully partitioning calibration and validation data by not addressing these boundary conditions during wavelet decomposition the incorrectly developed wavelet based forecasting models often result in much better performance than what is achievable in reality du et al 2017 for an example see section 5 3 to address these important and prevalent errors we developed a set of best practices that were holistically combined into a new wavelet based forecasting framework the wavelet data driven forecasting framework wddff that can be used to overcome these errors and that can be used for real world hydrological and water resources forecasting problems see section 2 and 3 using a real world daily urban water demand forecasting experiment in montreal canada we showed that wddff outperformed benchmark methods such as non wavelet based multiple linear regression extreme learning machines and a second order volterra model and provided more realistic and correct performance when compared against a recent wavelet based forecasting strategy that adopted the maximal overlap discrete wavelet transform based multiresolution analysis modwt mra bachour et al 2016 barzegar et al 2017 he et al 2015 prasad et al 2017 seo et al 2017 yang et al 2014 and that showed unrealistic and incorrect performance during validation in addition to providing an approach that overcomes the errors mentioned above thus allowing it to be used for real world forecasting applications a useful property of our proposed wddff is that it uses two different wavelet decomposition algorithms maximal overlap discrete wavelet transform modwt and à trous algorithm at two different wavelet based forecasting approaches direct and multicomponent and has several methods single within across single hybrid within hybrid or across hybrid see section 3 2 1 1 for adopting wavelet decomposed data in the forecast design typically in hydrological and water resources forecasting studies only a single wavelet decomposition algorithm e g modwt mra forecasting approach e g direct and method e g single is used for our experiments the combination of different wavelet decomposition algorithms wavelet based forecasting approaches and methods were demonstrated to provide significantly different performances when compared against one another highlighting the usefulness and supporting the practice of exploring different strategies for incorporating wavelet decomposed data in wavelet based hydrological and water resources forecasting models by addressing common pitfalls and errors of wavelet based forecasts for real world hydrological and water resources problems and providing a number of different strategies for using wavelet decomposed data in the forecast design wddff can be considered a promising new method for hydrological and water resources forecasting and we expect its use to grow within hydrology and water resources and potentially other domains before discussing future research endeavours we summarize below our main original contributions 1 since the wavelet based forecasting literature in general and specifically hydrology and water resources does not contain any studies concerning best and correct practices for real world wavelet based forecasting models this paper represents the first to comprehensively a compare correct modwt and at and incorrect dwt mra and modwt mra wavelet decomposition methods for real world forecasting see section 1 and 2 2 b study the different boundary conditions that need to be properly addressed in order to correctly use a wavelet based forecasting model in real world problems i e use of future data improper selection of decomposition levels and wavelet filters and improperly partitioning calibration and validation data see sections 1 2 3 2 4 and 2 5 c propose in addition to a set of best practices that addresses each boundary condition a general wavelet based data driven forecasting framework i e wddff that can adopt any data driven model and input variable selection routine two wavelet decomposition algorithms modwt and at two wavelet based forecasting approaches direct and multicomponent and several methods single within across single hybrid within hybrid or across hybrid for decomposing and including both target and explanatory data in the forecast design see sections 2 2 3 2 1 1 and 3 3 and d evaluate the forecasting performance of wddff on a real world water resources forecasting problem using different combinations of the wavelet decomposition algorithms wavelet based forecasting approaches and methods see section 5 2 this study is the first to discuss and compare the differences between the modwt and at wavelet and scaling coefficients in terms of theory see section 2 1 and forecasting performance see section 5 2 this is also the first study to use the modwt wavelet and scaling coefficients directly i e instead of the modwt mra detail and approximation coefficients for hydrological or water resources forecasting see section 2 2 3 this is the first study to apply a conditional mutual information based input variable selection approach for identifying which modwt and at based wavelet and scaling coefficients to use in a data driven forecasting model see section 3 2 2 future research will focus on converting wddff from a deterministic forecast into a stochastic forecast such a model has already been developed by the authors and will be published under the name stochastic wavelet data driven forecasting framework swddff allowing for the forecasts from this method to be used to forecast systems subject to uncertainty and which may be useful for complementary objectives such as risk assessment chen et al 2013 yung et al 2011 one may expand wddff and swddff by adopting singular spectrum analysis ssa to afford yet another method for taking into consideration the periodic and transient nature of hydrological and water resources processes an interesting study would be to swap wavelets for ssa within our proposed wddff and compare performances between both methods finally since wddff was only studied for a single water resources process since this work served as an introduction to the new method further research is required to explore its usefulness for forecasting other hydrological and water resources processes e g streamflow rainfall evaporation etc acknowledgements the authors are grateful to the associate editor and anonymous reviewers for their constructive comments that have significantly improved the quality of this work we thank the city of montreal for providing the urban water demand data used in this study requests for urban water demand and meteorological data used in this study should be made through the city of montreal or obtained from environment canada at climate weather gc ca respectively our appreciation is extended to maheswaran rathinasamy for his helpful discussions regarding the à trous algorithm and its relation to the boundary condition problem funding for this research was provided by nserc discovery and accelerator grants held by jan adamowski appendix a supplementary data supplementary data associated with this article can be found in the online version at https doi org 10 1016 j jhydrol 2018 05 003 appendix a supplementary data supplementary data 1 
7143,studies of moisture dynamics associated with major tropical rain activities with the aid of stable oxygen and hydrogen isotopic δ18o and δd measurements in precipitation and water vapour are of current research interest here we present such measurements of rain and water vapour samples collected at two tropical coastal hill stations of southern peninsular india during april october 2012 an apparent seasonal cycle is observed both in rain and vapour isotopes despite of the isotopic equilibrium observed between rain and vapour during the whole sampling period it often deviates in sub seasonal time scales rain vapour isotopic separation factors are lower compared to the equilibrium separation values during stratiform rain events of indian summer monsoon while the separation factors are close to the equilibrium values during convective events this is possibly due to the decreased vertical mixing of moisture during stratiform rain events keywords rain water vapour stable isotopes monsoon stratiform rain 1 introduction stable isotopologues of water are potential tracers to quantify the components of hydrological cycle such as evaporation gat 1996 sutanto et al 2012 transpiration jasechko et al 2013 rothfuss et al 2010 sheshshayee et al 2005 ground water recharge boronina et al 2005 thorburn et al 1993 river runoff etc and to reconstruct past climate from stable isotope based proxies e g managave et al 2011 ramesh et al 2010 xu et al 2015 yadava and ramesh 2005 the isotopic measurements of most components of hydrological cycle e g ocean water river water rain etc are rather straight forward and thus plenty till date but water vapour isotopic measurements are comparatively less compared to other measurements nevertheless increased measurements of isotopic composition of water vapour using laser based isotopic measurements during the last decade galewsky et al 2016 made significant advancement of knowledge on the hydrological cycle for example understanding of the microphysical rain vapour interactions raindrop re evaporation rain vapour isotopic equilibration mixing etc in convective cloud systems leading to the amount effect a negative linear relation between tropical rain amount and its 18o has been improved with vapour isotopic observations which in turn help in accurate paleoclimate reconstruction the 18o variations in climate proxies such as tree rings bose et al 2016 managave et al 2010 xu et al 2015 and speleothems are interpreted using amount effect araguás araguás and froehlich 1998 dansgaard 1964 the preferential condensation of heavy isotopes and the preferential evaporation of lighter isotopes during precipitation were believed to be the key processes responsible for amount effect low rain amount low fraction of rain from the vapour mass will be isotopically enriched while it leaves isotopically depleted vapour behind so increased rainfall incorporates more depleted vapour on further condensation leading to lower δ18o of higher rain amounts comparative dry condition during light rain causes subsequent enrichment of the raindrops due to raindrop re evaporation while less raindrop re evaporation occur during heavy rain events due to higher ambient relative humidities dansgaard 1964 accentuating the amount effect however the robustness of this relation has become questioned by the addition of more recent observations kumar et al 2010 kurita 2013 lekshmy et al 2015 midhun and ramesh 2016 rainfall δ18o variations are recently reported to be independent of the corresponding rainfall amount in many tropical stations and rather the importance of moisture sources type of rain activity and moisture recycling are highlighted berkelhammer et al 2012 kurita et al 2011 kurita and yamada 2008 lee and fung 2008 lekshmy et al 2014 moore et al 2014 risi et al 2008 the roles of different processes responsible for the amount effect were quantified by risi et al 2008 introducing 18o and d in the emmanuel convective parameterization in a single column model and underscored the importance of moisture recycling in convective clouds the isotopically depleted vapour produced after the condensation of clouds and from rain drop re evaporation reaches the sub cloud layer through downdraft which again feeds the cloud updraft influencing the isotopic composition of further rainfall intense convection amplifies the effect of such moisture recycling and leads to the amount effect risi et al 2008 a contemporary stream of research thus focuses on the validation of the theory proposed by risi et al 2008 and to improve the understanding of moisture recycling processes and rain vapour interactions in various types of clouds across the tropics isotopic composition of rain and vapour show distinct features in different types of clouds such as convective stratiform and frontal due to different microphysical processes aggarwal et al 2016 guan et al 2013 large scale convective systems are often observed in the tropics in association with low pressure systems tropical cyclones depressions etc madden julian oscillations mjo mesoscale convective systems mcs different monsoons etc such type of large scale systems consist of both convective clouds with high vertical extends as well as stratiform clouds thin clouds within it a significant proportion of the total rain in prominent tropical weather systems is derived from stratiform clouds chattopadhyay et al 2009 houze 1997 2004 pokhrel and sikka 2013 schumacher et al 2003 rain drop re evaporation and isotopic equilibration of raindrops with ambient vapour are found to be more effective in stratiform rain due to the smaller rain drop size which effectively increases the interactive surface area and remains in the atmosphere more time due to smaller terminal velocity compared to convective rain the instantaneous stratiform rain may get enriched in heavier isotopes due to the probability of more evaporation but can effectively produce vapour strongly depleted in 18o and d and play a crucial role in the moisture recycling occurring in organized convective regimes aggarwal et al 2016 berkelhammer et al 2012 kurita 2013 while in the convective clouds the clouds drop size is more compared to the stratiform cloud drops leading to comparatively less interactive surface area and large terminal velocity thus rain drop re evaporation and isotopic equilibration of raindrops with ambient vapour will be less effective in convective rain compared to the stratiform rain yet the limited simultaneous isotopic observations of vapour and rain constrain the quantification of role of stratiform clouds in rain water vapour interactions and moisture recycling in large scale convective clouds because of the tedious sampling procedure for water vapour compared to rain measurements of its stable oxygen and hydrogen isotopic compositions δ18ov and δdv respectively commonly δv are limited until recently i e before the advent of laser based portable isotope analyzers as even the simplest isotopic models necessarily require δv as an input craig and gordon 1965 previous studies mostly assumed that the water vapour was in isotopic equilibrium with monthly mean rain and calculated it theoretically e g managave et al 2010 while this assumption may be valid for average values over longer time scales months or years it could fail on shorter time scales days or weeks deshpande et al 2010 srivastava et al 2015 the reasons for which is not yet clear the present study is an attempt mainly to understand the rain vapour interaction and the role of stratiform clouds rain on the isotopic variability of indian summer monsoon ism rainfall for this simultaneous observation of isotopic composition of water vapour and rain was done from two tropical stations from kerala south western peninsular india collected during april october 2012 which is strongly influenced by ism the amount of local rainfall plays an insignificant role on the isotopic variability of rain here lekshmy et al 2015 2014 warrier et al 2012 yadava et al 2007 while the upstream convective activity over the eastern arabian sea shows a strong correlation with the rainfall δ18o at kerala lekshmy et al 2014 stratiform rainfall signifies around half of the total rainfall during ism and plays a major role in modulating the dynamical response of the ism atmosphere in organized convective events associated with the ism intra seasonal variability chattopadhyay et al 2009 besides the study area experiences rainfall during different seasons viz pre monsoon april may ism june september and north east monsoon nem october december throughout the year where the major moisture sources moisture transport pathways cloud activities leading to rain differ thus the major objectives of the present study are 1 to study the rain vapour isotopic interactions on seasonal to sub seasonal time scales with more emphasis on the ism season and 2 to identify the role of stratiform clouds on the isotopic variability and interactions of rainfall and surface water vapour 2 sampling sites materials and methods 2 1 rain and water vapour collection to understand the seasonal variation isotopic composition of rainfall and the isotopic interaction between them daily rain whenever it rained and water vapour samples were collected from march 30th to october 28th 2012 at ponmudi pnd 8 76 n 77 12 e 780 m above m s l and wayanad wyd 11 51 n 76 02 e 800 m above m s l fig 1 these stations are characterized by seasonally reversing winds and thus rain derives from two distinct sources of moisture during the year both the stations are located on the western side 50 away from the coast of the western ghats and obtain the majority of the annual rain during the ism the isotopic signature of water vapour here is less altered by continental evapo transpirated moisture due to the characteristic wind pattern south westerly wind with high wind speed during ism and thus these stations are ideal places to study the isotopic characteristics of ism vapour and rain north east monsoon nem october december also called winter monsoon or post monsoon also contribute to significant amounts of annual rainfall 30 at ponmudi and 14 at wayanad rain samples were collected each day at 9 00 am indian standard time taking care of the sample quality for details see lekshmy et al 2014 ponmudi received less rain a total of 1357 mm than wayanad 3903 mm these can be compared with the climatological mean values of the respective nearest meteorological stations 1412 mm at trivandrum and 2889 mm at kozhikode respectively http www imd gov in water vapour samples were also collected from the same stations and period using the cryo trap method see for details midhun et al 2013 atmospheric air is pumped for 3 h through a glass trap maintained under 80 c using a mixture of ethanol and liquid nitrogen at a flow rate below 500 ml minute vapour samples were collected from 9 00 am to12 00 pm almost every day during this period a total of 301 n 174 at pnd and n 127 at wyd water vapour samples and 201 n 78 at pnd and n 123 at wyd rain samples were collected during this period 2 2 isotopic analysis isotopic analyses of the samples δ18o and δd were done using a thermo delta v plus isotope ratio mass spectrometer at the physical research laboratory ahmedabad india gas equilibration method h2o co2 and h2o h2 was adopted for the isotopic analysis epstein and mayeda 1953 the precisions of isotopic analysis was below 0 1 for δ18o and 1 for δd leading to an uncertainty of 1 3 on the calculated deuterium excess d δd 8 δ18o 2 3 components of rainfall and back trajectory analysis to understand the role of stratiform clouds on isotopic variability and interaction of rain and vapour convective and stratiform rain components of the daily rainfall were obtained from tropical rainfall measurement mission trmm 3g68 using the trmm microwave imager tmi sensor haddad et al 1997 the climatology 1981 2011 ce of ism rainfall is obtained from global precipitation climatology project gpcp data adler et al 2003 120 hour air mass back trajectory to the surface level analysis was done using the noaa hybrid single particle lagrangian integrated trajectory hysplit model draxler and rolph 2013 to the location 11 55 n 76 22 e 800m above m s l the model uses gdas global data assimilation system data kanamitsu 1989 as input and generates three dimensional back trajectories of air parcels and meteorological variables such as rainfall pressure potential temperature temperature and relative humidities along the trajectories 3 results and discussions 3 1 isotopic characteristics of vapour and rain as stable isotope data for monsoon vapour from south western coast of india where the ism hits first in the country are being reported here for the first time we summarize the main features of both vapour and rain fig 2 shows the time series of δ18ov δdv water vapour δ18or δdr rain at ponmudi and wayanad and the associated parameters the δ18ov values between ponmudi and wayanad show a significant correlation with a correlation coefficient r of 0 54 likewise δ18or values at both stations are also significantly correlated r 0 62 the ranges of δ18ov δdv variability of water vapour at ponmudi and wayanad are from 8 6 to 24 3 51 0 to 170 0 and from 7 9 to 20 5 50 0 to 139 1 respectively while the δ18or δdr values of rain vary from 0 7 to 16 1 10 9 to 115 7 and 1 7 to 11 0 22 4 to 71 6 the d excess values of water vapour at ponmudi and wayanad varied from 6 3 to 26 5 and 13 3 to 31 2 and that of rain varied from 9 0 to 23 1 and 8 9 to 27 3 respectively high values of vapour rain d excess can be due to many factors such as i kinetic fractionation at the evaporation source uemura et al 2008 ii rain drop re evaporation iii mixing with vapour with high d excess etc these values are consistent with the rainfall isotopic observations from this region reported earlier by resmi et al 2016 shahul hameed et al 2016 warrier et al 2016 2010 etc and long term gnip observations from kozhikode the correlation between the measured rainfall and δ18or show significant negative relation at these stations but explains only 6 and 18 r2 of the daily rainfall variability at ponmudi and wayanad respectively although ponmudi received less annual rainfall the δ18or values here are slightly lower than the corresponding values at wayanad as it receives a higher proportion of the nem rainfall which is usually more depleted in 18o and d 3 2 seasonality of rainfall and vapour isotopes seasonal cycles in the rainfall and vapour isotopes are observed in the data with the most 18o or d enriched events during the pre monsoon depleted events during ism and followed by the most depleted events during nem fig 3 this is supported by the monthly observations at many stations of global network for isotopes in precipitation gnip across india lekshmy et al 2015 shahul hameed et al 2016 including the long term observations at kozhikode warrier et al 2010 and the event based observations at meghalaya breitenbach et al 2010 this seasonality has been attributed to i the changes in the moisture source during each season associated with the prevailing winds ii the moisture transport pathways and the changes in the condensation history iii the changes moisture source characteristics such as ocean surface condition and isotopic composition ocean e g bay of bengal breitenbach et al 2010 and iv the type of cloud activities responsible for the rain isolated of large scale organized convection lekshmy et al 2015 this is further discussed in detail in the next section 3 2 1 pre monsoon very few rain events were recorded during the pre monsoon which is mainly comprised of occasional isolated thunderstorms and a low pressure cyclonic storms one occurred during the last week of april water vapour and rain during pre monsoon are enriched in 18o and d compared to the later seasons but some individual events associated with cyclonic storms during pre monsoon show comparatively stronger 18o depletions in rain and vapour lekshmy et al 2015 while the 18o and d of rain and vapour during isolated rain vapour collected during non rainy days also events marked enriched values probably due to lesser moisture recycling with in the clouds lekshmy et al 2014 5 day air parcel back trajectories during pre monsoon season fig 4 show that air parcels which reach kerala during pre monsoon mostly come from the arabian sea with relative humidities 70 with some originate from west asia with low relative humidities 40 also the δ18o δd relation local meteoric water line lmwl for vapour during pre monsoon shows significantly lower values of slope and intercept compared to those for the later two seasons fig 4 the slope of lmwl of pre monsoon rainfall at wayanad is close to that of the global meteoric water line gmwl with a higher value of intercept at wayanad only the number of data points at ponmudi is 10 fig 3 this is possibly because the maximum temperatures 32 c occur during the pre monsoon which lead to evaporation of rain in the atmosphere and a lower slope the intercept is higher because of mixing with continental evapo transpirated vapour 3 2 2 indian summer monsoon ism during 2012 is characterized by both isolated events with comparatively enriched 18o and d and large scale convective events with depleted 18o and d lekshmy et al 2014 back trajectories show south westerly winds from the southern indian ocean reaching kerala during ism the relative humidities along these trajectories show that monsoon winds bring a great amount of moisture rh 70 from the southern arabian sea and the equatorial indian ocean though significant rainfall occurs over the arabian sea itself during the ism season supplementary information sf1 climatological mean jjas precipitation gpcp data the relative humidity of air parcels is high irrespective of the height of the air parcel indicating a constant supply of moisture from the arabian sea that leads to copious rainfall over kerala climatological annual ism rainfall in kerala is 2040 mm the slopes of local meteoric water and vapour lines lmvl are close to 8 but the intercept of lmwl of rain samples of ism is higher than 10 the intercept of lmwl of ism is slightly higher than that of pre monsoon whereas the intercept of lmvl of ism is significantly higher than that of pre monsoon for both stations 3 2 3 north east monsoon nem rain and vapour show the lowest δ18o and δd in the year lekshmy et al 2015 warrier et al 2010 yadava et al 2007 nem occurs after the withdrawal of south westerly winds with the establishment of north easterly winds back trajectory analyses show that air parcels travel from continental areas mainly from the indian subcontinent with low relative humidities until they reach the bay of bengal bob thereafter significant moisture uptake from the bob occurs leading to nem rainfall over tamil nadu before reaching kerala continental recycle moisture surface evaporation and transpiration may also contribute vapour to these air parcels when they cross the western ghats the observed d excess values in the rain and water vapour in this season fig 3 are slightly higher than those in the ism season possibly due to influence of continental recycled moisture gat 1996 yurtsever and gat 1981 during this season too at both the stations the slopes of lmwl are close to 8 the values of intercepts are higher compared fig 4 to the other two seasons except for the lmwl of ponmudi because the component of re cycled vapour is much higher as the air masses travel over larger distances over land supplementary figure sf2 4 rain vapour isotopic interaction δ18o values of vapour in isotopic equilibrium the equilibrium fractionation factors ε with rain is calculated using δ18or and ambient air temperature majoube 1971 and compared with the observed δ18ov fig 5 they show a significant positive linear relationship at both the stations it implies that surface water vapour and rain are close to isotopic equilibrium on longer time scale in order to quantify this we have compared the equilibrium fractionation values calculated ε with the corresponding isotopic separation between δ18or and δ18ov observed ε and given in fig 2e and f the average of calculated ε is 9 5 0 1 while the observed value is 8 3 2 2 for all the observations at ponmudi similarly calculated ε is 9 4 0 2 while the observed value is 9 4 1 4 at wayanad but the daily observations show deviation from the equilibrium fractionation factors fig 2 thus our observations suggest that surface water vapour and rain are close to isotopic equilibrium on longer time scale this could be due to i mismatch in the durations of water vapour collection 3 h per day and rain collection 24 h accumulated and ii mixing of evapo transpirated moisture from the surface deshpande et al 2010 rain vapour isotopic compositions of ism are characterized by little alteration from locally derived moisture as the observed ε is close to the calculated ε 8 4 2 2 n 43 at ponmudi and 9 4 1 4 n 57 at wayanad noticeably more deviation from the isotopic equilibrium level is also observed during the high rain events of ism season fig 2e and f these events are characterized by large scale organized convection over eastern arabian sea near kerala coast large scale organized convections are characterized by enhanced stratiform rainfall leading to the possibility of more moisture recycling inside and sub cloud layers risi et al 2008 kurita 2013 so the effect of stratiform clouds on the rain vapour isotopic interaction and their variability during ism are further studied using convective stratiform components from trmm 3g68 daily rainfall data kummerow et al 2001 lekshmy et al 2014 reported that the δ18o variability of ism rainfall over kerala is very much influenced by the convective activity over eastern arabian sea accordingly we selected a grid box 8 12 n and 70 75 e and evaluated the daily total rainfall with its convective and stratiform components from june 1 to september 30 2012 stratiform rain fraction varies between 10 50 of the daily total rain on an average stratiform rain contribute 30 to the total rain in the selected grid two station datasets are merged into a single time series by taking arithmetic averages as δ18or and δ18ov between the stations correlate significantly stratiform rain fraction increases with increase in daily total rainfall supplementary s fig 3 and significant negative correlation is observed between stratiform rain fraction and average δ18o of rain and vapour fig 6 a and b of both the stations the increased post condensation processes such as rain drop evaporation and equilibrium isotopic exchange processes are more in the stratiform rain which favors the heavier isotopic depletion of subcloud level vapour in an organized convective system which typically last for 2 4 days lekshmy et al 2014 this depleted sub cloud level vapour further feeds the system resulting in heavy depletion in the subsequent rain our observations support the recently proposed aggarwal et al 2016 berkelhammer et al 2012 kurita 2013 moore et al 2014 mechanisms of stratiform rainfall in large scale convective systems giving rise to stronger 18o depletion in the monsoon rain thus one could expect rain and surface vapour to be in isotopic equilibrium with higher fraction of stratiform rain or clouds as it provides more time low terminal velocity and higher drop surface area small drop size for isotopic equilibration however the possibility of more evaporation of stratiform rain drops due to their increased surface area can lead to kinetic fractionation but our observation show more deviation from isotopic equilibrium during stratiform rain fraction dominated events fig 6c shows rain and surface vapour significantly deviate from equilibrium ε for more stratiform fraction of rain the possible explanation is as follows stratiform rain is characterized by small drop size which leads low fall velocity of drops all together the intensity of downdaft will be low in stratiform rain areas compared to convective rain areas it leads to mixing of more evapo transpirated moisture with the moist air from the cloud down draft at lower levels of atmosphere sample collection at below 2m thus the ground level moisture will be isotopically more enriched and hence low values of ε than that during events with more convective rain fraction in other words high convective rain fraction low stratiform rain fraction can bring more moisture from the cloud to the ground level through intense cloud downdraft so the evapo transpirated moisture component will be less in the ground level vapour leading to ε values close to isotopic equilibrium figs 2 and 3 show that most rainfall and water vapour are strongly depleted in 18o and d during nem compared to other seasons but 18o depletion of rain 4 is more compared to 18o depletion in vapour 2 during nem relative to ism only ponmudi is considered here due to the lack of sufficient rain events at wayanad during nem apparently the mean observed difference in δ18o between rain and vapour observed ε is slightly less during nem 7 9 2 9 n 13 at ponmudi only compared to the corresponding values of pre monsoon 8 9 1 4 n 20 and ism 9 0 1 8 n 100 seasons this could be because the nem rain at the sampling sites is directly formed from the clouds brought by nem winds which are already depleted in 18o and d lekshmy et al 2015 breitenbach et al 2010 etc the sampling sites are located at the leeward side the mountain side sheltered from the wind of western ghats for nem winds supplementary fig sf2 so the lower isotopic depletion i e enrichment of the surface vapour compared to the rain could be possibly due to the contribution from the locally derived moisture evapo transpiration which will be isotopically enriched to the surface level vapour thus the rain and water vapour deviate from isotopic equilibrium during the nem 5 conclusions high resolution simultaneous observations of rain and water vapour stable isotopic composition from two tropical hill stations show distinct δ18o and δd values during different seasons due to i the differences in moisture source ii rain vapour interaction and iii mixing of ocean derived moisture with locally derived moisture evapo transpiration rain and water vapour are in isotopic equilibrium during the pre monsoon and ism seasons while they deviate from equilibrium during nem due to the influence of more locally derived moisture on the surface water vapour despite of the seasonal scale isotopic equilibrium of ism vapour and rain more deviations are observed during some events characterized by high rainfall from large scale convections occurs over the south eastern arabian sea the fraction of stratiform rainfall from such systems increases with increase in the total rainfall leading to more intense moisture recycling in the clouds though rain and surface water vapour are expected to be in isotopic equilibrium during such events we observe rain and surface water vapour deviate more from isotopic equilibrium when the stratiform rain fraction increases this is due to the increased mixing of isotopically enriched evapo transpiraed moisture during high stratiform rain events possibly due to low vertical mixing of air acknowledgements we thank pv ravisankar tg shylaja lathika sreenivas asokan and pc sreedharan for help in collecting the samples this project was funded by isro gbp government of india gpcp data is provided by the noaa oar esrl psd boulder colorado usa from their web site at http www esrl noaa gov psd the authors gratefully acknowledge noaa air resources laboratory arl for the provision of the hysplit transport and dispersion model through the ready website http www ready noaa gov we thank the anonymous referees for their critical comments appendix a supplementary data supplementary data associated with this article can be found in the online version at https doi org 10 1016 j jhydrol 2018 06 001 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
7143,studies of moisture dynamics associated with major tropical rain activities with the aid of stable oxygen and hydrogen isotopic δ18o and δd measurements in precipitation and water vapour are of current research interest here we present such measurements of rain and water vapour samples collected at two tropical coastal hill stations of southern peninsular india during april october 2012 an apparent seasonal cycle is observed both in rain and vapour isotopes despite of the isotopic equilibrium observed between rain and vapour during the whole sampling period it often deviates in sub seasonal time scales rain vapour isotopic separation factors are lower compared to the equilibrium separation values during stratiform rain events of indian summer monsoon while the separation factors are close to the equilibrium values during convective events this is possibly due to the decreased vertical mixing of moisture during stratiform rain events keywords rain water vapour stable isotopes monsoon stratiform rain 1 introduction stable isotopologues of water are potential tracers to quantify the components of hydrological cycle such as evaporation gat 1996 sutanto et al 2012 transpiration jasechko et al 2013 rothfuss et al 2010 sheshshayee et al 2005 ground water recharge boronina et al 2005 thorburn et al 1993 river runoff etc and to reconstruct past climate from stable isotope based proxies e g managave et al 2011 ramesh et al 2010 xu et al 2015 yadava and ramesh 2005 the isotopic measurements of most components of hydrological cycle e g ocean water river water rain etc are rather straight forward and thus plenty till date but water vapour isotopic measurements are comparatively less compared to other measurements nevertheless increased measurements of isotopic composition of water vapour using laser based isotopic measurements during the last decade galewsky et al 2016 made significant advancement of knowledge on the hydrological cycle for example understanding of the microphysical rain vapour interactions raindrop re evaporation rain vapour isotopic equilibration mixing etc in convective cloud systems leading to the amount effect a negative linear relation between tropical rain amount and its 18o has been improved with vapour isotopic observations which in turn help in accurate paleoclimate reconstruction the 18o variations in climate proxies such as tree rings bose et al 2016 managave et al 2010 xu et al 2015 and speleothems are interpreted using amount effect araguás araguás and froehlich 1998 dansgaard 1964 the preferential condensation of heavy isotopes and the preferential evaporation of lighter isotopes during precipitation were believed to be the key processes responsible for amount effect low rain amount low fraction of rain from the vapour mass will be isotopically enriched while it leaves isotopically depleted vapour behind so increased rainfall incorporates more depleted vapour on further condensation leading to lower δ18o of higher rain amounts comparative dry condition during light rain causes subsequent enrichment of the raindrops due to raindrop re evaporation while less raindrop re evaporation occur during heavy rain events due to higher ambient relative humidities dansgaard 1964 accentuating the amount effect however the robustness of this relation has become questioned by the addition of more recent observations kumar et al 2010 kurita 2013 lekshmy et al 2015 midhun and ramesh 2016 rainfall δ18o variations are recently reported to be independent of the corresponding rainfall amount in many tropical stations and rather the importance of moisture sources type of rain activity and moisture recycling are highlighted berkelhammer et al 2012 kurita et al 2011 kurita and yamada 2008 lee and fung 2008 lekshmy et al 2014 moore et al 2014 risi et al 2008 the roles of different processes responsible for the amount effect were quantified by risi et al 2008 introducing 18o and d in the emmanuel convective parameterization in a single column model and underscored the importance of moisture recycling in convective clouds the isotopically depleted vapour produced after the condensation of clouds and from rain drop re evaporation reaches the sub cloud layer through downdraft which again feeds the cloud updraft influencing the isotopic composition of further rainfall intense convection amplifies the effect of such moisture recycling and leads to the amount effect risi et al 2008 a contemporary stream of research thus focuses on the validation of the theory proposed by risi et al 2008 and to improve the understanding of moisture recycling processes and rain vapour interactions in various types of clouds across the tropics isotopic composition of rain and vapour show distinct features in different types of clouds such as convective stratiform and frontal due to different microphysical processes aggarwal et al 2016 guan et al 2013 large scale convective systems are often observed in the tropics in association with low pressure systems tropical cyclones depressions etc madden julian oscillations mjo mesoscale convective systems mcs different monsoons etc such type of large scale systems consist of both convective clouds with high vertical extends as well as stratiform clouds thin clouds within it a significant proportion of the total rain in prominent tropical weather systems is derived from stratiform clouds chattopadhyay et al 2009 houze 1997 2004 pokhrel and sikka 2013 schumacher et al 2003 rain drop re evaporation and isotopic equilibration of raindrops with ambient vapour are found to be more effective in stratiform rain due to the smaller rain drop size which effectively increases the interactive surface area and remains in the atmosphere more time due to smaller terminal velocity compared to convective rain the instantaneous stratiform rain may get enriched in heavier isotopes due to the probability of more evaporation but can effectively produce vapour strongly depleted in 18o and d and play a crucial role in the moisture recycling occurring in organized convective regimes aggarwal et al 2016 berkelhammer et al 2012 kurita 2013 while in the convective clouds the clouds drop size is more compared to the stratiform cloud drops leading to comparatively less interactive surface area and large terminal velocity thus rain drop re evaporation and isotopic equilibration of raindrops with ambient vapour will be less effective in convective rain compared to the stratiform rain yet the limited simultaneous isotopic observations of vapour and rain constrain the quantification of role of stratiform clouds in rain water vapour interactions and moisture recycling in large scale convective clouds because of the tedious sampling procedure for water vapour compared to rain measurements of its stable oxygen and hydrogen isotopic compositions δ18ov and δdv respectively commonly δv are limited until recently i e before the advent of laser based portable isotope analyzers as even the simplest isotopic models necessarily require δv as an input craig and gordon 1965 previous studies mostly assumed that the water vapour was in isotopic equilibrium with monthly mean rain and calculated it theoretically e g managave et al 2010 while this assumption may be valid for average values over longer time scales months or years it could fail on shorter time scales days or weeks deshpande et al 2010 srivastava et al 2015 the reasons for which is not yet clear the present study is an attempt mainly to understand the rain vapour interaction and the role of stratiform clouds rain on the isotopic variability of indian summer monsoon ism rainfall for this simultaneous observation of isotopic composition of water vapour and rain was done from two tropical stations from kerala south western peninsular india collected during april october 2012 which is strongly influenced by ism the amount of local rainfall plays an insignificant role on the isotopic variability of rain here lekshmy et al 2015 2014 warrier et al 2012 yadava et al 2007 while the upstream convective activity over the eastern arabian sea shows a strong correlation with the rainfall δ18o at kerala lekshmy et al 2014 stratiform rainfall signifies around half of the total rainfall during ism and plays a major role in modulating the dynamical response of the ism atmosphere in organized convective events associated with the ism intra seasonal variability chattopadhyay et al 2009 besides the study area experiences rainfall during different seasons viz pre monsoon april may ism june september and north east monsoon nem october december throughout the year where the major moisture sources moisture transport pathways cloud activities leading to rain differ thus the major objectives of the present study are 1 to study the rain vapour isotopic interactions on seasonal to sub seasonal time scales with more emphasis on the ism season and 2 to identify the role of stratiform clouds on the isotopic variability and interactions of rainfall and surface water vapour 2 sampling sites materials and methods 2 1 rain and water vapour collection to understand the seasonal variation isotopic composition of rainfall and the isotopic interaction between them daily rain whenever it rained and water vapour samples were collected from march 30th to october 28th 2012 at ponmudi pnd 8 76 n 77 12 e 780 m above m s l and wayanad wyd 11 51 n 76 02 e 800 m above m s l fig 1 these stations are characterized by seasonally reversing winds and thus rain derives from two distinct sources of moisture during the year both the stations are located on the western side 50 away from the coast of the western ghats and obtain the majority of the annual rain during the ism the isotopic signature of water vapour here is less altered by continental evapo transpirated moisture due to the characteristic wind pattern south westerly wind with high wind speed during ism and thus these stations are ideal places to study the isotopic characteristics of ism vapour and rain north east monsoon nem october december also called winter monsoon or post monsoon also contribute to significant amounts of annual rainfall 30 at ponmudi and 14 at wayanad rain samples were collected each day at 9 00 am indian standard time taking care of the sample quality for details see lekshmy et al 2014 ponmudi received less rain a total of 1357 mm than wayanad 3903 mm these can be compared with the climatological mean values of the respective nearest meteorological stations 1412 mm at trivandrum and 2889 mm at kozhikode respectively http www imd gov in water vapour samples were also collected from the same stations and period using the cryo trap method see for details midhun et al 2013 atmospheric air is pumped for 3 h through a glass trap maintained under 80 c using a mixture of ethanol and liquid nitrogen at a flow rate below 500 ml minute vapour samples were collected from 9 00 am to12 00 pm almost every day during this period a total of 301 n 174 at pnd and n 127 at wyd water vapour samples and 201 n 78 at pnd and n 123 at wyd rain samples were collected during this period 2 2 isotopic analysis isotopic analyses of the samples δ18o and δd were done using a thermo delta v plus isotope ratio mass spectrometer at the physical research laboratory ahmedabad india gas equilibration method h2o co2 and h2o h2 was adopted for the isotopic analysis epstein and mayeda 1953 the precisions of isotopic analysis was below 0 1 for δ18o and 1 for δd leading to an uncertainty of 1 3 on the calculated deuterium excess d δd 8 δ18o 2 3 components of rainfall and back trajectory analysis to understand the role of stratiform clouds on isotopic variability and interaction of rain and vapour convective and stratiform rain components of the daily rainfall were obtained from tropical rainfall measurement mission trmm 3g68 using the trmm microwave imager tmi sensor haddad et al 1997 the climatology 1981 2011 ce of ism rainfall is obtained from global precipitation climatology project gpcp data adler et al 2003 120 hour air mass back trajectory to the surface level analysis was done using the noaa hybrid single particle lagrangian integrated trajectory hysplit model draxler and rolph 2013 to the location 11 55 n 76 22 e 800m above m s l the model uses gdas global data assimilation system data kanamitsu 1989 as input and generates three dimensional back trajectories of air parcels and meteorological variables such as rainfall pressure potential temperature temperature and relative humidities along the trajectories 3 results and discussions 3 1 isotopic characteristics of vapour and rain as stable isotope data for monsoon vapour from south western coast of india where the ism hits first in the country are being reported here for the first time we summarize the main features of both vapour and rain fig 2 shows the time series of δ18ov δdv water vapour δ18or δdr rain at ponmudi and wayanad and the associated parameters the δ18ov values between ponmudi and wayanad show a significant correlation with a correlation coefficient r of 0 54 likewise δ18or values at both stations are also significantly correlated r 0 62 the ranges of δ18ov δdv variability of water vapour at ponmudi and wayanad are from 8 6 to 24 3 51 0 to 170 0 and from 7 9 to 20 5 50 0 to 139 1 respectively while the δ18or δdr values of rain vary from 0 7 to 16 1 10 9 to 115 7 and 1 7 to 11 0 22 4 to 71 6 the d excess values of water vapour at ponmudi and wayanad varied from 6 3 to 26 5 and 13 3 to 31 2 and that of rain varied from 9 0 to 23 1 and 8 9 to 27 3 respectively high values of vapour rain d excess can be due to many factors such as i kinetic fractionation at the evaporation source uemura et al 2008 ii rain drop re evaporation iii mixing with vapour with high d excess etc these values are consistent with the rainfall isotopic observations from this region reported earlier by resmi et al 2016 shahul hameed et al 2016 warrier et al 2016 2010 etc and long term gnip observations from kozhikode the correlation between the measured rainfall and δ18or show significant negative relation at these stations but explains only 6 and 18 r2 of the daily rainfall variability at ponmudi and wayanad respectively although ponmudi received less annual rainfall the δ18or values here are slightly lower than the corresponding values at wayanad as it receives a higher proportion of the nem rainfall which is usually more depleted in 18o and d 3 2 seasonality of rainfall and vapour isotopes seasonal cycles in the rainfall and vapour isotopes are observed in the data with the most 18o or d enriched events during the pre monsoon depleted events during ism and followed by the most depleted events during nem fig 3 this is supported by the monthly observations at many stations of global network for isotopes in precipitation gnip across india lekshmy et al 2015 shahul hameed et al 2016 including the long term observations at kozhikode warrier et al 2010 and the event based observations at meghalaya breitenbach et al 2010 this seasonality has been attributed to i the changes in the moisture source during each season associated with the prevailing winds ii the moisture transport pathways and the changes in the condensation history iii the changes moisture source characteristics such as ocean surface condition and isotopic composition ocean e g bay of bengal breitenbach et al 2010 and iv the type of cloud activities responsible for the rain isolated of large scale organized convection lekshmy et al 2015 this is further discussed in detail in the next section 3 2 1 pre monsoon very few rain events were recorded during the pre monsoon which is mainly comprised of occasional isolated thunderstorms and a low pressure cyclonic storms one occurred during the last week of april water vapour and rain during pre monsoon are enriched in 18o and d compared to the later seasons but some individual events associated with cyclonic storms during pre monsoon show comparatively stronger 18o depletions in rain and vapour lekshmy et al 2015 while the 18o and d of rain and vapour during isolated rain vapour collected during non rainy days also events marked enriched values probably due to lesser moisture recycling with in the clouds lekshmy et al 2014 5 day air parcel back trajectories during pre monsoon season fig 4 show that air parcels which reach kerala during pre monsoon mostly come from the arabian sea with relative humidities 70 with some originate from west asia with low relative humidities 40 also the δ18o δd relation local meteoric water line lmwl for vapour during pre monsoon shows significantly lower values of slope and intercept compared to those for the later two seasons fig 4 the slope of lmwl of pre monsoon rainfall at wayanad is close to that of the global meteoric water line gmwl with a higher value of intercept at wayanad only the number of data points at ponmudi is 10 fig 3 this is possibly because the maximum temperatures 32 c occur during the pre monsoon which lead to evaporation of rain in the atmosphere and a lower slope the intercept is higher because of mixing with continental evapo transpirated vapour 3 2 2 indian summer monsoon ism during 2012 is characterized by both isolated events with comparatively enriched 18o and d and large scale convective events with depleted 18o and d lekshmy et al 2014 back trajectories show south westerly winds from the southern indian ocean reaching kerala during ism the relative humidities along these trajectories show that monsoon winds bring a great amount of moisture rh 70 from the southern arabian sea and the equatorial indian ocean though significant rainfall occurs over the arabian sea itself during the ism season supplementary information sf1 climatological mean jjas precipitation gpcp data the relative humidity of air parcels is high irrespective of the height of the air parcel indicating a constant supply of moisture from the arabian sea that leads to copious rainfall over kerala climatological annual ism rainfall in kerala is 2040 mm the slopes of local meteoric water and vapour lines lmvl are close to 8 but the intercept of lmwl of rain samples of ism is higher than 10 the intercept of lmwl of ism is slightly higher than that of pre monsoon whereas the intercept of lmvl of ism is significantly higher than that of pre monsoon for both stations 3 2 3 north east monsoon nem rain and vapour show the lowest δ18o and δd in the year lekshmy et al 2015 warrier et al 2010 yadava et al 2007 nem occurs after the withdrawal of south westerly winds with the establishment of north easterly winds back trajectory analyses show that air parcels travel from continental areas mainly from the indian subcontinent with low relative humidities until they reach the bay of bengal bob thereafter significant moisture uptake from the bob occurs leading to nem rainfall over tamil nadu before reaching kerala continental recycle moisture surface evaporation and transpiration may also contribute vapour to these air parcels when they cross the western ghats the observed d excess values in the rain and water vapour in this season fig 3 are slightly higher than those in the ism season possibly due to influence of continental recycled moisture gat 1996 yurtsever and gat 1981 during this season too at both the stations the slopes of lmwl are close to 8 the values of intercepts are higher compared fig 4 to the other two seasons except for the lmwl of ponmudi because the component of re cycled vapour is much higher as the air masses travel over larger distances over land supplementary figure sf2 4 rain vapour isotopic interaction δ18o values of vapour in isotopic equilibrium the equilibrium fractionation factors ε with rain is calculated using δ18or and ambient air temperature majoube 1971 and compared with the observed δ18ov fig 5 they show a significant positive linear relationship at both the stations it implies that surface water vapour and rain are close to isotopic equilibrium on longer time scale in order to quantify this we have compared the equilibrium fractionation values calculated ε with the corresponding isotopic separation between δ18or and δ18ov observed ε and given in fig 2e and f the average of calculated ε is 9 5 0 1 while the observed value is 8 3 2 2 for all the observations at ponmudi similarly calculated ε is 9 4 0 2 while the observed value is 9 4 1 4 at wayanad but the daily observations show deviation from the equilibrium fractionation factors fig 2 thus our observations suggest that surface water vapour and rain are close to isotopic equilibrium on longer time scale this could be due to i mismatch in the durations of water vapour collection 3 h per day and rain collection 24 h accumulated and ii mixing of evapo transpirated moisture from the surface deshpande et al 2010 rain vapour isotopic compositions of ism are characterized by little alteration from locally derived moisture as the observed ε is close to the calculated ε 8 4 2 2 n 43 at ponmudi and 9 4 1 4 n 57 at wayanad noticeably more deviation from the isotopic equilibrium level is also observed during the high rain events of ism season fig 2e and f these events are characterized by large scale organized convection over eastern arabian sea near kerala coast large scale organized convections are characterized by enhanced stratiform rainfall leading to the possibility of more moisture recycling inside and sub cloud layers risi et al 2008 kurita 2013 so the effect of stratiform clouds on the rain vapour isotopic interaction and their variability during ism are further studied using convective stratiform components from trmm 3g68 daily rainfall data kummerow et al 2001 lekshmy et al 2014 reported that the δ18o variability of ism rainfall over kerala is very much influenced by the convective activity over eastern arabian sea accordingly we selected a grid box 8 12 n and 70 75 e and evaluated the daily total rainfall with its convective and stratiform components from june 1 to september 30 2012 stratiform rain fraction varies between 10 50 of the daily total rain on an average stratiform rain contribute 30 to the total rain in the selected grid two station datasets are merged into a single time series by taking arithmetic averages as δ18or and δ18ov between the stations correlate significantly stratiform rain fraction increases with increase in daily total rainfall supplementary s fig 3 and significant negative correlation is observed between stratiform rain fraction and average δ18o of rain and vapour fig 6 a and b of both the stations the increased post condensation processes such as rain drop evaporation and equilibrium isotopic exchange processes are more in the stratiform rain which favors the heavier isotopic depletion of subcloud level vapour in an organized convective system which typically last for 2 4 days lekshmy et al 2014 this depleted sub cloud level vapour further feeds the system resulting in heavy depletion in the subsequent rain our observations support the recently proposed aggarwal et al 2016 berkelhammer et al 2012 kurita 2013 moore et al 2014 mechanisms of stratiform rainfall in large scale convective systems giving rise to stronger 18o depletion in the monsoon rain thus one could expect rain and surface vapour to be in isotopic equilibrium with higher fraction of stratiform rain or clouds as it provides more time low terminal velocity and higher drop surface area small drop size for isotopic equilibration however the possibility of more evaporation of stratiform rain drops due to their increased surface area can lead to kinetic fractionation but our observation show more deviation from isotopic equilibrium during stratiform rain fraction dominated events fig 6c shows rain and surface vapour significantly deviate from equilibrium ε for more stratiform fraction of rain the possible explanation is as follows stratiform rain is characterized by small drop size which leads low fall velocity of drops all together the intensity of downdaft will be low in stratiform rain areas compared to convective rain areas it leads to mixing of more evapo transpirated moisture with the moist air from the cloud down draft at lower levels of atmosphere sample collection at below 2m thus the ground level moisture will be isotopically more enriched and hence low values of ε than that during events with more convective rain fraction in other words high convective rain fraction low stratiform rain fraction can bring more moisture from the cloud to the ground level through intense cloud downdraft so the evapo transpirated moisture component will be less in the ground level vapour leading to ε values close to isotopic equilibrium figs 2 and 3 show that most rainfall and water vapour are strongly depleted in 18o and d during nem compared to other seasons but 18o depletion of rain 4 is more compared to 18o depletion in vapour 2 during nem relative to ism only ponmudi is considered here due to the lack of sufficient rain events at wayanad during nem apparently the mean observed difference in δ18o between rain and vapour observed ε is slightly less during nem 7 9 2 9 n 13 at ponmudi only compared to the corresponding values of pre monsoon 8 9 1 4 n 20 and ism 9 0 1 8 n 100 seasons this could be because the nem rain at the sampling sites is directly formed from the clouds brought by nem winds which are already depleted in 18o and d lekshmy et al 2015 breitenbach et al 2010 etc the sampling sites are located at the leeward side the mountain side sheltered from the wind of western ghats for nem winds supplementary fig sf2 so the lower isotopic depletion i e enrichment of the surface vapour compared to the rain could be possibly due to the contribution from the locally derived moisture evapo transpiration which will be isotopically enriched to the surface level vapour thus the rain and water vapour deviate from isotopic equilibrium during the nem 5 conclusions high resolution simultaneous observations of rain and water vapour stable isotopic composition from two tropical hill stations show distinct δ18o and δd values during different seasons due to i the differences in moisture source ii rain vapour interaction and iii mixing of ocean derived moisture with locally derived moisture evapo transpiration rain and water vapour are in isotopic equilibrium during the pre monsoon and ism seasons while they deviate from equilibrium during nem due to the influence of more locally derived moisture on the surface water vapour despite of the seasonal scale isotopic equilibrium of ism vapour and rain more deviations are observed during some events characterized by high rainfall from large scale convections occurs over the south eastern arabian sea the fraction of stratiform rainfall from such systems increases with increase in the total rainfall leading to more intense moisture recycling in the clouds though rain and surface water vapour are expected to be in isotopic equilibrium during such events we observe rain and surface water vapour deviate more from isotopic equilibrium when the stratiform rain fraction increases this is due to the increased mixing of isotopically enriched evapo transpiraed moisture during high stratiform rain events possibly due to low vertical mixing of air acknowledgements we thank pv ravisankar tg shylaja lathika sreenivas asokan and pc sreedharan for help in collecting the samples this project was funded by isro gbp government of india gpcp data is provided by the noaa oar esrl psd boulder colorado usa from their web site at http www esrl noaa gov psd the authors gratefully acknowledge noaa air resources laboratory arl for the provision of the hysplit transport and dispersion model through the ready website http www ready noaa gov we thank the anonymous referees for their critical comments appendix a supplementary data supplementary data associated with this article can be found in the online version at https doi org 10 1016 j jhydrol 2018 06 001 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
7144,a vast amount of future climate scenario datasets created by climate models such as general circulation models gcms have been used in conjunction with watershed models to project future climate variability impact on hydrological processes and water quality however these low spatial temporal resolution datasets are often difficult to downscale spatially and disaggregate temporarily and they may not be accurate for local watersheds i e state level or smaller watersheds this study applied the us epa environmental protection agency s climate assessment tool cat to create future climate variability scenarios based on historical measured data for local watersheds as a case demonstration cat was employed in conjunction with hspf hydrological simulation program fortran model to assess the impacts of the potential future extreme rainfall events and air temperature increases upon nitrate nitrogen no3 n and orthophosphate po4 loads in the lower yazoo river watershed lyrw a local watershed in mississippi usa results showed that the 10 and 20 increases in rainfall rate respectively increased no3 n load by 9 1 and 18 and po4 load by 12 and 24 over a 10 year simulation period in contrast simultaneous increases in air temperature by 1 0 c and rainfall rate by 10 as well as air temperature by 2 0 c and rainfall rate by 20 increased no3 n load by 12 and 20 and po4 load by 14 and 26 respectively a summer extreme rainfall scenario was created if a 10 increase in rainfall rate increased the total volume of rainwater for that summer by 10 or more when this event occurred it could increase the monthly loads of no3 n and po4 by 31 and 41 respectively for that summer therefore the extreme rainfall events had tremendous impacts on the no3 n and po4 loads it is apparent that cat is a flexible and useful tool to modify historical rainfall and air temperature data to predict climate variability impacts on water quality for local watersheds keywords climate assessment tool local watersheds hspf rainfall nutrient load 1 introduction since last century increasing climate variability has resulted in modifications of intensity frequency duration and timing of extreme weather events ipcc 2012 in addition to increasing air temperature such change has caused variations in amount intensity and distribution of precipitations along with increasing frequency of extreme events such as floods and droughts praskievicz and chang 2009 ipcc 2012 wasko and sharma 2015 this has been observed in many areas around the world lecce 2000 bates et al 2008 labat 2008 peterson et al 2013 casanueva et al 2014 verma et al 2015 wasko et al 2017 tank et al 2009 argued that air temperature is expected to increase 1 1 6 4 c in 2100 as compared to that in 1900 these authors also speculated that each of the past three decades has been successively warmer than any previous decades based on historical weather records and the decade of the 2000s is the warmest bates et al 2008 stated that very dry land area has been doubled in some parts of the world while heavy rainfall has been increased in other parts of the world since 1970s it is a general consensus that increasing climate variability has discernible effects on agricultural industrial environmental and ecological systems at both global and regional scales ipcc 2012 hydrological processes and surface water quality are vulnerable to climate change through its impact on evapotranspiration surface runoff stream flow water yield soil erosion and nutrient loss estimate of hydrological processes and surface water quality is central to water resource management clean water supply environmental protection and ecological restoration ouyang et al 2015 parajuli et al 2016 to mitigate future climate variability impacts on hydrological processes and water quality water resource managers and decision makers must be able to assess potential threats and propose practices to adapt the future climatic conditions currently projecting changes in hydrologic cycles and water quality have generally been accomplished by using process based watershed models in conjunction with future climate scenario datasets created with climate models including the general circulation models gcms regional climate models rcms and cmip5 coupled model inter comparison project phase 5 chang et al 2001 verma et al 2015 wang et al 2016 alamdari et al 2017 chang et al 2001 assessed the potential impact of climate change on stream flow and nutrient loading in six watersheds of the susquehanna river basin pennsylvania using the generalized watershed loading function with future climate datasets i e air temperature and precipitation from the gcms these authors found that mean annual stream flow and nutrient loads increased for most watersheds but decreased in one watershed that was intensively cultivated and nutrient load slightly decreased in april and late summer for several watersheds as a result of early snowmelt and increasing evapotranspiration shrestha et al 2012 performed a modeling study on climate induced changes in hydrologic and nutrient fluxes at the lake winnipeg watershed canada using swat soil and water assessment tool for a 21 year baseline 1980 2000 and a 20 year 2042 2062 future period with climate data derived from the rcms these authors found that the simulated nutrient loads closely match the dynamics of the future runoff for both nitrogen and phosphorus alamdari et al 2017 assessed the effects of future climate on water quantity and quality in an urban watershed using storm water management model swmm with future precipitation and air temperature data from the rcms for the period from 2041 to 2068 these authors learned that annual runoff volume would increase by 6 5 while total suspended solids total nitrogen and total phosphorus would increase by 7 6 7 1 and 8 1 respectively more recently ajami et al 2017 investigated the nature and frequency of non stationary hydrological response over 166 anthropogenically unaffected catchments in australia these authors found that there are no changes to vegetation in certain type of catchments in a warmer climate while there are significant changes in other types of catchments that are dominantly dependent on whether the catchments are water limited or nutrient limited wang et al 2017 simulated the influence of sea level rise and warming on circulation and water quality of the chesapeake bay with projected climate conditions in 2050 they argued that with a 1 6 1 9 c increase in monthly air temperatures water temperature in the bay is estimated to increase by 0 8 1 c and the summer average anoxic volume is estimated to increase by 1 4 percent li et al 2011 predicted effects of temperature change on water discharge and sediment and nutrient loading in the lower pearl river basin china using the swat model these authors found that sediment load increases by 13 58 when the air temperature increases by 3 c and the inorganic n and p inputs into the estuary have an increasing trend when the air temperature increases from 2 c to 3 c although the above studies have provided invaluable insights into the direction to project the future hydrologic and water quality trends due to increasing climate variability the limitations on using the climate scenario datasets created by gcms rcms and cmip5 are 1 they have low spatial resolution and are somewhat difficult to downscale for local watersheds i e state level or smaller watersheds 2 they are in low temporal resolution e g monthly or annual time intervals and are difficult to disaggregate into daily or hourly interval required by most watershed models and 3 they are not flexible to answer the what if questions for local watersheds in other words while a vast amount of future climate datasets have become available in recent years from the gcms rcms and cmip5 these datasets are at such a low spatial temporal resolution that they may not be accurate and flexible to assess climate variability impacts on local watersheds wang et al 2016 reported that these climate scenario datasets have inaccurate spatial information for example reported to the nearest minute which are particularly problematic in steep mountainous terrain where a medium resolution grid cell would still span climate environments with several hundred meters difference in elevation mohammed et al 2015 found that most of cmip5 datasets fail to capture both the trends and variability observed in historical precipitation for a watershed with a drainage area of 360 km2 in the winooski basin huc 02010003 which is a multi state and bi national basin vermont new york and québec additionally these climate datasets do not have flexibility to answer the what if questions for local watersheds which are fundamental to the state and local water resource managers and stakeholders for example state and local water resource managers would like to know what will happen to stream flow and surface water availability for a given local watershed if the extreme precipitation events e g very dry summers and wet winters occur in the next 10 years so that they can implement practices to adapt for the changing climatic conditions with the pre set climate scenario data from the gcms rcms and cmip5 these what if questions are difficult to answer therefore an alternative approach is needed to circumvent these obstacles to this end the us epa climate assessment tool cat is chosen in this study cat was included in the basins better assessment science integrating point and nonpoint sources modeling system in 2007 to increase the ability for using basins to perform watershed studies as affected by climate change us epa 2009 cat can be used to easily create climate change scenarios and to quickly answer a wide range of what if questions on how weather and climate could affect hydrological processes and water quality using the hspf hydrological simulation program fortran swat and swmm models more specifically climate change scenarios can be established with cat through modifying the historical temperature and precipitation data to reflect the possible future changes us epa 2009 however a thorough literature search revealed that very few study has been devoted to using cat for analyzing climate change impacts on hydrological processes zhou et al 2017 and no effort has been currently made to analyze surface water quality using cat the goal of this study was to apply cat to project future climate variability impacts on nutrient load for local watersheds specific objectives of this study were to 1 develop a site specific basins hspf model using the lower yazoo river watershed lyrw a local watershed in mississippi usa as a case study 2 calibrate and validate the model with field measured data and 3 apply the resulted model in conjunction with cat to assess stream discharge and nitrate nitrogen no3 n and orthophosphate po4 loads in the lyrw as affected by potential air temperature and rainfall variations due to climate change 2 materials and methods 2 1 study site the lyrw is located within four mississippi counties sharkey issaquena yazoo and warren south of yazoo river basin yrb mississippi with an area of 618 km2 fig 1 a this watershed consists of 61 forest land and 31 agriculture land with soil types of sand loam and clay and is a highly productive agricultural area known for its cotton corn soybeans rice and catfish mdeq 2008 selection of this watershed was based on the following two reasons 1 there are field measured data available for model calibration and validation and 2 this watershed is small and is difficult to use the low spatial temporal resolution climate scenario datasets from the gcms rcms and cmip5 surface water pollution within the lyrw includes excess nutrients and sediments which are the results of storm water runoff discharge from ditches and creeks aquatic weed control and atmospheric deposition nett et al 2004 shields et al 2011 ouyang et al 2013 the degradation of water quality has resulted in altered species composition and decreased the overall health of aquatic communities in the lyrw ouyang et al 2015 2 2 cat description although an elaborate description of the basins and hspf models is not necessary because they are the widely used watershed models in the world a moderate description of the cat model is however warranted because the model is not yet common in the literature cat is basically used to adjust historical precipitation and air temperature time series input data to create climate change scenarios for the hspf swat or swmm model for precipitation cat can be used to modify all values daily or hourly by a specified constant or factor the values within a selected period month or season of every year and all events within a specified event class precipitation events can also be randomly added or removed to represent changes in precipitation event frequency for air temperature cat can be employed to modify full historical records and regenerate evapotranspiration et record add or subtract a constant or factor to a specified season and regenerate et and increase or decrease values occurring within a specified time period years and within the full record by a specified constant or factor the standard output files of hspf swat or swmm simulations can be saved for later analysis detailed description of the cat model can be found in its user s manual epa 2009 it should be pointed out that cat is a tool for modifying model inputs and saving model outputs and is very similar to a pre and post processor cat does not perform downscale or disaggregation of input data 2 3 hspf model and data acquisition procedures in developing a hspf model within basins include 1 watershed delineation this process requires to establish a digital elevation model dem create the stream networks in shape files and generate watershed inlets or outlets using the basins watershed delineation tool 2 land use and soil type determination this was accomplished by using the land use and soil classification tools in basins 3 mathematical description of the watershed processes and preparation of input meteorological and hydrological time series data bicknell et al 2001 hspf model is a lumped parameter model with a modular structure three modules are used in this study the perland modular is for pervious land segments over which an appreciable amount of water infiltrates into the ground the implnd modular is for impervious land segments over which infiltration are negligible such as paved urban surfaces the rchres modular is for the processes occurring in water bodies like streams and lakes these modules have several sub modules dealing with the hydrological processes biological and chemical reactions et soil water storage and water quality detailed information about the structure and functioning of these modules can be found in bicknell et al 2001 fig 1b shows the hspf model for the lyrw developed in this study we have used the similar approaches previously ouyang et al 2013 2015 major input data used in this study included land use soil type topography precipitation air temperature solar radiation and discharge they are from the national hydrography dataset us geologic survey usgs national water information system and the 2001 national land cover data these data can be downloaded directly from the metadata section of basins the resolution of dem for this model was 30 m and the precipitation air temperature solar radiation and simulation time step were in hourly intervals 2 4 hspf calibration and validation a model calibration is to modify input parameter values within an acceptable range to have a good fit between the field observations and the model simulations whereas a model validation is to verify the calibrated model by comparing the field observations and the model predictions without changing any input parameter values in this study the stream discharge as well as the no3 n and po4 concentrations from the hspf model were used for model calibration and validation the field observed daily discharge and concentration data from 2000 to 2005 were used for model calibration whereas an independent set of field observed daily discharge and concentration data from 2006 to 2009 were employed for model validation a similar approach was used previously for the same watershed ouyang et al 2013 2015 parajuli and ouyang 2013 except that more field measured data and statistical measures were used in this study to calibrate and validate the hspf model fig 2 shows the observed and predicted daily stream discharges as well as no3 n and po4 concentrations left hand side for the simulation period from january 1 2000 to december 31 2005 as the values of r2 and nse nash sutcliffe efficiency were respectively 0 69 and 0 68 for daily stream discharge 0 89 and 0 58 for daily no3 n concentration and 0 88 and 0 51 for daily po4 concentration we concluded that good agreements were gained between the model predictions and the field observations during model calibration the goodness of fit was further estimated graphically by comparing the peaks and valleys of daily discharge and concentrations as shown on the right hand side of fig 2 the daily peaks and valleys from model predictions matched reasonably well graphically with field observations daily stream discharge and no3 n and po4 concentrations between the field observations and the model predictions during model validation from january 1 2006 to december 31 2009 is shown on the left hand side of fig 3 with reasonable values of r2 and nse we showed that good agreements were achieved between the model predictions and the field observations during the model validation a visual estimate of the peaks and valleys of daily discharge and no3 n and po4 concentrations shown on the right hand side of fig 3 further confirmed that the model was reasonably validated 2 5 simulation scenarios to estimate the impacts of potential future rainfall and air temperature variations on no3 n and po4 loads in the lyrw four simulation scenarios were chosen in this study comparison of simulation results among these four scenarios allowed us to evaluate the potential impacts of future air temperature and rainfall variations due to climate change upon the daily and annual stream discharge and no3 n and po4 loads the first scenario base scenario was chosen to predict daily and annual no3 n and po4 loads with historical air temperature and rainfall data over a 10 year simulation period from 2000 to 2009 with an hourly time step the input data used in this scenario were the same as those used for model validation above more specifically the meteorological data such as rainfall rate air temperature relative humidity and solar radiation are the measured hourly data at the lyrw cat was not used for this base scenario because we did not modify the meteorological data the second scenario was the same as the first scenario except that the rainfall rates during the 10 year simulation period were increased by 20 from the historical data at an increment of 5 for each run i e a total of four simulation runs this was accomplished through the following steps fig 1c 1 open the cat from analysis toolbar in the basins program 2 open the based model file cat2017 uci for hspf model and type the new model file rainnew 3 click add to create the new rainfall input data the phrase rain new multiple from 1 to 1 2 step 0 05 means that the original historical rainfall data for the entire simulation period were increased to 20 at the interval of 5 detailed instructions on how to set up a cat modeling scenario are beyond the scope of this study but can be found in the cat user manual epa 2009 this second scenario was chosen to somewhat reflect the future rainfall trend because the amount of rainfall in mississippi tended to increase over the past 100 years based on weather records the third scenario was the same as the first scenario except that the air temperature and rainfall rate were increased simultaneously more specifically when the air temperature increased by 1 0 c from the historical data the rainfall rate was assumed to increase by 10 from its historical data whereas when the air temperature increased by 2 0 c from the historical data the rainfall rate was presumed to increase by 20 from its historical data although it is a general consensus that an increase in air temperature would couple with an increase in rainfall rate in sub tropical and tropical regions ipcc 2012 we do not know exactly how much the rainfall rate would increase when the air temperature increases by 1 or 2 c for this local watershed therefore this scenario was chosen to estimate the what if conditions regarding the potential air temperature increase the fourth scenario was somewhat complicated and was the same as the first scenario except that the extreme rainfall events were added to the historical data in summer months i e june july and august in mississippi summer is the crop growth and harvesting season and extreme rainfall events are harmful to crop productions and stream water quality understand these what if conditions would provide useful information to farmers and water resources managers the extreme rainfall events were established using the cat as follows increased the rainfall rate by 10 from the historical rainfall data in summer of each year and checked to see if the total volume of the rain water after increase for that summer exceeded 10 of the total volume of historical rain water if this is true then the rainfall rate for that summer was increased to 20 and was used as an extreme rainfall event for simulations similar set up can be found in the cat user manual and interested readers are recommended to consult the manual for details 3 results and discussion 3 1 rainfall impact daily changes in rainfall rate stream discharge and no3 n and po4 concentrations at the rainfall rates increased by 0 base 10 and 20 over a simulation period from 2000 to 2009 in the lyrw are shown in fig 4 noted that simulation results at 5 and 15 increases in rainfall rate are not shown for better graphical clarity overall the peaks of the stream discharge fig 4b related very well to those of rainfall fig 4a despite the increase in stream discharge was not proportional to the increase in rainfall rate for instance the daily discharge on may 14 2008 was 77 000 m3 s when the rainfall rate was unchanged base scenario but was 88 700 m3 s when the rainfall rate increased by 10 fig 4b in other words an increase in rainfall rate by 10 increased the stream discharge by 15 2 this occurred because the daily stream discharge depended not only on rainfall rate but also on watershed hydrogeological conditions generally the steeper slope narrower stream channel larger drainage area and lesser tree and grass covered land would generate higher stream discharge in contrast the daily no3 n concentration in general decreased as the rainfall rate increased fig 4c for example the daily no3 n concentrations were 0 49 0 43 and 0 37 mg l respectively as the rainfall rate increased by 0 base 10 and 20 on may 14 2008 it was assumed that no additional sources of n were added to the watershed during the entire period of simulation from 2000 to 2009 in this study therefore the decrease in daily no3 n concentration as the rainfall rate increases could be attributed to the dilution effect the more rainwater was added the lower the no3 n concentration was in the stream mixed results were obtained for the po4 concentration in the stream as the rainfall rate increased that is as the rainfall rate increased the po4 concentrations in the stream increased for some dates decreased for other dates and were unchanged for the rest of the dates fig 4d for instance the daily po4 concentrations were 0 0594 0 0694 and 0 0822 mg l respectively as the rainfall rate increased by 0 base 10 and 20 on august 20 2003 but were 0 025 0 0245 and 0 0241 mg l respectively as the rainfall rate increased by the same percentage levels on october 19 2007 the daily po4 concentration was unchanged 0 012 mg l when the rainfall rate increased by 0 base 10 and 20 on june 28 2005 these mixed results occurred likely due to dilution and desorption of po4 as the rainfall rate increased unlike the case of no3 n which has little adsorption in the soil because of its negative charge desorption of po4 from the soil happens when the rainwater wets the soil overall the dilution reduced while desorption released po4 into the stream annual stream discharge and no3 n and po4 loads from the lyrw at the rainfall rates increased by 0 base 10 and 20 are shown in fig 5 it is apparent that an increase in rainfall rate increased the annual stream discharge as an example the 10 and 20 increases in rainfall rate from the historical data increased respectively the annual stream discharge by 12 2 and 24 7 in 2000 fig 5a this was so because the increase in rainfall rate enhanced surface runoff and added more water for stream discharge analogous to the case of stream discharge the annual no3 n and po4 loads increased as the rainfall rate increased fig 5b and c a 10 increase in rainfall rate increased the no3 n and po4 loads in 2000 by 9 1 and 12 2 respectively this occurred because more volume of water containing the no3 n and po4 masses discharged out of watershed outlet as the rainfall rate increased over a 10 year simulation period the 10 and 20 increases in rainfall rate respectively increased stream discharge by 11 and 22 no3 n load by 9 1 and 18 and po4 load by 12 and 24 therefore a potential future wet climate could have discernable impacts on stream discharge and no3 n and po4 loads at the lyrw watershed efforts should be given to mitigate discharge and nutrient loads in the streams at this watershed 3 2 impacts of coupled air temperature and rainfall annual changes in stream discharge and no3 n and po4 loads for the following three conditions 1 the base case 2 increased air temperature by 1 0 c and rainfall rate by 10 and 3 increased air temperature by 2 0 c and rainfall rate by 20 scenario 3 over a simulation period from 2000 to 2009 in the lyrw are shown in fig 6 an 11 increase in annual stream discharge was found when the air temperature increased by 1 0 c and the rainfall rate increased by 10 fig 6a as compared to a 12 2 increase in annual stream discharge when only the rainfall rate increased by 10 scenario 2 and fig 5a this occurred because of more evapotranspiration et loss of water in the lyrw due to an increase in air temperature which reduced surface water runoff and soil water seepage into the streams simulation results further revealed that there was 19 increases in annual stream discharge when the air temperature increased by 2 0 c and the rainfall rate increased by 20 results suggested that a two fold increase in air temperature and rainfall rate did not increase the annual stream discharge by two times rather than 19 11 1 7 times this was because a two fold increase in air temperature would enhance et loss of water analogous to the case of the annual stream discharge changes in annual no3 n and po4 loads were significant as the air temperature and rainfall rate increased fig 6b and c more specifically there were 12 and 14 increases in annual no3 n and po4 loads respectively when increasing the air temperature by 1 0 c and rainfall rate by 10 while there were 15 and 18 increases in annual no3 n and po4 loads respectively when increasing the air temperature by 2 0 c and rainfall rate by 20 apparently the increases in both air temperature and rainfall rate had discernable impacts on no3 n and po4 loads the 10 year stream discharge and no3 n and po4 loads are shown in fig 7 overall the decadal stream discharge and no3 n and po4 loads increased as the air temperature and rainfall rate increased there were 8 12 and 14 increases in annual discharge no3 n load and po4 load respectively when increasing the air temperature by 1 0 c and rainfall rate by 10 while there were 15 20 and 26 increases in annual discharge no3 n load and po4 load respectively when increasing the air temperature by 2 0 c and rainfall rate by 20 3 3 extreme event impact monthly changes in stream discharge and no3 n and po4 loads for extreme rainfall events over the 10 year simulation period from 2000 to 2009 at the lyrw are shown in fig 8 the extreme rainfall events were added by modifying the historical data in summer months i e june july and august each year if the rainwater volume to be added exceeded 10 of rainwater volume for that summer if this condition was true the rainfall rate for that summer was modified to increase by 20 from the historical data at an increment of 10 for each run these extreme rainfall events were calculated and created using the cat simulation results showed that there were four times namely the summers of 2001 2004 2008 and 2009 when the extreme rainfall events occurred with dramatic changes in monthly stream discharge and no3 n and po4 loads fig 8 there were respectively 36 and 72 increases in monthly stream discharge 31 and 63 increases in monthly no3 n load and 41 and 86 increases in monthly po4 load as the rainfall rate increased by 10 and 20 when the extreme rainfall events occurred in june 2004 fig 8a it is apparent that extreme rainfall events had tremendous impacts on stream discharge and nutrient load this information is very important for local water resource managers stakeholders and farmers for adapting management practices to account for potential climate variability with the help of cat such what if questions can be easily answered results suggest that cat is a useful tool for estimating climate change impacts on watershed hydrology and water quality it should be pointed out that the future climate scenario datasets created by gcms and rcms are not only in low spatial resolution but also in low temporal resolution that is these datasets are normally in monthly or annual interval for most watershed models a daily time step e g swat or hourly time step e g hspf is required to meet this time step requirement the monthly precipitation and air temperature data are disaggregated and downscaled into daily or hourly data with great uncertainty and inaccuracy for a local watershed simulations using these downscale and disaggregate data as inputs may not be appropriate therefore it would be a good idea to use the gcms and rcms climate scenario datasets to assess future climate change impacts on hydrological processes and water quality for global and regional river basins and to use cat to create climate scenario datasets for the same assessment for local watersheds 4 summary and conclusions the climate assessment tool cat along with hspf model in the basins modeling system was applied to assess the impact of potential rainfall and air temperature variations due to climate change upon hydrological processes and water quality in the lyrw mississippi in addition to the base simulation scenario three more simulation scenarios were chosen to investigate impacts of increasing air temperature and increasing rainfall rate and or extreme events upon no3 n and po4 loads in the lyrw in general the daily no3 n concentration decreased as the rainfall rate increased when no additional source of n was added to the watershed such a decrease was attributed to the dilution effect as the rainfall rate increased in contrast the daily po4 concentration could increase or decrease as the rainfall rate increased and this occurred because of the dilution and desorption of po4 the dilution reduced while desorption released po4 into the stream a potential future wet climate could have discernable impacts on stream discharge and no3 n and po4 loads in the lyrw watershed the increases in both air temperature and rainfall rate had very significant impacts on no3 n and po4 loads extreme rainfall events had tremendous impacts on stream discharge and no3 n and po4 loads this information is very important for local water resource managers stakeholders and farmers for adapting management practices to account for potential climate variability for local watersheds simulations using the gcms and rcms climate scenario datasets as inputs may not be appropriate because they have low spatiotemporal resolution and are not flexible with the help of cat such obstacles could be circumvented results suggest that cat is a useful tool for estimating climate change impacts on local watersheds which can be extended to other watersheds in the larger scale based on availability of data acknowledgements the study was supported by usda nifa afri competitive grant program project 2013 67020 21407 and 2017 67020 26375 the views expressed in this article are those of the authors and do not necessarily reflect the views or policies of the united state department of agriculture and the u s environmental protection agency 
7144,a vast amount of future climate scenario datasets created by climate models such as general circulation models gcms have been used in conjunction with watershed models to project future climate variability impact on hydrological processes and water quality however these low spatial temporal resolution datasets are often difficult to downscale spatially and disaggregate temporarily and they may not be accurate for local watersheds i e state level or smaller watersheds this study applied the us epa environmental protection agency s climate assessment tool cat to create future climate variability scenarios based on historical measured data for local watersheds as a case demonstration cat was employed in conjunction with hspf hydrological simulation program fortran model to assess the impacts of the potential future extreme rainfall events and air temperature increases upon nitrate nitrogen no3 n and orthophosphate po4 loads in the lower yazoo river watershed lyrw a local watershed in mississippi usa results showed that the 10 and 20 increases in rainfall rate respectively increased no3 n load by 9 1 and 18 and po4 load by 12 and 24 over a 10 year simulation period in contrast simultaneous increases in air temperature by 1 0 c and rainfall rate by 10 as well as air temperature by 2 0 c and rainfall rate by 20 increased no3 n load by 12 and 20 and po4 load by 14 and 26 respectively a summer extreme rainfall scenario was created if a 10 increase in rainfall rate increased the total volume of rainwater for that summer by 10 or more when this event occurred it could increase the monthly loads of no3 n and po4 by 31 and 41 respectively for that summer therefore the extreme rainfall events had tremendous impacts on the no3 n and po4 loads it is apparent that cat is a flexible and useful tool to modify historical rainfall and air temperature data to predict climate variability impacts on water quality for local watersheds keywords climate assessment tool local watersheds hspf rainfall nutrient load 1 introduction since last century increasing climate variability has resulted in modifications of intensity frequency duration and timing of extreme weather events ipcc 2012 in addition to increasing air temperature such change has caused variations in amount intensity and distribution of precipitations along with increasing frequency of extreme events such as floods and droughts praskievicz and chang 2009 ipcc 2012 wasko and sharma 2015 this has been observed in many areas around the world lecce 2000 bates et al 2008 labat 2008 peterson et al 2013 casanueva et al 2014 verma et al 2015 wasko et al 2017 tank et al 2009 argued that air temperature is expected to increase 1 1 6 4 c in 2100 as compared to that in 1900 these authors also speculated that each of the past three decades has been successively warmer than any previous decades based on historical weather records and the decade of the 2000s is the warmest bates et al 2008 stated that very dry land area has been doubled in some parts of the world while heavy rainfall has been increased in other parts of the world since 1970s it is a general consensus that increasing climate variability has discernible effects on agricultural industrial environmental and ecological systems at both global and regional scales ipcc 2012 hydrological processes and surface water quality are vulnerable to climate change through its impact on evapotranspiration surface runoff stream flow water yield soil erosion and nutrient loss estimate of hydrological processes and surface water quality is central to water resource management clean water supply environmental protection and ecological restoration ouyang et al 2015 parajuli et al 2016 to mitigate future climate variability impacts on hydrological processes and water quality water resource managers and decision makers must be able to assess potential threats and propose practices to adapt the future climatic conditions currently projecting changes in hydrologic cycles and water quality have generally been accomplished by using process based watershed models in conjunction with future climate scenario datasets created with climate models including the general circulation models gcms regional climate models rcms and cmip5 coupled model inter comparison project phase 5 chang et al 2001 verma et al 2015 wang et al 2016 alamdari et al 2017 chang et al 2001 assessed the potential impact of climate change on stream flow and nutrient loading in six watersheds of the susquehanna river basin pennsylvania using the generalized watershed loading function with future climate datasets i e air temperature and precipitation from the gcms these authors found that mean annual stream flow and nutrient loads increased for most watersheds but decreased in one watershed that was intensively cultivated and nutrient load slightly decreased in april and late summer for several watersheds as a result of early snowmelt and increasing evapotranspiration shrestha et al 2012 performed a modeling study on climate induced changes in hydrologic and nutrient fluxes at the lake winnipeg watershed canada using swat soil and water assessment tool for a 21 year baseline 1980 2000 and a 20 year 2042 2062 future period with climate data derived from the rcms these authors found that the simulated nutrient loads closely match the dynamics of the future runoff for both nitrogen and phosphorus alamdari et al 2017 assessed the effects of future climate on water quantity and quality in an urban watershed using storm water management model swmm with future precipitation and air temperature data from the rcms for the period from 2041 to 2068 these authors learned that annual runoff volume would increase by 6 5 while total suspended solids total nitrogen and total phosphorus would increase by 7 6 7 1 and 8 1 respectively more recently ajami et al 2017 investigated the nature and frequency of non stationary hydrological response over 166 anthropogenically unaffected catchments in australia these authors found that there are no changes to vegetation in certain type of catchments in a warmer climate while there are significant changes in other types of catchments that are dominantly dependent on whether the catchments are water limited or nutrient limited wang et al 2017 simulated the influence of sea level rise and warming on circulation and water quality of the chesapeake bay with projected climate conditions in 2050 they argued that with a 1 6 1 9 c increase in monthly air temperatures water temperature in the bay is estimated to increase by 0 8 1 c and the summer average anoxic volume is estimated to increase by 1 4 percent li et al 2011 predicted effects of temperature change on water discharge and sediment and nutrient loading in the lower pearl river basin china using the swat model these authors found that sediment load increases by 13 58 when the air temperature increases by 3 c and the inorganic n and p inputs into the estuary have an increasing trend when the air temperature increases from 2 c to 3 c although the above studies have provided invaluable insights into the direction to project the future hydrologic and water quality trends due to increasing climate variability the limitations on using the climate scenario datasets created by gcms rcms and cmip5 are 1 they have low spatial resolution and are somewhat difficult to downscale for local watersheds i e state level or smaller watersheds 2 they are in low temporal resolution e g monthly or annual time intervals and are difficult to disaggregate into daily or hourly interval required by most watershed models and 3 they are not flexible to answer the what if questions for local watersheds in other words while a vast amount of future climate datasets have become available in recent years from the gcms rcms and cmip5 these datasets are at such a low spatial temporal resolution that they may not be accurate and flexible to assess climate variability impacts on local watersheds wang et al 2016 reported that these climate scenario datasets have inaccurate spatial information for example reported to the nearest minute which are particularly problematic in steep mountainous terrain where a medium resolution grid cell would still span climate environments with several hundred meters difference in elevation mohammed et al 2015 found that most of cmip5 datasets fail to capture both the trends and variability observed in historical precipitation for a watershed with a drainage area of 360 km2 in the winooski basin huc 02010003 which is a multi state and bi national basin vermont new york and québec additionally these climate datasets do not have flexibility to answer the what if questions for local watersheds which are fundamental to the state and local water resource managers and stakeholders for example state and local water resource managers would like to know what will happen to stream flow and surface water availability for a given local watershed if the extreme precipitation events e g very dry summers and wet winters occur in the next 10 years so that they can implement practices to adapt for the changing climatic conditions with the pre set climate scenario data from the gcms rcms and cmip5 these what if questions are difficult to answer therefore an alternative approach is needed to circumvent these obstacles to this end the us epa climate assessment tool cat is chosen in this study cat was included in the basins better assessment science integrating point and nonpoint sources modeling system in 2007 to increase the ability for using basins to perform watershed studies as affected by climate change us epa 2009 cat can be used to easily create climate change scenarios and to quickly answer a wide range of what if questions on how weather and climate could affect hydrological processes and water quality using the hspf hydrological simulation program fortran swat and swmm models more specifically climate change scenarios can be established with cat through modifying the historical temperature and precipitation data to reflect the possible future changes us epa 2009 however a thorough literature search revealed that very few study has been devoted to using cat for analyzing climate change impacts on hydrological processes zhou et al 2017 and no effort has been currently made to analyze surface water quality using cat the goal of this study was to apply cat to project future climate variability impacts on nutrient load for local watersheds specific objectives of this study were to 1 develop a site specific basins hspf model using the lower yazoo river watershed lyrw a local watershed in mississippi usa as a case study 2 calibrate and validate the model with field measured data and 3 apply the resulted model in conjunction with cat to assess stream discharge and nitrate nitrogen no3 n and orthophosphate po4 loads in the lyrw as affected by potential air temperature and rainfall variations due to climate change 2 materials and methods 2 1 study site the lyrw is located within four mississippi counties sharkey issaquena yazoo and warren south of yazoo river basin yrb mississippi with an area of 618 km2 fig 1 a this watershed consists of 61 forest land and 31 agriculture land with soil types of sand loam and clay and is a highly productive agricultural area known for its cotton corn soybeans rice and catfish mdeq 2008 selection of this watershed was based on the following two reasons 1 there are field measured data available for model calibration and validation and 2 this watershed is small and is difficult to use the low spatial temporal resolution climate scenario datasets from the gcms rcms and cmip5 surface water pollution within the lyrw includes excess nutrients and sediments which are the results of storm water runoff discharge from ditches and creeks aquatic weed control and atmospheric deposition nett et al 2004 shields et al 2011 ouyang et al 2013 the degradation of water quality has resulted in altered species composition and decreased the overall health of aquatic communities in the lyrw ouyang et al 2015 2 2 cat description although an elaborate description of the basins and hspf models is not necessary because they are the widely used watershed models in the world a moderate description of the cat model is however warranted because the model is not yet common in the literature cat is basically used to adjust historical precipitation and air temperature time series input data to create climate change scenarios for the hspf swat or swmm model for precipitation cat can be used to modify all values daily or hourly by a specified constant or factor the values within a selected period month or season of every year and all events within a specified event class precipitation events can also be randomly added or removed to represent changes in precipitation event frequency for air temperature cat can be employed to modify full historical records and regenerate evapotranspiration et record add or subtract a constant or factor to a specified season and regenerate et and increase or decrease values occurring within a specified time period years and within the full record by a specified constant or factor the standard output files of hspf swat or swmm simulations can be saved for later analysis detailed description of the cat model can be found in its user s manual epa 2009 it should be pointed out that cat is a tool for modifying model inputs and saving model outputs and is very similar to a pre and post processor cat does not perform downscale or disaggregation of input data 2 3 hspf model and data acquisition procedures in developing a hspf model within basins include 1 watershed delineation this process requires to establish a digital elevation model dem create the stream networks in shape files and generate watershed inlets or outlets using the basins watershed delineation tool 2 land use and soil type determination this was accomplished by using the land use and soil classification tools in basins 3 mathematical description of the watershed processes and preparation of input meteorological and hydrological time series data bicknell et al 2001 hspf model is a lumped parameter model with a modular structure three modules are used in this study the perland modular is for pervious land segments over which an appreciable amount of water infiltrates into the ground the implnd modular is for impervious land segments over which infiltration are negligible such as paved urban surfaces the rchres modular is for the processes occurring in water bodies like streams and lakes these modules have several sub modules dealing with the hydrological processes biological and chemical reactions et soil water storage and water quality detailed information about the structure and functioning of these modules can be found in bicknell et al 2001 fig 1b shows the hspf model for the lyrw developed in this study we have used the similar approaches previously ouyang et al 2013 2015 major input data used in this study included land use soil type topography precipitation air temperature solar radiation and discharge they are from the national hydrography dataset us geologic survey usgs national water information system and the 2001 national land cover data these data can be downloaded directly from the metadata section of basins the resolution of dem for this model was 30 m and the precipitation air temperature solar radiation and simulation time step were in hourly intervals 2 4 hspf calibration and validation a model calibration is to modify input parameter values within an acceptable range to have a good fit between the field observations and the model simulations whereas a model validation is to verify the calibrated model by comparing the field observations and the model predictions without changing any input parameter values in this study the stream discharge as well as the no3 n and po4 concentrations from the hspf model were used for model calibration and validation the field observed daily discharge and concentration data from 2000 to 2005 were used for model calibration whereas an independent set of field observed daily discharge and concentration data from 2006 to 2009 were employed for model validation a similar approach was used previously for the same watershed ouyang et al 2013 2015 parajuli and ouyang 2013 except that more field measured data and statistical measures were used in this study to calibrate and validate the hspf model fig 2 shows the observed and predicted daily stream discharges as well as no3 n and po4 concentrations left hand side for the simulation period from january 1 2000 to december 31 2005 as the values of r2 and nse nash sutcliffe efficiency were respectively 0 69 and 0 68 for daily stream discharge 0 89 and 0 58 for daily no3 n concentration and 0 88 and 0 51 for daily po4 concentration we concluded that good agreements were gained between the model predictions and the field observations during model calibration the goodness of fit was further estimated graphically by comparing the peaks and valleys of daily discharge and concentrations as shown on the right hand side of fig 2 the daily peaks and valleys from model predictions matched reasonably well graphically with field observations daily stream discharge and no3 n and po4 concentrations between the field observations and the model predictions during model validation from january 1 2006 to december 31 2009 is shown on the left hand side of fig 3 with reasonable values of r2 and nse we showed that good agreements were achieved between the model predictions and the field observations during the model validation a visual estimate of the peaks and valleys of daily discharge and no3 n and po4 concentrations shown on the right hand side of fig 3 further confirmed that the model was reasonably validated 2 5 simulation scenarios to estimate the impacts of potential future rainfall and air temperature variations on no3 n and po4 loads in the lyrw four simulation scenarios were chosen in this study comparison of simulation results among these four scenarios allowed us to evaluate the potential impacts of future air temperature and rainfall variations due to climate change upon the daily and annual stream discharge and no3 n and po4 loads the first scenario base scenario was chosen to predict daily and annual no3 n and po4 loads with historical air temperature and rainfall data over a 10 year simulation period from 2000 to 2009 with an hourly time step the input data used in this scenario were the same as those used for model validation above more specifically the meteorological data such as rainfall rate air temperature relative humidity and solar radiation are the measured hourly data at the lyrw cat was not used for this base scenario because we did not modify the meteorological data the second scenario was the same as the first scenario except that the rainfall rates during the 10 year simulation period were increased by 20 from the historical data at an increment of 5 for each run i e a total of four simulation runs this was accomplished through the following steps fig 1c 1 open the cat from analysis toolbar in the basins program 2 open the based model file cat2017 uci for hspf model and type the new model file rainnew 3 click add to create the new rainfall input data the phrase rain new multiple from 1 to 1 2 step 0 05 means that the original historical rainfall data for the entire simulation period were increased to 20 at the interval of 5 detailed instructions on how to set up a cat modeling scenario are beyond the scope of this study but can be found in the cat user manual epa 2009 this second scenario was chosen to somewhat reflect the future rainfall trend because the amount of rainfall in mississippi tended to increase over the past 100 years based on weather records the third scenario was the same as the first scenario except that the air temperature and rainfall rate were increased simultaneously more specifically when the air temperature increased by 1 0 c from the historical data the rainfall rate was assumed to increase by 10 from its historical data whereas when the air temperature increased by 2 0 c from the historical data the rainfall rate was presumed to increase by 20 from its historical data although it is a general consensus that an increase in air temperature would couple with an increase in rainfall rate in sub tropical and tropical regions ipcc 2012 we do not know exactly how much the rainfall rate would increase when the air temperature increases by 1 or 2 c for this local watershed therefore this scenario was chosen to estimate the what if conditions regarding the potential air temperature increase the fourth scenario was somewhat complicated and was the same as the first scenario except that the extreme rainfall events were added to the historical data in summer months i e june july and august in mississippi summer is the crop growth and harvesting season and extreme rainfall events are harmful to crop productions and stream water quality understand these what if conditions would provide useful information to farmers and water resources managers the extreme rainfall events were established using the cat as follows increased the rainfall rate by 10 from the historical rainfall data in summer of each year and checked to see if the total volume of the rain water after increase for that summer exceeded 10 of the total volume of historical rain water if this is true then the rainfall rate for that summer was increased to 20 and was used as an extreme rainfall event for simulations similar set up can be found in the cat user manual and interested readers are recommended to consult the manual for details 3 results and discussion 3 1 rainfall impact daily changes in rainfall rate stream discharge and no3 n and po4 concentrations at the rainfall rates increased by 0 base 10 and 20 over a simulation period from 2000 to 2009 in the lyrw are shown in fig 4 noted that simulation results at 5 and 15 increases in rainfall rate are not shown for better graphical clarity overall the peaks of the stream discharge fig 4b related very well to those of rainfall fig 4a despite the increase in stream discharge was not proportional to the increase in rainfall rate for instance the daily discharge on may 14 2008 was 77 000 m3 s when the rainfall rate was unchanged base scenario but was 88 700 m3 s when the rainfall rate increased by 10 fig 4b in other words an increase in rainfall rate by 10 increased the stream discharge by 15 2 this occurred because the daily stream discharge depended not only on rainfall rate but also on watershed hydrogeological conditions generally the steeper slope narrower stream channel larger drainage area and lesser tree and grass covered land would generate higher stream discharge in contrast the daily no3 n concentration in general decreased as the rainfall rate increased fig 4c for example the daily no3 n concentrations were 0 49 0 43 and 0 37 mg l respectively as the rainfall rate increased by 0 base 10 and 20 on may 14 2008 it was assumed that no additional sources of n were added to the watershed during the entire period of simulation from 2000 to 2009 in this study therefore the decrease in daily no3 n concentration as the rainfall rate increases could be attributed to the dilution effect the more rainwater was added the lower the no3 n concentration was in the stream mixed results were obtained for the po4 concentration in the stream as the rainfall rate increased that is as the rainfall rate increased the po4 concentrations in the stream increased for some dates decreased for other dates and were unchanged for the rest of the dates fig 4d for instance the daily po4 concentrations were 0 0594 0 0694 and 0 0822 mg l respectively as the rainfall rate increased by 0 base 10 and 20 on august 20 2003 but were 0 025 0 0245 and 0 0241 mg l respectively as the rainfall rate increased by the same percentage levels on october 19 2007 the daily po4 concentration was unchanged 0 012 mg l when the rainfall rate increased by 0 base 10 and 20 on june 28 2005 these mixed results occurred likely due to dilution and desorption of po4 as the rainfall rate increased unlike the case of no3 n which has little adsorption in the soil because of its negative charge desorption of po4 from the soil happens when the rainwater wets the soil overall the dilution reduced while desorption released po4 into the stream annual stream discharge and no3 n and po4 loads from the lyrw at the rainfall rates increased by 0 base 10 and 20 are shown in fig 5 it is apparent that an increase in rainfall rate increased the annual stream discharge as an example the 10 and 20 increases in rainfall rate from the historical data increased respectively the annual stream discharge by 12 2 and 24 7 in 2000 fig 5a this was so because the increase in rainfall rate enhanced surface runoff and added more water for stream discharge analogous to the case of stream discharge the annual no3 n and po4 loads increased as the rainfall rate increased fig 5b and c a 10 increase in rainfall rate increased the no3 n and po4 loads in 2000 by 9 1 and 12 2 respectively this occurred because more volume of water containing the no3 n and po4 masses discharged out of watershed outlet as the rainfall rate increased over a 10 year simulation period the 10 and 20 increases in rainfall rate respectively increased stream discharge by 11 and 22 no3 n load by 9 1 and 18 and po4 load by 12 and 24 therefore a potential future wet climate could have discernable impacts on stream discharge and no3 n and po4 loads at the lyrw watershed efforts should be given to mitigate discharge and nutrient loads in the streams at this watershed 3 2 impacts of coupled air temperature and rainfall annual changes in stream discharge and no3 n and po4 loads for the following three conditions 1 the base case 2 increased air temperature by 1 0 c and rainfall rate by 10 and 3 increased air temperature by 2 0 c and rainfall rate by 20 scenario 3 over a simulation period from 2000 to 2009 in the lyrw are shown in fig 6 an 11 increase in annual stream discharge was found when the air temperature increased by 1 0 c and the rainfall rate increased by 10 fig 6a as compared to a 12 2 increase in annual stream discharge when only the rainfall rate increased by 10 scenario 2 and fig 5a this occurred because of more evapotranspiration et loss of water in the lyrw due to an increase in air temperature which reduced surface water runoff and soil water seepage into the streams simulation results further revealed that there was 19 increases in annual stream discharge when the air temperature increased by 2 0 c and the rainfall rate increased by 20 results suggested that a two fold increase in air temperature and rainfall rate did not increase the annual stream discharge by two times rather than 19 11 1 7 times this was because a two fold increase in air temperature would enhance et loss of water analogous to the case of the annual stream discharge changes in annual no3 n and po4 loads were significant as the air temperature and rainfall rate increased fig 6b and c more specifically there were 12 and 14 increases in annual no3 n and po4 loads respectively when increasing the air temperature by 1 0 c and rainfall rate by 10 while there were 15 and 18 increases in annual no3 n and po4 loads respectively when increasing the air temperature by 2 0 c and rainfall rate by 20 apparently the increases in both air temperature and rainfall rate had discernable impacts on no3 n and po4 loads the 10 year stream discharge and no3 n and po4 loads are shown in fig 7 overall the decadal stream discharge and no3 n and po4 loads increased as the air temperature and rainfall rate increased there were 8 12 and 14 increases in annual discharge no3 n load and po4 load respectively when increasing the air temperature by 1 0 c and rainfall rate by 10 while there were 15 20 and 26 increases in annual discharge no3 n load and po4 load respectively when increasing the air temperature by 2 0 c and rainfall rate by 20 3 3 extreme event impact monthly changes in stream discharge and no3 n and po4 loads for extreme rainfall events over the 10 year simulation period from 2000 to 2009 at the lyrw are shown in fig 8 the extreme rainfall events were added by modifying the historical data in summer months i e june july and august each year if the rainwater volume to be added exceeded 10 of rainwater volume for that summer if this condition was true the rainfall rate for that summer was modified to increase by 20 from the historical data at an increment of 10 for each run these extreme rainfall events were calculated and created using the cat simulation results showed that there were four times namely the summers of 2001 2004 2008 and 2009 when the extreme rainfall events occurred with dramatic changes in monthly stream discharge and no3 n and po4 loads fig 8 there were respectively 36 and 72 increases in monthly stream discharge 31 and 63 increases in monthly no3 n load and 41 and 86 increases in monthly po4 load as the rainfall rate increased by 10 and 20 when the extreme rainfall events occurred in june 2004 fig 8a it is apparent that extreme rainfall events had tremendous impacts on stream discharge and nutrient load this information is very important for local water resource managers stakeholders and farmers for adapting management practices to account for potential climate variability with the help of cat such what if questions can be easily answered results suggest that cat is a useful tool for estimating climate change impacts on watershed hydrology and water quality it should be pointed out that the future climate scenario datasets created by gcms and rcms are not only in low spatial resolution but also in low temporal resolution that is these datasets are normally in monthly or annual interval for most watershed models a daily time step e g swat or hourly time step e g hspf is required to meet this time step requirement the monthly precipitation and air temperature data are disaggregated and downscaled into daily or hourly data with great uncertainty and inaccuracy for a local watershed simulations using these downscale and disaggregate data as inputs may not be appropriate therefore it would be a good idea to use the gcms and rcms climate scenario datasets to assess future climate change impacts on hydrological processes and water quality for global and regional river basins and to use cat to create climate scenario datasets for the same assessment for local watersheds 4 summary and conclusions the climate assessment tool cat along with hspf model in the basins modeling system was applied to assess the impact of potential rainfall and air temperature variations due to climate change upon hydrological processes and water quality in the lyrw mississippi in addition to the base simulation scenario three more simulation scenarios were chosen to investigate impacts of increasing air temperature and increasing rainfall rate and or extreme events upon no3 n and po4 loads in the lyrw in general the daily no3 n concentration decreased as the rainfall rate increased when no additional source of n was added to the watershed such a decrease was attributed to the dilution effect as the rainfall rate increased in contrast the daily po4 concentration could increase or decrease as the rainfall rate increased and this occurred because of the dilution and desorption of po4 the dilution reduced while desorption released po4 into the stream a potential future wet climate could have discernable impacts on stream discharge and no3 n and po4 loads in the lyrw watershed the increases in both air temperature and rainfall rate had very significant impacts on no3 n and po4 loads extreme rainfall events had tremendous impacts on stream discharge and no3 n and po4 loads this information is very important for local water resource managers stakeholders and farmers for adapting management practices to account for potential climate variability for local watersheds simulations using the gcms and rcms climate scenario datasets as inputs may not be appropriate because they have low spatiotemporal resolution and are not flexible with the help of cat such obstacles could be circumvented results suggest that cat is a useful tool for estimating climate change impacts on local watersheds which can be extended to other watersheds in the larger scale based on availability of data acknowledgements the study was supported by usda nifa afri competitive grant program project 2013 67020 21407 and 2017 67020 26375 the views expressed in this article are those of the authors and do not necessarily reflect the views or policies of the united state department of agriculture and the u s environmental protection agency 
