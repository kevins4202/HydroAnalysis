index,text
20520,the accurate and real time detection of moving ships has become an essential component in maritime video surveillance leading to enhanced traffic safety and security with the rapid development of artificial intelligence it becomes feasible to develop intelligent techniques to promote ship detection results in maritime applications in this work we propose to develop an enhanced convolutional neural network cnn to improve ship detection under different weather conditions to be specific the learning and representation capacities of our network are promoted by redesigning the sizes of anchor boxes predicting the localization uncertainties of bounding boxes introducing the soft non maximum suppression and reconstructing a mixed loss function in addition a flexible data augmentation strategy with generating synthetically degraded images is presented to enlarge the volume and diversity of original dataset to train learning based ship detection methods this strategy is capable of making our cnn based detection results more reliable and robust under adverse weather conditions e g rain haze and low illumination experimental results under different monitoring conditions demonstrate that our method significantly outperforms other competing methods e g ssd faster r cnn yolov2 and yolov3 in terms of detection accuracy robustness and efficiency the ship detection results under poor imaging conditions have also been implemented to demonstrate the superior performance of our learning method graphical abstract keywords maritime surveillance system maritime safety management ship detection computer vision convolutional neural network cnn 1 introduction owing to the received visual data with more meaningful information shore based surveillance cameras have attracted significant attention in the security and surveillance of maritime environment it is naturally beneficial for marine accident investigation enhancing traffic safety and maritime monitoring el darymli et al 2013 in real world imaging conditions the visual image quality is often degraded due to the adverse weather conditions e g rain haze and low illumination etc the visual degradation easily leads to negative influences on vessel traffic safety and security in addition the high quality imaging enabled accurate and real time detection of moving ships has become an essential component in maritime video surveillance many efforts have thus been devoted to implementing low visibility enhancement and ship detection under different imaging conditions it is well known that the ship detection robustness and accuracy would be easily reduced due to the visually degraded images under adverse weather conditions nie et al 2019 to guarantee high quality images the hybrid regularized variational method shu et al 2019 compensation textures zhang et al 2021 and fusion strategy ma et al 2016 have been developed for dehazing maritime water alike scenes to reconstruct images under low illumination conditions the two step illumination estimation method yang et al 2019 and deep learning guo et al 2020 contributed to enhancing low light images the restoration of rain degraded images using emerging convolutional neural network cnn rao et al 2021 recurrent neural network rnn ren et al 2020 and conditional generative adversarial network cgan zhang et al 2020 is naturally beneficial for enhancing automatic maritime surveillance under rainy conditions from a theoretical point of view the enhanced visual quality is potentially able to promote ship detection which plays an important role in intelligent maritime surveillance system a large number of object detection techniques have been recently presented under different imaging scenarios such as urban road teo and chiu 2015 underwater lee et al 2012 and sky imagery bazi and melgani 2018 etc it is difficult to adopt these methods to detect moving ships since the observed maritime images are essentially different from other types of imaging scenes due to the water specific influences e g water surface reflection waves and ship wakes etc prasad et al 2017 with the extensive use of high performance graphics processing unit gpu deep learning based object detection methods have significantly outperformed traditional ones zhao et al 2019 these traditional methods are strongly dependent on the hand crafted features which are sometimes unstable and inapplicable in practice in current literature the learning based methods could be widely classified into two types i e two stage and one stage frameworks for example r cnn girshick et al 2014 and its accelerated extensions i e fast r cnn girshick 2015 and faster r cnn ren et al 2017 are the representative two stage proposal based detection methods however these two stage methods still suffer from high computational cost leading to unreal time object detection to overcome this limitation the typical one stage detectors mainly include single shot multibox detector ssd liu et al 2016 yolov1 redmon et al 2016 yolov2 redmon and farhadi 2017 and yolov3 redmon and farhadi 2018 etc they could guarantee a good balance between detection efficiency and accuracy under adverse weather conditions e g rain haze and low illumination etc the existing image restoration methods have obviously improved the visual image quality however it is impossible to perfectly recover the degraded images due to the inevitable loss of detailed features based on these restored images the ship detection robustness and accuracy will then be reduced accordingly to make detection more robust under different imaging conditions a flexible data augmentation strategy with generating synthetically degraded images will be developed to enlarge the volume and diversity of original dataset to train our learning based detection method in addition to further improve detection accuracy we will propose an extension of yolov3 by redesigning the sizes of anchor boxes introducing the soft non maximum suppression and predicting the localization uncertainties of bounding boxes according to the proposed data augmentation and learning based detection method there is a huge potential to obtain satisfactory ship detection results with higher accuracy robustness and efficiency in conclusion given the current achievements our learning based ship detection significantly differs from previous studies in the following aspects we resign the sizes of anchor boxes predict the localization uncertainties of bounding boxes and exploit the soft non maximum suppression to yield more spatially accurate detection results a mixed loss function is reconstructed to handle the inter class imbalance problem during network training the ship detection accuracy and robustness can be improved accordingly a flexible data augmentation strategy with synthetically degraded images is proposed to significantly improve the learning and generalization capabilities of our detection network experimental results on different imaging conditions have demonstrated our superior ship detection performance in terms of accuracy robustness and efficiency to evaluate the detection performance we will compare the proposed method with several state of the art methods extensive experiments will be performed to illustrate that our method could significantly outperform other competing methods in terms of detection accuracy robustness and efficiency the remainder of this paper is organized as follows in section 2 we will briefly review the current studies on object detection under different imaging scenarios section 3 proposes the enhanced ship detection framework based on traditional yolov3 network experimental results on several imaging conditions are comprehensively implemented in section 4 we finally conclude the main contributions of this work in section 5 2 related works 2 1 cnn based object detection in natural images in current literature deep cnn based object detection methods can be generally classified into two categories i e two stage and one stage detectors we will briefly review the recent studies on these learning based object detection methods in this work it is obvious that the two stage detectors require two steps to obtain the trained learning model the typical two stage r cnn girshick et al 2014 first adopts the edge boxes algorithm to generate object bounding box proposals the cnn then classifies these proposal regions which are extracted from the original image and resized the final region proposals are commonly refined using the popular support vector machine svm which is trained through cnn based features however r cnn often suffers from long computational time and improper candidate region proposals to eliminate these drawbacks girshick 2015 proposed a faster detection method called fast r cnn which exploited the region of interest roi pooling layer and shared the computations across all proposals compared with the r cnn it enables faster and more accurate detection results as a modification of fast r cnn faster r cnn ren et al 2017 has received more attention and produced more satisfactory detection its superior performance mainly benefits from the region proposal network rpn and fast r cnn which are respectively adopted to generate region proposals and detect objects other extended versions e g domain adaptive faster r cnn chen et al 2018 and few shot adaptive faster r cnn wang et al 2019b etc have also been proposed leading to achieving reliable detection results in contrast the one stage detectors directly transform the problem of bounding box location into a regression problem redmon et al 2016 proposed the yolov1 algorithm based on image global information which can obtain acceptable accuracy with a lower computational cost however compared with the region proposal based detection methods yolov1 has several drawbacks such as inaccurate location lower recall rate and unsatisfactory detection results for overlapping or tiny objects liu et al 2016 proposed a single shot multibox detector i e ssd which exploited cnn to directly detect and extract feature maps of different scales furthermore tian et al 2019 proposed a pixel by pixel object detection algorithm which produced an anchor free and proposal free solution other detection methods law and deng law et al duan et al 2019 zhou et al 2019 which were developed based on detecting key points and matching them could obtain better detection results without anchor boxes in addition fu et al 2021 presented an anchor free detection method which combined feature balancing and refinement network to detect multiscale ships under complex conditions a fully convolutional one stage object detector fcos was then developed to handle object detection in a per pixel prediction tian et al 2019 the introduced feature selective anchor free fsaf could effectively eliminate the limitations brought by conventional anchor based detection methods zhu et al 2019a the fsaf module could be adopted alone or combined with the results of anchor based branch to directly learn the bounding box coordinates without anchor reference kong et al 2020 proposed a flexible and anchor free framework i e foveabox to make object detection easier in practice redmon and farhadi 2017 proposed the yolov2 which added batch normalization bn layer and anchor boxes the k means clustering wagstaff et al 2001 was exploited to calculate better anchor ratio during training to further improve the detection accuracy of yolov2 redmon and farhadi 2018 proposed the yolov3 which has gained increasing attention recently this object detector proposes to replace the softmax layer with logistics layer experimental results show that yolov3 has higher detection accuracy and shorter computational time compared to other object detection methods 2 2 ship detection in maritime surveillance system accurate and reliable ship detection plays an important role in maritime video surveillance system in current literature extensive efforts have been undertaken to automatically detect moving ships for example stauffer and grimson 2002 constructed the gaussian mixture model to replace the traditional single gaussian model to estimate the background a novel hierarchical complete approach was presented based on shape and texture features for ship detection from spaceborne optical images zhu et al 2010 based on sea surface analysis yang et al 2014 proposed to automatically detect ships in high resolution optical satellite images the shape and context information were then combined for detecting inshore ships liu et al 2014 zhang et al 2017 proposed a ship target detection framework based on discrete cosine transform dct which mainly included three stages i e horizon detection background modeling and background subtraction it is able to guarantee robust detection results under complicated sea surface background with large waves in addition the low rank tensor completion with top hat regularization was developed to detect infrared small targets zhu et al 2019b the structured sparse representation model has also been presented to automatically detect inshore ships from high resolution optical remote sensing images zhuang et al 2020 it is well known that real time ship detection is essentially an important foundation for improving the efficiency of maritime surveillance however due to the severe imaging weather environments e g rain haze and low lightness in maritime applications traditional ship detection methods commonly suffer from inaccurate detection and long computational time etc therefore it is intractable to accurately and real timely detect moving ships using these methods in maritime applications owing to the powerful feature extraction and generalization capabilities cnn has been successfully exploited to automatically detect ships under different environments for example wu et al 2018 developed a cnn based inshore ship detection framework which could obtain the location of ship heads and the rough ship directions cui et al 2019 proposed a multi scale ship detection based on dense attention pyramid network to better extract abundant features including resolution and semantic information the hierarchical selective filtering layer was introduced to map elements of different scales to the same scale space li et al 2018 the ship targets were then detected in high resolution optical remote sensing images kim et al 2018 proposed a faster r cnn based probabilistic ship detection and classification system to obtain accurate and efficient detection results shao et al 2019 presented a saliency aware cnn framework which included deep feature saliency map and coastline prior etc for real time ship detection in surveillance video in the literature wang et al 2020a lightweight cnn and multisource feature cascade decision were combined to perform ship detection in spaceborne infrared images to further improve detection performance the spatial shuffle group enhance attention was developed to automatically detect ships in large scale synthetic aperture radar sar images cui et al 2021 learning enabled ship recognition and tracking have also gained significant attention chen et al 2020 2019 leading to intelligent maritime surveillance to investigate the influences of severe weather conditions on ship detection nie et al 2019 first adopted the synthetically degraded images to enlarge the training datasets and then exploited the yolov3 to guarantee robust detection of different types of ships in this work we will extend the yolov3 based ship detection framework according to the following aspects i e redesigning the ratios of anchor boxes predicting the uncertainty of bounding box location and exploiting the soft non maximum suppression snms leading to more accurate and robust ship detection in maritime surveillance system the ablation experiments and detection results will be implemented to illustrate the superior performance of our method under different weather conditions 3 the proposed cnn enabled ship detection framework 3 1 network architecture the flowchart of our learning based ship detection framework is shown in fig 1 the input images are collected using the video empowered maritime surveillance system the detection results are beneficial for marine accident investigation enhancing traffic safety and maritime monitoring etc the detection performance is highly dependent upon the feature extraction ability of our enhanced yolov3 network the detection module of our enhanced yolov3 network in each scale is composed of convolutional layers with different filtering kernels of size 3 3 and 1 1 the 3 3 convolutional layer extracts meaningful image features which increases network channels and refines local features the 1 1 convolutional layer is expected to adjust the number of channels to compress the feature maps and reduce the amount of calculation these two kinds of convolutional kernels make our deep network achieve a satisfactory balance between feature extraction and computational cost similar with traditional yolov3 the batch normalization bn layer huang et al 2018 is embedded after each convolutional layer to improve the training speed and accuracy after the bn layer we tend to add the leaky relu activation function wang et al 2019a to avoid the network degradation and gradient vanishing exploding problems in video empowered maritime surveillance system the obtained ships of interest are often too small to be detected due to the limited resolution of video camera to guarantee high quality detection results we propose to adopt the multi scale network to improve the detection of small scale moving ships with higher average precision to be specific we will redesign the sizes of anchor boxes in section 3 2 and introduce the gaussian modeling to predict the localization uncertainties of bounding boxes in section 3 3 in addition the soft non maximum suppression strategy will be exploited in section 3 4 to alleviate the image overlap detection problem the proposed loss function is capable of handling the inter class imbalance problem during network training in section 3 5 benefiting from these strategies our enhanced yolov3 has the capacity to real timely detect moving ships with more reliable robust and accurate results in practical maritime scenarios 3 2 redesigning the sizes of anchor boxes the proposed enhanced yolov3 is essentially an anchor box based detection method it is thus necessary to pre define the numbers and sizes of anchor boxes before network training according to the statistical results from the pre selected ship dataset i e seaships shao et al 2018 we could observe that the sizes of different types of ships vary greatly and all ships appear in elongated shapes shown in fig 2 to improve ship detection results the ratio of width to height should be tremendously larger than 1 however traditional yolov3 commonly has the properties of square shaped anchor boxes or large ratio of height to width it is thus intractable to generate accurate ship detection using these prior anchor boxes adopted in traditional yolov3 to overcome these limitations we propose to redesign the sizes of anchor boxes to make ship detection more reliable and accurate generally more prior anchor boxes could generate more detection results but leading to much higher computational cost motivated by pioneering work redmon and farhadi 2018 we can adopt the intersection over union iou to determine the number of anchor boxes to guarantee the trade off between detection accuracy and computational load 3 different scales and 3 different aspect ratios are chosen to form 9 prior anchor boxes in our experiments in particular our detection network directly adopts the popular k means cluster to generate 9 priors whose width and height belong to the small scale type i e 0 072917 0 034259 0 146875 0 060185 0 203646 0 100926 middle scale type i e 0 273958 0 065741 0 317188 0 173148 0 350521 0 111111 and large scale type i e 0 504688 0 233333 0 578125 0 137963 0 811458 0 251852 respectively the comparisons of normalized width and height between original and redesigned anchor boxes are visually illustrated in fig 3 note that different feature maps naturally correspond to different sizes of prior anchor boxes the learning and generalization abilities of our network could be promoted accordingly leading to enhanced ship detection results 3 3 predicting the localization uncertainties of bounding boxes in original yolov3 each grid corresponds to 3 predicted bounding boxes where each box includes the bounding box coordinates i e t x t y t w and t h detection score and class scores in particular the detection score indicates whether a ship is present or not within the bounding box the class score between 0 and 1 determines the probability of a ship belonging to a certain class the ship of interest can thus be detected through the product of detection and class scores it is well known that the bounding box coordinates are specific coordinate values in yolov3 failing to represent the bounding box uncertainties the confidence of detected bounding box is thus indeterminate leading to limited improvement in ship detection motivated by previous work choi et al 2019 we propose to introduce a single gaussian function to model the localization uncertainties of predicted bounding boxes given a test input x the output y contains the following gaussian parameters i e 1 p y x n y μ x σ x where n denotes the single gaussian function with μ and σ being the mean and variance functions respectively as illustrated in fig 4 the coordinates of predicted bounding boxes in the feature maps are represented using the mean μ and variance σ functions in particular the corresponding outputs are composed of μ ˆ t x σ ˆ t x μ ˆ t y σ ˆ t y μ ˆ t w σ ˆ t w μ ˆ t h and σ ˆ t h the parameters i e t x t y t w and t h in the single gaussian model can be pre processed using μ t x δ μ ˆ t x μ t y δ μ ˆ t y μ t w μ ˆ t w μ t h μ ˆ t h σ t x δ σ ˆ t x σ t y δ σ ˆ t y σ t w δ σ ˆ t w and σ t h δ σ ˆ t h with δ x 1 1 exp x being the sigmoid function in our ship detection network the predicted coordinates of bounding boxes are related to the mean values of spatial coordinates in the detection layers the variance values correspond to the uncertainties of predicted bounding boxes it is worthy noting that the overall computational complexity will not increase significantly since the single gaussian function is only exploited to model the bounding box coordinates of detection layers choi et al 2019 there is thus a great potential to guarantee robust and accurate ship detection results with high computational efficiency 3 4 exploiting the soft non maximum suppression to achieve high quality detection results the non maximum suppression nms hosang et al 2017 has become an essential part of object detection methods which is able to delete the unnecessary bounding boxes through an overlap criterion in particular the nms algorithm divides the bounding boxes into disjoint subsets and sorts the predicted boxes in each subset according to the detection score for the sake of better understanding the nms algorithm can be written as follows 2 s i s i if iou m b i n t 0 if iou m b i n t where s i is the detection score related to the i th bounding box b i m denotes the bounding box with the maximum score and n t represents the iou threshold in eq 2 the iou denotes the computation of similarity between two arbitrary shapes its mathematical definition is given by iou a b a b a b with a and b representing the bounding boxes in practical applications the distance between ships is relatively close which may cause image overlap and inaccurate ship detection to alleviate this problem our learning framework will be incorporated with the soft non maximum suppression snms bodla et al 2017 instead of the traditional nms in eq 2 in particular the snms includes two different strategies i e piece wise function and gaussian penalty function to weight the scores of bounding boxes in this work to strongly penalize the box b i when the overlap of b i with m becomes close to one we tend to update the detection score s i using the gaussian penalty function i e 3 s i s i exp iou m b i 2 σ b i d where σ 0 1 is a smoothing parameter from a theoretical point of view the snms does not need additional training and can be efficiently executed it can thus be flexibly integrated into our enhanced cnn based ship detection framework without increased computation cost existing studies bodla et al 2017 have demonstrated that the snms could enable noticeable improvements in both detection accuracy and robustness 3 5 reconstruction of mixed loss function the loss function in original yolov3 is only composed of binary cross entropy bce and squared sum error sse to evaluate the bounding box localization and classification results tian et al 2020 however due to the imbalance of training samples the loss function is easily dominated by numerous negative samples thus resulting in unsatisfactory mislocalization and misclassification problems in this work we propose to reconstruct a mixed loss function to achieve more robust and effective learning in model training motivated by gaussian yolov3 choi et al 2019 the first part of our mixed loss can be defined through gaussian modeling which is detailedly modeled as a negative log likelihood nll function i e 4 l x i 1 w j 1 h k 1 k χ i j k log n x i j k g μ t x x i j k σ t x x i j k ε 5 l y i 1 w j 1 h k 1 k χ i j k log n y i j k g μ t y y i j k σ t y y i j k ε 6 l w i 1 w j 1 h k 1 k χ i j k log n w i j k g μ t w w i j k σ t w w i j k ε 7 l h i 1 w j 1 h k 1 k χ i j k log n h i j k g μ t h h i j k σ t h h i j k ε where l x l y l w and l h respectively denote the nll losses of t x t y t w and t h coordinates w and h are the numbers of grid centers along width and height axes k is the number of anchors ε 1 0 9 is adopted to avoid numerical instability χ i j k is a parameter at the k th anchor in the i j grid related to whether there is an object for the sake of simplicity we now take only l x as an example in the next description in eq 4 x i j k g denotes the ground truth of t x coordinate in addition μ t x x i j k and σ t x x i j k which are the outputs of the detection layer of our learning method respectively represent the location and uncertainty of t x coordinate at the k th anchor in the i j grid analogous to l x the definitions of other variables in l y l w and l h could be accordingly given similar to the previous work choi et al 2019 the coordinates of each ground truth bounding box can be computed as follows 8 x i j k g x g w i 9 y i j k g y g h j 10 w i j k g log w g w i a k w 11 h i j k g log h g h i a k h where x g y g w g and h g denote the scale ratios of one ground truth bounding box in an image w i and h i represent the width and height after image resizing and a k w and a k h are the width and height of the k th anchor in addition the parameter χ i j k plays an important role in ship detection in this work we propose to calculate χ i j k as follows 12 χ i j k ω scale i i j k obj 2 with ω scale 2 w g h g being computed using the width and height ratios of the ground truth bounding box in an image it is obvious that ω scale yields different weights based on the object sizes during network training in eq 12 i i j k obj is assigned to one if the iou of the ground truth and the k th anchor box achieves the largest value whereas is assigned to zero if there is no suitable ground truth it is well known that ship detection easily suffers from the inter class imbalance problem due to the obtained training dataset to deal with this imbalance problem the focal loss function lin et al 2017 has become an effective solution by reweighting the contribution of easy examples and enhancing the importance of hard examples in our network we propose a focal binary cross entropy fbce loss function to measure the bounding box confidence i e l conf and object classification i e l class i e 13 l conf i 1 w j 1 h k 1 k i i j k obj α 1 c i j k γ log c i j k ε 1 α c i j k γ log 1 c i j k ε 14 l class i 1 w j 1 h k 1 k i i j k obj α 0 1 p i j k γ log p i j k ε 1 α 0 p i j k γ log 1 p i j k ε with 15 c i j k i 1 w j 1 h k 1 k 1 1 exp x i j k and 16 p i j k exp x i j k i 1 w j 1 h k 1 k exp x i j k where γ is the dynamic scaling factor γ 2 c i j k is obtained by compressing x i j k with the sigmoid function p i j k is obtained by normalizing x i j k with the softmax function the dynamic factor α in eq 13 is given by 17 α α 0 c i j k 1 α 0 1 c i j k where α 0 denotes the equilibrium factor regarding the positive and negative samples and ε is a small constant to avoid numerical instability in this work we empirically set α 0 and ε to 0 25 and 10 8 respectively these parameters could guarantee robust learning during network training the proposed fbce loss has the capable of handling the imbalance problem to further improve the accuracy of bounding box localization we will incorporate the concept of generalized intersection over union giou rezatofighi et al 2019 into the mixed loss function different from the giou based loss tian et al 2020 our proposed localization loss l giou is described as follows 18 l giou i 1 w j 1 h k 1 k i i j k obj ω scale 1 g i j k where g i j k represents the giou related to the bounding box localization performance let a and b indicate the ground truth and predicted bounding boxes the giou for comparing similarity between a and b is then given by 19 giou iou c a b c with c denoting the smallest enclosing area for a and b therefore the total loss function l total used in our learning enabled ship detection framework is defined as follows 20 l total l x l y l w l h l conf l class l giou the importances of l x l y l w l h and l giou in guaranteeing detection accuracy and robustness have been confirmed in previous studies choi et al 2019 tian et al 2020 rezatofighi et al 2019 therefore we propose to only investigate the influences of fbce loss i e l conf and l class on ship detection in this work the positive influences will be discussed through the ablation experiments in section 4 3 4 experimental results and analysis we will conduct detection experiments based on tensorflow software library 1 9 0 in ubuntu 18 04 in particular all experiments are carried out on a computer with an intel r core tm i9 10850k cpu 3 60 ghz and nvidia geforce gtx 1080ti gpu in this work we directly exploit the darknet53 network to extract meaningful features for the optimal hyper parameters selected in our network the base learning rate momentum and weight decay are respectively set to 0 0001 0 9 and 0 0005 the other parameters are default values empirically adopted as done in original yolov3 redmon and farhadi 2018 4 1 dataset description and data augmentation we propose to adopt a large scale ship dataset called seaships shao et al 2018 as a training dataset to improve the learning and generalization capacities of our detection network all maritime images are obtained from the video camera surveillance systems the dataset used in this work consists of 7000 images and covers 6 types of ships i e ore carrier bulk carrier general cargo ship container ship fishing boat and passenger ship to further improve ship detection results we propose to exploit the data augmentation methods e g horizontal flipping random translation and random clipping etc to enlarge the original training dataset shown in fig 5 the maritime video surveillance easily suffers from adverse weather conditions e g rain haze and low illumination it is commonly intractable to robustly and accurately detect the moving ships using current learning techniques under these scenarios the traditional methods first restore the degraded images and then directly exploit the learning based ship detection methods however it is impossible to perfectly recover the degraded images due to the loss of detailed features inevitably yielded by image restoration methods in practice in this work we will synthetically simulate the degraded images e g rainy hazy and low light images to improve the volume and diversity of training dataset the learning and generalization capabilities of learning based detection methods will be promoted accordingly the rainy scene could be obtained by adding random rain streaks into original sharp images therefore one synthetically degraded image z x y containing rain streaks can be described as follows 21 z x y j x y b x y for any pixel x y ω here ω is the image domain j x y is the rain free scene i e latent sharp image and b x y denotes the rain streak layer as illustrated in fig 6 we can synthetically generate different styles of rainy images by adjusting the lengths and angles of rain streaks in particular the lengths of rain streaks change between 20 and 80 pixels the angles of rain streaks will be randomly selected from 50 to 50 in our experiments under the hazy environment the presence of haze could degrade the visual quality of images obtained from maritime video surveillance in this work we directly exploit the atmospheric scattering model to model the generation of maritime hazy images i e 22 i x y j x y t x y 1 t x y a where i x y denotes the obtained hazy image j x y is the latent haze free image a is the global atmospheric light and t is the transmission map which decays exponentially with increasing propagation distance i e t x y e β d x y where β is the scattering coefficient and d x y is the distance from the object to the video camera in the maritime surveillance system the synthetically degraded images are visually displayed in fig 7 these different hazy images are generated by adjusting different atmospheric light values a and transmission maps t to enlarge the original training dataset for the sake of simplicity we will synthetically simulate the hazy images using a 0 60 0 65 0 70 0 75 0 80 0 85 0 90 and t 0 1 0 2 0 3 0 4 0 5 low light images refer to the visual data acquired under low illumination conditions the visually degraded images inevitably suffer from several limitations e g low brightness low contrast and detail loss etc in this work the low light maritime images will be synthetically simulated through the retinex theory which assumes that an original image s can be decomposed into the product of reflection r and illumination l i e 23 s x y r x y l x y in eq 23 the reflection r represents the intrinsic property of target objects which can be considered as the latent sharp image it is naturally assumed to be consistent under different lighting conditions the illumination l denotes the various lightness on objects which is spatially smooth to synthetically generate the low light maritime images we first transform the high quality original images from rgb color space into hsv color space the v layer in original images is then multiplied by different attenuation coefficients ω 0 1 leading to visually degraded maritime images as illustrated in fig 8 the synthesized low light images are manually generated with ω 0 1 0 3 and 0 5 respectively 4 2 evaluation criteria to quantitatively evaluate the ship detection results both mean average precision map mean iou miou and frame per second fps are adopted in our experiments in particular the map indicates the detection robustness and accuracy the miou is adopted to evaluate the similarity between the predicted bounding box and the ground truth version the fps represents the computational efficiency of different ship detection methods in particular the map is the most widely used criterion to measure the detection performance the map can be computed by taking the average of ap which is related to the area under the precision recall curve the definition of map is mathematically given by 24 map 1 n n 1 n ap n where the average precision score ap n is calculated for n data folds in this paper the miou is computed by considering the iou of each class and averaging them the definition of iou has been given in section 3 4 the fps represents the number of image frames detected by the learning method in one second theoretically higher map miou and fps values normally indicate more accurate and efficient ship detection results 4 3 ablation experiments as discussed in section 3 our ship detection framework is proposed by taking into consideration several modules e g data augmentation da redesigning the sizes of anchor boxes rsab soft non maximum suppression snms and predicting the localization uncertainties of bounding boxes plubb and focal binary cross entropy fbce loss function in the literature da strategy has received significant attention and its positive effects have been confirmed this work mainly focuses on the influences of rsab snms plubb and fbce on ship detection the ablation experiments will thus be implemented to investigate which one plays more important role in improving detection performance the numerical experiments are detailedly illustrated in table 1 it can be found that the original yolov3 yields the lowest map and miou easily leading to unsatisfactory ship detection results the introductions of both da and rsab are able to obviously enhance the detection accuracy it seems that the improved detection accuracy brought by snms is not obvious however the visual appearance of ship detection will the tremendously enhanced by suppressing the unnecessary anchor boxes the original bounding boxes are mainly represented by two parameters i e mean and variance values the implementation of plubb will increase the amount of calculation time but improve the detection accuracy with increased map of 6 81 the introduced fbce loss function is also able to enhance detection accuracy compared with the original yolov3 our enhanced cnn enabled learning method can significantly improve the map by 12 55 while guaranteeing real time detection results as a consequence the introductions of da rsab snms plubb and fbce are capable of bringing positive effects on improved ship detection results 4 4 comparisons with other detection methods to evaluate the detection performance our method will be compared with several representative methods i e faster r cnn ssd yolov2 and yolov3 these learning methods are trained using the same enlarged dataset without synthetically degraded images in this case our enhanced learning method is called eyolov3 which only considers the rsab snms plubb and mixed loss function the detection results in terms of accuracy and efficiency are detailedly summarized in table 2 the ssd 300 means that it receives input images of 300 300 pixels the similar description can be found in ssd 512 yolov2 416 yolov3 416 eyolov3 416 eyolov3 512 and eyolov3 608 table 2 indicates that faster r cnn can bring higher detection accuracy compared with ssd yolov2 and yolov3 but generates the lowest efficiency both ssd 300 and ssd 512 have improved the detection accuracy but fail to detect the types of moving ships yolov3 416 is capable of real timely detecting the moving ships but leads to slightly lower detection accuracy compared with faster r cnn it is worth noting that our method is able to significantly improve the detection accuracy with real time ability the darknet53 network was used as the backbone structure of our method to train the learning based detection our superior detection performance mainly benefits from the introductions of rsab snms plubb and fbce loss function from a theoretical point of view with the increased sizes of input images e g from 416 416 to 608 608 the detection accuracy i e map and efficiency i e fps will be improved and reduced respectively in the case of 608 608 our eyolov3 608 generates the best detection accuracy and obviously enhances the computational efficiency compared with eyolov3 512 it means that eyolov3 608 enables a better balance between detection accuracy and efficiency we thus directly adopted ours 608 to detect moving ships in other numerical experiments several ship detection results under different monitoring conditions are visually illustrated in figs 9 12 we only compared our proposed eyolov3 i e eyolov3 608 with three typical methods i e ssd i e ssd 512 faster r cnn and yolov3 i e yolov3 416 in maritime applications it is commonly difficult to robustly perform ship detection under complex backgrounds shown in fig 9 the co occurrences of multiple ships in fig 10 small scale ships in fig 11 and large overlapping regions between ships in fig 12 make ship detection more difficult leading to unreliable traffic monitoring in maritime surveillance system compared with traditional natural imaging conditions the light conditions in maritime scenarios are more complicated for example the observed maritime images often suffer from several water specific influences e g water surface reflection waves and ship wakes etc as a consequence both faster r cnn and yolov3 sensitive to the unstable imaging background yield inaccurate detection results as shown in figs 9 and 11 the shoreside and water surfaces have been recognized as the ships of interest due to inadequate high level features ssd fails to accurately detect the ships in the cases of multiple ships in fig 10 and large overlapping regions in fig 12 in contrast our method is able to robustly and accurately detect the moving ships under different surveillance environments the accurate detection results are naturally beneficial for enhancing traffic safety and maritime monitoring in practical applications 4 5 influences of severe weather conditions on ship detection in practical applications the observed maritime images often suffer from adverse weather conditions e g rain haze and low illumination the current learning methods cannot be directly exploited to perform accurate detection under these scenarios although the traditional data augmentation methods e g horizontal flipping random translation and random clipping etc have been introduced to enlarge the original training dataset it is still intractable to achieve satisfactory detection performance under severe weather conditions from a theoretical point of view there are two different strategies i e indirect and direct versions to make ship detection more reliable the indirect strategy first restores the observed degraded images and then detects the moving ships using yolov3 or eyolov3 learned from only sharp images in contrast the direct strategy could efficiently generate ship detection results through the learning methods trained using the enlarged dataset which contains both sharp images and synthetically degraded images this subsection is thus mainly devoted to investigating the influences of different detection strategies on ship detection under severe weather conditions 4 5 1 detection results on synthetic weather conditions the influences of image restoration i e visibility enhancement on ship detection results are detailedly summarized in table 3 a large number of image restoration methods have been proposed to guarantee visual image quality under severe imaging scenarios in this work the rainy images are restored using the progressive recurrent network prenet which is a simpler and better baseline deraining network ren et al 2019 to improve visibility under hazy imaging environments the feature fusion attention network ffa net a simple image to image architecture qin et al 2020 is directly adopted to perform image dehazing the retinex theory based deep neural network i e retinexnet wei et al 2018 is introduced to perform low light image enhancement in particular retinexnet is mainly composed of two components i e decom net and enhance net subnetworks which respectively perform image decomposition and illumination adjustment it is obvious that these representative image restoration methods are capable of enhancing imaging quality leading to improvement in ship detection accuracy shown in table 3 however it is impossible to perfectly restore the degraded images due to the inevitable loss of detailed features in practice the further improvement in detection robustness and accuracy will be accordingly limited based on the restored images which are essentially different from the original sharp images table 4 depicts the influences of data augmentation strategies on ship detection under severe imaging scenes the proposed eyolov3 was trained using the training dataset which contains original sharp images hazy images low light images light rainy images or heavy light images the well trained network was then adopted to detect moving ships in test dataset which contains the similar imaging scenarios shown in training dataset it can be observed that if the training and test dataset include the similar imaging conditions the ship detection accuracy will be tremendously increased this is due to the fact that our data augmentation strategies with synthetically degraded images could essentially promote the volume and diversity of training dataset the learning and generalization abilities of eyolov3 are accordingly improved in practice in contrast the indirect detection framework i e image restoration and eyolov3 has limited the improvement of ship detection network without loss of generality we take the hazy weather conditions as an example our direct detection framework could generate satisfactory results with ap of 91 40 in table 4 whereas the indirect detection framework yields the results with ap of 72 59 under other weather conditions the direct strategy could still produce more accurate ship detection results in addition the indirect strategy often suffers from the high computational cost due to two inevitable implementations i e image restoration and ship detection owing to the direct operation our method i e eyolov3 and ad not only improves the detection accuracy but also potentially shortens the computational time in maritime applications for the sake of better understanding the visual comparisons of different ship detection strategies are illustrated in figs 13 15 it is obvious that the severe weather environments easily cause poor contrast and loss of structural details in degraded images these negative effects could make ship detection more difficult in maritime surveillance system in our numerical experiments the ship detection results generated by the eyolov3 original in figs 13 15 b which directly adopts our eyolov3 to detect ships from original sharp images can be considered as the benchmark with the highest accuracy to achieve reliable detection results under different imaging conditions the ship detection accuracy generated by the competing methods should be as similar as possible to the benchmark under poor imaging scenes both yolov3 and eyolov3 fail to accurately and robustly detect the moving ships shown in figs 13 15 c d it means that the detection accuracy and robustness is highly dependent on the imaging quality to further enhance detection efficacy it is tractable to first restore the degraded images and then directly exploit the existing learning based detection methods as shown in figs 13 15 e the visual image quality has been obviously improved using the state of the art visibility enhancement methods through the implementation of eyolov3 the ship detection accuracy is improved accordingly however it is still impossible to perfectly restore the lossless sharp images from their degraded versions due to the loss of fine details inevitably caused by the visibility enhancement methods 1 1 in theory the loss of fine details could bring negative effects on ship detection in maritime applications therefore the improvement of ship detection accuracy could be limited even the advanced detection methods are implemented for restored images in contrast our eyolov3 ad degraded first trains the eyolov3 using the ad based enlarged training dataset the learning and representation capacities of our eyolov3 could be promoted correspondingly the well trained eyolov3 is then exploited to directly detect different types of ships from the degraded images the detection results shown in figs 13 15 f illustrate that our proposed method is able to accurately detect the moving ships no matter what the imaging conditions are under different weather environments this superior detection performance mainly benefits from the proposed ad strategy the developed modules i e rsab snms plubb and fbce embedded in our eyolov3 framework could naturally promote ship detection in terms of both robustness and efficiency the detection experiments under realistic weather conditions will also be performed to evaluate the robustness and effectiveness of our eyolov3 with ad strategy 4 5 2 detection results under realistic weather conditions it is worthy noting that the realistic image degradation essentially differs from the synthetic operations according to the eqs 21 23 shown in section 4 1 it thus becomes more difficult to accurately detect the moving ships from realistically degraded images in maritime video surveillance in this subsection we will evaluate the effectiveness of our proposed method i e eyolov3 and ad under realistic weather conditions in particular our eyolov3 was trained using the ad based training dataset which includes the sharp images and their synthetically degraded versions experimental results on realistic ship detection produced by our proposed method are visually displayed in fig 16 it can be found that the degraded images obtained under rainy hazy and low light imaging conditions suffer from the low contrast and loss of fine details etc due to the visual quality degradation it becomes intractable to accurately detect the small scale ships and multiple ships benefiting from the proposed ad strategy our eyolov3 is capable of robustly performing ship detection under different imaging conditions owing to the proposed rsab snms plubb and fbce it is able to accurately detect the moving ships even the observed visual quality has been significantly degraded therefore our proposed method has the capacity of robustly efficiently and accurately performing automatic ship detection under poor imaging scenarios the reliable detection results are beneficial for maritime object tracking and abnormal behavior detection leading to enhanced traffic safety and management in intelligent video empowered maritime surveillance system 5 conclusions and future perspectives the robust and accurate detection of moving ships is of importance for guaranteeing traffic safety and security under different imaging conditions in this work we proposed an enhanced cnn enabled learning method to improve ship detection in maritime video surveillance the learning and representation capacities of our network have been promoted by redesigning the sizes of anchor boxes rsab predicting the localization uncertainties of bounding boxes plubb and introducing the soft non maximum suppression snms the proposed mixed loss function is able to handle the inter class imbalance problem during network training to make our network more reliable under adverse weather conditions the data augmentation da strategy was also presented to enlarge the original dataset to train learning based detection methods compared with several representative methods our method could real timely detect different types of moving ships with higher detection accuracy experimental results have also demonstrated our superior detection results under adverse imaging conditions i e rainy hazy and low light environments to make ship detection more reliable and robust the study shown in this paper can be extended along the following directions the proposed data augmentation strategy directly adopted simplified imaging models to generate the synthetically degraded images it should be noted that both tinctorial and structural differences between synthetic and realistic maritime images are significant to further promote ship detection under different imaging conditions the powerful transfer learning pan and yang 2009 and generative adversarial networks creswell et al 2018 could be adopted to produce synthetic images with more natural looking appearance the detection of small scale moving ships is more common and challenging in video empowered maritime surveillance system due to the long distance between the camera and ships of interest it is difficult to capture maritime images with high spatial resolution potentially leading to unsatisfactory detection results to guarantee reliable small scale ship detection before the implementation of ship detection the super resolution methods wang et al 2020b can be first introduced to enlarge the maritime images to make ship targets more sharpen in addition the popular attention mechanism li et al 2020 can also be embedded into existing learning based detection frameworks to promote small scale ship detection in terms of robustness and accuracy although the proposed ship detection method suffers from some inherent limitations it is still worthy of consideration because it could real timely and accurately detect moving ships under adverse imaging conditions we believe our method can be further extended to enhance the maritime traffic safety and management in practical applications credit authorship contribution statement ryan wen liu conceptualization methodology formal analysis supervision validation funding acquisition writing review editing weiqiao yuan methodology resources data curation software writing original draft xinqiang chen formal analysis validation writing review editing yuxu lu data curation software formal analysis validation investigation writing original draft declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the work described in this paper was supported by grants from the hainan provincial joint project of sanya yazhou bay science and technology city china no 520lh057 the national natural science foundation of china no 51609195 and the national key r d program of china no 2018yfc0309602 
20520,the accurate and real time detection of moving ships has become an essential component in maritime video surveillance leading to enhanced traffic safety and security with the rapid development of artificial intelligence it becomes feasible to develop intelligent techniques to promote ship detection results in maritime applications in this work we propose to develop an enhanced convolutional neural network cnn to improve ship detection under different weather conditions to be specific the learning and representation capacities of our network are promoted by redesigning the sizes of anchor boxes predicting the localization uncertainties of bounding boxes introducing the soft non maximum suppression and reconstructing a mixed loss function in addition a flexible data augmentation strategy with generating synthetically degraded images is presented to enlarge the volume and diversity of original dataset to train learning based ship detection methods this strategy is capable of making our cnn based detection results more reliable and robust under adverse weather conditions e g rain haze and low illumination experimental results under different monitoring conditions demonstrate that our method significantly outperforms other competing methods e g ssd faster r cnn yolov2 and yolov3 in terms of detection accuracy robustness and efficiency the ship detection results under poor imaging conditions have also been implemented to demonstrate the superior performance of our learning method graphical abstract keywords maritime surveillance system maritime safety management ship detection computer vision convolutional neural network cnn 1 introduction owing to the received visual data with more meaningful information shore based surveillance cameras have attracted significant attention in the security and surveillance of maritime environment it is naturally beneficial for marine accident investigation enhancing traffic safety and maritime monitoring el darymli et al 2013 in real world imaging conditions the visual image quality is often degraded due to the adverse weather conditions e g rain haze and low illumination etc the visual degradation easily leads to negative influences on vessel traffic safety and security in addition the high quality imaging enabled accurate and real time detection of moving ships has become an essential component in maritime video surveillance many efforts have thus been devoted to implementing low visibility enhancement and ship detection under different imaging conditions it is well known that the ship detection robustness and accuracy would be easily reduced due to the visually degraded images under adverse weather conditions nie et al 2019 to guarantee high quality images the hybrid regularized variational method shu et al 2019 compensation textures zhang et al 2021 and fusion strategy ma et al 2016 have been developed for dehazing maritime water alike scenes to reconstruct images under low illumination conditions the two step illumination estimation method yang et al 2019 and deep learning guo et al 2020 contributed to enhancing low light images the restoration of rain degraded images using emerging convolutional neural network cnn rao et al 2021 recurrent neural network rnn ren et al 2020 and conditional generative adversarial network cgan zhang et al 2020 is naturally beneficial for enhancing automatic maritime surveillance under rainy conditions from a theoretical point of view the enhanced visual quality is potentially able to promote ship detection which plays an important role in intelligent maritime surveillance system a large number of object detection techniques have been recently presented under different imaging scenarios such as urban road teo and chiu 2015 underwater lee et al 2012 and sky imagery bazi and melgani 2018 etc it is difficult to adopt these methods to detect moving ships since the observed maritime images are essentially different from other types of imaging scenes due to the water specific influences e g water surface reflection waves and ship wakes etc prasad et al 2017 with the extensive use of high performance graphics processing unit gpu deep learning based object detection methods have significantly outperformed traditional ones zhao et al 2019 these traditional methods are strongly dependent on the hand crafted features which are sometimes unstable and inapplicable in practice in current literature the learning based methods could be widely classified into two types i e two stage and one stage frameworks for example r cnn girshick et al 2014 and its accelerated extensions i e fast r cnn girshick 2015 and faster r cnn ren et al 2017 are the representative two stage proposal based detection methods however these two stage methods still suffer from high computational cost leading to unreal time object detection to overcome this limitation the typical one stage detectors mainly include single shot multibox detector ssd liu et al 2016 yolov1 redmon et al 2016 yolov2 redmon and farhadi 2017 and yolov3 redmon and farhadi 2018 etc they could guarantee a good balance between detection efficiency and accuracy under adverse weather conditions e g rain haze and low illumination etc the existing image restoration methods have obviously improved the visual image quality however it is impossible to perfectly recover the degraded images due to the inevitable loss of detailed features based on these restored images the ship detection robustness and accuracy will then be reduced accordingly to make detection more robust under different imaging conditions a flexible data augmentation strategy with generating synthetically degraded images will be developed to enlarge the volume and diversity of original dataset to train our learning based detection method in addition to further improve detection accuracy we will propose an extension of yolov3 by redesigning the sizes of anchor boxes introducing the soft non maximum suppression and predicting the localization uncertainties of bounding boxes according to the proposed data augmentation and learning based detection method there is a huge potential to obtain satisfactory ship detection results with higher accuracy robustness and efficiency in conclusion given the current achievements our learning based ship detection significantly differs from previous studies in the following aspects we resign the sizes of anchor boxes predict the localization uncertainties of bounding boxes and exploit the soft non maximum suppression to yield more spatially accurate detection results a mixed loss function is reconstructed to handle the inter class imbalance problem during network training the ship detection accuracy and robustness can be improved accordingly a flexible data augmentation strategy with synthetically degraded images is proposed to significantly improve the learning and generalization capabilities of our detection network experimental results on different imaging conditions have demonstrated our superior ship detection performance in terms of accuracy robustness and efficiency to evaluate the detection performance we will compare the proposed method with several state of the art methods extensive experiments will be performed to illustrate that our method could significantly outperform other competing methods in terms of detection accuracy robustness and efficiency the remainder of this paper is organized as follows in section 2 we will briefly review the current studies on object detection under different imaging scenarios section 3 proposes the enhanced ship detection framework based on traditional yolov3 network experimental results on several imaging conditions are comprehensively implemented in section 4 we finally conclude the main contributions of this work in section 5 2 related works 2 1 cnn based object detection in natural images in current literature deep cnn based object detection methods can be generally classified into two categories i e two stage and one stage detectors we will briefly review the recent studies on these learning based object detection methods in this work it is obvious that the two stage detectors require two steps to obtain the trained learning model the typical two stage r cnn girshick et al 2014 first adopts the edge boxes algorithm to generate object bounding box proposals the cnn then classifies these proposal regions which are extracted from the original image and resized the final region proposals are commonly refined using the popular support vector machine svm which is trained through cnn based features however r cnn often suffers from long computational time and improper candidate region proposals to eliminate these drawbacks girshick 2015 proposed a faster detection method called fast r cnn which exploited the region of interest roi pooling layer and shared the computations across all proposals compared with the r cnn it enables faster and more accurate detection results as a modification of fast r cnn faster r cnn ren et al 2017 has received more attention and produced more satisfactory detection its superior performance mainly benefits from the region proposal network rpn and fast r cnn which are respectively adopted to generate region proposals and detect objects other extended versions e g domain adaptive faster r cnn chen et al 2018 and few shot adaptive faster r cnn wang et al 2019b etc have also been proposed leading to achieving reliable detection results in contrast the one stage detectors directly transform the problem of bounding box location into a regression problem redmon et al 2016 proposed the yolov1 algorithm based on image global information which can obtain acceptable accuracy with a lower computational cost however compared with the region proposal based detection methods yolov1 has several drawbacks such as inaccurate location lower recall rate and unsatisfactory detection results for overlapping or tiny objects liu et al 2016 proposed a single shot multibox detector i e ssd which exploited cnn to directly detect and extract feature maps of different scales furthermore tian et al 2019 proposed a pixel by pixel object detection algorithm which produced an anchor free and proposal free solution other detection methods law and deng law et al duan et al 2019 zhou et al 2019 which were developed based on detecting key points and matching them could obtain better detection results without anchor boxes in addition fu et al 2021 presented an anchor free detection method which combined feature balancing and refinement network to detect multiscale ships under complex conditions a fully convolutional one stage object detector fcos was then developed to handle object detection in a per pixel prediction tian et al 2019 the introduced feature selective anchor free fsaf could effectively eliminate the limitations brought by conventional anchor based detection methods zhu et al 2019a the fsaf module could be adopted alone or combined with the results of anchor based branch to directly learn the bounding box coordinates without anchor reference kong et al 2020 proposed a flexible and anchor free framework i e foveabox to make object detection easier in practice redmon and farhadi 2017 proposed the yolov2 which added batch normalization bn layer and anchor boxes the k means clustering wagstaff et al 2001 was exploited to calculate better anchor ratio during training to further improve the detection accuracy of yolov2 redmon and farhadi 2018 proposed the yolov3 which has gained increasing attention recently this object detector proposes to replace the softmax layer with logistics layer experimental results show that yolov3 has higher detection accuracy and shorter computational time compared to other object detection methods 2 2 ship detection in maritime surveillance system accurate and reliable ship detection plays an important role in maritime video surveillance system in current literature extensive efforts have been undertaken to automatically detect moving ships for example stauffer and grimson 2002 constructed the gaussian mixture model to replace the traditional single gaussian model to estimate the background a novel hierarchical complete approach was presented based on shape and texture features for ship detection from spaceborne optical images zhu et al 2010 based on sea surface analysis yang et al 2014 proposed to automatically detect ships in high resolution optical satellite images the shape and context information were then combined for detecting inshore ships liu et al 2014 zhang et al 2017 proposed a ship target detection framework based on discrete cosine transform dct which mainly included three stages i e horizon detection background modeling and background subtraction it is able to guarantee robust detection results under complicated sea surface background with large waves in addition the low rank tensor completion with top hat regularization was developed to detect infrared small targets zhu et al 2019b the structured sparse representation model has also been presented to automatically detect inshore ships from high resolution optical remote sensing images zhuang et al 2020 it is well known that real time ship detection is essentially an important foundation for improving the efficiency of maritime surveillance however due to the severe imaging weather environments e g rain haze and low lightness in maritime applications traditional ship detection methods commonly suffer from inaccurate detection and long computational time etc therefore it is intractable to accurately and real timely detect moving ships using these methods in maritime applications owing to the powerful feature extraction and generalization capabilities cnn has been successfully exploited to automatically detect ships under different environments for example wu et al 2018 developed a cnn based inshore ship detection framework which could obtain the location of ship heads and the rough ship directions cui et al 2019 proposed a multi scale ship detection based on dense attention pyramid network to better extract abundant features including resolution and semantic information the hierarchical selective filtering layer was introduced to map elements of different scales to the same scale space li et al 2018 the ship targets were then detected in high resolution optical remote sensing images kim et al 2018 proposed a faster r cnn based probabilistic ship detection and classification system to obtain accurate and efficient detection results shao et al 2019 presented a saliency aware cnn framework which included deep feature saliency map and coastline prior etc for real time ship detection in surveillance video in the literature wang et al 2020a lightweight cnn and multisource feature cascade decision were combined to perform ship detection in spaceborne infrared images to further improve detection performance the spatial shuffle group enhance attention was developed to automatically detect ships in large scale synthetic aperture radar sar images cui et al 2021 learning enabled ship recognition and tracking have also gained significant attention chen et al 2020 2019 leading to intelligent maritime surveillance to investigate the influences of severe weather conditions on ship detection nie et al 2019 first adopted the synthetically degraded images to enlarge the training datasets and then exploited the yolov3 to guarantee robust detection of different types of ships in this work we will extend the yolov3 based ship detection framework according to the following aspects i e redesigning the ratios of anchor boxes predicting the uncertainty of bounding box location and exploiting the soft non maximum suppression snms leading to more accurate and robust ship detection in maritime surveillance system the ablation experiments and detection results will be implemented to illustrate the superior performance of our method under different weather conditions 3 the proposed cnn enabled ship detection framework 3 1 network architecture the flowchart of our learning based ship detection framework is shown in fig 1 the input images are collected using the video empowered maritime surveillance system the detection results are beneficial for marine accident investigation enhancing traffic safety and maritime monitoring etc the detection performance is highly dependent upon the feature extraction ability of our enhanced yolov3 network the detection module of our enhanced yolov3 network in each scale is composed of convolutional layers with different filtering kernels of size 3 3 and 1 1 the 3 3 convolutional layer extracts meaningful image features which increases network channels and refines local features the 1 1 convolutional layer is expected to adjust the number of channels to compress the feature maps and reduce the amount of calculation these two kinds of convolutional kernels make our deep network achieve a satisfactory balance between feature extraction and computational cost similar with traditional yolov3 the batch normalization bn layer huang et al 2018 is embedded after each convolutional layer to improve the training speed and accuracy after the bn layer we tend to add the leaky relu activation function wang et al 2019a to avoid the network degradation and gradient vanishing exploding problems in video empowered maritime surveillance system the obtained ships of interest are often too small to be detected due to the limited resolution of video camera to guarantee high quality detection results we propose to adopt the multi scale network to improve the detection of small scale moving ships with higher average precision to be specific we will redesign the sizes of anchor boxes in section 3 2 and introduce the gaussian modeling to predict the localization uncertainties of bounding boxes in section 3 3 in addition the soft non maximum suppression strategy will be exploited in section 3 4 to alleviate the image overlap detection problem the proposed loss function is capable of handling the inter class imbalance problem during network training in section 3 5 benefiting from these strategies our enhanced yolov3 has the capacity to real timely detect moving ships with more reliable robust and accurate results in practical maritime scenarios 3 2 redesigning the sizes of anchor boxes the proposed enhanced yolov3 is essentially an anchor box based detection method it is thus necessary to pre define the numbers and sizes of anchor boxes before network training according to the statistical results from the pre selected ship dataset i e seaships shao et al 2018 we could observe that the sizes of different types of ships vary greatly and all ships appear in elongated shapes shown in fig 2 to improve ship detection results the ratio of width to height should be tremendously larger than 1 however traditional yolov3 commonly has the properties of square shaped anchor boxes or large ratio of height to width it is thus intractable to generate accurate ship detection using these prior anchor boxes adopted in traditional yolov3 to overcome these limitations we propose to redesign the sizes of anchor boxes to make ship detection more reliable and accurate generally more prior anchor boxes could generate more detection results but leading to much higher computational cost motivated by pioneering work redmon and farhadi 2018 we can adopt the intersection over union iou to determine the number of anchor boxes to guarantee the trade off between detection accuracy and computational load 3 different scales and 3 different aspect ratios are chosen to form 9 prior anchor boxes in our experiments in particular our detection network directly adopts the popular k means cluster to generate 9 priors whose width and height belong to the small scale type i e 0 072917 0 034259 0 146875 0 060185 0 203646 0 100926 middle scale type i e 0 273958 0 065741 0 317188 0 173148 0 350521 0 111111 and large scale type i e 0 504688 0 233333 0 578125 0 137963 0 811458 0 251852 respectively the comparisons of normalized width and height between original and redesigned anchor boxes are visually illustrated in fig 3 note that different feature maps naturally correspond to different sizes of prior anchor boxes the learning and generalization abilities of our network could be promoted accordingly leading to enhanced ship detection results 3 3 predicting the localization uncertainties of bounding boxes in original yolov3 each grid corresponds to 3 predicted bounding boxes where each box includes the bounding box coordinates i e t x t y t w and t h detection score and class scores in particular the detection score indicates whether a ship is present or not within the bounding box the class score between 0 and 1 determines the probability of a ship belonging to a certain class the ship of interest can thus be detected through the product of detection and class scores it is well known that the bounding box coordinates are specific coordinate values in yolov3 failing to represent the bounding box uncertainties the confidence of detected bounding box is thus indeterminate leading to limited improvement in ship detection motivated by previous work choi et al 2019 we propose to introduce a single gaussian function to model the localization uncertainties of predicted bounding boxes given a test input x the output y contains the following gaussian parameters i e 1 p y x n y μ x σ x where n denotes the single gaussian function with μ and σ being the mean and variance functions respectively as illustrated in fig 4 the coordinates of predicted bounding boxes in the feature maps are represented using the mean μ and variance σ functions in particular the corresponding outputs are composed of μ ˆ t x σ ˆ t x μ ˆ t y σ ˆ t y μ ˆ t w σ ˆ t w μ ˆ t h and σ ˆ t h the parameters i e t x t y t w and t h in the single gaussian model can be pre processed using μ t x δ μ ˆ t x μ t y δ μ ˆ t y μ t w μ ˆ t w μ t h μ ˆ t h σ t x δ σ ˆ t x σ t y δ σ ˆ t y σ t w δ σ ˆ t w and σ t h δ σ ˆ t h with δ x 1 1 exp x being the sigmoid function in our ship detection network the predicted coordinates of bounding boxes are related to the mean values of spatial coordinates in the detection layers the variance values correspond to the uncertainties of predicted bounding boxes it is worthy noting that the overall computational complexity will not increase significantly since the single gaussian function is only exploited to model the bounding box coordinates of detection layers choi et al 2019 there is thus a great potential to guarantee robust and accurate ship detection results with high computational efficiency 3 4 exploiting the soft non maximum suppression to achieve high quality detection results the non maximum suppression nms hosang et al 2017 has become an essential part of object detection methods which is able to delete the unnecessary bounding boxes through an overlap criterion in particular the nms algorithm divides the bounding boxes into disjoint subsets and sorts the predicted boxes in each subset according to the detection score for the sake of better understanding the nms algorithm can be written as follows 2 s i s i if iou m b i n t 0 if iou m b i n t where s i is the detection score related to the i th bounding box b i m denotes the bounding box with the maximum score and n t represents the iou threshold in eq 2 the iou denotes the computation of similarity between two arbitrary shapes its mathematical definition is given by iou a b a b a b with a and b representing the bounding boxes in practical applications the distance between ships is relatively close which may cause image overlap and inaccurate ship detection to alleviate this problem our learning framework will be incorporated with the soft non maximum suppression snms bodla et al 2017 instead of the traditional nms in eq 2 in particular the snms includes two different strategies i e piece wise function and gaussian penalty function to weight the scores of bounding boxes in this work to strongly penalize the box b i when the overlap of b i with m becomes close to one we tend to update the detection score s i using the gaussian penalty function i e 3 s i s i exp iou m b i 2 σ b i d where σ 0 1 is a smoothing parameter from a theoretical point of view the snms does not need additional training and can be efficiently executed it can thus be flexibly integrated into our enhanced cnn based ship detection framework without increased computation cost existing studies bodla et al 2017 have demonstrated that the snms could enable noticeable improvements in both detection accuracy and robustness 3 5 reconstruction of mixed loss function the loss function in original yolov3 is only composed of binary cross entropy bce and squared sum error sse to evaluate the bounding box localization and classification results tian et al 2020 however due to the imbalance of training samples the loss function is easily dominated by numerous negative samples thus resulting in unsatisfactory mislocalization and misclassification problems in this work we propose to reconstruct a mixed loss function to achieve more robust and effective learning in model training motivated by gaussian yolov3 choi et al 2019 the first part of our mixed loss can be defined through gaussian modeling which is detailedly modeled as a negative log likelihood nll function i e 4 l x i 1 w j 1 h k 1 k χ i j k log n x i j k g μ t x x i j k σ t x x i j k ε 5 l y i 1 w j 1 h k 1 k χ i j k log n y i j k g μ t y y i j k σ t y y i j k ε 6 l w i 1 w j 1 h k 1 k χ i j k log n w i j k g μ t w w i j k σ t w w i j k ε 7 l h i 1 w j 1 h k 1 k χ i j k log n h i j k g μ t h h i j k σ t h h i j k ε where l x l y l w and l h respectively denote the nll losses of t x t y t w and t h coordinates w and h are the numbers of grid centers along width and height axes k is the number of anchors ε 1 0 9 is adopted to avoid numerical instability χ i j k is a parameter at the k th anchor in the i j grid related to whether there is an object for the sake of simplicity we now take only l x as an example in the next description in eq 4 x i j k g denotes the ground truth of t x coordinate in addition μ t x x i j k and σ t x x i j k which are the outputs of the detection layer of our learning method respectively represent the location and uncertainty of t x coordinate at the k th anchor in the i j grid analogous to l x the definitions of other variables in l y l w and l h could be accordingly given similar to the previous work choi et al 2019 the coordinates of each ground truth bounding box can be computed as follows 8 x i j k g x g w i 9 y i j k g y g h j 10 w i j k g log w g w i a k w 11 h i j k g log h g h i a k h where x g y g w g and h g denote the scale ratios of one ground truth bounding box in an image w i and h i represent the width and height after image resizing and a k w and a k h are the width and height of the k th anchor in addition the parameter χ i j k plays an important role in ship detection in this work we propose to calculate χ i j k as follows 12 χ i j k ω scale i i j k obj 2 with ω scale 2 w g h g being computed using the width and height ratios of the ground truth bounding box in an image it is obvious that ω scale yields different weights based on the object sizes during network training in eq 12 i i j k obj is assigned to one if the iou of the ground truth and the k th anchor box achieves the largest value whereas is assigned to zero if there is no suitable ground truth it is well known that ship detection easily suffers from the inter class imbalance problem due to the obtained training dataset to deal with this imbalance problem the focal loss function lin et al 2017 has become an effective solution by reweighting the contribution of easy examples and enhancing the importance of hard examples in our network we propose a focal binary cross entropy fbce loss function to measure the bounding box confidence i e l conf and object classification i e l class i e 13 l conf i 1 w j 1 h k 1 k i i j k obj α 1 c i j k γ log c i j k ε 1 α c i j k γ log 1 c i j k ε 14 l class i 1 w j 1 h k 1 k i i j k obj α 0 1 p i j k γ log p i j k ε 1 α 0 p i j k γ log 1 p i j k ε with 15 c i j k i 1 w j 1 h k 1 k 1 1 exp x i j k and 16 p i j k exp x i j k i 1 w j 1 h k 1 k exp x i j k where γ is the dynamic scaling factor γ 2 c i j k is obtained by compressing x i j k with the sigmoid function p i j k is obtained by normalizing x i j k with the softmax function the dynamic factor α in eq 13 is given by 17 α α 0 c i j k 1 α 0 1 c i j k where α 0 denotes the equilibrium factor regarding the positive and negative samples and ε is a small constant to avoid numerical instability in this work we empirically set α 0 and ε to 0 25 and 10 8 respectively these parameters could guarantee robust learning during network training the proposed fbce loss has the capable of handling the imbalance problem to further improve the accuracy of bounding box localization we will incorporate the concept of generalized intersection over union giou rezatofighi et al 2019 into the mixed loss function different from the giou based loss tian et al 2020 our proposed localization loss l giou is described as follows 18 l giou i 1 w j 1 h k 1 k i i j k obj ω scale 1 g i j k where g i j k represents the giou related to the bounding box localization performance let a and b indicate the ground truth and predicted bounding boxes the giou for comparing similarity between a and b is then given by 19 giou iou c a b c with c denoting the smallest enclosing area for a and b therefore the total loss function l total used in our learning enabled ship detection framework is defined as follows 20 l total l x l y l w l h l conf l class l giou the importances of l x l y l w l h and l giou in guaranteeing detection accuracy and robustness have been confirmed in previous studies choi et al 2019 tian et al 2020 rezatofighi et al 2019 therefore we propose to only investigate the influences of fbce loss i e l conf and l class on ship detection in this work the positive influences will be discussed through the ablation experiments in section 4 3 4 experimental results and analysis we will conduct detection experiments based on tensorflow software library 1 9 0 in ubuntu 18 04 in particular all experiments are carried out on a computer with an intel r core tm i9 10850k cpu 3 60 ghz and nvidia geforce gtx 1080ti gpu in this work we directly exploit the darknet53 network to extract meaningful features for the optimal hyper parameters selected in our network the base learning rate momentum and weight decay are respectively set to 0 0001 0 9 and 0 0005 the other parameters are default values empirically adopted as done in original yolov3 redmon and farhadi 2018 4 1 dataset description and data augmentation we propose to adopt a large scale ship dataset called seaships shao et al 2018 as a training dataset to improve the learning and generalization capacities of our detection network all maritime images are obtained from the video camera surveillance systems the dataset used in this work consists of 7000 images and covers 6 types of ships i e ore carrier bulk carrier general cargo ship container ship fishing boat and passenger ship to further improve ship detection results we propose to exploit the data augmentation methods e g horizontal flipping random translation and random clipping etc to enlarge the original training dataset shown in fig 5 the maritime video surveillance easily suffers from adverse weather conditions e g rain haze and low illumination it is commonly intractable to robustly and accurately detect the moving ships using current learning techniques under these scenarios the traditional methods first restore the degraded images and then directly exploit the learning based ship detection methods however it is impossible to perfectly recover the degraded images due to the loss of detailed features inevitably yielded by image restoration methods in practice in this work we will synthetically simulate the degraded images e g rainy hazy and low light images to improve the volume and diversity of training dataset the learning and generalization capabilities of learning based detection methods will be promoted accordingly the rainy scene could be obtained by adding random rain streaks into original sharp images therefore one synthetically degraded image z x y containing rain streaks can be described as follows 21 z x y j x y b x y for any pixel x y ω here ω is the image domain j x y is the rain free scene i e latent sharp image and b x y denotes the rain streak layer as illustrated in fig 6 we can synthetically generate different styles of rainy images by adjusting the lengths and angles of rain streaks in particular the lengths of rain streaks change between 20 and 80 pixels the angles of rain streaks will be randomly selected from 50 to 50 in our experiments under the hazy environment the presence of haze could degrade the visual quality of images obtained from maritime video surveillance in this work we directly exploit the atmospheric scattering model to model the generation of maritime hazy images i e 22 i x y j x y t x y 1 t x y a where i x y denotes the obtained hazy image j x y is the latent haze free image a is the global atmospheric light and t is the transmission map which decays exponentially with increasing propagation distance i e t x y e β d x y where β is the scattering coefficient and d x y is the distance from the object to the video camera in the maritime surveillance system the synthetically degraded images are visually displayed in fig 7 these different hazy images are generated by adjusting different atmospheric light values a and transmission maps t to enlarge the original training dataset for the sake of simplicity we will synthetically simulate the hazy images using a 0 60 0 65 0 70 0 75 0 80 0 85 0 90 and t 0 1 0 2 0 3 0 4 0 5 low light images refer to the visual data acquired under low illumination conditions the visually degraded images inevitably suffer from several limitations e g low brightness low contrast and detail loss etc in this work the low light maritime images will be synthetically simulated through the retinex theory which assumes that an original image s can be decomposed into the product of reflection r and illumination l i e 23 s x y r x y l x y in eq 23 the reflection r represents the intrinsic property of target objects which can be considered as the latent sharp image it is naturally assumed to be consistent under different lighting conditions the illumination l denotes the various lightness on objects which is spatially smooth to synthetically generate the low light maritime images we first transform the high quality original images from rgb color space into hsv color space the v layer in original images is then multiplied by different attenuation coefficients ω 0 1 leading to visually degraded maritime images as illustrated in fig 8 the synthesized low light images are manually generated with ω 0 1 0 3 and 0 5 respectively 4 2 evaluation criteria to quantitatively evaluate the ship detection results both mean average precision map mean iou miou and frame per second fps are adopted in our experiments in particular the map indicates the detection robustness and accuracy the miou is adopted to evaluate the similarity between the predicted bounding box and the ground truth version the fps represents the computational efficiency of different ship detection methods in particular the map is the most widely used criterion to measure the detection performance the map can be computed by taking the average of ap which is related to the area under the precision recall curve the definition of map is mathematically given by 24 map 1 n n 1 n ap n where the average precision score ap n is calculated for n data folds in this paper the miou is computed by considering the iou of each class and averaging them the definition of iou has been given in section 3 4 the fps represents the number of image frames detected by the learning method in one second theoretically higher map miou and fps values normally indicate more accurate and efficient ship detection results 4 3 ablation experiments as discussed in section 3 our ship detection framework is proposed by taking into consideration several modules e g data augmentation da redesigning the sizes of anchor boxes rsab soft non maximum suppression snms and predicting the localization uncertainties of bounding boxes plubb and focal binary cross entropy fbce loss function in the literature da strategy has received significant attention and its positive effects have been confirmed this work mainly focuses on the influences of rsab snms plubb and fbce on ship detection the ablation experiments will thus be implemented to investigate which one plays more important role in improving detection performance the numerical experiments are detailedly illustrated in table 1 it can be found that the original yolov3 yields the lowest map and miou easily leading to unsatisfactory ship detection results the introductions of both da and rsab are able to obviously enhance the detection accuracy it seems that the improved detection accuracy brought by snms is not obvious however the visual appearance of ship detection will the tremendously enhanced by suppressing the unnecessary anchor boxes the original bounding boxes are mainly represented by two parameters i e mean and variance values the implementation of plubb will increase the amount of calculation time but improve the detection accuracy with increased map of 6 81 the introduced fbce loss function is also able to enhance detection accuracy compared with the original yolov3 our enhanced cnn enabled learning method can significantly improve the map by 12 55 while guaranteeing real time detection results as a consequence the introductions of da rsab snms plubb and fbce are capable of bringing positive effects on improved ship detection results 4 4 comparisons with other detection methods to evaluate the detection performance our method will be compared with several representative methods i e faster r cnn ssd yolov2 and yolov3 these learning methods are trained using the same enlarged dataset without synthetically degraded images in this case our enhanced learning method is called eyolov3 which only considers the rsab snms plubb and mixed loss function the detection results in terms of accuracy and efficiency are detailedly summarized in table 2 the ssd 300 means that it receives input images of 300 300 pixels the similar description can be found in ssd 512 yolov2 416 yolov3 416 eyolov3 416 eyolov3 512 and eyolov3 608 table 2 indicates that faster r cnn can bring higher detection accuracy compared with ssd yolov2 and yolov3 but generates the lowest efficiency both ssd 300 and ssd 512 have improved the detection accuracy but fail to detect the types of moving ships yolov3 416 is capable of real timely detecting the moving ships but leads to slightly lower detection accuracy compared with faster r cnn it is worth noting that our method is able to significantly improve the detection accuracy with real time ability the darknet53 network was used as the backbone structure of our method to train the learning based detection our superior detection performance mainly benefits from the introductions of rsab snms plubb and fbce loss function from a theoretical point of view with the increased sizes of input images e g from 416 416 to 608 608 the detection accuracy i e map and efficiency i e fps will be improved and reduced respectively in the case of 608 608 our eyolov3 608 generates the best detection accuracy and obviously enhances the computational efficiency compared with eyolov3 512 it means that eyolov3 608 enables a better balance between detection accuracy and efficiency we thus directly adopted ours 608 to detect moving ships in other numerical experiments several ship detection results under different monitoring conditions are visually illustrated in figs 9 12 we only compared our proposed eyolov3 i e eyolov3 608 with three typical methods i e ssd i e ssd 512 faster r cnn and yolov3 i e yolov3 416 in maritime applications it is commonly difficult to robustly perform ship detection under complex backgrounds shown in fig 9 the co occurrences of multiple ships in fig 10 small scale ships in fig 11 and large overlapping regions between ships in fig 12 make ship detection more difficult leading to unreliable traffic monitoring in maritime surveillance system compared with traditional natural imaging conditions the light conditions in maritime scenarios are more complicated for example the observed maritime images often suffer from several water specific influences e g water surface reflection waves and ship wakes etc as a consequence both faster r cnn and yolov3 sensitive to the unstable imaging background yield inaccurate detection results as shown in figs 9 and 11 the shoreside and water surfaces have been recognized as the ships of interest due to inadequate high level features ssd fails to accurately detect the ships in the cases of multiple ships in fig 10 and large overlapping regions in fig 12 in contrast our method is able to robustly and accurately detect the moving ships under different surveillance environments the accurate detection results are naturally beneficial for enhancing traffic safety and maritime monitoring in practical applications 4 5 influences of severe weather conditions on ship detection in practical applications the observed maritime images often suffer from adverse weather conditions e g rain haze and low illumination the current learning methods cannot be directly exploited to perform accurate detection under these scenarios although the traditional data augmentation methods e g horizontal flipping random translation and random clipping etc have been introduced to enlarge the original training dataset it is still intractable to achieve satisfactory detection performance under severe weather conditions from a theoretical point of view there are two different strategies i e indirect and direct versions to make ship detection more reliable the indirect strategy first restores the observed degraded images and then detects the moving ships using yolov3 or eyolov3 learned from only sharp images in contrast the direct strategy could efficiently generate ship detection results through the learning methods trained using the enlarged dataset which contains both sharp images and synthetically degraded images this subsection is thus mainly devoted to investigating the influences of different detection strategies on ship detection under severe weather conditions 4 5 1 detection results on synthetic weather conditions the influences of image restoration i e visibility enhancement on ship detection results are detailedly summarized in table 3 a large number of image restoration methods have been proposed to guarantee visual image quality under severe imaging scenarios in this work the rainy images are restored using the progressive recurrent network prenet which is a simpler and better baseline deraining network ren et al 2019 to improve visibility under hazy imaging environments the feature fusion attention network ffa net a simple image to image architecture qin et al 2020 is directly adopted to perform image dehazing the retinex theory based deep neural network i e retinexnet wei et al 2018 is introduced to perform low light image enhancement in particular retinexnet is mainly composed of two components i e decom net and enhance net subnetworks which respectively perform image decomposition and illumination adjustment it is obvious that these representative image restoration methods are capable of enhancing imaging quality leading to improvement in ship detection accuracy shown in table 3 however it is impossible to perfectly restore the degraded images due to the inevitable loss of detailed features in practice the further improvement in detection robustness and accuracy will be accordingly limited based on the restored images which are essentially different from the original sharp images table 4 depicts the influences of data augmentation strategies on ship detection under severe imaging scenes the proposed eyolov3 was trained using the training dataset which contains original sharp images hazy images low light images light rainy images or heavy light images the well trained network was then adopted to detect moving ships in test dataset which contains the similar imaging scenarios shown in training dataset it can be observed that if the training and test dataset include the similar imaging conditions the ship detection accuracy will be tremendously increased this is due to the fact that our data augmentation strategies with synthetically degraded images could essentially promote the volume and diversity of training dataset the learning and generalization abilities of eyolov3 are accordingly improved in practice in contrast the indirect detection framework i e image restoration and eyolov3 has limited the improvement of ship detection network without loss of generality we take the hazy weather conditions as an example our direct detection framework could generate satisfactory results with ap of 91 40 in table 4 whereas the indirect detection framework yields the results with ap of 72 59 under other weather conditions the direct strategy could still produce more accurate ship detection results in addition the indirect strategy often suffers from the high computational cost due to two inevitable implementations i e image restoration and ship detection owing to the direct operation our method i e eyolov3 and ad not only improves the detection accuracy but also potentially shortens the computational time in maritime applications for the sake of better understanding the visual comparisons of different ship detection strategies are illustrated in figs 13 15 it is obvious that the severe weather environments easily cause poor contrast and loss of structural details in degraded images these negative effects could make ship detection more difficult in maritime surveillance system in our numerical experiments the ship detection results generated by the eyolov3 original in figs 13 15 b which directly adopts our eyolov3 to detect ships from original sharp images can be considered as the benchmark with the highest accuracy to achieve reliable detection results under different imaging conditions the ship detection accuracy generated by the competing methods should be as similar as possible to the benchmark under poor imaging scenes both yolov3 and eyolov3 fail to accurately and robustly detect the moving ships shown in figs 13 15 c d it means that the detection accuracy and robustness is highly dependent on the imaging quality to further enhance detection efficacy it is tractable to first restore the degraded images and then directly exploit the existing learning based detection methods as shown in figs 13 15 e the visual image quality has been obviously improved using the state of the art visibility enhancement methods through the implementation of eyolov3 the ship detection accuracy is improved accordingly however it is still impossible to perfectly restore the lossless sharp images from their degraded versions due to the loss of fine details inevitably caused by the visibility enhancement methods 1 1 in theory the loss of fine details could bring negative effects on ship detection in maritime applications therefore the improvement of ship detection accuracy could be limited even the advanced detection methods are implemented for restored images in contrast our eyolov3 ad degraded first trains the eyolov3 using the ad based enlarged training dataset the learning and representation capacities of our eyolov3 could be promoted correspondingly the well trained eyolov3 is then exploited to directly detect different types of ships from the degraded images the detection results shown in figs 13 15 f illustrate that our proposed method is able to accurately detect the moving ships no matter what the imaging conditions are under different weather environments this superior detection performance mainly benefits from the proposed ad strategy the developed modules i e rsab snms plubb and fbce embedded in our eyolov3 framework could naturally promote ship detection in terms of both robustness and efficiency the detection experiments under realistic weather conditions will also be performed to evaluate the robustness and effectiveness of our eyolov3 with ad strategy 4 5 2 detection results under realistic weather conditions it is worthy noting that the realistic image degradation essentially differs from the synthetic operations according to the eqs 21 23 shown in section 4 1 it thus becomes more difficult to accurately detect the moving ships from realistically degraded images in maritime video surveillance in this subsection we will evaluate the effectiveness of our proposed method i e eyolov3 and ad under realistic weather conditions in particular our eyolov3 was trained using the ad based training dataset which includes the sharp images and their synthetically degraded versions experimental results on realistic ship detection produced by our proposed method are visually displayed in fig 16 it can be found that the degraded images obtained under rainy hazy and low light imaging conditions suffer from the low contrast and loss of fine details etc due to the visual quality degradation it becomes intractable to accurately detect the small scale ships and multiple ships benefiting from the proposed ad strategy our eyolov3 is capable of robustly performing ship detection under different imaging conditions owing to the proposed rsab snms plubb and fbce it is able to accurately detect the moving ships even the observed visual quality has been significantly degraded therefore our proposed method has the capacity of robustly efficiently and accurately performing automatic ship detection under poor imaging scenarios the reliable detection results are beneficial for maritime object tracking and abnormal behavior detection leading to enhanced traffic safety and management in intelligent video empowered maritime surveillance system 5 conclusions and future perspectives the robust and accurate detection of moving ships is of importance for guaranteeing traffic safety and security under different imaging conditions in this work we proposed an enhanced cnn enabled learning method to improve ship detection in maritime video surveillance the learning and representation capacities of our network have been promoted by redesigning the sizes of anchor boxes rsab predicting the localization uncertainties of bounding boxes plubb and introducing the soft non maximum suppression snms the proposed mixed loss function is able to handle the inter class imbalance problem during network training to make our network more reliable under adverse weather conditions the data augmentation da strategy was also presented to enlarge the original dataset to train learning based detection methods compared with several representative methods our method could real timely detect different types of moving ships with higher detection accuracy experimental results have also demonstrated our superior detection results under adverse imaging conditions i e rainy hazy and low light environments to make ship detection more reliable and robust the study shown in this paper can be extended along the following directions the proposed data augmentation strategy directly adopted simplified imaging models to generate the synthetically degraded images it should be noted that both tinctorial and structural differences between synthetic and realistic maritime images are significant to further promote ship detection under different imaging conditions the powerful transfer learning pan and yang 2009 and generative adversarial networks creswell et al 2018 could be adopted to produce synthetic images with more natural looking appearance the detection of small scale moving ships is more common and challenging in video empowered maritime surveillance system due to the long distance between the camera and ships of interest it is difficult to capture maritime images with high spatial resolution potentially leading to unsatisfactory detection results to guarantee reliable small scale ship detection before the implementation of ship detection the super resolution methods wang et al 2020b can be first introduced to enlarge the maritime images to make ship targets more sharpen in addition the popular attention mechanism li et al 2020 can also be embedded into existing learning based detection frameworks to promote small scale ship detection in terms of robustness and accuracy although the proposed ship detection method suffers from some inherent limitations it is still worthy of consideration because it could real timely and accurately detect moving ships under adverse imaging conditions we believe our method can be further extended to enhance the maritime traffic safety and management in practical applications credit authorship contribution statement ryan wen liu conceptualization methodology formal analysis supervision validation funding acquisition writing review editing weiqiao yuan methodology resources data curation software writing original draft xinqiang chen formal analysis validation writing review editing yuxu lu data curation software formal analysis validation investigation writing original draft declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the work described in this paper was supported by grants from the hainan provincial joint project of sanya yazhou bay science and technology city china no 520lh057 the national natural science foundation of china no 51609195 and the national key r d program of china no 2018yfc0309602 
20521,the dynamic behaviours of subsea pipe valve structures the principal components of subsea equipment are of critical concern for the control of the lowering through the splash zone during installation nonlinear interactions between waves and pipe valve combinations are challenging the investigation of the wave forces acting on large dimension structures this paper proposes a numerical model to study the nonlinear hydrodynamic performance of partially submerged pipe valve structures a two dimensional 2d numerical water tank nwt was established to efficiently generate high accuracy incident waves and a semi immersed horizontal cylinder was applied to the numerical simulations of wave structure interaction wsi to study the mesh and time convergence the numerical model was validated with a comparative analysis of the modelling results with experimental data other numerical results and theoretical results numerical simulations of the interaction between stokes ii waves and subsea pipe valve structures were performed and the effects of the valve height ratio valve length ratio and valve spacing were investigated the subsea pipe valve structure is a kind of multi scale structure the wave forces exhibited stronger nonlinearity when acting on the partially submerged valves than on the completely submerged pipe changes in valve structure and distribution significantly increased the overall change in the wave forces acting on the valves the stronger nonlinearity was primarily derived from phenomena such as wave reflection wave blockage and wave run up the numerical results provide references for the structure and strength designs and offshore installations of large subsea equipment like subsea manifolds keywords subsea pipe valve structures partially submerged numerical water tank wave structure interaction nonlinearity 1 introduction the development of offshore oil industry technology and the increased water depth of offshore oilfields have accelerated the development of subsea production systems to exploit deepwater oil and gas resources subsea production systems play a significant role in the extraction of deepwater hydrocarbons have a wide application range and high efficiency and are less affected by environmental loads cao et al 2016 hong et al 2018 lindseth et al 2019 jamaludin 2019 subsea production systems are composed of vital subsea equipment such as subsea manifolds xmas trees and pipeline end terminations mason and upchurch 1996 bernt 2004 the four primary phases of lowering subsea equipment from the installation ship to the seabed consist of lifting equipment from the deck of the installation ship lowering through the splash zone lowering in deep waters and approaching the seabed veritas 2011 the nonlinear wave force acting on subsea structures in the second phase may result in structural damage such as deformation and bending therefore more information on wsi must be provided before conducting practical offshore installations wsi is a typical problem in ocean and coastal engineering that has been studied by many researchers using different approaches such as analytical solutions physical experiments and numerical simulations buccino and martinelli 2020 summarised the arguments of the papers gathered in a special issue named interaction between waves and maritime structures primarily the structural and functional performances additionally regarding the functional performance it was subdivided into the hydraulic morphodynamic and floating body responses analytical method is relatively more cost effective and efficient for studying wsi under certain conditions and provides a good scientific understanding of the hydrodynamic characteristics of structures in the wsi process fang et al 2018 presented an analytical solution based on the linear potential theory to predict hydrodynamic wave forces subjected by girder type bridge decks under hurricane generated oblique water waves jalón et al 2019 considered the linear wave theory and the head loss caused by the constriction of flow to develop an analytical model of the oblique incident wave interaction with a maritime structure and extended it to irregular waves bahena jimenez et al 2020 obtained formulas that obey a power law function for the reflection and transmission coefficients and the wave elevation for the linear water wave interaction with a cycloidal breakwater in presence of a sloping beach however the analytical method has limitations such as the potential flow models established under the assumption of inviscid and irrotational fluid flow and cannot adequately address the velocity fields around structures and the strong nonlinear effect li et al 2020a analytically and experimentally investigated the interaction between water waves and a submerged perforated quarter circular caisson breakwater wave energy dissipation near the breakwater crown is considerable owing to flow separation but cannot be considered in the potential solution therefore at a water depth of 0 5 m the reflection and transmission coefficients calculated by the analytical solution are slightly larger than those measured by the experimental tests extensive studies on physical wsi experiments have been reported based on physical water tanks different wave generators such as piston flap and plunger are used to generate different types of waves lamberti et al 2011 focused on wave induced horizontal forces on the deck front described a series of large scale experiments on exposed jetties and provided guidelines on the optimal logging frequency or low pass filter to be used if the experimental loads were obtained by pressure integration rodríguez and spinneken 2016 conducted a series of experimental tests in regular and irregular wave conditions concerning the nonlinear loading and dynamic response of a heaving rectangular box in two dimensions applied four absorbing flap type wavemakers to generate incident wave conditions and obtained all experimental data in the long wave flume sayeed et al 2017 conducted experiments to study the change in wave loads for different sizes of small spherical bodies at different proximities to a fixed structure a hydraulically actuated wave board and a wave absorbing beach were respectively equipped on both sides of the towing tank huang et al 2018 experimentally and numerically investigated hurricane induced wave forces on a box girder deck of a coastal bridge in the experiments the periodic waves were produced on the left side of the wave flume using a wave generator without reflection yan et al 2019 used a piston type wavemaker to produce the plunging wave based on the focused wave theory and experimentally and numerically studied the plunging wave impacts on a box shape structure physical experiments a traditional research approach are highly accurate and reliable but have limitations such as long research time high cost and scale restriction the rapid development of computational fluid dynamics cfd and improved computational power allow numerical simulations to provide an economic highly efficient and powerful alternative to perform the wsi investigations numerical study of wsi requires the development of a nwt which can overcome limitations of physical model tests such as model size and viscous similarity many researchers including anbarsooz et al 2013 dao et al 2018 wu and hsiao 2018 and marques machado et al 2018 have conducted studies on nwts finnegan and goggins 2015 used the commercial software ansys cfx to develop a cfd nwt model and introduced a rectangular prism structure into the model to investigate a linear irregular ocean wave interaction with a structure ghezelbashan and d mello 2017 used cfd package ansys fluent with a stokes v wave to model the nonlinear high amplitude ocean wave and used ansys workbench to investigate wave interaction with a vertical slender cylindrical member miquel et al 2018 analysed the performance of different wave generation and absorption methods in cfd based nwts using the open source hydrodynamic model reef3d and conducted a sensitivity analysis for quantifying and comparing the differences in absorption quality between these methods aggarwal et al 2019 used the reef3d to conduct cfd based numerical simulations to study breaking wave characteristics and the influence of the breaker location on the wave impact loads of a jacket structure the numerical simulations in this study were performed using openfoam a free and open source cfd package that uses the finite volume method to solve the discretised navier stokes equations extensive numerical simulations involving the interaction between waves and structures have been reported based on the openfoam software package hu et al 2016 used openfoam to simulate wsis and developed a new boundary condition for extreme waves the new boundary condition was implemented to simulate the interaction with a fixed floating truncated cylinder and a simplified fpso islam et al 2019 used openfoam to analyse wave radiation due to heave surge and pitch by a box type floating structure based on cfd simulations and applied the waves2foam toolbox to generate and absorb free surface waves based on openfoam package gao et al 2020 used a 2d numerical wave flume to numerically investigate wave loads during gap resonance between a fixed box and a vertical wall and employed the waves2foam toolbox to produce incident waves at the boundaries and avoid wave re reflection in the water flume the operational environment during the lowering and installation of subsea equipment is often harsh especially strong nonlinear phenomena such as wave breaking and splashing affect the process of lowering through the splash zone environmental loads can cause structural damage to subsea equipment leading to installation failures or engineering accidents in subsea production systems subsea manifolds as the critical equipment are used to simplify the system to minimise the usage of subsea pipelines and risers and to optimise fluid flow during production the subsea manifold is an arrangement of pipes and valves aimed at combining distributing controlling and monitoring fluid flow bai and bai 2019 the pipe valve structure is a multi scale critical component installed inside the subsea equipment and it is necessary to investigate its hydrodynamic performance under nonlinear incident waves for example the subsea manifold contains different types of valves e g hydraulic ball valve hydraulic gate valve and manual ball valve of different heights and lengths the close arrangement of the valves causes the hydrodynamic behaviour of a valve will be affected by adjacent valves this study performed numerical calculations to investigate the interaction between nonlinear waves and partially submerged pipe valve structures we investigated the effects of the valve height ratio valve length ratio and valve spacing on wave forces subjected by subsea pipe valve structures in a 2d nwt and analysed the reasons for wave force changes the obtained results provide references for the structure and strength designs and valve layout of subsea pipe valve structures the rest of this paper proceeds as follows section 2 presents the numerical method used in the current study introduces the governing equations uses the static boundary method to generate stokes ii waves and determines the mesh generation scheme a series of numerical simulations for the interaction between waves and a semi immersed cylinder are performed to study the mesh and time convergence and to validate the numerical model in section 3 a series of numerical simulations are conducted to calculate the horizontal and vertical forces acting on partially submerged subsea pipe valve structures at different valve structures and valve distributions section 4 provides conclusions based on the results 2 numerical model 2 1 governing equations with respect to an incompressible two phase water and air flow the densities of both fluids are constants the governing equations are the continuity and momentum equations the continuity equation is given by 1 u 0 where u is the velocity vector in the volume of fluid method α 0 α 1 represents the water volume fraction in each cell for α 1 it means that the cell is full of water for α 0 it means that the cell is full of air in addition to these two cases it represents the air water interface thus eq 1 can be reduced to the following form 2 α t u α u r α 1 α 0 where u r represents a relative velocity and u r α 1 α is an artificial compression term for limiting the interface smearing rusche 2003 the momentum equation is given by 3 ρ u t ρ uu μ u p g x ρ σ t κ α α where p is the dynamic pressure g is the gravitational acceleration x is the position vector σ t denotes the surface tension coefficient κ α denotes the surface curvature of the air water interface and ρ and μ are the density and viscosity of the mixture respectively the equations of which are as follows 4 ρ α ρ w a t e r 1 α ρ a i r 5 μ α μ w a t e r 1 α μ a i r 2 2 wave generation based on the static boundary method practical wave height in the ocean is generally limited with respect to the wavelength or water depth and sometimes it can reach a relatively large value for the finite amplitude wave the nonlinear effects caused by the fluctuating free surface must be considered namely the motion and dynamic conditions of the free surface are nonlinear considering the calculational accuracy and cost this study uses the static boundary method to generate nonlinear waves for wave generation and absorption many researchers used the waves2foam within openfoam which is a third party toolkit developed by jacobsen et al 2012 in this study we used the ihfoam toolbox to generate and absorb incident waves which is embedded in openfoam and can be applied to generate different types of waves e g cnoidal stokes i stokes ii and stokes v additionally the active wave absorption of ihfoam works simultaneously with wave generation to dissipate incident waves ihfoam is the fastest wave generation method whereas waves2foam is 11 slower because of the use of relaxation zones martínez ferrer et al 2018 in the present study combined with the setting of related parameters and according to the range of application of the various wave theories proposed by le méhauté 1976 stokes ii wave theory is the most suitable for this paper additionally the stokes ii wave theory is representative widely used in the investigation of wsis and the basis for investigating the interactions between structures and more complex waves the corresponding free surface elevation is expressed as follows 6 η h 2 c o s k x ω t k h 2 16 c o s h k d s i n h 3 k d 2 c o s h 2 k d c o s 2 k x 2 ω t where h is the wave height k is the wave number x is the distance along the longitudinal direction ω is the wave frequency and d and t represent the water depth and time respectively based on the static boundary method the water particle velocity was specified in the horizontal and vertical directions on the inlet boundary for wave generation the particle velocity equations based on the stokes ii wave theory are as follows 7 u h π h t c o s h k d k z s i n h k d c o s k x ω t 3 4 π 2 h 2 c o s h 2 k d 2 k z t l s i n h 4 k d c o s 2 k x 2 ω t 8 u v π h t s i n h k d k z s i n h k d s i n k x ω t 3 4 π 2 h 2 s i n h 2 k d 2 k z t l s i n h 4 k d s i n 2 k x 2 ω t where u h and u v represent the components of the particle velocity in the horizontal and vertical directions respectively z is the vertical coordinate used to describe wave movement and z 0 denotes the still water level t is the wave period and l is the wavelength therefore a nwt was established with a length of 20 m width of 0 06 m height of 1 m and water depth of 0 6 m because the numerical simulations were conducted in 2d the width of the nwt did not affect the simulation results therefore the extrudemeshdict and createpatchdict dictionaries in openfoam were used to ensure that the computational domain had only one grid layer in the width direction to greatly reduce the number of grids required for the numerical calculations thus saving the computational cost mesh size plays a significant role in the accuracy of the numerical results thus mesh convergence was studied to determine a reasonable mesh system with high accuracy and efficiency for wave generation firstly the mesh size was globally refined along the horizontal x axis and vertical z axis directions respectively the wave height was set to 0 05 m and the wave period was set to 3 s the cell sizes remained at 0 01 m in the vertical direction and were set to 0 06 m 0 04 m 0 03 m and 0 02 m in the horizontal direction respectively fig 1 a shows that mesh refinement in the horizontal direction has little effect on wave elevation prediction accuracy and the numerical results are in good agreement with the theoretical data hd and vd represent the cell size unit m in the horizontal and vertical directions respectively the simulation times consumed by the four cell sizes hd0 06 vd0 01 hd0 04 vd0 01 hd0 03 vd0 01 and hd0 02 vd0 01 were 647 s 829 s 856 s and 1279 s respectively then the cell sizes remained at 0 04 m in the horizontal direction and were set to 0 015 m 0 01 m 0 007 m and 0 005 m in the vertical direction respectively fig 1 b shows that the prediction accuracy for the wave elevation is not good under the hd0 04 vd0 015 cell size for vertical cell sizes of less than 0 01 m the numerical results change very little as the cell size decreases the simulation times consumed by the four cell sizes hd0 04 vd0 015 hd0 04 vd0 01 hd0 04 vd0 007 and hd0 04 vd0 005 were 482 s 829 s 1011 s and 1290 s respectively the time consumed gradually increased as the mesh refinement level increased secondly to reduce the time consumed in the simulation without reducing the calculation accuracy the hd0 04 vd0 01 cell size was used to capture the free surface elevation near the still water level and the hd0 04 vd0 04 cell size was used in other domains namely local mesh refinement fig 2 compares the predicted wave elevation based on global mesh refinement only the hd0 04 vd0 01 cell size and local mesh refinement the wave elevations predicted by the two mesh generation schemes agree well and the times consumed by the two schemes were 829 s and 445 s respectively thus local mesh refinement is a good mesh generation scheme that efficiently generates high accuracy incident waves the numerical results prove that the wave generation is mesh convergent 2 3 validation a numerical simulation scheme based on the above mentioned 2d nwt is presented to investigate the interaction between nonlinear waves and partially submerged structures fig 3 shows the computational domain of the interaction between stokes ii waves and a semi immersed horizontal cylinder the radius of the cylinder is 0 05 m and the centre coincides with the still water level optimal boundary conditions were applied to the numerical simulations the left side inlet and right side outlet of the nwt were used to generate incident waves and to avoid wave reflection respectively thus the velocity boundary condition was used for the inlet and the wave mode of shallow water absorption was used for the outlet the wall boundary condition was applied for the structure and the nwt bottom and the type keyword fixedvalue was applied to ensure zero velocity at these boundaries the boundary condition at the top side of the nwt was set to inletoutlet which was used to avoid backflow the numerical simulations in this study were performed in 2d thus the front and back sides of the nwt should be set to empty the density and kinematic viscosity of the water were set to 1000 kg m3 and 10 6 m2 s respectively and the density and kinematic viscosity of the air were set to 1 kg m3 and 1 48 10 5 m2 s respectively the mesh generation scheme proposed for wave generation may be unsuitable for the numerical calculation of wave interaction with structures thus further mesh refinement is needed around structures where high velocity gradients may occur fig 3 to study mesh convergence three mesh refinement levels coarse middle and fine were applied to simulate the wave interaction with a semi immerged cylinder respectively the normalised wave force amplitude f h v see eq 9 was used for the mesh convergence study 9 f h v 2 f r m s ρ w a t e r g r a l where r is the cylinder radius l is the cylinder length a is the wave amplitude root mean square rms is also called the quadratic mean and is obtained by summing the square of all values finding its mean value then calculating the root f r m s is the rms of the horizontal wave force f h or the vertical wave force f v and 2 f r m s denotes the wave force amplitude the f r m s equation can be expressed as follows 10 f r m s 1 t 0 t f h v 2 t according to the principle of dixon et al 1979 the theoretical wave forces acting on structures in the horizontal and vertical directions are 11 f h 1 2 c d ρ w a t e r s h t u h u h c m ρ w a t e r v t u h t 12 f v c m ρ w a t e r v t u v t ρ w a t e r g v t v 0 where c d and c m are the drag and inertia coefficients respectively s h t is the instantaneous immersed projection area of the structure in the horizontal direction v t and v 0 are the instantaneous and initial immersed volumes of the structure respectively the last term in eq 12 was subtracted to analyse only the dynamic force the incident wave height was set to 0 05 m and the wave period was set to 1 s fig 4 shows the numerical results of the horizontal and vertical forces acting on the cylinder under different mesh refinement levels regarding the prediction of f h calculation errors between the no mesh refinement coarse mesh middle mesh and fine mesh were approximately 18 27 2 32 and 2 01 respectively regarding the prediction of f v calculation errors between the no mesh refinement coarse mesh middle mesh and fine mesh were approximately 8 22 2 48 and 0 79 respectively the numerical results obtained by the middle and fine meshes show very little discrepancy proving that mesh convergence is guaranteed additionally the times consumed for numerical simulations under coarse middle and fine meshes were 626 s 1714 s and 2587 s respectively considering the calculation accuracy and efficiency the middle mesh was selected for the following simulations the time step plays a significant role in the accuracy of the numerical results thus the time convergence was studied to select a reasonable maximum courant maxco number for the numerical simulations fig 5 shows the numerical results of the horizontal and vertical forces acting on the cylinder under different maxco numbers regarding the prediction of f h calculation errors between maxco numbers of 1 0 65 and 0 5 were approximately 0 71 and 0 36 respectively regarding the prediction of f v calculation errors between maxco numbers of 1 0 65 and 0 5 were approximately 0 86 and 0 085 respectively thus the calculations are time convergent additionally the times consumed for the numerical simulations under maxco numbers of 1 0 65 and 0 5 were 1421 s 1714 s and 1929 s respectively due to the small discrepancy in time consumed a maxco number of 0 5 was selected to guarantee stable numerical calculations to validate the accuracy and reliability of the numerical model numerical simulations were conducted for the interaction between the stokes ii waves and a semi immersed cylinder the incident wave amplitudes were set to 0 01 m 0 015 m 0 02 m 0 03 m 0 04 m and 0 05 m respectively and the wave period was set to 1 s in this study considering the selection of calculation parameters and for batter comparing with other research results thus the f h v see eqs 9 and 10 obtained by our present simulations represented by p were compared with the linear theory results represented by t the experiment data martin and dixon 1983 represented by e and the published numerical results tan loh et al 2018 represented by n fig 6 the difference between p and t increases as the wave amplitude increases primarily because the theoretical results are independent of a r additionally the linear theory is only valid for small a r values as a r gradually increases the nonlinearity of the wave forces acting on the cylinder increases and cannot be accurately predicted by linear theory namely the linear theory has a weaker prediction accuracy for large a r values the overall tendencies of our present results experimental data and published numerical results are similar meanwhile for a r less than 0 6 the errors between p n e and t were approximately 8 12 14 21 and 13 51 respectively thus our present results show better agreement with the theoretical data at low a r values furthermore comparing p and e reveals that the minimum and average errors were approximately 0 04 and 3 04 respectively it is indicated that our results agree well with the experimental results in summary the numerical model proposed in this study can efficiently and accurately predict stokes ii wave interaction with partially submerged structures 3 results and discussion subsea pipe valve structures are the critical components of subsea equipment and the dynamic behaviours are of critical concern for controlling the process of lowering through the splash zone during installation the size of valve is much smaller than the size of pipe thus the pipe valve structure is a multi scale structure the mechanism of the interaction between the waves and the pipe valve structures is significantly different from that of other simple structures e g cylinders and boxes multi scale structures will produce significant multi scale coupling phenomena when interacting with nonlinear waves structural interactions at different scales complicate the wave motion track produce strong nonlinear wave loads and increase the wave forces acting on the structures and the possibility of structural damage we performed numerical calculations on the interactions between the incident wave and the independent valve structure and the incident wave and the pipe valve structure fig 7 the valve has a length of 0 06 m a height of 0 06 m and a centre that coincides with the still water level the pipe has a length of 1 5 m and height of 0 06 m the distance between the top of pipe and the still water level is 0 03 m four wave gauges wg1 wg2 wg3 and wg4 were deployed near the valve to record the surrounding wave fields wg1 and wg2 were placed on the left side of the valve whereas wg3 and wg4 were located on the right side wg2 and wg3 were very close 0 02 m to the sides of the valve the incident wave height was set to 0 06 m and the wave period was set to 1 5 s fig 8 a shows the calculated wave forces acting on an independent valve structure the nonlinearity of the horizontal and vertical forces acting on the valve was relatively weak fig 8 b shows that the nonlinearity of the wave forces is significantly greater on the valve of the pipe valve structure than that on the independent valve structure because of the pipe additionally the maximum absolute values of the horizontal and vertical forces acting on the valve of the pipe valve structure all increase significantly indicating that the pipe valve structure is more prone to structural damage than the independent valve structure for an independent valve structure fig 9 a shows the wave elevation time histories at different wave gauges it can be found that the nonlinearity of the wave elevations near the valve is relatively weak the recorded wave crests were larger at wg1 and wg2 than at wg3 and wg4 primarily due to the wave reflection effect produced by the valve compared with the independent valve structure fig 9 b shows that the nonlinearity of wave elevations near the valve of the pipe valve structure is significantly enhanced additionally the motion track of incident waves becomes more complicated the wave crests and troughs upstream of the valve significantly increase and the wave crests downstream of the valve obviously decreases this section investigates the effects of valve height ratio valve length ratio and valve spacing on the wave forces subjected by pipe valve structures in the following numerical calculations the wave height was set to 0 06 m the wave period was set to 1 5 s thus the subsea pipe valve structures can be completely submerged during the wave cycle the total simulation time was set to 24 s additionally the decomposepardict dictionary in openfoam was used to conduct parallel computation which breaks the geometry and associated fields into sub fields and distributes them to different processors for calculation parallel computing primarily decomposes the grids and fields runs the application in parallel and post processes the decomposed fields all the simulations in this study were executed on a computer with an intel r core tm i7 6700hq cpu with eight physical cores therefore eight cores were used to run in parallel for every simulation case greatly reducing the execution time 3 1 effect of valve height ratio on wave forces acting on the subsea pipe valve structure the effect of the valve height ratio on wave forces subjected by the subsea pipe valve structure was studied by setting two valves with specified heights on a pipe fig 10 lpipe and hpipe represent the length and height of the pipe respectively lvalve1 and hvalve1 represent the length and height of the first valve hereinafter referred to as valve 1 respectively and lvalve2 and hvalve2 represent the length and height of the second valve hereinafter referred to as valve 2 respectively d12 denotes the spacing between valves 1 and 2 and the numerical simulations are divided into two groups in the first group of simulations the height of valve 2 remained at 0 06 m and the height of valve 1 increased from 0 01 m to 0 06 m at 0 01 m increments in the second group of simulations the height of valve 1 remained at 0 06 m and the height of valve 2 increased from 0 01 m to 0 06 m at 0 01 m increments the positive and negative signs indicate the direction of the wave forces f h and f v represent the maximum horizontal and vertical forces acting on the structures in a specific simulation case respectively f h and f v represent the minimum horizontal and vertical forces acting on the structures in a specific simulation case respectively f h m e a n and f v m e a n represent the average horizontal and vertical forces acting on the structures in a specific simulation case respectively 3 1 1 first simulation group in the first group the valve height ratio between valves 1 and 2 varies from 1 6 to 1 table 1 lists the six configurations of the geometrical model fig 11 shows the horizontal and vertical forces acting on the pipe valves 1 and 2 at different valve height ratios fig 11 a shows that the change in the valve height ratio had little effect on the wave forces subjected by the pipe which can be nearly neglected additionally the vertical force acting on the pipe is greater than the horizontal force and plays a significant role in the wave forces acting on the completely submerged pipe fig 11 b shows that the horizontal force acting on valve 1 changed significantly as the height ratio increased f h increased as the height ratio increased due to the increased wave reflection effect caused by the increased height of valve 1 the incident wave crest upstream of valve 1 gradually increased thus increasing f h meanwhile the incident wave trough upstream of valve 1 gradually decreased thus gradually increasing the free surface height difference between the left and right sides of valve 1 thus the horizontal pressure difference formed along the x axis direction gradually increased when the wave trough passed through valve 1 resulting in a decrease in f h the relationship between the gradual decrease in f h m e a n and the simultaneous increase in the height of valve 1 was nearly linear fig 11 b shows that f v and f v m e a n first decreased then increased the minimum values of f v and f v m e a n appeared at a valve height ratio of 1 2 primarily because the reflected waves produced by the two valves were coupled above valve 1 a superimposed wave with a large amplitude was formed and a vertical slamming force was produced on valve 1 along the z axis direction fig 12 however as the height of valve 1 continued increasing the incident wave propagation to the right was gradually blocked resulting in an increase in f v and f v m e a n fig 11 c shows that f h acting on valve 2 increased then decreased as the valve height ratio increased due to the wave reflection effect generated by valve 1 the wave crest upstream of valve 2 increased as the height of valve 1 increased resulting in an increase in f h however for ratios greater than 1 2 the forward propagation of the incident wave was gradually blocked and the amount of water acting on valve 2 was reduced resulting in a gradual decrease in f h acting on valve 2 additionally f h m e a n and f h acting on valve 2 increased as the height of valve 1 increased because as the valve 1 height increased the horizontal pressure difference along the x axis direction will increase when the wave trough passed through valve 2 fig 11 c shows that f v and f v m e a n changed relatively little compared with f v acting on valve 2 as the height of valve 1 increased further the minimum value of f v appeared at a valve height ratio of 1 2 for relatively small valve height ratios the vertical force acting on valve 2 was primarily derived from the overtopping wave formed by the wave run up over it fig 13 a additionally the wave reflection effect generated by valve 1 increased the incident wave crest upstream of valve 2 for relatively large height ratios valve 1 blocks the incident wave from propagating to the right at this time fig 13 b shows that the vertical force acting on valve 2 was primarily derived from the overtopping wave formed by wave run up over valve 1 thus resulting in a decrease in f v fig 14 shows the wave force time history of the subsea pipe valve structure at valve height ratios of 1 6 and 1 the nonlinearity of the wave force acting on the pipe is weaker than that of the partially submerged valves primarily because the pipe is completely submerged below the still water level nonlinear phenomena e g wave reflection wave blockage and wave run up have little effect on the pipe additionally there are non zero initial vertical forces acting on each structure primarily because when each structure is analysed separately it will be subjected by the vertical stokes ii wave pressure 3 1 2 second simulation group in the second group the valve height ratios between valves 1 and 2 vary from 6 to 1 table 2 lists six configurations of the geometrical model fig 15 shows the horizontal and vertical forces acting on each structure at different height ratios unlike the two valves the pipe was always completely submerged so the nonlinearity of the wave forces acting on it was relatively weak additionally fig 15 a shows that the increase in the height of valve 2 had little effect on the wave forces subjected by the pipe which can basically be neglected fig 15 b shows that f h acting on valve 1 changed little when the height ratio decreased from 6 to 2 then decreased significantly primarily because of the wave reflection effect produced by valve 2 the reflected wave propagated to the left and the reflection effect increased as the height of valve 2 increased thus the wave force acting on valve 1 was partially offset by the reflected wave resulting in a decrease in f h fig 16 shows that the effect of the reflected wave on valve 1 increased as the height of valve 2 increased when the overtopping wave impacted valve 2 additionally the free surface height difference between the left and right sides of valve 1 gradually increased as the height of valve 2 increased therefore when the wave trough passed through valve 1 the horizontal pressure difference along the x axis direction gradually increased resulting in a decrease in f h additionally the relationship between the gradual decrease in f h m e a n and the simultaneous increase in the height of valve 2 was nearly linear fig 15 b also shows that f v and f v m e a n acting on valve 1 changed little as the height of valve 2 increased f v acting on valve 1 was primarily derived from the overtopping wave slamming force caused by the wave run up over valve 1 which gradually decreased as the height ratio decreased from 6 to 6 4 then the change in f v was irregular but relatively small and the minimum value of f v appeared at a height ratio of 6 4 the main reason is that the gradual increase in the height of valve 2 had a certain effect on the motion behaviour of the overtopping wave thereby affecting the overtopping wave force acting on valve 1 fig 15 c shows that as the height of valve 2 increased f h acting on valve 2 remained basically unchanged however f h and f h m e a n increased significantly and the maximum value of f h acting on valve 2 appeared at a height ratio of 6 4 the horizontal force acting on valve 2 along the x axis direction was primarily derived from the overtopping wave formed by wave run up over valve 1 which basically propagated to the right in the form of horizontal projectile motion fig 17 the actual force area of valve 2 in the horizontal direction increased as its height increased thus resulting in an increasing f h comparing figs 13 b and 17 shows that the motion track of the overtopping wave was significantly different under different valve 2 heights thus the actual force area of valve 2 will be affected the vertical force acting on valve 2 was primarily derived from the overtopping wave generated by valve 1 which will produce the slamming force on valve 2 along the z direction the slamming force is proportional to the height difference between the two valves thus the values of f v relatively large when the top of valve 2 does not exceed the still water level fig 15 c the minimum value of f v appeared at a height ratio of 6 2 then f v increased as the height of valve 2 increased due to the decreased height difference 3 2 effect of valve length ratio on wave forces acting on the subsea pipe valve structure the effect of the valve length ratio on wave forces subjected by the subsea pipe valve structure was studied by setting two valves with specified lengths on a pipe the numerical simulations were divided into two groups in the first group of simulations the length of valve 2 remained at 0 06 m and the length of valve 1 increased from 0 01 m to 0 06 m at 0 01 m increments in the second group of simulations the length of valve 1 remained at 0 06 m and the length of valve 2 increased from 0 01 m to 0 06 m at 0 01 m increments 3 2 1 first simulation group table 3 lists the detailed dimensions of the subsea pipe valve structure model in the first group the valve length ratio between valves 1 and 2 varies from 1 6 to 1 fig 18 a shows that the variation in the length ratio has little effect on the wave forces acting on the pipe in the horizontal and vertical directions the corresponding reasons for the numerical results are the same as those in section 3 1 the horizontal force acting on valve 1 was primarily derived from the upstream incident wave and changes in the length of valve 1 had little effect on the wave shape thus fig 18 b shows that f h and f h m e a n acting on valve 1 were basically independent of the increased length ratio additionally the relationship between the decrease in f v f v and f v m e a n acting on valve 1 and the simultaneous increase in the length ratio was approximately linear the obvious linear relationship was primarily due to the force caused by the wave pressure during individual structure analysis additionally the difference between f v m e a n and f v increased as the length of valve 1 increased the vertical force acting on valve 1 was primarily derived from the overtopping wave slamming force formed by the wave run up over it and the slamming force was proportional to the slamming area projected on valve 1 park et al 2013 fig 18 c shows that f h and f h m e a n acting on valve 2 basically remained unchanged as the length of valve 1 increased f h acting on valve 2 was primarily derived from the overtopping wave formed by the wave run up over valve 1 additionally the distance between the valve 2 and left side of valve 1 gradually increased thus for relatively short valve 1 lengths the overtopping wave had a greater impact on valve 2 resulting in larger f h the maximum f h value appeared at a ratio of 2 6 as the length valve 1 continued increasing the effect of the overtopping wave on valve 2 weakened thus f h acting on valve 2 decreased fig 18 c shows that as the length ratio increased f v and f v m e a n remained almost constant f v underwent a relatively large change the vertical force acting on valve 2 was primarily derived from the overtopping wave generated by valve 1 the overtopping wave propagated to the right in the form of horizontal projectile motion producing a slamming force acting on valve 2 along the z direction however the change in the length of valve 1 affected the motion behaviour of the overtopping wave fig 19 thereby affecting the f v acting on valve 2 within a certain range 3 2 2 second simulation group in the second group the length of valve 1 remained at 0 06 m and the length of valve 2 increased from 0 01 m to 0 06 m at 0 01 m increments table 4 lists the detailed dimensions of the subsea pipe valve model similar to the above mentioned simulation results the horizontal and vertical forces acting on the pipe were basically independent of the structural changes fig 20 a and the vertical force acting on the pipe was greater than the horizontal force the horizontal force acting on valve 1 was primarily derived from the incident wave because the dimension remained unchanged valve 1 had little effect on the upstream wave crest and trough fig 20 b shows that as the valve length ratio decreased f h acting on valve 1 changed slightly while f h m e a n remained almost constant f h suddenly decreased at a length ratio of 1 might be because of the left propagating reflected wave generated by valve 2 in the other five cases f h remained almost constant fig 20 b also shows that as the valve length ratio decreases f v and f v m e a n acting on valve 1 basically remained unchanged however the change in f v was relatively large the overtopping wave generated by the wave run up over valve 1 played a significant role in the vertical force acting on it fig 21 shows that the change in valve 2 length affected the overtopping wave motion behaviour thus affecting f v acting on valve 1 within a certain range the horizontal force acting on valve 2 was primarily derived from the right propagating overtopping wave generated by valve 1 and the change in the length of valve 2 had little effect on its horizontal force area the motion behaviour of the overtopping wave changed as the length of valve 2 increased resulting in slight changes in f h and f h acting on valve 2 fig 20 c f h m e a n acting on valve 2 remained almost constant which indicating that the change in the length of valve 2 had little effect on the overall change in the horizontal force acting on it fig 20 c also shows that the overall trend of f v f v and f v m e a n acting on valve 2 decreased as the length of valve 2 increased the relationship between the forces and the length ratio was approximately linear primarily due to the force caused by the wave pressure when valve 2 was analysed individually additionally the difference between f v m e a n and f v increased as the length of valve 2 increased f v acting on valve 2 was primarily derived from the overtopping wave slamming force generated by valve 1 fig 21 the slamming force is proportional to the force area of valve 2 in the vertical direction moreover the right propagating overtopping wave was affected by the change in the length of valve 2 3 3 effect of valve spacing on wave forces acting on the subsea pipe valve structure the effect of the valve spacing on wave forces subjected by the subsea pipe valve structure was studied by setting three valves with heights and lengths of 0 06 m on a pipe fig 22 the spacing between valve 1 and valve 2 d12 was equal to the spacing between valve 2 and valve 3 d23 increased from 0 02 to 0 1 m at 0 02 m increments we used the presented numerical method to calculate the wave forces acting on each structure at different spacings fig 23 a shows that the change in valve spacing had little effect on the wave forces subjected by the pipe corresponding reasons were the same as in previous sections fig 23 b shows that f h acting on valve 1 was basically the same for different spacings and was primarily derived from the upstream incident wave however f h acting on valve 1 was much smaller at a valve spacing of 0 02 m primarily because valve 1 was subjected by the strong wave reflection effect produced by valve 2 under small spacing additionally the reflected wave produced a large f h acting on valve 1 along the x axis direction as the valve spacing continued increasing the reflection effect weakened thus f h was basically independent of the spacing at spacings greater than 0 04 m fig 23 b also shows that valve 1 experienced the maximum f v value at a valve spacing of 0 02 m primarily because the effect of the reflected wave generated by valve 2 on valve 1 was relatively strong when spacing was small thus a superimposed wave with a larger amplitude was formed above valve 1 unlike f h f v acting on valve 1 experienced a relatively large change as the spacing increased for spacing greater than 0 04 m as the valve spacing increased the reflection effect of valve 2 on valve 1 weakened but affected the motion behaviour of the overtopping wave thereby the f v acting on valve 1 was affected within a certain range the results obtained indicated that for valve 1 the sensitivity of horizontal force to the variation of valve spacing was less than that of vertical force fig 23 c shows that valve 2 experienced maximum f h and minimum f h values at spacings of 0 02 and 0 1 m respectively f h acting on valve 2 was derived from the overtopping wave impact force caused by wave run up over valve 1 the effect of the wave impact force on valve 2 weakened as the spacing increased fig 24 a shows that for a valve spacing of 0 02 m the overtopping wave directly impacted valve 2 in the form of horizontal projectile motion as the spacing continued increasing figs 24 b and c the overtopping wave impact point was located in the groove between valves 1 and 2 additionally f h acting on valve 2 was relatively large at small valve spacings of 0 02 m and 0 04 m primarily due to the wave reflection effect generated by valve 3 the effect of the left propagating reflected wave on valve 2 weakened as the spacing increased the vertical force acting on valve 2 changed less than the horizontal force as the spacing increased f v and f v m e a n were basically independent of the valve spacing the f v acting on valve 2 was relatively small at a spacing of 0 1 m but remained largely unchanged in the other cases the results obtained indicated that for valve 2 the sensitivity of vertical force to the variation of valve spacing was less than that of horizontal force fig 23 d shows that f h acting on valve 3 increased then decreased as the valve spacing increased the maximum value of f h appeared at a valve spacing of 0 04 m the horizontal wave force acting on valve 3 was primarily derived from the overtopping wave generated by the upstream valves the overtopping wave propagated to the right and directly impacted valve 3 at relatively small valve spacings thus forming a relatively large f h as the spacing continued increasing a large number of overtopping waves fell into the grooves between valves figs 24 b and c thus f h acting on valve 3 gradually decreased fig 23 d shows that the vertical force acting on valve 3 changed slightly compared to the horizontal force as the spacing increased for valve spacing from 0 02 to 0 06 m f v acting on valve 3 was basically independent of the valve spacing as the spacing continued increasing f v increased obviously the vertical force acting on valve 3 was primarily derived from the overtopping wave slamming force generated by the other two valves therefore for spacing greater than one valve length the effect of the overtopping wave on valve 3 in the vertical direction gradually weakened the results obtained indicated that for valve 3 the sensitivity of vertical force to the variation of valve spacing was less than that of horizontal force 4 conclusions we performed numerical simulations based on the openfoam software package to study the interaction between nonlinear waves and partially submerged subsea pipe valve structures the subsea pipe valve as a kind of multi scale structure has more complicated hydrodynamic performance under nonlinear incident waves than other simple structures such as cylinders and boxes we performed a series of numerical calculations of the interaction between stokes ii waves and a semi immersed horizontal cylinder to study the mesh and time convergence and to validate the accuracy of the presented numerical model further we compared the modelling results with the experimental data published numerical results and theoretical results the calculations are mesh and time convergent and the presented numerical method has good accuracy and high efficiency the conclusions of the research are summarised as follows 1 compared with an independent valve structure the wave forces acting on a subsea pipe valve structure had strong nonlinearity and the valve of the pipe valve structure was subjected to larger horizontal and vertical forces additionally for a subsea pipe valve structure the nonlinearity of incident waves near the valve was significantly enhanced the motion track of incident waves became obviously complicated 2 we studied the effect of changes in valve structure and valve distribution on wave forces acting on the subsea pipe valve structures by setting different valve height ratios valve length ratios and valve spacings the interaction between nonlinear waves and subsea pipe valve structures produces strong nonlinear phenomena near the free surface such as wave reflection wave blockage and wave run up because the pipe was always in a completely submerged state the nonlinearity of the wave force acting on the pipe was relatively small compared with that of the partially submerged valves additionally changes in the valve structure and valve distribution had little effect on wave forces subjected by the pipe the modelling results showed that the wave force acting on the partially submerged valves was strongly nonlinear which indirectly indicated that the wave force cannot be accurately predicted by theoretical equations 3 numerical calculations of the wave force acting on the valves under different valve height and length ratios revealed that the horizontal force acting on valve 1 was primarily derived from the incident wave and from the reflected wave generated by valve 2 the horizontal force acting on valve 2 was primarily derived from the incident wave upstream and from the overtopping wave formed by the wave run up over valve 1 the vertical wave force acting on valve 1 was primarily derived from the overtopping wave that it generated and from the reflected wave generated by valve 2 the vertical wave force acting on valve 2 was primarily derived from the overtopping wave formed by the wave run up over valves 1 and 2 the overtopping wave propagated to the right in the form of horizontal projectile motion the motion behaviour of the overtopping wave was affected by valve structure changes 4 numerical calculations of the wave force acting on the valves under different valve spacings revealed that for valves 2 and 3 the spacing had a greater influence on the horizontal force acting on the valves than the vertical force but for valve 1 the result was the opposite of the above the maximum value of f h and the minimum values of f h and f v acting on the valves usually appeared under relatively small valve spacing the horizontal and vertical forces acting on the valves were primarily derived from the incident reflected and overtopping waves the latter two types of waves were more sensitive to spacing changes and the change in valve spacing affected the motion behaviour of the overtopping wave however in practical ocean engineering a group of pipe valve structures is generally surrounded by other groups of pipe valve structures or the external support frames of subsea equipment these pipe valve structures are often arranged in parallel inside the subsea equipment therefore studying the hydrodynamic performances of the subsea pipe valve structures using 2d numerical models has limitations ignored the influence of the surrounding structures on the pipe valve future work will investigate the interaction between nonlinear waves and pipe valve structures within 3d subsea equipment declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors are grateful for the financial support from the national key research and development program of china grant no 2016yfc0303701 the national natural science foundation of china grant no 51879271 the 111 project b18054 the brazilian research council cnpq grant no 305657 2017 8 and the carlos chagas filho foundation faperj grant no e 26 202 600 2019 
20521,the dynamic behaviours of subsea pipe valve structures the principal components of subsea equipment are of critical concern for the control of the lowering through the splash zone during installation nonlinear interactions between waves and pipe valve combinations are challenging the investigation of the wave forces acting on large dimension structures this paper proposes a numerical model to study the nonlinear hydrodynamic performance of partially submerged pipe valve structures a two dimensional 2d numerical water tank nwt was established to efficiently generate high accuracy incident waves and a semi immersed horizontal cylinder was applied to the numerical simulations of wave structure interaction wsi to study the mesh and time convergence the numerical model was validated with a comparative analysis of the modelling results with experimental data other numerical results and theoretical results numerical simulations of the interaction between stokes ii waves and subsea pipe valve structures were performed and the effects of the valve height ratio valve length ratio and valve spacing were investigated the subsea pipe valve structure is a kind of multi scale structure the wave forces exhibited stronger nonlinearity when acting on the partially submerged valves than on the completely submerged pipe changes in valve structure and distribution significantly increased the overall change in the wave forces acting on the valves the stronger nonlinearity was primarily derived from phenomena such as wave reflection wave blockage and wave run up the numerical results provide references for the structure and strength designs and offshore installations of large subsea equipment like subsea manifolds keywords subsea pipe valve structures partially submerged numerical water tank wave structure interaction nonlinearity 1 introduction the development of offshore oil industry technology and the increased water depth of offshore oilfields have accelerated the development of subsea production systems to exploit deepwater oil and gas resources subsea production systems play a significant role in the extraction of deepwater hydrocarbons have a wide application range and high efficiency and are less affected by environmental loads cao et al 2016 hong et al 2018 lindseth et al 2019 jamaludin 2019 subsea production systems are composed of vital subsea equipment such as subsea manifolds xmas trees and pipeline end terminations mason and upchurch 1996 bernt 2004 the four primary phases of lowering subsea equipment from the installation ship to the seabed consist of lifting equipment from the deck of the installation ship lowering through the splash zone lowering in deep waters and approaching the seabed veritas 2011 the nonlinear wave force acting on subsea structures in the second phase may result in structural damage such as deformation and bending therefore more information on wsi must be provided before conducting practical offshore installations wsi is a typical problem in ocean and coastal engineering that has been studied by many researchers using different approaches such as analytical solutions physical experiments and numerical simulations buccino and martinelli 2020 summarised the arguments of the papers gathered in a special issue named interaction between waves and maritime structures primarily the structural and functional performances additionally regarding the functional performance it was subdivided into the hydraulic morphodynamic and floating body responses analytical method is relatively more cost effective and efficient for studying wsi under certain conditions and provides a good scientific understanding of the hydrodynamic characteristics of structures in the wsi process fang et al 2018 presented an analytical solution based on the linear potential theory to predict hydrodynamic wave forces subjected by girder type bridge decks under hurricane generated oblique water waves jalón et al 2019 considered the linear wave theory and the head loss caused by the constriction of flow to develop an analytical model of the oblique incident wave interaction with a maritime structure and extended it to irregular waves bahena jimenez et al 2020 obtained formulas that obey a power law function for the reflection and transmission coefficients and the wave elevation for the linear water wave interaction with a cycloidal breakwater in presence of a sloping beach however the analytical method has limitations such as the potential flow models established under the assumption of inviscid and irrotational fluid flow and cannot adequately address the velocity fields around structures and the strong nonlinear effect li et al 2020a analytically and experimentally investigated the interaction between water waves and a submerged perforated quarter circular caisson breakwater wave energy dissipation near the breakwater crown is considerable owing to flow separation but cannot be considered in the potential solution therefore at a water depth of 0 5 m the reflection and transmission coefficients calculated by the analytical solution are slightly larger than those measured by the experimental tests extensive studies on physical wsi experiments have been reported based on physical water tanks different wave generators such as piston flap and plunger are used to generate different types of waves lamberti et al 2011 focused on wave induced horizontal forces on the deck front described a series of large scale experiments on exposed jetties and provided guidelines on the optimal logging frequency or low pass filter to be used if the experimental loads were obtained by pressure integration rodríguez and spinneken 2016 conducted a series of experimental tests in regular and irregular wave conditions concerning the nonlinear loading and dynamic response of a heaving rectangular box in two dimensions applied four absorbing flap type wavemakers to generate incident wave conditions and obtained all experimental data in the long wave flume sayeed et al 2017 conducted experiments to study the change in wave loads for different sizes of small spherical bodies at different proximities to a fixed structure a hydraulically actuated wave board and a wave absorbing beach were respectively equipped on both sides of the towing tank huang et al 2018 experimentally and numerically investigated hurricane induced wave forces on a box girder deck of a coastal bridge in the experiments the periodic waves were produced on the left side of the wave flume using a wave generator without reflection yan et al 2019 used a piston type wavemaker to produce the plunging wave based on the focused wave theory and experimentally and numerically studied the plunging wave impacts on a box shape structure physical experiments a traditional research approach are highly accurate and reliable but have limitations such as long research time high cost and scale restriction the rapid development of computational fluid dynamics cfd and improved computational power allow numerical simulations to provide an economic highly efficient and powerful alternative to perform the wsi investigations numerical study of wsi requires the development of a nwt which can overcome limitations of physical model tests such as model size and viscous similarity many researchers including anbarsooz et al 2013 dao et al 2018 wu and hsiao 2018 and marques machado et al 2018 have conducted studies on nwts finnegan and goggins 2015 used the commercial software ansys cfx to develop a cfd nwt model and introduced a rectangular prism structure into the model to investigate a linear irregular ocean wave interaction with a structure ghezelbashan and d mello 2017 used cfd package ansys fluent with a stokes v wave to model the nonlinear high amplitude ocean wave and used ansys workbench to investigate wave interaction with a vertical slender cylindrical member miquel et al 2018 analysed the performance of different wave generation and absorption methods in cfd based nwts using the open source hydrodynamic model reef3d and conducted a sensitivity analysis for quantifying and comparing the differences in absorption quality between these methods aggarwal et al 2019 used the reef3d to conduct cfd based numerical simulations to study breaking wave characteristics and the influence of the breaker location on the wave impact loads of a jacket structure the numerical simulations in this study were performed using openfoam a free and open source cfd package that uses the finite volume method to solve the discretised navier stokes equations extensive numerical simulations involving the interaction between waves and structures have been reported based on the openfoam software package hu et al 2016 used openfoam to simulate wsis and developed a new boundary condition for extreme waves the new boundary condition was implemented to simulate the interaction with a fixed floating truncated cylinder and a simplified fpso islam et al 2019 used openfoam to analyse wave radiation due to heave surge and pitch by a box type floating structure based on cfd simulations and applied the waves2foam toolbox to generate and absorb free surface waves based on openfoam package gao et al 2020 used a 2d numerical wave flume to numerically investigate wave loads during gap resonance between a fixed box and a vertical wall and employed the waves2foam toolbox to produce incident waves at the boundaries and avoid wave re reflection in the water flume the operational environment during the lowering and installation of subsea equipment is often harsh especially strong nonlinear phenomena such as wave breaking and splashing affect the process of lowering through the splash zone environmental loads can cause structural damage to subsea equipment leading to installation failures or engineering accidents in subsea production systems subsea manifolds as the critical equipment are used to simplify the system to minimise the usage of subsea pipelines and risers and to optimise fluid flow during production the subsea manifold is an arrangement of pipes and valves aimed at combining distributing controlling and monitoring fluid flow bai and bai 2019 the pipe valve structure is a multi scale critical component installed inside the subsea equipment and it is necessary to investigate its hydrodynamic performance under nonlinear incident waves for example the subsea manifold contains different types of valves e g hydraulic ball valve hydraulic gate valve and manual ball valve of different heights and lengths the close arrangement of the valves causes the hydrodynamic behaviour of a valve will be affected by adjacent valves this study performed numerical calculations to investigate the interaction between nonlinear waves and partially submerged pipe valve structures we investigated the effects of the valve height ratio valve length ratio and valve spacing on wave forces subjected by subsea pipe valve structures in a 2d nwt and analysed the reasons for wave force changes the obtained results provide references for the structure and strength designs and valve layout of subsea pipe valve structures the rest of this paper proceeds as follows section 2 presents the numerical method used in the current study introduces the governing equations uses the static boundary method to generate stokes ii waves and determines the mesh generation scheme a series of numerical simulations for the interaction between waves and a semi immersed cylinder are performed to study the mesh and time convergence and to validate the numerical model in section 3 a series of numerical simulations are conducted to calculate the horizontal and vertical forces acting on partially submerged subsea pipe valve structures at different valve structures and valve distributions section 4 provides conclusions based on the results 2 numerical model 2 1 governing equations with respect to an incompressible two phase water and air flow the densities of both fluids are constants the governing equations are the continuity and momentum equations the continuity equation is given by 1 u 0 where u is the velocity vector in the volume of fluid method α 0 α 1 represents the water volume fraction in each cell for α 1 it means that the cell is full of water for α 0 it means that the cell is full of air in addition to these two cases it represents the air water interface thus eq 1 can be reduced to the following form 2 α t u α u r α 1 α 0 where u r represents a relative velocity and u r α 1 α is an artificial compression term for limiting the interface smearing rusche 2003 the momentum equation is given by 3 ρ u t ρ uu μ u p g x ρ σ t κ α α where p is the dynamic pressure g is the gravitational acceleration x is the position vector σ t denotes the surface tension coefficient κ α denotes the surface curvature of the air water interface and ρ and μ are the density and viscosity of the mixture respectively the equations of which are as follows 4 ρ α ρ w a t e r 1 α ρ a i r 5 μ α μ w a t e r 1 α μ a i r 2 2 wave generation based on the static boundary method practical wave height in the ocean is generally limited with respect to the wavelength or water depth and sometimes it can reach a relatively large value for the finite amplitude wave the nonlinear effects caused by the fluctuating free surface must be considered namely the motion and dynamic conditions of the free surface are nonlinear considering the calculational accuracy and cost this study uses the static boundary method to generate nonlinear waves for wave generation and absorption many researchers used the waves2foam within openfoam which is a third party toolkit developed by jacobsen et al 2012 in this study we used the ihfoam toolbox to generate and absorb incident waves which is embedded in openfoam and can be applied to generate different types of waves e g cnoidal stokes i stokes ii and stokes v additionally the active wave absorption of ihfoam works simultaneously with wave generation to dissipate incident waves ihfoam is the fastest wave generation method whereas waves2foam is 11 slower because of the use of relaxation zones martínez ferrer et al 2018 in the present study combined with the setting of related parameters and according to the range of application of the various wave theories proposed by le méhauté 1976 stokes ii wave theory is the most suitable for this paper additionally the stokes ii wave theory is representative widely used in the investigation of wsis and the basis for investigating the interactions between structures and more complex waves the corresponding free surface elevation is expressed as follows 6 η h 2 c o s k x ω t k h 2 16 c o s h k d s i n h 3 k d 2 c o s h 2 k d c o s 2 k x 2 ω t where h is the wave height k is the wave number x is the distance along the longitudinal direction ω is the wave frequency and d and t represent the water depth and time respectively based on the static boundary method the water particle velocity was specified in the horizontal and vertical directions on the inlet boundary for wave generation the particle velocity equations based on the stokes ii wave theory are as follows 7 u h π h t c o s h k d k z s i n h k d c o s k x ω t 3 4 π 2 h 2 c o s h 2 k d 2 k z t l s i n h 4 k d c o s 2 k x 2 ω t 8 u v π h t s i n h k d k z s i n h k d s i n k x ω t 3 4 π 2 h 2 s i n h 2 k d 2 k z t l s i n h 4 k d s i n 2 k x 2 ω t where u h and u v represent the components of the particle velocity in the horizontal and vertical directions respectively z is the vertical coordinate used to describe wave movement and z 0 denotes the still water level t is the wave period and l is the wavelength therefore a nwt was established with a length of 20 m width of 0 06 m height of 1 m and water depth of 0 6 m because the numerical simulations were conducted in 2d the width of the nwt did not affect the simulation results therefore the extrudemeshdict and createpatchdict dictionaries in openfoam were used to ensure that the computational domain had only one grid layer in the width direction to greatly reduce the number of grids required for the numerical calculations thus saving the computational cost mesh size plays a significant role in the accuracy of the numerical results thus mesh convergence was studied to determine a reasonable mesh system with high accuracy and efficiency for wave generation firstly the mesh size was globally refined along the horizontal x axis and vertical z axis directions respectively the wave height was set to 0 05 m and the wave period was set to 3 s the cell sizes remained at 0 01 m in the vertical direction and were set to 0 06 m 0 04 m 0 03 m and 0 02 m in the horizontal direction respectively fig 1 a shows that mesh refinement in the horizontal direction has little effect on wave elevation prediction accuracy and the numerical results are in good agreement with the theoretical data hd and vd represent the cell size unit m in the horizontal and vertical directions respectively the simulation times consumed by the four cell sizes hd0 06 vd0 01 hd0 04 vd0 01 hd0 03 vd0 01 and hd0 02 vd0 01 were 647 s 829 s 856 s and 1279 s respectively then the cell sizes remained at 0 04 m in the horizontal direction and were set to 0 015 m 0 01 m 0 007 m and 0 005 m in the vertical direction respectively fig 1 b shows that the prediction accuracy for the wave elevation is not good under the hd0 04 vd0 015 cell size for vertical cell sizes of less than 0 01 m the numerical results change very little as the cell size decreases the simulation times consumed by the four cell sizes hd0 04 vd0 015 hd0 04 vd0 01 hd0 04 vd0 007 and hd0 04 vd0 005 were 482 s 829 s 1011 s and 1290 s respectively the time consumed gradually increased as the mesh refinement level increased secondly to reduce the time consumed in the simulation without reducing the calculation accuracy the hd0 04 vd0 01 cell size was used to capture the free surface elevation near the still water level and the hd0 04 vd0 04 cell size was used in other domains namely local mesh refinement fig 2 compares the predicted wave elevation based on global mesh refinement only the hd0 04 vd0 01 cell size and local mesh refinement the wave elevations predicted by the two mesh generation schemes agree well and the times consumed by the two schemes were 829 s and 445 s respectively thus local mesh refinement is a good mesh generation scheme that efficiently generates high accuracy incident waves the numerical results prove that the wave generation is mesh convergent 2 3 validation a numerical simulation scheme based on the above mentioned 2d nwt is presented to investigate the interaction between nonlinear waves and partially submerged structures fig 3 shows the computational domain of the interaction between stokes ii waves and a semi immersed horizontal cylinder the radius of the cylinder is 0 05 m and the centre coincides with the still water level optimal boundary conditions were applied to the numerical simulations the left side inlet and right side outlet of the nwt were used to generate incident waves and to avoid wave reflection respectively thus the velocity boundary condition was used for the inlet and the wave mode of shallow water absorption was used for the outlet the wall boundary condition was applied for the structure and the nwt bottom and the type keyword fixedvalue was applied to ensure zero velocity at these boundaries the boundary condition at the top side of the nwt was set to inletoutlet which was used to avoid backflow the numerical simulations in this study were performed in 2d thus the front and back sides of the nwt should be set to empty the density and kinematic viscosity of the water were set to 1000 kg m3 and 10 6 m2 s respectively and the density and kinematic viscosity of the air were set to 1 kg m3 and 1 48 10 5 m2 s respectively the mesh generation scheme proposed for wave generation may be unsuitable for the numerical calculation of wave interaction with structures thus further mesh refinement is needed around structures where high velocity gradients may occur fig 3 to study mesh convergence three mesh refinement levels coarse middle and fine were applied to simulate the wave interaction with a semi immerged cylinder respectively the normalised wave force amplitude f h v see eq 9 was used for the mesh convergence study 9 f h v 2 f r m s ρ w a t e r g r a l where r is the cylinder radius l is the cylinder length a is the wave amplitude root mean square rms is also called the quadratic mean and is obtained by summing the square of all values finding its mean value then calculating the root f r m s is the rms of the horizontal wave force f h or the vertical wave force f v and 2 f r m s denotes the wave force amplitude the f r m s equation can be expressed as follows 10 f r m s 1 t 0 t f h v 2 t according to the principle of dixon et al 1979 the theoretical wave forces acting on structures in the horizontal and vertical directions are 11 f h 1 2 c d ρ w a t e r s h t u h u h c m ρ w a t e r v t u h t 12 f v c m ρ w a t e r v t u v t ρ w a t e r g v t v 0 where c d and c m are the drag and inertia coefficients respectively s h t is the instantaneous immersed projection area of the structure in the horizontal direction v t and v 0 are the instantaneous and initial immersed volumes of the structure respectively the last term in eq 12 was subtracted to analyse only the dynamic force the incident wave height was set to 0 05 m and the wave period was set to 1 s fig 4 shows the numerical results of the horizontal and vertical forces acting on the cylinder under different mesh refinement levels regarding the prediction of f h calculation errors between the no mesh refinement coarse mesh middle mesh and fine mesh were approximately 18 27 2 32 and 2 01 respectively regarding the prediction of f v calculation errors between the no mesh refinement coarse mesh middle mesh and fine mesh were approximately 8 22 2 48 and 0 79 respectively the numerical results obtained by the middle and fine meshes show very little discrepancy proving that mesh convergence is guaranteed additionally the times consumed for numerical simulations under coarse middle and fine meshes were 626 s 1714 s and 2587 s respectively considering the calculation accuracy and efficiency the middle mesh was selected for the following simulations the time step plays a significant role in the accuracy of the numerical results thus the time convergence was studied to select a reasonable maximum courant maxco number for the numerical simulations fig 5 shows the numerical results of the horizontal and vertical forces acting on the cylinder under different maxco numbers regarding the prediction of f h calculation errors between maxco numbers of 1 0 65 and 0 5 were approximately 0 71 and 0 36 respectively regarding the prediction of f v calculation errors between maxco numbers of 1 0 65 and 0 5 were approximately 0 86 and 0 085 respectively thus the calculations are time convergent additionally the times consumed for the numerical simulations under maxco numbers of 1 0 65 and 0 5 were 1421 s 1714 s and 1929 s respectively due to the small discrepancy in time consumed a maxco number of 0 5 was selected to guarantee stable numerical calculations to validate the accuracy and reliability of the numerical model numerical simulations were conducted for the interaction between the stokes ii waves and a semi immersed cylinder the incident wave amplitudes were set to 0 01 m 0 015 m 0 02 m 0 03 m 0 04 m and 0 05 m respectively and the wave period was set to 1 s in this study considering the selection of calculation parameters and for batter comparing with other research results thus the f h v see eqs 9 and 10 obtained by our present simulations represented by p were compared with the linear theory results represented by t the experiment data martin and dixon 1983 represented by e and the published numerical results tan loh et al 2018 represented by n fig 6 the difference between p and t increases as the wave amplitude increases primarily because the theoretical results are independent of a r additionally the linear theory is only valid for small a r values as a r gradually increases the nonlinearity of the wave forces acting on the cylinder increases and cannot be accurately predicted by linear theory namely the linear theory has a weaker prediction accuracy for large a r values the overall tendencies of our present results experimental data and published numerical results are similar meanwhile for a r less than 0 6 the errors between p n e and t were approximately 8 12 14 21 and 13 51 respectively thus our present results show better agreement with the theoretical data at low a r values furthermore comparing p and e reveals that the minimum and average errors were approximately 0 04 and 3 04 respectively it is indicated that our results agree well with the experimental results in summary the numerical model proposed in this study can efficiently and accurately predict stokes ii wave interaction with partially submerged structures 3 results and discussion subsea pipe valve structures are the critical components of subsea equipment and the dynamic behaviours are of critical concern for controlling the process of lowering through the splash zone during installation the size of valve is much smaller than the size of pipe thus the pipe valve structure is a multi scale structure the mechanism of the interaction between the waves and the pipe valve structures is significantly different from that of other simple structures e g cylinders and boxes multi scale structures will produce significant multi scale coupling phenomena when interacting with nonlinear waves structural interactions at different scales complicate the wave motion track produce strong nonlinear wave loads and increase the wave forces acting on the structures and the possibility of structural damage we performed numerical calculations on the interactions between the incident wave and the independent valve structure and the incident wave and the pipe valve structure fig 7 the valve has a length of 0 06 m a height of 0 06 m and a centre that coincides with the still water level the pipe has a length of 1 5 m and height of 0 06 m the distance between the top of pipe and the still water level is 0 03 m four wave gauges wg1 wg2 wg3 and wg4 were deployed near the valve to record the surrounding wave fields wg1 and wg2 were placed on the left side of the valve whereas wg3 and wg4 were located on the right side wg2 and wg3 were very close 0 02 m to the sides of the valve the incident wave height was set to 0 06 m and the wave period was set to 1 5 s fig 8 a shows the calculated wave forces acting on an independent valve structure the nonlinearity of the horizontal and vertical forces acting on the valve was relatively weak fig 8 b shows that the nonlinearity of the wave forces is significantly greater on the valve of the pipe valve structure than that on the independent valve structure because of the pipe additionally the maximum absolute values of the horizontal and vertical forces acting on the valve of the pipe valve structure all increase significantly indicating that the pipe valve structure is more prone to structural damage than the independent valve structure for an independent valve structure fig 9 a shows the wave elevation time histories at different wave gauges it can be found that the nonlinearity of the wave elevations near the valve is relatively weak the recorded wave crests were larger at wg1 and wg2 than at wg3 and wg4 primarily due to the wave reflection effect produced by the valve compared with the independent valve structure fig 9 b shows that the nonlinearity of wave elevations near the valve of the pipe valve structure is significantly enhanced additionally the motion track of incident waves becomes more complicated the wave crests and troughs upstream of the valve significantly increase and the wave crests downstream of the valve obviously decreases this section investigates the effects of valve height ratio valve length ratio and valve spacing on the wave forces subjected by pipe valve structures in the following numerical calculations the wave height was set to 0 06 m the wave period was set to 1 5 s thus the subsea pipe valve structures can be completely submerged during the wave cycle the total simulation time was set to 24 s additionally the decomposepardict dictionary in openfoam was used to conduct parallel computation which breaks the geometry and associated fields into sub fields and distributes them to different processors for calculation parallel computing primarily decomposes the grids and fields runs the application in parallel and post processes the decomposed fields all the simulations in this study were executed on a computer with an intel r core tm i7 6700hq cpu with eight physical cores therefore eight cores were used to run in parallel for every simulation case greatly reducing the execution time 3 1 effect of valve height ratio on wave forces acting on the subsea pipe valve structure the effect of the valve height ratio on wave forces subjected by the subsea pipe valve structure was studied by setting two valves with specified heights on a pipe fig 10 lpipe and hpipe represent the length and height of the pipe respectively lvalve1 and hvalve1 represent the length and height of the first valve hereinafter referred to as valve 1 respectively and lvalve2 and hvalve2 represent the length and height of the second valve hereinafter referred to as valve 2 respectively d12 denotes the spacing between valves 1 and 2 and the numerical simulations are divided into two groups in the first group of simulations the height of valve 2 remained at 0 06 m and the height of valve 1 increased from 0 01 m to 0 06 m at 0 01 m increments in the second group of simulations the height of valve 1 remained at 0 06 m and the height of valve 2 increased from 0 01 m to 0 06 m at 0 01 m increments the positive and negative signs indicate the direction of the wave forces f h and f v represent the maximum horizontal and vertical forces acting on the structures in a specific simulation case respectively f h and f v represent the minimum horizontal and vertical forces acting on the structures in a specific simulation case respectively f h m e a n and f v m e a n represent the average horizontal and vertical forces acting on the structures in a specific simulation case respectively 3 1 1 first simulation group in the first group the valve height ratio between valves 1 and 2 varies from 1 6 to 1 table 1 lists the six configurations of the geometrical model fig 11 shows the horizontal and vertical forces acting on the pipe valves 1 and 2 at different valve height ratios fig 11 a shows that the change in the valve height ratio had little effect on the wave forces subjected by the pipe which can be nearly neglected additionally the vertical force acting on the pipe is greater than the horizontal force and plays a significant role in the wave forces acting on the completely submerged pipe fig 11 b shows that the horizontal force acting on valve 1 changed significantly as the height ratio increased f h increased as the height ratio increased due to the increased wave reflection effect caused by the increased height of valve 1 the incident wave crest upstream of valve 1 gradually increased thus increasing f h meanwhile the incident wave trough upstream of valve 1 gradually decreased thus gradually increasing the free surface height difference between the left and right sides of valve 1 thus the horizontal pressure difference formed along the x axis direction gradually increased when the wave trough passed through valve 1 resulting in a decrease in f h the relationship between the gradual decrease in f h m e a n and the simultaneous increase in the height of valve 1 was nearly linear fig 11 b shows that f v and f v m e a n first decreased then increased the minimum values of f v and f v m e a n appeared at a valve height ratio of 1 2 primarily because the reflected waves produced by the two valves were coupled above valve 1 a superimposed wave with a large amplitude was formed and a vertical slamming force was produced on valve 1 along the z axis direction fig 12 however as the height of valve 1 continued increasing the incident wave propagation to the right was gradually blocked resulting in an increase in f v and f v m e a n fig 11 c shows that f h acting on valve 2 increased then decreased as the valve height ratio increased due to the wave reflection effect generated by valve 1 the wave crest upstream of valve 2 increased as the height of valve 1 increased resulting in an increase in f h however for ratios greater than 1 2 the forward propagation of the incident wave was gradually blocked and the amount of water acting on valve 2 was reduced resulting in a gradual decrease in f h acting on valve 2 additionally f h m e a n and f h acting on valve 2 increased as the height of valve 1 increased because as the valve 1 height increased the horizontal pressure difference along the x axis direction will increase when the wave trough passed through valve 2 fig 11 c shows that f v and f v m e a n changed relatively little compared with f v acting on valve 2 as the height of valve 1 increased further the minimum value of f v appeared at a valve height ratio of 1 2 for relatively small valve height ratios the vertical force acting on valve 2 was primarily derived from the overtopping wave formed by the wave run up over it fig 13 a additionally the wave reflection effect generated by valve 1 increased the incident wave crest upstream of valve 2 for relatively large height ratios valve 1 blocks the incident wave from propagating to the right at this time fig 13 b shows that the vertical force acting on valve 2 was primarily derived from the overtopping wave formed by wave run up over valve 1 thus resulting in a decrease in f v fig 14 shows the wave force time history of the subsea pipe valve structure at valve height ratios of 1 6 and 1 the nonlinearity of the wave force acting on the pipe is weaker than that of the partially submerged valves primarily because the pipe is completely submerged below the still water level nonlinear phenomena e g wave reflection wave blockage and wave run up have little effect on the pipe additionally there are non zero initial vertical forces acting on each structure primarily because when each structure is analysed separately it will be subjected by the vertical stokes ii wave pressure 3 1 2 second simulation group in the second group the valve height ratios between valves 1 and 2 vary from 6 to 1 table 2 lists six configurations of the geometrical model fig 15 shows the horizontal and vertical forces acting on each structure at different height ratios unlike the two valves the pipe was always completely submerged so the nonlinearity of the wave forces acting on it was relatively weak additionally fig 15 a shows that the increase in the height of valve 2 had little effect on the wave forces subjected by the pipe which can basically be neglected fig 15 b shows that f h acting on valve 1 changed little when the height ratio decreased from 6 to 2 then decreased significantly primarily because of the wave reflection effect produced by valve 2 the reflected wave propagated to the left and the reflection effect increased as the height of valve 2 increased thus the wave force acting on valve 1 was partially offset by the reflected wave resulting in a decrease in f h fig 16 shows that the effect of the reflected wave on valve 1 increased as the height of valve 2 increased when the overtopping wave impacted valve 2 additionally the free surface height difference between the left and right sides of valve 1 gradually increased as the height of valve 2 increased therefore when the wave trough passed through valve 1 the horizontal pressure difference along the x axis direction gradually increased resulting in a decrease in f h additionally the relationship between the gradual decrease in f h m e a n and the simultaneous increase in the height of valve 2 was nearly linear fig 15 b also shows that f v and f v m e a n acting on valve 1 changed little as the height of valve 2 increased f v acting on valve 1 was primarily derived from the overtopping wave slamming force caused by the wave run up over valve 1 which gradually decreased as the height ratio decreased from 6 to 6 4 then the change in f v was irregular but relatively small and the minimum value of f v appeared at a height ratio of 6 4 the main reason is that the gradual increase in the height of valve 2 had a certain effect on the motion behaviour of the overtopping wave thereby affecting the overtopping wave force acting on valve 1 fig 15 c shows that as the height of valve 2 increased f h acting on valve 2 remained basically unchanged however f h and f h m e a n increased significantly and the maximum value of f h acting on valve 2 appeared at a height ratio of 6 4 the horizontal force acting on valve 2 along the x axis direction was primarily derived from the overtopping wave formed by wave run up over valve 1 which basically propagated to the right in the form of horizontal projectile motion fig 17 the actual force area of valve 2 in the horizontal direction increased as its height increased thus resulting in an increasing f h comparing figs 13 b and 17 shows that the motion track of the overtopping wave was significantly different under different valve 2 heights thus the actual force area of valve 2 will be affected the vertical force acting on valve 2 was primarily derived from the overtopping wave generated by valve 1 which will produce the slamming force on valve 2 along the z direction the slamming force is proportional to the height difference between the two valves thus the values of f v relatively large when the top of valve 2 does not exceed the still water level fig 15 c the minimum value of f v appeared at a height ratio of 6 2 then f v increased as the height of valve 2 increased due to the decreased height difference 3 2 effect of valve length ratio on wave forces acting on the subsea pipe valve structure the effect of the valve length ratio on wave forces subjected by the subsea pipe valve structure was studied by setting two valves with specified lengths on a pipe the numerical simulations were divided into two groups in the first group of simulations the length of valve 2 remained at 0 06 m and the length of valve 1 increased from 0 01 m to 0 06 m at 0 01 m increments in the second group of simulations the length of valve 1 remained at 0 06 m and the length of valve 2 increased from 0 01 m to 0 06 m at 0 01 m increments 3 2 1 first simulation group table 3 lists the detailed dimensions of the subsea pipe valve structure model in the first group the valve length ratio between valves 1 and 2 varies from 1 6 to 1 fig 18 a shows that the variation in the length ratio has little effect on the wave forces acting on the pipe in the horizontal and vertical directions the corresponding reasons for the numerical results are the same as those in section 3 1 the horizontal force acting on valve 1 was primarily derived from the upstream incident wave and changes in the length of valve 1 had little effect on the wave shape thus fig 18 b shows that f h and f h m e a n acting on valve 1 were basically independent of the increased length ratio additionally the relationship between the decrease in f v f v and f v m e a n acting on valve 1 and the simultaneous increase in the length ratio was approximately linear the obvious linear relationship was primarily due to the force caused by the wave pressure during individual structure analysis additionally the difference between f v m e a n and f v increased as the length of valve 1 increased the vertical force acting on valve 1 was primarily derived from the overtopping wave slamming force formed by the wave run up over it and the slamming force was proportional to the slamming area projected on valve 1 park et al 2013 fig 18 c shows that f h and f h m e a n acting on valve 2 basically remained unchanged as the length of valve 1 increased f h acting on valve 2 was primarily derived from the overtopping wave formed by the wave run up over valve 1 additionally the distance between the valve 2 and left side of valve 1 gradually increased thus for relatively short valve 1 lengths the overtopping wave had a greater impact on valve 2 resulting in larger f h the maximum f h value appeared at a ratio of 2 6 as the length valve 1 continued increasing the effect of the overtopping wave on valve 2 weakened thus f h acting on valve 2 decreased fig 18 c shows that as the length ratio increased f v and f v m e a n remained almost constant f v underwent a relatively large change the vertical force acting on valve 2 was primarily derived from the overtopping wave generated by valve 1 the overtopping wave propagated to the right in the form of horizontal projectile motion producing a slamming force acting on valve 2 along the z direction however the change in the length of valve 1 affected the motion behaviour of the overtopping wave fig 19 thereby affecting the f v acting on valve 2 within a certain range 3 2 2 second simulation group in the second group the length of valve 1 remained at 0 06 m and the length of valve 2 increased from 0 01 m to 0 06 m at 0 01 m increments table 4 lists the detailed dimensions of the subsea pipe valve model similar to the above mentioned simulation results the horizontal and vertical forces acting on the pipe were basically independent of the structural changes fig 20 a and the vertical force acting on the pipe was greater than the horizontal force the horizontal force acting on valve 1 was primarily derived from the incident wave because the dimension remained unchanged valve 1 had little effect on the upstream wave crest and trough fig 20 b shows that as the valve length ratio decreased f h acting on valve 1 changed slightly while f h m e a n remained almost constant f h suddenly decreased at a length ratio of 1 might be because of the left propagating reflected wave generated by valve 2 in the other five cases f h remained almost constant fig 20 b also shows that as the valve length ratio decreases f v and f v m e a n acting on valve 1 basically remained unchanged however the change in f v was relatively large the overtopping wave generated by the wave run up over valve 1 played a significant role in the vertical force acting on it fig 21 shows that the change in valve 2 length affected the overtopping wave motion behaviour thus affecting f v acting on valve 1 within a certain range the horizontal force acting on valve 2 was primarily derived from the right propagating overtopping wave generated by valve 1 and the change in the length of valve 2 had little effect on its horizontal force area the motion behaviour of the overtopping wave changed as the length of valve 2 increased resulting in slight changes in f h and f h acting on valve 2 fig 20 c f h m e a n acting on valve 2 remained almost constant which indicating that the change in the length of valve 2 had little effect on the overall change in the horizontal force acting on it fig 20 c also shows that the overall trend of f v f v and f v m e a n acting on valve 2 decreased as the length of valve 2 increased the relationship between the forces and the length ratio was approximately linear primarily due to the force caused by the wave pressure when valve 2 was analysed individually additionally the difference between f v m e a n and f v increased as the length of valve 2 increased f v acting on valve 2 was primarily derived from the overtopping wave slamming force generated by valve 1 fig 21 the slamming force is proportional to the force area of valve 2 in the vertical direction moreover the right propagating overtopping wave was affected by the change in the length of valve 2 3 3 effect of valve spacing on wave forces acting on the subsea pipe valve structure the effect of the valve spacing on wave forces subjected by the subsea pipe valve structure was studied by setting three valves with heights and lengths of 0 06 m on a pipe fig 22 the spacing between valve 1 and valve 2 d12 was equal to the spacing between valve 2 and valve 3 d23 increased from 0 02 to 0 1 m at 0 02 m increments we used the presented numerical method to calculate the wave forces acting on each structure at different spacings fig 23 a shows that the change in valve spacing had little effect on the wave forces subjected by the pipe corresponding reasons were the same as in previous sections fig 23 b shows that f h acting on valve 1 was basically the same for different spacings and was primarily derived from the upstream incident wave however f h acting on valve 1 was much smaller at a valve spacing of 0 02 m primarily because valve 1 was subjected by the strong wave reflection effect produced by valve 2 under small spacing additionally the reflected wave produced a large f h acting on valve 1 along the x axis direction as the valve spacing continued increasing the reflection effect weakened thus f h was basically independent of the spacing at spacings greater than 0 04 m fig 23 b also shows that valve 1 experienced the maximum f v value at a valve spacing of 0 02 m primarily because the effect of the reflected wave generated by valve 2 on valve 1 was relatively strong when spacing was small thus a superimposed wave with a larger amplitude was formed above valve 1 unlike f h f v acting on valve 1 experienced a relatively large change as the spacing increased for spacing greater than 0 04 m as the valve spacing increased the reflection effect of valve 2 on valve 1 weakened but affected the motion behaviour of the overtopping wave thereby the f v acting on valve 1 was affected within a certain range the results obtained indicated that for valve 1 the sensitivity of horizontal force to the variation of valve spacing was less than that of vertical force fig 23 c shows that valve 2 experienced maximum f h and minimum f h values at spacings of 0 02 and 0 1 m respectively f h acting on valve 2 was derived from the overtopping wave impact force caused by wave run up over valve 1 the effect of the wave impact force on valve 2 weakened as the spacing increased fig 24 a shows that for a valve spacing of 0 02 m the overtopping wave directly impacted valve 2 in the form of horizontal projectile motion as the spacing continued increasing figs 24 b and c the overtopping wave impact point was located in the groove between valves 1 and 2 additionally f h acting on valve 2 was relatively large at small valve spacings of 0 02 m and 0 04 m primarily due to the wave reflection effect generated by valve 3 the effect of the left propagating reflected wave on valve 2 weakened as the spacing increased the vertical force acting on valve 2 changed less than the horizontal force as the spacing increased f v and f v m e a n were basically independent of the valve spacing the f v acting on valve 2 was relatively small at a spacing of 0 1 m but remained largely unchanged in the other cases the results obtained indicated that for valve 2 the sensitivity of vertical force to the variation of valve spacing was less than that of horizontal force fig 23 d shows that f h acting on valve 3 increased then decreased as the valve spacing increased the maximum value of f h appeared at a valve spacing of 0 04 m the horizontal wave force acting on valve 3 was primarily derived from the overtopping wave generated by the upstream valves the overtopping wave propagated to the right and directly impacted valve 3 at relatively small valve spacings thus forming a relatively large f h as the spacing continued increasing a large number of overtopping waves fell into the grooves between valves figs 24 b and c thus f h acting on valve 3 gradually decreased fig 23 d shows that the vertical force acting on valve 3 changed slightly compared to the horizontal force as the spacing increased for valve spacing from 0 02 to 0 06 m f v acting on valve 3 was basically independent of the valve spacing as the spacing continued increasing f v increased obviously the vertical force acting on valve 3 was primarily derived from the overtopping wave slamming force generated by the other two valves therefore for spacing greater than one valve length the effect of the overtopping wave on valve 3 in the vertical direction gradually weakened the results obtained indicated that for valve 3 the sensitivity of vertical force to the variation of valve spacing was less than that of horizontal force 4 conclusions we performed numerical simulations based on the openfoam software package to study the interaction between nonlinear waves and partially submerged subsea pipe valve structures the subsea pipe valve as a kind of multi scale structure has more complicated hydrodynamic performance under nonlinear incident waves than other simple structures such as cylinders and boxes we performed a series of numerical calculations of the interaction between stokes ii waves and a semi immersed horizontal cylinder to study the mesh and time convergence and to validate the accuracy of the presented numerical model further we compared the modelling results with the experimental data published numerical results and theoretical results the calculations are mesh and time convergent and the presented numerical method has good accuracy and high efficiency the conclusions of the research are summarised as follows 1 compared with an independent valve structure the wave forces acting on a subsea pipe valve structure had strong nonlinearity and the valve of the pipe valve structure was subjected to larger horizontal and vertical forces additionally for a subsea pipe valve structure the nonlinearity of incident waves near the valve was significantly enhanced the motion track of incident waves became obviously complicated 2 we studied the effect of changes in valve structure and valve distribution on wave forces acting on the subsea pipe valve structures by setting different valve height ratios valve length ratios and valve spacings the interaction between nonlinear waves and subsea pipe valve structures produces strong nonlinear phenomena near the free surface such as wave reflection wave blockage and wave run up because the pipe was always in a completely submerged state the nonlinearity of the wave force acting on the pipe was relatively small compared with that of the partially submerged valves additionally changes in the valve structure and valve distribution had little effect on wave forces subjected by the pipe the modelling results showed that the wave force acting on the partially submerged valves was strongly nonlinear which indirectly indicated that the wave force cannot be accurately predicted by theoretical equations 3 numerical calculations of the wave force acting on the valves under different valve height and length ratios revealed that the horizontal force acting on valve 1 was primarily derived from the incident wave and from the reflected wave generated by valve 2 the horizontal force acting on valve 2 was primarily derived from the incident wave upstream and from the overtopping wave formed by the wave run up over valve 1 the vertical wave force acting on valve 1 was primarily derived from the overtopping wave that it generated and from the reflected wave generated by valve 2 the vertical wave force acting on valve 2 was primarily derived from the overtopping wave formed by the wave run up over valves 1 and 2 the overtopping wave propagated to the right in the form of horizontal projectile motion the motion behaviour of the overtopping wave was affected by valve structure changes 4 numerical calculations of the wave force acting on the valves under different valve spacings revealed that for valves 2 and 3 the spacing had a greater influence on the horizontal force acting on the valves than the vertical force but for valve 1 the result was the opposite of the above the maximum value of f h and the minimum values of f h and f v acting on the valves usually appeared under relatively small valve spacing the horizontal and vertical forces acting on the valves were primarily derived from the incident reflected and overtopping waves the latter two types of waves were more sensitive to spacing changes and the change in valve spacing affected the motion behaviour of the overtopping wave however in practical ocean engineering a group of pipe valve structures is generally surrounded by other groups of pipe valve structures or the external support frames of subsea equipment these pipe valve structures are often arranged in parallel inside the subsea equipment therefore studying the hydrodynamic performances of the subsea pipe valve structures using 2d numerical models has limitations ignored the influence of the surrounding structures on the pipe valve future work will investigate the interaction between nonlinear waves and pipe valve structures within 3d subsea equipment declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors are grateful for the financial support from the national key research and development program of china grant no 2016yfc0303701 the national natural science foundation of china grant no 51879271 the 111 project b18054 the brazilian research council cnpq grant no 305657 2017 8 and the carlos chagas filho foundation faperj grant no e 26 202 600 2019 
20522,float over deck installation has become a reliable and cost effective method of installing heavy integrated decks for various types of offshore platforms such as the jacket and gbs platforms this operation involves a number of inherent complexities such as the strong nonlinear interactions between the multi body system and environment therefore dynamic modelling of the float over system during the deck load transfer stage is a challenging task particularly the wave induced impacts among the deck barge and platform substructure may generate strong nonlinear dynamics that cannot be accurately investigated by the current standard simulation packages this study develops a constant parameter time domain model cptdm based on cummins equation and state space model for analysing the nonlinear dynamics arising from the float over deck installation of a gbs platform frequency domain hydrodynamic analyses of the installation barge carrying the deck with and without the presence of the gbs are both carried to identify hydrodynamic interactions a code to code verification is performed to verify the accuracy and efficiency of the developed cptdm by comparing the present results with ansys aqwa based on the verified model the nonlinear dynamics of the gbs platform at different load transfer stages are investigated by using poincare maps bifurcation diagrams and phase trajectories keywords float over deck installation constant parameter time domain model nonlinear dynamics wave induced impact steel to steel impact sub harmonic motion 1 introduction with offshore oil gas exploitation activities moving into deeper waters and the deck weight being continually increased the deck installation of offshore platforms has become a major challenge as the deck weight for the large offshore platforms has been far beyond the lift capacity of the traditional heavy lift crane vessels hlcvs float over deck installation has become the most favourite method for installing heavy integrated decks of offshore platforms due to its high installation capacity and cost effectiveness o neill et al 2000 this method was firstly applied in 1970s for installing the heavy decks of gbs platforms in the fjords of norwegian waters where the heavy deck of gbs platform supporting by two barges were mated with the substructure by de ballasting the substructure ramzan 1984 tahar et al 2006 however the first application of float over deck installation method in open waters took place much later in 1981 for the ekoundou field where an integrated deck of 1600 tonnes was transferred from the installation barge onto the substructure by using the hydraulic jacking system gros and lescurat 1982 compared with float over deck installations in sheltered waters the float over deck installation in open water entails strong nonlinear dynamics induced by the complex environmental excitations particularly for the wave induced impacts among the deck substructure and installation barge chen et al 2017 for this reason float over deck installations in open waters often use the shock absorber devices to mitigate the impact forces and to prevent structural damage during the mating operation such as the leg mating unite lmu deck support unit dsu and fender used at the connections between the deck and substructure between the deck and barge and between the barge and substructure respectively in the past 40 years the float over deck installation method has gained rapid development with numerous innovations in the deck load transfer method ranging from hideck method using the barge ballasting to the active mating method using the hydraulic jacking system detailed reviews of the technology development of float over method can be found in o neill et al 2000 seij and de groot 2007 and wang et al 2010 in addition with the development and maturity of the dynamic positioning dp system dp assisted vessel has been recently used in float over deck installations which has the advantage of reducing offshore commissioning time since the anchoring operation of the installation barge is no longer needed bai et al 2014 he et al 2020 the float over deck installation method has been applied for various types of offshore platforms including jacket gbs spar tlp and semi submersible platforms liu and li 2017 chen 2014 besides the installation capacity of float over method has been continually increased the deck installation of arkutun dagi gbs platform executed in 2017 has set the world s new record for the heaviest deck ever installed by the single barge float over method russell 2017 in addition considering its advantages over the traditional lift installation method the float over method has also been recently proposed as a potential method for installing the integrated offshore wind turbine hassan and guedes soares 2017 jiang et al 2018 chen et al 2020 float over deck installation has its own inherent complexities such as the nonlinear mechanical interactions among the deck barge and platform substructure and thus may exhibit complex nonlinear dynamics under the environmental excitations moreover each offshore installation contractor has its own equipment and method for deck installation making it a challenging task for establishing a uniform standard for guiding the design and analysis of the float over system seij and de groot 2007 chen 2014 however some common challenges can still be clearly identified such as the wave induced impacts via the shock absorber devices and the multi body hydrodynamic interaction depending on the dimension of the platform substructure and the number of barges used in the float over operation for ensuring a safe float over operation the motions and impact loads of the float over system during the whole deck load transfer stage need to be strictly controlled since excessive motions and impact loads would lead to severe structural damage and may even cause installation failure chen et al 2014 in this regard wang et al 2014 gave a comprehensive discussion of a complete failure of float over deck installation caused by the failure of the strand jacking system and excessive impact loads hence extensive simulations and model tests are needed to determine the workability and safety of a float over system in the design stage the model test method is essential to investigating the nonlinear dynamics arising from the float over deck installation and is commonly used to identify any unusual behaviour that may occur in the deck mating stage and to provide validation data for the numerical model this method is however costly and thus cannot be used to investigate the effects of design parameters of the float over system on the system dynamics for the purpose of achieving an optimized design of the float over system much literature has been dedicated to the experimental studies on the float over deck installation for various platforms see for example koo et al 2010 for the spar platform kim et al 2019 for the semi submersible platform and bai et al 2020 for the jacket platform apart from the experimental method the numerical method is commonly used to optimize the float over system and to investigate the operational limit of a float over deck installation for a specific engineering project there are a number of standard simulation packages that can be used to analyse the dynamics of float over deck installations such as ansys aqwa aqwa 2019 moses bentley 2020 multisim paulling 1995 and sesam dnv gl 2014 tahar et al 2006 used wamit and multisim to investigate the complex dynamics arising from the float over deck installation for a compliant tower by using twin barges kagita et al 2019 applied moses software to investigate the jacket platform float over deck installation by a series of linear frequency domain hydrodynamic simulations and nonlinear time domain simulations in their study the motion and load control devices such as the lmus dsus jacks fenders and mooring lines were modelled by appropriate linear and nonlinear springs they also discussed the effects of the random wave seed selection barge motions and wave headings on the impact loads at the mating connections among the barge deck and jacket geba et al 2017 presented a novel float over installation technique by using twin pontoons and performed numerical simulations to investigate its feasibility by using ansys aqwa cao et al 2019 applied ansys aqwa to study the nonlinear dynamics of the float over deck installation for a spar platform using twin barges jung et al 2018 studied the impact behaviour between the deck leg and jacket leg via the lmus and between the deck and installation barge via the dsus by using sesam software ma et al 2018 also applied sesam to analyse the installation dynamics of a float over deck installation for a jacket platform using the t shaped barge and compared the numerical results with the model test results in their simulations the effects of the second order mean drift forces on the system dynamics were investigated the aforementioned simulation packages generally adopt a similar approach for modelling the dynamics of float over deck installations which firstly perform hydrodynamic analysis of the float over system in the frequency domain and then analyse the nonlinear dynamics of float over deck installations in the time domain based on the cummins equation cummins 1962 in the time domain simulations the shock absorber devices such as the lmus dsus and fenders are modelled as gap springs that can only resist compression forces for these software the convolution term in the cummins equation which represents the fluid memory effects is directly evaluated by the time domain integration algorithm however direct integration of the convolution term in the time domain is cumbersome and time consuming kashiwagi 2004 taghipour et al 2008 this may result in huge computation time for modelling the float over deck installation since extensive numerical simulations are generally needed to determine the operational limit of a float over system for a given installation site in addition the strong nonlinearity caused by the wave induced impacts among the deck barge and platform substructure may not be accurately simulated since a fixed time step is generally used by these simulation packages resulting in numerical errors in modelling the system discontinuities such as the impact and separation between the mating cone and the corresponding lmu pre installed onto the substructure leg significant discrepancies can be observed in the comparison of the results between the standard simulation packages and the model tests chu et al 1998 tahar et al 2006 therefore an efficient and accurate numerical model is needed to evaluate the nonlinear dynamics arising from the float over installation float over deck installation involves a number of nonlinearities that can only be analysed in the time domain the time domain model described by the cummins equation has been widely used in analyzing the nonlinear dynamics of various types of marine operations such as the float over deck installations and offshore lift installations in addition this model can account for the multi body hydrodynamic interaction effects provided that the frequency domain hydrodynamic analyses consider these effects however the strong hydrodynamic interaction effects may cause gap resonances zhao et al 2020 and may cause the impulse response functions exhibit lightly damped characteristics lewandowski 2008 chen et al 2018 this lightly damped feature may cause negative damping effects energy feed in at low frequencies and may result in large numerical errors in solving the time domain model based on the cummins equation as reported by chen et al 2016 for analyzing the dynamics of two barges for the float over deck installation of a spar platform therefore in many simulation packages the hydrodynamic coupling terms between multiple structures are commonly ignored to obtain converged numerical results in the time domain although the current standard simulation packages still adopts the direct integration method to solve the time consuming convolution term in the cummins equation many studies have been carried out to develop a more efficient and robust method for evaluating the time domain model by the cummins equation since the convolution term is a linear time invariant causal system it can be replaced by either a state space mode or a transfer function making the cummins equation become a hybrid frequency time domain constant parameter model taghipour et al 2008 by this approach the parameters of the time domain model are obtained from the frequency domain results based on the ogilvie relations ogilvie 1966 in addition the time consuming convolution term is replaced by the state space model the parameters of which can be determined via the system identification based on the hydrodynamic coefficients obtained from the frequency domain analyses various parameter estimation methods have been proposed in the literature to obtain the parametric matrices of the state space model see for example the least square fitting method yu and falnes 1995 the realization theory method kristiansen et al 2005 the frequency domain regression method damaren 2000 mccabe et al 2005 and the prony identification method clément 1999 duclos et al 2001 babarit et al 2005 the most prominent advantages of the constant parameter time domain model cptdm based on the state space model are its good efficiency and ease of implementation in the control system kristiansen et al 2005 therefore this approach has been widely used in the offshore and ocean engineering for analysing problems involving floater dynamics and various types of nonlinearities duarte et al 2013 investigated the computation efficiency of the cptdm by using the state space model and concluded that using state space model can save 75 computation time as compared with the direct integration of the standard cummins equation involving the convolution integral the wave induced impact arising from the float over deck installation is an analogy to the traditional bilinear impact oscillators under periodic excitations as analysed by thompson et al 1983 1984 andreaus et al 2010 and zhang et al 2018 therefore the float over system may also exhibit strong nonlinear dynamics such as the sub harmonic and chaotic motions that may suddenly cause the motions and impact forces greatly increased however these nonlinear features cannot be analysed using the current standard simulation packages since they generally adopts a fixed integration time step in recent years a number of studies have been carried out to investigate the nonlinear dynamics of the float over system by using the concept of topological dynamics that is widely used in the analysis of bilinear oscillators in this regard the pioneer work was done by chen et al 2014 they analysed the float over deck installation for a jacket platform by considering only the heaving motions of the float over system based on the cptdm in their model the time consuming convolution integral was replaced by a state space model the parametric matrices of which were determined using the realization theory method in addition they adopted a variable time integration step to accurately capture the system discontinuities during the impact and separation occurring at the lmu and dsu connections besides they applied the topological dynamics analysis tools such as the poincaré map bifurcation diagram impact map and phase trajectory to investigate the motion characteristics of the float over deck installation following their method zou et al 2018 established a two body heaving impact model to analyse the nonlinear dynamics of the jacket platform float over deck installation and identified both the sub harmonic and chaotic motions hu et al 2016 2017 and chen et al 2017 extended the single degree of freedom sdof model by chen et al 2014 to a coupled sway heave roll impact model and a coupled heave roll pitch impact model respectively for analysing the nonlinear dynamics of the jacket platform float over deck installation recently following the same method established by chen et al 2017 for modelling the system discontinuity caused by lmu and dsu impacts zhao et al 2021 developed a multi body dynamic model based on the cummins equation to perform a continuous numerical simulation of the float over deck installation with the rapid load transfer technique in their study the convolution integral in cummins equation was however still solved by the direct integration method their simulations were validated with both experimentally measured raos and simo simulations for the moored barge motions without considering the impact induced nonlinear dynamics one significant improvement made by their method is to consider the effects of barge draft change on the transient dynamics of the float over system within the whole deck mating operation based on the coupled heave roll pitch impact model chen et al 2019 conducted a preliminary study on the nonlinear dynamics of a gbs platform float over deck installation at both the docking and undocking stages they mainly discussed the effects of nonlinear lmu dsu stiffness on the nonlinear dynamics of float deck installation however the current studies based on cptdm have been mostly dedicated to the analysis of the jacket platform float over deck installation and no comparisons have ever been made between the cptdm and the standard simulation packages such as ansys aqwa for the gbs and spar platforms the multi body hydrodynamic interactions cannot be ignored sun et al 2012 adopted a frequency domain approach to analyse the gbs platform float over deck installations and found that the hydrodynamic interaction between the installation barge and gbs may lead to harsher roll motions of the barge deck system therefore the gbs float over deck installation is much more complex compared with the jacket platform deck installations in this study a coupled heave roll pitch impact model based on cptdm is established to analyse the dynamics of a gbs platform float over deck installation the hydrodynamic interaction between the barge and gbs is considered and its effects on the construction of cptdm are discussed a self adaptive integration time step method is adopted to further enhance the efficiency of cptdm for accurately capturing the lmu dsu impacts this is particularly useful for the bifurcation analysis of the system nonlinear dynamics which generally involves a large number of time domain simulations a code to code verification is carried out to demonstrate the accuracy and efficiency of cptdm compared with the standard simulation package ansys aqwa this study mainly has two objectives the first objective is to demonstrate that the proposed cptdm can account for the hydrodynamic interaction effects arising from the gbs float over deck installation and to cross verify the established cptdm with ansys aqwa the second objective is to investigate the nonlinear dynamics of gbs float over deck installation at different deck load transfer stages this paper is arranged as follows section 2 briefly describes the mathematical background of the established cptdm for the modelling of gbs float over deck installations section 3 presents the hydrodynamic analysis of the gbs float over system and discusses the implication of the multi body hydrodynamic interaction between the barge and gbs on the construction of state space models the discussion on the effects of steel to steel damping and the code to code verification between the established cptdm and ansys aqwa are illustrated in section 4 a comprehensive discussion of the nonlinear dynamics arising from the gbs float over deck installation is given in section 5 finally some concluding remarks are given in section 6 2 mathematical background for cptdm for the gbs float over deck installation the gbs float over deck installation involves multi body hydrodynamic interactions and strong nonlinear effects such as the wave induced impacts among the deck barge and gbs thus an efficient time domain model is needed to explore the nonlinear dynamic characteristics of the float over system during the whole deck mating process this paper presents a coupled heave roll pitch cptdm for analysing the nonlinear dynamics arising from the gbs float over deck installations with emphasis on investigating the nonlinear impact behaviour at the lmu and dsu connections among the deck barge and gbs the mathematic background of the cptdm is briefly introduced as follows 2 1 frequency domain hydrodynamic analysis the frequency domain analysis for a gbs platform float over deck installation needs to consider the hydrodynamic interaction between the installation barge and the gbs substructure sun et al 2012 this can be done by the standard 3d hydrodynamic codes based on the linear potential flow theory in this study the well proven 3d hydrodynamic code diffract is applied to perform the frequency domain hydrodynamic analysis of the gbs float over system diffract is mainly developed by prof rodney eatock taylor and has been widely used to analyse multi body floating system sun et al 2010 2012 2012 which adopts a quadratic boundary element method according to matsui and tamaki 1981 the hydrodynamic coefficients of one floating body may change significantly due to the presence of the neighbouring large dimensional structures in addition for multiple floating structures the hydrodynamic forces due to the motion of the neighbouring structure need also to be considered these two aspects of the multi body interaction can both be analysed by diffract while only the first aspect applies to the gbs float over installation since the gbs substructure is fixed onto the seabed the equation of motion for the multi body system in the frequency domain can be expressed as follows 1 ω 2 m a ω i ω b ω g x ˆ i ω f e x c i ω where the matrices m and g are the rigid body mass matrix and hydrostatic stiffness matrix for the n floating bodies respectively ω and i are the wave angular frequency and imaginary unit respectively a ω and b ω are the matrices of the frequency dependent added mass and added damping coefficients respectively f e x c i ω represents the vector of the wave excitation forces for the n floating bodies x ˆ i ω denotes the vector of the complex response amplitude operator rao of the floating structures the wave excitation forces and hydrodynamic coefficients can be readily obtained by diffract for the gbs platform float over installation the effects of the presence of the gbs substructure on the hydrodynamic coefficients and wave excitation forces of the installation barge are analysed 2 2 construction of the cptdm based on the cummins equation the frequency domain model described by eq 1 can only analyse linear problems since float over deck installations are normally executed in relatively calm sea states the linear frequency domain hydrodynamic analysis could be an appropriate method for investigating the fluid structure interaction problem which provides the basis for analysing the nonlinear dynamics in the time domain by the cummins equation for the case of zero forward speed cummins equation has the following expression cummins 1962 2 m a x t 0 t k t τ x τ d τ g x t f e x c t where a is the infinite frequency added mass matrix k t is the matrix of the impulse response functions and f e x c t is the vector of time domain wave excitation forces by eq 2 any nonlinearities associated with the floating structures can be treated as additional loads wu and moan 1996 according to the ogilvie relations ogilvie 1966 the parameters of the time domain model can be obtained based on the frequency domain results the impulse response function can be obtained by taking the inverse fourier transformation of the radiation damping coefficients 3 k i j t 2 π 0 b i j ω cos ω t d ω i j 1 6 n in practice the radiation damping coefficients at higher frequencies are often approximated by the polynomial fitting method due to the limitation of panel size and computation time chen et al 2014 hence the impulse response functions are often approximated by the following expression 4 k i j t k ˆ i j t 2 π 0 σ b i j ω cos ω t d ω 2 π σ b ˆ i j ω cos ω t d ω where σ denotes the upper limit angular frequency for the frequency domain simulation and b ˆ i j ω represents the approximated radiation damping coefficients beyond the upper limit frequency based on the calculated impulse response functions the infinite frequency added mass can be calculated by the following form 5 a i j a i j ω 1 ω 0 k ˆ i j τ sin ω τ d τ the wave excitation forces in the time domain can be obtained from the frequency domain calculations 6 f e x c t re f e x c i ω e i ω t in this way the time domain model and frequency domain model are equivalent for the freely floating condition and can be converted from one to another the accuracy of the time domain model can be assessed by comparing the time domain responses with the rao based response for the freely floating case the rao based responses can be obtained by the following expression 7 x r a o t re x ˆ i ω e i ω t as mentioned earlier the direct evaluation of the time domain model by eq 2 is time consuming and cumbersome which needs to integrate the convolution integral at each time step and is difficult to consider variable integration time steps for accurately capturing the system nonlinearities the convolution integral in the cummins equation can be replaced by the state space model for each k ˆ i j t calculated by eq 4 the corresponding convolution integral can be replaced by the following state space model chen et al 2017 8 z i j t n i j z i j t p i j x j t y i j x j t q i j z i j t where n i j r n n p i j r n 1 and q i j r 1 n are the state space matrices for a single input single output siso system n is the order of the siso state space model z i j t r n 1 is the state vector summarizing all the past information of the system and y i j x j t stands for the wave radiation damping forces due to the jth mode of motion which is also the output of the convolution integral as shown in eq 2 the siso state space matrices in eq 8 can be determined via the system identification method using the realization theory method proposed by kristiansen et al 2005 among the various methods for determining the state space matrices the realization method has been well proven to offer the best quality fit with the smallest number of states duarte et al 2013 detailed description of the implementation procedure for the realization theory method can be found in chen et al 2017 the accuracy of the constructed state space model for replacing the convolution integral can be evaluated by an coefficient r 2 which has the following expression duarte et al 2013 9 r 2 1 l k ˆ i j k i j 2 l k ˆ i j k i j 2 0 r 2 1 where k ˆ i j denotes the calculated impulse response functions by eq 4 k i j represents by output of the state space model by eq 8 for the given input being the dirac delta function and k i j is the mean value of k ˆ i j in general eq 9 involves summations across all the calculated time period for the impulse response functions and the coefficient r 2 reflects the amount of variability of the approximated impulse response functions k i j by the state space model relative to k ˆ i j the closer r 2 is to 1 the higher the accuracy of the state space model is duarte et al 2013 suggested that a value of at least 0 97 for the r 2 should be required when fitting the state space models in order to ensure the accuracy of the time domain dynamic modelling of the floating structures with the impulse response functions in all the modes of motions being replaced by the individual siso state space model a multi input multi output mimo state space model can be constructed resulting in a cptdm based on the cummins equation for the gbs float over deck installation by only considering the coupled heave roll pitch motions the time domain equation of motion of the installation barge for the freely floating condition can be expressed as follows 10 m b a x b t y x b t g x b t f e x c t where y x b t denotes the wave radiation forces and moments which is the output of the mimo state space model 2 3 development of the coupled heave roll pitch impact model based on cptdm by considering only the coupled heave roll pitch motion of the float over system the interactions between the deck and barge via the dsus and between the deck and gbs via the lmus are simplified in the vertical direction this simplification helps to investigate the effects of vertical lmu dsu interactions impact and separation on the nonlinear dynamics of the float over system which may be potentially applicable in modelling the float over deck installations with the anti surge system as reported by tribout et al 2007 in this study both the lmu and dsu are modelled as a bilinear spring damper system which accounts for the deck to substructure stiffness k dts and the deck to barge stiffness k dtb at the lmu and dsu connections respectively these two stiffnesses refer to the steel to steel contact stiffness when the lmu and dsu are fully compressed since they practically have limited load carrying capacity as defined by chen et al 2017 fig 1 shows the sketch of the lmu model and the classification of the lmu interaction depending on the vertical motion of the stabbing cone attached onto the deck leg the interaction between the stabbing cone and the lmu can be divided into three domains ω 0 ω 1 and ω 2 ω 0 is where the stabbing cone has no interaction with the lmu and its lower bound denotes the lmu impact ω 1 is where the stabbing cone interacts with the lmu and the lmu is not fully compressed ω 2 is where the stabbing cone directly interacts with the substructure and its upper bound denotes the steel to steel impact since the dsu interaction between the deck and barge is an analogy to the lmu interaction the detailed description of the dsu interaction is not given in this paper the load compression curve of the lmu and dsu is shown in fig 2 as discussed earlier the lmu and dsu connections behave like the bilinear spring damper system before the lmu and dsu reaching their stroke limit the lmu and dsu interactions between different structures would be governed by a relatively softer stiffness k 1 which represents the combined action of the lmu dsu stiffness and the steel to steel stiffness in series after the lmu and dsu are fully compressed the interaction stiffnesses at the lmu and dsu connection are only the deck to substructure stiffness k dts and the deck to barge stiffness k dtb respectively therefore two types of impacts can be distinguished at the lmu and dsu connections namely the relatively softer impact on the lmu dsu devices and the harder steel to steel impact when the lmu dsu is fully compressed the equivalent vertical stiffness at the lmu and dsu interactions can be derived based on the lmu dsu stiffnesses and the steel to steel stiffnesses 11a k l m u e q k l m u 1 k l m u k d t s k l m u k d t s 0 δ l m u t δ l m u 0 k l m u 2 k d t s δ l m u t δ l m u 0 11b k d s u e q k d s u 1 k d s u k d t b k d s u k d t b 0 δ d s u t δ d s u 0 k d s u 2 k d t b δ d s u t δ d s u 0 where k lmu and k dsu are the stiffnesses of the lmu and dsu devices respectively δ l m u t and δ d s u t are the instantaneous compressions at the lmu and dsu connections respectively δ l m u 0 and δ d s u 0 represents the compression limit at the instant when the lmu and dsu are fully compressed which can be obtained by the following expression 12 δ l m u 0 δ l m u δ l m u k l m u 1 k l m u 2 δ d s u 0 δ d s u δ d s u k d s u 1 k d s u 2 where δ l m u and δ d s u denote the corresponding stroke limits of the lmu and dsu respectively in addition lmus and dsus also have the damping effects to mitigate the impact loads however it is a challenging work to accurately model these damping effects in the numerical model if the experimental data were not provided chen et al 2017 adopted the linear rayleigh damping method to model the lmu dsu damping effects and concluded that the variation of the damping ratios in an appropriate range appear to have no significant effects on the maximum responses and impact loads of the float over system in this study the same method is applied to model the damping effects associated with the lmu and dsu interactions as well as the steel to steel contact the damping coefficients in the mode of heave motions for the lmu and dsu connections can be calculated as follows 13a b l m u b l m u 1 2 μ l m u 1 m d k l m u 1 m d if 0 δ l m u t δ l m u 0 v l m u t 0 0 else b l m u 2 2 μ l m u 2 m d k l m u 2 m d if δ l m u t δ l m u 0 v l m u t 0 0 else 13b b d s u b d s u 1 2 μ d s u 1 m d k d s u 1 m d if 0 δ d s u t δ d s u 0 v d s u t 0 0 else b d s u 2 2 μ d s u 2 m d k d s u 2 m d if δ d s u t δ d s u 0 v d s u t 0 0 else where m d denotes the deck weight μ l m u 1 and μ l m u 2 are the damping ratios of the lmu device and the deck to substructure structural damping respectively μ d s u 1 and μ d s u 2 are the damping ratios of the dsu device and the deck to barge structural damping respectively v l m u t and v d s u t are the vertical velocities of the stabbing cone attached onto the deck leg at the lmu connection and the relative vertical velocities between the contact points on the deck and barge at the dsu connection depending on the wave excitations and the load transfer stages of the float over deck installation the deck would make intermittent interaction with the substructure via the lmu connections and with the barge via the dsu connections the lmu and dsu forces can be calculated based on the instantaneous motions of the contact points such as the stabbing cones for the lmu connections the instantaneous stabbing cone motions can be calculated as follows 14 z l m u t z 0 x 1 t r y x 2 t r x x 3 t v l m u t x 1 t r y x 2 t r x x 3 t where z t denotes the instantaneous vertical position of the stabbing cone considered z 0 is the initial vertical position of the centre of gravity of the deck x 1 x 2 and x 3 are the displacements of the deck in the modes of heave roll and pitch motions respectively and r x and r y are the distances of the stabbing cone relative to the centre of gravity of the deck in x and y directions respectively based on the calculation by eq 14 the instantaneous lmu compression δ l m u t can be determined similar to the calculation of the stabbing cone motions the instantaneous relative vertical motions of the contact points at the dsu connection can also be readily obtained based on the rigid body motions of the deck and barge then the vertical lmu and dsu forces acting on the deck can be calculated as follows 15a f l m u d t k l m u 1 δ l m u t b l m u 1 v l m u t f l m u 0 d if 0 δ l m u t δ l m u 0 k l m u 1 δ l m u 0 k l m u 2 δ l m u t δ l m u 0 b l m u 2 v l m u t f l m u 0 d elseif δ l m u t δ l m u 0 f l m u 0 d else 15b f d s u d t k d s u 1 δ d s u t b d s u 1 v d s u t f d s u 0 d if 0 δ d s u t δ d s u 0 k d s u 1 δ d s u 0 k d s u 2 δ d s u t δ d s u 0 b d s u 2 v d s u t f d s u 0 d elseif δ d s u t δ d s u 0 f d s u 0 d else where f l m u 0 d and f d s u 0 d are the vertical lmu and dsu forces acting on the deck in the calm water condition before the wave excitations f l m u d t and f d s u d t reflects the variation of the lmu and dsu forces relative to the initial condition and will be used to derive the moment forces in the modes of roll and pitch motions once individual lmu forces and dsu forces are all obtained by eq 15 their total forces and moments acting on the deck and barge can be readily derived for the modes of heave roll and pitch motions these forces and moments can be added into the cptdm by eq 10 as additional loads the coupled heave roll pitch impact model for the deck barge system can be expressed as the following matrix form 16 m d 0 0 m b a x d t x b t 0 y x b t 0 0 0 g x d t x b t 0 f e x c t f d s u d t f l m u d t f d s u b t where f d s u d t and f d s u b t are the total dsu forces and moments acting on the deck and barge respectively f l m u d t denotes the total lmu forces and moments acting on the deck the above model provides an efficient way of modelling the wave induced impact behaviour of the float over system the numerical scheme using the 4th order runge kutta integration algorithm described by chen et al 2014 2017 2019 are applied here to derive the time domain results in order to enhance the simulation efficiency a self adaptive integration time step method is adopted here to accurately capture the system discontinuities induced by the lmu dsu impact separation and the steel to steel impact separation as illustrated in fig 3 by this integration method three types of integration time steps can be distinguished 1 dt 0 a relatively coarser time step which is applied in the beginning and where the system discontinuities are not experienced this time step is mostly used in the simulation period which helps to enhance the simulation efficiency 2 dt 1 a relatively finer time step which is applied when the programme have checked that using the initial time step dt 0 would experience the system discontinuity at next time step this time step is then used for the subsequent simulations until that the programme detects that using the finer time step dt 1 would experience the system discontinuity at next time step the time step dt 1 can be calculated as follows 17 d t 1 d t 0 n t where n t is a large positive integer 3 dt 2 a predicted time step to accurately capture the system discontinuity which is calculated based on the 1st order taylor s approximation 18 d t 2 a b s ξ v 0 where v 0 denotes the vertical velocity of the stabbing cone and the relative vertical velocity between the dsu contact points for the lmu and dsu interactions closest to the occurring of system discontinuity respectively and ξ represents the clearance between the current stabbing cone position and the system discontinuities at the lmu connection and between the current position of the dsu contact point on the deck leg and the system discontinuities at the dsu connections by using the self adaptive integration time step method the check of system discontinuities will be carried out for each lmu dsu at each time step and the instant closest to the system discontinuities will be identified this helps to improve the simulation accuracy for modelling the wave induced impact behaviour of the float over deck installation which is however not considered in the standard simulation packages such as ansys aqwa analysis tools for characterising nonlinear dynamics such as the poincaré map phase trajectory impact map and bifurcation diagram are applied in the following sections to analyse the nonlinear motion characteristics arising from the float over deck installation at different load transfer stages the poincaré map plots the displacement versus velocity at a constant phase within a wave period as defined by φ mod t t in which the number of points denotes the periodicity of the motion if there are m points in the poincaré map the motion pattern can be regarded as period m motion the impact map plots the impact velocities versus the impact phase defined as mod t i t where t i is the impact instant the phase trajectory plots the displacement versus velocity for the whole simulation period the bifurcation diagram plots the points in the poincaré map versus the changing control parameter to demonstrate the change of the motion pattern with the increase of the control parameter detailed descriptions of these analysis tools can be found in chen et al 2014 and thompson and stewart 2000 3 hydrodynamic analyses of the gbs float over system and the validation of the constructed state space models for the cptmd 3 1 particulars of the analysed gbs float over system in this study the analysed gbs float over system is loosely based on the model analysed by sun et al 2012 and chen 2014 as shown in fig 4 the water depth is 53 13 m the gbs substructure model is based on the one investigated by walker et al 2008 which consists of a caisson base and 4 vertical columns the gap in between the gbs column and the barge is 2 75 m in the transverse direction for all the different load transfer stages and the gap in between the barge bottom and the top of the gbs caisson is 28 83 m at the 0 load transfer stage the origin of the global earth fixed reference system is located at the centre of the barge in the water plane for all the different deck load transfer stages the particulars of the deck are summarized in table 1 where the values of deck cog is based on the 0 load transfer stage table 2 summarises the particulars of the barge model at different deck load transfer stages it needs to be noted that the modelling of the lmu and dsu connections is crucial to investigating the wave induced nonlinear impact behaviour arising from the float over deck installations due to its complexities many studies were carried out with certain simplifications table 3 summarises the parameters of the lmu and dsu used in the published literature in table 3 n a stands for not applicable which means the parameters were not considered in the numerical model and n g stands for not given which means the parameters were considered but were not provided in the referenced publications apparently the numerical model by jung et al 2018 provided a more realistic modelling of the lmu and dsu interactions since the limited load carrying capacity of lmu dsu damping effects of the lmu dsu and the steel to steel contacts were all modelled therefore the modelling of the lmu dsu interactions in this study follows the method by jung et al 2018 as shown in fig 4 the analysed float over system involves 4 lmus and 6 dsus in this study all the lmus are assumed to be identical in terms of both the stiffness and damping effect this assumption also applied to the dsus therefore the analysed float over system is symmetric about both the x and y axes as shown in fig 4 the specifications of the lmu and dsu connections are summarized in table 4 and table 5 respectively the load capacity of the lmus is assumed to take 70 of the deck weight which is 3850 tonnes for each lmu the load capacity of the dsus is assumed to take 30 of the deck weight which is 1100 tonnes for each dsu the damping characteristics of the steel to steel contacts are not given here which will be discussed in subsequent sections 3 2 frequency domain hydrodynamic analyses of the analysed gbs float over system in this study the frequency domain hydrodynamic analyses of the gbs platform float over system are performed by using the high order panel code diffract since the analysed float over system is symmetric about both the x and y axes only one quarter of the model is analysed in diffract using the two plane symmetry to reduce computation time to investigate the effects of multi body hydrodynamic interactions between the barge and the gbs substructure two hydrodynamic models are analysed which are the barge only model and the barge with gbs the hydrodynamic analysis of the barge only model is only carried out for the 0 deck load transfer stage while hydrodynamic analysis of the barge with gbs model is carried out for the 0 30 50 70 and 100 deck load transfer stages fig 5 shows the meshes of the one quarter body for the two hydrodynamic models at the 0 deck load transfer stage frequency domain analyses are carried out from ω 0 02 rad s to 2 52 rad s with a step of 0 01 rad s for all the different deck load transfer stages the mesh size of the hydrodynamic models was selected by meeting the mesh requirement for the high order potential flow panel code that the characteristic sizes of the panels should be smaller than ¼ of the minimal wave length considered the natural frequencies of the barge in the modes of heave roll and pitch in calm water at the 0 deck load transfer stage are summarized in table 6 which are calculated based on the body mass infinite added mass as well as the derivation of the lmu and dsu stiffnesses the comparisons of the hydrodynamic coefficients of the barge for the cases with and without gbs are shown in fig 6 it can be observed that the hydrodynamic coefficients of the barge are significantly influenced by the neighbouring gbs substructure due to the multi body hydrodynamic interaction effects fig 6 also illustrates the variations of the hydrodynamic coefficients of the barge for the case with gbs at the different deck load transfer stages it seems that the increase of the barge draft from 9 3 m at the 0 deck load transfer stage to 10 65 m at the 100 deck load transfer stage has no significant impact on the hydrodynamic coefficients of the barge this finding is consistent with the results by zhao et al 2021 in this study only the nonlinear dynamics of the float over system under the quartering sea states are analysed and thus the 1st order wave excitation forces of the barge in the modes of heave roll and pitch motions are compared as shown in fig 7 it can be observed that the wave forces acting on the barge at different deck load transfer stages also rarely vary therefore the frequency domain hydrodynamic results of the barge at the 0 load transfer stage will be used in constructing the cptdm in subsequent sections for performing time domain modelling of the wave induced impact behaviour of the float over system at different deck load transfer stages 3 3 validation of the state space models for cptdm based on the frequency domain results shown in section 3 2 a cptdm can be established by replacing the time consuming convolution integral in cummins equation with a state space model fig 8 shows a comparison of the impulse response functions of the barge for the cases with and without the gbs substructure in the modes of heave roll and pitch motions the impulse response functions shown here are calculated by eq 4 based on the integration of the added damping coefficients it can be observed that the impulse response functions of the barge with a neighbouring gbs substructure need slightly longer period to decay to zero this is in consistent with the findings by lewandowski 2008 and chen et al 2016 that the impulse response functions for adjacent floating multi body system exhibit a lightly damped feature however this feature for the case considered here is not so significant as that of twin barges operating side by side analysed by them the calculated impulse response functions shown in fig 8 can be used to determine the state space matrices of the state space models for constructing the cptdm the accuracy of the cptdm can be directly evaluated by the fitting quality of the state space model as compared with the calculated impulse response functions fig 9 shows the comparison of the calculated impulse response functions with the fittings of state space model with different orders for the cases of barge with and without gbs it is found that the fitting quality of the state space model increase with the order of state space model for both cases table 7 summarises the values of r 2 as defined by eq 9 for the state space models constructed for both cases with the same order the state space models for the barge without gbs are found to produce slightly better fitting of the impulse response functions as compared with those for the barge with gbs in other words a slightly higher order state space model is needed for the barge with gbs this is due to the fact that the impulse response functions are more slightly damped for the case of barge with gbs therefore the state space models with order 6 will be used to construct the cptdm for the barge with gbs though an order of 4 can produce satisfactory fitting for the barge without gbs 4 discussion on the effects of steel to steel damping and code to code verification of the cptdm 4 1 effects of the steel to steel damping on the dynamics of float over system as summarized in table 3 different models have been proposed to simulate the lmu and dsu connections in the literature among which the bilinear damper system is considered to be a more realistic numerical representation in this study the bilinear damper system is applied to model the interactions between the deck and substructure and between the deck and barge at the lmu and dsu connections respectively as pointed out by bokhorst et al 2011 the various sources of damping should be carefully considered when modelling the float over deck installations such as the structural damping associated with the steel to steel contacts due to the high stiffness at the steel to steel contacts high frequency oscillations of the deck may be generated due to the steel to steel impacts when the lmus or dsus are fully compressed this phenomenon rises due to the numerical issue that the deck is assumed to be rigid and is of structural damping besides this phenomenon was not observed at all in the model tests bokhorst et al 2011 therefore in this study a linear rayleigh damping defined as b l m u 2 and b d s u 2 in eq 13 is introduced for the steel to steel contacts occurring at the lmu and dsu connections in order to eliminate these unrealistic high frequency oscillations to illustrate the effects of steel to steel damping coefficients on the dynamic behaviour of float over system the relative vertical motions between the two contacts at the dsu connection and the vertical motions of the stabbing cone at the lmu connection are compared for different damping ratios as shown in figs 10 and 11 the results shown in figs 10 and 11 are for the 0 and 100 deck load transfer stages respectively under the same regular wave excitation with the wave height wave frequency and incident wave angle being 1 5 m 0 43 rad s and 45 respectively as shown in fig 10 the dsu experiences steel to steel impacts when the relative vertical motion crossing the dtb impact limit and the case without steel to steel structural damping exhibit high frequency oscillations at the 100 deck load transfer stage the lmu would also experience steel to steel impacts when the vertical displacement of the stabbing cone crossing the dts impact limit and the case without steel to steel structural damping also exhibit high frequency oscillations it is found that the steel to steel damping ratios of 0 05 and 0 1 for the dsu and lmu respectively are adequate to eliminate the high frequency vibrations therefore these coefficients will be applied in the following nonlinear dynamic analyses of the gbs float over deck installation together with the parameters defined in tables 4 and 5 the parameters for constructing the bilinear damper model for the lmu and dsu connections are all determined 4 2 code to code verification of the cptdm the wave induced impact model based on cptdm was firstly proposed by chen et al 2014 their method was further extended by many researchers in terms of expanding the degrees of freedom of the numerical model and improved representation of the lmu and dsu models however the code to code verification of the developed cptdm has not been conducted before in order to demonstrate the accuracy and efficiency of cptdm a code to code verification is carried out here by comparing the numerical results by cptdm with those from the standard simulation package ansys aqwa different from the cptdm ansys aqwa adopts the method of direct evaluating the convolution integral in the time domain with a fixed time step therefore the time domain modelling of wave induced impacts in ansys aqwa cannot accurately capture the system discontinuities caused by the change of the system stiffness which may possibly introduce numerical errors if the chosen time step is not fine enough in addition the developed cptdm is only a time domain model that needs frequency domain hydrodynamic results from other standard panel codes such as diffract while ansys aqwa has its own frequency domain hydrodynamic analysis model the same float over model as defined in section 3 is analysed in ansys aqwa as shown in fig 12 fig 13 illustrates the comparison of the frequency domain hydrodynamic coefficients between ansys aqwa and diffract to assure that the time domain simulations by cptdm and ansys aqwa are based on the same frequency domain results it can be observed that the hydrodynamic coefficients of the barge in the mode of heave motion are almost the same for the two panel codes which means there are no differences in their frequency domain models as defined in eq 1 for the time domain modelling in ansys aqwa each lmu dsu is modelled by two fender elements to form a bilinear damper model with the same parameters as defined in tables 4 and 5 as well as in section 4 1 for the steel to steel damping in the time domain simulations in anasys aqwa the float over system including the deck and barge are constrained to have no surge sway and yaw motions and thus only the coupled heave roll pitch motions are considered making it coincide with the developed cptdm the comparisons of the time domain results are based on the float over system at the 0 load transfer stage excited by the same regular wave excitation with the wave height wave frequency and incident wave angle being 1 5 m 0 5224 rad s and 45 respectively this frequency is specially selected to demonstrate that the developed cptdm can predict sub harmonic motions caused by the wave induced impacts arising from the float over deck installation which will be further discussed in section 5 2 the time integration step applied in ansys aqwa is a fixed value of 0 01 s the cptdm has the time integration steps of dt 0 0 06 s and dt 1 0 01 s and dt 2 is in the order of 10 3 s to 10 4 s as predicted by eq 18 the heave roll and pitch motions of the deck and barge are compared in fig 14 it can be observed that the heave motions by cptdm agree quite well with those by ansys aqwa while they produce quite different roll and pitch motions for both the deck and barge the phase shift for the pitch motion is mainly caused by the differences between the two codes in modelling the lmu dsu damping forces in the developed cptdm the damping effects of the lmu and dsu are only considered for the loading stage when the lmu and dsu are being further compressed however when the compressed lmu and dsu are released to the uncompressed stage these damping effects were not considered to avoid the total lmu dsu forces being negative when the negative damping forces are larger than the positive forces due to compression as shown in eq 13 however in anasys aqwa the damping forces of the lmu dsu are considered for both the compression and decompression stages moreover significant discrepancies are found in the comparison of the roll motions between the cptdm and ansys aqwa which may be due to the fact that the numerical integration errors by ansys aqwa are comparable to the magnitudes of the roll motions since they are only in the order of 10 3 rad in ansys aqwa a 2nd order predict corrector method is used while a 4th order runge kutta method is used in cptdm which has higher accuracy fig 15 shows the comparison of the vertical motions of the stabbing cones l 1 and l 2 significant discrepancies are observed in vertical motions of the stabbing cones the vertical lmu impact forces on the stabbing cones are compared in fig 16 it can be observed that ansys aqwa produces smaller lmu impact forces and their impact duration is found to not coincide with the duration predicted by cptdm the developed cptdm adopts a self adaptive time integration method which helps to accurately predict the instants when lmu impact and separation occurs therefore the discrepancies observed in figs 14 16 may be due to the fact that ansys aqwa adopts a fixed time integration step that cannot accurately model the system continuities caused by the stiffness change which means a much finer time step is needed for ansys aqwa to reduce the errors in the prediction of wave induced impact forces at the lmu and dsu connections furthermore it is clearly shown in fig 15 that the stabbing cone motions calculated by the cptdm are sub harmonic motions period 2 motions while the results by ansys aqwa exhibit harmonic feature having a period equal to the wave period this phenomenon can be further illustrated in the phase trajectories of the deck and barge motions as shown in fig 17 in addition as pointed out by chen et al 2021 for the modelling of the point absorber with end stop mechanism ansys aqwa is found to unable to identify sub harmonic motions caused by the wave induced impacts therefore it may be concluded that ansys aqwa with a fixed time integration step may not be able to identify high order sub harmonic motions caused by the system nonlinearities in addition the computation efficiencies by ansys aqwa and cptdm are compared as shown in table 8 here all the simulations were carried out on the same pc intel xenon cpu e5 2643 v4 3 40 ghz it can be observed that the computation efficiency of cptdm is much higher than that of ansys aqwa this is because the cptdm use the state space model to replace the time consuming convolution integral however the improved computation efficiency by the cptdm become less effective with the simulation length being increased this may be due to the fact that the cptdm would check whether the system discontinuities occur at each time step and adopt a much finer time step defined as dt 2 to accurately capture the system discontinuities which may accounts for more computation time 5 nonlinear dynamics of the gbs float over deck installation at different deck load transfer stages 5 1 brief discussions of the nonlinear dynamics of the float over system at different deck load transfer stages during the deck mating stage the deck weight is gradually transferred from the barge onto the gbs substructure by ballasting the barge down the whole process is generally divided into different deck load transfer stages for the numerical modelling by only considered the coupled heave roll pitch motions of the float over system the mooring system is thus not modelled and the system nonlinearities are mainly caused by two types of wave induced impacts namely the soft lmu dsu impact and the hard dts dtb steel to steel impact by considering the same regular wave excitation with the wave height wave frequency and wave angle being 1 5 m 0 43 rad s and 45 respectively the different impact behaviours of the float over system at different deck load transfer stages are compared fig 18 shows the comparison of the vertical motions of the stabbing cone l 2 at different deck load transfer stages the lmu impact limit and dts impact limit are where soft lmu impact and hard dts impact occur respectively fig 19 shows the comparison of the relative vertical motion of the deck leg d 3 at different deck load transfer stages the dsu impact limit and dtb impact limit are where soft dsu impact and hard dtb impact occur respectively at the 0 deck load transfer stage significant lmu impacts are observed as shown in fig 18 the maximum compression of the lmu l 2 is larger than 0 4 m and the maximum separation between the stabbing cone and lmu at l 2 is about 1 1 m which may generate strong nonlinear dynamics in addition it can be observed from fig 19 that the interaction between the deck and barge at d 3 is within the steel to steel contact region and no dtb impact separation occurs at the 0 deck load transfer stage this is because the load capacity of the dsus is designed to take only 30 of the deck weight and there are significant steel to steel compressions at the dsu connections therefore the nonlinear dynamics of the float over system at the 0 deck load transfer stage are mainly caused by the soft lmu impacts fig 20 shows the impact maps of different lmus at the 0 deck load transfer stage it is found that the four stabbing cones experience different impact behaviours at the corresponding lmu connections and the maximum impact velocities are found at the lmu l 2 that is located in the corner encountering the incident wave as shown in fig 4 the poincaré map and phase trajectory of the deck heave motions at the 0 deck load transfer stage are shown in fig 21 it is clearly shown that the deck exhibits a sub harmonic motion of order 4 namely the period 4 motion this nonlinear feature is induced by the significant soft lmu impacts at the 30 deck load transfer stage it can be observed from figs 18 and 19 that the float over system experiences no discontinuity and behaves like a linear system at this stage the deck and barge interacts with each other via the dtb stiffness k dtb and the deck interacts with the gbs substructure via the linear equivalent lmu stiffness k l m u 1 as defined in eq 11a at the 50 deck load transfer stage both the dts and dtb hard impacts are observed as shown in figs 18 and 19 the dts and dtb impact maps are shown in fig 22 it is found that both the dts and dtb impact velocities are quite small compared with the lmu impact velocities shown in fig 20 at the 0 deck load transfer stage in addition it can be observed in fig 22 that the dsus d 1 and d 4 experience no dtb impact and only the lmu l 2 experiences dts impact showing that the lmus and dsus also exhibit different hard impact behaviours fig 23 plots the phase trajectories of the deck heave motions at the 30 and 50 load transfer stages it is found that the dynamic responses at the two stages are less nonlinear compared with the 0 load transfer stage this is because the float over system behaves like a linear system at the 30 deck load transfer stage and for the 50 load transfer stage the system discontinuities due to the dts and dtb impacts is not so violent as that caused by the lmu impacts at the 0 load transfer stage at the 70 deck load transfer stage as shown in figs 18 and 19 both dtb and dts hard impacts are observed the dtb and dts impact maps are shown in fig 24 different from the 50 load transfer stage all the dsus at the 70 load transfer stage experience dtb impact since the initial compressions of all the dsus at this stage are just at the dtb impact limit in the calm water in addition the dtb impact velocities at the 70 load transfer stage are much larger than the 50 load transfer stage the amplitude of the relative vertical motion at the dsu d 3 at the 70 load transfer stage is much larger than that at the 50 load transfer stage since the deck interacts with the barge mainly via the harder dtb stiffness k dtb and the softer equivalent dsu stiffness k d s u 1 defined in eq 13b at the 50 and 70 load transfer stages respectively at the 100 deck load transfer stage the nonlinear dynamics are similar to the 70 load transfer stage as shown in figs 18 and 19 the float over system experiences dts hard impacts and dtb hard impacts at this stage in addition the dsus are found to be all in compression and no dsu impact separation occurs at this stage the amplitude of the vertical motion of the stabbing cone l 2 at the 100 load transfer stage is found to be slightly larger than that at the 70 load transfer stage apart from this exception the amplitude of the vertical stabbing cone motions is found to generally decrease with the increased deck weight transferred onto the substructure as shown in fig 18 in addition it is found that the relative vertical motion at the dsu connection generally increase with the increased deck weight transferred onto the substructure as shown in fig 19 this is because with deck weight being increasingly transferred onto the substructure the interactions between the deck and substructure and between the deck and barge become stiffer and softer respectively fig 25 plots the dts and dtb impact maps as well as the dsu impact map at the 100 load transfer stage it can be observed that the maximum impact velocities at the dts and dtb impact limits at the 100 load transfer are similar to the 70 load transfer stage in addition similar to the lmu impact observed at the 0 load transfer stage different impact behaviours are observed at different dsu connections as shown in the dsu impact map in fig 25 fig 26 shows the pincaré maps and phase trajectories of the deck heave motions at the 70 and 100 load transfer stages the motion patterns at the two stages also show a periodic feature as the 30 and 50 load transfer stages however the phase trajectories show more violations at the two stages mainly due to the occurring of the significant dts and dtb impacts 5 2 bifurcation analyses of the float over installation system at different load transfer stages as discussed in section 5 1 the nonlinear dynamics of the float over system exhibit different characteristics at the different deck load transfer stages in particular the float over system is found to exhibit strong nonlinear dynamics at the 0 load transfer stage mainly induced by the lmu impacts however the discussions in section 5 1 are based on the same wave excitation it is of great importance to investigate the effects of varying wave excitations on the wave induced impact behaviours of the float over deck installation according to chen et al 2014 the variation of the wave height in the operational sea states is found to have little effect on the motion pattern of the float over system in addition the offshore commissioning of float over deck installation is often limited to a wave height of 1 5 m therefore this study mainly investigate the effects of the wave frequency on the nonlinear dynamics of the float over system by performing bifurcation analysis using the wave frequency as the control parameter a quartering sea state with a fixed wave height of 1 5 m and an incident wave angle of 45 is used for all the subsequent simulations since the float over system would experience more complex coupled heave roll pitch motions fig 27 shows the bifurcation diagrams of the deck heave motion at the 0 load transfer stage with the wave frequency being increased from 0 2 rad s to 2 2 rad s with a frequency step of 0 01 rad s which plots the points in the pincaré map at φ 0 75t for each wave frequency considered the results at other load transfer stages show all periodic motions and thus are not shown here for the time domain simulation at each wave frequency the simulation length is 200t and only the results after 100t when the motions become stable are used to derive the bifurcation diagram in order to eliminate the transient effects by the wave excitation it can be observed from fig 27 that only the 0 load transfer stage exhibit significant motion pattern evolution with the changing wave frequency at the 0 load transfer stage period 2 motions firstly appear around the frequency of 0 4 rad s while the motion pattern quickly become periodic with the frequency increased in addition two significant motion pattern evolution zones can be identified at this stage the first zone is within the frequency range from 0 51 rad s to 0 60 rad s which clearly exhibits the phenomenon of period doubling leading to chaos as shown in fig 28 that is based on a much finer wave frequency step of 0 0002 rad s the other zone is around the wave frequency of 0 8 rad s which shows a stable chaotic regime the poincaré map and phase trajectory of a typical chaotic motion are shown in fig 29 as shown in fig 28 a periodic motion bifurcates to a stable period 2 motion at ω 0 517 rad s which further bifurcates to a period 4 motion with the frequency being increased to 0 525 rad s and subsequently leads to stable chaotic motions which is within the frequency range from 0 53 rad s to 0 546 rad s with the frequency being further increased a frequency doubling phenomenon is observed after the chaotic regime and the motion pattern returns back to the stable period 2 motion after ω 0 549 rad s fig 30 shows the poincaré maps and phase trajectories of three sub harmonic motions with different orders at very neighbouring frequencies it can be observed that a tiny change of the wave frequency would lead to the motion pattern changing from the period 2 motion to the period 8 motion however the points in the poincaré maps are not significantly deflected and the phase trajectories are quite close which means the system nonlinearities are not significant and result in only the weakly sub harmonic motions the maximum lmu and dsu forces for the sub harmonic motions are compared in fig 31 it is observed that the maximum forces slightly increase with the increase of the order of sub harmonic motion though the wave frequency is only with a tiny and negligible change however significant sub harmonic resonances are not observed in this study which may be due to the fact that the steel to steel damping coefficients at the dsu connection are modelled therefore special attentions should be paid to the selection of these damping coefficients in addition the maximum lmu and dsu forces at different load transfer stages for varying wave frequencies are compared as shown in fig 32 for the lmu forces the two lmus l 2 and l 3 located in line with the wave incident direction are found to have larger forces and the maximum forces of different lmus generally decreases with the increase of the wave frequency in addition the 70 and 100 load transfer stages are found to have the largest lmu forces for the dsus different dsus exhibit more diverse variation with the wave frequency and the largest dsu forces are found at the 30 load transfer stage where the dsus experience fully steel to steel contacts similar to the lmu forces the dsu forces are all found to generally decrease with the increase of the wave frequency in addition the largest forces of all the lmus and dsus are found to occur around ω 0 4 rad s which is close to the natural frequency of the barge roll motion as given in table 6 this may be reasonable as the barge roll motion would give rise to the vertical motions of the stabbing cone and thus result in larger impact forces it can be observed from fig 32 that the wave frequency being larger than 0 8 rad s may be preferred for executing the deck mating operation based on the analysed float over model since much smaller lmu and dsu forces will be experienced this finding is consistent with the industry practice as the long period swell will often cause large barge motions and thus offshore operations under swell condition are often executed under a lower sea states 6 concluding remarks this study develops a coupled heave roll pitch impact cptdm for analysing the wave induced impact behaviours of the gbs float over system at the different deck load transfer stages the cptdm is established based on the cummins equation with its time consuming convolution integral being replaced by a state space model the vertical interactions between the deck and barge and between the deck and substructure via the lmu and dsu connections are modelled as a bilinear damper system and are treated as additional external loads to the cptdm in addition the hydrodynamic interaction between the installation barge and gbs substructure is analysed and its effects are taken into account in the cptdm a code to code verification is carried out to demonstrate the accuracy and efficiency of cptdm compared with the standard simulation package ansys aqwa based on the developed cptdm nonlinear dynamics of the gbs float over system at different load transfer stages are analysed some concluding remarks can be drawn from the study 1 the hydrodynamic interaction between the barge and gbs is found to make the impulse response function takes longer time to decay to zero and thus a relatively higher order stage space model is needed to assure the fitting quality of the impulse response function in addition the interaction effect is found to be not so strong as the twin barge cases analysed by chen et al 2016 and thus it does not have significant impact on the construction of cptdm for the gbs float over system 2 the steel to steel damping coefficients are found to significantly mitigate the high frequency oscillations that were not observed in the model tests however the selection of these damping coefficients need to be cautious since they may cause the system being overly damped and thus eliminate some important nonlinear features 3 by comparing the nonlinear dynamics at different deck load transfer stages the 0 deck load transfer stage is found to exhibit the strongest nonlinear dynamics excited by the lmu impacts some weakly sub harmonic motions and chaotic motions are observed at certain wave frequencies in this preliminary study in addition the largest lmu and dsu forces are found to be at the wave frequencies around the barge s natural roll frequency based on the analysed float over system in this study it may be recommended that the execution of float over deck installation is preferred for wave frequencies larger than 0 8 rad s and a much lower sea states may be required for float over deck installations under the swell condition which is consistent with the industrial practices it should be noted that the developed cptdm only considers the coupled heave roll pitch motions of the float over system and ignores the viscous roll damping forces acting on the barge with emphasis on investigating the vertical interactions at the lmu and dsu connections at different load transfer stages for varying wave frequencies therefore the conclusions drawn from the study are limited to the present simplified model and cannot be directly used to guide the engineering practice of float over deck installations the present model needs to be further extended to 6 degrees of freedom to provide a more realistic modelling of float over deck installations and may be extended to multi body system for analysing float over operations for floating platforms such as the spar and semi submersible credit authorship contribution statement ling zhu project administration resources writing review editing meiyan zou methodology software investigation data curation writing original draft visualization mingsheng chen methodology supervision validation formal analysis writing review editing funding acquisition lin li methodology formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the corresponding author would like to acknowledge the support of the national natural science foundation of china grant no 5180090578 and the natural science foundation of hainan province pr china grant no 520ms072 
20522,float over deck installation has become a reliable and cost effective method of installing heavy integrated decks for various types of offshore platforms such as the jacket and gbs platforms this operation involves a number of inherent complexities such as the strong nonlinear interactions between the multi body system and environment therefore dynamic modelling of the float over system during the deck load transfer stage is a challenging task particularly the wave induced impacts among the deck barge and platform substructure may generate strong nonlinear dynamics that cannot be accurately investigated by the current standard simulation packages this study develops a constant parameter time domain model cptdm based on cummins equation and state space model for analysing the nonlinear dynamics arising from the float over deck installation of a gbs platform frequency domain hydrodynamic analyses of the installation barge carrying the deck with and without the presence of the gbs are both carried to identify hydrodynamic interactions a code to code verification is performed to verify the accuracy and efficiency of the developed cptdm by comparing the present results with ansys aqwa based on the verified model the nonlinear dynamics of the gbs platform at different load transfer stages are investigated by using poincare maps bifurcation diagrams and phase trajectories keywords float over deck installation constant parameter time domain model nonlinear dynamics wave induced impact steel to steel impact sub harmonic motion 1 introduction with offshore oil gas exploitation activities moving into deeper waters and the deck weight being continually increased the deck installation of offshore platforms has become a major challenge as the deck weight for the large offshore platforms has been far beyond the lift capacity of the traditional heavy lift crane vessels hlcvs float over deck installation has become the most favourite method for installing heavy integrated decks of offshore platforms due to its high installation capacity and cost effectiveness o neill et al 2000 this method was firstly applied in 1970s for installing the heavy decks of gbs platforms in the fjords of norwegian waters where the heavy deck of gbs platform supporting by two barges were mated with the substructure by de ballasting the substructure ramzan 1984 tahar et al 2006 however the first application of float over deck installation method in open waters took place much later in 1981 for the ekoundou field where an integrated deck of 1600 tonnes was transferred from the installation barge onto the substructure by using the hydraulic jacking system gros and lescurat 1982 compared with float over deck installations in sheltered waters the float over deck installation in open water entails strong nonlinear dynamics induced by the complex environmental excitations particularly for the wave induced impacts among the deck substructure and installation barge chen et al 2017 for this reason float over deck installations in open waters often use the shock absorber devices to mitigate the impact forces and to prevent structural damage during the mating operation such as the leg mating unite lmu deck support unit dsu and fender used at the connections between the deck and substructure between the deck and barge and between the barge and substructure respectively in the past 40 years the float over deck installation method has gained rapid development with numerous innovations in the deck load transfer method ranging from hideck method using the barge ballasting to the active mating method using the hydraulic jacking system detailed reviews of the technology development of float over method can be found in o neill et al 2000 seij and de groot 2007 and wang et al 2010 in addition with the development and maturity of the dynamic positioning dp system dp assisted vessel has been recently used in float over deck installations which has the advantage of reducing offshore commissioning time since the anchoring operation of the installation barge is no longer needed bai et al 2014 he et al 2020 the float over deck installation method has been applied for various types of offshore platforms including jacket gbs spar tlp and semi submersible platforms liu and li 2017 chen 2014 besides the installation capacity of float over method has been continually increased the deck installation of arkutun dagi gbs platform executed in 2017 has set the world s new record for the heaviest deck ever installed by the single barge float over method russell 2017 in addition considering its advantages over the traditional lift installation method the float over method has also been recently proposed as a potential method for installing the integrated offshore wind turbine hassan and guedes soares 2017 jiang et al 2018 chen et al 2020 float over deck installation has its own inherent complexities such as the nonlinear mechanical interactions among the deck barge and platform substructure and thus may exhibit complex nonlinear dynamics under the environmental excitations moreover each offshore installation contractor has its own equipment and method for deck installation making it a challenging task for establishing a uniform standard for guiding the design and analysis of the float over system seij and de groot 2007 chen 2014 however some common challenges can still be clearly identified such as the wave induced impacts via the shock absorber devices and the multi body hydrodynamic interaction depending on the dimension of the platform substructure and the number of barges used in the float over operation for ensuring a safe float over operation the motions and impact loads of the float over system during the whole deck load transfer stage need to be strictly controlled since excessive motions and impact loads would lead to severe structural damage and may even cause installation failure chen et al 2014 in this regard wang et al 2014 gave a comprehensive discussion of a complete failure of float over deck installation caused by the failure of the strand jacking system and excessive impact loads hence extensive simulations and model tests are needed to determine the workability and safety of a float over system in the design stage the model test method is essential to investigating the nonlinear dynamics arising from the float over deck installation and is commonly used to identify any unusual behaviour that may occur in the deck mating stage and to provide validation data for the numerical model this method is however costly and thus cannot be used to investigate the effects of design parameters of the float over system on the system dynamics for the purpose of achieving an optimized design of the float over system much literature has been dedicated to the experimental studies on the float over deck installation for various platforms see for example koo et al 2010 for the spar platform kim et al 2019 for the semi submersible platform and bai et al 2020 for the jacket platform apart from the experimental method the numerical method is commonly used to optimize the float over system and to investigate the operational limit of a float over deck installation for a specific engineering project there are a number of standard simulation packages that can be used to analyse the dynamics of float over deck installations such as ansys aqwa aqwa 2019 moses bentley 2020 multisim paulling 1995 and sesam dnv gl 2014 tahar et al 2006 used wamit and multisim to investigate the complex dynamics arising from the float over deck installation for a compliant tower by using twin barges kagita et al 2019 applied moses software to investigate the jacket platform float over deck installation by a series of linear frequency domain hydrodynamic simulations and nonlinear time domain simulations in their study the motion and load control devices such as the lmus dsus jacks fenders and mooring lines were modelled by appropriate linear and nonlinear springs they also discussed the effects of the random wave seed selection barge motions and wave headings on the impact loads at the mating connections among the barge deck and jacket geba et al 2017 presented a novel float over installation technique by using twin pontoons and performed numerical simulations to investigate its feasibility by using ansys aqwa cao et al 2019 applied ansys aqwa to study the nonlinear dynamics of the float over deck installation for a spar platform using twin barges jung et al 2018 studied the impact behaviour between the deck leg and jacket leg via the lmus and between the deck and installation barge via the dsus by using sesam software ma et al 2018 also applied sesam to analyse the installation dynamics of a float over deck installation for a jacket platform using the t shaped barge and compared the numerical results with the model test results in their simulations the effects of the second order mean drift forces on the system dynamics were investigated the aforementioned simulation packages generally adopt a similar approach for modelling the dynamics of float over deck installations which firstly perform hydrodynamic analysis of the float over system in the frequency domain and then analyse the nonlinear dynamics of float over deck installations in the time domain based on the cummins equation cummins 1962 in the time domain simulations the shock absorber devices such as the lmus dsus and fenders are modelled as gap springs that can only resist compression forces for these software the convolution term in the cummins equation which represents the fluid memory effects is directly evaluated by the time domain integration algorithm however direct integration of the convolution term in the time domain is cumbersome and time consuming kashiwagi 2004 taghipour et al 2008 this may result in huge computation time for modelling the float over deck installation since extensive numerical simulations are generally needed to determine the operational limit of a float over system for a given installation site in addition the strong nonlinearity caused by the wave induced impacts among the deck barge and platform substructure may not be accurately simulated since a fixed time step is generally used by these simulation packages resulting in numerical errors in modelling the system discontinuities such as the impact and separation between the mating cone and the corresponding lmu pre installed onto the substructure leg significant discrepancies can be observed in the comparison of the results between the standard simulation packages and the model tests chu et al 1998 tahar et al 2006 therefore an efficient and accurate numerical model is needed to evaluate the nonlinear dynamics arising from the float over installation float over deck installation involves a number of nonlinearities that can only be analysed in the time domain the time domain model described by the cummins equation has been widely used in analyzing the nonlinear dynamics of various types of marine operations such as the float over deck installations and offshore lift installations in addition this model can account for the multi body hydrodynamic interaction effects provided that the frequency domain hydrodynamic analyses consider these effects however the strong hydrodynamic interaction effects may cause gap resonances zhao et al 2020 and may cause the impulse response functions exhibit lightly damped characteristics lewandowski 2008 chen et al 2018 this lightly damped feature may cause negative damping effects energy feed in at low frequencies and may result in large numerical errors in solving the time domain model based on the cummins equation as reported by chen et al 2016 for analyzing the dynamics of two barges for the float over deck installation of a spar platform therefore in many simulation packages the hydrodynamic coupling terms between multiple structures are commonly ignored to obtain converged numerical results in the time domain although the current standard simulation packages still adopts the direct integration method to solve the time consuming convolution term in the cummins equation many studies have been carried out to develop a more efficient and robust method for evaluating the time domain model by the cummins equation since the convolution term is a linear time invariant causal system it can be replaced by either a state space mode or a transfer function making the cummins equation become a hybrid frequency time domain constant parameter model taghipour et al 2008 by this approach the parameters of the time domain model are obtained from the frequency domain results based on the ogilvie relations ogilvie 1966 in addition the time consuming convolution term is replaced by the state space model the parameters of which can be determined via the system identification based on the hydrodynamic coefficients obtained from the frequency domain analyses various parameter estimation methods have been proposed in the literature to obtain the parametric matrices of the state space model see for example the least square fitting method yu and falnes 1995 the realization theory method kristiansen et al 2005 the frequency domain regression method damaren 2000 mccabe et al 2005 and the prony identification method clément 1999 duclos et al 2001 babarit et al 2005 the most prominent advantages of the constant parameter time domain model cptdm based on the state space model are its good efficiency and ease of implementation in the control system kristiansen et al 2005 therefore this approach has been widely used in the offshore and ocean engineering for analysing problems involving floater dynamics and various types of nonlinearities duarte et al 2013 investigated the computation efficiency of the cptdm by using the state space model and concluded that using state space model can save 75 computation time as compared with the direct integration of the standard cummins equation involving the convolution integral the wave induced impact arising from the float over deck installation is an analogy to the traditional bilinear impact oscillators under periodic excitations as analysed by thompson et al 1983 1984 andreaus et al 2010 and zhang et al 2018 therefore the float over system may also exhibit strong nonlinear dynamics such as the sub harmonic and chaotic motions that may suddenly cause the motions and impact forces greatly increased however these nonlinear features cannot be analysed using the current standard simulation packages since they generally adopts a fixed integration time step in recent years a number of studies have been carried out to investigate the nonlinear dynamics of the float over system by using the concept of topological dynamics that is widely used in the analysis of bilinear oscillators in this regard the pioneer work was done by chen et al 2014 they analysed the float over deck installation for a jacket platform by considering only the heaving motions of the float over system based on the cptdm in their model the time consuming convolution integral was replaced by a state space model the parametric matrices of which were determined using the realization theory method in addition they adopted a variable time integration step to accurately capture the system discontinuities during the impact and separation occurring at the lmu and dsu connections besides they applied the topological dynamics analysis tools such as the poincaré map bifurcation diagram impact map and phase trajectory to investigate the motion characteristics of the float over deck installation following their method zou et al 2018 established a two body heaving impact model to analyse the nonlinear dynamics of the jacket platform float over deck installation and identified both the sub harmonic and chaotic motions hu et al 2016 2017 and chen et al 2017 extended the single degree of freedom sdof model by chen et al 2014 to a coupled sway heave roll impact model and a coupled heave roll pitch impact model respectively for analysing the nonlinear dynamics of the jacket platform float over deck installation recently following the same method established by chen et al 2017 for modelling the system discontinuity caused by lmu and dsu impacts zhao et al 2021 developed a multi body dynamic model based on the cummins equation to perform a continuous numerical simulation of the float over deck installation with the rapid load transfer technique in their study the convolution integral in cummins equation was however still solved by the direct integration method their simulations were validated with both experimentally measured raos and simo simulations for the moored barge motions without considering the impact induced nonlinear dynamics one significant improvement made by their method is to consider the effects of barge draft change on the transient dynamics of the float over system within the whole deck mating operation based on the coupled heave roll pitch impact model chen et al 2019 conducted a preliminary study on the nonlinear dynamics of a gbs platform float over deck installation at both the docking and undocking stages they mainly discussed the effects of nonlinear lmu dsu stiffness on the nonlinear dynamics of float deck installation however the current studies based on cptdm have been mostly dedicated to the analysis of the jacket platform float over deck installation and no comparisons have ever been made between the cptdm and the standard simulation packages such as ansys aqwa for the gbs and spar platforms the multi body hydrodynamic interactions cannot be ignored sun et al 2012 adopted a frequency domain approach to analyse the gbs platform float over deck installations and found that the hydrodynamic interaction between the installation barge and gbs may lead to harsher roll motions of the barge deck system therefore the gbs float over deck installation is much more complex compared with the jacket platform deck installations in this study a coupled heave roll pitch impact model based on cptdm is established to analyse the dynamics of a gbs platform float over deck installation the hydrodynamic interaction between the barge and gbs is considered and its effects on the construction of cptdm are discussed a self adaptive integration time step method is adopted to further enhance the efficiency of cptdm for accurately capturing the lmu dsu impacts this is particularly useful for the bifurcation analysis of the system nonlinear dynamics which generally involves a large number of time domain simulations a code to code verification is carried out to demonstrate the accuracy and efficiency of cptdm compared with the standard simulation package ansys aqwa this study mainly has two objectives the first objective is to demonstrate that the proposed cptdm can account for the hydrodynamic interaction effects arising from the gbs float over deck installation and to cross verify the established cptdm with ansys aqwa the second objective is to investigate the nonlinear dynamics of gbs float over deck installation at different deck load transfer stages this paper is arranged as follows section 2 briefly describes the mathematical background of the established cptdm for the modelling of gbs float over deck installations section 3 presents the hydrodynamic analysis of the gbs float over system and discusses the implication of the multi body hydrodynamic interaction between the barge and gbs on the construction of state space models the discussion on the effects of steel to steel damping and the code to code verification between the established cptdm and ansys aqwa are illustrated in section 4 a comprehensive discussion of the nonlinear dynamics arising from the gbs float over deck installation is given in section 5 finally some concluding remarks are given in section 6 2 mathematical background for cptdm for the gbs float over deck installation the gbs float over deck installation involves multi body hydrodynamic interactions and strong nonlinear effects such as the wave induced impacts among the deck barge and gbs thus an efficient time domain model is needed to explore the nonlinear dynamic characteristics of the float over system during the whole deck mating process this paper presents a coupled heave roll pitch cptdm for analysing the nonlinear dynamics arising from the gbs float over deck installations with emphasis on investigating the nonlinear impact behaviour at the lmu and dsu connections among the deck barge and gbs the mathematic background of the cptdm is briefly introduced as follows 2 1 frequency domain hydrodynamic analysis the frequency domain analysis for a gbs platform float over deck installation needs to consider the hydrodynamic interaction between the installation barge and the gbs substructure sun et al 2012 this can be done by the standard 3d hydrodynamic codes based on the linear potential flow theory in this study the well proven 3d hydrodynamic code diffract is applied to perform the frequency domain hydrodynamic analysis of the gbs float over system diffract is mainly developed by prof rodney eatock taylor and has been widely used to analyse multi body floating system sun et al 2010 2012 2012 which adopts a quadratic boundary element method according to matsui and tamaki 1981 the hydrodynamic coefficients of one floating body may change significantly due to the presence of the neighbouring large dimensional structures in addition for multiple floating structures the hydrodynamic forces due to the motion of the neighbouring structure need also to be considered these two aspects of the multi body interaction can both be analysed by diffract while only the first aspect applies to the gbs float over installation since the gbs substructure is fixed onto the seabed the equation of motion for the multi body system in the frequency domain can be expressed as follows 1 ω 2 m a ω i ω b ω g x ˆ i ω f e x c i ω where the matrices m and g are the rigid body mass matrix and hydrostatic stiffness matrix for the n floating bodies respectively ω and i are the wave angular frequency and imaginary unit respectively a ω and b ω are the matrices of the frequency dependent added mass and added damping coefficients respectively f e x c i ω represents the vector of the wave excitation forces for the n floating bodies x ˆ i ω denotes the vector of the complex response amplitude operator rao of the floating structures the wave excitation forces and hydrodynamic coefficients can be readily obtained by diffract for the gbs platform float over installation the effects of the presence of the gbs substructure on the hydrodynamic coefficients and wave excitation forces of the installation barge are analysed 2 2 construction of the cptdm based on the cummins equation the frequency domain model described by eq 1 can only analyse linear problems since float over deck installations are normally executed in relatively calm sea states the linear frequency domain hydrodynamic analysis could be an appropriate method for investigating the fluid structure interaction problem which provides the basis for analysing the nonlinear dynamics in the time domain by the cummins equation for the case of zero forward speed cummins equation has the following expression cummins 1962 2 m a x t 0 t k t τ x τ d τ g x t f e x c t where a is the infinite frequency added mass matrix k t is the matrix of the impulse response functions and f e x c t is the vector of time domain wave excitation forces by eq 2 any nonlinearities associated with the floating structures can be treated as additional loads wu and moan 1996 according to the ogilvie relations ogilvie 1966 the parameters of the time domain model can be obtained based on the frequency domain results the impulse response function can be obtained by taking the inverse fourier transformation of the radiation damping coefficients 3 k i j t 2 π 0 b i j ω cos ω t d ω i j 1 6 n in practice the radiation damping coefficients at higher frequencies are often approximated by the polynomial fitting method due to the limitation of panel size and computation time chen et al 2014 hence the impulse response functions are often approximated by the following expression 4 k i j t k ˆ i j t 2 π 0 σ b i j ω cos ω t d ω 2 π σ b ˆ i j ω cos ω t d ω where σ denotes the upper limit angular frequency for the frequency domain simulation and b ˆ i j ω represents the approximated radiation damping coefficients beyond the upper limit frequency based on the calculated impulse response functions the infinite frequency added mass can be calculated by the following form 5 a i j a i j ω 1 ω 0 k ˆ i j τ sin ω τ d τ the wave excitation forces in the time domain can be obtained from the frequency domain calculations 6 f e x c t re f e x c i ω e i ω t in this way the time domain model and frequency domain model are equivalent for the freely floating condition and can be converted from one to another the accuracy of the time domain model can be assessed by comparing the time domain responses with the rao based response for the freely floating case the rao based responses can be obtained by the following expression 7 x r a o t re x ˆ i ω e i ω t as mentioned earlier the direct evaluation of the time domain model by eq 2 is time consuming and cumbersome which needs to integrate the convolution integral at each time step and is difficult to consider variable integration time steps for accurately capturing the system nonlinearities the convolution integral in the cummins equation can be replaced by the state space model for each k ˆ i j t calculated by eq 4 the corresponding convolution integral can be replaced by the following state space model chen et al 2017 8 z i j t n i j z i j t p i j x j t y i j x j t q i j z i j t where n i j r n n p i j r n 1 and q i j r 1 n are the state space matrices for a single input single output siso system n is the order of the siso state space model z i j t r n 1 is the state vector summarizing all the past information of the system and y i j x j t stands for the wave radiation damping forces due to the jth mode of motion which is also the output of the convolution integral as shown in eq 2 the siso state space matrices in eq 8 can be determined via the system identification method using the realization theory method proposed by kristiansen et al 2005 among the various methods for determining the state space matrices the realization method has been well proven to offer the best quality fit with the smallest number of states duarte et al 2013 detailed description of the implementation procedure for the realization theory method can be found in chen et al 2017 the accuracy of the constructed state space model for replacing the convolution integral can be evaluated by an coefficient r 2 which has the following expression duarte et al 2013 9 r 2 1 l k ˆ i j k i j 2 l k ˆ i j k i j 2 0 r 2 1 where k ˆ i j denotes the calculated impulse response functions by eq 4 k i j represents by output of the state space model by eq 8 for the given input being the dirac delta function and k i j is the mean value of k ˆ i j in general eq 9 involves summations across all the calculated time period for the impulse response functions and the coefficient r 2 reflects the amount of variability of the approximated impulse response functions k i j by the state space model relative to k ˆ i j the closer r 2 is to 1 the higher the accuracy of the state space model is duarte et al 2013 suggested that a value of at least 0 97 for the r 2 should be required when fitting the state space models in order to ensure the accuracy of the time domain dynamic modelling of the floating structures with the impulse response functions in all the modes of motions being replaced by the individual siso state space model a multi input multi output mimo state space model can be constructed resulting in a cptdm based on the cummins equation for the gbs float over deck installation by only considering the coupled heave roll pitch motions the time domain equation of motion of the installation barge for the freely floating condition can be expressed as follows 10 m b a x b t y x b t g x b t f e x c t where y x b t denotes the wave radiation forces and moments which is the output of the mimo state space model 2 3 development of the coupled heave roll pitch impact model based on cptdm by considering only the coupled heave roll pitch motion of the float over system the interactions between the deck and barge via the dsus and between the deck and gbs via the lmus are simplified in the vertical direction this simplification helps to investigate the effects of vertical lmu dsu interactions impact and separation on the nonlinear dynamics of the float over system which may be potentially applicable in modelling the float over deck installations with the anti surge system as reported by tribout et al 2007 in this study both the lmu and dsu are modelled as a bilinear spring damper system which accounts for the deck to substructure stiffness k dts and the deck to barge stiffness k dtb at the lmu and dsu connections respectively these two stiffnesses refer to the steel to steel contact stiffness when the lmu and dsu are fully compressed since they practically have limited load carrying capacity as defined by chen et al 2017 fig 1 shows the sketch of the lmu model and the classification of the lmu interaction depending on the vertical motion of the stabbing cone attached onto the deck leg the interaction between the stabbing cone and the lmu can be divided into three domains ω 0 ω 1 and ω 2 ω 0 is where the stabbing cone has no interaction with the lmu and its lower bound denotes the lmu impact ω 1 is where the stabbing cone interacts with the lmu and the lmu is not fully compressed ω 2 is where the stabbing cone directly interacts with the substructure and its upper bound denotes the steel to steel impact since the dsu interaction between the deck and barge is an analogy to the lmu interaction the detailed description of the dsu interaction is not given in this paper the load compression curve of the lmu and dsu is shown in fig 2 as discussed earlier the lmu and dsu connections behave like the bilinear spring damper system before the lmu and dsu reaching their stroke limit the lmu and dsu interactions between different structures would be governed by a relatively softer stiffness k 1 which represents the combined action of the lmu dsu stiffness and the steel to steel stiffness in series after the lmu and dsu are fully compressed the interaction stiffnesses at the lmu and dsu connection are only the deck to substructure stiffness k dts and the deck to barge stiffness k dtb respectively therefore two types of impacts can be distinguished at the lmu and dsu connections namely the relatively softer impact on the lmu dsu devices and the harder steel to steel impact when the lmu dsu is fully compressed the equivalent vertical stiffness at the lmu and dsu interactions can be derived based on the lmu dsu stiffnesses and the steel to steel stiffnesses 11a k l m u e q k l m u 1 k l m u k d t s k l m u k d t s 0 δ l m u t δ l m u 0 k l m u 2 k d t s δ l m u t δ l m u 0 11b k d s u e q k d s u 1 k d s u k d t b k d s u k d t b 0 δ d s u t δ d s u 0 k d s u 2 k d t b δ d s u t δ d s u 0 where k lmu and k dsu are the stiffnesses of the lmu and dsu devices respectively δ l m u t and δ d s u t are the instantaneous compressions at the lmu and dsu connections respectively δ l m u 0 and δ d s u 0 represents the compression limit at the instant when the lmu and dsu are fully compressed which can be obtained by the following expression 12 δ l m u 0 δ l m u δ l m u k l m u 1 k l m u 2 δ d s u 0 δ d s u δ d s u k d s u 1 k d s u 2 where δ l m u and δ d s u denote the corresponding stroke limits of the lmu and dsu respectively in addition lmus and dsus also have the damping effects to mitigate the impact loads however it is a challenging work to accurately model these damping effects in the numerical model if the experimental data were not provided chen et al 2017 adopted the linear rayleigh damping method to model the lmu dsu damping effects and concluded that the variation of the damping ratios in an appropriate range appear to have no significant effects on the maximum responses and impact loads of the float over system in this study the same method is applied to model the damping effects associated with the lmu and dsu interactions as well as the steel to steel contact the damping coefficients in the mode of heave motions for the lmu and dsu connections can be calculated as follows 13a b l m u b l m u 1 2 μ l m u 1 m d k l m u 1 m d if 0 δ l m u t δ l m u 0 v l m u t 0 0 else b l m u 2 2 μ l m u 2 m d k l m u 2 m d if δ l m u t δ l m u 0 v l m u t 0 0 else 13b b d s u b d s u 1 2 μ d s u 1 m d k d s u 1 m d if 0 δ d s u t δ d s u 0 v d s u t 0 0 else b d s u 2 2 μ d s u 2 m d k d s u 2 m d if δ d s u t δ d s u 0 v d s u t 0 0 else where m d denotes the deck weight μ l m u 1 and μ l m u 2 are the damping ratios of the lmu device and the deck to substructure structural damping respectively μ d s u 1 and μ d s u 2 are the damping ratios of the dsu device and the deck to barge structural damping respectively v l m u t and v d s u t are the vertical velocities of the stabbing cone attached onto the deck leg at the lmu connection and the relative vertical velocities between the contact points on the deck and barge at the dsu connection depending on the wave excitations and the load transfer stages of the float over deck installation the deck would make intermittent interaction with the substructure via the lmu connections and with the barge via the dsu connections the lmu and dsu forces can be calculated based on the instantaneous motions of the contact points such as the stabbing cones for the lmu connections the instantaneous stabbing cone motions can be calculated as follows 14 z l m u t z 0 x 1 t r y x 2 t r x x 3 t v l m u t x 1 t r y x 2 t r x x 3 t where z t denotes the instantaneous vertical position of the stabbing cone considered z 0 is the initial vertical position of the centre of gravity of the deck x 1 x 2 and x 3 are the displacements of the deck in the modes of heave roll and pitch motions respectively and r x and r y are the distances of the stabbing cone relative to the centre of gravity of the deck in x and y directions respectively based on the calculation by eq 14 the instantaneous lmu compression δ l m u t can be determined similar to the calculation of the stabbing cone motions the instantaneous relative vertical motions of the contact points at the dsu connection can also be readily obtained based on the rigid body motions of the deck and barge then the vertical lmu and dsu forces acting on the deck can be calculated as follows 15a f l m u d t k l m u 1 δ l m u t b l m u 1 v l m u t f l m u 0 d if 0 δ l m u t δ l m u 0 k l m u 1 δ l m u 0 k l m u 2 δ l m u t δ l m u 0 b l m u 2 v l m u t f l m u 0 d elseif δ l m u t δ l m u 0 f l m u 0 d else 15b f d s u d t k d s u 1 δ d s u t b d s u 1 v d s u t f d s u 0 d if 0 δ d s u t δ d s u 0 k d s u 1 δ d s u 0 k d s u 2 δ d s u t δ d s u 0 b d s u 2 v d s u t f d s u 0 d elseif δ d s u t δ d s u 0 f d s u 0 d else where f l m u 0 d and f d s u 0 d are the vertical lmu and dsu forces acting on the deck in the calm water condition before the wave excitations f l m u d t and f d s u d t reflects the variation of the lmu and dsu forces relative to the initial condition and will be used to derive the moment forces in the modes of roll and pitch motions once individual lmu forces and dsu forces are all obtained by eq 15 their total forces and moments acting on the deck and barge can be readily derived for the modes of heave roll and pitch motions these forces and moments can be added into the cptdm by eq 10 as additional loads the coupled heave roll pitch impact model for the deck barge system can be expressed as the following matrix form 16 m d 0 0 m b a x d t x b t 0 y x b t 0 0 0 g x d t x b t 0 f e x c t f d s u d t f l m u d t f d s u b t where f d s u d t and f d s u b t are the total dsu forces and moments acting on the deck and barge respectively f l m u d t denotes the total lmu forces and moments acting on the deck the above model provides an efficient way of modelling the wave induced impact behaviour of the float over system the numerical scheme using the 4th order runge kutta integration algorithm described by chen et al 2014 2017 2019 are applied here to derive the time domain results in order to enhance the simulation efficiency a self adaptive integration time step method is adopted here to accurately capture the system discontinuities induced by the lmu dsu impact separation and the steel to steel impact separation as illustrated in fig 3 by this integration method three types of integration time steps can be distinguished 1 dt 0 a relatively coarser time step which is applied in the beginning and where the system discontinuities are not experienced this time step is mostly used in the simulation period which helps to enhance the simulation efficiency 2 dt 1 a relatively finer time step which is applied when the programme have checked that using the initial time step dt 0 would experience the system discontinuity at next time step this time step is then used for the subsequent simulations until that the programme detects that using the finer time step dt 1 would experience the system discontinuity at next time step the time step dt 1 can be calculated as follows 17 d t 1 d t 0 n t where n t is a large positive integer 3 dt 2 a predicted time step to accurately capture the system discontinuity which is calculated based on the 1st order taylor s approximation 18 d t 2 a b s ξ v 0 where v 0 denotes the vertical velocity of the stabbing cone and the relative vertical velocity between the dsu contact points for the lmu and dsu interactions closest to the occurring of system discontinuity respectively and ξ represents the clearance between the current stabbing cone position and the system discontinuities at the lmu connection and between the current position of the dsu contact point on the deck leg and the system discontinuities at the dsu connections by using the self adaptive integration time step method the check of system discontinuities will be carried out for each lmu dsu at each time step and the instant closest to the system discontinuities will be identified this helps to improve the simulation accuracy for modelling the wave induced impact behaviour of the float over deck installation which is however not considered in the standard simulation packages such as ansys aqwa analysis tools for characterising nonlinear dynamics such as the poincaré map phase trajectory impact map and bifurcation diagram are applied in the following sections to analyse the nonlinear motion characteristics arising from the float over deck installation at different load transfer stages the poincaré map plots the displacement versus velocity at a constant phase within a wave period as defined by φ mod t t in which the number of points denotes the periodicity of the motion if there are m points in the poincaré map the motion pattern can be regarded as period m motion the impact map plots the impact velocities versus the impact phase defined as mod t i t where t i is the impact instant the phase trajectory plots the displacement versus velocity for the whole simulation period the bifurcation diagram plots the points in the poincaré map versus the changing control parameter to demonstrate the change of the motion pattern with the increase of the control parameter detailed descriptions of these analysis tools can be found in chen et al 2014 and thompson and stewart 2000 3 hydrodynamic analyses of the gbs float over system and the validation of the constructed state space models for the cptmd 3 1 particulars of the analysed gbs float over system in this study the analysed gbs float over system is loosely based on the model analysed by sun et al 2012 and chen 2014 as shown in fig 4 the water depth is 53 13 m the gbs substructure model is based on the one investigated by walker et al 2008 which consists of a caisson base and 4 vertical columns the gap in between the gbs column and the barge is 2 75 m in the transverse direction for all the different load transfer stages and the gap in between the barge bottom and the top of the gbs caisson is 28 83 m at the 0 load transfer stage the origin of the global earth fixed reference system is located at the centre of the barge in the water plane for all the different deck load transfer stages the particulars of the deck are summarized in table 1 where the values of deck cog is based on the 0 load transfer stage table 2 summarises the particulars of the barge model at different deck load transfer stages it needs to be noted that the modelling of the lmu and dsu connections is crucial to investigating the wave induced nonlinear impact behaviour arising from the float over deck installations due to its complexities many studies were carried out with certain simplifications table 3 summarises the parameters of the lmu and dsu used in the published literature in table 3 n a stands for not applicable which means the parameters were not considered in the numerical model and n g stands for not given which means the parameters were considered but were not provided in the referenced publications apparently the numerical model by jung et al 2018 provided a more realistic modelling of the lmu and dsu interactions since the limited load carrying capacity of lmu dsu damping effects of the lmu dsu and the steel to steel contacts were all modelled therefore the modelling of the lmu dsu interactions in this study follows the method by jung et al 2018 as shown in fig 4 the analysed float over system involves 4 lmus and 6 dsus in this study all the lmus are assumed to be identical in terms of both the stiffness and damping effect this assumption also applied to the dsus therefore the analysed float over system is symmetric about both the x and y axes as shown in fig 4 the specifications of the lmu and dsu connections are summarized in table 4 and table 5 respectively the load capacity of the lmus is assumed to take 70 of the deck weight which is 3850 tonnes for each lmu the load capacity of the dsus is assumed to take 30 of the deck weight which is 1100 tonnes for each dsu the damping characteristics of the steel to steel contacts are not given here which will be discussed in subsequent sections 3 2 frequency domain hydrodynamic analyses of the analysed gbs float over system in this study the frequency domain hydrodynamic analyses of the gbs platform float over system are performed by using the high order panel code diffract since the analysed float over system is symmetric about both the x and y axes only one quarter of the model is analysed in diffract using the two plane symmetry to reduce computation time to investigate the effects of multi body hydrodynamic interactions between the barge and the gbs substructure two hydrodynamic models are analysed which are the barge only model and the barge with gbs the hydrodynamic analysis of the barge only model is only carried out for the 0 deck load transfer stage while hydrodynamic analysis of the barge with gbs model is carried out for the 0 30 50 70 and 100 deck load transfer stages fig 5 shows the meshes of the one quarter body for the two hydrodynamic models at the 0 deck load transfer stage frequency domain analyses are carried out from ω 0 02 rad s to 2 52 rad s with a step of 0 01 rad s for all the different deck load transfer stages the mesh size of the hydrodynamic models was selected by meeting the mesh requirement for the high order potential flow panel code that the characteristic sizes of the panels should be smaller than ¼ of the minimal wave length considered the natural frequencies of the barge in the modes of heave roll and pitch in calm water at the 0 deck load transfer stage are summarized in table 6 which are calculated based on the body mass infinite added mass as well as the derivation of the lmu and dsu stiffnesses the comparisons of the hydrodynamic coefficients of the barge for the cases with and without gbs are shown in fig 6 it can be observed that the hydrodynamic coefficients of the barge are significantly influenced by the neighbouring gbs substructure due to the multi body hydrodynamic interaction effects fig 6 also illustrates the variations of the hydrodynamic coefficients of the barge for the case with gbs at the different deck load transfer stages it seems that the increase of the barge draft from 9 3 m at the 0 deck load transfer stage to 10 65 m at the 100 deck load transfer stage has no significant impact on the hydrodynamic coefficients of the barge this finding is consistent with the results by zhao et al 2021 in this study only the nonlinear dynamics of the float over system under the quartering sea states are analysed and thus the 1st order wave excitation forces of the barge in the modes of heave roll and pitch motions are compared as shown in fig 7 it can be observed that the wave forces acting on the barge at different deck load transfer stages also rarely vary therefore the frequency domain hydrodynamic results of the barge at the 0 load transfer stage will be used in constructing the cptdm in subsequent sections for performing time domain modelling of the wave induced impact behaviour of the float over system at different deck load transfer stages 3 3 validation of the state space models for cptdm based on the frequency domain results shown in section 3 2 a cptdm can be established by replacing the time consuming convolution integral in cummins equation with a state space model fig 8 shows a comparison of the impulse response functions of the barge for the cases with and without the gbs substructure in the modes of heave roll and pitch motions the impulse response functions shown here are calculated by eq 4 based on the integration of the added damping coefficients it can be observed that the impulse response functions of the barge with a neighbouring gbs substructure need slightly longer period to decay to zero this is in consistent with the findings by lewandowski 2008 and chen et al 2016 that the impulse response functions for adjacent floating multi body system exhibit a lightly damped feature however this feature for the case considered here is not so significant as that of twin barges operating side by side analysed by them the calculated impulse response functions shown in fig 8 can be used to determine the state space matrices of the state space models for constructing the cptdm the accuracy of the cptdm can be directly evaluated by the fitting quality of the state space model as compared with the calculated impulse response functions fig 9 shows the comparison of the calculated impulse response functions with the fittings of state space model with different orders for the cases of barge with and without gbs it is found that the fitting quality of the state space model increase with the order of state space model for both cases table 7 summarises the values of r 2 as defined by eq 9 for the state space models constructed for both cases with the same order the state space models for the barge without gbs are found to produce slightly better fitting of the impulse response functions as compared with those for the barge with gbs in other words a slightly higher order state space model is needed for the barge with gbs this is due to the fact that the impulse response functions are more slightly damped for the case of barge with gbs therefore the state space models with order 6 will be used to construct the cptdm for the barge with gbs though an order of 4 can produce satisfactory fitting for the barge without gbs 4 discussion on the effects of steel to steel damping and code to code verification of the cptdm 4 1 effects of the steel to steel damping on the dynamics of float over system as summarized in table 3 different models have been proposed to simulate the lmu and dsu connections in the literature among which the bilinear damper system is considered to be a more realistic numerical representation in this study the bilinear damper system is applied to model the interactions between the deck and substructure and between the deck and barge at the lmu and dsu connections respectively as pointed out by bokhorst et al 2011 the various sources of damping should be carefully considered when modelling the float over deck installations such as the structural damping associated with the steel to steel contacts due to the high stiffness at the steel to steel contacts high frequency oscillations of the deck may be generated due to the steel to steel impacts when the lmus or dsus are fully compressed this phenomenon rises due to the numerical issue that the deck is assumed to be rigid and is of structural damping besides this phenomenon was not observed at all in the model tests bokhorst et al 2011 therefore in this study a linear rayleigh damping defined as b l m u 2 and b d s u 2 in eq 13 is introduced for the steel to steel contacts occurring at the lmu and dsu connections in order to eliminate these unrealistic high frequency oscillations to illustrate the effects of steel to steel damping coefficients on the dynamic behaviour of float over system the relative vertical motions between the two contacts at the dsu connection and the vertical motions of the stabbing cone at the lmu connection are compared for different damping ratios as shown in figs 10 and 11 the results shown in figs 10 and 11 are for the 0 and 100 deck load transfer stages respectively under the same regular wave excitation with the wave height wave frequency and incident wave angle being 1 5 m 0 43 rad s and 45 respectively as shown in fig 10 the dsu experiences steel to steel impacts when the relative vertical motion crossing the dtb impact limit and the case without steel to steel structural damping exhibit high frequency oscillations at the 100 deck load transfer stage the lmu would also experience steel to steel impacts when the vertical displacement of the stabbing cone crossing the dts impact limit and the case without steel to steel structural damping also exhibit high frequency oscillations it is found that the steel to steel damping ratios of 0 05 and 0 1 for the dsu and lmu respectively are adequate to eliminate the high frequency vibrations therefore these coefficients will be applied in the following nonlinear dynamic analyses of the gbs float over deck installation together with the parameters defined in tables 4 and 5 the parameters for constructing the bilinear damper model for the lmu and dsu connections are all determined 4 2 code to code verification of the cptdm the wave induced impact model based on cptdm was firstly proposed by chen et al 2014 their method was further extended by many researchers in terms of expanding the degrees of freedom of the numerical model and improved representation of the lmu and dsu models however the code to code verification of the developed cptdm has not been conducted before in order to demonstrate the accuracy and efficiency of cptdm a code to code verification is carried out here by comparing the numerical results by cptdm with those from the standard simulation package ansys aqwa different from the cptdm ansys aqwa adopts the method of direct evaluating the convolution integral in the time domain with a fixed time step therefore the time domain modelling of wave induced impacts in ansys aqwa cannot accurately capture the system discontinuities caused by the change of the system stiffness which may possibly introduce numerical errors if the chosen time step is not fine enough in addition the developed cptdm is only a time domain model that needs frequency domain hydrodynamic results from other standard panel codes such as diffract while ansys aqwa has its own frequency domain hydrodynamic analysis model the same float over model as defined in section 3 is analysed in ansys aqwa as shown in fig 12 fig 13 illustrates the comparison of the frequency domain hydrodynamic coefficients between ansys aqwa and diffract to assure that the time domain simulations by cptdm and ansys aqwa are based on the same frequency domain results it can be observed that the hydrodynamic coefficients of the barge in the mode of heave motion are almost the same for the two panel codes which means there are no differences in their frequency domain models as defined in eq 1 for the time domain modelling in ansys aqwa each lmu dsu is modelled by two fender elements to form a bilinear damper model with the same parameters as defined in tables 4 and 5 as well as in section 4 1 for the steel to steel damping in the time domain simulations in anasys aqwa the float over system including the deck and barge are constrained to have no surge sway and yaw motions and thus only the coupled heave roll pitch motions are considered making it coincide with the developed cptdm the comparisons of the time domain results are based on the float over system at the 0 load transfer stage excited by the same regular wave excitation with the wave height wave frequency and incident wave angle being 1 5 m 0 5224 rad s and 45 respectively this frequency is specially selected to demonstrate that the developed cptdm can predict sub harmonic motions caused by the wave induced impacts arising from the float over deck installation which will be further discussed in section 5 2 the time integration step applied in ansys aqwa is a fixed value of 0 01 s the cptdm has the time integration steps of dt 0 0 06 s and dt 1 0 01 s and dt 2 is in the order of 10 3 s to 10 4 s as predicted by eq 18 the heave roll and pitch motions of the deck and barge are compared in fig 14 it can be observed that the heave motions by cptdm agree quite well with those by ansys aqwa while they produce quite different roll and pitch motions for both the deck and barge the phase shift for the pitch motion is mainly caused by the differences between the two codes in modelling the lmu dsu damping forces in the developed cptdm the damping effects of the lmu and dsu are only considered for the loading stage when the lmu and dsu are being further compressed however when the compressed lmu and dsu are released to the uncompressed stage these damping effects were not considered to avoid the total lmu dsu forces being negative when the negative damping forces are larger than the positive forces due to compression as shown in eq 13 however in anasys aqwa the damping forces of the lmu dsu are considered for both the compression and decompression stages moreover significant discrepancies are found in the comparison of the roll motions between the cptdm and ansys aqwa which may be due to the fact that the numerical integration errors by ansys aqwa are comparable to the magnitudes of the roll motions since they are only in the order of 10 3 rad in ansys aqwa a 2nd order predict corrector method is used while a 4th order runge kutta method is used in cptdm which has higher accuracy fig 15 shows the comparison of the vertical motions of the stabbing cones l 1 and l 2 significant discrepancies are observed in vertical motions of the stabbing cones the vertical lmu impact forces on the stabbing cones are compared in fig 16 it can be observed that ansys aqwa produces smaller lmu impact forces and their impact duration is found to not coincide with the duration predicted by cptdm the developed cptdm adopts a self adaptive time integration method which helps to accurately predict the instants when lmu impact and separation occurs therefore the discrepancies observed in figs 14 16 may be due to the fact that ansys aqwa adopts a fixed time integration step that cannot accurately model the system continuities caused by the stiffness change which means a much finer time step is needed for ansys aqwa to reduce the errors in the prediction of wave induced impact forces at the lmu and dsu connections furthermore it is clearly shown in fig 15 that the stabbing cone motions calculated by the cptdm are sub harmonic motions period 2 motions while the results by ansys aqwa exhibit harmonic feature having a period equal to the wave period this phenomenon can be further illustrated in the phase trajectories of the deck and barge motions as shown in fig 17 in addition as pointed out by chen et al 2021 for the modelling of the point absorber with end stop mechanism ansys aqwa is found to unable to identify sub harmonic motions caused by the wave induced impacts therefore it may be concluded that ansys aqwa with a fixed time integration step may not be able to identify high order sub harmonic motions caused by the system nonlinearities in addition the computation efficiencies by ansys aqwa and cptdm are compared as shown in table 8 here all the simulations were carried out on the same pc intel xenon cpu e5 2643 v4 3 40 ghz it can be observed that the computation efficiency of cptdm is much higher than that of ansys aqwa this is because the cptdm use the state space model to replace the time consuming convolution integral however the improved computation efficiency by the cptdm become less effective with the simulation length being increased this may be due to the fact that the cptdm would check whether the system discontinuities occur at each time step and adopt a much finer time step defined as dt 2 to accurately capture the system discontinuities which may accounts for more computation time 5 nonlinear dynamics of the gbs float over deck installation at different deck load transfer stages 5 1 brief discussions of the nonlinear dynamics of the float over system at different deck load transfer stages during the deck mating stage the deck weight is gradually transferred from the barge onto the gbs substructure by ballasting the barge down the whole process is generally divided into different deck load transfer stages for the numerical modelling by only considered the coupled heave roll pitch motions of the float over system the mooring system is thus not modelled and the system nonlinearities are mainly caused by two types of wave induced impacts namely the soft lmu dsu impact and the hard dts dtb steel to steel impact by considering the same regular wave excitation with the wave height wave frequency and wave angle being 1 5 m 0 43 rad s and 45 respectively the different impact behaviours of the float over system at different deck load transfer stages are compared fig 18 shows the comparison of the vertical motions of the stabbing cone l 2 at different deck load transfer stages the lmu impact limit and dts impact limit are where soft lmu impact and hard dts impact occur respectively fig 19 shows the comparison of the relative vertical motion of the deck leg d 3 at different deck load transfer stages the dsu impact limit and dtb impact limit are where soft dsu impact and hard dtb impact occur respectively at the 0 deck load transfer stage significant lmu impacts are observed as shown in fig 18 the maximum compression of the lmu l 2 is larger than 0 4 m and the maximum separation between the stabbing cone and lmu at l 2 is about 1 1 m which may generate strong nonlinear dynamics in addition it can be observed from fig 19 that the interaction between the deck and barge at d 3 is within the steel to steel contact region and no dtb impact separation occurs at the 0 deck load transfer stage this is because the load capacity of the dsus is designed to take only 30 of the deck weight and there are significant steel to steel compressions at the dsu connections therefore the nonlinear dynamics of the float over system at the 0 deck load transfer stage are mainly caused by the soft lmu impacts fig 20 shows the impact maps of different lmus at the 0 deck load transfer stage it is found that the four stabbing cones experience different impact behaviours at the corresponding lmu connections and the maximum impact velocities are found at the lmu l 2 that is located in the corner encountering the incident wave as shown in fig 4 the poincaré map and phase trajectory of the deck heave motions at the 0 deck load transfer stage are shown in fig 21 it is clearly shown that the deck exhibits a sub harmonic motion of order 4 namely the period 4 motion this nonlinear feature is induced by the significant soft lmu impacts at the 30 deck load transfer stage it can be observed from figs 18 and 19 that the float over system experiences no discontinuity and behaves like a linear system at this stage the deck and barge interacts with each other via the dtb stiffness k dtb and the deck interacts with the gbs substructure via the linear equivalent lmu stiffness k l m u 1 as defined in eq 11a at the 50 deck load transfer stage both the dts and dtb hard impacts are observed as shown in figs 18 and 19 the dts and dtb impact maps are shown in fig 22 it is found that both the dts and dtb impact velocities are quite small compared with the lmu impact velocities shown in fig 20 at the 0 deck load transfer stage in addition it can be observed in fig 22 that the dsus d 1 and d 4 experience no dtb impact and only the lmu l 2 experiences dts impact showing that the lmus and dsus also exhibit different hard impact behaviours fig 23 plots the phase trajectories of the deck heave motions at the 30 and 50 load transfer stages it is found that the dynamic responses at the two stages are less nonlinear compared with the 0 load transfer stage this is because the float over system behaves like a linear system at the 30 deck load transfer stage and for the 50 load transfer stage the system discontinuities due to the dts and dtb impacts is not so violent as that caused by the lmu impacts at the 0 load transfer stage at the 70 deck load transfer stage as shown in figs 18 and 19 both dtb and dts hard impacts are observed the dtb and dts impact maps are shown in fig 24 different from the 50 load transfer stage all the dsus at the 70 load transfer stage experience dtb impact since the initial compressions of all the dsus at this stage are just at the dtb impact limit in the calm water in addition the dtb impact velocities at the 70 load transfer stage are much larger than the 50 load transfer stage the amplitude of the relative vertical motion at the dsu d 3 at the 70 load transfer stage is much larger than that at the 50 load transfer stage since the deck interacts with the barge mainly via the harder dtb stiffness k dtb and the softer equivalent dsu stiffness k d s u 1 defined in eq 13b at the 50 and 70 load transfer stages respectively at the 100 deck load transfer stage the nonlinear dynamics are similar to the 70 load transfer stage as shown in figs 18 and 19 the float over system experiences dts hard impacts and dtb hard impacts at this stage in addition the dsus are found to be all in compression and no dsu impact separation occurs at this stage the amplitude of the vertical motion of the stabbing cone l 2 at the 100 load transfer stage is found to be slightly larger than that at the 70 load transfer stage apart from this exception the amplitude of the vertical stabbing cone motions is found to generally decrease with the increased deck weight transferred onto the substructure as shown in fig 18 in addition it is found that the relative vertical motion at the dsu connection generally increase with the increased deck weight transferred onto the substructure as shown in fig 19 this is because with deck weight being increasingly transferred onto the substructure the interactions between the deck and substructure and between the deck and barge become stiffer and softer respectively fig 25 plots the dts and dtb impact maps as well as the dsu impact map at the 100 load transfer stage it can be observed that the maximum impact velocities at the dts and dtb impact limits at the 100 load transfer are similar to the 70 load transfer stage in addition similar to the lmu impact observed at the 0 load transfer stage different impact behaviours are observed at different dsu connections as shown in the dsu impact map in fig 25 fig 26 shows the pincaré maps and phase trajectories of the deck heave motions at the 70 and 100 load transfer stages the motion patterns at the two stages also show a periodic feature as the 30 and 50 load transfer stages however the phase trajectories show more violations at the two stages mainly due to the occurring of the significant dts and dtb impacts 5 2 bifurcation analyses of the float over installation system at different load transfer stages as discussed in section 5 1 the nonlinear dynamics of the float over system exhibit different characteristics at the different deck load transfer stages in particular the float over system is found to exhibit strong nonlinear dynamics at the 0 load transfer stage mainly induced by the lmu impacts however the discussions in section 5 1 are based on the same wave excitation it is of great importance to investigate the effects of varying wave excitations on the wave induced impact behaviours of the float over deck installation according to chen et al 2014 the variation of the wave height in the operational sea states is found to have little effect on the motion pattern of the float over system in addition the offshore commissioning of float over deck installation is often limited to a wave height of 1 5 m therefore this study mainly investigate the effects of the wave frequency on the nonlinear dynamics of the float over system by performing bifurcation analysis using the wave frequency as the control parameter a quartering sea state with a fixed wave height of 1 5 m and an incident wave angle of 45 is used for all the subsequent simulations since the float over system would experience more complex coupled heave roll pitch motions fig 27 shows the bifurcation diagrams of the deck heave motion at the 0 load transfer stage with the wave frequency being increased from 0 2 rad s to 2 2 rad s with a frequency step of 0 01 rad s which plots the points in the pincaré map at φ 0 75t for each wave frequency considered the results at other load transfer stages show all periodic motions and thus are not shown here for the time domain simulation at each wave frequency the simulation length is 200t and only the results after 100t when the motions become stable are used to derive the bifurcation diagram in order to eliminate the transient effects by the wave excitation it can be observed from fig 27 that only the 0 load transfer stage exhibit significant motion pattern evolution with the changing wave frequency at the 0 load transfer stage period 2 motions firstly appear around the frequency of 0 4 rad s while the motion pattern quickly become periodic with the frequency increased in addition two significant motion pattern evolution zones can be identified at this stage the first zone is within the frequency range from 0 51 rad s to 0 60 rad s which clearly exhibits the phenomenon of period doubling leading to chaos as shown in fig 28 that is based on a much finer wave frequency step of 0 0002 rad s the other zone is around the wave frequency of 0 8 rad s which shows a stable chaotic regime the poincaré map and phase trajectory of a typical chaotic motion are shown in fig 29 as shown in fig 28 a periodic motion bifurcates to a stable period 2 motion at ω 0 517 rad s which further bifurcates to a period 4 motion with the frequency being increased to 0 525 rad s and subsequently leads to stable chaotic motions which is within the frequency range from 0 53 rad s to 0 546 rad s with the frequency being further increased a frequency doubling phenomenon is observed after the chaotic regime and the motion pattern returns back to the stable period 2 motion after ω 0 549 rad s fig 30 shows the poincaré maps and phase trajectories of three sub harmonic motions with different orders at very neighbouring frequencies it can be observed that a tiny change of the wave frequency would lead to the motion pattern changing from the period 2 motion to the period 8 motion however the points in the poincaré maps are not significantly deflected and the phase trajectories are quite close which means the system nonlinearities are not significant and result in only the weakly sub harmonic motions the maximum lmu and dsu forces for the sub harmonic motions are compared in fig 31 it is observed that the maximum forces slightly increase with the increase of the order of sub harmonic motion though the wave frequency is only with a tiny and negligible change however significant sub harmonic resonances are not observed in this study which may be due to the fact that the steel to steel damping coefficients at the dsu connection are modelled therefore special attentions should be paid to the selection of these damping coefficients in addition the maximum lmu and dsu forces at different load transfer stages for varying wave frequencies are compared as shown in fig 32 for the lmu forces the two lmus l 2 and l 3 located in line with the wave incident direction are found to have larger forces and the maximum forces of different lmus generally decreases with the increase of the wave frequency in addition the 70 and 100 load transfer stages are found to have the largest lmu forces for the dsus different dsus exhibit more diverse variation with the wave frequency and the largest dsu forces are found at the 30 load transfer stage where the dsus experience fully steel to steel contacts similar to the lmu forces the dsu forces are all found to generally decrease with the increase of the wave frequency in addition the largest forces of all the lmus and dsus are found to occur around ω 0 4 rad s which is close to the natural frequency of the barge roll motion as given in table 6 this may be reasonable as the barge roll motion would give rise to the vertical motions of the stabbing cone and thus result in larger impact forces it can be observed from fig 32 that the wave frequency being larger than 0 8 rad s may be preferred for executing the deck mating operation based on the analysed float over model since much smaller lmu and dsu forces will be experienced this finding is consistent with the industry practice as the long period swell will often cause large barge motions and thus offshore operations under swell condition are often executed under a lower sea states 6 concluding remarks this study develops a coupled heave roll pitch impact cptdm for analysing the wave induced impact behaviours of the gbs float over system at the different deck load transfer stages the cptdm is established based on the cummins equation with its time consuming convolution integral being replaced by a state space model the vertical interactions between the deck and barge and between the deck and substructure via the lmu and dsu connections are modelled as a bilinear damper system and are treated as additional external loads to the cptdm in addition the hydrodynamic interaction between the installation barge and gbs substructure is analysed and its effects are taken into account in the cptdm a code to code verification is carried out to demonstrate the accuracy and efficiency of cptdm compared with the standard simulation package ansys aqwa based on the developed cptdm nonlinear dynamics of the gbs float over system at different load transfer stages are analysed some concluding remarks can be drawn from the study 1 the hydrodynamic interaction between the barge and gbs is found to make the impulse response function takes longer time to decay to zero and thus a relatively higher order stage space model is needed to assure the fitting quality of the impulse response function in addition the interaction effect is found to be not so strong as the twin barge cases analysed by chen et al 2016 and thus it does not have significant impact on the construction of cptdm for the gbs float over system 2 the steel to steel damping coefficients are found to significantly mitigate the high frequency oscillations that were not observed in the model tests however the selection of these damping coefficients need to be cautious since they may cause the system being overly damped and thus eliminate some important nonlinear features 3 by comparing the nonlinear dynamics at different deck load transfer stages the 0 deck load transfer stage is found to exhibit the strongest nonlinear dynamics excited by the lmu impacts some weakly sub harmonic motions and chaotic motions are observed at certain wave frequencies in this preliminary study in addition the largest lmu and dsu forces are found to be at the wave frequencies around the barge s natural roll frequency based on the analysed float over system in this study it may be recommended that the execution of float over deck installation is preferred for wave frequencies larger than 0 8 rad s and a much lower sea states may be required for float over deck installations under the swell condition which is consistent with the industrial practices it should be noted that the developed cptdm only considers the coupled heave roll pitch motions of the float over system and ignores the viscous roll damping forces acting on the barge with emphasis on investigating the vertical interactions at the lmu and dsu connections at different load transfer stages for varying wave frequencies therefore the conclusions drawn from the study are limited to the present simplified model and cannot be directly used to guide the engineering practice of float over deck installations the present model needs to be further extended to 6 degrees of freedom to provide a more realistic modelling of float over deck installations and may be extended to multi body system for analysing float over operations for floating platforms such as the spar and semi submersible credit authorship contribution statement ling zhu project administration resources writing review editing meiyan zou methodology software investigation data curation writing original draft visualization mingsheng chen methodology supervision validation formal analysis writing review editing funding acquisition lin li methodology formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the corresponding author would like to acknowledge the support of the national natural science foundation of china grant no 5180090578 and the natural science foundation of hainan province pr china grant no 520ms072 
20523,this paper demonstrates the implementation and performance testing of a deep reinforcement learning based control scheme used for dynamic positioning of a marine surface vessel the control scheme encapsulated motion control and control allocation by using a neural network which was trained on a digital twin without having any prior knowledge of the system dynamics using the proximal policy optimization learning algorithm by using a multivariate gaussian reward function for rewarding small errors between the vessel and the various setpoints while encouraging small actuator outputs the proposed deep reinforcement learning based control scheme showed good positioning performance while being energy efficient both simulations and model scale sea trials were carried out to demonstrate performance compared to traditional methods and to evaluate the ability of neural networks trained in simulation to perform on real life systems keywords dynamic positioning deep reinforcement learning proximal policy optimization reward shaping 1 introduction dynamic positioning dp of marine vessels is concerned with maintaining a vessel s position and heading while using a computer program to control the vessel s actuators due to the nonlinear dynamics of marine vessels and the stochastic behavior of the environment the dp task can become quite complex traditional methods for solving dp consist of a state estimation component responsible for signal processing and estimation of the vessel s states given the various sensor inputs a guidance system responsible for calculating set points to the control system and a control system which typically consists of a motion control law and a thrust allocation ta method a simplified overview of the dp system is shown in fig 1 showing the connectivity between the above mentioned dp system components including the forces acting on the vessel coming from the environmental loads and the actuators a considerable amount of research has gone into the state estimation algorithms as the dp system should only counteract the low frequency wave motions which cause the vessel to drift over time filtering out the wave frequency motions which cause the vessel to oscillate early work included the use of notch filters and low pass filtering while today s methods tend to linearize the dynamics and use linear quadratic estimation based on the work by kalman in the 1960 s with applications like in balchen et al 1980 who combined the kalman filter kf with optimal control the extended kalman filter ekf has become a standard in which the dynamics are linearized around working points using the taylor expansion but it lacks global stability proofs since the dynamics are linearized within certain regions of heading angle one option to the ekf is the nonlinear passive observer derived by fossen and strand 1999 providing global stability proofs while using less tuning parameters with demonstrated performance on a supply vessel since an ekf was already implemented on the vessel used for demonstrations in this paper the focus was on the control aspect of dp namely the motion control and the thrust allocation traditional methods used in a control system divide the control problem itself into two parts the motion controller and the thrust allocation the motion controller calculates the generalized control forces τ d to put on the vessel in order to move it towards a setpoint while the ta translates these generalized forces into thruster commands resulting in the actual forces τ b on the vessel a widely used motion control law for controlling the horizontal motions of a vessel is to use three decoupled pid feedback control laws in combination with a feedforward law that combines the modeled system dynamics with information such as measured wind speeds or changes in desired states in order to calculate desired forces up front however as the vessel dynamics are highly nonlinear inaccuracies arise due to modeling errors in addition to time varying environmental and or operating conditions more advanced control methods aiming to combat these issues include methods that use gain scheduling exemplified by tannuri et al 2006 using model reference adaptive control for time varying environmental loads methods using pid with fuzzy logic which adapts controller s coefficients has been demonstrated such as the fuzzy pid controller by xu et al 2019 other methods aimed at including the nonlinear dynamics directly in the controller design such as backstepping control a recursive control design methodology introduced by kokotovic 1992 and widely exemplified by in the works of fossen and grøvlen 1998 and skjetne and fossen 2004 and du et al 2018 katebi et al 2001 used the h controller design method based on the wind and wave disturbances providing an option for multivariate systems with coupling terms also sliding mode control has been investigated a nonlinear controller design method that consists of a sliding surface which is meant to guarantee stable dynamics when the trajectory lies on it demonstrated for marine vessels in dp operations by tannuri et al 2010 nguyen et al 2007 used hybrid control as a means of expanding the range of varying environmental conditions using a switching logic for selecting between a predetermined set of observers and controllers according to the estimated sea state spectre s peak frequency the work was later extended to apply for various operating speeds as well nguyen et al 2008 the thrust allocation algorithm s goal is to output actuator forces that is as close to the ones calculated from the motion controller i e minimizing τ b τ d 2 for most marine surface vessels the number of actuators are larger than the degrees of freedom to be controlled and hence there might exist an infinite amount of thruster configurations that yields the desired forces therefore optimal solutions must be chosen with respect to some objective criteria as a consequence ta methods are typically based on optimization johansen and fossen 2013 which takes aim at minimizing a cost function subject to the physical constraints of the thrusters and the relationship between thruster forces and total force generation this allows for flexible constraint handling while optimizing a designable objective function for minimizing fuel consumption a quadratic programming qp approach is common in which the cost function includes a quadratic cost on thruster usage optimization based methods could suffer from complex actuator setups leading to nonlinear optimization constraints and nonconvex objective functions which can be computationally demanding to solve online avoiding some of the nonlinearities that creates computational issues the application of an extended thrust formulation for calculating a pseudoinverse of the linear actuator model has become fairly standard in the industry sørdalen 1997 jenssen and realfsen 2006 though requiring some iterative logic to ensure that the commanded thruster signals are feasible a variety of workarounds of the nonlinearities has been proposed see e g johansen et al 2008 for allocation with a propeller and rudder interaction where the proposed method divide the nonconvex problem into several convex qp problems with a switching logic to decide on the best solution by comparing final costs of each separate sub solution other approaches include multiparametric quadratic programs mpqp gupta et al 2011 which pre computes optimal parametric functions offline and as demonstrated by johansen et al 2005 offers real time applications by searching for the optimal solutions within the pre computed functions the method was further expanded by leavitt 2008 combining several mpqp formulations with different properties including a blending and a switching logic for deciding the best solution from the sub problems newer methods improve the accuracy of ta methods as shown by arditti et al 2018 which used sequential qp with slack variables including actual thrust constraints and hydrodynamic thruster interactions in high detail to increase ta accuracy while reducing energy consumption through the rapid development of computer hardware model predictive control mpc has become a viable option for the allocation of actuator commands vermillion et al 2007 naderi et al 2019 it has also been shown to be applicable for encapsulating both the motion controller and the ta into one entity as demonstrated by veksler et al 2016 they formulated the controller as an optimization over a given prediction horizon calculating optimal thruster commands through minimizing a cost function which included thruster usage and state deviations while formulating the vessel and thruster dynamics in addition to their limitations as constraints to the optimization procedure reinforcement learning rl algorithms have been used with promising results in a large variety of decision making tasks including control problems a comprehensive overview of rl can be found in sutton and barto 2017 as opposed to the traditional methods which are based on instructive design based on some sort of modeling of the vehicle dynamics rl based controllers is developed in a trial and error fashion finding or learning a control policy through choosing actions while receiving feedback from a designed reward function signal the behavior is corrected based on a reward mechanism an incentive for exploring methods within model free rl has been that they have shown to provide frameworks for learning control policies by using methods that has no a priori knowledge of the system dynamics this has allowed for development of controllers for nonlinear systems without any attention to dynamics modeling these methods have especially proven performance when combining rl with deep artificial neural networks ann giving rise to deep reinforcement learning drl widespread attention of drl based methods was attained with the demonstration of deep q networks dqn mnih et al 2013 which combined q learning with neural networks to reach super human level in atari computer games advancing similar ideas also the alphazero program gained super human abilities in very complex games such as chess and go through rl based self play silver et al 2018 considered as state of the art within drl today recent work using drl on dynamic systems includes a variety of path following and station keeping problems for systems which often contain hard to model nonlinearities ranging from aerial vehicles koch et al 2018 bohn et al 2019 to underwater vehicles kjærnli 2018 knudsen 2019 drl based methods for control of marine surface vessels has similar to traditional methods divided the control problem into motion control and ta in addition to motion planning chen et al 2019 guo et al 2020 and path following through speed and or heading control martinsen and lekkas 2018 cui et al 2019 martinsen et al 2020 demonstrated an approach that included data driven system identification used in feedforward control with a rl based feedback control law to create a motion controller capable of solving both low speed dp tasks and high speed path following ta has also been subject to testing of artificial intelligence based methods luman et al 2015 solved ta by using genetic algorithms and wu et al 2016 used bee colony based optimization techniques both for energy optimal allocation skulstad et al 2018 showed that a neural network was able to be trained on translating desired forces from a pid motion controller into thruster commands rather efficiently the work in this paper was motivated by some of the key results coming from martinsen et al 2020 where they combined their motion controller with an existing implementation of a ta algorithm from det norske veritas dnv on the revolt platform dnv 2015 one of their discussions was based on the observed mismatch between the forces commanded by their motion controller and the commanded forces from the ta coming from that the desired forces from their motion controller was assumed to be instantaneously achievable while in reality the ta involves delays in terms of the actual time the podded thrusters use to rotate or to change the propellers speed the ta procedure itself was left out of the scope of their work but was recommended as future work this motivated the search for a control scheme that uses the advantages of a precomputed control law using drl which can learn the nonlinear dynamics of the vessel and the thrusters hence possibly circumventing modeling inaccuracies and computational complexity at the same time while directly optimizing the thruster commands in order to eliminate body frame errors the main objective of this paper is therefore to solve the dp control problem for a marine surface vessel utilizing the well proven proximal policy optimization ppo algorithm schulman et al 2017 for training a drl based control scheme which encapsulated both the motion controller and the ta into one entity access to the ta method from dnv was available for testing in this paper so the performance is evaluated by comparing with previously implemented control systems on board the revolt platform using a motion control law including pid and feedforward control and dnv s ta separately both in simulation and sea trial demonstrations the main contributions of this paper is as follows i an end to end learning procedure for drl based methods using neural networks to encapsulate both motion control and thrust allocation into one entity for solving dp tasks while at the same time not suffering from computational complexity ii introduction of a novel multi variable gaussian reward function used to train the reinforcement learning agent in eliminating body frame errors for marine vessels iii presentation of performance in both simulations and in a sea trial demonstrating the transfer capability of the drl model from simulation to physical systems having only trained the model in simulations the organization of this paper is as follows section 2 gives a description of the dp task the vessel model and drl while section 3 explains the development of the drl framework and the procedure of training the neural networks section 4 demonstrates the performance from simulations and the sea trial and discusses the main findings finally section 5 concludes the work the notation used in this paper is shown in table 1 2 system description 2 1 dynamic positioning and vessel dynamics to analyze the vessel s motions the geographical reference frame north east down ned and the body fixed reference frame was used ned is chosen as a tangent plane fixed to the surface of the earth and positions within the frame is denoted x n y n z n where the x n axis points towards true north n the y n axis points east e and the z n axis points downwards the body fixed reference frame is denoted x b y b z b and as defined in this paper the positive direction was defined for the x b axis to point in the forward direction of the vessel the y b axis towards starboard the z b axis downwards with the origin placed in the center of gravity cg of the vessel this implies that the vessel s heading ψ was defined to be relative to true north rotating clockwise in addition a hydrodynamic earth fixed frame denoted x h y h z h was used for modeling the vessel motions subject to wave loads when used in dp the origin of the frame is moved to the desired coordinate x d y d and aligned with the desired heading angle ψ d the vessel is assumed to oscillate with small motions about this frame in order to utilize linear theory when modeling the wave induced motions the pose η was used as the three dimensional vector of position and heading the vessel either as η n in the ned frame or as η b describing position and heading relative to the vessel s body frame the body frame errors η b represents the deviation between the vessel s current pose and the desired pose and a dp system should work to eliminate these deviations namely ensuring η b 0 by first calculating the errors in the ned frame as the deviation between the current pose and the desired pose in the ned frame η n η n η d n n e ψ the body frame errors are calculated as shown in eqs 1a 1b and 1c 1a x y c o s ψ s i n ψ s i n ψ c o s ψ n e 1b ψ ψ ψ d 1c η b x y ψ modeling the vessel motions are usually done in one of two ways a high fidelity process plant model ppm is used where the physics are modeled as exact as possible to reality for accurate numerical simulations and various analysis on the other hand a control plant model cpm is based on a simplified mathematical model of the vessel dynamics a cpm is usually used for stability analysis and classic controller design while this paper based the controller design on using a ppm for training neural networks thus the following briefly explains the ppm used for further explanation of the terms the reader is referred to fossen 2011 and sørensen 2018 the numeric values of the system matrices were found in alfheim and muggerud 2016 the vessel motions in a ppm could be simplified into two models sørensen et al 1996 low frequency lf wave loads and the wave frequency wf wave loads the lf wave loads are primarily coming from second order mean and slowly varying forces from waves current and wind the simulation model for the lf loads used in this paper was based on sørensen 2018 in which the formulation of the 6 dof equations of motion is given in eq 2 for a nonlinear lf model of the vessel 2 m ν c r b ν ν c a ν r ν r d ν r g η τ w a v e 2 τ w i n d τ b where ν r 6 is the body frame velocities ν r r 6 is the relative velocities between the vessel and the ocean current m r 6 6 represents the system inertia and added mass matrix c r b r 6 6 is the rigid body coriolis and centripetal matrix c a r 6 6 is the added mass coriolis and centripetal matrix d ν r r 6 6 represents the linear and nonlinear damping g η r 6 6 is the generalized restoring vector coming from buoyancy and gravitation τ w a v e 2 r 6 is the second order wave load τ w i n d r 6 is the wind load τ b r 6 is the control forces and moments put on the vessel by the actuators the second of the two simplified components are linked to the wave frequency wf components that is primarily due to first order wave loads here the coupled equations of the wf motions in surge sway heave roll pitch and yaw are assumed to be linear and can be formulated as shown in eq 3 3 m ω i η r w d p ω i η r w g η r w τ w a v e 1 η w j η 2 η r w where m ω i r 6 6 represents the system inertia matrix containing the vessel s mass and moment of inertia in addition to added mass coefficients that are dependent on the wave frequency ω i η r w r 6 is the wf motion vector in the hydrodynamics frame d p ω i r 6 6 is the wave radiation damping matrix g r 6 6 represents the linearized restoring coefficient matrix coming from gravity and buoyancy affecting heave roll and pitch only τ w a v e 1 r 6 is the first order wave excitation vector η w r 6 is the wf motion vector in the ned frame j η 2 r 3 3 is the rotation matrix relating the wf velocities between the ned frame and the hydrodynamic frame as defined in fossen 2011 2 2 the revolt ship model the revolt ship model was used as a demonstration platform it is a 3 meter long ship model representing a 1 20 scale model of the 60 meter long revolt ship concept dnv 2015 a digital twin or a ppm based on a 6dof model has been developed for the model scaled vessel by using matlab and simulink then verified through frequency domain analysis of a 3d model of the hull and through experiments in a towing tank the ppm was used for running simulations in dnv s cybersea simulation environment which is used to simulate the vessel and the relevant equipment onboard such as thrusters power system sensors position reference systems and possibly other equipment used in marine operations relevant for dp this allows for rapid deployment and testing of the control system in various sea states see nguyen et al 2013 for further details the real life ship model runs a tank 720 computer with the linux ubuntu lts 16 04 operating system on board powered by two 12 v batteries the robot operating system ros runs as a means of communication between the sensors global navigation satellite system accelerometer gyroscope and compass software and the various hardware having ros kinetic as the current version the propulsion consists of two fully rotatable podded two bladed thrusters in the stern referred to as port and starboard thrusters and a retractable podded two bladed bow thruster the main characteristics of the vessel and the thrusters are listed in table 2 while the thruster placements are displayed in fig 3 2 3 reinforcement learning in rl it is usually assumed that an agent makes actions in a certain environment e g a simulated environment with vessel dynamics and environmental loads and the interactions between the agent and the environment can be described as a markov decision process mdp sutton and barto 2017 an mdp consists of a set of states defining the state space s s a set of actions defining the action space a a a probability matrix relating the selection of an action a in a certain state s and ending up in a new state s p p s s a and a scalar reward function that weights the reward of taking action a in state s r r s a the rl process with such an mdp is illustrated in fig 2 where an agent decides action a t given a state s t yielding the next state s t 1 and a reward signal r t from the environment the goal of the rl algorithm or the agent is to find an optimal policy π which maximizes the rewards over time letting the return of a certain time period following time t be denoted g t a common formulation is the infinite horizon discounted return as shown in eq 4 where 0 γ 1 is the discount rate a weighting factor between rewards accumulated immediately and reward accumulated in future time steps 4 g t r t 1 γ r t 2 γ 2 r t 3 k 0 γ k r t k 1 since the rl agent does not have a perfect model of the world the task is to maximize the expected return an objective function j π representing the expected return to be maximized can be formulated as in eq 5 it expresses the expected return over the trajectory τ of state action pairs following the action selection of the agent s policy π interacting with the environment by observing a state taking an action and getting a reward accumulated as g τ 5 j π e τ π g τ commonly used in rl algorithms is the notion of a value function describing the estimated value of the return by starting in state s t and following the actions taken by the policy π into the future 6 v s t e τ π g τ s 0 s t various rl algorithms combine the policy and value function in different ways in order to approximate the optimal policy by the inclusion of anns for approximation rl algorithms expressive power has increased when solving mdps with continuous state and action spaces where actor only algorithms only approximate the policy by using an ann actor critic algorithms use anns for approximating both the policy called the actor and the value function estimator called the critic in this work the actor s output being an action when given a state s t is denoted π θ a s t while the value function estimate from the critic is denoted v ˆ θ c s t the algorithm used in this paper is called proximal policy optimization ppo and uses the actor critic structure to learn the policy with the help of a value function through ppo schulman et al 2017 presented an objective function for training the actor s ann in a way that was data efficient robust with respect to hyperparameter changes and easy to implement it was based on maximizing the expected return while limiting the magnitude of the updates to the actor s ann by using the idea of trust regions it did so by using the conservative estimate of the expected return of a state action pair s t a t as shown in eq 7 7 e t g t e t r θ a t a ˆ t here r θ a t is the probability ratio between taking an action in a current state with the new network parameters θ a and the old ones θ a o l d note that r θ a 0 θ and r θ a o l d t 1 0 8 r θ a t π θ a a t s t π θ a o l d a t s t a ˆ t denotes the estimate of the advantage function representing how much better it was to select action a t in state s t compared to the average return of all actions available in state s t generalized advantage estimation schulman et al 2015 was used for estimating the advantage as shown in eq 9 where the critic s value estimates from eq 6 was used 9 a ˆ t i 0 γ λ i r t γ v ˆ θ c s t 1 v ˆ θ c s t by limiting the magnitude of r θ a t per parameter update we can perform improvements on the objective function while being careful of not making too large parameter updates in θ a space which might reduce the performance in the policy s output space π θ a the proposed objective function from schulman et al 2017 included bounding the size of r θ a t on both sides called clipping in order to enforce a limitation of the probability ratio so that r θ a t 1 ϵ 1 ϵ by choosing the objective function to be the minimum of the conventional estimate from eq 7 and the estimate using the clipped ratio gave their clipped surrogate objective function as shown in eq 10 where the conservative objective function estimate is used unless the value of the ratio r θ a t becomes too large or too small 10 j θ a t min r θ a t a ˆ t clip r θ a t 1 ϵ 1 ϵ a ˆ t the critic network performed parameter updates by attempting to minimize the deviations between its value function estimates versus the experienced values of being in a state by using the mean squared error function thus the update rule was as showed in eq 11 for the critic s weights θ c the actor attempted to maximize the clipped surrogate objective and therefore used the update rule for its weights θ a as in eq 12 11 θ c k 1 argmin θ c 1 t t 1 t v ˆ θ c k s t g t 2 12 θ a k 1 argmax θ a 1 t t 1 t j θ a t the training process following these update rules can be illustrated as shown in fig 4 where the reward from the reward function is propagated to the critic network which in turn calculates information for the actor network update rule as seen used in eqs 9 and 10 the following section shows how the input and outputs of the networks were defined and how the reward function was shaped in order to allow the neural networks to learn how to solve the dp task specifically 3 controller design and implementation the characteristic difference between traditional methods and the one proposed in this paper is shown in fig 5 fig 5 shows how the motion controller and ta were encapsulated into one entity represented by a trained ann the actor network compared to fig 1 no information of the vessel dynamics was given to the controller the neural network directly translated the body frame errors into thruster commands making it a feedback controller it should be noted that when training was finished only the actor ann was used as the control policy the critic ann and the reward function was only used during the training process 3 1 state and action vector the state vector used as input to the actor and the critic networks was developed with the goal of dp in mind thus adding the body frame errors as the first components additionally it was beneficial for the agent to have access to the body frame velocities calculated from the body frame errors between the two most recent time steps u v and ψ which were added next in addition the previous time step s thruster commands were added to the state vector in order to increase the agent s ability to minimize the penalty put on the size of the output from the network s thrust components the quantities in the state vector was extracted straight from the simulator during training and from the existing observer and reference filter in ros during testing the state vector is shown in eq 13 where x t y t and ψ t are the body frame position and heading error u t v t and ψ t represents the surge sway and yaw velocities respectively estimated from position differences between time steps and n b t 1 n p t 1 and n s t 1 represents the previous time step s thruster commands for the bow port and starboard thruster respectively all normalized to the region 1 1 to represent a fraction of maximum thrust 13 s t x t y t ψ t u t v t ψ t n b t 1 n p t 1 n s t 1 formulating the action vector a t it was found to increase the rate of learning if letting the policy predict the sines s and cosines c of the angles of the port p and starboard s thrusters instead of the raw angles directly previous experience alfheim and muggerud 2016 øvereng 2020 had shown that the dp ability of the vessel improved by setting the bow thruster to a fixed angle of 90 so the bow thruster s angle was not included in the action vector the resulting action vector was as shown in eq 14 14 a t n b t n p t n s t s α ˆ p t c α ˆ p t s α ˆ s t c α ˆ s t in eq 14 n b t n p t and n s t represents the commanded thrust signal for the bow port and starboard thruster respectively in the region of 100 100 of maximum thruster rpm s α ˆ p s t and c α ˆ p s t represent the outputted sines and cosines of the angles og the port and starboard thruster while the final command sent to the thrusters where calculated as shown in eq 15 where atan2 is the four quadrant inverse tangent function 15 α i t atan2 s α ˆ i t c α ˆ i t 3 2 reward shaping the shape of the reward function for rewarding small deviations from the setpoint in terms of euclidean distance d x 2 y 2 and heading deviation ψ was inspired by the shape of the output layer of the policy network itself using a multivariate gaussian function hence small deviations was rewarded by using the shape of the multivariate gaussian as shown in eqs 16 and 17 spanning the two dimensional d ψ space by using a diagonal square matrix σ 1 1 σ is usually denoted as a covariance matrix but for purposes in this paper it was only used for tuning and did not represent any covariances 16 σ diag σ d 2 σ ψ 2 17 r g a u s s c g a u s s exp 1 2 d ψ σ 1 d ψ to reduce the sparsity of the function as only a negligible reward was given when far away from the setpoint a function was added by using a distance measurement ϕ in the d ψ space for guiding the agent s learning process in addition to a constant as shown in eq 18 the resulting reward function for pose was therefore as shown in fig 6 18 r as max 0 1 c a s ϕ c c o n s t since actuator penalties were added later a constant c c o n s t was also added in order to avoid cases were the agent could find it more profitable to exert no thrust than to reduce the body frame errors to avoid the agent overshooting the setpoints penalties on the velocities was added as a small quadratic penalty using weighting coefficients c u c v and c ψ for the surge sway and yaw velocities respectively 19 r v e l c u u 2 c v v 2 c ψ ψ 2 in order to achieve energy efficiency in addition to low wear and tear on the actuators small penalties were put on the magnitude of the commanded thrust n weighted with c n in addition to the derivatives of the commanded thrust n and angles α weighted with c n and c α respectively the resulting actuator penalties are shown in eq 20 where contributions from all three thrusters were summed together 20 r a c t i 3 c n i n i c n i n i c α i α i these contributions result in the total reward function that was used for rewarding the agent at each time step during training 21 r t o t r g a u s s r a s r v e l r a c t 3 3 training procedure the training was done by randomly initializing the pose of the vessel in various locations around a setpoint within a radius of 2 5 vessel lengths and within 45 of the setpoint s heading the agent collected experiences as state action pairs from each time step by interacting with the environment it should be noted that during training the drl method was updated on the same windows computer that ran the simulator hence receiving perfect information about the states directly from the cybersea simulation environment the critic and actor networks were updated according to eqs 11 and 12 respectively when experience from 1600 time steps was collected in total updates to the networks were performed with state action pairs from 2 4 1 0 6 time steps using an implementation of the ppo algorithm based on openai s repository 2 2 https spinningup openai com last accessed 06 june 2020 with a stochastic actor network for which the gaussian action sampling noise was completely reduced at the end of training the actor critic architecture was set up using independent anns for the actor and the critic both using the state vector s t r 9 as input the networks used three fully connected hidden layers with 80 neurons and the output of the actor at time step t was a t r 7 while the output from the critic was v θ c s t r 1 both networks used the leaky relu activation functions for nonlinearities and the adam optimizer for parameter updates the average return obtained per episode having an optimal value of 1400 and the objective function of the critic optimal value of 0 are shown in fig 7 the average episodal return fluctuated due to the random initialization of the vessel s state between each trajectory within each episode albeit improving steadily on average 4 results and discussion to evaluate the performance of the controllers a four corner test was used the four corner test was performed by changing setpoints to different corners of a square illustrated in fig 8 and with coordinates as listed in table 3 during testing only the actor ann was used as control policy in the drl method disabling the stochastic noise from openai s implementation differing from the training procedure the actor ann was loaded into the control system in ros on a linux computer receiving the estimated states from the ekf state estimator which estimated the states from the sensor inputs coming from either the digital twin from the cybersea environment during simulations or the actual model ship during sea trials in simulation the controllers robustness against external disturbances was evaluated during the four corner test while enabling current forces the current was irrotational and non fluctuating with velocity ν c 0 2 m s and direction β c 13 5 from north west no information about the environmental loads were given to the control system and the tests were started when the vessel had been standing still for 30 s in the sea trial negligible environmental loads were present in order to evaluate the effect of an integral controller an integral effect was added to the state vector of the drl method augmenting the body frame error pose in the state vector according to η ˆ t η t η ˆ s s t where the discrete integration was calculated according to η ˆ s s t η ˆ s s t 1 δ t k η t δ t is the time step and k is a coefficient deciding the speed of the integral accumulation a windup guard was also added to prevent overshoots during the sea trial the same four corner test coordinates were used the simulation was performed using the drl method with and without integral effect it was also benchmarked against two other methods the first being a motion control law consisting of feedforward a pid feedback controller developed in alfheim and muggerud 2016 combined with a pseudoinverse based ta and a qp based ta developed in øvereng 2020 the acronyms for the methods used in the plots going forward were as shown in table 4 to evaluate performance the integral of absolute error iae metric was used as a measurement of how accurate the dp system was in terms of reducing the body frame error between the current pose and the desired pose the iae metric was chosen due to its convenience when testing with several setpoints in the same scenario due to its independence of time compared to other popular metrics such as the integral of time weighted absolute error itae metric the lower the iae score the more accurate a method is evaluated as the measurement η was used where the body frame errors was normalized for making the iae a dimensionless number dividing the respective deviations with 5 m 5 m 25 meaning that a 5 degree deviation was weighted equally as a 1 m deviation in model scale 22 i a e t 0 t η σ η σ d σ the energy usage was calculated by integrating the power for each of the commanded rps signals the power as a function of a propeller s revolution per second rps n is given as shown under the integral in eq 23 where ρ is the sea water density d is the propeller diameter and k q is the propeller torque coefficient found through model scale tests in alfheim and muggerud 2016 lower w means better fuel efficiency 23 w t 0 t 2 π ρ k q d 5 sgn n σ n σ 3 d σ note that both the simulations and sea trials were carried out with the model scaled vessel the results have been scaled to full scale by using froude number scaling meaning that it shows results comparable to other 60 meter vessels of similar size and shape for details on froude number scaling in hydrodynamic experiments the reader is referred to islam et al 2016 4 1 simulation the simulation results are displayed in fig 9 it was observed that only the drl method with integral effect was able to totally remove the steady state body frame error in all setpoints while the classic methods displayed a slight steady state deviation in some setpoints likely due to control scheme tuning from previous work on revolt the drl method without integral effect struggled with removing steady state errors in sway the classic methods and the drl method with integral effect showed some overshoots of the setpoints but only the classic methods showed oscillations particularly in yaw before settling on a setpoint this leads to questioning the quality of the existing implementation of the motion control law on revolt which both the ipi and the qp allocation depended on it was believed that this came from the fact that the motion controller was tuned on board the physical model of revolt in previous work thus performing poorly in simulation the qp allocation resulted in having the highest values of iae and energy usage the drl method with integral effect resulted in the lowest values of both metrics as it resulted in 15 lower iae and 38 less energy usage compared to the qp allocation while also having 8 lower iae and 33 less energy usage compared to the ipi allocation 4 2 sea trial the sea trials were performed with the revolt in model scale as presented in section 2 first a measurement was taken of the time the ann used to perform a calculation on the computer on board the model ship the maximum time between two calculations was 0 015 s indicating that using ann based approaches is not likely to suffer from computation time on the model ship it was found that the bow thruster experienced high friction between the propeller and the propeller housing causing the propeller to get stuck unless being commanded approximately 50 thrust this came at the cost of overshoots and or oscillations in sway and yaw due to the differences between the digital twin used in training and the actual model ship it was also found that the bow thruster s propeller was unsymmetrical yielding a maximum force when exerting forces towards starboard when locked to 90 of 2 4 times the size of the maximum when exerting forces towards port the drl method had however been trained with symmetrical bow thruster parameters due to time constraints following these experiences the four corner test was performed with only the drl method without any integral effect on the state vector and the motion controller with the pseudoinverse based allocation method as a baseline the results from the four corner test in fig 10 showed that the drl method was able to reach all setpoints in approximately the same time in the sea trial as in the simulation and reached the setpoints without much overshoot except when the vessel was traveling with sway motions at 80 and 270 s which was also the case for the ipi method this was presumably due to the bow thruster issue being more severe for the drl method which had learned to use the bow thruster more extensively than classic methods in simulation in order to be energy efficient the oscillatory movements were both coming from the bow thruster issue in addition to that the stern thrusters had to compensate in order to follow the reference signal while both methods displayed overshoots of the setpoint changes the oscillatory behavior especially in heading caused the resulting iae value to be larger for the drl method than for the classic ipi method the increased use of all thrusters also made the drl method significantly less energy effective mainly due to the compensating stern thrusters both compared to results from simulation and to the baseline controller in the sea trial as the issue with high friction in the bow thruster indicated that the drl method was less robust to changes in the dynamics between simulation and real life it also suggests that further training of the neural networks on board the real vessel would improve performance 5 conclusion this paper presented the implementation of the ppo algorithm for developing a drl control scheme for applications to low speed control problems such as dp the learning process benefited greatly from including prediction of sines and cosines of the stern thrusters angles and by using a multivariate gaussian reward function with an additional element to combat sparsity the test scenarios were considered satisfactory when compared to traditional methods where simulations proved that the performance of the drl method was both accurate and energy efficient able to suppress steady state deviations when combined with an integrated state vector the drl method also showed positional accuracy when employing it to a physical model in a sea trial deemed excellent considering that the drl method was trained in simulation with perfect information about the vessel s state zero environmental forces and no thruster issues which was not the case during the sea trial the proposed method also solves the issue of computational complexity as the computational time of the control scheme s neural network was negligible the work concludes that drl s potential for accurate and energy efficient control is realizable and proposes that the presented drl method is a strong contender when looking for new methods for station keeping and low speed maneuvering in a way that encapsulates both the motion control and thrust allocation for future work it is suggested to focus on providing stability guarantees of drl systems and to explore continual learning as a method for tuning a drl model from simulations to the real life model by continuing the training process on real life data in order to adapt to differences in the system dynamics and actuator characteristics between simulation and real life credit authorship contribution statement simen sem øvereng writing original draft methodology software validation dong trong nguyen main supervisor reviewing and editing geir hamre co supervisor declaration of competing interest one or more of the authors of this paper have disclosed potential or pertinent conflicts of interest which may include receipt of payment either direct or indirect institutional support or association with an entity in the biomedical field which may be perceived to have potential conflict of interest with this work for full disclosure statements refer to https doi org 10 1016 j oceaneng 2021 109433 dong trong nguyen reports financial support was provided by amos ntnu acknowledgments this paper is based on the work of a master s thesis øvereng 2020 which was written in collaboration with dnv the work was sponsored by the research council of norway through the centre of excellence funding scheme project number 223254 amos all implementations can be found at https github com simensov ml4ca appendix reward function coefficients the final coefficients for the reward function used during training of the drl agent in this paper is given in table 5 
20523,this paper demonstrates the implementation and performance testing of a deep reinforcement learning based control scheme used for dynamic positioning of a marine surface vessel the control scheme encapsulated motion control and control allocation by using a neural network which was trained on a digital twin without having any prior knowledge of the system dynamics using the proximal policy optimization learning algorithm by using a multivariate gaussian reward function for rewarding small errors between the vessel and the various setpoints while encouraging small actuator outputs the proposed deep reinforcement learning based control scheme showed good positioning performance while being energy efficient both simulations and model scale sea trials were carried out to demonstrate performance compared to traditional methods and to evaluate the ability of neural networks trained in simulation to perform on real life systems keywords dynamic positioning deep reinforcement learning proximal policy optimization reward shaping 1 introduction dynamic positioning dp of marine vessels is concerned with maintaining a vessel s position and heading while using a computer program to control the vessel s actuators due to the nonlinear dynamics of marine vessels and the stochastic behavior of the environment the dp task can become quite complex traditional methods for solving dp consist of a state estimation component responsible for signal processing and estimation of the vessel s states given the various sensor inputs a guidance system responsible for calculating set points to the control system and a control system which typically consists of a motion control law and a thrust allocation ta method a simplified overview of the dp system is shown in fig 1 showing the connectivity between the above mentioned dp system components including the forces acting on the vessel coming from the environmental loads and the actuators a considerable amount of research has gone into the state estimation algorithms as the dp system should only counteract the low frequency wave motions which cause the vessel to drift over time filtering out the wave frequency motions which cause the vessel to oscillate early work included the use of notch filters and low pass filtering while today s methods tend to linearize the dynamics and use linear quadratic estimation based on the work by kalman in the 1960 s with applications like in balchen et al 1980 who combined the kalman filter kf with optimal control the extended kalman filter ekf has become a standard in which the dynamics are linearized around working points using the taylor expansion but it lacks global stability proofs since the dynamics are linearized within certain regions of heading angle one option to the ekf is the nonlinear passive observer derived by fossen and strand 1999 providing global stability proofs while using less tuning parameters with demonstrated performance on a supply vessel since an ekf was already implemented on the vessel used for demonstrations in this paper the focus was on the control aspect of dp namely the motion control and the thrust allocation traditional methods used in a control system divide the control problem itself into two parts the motion controller and the thrust allocation the motion controller calculates the generalized control forces τ d to put on the vessel in order to move it towards a setpoint while the ta translates these generalized forces into thruster commands resulting in the actual forces τ b on the vessel a widely used motion control law for controlling the horizontal motions of a vessel is to use three decoupled pid feedback control laws in combination with a feedforward law that combines the modeled system dynamics with information such as measured wind speeds or changes in desired states in order to calculate desired forces up front however as the vessel dynamics are highly nonlinear inaccuracies arise due to modeling errors in addition to time varying environmental and or operating conditions more advanced control methods aiming to combat these issues include methods that use gain scheduling exemplified by tannuri et al 2006 using model reference adaptive control for time varying environmental loads methods using pid with fuzzy logic which adapts controller s coefficients has been demonstrated such as the fuzzy pid controller by xu et al 2019 other methods aimed at including the nonlinear dynamics directly in the controller design such as backstepping control a recursive control design methodology introduced by kokotovic 1992 and widely exemplified by in the works of fossen and grøvlen 1998 and skjetne and fossen 2004 and du et al 2018 katebi et al 2001 used the h controller design method based on the wind and wave disturbances providing an option for multivariate systems with coupling terms also sliding mode control has been investigated a nonlinear controller design method that consists of a sliding surface which is meant to guarantee stable dynamics when the trajectory lies on it demonstrated for marine vessels in dp operations by tannuri et al 2010 nguyen et al 2007 used hybrid control as a means of expanding the range of varying environmental conditions using a switching logic for selecting between a predetermined set of observers and controllers according to the estimated sea state spectre s peak frequency the work was later extended to apply for various operating speeds as well nguyen et al 2008 the thrust allocation algorithm s goal is to output actuator forces that is as close to the ones calculated from the motion controller i e minimizing τ b τ d 2 for most marine surface vessels the number of actuators are larger than the degrees of freedom to be controlled and hence there might exist an infinite amount of thruster configurations that yields the desired forces therefore optimal solutions must be chosen with respect to some objective criteria as a consequence ta methods are typically based on optimization johansen and fossen 2013 which takes aim at minimizing a cost function subject to the physical constraints of the thrusters and the relationship between thruster forces and total force generation this allows for flexible constraint handling while optimizing a designable objective function for minimizing fuel consumption a quadratic programming qp approach is common in which the cost function includes a quadratic cost on thruster usage optimization based methods could suffer from complex actuator setups leading to nonlinear optimization constraints and nonconvex objective functions which can be computationally demanding to solve online avoiding some of the nonlinearities that creates computational issues the application of an extended thrust formulation for calculating a pseudoinverse of the linear actuator model has become fairly standard in the industry sørdalen 1997 jenssen and realfsen 2006 though requiring some iterative logic to ensure that the commanded thruster signals are feasible a variety of workarounds of the nonlinearities has been proposed see e g johansen et al 2008 for allocation with a propeller and rudder interaction where the proposed method divide the nonconvex problem into several convex qp problems with a switching logic to decide on the best solution by comparing final costs of each separate sub solution other approaches include multiparametric quadratic programs mpqp gupta et al 2011 which pre computes optimal parametric functions offline and as demonstrated by johansen et al 2005 offers real time applications by searching for the optimal solutions within the pre computed functions the method was further expanded by leavitt 2008 combining several mpqp formulations with different properties including a blending and a switching logic for deciding the best solution from the sub problems newer methods improve the accuracy of ta methods as shown by arditti et al 2018 which used sequential qp with slack variables including actual thrust constraints and hydrodynamic thruster interactions in high detail to increase ta accuracy while reducing energy consumption through the rapid development of computer hardware model predictive control mpc has become a viable option for the allocation of actuator commands vermillion et al 2007 naderi et al 2019 it has also been shown to be applicable for encapsulating both the motion controller and the ta into one entity as demonstrated by veksler et al 2016 they formulated the controller as an optimization over a given prediction horizon calculating optimal thruster commands through minimizing a cost function which included thruster usage and state deviations while formulating the vessel and thruster dynamics in addition to their limitations as constraints to the optimization procedure reinforcement learning rl algorithms have been used with promising results in a large variety of decision making tasks including control problems a comprehensive overview of rl can be found in sutton and barto 2017 as opposed to the traditional methods which are based on instructive design based on some sort of modeling of the vehicle dynamics rl based controllers is developed in a trial and error fashion finding or learning a control policy through choosing actions while receiving feedback from a designed reward function signal the behavior is corrected based on a reward mechanism an incentive for exploring methods within model free rl has been that they have shown to provide frameworks for learning control policies by using methods that has no a priori knowledge of the system dynamics this has allowed for development of controllers for nonlinear systems without any attention to dynamics modeling these methods have especially proven performance when combining rl with deep artificial neural networks ann giving rise to deep reinforcement learning drl widespread attention of drl based methods was attained with the demonstration of deep q networks dqn mnih et al 2013 which combined q learning with neural networks to reach super human level in atari computer games advancing similar ideas also the alphazero program gained super human abilities in very complex games such as chess and go through rl based self play silver et al 2018 considered as state of the art within drl today recent work using drl on dynamic systems includes a variety of path following and station keeping problems for systems which often contain hard to model nonlinearities ranging from aerial vehicles koch et al 2018 bohn et al 2019 to underwater vehicles kjærnli 2018 knudsen 2019 drl based methods for control of marine surface vessels has similar to traditional methods divided the control problem into motion control and ta in addition to motion planning chen et al 2019 guo et al 2020 and path following through speed and or heading control martinsen and lekkas 2018 cui et al 2019 martinsen et al 2020 demonstrated an approach that included data driven system identification used in feedforward control with a rl based feedback control law to create a motion controller capable of solving both low speed dp tasks and high speed path following ta has also been subject to testing of artificial intelligence based methods luman et al 2015 solved ta by using genetic algorithms and wu et al 2016 used bee colony based optimization techniques both for energy optimal allocation skulstad et al 2018 showed that a neural network was able to be trained on translating desired forces from a pid motion controller into thruster commands rather efficiently the work in this paper was motivated by some of the key results coming from martinsen et al 2020 where they combined their motion controller with an existing implementation of a ta algorithm from det norske veritas dnv on the revolt platform dnv 2015 one of their discussions was based on the observed mismatch between the forces commanded by their motion controller and the commanded forces from the ta coming from that the desired forces from their motion controller was assumed to be instantaneously achievable while in reality the ta involves delays in terms of the actual time the podded thrusters use to rotate or to change the propellers speed the ta procedure itself was left out of the scope of their work but was recommended as future work this motivated the search for a control scheme that uses the advantages of a precomputed control law using drl which can learn the nonlinear dynamics of the vessel and the thrusters hence possibly circumventing modeling inaccuracies and computational complexity at the same time while directly optimizing the thruster commands in order to eliminate body frame errors the main objective of this paper is therefore to solve the dp control problem for a marine surface vessel utilizing the well proven proximal policy optimization ppo algorithm schulman et al 2017 for training a drl based control scheme which encapsulated both the motion controller and the ta into one entity access to the ta method from dnv was available for testing in this paper so the performance is evaluated by comparing with previously implemented control systems on board the revolt platform using a motion control law including pid and feedforward control and dnv s ta separately both in simulation and sea trial demonstrations the main contributions of this paper is as follows i an end to end learning procedure for drl based methods using neural networks to encapsulate both motion control and thrust allocation into one entity for solving dp tasks while at the same time not suffering from computational complexity ii introduction of a novel multi variable gaussian reward function used to train the reinforcement learning agent in eliminating body frame errors for marine vessels iii presentation of performance in both simulations and in a sea trial demonstrating the transfer capability of the drl model from simulation to physical systems having only trained the model in simulations the organization of this paper is as follows section 2 gives a description of the dp task the vessel model and drl while section 3 explains the development of the drl framework and the procedure of training the neural networks section 4 demonstrates the performance from simulations and the sea trial and discusses the main findings finally section 5 concludes the work the notation used in this paper is shown in table 1 2 system description 2 1 dynamic positioning and vessel dynamics to analyze the vessel s motions the geographical reference frame north east down ned and the body fixed reference frame was used ned is chosen as a tangent plane fixed to the surface of the earth and positions within the frame is denoted x n y n z n where the x n axis points towards true north n the y n axis points east e and the z n axis points downwards the body fixed reference frame is denoted x b y b z b and as defined in this paper the positive direction was defined for the x b axis to point in the forward direction of the vessel the y b axis towards starboard the z b axis downwards with the origin placed in the center of gravity cg of the vessel this implies that the vessel s heading ψ was defined to be relative to true north rotating clockwise in addition a hydrodynamic earth fixed frame denoted x h y h z h was used for modeling the vessel motions subject to wave loads when used in dp the origin of the frame is moved to the desired coordinate x d y d and aligned with the desired heading angle ψ d the vessel is assumed to oscillate with small motions about this frame in order to utilize linear theory when modeling the wave induced motions the pose η was used as the three dimensional vector of position and heading the vessel either as η n in the ned frame or as η b describing position and heading relative to the vessel s body frame the body frame errors η b represents the deviation between the vessel s current pose and the desired pose and a dp system should work to eliminate these deviations namely ensuring η b 0 by first calculating the errors in the ned frame as the deviation between the current pose and the desired pose in the ned frame η n η n η d n n e ψ the body frame errors are calculated as shown in eqs 1a 1b and 1c 1a x y c o s ψ s i n ψ s i n ψ c o s ψ n e 1b ψ ψ ψ d 1c η b x y ψ modeling the vessel motions are usually done in one of two ways a high fidelity process plant model ppm is used where the physics are modeled as exact as possible to reality for accurate numerical simulations and various analysis on the other hand a control plant model cpm is based on a simplified mathematical model of the vessel dynamics a cpm is usually used for stability analysis and classic controller design while this paper based the controller design on using a ppm for training neural networks thus the following briefly explains the ppm used for further explanation of the terms the reader is referred to fossen 2011 and sørensen 2018 the numeric values of the system matrices were found in alfheim and muggerud 2016 the vessel motions in a ppm could be simplified into two models sørensen et al 1996 low frequency lf wave loads and the wave frequency wf wave loads the lf wave loads are primarily coming from second order mean and slowly varying forces from waves current and wind the simulation model for the lf loads used in this paper was based on sørensen 2018 in which the formulation of the 6 dof equations of motion is given in eq 2 for a nonlinear lf model of the vessel 2 m ν c r b ν ν c a ν r ν r d ν r g η τ w a v e 2 τ w i n d τ b where ν r 6 is the body frame velocities ν r r 6 is the relative velocities between the vessel and the ocean current m r 6 6 represents the system inertia and added mass matrix c r b r 6 6 is the rigid body coriolis and centripetal matrix c a r 6 6 is the added mass coriolis and centripetal matrix d ν r r 6 6 represents the linear and nonlinear damping g η r 6 6 is the generalized restoring vector coming from buoyancy and gravitation τ w a v e 2 r 6 is the second order wave load τ w i n d r 6 is the wind load τ b r 6 is the control forces and moments put on the vessel by the actuators the second of the two simplified components are linked to the wave frequency wf components that is primarily due to first order wave loads here the coupled equations of the wf motions in surge sway heave roll pitch and yaw are assumed to be linear and can be formulated as shown in eq 3 3 m ω i η r w d p ω i η r w g η r w τ w a v e 1 η w j η 2 η r w where m ω i r 6 6 represents the system inertia matrix containing the vessel s mass and moment of inertia in addition to added mass coefficients that are dependent on the wave frequency ω i η r w r 6 is the wf motion vector in the hydrodynamics frame d p ω i r 6 6 is the wave radiation damping matrix g r 6 6 represents the linearized restoring coefficient matrix coming from gravity and buoyancy affecting heave roll and pitch only τ w a v e 1 r 6 is the first order wave excitation vector η w r 6 is the wf motion vector in the ned frame j η 2 r 3 3 is the rotation matrix relating the wf velocities between the ned frame and the hydrodynamic frame as defined in fossen 2011 2 2 the revolt ship model the revolt ship model was used as a demonstration platform it is a 3 meter long ship model representing a 1 20 scale model of the 60 meter long revolt ship concept dnv 2015 a digital twin or a ppm based on a 6dof model has been developed for the model scaled vessel by using matlab and simulink then verified through frequency domain analysis of a 3d model of the hull and through experiments in a towing tank the ppm was used for running simulations in dnv s cybersea simulation environment which is used to simulate the vessel and the relevant equipment onboard such as thrusters power system sensors position reference systems and possibly other equipment used in marine operations relevant for dp this allows for rapid deployment and testing of the control system in various sea states see nguyen et al 2013 for further details the real life ship model runs a tank 720 computer with the linux ubuntu lts 16 04 operating system on board powered by two 12 v batteries the robot operating system ros runs as a means of communication between the sensors global navigation satellite system accelerometer gyroscope and compass software and the various hardware having ros kinetic as the current version the propulsion consists of two fully rotatable podded two bladed thrusters in the stern referred to as port and starboard thrusters and a retractable podded two bladed bow thruster the main characteristics of the vessel and the thrusters are listed in table 2 while the thruster placements are displayed in fig 3 2 3 reinforcement learning in rl it is usually assumed that an agent makes actions in a certain environment e g a simulated environment with vessel dynamics and environmental loads and the interactions between the agent and the environment can be described as a markov decision process mdp sutton and barto 2017 an mdp consists of a set of states defining the state space s s a set of actions defining the action space a a a probability matrix relating the selection of an action a in a certain state s and ending up in a new state s p p s s a and a scalar reward function that weights the reward of taking action a in state s r r s a the rl process with such an mdp is illustrated in fig 2 where an agent decides action a t given a state s t yielding the next state s t 1 and a reward signal r t from the environment the goal of the rl algorithm or the agent is to find an optimal policy π which maximizes the rewards over time letting the return of a certain time period following time t be denoted g t a common formulation is the infinite horizon discounted return as shown in eq 4 where 0 γ 1 is the discount rate a weighting factor between rewards accumulated immediately and reward accumulated in future time steps 4 g t r t 1 γ r t 2 γ 2 r t 3 k 0 γ k r t k 1 since the rl agent does not have a perfect model of the world the task is to maximize the expected return an objective function j π representing the expected return to be maximized can be formulated as in eq 5 it expresses the expected return over the trajectory τ of state action pairs following the action selection of the agent s policy π interacting with the environment by observing a state taking an action and getting a reward accumulated as g τ 5 j π e τ π g τ commonly used in rl algorithms is the notion of a value function describing the estimated value of the return by starting in state s t and following the actions taken by the policy π into the future 6 v s t e τ π g τ s 0 s t various rl algorithms combine the policy and value function in different ways in order to approximate the optimal policy by the inclusion of anns for approximation rl algorithms expressive power has increased when solving mdps with continuous state and action spaces where actor only algorithms only approximate the policy by using an ann actor critic algorithms use anns for approximating both the policy called the actor and the value function estimator called the critic in this work the actor s output being an action when given a state s t is denoted π θ a s t while the value function estimate from the critic is denoted v ˆ θ c s t the algorithm used in this paper is called proximal policy optimization ppo and uses the actor critic structure to learn the policy with the help of a value function through ppo schulman et al 2017 presented an objective function for training the actor s ann in a way that was data efficient robust with respect to hyperparameter changes and easy to implement it was based on maximizing the expected return while limiting the magnitude of the updates to the actor s ann by using the idea of trust regions it did so by using the conservative estimate of the expected return of a state action pair s t a t as shown in eq 7 7 e t g t e t r θ a t a ˆ t here r θ a t is the probability ratio between taking an action in a current state with the new network parameters θ a and the old ones θ a o l d note that r θ a 0 θ and r θ a o l d t 1 0 8 r θ a t π θ a a t s t π θ a o l d a t s t a ˆ t denotes the estimate of the advantage function representing how much better it was to select action a t in state s t compared to the average return of all actions available in state s t generalized advantage estimation schulman et al 2015 was used for estimating the advantage as shown in eq 9 where the critic s value estimates from eq 6 was used 9 a ˆ t i 0 γ λ i r t γ v ˆ θ c s t 1 v ˆ θ c s t by limiting the magnitude of r θ a t per parameter update we can perform improvements on the objective function while being careful of not making too large parameter updates in θ a space which might reduce the performance in the policy s output space π θ a the proposed objective function from schulman et al 2017 included bounding the size of r θ a t on both sides called clipping in order to enforce a limitation of the probability ratio so that r θ a t 1 ϵ 1 ϵ by choosing the objective function to be the minimum of the conventional estimate from eq 7 and the estimate using the clipped ratio gave their clipped surrogate objective function as shown in eq 10 where the conservative objective function estimate is used unless the value of the ratio r θ a t becomes too large or too small 10 j θ a t min r θ a t a ˆ t clip r θ a t 1 ϵ 1 ϵ a ˆ t the critic network performed parameter updates by attempting to minimize the deviations between its value function estimates versus the experienced values of being in a state by using the mean squared error function thus the update rule was as showed in eq 11 for the critic s weights θ c the actor attempted to maximize the clipped surrogate objective and therefore used the update rule for its weights θ a as in eq 12 11 θ c k 1 argmin θ c 1 t t 1 t v ˆ θ c k s t g t 2 12 θ a k 1 argmax θ a 1 t t 1 t j θ a t the training process following these update rules can be illustrated as shown in fig 4 where the reward from the reward function is propagated to the critic network which in turn calculates information for the actor network update rule as seen used in eqs 9 and 10 the following section shows how the input and outputs of the networks were defined and how the reward function was shaped in order to allow the neural networks to learn how to solve the dp task specifically 3 controller design and implementation the characteristic difference between traditional methods and the one proposed in this paper is shown in fig 5 fig 5 shows how the motion controller and ta were encapsulated into one entity represented by a trained ann the actor network compared to fig 1 no information of the vessel dynamics was given to the controller the neural network directly translated the body frame errors into thruster commands making it a feedback controller it should be noted that when training was finished only the actor ann was used as the control policy the critic ann and the reward function was only used during the training process 3 1 state and action vector the state vector used as input to the actor and the critic networks was developed with the goal of dp in mind thus adding the body frame errors as the first components additionally it was beneficial for the agent to have access to the body frame velocities calculated from the body frame errors between the two most recent time steps u v and ψ which were added next in addition the previous time step s thruster commands were added to the state vector in order to increase the agent s ability to minimize the penalty put on the size of the output from the network s thrust components the quantities in the state vector was extracted straight from the simulator during training and from the existing observer and reference filter in ros during testing the state vector is shown in eq 13 where x t y t and ψ t are the body frame position and heading error u t v t and ψ t represents the surge sway and yaw velocities respectively estimated from position differences between time steps and n b t 1 n p t 1 and n s t 1 represents the previous time step s thruster commands for the bow port and starboard thruster respectively all normalized to the region 1 1 to represent a fraction of maximum thrust 13 s t x t y t ψ t u t v t ψ t n b t 1 n p t 1 n s t 1 formulating the action vector a t it was found to increase the rate of learning if letting the policy predict the sines s and cosines c of the angles of the port p and starboard s thrusters instead of the raw angles directly previous experience alfheim and muggerud 2016 øvereng 2020 had shown that the dp ability of the vessel improved by setting the bow thruster to a fixed angle of 90 so the bow thruster s angle was not included in the action vector the resulting action vector was as shown in eq 14 14 a t n b t n p t n s t s α ˆ p t c α ˆ p t s α ˆ s t c α ˆ s t in eq 14 n b t n p t and n s t represents the commanded thrust signal for the bow port and starboard thruster respectively in the region of 100 100 of maximum thruster rpm s α ˆ p s t and c α ˆ p s t represent the outputted sines and cosines of the angles og the port and starboard thruster while the final command sent to the thrusters where calculated as shown in eq 15 where atan2 is the four quadrant inverse tangent function 15 α i t atan2 s α ˆ i t c α ˆ i t 3 2 reward shaping the shape of the reward function for rewarding small deviations from the setpoint in terms of euclidean distance d x 2 y 2 and heading deviation ψ was inspired by the shape of the output layer of the policy network itself using a multivariate gaussian function hence small deviations was rewarded by using the shape of the multivariate gaussian as shown in eqs 16 and 17 spanning the two dimensional d ψ space by using a diagonal square matrix σ 1 1 σ is usually denoted as a covariance matrix but for purposes in this paper it was only used for tuning and did not represent any covariances 16 σ diag σ d 2 σ ψ 2 17 r g a u s s c g a u s s exp 1 2 d ψ σ 1 d ψ to reduce the sparsity of the function as only a negligible reward was given when far away from the setpoint a function was added by using a distance measurement ϕ in the d ψ space for guiding the agent s learning process in addition to a constant as shown in eq 18 the resulting reward function for pose was therefore as shown in fig 6 18 r as max 0 1 c a s ϕ c c o n s t since actuator penalties were added later a constant c c o n s t was also added in order to avoid cases were the agent could find it more profitable to exert no thrust than to reduce the body frame errors to avoid the agent overshooting the setpoints penalties on the velocities was added as a small quadratic penalty using weighting coefficients c u c v and c ψ for the surge sway and yaw velocities respectively 19 r v e l c u u 2 c v v 2 c ψ ψ 2 in order to achieve energy efficiency in addition to low wear and tear on the actuators small penalties were put on the magnitude of the commanded thrust n weighted with c n in addition to the derivatives of the commanded thrust n and angles α weighted with c n and c α respectively the resulting actuator penalties are shown in eq 20 where contributions from all three thrusters were summed together 20 r a c t i 3 c n i n i c n i n i c α i α i these contributions result in the total reward function that was used for rewarding the agent at each time step during training 21 r t o t r g a u s s r a s r v e l r a c t 3 3 training procedure the training was done by randomly initializing the pose of the vessel in various locations around a setpoint within a radius of 2 5 vessel lengths and within 45 of the setpoint s heading the agent collected experiences as state action pairs from each time step by interacting with the environment it should be noted that during training the drl method was updated on the same windows computer that ran the simulator hence receiving perfect information about the states directly from the cybersea simulation environment the critic and actor networks were updated according to eqs 11 and 12 respectively when experience from 1600 time steps was collected in total updates to the networks were performed with state action pairs from 2 4 1 0 6 time steps using an implementation of the ppo algorithm based on openai s repository 2 2 https spinningup openai com last accessed 06 june 2020 with a stochastic actor network for which the gaussian action sampling noise was completely reduced at the end of training the actor critic architecture was set up using independent anns for the actor and the critic both using the state vector s t r 9 as input the networks used three fully connected hidden layers with 80 neurons and the output of the actor at time step t was a t r 7 while the output from the critic was v θ c s t r 1 both networks used the leaky relu activation functions for nonlinearities and the adam optimizer for parameter updates the average return obtained per episode having an optimal value of 1400 and the objective function of the critic optimal value of 0 are shown in fig 7 the average episodal return fluctuated due to the random initialization of the vessel s state between each trajectory within each episode albeit improving steadily on average 4 results and discussion to evaluate the performance of the controllers a four corner test was used the four corner test was performed by changing setpoints to different corners of a square illustrated in fig 8 and with coordinates as listed in table 3 during testing only the actor ann was used as control policy in the drl method disabling the stochastic noise from openai s implementation differing from the training procedure the actor ann was loaded into the control system in ros on a linux computer receiving the estimated states from the ekf state estimator which estimated the states from the sensor inputs coming from either the digital twin from the cybersea environment during simulations or the actual model ship during sea trials in simulation the controllers robustness against external disturbances was evaluated during the four corner test while enabling current forces the current was irrotational and non fluctuating with velocity ν c 0 2 m s and direction β c 13 5 from north west no information about the environmental loads were given to the control system and the tests were started when the vessel had been standing still for 30 s in the sea trial negligible environmental loads were present in order to evaluate the effect of an integral controller an integral effect was added to the state vector of the drl method augmenting the body frame error pose in the state vector according to η ˆ t η t η ˆ s s t where the discrete integration was calculated according to η ˆ s s t η ˆ s s t 1 δ t k η t δ t is the time step and k is a coefficient deciding the speed of the integral accumulation a windup guard was also added to prevent overshoots during the sea trial the same four corner test coordinates were used the simulation was performed using the drl method with and without integral effect it was also benchmarked against two other methods the first being a motion control law consisting of feedforward a pid feedback controller developed in alfheim and muggerud 2016 combined with a pseudoinverse based ta and a qp based ta developed in øvereng 2020 the acronyms for the methods used in the plots going forward were as shown in table 4 to evaluate performance the integral of absolute error iae metric was used as a measurement of how accurate the dp system was in terms of reducing the body frame error between the current pose and the desired pose the iae metric was chosen due to its convenience when testing with several setpoints in the same scenario due to its independence of time compared to other popular metrics such as the integral of time weighted absolute error itae metric the lower the iae score the more accurate a method is evaluated as the measurement η was used where the body frame errors was normalized for making the iae a dimensionless number dividing the respective deviations with 5 m 5 m 25 meaning that a 5 degree deviation was weighted equally as a 1 m deviation in model scale 22 i a e t 0 t η σ η σ d σ the energy usage was calculated by integrating the power for each of the commanded rps signals the power as a function of a propeller s revolution per second rps n is given as shown under the integral in eq 23 where ρ is the sea water density d is the propeller diameter and k q is the propeller torque coefficient found through model scale tests in alfheim and muggerud 2016 lower w means better fuel efficiency 23 w t 0 t 2 π ρ k q d 5 sgn n σ n σ 3 d σ note that both the simulations and sea trials were carried out with the model scaled vessel the results have been scaled to full scale by using froude number scaling meaning that it shows results comparable to other 60 meter vessels of similar size and shape for details on froude number scaling in hydrodynamic experiments the reader is referred to islam et al 2016 4 1 simulation the simulation results are displayed in fig 9 it was observed that only the drl method with integral effect was able to totally remove the steady state body frame error in all setpoints while the classic methods displayed a slight steady state deviation in some setpoints likely due to control scheme tuning from previous work on revolt the drl method without integral effect struggled with removing steady state errors in sway the classic methods and the drl method with integral effect showed some overshoots of the setpoints but only the classic methods showed oscillations particularly in yaw before settling on a setpoint this leads to questioning the quality of the existing implementation of the motion control law on revolt which both the ipi and the qp allocation depended on it was believed that this came from the fact that the motion controller was tuned on board the physical model of revolt in previous work thus performing poorly in simulation the qp allocation resulted in having the highest values of iae and energy usage the drl method with integral effect resulted in the lowest values of both metrics as it resulted in 15 lower iae and 38 less energy usage compared to the qp allocation while also having 8 lower iae and 33 less energy usage compared to the ipi allocation 4 2 sea trial the sea trials were performed with the revolt in model scale as presented in section 2 first a measurement was taken of the time the ann used to perform a calculation on the computer on board the model ship the maximum time between two calculations was 0 015 s indicating that using ann based approaches is not likely to suffer from computation time on the model ship it was found that the bow thruster experienced high friction between the propeller and the propeller housing causing the propeller to get stuck unless being commanded approximately 50 thrust this came at the cost of overshoots and or oscillations in sway and yaw due to the differences between the digital twin used in training and the actual model ship it was also found that the bow thruster s propeller was unsymmetrical yielding a maximum force when exerting forces towards starboard when locked to 90 of 2 4 times the size of the maximum when exerting forces towards port the drl method had however been trained with symmetrical bow thruster parameters due to time constraints following these experiences the four corner test was performed with only the drl method without any integral effect on the state vector and the motion controller with the pseudoinverse based allocation method as a baseline the results from the four corner test in fig 10 showed that the drl method was able to reach all setpoints in approximately the same time in the sea trial as in the simulation and reached the setpoints without much overshoot except when the vessel was traveling with sway motions at 80 and 270 s which was also the case for the ipi method this was presumably due to the bow thruster issue being more severe for the drl method which had learned to use the bow thruster more extensively than classic methods in simulation in order to be energy efficient the oscillatory movements were both coming from the bow thruster issue in addition to that the stern thrusters had to compensate in order to follow the reference signal while both methods displayed overshoots of the setpoint changes the oscillatory behavior especially in heading caused the resulting iae value to be larger for the drl method than for the classic ipi method the increased use of all thrusters also made the drl method significantly less energy effective mainly due to the compensating stern thrusters both compared to results from simulation and to the baseline controller in the sea trial as the issue with high friction in the bow thruster indicated that the drl method was less robust to changes in the dynamics between simulation and real life it also suggests that further training of the neural networks on board the real vessel would improve performance 5 conclusion this paper presented the implementation of the ppo algorithm for developing a drl control scheme for applications to low speed control problems such as dp the learning process benefited greatly from including prediction of sines and cosines of the stern thrusters angles and by using a multivariate gaussian reward function with an additional element to combat sparsity the test scenarios were considered satisfactory when compared to traditional methods where simulations proved that the performance of the drl method was both accurate and energy efficient able to suppress steady state deviations when combined with an integrated state vector the drl method also showed positional accuracy when employing it to a physical model in a sea trial deemed excellent considering that the drl method was trained in simulation with perfect information about the vessel s state zero environmental forces and no thruster issues which was not the case during the sea trial the proposed method also solves the issue of computational complexity as the computational time of the control scheme s neural network was negligible the work concludes that drl s potential for accurate and energy efficient control is realizable and proposes that the presented drl method is a strong contender when looking for new methods for station keeping and low speed maneuvering in a way that encapsulates both the motion control and thrust allocation for future work it is suggested to focus on providing stability guarantees of drl systems and to explore continual learning as a method for tuning a drl model from simulations to the real life model by continuing the training process on real life data in order to adapt to differences in the system dynamics and actuator characteristics between simulation and real life credit authorship contribution statement simen sem øvereng writing original draft methodology software validation dong trong nguyen main supervisor reviewing and editing geir hamre co supervisor declaration of competing interest one or more of the authors of this paper have disclosed potential or pertinent conflicts of interest which may include receipt of payment either direct or indirect institutional support or association with an entity in the biomedical field which may be perceived to have potential conflict of interest with this work for full disclosure statements refer to https doi org 10 1016 j oceaneng 2021 109433 dong trong nguyen reports financial support was provided by amos ntnu acknowledgments this paper is based on the work of a master s thesis øvereng 2020 which was written in collaboration with dnv the work was sponsored by the research council of norway through the centre of excellence funding scheme project number 223254 amos all implementations can be found at https github com simensov ml4ca appendix reward function coefficients the final coefficients for the reward function used during training of the drl agent in this paper is given in table 5 
20524,the ocean waves in the north atlantic ocean are internationally recognized to represent a wave climate suitable for the design of merchant ships however the accumulated knowledge from the past indicates that the encountered sea states are less severe than the standard wave data recommended by the international association of classification society in this study we propose a statistical model representing storm avoidance by ships and apply it to a newly computed 25 year wave hindcast todaiww3 nk in the north atlantic ocean we derive the 25 year statistics of waves encountered by merchant ships the statistical model relates the storm intensity and the distance of the ship from the storm center and derives from the 2 years and 11 months of ship position records based on automatic identification system ais and the hindcast wave data the estimated 25 year exceedance probability of significant wave height in the north atlantic ocean agrees well with that of the waves encountered along the shipping route thereby demonstrating the validity of the suggested storm avoidance model the most significant uncertainty of the estimate originates from the choice of a wave model as shown by comparison with the estimation based on other hindcast products era5 and iowaga keywords storm avoidance automatic identification system north atlantic wave climate standard wave data ship structural design 1 introduction the statistics of ocean waves are closely related to local meteorological conditions and are affected by remote storms as the swells propagate across the ocean the resulting sea state is a mixture of locally generated wind waves and remotely generated swells the wind waves growing under the action of wind satisfy a specific relation between the significant wave height and period the 3 2 law toba 1972 however the relation between the wave height and period of a mixed sea varies widely depending on the locally and remotely determined sea states the long term statistics of the ocean waves are therefore represented by the joint probability density of significant wave height and zero crossing wave period to estimate the extreme conditions that a navigating ship may encounter in her lifetime the international association of classification society iacs adopted the north atlantic ocean wave climate as a representative sea state the north atlantic ocean is characterized by a frequent occurrence of extreme wave events on average there are approximately five events per year which exceeds the two to three a year in the gulf of mexico and the northwest pacific wada and waseda 2020 the recommended procedure for estimating the design loads by the iacs is to use a minimum of a 25 year return period corresponding to a probability of exceedance cycle of approximately 10 8 iacs 2020 the standard wave data or the so called wave scatter diagram was established based on the sea states in areas 8 9 15 and 16 of the global wave statistics gws british marine technology 1986 the significant wave heights and wave periods of the gws were corrected by fitting a combined weibull log normal distribution model bitner gregersen et al 1995 although the gws record has been based on visual observations of waves by ships in normal operation since 1949 it has been noted that ships may avoid severe sea conditions vettor and guedes soares 2016a by subsampling the wave records from hindcast wave data along the known ship tracks in the atlantic ocean vettor and guedes soares 2016a showed that the wave scatter diagram from the iacs rec no 34 is largely altered to relax the probability of extreme sea states moreover a global analysis of waves encountered by merchant ships suggests that the active avoidance of rough weather may significantly reduce the mean wave height that a ship encounters in her lifetime and that the effect is especially pronounced in the north atlantic ocean vettor and guedes soares 2016b the question is whether the typical ship routes are determined to avoid severe sea states or each ship is avoiding the storm a recent study by miratsu et al 2019 concluded that by analyzing ais data in the north atlantic from 2015 1 to 2017 8 the wave heights encountered by bulk carriers oil tankers and container ships are smaller than the wave heights of the iacs rec no 34 they have further investigated the dependency of the reduction factor on the ship types ship sizes headings and ship speeds as it is known that the encountered wave climate depends on the operation e g guedes soares 1990 the objective of this study is to model storm avoidance by merchant ships and to derive the 25 year statistics of waves encountered by merchant ships in the north atlantic ocean we focus on the reproducibility of the marginal distribution of the encountered significant wave height h s but as a result we will derive a scatter diagram of waves encountered by merchant ships we will show that the ships are avoiding storms and the avoidance operation can be modeled by a simple masking function dependent on the distance of the ships from the storm center the datasets used in the study namely the ais data and 25 year hindcast simulation data are described in section 2 candidate statistical models of storm avoidance are described and their performances are compared in section 3 the result of applying the established storm avoidance model to the 25 year hindcast is presented in section 4 together with a discussion on the uncertainty of the estimate owing to different wave models finally the conclusion is presented in section 5 2 datasets 2 1 automatic identification system data 2014 1 2015 1 2017 10 the automatic identification system ais data were obtained from january 2015 to october 2017 in the regions 8 9 15 and 16 as defined in the global wave statistics iacs recommendation no 34 standard wave data this is shown in fig 1 additional data were obtained for january 2014 as this month included the largest storm in the last 25 years in the north atlantic the data for 2 years and 11 months contained 2 656 556 datasets of which 1 093 563 were from the bulk carrier 952 621 were from the container ship and 584 788 were from the oil tanker during this period more than 10 of the time the significant wave height h s exceeded 10 m somewhere within the regions 8 9 15 and 16 hereafter gws 8 9 15 and 16 however the likelihood of ships encountering sea states over 10 m h s was at most 8 8 possibly because of the storm avoidance by the ship table 1 moreover the number of ships in gws 8 9 15 and 16 exhibited a seasonal change that is the number reduced in winter fig 2 this is likely because during wintertime the storm track shifts south and the ships tend to navigate in the ocean to the south of gws 15 and 16 to avoid storms from the probability density plot of the ship locations fig 3 the majority of the ships navigate in gws 15 and 16 avoiding the severe sea conditions in regions 8 and 9 as will be shown later the ships may take a northern route when the storm resides in regions 15 and 16 2 2 twenty five year wave hindcast simulation 1994 2018 a 25 year wave hindcast simulation was conducted from 1994 to 2018 based on the third generation spectral wave model noaa national oceanic and atmospheric administration wavewatch iii version 6 07 wavewatch iii development group 2019 with a spatial resolution of 0 20 0 25 lat lon and spectral resolution of 35 frequency bins and 36 directional bins the model was forced by ncep cfsr national centers for environmental prediction climate forecast system reanalysis hourly wind and ncep cfsr daily sea ice concentration was provided to the model as a source of sea ice saha et al 2014 the details of the model setting and its validation are described in a companion paper sasmal et al 2020 and a brief summary is provided in the appendix for the wind energy input and the wave energy dissipation source terms the st4 package of ardhuin et al 2010 was used the model configuration is essentially the same as that of iowaga ifremer integrated ocean waves for geophysical and other applications ifremer rascle and ardhuin 2013 but with a higher resolution the spatial resolution of the iowaga global model is 0 5 0 5 however it turns out that the spatial resolution crucially affects the estimated significant wave height during extreme events thereby changing the high wave height tail of the probability density function the model output was saved at an hourly interval however in this study we analyzed the three hourly output to be consistent with the iowaga output interval the 25 year mean significant wave height h s shows that on average the sea states are more severe in gws 8 and 9 than in gws 15 and 16 fig 4 a this tendency is attributable to the storm tracks that are mostly in gws 8 and 9 fig 4c however the largest storm events occurred in gws 15 and 16 as depicted in the maximum h s during the 25 years fig 4b we can speculate that on average the ships are circumventing the storms by selecting a southern route however occasional passages of large storms in the south force the ships to actively escape from the storms in the next section by implementing different storm avoidance schemes we elucidate which avoidance scheme better represents the actual operation by ships in a companion paper sasmal et al 2020 carefully investigated the events that affect the tail of the exceedance probability of the significant wave height and identified that the impact of a single storm in january 2014 was dominant in january 2014 the wave height exceeded 20 m because of this single event in 2014 the tail of the exceedance probability was largely enhanced sasmal et al 2020 the number of storms and their intensity varies from year to year as such h s is considered nonstationary as depicted in the time series of annual mean variance skewness and kurtosis of gws 8 9 15 and 16 fig 5 apparently the interannual variation is large therefore the annual average is not considered a stationary random process e g bendat and piersol 1966 however the mean absolute percentage error of the moving average is reduced to approximately 1 at around 15 years therefore 25 year averaging is considered sufficiently long to assure stationarity a scatter diagram is constructed under the assumption of ergodicity and thus the ensemble average is replaced by a spatiotemporal mean over 25 years 3 statistical models of storm avoidance by ships guidelines of the classification society e g recommended practice det norske veritas dnv rp c205 environmental conditions and environmental loads recommend using the ocean wave statistics of the north atlantic for the design of marine structures the joint probability density of the significant wave height h s and zero crossing period t z is called a scatter diagram in rec 34 standard wave data of iacs the scatter diagram is derived based on the wave statistics in regions 8 9 15 and 16 defined in the gws british marine technology 1986 fig 1 however miratsu et al 2019 have shown that the actual sea states encountered by navigating vessels are less severe because of active storm avoidance we first define the significant wave height h s as a function of position and time h s x t under the ergodic hypothesis the statistical moments can be replaced by space and time averages and therefore the distribution of significant wave height p h s can be estimated from the sample h s x t here we make no distinction between space and time a scatter diagram of the iacs rec no 34 was constructed by estimating the joint distribution of h s and t z by applying a weak ergodic hypothesis to both samples h s x t and t z x t because the underlying assumption of ergodicity is stationarity a sufficiently large number of position x and time t samples should be chosen in this study we consider gws 8 9 15 and 16 and 25 years as the sample domain then the statistics of waves encountered by the ships can be considered as an estimate based on a subsample x s h i p x and t s h i p t the available ais dataset used in this study is limited to a duration of 2 years 11 months which is substantially shorter than the 25 years therefore the subsample during the ais period is considered nonstationary this study aims to extrapolate the estimated wave statistics based on the 2 years 11 months ais data to 25 years to do this we consider the ship location x s h i p as a random variable then the marginal distribution of significant wave height can be expressed as p s h i p h s p h s x s h i p if h s and x s h i p are independent then p h s x s h i p p h s p x s h i p and therefore p s h i p h s p h s however the underlying assumption of storm avoidance by the ship is that h s and x s h i p are dependent and therefore p s h i p h s p h s x s h i p p x s h i p the steps necessary to model storm avoidance by the ship are to first determine p x s h i p and then to consider p h s x s h i p utilizing the identity 1 p h s x s h i p p x s h i p p x s h i p h s p h s that is equivalent to determining p x s h i p h s in the following we outline the cases tested in this study using the 2 years 11 months statistics as a benchmark scheme 1 independence of ship route and sea state pseudo wave field ensemble here we assume that p h s x s h i p p h s p x s h i p first the ensemble of ship locations is fixed and is based only on the 2 years 11 months ais data then the wave fields are perturbed two approaches are adopted first we artificially shift the year from 1994 to 2018 instead of the ais periods of 2014 1 and 2015 1 to 2017 10 for example the wavefield on 2015 1 1 will be replaced by wavefield of 1994 1 1 to 2018 1 1 by doing so the number of samples is equivalent to 25 years schemes 1 1 next the hour is artificially shifted by plus and minus 24 h at a 6 h interval scheme 1 and 2 the difference between the two approaches should reveal the relevant time scale for the stationarity of the wave field scheme 2 independence of ship route and sea state monte carlo simulation of ship locations here p s h i p h s p h s x s h i p is obtained by randomly selecting the ship locations x s h i p based on the probability density function of the ship locations p x s h i p fig 3 at each time step of the model output ship locations are randomly selected from p x s h i p to construct a sample set of h s scheme 3 dependence of ship route on sea state selection of northern and southern routes here we consider that the ship locations are affected by the sea state while the storm tracks are mostly in gws 8 and 9 fig 4c the ship routes are in gws 15 and 16 fig 3 storm avoidance can be modeled by defining p x s h i p h s such that when the storm center is in the north the southern ship route p s o u t h x s h i p is selected and when the storm center is in the south the northern route p n o r t h x s h i p is selected the storm is defined as a low pressure system whose highest wave height h s m a x exceeds predefined thresholds such as 10 m and 13 m when h s m a x is less than the threshold value the ship routes in the entire domain are used p t o t a l x s h i p p t o t a l x s h i p for the h s m a x 10 m case is plotted in fig 6 a the southern route excludes the routes north of around 48 fig 6 b two types of northern routes were used the first excluding the routes in the southeast but retaining the direct route from the united states to the uk schemes 3 1 fig 6 c and the second intentionally excluding a large part of the southern area schemes 3 2 fig 6 d that was affected by the two storms in 2003 and 2014 fig 7 sasmal et al 2020 showed that these two storms affected the tail of the exceedance probability of h s the tail was substantially suppressed for the ais based distribution by using the p n o r t h x s h i p of scheme 3 2 the ships effectively avoid the two large storms in 2003 and 2014 scheme 4 dependence of ship route on sea state time dependent active avoidance of the storm finally a scheme to model active avoidance of a storm is implemented here p x s h i p h s is modified at each time by applying a masking function in which the value is nil at the storm center and increases to 1 at a predefined distance from the center 2 p m o d t o t a l x s h i p t p t o t a l x s h i p w x s h i p x s t o r m h s s t o r m t the storm is defined by imposing a threshold value to the maximum significant wave height h s m a x such that p t o t a l x s h i p is used when the sea state is not that severe the ais ship locations fig 3 were analyzed together with the todaiww3 nk estimated h s field at each instance the distances of the ships from the storm center were collected and the cumulated distribution was estimated the distance was normalized by h s m a x otherwise the distribution tended to be irregular from the center the distribution tends to increase to a certain point and then gradually reduces to zero with distance fig 8 when storms were identified as h s m a x 13 m the number of ships peaked at around 80 90 fig 8a whereas when the storm was identified as h s m a x 10 m it peaked at around 90 100 fig 8b both corresponding roughly to around 1000 km from the center thereafter the number of ships decreases partially because the distance is close to the scale of the clusters of ship routes as shown in fig 3 based on this distribution of the ships we model the weighting function as follows 3 w x s h i p x s t o r m h s s t o r m t a x s h i p x s t o r m h s s t o r m 2 if x s h i p x s t o r m h s s t o r m d l i m 1 if x s h i p x s t o r m h s s t o r m d l i m where x s t o r m is the storm center defined where the maximum wave height h s s t o r m is attained note that this definition of the storm center is not the same as the normally used minimum sea level pressure point the coefficient a is empirically determined by fitting a quadratic curve to the distribution of ship locations the weighting function is normalized such that p m o d t o t a l x s h i p t d x 1 both p t o t a l x s h i p and w x s h i p x s t o r m h s s t o r m t are derived for the bulk carrier container ship and oil tanker however in this study for simplicity the fitting was made for the distribution of all ships the d l i m values where the weighting function reaches 1 were set to 70 80 and 90 in this study we show the results with d l i m 90 h s m a x thresholds of 4 m 6 m 7 m 10 m and 13 m were used for the analysis the analysis procedure is summarized in fig 9 first for a given time t the storm is detected from the h s field here we show an example of the 2014 january storm which was the largest in the last 25 years fig 9 a with h s s t o r m at x s t o r m w x s h i p x s t o r m h s s t o r m t is determined fig 9 b following equation 2 p t o t a l x s h i p is modified as p m o d t o t a l x s h i p t fig 9 d at each model output p m o d t o t a l x s h i p t is determined and n number of ship locations are randomly chosen from it the procedure is repeated at each output time step of the 25 year model output 4 results and discussions 4 1 exceedance probabilities of significant wave height in 2014 1 and 2015 1 to 2017 10 the suggested schemes of storm avoidance by ships were applied for the ais data period of 2014 1 and from 2015 1 to 2017 10 the exceedance probabilities were validated against the ais based estimate in fig 10 the exceedance probability based on the gws 8 9 15 and 16 25 year todaiww3 nk h s field is shown in red the highest value reaches 21 m largely extending the iacs rec 34 standard wave data the validity of this estimate is shown in sasmal et al 2020 revealing that the estimate agrees well with the satellite altimeter derived estimate the probability significantly decreases when the sea states only at the ais based ship locations are considered fig 10a green the ais based statistics will serve as a benchmark to test the validity of the implemented schemes first the dependence of shipping route x s h i p and sea state h s was tested by perturbing the wavefield while retaining the ais ship positions scheme 1 because the meteorological events of the same date are independent of year a pseudo ensemble of wave fields is created by shifting the years the statistics obtained from the perturbed ensemble are equivalent to imposing the independence condition p h s x s h i p p h s p x s h i p schemes 1 1 estimate fig 10a blue largely deviates from the ais based estimate fig 10a green and is close to the 25 year estimate of the gws 8 9 15 and 16 fig 10a red however when the wave field was perturbed within the 24 h to 24 h window the resulting distribution was almost identical to the ais based estimate fig 10a black this is likely because the 24 h window is shorter than 3 days when the meteorological predictability starts to deteriorate next the locations of the ships were randomly selected from the ship location pdf p t o t a l x s h i p fig 3 the 1300 locations were randomly selected at each time step for 25 years and the collected set of h s was analyzed scheme 2 the estimated exceedance probability of h s fig 10b green resembles the 25 year gws 8 9 15 and 16 estimate the discrepancy from the ais based probability implies that the ships are indeed avoiding the storms based on the finding of schemes 1 and 2 that the ships are avoiding the storms the ship avoidance schemes were applied scheme 3 the storm was identified as h s max 10 m and when the storm center was in the north the southern ship route p s o u t h x s h i p was selected and when the storm center was in the south the northern ship route p n o r t h x s h i p was selected for the rest the total ship route p t o t a l x s h i p was used despite the choices of northern and southern ship routes schemes 3 1 the resulting exceedance probability 1 p s h i p h s 1 0 h s p s h i p h s d h s mostly followed the 25 year gws 8 9 15 and 16 probability fig 11 a by carefully examining particular events that might have affected the results we identified two large southern storms in 2003 and 2014 fig 7 these extraordinary storms occur in the south where most of the ship traffic exists therefore the fact that the ais based statistics largely reduced the exceedance probability implies that the ship has avoided these two storms the northern route was largely modified to exclude ships passing by these two storms schemes 3 2 fig 6 d by this artificial exclusion of ship encounters with the southern storms the exceedance probability largely decreased and approached the ais based probability fig 11 b this experiment suggests that the ship is indeed avoiding these large storms but likely not small storms thereby requiring implementation of a time dependent ship avoidance scheme finally a time dependent ship avoidance scheme is implemented scheme 4 the scheme masks p t o t a l x s h i p by a weighting function that reduces the number of ships as they get closer to the storm center where the wave height is the highest p m o d t o t a l x s h i p t p t o t a l x s h i p w x s h i p x s t o r m h s s t o r m t the resulting 1 p s h i p h s fig 12 black in the period of 2014 1 and 2015 1 to 2017 10 is much closer to the ais based estimate fig 12 gray than schemes 1 and 2 unlike the case of scheme 3 the p m o d t o t a l x s h i p t values determined for each instance are realistic the scheme was applied with d l i m 90 which means that w x s h i p x s t o r m h s s t o r m t becomes 1 at the distance h s s t o r m 90 from the storm center the scheme is somewhat sensitive to the choice of d l i m but it does not crucially affect the result the number of ship locations randomly selected in this example was set to 1300 for each instance with good agreement between the ais based statistics the implemented storm avoidance scheme scheme 4 is applied to the 25 year hindcast data hereafter scheme 4 will be named the h s based storm avoidance model hssam 4 2 scatter diagram of waves encountered by merchant ships by h s based storm avoidance model hssam the 25 year wave statistics are estimated from the todaiww3 nk model output incorporating the h s based storm avoidance model hssam every 3 h the h s field is diagnosed and the storm center is detected the storm is defined as h s s t o r m h s t h r e s h o l d different values of h s t h r e s h o l d were used 4 m 7 m 10 m and 13 m based on the modified p m o d t o t a l x s h i p t 1300 locations were randomly selected and the h s and t z values were sampled the procedure is repeated for 25 years amounting to a collection of approximately 12 million samples of h s and t z from which the joint probability density and the marginal distributions are estimated the resulting exceedance probabilities of h s applying the hssam are plotted in fig 13 green together with the 25 year gws 8 9 15 16 red and the 2 years 11 months ais based gray exceedance probabilities surprisingly the hssam based and ais based exceedance probabilities agree quite well green and gray especially for the smaller h s t h r e s h o l d values of 4 m and 7 m this suggests that the ships are avoiding not only the extreme events with h s m a x 10 m but also smaller storm events with h s m a x as low as 4 m the ship locations from the hssam analysis were used to sample t z a scatter diagram jpd joint probability density of h s and t z was constructed and the case with h s t h r e s h o l d 7 m is presented in fig 14 compared with the scatter diagram from the gws 8 9 15 and 16 25 year samples fig 14 a the higher wave heights and longer periods are not present in the hssam based scatter diagram fig 14 b waves under strong mid latitude cyclones are asymmetrically distributed along the circumference of the minimum sea level pressure point because of the fronts and its fast translation speed e g kita et al 2018 typically the waves are higher on the right hand side of the cyclone and swells are left behind the cyclone the current implementation of hssam neglects such point asymmetry of the wavefield and masks the probability of ship position by an omni directional weighting function as a result swells with low wave heights but with a long wave periods are also removed from the scatter diagram 4 3 uncertainties of scatter diagram of waves encountered by merchant ships hssam has several parameters that users can objectively select h s t h r e s h o l d which relates to the severity of the storm that the ship would avoid d l i m which defines the radius of influence of the storm and the number of ship locations n the result is somewhat sensitive to the choices of these parameters and in this study we have shown examples of h s t h r e s h o l d 7 m d l i m 90 and n 1300 however the largest uncertainty originates from the choice of the wave model used the characteristics of the wave models table 2 as explained in the companion papers sasmal et al 2020 are depicted in the estimated exceedance probabilities fig 15 the reproduced wave data from the 25 year gws 8 9 15 and 16 samples fig 15 a show that era5 ifs documentation cy46r1 2019 hersbach et al 2020 largely underestimates the distribution whereas iowaga and todaiww3 nk are similar but todaiww3 nk estimates slightly larger values because of the higher resolution 0 5 vs 0 2 relative to the distribution based on gws iacs rec 34 the iowaga and todaiww3 nk distributions are larger possibly because the gws records based on observations from the vos misses some of the extreme events the largest wave reaches approximately 21 m for todaiww3 nk approximately 20 m for iowaga and approximately 19 m for era5 the same tendency appears for the 2 years 11 months ais based exceedance probability fig 15 b the largest waves are approximately 13 m 14 m and 16 m for era5 iowaga and todaiww3 nk respectively finally the hssam rectified wave data from the 25 year gws 8 9 15 and 16 samples were compared fig 15 c the tendencies of era5 underestimating the most and todaiww3 nk showing the largest estimate remain the same the largest waves are 18 m for era5 and iowaga and 20 m for todaiww3 nk the comparison reveals that the model difference can be associated with a particular storm event and in this case we can conjecture that the largest storm event in january 2014 affected the estimate because of the similarity between the ais based estimate and the hssam based estimate that iowaga did not contain an event as large as todaiww3 nk for the hssam rectified analysis suggests that the reproducibility of the extremely large event depends strongly on the spatial resolution in other words not only the in situ or satellite measurements but also the model may miss the largest event depending on the spatial resolution 5 conclusions we implemented a statistical model of storm avoidance operations by merchant ships to estimate the wave statistics encountered by merchant ships in the north atlantic ocean h s and t z were randomly sampled from the 25 year wave hindcast simulation results along the ship routes within the gws 8 9 15 and 16 areas to construct the 25 year statistics of waves encountered by merchant ships in their lifetimes the probability of the ship locations is based on the ais ship location data for 2 years 11 months and is modified at each step circumventing the circular area centered at the storm center the validity of considering the ship location as a random variable was confirmed by comparing the exceedance probability of h s based on the actual locations of the ships during 2014 1 and 2015 1 2017 10 and that estimated by the h s based storm avoidance model hssam during the same period confirming an acceptable agreement the hssam was applied to the 25 year hindcast data the storm avoidance model can be further improved in this study the weighting function w x s h i p x s t o r m h s s t o r m t was empirically determined and is related only to the normalized distance from the storm center thus the scheme neglects local environmental conditions however the ship may change its route depending on the locally determined wave height wave period relative wave direction wind speed and so forth the route selected by a particular ship is a result of local operation therefore the location of the ship in time is not independent the underlying assumption of hssam is time independence of the ship locations to consider this locality a correlation in time of the ship locations needs to be introduced an alternative is to use a ship routing simulation however a monte carlo simulation will consume a considerable amount of time finally in this study the ship types were not distinguished and the statistics were based on all ship types in order to simplify the discussion on the newly introduced hssam the 25 year statistics of waves encountered by merchant ships for bulk carriers container ships and oil tankers were estimated and will be presented elsewhere credit authorship contribution statement kaushik sasmal software formal analysis investigation visualization writing original draft rei miratsu validation investigation writing review editing tsubasa kodaira validation investigation writing review editing tsutomu fukui validation investigation writing review editing tingyao zhu validation investigation writing review editing takuji waseda conceptualization methodology investigation writing original draft declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement y kita set up the atlantic wave model that was the basis of the developed todaiww3 nk and this work is highly appreciated t w thanks internship students vladan vukovic and hugo chan for their contributions at the early stage of research in looking into the ais and wave model data the study presented in this paper was carried out within a joint research project between the university of tokyo and nippon kaiji kyokai classnk and was funded by classnk we would like to thank editage www editage com for english language editing some of the figures in this paper were created using the matlab package m map of pawlowicz 2020 appendix model settings todaiww3 nk is an atlantic ocean wave model based on noaa wavewatch iii version 6 07 the spatial resolution of the model is 0 20 0 25 lat lon with a spectral resolution of 35 frequency bins from 0 04118 hz to 1 1 hz and 36 directional bins bathymetry was derived from etopo1 and small water bodies were set to land the model was forced by ncep cfsr hourly wind and therefore the st4 package optimized for cfsr wind was used ardhuin et al 2010 the 25 year model computations were carried out in the oakforest pacs supercomputer of the university of tokyo from 1994 to 2018 twenty five year long runs were conducted in parallel each with a one month spin up the maximum cfl time step in the model was set to 360 s the significant wave height h s 4 0 m 0 and zero up crossing wave period t 02 m 0 m 2 were derived for gws areas 8 9 15 and 16 the integrated ocean waves for geophysical and other applications iowaga wave fields are available at 3 h intervals ftp ftp ifremer fr ifremer ww3 hindcast from 1990 to 2019 july based on noaa wavewatch iii the spatial resolution of the model is 0 5 0 5 lat lon with a spectral resolution of 31 frequency bins from 0 037 hz to 0 7 hz and 24 directional bins the model was forced by the ncep cfsr wind from 1994 to 2016 and by the ecmwf european center for medium range weather forecasts wind from 2017 to 2018 different values of the β m a x parameter of the st4 package ardhuin et al 2010 were used to optimize the performance for both the ncep cfsr and ecmwf winds era5 is the newest global reanalysis of ecmwf produced by the ecmwf ocean wave model ecwam the spatial resolution of the model is 0 5 0 5 lat lon with a spectral resolution of 30 frequency bins from 0 03453 hz to 0 55 hz and 24 directional bins the native resolution of ecwam is 0 36 the wave fields were available from 1979 at hourly intervals wave height data from satellite altimeters are assimilated into ecwam the ecwam model has updates to the white capping swell dissipation and wind wave growth terms based on bidlot 2012 
20524,the ocean waves in the north atlantic ocean are internationally recognized to represent a wave climate suitable for the design of merchant ships however the accumulated knowledge from the past indicates that the encountered sea states are less severe than the standard wave data recommended by the international association of classification society in this study we propose a statistical model representing storm avoidance by ships and apply it to a newly computed 25 year wave hindcast todaiww3 nk in the north atlantic ocean we derive the 25 year statistics of waves encountered by merchant ships the statistical model relates the storm intensity and the distance of the ship from the storm center and derives from the 2 years and 11 months of ship position records based on automatic identification system ais and the hindcast wave data the estimated 25 year exceedance probability of significant wave height in the north atlantic ocean agrees well with that of the waves encountered along the shipping route thereby demonstrating the validity of the suggested storm avoidance model the most significant uncertainty of the estimate originates from the choice of a wave model as shown by comparison with the estimation based on other hindcast products era5 and iowaga keywords storm avoidance automatic identification system north atlantic wave climate standard wave data ship structural design 1 introduction the statistics of ocean waves are closely related to local meteorological conditions and are affected by remote storms as the swells propagate across the ocean the resulting sea state is a mixture of locally generated wind waves and remotely generated swells the wind waves growing under the action of wind satisfy a specific relation between the significant wave height and period the 3 2 law toba 1972 however the relation between the wave height and period of a mixed sea varies widely depending on the locally and remotely determined sea states the long term statistics of the ocean waves are therefore represented by the joint probability density of significant wave height and zero crossing wave period to estimate the extreme conditions that a navigating ship may encounter in her lifetime the international association of classification society iacs adopted the north atlantic ocean wave climate as a representative sea state the north atlantic ocean is characterized by a frequent occurrence of extreme wave events on average there are approximately five events per year which exceeds the two to three a year in the gulf of mexico and the northwest pacific wada and waseda 2020 the recommended procedure for estimating the design loads by the iacs is to use a minimum of a 25 year return period corresponding to a probability of exceedance cycle of approximately 10 8 iacs 2020 the standard wave data or the so called wave scatter diagram was established based on the sea states in areas 8 9 15 and 16 of the global wave statistics gws british marine technology 1986 the significant wave heights and wave periods of the gws were corrected by fitting a combined weibull log normal distribution model bitner gregersen et al 1995 although the gws record has been based on visual observations of waves by ships in normal operation since 1949 it has been noted that ships may avoid severe sea conditions vettor and guedes soares 2016a by subsampling the wave records from hindcast wave data along the known ship tracks in the atlantic ocean vettor and guedes soares 2016a showed that the wave scatter diagram from the iacs rec no 34 is largely altered to relax the probability of extreme sea states moreover a global analysis of waves encountered by merchant ships suggests that the active avoidance of rough weather may significantly reduce the mean wave height that a ship encounters in her lifetime and that the effect is especially pronounced in the north atlantic ocean vettor and guedes soares 2016b the question is whether the typical ship routes are determined to avoid severe sea states or each ship is avoiding the storm a recent study by miratsu et al 2019 concluded that by analyzing ais data in the north atlantic from 2015 1 to 2017 8 the wave heights encountered by bulk carriers oil tankers and container ships are smaller than the wave heights of the iacs rec no 34 they have further investigated the dependency of the reduction factor on the ship types ship sizes headings and ship speeds as it is known that the encountered wave climate depends on the operation e g guedes soares 1990 the objective of this study is to model storm avoidance by merchant ships and to derive the 25 year statistics of waves encountered by merchant ships in the north atlantic ocean we focus on the reproducibility of the marginal distribution of the encountered significant wave height h s but as a result we will derive a scatter diagram of waves encountered by merchant ships we will show that the ships are avoiding storms and the avoidance operation can be modeled by a simple masking function dependent on the distance of the ships from the storm center the datasets used in the study namely the ais data and 25 year hindcast simulation data are described in section 2 candidate statistical models of storm avoidance are described and their performances are compared in section 3 the result of applying the established storm avoidance model to the 25 year hindcast is presented in section 4 together with a discussion on the uncertainty of the estimate owing to different wave models finally the conclusion is presented in section 5 2 datasets 2 1 automatic identification system data 2014 1 2015 1 2017 10 the automatic identification system ais data were obtained from january 2015 to october 2017 in the regions 8 9 15 and 16 as defined in the global wave statistics iacs recommendation no 34 standard wave data this is shown in fig 1 additional data were obtained for january 2014 as this month included the largest storm in the last 25 years in the north atlantic the data for 2 years and 11 months contained 2 656 556 datasets of which 1 093 563 were from the bulk carrier 952 621 were from the container ship and 584 788 were from the oil tanker during this period more than 10 of the time the significant wave height h s exceeded 10 m somewhere within the regions 8 9 15 and 16 hereafter gws 8 9 15 and 16 however the likelihood of ships encountering sea states over 10 m h s was at most 8 8 possibly because of the storm avoidance by the ship table 1 moreover the number of ships in gws 8 9 15 and 16 exhibited a seasonal change that is the number reduced in winter fig 2 this is likely because during wintertime the storm track shifts south and the ships tend to navigate in the ocean to the south of gws 15 and 16 to avoid storms from the probability density plot of the ship locations fig 3 the majority of the ships navigate in gws 15 and 16 avoiding the severe sea conditions in regions 8 and 9 as will be shown later the ships may take a northern route when the storm resides in regions 15 and 16 2 2 twenty five year wave hindcast simulation 1994 2018 a 25 year wave hindcast simulation was conducted from 1994 to 2018 based on the third generation spectral wave model noaa national oceanic and atmospheric administration wavewatch iii version 6 07 wavewatch iii development group 2019 with a spatial resolution of 0 20 0 25 lat lon and spectral resolution of 35 frequency bins and 36 directional bins the model was forced by ncep cfsr national centers for environmental prediction climate forecast system reanalysis hourly wind and ncep cfsr daily sea ice concentration was provided to the model as a source of sea ice saha et al 2014 the details of the model setting and its validation are described in a companion paper sasmal et al 2020 and a brief summary is provided in the appendix for the wind energy input and the wave energy dissipation source terms the st4 package of ardhuin et al 2010 was used the model configuration is essentially the same as that of iowaga ifremer integrated ocean waves for geophysical and other applications ifremer rascle and ardhuin 2013 but with a higher resolution the spatial resolution of the iowaga global model is 0 5 0 5 however it turns out that the spatial resolution crucially affects the estimated significant wave height during extreme events thereby changing the high wave height tail of the probability density function the model output was saved at an hourly interval however in this study we analyzed the three hourly output to be consistent with the iowaga output interval the 25 year mean significant wave height h s shows that on average the sea states are more severe in gws 8 and 9 than in gws 15 and 16 fig 4 a this tendency is attributable to the storm tracks that are mostly in gws 8 and 9 fig 4c however the largest storm events occurred in gws 15 and 16 as depicted in the maximum h s during the 25 years fig 4b we can speculate that on average the ships are circumventing the storms by selecting a southern route however occasional passages of large storms in the south force the ships to actively escape from the storms in the next section by implementing different storm avoidance schemes we elucidate which avoidance scheme better represents the actual operation by ships in a companion paper sasmal et al 2020 carefully investigated the events that affect the tail of the exceedance probability of the significant wave height and identified that the impact of a single storm in january 2014 was dominant in january 2014 the wave height exceeded 20 m because of this single event in 2014 the tail of the exceedance probability was largely enhanced sasmal et al 2020 the number of storms and their intensity varies from year to year as such h s is considered nonstationary as depicted in the time series of annual mean variance skewness and kurtosis of gws 8 9 15 and 16 fig 5 apparently the interannual variation is large therefore the annual average is not considered a stationary random process e g bendat and piersol 1966 however the mean absolute percentage error of the moving average is reduced to approximately 1 at around 15 years therefore 25 year averaging is considered sufficiently long to assure stationarity a scatter diagram is constructed under the assumption of ergodicity and thus the ensemble average is replaced by a spatiotemporal mean over 25 years 3 statistical models of storm avoidance by ships guidelines of the classification society e g recommended practice det norske veritas dnv rp c205 environmental conditions and environmental loads recommend using the ocean wave statistics of the north atlantic for the design of marine structures the joint probability density of the significant wave height h s and zero crossing period t z is called a scatter diagram in rec 34 standard wave data of iacs the scatter diagram is derived based on the wave statistics in regions 8 9 15 and 16 defined in the gws british marine technology 1986 fig 1 however miratsu et al 2019 have shown that the actual sea states encountered by navigating vessels are less severe because of active storm avoidance we first define the significant wave height h s as a function of position and time h s x t under the ergodic hypothesis the statistical moments can be replaced by space and time averages and therefore the distribution of significant wave height p h s can be estimated from the sample h s x t here we make no distinction between space and time a scatter diagram of the iacs rec no 34 was constructed by estimating the joint distribution of h s and t z by applying a weak ergodic hypothesis to both samples h s x t and t z x t because the underlying assumption of ergodicity is stationarity a sufficiently large number of position x and time t samples should be chosen in this study we consider gws 8 9 15 and 16 and 25 years as the sample domain then the statistics of waves encountered by the ships can be considered as an estimate based on a subsample x s h i p x and t s h i p t the available ais dataset used in this study is limited to a duration of 2 years 11 months which is substantially shorter than the 25 years therefore the subsample during the ais period is considered nonstationary this study aims to extrapolate the estimated wave statistics based on the 2 years 11 months ais data to 25 years to do this we consider the ship location x s h i p as a random variable then the marginal distribution of significant wave height can be expressed as p s h i p h s p h s x s h i p if h s and x s h i p are independent then p h s x s h i p p h s p x s h i p and therefore p s h i p h s p h s however the underlying assumption of storm avoidance by the ship is that h s and x s h i p are dependent and therefore p s h i p h s p h s x s h i p p x s h i p the steps necessary to model storm avoidance by the ship are to first determine p x s h i p and then to consider p h s x s h i p utilizing the identity 1 p h s x s h i p p x s h i p p x s h i p h s p h s that is equivalent to determining p x s h i p h s in the following we outline the cases tested in this study using the 2 years 11 months statistics as a benchmark scheme 1 independence of ship route and sea state pseudo wave field ensemble here we assume that p h s x s h i p p h s p x s h i p first the ensemble of ship locations is fixed and is based only on the 2 years 11 months ais data then the wave fields are perturbed two approaches are adopted first we artificially shift the year from 1994 to 2018 instead of the ais periods of 2014 1 and 2015 1 to 2017 10 for example the wavefield on 2015 1 1 will be replaced by wavefield of 1994 1 1 to 2018 1 1 by doing so the number of samples is equivalent to 25 years schemes 1 1 next the hour is artificially shifted by plus and minus 24 h at a 6 h interval scheme 1 and 2 the difference between the two approaches should reveal the relevant time scale for the stationarity of the wave field scheme 2 independence of ship route and sea state monte carlo simulation of ship locations here p s h i p h s p h s x s h i p is obtained by randomly selecting the ship locations x s h i p based on the probability density function of the ship locations p x s h i p fig 3 at each time step of the model output ship locations are randomly selected from p x s h i p to construct a sample set of h s scheme 3 dependence of ship route on sea state selection of northern and southern routes here we consider that the ship locations are affected by the sea state while the storm tracks are mostly in gws 8 and 9 fig 4c the ship routes are in gws 15 and 16 fig 3 storm avoidance can be modeled by defining p x s h i p h s such that when the storm center is in the north the southern ship route p s o u t h x s h i p is selected and when the storm center is in the south the northern route p n o r t h x s h i p is selected the storm is defined as a low pressure system whose highest wave height h s m a x exceeds predefined thresholds such as 10 m and 13 m when h s m a x is less than the threshold value the ship routes in the entire domain are used p t o t a l x s h i p p t o t a l x s h i p for the h s m a x 10 m case is plotted in fig 6 a the southern route excludes the routes north of around 48 fig 6 b two types of northern routes were used the first excluding the routes in the southeast but retaining the direct route from the united states to the uk schemes 3 1 fig 6 c and the second intentionally excluding a large part of the southern area schemes 3 2 fig 6 d that was affected by the two storms in 2003 and 2014 fig 7 sasmal et al 2020 showed that these two storms affected the tail of the exceedance probability of h s the tail was substantially suppressed for the ais based distribution by using the p n o r t h x s h i p of scheme 3 2 the ships effectively avoid the two large storms in 2003 and 2014 scheme 4 dependence of ship route on sea state time dependent active avoidance of the storm finally a scheme to model active avoidance of a storm is implemented here p x s h i p h s is modified at each time by applying a masking function in which the value is nil at the storm center and increases to 1 at a predefined distance from the center 2 p m o d t o t a l x s h i p t p t o t a l x s h i p w x s h i p x s t o r m h s s t o r m t the storm is defined by imposing a threshold value to the maximum significant wave height h s m a x such that p t o t a l x s h i p is used when the sea state is not that severe the ais ship locations fig 3 were analyzed together with the todaiww3 nk estimated h s field at each instance the distances of the ships from the storm center were collected and the cumulated distribution was estimated the distance was normalized by h s m a x otherwise the distribution tended to be irregular from the center the distribution tends to increase to a certain point and then gradually reduces to zero with distance fig 8 when storms were identified as h s m a x 13 m the number of ships peaked at around 80 90 fig 8a whereas when the storm was identified as h s m a x 10 m it peaked at around 90 100 fig 8b both corresponding roughly to around 1000 km from the center thereafter the number of ships decreases partially because the distance is close to the scale of the clusters of ship routes as shown in fig 3 based on this distribution of the ships we model the weighting function as follows 3 w x s h i p x s t o r m h s s t o r m t a x s h i p x s t o r m h s s t o r m 2 if x s h i p x s t o r m h s s t o r m d l i m 1 if x s h i p x s t o r m h s s t o r m d l i m where x s t o r m is the storm center defined where the maximum wave height h s s t o r m is attained note that this definition of the storm center is not the same as the normally used minimum sea level pressure point the coefficient a is empirically determined by fitting a quadratic curve to the distribution of ship locations the weighting function is normalized such that p m o d t o t a l x s h i p t d x 1 both p t o t a l x s h i p and w x s h i p x s t o r m h s s t o r m t are derived for the bulk carrier container ship and oil tanker however in this study for simplicity the fitting was made for the distribution of all ships the d l i m values where the weighting function reaches 1 were set to 70 80 and 90 in this study we show the results with d l i m 90 h s m a x thresholds of 4 m 6 m 7 m 10 m and 13 m were used for the analysis the analysis procedure is summarized in fig 9 first for a given time t the storm is detected from the h s field here we show an example of the 2014 january storm which was the largest in the last 25 years fig 9 a with h s s t o r m at x s t o r m w x s h i p x s t o r m h s s t o r m t is determined fig 9 b following equation 2 p t o t a l x s h i p is modified as p m o d t o t a l x s h i p t fig 9 d at each model output p m o d t o t a l x s h i p t is determined and n number of ship locations are randomly chosen from it the procedure is repeated at each output time step of the 25 year model output 4 results and discussions 4 1 exceedance probabilities of significant wave height in 2014 1 and 2015 1 to 2017 10 the suggested schemes of storm avoidance by ships were applied for the ais data period of 2014 1 and from 2015 1 to 2017 10 the exceedance probabilities were validated against the ais based estimate in fig 10 the exceedance probability based on the gws 8 9 15 and 16 25 year todaiww3 nk h s field is shown in red the highest value reaches 21 m largely extending the iacs rec 34 standard wave data the validity of this estimate is shown in sasmal et al 2020 revealing that the estimate agrees well with the satellite altimeter derived estimate the probability significantly decreases when the sea states only at the ais based ship locations are considered fig 10a green the ais based statistics will serve as a benchmark to test the validity of the implemented schemes first the dependence of shipping route x s h i p and sea state h s was tested by perturbing the wavefield while retaining the ais ship positions scheme 1 because the meteorological events of the same date are independent of year a pseudo ensemble of wave fields is created by shifting the years the statistics obtained from the perturbed ensemble are equivalent to imposing the independence condition p h s x s h i p p h s p x s h i p schemes 1 1 estimate fig 10a blue largely deviates from the ais based estimate fig 10a green and is close to the 25 year estimate of the gws 8 9 15 and 16 fig 10a red however when the wave field was perturbed within the 24 h to 24 h window the resulting distribution was almost identical to the ais based estimate fig 10a black this is likely because the 24 h window is shorter than 3 days when the meteorological predictability starts to deteriorate next the locations of the ships were randomly selected from the ship location pdf p t o t a l x s h i p fig 3 the 1300 locations were randomly selected at each time step for 25 years and the collected set of h s was analyzed scheme 2 the estimated exceedance probability of h s fig 10b green resembles the 25 year gws 8 9 15 and 16 estimate the discrepancy from the ais based probability implies that the ships are indeed avoiding the storms based on the finding of schemes 1 and 2 that the ships are avoiding the storms the ship avoidance schemes were applied scheme 3 the storm was identified as h s max 10 m and when the storm center was in the north the southern ship route p s o u t h x s h i p was selected and when the storm center was in the south the northern ship route p n o r t h x s h i p was selected for the rest the total ship route p t o t a l x s h i p was used despite the choices of northern and southern ship routes schemes 3 1 the resulting exceedance probability 1 p s h i p h s 1 0 h s p s h i p h s d h s mostly followed the 25 year gws 8 9 15 and 16 probability fig 11 a by carefully examining particular events that might have affected the results we identified two large southern storms in 2003 and 2014 fig 7 these extraordinary storms occur in the south where most of the ship traffic exists therefore the fact that the ais based statistics largely reduced the exceedance probability implies that the ship has avoided these two storms the northern route was largely modified to exclude ships passing by these two storms schemes 3 2 fig 6 d by this artificial exclusion of ship encounters with the southern storms the exceedance probability largely decreased and approached the ais based probability fig 11 b this experiment suggests that the ship is indeed avoiding these large storms but likely not small storms thereby requiring implementation of a time dependent ship avoidance scheme finally a time dependent ship avoidance scheme is implemented scheme 4 the scheme masks p t o t a l x s h i p by a weighting function that reduces the number of ships as they get closer to the storm center where the wave height is the highest p m o d t o t a l x s h i p t p t o t a l x s h i p w x s h i p x s t o r m h s s t o r m t the resulting 1 p s h i p h s fig 12 black in the period of 2014 1 and 2015 1 to 2017 10 is much closer to the ais based estimate fig 12 gray than schemes 1 and 2 unlike the case of scheme 3 the p m o d t o t a l x s h i p t values determined for each instance are realistic the scheme was applied with d l i m 90 which means that w x s h i p x s t o r m h s s t o r m t becomes 1 at the distance h s s t o r m 90 from the storm center the scheme is somewhat sensitive to the choice of d l i m but it does not crucially affect the result the number of ship locations randomly selected in this example was set to 1300 for each instance with good agreement between the ais based statistics the implemented storm avoidance scheme scheme 4 is applied to the 25 year hindcast data hereafter scheme 4 will be named the h s based storm avoidance model hssam 4 2 scatter diagram of waves encountered by merchant ships by h s based storm avoidance model hssam the 25 year wave statistics are estimated from the todaiww3 nk model output incorporating the h s based storm avoidance model hssam every 3 h the h s field is diagnosed and the storm center is detected the storm is defined as h s s t o r m h s t h r e s h o l d different values of h s t h r e s h o l d were used 4 m 7 m 10 m and 13 m based on the modified p m o d t o t a l x s h i p t 1300 locations were randomly selected and the h s and t z values were sampled the procedure is repeated for 25 years amounting to a collection of approximately 12 million samples of h s and t z from which the joint probability density and the marginal distributions are estimated the resulting exceedance probabilities of h s applying the hssam are plotted in fig 13 green together with the 25 year gws 8 9 15 16 red and the 2 years 11 months ais based gray exceedance probabilities surprisingly the hssam based and ais based exceedance probabilities agree quite well green and gray especially for the smaller h s t h r e s h o l d values of 4 m and 7 m this suggests that the ships are avoiding not only the extreme events with h s m a x 10 m but also smaller storm events with h s m a x as low as 4 m the ship locations from the hssam analysis were used to sample t z a scatter diagram jpd joint probability density of h s and t z was constructed and the case with h s t h r e s h o l d 7 m is presented in fig 14 compared with the scatter diagram from the gws 8 9 15 and 16 25 year samples fig 14 a the higher wave heights and longer periods are not present in the hssam based scatter diagram fig 14 b waves under strong mid latitude cyclones are asymmetrically distributed along the circumference of the minimum sea level pressure point because of the fronts and its fast translation speed e g kita et al 2018 typically the waves are higher on the right hand side of the cyclone and swells are left behind the cyclone the current implementation of hssam neglects such point asymmetry of the wavefield and masks the probability of ship position by an omni directional weighting function as a result swells with low wave heights but with a long wave periods are also removed from the scatter diagram 4 3 uncertainties of scatter diagram of waves encountered by merchant ships hssam has several parameters that users can objectively select h s t h r e s h o l d which relates to the severity of the storm that the ship would avoid d l i m which defines the radius of influence of the storm and the number of ship locations n the result is somewhat sensitive to the choices of these parameters and in this study we have shown examples of h s t h r e s h o l d 7 m d l i m 90 and n 1300 however the largest uncertainty originates from the choice of the wave model used the characteristics of the wave models table 2 as explained in the companion papers sasmal et al 2020 are depicted in the estimated exceedance probabilities fig 15 the reproduced wave data from the 25 year gws 8 9 15 and 16 samples fig 15 a show that era5 ifs documentation cy46r1 2019 hersbach et al 2020 largely underestimates the distribution whereas iowaga and todaiww3 nk are similar but todaiww3 nk estimates slightly larger values because of the higher resolution 0 5 vs 0 2 relative to the distribution based on gws iacs rec 34 the iowaga and todaiww3 nk distributions are larger possibly because the gws records based on observations from the vos misses some of the extreme events the largest wave reaches approximately 21 m for todaiww3 nk approximately 20 m for iowaga and approximately 19 m for era5 the same tendency appears for the 2 years 11 months ais based exceedance probability fig 15 b the largest waves are approximately 13 m 14 m and 16 m for era5 iowaga and todaiww3 nk respectively finally the hssam rectified wave data from the 25 year gws 8 9 15 and 16 samples were compared fig 15 c the tendencies of era5 underestimating the most and todaiww3 nk showing the largest estimate remain the same the largest waves are 18 m for era5 and iowaga and 20 m for todaiww3 nk the comparison reveals that the model difference can be associated with a particular storm event and in this case we can conjecture that the largest storm event in january 2014 affected the estimate because of the similarity between the ais based estimate and the hssam based estimate that iowaga did not contain an event as large as todaiww3 nk for the hssam rectified analysis suggests that the reproducibility of the extremely large event depends strongly on the spatial resolution in other words not only the in situ or satellite measurements but also the model may miss the largest event depending on the spatial resolution 5 conclusions we implemented a statistical model of storm avoidance operations by merchant ships to estimate the wave statistics encountered by merchant ships in the north atlantic ocean h s and t z were randomly sampled from the 25 year wave hindcast simulation results along the ship routes within the gws 8 9 15 and 16 areas to construct the 25 year statistics of waves encountered by merchant ships in their lifetimes the probability of the ship locations is based on the ais ship location data for 2 years 11 months and is modified at each step circumventing the circular area centered at the storm center the validity of considering the ship location as a random variable was confirmed by comparing the exceedance probability of h s based on the actual locations of the ships during 2014 1 and 2015 1 2017 10 and that estimated by the h s based storm avoidance model hssam during the same period confirming an acceptable agreement the hssam was applied to the 25 year hindcast data the storm avoidance model can be further improved in this study the weighting function w x s h i p x s t o r m h s s t o r m t was empirically determined and is related only to the normalized distance from the storm center thus the scheme neglects local environmental conditions however the ship may change its route depending on the locally determined wave height wave period relative wave direction wind speed and so forth the route selected by a particular ship is a result of local operation therefore the location of the ship in time is not independent the underlying assumption of hssam is time independence of the ship locations to consider this locality a correlation in time of the ship locations needs to be introduced an alternative is to use a ship routing simulation however a monte carlo simulation will consume a considerable amount of time finally in this study the ship types were not distinguished and the statistics were based on all ship types in order to simplify the discussion on the newly introduced hssam the 25 year statistics of waves encountered by merchant ships for bulk carriers container ships and oil tankers were estimated and will be presented elsewhere credit authorship contribution statement kaushik sasmal software formal analysis investigation visualization writing original draft rei miratsu validation investigation writing review editing tsubasa kodaira validation investigation writing review editing tsutomu fukui validation investigation writing review editing tingyao zhu validation investigation writing review editing takuji waseda conceptualization methodology investigation writing original draft declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement y kita set up the atlantic wave model that was the basis of the developed todaiww3 nk and this work is highly appreciated t w thanks internship students vladan vukovic and hugo chan for their contributions at the early stage of research in looking into the ais and wave model data the study presented in this paper was carried out within a joint research project between the university of tokyo and nippon kaiji kyokai classnk and was funded by classnk we would like to thank editage www editage com for english language editing some of the figures in this paper were created using the matlab package m map of pawlowicz 2020 appendix model settings todaiww3 nk is an atlantic ocean wave model based on noaa wavewatch iii version 6 07 the spatial resolution of the model is 0 20 0 25 lat lon with a spectral resolution of 35 frequency bins from 0 04118 hz to 1 1 hz and 36 directional bins bathymetry was derived from etopo1 and small water bodies were set to land the model was forced by ncep cfsr hourly wind and therefore the st4 package optimized for cfsr wind was used ardhuin et al 2010 the 25 year model computations were carried out in the oakforest pacs supercomputer of the university of tokyo from 1994 to 2018 twenty five year long runs were conducted in parallel each with a one month spin up the maximum cfl time step in the model was set to 360 s the significant wave height h s 4 0 m 0 and zero up crossing wave period t 02 m 0 m 2 were derived for gws areas 8 9 15 and 16 the integrated ocean waves for geophysical and other applications iowaga wave fields are available at 3 h intervals ftp ftp ifremer fr ifremer ww3 hindcast from 1990 to 2019 july based on noaa wavewatch iii the spatial resolution of the model is 0 5 0 5 lat lon with a spectral resolution of 31 frequency bins from 0 037 hz to 0 7 hz and 24 directional bins the model was forced by the ncep cfsr wind from 1994 to 2016 and by the ecmwf european center for medium range weather forecasts wind from 2017 to 2018 different values of the β m a x parameter of the st4 package ardhuin et al 2010 were used to optimize the performance for both the ncep cfsr and ecmwf winds era5 is the newest global reanalysis of ecmwf produced by the ecmwf ocean wave model ecwam the spatial resolution of the model is 0 5 0 5 lat lon with a spectral resolution of 30 frequency bins from 0 03453 hz to 0 55 hz and 24 directional bins the native resolution of ecwam is 0 36 the wave fields were available from 1979 at hourly intervals wave height data from satellite altimeters are assimilated into ecwam the ecwam model has updates to the white capping swell dissipation and wind wave growth terms based on bidlot 2012 
