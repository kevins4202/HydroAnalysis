index,text
20635,to solve the problems of external disturbance internal model uncertainty and rudder angle energy input to much in ship course keeping an active disturbance rejection control algorithm based on nonlinear feedback is proposed firstly the adrc algorithm is designed to control the ship course and the external disturbance and internal uncertainty are estimated by the linear state observer and then the controller is compensated in the process of navigation large rudder angle and high rudder frequency will increase ship roll and rudder wear nonlinear feedback is used to modify the error to reduce the excessive input of rudder angle energy zero order holder is introduced to reduce rudder frequency and rudder wear finally the simulation results show that the controller has well tracking effect the nonlinear feedback with zoh has smaller rudder angle and frequency in severe sea state high rudder frequency and high rudder amplitude will cause the wear of ship steering gear excessive heeling and reduced stability so the algorithm proposed in this paper is more secure and energy saving keywords ship motion control course keeping control active disturbance rejection control nonlinear feedback zero order holder 1 introduction ship course keeping is the most basic research problem in ship motion control the emergence of various control algorithms can be verified by the application effect of course keeping control han jingqing proposed an active disturbance rejection control algorithm based on pid which greatly promoted the development of control theory han 2009 the core idea of active disturbance rejection control is to treat the controlled object as a simple integral series treat the part of the plant dynamic which is different from the standard type as total disturbance and estimate and eliminate the total disturbance in real time by means of extended state observer the method is simple easy to operate and intuitive which has attracted the attention of many scholars at home and abroad in reference gao 2003 the nonlinear adrc is simplified to linear active disturbance rejection control ladrc and parameterized which overcomes the difficulty of parameter adjustment of nonlinear adrc in reference li 2013 a sliding mode active disturbance rejection control algorithm is proposed by combining active disturbance rejection with sliding mode control the error feedback part of the active disturbance rejection control law is designed by using the sliding mode iterative method and the effectiveness of the designed controller is verified by simulation in reference zou et al 2020 the virtual course angle was designed by backstepping and the ship s path following was transformed into course angle control assuming that the ship s lateral drift was a disturbance twice lesos were introduced to estimate the ship s lateral drift and the total uncertainty respectively finally the adrc algorithm was used to control the ship s course in reference guo et al 2020 an active disturbance rejection controller based on multi mode fast nonsingular terminal sliding mode fntsm is designed a state observer which can switch between linear and nonlinear is designed the nonsingular terminal sliding mode designed according to the multi mode idea and a new double power reaching law are introduced into the state error feedback link and the adrc control law based on multimodal fntsm is designed in the process of sailing the ship will inevitably be affected by the external ocean disturbance and the uncertainty caused by model changes in reference huang et al 2021 the uncertainty of the model is approximated by the fusion of neural network and fractional power function and the finite time convergence is obtained in reference hu et al 2019 2020 the problem of disturbance estimation and elimination with ocean disturbance and model uncertainty is studied in reference li et al 2020 radial basis function neural network is used to compensate unknown factors such as parameter uncertainty and environmental disturbance the idea of nonlinear feedback is to enhance the control when the system output error becomes larger and weaken the control when the system error becomes smaller which will eventually reduce the output error however the enhancement or weakening of the control effect is not a linear function of the output error at least the control function has the maximum and minimum saturation limit so as to achieve the actual and energy saving effect liu et al 2016 reference zhou and zhang 2018 modified the traditional pid controller with nonlinear sinusoidal function and reference ma and zhang 2017 designed an exponential function nonlinear feedback controller based on closed loop gain shaping algorithm in reference zongxuan et al 2021 the controller is compensated by neural network observation disturbance in order to obtain better observation effect nonlinear function is used to modify the neural network to improve the approximation effect of neural network in reference zhao et al 2020 the output of the linear controller designed by the second order closed loop gain shaping algorithm is modified by gaussian function to reduce the input of control energy in this paper the active disturbance rejection control algorithm is used to design the control law to control the ship course the linear state observer is used to estimate the external disturbance and the system internal uncertainty so as to solve the problem of external disturbance and system internal uncertainty the nonlinear feedback is introduced to modify the error to reduce the excessive input of rudder angle finally the simulation results verify the effectiveness of the proposed algorithm 2 ship motion model 2 1 design model and simulink model in the late 1950s nomoto regarded the ship as a dynamic system from the point of view of control engineering the rudder angle was the input of the system and the course angle or yaw velocity was the output of the system the response model of the input output response relationship was established on the simplified physical model zhou and zhang 2018 1 ψ k t α ψ β ψ 3 k t δ according to nomoto model considering the characteristic equation of steering gear the nonlinear response mathematical model of ship course keeping control can be expressed as follows zongxuan et al 2021 2 ψ r r a r t k k t δ β r 3 t f δ k e δ r δ t e f f 1 d in eqn 2 α and ꞵ are the proportional coefficients of yaw rate ψ k and t are the ship maneuverability index k e is the steering gear control gain generally taken as 1 t e is the steering gear time constant generally about 2 5s δ is the actual rudder angle and δ r is the command rudder angle f 1 is the internal uncertainty of the ship system d is the external disturbance and f is the total disturbance the response characteristics of the steering gear and the other items except the control inputs are regarded as internal uncertainties of the system and the external interference is considered the design model can simplify as follows 3 ψ r r k t δ f 2 2 control objectives and assumptions the control objective of this paper is to design a ship course controller to make the ship track the reference course in the design process the necessary assumptions are as follows 1 the uncertainty f is bounded that is f f max 2 the input rudder angle δ and the output course angle ψ can be obtained 3 the ship s reference course ψ d is not polluted by noise 3 design of adrc for ship course active disturbance rejection control adrc is composed of three important parts tracking differentiator td extended state observer eso and error feedback since the reference input is not polluted by noise the tracking differentiator is not used in this paper han 2009 3 1 extended state observer the extended state observer is the core of adrc structure its basic idea is to estimate and compensate the uncertain dynamic in real time and compensate in feedback control the uncertain dynamic that can be estimated can be time varying and time invariant linear and nonlinear internal and external dynamic consider the general integral series type li 2013 4 x 1 x 2 x 2 x 3 x n x n 1 b u x n 1 h y x 1 in eqn 4 x n 1 f is the expanded state x t x 1 t x 2 t x n 1 t t rn 1 u r and y r are the state variables control inputs and measurement outputs of the system respectively then the general form of the extended state observer is 5 x ˆ 1 x ˆ 2 l 1 g 1 e ˆ 1 x ˆ 2 x ˆ 3 l 2 g 2 e ˆ 1 x ˆ n x ˆ n 1 l n g n e ˆ 1 b u x ˆ n 1 l n 1 g n 1 e ˆ 1 in eqn 5 e ˆ 1 x ˆ 1 x 1 x ˆ x ˆ 1 x ˆ 2 x ˆ n 1 the output x ˆ i of the observer tracks the state variable x i of the system i 1 2 n 1 x ˆ n 1 f ˆ f ˆ is an estimate of f l l 1 l 2 l n 1 l i 0 i 1 2 n 1 is the observer parameter g i e ˆ 1 is a properly constructed nonlinear function satisfying the following properties if g i e ˆ 1 is taken directly as e ˆ 1 then eqn 5 becomes the following form of linear extended state observer leso 6 x ˆ 1 x ˆ 2 l 1 x ˆ 1 x 1 x ˆ 2 x ˆ 3 l 2 x ˆ 1 x 1 x ˆ n x ˆ n 1 l n x ˆ 1 x 1 b u x ˆ n 1 l n 1 x ˆ 1 x 1 in reference gao 2003 a simple method for determining the parameters of linear extended observer is proposed by using the concept of bandwidth 7 l n 1 w 0 a 1 w 0 2 a 2 w 0 n 1 a n 1 in eqn 7 w 0 0 in addition ai i 1 2 n 1 take the characteristic polynomial s n 1 a 1 s n a n s a n 1 s 1 n 1 where a i n 1 i n 1 i i 1 2 n 1 then the characteristic polynomial is 8 λ 0 s s n 1 w 0 a 1 s n w 0 n a n s w 0 n 1 a n 1 s w 0 n 1 thus the observer bandwidth w n becomes the only observer parameter to be adjusted in this paper referring to leso algorithm this paper simplifies the ship motion model and designs the second order course leso of the system 9 ψ ˆ r ˆ l 1 ψ ˆ ψ r ˆ k t δ f ˆ l 2 ψ ˆ ψ f ˆ l 3 ψ ˆ ψ in eqn 9 ψ ˆ and r ˆ are the estimated values of course angle ψ and yaw rate r respectively and l 1 l 2 and l 3 are observer parameters the input of leso is rudder angle δ and actual course angle ψ and the output is f and fed back to the controller in this paper the course control is a standard second order system which satisfies the stability conditions of the leso corresponding to the second order system 3 2 nonlinear error feedback in order to improve the control performance of the nonlinear control system the sinusoidal function of the difference between the set value and the output is used as the feedback signal to drive the controller let s verify the validity of the sinusoidal driven error the input and output of the nonlinear feedback be described as 10 y f x μ x a when the input signal of nonlinear feedback is a sinusoidal signal x t a sin ω t 11 y t μ a sin ω t a in eqn 11 a is any positive parameter harmonic analysis is carried out for the steady output y t of the nonlinear feedback normally y t is a non sinusoidal periodic signal expand y t into the fourier series and taking the first harmonic component 12 y t a 0 a 1 cos ω t b 1 sin ω t a 0 is the direct current component a 1 and b 1 are the first harmonic component in eqn 12 13 a 0 1 2 π 0 2 π y t d ω t a 1 1 π 0 2 π y t cos ω t d ω t b 1 1 π 0 2 π y t sin ω t d ω t under the impact of sinusoidal input signal y t μ a sin ω t a the complex ratio of the first order harmonic component which from the steady state output signal in nonlinear feedback and the input signal is the describing function of nonlinear feedback which is expressed as n a 14 n a n a e j ð n a b 1 j a 1 a the first harmonic components of a 1 and b 1 are calculated as follows 15 a 1 1 π 0 2 π μ a sin ω t a cos ω t d ω t μ a a π sin ω t a 1 a 1 0 2 π 0 16 b 1 1 π 0 2 π y t sin ω t d ω t μ a a π 0 2 π sin ω t a 1 d ω t the sin ω t can be expanded by taylor series and retain it to the 9 t h order 17 sin ω t ω t ω t 3 3 ω t 5 5 ω t 7 7 ω t 9 9 set τ μ a a π and substitute eqn 17 into eqn 16 then 18 b 1 τ 0 2 π ω t a 1 1 ω t 2 3 ω t 4 5 ω t 6 7 ω t 8 9 a 1 d ω t set z ω t 2 3 ω t 4 5 ω t 6 7 ω t 8 9 and expand 1 z a 1 by taylor series and retain it to 2 n d order 19 1 z a 1 1 a 1 z a 1 a 2 z 2 substitute eqn 19 into eqn 18 and calculate the result of integral 20 b 1 τ 0 2 π ω t a 1 1 a 1 ω t 2 3 ω t 4 5 ω t 6 7 ω t 8 9 a a 1 2 ω t 2 3 ω t 4 5 ω t 6 7 ω t 8 9 2 d ω t for the sake of generality let a 0 4 be used to prove when a is another parameter the proof method is the same the describing function of nonlinear feedback is 21 n a b 1 j a 1 a 4 3165 μ a 0 4 π a it can be seen that when the error signal is small the nonlinear feedback can be approximately equivalent to a linear signal so it does not affect the stability of the system 3 3 the design of control and zero order holder in this section we design a nonlinear pd controller to control the ship s course the general form of linear pd controller is 22 u 1 k p ψ d ψ k d ψ d ψ k p ψ e k d ψ e in eqn 22 k p and k d are parameters of linear pd ψ e ψ d ψ refers to the course error considering the modification of error by nonlinear function we can get the nonlinear error feedback control law is 23 u 2 a 2 sin w 0 ψ e a 3 cos w 0 ψ e in eqn 23 w 0 is the frequency of sinusoidal signal which is used to compress coordinates and a 2 and a 3 are the amplitude of sinusoidal signals so as to avoid excessive error resulting in excessive feedback combine with eqn 3 then the final course nonlinear control law is 24 δ t k u 2 f ˆ how to reduce rudder frequency is always a research hotspot in rudder drag control if the rudder frequency is too low the performance of rudder drag controller will degrade greatly too high rudder frequency will speed up the wear of the steering gear and shorten the service life of the steering gear in order to reduce rudder frequency and wear of steering gear and prolong the service life of steering gear zero order holder zoh is introduced into the control system zero order hold is used for resampling the sampled signal after it has been maintained for a period of time by installing the zero order holder in the rudder drag controller the continuity between the controller and the steering gear signal can be solved on the one hand and the rudder frequency can be reduced to an acceptable range on the other hand the mathematical description of the zero order holder is yan et al 2020 25 e n t z δ t e n t z in eqn 25 t z is the signal holding time of the zero order holder the above formula shows that the zero order holder is a constant extrapolation holder which keeps the sampling value e nt z of nt z from the previous sampling time until the next sampling time n 1 t z so that the sampling signal can be programmed into ladder signal the pd control is firstly used in the actual industrial production and then studied in the theories so its stability is hardly illustrated by lyapunov theories the stability of pid with zoh has been studied in literature yan et al 2020 hence the stability of pd is no longer illuminated specifically 3 4 overall control structure the adrc of ship course designed in this paper consists of three parts the first part is the nonlinear modification of error to form the nonlinear feedback the second part is the adrc with state observer to control the ship in order to get closer to the real sea state the wind wave disturbance driven by white noise is added the third part is to use zero order holder for rudder angle input signal to reduce the rudder frequency the overall control structure is shown in fig 1 4 simulation research 4 1 ship parameters in order to verify the effectiveness of the designed controller the simulation experiment is carried out with simulink in matlab taking the teaching practice ship yupeng of dalian maritime university as the simulation object the parameters of yupeng are shown in table 1 4 2 wind wave interference when the ship is sailing on the sea the wind and wave interference is the main cause of ship sway and yaw so in the simulation study the influence of wind and wave can not be ignored for the sea wind disturbance it is divided into average wind and pulsation component in which the pulsation is realized by white noise while the average wind is represented by wind pressure difference which is equivalent to rudder angle δ wind according to reference guo 1999 δ wind can be expressed by empirical eqn 26 26 δ wind k 0 v r v 2 sin γ where k 0 is the coefficient of wind pressure difference v r and v are the wind speed and ship speed respectively γ is the wind side angle when the wind force is 6 and the wind side angle is 30 degrees δ wind 3 degrees is obtained the wind disturbance is added to the input end of the steering gear characteristics in the form of equivalent rudder angle for the wave disturbance a simple simulation method is adopted that is a typical second order oscillation link is driven by white noise and the transfer function of wave model under the action of level 6wind and 8wind are in eqn 27 and 28 27 h 1 s 0 4198 s s 2 0 3638 s 0 3675 28 h 2 s 1 3353 s s 2 0 5153 s 0 2655 the sampling time of white noise is 0 5 s and its noise power parameter is set to 0 0001 the white noise driven by sea wave uses the same module as the white noise used for random wind simulation the visualization of wave interference is shown in figs 2 and 3 4 3 simulation results the parameters of the controller are a 0 3 8 a 2 21 w 0 0 4 l 1 1 2 l 2 0 48 l 3 0 064 in theory all line segments can be represented by sinusoidal function so if the sinusoidal function is taken as the reference course the simulation reference course is ψ d 50sin 0 001 π the simulation results based on nonlinear feedback control are shown in figs 4 11 among them figs 4 7 shows the simulation results under normal sea state and figs 8 11 shows the simulation results under severe sea state 1 simulation results under normal sea state under normal sea state both linear feedback controller and nonlinear feedback controller have well control effect and their error is within 0 5 it shows that nonlinear feedback and linear feedback have the same control accuracy when the rudder angle is output the linear feedback controller has large steering range and high steering frequency the maximum rudder amplitude reaches 24 9756 and the average rudder angle reaches 2 4708 however the maximum rudder amplitude is only 16 6504 and the average rudder angle is 2 2320 compared with the linear feedback the maximum rudder amplitude is reduced by 50 06 and the average rudder angle is reduced by 10 7 according to the practice of navigation the increase of rudder amplitude and average rudder angle will cause ship heeling and reduce ship stability it shows that the control algorithm proposed in this paper has more secure characteristics for navigation practice fig 6 shows the comparison of rudder angle between the ship with zero order retainer and without zero order retainer for ships without zero order retainer the rudder is turned every 0 2s and 17 500 rudders are required in 3500s simulation the wear of rudder is very large after adding zero order retainer the rudder is changed from 0 2s to 7s and the course tracking effect does not change but it only needs 500 times in 3500s the rudder can be used which greatly reduces the steering frequency in the actual navigation frequent rudder will cause discomfort to the crew and reduce the stability of the ship resulting in the wear of the steering gear which shows the effectiveness of adding zoh fig 7 shows the total error observed by the state observer under normal sea state and the maximum error is 2 6728 since the state observer has filtering effect on high frequency signal it shows a smooth total error curve because the total unknown interference is external interference and internal model uncertainty so the total interference is unknown which is also in line with the actual situation of navigation 2 simulation results in heavy sea state fig 8 shows the nonlinear feedback and linear feedback also achieve good control effect in bad sea state which shows that the designed controller is also robust to the bad sea state the deviation between the nonlinear feedback and the linear feedback is less than 1 which indicates that the nonlinear feedback has high accuracy for ship course keeping fig 9 showsthe maximum rudder amplitude of the linear feedback is 26 12 and the average rudder angle is 2 57 under severe sea conditions the maximum rudder angle of nonlinear feedback is 16 77 the average rudder angle is 2 426 the maximum rudder amplitude is reduced by 55 75 and the average rudder angle is reduced by 5 936 it shows that the algorithm proposed in this paper also has good control effect on ships in bad sea conditions and the rudder amplitude and average rudder angle can be effectively reduced by adding nonlinear feedback fig 10 shows the rudder angle change of the ship with or without zero order retainer under bad sea state it also can be seen that with zero order retainer the rudder frequency is reduced from 0 2 times s to 7 times s which greatly reduces the steering frequency it can reduce the wear of steering gear and enhance the navigation safety in bad sea state fig 11 shows the total error observed by the state observer under heavy sea state and the maximum error is 4 1604 since the state observer has filtering effect on high frequency signal it shows a smooth total error curve because the total unknown interference is external interference and internal model uncertainty so the total interference is unknown which is also in line with the actual situation of navigation 5 conclusion in order to solve the problems of external disturbance internal model uncertainty and excessive rudder angle energy input in ship course keeping an active disturbance rejection control algorithm based on nonlinear feedback is proposed in this paper the active disturbance rejection control algorithm is designed to control the ship course the external disturbance and internal uncertainty are estimated by the linear state observer and the error is compensated to the controller nonlinear feedback is introduced to modify the error to reduce the problem of excessive input of rudder angle energy the zero order holder is added to reduce the steering frequency reduce the wear of the rudder machine and enhance the safety of the ship in the process of driving finally the simulation results show that the control algorithm can effectively solve the problems of excessive input of rudder angle energy high rudder frequency and uncertain external interference so that the ship can track the given course well credit authorship contribution statement hugan zhang conceptualization methodology software validation formal analysis writing original draft visualization xianku zhang funding acquisition writing review editing renxiang bu supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this study was supported by the natural science foundation of china grant no 61751202 61751205 u1813203 and the key project of liaoning natural science foundation grant no 20170540098 
20635,to solve the problems of external disturbance internal model uncertainty and rudder angle energy input to much in ship course keeping an active disturbance rejection control algorithm based on nonlinear feedback is proposed firstly the adrc algorithm is designed to control the ship course and the external disturbance and internal uncertainty are estimated by the linear state observer and then the controller is compensated in the process of navigation large rudder angle and high rudder frequency will increase ship roll and rudder wear nonlinear feedback is used to modify the error to reduce the excessive input of rudder angle energy zero order holder is introduced to reduce rudder frequency and rudder wear finally the simulation results show that the controller has well tracking effect the nonlinear feedback with zoh has smaller rudder angle and frequency in severe sea state high rudder frequency and high rudder amplitude will cause the wear of ship steering gear excessive heeling and reduced stability so the algorithm proposed in this paper is more secure and energy saving keywords ship motion control course keeping control active disturbance rejection control nonlinear feedback zero order holder 1 introduction ship course keeping is the most basic research problem in ship motion control the emergence of various control algorithms can be verified by the application effect of course keeping control han jingqing proposed an active disturbance rejection control algorithm based on pid which greatly promoted the development of control theory han 2009 the core idea of active disturbance rejection control is to treat the controlled object as a simple integral series treat the part of the plant dynamic which is different from the standard type as total disturbance and estimate and eliminate the total disturbance in real time by means of extended state observer the method is simple easy to operate and intuitive which has attracted the attention of many scholars at home and abroad in reference gao 2003 the nonlinear adrc is simplified to linear active disturbance rejection control ladrc and parameterized which overcomes the difficulty of parameter adjustment of nonlinear adrc in reference li 2013 a sliding mode active disturbance rejection control algorithm is proposed by combining active disturbance rejection with sliding mode control the error feedback part of the active disturbance rejection control law is designed by using the sliding mode iterative method and the effectiveness of the designed controller is verified by simulation in reference zou et al 2020 the virtual course angle was designed by backstepping and the ship s path following was transformed into course angle control assuming that the ship s lateral drift was a disturbance twice lesos were introduced to estimate the ship s lateral drift and the total uncertainty respectively finally the adrc algorithm was used to control the ship s course in reference guo et al 2020 an active disturbance rejection controller based on multi mode fast nonsingular terminal sliding mode fntsm is designed a state observer which can switch between linear and nonlinear is designed the nonsingular terminal sliding mode designed according to the multi mode idea and a new double power reaching law are introduced into the state error feedback link and the adrc control law based on multimodal fntsm is designed in the process of sailing the ship will inevitably be affected by the external ocean disturbance and the uncertainty caused by model changes in reference huang et al 2021 the uncertainty of the model is approximated by the fusion of neural network and fractional power function and the finite time convergence is obtained in reference hu et al 2019 2020 the problem of disturbance estimation and elimination with ocean disturbance and model uncertainty is studied in reference li et al 2020 radial basis function neural network is used to compensate unknown factors such as parameter uncertainty and environmental disturbance the idea of nonlinear feedback is to enhance the control when the system output error becomes larger and weaken the control when the system error becomes smaller which will eventually reduce the output error however the enhancement or weakening of the control effect is not a linear function of the output error at least the control function has the maximum and minimum saturation limit so as to achieve the actual and energy saving effect liu et al 2016 reference zhou and zhang 2018 modified the traditional pid controller with nonlinear sinusoidal function and reference ma and zhang 2017 designed an exponential function nonlinear feedback controller based on closed loop gain shaping algorithm in reference zongxuan et al 2021 the controller is compensated by neural network observation disturbance in order to obtain better observation effect nonlinear function is used to modify the neural network to improve the approximation effect of neural network in reference zhao et al 2020 the output of the linear controller designed by the second order closed loop gain shaping algorithm is modified by gaussian function to reduce the input of control energy in this paper the active disturbance rejection control algorithm is used to design the control law to control the ship course the linear state observer is used to estimate the external disturbance and the system internal uncertainty so as to solve the problem of external disturbance and system internal uncertainty the nonlinear feedback is introduced to modify the error to reduce the excessive input of rudder angle finally the simulation results verify the effectiveness of the proposed algorithm 2 ship motion model 2 1 design model and simulink model in the late 1950s nomoto regarded the ship as a dynamic system from the point of view of control engineering the rudder angle was the input of the system and the course angle or yaw velocity was the output of the system the response model of the input output response relationship was established on the simplified physical model zhou and zhang 2018 1 ψ k t α ψ β ψ 3 k t δ according to nomoto model considering the characteristic equation of steering gear the nonlinear response mathematical model of ship course keeping control can be expressed as follows zongxuan et al 2021 2 ψ r r a r t k k t δ β r 3 t f δ k e δ r δ t e f f 1 d in eqn 2 α and ꞵ are the proportional coefficients of yaw rate ψ k and t are the ship maneuverability index k e is the steering gear control gain generally taken as 1 t e is the steering gear time constant generally about 2 5s δ is the actual rudder angle and δ r is the command rudder angle f 1 is the internal uncertainty of the ship system d is the external disturbance and f is the total disturbance the response characteristics of the steering gear and the other items except the control inputs are regarded as internal uncertainties of the system and the external interference is considered the design model can simplify as follows 3 ψ r r k t δ f 2 2 control objectives and assumptions the control objective of this paper is to design a ship course controller to make the ship track the reference course in the design process the necessary assumptions are as follows 1 the uncertainty f is bounded that is f f max 2 the input rudder angle δ and the output course angle ψ can be obtained 3 the ship s reference course ψ d is not polluted by noise 3 design of adrc for ship course active disturbance rejection control adrc is composed of three important parts tracking differentiator td extended state observer eso and error feedback since the reference input is not polluted by noise the tracking differentiator is not used in this paper han 2009 3 1 extended state observer the extended state observer is the core of adrc structure its basic idea is to estimate and compensate the uncertain dynamic in real time and compensate in feedback control the uncertain dynamic that can be estimated can be time varying and time invariant linear and nonlinear internal and external dynamic consider the general integral series type li 2013 4 x 1 x 2 x 2 x 3 x n x n 1 b u x n 1 h y x 1 in eqn 4 x n 1 f is the expanded state x t x 1 t x 2 t x n 1 t t rn 1 u r and y r are the state variables control inputs and measurement outputs of the system respectively then the general form of the extended state observer is 5 x ˆ 1 x ˆ 2 l 1 g 1 e ˆ 1 x ˆ 2 x ˆ 3 l 2 g 2 e ˆ 1 x ˆ n x ˆ n 1 l n g n e ˆ 1 b u x ˆ n 1 l n 1 g n 1 e ˆ 1 in eqn 5 e ˆ 1 x ˆ 1 x 1 x ˆ x ˆ 1 x ˆ 2 x ˆ n 1 the output x ˆ i of the observer tracks the state variable x i of the system i 1 2 n 1 x ˆ n 1 f ˆ f ˆ is an estimate of f l l 1 l 2 l n 1 l i 0 i 1 2 n 1 is the observer parameter g i e ˆ 1 is a properly constructed nonlinear function satisfying the following properties if g i e ˆ 1 is taken directly as e ˆ 1 then eqn 5 becomes the following form of linear extended state observer leso 6 x ˆ 1 x ˆ 2 l 1 x ˆ 1 x 1 x ˆ 2 x ˆ 3 l 2 x ˆ 1 x 1 x ˆ n x ˆ n 1 l n x ˆ 1 x 1 b u x ˆ n 1 l n 1 x ˆ 1 x 1 in reference gao 2003 a simple method for determining the parameters of linear extended observer is proposed by using the concept of bandwidth 7 l n 1 w 0 a 1 w 0 2 a 2 w 0 n 1 a n 1 in eqn 7 w 0 0 in addition ai i 1 2 n 1 take the characteristic polynomial s n 1 a 1 s n a n s a n 1 s 1 n 1 where a i n 1 i n 1 i i 1 2 n 1 then the characteristic polynomial is 8 λ 0 s s n 1 w 0 a 1 s n w 0 n a n s w 0 n 1 a n 1 s w 0 n 1 thus the observer bandwidth w n becomes the only observer parameter to be adjusted in this paper referring to leso algorithm this paper simplifies the ship motion model and designs the second order course leso of the system 9 ψ ˆ r ˆ l 1 ψ ˆ ψ r ˆ k t δ f ˆ l 2 ψ ˆ ψ f ˆ l 3 ψ ˆ ψ in eqn 9 ψ ˆ and r ˆ are the estimated values of course angle ψ and yaw rate r respectively and l 1 l 2 and l 3 are observer parameters the input of leso is rudder angle δ and actual course angle ψ and the output is f and fed back to the controller in this paper the course control is a standard second order system which satisfies the stability conditions of the leso corresponding to the second order system 3 2 nonlinear error feedback in order to improve the control performance of the nonlinear control system the sinusoidal function of the difference between the set value and the output is used as the feedback signal to drive the controller let s verify the validity of the sinusoidal driven error the input and output of the nonlinear feedback be described as 10 y f x μ x a when the input signal of nonlinear feedback is a sinusoidal signal x t a sin ω t 11 y t μ a sin ω t a in eqn 11 a is any positive parameter harmonic analysis is carried out for the steady output y t of the nonlinear feedback normally y t is a non sinusoidal periodic signal expand y t into the fourier series and taking the first harmonic component 12 y t a 0 a 1 cos ω t b 1 sin ω t a 0 is the direct current component a 1 and b 1 are the first harmonic component in eqn 12 13 a 0 1 2 π 0 2 π y t d ω t a 1 1 π 0 2 π y t cos ω t d ω t b 1 1 π 0 2 π y t sin ω t d ω t under the impact of sinusoidal input signal y t μ a sin ω t a the complex ratio of the first order harmonic component which from the steady state output signal in nonlinear feedback and the input signal is the describing function of nonlinear feedback which is expressed as n a 14 n a n a e j ð n a b 1 j a 1 a the first harmonic components of a 1 and b 1 are calculated as follows 15 a 1 1 π 0 2 π μ a sin ω t a cos ω t d ω t μ a a π sin ω t a 1 a 1 0 2 π 0 16 b 1 1 π 0 2 π y t sin ω t d ω t μ a a π 0 2 π sin ω t a 1 d ω t the sin ω t can be expanded by taylor series and retain it to the 9 t h order 17 sin ω t ω t ω t 3 3 ω t 5 5 ω t 7 7 ω t 9 9 set τ μ a a π and substitute eqn 17 into eqn 16 then 18 b 1 τ 0 2 π ω t a 1 1 ω t 2 3 ω t 4 5 ω t 6 7 ω t 8 9 a 1 d ω t set z ω t 2 3 ω t 4 5 ω t 6 7 ω t 8 9 and expand 1 z a 1 by taylor series and retain it to 2 n d order 19 1 z a 1 1 a 1 z a 1 a 2 z 2 substitute eqn 19 into eqn 18 and calculate the result of integral 20 b 1 τ 0 2 π ω t a 1 1 a 1 ω t 2 3 ω t 4 5 ω t 6 7 ω t 8 9 a a 1 2 ω t 2 3 ω t 4 5 ω t 6 7 ω t 8 9 2 d ω t for the sake of generality let a 0 4 be used to prove when a is another parameter the proof method is the same the describing function of nonlinear feedback is 21 n a b 1 j a 1 a 4 3165 μ a 0 4 π a it can be seen that when the error signal is small the nonlinear feedback can be approximately equivalent to a linear signal so it does not affect the stability of the system 3 3 the design of control and zero order holder in this section we design a nonlinear pd controller to control the ship s course the general form of linear pd controller is 22 u 1 k p ψ d ψ k d ψ d ψ k p ψ e k d ψ e in eqn 22 k p and k d are parameters of linear pd ψ e ψ d ψ refers to the course error considering the modification of error by nonlinear function we can get the nonlinear error feedback control law is 23 u 2 a 2 sin w 0 ψ e a 3 cos w 0 ψ e in eqn 23 w 0 is the frequency of sinusoidal signal which is used to compress coordinates and a 2 and a 3 are the amplitude of sinusoidal signals so as to avoid excessive error resulting in excessive feedback combine with eqn 3 then the final course nonlinear control law is 24 δ t k u 2 f ˆ how to reduce rudder frequency is always a research hotspot in rudder drag control if the rudder frequency is too low the performance of rudder drag controller will degrade greatly too high rudder frequency will speed up the wear of the steering gear and shorten the service life of the steering gear in order to reduce rudder frequency and wear of steering gear and prolong the service life of steering gear zero order holder zoh is introduced into the control system zero order hold is used for resampling the sampled signal after it has been maintained for a period of time by installing the zero order holder in the rudder drag controller the continuity between the controller and the steering gear signal can be solved on the one hand and the rudder frequency can be reduced to an acceptable range on the other hand the mathematical description of the zero order holder is yan et al 2020 25 e n t z δ t e n t z in eqn 25 t z is the signal holding time of the zero order holder the above formula shows that the zero order holder is a constant extrapolation holder which keeps the sampling value e nt z of nt z from the previous sampling time until the next sampling time n 1 t z so that the sampling signal can be programmed into ladder signal the pd control is firstly used in the actual industrial production and then studied in the theories so its stability is hardly illustrated by lyapunov theories the stability of pid with zoh has been studied in literature yan et al 2020 hence the stability of pd is no longer illuminated specifically 3 4 overall control structure the adrc of ship course designed in this paper consists of three parts the first part is the nonlinear modification of error to form the nonlinear feedback the second part is the adrc with state observer to control the ship in order to get closer to the real sea state the wind wave disturbance driven by white noise is added the third part is to use zero order holder for rudder angle input signal to reduce the rudder frequency the overall control structure is shown in fig 1 4 simulation research 4 1 ship parameters in order to verify the effectiveness of the designed controller the simulation experiment is carried out with simulink in matlab taking the teaching practice ship yupeng of dalian maritime university as the simulation object the parameters of yupeng are shown in table 1 4 2 wind wave interference when the ship is sailing on the sea the wind and wave interference is the main cause of ship sway and yaw so in the simulation study the influence of wind and wave can not be ignored for the sea wind disturbance it is divided into average wind and pulsation component in which the pulsation is realized by white noise while the average wind is represented by wind pressure difference which is equivalent to rudder angle δ wind according to reference guo 1999 δ wind can be expressed by empirical eqn 26 26 δ wind k 0 v r v 2 sin γ where k 0 is the coefficient of wind pressure difference v r and v are the wind speed and ship speed respectively γ is the wind side angle when the wind force is 6 and the wind side angle is 30 degrees δ wind 3 degrees is obtained the wind disturbance is added to the input end of the steering gear characteristics in the form of equivalent rudder angle for the wave disturbance a simple simulation method is adopted that is a typical second order oscillation link is driven by white noise and the transfer function of wave model under the action of level 6wind and 8wind are in eqn 27 and 28 27 h 1 s 0 4198 s s 2 0 3638 s 0 3675 28 h 2 s 1 3353 s s 2 0 5153 s 0 2655 the sampling time of white noise is 0 5 s and its noise power parameter is set to 0 0001 the white noise driven by sea wave uses the same module as the white noise used for random wind simulation the visualization of wave interference is shown in figs 2 and 3 4 3 simulation results the parameters of the controller are a 0 3 8 a 2 21 w 0 0 4 l 1 1 2 l 2 0 48 l 3 0 064 in theory all line segments can be represented by sinusoidal function so if the sinusoidal function is taken as the reference course the simulation reference course is ψ d 50sin 0 001 π the simulation results based on nonlinear feedback control are shown in figs 4 11 among them figs 4 7 shows the simulation results under normal sea state and figs 8 11 shows the simulation results under severe sea state 1 simulation results under normal sea state under normal sea state both linear feedback controller and nonlinear feedback controller have well control effect and their error is within 0 5 it shows that nonlinear feedback and linear feedback have the same control accuracy when the rudder angle is output the linear feedback controller has large steering range and high steering frequency the maximum rudder amplitude reaches 24 9756 and the average rudder angle reaches 2 4708 however the maximum rudder amplitude is only 16 6504 and the average rudder angle is 2 2320 compared with the linear feedback the maximum rudder amplitude is reduced by 50 06 and the average rudder angle is reduced by 10 7 according to the practice of navigation the increase of rudder amplitude and average rudder angle will cause ship heeling and reduce ship stability it shows that the control algorithm proposed in this paper has more secure characteristics for navigation practice fig 6 shows the comparison of rudder angle between the ship with zero order retainer and without zero order retainer for ships without zero order retainer the rudder is turned every 0 2s and 17 500 rudders are required in 3500s simulation the wear of rudder is very large after adding zero order retainer the rudder is changed from 0 2s to 7s and the course tracking effect does not change but it only needs 500 times in 3500s the rudder can be used which greatly reduces the steering frequency in the actual navigation frequent rudder will cause discomfort to the crew and reduce the stability of the ship resulting in the wear of the steering gear which shows the effectiveness of adding zoh fig 7 shows the total error observed by the state observer under normal sea state and the maximum error is 2 6728 since the state observer has filtering effect on high frequency signal it shows a smooth total error curve because the total unknown interference is external interference and internal model uncertainty so the total interference is unknown which is also in line with the actual situation of navigation 2 simulation results in heavy sea state fig 8 shows the nonlinear feedback and linear feedback also achieve good control effect in bad sea state which shows that the designed controller is also robust to the bad sea state the deviation between the nonlinear feedback and the linear feedback is less than 1 which indicates that the nonlinear feedback has high accuracy for ship course keeping fig 9 showsthe maximum rudder amplitude of the linear feedback is 26 12 and the average rudder angle is 2 57 under severe sea conditions the maximum rudder angle of nonlinear feedback is 16 77 the average rudder angle is 2 426 the maximum rudder amplitude is reduced by 55 75 and the average rudder angle is reduced by 5 936 it shows that the algorithm proposed in this paper also has good control effect on ships in bad sea conditions and the rudder amplitude and average rudder angle can be effectively reduced by adding nonlinear feedback fig 10 shows the rudder angle change of the ship with or without zero order retainer under bad sea state it also can be seen that with zero order retainer the rudder frequency is reduced from 0 2 times s to 7 times s which greatly reduces the steering frequency it can reduce the wear of steering gear and enhance the navigation safety in bad sea state fig 11 shows the total error observed by the state observer under heavy sea state and the maximum error is 4 1604 since the state observer has filtering effect on high frequency signal it shows a smooth total error curve because the total unknown interference is external interference and internal model uncertainty so the total interference is unknown which is also in line with the actual situation of navigation 5 conclusion in order to solve the problems of external disturbance internal model uncertainty and excessive rudder angle energy input in ship course keeping an active disturbance rejection control algorithm based on nonlinear feedback is proposed in this paper the active disturbance rejection control algorithm is designed to control the ship course the external disturbance and internal uncertainty are estimated by the linear state observer and the error is compensated to the controller nonlinear feedback is introduced to modify the error to reduce the problem of excessive input of rudder angle energy the zero order holder is added to reduce the steering frequency reduce the wear of the rudder machine and enhance the safety of the ship in the process of driving finally the simulation results show that the control algorithm can effectively solve the problems of excessive input of rudder angle energy high rudder frequency and uncertain external interference so that the ship can track the given course well credit authorship contribution statement hugan zhang conceptualization methodology software validation formal analysis writing original draft visualization xianku zhang funding acquisition writing review editing renxiang bu supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this study was supported by the natural science foundation of china grant no 61751202 61751205 u1813203 and the key project of liaoning natural science foundation grant no 20170540098 
20636,the problem of ship motions in waves can be seen as a coupled problem of manoeuvring and seakeeping the former is a low frequency motion problem in terms of time scale of ship motion whereas the latter is relatively a high frequency motion problem they can be separately predicted by solving a group of low frequency ship motion equations and a group of high frequency ship motion equations however the theoretical basis behind both usual groups of motion equations may be questionable in our previous study a time averaged method was introduced to derive the pure low frequency ship motion equations in regular waves the new equations have a few additional terms which are the mean inertial forces and moments due to wave induced high frequency motions compared with the usual equations the low frequency ship motion equations were then solved to predict ship manoeuvring in waves by means of a modelling approach it has been demonstrated that these additional terms are non negligible for manoeuvring prediction if amplitudes of high frequency motions are large enough e g in the condition of long wave length and large wave amplitude in this study we will give out the more complete pure low frequency ship motion equations in regular waves and some new explanations the pure high frequency ship motion equations are also derived by subtracting the pure low frequency ship motion equations from transient ship motion equations on the aspect of manoeuvring prediction there are two improvements as compared with before one is that the mean inertial forces and moments due to second order high frequency motions are retained in the pure low frequency motion equations the other is that the effect of longitudinal ship speed is taken into account in the modelling approach as will be shown the prediction accuracy is improved keywords ship manoeuvring in waves time averaged method pure low frequency ship motion equations pure high frequency ship motion equations 1 introduction the problem of ship motions in waves have attracted much attention in recent years generally speaking this problem can be seen as a coupled problem of manoeuvring and seakeeping they differ in time scale of ship motion the former is a low frequency motion problem whereas the latter is relatively a high frequency motion problem based on newtonian mechanics ship motions in waves can be predicted by solving ship motion equations as long as the forces and moments are known carrica et al 2013 solved six degrees of freedom ship motion equations coupled with the reynolds averaged naiver stokes rans equations by using an overset grid approach to predict ship rudder manoeuvres in waves rans solution supplied forces and moments for ship motion equations while the solution of ship motion equations supplied boundary information for rans note that this approach did not differentiate between manoeuvring and seakeeping since ship motion equations were transient the predicted results contained both low frequency component and high frequency component another approach is to separate the transient motion problem into a low frequency motion problem and a high frequency motion problem based on this idea manoeuvring and seakeeping can be separately predicted by solving a group of low frequency motion equations and a group of high frequency motion equations in a coupled manner i e the so called two time scale method so far the forms of both usual groups of equations actually accord with the form of transient ship motion equations it is just that the physical meaning of variables in the equations has changed the low frequency forces and moments in the group of low frequency motion equations are regarded as a superposition of the calm water forces and moments and the added hydrodynamic forces and moments due to waves the relevant studies were reported by yasukawa 2006a 2006b 2008 skejic and faltinsen 2008 seo and kim 2011 subramanian 2015 zhang and zou 2017 et al in these studies a numerical method based on potential flow theory pft was employed to compute wave loads including the added hydrodynamic forces and moments due to waves for the group of low frequency motion equations and high frequency wave forces and moments for the group of high frequency motion equations note that the aforementioned added hydrodynamic forces and moments due to waves just stem from flow variation around ship i e being of pure hydrodynamics uharek and cura hochbaum 2018a and lengwinat and cura hochbaum 2018 found and confirmed the inertial effects on the added forces and moments due to waves by rans computations and experiments it has been concluded that the added forces and moments should contain the mean inertial forces and moments not just the added hydrodynamic forces and moments as usual note that the inertial effects for the comparison of computational results with experimental data should include the contributions of both low frequency and high frequency ship motions i e the contribution of transient motions uharek and cura hochbaum 2016 predicted ship manoeuvring in waves by solving ship motion equations by means of a modelling approach with model coefficients from rans computations later on in the work by uharek and cura hochbaum 2018b the inertial effects were accounted for when modelling the mean wave forces and moments to predict manoeuvring in waves it should be just necessary to subtract the inertial effects due to high frequency ship motions in the work people are used to add external loads e g wave drift forces and moments wind loads current loads etc on the right hand side of ship motion equations for predicting ship manoeuvring with consideration of external environment influences it may be baseless to do so at least when predicting ship manoeuvring and seakeeping separately in the study by yao et al 2020 a time averaged operation was performed towards the transient ship motion equations under condition of regular waves in order to filter the pure high frequency terms and resulted in the time averaged ship motion equations i e the pure low frequency ship motion equations the time averaged operation was very similar with the average operation towards naiver stokes n s equations the low frequency ship motion equations have a few additional terms which are the mean inertial forces and moments due to wave induced high frequency motions compared with the form of transient ship motion equations the additional mean inertial forces and moments due to high frequency ship motions indicate a similar concept with the inertial effects as found by uharek and cura hochbaum 2018a and lengwinat and cura hochbaum 2018 nevertheless to predict ship manoeuvring in waves one of the basic problems may be the ship motion equations so that it is very necessary to clarify which ship motion equations transient low frequency or high frequency we should solve in applications in this study we will give out the more complete pure low frequency ship motion equations in regular waves and some new explanations the pure high frequency ship motion equations are also derived by subtracting the pure low frequency ship motion equations from transient ship motion equations there are two improvements in manoeuvring prediction as compared with before one is that the mean inertial forces and moments due to second order high frequency motions are retained in the pure low frequency motion equations the other is that the effect of longitudinal ship speed is taken into account in the modelling approach as will be shown the prediction accuracy is improved 2 ship motion equations 2 1 transient ship motion equations in order to describe the motion of ship a completely ship fixed coordinate system o x y z is defined the origin is positioned at the intersection of mid ship sections and undisturbed free surface x axis parallel to the keel positive to bow y axis perpendicular to the symmetry plane positive to starboard and z axis towards the keel the motion equations of the assumed rigid ship can be written as e g abkowitz 1964 1a m u v r w q x g q 2 r 2 y g p q r z g p r q x 1b m v w p u r y g r 2 p 2 z g q r p x g q p r y 1c m w u q v p z g p 2 q 2 x g r p q y g r q p z 1d i x p i z i y q r m y g w p v q u z g v r u p w k 1e i y q i x i z r p m z g u q w r v x g w p v q u m 1f i z r i y i x p q m x g v r u p w y g u q w r v n where m is ship mass u v w are linear velocity components p q r are rotational velocity components x y z k m n are force or moment component x g y g z g are coordinates of center of gravity i x i y i z are inertial moments it should be noted that all products of inertia are assumed to be zero in eq 1 although they are generally not zero for real ships since ships are not completely of fore aft and left right symmetry e g single screw and single rudder ships however this assumption is usually expected to be of small influences on the final results of rudder manoeuver simulations equation 1 is derived by newton s law of motion all variables are transient 2 2 pure low frequency ship motion equations in order to derive the pure low frequency ship motion equations in regular waves we make the following assumptions 1 each transient variable in eq 1 is seen as a linear superposition of high frequency component and low frequency component 2 the time scales of high frequency component and low frequency component are so far away that the high frequency component has oscillated several times at least once during a time interval whereas the low frequency component is assumed to be unchanged 3 the high frequency component during the time interval may be approximated by trigonometric series so that a transient variable during the time interval in the condition of regular waves may be expressed as 2 φ φ l φ h 3 φ h n 1 φ c n cos n ω e t φ s n sin n ω e t where φ is u v w p q r x y z k m or n subscripts l and h denote low frequency component and high frequency component respectively φ c n and φ s n are coefficients of trigonometric series and ω e is current encounter frequency as seen under the assumptions the high frequency component contains the terms with the frequencies n ω e where n runs from 1 to maybe the high frequency component can be understood as a superposition of high order motions or forces moments excited by waves whereas the low frequency component is of zero order the low frequency component is excited by both waves and manoeuvring operations e g rudder deflection substituting each transient variable in above form into eq 1 then averaging the transient motion equations over the time interval term by term we can therefore obtain the time averaged equations i e the pure low frequency equations the average operation is described below in order to filter the high frequency component of a variable the time interval δ t should be an integral multiple of current encounter period t e here we assume δ t is t e thus for a single variable the mean of high frequency component is then equal to zero e g 4 u h t 0 t 0 δ t u h d t δ t t 0 t 0 t e u h d t t e 0 as a result 5 u t 0 t 0 t e u d t t e t 0 t 0 t e u h u l d t t e t 0 t 0 t e u l d t t e u l based on above assumptions as mentioned the mean of a single variable is the low frequency component itself note that if the time scales of high frequency component and low frequency component are close enough or saying the low frequency component change greatly during the time interval eq 5 is wrong for the mean of a product term of two variables e g the term v r it reads 6 v r t 0 t 0 t e v r d t t e t 0 t 0 t e v l r l v l r h v h r l v h r h d t t e obviously v l r h and v h r l are zero and v l r l v r note that v h r h is a sum of four kinds of terms v h r h n 1 m 1 v c n r c m cos n ω e t cos m ω e t v s n r c m sin n ω e t cos m ω e t v c n r s m cos n ω e t sin m ω e t v s n r s m sin n ω e t sin m ω e t let s recall the following relations cos n ω e t cos m ω e t 1 2 cos n m ω e t cos n m ω e t sin n ω e t cos m ω e t 1 2 sin n m ω e t sin n m ω e t cos n ω e t sin m ω e t 1 2 sin n m ω e t sin n m ω e t sin n ω e t sin m ω e t 1 2 cos n m ω e t cos n m ω e t for a random n and m t 0 t 0 t e cos n m ω e t d t t e 0 t 0 t 0 t e sin n m ω e t d t t e 0 t 0 t 0 t e sin n m ω e t d t t e 0 if n m t 0 t 0 t e cos n m ω e t d t t e 1 else if n m t 0 t 0 t e cos n m ω e t d t t e 0 due to above relations averaging v h r h term by term results in 7 v h r h 1 2 n 1 v c n r c n v s n r s n thus eq 6 finally becomes 8 v r v r 1 2 n 1 v c n r c n v s n r s n averaging all terms in eq 1 in the similar way we can obtain the complete pure low frequency ship motion equations 9a m u v r w q x g q 2 r 2 y g p q r z g p r q 1 2 m n 1 v c n r c n v s n r s n n 1 w c n q c n w s n q s n x g n 1 q c n 2 q s n 2 n 1 r c n 2 r s n 2 y g n 1 p c n q c n p s n q s n z g n 1 p c n r c n p s n r s n x 9b m v w p u r y g r 2 p 2 z g q r p x g q p r 1 2 m n 1 w c n p c n w s n p s n n 1 u c n r c n u s n r s n y g n 1 r c n 2 r s n 2 n 1 p c n 2 p s n 2 z g n 1 q c n r c n q s n r s n x g n 1 q c n p c n q s n p s n y 9c m w u q v p z g p 2 q 2 x g r p q y g r q p 1 2 m n 1 u c n q c n u s n q s n n 1 v c n p c n v s n p s n z g n 1 p c n 2 p s n 2 n 1 q c n 2 q s n 2 x g n 1 r c n p c n r s n p s n y g n 1 r c n q c n r s n q s n z 9d i x p i z i y q r m y g w p v q u z g v r u p w 1 2 i z i y n 1 q c n r c n q s n r s n 1 2 m y g n 1 p c n v c n p s n v s n n 1 q c n u c n q s n u s n z g n 1 r c n u c n r s n u s n n 1 p c n w c n p s n w s n k 9e i y q i x i z r p m z g u q w r v x g w p v q u 1 2 i x i z n 1 r c n p c n r s n p s n 1 2 m z g n 1 q c n w c n q s n u w s n n 1 r c n v c n r s n v s n x g n 1 p c n v c n p s n v s n n 1 q c n u c n q s n u s n m 9f i z r i y i x p q m x g v r u p w y g u q w r v 1 2 i y i x n 1 p c n q c n p s n q s n 1 2 m x g n 1 r c n u c n r s n u s n n 1 p c n w c n p s n w s n y g n 1 q c n w c n q s n w s n n 1 r c n v c n r s n v s n n it should be noted that the mean forces and moments on the right hand side are of pure hydrodynamics each mean force or moment can be seen as a linear superposition of the calm water force or moment and the added hydrodynamic force or moment due to waves the latter is the usual wave drift force or moment in concept for example the longitudinal mean force is x x c a l m x x c a l m x c a l m x d where subscripts c a l m and d denote the force or moment in calm water and the added hydrodynamic force or moment due to waves respectively the additional terms in eq 9 compared with the form of eq 1 are the non zero mean forces and moments due to wave induced high frequency motions the above average operation towards transient ship motion equations is quite similar with the average operation towards n s equations the reynolds stress in rans equations is actually the mean stress produced by the product terms of two pulsating quantities of turbulence similarly the resulting additional terms in eq 9 are the mean inertial forces and moments produced by the product terms of two high frequency ship motions 2 3 pure high frequency ship motion equations to obtain the pure high frequency ship motion equations we subtract the pure low frequency ship motion equations from transient ship motion equations for a single variable e g v its high frequency component is v v for a product term e g v r it can be written as 10 v r v v h r r h v r v r h v h r v h r h subtracting the pure low frequency component i e v r v r v h r h from above equation we can obtain its pure high frequency component 11 v r h v r v r v r h v h r v h r h v h r h where v h r h has been formulated previously i e eq 7 subtracting eq 9 from eq 1 term by term the expression of pure high frequency ship motion equations can be written as 12a m u h v r h v h r v h r h v h r h w q h w h q w h q h w h q h x g 2 q q h q h 2 q h 2 2 r r h r h 2 r h 2 y g p q h p h q p h q h p h q h r h z g p r h p h r p h r h p h r h q h x h 12b m v h w p h w h p w h p h w h p h u r h u h r u h r h u h r h y g 2 r r h r h 2 r h 2 2 p p h p h 2 p h 2 z g q r h q h r q h r h q h r h p h x g q p h q h p q h p h q h p h r h y h 12c m w h u q h u h q u h q h u h q h v p h v h p v h p h v h p h z g 2 p p h p h 2 p h 2 2 q q h q h 2 q h 2 x g r p h r h p r h p h r h p h q h y g r q h r h q r h q h r h q h p h z h 12d i x p h i z i y q r h q h r q h r h q h r h m y g w h p v h p h v p h v h p h v h q u h q h u q h u h q h u h z g v h r u h r h u r h u h r h u h p w h p h w p h w h p h w h k h 12e i y q h i x i z r p h r h p r h p h r h p h m z g u h q w h q h w q h w h q h w h r v h r h v r h v h r h v h x g w h p v h p h v p h v h p h v h q u h q h u q h u h q h u h m h 12f i z r h i y i x p q h p h q p h q h p h q h m x g v h r u h r h u r h u h r h u h p w h p h w p h w h p h w h y g u h q w h q h w q h w h q h w h r v h r h v r h v h r h v h n h the product terms of a low frequency motion and a high frequency motion such as v r h v h r and q q h are of purely high frequency since low frequency motions are assumed to be unchanged during the time interval when performing average operation the product terms of two high frequency motions such as v h r h are certainly not of purely high frequency as v h r h is not zero see eq 7 however if subtracting their pure low frequency component such as v h r h v h r h they are we have given out the pure low frequency and pure high frequency ship motion equations in regular waves it should be understood that low frequency variables satisfy the pure low frequency equations approximately just during a current time interval in terms of a large time scale the time interval should be one or several current encounter periods to talk about the variation of low frequency variables in terms of a small time scale may be nonsense the mean inertial forces and moments due to high frequency motions are just relevant to their amplitudes and phases not their transient motions the high frequency variables synchronously satisfy the pure high frequency equations approximately during the same time interval as well the low frequency motion variables in the pure high frequency equations as well as the mean inertial forces and moments due to high frequency motions are also assumed to be unchanged during the time interval but in terms of a small time scale as time shifts into another time interval these variables or terms as assumed to be unchanged during the current time interval will certainly change 3 manoeuvring prediction in waves the three degrees of freedom low frequency ship motion equations including the low frequency terms due to coupled heave pitch and roll have been solved to predict the manoeuvrability of container ship s 175 in regular waves by means of a modelling approach in our previous work modelling was not only for calm water forces and moment as usual but also for the added forces and moments due to waves the latter included the added hydrodynamic forces and moment and the mean inertial forces and moments due to the coupled heave pitch and roll however the modelling was not directly for the mean inertial forces and moments but for the first order heave pitch and roll i e the coefficients of trigonometric series such as w c 1 and q s 1 in eq 9 in present work manoeuvring prediction in waves are also conducted for s 175 by using the modelling approach as before however as mentioned there are two improvements 1 the mean inertial forces and moments due to second order high frequency motions are retained in the pure low frequency motion equations 2 the effect of longitudinal ship speed is taken into account in the modelling approach the three degrees of freedom pure low frequency ship motion equations to be solved are expressed as follows 13a m u v r x g r 2 1 2 m n 1 2 w c n q c n w s n q s n x g n 1 2 q c n 2 q s n 2 x c a l m x d 13b m v u r x g r 1 2 m n 1 2 w c n p c n w s n p s n x g n 1 2 q c n p c n q s n p s n y c a l m y d 13c i z r m x g v r u 1 2 i z i x n 1 2 p c n q c n p s n q s n 1 2 m x g n 1 2 p c n w c n p s n w s n n c a l m n d where i y i z is assumed for convenience the bars over variables in above equations will be dropped in the following content we have carried out free running tests in calm water and in waves for present validation the main particulars of s 175 are listed in table 1 fig 1 shows the ship model being in a turning test in waves 3 1 modelling of hydrodynamic forces and moment in calm water a usual abkowitz type mathematic model is employed to approximate the calm water forces and moment the model is as follows 14a x c a l m x 0 x u δ u x u u δ u 2 x u u u δ u 3 x u u x v v x v v v 2 x v v v v 3 x r r x r r r 2 x r r r r 3 x δ δ x δ δ δ 2 x δ δ δ δ 3 x v r v r x v δ v δ x r δ r δ 14b y c a l m y 0 y v v y v v v 2 y v v v v 3 y v v y r r y r r r 2 y r r r r 3 y r r y v r r v r 2 y v v r v 2 r y δ δ y δ δ δ 2 y δ δ δ δ 3 y u δ δ u δ y v δ δ v δ 2 y v v δ v 2 δ y r δ δ r δ 2 y r r δ r 2 δ 14c n c a l m n 0 n v v n v v v 2 n v v v v 3 n v v n r r n r r r 2 n r r r r 3 n r r n v r r v r 2 n v v r v 2 r n δ δ n δ δ δ 2 n δ δ δ δ 3 n u δ δ u δ n v δ δ v δ 2 n v v δ v 2 δ n r δ δ r δ 2 n r r δ r 2 δ to determine the derivatives an expanded rans solver based on openfoam is used to compute the manoeuvring forces and moment for the ship model performing a series of captive motions in calm water including static straight ahead motion with rudder deflection static drift motion with rudder deflection static circle motion with rudder deflection static circle motion with drift and dynamic pure surge sway and yaw afterwards hydrodynamic derivatives can be acquired by regression as usual the rans methods have been described in details in a previous publication by yao 2015 generally speaking to obtain all required hydrodynamic derivatives from pure rans computations will be very time consuming due to many cases especially considering dynamic ship motions in water surface and real rotating propeller with dynamic grid approach in order to reduce computational time the assumptions of double body flow and body force propeller are introduced during present computations the thrust and torque specified for the body force propeller are estimated by make use of open water curves however the body force distribution is assumed to be always of circumferential symmetry regardless of the effects of manoeuvring motions the grids are generated by using the commercial software hexpress grid dependence analysis is firstly carried out for resistance the grid with around 1 22 million cells is finally selected although we generate the grid for each case of rudder deflection the procedure of grid generation e g cell size around hull and rudder remain almost the same that means the grids with different rudder deflection have a close distribution of grid cell and are expected to be of enough accuracy for reasonable results fig 2 shows the stream lines across propeller disk for a static drift motion with rudder deflection the stream lines near ship bow and body force region swirl as observed the derivatives used are summarized in table 2 here we find five derivatives i e x u x u u x u u u y u δ and n u δ to be of less accuracy since the simple body force propeller is not able to accurately predict thrust and torque empirical ones are borrowed to replace them in use the accuracy of rans computation is not discussed presently due to lack of experimental data even so the derivatives in table 2 are expected to be applicable to approximate the calm water forces and moment for manoeuvre simulations fig 3 present a comparison of the simulated turning trajectory with experimental ones the experimental data by yasukawa 2006b who conducted free running tests for a ship model with 3 5 m is plotted in the figure as well as can be seen the final simulation accuracy is acceptable this means except for the five derivatives others should be accurate enough 3 2 modelling of the added forces and moments due to waves the added forces and moments due to waves here includes the added hydrodynamic forces and moment and the mean inertial forces and moments due to high frequency motions as mentioned for the latter the modelling is for the coefficients of trigonometric series in eq 13 their dimensionless forms may be expressed as follows 15a c w x x d ρ g a 2 l p p 15b c w y y d ρ g a 2 l p p 15c c w n n d ρ g a 2 l p p 2 16a c w c n w c n a ω e 16b c w s n w s n a ω e 16c c q c n q c n a ω e k w 16d c q s n q s n a ω e k w 16e c p c n p c n a ω e k w 16f c p s n p s n a ω e k w with a wave amplitude g acceleration due to gravity ρ water density k w wave number and n equal to 1 and 2 to use encounter frequency ω e in eq 16 may be more reasonable than to use natural circular frequency of waves in addition the calm water forces and moment are made non dimensional by 1 2 ρ u 2 l p p 2 and 1 2 ρ u 2 l p p 3 respectively as usual although the assumption of quadratic dependence of the added hydrodynamic forces and moment on wave amplitude is not applicable for all waves it will not affect the final manoeuvre simulation in the present consideration because the wave amplitude considered in the later manoeuvre simulations will be same with the one used to determine the above dimensionless coefficients since the dimensionless added hydrodynamic forces and moment and high frequency motions expressed by eqs 15 and 16 will change with wave encounter angle χ periodically and the period is 2 π fourier series are used to approximate them as proposed by uharek and cura hochbaum 2015 the wave encounter angle 0 was defined as heading waves 180 as following waves moreover c w x c w c n c w s n c q c n and c q s n are symmetric with respect to the central longitudinal section of ship as encounter angle changes so that the model up to sixth order is as follows for them 17a c w x c w c n c w s n c q c n c q s n a 0 2 m 1 6 a m cos m χ whereas since c w y c w n c p c n and c p s n are antisymmetric with respect to the central longitudinal section of ship as encounter angle changes the following model up to fifth order is used for them 17b c w y c w n c p c n c p s n m 1 5 b m sin m χ definitely a 0 a m and b m will change with ship manoeuvring motions and wave conditions except for χ in present consideration a 0 a m and b m are assumed to depend on wave length λ at a certain ship speed u three ship speeds are considered in the modelling as will be also mentioned later on during the latter manoeuver simulations if λ and χ are known the model is employed to calculate x d y d n d w c n w s n q c n q s n p c n and p s n for the three ship speeds then a parabolic interpolation method is used to determine their values at the current ship speed in our previous work yao et al 2020 the two phase rans solver based on openfoam has been applied to compute the hydrodynamic forces and moment and wave induced motions for a bare s 175 performing straight ahead motion in oblique regular waves the length of ship model was 3 5 m during the rans computations surge sway and yaw were fixed however heave pitch and roll were completely free seven wave encounter angles i e 0 30 60 90 120 150 and 180 and four wave lengths i e 0 5 l p p 0 7 l p p l p p and 1 2 l p p were considered the forces and moment and ship motions for encounter angles 210 240 270 300 and 330 were resulted by make use of symmetric or antisymmetric relations however just one ship speed corresponding to froude number 0 15 was taken into account in our previous work due to high computational cost the fourier coefficients for this speed have been obtained the relevant numerical methods have been described in details in the work in this work another two speeds as supplement are considered for the rans computations providing more data for the modelling the corresponding froude numbers are 0 075 and 0 0375 during the computations the wave conditions such as wave length wave amplitude encounter angle remain the same the dimensionless wave amplitude defined by a a l p p is 0 01 based on the grid dependency analysis in the previous work the grid with around 1 05 million cells is used for present computations fig 4 shows the wave snapshots for λ 1 and χ 30 where λ λ l p p as can be seen the waves downstream along wave direction are more disturbed as speed increases moreover the decay of wave amplitude is observed downstream as well that may be unavoidable after completing all computations the model coefficients can be determined the procedure of data post processing is shown in fig 5 1 regress time histories of heave pitch and roll for all cases by fourier series resulting in coefficients of trigonometric series the time when wave crest locates at amid ship is assumed as zero time 2a average the computed longitudinal force side force and yaw moment in time resulting in mean forces and moment 2 b subtract calm water forces and moment from the mean forces and moment resulting in added hydrodynamic forces and moment due to waves note that here the forces and moment are all of pure hydrodynamics 3 for a certain wave length and ship speed only one wave amplitude is considered at present the added hydrodynamic forces and moment and the coefficients of trigonometric series change with wave encounter angle approximating the change law by fourier series i e eq 17 results in fourier coefficients fig 6 presents the dimensionless added hydrodynamic forces and moment versus wave encounter angle for λ 0 7 circles represent the computed values and lines represent the reconstructed values by the model the computed and reconstructed dimensionless first order and second order heave pitch and roll for λ 1 are shown in fig 7 the model is able to reconstruct the computed results perfectly 3 3 manoeuvring prediction in waves using above mathematic models eq 13 is solved by an iterative approach for the simulation of free running test in waves as usual the fourth order runge kutta scheme is employed to approximate the acceleration terms wave amplitude is chosen as a 0 01 the same with the one to determine model coefficients as mentioned the considered initial ship speed corresponds to froude number 0 15 note that during a rudder manoeuvre simulation in waves the ship initially keeps steady rectilinear motion before deflecting rudder so that except for heading and following waves there must be an initial balance rudder angle to offset wave effects ensuring the equilibrium at beginning here says steady rectilinear motion or equilibrium should be understood as a mean situation in general the initial equilibrium state of ship motion can be determined by solving the equilibrium motion equations i e the simplified equations of eq 13 with the condition that the mean accelerations and yaw rate are zero at present the newton iteration method is used to solve the equilibrium equations for a given initial wave condition the solutions u v and δ represent the initial equilibrium state of ship motion and the rudder angle needed to keep the equilibrium under the given wave condition 3 3 1 simulation of turning test the simulated trajectories of turning tests for λ 0 7 0 initial wave encounter angle and 35 rudder deflection with both port side and starboard side are compared with experimental data in fig 8 the simulated time histories of turning rate pitch and roll are compared in the back of the figure as well note that the simulated pitch and roll are their first order amplitudes of displacement which are calculated by make use of the mathematic model e g the first order amplitude of pitch displacement θ m a x q c 1 2 q s 1 2 ω e thus the advantage of modelling the high frequency motions i e w c 1 q s 1 etc but not directly modelling the inertial forces and moments due to the high frequency motions is that time traces of first order heave pitch and roll amplitudes can be obtained during rudder manoeuver simulations even though the pure high frequency motion equations are not solved the comparison of the results for 90 initial wave encounter angle is shown in fig 9 the results are improved significantly due to the consideration of longitudinal ship speed when modelling as compared with before especially the drift direction of motion trajectory accords quite well with experimental data however the simulations present a little bit larger twisted turning circles than the experimental ones the drift distance of turning circle is smaller than that of experiment the comparisons of simulated results with experimental data for λ 1 are shown in figs 10 and 11 satisfactory agreements are also observed in particular for turning rate pitch and roll however the advances of trajectories are generally underestimated this is most probably due to two reasons 1 neglect of the mean inertial forces and moments due to high frequency surge sway and yaw in the pure low frequency motion equations 2 less accuracy of the computed added forces and moments due to waves larger twisted turning circles and smaller drift distance are found as well compared with experimental data in addition the effects of initial wave encounter angle on motion trajectory are investigated the results for λ 0 7 and λ 1 are shown in fig 12 it is observed that the included angle between the drift direction of trajectory and the direction of wave propagation is always fixed and the ship tends to a same periodic motion over time regardless of the initial wave encounter angle this observation is coincident with that by cura hochbaum and uharek 2016 3 3 2 simulation of zig zag test the simulated results of zig zag test including times histories of heading angle rudder angle and turning rate are compared with experimental data in figs 13 15 for different conditions the results of 20 20 zig zag manoeuvres show generally good agreements with experimental data either for 0 or for 90 initial wave encounter angle however the accuracy becomes worse for 10 10 zig zag the simulations are not able to predict well the rudder steering time the zig zag period for λ 1 is larger than that for λ 0 7 the oscillation amplitudes of experimental data for 90 initial wave encounter angle are larger than that for 0 initial wave encounter angle as compared the experimental curves in fig 14 and in fig 15 4 concluding remarks the present main purpose is to give out the complete expressions of pure low frequency and pure high frequency ship motion equations in regular waves these equations are recommended for the method of predicting manoeuvring and seakeeping separately however it has to note that the motion equations just satisfy approximately the relation between motions and forces moments if the assumptions introduced to derive these equations e g there exists a great difference between the time scales of high frequency and low frequency ship motions are not satisfied the motion equations are of not accuracy or even wrong in this case to predict manoeuvring and seakeeping separately may be questionable in present application the three degrees of freedom pure low frequency ship motion equations are solved by means of a modelling approach to predict manoeuvring in waves there are two improvements as compared with our previous work the mean inertial forces and moments due to second order heave pitch and roll are retained in the low frequency ship motion equations three longitudinal ship speeds are taken into account when modelling not just one speed more accurate results are obtained compared with our previous results however the accuracy of rans computation is not discussed in this work due to lack of appropriate experimental data it is necessary to distinguish the concepts of added forces and moments due to waves wave drift forces and moments low frequency wave inertial forces and moments etc for comparison purpose of numerical results with experimental data the other concern may be the standard coordinate system in which the forces and moments are expressed e g completely ship fixed coordinate system or horizontal ship fixed coordinate system credit authorship contribution statement jianxi yao conceptualization methodology software writing review editing formal analysis visualization writing original draft investigation validation zuyuan liu funding acquisition supervision conceptualization methodology xuemin song software writing original draft investigation yan su methodology software formal analysis investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by national natural science foundation of china grant nos 51609188 51720105011 
20636,the problem of ship motions in waves can be seen as a coupled problem of manoeuvring and seakeeping the former is a low frequency motion problem in terms of time scale of ship motion whereas the latter is relatively a high frequency motion problem they can be separately predicted by solving a group of low frequency ship motion equations and a group of high frequency ship motion equations however the theoretical basis behind both usual groups of motion equations may be questionable in our previous study a time averaged method was introduced to derive the pure low frequency ship motion equations in regular waves the new equations have a few additional terms which are the mean inertial forces and moments due to wave induced high frequency motions compared with the usual equations the low frequency ship motion equations were then solved to predict ship manoeuvring in waves by means of a modelling approach it has been demonstrated that these additional terms are non negligible for manoeuvring prediction if amplitudes of high frequency motions are large enough e g in the condition of long wave length and large wave amplitude in this study we will give out the more complete pure low frequency ship motion equations in regular waves and some new explanations the pure high frequency ship motion equations are also derived by subtracting the pure low frequency ship motion equations from transient ship motion equations on the aspect of manoeuvring prediction there are two improvements as compared with before one is that the mean inertial forces and moments due to second order high frequency motions are retained in the pure low frequency motion equations the other is that the effect of longitudinal ship speed is taken into account in the modelling approach as will be shown the prediction accuracy is improved keywords ship manoeuvring in waves time averaged method pure low frequency ship motion equations pure high frequency ship motion equations 1 introduction the problem of ship motions in waves have attracted much attention in recent years generally speaking this problem can be seen as a coupled problem of manoeuvring and seakeeping they differ in time scale of ship motion the former is a low frequency motion problem whereas the latter is relatively a high frequency motion problem based on newtonian mechanics ship motions in waves can be predicted by solving ship motion equations as long as the forces and moments are known carrica et al 2013 solved six degrees of freedom ship motion equations coupled with the reynolds averaged naiver stokes rans equations by using an overset grid approach to predict ship rudder manoeuvres in waves rans solution supplied forces and moments for ship motion equations while the solution of ship motion equations supplied boundary information for rans note that this approach did not differentiate between manoeuvring and seakeeping since ship motion equations were transient the predicted results contained both low frequency component and high frequency component another approach is to separate the transient motion problem into a low frequency motion problem and a high frequency motion problem based on this idea manoeuvring and seakeeping can be separately predicted by solving a group of low frequency motion equations and a group of high frequency motion equations in a coupled manner i e the so called two time scale method so far the forms of both usual groups of equations actually accord with the form of transient ship motion equations it is just that the physical meaning of variables in the equations has changed the low frequency forces and moments in the group of low frequency motion equations are regarded as a superposition of the calm water forces and moments and the added hydrodynamic forces and moments due to waves the relevant studies were reported by yasukawa 2006a 2006b 2008 skejic and faltinsen 2008 seo and kim 2011 subramanian 2015 zhang and zou 2017 et al in these studies a numerical method based on potential flow theory pft was employed to compute wave loads including the added hydrodynamic forces and moments due to waves for the group of low frequency motion equations and high frequency wave forces and moments for the group of high frequency motion equations note that the aforementioned added hydrodynamic forces and moments due to waves just stem from flow variation around ship i e being of pure hydrodynamics uharek and cura hochbaum 2018a and lengwinat and cura hochbaum 2018 found and confirmed the inertial effects on the added forces and moments due to waves by rans computations and experiments it has been concluded that the added forces and moments should contain the mean inertial forces and moments not just the added hydrodynamic forces and moments as usual note that the inertial effects for the comparison of computational results with experimental data should include the contributions of both low frequency and high frequency ship motions i e the contribution of transient motions uharek and cura hochbaum 2016 predicted ship manoeuvring in waves by solving ship motion equations by means of a modelling approach with model coefficients from rans computations later on in the work by uharek and cura hochbaum 2018b the inertial effects were accounted for when modelling the mean wave forces and moments to predict manoeuvring in waves it should be just necessary to subtract the inertial effects due to high frequency ship motions in the work people are used to add external loads e g wave drift forces and moments wind loads current loads etc on the right hand side of ship motion equations for predicting ship manoeuvring with consideration of external environment influences it may be baseless to do so at least when predicting ship manoeuvring and seakeeping separately in the study by yao et al 2020 a time averaged operation was performed towards the transient ship motion equations under condition of regular waves in order to filter the pure high frequency terms and resulted in the time averaged ship motion equations i e the pure low frequency ship motion equations the time averaged operation was very similar with the average operation towards naiver stokes n s equations the low frequency ship motion equations have a few additional terms which are the mean inertial forces and moments due to wave induced high frequency motions compared with the form of transient ship motion equations the additional mean inertial forces and moments due to high frequency ship motions indicate a similar concept with the inertial effects as found by uharek and cura hochbaum 2018a and lengwinat and cura hochbaum 2018 nevertheless to predict ship manoeuvring in waves one of the basic problems may be the ship motion equations so that it is very necessary to clarify which ship motion equations transient low frequency or high frequency we should solve in applications in this study we will give out the more complete pure low frequency ship motion equations in regular waves and some new explanations the pure high frequency ship motion equations are also derived by subtracting the pure low frequency ship motion equations from transient ship motion equations there are two improvements in manoeuvring prediction as compared with before one is that the mean inertial forces and moments due to second order high frequency motions are retained in the pure low frequency motion equations the other is that the effect of longitudinal ship speed is taken into account in the modelling approach as will be shown the prediction accuracy is improved 2 ship motion equations 2 1 transient ship motion equations in order to describe the motion of ship a completely ship fixed coordinate system o x y z is defined the origin is positioned at the intersection of mid ship sections and undisturbed free surface x axis parallel to the keel positive to bow y axis perpendicular to the symmetry plane positive to starboard and z axis towards the keel the motion equations of the assumed rigid ship can be written as e g abkowitz 1964 1a m u v r w q x g q 2 r 2 y g p q r z g p r q x 1b m v w p u r y g r 2 p 2 z g q r p x g q p r y 1c m w u q v p z g p 2 q 2 x g r p q y g r q p z 1d i x p i z i y q r m y g w p v q u z g v r u p w k 1e i y q i x i z r p m z g u q w r v x g w p v q u m 1f i z r i y i x p q m x g v r u p w y g u q w r v n where m is ship mass u v w are linear velocity components p q r are rotational velocity components x y z k m n are force or moment component x g y g z g are coordinates of center of gravity i x i y i z are inertial moments it should be noted that all products of inertia are assumed to be zero in eq 1 although they are generally not zero for real ships since ships are not completely of fore aft and left right symmetry e g single screw and single rudder ships however this assumption is usually expected to be of small influences on the final results of rudder manoeuver simulations equation 1 is derived by newton s law of motion all variables are transient 2 2 pure low frequency ship motion equations in order to derive the pure low frequency ship motion equations in regular waves we make the following assumptions 1 each transient variable in eq 1 is seen as a linear superposition of high frequency component and low frequency component 2 the time scales of high frequency component and low frequency component are so far away that the high frequency component has oscillated several times at least once during a time interval whereas the low frequency component is assumed to be unchanged 3 the high frequency component during the time interval may be approximated by trigonometric series so that a transient variable during the time interval in the condition of regular waves may be expressed as 2 φ φ l φ h 3 φ h n 1 φ c n cos n ω e t φ s n sin n ω e t where φ is u v w p q r x y z k m or n subscripts l and h denote low frequency component and high frequency component respectively φ c n and φ s n are coefficients of trigonometric series and ω e is current encounter frequency as seen under the assumptions the high frequency component contains the terms with the frequencies n ω e where n runs from 1 to maybe the high frequency component can be understood as a superposition of high order motions or forces moments excited by waves whereas the low frequency component is of zero order the low frequency component is excited by both waves and manoeuvring operations e g rudder deflection substituting each transient variable in above form into eq 1 then averaging the transient motion equations over the time interval term by term we can therefore obtain the time averaged equations i e the pure low frequency equations the average operation is described below in order to filter the high frequency component of a variable the time interval δ t should be an integral multiple of current encounter period t e here we assume δ t is t e thus for a single variable the mean of high frequency component is then equal to zero e g 4 u h t 0 t 0 δ t u h d t δ t t 0 t 0 t e u h d t t e 0 as a result 5 u t 0 t 0 t e u d t t e t 0 t 0 t e u h u l d t t e t 0 t 0 t e u l d t t e u l based on above assumptions as mentioned the mean of a single variable is the low frequency component itself note that if the time scales of high frequency component and low frequency component are close enough or saying the low frequency component change greatly during the time interval eq 5 is wrong for the mean of a product term of two variables e g the term v r it reads 6 v r t 0 t 0 t e v r d t t e t 0 t 0 t e v l r l v l r h v h r l v h r h d t t e obviously v l r h and v h r l are zero and v l r l v r note that v h r h is a sum of four kinds of terms v h r h n 1 m 1 v c n r c m cos n ω e t cos m ω e t v s n r c m sin n ω e t cos m ω e t v c n r s m cos n ω e t sin m ω e t v s n r s m sin n ω e t sin m ω e t let s recall the following relations cos n ω e t cos m ω e t 1 2 cos n m ω e t cos n m ω e t sin n ω e t cos m ω e t 1 2 sin n m ω e t sin n m ω e t cos n ω e t sin m ω e t 1 2 sin n m ω e t sin n m ω e t sin n ω e t sin m ω e t 1 2 cos n m ω e t cos n m ω e t for a random n and m t 0 t 0 t e cos n m ω e t d t t e 0 t 0 t 0 t e sin n m ω e t d t t e 0 t 0 t 0 t e sin n m ω e t d t t e 0 if n m t 0 t 0 t e cos n m ω e t d t t e 1 else if n m t 0 t 0 t e cos n m ω e t d t t e 0 due to above relations averaging v h r h term by term results in 7 v h r h 1 2 n 1 v c n r c n v s n r s n thus eq 6 finally becomes 8 v r v r 1 2 n 1 v c n r c n v s n r s n averaging all terms in eq 1 in the similar way we can obtain the complete pure low frequency ship motion equations 9a m u v r w q x g q 2 r 2 y g p q r z g p r q 1 2 m n 1 v c n r c n v s n r s n n 1 w c n q c n w s n q s n x g n 1 q c n 2 q s n 2 n 1 r c n 2 r s n 2 y g n 1 p c n q c n p s n q s n z g n 1 p c n r c n p s n r s n x 9b m v w p u r y g r 2 p 2 z g q r p x g q p r 1 2 m n 1 w c n p c n w s n p s n n 1 u c n r c n u s n r s n y g n 1 r c n 2 r s n 2 n 1 p c n 2 p s n 2 z g n 1 q c n r c n q s n r s n x g n 1 q c n p c n q s n p s n y 9c m w u q v p z g p 2 q 2 x g r p q y g r q p 1 2 m n 1 u c n q c n u s n q s n n 1 v c n p c n v s n p s n z g n 1 p c n 2 p s n 2 n 1 q c n 2 q s n 2 x g n 1 r c n p c n r s n p s n y g n 1 r c n q c n r s n q s n z 9d i x p i z i y q r m y g w p v q u z g v r u p w 1 2 i z i y n 1 q c n r c n q s n r s n 1 2 m y g n 1 p c n v c n p s n v s n n 1 q c n u c n q s n u s n z g n 1 r c n u c n r s n u s n n 1 p c n w c n p s n w s n k 9e i y q i x i z r p m z g u q w r v x g w p v q u 1 2 i x i z n 1 r c n p c n r s n p s n 1 2 m z g n 1 q c n w c n q s n u w s n n 1 r c n v c n r s n v s n x g n 1 p c n v c n p s n v s n n 1 q c n u c n q s n u s n m 9f i z r i y i x p q m x g v r u p w y g u q w r v 1 2 i y i x n 1 p c n q c n p s n q s n 1 2 m x g n 1 r c n u c n r s n u s n n 1 p c n w c n p s n w s n y g n 1 q c n w c n q s n w s n n 1 r c n v c n r s n v s n n it should be noted that the mean forces and moments on the right hand side are of pure hydrodynamics each mean force or moment can be seen as a linear superposition of the calm water force or moment and the added hydrodynamic force or moment due to waves the latter is the usual wave drift force or moment in concept for example the longitudinal mean force is x x c a l m x x c a l m x c a l m x d where subscripts c a l m and d denote the force or moment in calm water and the added hydrodynamic force or moment due to waves respectively the additional terms in eq 9 compared with the form of eq 1 are the non zero mean forces and moments due to wave induced high frequency motions the above average operation towards transient ship motion equations is quite similar with the average operation towards n s equations the reynolds stress in rans equations is actually the mean stress produced by the product terms of two pulsating quantities of turbulence similarly the resulting additional terms in eq 9 are the mean inertial forces and moments produced by the product terms of two high frequency ship motions 2 3 pure high frequency ship motion equations to obtain the pure high frequency ship motion equations we subtract the pure low frequency ship motion equations from transient ship motion equations for a single variable e g v its high frequency component is v v for a product term e g v r it can be written as 10 v r v v h r r h v r v r h v h r v h r h subtracting the pure low frequency component i e v r v r v h r h from above equation we can obtain its pure high frequency component 11 v r h v r v r v r h v h r v h r h v h r h where v h r h has been formulated previously i e eq 7 subtracting eq 9 from eq 1 term by term the expression of pure high frequency ship motion equations can be written as 12a m u h v r h v h r v h r h v h r h w q h w h q w h q h w h q h x g 2 q q h q h 2 q h 2 2 r r h r h 2 r h 2 y g p q h p h q p h q h p h q h r h z g p r h p h r p h r h p h r h q h x h 12b m v h w p h w h p w h p h w h p h u r h u h r u h r h u h r h y g 2 r r h r h 2 r h 2 2 p p h p h 2 p h 2 z g q r h q h r q h r h q h r h p h x g q p h q h p q h p h q h p h r h y h 12c m w h u q h u h q u h q h u h q h v p h v h p v h p h v h p h z g 2 p p h p h 2 p h 2 2 q q h q h 2 q h 2 x g r p h r h p r h p h r h p h q h y g r q h r h q r h q h r h q h p h z h 12d i x p h i z i y q r h q h r q h r h q h r h m y g w h p v h p h v p h v h p h v h q u h q h u q h u h q h u h z g v h r u h r h u r h u h r h u h p w h p h w p h w h p h w h k h 12e i y q h i x i z r p h r h p r h p h r h p h m z g u h q w h q h w q h w h q h w h r v h r h v r h v h r h v h x g w h p v h p h v p h v h p h v h q u h q h u q h u h q h u h m h 12f i z r h i y i x p q h p h q p h q h p h q h m x g v h r u h r h u r h u h r h u h p w h p h w p h w h p h w h y g u h q w h q h w q h w h q h w h r v h r h v r h v h r h v h n h the product terms of a low frequency motion and a high frequency motion such as v r h v h r and q q h are of purely high frequency since low frequency motions are assumed to be unchanged during the time interval when performing average operation the product terms of two high frequency motions such as v h r h are certainly not of purely high frequency as v h r h is not zero see eq 7 however if subtracting their pure low frequency component such as v h r h v h r h they are we have given out the pure low frequency and pure high frequency ship motion equations in regular waves it should be understood that low frequency variables satisfy the pure low frequency equations approximately just during a current time interval in terms of a large time scale the time interval should be one or several current encounter periods to talk about the variation of low frequency variables in terms of a small time scale may be nonsense the mean inertial forces and moments due to high frequency motions are just relevant to their amplitudes and phases not their transient motions the high frequency variables synchronously satisfy the pure high frequency equations approximately during the same time interval as well the low frequency motion variables in the pure high frequency equations as well as the mean inertial forces and moments due to high frequency motions are also assumed to be unchanged during the time interval but in terms of a small time scale as time shifts into another time interval these variables or terms as assumed to be unchanged during the current time interval will certainly change 3 manoeuvring prediction in waves the three degrees of freedom low frequency ship motion equations including the low frequency terms due to coupled heave pitch and roll have been solved to predict the manoeuvrability of container ship s 175 in regular waves by means of a modelling approach in our previous work modelling was not only for calm water forces and moment as usual but also for the added forces and moments due to waves the latter included the added hydrodynamic forces and moment and the mean inertial forces and moments due to the coupled heave pitch and roll however the modelling was not directly for the mean inertial forces and moments but for the first order heave pitch and roll i e the coefficients of trigonometric series such as w c 1 and q s 1 in eq 9 in present work manoeuvring prediction in waves are also conducted for s 175 by using the modelling approach as before however as mentioned there are two improvements 1 the mean inertial forces and moments due to second order high frequency motions are retained in the pure low frequency motion equations 2 the effect of longitudinal ship speed is taken into account in the modelling approach the three degrees of freedom pure low frequency ship motion equations to be solved are expressed as follows 13a m u v r x g r 2 1 2 m n 1 2 w c n q c n w s n q s n x g n 1 2 q c n 2 q s n 2 x c a l m x d 13b m v u r x g r 1 2 m n 1 2 w c n p c n w s n p s n x g n 1 2 q c n p c n q s n p s n y c a l m y d 13c i z r m x g v r u 1 2 i z i x n 1 2 p c n q c n p s n q s n 1 2 m x g n 1 2 p c n w c n p s n w s n n c a l m n d where i y i z is assumed for convenience the bars over variables in above equations will be dropped in the following content we have carried out free running tests in calm water and in waves for present validation the main particulars of s 175 are listed in table 1 fig 1 shows the ship model being in a turning test in waves 3 1 modelling of hydrodynamic forces and moment in calm water a usual abkowitz type mathematic model is employed to approximate the calm water forces and moment the model is as follows 14a x c a l m x 0 x u δ u x u u δ u 2 x u u u δ u 3 x u u x v v x v v v 2 x v v v v 3 x r r x r r r 2 x r r r r 3 x δ δ x δ δ δ 2 x δ δ δ δ 3 x v r v r x v δ v δ x r δ r δ 14b y c a l m y 0 y v v y v v v 2 y v v v v 3 y v v y r r y r r r 2 y r r r r 3 y r r y v r r v r 2 y v v r v 2 r y δ δ y δ δ δ 2 y δ δ δ δ 3 y u δ δ u δ y v δ δ v δ 2 y v v δ v 2 δ y r δ δ r δ 2 y r r δ r 2 δ 14c n c a l m n 0 n v v n v v v 2 n v v v v 3 n v v n r r n r r r 2 n r r r r 3 n r r n v r r v r 2 n v v r v 2 r n δ δ n δ δ δ 2 n δ δ δ δ 3 n u δ δ u δ n v δ δ v δ 2 n v v δ v 2 δ n r δ δ r δ 2 n r r δ r 2 δ to determine the derivatives an expanded rans solver based on openfoam is used to compute the manoeuvring forces and moment for the ship model performing a series of captive motions in calm water including static straight ahead motion with rudder deflection static drift motion with rudder deflection static circle motion with rudder deflection static circle motion with drift and dynamic pure surge sway and yaw afterwards hydrodynamic derivatives can be acquired by regression as usual the rans methods have been described in details in a previous publication by yao 2015 generally speaking to obtain all required hydrodynamic derivatives from pure rans computations will be very time consuming due to many cases especially considering dynamic ship motions in water surface and real rotating propeller with dynamic grid approach in order to reduce computational time the assumptions of double body flow and body force propeller are introduced during present computations the thrust and torque specified for the body force propeller are estimated by make use of open water curves however the body force distribution is assumed to be always of circumferential symmetry regardless of the effects of manoeuvring motions the grids are generated by using the commercial software hexpress grid dependence analysis is firstly carried out for resistance the grid with around 1 22 million cells is finally selected although we generate the grid for each case of rudder deflection the procedure of grid generation e g cell size around hull and rudder remain almost the same that means the grids with different rudder deflection have a close distribution of grid cell and are expected to be of enough accuracy for reasonable results fig 2 shows the stream lines across propeller disk for a static drift motion with rudder deflection the stream lines near ship bow and body force region swirl as observed the derivatives used are summarized in table 2 here we find five derivatives i e x u x u u x u u u y u δ and n u δ to be of less accuracy since the simple body force propeller is not able to accurately predict thrust and torque empirical ones are borrowed to replace them in use the accuracy of rans computation is not discussed presently due to lack of experimental data even so the derivatives in table 2 are expected to be applicable to approximate the calm water forces and moment for manoeuvre simulations fig 3 present a comparison of the simulated turning trajectory with experimental ones the experimental data by yasukawa 2006b who conducted free running tests for a ship model with 3 5 m is plotted in the figure as well as can be seen the final simulation accuracy is acceptable this means except for the five derivatives others should be accurate enough 3 2 modelling of the added forces and moments due to waves the added forces and moments due to waves here includes the added hydrodynamic forces and moment and the mean inertial forces and moments due to high frequency motions as mentioned for the latter the modelling is for the coefficients of trigonometric series in eq 13 their dimensionless forms may be expressed as follows 15a c w x x d ρ g a 2 l p p 15b c w y y d ρ g a 2 l p p 15c c w n n d ρ g a 2 l p p 2 16a c w c n w c n a ω e 16b c w s n w s n a ω e 16c c q c n q c n a ω e k w 16d c q s n q s n a ω e k w 16e c p c n p c n a ω e k w 16f c p s n p s n a ω e k w with a wave amplitude g acceleration due to gravity ρ water density k w wave number and n equal to 1 and 2 to use encounter frequency ω e in eq 16 may be more reasonable than to use natural circular frequency of waves in addition the calm water forces and moment are made non dimensional by 1 2 ρ u 2 l p p 2 and 1 2 ρ u 2 l p p 3 respectively as usual although the assumption of quadratic dependence of the added hydrodynamic forces and moment on wave amplitude is not applicable for all waves it will not affect the final manoeuvre simulation in the present consideration because the wave amplitude considered in the later manoeuvre simulations will be same with the one used to determine the above dimensionless coefficients since the dimensionless added hydrodynamic forces and moment and high frequency motions expressed by eqs 15 and 16 will change with wave encounter angle χ periodically and the period is 2 π fourier series are used to approximate them as proposed by uharek and cura hochbaum 2015 the wave encounter angle 0 was defined as heading waves 180 as following waves moreover c w x c w c n c w s n c q c n and c q s n are symmetric with respect to the central longitudinal section of ship as encounter angle changes so that the model up to sixth order is as follows for them 17a c w x c w c n c w s n c q c n c q s n a 0 2 m 1 6 a m cos m χ whereas since c w y c w n c p c n and c p s n are antisymmetric with respect to the central longitudinal section of ship as encounter angle changes the following model up to fifth order is used for them 17b c w y c w n c p c n c p s n m 1 5 b m sin m χ definitely a 0 a m and b m will change with ship manoeuvring motions and wave conditions except for χ in present consideration a 0 a m and b m are assumed to depend on wave length λ at a certain ship speed u three ship speeds are considered in the modelling as will be also mentioned later on during the latter manoeuver simulations if λ and χ are known the model is employed to calculate x d y d n d w c n w s n q c n q s n p c n and p s n for the three ship speeds then a parabolic interpolation method is used to determine their values at the current ship speed in our previous work yao et al 2020 the two phase rans solver based on openfoam has been applied to compute the hydrodynamic forces and moment and wave induced motions for a bare s 175 performing straight ahead motion in oblique regular waves the length of ship model was 3 5 m during the rans computations surge sway and yaw were fixed however heave pitch and roll were completely free seven wave encounter angles i e 0 30 60 90 120 150 and 180 and four wave lengths i e 0 5 l p p 0 7 l p p l p p and 1 2 l p p were considered the forces and moment and ship motions for encounter angles 210 240 270 300 and 330 were resulted by make use of symmetric or antisymmetric relations however just one ship speed corresponding to froude number 0 15 was taken into account in our previous work due to high computational cost the fourier coefficients for this speed have been obtained the relevant numerical methods have been described in details in the work in this work another two speeds as supplement are considered for the rans computations providing more data for the modelling the corresponding froude numbers are 0 075 and 0 0375 during the computations the wave conditions such as wave length wave amplitude encounter angle remain the same the dimensionless wave amplitude defined by a a l p p is 0 01 based on the grid dependency analysis in the previous work the grid with around 1 05 million cells is used for present computations fig 4 shows the wave snapshots for λ 1 and χ 30 where λ λ l p p as can be seen the waves downstream along wave direction are more disturbed as speed increases moreover the decay of wave amplitude is observed downstream as well that may be unavoidable after completing all computations the model coefficients can be determined the procedure of data post processing is shown in fig 5 1 regress time histories of heave pitch and roll for all cases by fourier series resulting in coefficients of trigonometric series the time when wave crest locates at amid ship is assumed as zero time 2a average the computed longitudinal force side force and yaw moment in time resulting in mean forces and moment 2 b subtract calm water forces and moment from the mean forces and moment resulting in added hydrodynamic forces and moment due to waves note that here the forces and moment are all of pure hydrodynamics 3 for a certain wave length and ship speed only one wave amplitude is considered at present the added hydrodynamic forces and moment and the coefficients of trigonometric series change with wave encounter angle approximating the change law by fourier series i e eq 17 results in fourier coefficients fig 6 presents the dimensionless added hydrodynamic forces and moment versus wave encounter angle for λ 0 7 circles represent the computed values and lines represent the reconstructed values by the model the computed and reconstructed dimensionless first order and second order heave pitch and roll for λ 1 are shown in fig 7 the model is able to reconstruct the computed results perfectly 3 3 manoeuvring prediction in waves using above mathematic models eq 13 is solved by an iterative approach for the simulation of free running test in waves as usual the fourth order runge kutta scheme is employed to approximate the acceleration terms wave amplitude is chosen as a 0 01 the same with the one to determine model coefficients as mentioned the considered initial ship speed corresponds to froude number 0 15 note that during a rudder manoeuvre simulation in waves the ship initially keeps steady rectilinear motion before deflecting rudder so that except for heading and following waves there must be an initial balance rudder angle to offset wave effects ensuring the equilibrium at beginning here says steady rectilinear motion or equilibrium should be understood as a mean situation in general the initial equilibrium state of ship motion can be determined by solving the equilibrium motion equations i e the simplified equations of eq 13 with the condition that the mean accelerations and yaw rate are zero at present the newton iteration method is used to solve the equilibrium equations for a given initial wave condition the solutions u v and δ represent the initial equilibrium state of ship motion and the rudder angle needed to keep the equilibrium under the given wave condition 3 3 1 simulation of turning test the simulated trajectories of turning tests for λ 0 7 0 initial wave encounter angle and 35 rudder deflection with both port side and starboard side are compared with experimental data in fig 8 the simulated time histories of turning rate pitch and roll are compared in the back of the figure as well note that the simulated pitch and roll are their first order amplitudes of displacement which are calculated by make use of the mathematic model e g the first order amplitude of pitch displacement θ m a x q c 1 2 q s 1 2 ω e thus the advantage of modelling the high frequency motions i e w c 1 q s 1 etc but not directly modelling the inertial forces and moments due to the high frequency motions is that time traces of first order heave pitch and roll amplitudes can be obtained during rudder manoeuver simulations even though the pure high frequency motion equations are not solved the comparison of the results for 90 initial wave encounter angle is shown in fig 9 the results are improved significantly due to the consideration of longitudinal ship speed when modelling as compared with before especially the drift direction of motion trajectory accords quite well with experimental data however the simulations present a little bit larger twisted turning circles than the experimental ones the drift distance of turning circle is smaller than that of experiment the comparisons of simulated results with experimental data for λ 1 are shown in figs 10 and 11 satisfactory agreements are also observed in particular for turning rate pitch and roll however the advances of trajectories are generally underestimated this is most probably due to two reasons 1 neglect of the mean inertial forces and moments due to high frequency surge sway and yaw in the pure low frequency motion equations 2 less accuracy of the computed added forces and moments due to waves larger twisted turning circles and smaller drift distance are found as well compared with experimental data in addition the effects of initial wave encounter angle on motion trajectory are investigated the results for λ 0 7 and λ 1 are shown in fig 12 it is observed that the included angle between the drift direction of trajectory and the direction of wave propagation is always fixed and the ship tends to a same periodic motion over time regardless of the initial wave encounter angle this observation is coincident with that by cura hochbaum and uharek 2016 3 3 2 simulation of zig zag test the simulated results of zig zag test including times histories of heading angle rudder angle and turning rate are compared with experimental data in figs 13 15 for different conditions the results of 20 20 zig zag manoeuvres show generally good agreements with experimental data either for 0 or for 90 initial wave encounter angle however the accuracy becomes worse for 10 10 zig zag the simulations are not able to predict well the rudder steering time the zig zag period for λ 1 is larger than that for λ 0 7 the oscillation amplitudes of experimental data for 90 initial wave encounter angle are larger than that for 0 initial wave encounter angle as compared the experimental curves in fig 14 and in fig 15 4 concluding remarks the present main purpose is to give out the complete expressions of pure low frequency and pure high frequency ship motion equations in regular waves these equations are recommended for the method of predicting manoeuvring and seakeeping separately however it has to note that the motion equations just satisfy approximately the relation between motions and forces moments if the assumptions introduced to derive these equations e g there exists a great difference between the time scales of high frequency and low frequency ship motions are not satisfied the motion equations are of not accuracy or even wrong in this case to predict manoeuvring and seakeeping separately may be questionable in present application the three degrees of freedom pure low frequency ship motion equations are solved by means of a modelling approach to predict manoeuvring in waves there are two improvements as compared with our previous work the mean inertial forces and moments due to second order heave pitch and roll are retained in the low frequency ship motion equations three longitudinal ship speeds are taken into account when modelling not just one speed more accurate results are obtained compared with our previous results however the accuracy of rans computation is not discussed in this work due to lack of appropriate experimental data it is necessary to distinguish the concepts of added forces and moments due to waves wave drift forces and moments low frequency wave inertial forces and moments etc for comparison purpose of numerical results with experimental data the other concern may be the standard coordinate system in which the forces and moments are expressed e g completely ship fixed coordinate system or horizontal ship fixed coordinate system credit authorship contribution statement jianxi yao conceptualization methodology software writing review editing formal analysis visualization writing original draft investigation validation zuyuan liu funding acquisition supervision conceptualization methodology xuemin song software writing original draft investigation yan su methodology software formal analysis investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by national natural science foundation of china grant nos 51609188 51720105011 
20637,this paper investigates the finite time distributed formation control for unmanned surface vessels usvs exposed to external disturbances model uncertainties and input saturation constraints by combing the sliding mode control method and adaptive algorithms two control architectures are developed for usvs formation control problem radial basis function neural networks rbfnns is adopted for approximating the unavailable system dynamics where the minimum learning parameter mlp algorithm is utilized to alleviate the excessive occupation of the computational resource by feat of an auxiliary system an adaptive mechanism is devised such that the input saturation problem could be figured out it follows from the theoretical analysis that finite time convergence is achievable under the proposed two controllers finally numerical simulations are exhibited to illustrate the effectiveness of the proposed formation control schemes keywords unmanned surface vessels formation control input saturation sliding mode control minimum learning parameter 1 introduction for the indispensable role in numerous military and commercial activities including marine resources prospecting and development reconnaissance and surveillance and marine mapping zhang et al 2020 zheng et al 2020 wang et al 2020a qin et al 2020 etc the formation of usvs has been an attractive topic in marine engineering compared with a monolithic surface vessel the potential advantages such as better disturbance rejection properties great adaptability and feasibility fewer mission costs and high reliability are the prominent reason to apply the formation configuration for usvs xiao et al 2016 owing to this practical and theoretical significance the design of control schemes deserves a great interest for improving the accuracy and robustness of formation systems thus far in order to get desirable control performance numerous results have been proposed in the formation scenarios involving backstepping approaches wang et al 2020a finite time control strategies fu and lingling 2018 and neural network methods lu et al 2018a etc in fact although there are fruitful results on formation control of usvs developing controllers with less dependence on model information still possess a significant challenge the strong coupling of nonlinear systems and disturbances caused by the complicated external environment make it impossible to obtain accurate model information for designers owing to the prominent superiority the backstepping methods are widely applied in the trajectory tracking tasks of marine vehicles when the system suffers from unknown nonlinear dynamics and disturbances xie et al 2020 wen et al 2019 in xie et al 2020 and wen et al 2019 backstepping methods in connection with a state observer and the optimization control method were adopted to perform tracking missions for autonomous underwater vehicles and usvs respectively though effective these two controllers are only applicable for a single vehicle considering the formation control problem a leader following architecture were utilized such that all of the followers could track the trajectory of the leader in the consideration of unmodeled system dynamics lu et al 2020a prescribed performance constraints he et al 2018 dai et al 2017 2019 zhang and yang 2018 and line of sight range constraints jin 2016 ghommam and saad 2017 by resorting to the mlp algorithm based nonlinear disturbance observer the followers could track the leader with a predefined geometrical shape even when the velocities of the leader remained unavailable to followers lu et al 2018b obviously these formation controllers are synthesized under the centralized control strategy which means all of the formation members require precise information from the leader however this limitation results in the leader follower based controllers vulnerable to single point failure problem thus leading to undesirable effect to the formation missions taking the foregoing drawback of the leader following controllers into account the interaction topology was introduced in the cooperative formation control schemes fu and lingling 2018 lu et al 2018a where the leader s information is just available to a subset of the followers on account of the satisfactory estimation property the neural networks nns were employed to construct leaderless and leader follower cooperative formation control strategies by inclusion of backstepping technique and graph theory peng et al 2013 in this way by means of estimating the weight matrix online the unmodeled system dynamics could be approximated online simultaneously although effective for uncertainties as the number of the formation member increases the computational complexity will become the main obstacle for the formation system to this end the mlp algorithm was introduced for the usvs cooperative control such that the amount of computation can be cut down fu and lingling 2018 totally different from the solutions in fu and lingling 2018 lu et al 2018a peng et al 2013 two updating laws including composite iterative and direct iterative updating laws were proposed to solve the cooperative dynamic positioning problem for multiple usvs in a time varying formation configuration liu et al 2015 nevertheless it must be pointed out that these foregoing cooperative controllers are developed for fully actuated surface vessels in practice attributing to the dynamic nature or physical constraint the tracking control systems may become underactuated lying in this fact input output linearization technique was used to guarantee desired geometric shapes and bounded tracking errors for multiple underactuated surface vessels xie et al 2018 for the purpose of not only guaranteeing system stability but also considering transient performance prescribed performance control methods have been applied for the formation issue of usvs in yoo and park 2017 prescribed performance will be ensured for the containment problem of a group of underactuated surface vessels furthermore an error transformation method was utilized to further solve the predefined performance constraint and endow the formation system with the ability of collision avoidance and connectivity preserving park and yoo 2018 in many practical applications due to the physical limitations on hardware and energy consumption the actuators with constrained outputs always exist with which performance deterioration or even system instability will occur attributing to the deviation between the desired input signals and the actual outputs of actuators guo et al 2019 in this context various attempts in the development of anti saturation controllers for both single and multiple surface vessel systems can be founded in fu and lingling 2018 deng et al 2020 shen et al 2020 zhu et al 2020 qin et al 2020 wang et al 2014 and references therein particularly a coordinate transformation was introduced in deng et al 2020 to not only release the requirement of an off diagonal inertia matrix but also obtain a saturation free control scheme based on the fuzzy logic systems besides for the ability of strong robustness against uncertainties recursive sliding mode method was employed in shen et al 2020 then in order to reduce the effect of magnitude limit on actuators outputs a saturation compensational term was designed in the tracking controller with the combination of dynamic surface approach unlike the literatures mentioned above through the error transformation method and dynamic auxiliary system both state constraints and input saturation constraints could be tackled in zhu et al 2020 in contrast to the method proposed in zhu et al 2020 barrier lyapunov function was applied to solve the full state constraints for surface vessels in qin et al 2020 as for multiple surface vessels formation missions cooperative path following problem and distributed formation task were considered in wang et al 2014 and fu and lingling 2018 respectively a bearing based adaptive neural formation scaling control scheme was developed for a group of autonomous surface vehicles with uncertainties and input saturation lu et al 2020b however observing the existing methods for multiple surface vessels it shows that finite time anti saturation control architectures with less computational complexity have been rarely investigated this paper is motivated by the above analysis and discussion which mainly concentrates on providing a finite time solution to the problem of formation control of usvs subject to external disturbance model uncertainties and input saturation constraints firstly a basic robust controller is developed for cooperative formation control problem with the combination of sliding mode method and adaptive algorithms then through an auxiliary system with bounded compensation terms an adaptive mechanism is devised in the second controller such that the input saturation problem could be figured out the major superiorities of the developed controllers are summarized as follows i in contrast with the solutions for input saturation in wang et al 2014 esfandiari et al 2014 an auxiliary system is introduced into the sliding mode control scheme to compensate for the input saturation constraints in addition the auxiliary valuables are bounded under the proposed control scheme thus compensating for the saturation constraints with satisfactory performance ii different form previous works lu et al 2018a 2020b finite time convergence is endowed to the formation system with uncertainties in this paper such that fast system response will be achieved particularly unlike the finite time solution in fu and lingling 2018 by virtue of the mlp based online estimation algorithm the accurate model information of usvs is not required to derive the saturation free cooperative controller thus the study on finite time anti saturation control architectures for usvs can be enriched and the designed controller is more practical for formation issues in ocean engineering the remainder of this paper is presented as follows in section 2 corresponding preliminaries of this paper are presented section 3 illustrates the design of formation controllers in section 4 numerical simulations are presented to verify the effectiveness of the proposed methods finally the conclusion of this paper can be derived in section 5 2 preliminaries 2 1 dynamics of usvs in this brief we consider that the trajectory of the formation system is defined in a horizontal plane the control objective of cooperative formation for usvs in this paper could be divided into two points tracking the trajectory of the virtual leader and maintaining a predefined formation shape two coordinates are defined in to describe the ith usv s motion i e the earth fixed coordinate o e x e y e and the body fixed coordinate o b x b y b the geometric description for the formation problem could be presented as fig 1 a for a network containing n usvs the numerical dynamics of the ith vehicle under these two coordinates is described as 1 η i r ψ i v i m i v i c i v i v i d i v i v i ρ i h τ i m i r t ψ i d i where η i x i y i ψ i t is composed of the position vector x i y i and heading angle ψ i of the vessel in the earth fixed coordinate frame efcf v i u i v i r i t is composed of the corresponding linear velocity u i v i and angular velocity r i in the body fixed coordinate frame bfcf r ψ i denotes the rotation matrix from bfcf to efcf m i is the inertia matrix of the ith vehicle c i v i and d i v i represent coriolis matrix and hydrodynamic damping matrix respectively d i v i is always symmetric and positive definite ρ i ρ i u ρ i v ρ i r t denotes the unmodeled system dynamics caused by unknown parameter variations from the real application aspect the model information of the msv cannot be accurately accessible to the designers and ρ i remains unknown in the controller design process it should be noted that η i is defined in the efcf while v i is defined in bfcf to facilitate the design transformation matrix r ψ i is applied to transform the linear velocity and angular velocity from bfcf to efcf the inertia matrix m i is mainly decided by the usv s mass in engineering implementation m i is a time varying valuable and it cannot be always accurately known to designers implying that unknown system dynamics will be caused by this uncertain information c i v i v i and d i v i v i mainly decide the nonlinear part of the usv model from the aspect of real applications these two matrixes always possess much uncertainties the detailed expression of these model parameters are given as 2 r ψ i cos ψ i sin ψ i 0 sin ψ i cos ψ i 0 0 0 1 m i m 11 m 12 m 13 m 21 m 22 m 23 m 31 m 32 m 33 ℝ 3 3 c i v i c 11 c 12 c 13 c 21 c 22 c 23 c 31 c 32 c 33 ℝ 3 3 d i v i d 11 d 12 d 13 d 21 d 22 d 23 d 31 d 32 d 33 ℝ 3 3 in 1 the vector d i d u i d v i d r i t denotes the bounded external disturbance caused by unknown winds waves and ocean currents for convenience d i represents the lumped disturbance τ i τ u i τ v i τ r i t denotes the desired control input of the close loop system τ u i τ v i and τ r i are surge force sway force and yaw moment produced by the propulsion system composed by main propellers aft and thrusters h τ i h τ u i h τ v i h τ r i t denotes the input nonlinearity induced by actuator saturation whose expression is shown as 3 h τ sat τ sign τ h m τ h m τ τ h m where h m is the upper bound of h τ the notation sign means the sign function remark 1 from a practical point of view the marine environment is complicated and unpredictable the time varying disturbances d t can hardly be accurately observed in real time on the other hand coriolis matrix c v and hydrodynamic damping matrix d v show strong nonlinearity owing to the complex hydrodynamics consequently it s necessary to design formation controllers with strong robustness against these perturbations remark 2 in the engineering applications owing to the physical limitations and energy consumption the input saturation will exist and lead to deviations between the desired input signals and the actual control input in the occurrence of this constraints system performance deterioration will inevitably happen in the existing literatures wang et al 2020b lu et al 2018a this topic was rarely discussed for formation usvs to relax the restriction this paper constructs an auxiliary system to address the input saturation problem subsequently by defining μ i η i and using the property r i t r i i the transformed dynamics of usvs can be obtained as 4 η i μ i μ i r i m i 1 h τ i g r i μ i r i m i 1 c i v i v i d i v i v i ρ i r i t μ i d i with g r i 0 r i 0 r i 0 0 0 0 0 this paper aims to force all of the formation members to track the virtual leader η d t while maintaining prescribed geometrical shapes in order to derive the tracking errors the relative formation shape δ i r 3 is introduced then the tracking errors are written as 5 e 1 i η i δ i η d e 2 i η i δ i η d this paper is dedicating to developing controllers for formation system eq 1 such that tracking errors e 1 i and e 2 i are characterized with finite time convergence understanding this control objective from physical meaning implies that the following vehicles in the formation will track the desired trajectory and maintain a preset geometry formation shape in finite time in order to establish the dynamics of overall formation system the following vectors are defined 6 η η 1 t η 2 t η n t t v v 1 t v 2 t v n t t μ μ 1 t μ 2 t μ n t t d d 1 t d 2 t d n t t h τ h t τ 1 h t τ 2 h t τ n t e 1 e 11 t e 12 t e 1 n t t e 2 e 21 t e 22 t e 2 n t t τ τ 1 t τ 2 t τ n t t δ δ 1 t δ 2 t δ n t t η d η d t η d t η d t t ρ ρ 1 t ρ 2 t ρ n t furthermore for convenience some diagonal matrixes are defined as follows 7 m 1 diag m 1 1 m 2 1 m n 1 t g r diag g r 1 g r 2 g r n t r diag r 1 r 2 r n t c v diag c 1 v 1 c 2 v 2 c n v n t d v diag d 1 v 1 d 2 v 2 d n v n t then the formation system for multiple usvs could be described as 8 η μ μ r m 1 h τ g r μ r m 1 c v v d v v ρ r t μ d 2 2 basic graph theory this paper employs the undirected connected graph to describe the communication topology of formation members the graph is denoted as g ν ζ a in which the node set ν ν 1 ν 2 ν n represents all usvs in the formation the edge set ζ n n represents the communication paths among usvs a a i j ℝ n n is the weighted adjacency matrix the element a i j satisfies a i j 0 when v i v j ζ and a i j 0 otherwise generally it is assumed that each node does not exchange information with itself i e a i j 0 i j for any undirected graph a is a symmetric matrix with a i j a j i furthermore if all the nodes are connected as a whole by paths it is called that the undirected graph is connected the laplace matrix l of the graph g is introduced as l d a where d diag j 1 n a 1 j j 1 n a 2 j j 1 n a n j 2 3 function approximation based on rbfnn radial basis function neural network rbfnn possess a satisfactory property in approximating nonlinear functions with arbitrary precision thus it will be introduced here to estimate unmodeled system dynamics for the formation system previous to the main result of this paper the following lemma of rbfnn is given lemma 1 fu and lingling 2018 suppose f x as an unknown smooth nonlinear function there exists a weight vector w satisfying the following equation 9 f x w t h x ο 0 ο o where w w 1 w 2 w p t and x x 1 x 2 x m denote the weight vector and the input vector respectively p and m are numbers of nodes and inputs o and o represent the approximation error and its upper bound h x h 1 x h 2 x t stands for the gaussian basis function vector whose definition is given as 10 h i x exp x c i 2 2 2 b i 2 i 1 p where c i r m and b i r are the central vector and the width of gaussian basis function respectively 2 4 math preliminaries for a vector a r n a denotes its euclidean norm for a matrix a a is the induced norm of this matrix if a is a positive matrix λ max a and λ min a stand for the maximum and minimum eigenvalue of matrix a the notation denotes the kronecker product tanh a is defined as tanh a tanh a 1 tanh a 2 tanh a n t lemma 2 yu et al 2018 for a lyapunov function v satisfying the following equation finite time stability for v is achievable and it will move into a residual set 11 v ι v κ v α ϖ where 0 α 1 ι 0 κ 0 ϖ 0 lemma 3 xie et al 2020 for any scalar x r the hyperbolic tangent function possesses the following property 12 0 x x tanh μ x δ μ with the constants satisfying μ 0 and δ 0 2785 lemma 4 qinglei et al 2019 for any positive constants α and β there always exists the following relation 13 0 α α 2 α 2 β 2 α α 2 α β β 2 5 assumptions assumption 1 the communication topology of the formation system is an undirected connected graph the reference trajectory η d t of virtual leader is available by exchanging information among formation vehicles assumption 2 the reference trajectory η d t of the virtual leader is second order differentiable and η d η d η d are all bounded assumption 3 the lumped disturbance d i possess an unknown upper bound i e d i d i with d i denoting a positive constant remark 3 in practical engineering the value of reference trajectory η d t is determined by the designers thus η d t can be second order differentiable and the parameters η d η d η d all have bounds in assumption 2 attributing to the fact that disturbances are caused by winds waves and ocean currents it is necessary to assumpe the external disturbances being bounded unknown and time varing it can be found the assumption 3 always exists for formation control problems 3 controllers design in this section the finite time cooperative formation control problem for multiple usvs is addressed by resorting to the sliding mode control approach mlp algorithm and an auxiliary system firstly a basic adaptive control architecture is exploited when the unmodeled system dynamics and magnitude limits on the outputs of actuators are ignored then these two issues will be handled in the second controller more specifically rbfnn based mlp algorithm is employed to approximate the unknown dynamics with low complexity and an auxiliary system is proposed for the compensation of input saturation constraints eventually finite time convergence of the proposed controllers is theoretically demonstrated by lyapunov based analysis in order to show the control algorithm more intuitively the schematic diagram is presented in fig 1 b 3 1 finite time cooperative controller synthesis without the consideration of unmodeled system dynamics and input saturation constraints mathematic model of the ith vessel in formation is written as 14 η i μ i μ i r i m i 1 τ i g r i μ i r i m i 1 c i v i v i d i v i v i r i t μ i d i based on the tracking errors defined in eq 5 a sliding mode surface sms for the ith vehicle is formulated as 15 s 1 i e 2 i k 1 e 1 i k 2 tanh e 1 i j 1 n a i j e 2 i e 2 j k 1 e 1 i e 1 j k 2 tanh e 1 i tanh e 1 j where k 1 k 2 are both positive parameters and a i j is the element of weight weighted adjacency matrix a by resorting to the definitions 6 7 and the laplace matrix l eq 15 is rewritten as 16 s 1 i n n l i 3 3 e 2 k 1 e 1 k 2 tanh e 1 taking the time derivative of s 1 and substituting 14 yields 17 s 1 i n n l i 3 3 e 2 k 1 e 1 k 2 1 tanh t e 1 tanh e 1 e 1 i n n l i 3 3 r m 1 τ g r μ r m 1 c v v d v v r t μ d δ η d k 1 e 1 k 2 1 tanh t e 1 tanh e 1 e 1 remark 4 the major superiorities of this sms can be summarized as three aspects 1 compared with the centralized formation control strategies he et al 2018 dai et al 2017 2019 jin 2016 distributed algorithms will be synthesized based on this sms since the laplacian matrix applied here will ensure that only the local information is required for each formation member thus the single point failure will be avoided effectively 2 as a matter of fact the sms expressed in eqs 15 16 will render finite time stability for e 1 and e 2 as can be found later these two tracking errors are forced into a residual set once the sms is stabilized 3 observing eq 17 it allows the conclusion that this sms can not only ensure finite time stability but also possess the singularity free property by incorporating the hyperbolic tangent function into the sms based on the sliding mode control approach the control input and adaptive learning law for the ith vehicle can be designed as 18 τ i m i r i 1 k 3 s 1 i k 4 s 1 i s 1 i 2 ε 2 s 1 i d ˆ i 2 s 1 i 2 d ˆ i 2 ε 2 δ i η d k 1 e 1 i k 2 1 tanh t e 1 i tanh e 1 i e 1 i g r i μ i r i m i 1 c i v i v i d i v i v i r i t μ i 19 d ˆ i α s 1 i k 5 d ˆ i where k 3 k 4 k 5 ε α are all positive constants d ˆ i stands for the estimation of d i then the estimation error of d i is defined as d i d i d ˆ i remark 5 it must be noted that the chattering phenomenon will cause much damage to actuators for the purpose of chattering alleviation the term k 4 s 1 i s 1 i 2 ε 2 is developed in 18 to perform the similar function as sign function the term s 1 i d ˆ i 2 s 1 i 2 d ˆ i 2 ε 2 introduced here performs the function of disturbance rejection the parameter ε in eq 18 can be changed by designers to alleviate the chattering and reduce the control precision however these two objectives are always contradictory during the design process the parameter ε must be appropriately selected for satisfactory control performance the value of parameters k 4 k 5 ε designed by designers will influence the convergence rate of sms theorem 1 for the close loop dynamic eq 14 with assumptions 1 3 if the sms is designed as eq 16 and adaptive control laws 18 19 are employed the following conclusions can be achieved 20 k 1 λ min 2 i n n l i 3 3 1 s 1 and adaptive estimation error d i will converge to a tiny region containing the origin in finite time 2 finite time convergence for e 1 is always assured if the following inequality holds proof the lyapunov candidate function lcf is selected as 21 v 1 1 2 s 1 t i n n l i 3 3 1 s 1 1 2 α i 1 n d i 2 then in lights of eq 17 the derivative of v 1 can be written as follows 22 v 1 s 1 t i n n l i 3 3 1 s 1 1 α i 1 n d i d ˆ i s 1 t r m 1 τ g r μ r m 1 c v v d v v r t μ d δ η d k 1 e 1 k 2 1 tanh t e 1 tanh e 1 e 1 1 α i 1 n d i d ˆ i substituting controller 18 and adaptive learning law 19 in to eq 22 it obtains 23 v 1 i 1 n k 3 s 1 i 2 k 4 s 1 i 2 s 1 i 2 ε 2 s 1 i 2 d ˆ i 2 s 1 i 2 d ˆ i 2 ε 2 s 1 i t d i d i s 1 i k 5 d ˆ i for further calculation according to lemma 4 there exists an explicit inequality 24 δ x 2 δ x 2 n 2 δ x n where δ denotes an arbitrary real number x stands for a state variable n means a nonnegative constant thus substituting these results into 24 and applying the fact d i d i one has 25 v 1 i 1 n k 3 s 1 i 2 k 4 s 1 i s 1 i d ˆ i s 1 i d i d i s 1 i k 5 d ˆ i n k 4 1 ε i 1 n k 3 s 1 i 2 k 4 s 1 i k 5 d i d ˆ i n k 4 1 ε i 1 n k 3 s 1 i 2 k 4 s 1 i d i 2 d i 2 k 5 d i d ˆ i n k 4 1 ε furthermore noting that the term d i 2 k 5 d i d ˆ i satisfies the following relation 26 d i 2 k 5 d i d ˆ i d i d ˆ i 2 k 5 d i d ˆ i d ˆ i k 5 1 d ˆ i 2 k 5 2 d i d ˆ i d i 2 k 5 2 d i 2 4 k 5 1 thus the eq 25 can be further rewritten as 27 v 1 i 1 n k 3 s 1 i 2 d i 2 k 5 2 d i 2 4 k 5 1 n k 4 1 ε κ 1 v 1 ρ 1 where κ 1 2 k 3 λ max i n n l i 3 3 1 ρ 1 k 5 2 4 k 5 1 i 1 n d i 2 n k 4 1 ε integrating both sides of eq 27 leads to 28 v 1 v 1 0 exp κ 1 t ρ 1 κ 1 1 exp κ 1 t then it deduces that v 1 is uniformly ultimately bounded then the boundness of d i is guaranteed in the case of d ˆ i 0 there must exist a positive constant satisfying d i d ˆ i and d i d i i e 29 d i d ˆ i d i d ˆ i d i to elaborate the finite time stability of the system the second lcf is chosen as 30 v 2 1 2 s 1 t i n n l i 3 3 1 s 1 1 α i 1 n d i d ˆ i 2 differentiating v 2 along eqs 8 and 17 yields 31 v 2 s 1 t i n n l i 3 3 1 s 1 2 α i 1 n d i d ˆ i d ˆ i s 1 t r m 1 τ g r μ r m 1 c v v d v v r t μ d δ η d k 1 e 1 k 2 1 tanh t e 1 tanh e 1 e 1 2 α i 1 n d i d ˆ i d ˆ i combing control law 18 and adaptive law 19 with eq 31 it obtains 32 v 2 i 1 n k 3 s 1 i 2 k 4 s 1 i 2 s 1 i 2 ε 2 s 1 i 2 d ˆ i 2 s 1 i 2 d ˆ i 2 ε 2 s 1 i t d i 2 d i d ˆ i s 1 i k 5 d ˆ i recalling eq 24 and substituting it into eq 32 it leads to 33 v 2 i 1 n k 3 s 1 i 2 k 4 s 1 i s 1 i d ˆ i k 4 1 ε s 1 i d i 2 s 1 i d i d ˆ i 2 k 5 d i d ˆ i d ˆ i i 1 n k 3 s 1 i 2 k 4 s 1 i s 1 i d i d ˆ i 2 k 5 d i d ˆ i d ˆ i k 4 1 ε furthermore the term 2 k 5 d i d ˆ i d ˆ i can be calculated as follows 34 2 k 5 d i d ˆ i d ˆ i 2 k 5 d ˆ i 2 d i d ˆ i k 5 d i 2 2 with the substitution of this result v 2 is finally derived as 35 v 2 i 1 n k 3 s 1 i 2 k 4 s 1 i s 1 i d i d ˆ i k 5 d i 2 2 k 4 1 ε κ 1 v 2 κ 2 v 2 1 2 ρ 2 where κ 2 k 4 2 λ max i n n l i 3 3 1 1 2 and ρ 2 k 5 2 i 1 n d i 2 n k 4 1 ε according to lemma 2 and eq 33 it follows the conclusion that v 2 will converge to a tiny region containing zero then in view of the definition of v 2 finite time stability of s 1 could be obtained thus far the validity of the first point is illustrated to facilitate the subsequent analysis the convergence region of s 1 is defined as δ 1 based on the above result the convergence region of tracking errors will be demonstrated subsequently the relevant lcf is selected as 36 v 3 1 2 e 1 t e 1 differentiating v 3 with respect to time and using eq 16 yield 37 v 3 e 1 t e 1 e 1 t i n n l i 3 3 1 s 1 k 1 e 1 k 2 tanh e 1 in view of lemma 3 one has 38 k 2 e 1 t tanh e 1 k 2 e 1 3 n k 2 δ consequently eq 37 can be further derived as 39 v 3 λ min i n n l i 3 3 e 1 δ 1 k 1 e 1 2 k 2 e 1 3 n k 2 δ k 1 λ min 2 i n n l i 3 3 e 1 2 k 2 e 1 3 n k 2 δ δ 1 2 4 2 k 1 λ min 2 i n n l i 3 3 v 3 2 k 2 v 3 1 2 3 n k 2 δ δ 1 2 4 according to lemma 2 it shows that v 3 will move into a residual set in finite time once eq 20 is satisfied from the definition of v 3 it concludes that e 1 will also converge into a residual set in finite time at this point the proof of theorem 1 is completed remark 6 the forgoing stability analysis can be divided into three steps initially the asymptotic stability of the sms is presented based on lyapunov directed method subsequently it shows that the sms possesses finite time convergence under control scheme eq 18 eventually the fact that e 1 and e 2 are characterized with finite time stability is elaborated based on the former two steps 3 2 robust anti saturation cooperative controller synthesis in the previous design it is assumed that input saturation is ignored and the usvs models could be exactly acquired however the limit on magnitude on of actuators outputs and unmodeled system dynamics are the main factors that cause performance deterioration for formation systems considering these two problems simultaneously the dynamic of the ith usv in formation is described as 40 η i μ i μ i r i m i 1 h τ i f i η i μ i d i the nonlinear function f i η i μ i is defined as the unknown dynamics which is expressed as 41 f i η i μ i g r i μ i r i m i 1 c i v i v i d i v i v i ρ i r i t μ i by resorting to lemma 1 f i η i μ i is approximated as 42 f i η i μ i w i t h i ο i 0 ο i o i 43 w i t h i w i h i w i h i where h i h i and w i w i here it is the single parameter w i instead of the whole weight matrix w i that will be approximated online in this way low computational complexity is required in the implementation of the controller even when the rbfnn is adopted for the formation system then an auxiliary valuable is introduced into the sms which is expressed as 44 s 2 i e 2 i k 1 e 1 i k 2 tanh e 1 i ξ tanh χ i j 1 n a i j e 2 i e 2 j k 1 e 1 i e 1 j k 2 tanh e 1 i tanh e 1 j ξ tanh χ i ξ tanh χ j where k 1 k 2 ξ are positive parameters the auxiliary valuable χ i is designed as 45 χ i ϕ i 1 ξ ζ tanh χ i r i m i 1 h τ i τ i χ i 0 0 with ζ 0 and ϕ i diag 1 tanh 2 χ i 1 1 tanh 2 χ i 2 1 tanh 2 χ i 3 t remark 7 different from the sms designed as eq 15 an auxiliary valuable is added in eq 44 which considers the input saturation problem the auxiliary system is designed to handle the nonlinearities caused by input saturation constraints with the combination of this auxiliary system anti saturation property is endowed for the formation system remark 8a the anti saturation auxiliary system proposed in esfandiari et al 2014 possesses a certain conservatism i e χ i ζ χ i h τ i τ i is dependent on the boundness of χ i to relax the restriction this paper constructively develops a modify compensation term ξ tanh χ i via hyperbolic tangent function which means that the global boundness of s 2 is guaranteed without any assumption for χ i with the definition of χ χ 1 t χ 2 t χ n t t and using eqs 6 and 7 the sms for usv formation is exhibited as 46 s 2 i n n l i 3 3 e 2 k 1 e 1 k 2 tanh e 1 ξ tanh χ the derivative of s 2 is calculated as 47 s 2 i n n l i 3 3 e 2 k 1 e 1 k 2 1 tanh t e 1 tanh e 1 e 1 ξ ϕ χ i n n l i 3 3 r m 1 h τ f η μ d δ η d k 1 e 1 k 2 1 tanh t e 1 tanh e 1 e 1 ζ tanh χ r m 1 h τ τ i n n l i 3 3 τ f η μ d ζ tanh χ δ η d k 1 e 1 k 2 1 tanh t e 1 tanh e 1 e 1 in order to facilitate the subsequent design a valuable γ i is defined as γ i o i d i ξ and it will be estimated online detailed utilization of this term will be presented in the stability analysis part then the control algorithm and adaptive learning laws are established as 48 τ i k 3 s 2 i k 4 s 2 i s 2 i 2 ε 2 s 2 i γ ˆ i 2 s 2 i 2 γ ˆ i 2 ε 2 s 2 i w ˆ i 2 h i 2 s 2 i 2 w ˆ i 2 h i 2 ε 2 δ i η d k 1 e 1 i k 2 1 tanh t e 1 i tanh e 1 i e 1 i 49 γ ˆ i α s 2 i k 5 γ ˆ i 50 w ˆ i β h i s 2 i k 6 w ˆ i where k 3 k 4 k 5 k 6 ε α β are positive constants remark 8b as stated in remark 4 terms s 2 i n s 2 i 2 ε 2 s 2 i γ ˆ i 2 n s 2 i 2 γ ˆ i 2 ε 2 and s 2 i w ˆ i 2 h i 2 n s 2 i 2 w ˆ i 2 h i 2 ε 2 are constructed for chattering reduction purpose different from the first method the estimated value w ˆ i is developed to realize the online approximation of unknown system dynamics the valuable γ ˆ i stands for the estimation of the lumped uncertainties the implementation of the rbfnn will inevitably bring in approximation errors for the formation system thus for convenience these errors along with the disturbances are tackled together in the anti saturation control scheme the convergence rate of sms will be influenced by the choice of the value of parameters k 4 k 5 k 6 ε theorem 2 considering the system eq 40 under assumptions 1 3 if the sms is selected as eq 44 the controller and adaptive laws are developed as eqs 48 50 the following conclusions will be obtained 51 k 1 λ min 2 i n n l i 3 3 k 2 ξ 1 s 2 and errors γ i w i will move into a small neighbourhood around zero in finite time 2 finite time convergence for e 1 is always assured if the following inequality holds 3 the auxiliary variable χ always remains bounded proof the lcf is chosen as the following equation 52 v 4 1 2 s 2 t i n n l i 3 3 1 s 2 1 2 α i 1 n γ i 2 1 2 β i 1 n w i 2 in view of eq 47 the time derivative of v 4 can be obtained as 53 v 4 s 2 t i n n l i 3 3 1 s 2 1 α i 1 n γ i γ ˆ i 1 β i 1 n w i w ˆ i s 2 t τ f η μ d ζ tanh χ δ η d k 1 e 1 k 2 1 tanh t e 1 tanh e 1 e 1 1 α i 1 n γ i γ ˆ i 1 β i 1 n w i w ˆ i then substituting the control algorithm 48 and adaptive learning laws 49 50 into eq 53 it leads to 54 v 4 i 1 n k 3 s 2 i 2 k 4 s 2 i 2 s 2 i 2 ε 2 s 2 i 2 γ ˆ i 2 s 2 i 2 γ ˆ i 2 ε 2 s 2 i 2 w ˆ i 2 h i 2 s 2 i 2 w ˆ i 2 h i 2 ε 2 s 2 i t f i η i μ i d i ζ tanh χ i γ i s 2 i k 5 γ ˆ i w i h i s 2 i k 6 w ˆ i considering eqs 52 and 24 v 4 is developed as 55 v 4 i 1 n k 3 s 2 i 2 k 4 s 2 i s 2 i γ ˆ i s 2 i w ˆ i h i k 4 2 ε s 2 i w i h i o i s 2 i d i s 2 i ζ γ i s 2 i k 5 γ ˆ i w i h i s 2 i k 6 w ˆ i i 1 n k 3 s 2 i 2 k 4 s 2 i s 2 i γ ˆ i s 2 i w ˆ i h i s 2 i w i h i s 2 i γ i s 2 i γ i k 5 γ i γ ˆ i s 2 i w i h i k 6 w i w ˆ i n k 4 2 ε i 1 n k 3 s 2 i 2 k 4 s 2 i k 5 γ i γ ˆ i k 6 w i w ˆ i n k 4 2 ε furthermore as done previously the following inequalities can be obtained 56 γ i 2 k 5 γ i γ ˆ i k 5 2 γ i 2 4 k 5 1 w i 2 k 6 w i w ˆ i k 6 2 w i 2 4 k 6 1 with the substitution of these results one has 57 v 4 i 1 n k 3 s 1 i 2 γ i 2 w i 2 k 5 2 γ i 2 4 k 5 1 k 6 2 w i 2 4 k 6 1 n k 4 2 ε κ 3 v 4 ρ 3 where κ 3 2 k 3 λ max i n n l i 3 3 1 and ρ 3 n k 4 2 ε k 5 2 4 k 5 1 i 1 n γ i 2 k 6 2 4 k 6 1 i 1 n w i 2 it follows from the same conclusion as eq 27 that asymptotic stability of s 2 γ w is validated similar to the previous expression two unknown upper bounds are introduced as γ i and w i which satisfy 58 γ i γ ˆ i γ i γ ˆ i γ i w i w ˆ i w i w ˆ i w i the modified lcf is chosen as 59 v 5 1 2 s 2 t i n n l i 3 3 1 s 2 1 α i 1 n γ i γ ˆ i 2 1 β i 1 n w i w ˆ i 2 by virtue of eq 47 taking the derivative of v 5 one has 60 v 5 s 2 t i n n l i 3 3 1 s 2 2 α i 1 n γ i γ ˆ i γ ˆ i 2 β i 1 n w i w ˆ i w ˆ i s 2 t τ f η μ d ζ tanh χ δ η d k 1 e 1 k 2 1 tanh t e 1 tanh e 1 e 1 2 α i 1 n γ i γ ˆ i γ ˆ i 2 β i 1 n w i w ˆ i w ˆ i then combing control algorithm and adaptive learning laws eqs 48 50 with eq 60 it obtains 61 v 5 i 1 n k 3 s 2 i 2 k 4 s 2 i 2 s 2 i 2 ε 2 s 2 i 2 γ ˆ i 2 s 2 i 2 γ ˆ i 2 ε 2 s 2 i 2 w ˆ i 2 h i 2 s 2 i 2 w ˆ i 2 h i 2 ε 2 s 2 i t f i η i μ i d i ζ tanh χ i 2 γ i γ ˆ i s 2 i k 5 γ ˆ i 2 w i w ˆ i h i s 2 i k 6 w ˆ i with the consideration of eq 42 eq 61 is calculated as 62 v 5 i 1 n k 3 s 2 i 2 k 4 s 2 i s 2 i γ ˆ i s 2 i w ˆ i h i s 2 i w i h i o i s 2 i d i s 2 i ζ 2 γ i γ ˆ i s 2 i k 5 γ ˆ i 2 w i w ˆ i h i s 2 i k 6 w ˆ i n k 4 2 ε i 1 n k 3 s 2 i 2 k 4 s 2 i s 2 i γ ˆ i s 2 i w ˆ i h i s 2 i w i h i s 2 i γ i 2 s 2 i γ i γ ˆ i 2 k 5 γ i γ ˆ i γ ˆ i 2 s 2 i w i w ˆ i h i 2 k 6 w i w ˆ i w ˆ i n k 4 2 ε i 1 n k 3 s 2 i 2 k 4 s 2 i s 2 i γ i γ ˆ i s 2 i w i w ˆ i h i 2 k 5 γ i γ ˆ i γ ˆ i 2 k 6 w i w ˆ i w ˆ i n k 4 2 ε then in lights of eq 34 the following inequalities can be presented 63 2 k 5 γ i γ ˆ i γ ˆ i k 5 γ i 2 2 2 k 6 w i w ˆ i w ˆ i k 6 w i 2 2 substituting these results into eq 63 v 5 is evolved as 64 v 5 i 1 n k 3 s 2 i 2 k 4 s 2 i s 2 i γ i γ ˆ i s 2 i w i w ˆ i h i k 5 γ i 2 2 k 6 w i 2 2 n k 4 2 ε κ 4 v 5 κ 5 v 5 1 2 ρ 5 where κ 5 min 2 k 4 i n n l i 3 3 α s 1 i min β s 1 i min and ρ 5 k 5 2 i 1 n γ i 2 k 6 2 i 1 n w i 2 n k 4 2 ε according to lemma 2 the finite time convergence of s 2 is ensured so far the first point of theorem 2 is authenticated then the convergence region of s 1 can be defined as δ 2 to illustrate the convergence of tracking errors the lcf is selected as 65 v 6 1 2 e 1 t e 1 its time derivative is calculated as 66 v 6 e 1 t e 1 e 1 t i n n l i 3 3 1 s 1 k 1 e 1 k 2 tanh e 1 ξ tanh χ λ min i n n l i 3 3 e 1 δ 1 k 1 e 1 2 k 2 e 1 3 n k 2 δ ξ e 1 k 1 λ min 2 i n n l i 3 3 e 1 2 k 2 ξ e 1 3 n k 2 δ 2 k 1 λ min 2 i n n l i 3 3 v 6 2 k 2 ξ v 6 1 2 3 n k 2 δ in virtue of lemma 2 and eq 51 the tracking error e 1 will be forced into a tiny region containing the origin within finite time thus the validity of the second point of theorem 2 is illustrated since s 2 γ w e 1 e 2 and the parameters r m 1 are all bounded the control input τ is bounded consequently there exists a nonnegative constant θ satisfying r m 1 h τ τ θ the specific lcf for the auxiliary system is chosen as 67 v 7 1 2 ξ χ t χ taking derivative for v 7 and the utilizing 45 it obtains 68 v 7 ξ χ t χ χ t ϕ 1 ζ tanh χ r m 1 h τ τ from lemma 3 the following relation holds 69 ζ χ t tanh χ ζ χ ζ δ substituting it into eq 68 one further has 70 v 7 ϕ 1 ζ χ ζ δ ϖ χ ζ ϖ ϕ 1 χ ζ δ ϕ 1 thus if χ ζ δ ζ ϖ and ζ ϖ 0 it has v 7 0 in this way χ will hold inside of the compact set χ χ ζ δ ζ ϖ for t 0 thus theorem 2 is fully authenticated remark 9 similar to the previous analysis in section 3 1 three steps are presented here to show the finite time stability of the formation system furthermore eq 70 indicates that the auxiliary valuable χ is always bounded by observing the smc eq 46 it concludes that ξ tanh χ ξ always holds regardless of the value of χ which means the condition of bounded χ is no longer required in this control scheme remark 10 there are many design parameters involving in the controller development which will determine the control performance considerably by trial and error selections of these parameters mainly depend on the control accuracy system response speed and chattering issue k 1 k 2 k 3 and k 4 can determine the control accuracy and convergence rate however these two performance indexes cannot be satisfied simultaneously selections for these four parameters must make a tradeoff between the accuracy and response speed increasing the parameter ζ will strengthen the anti saturation property of the closed loop system tuning the parameter ε can obtain desired control accuracy and reducing chattering α β k 5 and k 6 are parameters to adjust the convergence rate and estimation accuracy of the adaptive laws 4 simulation results in this section simulation examples for system eq 4 are provided to demonstrate the efficiency and validity of the anti saturation controller eq 45 considering that there are three usvs and one virtual leader in the formation the internal communication topology is described via a connected undirected graph as fig 1 c from the aspect of application in ocean engineering it is only the first follower have the sensor to obtain the desired trajectory and formation shape data from the virtual leader in this way the second follower and third follower must be capable of transmitting data to their next nodes and receive information from the prior ones additionally model structure and parameters of the followers are assumed to be the same to facilitate the controller design and numerical simulations in reality this kind of assumption is reasonable the detailed model parameters of the formation members are presented in table 1 which can be found in the reference lu et al 2018a here the standard si units are adopted the length and mass of the formation vehicles are 0 29 m and 23 8 kg according to these two parameters it is deduced that the designed cooperative controller will be implemented on small vehicles according to the design of the formation members propulsion systems the maximum force and moment that can be produced are 150 n and 50 n m thus the designed controller must satisfy these input saturation constraints for surge motion sway motion and yaw motion in ocean environment msvs will suffer from waves winds and currents which makes it difficult to obtain the accurate model information to this end the term ρ i denoted as the total unmodeled dynamics is given as ρ i u 0 0279 u i v i 0 0342 v i 2 r i ρ i v 0 0912 u i 2 v i ρ i r 0 0156 u i r i 2 0 0278 u i v i 3 r i including the virtual leader the initial state vectors of msvs are presented as η 0 0 0 10 0 t η 1 0 4 15 π 3 t η 2 0 5 21 π 2 t η 3 0 3 0 π 2 t μ 1 0 μ 2 0 μ 3 0 0 0 0 t the prescribed configurations of formation are given as δ 1 2 0 0 t δ 2 0 2 0 t and δ 3 0 2 0 t respectively it implies that the formation finally forms a standard shape of an isosceles right triangle to simplify matter the reference trajectory of virtual leader is predefined as a straight line parallel to x axis to achieve better illustration of the proposed method s efficiency three simulation examples are employed here specifically three types of external disturbances are imposed on the formation system to show the influence of different current and wave conditions the time varying environmental disturbances are set as follows case 1 d i 2 cos 0 5 t cos t 0 3 cos 0 5 t sin 0 5 t 3 0 01 sin 0 1 t 0 6 sin 1 1 t cos 0 3 t if t 40 s 0 0 0 t t 40 s case 2 d i 0 3 cos 0 1 t sin 0 1 t 0 5 1 2 sin 0 3 t t t 40 s 3 cos 0 1 t cos t 0 3 cos 0 1 t sin 0 1 t 3 sin 0 1 t 1 2 cos 0 3 t 40 s t 70 s 5 sin 0 1 t 5 cos 0 1 t 5 2 sin 1 1 t cos 0 3 t 2 4 cos 0 3 t t if t 70 s case 3 d i 0 3 cos 0 1 t sin 0 1 t 0 5 1 2 sin 0 3 t t t 40 s 8 cos 0 1 t cos t 8 cos 0 1 t sin 0 1 t 8 4 sin 0 1 t 4 cos 0 3 t 40 s t 70 s 10 sin 0 1 t 10 cos 0 1 t 10 8 sin 1 1 t coscos 0 3 t 8 coscos 0 3 t t if t 70 s for the purpose of testifying the proposal s robustness against uncertainties and input saturation the neural network based formation control scheme eqs 48 50 is imposed in the subsequent simulation experiments according to theorem 2 all the usvs in formation will follow the virtual leader along the prescribed shape for satisfactory control performance design parameters are chosen as k 1 1 k 2 1 k 3 0 1 k 4 5 k 5 1 k 6 1 α 0 01 β 0 001 ε 0 25 ξ 10 ζ 2 the number of neurons is 15 inputs of the neural network is placed in 1 3 1 3 1 3 1 3 and the parameter of the gaussian function is selected as σ i 2 for brevity only the position tracking errors velocity tracking errors and control torques of case 2 and case 3 are depicted here the detailed results of the numerical simulation are shown in figs 2 14 fig 2 shows the cooperated trajectory of the usv formation in the two dimensional plane in which three followers have the capability to complete the trajectory tracking missions while maintaining an isosceles triangle formation more specific results are provided in figs 3 8 the curves of tracking errors of each usv in formation are given in figs 3 4 as shown in these two figures the trajectory and velocity tracking errors converge to the origin within 10s even though it suffers from the system uncertainties and input saturations constraints secondly the control input signals are illustrated in fig 5 obviously the bounded control torques will move into a tiny region once the tracking mission is fulfilled thirdly the adaptive estimations for d and γ are described in figs 6 7 in which these estimations are guaranteed to be bounded under the proposed controller finally the auxiliary valuables are elaborated in fig 13 the boundness of χ i implies that the nonlinearity caused by input saturation is surmounted by the designed controller these pictures illustrate that the cooperative tracking and formation maintaining purposes are achieved simultaneously in spite of the occurrence of input saturation constraints observing from figs 3 figs 9 and 12 one can find that the proposal possesses satisfied tracking performance under different disturbances additionally it also implies that followers in the formation could move as expected even when the waves currents and winds tend to be large figs 5 figs 11 and 14 present the control torques and moments under different disturbances obviously outputs of the controller will change to adapt to different environment thus maintaining excellent robustness and formation performance 5 conclusions this paper constructs two finite time cooperative formation control strategies for multiple usvs with unknown dynamics and input saturations by virtue of the sliding mode control method based on mlp algorithm the uncertainties of model dynamics can be approximated on line and the designed controller occupies less computational resource additionally different from the existing anti saturation solutions an auxiliary system is introduced into the sliding mode control scheme to address nonlinearities arising from input saturation constraints thus the presented scheme has strong robustness against input saturations in practical application the proposed methods are validated via the theoretical analysis and simulation results though effective the proposed cooperative controller still possesses the following limitations i it is only the numerical simulations rather than the real experiments that are conducted in this paper in the future works the developed control scheme will be implemented on small msvs designed by our laboratory ii transient performance and reliability of the formation system are not fully considered in this paper with the simultaneous consideration of input saturation transient performance and actuator faults a fault tolerant prescribed performance formation controller will be designed in our future work credit authorship contribution statement bing huang conceptualization methodology software validation formal analysis writing original draft shuo song data curation investigation cheng zhu supervision methodology jun li supervision investigation bin zhou ajay kumar software validation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was co supported by the fundamental research funds for the central universities gk2010260307 gk2010260338 science and technology on underwater vehicle laboratory under grant 6217905300000870562 and jckys2020sxjqr 03 the china postdoctoral science foundation funded project no 2020m681081 the postdoctoral science foundation funded project of heilongjiang province no lbh z20130 
20637,this paper investigates the finite time distributed formation control for unmanned surface vessels usvs exposed to external disturbances model uncertainties and input saturation constraints by combing the sliding mode control method and adaptive algorithms two control architectures are developed for usvs formation control problem radial basis function neural networks rbfnns is adopted for approximating the unavailable system dynamics where the minimum learning parameter mlp algorithm is utilized to alleviate the excessive occupation of the computational resource by feat of an auxiliary system an adaptive mechanism is devised such that the input saturation problem could be figured out it follows from the theoretical analysis that finite time convergence is achievable under the proposed two controllers finally numerical simulations are exhibited to illustrate the effectiveness of the proposed formation control schemes keywords unmanned surface vessels formation control input saturation sliding mode control minimum learning parameter 1 introduction for the indispensable role in numerous military and commercial activities including marine resources prospecting and development reconnaissance and surveillance and marine mapping zhang et al 2020 zheng et al 2020 wang et al 2020a qin et al 2020 etc the formation of usvs has been an attractive topic in marine engineering compared with a monolithic surface vessel the potential advantages such as better disturbance rejection properties great adaptability and feasibility fewer mission costs and high reliability are the prominent reason to apply the formation configuration for usvs xiao et al 2016 owing to this practical and theoretical significance the design of control schemes deserves a great interest for improving the accuracy and robustness of formation systems thus far in order to get desirable control performance numerous results have been proposed in the formation scenarios involving backstepping approaches wang et al 2020a finite time control strategies fu and lingling 2018 and neural network methods lu et al 2018a etc in fact although there are fruitful results on formation control of usvs developing controllers with less dependence on model information still possess a significant challenge the strong coupling of nonlinear systems and disturbances caused by the complicated external environment make it impossible to obtain accurate model information for designers owing to the prominent superiority the backstepping methods are widely applied in the trajectory tracking tasks of marine vehicles when the system suffers from unknown nonlinear dynamics and disturbances xie et al 2020 wen et al 2019 in xie et al 2020 and wen et al 2019 backstepping methods in connection with a state observer and the optimization control method were adopted to perform tracking missions for autonomous underwater vehicles and usvs respectively though effective these two controllers are only applicable for a single vehicle considering the formation control problem a leader following architecture were utilized such that all of the followers could track the trajectory of the leader in the consideration of unmodeled system dynamics lu et al 2020a prescribed performance constraints he et al 2018 dai et al 2017 2019 zhang and yang 2018 and line of sight range constraints jin 2016 ghommam and saad 2017 by resorting to the mlp algorithm based nonlinear disturbance observer the followers could track the leader with a predefined geometrical shape even when the velocities of the leader remained unavailable to followers lu et al 2018b obviously these formation controllers are synthesized under the centralized control strategy which means all of the formation members require precise information from the leader however this limitation results in the leader follower based controllers vulnerable to single point failure problem thus leading to undesirable effect to the formation missions taking the foregoing drawback of the leader following controllers into account the interaction topology was introduced in the cooperative formation control schemes fu and lingling 2018 lu et al 2018a where the leader s information is just available to a subset of the followers on account of the satisfactory estimation property the neural networks nns were employed to construct leaderless and leader follower cooperative formation control strategies by inclusion of backstepping technique and graph theory peng et al 2013 in this way by means of estimating the weight matrix online the unmodeled system dynamics could be approximated online simultaneously although effective for uncertainties as the number of the formation member increases the computational complexity will become the main obstacle for the formation system to this end the mlp algorithm was introduced for the usvs cooperative control such that the amount of computation can be cut down fu and lingling 2018 totally different from the solutions in fu and lingling 2018 lu et al 2018a peng et al 2013 two updating laws including composite iterative and direct iterative updating laws were proposed to solve the cooperative dynamic positioning problem for multiple usvs in a time varying formation configuration liu et al 2015 nevertheless it must be pointed out that these foregoing cooperative controllers are developed for fully actuated surface vessels in practice attributing to the dynamic nature or physical constraint the tracking control systems may become underactuated lying in this fact input output linearization technique was used to guarantee desired geometric shapes and bounded tracking errors for multiple underactuated surface vessels xie et al 2018 for the purpose of not only guaranteeing system stability but also considering transient performance prescribed performance control methods have been applied for the formation issue of usvs in yoo and park 2017 prescribed performance will be ensured for the containment problem of a group of underactuated surface vessels furthermore an error transformation method was utilized to further solve the predefined performance constraint and endow the formation system with the ability of collision avoidance and connectivity preserving park and yoo 2018 in many practical applications due to the physical limitations on hardware and energy consumption the actuators with constrained outputs always exist with which performance deterioration or even system instability will occur attributing to the deviation between the desired input signals and the actual outputs of actuators guo et al 2019 in this context various attempts in the development of anti saturation controllers for both single and multiple surface vessel systems can be founded in fu and lingling 2018 deng et al 2020 shen et al 2020 zhu et al 2020 qin et al 2020 wang et al 2014 and references therein particularly a coordinate transformation was introduced in deng et al 2020 to not only release the requirement of an off diagonal inertia matrix but also obtain a saturation free control scheme based on the fuzzy logic systems besides for the ability of strong robustness against uncertainties recursive sliding mode method was employed in shen et al 2020 then in order to reduce the effect of magnitude limit on actuators outputs a saturation compensational term was designed in the tracking controller with the combination of dynamic surface approach unlike the literatures mentioned above through the error transformation method and dynamic auxiliary system both state constraints and input saturation constraints could be tackled in zhu et al 2020 in contrast to the method proposed in zhu et al 2020 barrier lyapunov function was applied to solve the full state constraints for surface vessels in qin et al 2020 as for multiple surface vessels formation missions cooperative path following problem and distributed formation task were considered in wang et al 2014 and fu and lingling 2018 respectively a bearing based adaptive neural formation scaling control scheme was developed for a group of autonomous surface vehicles with uncertainties and input saturation lu et al 2020b however observing the existing methods for multiple surface vessels it shows that finite time anti saturation control architectures with less computational complexity have been rarely investigated this paper is motivated by the above analysis and discussion which mainly concentrates on providing a finite time solution to the problem of formation control of usvs subject to external disturbance model uncertainties and input saturation constraints firstly a basic robust controller is developed for cooperative formation control problem with the combination of sliding mode method and adaptive algorithms then through an auxiliary system with bounded compensation terms an adaptive mechanism is devised in the second controller such that the input saturation problem could be figured out the major superiorities of the developed controllers are summarized as follows i in contrast with the solutions for input saturation in wang et al 2014 esfandiari et al 2014 an auxiliary system is introduced into the sliding mode control scheme to compensate for the input saturation constraints in addition the auxiliary valuables are bounded under the proposed control scheme thus compensating for the saturation constraints with satisfactory performance ii different form previous works lu et al 2018a 2020b finite time convergence is endowed to the formation system with uncertainties in this paper such that fast system response will be achieved particularly unlike the finite time solution in fu and lingling 2018 by virtue of the mlp based online estimation algorithm the accurate model information of usvs is not required to derive the saturation free cooperative controller thus the study on finite time anti saturation control architectures for usvs can be enriched and the designed controller is more practical for formation issues in ocean engineering the remainder of this paper is presented as follows in section 2 corresponding preliminaries of this paper are presented section 3 illustrates the design of formation controllers in section 4 numerical simulations are presented to verify the effectiveness of the proposed methods finally the conclusion of this paper can be derived in section 5 2 preliminaries 2 1 dynamics of usvs in this brief we consider that the trajectory of the formation system is defined in a horizontal plane the control objective of cooperative formation for usvs in this paper could be divided into two points tracking the trajectory of the virtual leader and maintaining a predefined formation shape two coordinates are defined in to describe the ith usv s motion i e the earth fixed coordinate o e x e y e and the body fixed coordinate o b x b y b the geometric description for the formation problem could be presented as fig 1 a for a network containing n usvs the numerical dynamics of the ith vehicle under these two coordinates is described as 1 η i r ψ i v i m i v i c i v i v i d i v i v i ρ i h τ i m i r t ψ i d i where η i x i y i ψ i t is composed of the position vector x i y i and heading angle ψ i of the vessel in the earth fixed coordinate frame efcf v i u i v i r i t is composed of the corresponding linear velocity u i v i and angular velocity r i in the body fixed coordinate frame bfcf r ψ i denotes the rotation matrix from bfcf to efcf m i is the inertia matrix of the ith vehicle c i v i and d i v i represent coriolis matrix and hydrodynamic damping matrix respectively d i v i is always symmetric and positive definite ρ i ρ i u ρ i v ρ i r t denotes the unmodeled system dynamics caused by unknown parameter variations from the real application aspect the model information of the msv cannot be accurately accessible to the designers and ρ i remains unknown in the controller design process it should be noted that η i is defined in the efcf while v i is defined in bfcf to facilitate the design transformation matrix r ψ i is applied to transform the linear velocity and angular velocity from bfcf to efcf the inertia matrix m i is mainly decided by the usv s mass in engineering implementation m i is a time varying valuable and it cannot be always accurately known to designers implying that unknown system dynamics will be caused by this uncertain information c i v i v i and d i v i v i mainly decide the nonlinear part of the usv model from the aspect of real applications these two matrixes always possess much uncertainties the detailed expression of these model parameters are given as 2 r ψ i cos ψ i sin ψ i 0 sin ψ i cos ψ i 0 0 0 1 m i m 11 m 12 m 13 m 21 m 22 m 23 m 31 m 32 m 33 ℝ 3 3 c i v i c 11 c 12 c 13 c 21 c 22 c 23 c 31 c 32 c 33 ℝ 3 3 d i v i d 11 d 12 d 13 d 21 d 22 d 23 d 31 d 32 d 33 ℝ 3 3 in 1 the vector d i d u i d v i d r i t denotes the bounded external disturbance caused by unknown winds waves and ocean currents for convenience d i represents the lumped disturbance τ i τ u i τ v i τ r i t denotes the desired control input of the close loop system τ u i τ v i and τ r i are surge force sway force and yaw moment produced by the propulsion system composed by main propellers aft and thrusters h τ i h τ u i h τ v i h τ r i t denotes the input nonlinearity induced by actuator saturation whose expression is shown as 3 h τ sat τ sign τ h m τ h m τ τ h m where h m is the upper bound of h τ the notation sign means the sign function remark 1 from a practical point of view the marine environment is complicated and unpredictable the time varying disturbances d t can hardly be accurately observed in real time on the other hand coriolis matrix c v and hydrodynamic damping matrix d v show strong nonlinearity owing to the complex hydrodynamics consequently it s necessary to design formation controllers with strong robustness against these perturbations remark 2 in the engineering applications owing to the physical limitations and energy consumption the input saturation will exist and lead to deviations between the desired input signals and the actual control input in the occurrence of this constraints system performance deterioration will inevitably happen in the existing literatures wang et al 2020b lu et al 2018a this topic was rarely discussed for formation usvs to relax the restriction this paper constructs an auxiliary system to address the input saturation problem subsequently by defining μ i η i and using the property r i t r i i the transformed dynamics of usvs can be obtained as 4 η i μ i μ i r i m i 1 h τ i g r i μ i r i m i 1 c i v i v i d i v i v i ρ i r i t μ i d i with g r i 0 r i 0 r i 0 0 0 0 0 this paper aims to force all of the formation members to track the virtual leader η d t while maintaining prescribed geometrical shapes in order to derive the tracking errors the relative formation shape δ i r 3 is introduced then the tracking errors are written as 5 e 1 i η i δ i η d e 2 i η i δ i η d this paper is dedicating to developing controllers for formation system eq 1 such that tracking errors e 1 i and e 2 i are characterized with finite time convergence understanding this control objective from physical meaning implies that the following vehicles in the formation will track the desired trajectory and maintain a preset geometry formation shape in finite time in order to establish the dynamics of overall formation system the following vectors are defined 6 η η 1 t η 2 t η n t t v v 1 t v 2 t v n t t μ μ 1 t μ 2 t μ n t t d d 1 t d 2 t d n t t h τ h t τ 1 h t τ 2 h t τ n t e 1 e 11 t e 12 t e 1 n t t e 2 e 21 t e 22 t e 2 n t t τ τ 1 t τ 2 t τ n t t δ δ 1 t δ 2 t δ n t t η d η d t η d t η d t t ρ ρ 1 t ρ 2 t ρ n t furthermore for convenience some diagonal matrixes are defined as follows 7 m 1 diag m 1 1 m 2 1 m n 1 t g r diag g r 1 g r 2 g r n t r diag r 1 r 2 r n t c v diag c 1 v 1 c 2 v 2 c n v n t d v diag d 1 v 1 d 2 v 2 d n v n t then the formation system for multiple usvs could be described as 8 η μ μ r m 1 h τ g r μ r m 1 c v v d v v ρ r t μ d 2 2 basic graph theory this paper employs the undirected connected graph to describe the communication topology of formation members the graph is denoted as g ν ζ a in which the node set ν ν 1 ν 2 ν n represents all usvs in the formation the edge set ζ n n represents the communication paths among usvs a a i j ℝ n n is the weighted adjacency matrix the element a i j satisfies a i j 0 when v i v j ζ and a i j 0 otherwise generally it is assumed that each node does not exchange information with itself i e a i j 0 i j for any undirected graph a is a symmetric matrix with a i j a j i furthermore if all the nodes are connected as a whole by paths it is called that the undirected graph is connected the laplace matrix l of the graph g is introduced as l d a where d diag j 1 n a 1 j j 1 n a 2 j j 1 n a n j 2 3 function approximation based on rbfnn radial basis function neural network rbfnn possess a satisfactory property in approximating nonlinear functions with arbitrary precision thus it will be introduced here to estimate unmodeled system dynamics for the formation system previous to the main result of this paper the following lemma of rbfnn is given lemma 1 fu and lingling 2018 suppose f x as an unknown smooth nonlinear function there exists a weight vector w satisfying the following equation 9 f x w t h x ο 0 ο o where w w 1 w 2 w p t and x x 1 x 2 x m denote the weight vector and the input vector respectively p and m are numbers of nodes and inputs o and o represent the approximation error and its upper bound h x h 1 x h 2 x t stands for the gaussian basis function vector whose definition is given as 10 h i x exp x c i 2 2 2 b i 2 i 1 p where c i r m and b i r are the central vector and the width of gaussian basis function respectively 2 4 math preliminaries for a vector a r n a denotes its euclidean norm for a matrix a a is the induced norm of this matrix if a is a positive matrix λ max a and λ min a stand for the maximum and minimum eigenvalue of matrix a the notation denotes the kronecker product tanh a is defined as tanh a tanh a 1 tanh a 2 tanh a n t lemma 2 yu et al 2018 for a lyapunov function v satisfying the following equation finite time stability for v is achievable and it will move into a residual set 11 v ι v κ v α ϖ where 0 α 1 ι 0 κ 0 ϖ 0 lemma 3 xie et al 2020 for any scalar x r the hyperbolic tangent function possesses the following property 12 0 x x tanh μ x δ μ with the constants satisfying μ 0 and δ 0 2785 lemma 4 qinglei et al 2019 for any positive constants α and β there always exists the following relation 13 0 α α 2 α 2 β 2 α α 2 α β β 2 5 assumptions assumption 1 the communication topology of the formation system is an undirected connected graph the reference trajectory η d t of virtual leader is available by exchanging information among formation vehicles assumption 2 the reference trajectory η d t of the virtual leader is second order differentiable and η d η d η d are all bounded assumption 3 the lumped disturbance d i possess an unknown upper bound i e d i d i with d i denoting a positive constant remark 3 in practical engineering the value of reference trajectory η d t is determined by the designers thus η d t can be second order differentiable and the parameters η d η d η d all have bounds in assumption 2 attributing to the fact that disturbances are caused by winds waves and ocean currents it is necessary to assumpe the external disturbances being bounded unknown and time varing it can be found the assumption 3 always exists for formation control problems 3 controllers design in this section the finite time cooperative formation control problem for multiple usvs is addressed by resorting to the sliding mode control approach mlp algorithm and an auxiliary system firstly a basic adaptive control architecture is exploited when the unmodeled system dynamics and magnitude limits on the outputs of actuators are ignored then these two issues will be handled in the second controller more specifically rbfnn based mlp algorithm is employed to approximate the unknown dynamics with low complexity and an auxiliary system is proposed for the compensation of input saturation constraints eventually finite time convergence of the proposed controllers is theoretically demonstrated by lyapunov based analysis in order to show the control algorithm more intuitively the schematic diagram is presented in fig 1 b 3 1 finite time cooperative controller synthesis without the consideration of unmodeled system dynamics and input saturation constraints mathematic model of the ith vessel in formation is written as 14 η i μ i μ i r i m i 1 τ i g r i μ i r i m i 1 c i v i v i d i v i v i r i t μ i d i based on the tracking errors defined in eq 5 a sliding mode surface sms for the ith vehicle is formulated as 15 s 1 i e 2 i k 1 e 1 i k 2 tanh e 1 i j 1 n a i j e 2 i e 2 j k 1 e 1 i e 1 j k 2 tanh e 1 i tanh e 1 j where k 1 k 2 are both positive parameters and a i j is the element of weight weighted adjacency matrix a by resorting to the definitions 6 7 and the laplace matrix l eq 15 is rewritten as 16 s 1 i n n l i 3 3 e 2 k 1 e 1 k 2 tanh e 1 taking the time derivative of s 1 and substituting 14 yields 17 s 1 i n n l i 3 3 e 2 k 1 e 1 k 2 1 tanh t e 1 tanh e 1 e 1 i n n l i 3 3 r m 1 τ g r μ r m 1 c v v d v v r t μ d δ η d k 1 e 1 k 2 1 tanh t e 1 tanh e 1 e 1 remark 4 the major superiorities of this sms can be summarized as three aspects 1 compared with the centralized formation control strategies he et al 2018 dai et al 2017 2019 jin 2016 distributed algorithms will be synthesized based on this sms since the laplacian matrix applied here will ensure that only the local information is required for each formation member thus the single point failure will be avoided effectively 2 as a matter of fact the sms expressed in eqs 15 16 will render finite time stability for e 1 and e 2 as can be found later these two tracking errors are forced into a residual set once the sms is stabilized 3 observing eq 17 it allows the conclusion that this sms can not only ensure finite time stability but also possess the singularity free property by incorporating the hyperbolic tangent function into the sms based on the sliding mode control approach the control input and adaptive learning law for the ith vehicle can be designed as 18 τ i m i r i 1 k 3 s 1 i k 4 s 1 i s 1 i 2 ε 2 s 1 i d ˆ i 2 s 1 i 2 d ˆ i 2 ε 2 δ i η d k 1 e 1 i k 2 1 tanh t e 1 i tanh e 1 i e 1 i g r i μ i r i m i 1 c i v i v i d i v i v i r i t μ i 19 d ˆ i α s 1 i k 5 d ˆ i where k 3 k 4 k 5 ε α are all positive constants d ˆ i stands for the estimation of d i then the estimation error of d i is defined as d i d i d ˆ i remark 5 it must be noted that the chattering phenomenon will cause much damage to actuators for the purpose of chattering alleviation the term k 4 s 1 i s 1 i 2 ε 2 is developed in 18 to perform the similar function as sign function the term s 1 i d ˆ i 2 s 1 i 2 d ˆ i 2 ε 2 introduced here performs the function of disturbance rejection the parameter ε in eq 18 can be changed by designers to alleviate the chattering and reduce the control precision however these two objectives are always contradictory during the design process the parameter ε must be appropriately selected for satisfactory control performance the value of parameters k 4 k 5 ε designed by designers will influence the convergence rate of sms theorem 1 for the close loop dynamic eq 14 with assumptions 1 3 if the sms is designed as eq 16 and adaptive control laws 18 19 are employed the following conclusions can be achieved 20 k 1 λ min 2 i n n l i 3 3 1 s 1 and adaptive estimation error d i will converge to a tiny region containing the origin in finite time 2 finite time convergence for e 1 is always assured if the following inequality holds proof the lyapunov candidate function lcf is selected as 21 v 1 1 2 s 1 t i n n l i 3 3 1 s 1 1 2 α i 1 n d i 2 then in lights of eq 17 the derivative of v 1 can be written as follows 22 v 1 s 1 t i n n l i 3 3 1 s 1 1 α i 1 n d i d ˆ i s 1 t r m 1 τ g r μ r m 1 c v v d v v r t μ d δ η d k 1 e 1 k 2 1 tanh t e 1 tanh e 1 e 1 1 α i 1 n d i d ˆ i substituting controller 18 and adaptive learning law 19 in to eq 22 it obtains 23 v 1 i 1 n k 3 s 1 i 2 k 4 s 1 i 2 s 1 i 2 ε 2 s 1 i 2 d ˆ i 2 s 1 i 2 d ˆ i 2 ε 2 s 1 i t d i d i s 1 i k 5 d ˆ i for further calculation according to lemma 4 there exists an explicit inequality 24 δ x 2 δ x 2 n 2 δ x n where δ denotes an arbitrary real number x stands for a state variable n means a nonnegative constant thus substituting these results into 24 and applying the fact d i d i one has 25 v 1 i 1 n k 3 s 1 i 2 k 4 s 1 i s 1 i d ˆ i s 1 i d i d i s 1 i k 5 d ˆ i n k 4 1 ε i 1 n k 3 s 1 i 2 k 4 s 1 i k 5 d i d ˆ i n k 4 1 ε i 1 n k 3 s 1 i 2 k 4 s 1 i d i 2 d i 2 k 5 d i d ˆ i n k 4 1 ε furthermore noting that the term d i 2 k 5 d i d ˆ i satisfies the following relation 26 d i 2 k 5 d i d ˆ i d i d ˆ i 2 k 5 d i d ˆ i d ˆ i k 5 1 d ˆ i 2 k 5 2 d i d ˆ i d i 2 k 5 2 d i 2 4 k 5 1 thus the eq 25 can be further rewritten as 27 v 1 i 1 n k 3 s 1 i 2 d i 2 k 5 2 d i 2 4 k 5 1 n k 4 1 ε κ 1 v 1 ρ 1 where κ 1 2 k 3 λ max i n n l i 3 3 1 ρ 1 k 5 2 4 k 5 1 i 1 n d i 2 n k 4 1 ε integrating both sides of eq 27 leads to 28 v 1 v 1 0 exp κ 1 t ρ 1 κ 1 1 exp κ 1 t then it deduces that v 1 is uniformly ultimately bounded then the boundness of d i is guaranteed in the case of d ˆ i 0 there must exist a positive constant satisfying d i d ˆ i and d i d i i e 29 d i d ˆ i d i d ˆ i d i to elaborate the finite time stability of the system the second lcf is chosen as 30 v 2 1 2 s 1 t i n n l i 3 3 1 s 1 1 α i 1 n d i d ˆ i 2 differentiating v 2 along eqs 8 and 17 yields 31 v 2 s 1 t i n n l i 3 3 1 s 1 2 α i 1 n d i d ˆ i d ˆ i s 1 t r m 1 τ g r μ r m 1 c v v d v v r t μ d δ η d k 1 e 1 k 2 1 tanh t e 1 tanh e 1 e 1 2 α i 1 n d i d ˆ i d ˆ i combing control law 18 and adaptive law 19 with eq 31 it obtains 32 v 2 i 1 n k 3 s 1 i 2 k 4 s 1 i 2 s 1 i 2 ε 2 s 1 i 2 d ˆ i 2 s 1 i 2 d ˆ i 2 ε 2 s 1 i t d i 2 d i d ˆ i s 1 i k 5 d ˆ i recalling eq 24 and substituting it into eq 32 it leads to 33 v 2 i 1 n k 3 s 1 i 2 k 4 s 1 i s 1 i d ˆ i k 4 1 ε s 1 i d i 2 s 1 i d i d ˆ i 2 k 5 d i d ˆ i d ˆ i i 1 n k 3 s 1 i 2 k 4 s 1 i s 1 i d i d ˆ i 2 k 5 d i d ˆ i d ˆ i k 4 1 ε furthermore the term 2 k 5 d i d ˆ i d ˆ i can be calculated as follows 34 2 k 5 d i d ˆ i d ˆ i 2 k 5 d ˆ i 2 d i d ˆ i k 5 d i 2 2 with the substitution of this result v 2 is finally derived as 35 v 2 i 1 n k 3 s 1 i 2 k 4 s 1 i s 1 i d i d ˆ i k 5 d i 2 2 k 4 1 ε κ 1 v 2 κ 2 v 2 1 2 ρ 2 where κ 2 k 4 2 λ max i n n l i 3 3 1 1 2 and ρ 2 k 5 2 i 1 n d i 2 n k 4 1 ε according to lemma 2 and eq 33 it follows the conclusion that v 2 will converge to a tiny region containing zero then in view of the definition of v 2 finite time stability of s 1 could be obtained thus far the validity of the first point is illustrated to facilitate the subsequent analysis the convergence region of s 1 is defined as δ 1 based on the above result the convergence region of tracking errors will be demonstrated subsequently the relevant lcf is selected as 36 v 3 1 2 e 1 t e 1 differentiating v 3 with respect to time and using eq 16 yield 37 v 3 e 1 t e 1 e 1 t i n n l i 3 3 1 s 1 k 1 e 1 k 2 tanh e 1 in view of lemma 3 one has 38 k 2 e 1 t tanh e 1 k 2 e 1 3 n k 2 δ consequently eq 37 can be further derived as 39 v 3 λ min i n n l i 3 3 e 1 δ 1 k 1 e 1 2 k 2 e 1 3 n k 2 δ k 1 λ min 2 i n n l i 3 3 e 1 2 k 2 e 1 3 n k 2 δ δ 1 2 4 2 k 1 λ min 2 i n n l i 3 3 v 3 2 k 2 v 3 1 2 3 n k 2 δ δ 1 2 4 according to lemma 2 it shows that v 3 will move into a residual set in finite time once eq 20 is satisfied from the definition of v 3 it concludes that e 1 will also converge into a residual set in finite time at this point the proof of theorem 1 is completed remark 6 the forgoing stability analysis can be divided into three steps initially the asymptotic stability of the sms is presented based on lyapunov directed method subsequently it shows that the sms possesses finite time convergence under control scheme eq 18 eventually the fact that e 1 and e 2 are characterized with finite time stability is elaborated based on the former two steps 3 2 robust anti saturation cooperative controller synthesis in the previous design it is assumed that input saturation is ignored and the usvs models could be exactly acquired however the limit on magnitude on of actuators outputs and unmodeled system dynamics are the main factors that cause performance deterioration for formation systems considering these two problems simultaneously the dynamic of the ith usv in formation is described as 40 η i μ i μ i r i m i 1 h τ i f i η i μ i d i the nonlinear function f i η i μ i is defined as the unknown dynamics which is expressed as 41 f i η i μ i g r i μ i r i m i 1 c i v i v i d i v i v i ρ i r i t μ i by resorting to lemma 1 f i η i μ i is approximated as 42 f i η i μ i w i t h i ο i 0 ο i o i 43 w i t h i w i h i w i h i where h i h i and w i w i here it is the single parameter w i instead of the whole weight matrix w i that will be approximated online in this way low computational complexity is required in the implementation of the controller even when the rbfnn is adopted for the formation system then an auxiliary valuable is introduced into the sms which is expressed as 44 s 2 i e 2 i k 1 e 1 i k 2 tanh e 1 i ξ tanh χ i j 1 n a i j e 2 i e 2 j k 1 e 1 i e 1 j k 2 tanh e 1 i tanh e 1 j ξ tanh χ i ξ tanh χ j where k 1 k 2 ξ are positive parameters the auxiliary valuable χ i is designed as 45 χ i ϕ i 1 ξ ζ tanh χ i r i m i 1 h τ i τ i χ i 0 0 with ζ 0 and ϕ i diag 1 tanh 2 χ i 1 1 tanh 2 χ i 2 1 tanh 2 χ i 3 t remark 7 different from the sms designed as eq 15 an auxiliary valuable is added in eq 44 which considers the input saturation problem the auxiliary system is designed to handle the nonlinearities caused by input saturation constraints with the combination of this auxiliary system anti saturation property is endowed for the formation system remark 8a the anti saturation auxiliary system proposed in esfandiari et al 2014 possesses a certain conservatism i e χ i ζ χ i h τ i τ i is dependent on the boundness of χ i to relax the restriction this paper constructively develops a modify compensation term ξ tanh χ i via hyperbolic tangent function which means that the global boundness of s 2 is guaranteed without any assumption for χ i with the definition of χ χ 1 t χ 2 t χ n t t and using eqs 6 and 7 the sms for usv formation is exhibited as 46 s 2 i n n l i 3 3 e 2 k 1 e 1 k 2 tanh e 1 ξ tanh χ the derivative of s 2 is calculated as 47 s 2 i n n l i 3 3 e 2 k 1 e 1 k 2 1 tanh t e 1 tanh e 1 e 1 ξ ϕ χ i n n l i 3 3 r m 1 h τ f η μ d δ η d k 1 e 1 k 2 1 tanh t e 1 tanh e 1 e 1 ζ tanh χ r m 1 h τ τ i n n l i 3 3 τ f η μ d ζ tanh χ δ η d k 1 e 1 k 2 1 tanh t e 1 tanh e 1 e 1 in order to facilitate the subsequent design a valuable γ i is defined as γ i o i d i ξ and it will be estimated online detailed utilization of this term will be presented in the stability analysis part then the control algorithm and adaptive learning laws are established as 48 τ i k 3 s 2 i k 4 s 2 i s 2 i 2 ε 2 s 2 i γ ˆ i 2 s 2 i 2 γ ˆ i 2 ε 2 s 2 i w ˆ i 2 h i 2 s 2 i 2 w ˆ i 2 h i 2 ε 2 δ i η d k 1 e 1 i k 2 1 tanh t e 1 i tanh e 1 i e 1 i 49 γ ˆ i α s 2 i k 5 γ ˆ i 50 w ˆ i β h i s 2 i k 6 w ˆ i where k 3 k 4 k 5 k 6 ε α β are positive constants remark 8b as stated in remark 4 terms s 2 i n s 2 i 2 ε 2 s 2 i γ ˆ i 2 n s 2 i 2 γ ˆ i 2 ε 2 and s 2 i w ˆ i 2 h i 2 n s 2 i 2 w ˆ i 2 h i 2 ε 2 are constructed for chattering reduction purpose different from the first method the estimated value w ˆ i is developed to realize the online approximation of unknown system dynamics the valuable γ ˆ i stands for the estimation of the lumped uncertainties the implementation of the rbfnn will inevitably bring in approximation errors for the formation system thus for convenience these errors along with the disturbances are tackled together in the anti saturation control scheme the convergence rate of sms will be influenced by the choice of the value of parameters k 4 k 5 k 6 ε theorem 2 considering the system eq 40 under assumptions 1 3 if the sms is selected as eq 44 the controller and adaptive laws are developed as eqs 48 50 the following conclusions will be obtained 51 k 1 λ min 2 i n n l i 3 3 k 2 ξ 1 s 2 and errors γ i w i will move into a small neighbourhood around zero in finite time 2 finite time convergence for e 1 is always assured if the following inequality holds 3 the auxiliary variable χ always remains bounded proof the lcf is chosen as the following equation 52 v 4 1 2 s 2 t i n n l i 3 3 1 s 2 1 2 α i 1 n γ i 2 1 2 β i 1 n w i 2 in view of eq 47 the time derivative of v 4 can be obtained as 53 v 4 s 2 t i n n l i 3 3 1 s 2 1 α i 1 n γ i γ ˆ i 1 β i 1 n w i w ˆ i s 2 t τ f η μ d ζ tanh χ δ η d k 1 e 1 k 2 1 tanh t e 1 tanh e 1 e 1 1 α i 1 n γ i γ ˆ i 1 β i 1 n w i w ˆ i then substituting the control algorithm 48 and adaptive learning laws 49 50 into eq 53 it leads to 54 v 4 i 1 n k 3 s 2 i 2 k 4 s 2 i 2 s 2 i 2 ε 2 s 2 i 2 γ ˆ i 2 s 2 i 2 γ ˆ i 2 ε 2 s 2 i 2 w ˆ i 2 h i 2 s 2 i 2 w ˆ i 2 h i 2 ε 2 s 2 i t f i η i μ i d i ζ tanh χ i γ i s 2 i k 5 γ ˆ i w i h i s 2 i k 6 w ˆ i considering eqs 52 and 24 v 4 is developed as 55 v 4 i 1 n k 3 s 2 i 2 k 4 s 2 i s 2 i γ ˆ i s 2 i w ˆ i h i k 4 2 ε s 2 i w i h i o i s 2 i d i s 2 i ζ γ i s 2 i k 5 γ ˆ i w i h i s 2 i k 6 w ˆ i i 1 n k 3 s 2 i 2 k 4 s 2 i s 2 i γ ˆ i s 2 i w ˆ i h i s 2 i w i h i s 2 i γ i s 2 i γ i k 5 γ i γ ˆ i s 2 i w i h i k 6 w i w ˆ i n k 4 2 ε i 1 n k 3 s 2 i 2 k 4 s 2 i k 5 γ i γ ˆ i k 6 w i w ˆ i n k 4 2 ε furthermore as done previously the following inequalities can be obtained 56 γ i 2 k 5 γ i γ ˆ i k 5 2 γ i 2 4 k 5 1 w i 2 k 6 w i w ˆ i k 6 2 w i 2 4 k 6 1 with the substitution of these results one has 57 v 4 i 1 n k 3 s 1 i 2 γ i 2 w i 2 k 5 2 γ i 2 4 k 5 1 k 6 2 w i 2 4 k 6 1 n k 4 2 ε κ 3 v 4 ρ 3 where κ 3 2 k 3 λ max i n n l i 3 3 1 and ρ 3 n k 4 2 ε k 5 2 4 k 5 1 i 1 n γ i 2 k 6 2 4 k 6 1 i 1 n w i 2 it follows from the same conclusion as eq 27 that asymptotic stability of s 2 γ w is validated similar to the previous expression two unknown upper bounds are introduced as γ i and w i which satisfy 58 γ i γ ˆ i γ i γ ˆ i γ i w i w ˆ i w i w ˆ i w i the modified lcf is chosen as 59 v 5 1 2 s 2 t i n n l i 3 3 1 s 2 1 α i 1 n γ i γ ˆ i 2 1 β i 1 n w i w ˆ i 2 by virtue of eq 47 taking the derivative of v 5 one has 60 v 5 s 2 t i n n l i 3 3 1 s 2 2 α i 1 n γ i γ ˆ i γ ˆ i 2 β i 1 n w i w ˆ i w ˆ i s 2 t τ f η μ d ζ tanh χ δ η d k 1 e 1 k 2 1 tanh t e 1 tanh e 1 e 1 2 α i 1 n γ i γ ˆ i γ ˆ i 2 β i 1 n w i w ˆ i w ˆ i then combing control algorithm and adaptive learning laws eqs 48 50 with eq 60 it obtains 61 v 5 i 1 n k 3 s 2 i 2 k 4 s 2 i 2 s 2 i 2 ε 2 s 2 i 2 γ ˆ i 2 s 2 i 2 γ ˆ i 2 ε 2 s 2 i 2 w ˆ i 2 h i 2 s 2 i 2 w ˆ i 2 h i 2 ε 2 s 2 i t f i η i μ i d i ζ tanh χ i 2 γ i γ ˆ i s 2 i k 5 γ ˆ i 2 w i w ˆ i h i s 2 i k 6 w ˆ i with the consideration of eq 42 eq 61 is calculated as 62 v 5 i 1 n k 3 s 2 i 2 k 4 s 2 i s 2 i γ ˆ i s 2 i w ˆ i h i s 2 i w i h i o i s 2 i d i s 2 i ζ 2 γ i γ ˆ i s 2 i k 5 γ ˆ i 2 w i w ˆ i h i s 2 i k 6 w ˆ i n k 4 2 ε i 1 n k 3 s 2 i 2 k 4 s 2 i s 2 i γ ˆ i s 2 i w ˆ i h i s 2 i w i h i s 2 i γ i 2 s 2 i γ i γ ˆ i 2 k 5 γ i γ ˆ i γ ˆ i 2 s 2 i w i w ˆ i h i 2 k 6 w i w ˆ i w ˆ i n k 4 2 ε i 1 n k 3 s 2 i 2 k 4 s 2 i s 2 i γ i γ ˆ i s 2 i w i w ˆ i h i 2 k 5 γ i γ ˆ i γ ˆ i 2 k 6 w i w ˆ i w ˆ i n k 4 2 ε then in lights of eq 34 the following inequalities can be presented 63 2 k 5 γ i γ ˆ i γ ˆ i k 5 γ i 2 2 2 k 6 w i w ˆ i w ˆ i k 6 w i 2 2 substituting these results into eq 63 v 5 is evolved as 64 v 5 i 1 n k 3 s 2 i 2 k 4 s 2 i s 2 i γ i γ ˆ i s 2 i w i w ˆ i h i k 5 γ i 2 2 k 6 w i 2 2 n k 4 2 ε κ 4 v 5 κ 5 v 5 1 2 ρ 5 where κ 5 min 2 k 4 i n n l i 3 3 α s 1 i min β s 1 i min and ρ 5 k 5 2 i 1 n γ i 2 k 6 2 i 1 n w i 2 n k 4 2 ε according to lemma 2 the finite time convergence of s 2 is ensured so far the first point of theorem 2 is authenticated then the convergence region of s 1 can be defined as δ 2 to illustrate the convergence of tracking errors the lcf is selected as 65 v 6 1 2 e 1 t e 1 its time derivative is calculated as 66 v 6 e 1 t e 1 e 1 t i n n l i 3 3 1 s 1 k 1 e 1 k 2 tanh e 1 ξ tanh χ λ min i n n l i 3 3 e 1 δ 1 k 1 e 1 2 k 2 e 1 3 n k 2 δ ξ e 1 k 1 λ min 2 i n n l i 3 3 e 1 2 k 2 ξ e 1 3 n k 2 δ 2 k 1 λ min 2 i n n l i 3 3 v 6 2 k 2 ξ v 6 1 2 3 n k 2 δ in virtue of lemma 2 and eq 51 the tracking error e 1 will be forced into a tiny region containing the origin within finite time thus the validity of the second point of theorem 2 is illustrated since s 2 γ w e 1 e 2 and the parameters r m 1 are all bounded the control input τ is bounded consequently there exists a nonnegative constant θ satisfying r m 1 h τ τ θ the specific lcf for the auxiliary system is chosen as 67 v 7 1 2 ξ χ t χ taking derivative for v 7 and the utilizing 45 it obtains 68 v 7 ξ χ t χ χ t ϕ 1 ζ tanh χ r m 1 h τ τ from lemma 3 the following relation holds 69 ζ χ t tanh χ ζ χ ζ δ substituting it into eq 68 one further has 70 v 7 ϕ 1 ζ χ ζ δ ϖ χ ζ ϖ ϕ 1 χ ζ δ ϕ 1 thus if χ ζ δ ζ ϖ and ζ ϖ 0 it has v 7 0 in this way χ will hold inside of the compact set χ χ ζ δ ζ ϖ for t 0 thus theorem 2 is fully authenticated remark 9 similar to the previous analysis in section 3 1 three steps are presented here to show the finite time stability of the formation system furthermore eq 70 indicates that the auxiliary valuable χ is always bounded by observing the smc eq 46 it concludes that ξ tanh χ ξ always holds regardless of the value of χ which means the condition of bounded χ is no longer required in this control scheme remark 10 there are many design parameters involving in the controller development which will determine the control performance considerably by trial and error selections of these parameters mainly depend on the control accuracy system response speed and chattering issue k 1 k 2 k 3 and k 4 can determine the control accuracy and convergence rate however these two performance indexes cannot be satisfied simultaneously selections for these four parameters must make a tradeoff between the accuracy and response speed increasing the parameter ζ will strengthen the anti saturation property of the closed loop system tuning the parameter ε can obtain desired control accuracy and reducing chattering α β k 5 and k 6 are parameters to adjust the convergence rate and estimation accuracy of the adaptive laws 4 simulation results in this section simulation examples for system eq 4 are provided to demonstrate the efficiency and validity of the anti saturation controller eq 45 considering that there are three usvs and one virtual leader in the formation the internal communication topology is described via a connected undirected graph as fig 1 c from the aspect of application in ocean engineering it is only the first follower have the sensor to obtain the desired trajectory and formation shape data from the virtual leader in this way the second follower and third follower must be capable of transmitting data to their next nodes and receive information from the prior ones additionally model structure and parameters of the followers are assumed to be the same to facilitate the controller design and numerical simulations in reality this kind of assumption is reasonable the detailed model parameters of the formation members are presented in table 1 which can be found in the reference lu et al 2018a here the standard si units are adopted the length and mass of the formation vehicles are 0 29 m and 23 8 kg according to these two parameters it is deduced that the designed cooperative controller will be implemented on small vehicles according to the design of the formation members propulsion systems the maximum force and moment that can be produced are 150 n and 50 n m thus the designed controller must satisfy these input saturation constraints for surge motion sway motion and yaw motion in ocean environment msvs will suffer from waves winds and currents which makes it difficult to obtain the accurate model information to this end the term ρ i denoted as the total unmodeled dynamics is given as ρ i u 0 0279 u i v i 0 0342 v i 2 r i ρ i v 0 0912 u i 2 v i ρ i r 0 0156 u i r i 2 0 0278 u i v i 3 r i including the virtual leader the initial state vectors of msvs are presented as η 0 0 0 10 0 t η 1 0 4 15 π 3 t η 2 0 5 21 π 2 t η 3 0 3 0 π 2 t μ 1 0 μ 2 0 μ 3 0 0 0 0 t the prescribed configurations of formation are given as δ 1 2 0 0 t δ 2 0 2 0 t and δ 3 0 2 0 t respectively it implies that the formation finally forms a standard shape of an isosceles right triangle to simplify matter the reference trajectory of virtual leader is predefined as a straight line parallel to x axis to achieve better illustration of the proposed method s efficiency three simulation examples are employed here specifically three types of external disturbances are imposed on the formation system to show the influence of different current and wave conditions the time varying environmental disturbances are set as follows case 1 d i 2 cos 0 5 t cos t 0 3 cos 0 5 t sin 0 5 t 3 0 01 sin 0 1 t 0 6 sin 1 1 t cos 0 3 t if t 40 s 0 0 0 t t 40 s case 2 d i 0 3 cos 0 1 t sin 0 1 t 0 5 1 2 sin 0 3 t t t 40 s 3 cos 0 1 t cos t 0 3 cos 0 1 t sin 0 1 t 3 sin 0 1 t 1 2 cos 0 3 t 40 s t 70 s 5 sin 0 1 t 5 cos 0 1 t 5 2 sin 1 1 t cos 0 3 t 2 4 cos 0 3 t t if t 70 s case 3 d i 0 3 cos 0 1 t sin 0 1 t 0 5 1 2 sin 0 3 t t t 40 s 8 cos 0 1 t cos t 8 cos 0 1 t sin 0 1 t 8 4 sin 0 1 t 4 cos 0 3 t 40 s t 70 s 10 sin 0 1 t 10 cos 0 1 t 10 8 sin 1 1 t coscos 0 3 t 8 coscos 0 3 t t if t 70 s for the purpose of testifying the proposal s robustness against uncertainties and input saturation the neural network based formation control scheme eqs 48 50 is imposed in the subsequent simulation experiments according to theorem 2 all the usvs in formation will follow the virtual leader along the prescribed shape for satisfactory control performance design parameters are chosen as k 1 1 k 2 1 k 3 0 1 k 4 5 k 5 1 k 6 1 α 0 01 β 0 001 ε 0 25 ξ 10 ζ 2 the number of neurons is 15 inputs of the neural network is placed in 1 3 1 3 1 3 1 3 and the parameter of the gaussian function is selected as σ i 2 for brevity only the position tracking errors velocity tracking errors and control torques of case 2 and case 3 are depicted here the detailed results of the numerical simulation are shown in figs 2 14 fig 2 shows the cooperated trajectory of the usv formation in the two dimensional plane in which three followers have the capability to complete the trajectory tracking missions while maintaining an isosceles triangle formation more specific results are provided in figs 3 8 the curves of tracking errors of each usv in formation are given in figs 3 4 as shown in these two figures the trajectory and velocity tracking errors converge to the origin within 10s even though it suffers from the system uncertainties and input saturations constraints secondly the control input signals are illustrated in fig 5 obviously the bounded control torques will move into a tiny region once the tracking mission is fulfilled thirdly the adaptive estimations for d and γ are described in figs 6 7 in which these estimations are guaranteed to be bounded under the proposed controller finally the auxiliary valuables are elaborated in fig 13 the boundness of χ i implies that the nonlinearity caused by input saturation is surmounted by the designed controller these pictures illustrate that the cooperative tracking and formation maintaining purposes are achieved simultaneously in spite of the occurrence of input saturation constraints observing from figs 3 figs 9 and 12 one can find that the proposal possesses satisfied tracking performance under different disturbances additionally it also implies that followers in the formation could move as expected even when the waves currents and winds tend to be large figs 5 figs 11 and 14 present the control torques and moments under different disturbances obviously outputs of the controller will change to adapt to different environment thus maintaining excellent robustness and formation performance 5 conclusions this paper constructs two finite time cooperative formation control strategies for multiple usvs with unknown dynamics and input saturations by virtue of the sliding mode control method based on mlp algorithm the uncertainties of model dynamics can be approximated on line and the designed controller occupies less computational resource additionally different from the existing anti saturation solutions an auxiliary system is introduced into the sliding mode control scheme to address nonlinearities arising from input saturation constraints thus the presented scheme has strong robustness against input saturations in practical application the proposed methods are validated via the theoretical analysis and simulation results though effective the proposed cooperative controller still possesses the following limitations i it is only the numerical simulations rather than the real experiments that are conducted in this paper in the future works the developed control scheme will be implemented on small msvs designed by our laboratory ii transient performance and reliability of the formation system are not fully considered in this paper with the simultaneous consideration of input saturation transient performance and actuator faults a fault tolerant prescribed performance formation controller will be designed in our future work credit authorship contribution statement bing huang conceptualization methodology software validation formal analysis writing original draft shuo song data curation investigation cheng zhu supervision methodology jun li supervision investigation bin zhou ajay kumar software validation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was co supported by the fundamental research funds for the central universities gk2010260307 gk2010260338 science and technology on underwater vehicle laboratory under grant 6217905300000870562 and jckys2020sxjqr 03 the china postdoctoral science foundation funded project no 2020m681081 the postdoctoral science foundation funded project of heilongjiang province no lbh z20130 
20638,with the advances in available brute force computing power parallel computations overset grid technology and meta modeling will eventually open a path to the widespread application of full scale computations this study presents a computational fluid dynamics cfd prediction of a full scale ship parametric roll in a regular head wave an in house unsteady reynolds averaged navier stokes urans cfd code was used for the simulations the onr tumblehome surface combatant was selected as the research object and the full scale ship was studied under the same conditions as the model tests comparisons between the cfd results and model test results from the reference show good agreement and validate that the code could capture the details of parametric roll phenomenon in head waves the full scale predictions were compared with the model scale results to assess the scale effect of the parametric roll the induced force and moment acting on the hull under the parametric roll were analyzed simulations for ships with bilge keels were also performed at model and full scale to evaluate the effect of bilge keels numerical results demonstrate that the in house urans code could be used to predict the parametric roll characteristics for a full scale ship at the design stage in the future keywords full scale cfd parametric roll head wave urans solver 1 introduction the parametric roll phenomenon is one of the five dynamic stability failure modes in the second generation intact stability criteria proposed by the international maritime organization imo the parametric roll phenomenon has been investigated since the 1930s paulling and rosenberg 1959 attempted to develop a method for predicting the parametric roll in regular waves by solving the mathieu equation however the research has been regarded as of theoretical interest and few practical studies were conducted since the turn of the 21st century the parametric roll phenomenon has received extensive attention in 1998 the apl china container ship sailing from taiwan to seattle experienced parametric roll resonance and more than 60 of the cargo was lost or damaged van laarhoven 2009 such accidents have led the imo to reconsider the drawback of the first generation intact stability criteria and propose second generation intact stability criteria including parametric roll self riding and broaching pure loss of stability dead ship condition and excessive acceleration imo 2015 in the imo sdc 4th conference attention was focused on methods for the direct assessment of the five dynamic stability failure modes imo 2017a a direct stability assessment can consider all relevant physics in the most accurate way allowing us to address unconventional ship designs thus it was demonstrated that the establishment of a direct assessment method for predicting the dynamic stability failure modes was necessary to study the vulnerability of different ships in recent years many studies have been carried out on the prediction of the parametric roll phenomenon evaluating the potential danger for ships francescutto 2001 conducted a study on the possibility of parametric roll for a forward ship in head wave conditions by experiments the experimental results showed good agreement with the theoretical results by mathieu equation spanos and papanikolaou 2009 presented a benchmark study for the prediction of a ship s parametric roll to assess the performance of 14 different numerical methods a containership was investigated with roll heave pitch motions in regular group and irregular waves sadat hosseini et al 2010 studied parametric roll for the onr tumblehome surface combatant using computational fluid dynamics cfd experimental fluid dynamics efd and nonlinear dynamics approach the cfd results showed agreement with the efd data for the parametric roll in head waves but they showed larger instability zones at high and low froude numbers fn zhou et al 2015 and zhou 2019 conducted a hybrid method in which roll damping was obtained by using a three dimensional 3d cfd approach and the potential theory method was applied to predict the parametric roll characteristics the hybrid method requires fewer computational resources compared to direct cfd methods schumacher et al 2016 conducted a set of scaled model experiments to investigate the occurrence of parametric roll for a containership in different wave conditions results from a nonlinear time domain model were compared with the experimental data lu et al 2016 studied the correlation between the parametric roll and added resistance the results showed that the added resistance increases with the amplitude of the parametric roll liu and papanikolaou 2016 applied a 3d nonlinear time domain method using the impulse response function to investigate the parametric roll of a containership ma et al 2018 studied the parametric roll of a containership in regular waves with the model tests and numerical predictions it was found that the numerical results provide good predictions for the parametric roll sakai et al 2019 verified the encounter frequency assumption on the draught of the second check for the parametric roll bu et al 2019 studied the parametric roll using a coupled three degree of freedom 3dof model based on a 3d mixed source method the results showed that the effects of radiation and diffraction forces on righting arm variation are nonlinearly related to heeling angles and wave amplitudes somayajula et al 2019 presented a method to assess the vulnerability of a ship s parametric roll in a realistic random seaway the stochastic averaging technique was applied to provide an effective estimate of ship stability yu et al 2019 conducted parametric roll prediction for a containership applying a 5dof nonlinear time domain model the results showed that the amplitudes of parametric roll are influenced by the roll damping acanfora et al 2020 applied a 6dof blended nonlinear model to generate the roll motions from irregular waves in the time domain the results showed that the resonance period in an irregular wave is ruled by the roll amplitude in a manner similar to that in a regular wave during the literature review it is noted that most of the abovementioned studies for the parametric roll were conducted at the model scale to the best of our knowledge scale effect is a well researched topic in ship hydrodynamics because the complete hydrodynamic similarity between model and full scale ship cannot be achieved it was indicated that the flow characteristics at model and full scale show obvious differences hochkirch and mallol 2013 for the simulation based design projects full scale analyses are thus advisable to properly evaluate the potential danger for a full scale ship caused by parametric roll performance under different wave conditions it is critical to predict the parametric roll of a full scale ship at the design stage therefore the main aim of this study is to evaluate the parametric roll for a full scale ship directly which can avoid the scale effects as computational facilities become more powerful and accessible full scale cfd simulations are gaining attentions which can allow the prediction of full scale ship performance directly different cfd methods have been used in full scale modeling of ship hydrodynamic characteristics including reynolds averaged navier stokes rans method detached eddy simulation des and large eddy simulation les compared with those other simulation methods the rans method reduces the required resolution in time and space showing the advent of high efficiency computing helma et al 2018 furthermore the rans method has been used commonly for the full scale simulation with great accuracy to predict ship hydrodynamic performance including resistance farkas et al 2018 haase et al 2016 niklas and pruszko 2019b pereira et al 2017 self propulsion castro et al 2011 farkas et al 2018 jasak et al 2019 mikkelsen and walther 2020 and seakeeping performance niklas and pruszko 2019a tezdogan et al 2015 2016 tezdogan et al 2015 carried out a rans prediction for a full scale containership at service and slow steaming speeds to predict the motions and added resistance tezdogan et al 2016 applied a commercial rans solver to study the vertical motions of a full scale tanker in shallow water niklas and pruszko 2019a performed cfd predictions for the seakeeping performance of a full scale ship these results were compared with the available experimental data and showed good agreement based on the abovementioned studies it is of great importance to perform an analysis at full scale furthermore it has been validated that the rans method can be used as an efficient tool for full scale prediction therefore an in house urans code hust ship was applied to the simulation for ship s parametric roll phenomenon at full scale and the onr tumblehome was regarded as the object in this study the rigorous verification and validation studies including the comparison with model test results were carried out to validate the numerical method a 1 46 6 scaled model was also considered as the cfd prediction object based on the insean captive model tests sadat hosseini 2009 comparisons between the model and full scale results were performed to analyze the scale effect the remainder of this paper is structured as follows section 2 describes numerical theories relevant to hust ship the study object used in the numerical simulations is presented in section 3 with the description of the computational domain and grid generation section 4 presents the results of model scale simulations using hust ship including verification and validation studies with the analyses of correlations between the motions and forces in section 5 full scale simulations of parametric roll are performed differences between the model and full scale results are identified and discussed including ship motions forces and moments numerical simulations were also conducted for a full scale ship with bilge keels finally section 6 presents the conclusions 2 computational method in this study cfd predictions are performed using hust ship an in house urans code for ship hydrodynamics in the urans approach the conservation equations are solved in the liquid phase defined as follows 1 ρ t ρ u i x i 0 2 u i t u i u j x j 1 ρ p x i 1 ρ x j μ u i x j ρ u i u j where u i and u i i 1 2 3 are the time averaged and fluctuation components of velocities respectively ρ is the density p is the time averaged pressure μ is the dynamic viscosity and ρ u i u j is the reynolds stress term the shear stress transport sst k ω turbulence model a two equation eddy viscosity model proposed by menter 1994 is used for the closure of governing equations this turbulence model has been proven to be capable of solving the adverse pressure gradients and separating flow with the reasonable solution for the near wall region it was shown that the difference between the numerical results and sea trial measurements for the sst k ω model was less than that for the k ε model when predicting the force and moment of a full scale ship pena et al 2020 the wake field and boundary layer were also captured better when using the sst k ω model than using the k ε model the roll damping at full scale which is of importance for the parametric roll prediction was predicted accurately by the rans method with sst k ω model irkal et al 2019 irkal et al 2019 also concluded that the les simulation method shows no advantage when compared with rans method for the roll damping prediction furthermore this model has been validated in ma et al 2018 and sadat hosseini et al 2010 in which the model scale parametric roll was predicted satisfactorily therefore the sst k ω turbulence model is applied in this study for the simulation of the parametric roll of full scale ship this cfd code uses the finite difference method to discretize the difference form of the governing equations with the structured body fitted curvilinear grid the 2nd order difference scheme is used for spatial and temporal discretization a projection algorithm is applied to solve velocity pressure coupling both absolute inertial earth fixed and relative non inertial ship fixed coordinate systems are used in this code as shown in fig 1 positive x y and z represent the downstream starboard and upward directions respectively ship motions are estimated in an earth fixed coordinate system a ship fixed coordinate system is attached to the center of gravity of the ship with the movements following ship motions this code is capable of simulating ship motion with large amplitude by using a multiblock structured grid with a dynamic overset approach rigid body motion equations can be solved the ship grid moves with the predicted motions and a dynamic overset approach is used to update the relative location between the computational domain and the ship the level set method is used to capture the free surface in which the positive function is defined as the water phase linear regular wave velocity components can be defined in the computational domain to generate a corresponding regular wave for the regular head wave the velocity components in the x direction and z direction are defined as follows 3 u 2 π a f e k z cos k x 2 π f t ϕ 4 w 2 π a f e k z sin k x 2 π f t ϕ where a is the wave amplitude k is the wave number f is the wave frequency and ϕ is the initial phase a damping zone is created at the end of the computational domain where a damping modification is applied to the momentum equations aimed at preventing the reflection from the exit boundary the overall solution flowchart for the hust ship is presented in fig 2 the parallel computation technique is applied and the overset grid system is read with the decomposition the discretized governing equations are then solved with turbulence model the free surface can be simulated and the velocity field is obtained implicitly the coupling field of the pressure and velocity is then obtained by using the projection algorithm based on the flow field computation the force and moment acting on the ship are integrated the convergence is then evaluated as the convergence of the solution is achieved the grid is moved following the ship motions which are predicted by the 6dof motion solver once the time step is finished the next time step is then started finally the whole solution is finished as the stable results can be obtained a more detailed description of the hust ship can be found in zhang et al 2020 wang et al 2020 and feng et al 2020 full scale and model scale cfd predictions of ship parametric roll were carried out using the tianhe 2 supercomputer at the national supercomputer center in guangzhou the supercomputer includes 17 920 processors intel xeon e5 2692 v2 processor for the parametric roll simulation in the head wave the calculation speed increases linearly with the increase in the number of processors used 3 geometry and numerical modeling 3 1 onr tumblehome the onr tumblehome is considered as the simulation object which is a preliminary design of a modern concept surface combatant the parametric roll phenomenon of the full scale ship is predicted using the cfd approach experimental data from insean captive tests sadat hosseini 2009 is used for the validation and the tested model is a 1 46 6 scaled model a numerical simulation of the 1 46 6 scaled model is performed and the results are compared with those from full scale simulations in this cfd prediction the ship model is appended with a skeg but the superstructure is not attached taking precedence from the experiment fig 3 shows the 3d geometry and table 1 presents the main parameters for the model scale and full scale ship which are all set to be the same as those of the model tests 3 2 simulation condition during the cfd predictions of the parametric roll phenomenon in regular head waves at model and full scale 3dof semi captive conditions free to roll heave and pitch and constrained in surge sway and yaw are considered head wave simulations are carried out in a wave with wave amplitude a l pp 0 0183 and wavelength λ l pp 1 following insean captive tests sadat hosseini 2009 in which evident parametric roll occurred in the model tests typical parameters of the simulation conditions are shown in table 2 where u is the ship advancing speed fn is the froude number u g l p p re is the reynolds number u l p p ν ν is the kinematic viscosity of the fluid and f e is the encounter frequency which is defined as follows 5 f e f 2 π f 2 g u 3 3 grid generation and computational domain in the cfd predictions the computational domain grid and ship grid are generated independently and then an in house overset grid program hust overset is used for the composition to generate a numerical overset grid system which is beneficial for simulations of ship motions with large amplitudes the computational domain is shown in fig 4 and the boundary conditions are presented in detail the computational domain extends over the ranges of l pp x 3l pp l pp y l pp and l pp z 0 4 l pp the ship length is aligned with the x axis where the ship bow is set at x 0 with the stern at x l pp the initial water surface lies at z 0 the cartesian grid in the computational domain is refined near the water surface including 50 grid points per wavelength and 20 grid points in the range of wave height the refinements are provided around the ship bow and stern where flow features of interest are expected the wave velocity components eqs 3 and 4 are defined at the inlet of the domain to generate the incident head wave the pressure outlet boundary condition is imposed on the exit of the domain where the grid along the x axis is coarsened and the damping zone is generated in the range of 2 4l pp x 3l pp zero pressure is imposed on the bottom and a zero pressure gradient is imposed on the top and two sides the quality of wave elevation λ l pp 1 a l pp 0 0183 simulated in this computational domain without ship model is first validated a fixed wave probe at a position 0 5l pp from the inlet boundary is used to monitor the wave elevation varying with time fig 5 shows a comparison of wave elevation time histories from cfd and theory in which the variables are nondimensional it can be observed that the cfd results are consistent with the theoretical results for the ship grid a body fitted structured grid is generated to accurately capture the geometric features the o o topology is adopted as shown in fig 6 the grid spacing of the model inside the boundary layer is determined based on the nondimensional wall distance y which is defined as follows 6 y ρ u μ y where ρ is the density u is the friction velocity y is the wall normal coordinate and μ is the dynamic viscosity during the model scale simulation the sst k ω turbulence model is used to resolve the flow in the near wall region therefore the y 1 is used to generated the boundary layer grid with the expansion ratio around 1 2 which is recommended by ittc 2014 the spacing δs of the first grid point from the wall is assumed as follows 7 δ s y l p p r e c f 2 where c f is the friction coefficient which can be computed by the 1957 ittc formulation ittc 2014 following eq 7 the δs is set to be 10 5 m to yield y 1 for the case with the highest re fig 7 shows the y distribution on the hull obtained from the model scale simulation where the average y value is approximately 0 6 during the full scale simulation a wall function model is used to treat near wall flow solutions owing to the thin sublayer ittc 2014 recommends that the first grid point from the wall is well within the logarithmic layer of the boundary layer when using the wall function model following eq 7 the δs is set to be 4 10 4 m to yield 30 y 100 and the boundary layer grid is generated normally with the expansion ratio around 1 2 fig 8 shows the y distribution on the hull obtained from the full scale simulation where the average y value is approximately 70 the hust overset program is applied to generate an overset region between the computational domain and ship hull the overset grid system of the numerical model is shown in fig 9 the systematic grid convergence studies are described in section 4 2 and 5 1 3 4 choice of the time step for the unsteady rans simulations the time step is determined by the flow properties tezdogan et al 2016 it is recommended that at least 100 time steps per period are used for the periodic phenomena such as the incoming waves ittc 2014 in this study the wavelength λ is constant to be l pp and the encounter period decreases with the ship speed therefore the time step is calculated as t min 124 where the t min is the minimum encounter period corresponding to the highest speed case fn 0 25 for the model and full scale simulations the time step is chosen as 0 0072s and 0 0496s respectively the systematic time step convergence studies are described in section 4 2 and 5 1 4 model scale simulations the following section describes the results of the model scale simulations using hust ship the simulation results and experimental data from insean are compared the forces and moments acting on the model at different forward speeds are obtained and different components are analyzed 4 1 influence of the initial roll angle first the influence of initial roll angle on the parametric roll is studied simulations are conducted for three different given roll angles of 5 10 and 30 as shown in fig 10 the results indicate that the initial roll angle causes no effect for the amplitude and period of ship parametric roll at the steady stage which is consistent with the conclusion from zhang et al 2019 sadat hosseini 2009 also performed parametric roll tests with the model fixed at 30 initial roll angle therefore the numerical simulations are all conducted for the ship model at a given initial roll angle of 30 to realize the more rapid occurrence of the parametric roll phenomenon in this way the stage of parametric roll development is not concerned 4 2 verification and validation a systematic verification and validation study for the parametric roll of a model scale ship with a forward speed fn 0 20 was conducted to quantify the uncertainties in the cfd simulations the same wave condition was used in the simulations as in the model tests λ l pp 1 a l pp 0 0183 it is assumed that the numerical uncertainty u sn consists of the grid uncertainty u g time step uncertainty u t and iterative uncertainty u i which can be defined as stern et al 2001 8 u s n 2 u g 2 u t 2 u i 2 according to previous studies castiglione et al 2011 tezdogan et al 2015 the iterative uncertainty u i is negligible when compared with the grid and time step uncertainties therefore grid and time step convergence studies were performed to estimate the uncertainties the american society of mechanical engineers 2009 determined that a verification study requires a minimum of three solutions to evaluate the convergence behavior with respect to the input parameter based on this procedure three grids were considered which were refined by a constant ratio r g 2 corresponding to coarse 2 80 million grid points medium 4 41 million grid points and fine 9 34 million grid points the results of the parametric roll amplitude simulated by coarse medium and fine grids were denoted as s gc s gm and s gf respectively and are summarized in table 3 three time steps were refined by a ratio r t 2 for coarse 0 0144 s medium 0 0072 s and fine 0 0036 s the results of the parametric roll amplitude simulated by coarse medium and fine time steps were denoted as s tc s tm and s tf respectively and are summarized in table 4 in the verification study the convergence factor r could be estimated first as 9 r s f s m s m s c where s f s m and s c represent the fine medium and coarse results from the numerical simulation respectively it was found that the convergence factors for both the grid r g and time step r t studies are in the range of 0 1 indicating that monotonic convergence is achieved stern et al 2001 as a result uncertainties from the grid and time step could be calculated following the factors of the safety method for richardson extrapolation xing and stern 2010 as shown in table 5 where p g and p t are the distance metrics of the grid and time step respectively for the validation procedure the validation uncertainty u v should be compared with the comparison error e between the numerical result and benchmark experimental data the validation uncertainty u v consists of the numerical uncertainty u sn and experimental uncertainty u d where u d is obtained from the reference sadat hosseini 2009 the values from the validation study are summarized in table 6 the results show that the comparison error e of the parametric roll amplitude is lower than the validation uncertainty u v which indicates that the validation of model scale simulation is successful at the u v level model scale simulations were also conducted for different forward speeds fn 0 10 0 25 under the same wave conditions λ l pp 1 a l pp 0 0183 the time histories of ship motions including heave roll and pitch motions are shown in fig 11 an obvious parametric roll occurs at different forward speeds which is consistent with the phenomenon in the model tests the time history of the parametric roll shows a regular pattern and the amplitude decreases with the increase in ship speed the maximum steady roll amplitude was predicted at fn 0 10 for heave motion the steady amplitude shows an increasing trend with the increase in fn the results of pitch amplitude indicate an increasing trend for 0 10 fn 0 20 and shows a decreasing trend for 0 20 fn 0 25 to capture the characteristics of ship motions in the frequency domain time histories could be approximated by fourier series expansions as given by 10 ξ t ξ 0 n 1 n ξ n cos 2 π f n t ϕ n where ξ n represents the nth order harmonic amplitude and ϕ n is the corresponding phase the fast fourier transform fft is used to process the time histories and obtain the values calculated as follows 11 ξ n a n 2 b n 2 12 ϕ n a r c t a n b n a n where a n and b n are defined as 13 a n 2 t 0 t ξ t cos 2 π f n t d t 14 b n 2 t 0 t ξ t sin 2 π f n t d t here t represents the period of the time history the 0th order harmonic amplitude ξ 0 refers to the averaged value of the time history ξ t and the 1st order harmonic amplitude ξ 1 is the linear term defined as the fundamental component fig 12 shows the results of ship motions from the fft analysis for heave and pitch motions the dominant amplitude component could be observed at the wave encounter frequency f e as for the parametric roll obvious roll motion response could be observed at 1 2f e coupled with the vertical motions numerical results of roll and pitch motions from hust ship were compared with the available experimental data sadat hosseini 2009 and the results computed by the rans based cfdship iowa code sadat hosseini 2009 in general there is satisfactory agreement among all the results for roll amplitude hust ship over predicts at low fn fn 0 20 and under predicts at high fn fn 0 20 the average difference in roll amplitude between the results from hust ship and the experimental data is 5 which is similar to the simulation results from cfdship iowa pitch amplitude is over predicted by hust ship at all fn but it shows the same trend as efd and cfdship iowa the wave pattern around the model during cfd simulation at fn 0 20 is shown in fig 13 the snapshots in one period are provided and an obvious parametric roll can be observed owing to the large roll angle the green water phenomenon at the ship bow occurs in regular head waves 4 3 analyses of forces and moments fig 14 shows the time histories of the heave force f z acting on the model at fn 0 10 and 0 25 the total heave force f z is divided into the pressure component f zp and friction component f zf obtained from cfd calculations by integrating the normal and tangential forces over the surfaces fig 15 shows the results of f z f zp and f zf from the fft analysis it can be observed that the pressure component is much larger than the friction component at different ship speeds as the dominant contributor to the total heave force for harmonic amplitudes of different order the roll moment m x and pitch moment m y are also divided into pressure and friction components to analyze the viscous influence fig 16 shows the time histories of m x and m y on the model at fn 0 10 and 0 25 where the suffixes p and f denote the pressure and friction components respectively fft analyses were conducted for the m x and m y as shown in figs 17 and 18 respectively as with the heave force the roll and pitch moments are both dominated by the pressure component it indicates that the viscous component weakly influences the heave force roll moment and pitch moment acting on the ship which means that viscous forces do not influence ship motion dynamics significantly this conclusion is consistent with previous studies on ship seakeeping niklas and pruszko 2019a and roll damping falzarano et al 2015 thus in a full scale parametric roll study it is believed that experimental data from model tests could be used for comparisons with full scale results predicted by hust ship to validate the accuracy of full scale simulations 5 full scale simulations the following section describes the cfd prediction results of a full scale ship s parametric roll in a regular head wave including ship motions forces and moments the results are compared with the computations at model scale and the differences are discussed the effects of bilge keels are analyzed in detail this section is divided into three main subsections which present the results and discussions on verification and validation comparison between model and full scale simulations and cases with bilge keels 5 1 verification and validation first a parametric roll simulation was performed for a full scale onr tumblehome with a forward speed fn 0 10 in a regular head wave λ l pp 1 a l pp 0 0183 a verification study was undertaken to assess the numerical uncertainty for the parametric roll amplitude the procedure of the verification study is the same as that conducted for the model scale predictions as described in section 4 2 grid and time step convergence studies were conducted using triple solutions three grids were refined by a constant ratio r g 2 similar to the model scale simulations corresponding to coarse 2 80 million grid points medium 4 41 million grid points and fine 9 34 million grid points three time steps were refined by a ratio r t 2 of coarse 0 0991 s medium 0 0496 s and fine 0 0248 s the simulation results for the convergence studies are summarized in table 7 table 8 presents the uncertainties from grid and time step for the full scale case the results demonstrate good monotonic convergence performance for both grid and time step therefore the medium grid and medium time step were determined for the next full scale numerical study table 9 shows the results of the validation study where the validation uncertainty u v is higher than the comparison error e it demonstrates that the cfd prediction of the parametric roll at full scale is validated at the u v level the time history of the parametric roll from the simulation using the medium grid and medium time step is compared with experimental data from the insean model test sadat hosseini 2009 as shown in fig 19 where the elevation of roll motion is plotted versus nondimensional time ut l pp the numerical results of the full scale simulation show good agreement with the experimental data full scale simulations were also conducted for different forward speeds fn 0 10 0 25 fig 20 presents the roll amplitude from the cfd and efd results with 5 and 10 difference bands from the efd results the cfd results show a similar trend with the efd results for the roll amplitude as a function of fn for fn 0 10 0 20 the differences between the cfd and efd results are within 5 however the roll amplitude predicted at fn 0 25 is underestimated by the cfd approach with a difference of less than 10 the imo has developed provisional acceptance criteria for the numerical prediction method of parametric roll in draft guidelines of direct stability assessment procedures imo 2017b for the roll amplitude of parametric roll the guidelines require the error to be smaller than 10 of the amplitude overall the numerical results from the full scale simulations show good agreement with the model tests which meet the imo requirement 5 2 comparison between model scale and full scale simulations 5 2 1 ship motions fig 21 shows the time histories of ship 3dof unsteady motions heave pitch and roll from full scale simulations an obvious occurrence of parametric roll could be observed in the range of 0 10 fn 0 25 and the period of parametric roll is twice the periods of heave and pitch motions time histories of ship motions from model scale simulations are also presented and compared with the results of the full scale ship these indicate that the scale effect on the parametric roll of the onr tumblehome is not obvious which is consistent with the conclusion from section 4 3 illustrating that viscous forces do not significantly influence ship motion dynamics 5 2 2 forces and moments the total forces and moments acting on the ship in the 6dof directions are obtained from full scale simulations and compared with the results at the model scale figs 22 25 show the comparisons for the surge sway and heave forces between model and full scale simulations in regular head waves at fn 0 10 0 15 0 20 and 0 25 respectively where the total forces are nondimensional for the comparison and the force coefficients are defined as 15 c f x f x 0 5 ρ u 2 s 16 c f y f y 0 5 ρ u 2 s 17 c f z f z 0 5 ρ u 2 s where f x f y and f z are the surge sway and heave forces c fx c fy and c fz are the surge sway and heave force coefficients ρ is the fluid density u is the ship forward speed and s is the wetted surface area of the hull the time histories and results from the fft analysis of the force coefficients at different speeds are presented in figs 22 25 the surge force f x indicates the 0th harmonic amplitude which represents the average value of the total resistance 1st harmonic amplitude at f e and 2nd harmonic amplitude at 2f e caused by the wave effect the sway force f y responses are observed at 1 2f e 3 2f e and 5 2f e due to the roll motion the heave force is dominant at f e with a small 2nd harmonic amplitude at 2f e overall the time histories of the ship forces and the corresponding responses in the frequency domain from the full scale simulations are similar to those from the model scale results in order to study the varying trends of surge sway and heave forces versus ship forward speed intuitively different harmonic amplitudes of ship force coefficients are obtained and plotted in fig 26 as a function of fn the results of the full scale ship are also compared with those of a model scale ship based on the fft analysis shown in figs 22 25 the 0th 1st and 2nd harmonic amplitudes of c fx are presented and they all decrease with the increase in fn the full scale results are consistent with the model scale results for the 1st and 2nd harmonic amplitudes but smaller than the model scale results for the 0th harmonic amplitude which is caused by the difference in friction resistance c fy indicates a dominant harmonic amplitude at 5 2f e and the amplitude decreases with the increase in fn the harmonic amplitude at 1 2f e is small but the harmonic amplitude at 3 2f e is large for fn 0 10 which decreases with the increase in fn it can be observed that the c fy amplitudes of the full scale ship are overestimated compared to the model scale ship especially for fn 0 10 the 1st and 2nd harmonic amplitudes of c fz decrease with the increase in fn which are similar to c fx moreover the c fz amplitudes obtained from full scale simulations are consistent with the model scale results figs 27 30 show the comparisons for roll pitch and yaw moments between model scale and full scale simulations in regular head waves at fn 0 10 0 15 0 20 and 0 25 respectively where the total moments are nondimensional as follows 18 c m x m x 0 5 ρ u 2 s l p p 19 c m y m y 0 5 ρ u 2 s l p p 20 c m z m z 0 5 ρ u 2 s l p p where m x m y and m z are the roll pitch and yaw moments and c mx c my and c mz are the roll pitch and yaw moment coefficients respectively the fft analysis of moment coefficients at different speeds are presented in figs 27 30 the roll moment m x is dominant at 1 2f e inducing the parametric roll the pitch moment m y shows linear oscillation with some nonlinearity at different fn resulting in the linear pitch motion shown in fig 21 the yaw moment m z indicates 1 2 3 2 and 5 2 harmonic amplitudes due to the roll motion it can be observed that the time histories of ship moments and the corresponding responses in the frequency domain from the full scale simulations are similar to the model scale results different harmonic amplitudes of the ship moment coefficients are plotted in fig 31 as a function of fn the 1 2 and 5 2 harmonic amplitudes of c mx decrease with an increase in fn the 1st harmonic amplitude of c my at f e decreases with the increase in fn and the 2nd harmonic amplitude at 2f e is sufficiently small compared with the 1st harmonic amplitude based on the comparisons all the amplitudes of c mx and c my for a full scale ship are consistent with the model scale results c mz shows significant amplitudes at 1 2f e 3 2f e and 5 2f e which all decrease with the increase in fn a difference could be observed between full scale and model scale simulations on c mz the 1 2 and 3 2 c mz harmonic amplitudes of the full scale ship are underestimated but the 5 2 c mz harmonic amplitude is overestimated compared to the model scale simulations 5 3 effect of bilge keels numerical simulations were carried out for the full scale onr tumblehome appended with bilge keels under the same wave condition the geometry of the bilge keels is shown in fig 32 and the dimensions are shown in table 10 which are consistent with the model tests conducted by sadat hosseini 2009 the grid of the hull with bilge keels is shown in fig 33 the numerical setup is the same as that of the full scale simulations introduced in section 3 heave roll pitch 3dof motions were predicted in the range of fn 0 10 0 25 as shown in fig 34 in general the obvious parametric roll disappeared when appending the bilge keels on the ship hull model scale simulations were also carried out to check the scale effect of the bilge keels the comparisons show little difference for the 3dof motions of ship with bilge keels between the model and full scale results for the hull with bilge keels the results of roll motion are consistent with the phenomenon in previous model tests sadat hosseini 2009 which show no evidence of the parametric roll of the onr tumblehome with bilge keels this indicates that the occurrence of parametric roll can be predicted accurately by the urans solver hust ship for the full scale ship with without bilge keels fig 35 presents the comparisons for the roll moment of the bilge keel starboard between model and full scale results at different fn with the increase of fn the roll moment shows nonlinear characteristics obviously the roll moment of the bilge keel starboard at full scale is similar to that at model scale on the whole therefore the scale effect of bilge keels on the parametric roll is not obvious 6 conclusions this paper presents cfd predictions for the parametric roll of a full scale onr tumblehome in a regular head wave with different forward speeds a viscous urans code hust ship was used and a systematic verification study was caried out for two parameters grid and time step based on the experimental data a validation study was performed by comparing the full scale cfd prediction results with the results from model tests both model and full scale simulations were conducted to analyze the scale effect on the parametric roll simulations for ships with bilge keels were also performed to evaluate the effect of bilge keels parametric roll occurs in the cfd prediction for a full scale onr tumblehome ship as observed in model tests the verification study shows reasonable grid and time step convergence behavior and the average difference of the parametric roll amplitude at different fn between the cfd and efd results is less than 5 satisfying the requirement of the imo by comparing the results between model and full scale simulations including ship motions forces and moments it can be seen that the scale effect on the parametric roll is not obvious and can be neglected the simulations of the ship equipped with bilge keels show no evidence of the parametric roll of the onr tumblehome ship with bilge keels which is consistent with the phenomenon observed in model tests the effect of bilge keels on the parametric roll shows little difference between model and full scale ships overall it could be concluded that the occurrence of parametric roll can be simulated well by hust ship and the roll amplitude and period can be predicted accurately declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this research was sponsored by the fundamental research funds for the central universities hust 2020jycxjj064 this essential support is greatly acknowledged 
20638,with the advances in available brute force computing power parallel computations overset grid technology and meta modeling will eventually open a path to the widespread application of full scale computations this study presents a computational fluid dynamics cfd prediction of a full scale ship parametric roll in a regular head wave an in house unsteady reynolds averaged navier stokes urans cfd code was used for the simulations the onr tumblehome surface combatant was selected as the research object and the full scale ship was studied under the same conditions as the model tests comparisons between the cfd results and model test results from the reference show good agreement and validate that the code could capture the details of parametric roll phenomenon in head waves the full scale predictions were compared with the model scale results to assess the scale effect of the parametric roll the induced force and moment acting on the hull under the parametric roll were analyzed simulations for ships with bilge keels were also performed at model and full scale to evaluate the effect of bilge keels numerical results demonstrate that the in house urans code could be used to predict the parametric roll characteristics for a full scale ship at the design stage in the future keywords full scale cfd parametric roll head wave urans solver 1 introduction the parametric roll phenomenon is one of the five dynamic stability failure modes in the second generation intact stability criteria proposed by the international maritime organization imo the parametric roll phenomenon has been investigated since the 1930s paulling and rosenberg 1959 attempted to develop a method for predicting the parametric roll in regular waves by solving the mathieu equation however the research has been regarded as of theoretical interest and few practical studies were conducted since the turn of the 21st century the parametric roll phenomenon has received extensive attention in 1998 the apl china container ship sailing from taiwan to seattle experienced parametric roll resonance and more than 60 of the cargo was lost or damaged van laarhoven 2009 such accidents have led the imo to reconsider the drawback of the first generation intact stability criteria and propose second generation intact stability criteria including parametric roll self riding and broaching pure loss of stability dead ship condition and excessive acceleration imo 2015 in the imo sdc 4th conference attention was focused on methods for the direct assessment of the five dynamic stability failure modes imo 2017a a direct stability assessment can consider all relevant physics in the most accurate way allowing us to address unconventional ship designs thus it was demonstrated that the establishment of a direct assessment method for predicting the dynamic stability failure modes was necessary to study the vulnerability of different ships in recent years many studies have been carried out on the prediction of the parametric roll phenomenon evaluating the potential danger for ships francescutto 2001 conducted a study on the possibility of parametric roll for a forward ship in head wave conditions by experiments the experimental results showed good agreement with the theoretical results by mathieu equation spanos and papanikolaou 2009 presented a benchmark study for the prediction of a ship s parametric roll to assess the performance of 14 different numerical methods a containership was investigated with roll heave pitch motions in regular group and irregular waves sadat hosseini et al 2010 studied parametric roll for the onr tumblehome surface combatant using computational fluid dynamics cfd experimental fluid dynamics efd and nonlinear dynamics approach the cfd results showed agreement with the efd data for the parametric roll in head waves but they showed larger instability zones at high and low froude numbers fn zhou et al 2015 and zhou 2019 conducted a hybrid method in which roll damping was obtained by using a three dimensional 3d cfd approach and the potential theory method was applied to predict the parametric roll characteristics the hybrid method requires fewer computational resources compared to direct cfd methods schumacher et al 2016 conducted a set of scaled model experiments to investigate the occurrence of parametric roll for a containership in different wave conditions results from a nonlinear time domain model were compared with the experimental data lu et al 2016 studied the correlation between the parametric roll and added resistance the results showed that the added resistance increases with the amplitude of the parametric roll liu and papanikolaou 2016 applied a 3d nonlinear time domain method using the impulse response function to investigate the parametric roll of a containership ma et al 2018 studied the parametric roll of a containership in regular waves with the model tests and numerical predictions it was found that the numerical results provide good predictions for the parametric roll sakai et al 2019 verified the encounter frequency assumption on the draught of the second check for the parametric roll bu et al 2019 studied the parametric roll using a coupled three degree of freedom 3dof model based on a 3d mixed source method the results showed that the effects of radiation and diffraction forces on righting arm variation are nonlinearly related to heeling angles and wave amplitudes somayajula et al 2019 presented a method to assess the vulnerability of a ship s parametric roll in a realistic random seaway the stochastic averaging technique was applied to provide an effective estimate of ship stability yu et al 2019 conducted parametric roll prediction for a containership applying a 5dof nonlinear time domain model the results showed that the amplitudes of parametric roll are influenced by the roll damping acanfora et al 2020 applied a 6dof blended nonlinear model to generate the roll motions from irregular waves in the time domain the results showed that the resonance period in an irregular wave is ruled by the roll amplitude in a manner similar to that in a regular wave during the literature review it is noted that most of the abovementioned studies for the parametric roll were conducted at the model scale to the best of our knowledge scale effect is a well researched topic in ship hydrodynamics because the complete hydrodynamic similarity between model and full scale ship cannot be achieved it was indicated that the flow characteristics at model and full scale show obvious differences hochkirch and mallol 2013 for the simulation based design projects full scale analyses are thus advisable to properly evaluate the potential danger for a full scale ship caused by parametric roll performance under different wave conditions it is critical to predict the parametric roll of a full scale ship at the design stage therefore the main aim of this study is to evaluate the parametric roll for a full scale ship directly which can avoid the scale effects as computational facilities become more powerful and accessible full scale cfd simulations are gaining attentions which can allow the prediction of full scale ship performance directly different cfd methods have been used in full scale modeling of ship hydrodynamic characteristics including reynolds averaged navier stokes rans method detached eddy simulation des and large eddy simulation les compared with those other simulation methods the rans method reduces the required resolution in time and space showing the advent of high efficiency computing helma et al 2018 furthermore the rans method has been used commonly for the full scale simulation with great accuracy to predict ship hydrodynamic performance including resistance farkas et al 2018 haase et al 2016 niklas and pruszko 2019b pereira et al 2017 self propulsion castro et al 2011 farkas et al 2018 jasak et al 2019 mikkelsen and walther 2020 and seakeeping performance niklas and pruszko 2019a tezdogan et al 2015 2016 tezdogan et al 2015 carried out a rans prediction for a full scale containership at service and slow steaming speeds to predict the motions and added resistance tezdogan et al 2016 applied a commercial rans solver to study the vertical motions of a full scale tanker in shallow water niklas and pruszko 2019a performed cfd predictions for the seakeeping performance of a full scale ship these results were compared with the available experimental data and showed good agreement based on the abovementioned studies it is of great importance to perform an analysis at full scale furthermore it has been validated that the rans method can be used as an efficient tool for full scale prediction therefore an in house urans code hust ship was applied to the simulation for ship s parametric roll phenomenon at full scale and the onr tumblehome was regarded as the object in this study the rigorous verification and validation studies including the comparison with model test results were carried out to validate the numerical method a 1 46 6 scaled model was also considered as the cfd prediction object based on the insean captive model tests sadat hosseini 2009 comparisons between the model and full scale results were performed to analyze the scale effect the remainder of this paper is structured as follows section 2 describes numerical theories relevant to hust ship the study object used in the numerical simulations is presented in section 3 with the description of the computational domain and grid generation section 4 presents the results of model scale simulations using hust ship including verification and validation studies with the analyses of correlations between the motions and forces in section 5 full scale simulations of parametric roll are performed differences between the model and full scale results are identified and discussed including ship motions forces and moments numerical simulations were also conducted for a full scale ship with bilge keels finally section 6 presents the conclusions 2 computational method in this study cfd predictions are performed using hust ship an in house urans code for ship hydrodynamics in the urans approach the conservation equations are solved in the liquid phase defined as follows 1 ρ t ρ u i x i 0 2 u i t u i u j x j 1 ρ p x i 1 ρ x j μ u i x j ρ u i u j where u i and u i i 1 2 3 are the time averaged and fluctuation components of velocities respectively ρ is the density p is the time averaged pressure μ is the dynamic viscosity and ρ u i u j is the reynolds stress term the shear stress transport sst k ω turbulence model a two equation eddy viscosity model proposed by menter 1994 is used for the closure of governing equations this turbulence model has been proven to be capable of solving the adverse pressure gradients and separating flow with the reasonable solution for the near wall region it was shown that the difference between the numerical results and sea trial measurements for the sst k ω model was less than that for the k ε model when predicting the force and moment of a full scale ship pena et al 2020 the wake field and boundary layer were also captured better when using the sst k ω model than using the k ε model the roll damping at full scale which is of importance for the parametric roll prediction was predicted accurately by the rans method with sst k ω model irkal et al 2019 irkal et al 2019 also concluded that the les simulation method shows no advantage when compared with rans method for the roll damping prediction furthermore this model has been validated in ma et al 2018 and sadat hosseini et al 2010 in which the model scale parametric roll was predicted satisfactorily therefore the sst k ω turbulence model is applied in this study for the simulation of the parametric roll of full scale ship this cfd code uses the finite difference method to discretize the difference form of the governing equations with the structured body fitted curvilinear grid the 2nd order difference scheme is used for spatial and temporal discretization a projection algorithm is applied to solve velocity pressure coupling both absolute inertial earth fixed and relative non inertial ship fixed coordinate systems are used in this code as shown in fig 1 positive x y and z represent the downstream starboard and upward directions respectively ship motions are estimated in an earth fixed coordinate system a ship fixed coordinate system is attached to the center of gravity of the ship with the movements following ship motions this code is capable of simulating ship motion with large amplitude by using a multiblock structured grid with a dynamic overset approach rigid body motion equations can be solved the ship grid moves with the predicted motions and a dynamic overset approach is used to update the relative location between the computational domain and the ship the level set method is used to capture the free surface in which the positive function is defined as the water phase linear regular wave velocity components can be defined in the computational domain to generate a corresponding regular wave for the regular head wave the velocity components in the x direction and z direction are defined as follows 3 u 2 π a f e k z cos k x 2 π f t ϕ 4 w 2 π a f e k z sin k x 2 π f t ϕ where a is the wave amplitude k is the wave number f is the wave frequency and ϕ is the initial phase a damping zone is created at the end of the computational domain where a damping modification is applied to the momentum equations aimed at preventing the reflection from the exit boundary the overall solution flowchart for the hust ship is presented in fig 2 the parallel computation technique is applied and the overset grid system is read with the decomposition the discretized governing equations are then solved with turbulence model the free surface can be simulated and the velocity field is obtained implicitly the coupling field of the pressure and velocity is then obtained by using the projection algorithm based on the flow field computation the force and moment acting on the ship are integrated the convergence is then evaluated as the convergence of the solution is achieved the grid is moved following the ship motions which are predicted by the 6dof motion solver once the time step is finished the next time step is then started finally the whole solution is finished as the stable results can be obtained a more detailed description of the hust ship can be found in zhang et al 2020 wang et al 2020 and feng et al 2020 full scale and model scale cfd predictions of ship parametric roll were carried out using the tianhe 2 supercomputer at the national supercomputer center in guangzhou the supercomputer includes 17 920 processors intel xeon e5 2692 v2 processor for the parametric roll simulation in the head wave the calculation speed increases linearly with the increase in the number of processors used 3 geometry and numerical modeling 3 1 onr tumblehome the onr tumblehome is considered as the simulation object which is a preliminary design of a modern concept surface combatant the parametric roll phenomenon of the full scale ship is predicted using the cfd approach experimental data from insean captive tests sadat hosseini 2009 is used for the validation and the tested model is a 1 46 6 scaled model a numerical simulation of the 1 46 6 scaled model is performed and the results are compared with those from full scale simulations in this cfd prediction the ship model is appended with a skeg but the superstructure is not attached taking precedence from the experiment fig 3 shows the 3d geometry and table 1 presents the main parameters for the model scale and full scale ship which are all set to be the same as those of the model tests 3 2 simulation condition during the cfd predictions of the parametric roll phenomenon in regular head waves at model and full scale 3dof semi captive conditions free to roll heave and pitch and constrained in surge sway and yaw are considered head wave simulations are carried out in a wave with wave amplitude a l pp 0 0183 and wavelength λ l pp 1 following insean captive tests sadat hosseini 2009 in which evident parametric roll occurred in the model tests typical parameters of the simulation conditions are shown in table 2 where u is the ship advancing speed fn is the froude number u g l p p re is the reynolds number u l p p ν ν is the kinematic viscosity of the fluid and f e is the encounter frequency which is defined as follows 5 f e f 2 π f 2 g u 3 3 grid generation and computational domain in the cfd predictions the computational domain grid and ship grid are generated independently and then an in house overset grid program hust overset is used for the composition to generate a numerical overset grid system which is beneficial for simulations of ship motions with large amplitudes the computational domain is shown in fig 4 and the boundary conditions are presented in detail the computational domain extends over the ranges of l pp x 3l pp l pp y l pp and l pp z 0 4 l pp the ship length is aligned with the x axis where the ship bow is set at x 0 with the stern at x l pp the initial water surface lies at z 0 the cartesian grid in the computational domain is refined near the water surface including 50 grid points per wavelength and 20 grid points in the range of wave height the refinements are provided around the ship bow and stern where flow features of interest are expected the wave velocity components eqs 3 and 4 are defined at the inlet of the domain to generate the incident head wave the pressure outlet boundary condition is imposed on the exit of the domain where the grid along the x axis is coarsened and the damping zone is generated in the range of 2 4l pp x 3l pp zero pressure is imposed on the bottom and a zero pressure gradient is imposed on the top and two sides the quality of wave elevation λ l pp 1 a l pp 0 0183 simulated in this computational domain without ship model is first validated a fixed wave probe at a position 0 5l pp from the inlet boundary is used to monitor the wave elevation varying with time fig 5 shows a comparison of wave elevation time histories from cfd and theory in which the variables are nondimensional it can be observed that the cfd results are consistent with the theoretical results for the ship grid a body fitted structured grid is generated to accurately capture the geometric features the o o topology is adopted as shown in fig 6 the grid spacing of the model inside the boundary layer is determined based on the nondimensional wall distance y which is defined as follows 6 y ρ u μ y where ρ is the density u is the friction velocity y is the wall normal coordinate and μ is the dynamic viscosity during the model scale simulation the sst k ω turbulence model is used to resolve the flow in the near wall region therefore the y 1 is used to generated the boundary layer grid with the expansion ratio around 1 2 which is recommended by ittc 2014 the spacing δs of the first grid point from the wall is assumed as follows 7 δ s y l p p r e c f 2 where c f is the friction coefficient which can be computed by the 1957 ittc formulation ittc 2014 following eq 7 the δs is set to be 10 5 m to yield y 1 for the case with the highest re fig 7 shows the y distribution on the hull obtained from the model scale simulation where the average y value is approximately 0 6 during the full scale simulation a wall function model is used to treat near wall flow solutions owing to the thin sublayer ittc 2014 recommends that the first grid point from the wall is well within the logarithmic layer of the boundary layer when using the wall function model following eq 7 the δs is set to be 4 10 4 m to yield 30 y 100 and the boundary layer grid is generated normally with the expansion ratio around 1 2 fig 8 shows the y distribution on the hull obtained from the full scale simulation where the average y value is approximately 70 the hust overset program is applied to generate an overset region between the computational domain and ship hull the overset grid system of the numerical model is shown in fig 9 the systematic grid convergence studies are described in section 4 2 and 5 1 3 4 choice of the time step for the unsteady rans simulations the time step is determined by the flow properties tezdogan et al 2016 it is recommended that at least 100 time steps per period are used for the periodic phenomena such as the incoming waves ittc 2014 in this study the wavelength λ is constant to be l pp and the encounter period decreases with the ship speed therefore the time step is calculated as t min 124 where the t min is the minimum encounter period corresponding to the highest speed case fn 0 25 for the model and full scale simulations the time step is chosen as 0 0072s and 0 0496s respectively the systematic time step convergence studies are described in section 4 2 and 5 1 4 model scale simulations the following section describes the results of the model scale simulations using hust ship the simulation results and experimental data from insean are compared the forces and moments acting on the model at different forward speeds are obtained and different components are analyzed 4 1 influence of the initial roll angle first the influence of initial roll angle on the parametric roll is studied simulations are conducted for three different given roll angles of 5 10 and 30 as shown in fig 10 the results indicate that the initial roll angle causes no effect for the amplitude and period of ship parametric roll at the steady stage which is consistent with the conclusion from zhang et al 2019 sadat hosseini 2009 also performed parametric roll tests with the model fixed at 30 initial roll angle therefore the numerical simulations are all conducted for the ship model at a given initial roll angle of 30 to realize the more rapid occurrence of the parametric roll phenomenon in this way the stage of parametric roll development is not concerned 4 2 verification and validation a systematic verification and validation study for the parametric roll of a model scale ship with a forward speed fn 0 20 was conducted to quantify the uncertainties in the cfd simulations the same wave condition was used in the simulations as in the model tests λ l pp 1 a l pp 0 0183 it is assumed that the numerical uncertainty u sn consists of the grid uncertainty u g time step uncertainty u t and iterative uncertainty u i which can be defined as stern et al 2001 8 u s n 2 u g 2 u t 2 u i 2 according to previous studies castiglione et al 2011 tezdogan et al 2015 the iterative uncertainty u i is negligible when compared with the grid and time step uncertainties therefore grid and time step convergence studies were performed to estimate the uncertainties the american society of mechanical engineers 2009 determined that a verification study requires a minimum of three solutions to evaluate the convergence behavior with respect to the input parameter based on this procedure three grids were considered which were refined by a constant ratio r g 2 corresponding to coarse 2 80 million grid points medium 4 41 million grid points and fine 9 34 million grid points the results of the parametric roll amplitude simulated by coarse medium and fine grids were denoted as s gc s gm and s gf respectively and are summarized in table 3 three time steps were refined by a ratio r t 2 for coarse 0 0144 s medium 0 0072 s and fine 0 0036 s the results of the parametric roll amplitude simulated by coarse medium and fine time steps were denoted as s tc s tm and s tf respectively and are summarized in table 4 in the verification study the convergence factor r could be estimated first as 9 r s f s m s m s c where s f s m and s c represent the fine medium and coarse results from the numerical simulation respectively it was found that the convergence factors for both the grid r g and time step r t studies are in the range of 0 1 indicating that monotonic convergence is achieved stern et al 2001 as a result uncertainties from the grid and time step could be calculated following the factors of the safety method for richardson extrapolation xing and stern 2010 as shown in table 5 where p g and p t are the distance metrics of the grid and time step respectively for the validation procedure the validation uncertainty u v should be compared with the comparison error e between the numerical result and benchmark experimental data the validation uncertainty u v consists of the numerical uncertainty u sn and experimental uncertainty u d where u d is obtained from the reference sadat hosseini 2009 the values from the validation study are summarized in table 6 the results show that the comparison error e of the parametric roll amplitude is lower than the validation uncertainty u v which indicates that the validation of model scale simulation is successful at the u v level model scale simulations were also conducted for different forward speeds fn 0 10 0 25 under the same wave conditions λ l pp 1 a l pp 0 0183 the time histories of ship motions including heave roll and pitch motions are shown in fig 11 an obvious parametric roll occurs at different forward speeds which is consistent with the phenomenon in the model tests the time history of the parametric roll shows a regular pattern and the amplitude decreases with the increase in ship speed the maximum steady roll amplitude was predicted at fn 0 10 for heave motion the steady amplitude shows an increasing trend with the increase in fn the results of pitch amplitude indicate an increasing trend for 0 10 fn 0 20 and shows a decreasing trend for 0 20 fn 0 25 to capture the characteristics of ship motions in the frequency domain time histories could be approximated by fourier series expansions as given by 10 ξ t ξ 0 n 1 n ξ n cos 2 π f n t ϕ n where ξ n represents the nth order harmonic amplitude and ϕ n is the corresponding phase the fast fourier transform fft is used to process the time histories and obtain the values calculated as follows 11 ξ n a n 2 b n 2 12 ϕ n a r c t a n b n a n where a n and b n are defined as 13 a n 2 t 0 t ξ t cos 2 π f n t d t 14 b n 2 t 0 t ξ t sin 2 π f n t d t here t represents the period of the time history the 0th order harmonic amplitude ξ 0 refers to the averaged value of the time history ξ t and the 1st order harmonic amplitude ξ 1 is the linear term defined as the fundamental component fig 12 shows the results of ship motions from the fft analysis for heave and pitch motions the dominant amplitude component could be observed at the wave encounter frequency f e as for the parametric roll obvious roll motion response could be observed at 1 2f e coupled with the vertical motions numerical results of roll and pitch motions from hust ship were compared with the available experimental data sadat hosseini 2009 and the results computed by the rans based cfdship iowa code sadat hosseini 2009 in general there is satisfactory agreement among all the results for roll amplitude hust ship over predicts at low fn fn 0 20 and under predicts at high fn fn 0 20 the average difference in roll amplitude between the results from hust ship and the experimental data is 5 which is similar to the simulation results from cfdship iowa pitch amplitude is over predicted by hust ship at all fn but it shows the same trend as efd and cfdship iowa the wave pattern around the model during cfd simulation at fn 0 20 is shown in fig 13 the snapshots in one period are provided and an obvious parametric roll can be observed owing to the large roll angle the green water phenomenon at the ship bow occurs in regular head waves 4 3 analyses of forces and moments fig 14 shows the time histories of the heave force f z acting on the model at fn 0 10 and 0 25 the total heave force f z is divided into the pressure component f zp and friction component f zf obtained from cfd calculations by integrating the normal and tangential forces over the surfaces fig 15 shows the results of f z f zp and f zf from the fft analysis it can be observed that the pressure component is much larger than the friction component at different ship speeds as the dominant contributor to the total heave force for harmonic amplitudes of different order the roll moment m x and pitch moment m y are also divided into pressure and friction components to analyze the viscous influence fig 16 shows the time histories of m x and m y on the model at fn 0 10 and 0 25 where the suffixes p and f denote the pressure and friction components respectively fft analyses were conducted for the m x and m y as shown in figs 17 and 18 respectively as with the heave force the roll and pitch moments are both dominated by the pressure component it indicates that the viscous component weakly influences the heave force roll moment and pitch moment acting on the ship which means that viscous forces do not influence ship motion dynamics significantly this conclusion is consistent with previous studies on ship seakeeping niklas and pruszko 2019a and roll damping falzarano et al 2015 thus in a full scale parametric roll study it is believed that experimental data from model tests could be used for comparisons with full scale results predicted by hust ship to validate the accuracy of full scale simulations 5 full scale simulations the following section describes the cfd prediction results of a full scale ship s parametric roll in a regular head wave including ship motions forces and moments the results are compared with the computations at model scale and the differences are discussed the effects of bilge keels are analyzed in detail this section is divided into three main subsections which present the results and discussions on verification and validation comparison between model and full scale simulations and cases with bilge keels 5 1 verification and validation first a parametric roll simulation was performed for a full scale onr tumblehome with a forward speed fn 0 10 in a regular head wave λ l pp 1 a l pp 0 0183 a verification study was undertaken to assess the numerical uncertainty for the parametric roll amplitude the procedure of the verification study is the same as that conducted for the model scale predictions as described in section 4 2 grid and time step convergence studies were conducted using triple solutions three grids were refined by a constant ratio r g 2 similar to the model scale simulations corresponding to coarse 2 80 million grid points medium 4 41 million grid points and fine 9 34 million grid points three time steps were refined by a ratio r t 2 of coarse 0 0991 s medium 0 0496 s and fine 0 0248 s the simulation results for the convergence studies are summarized in table 7 table 8 presents the uncertainties from grid and time step for the full scale case the results demonstrate good monotonic convergence performance for both grid and time step therefore the medium grid and medium time step were determined for the next full scale numerical study table 9 shows the results of the validation study where the validation uncertainty u v is higher than the comparison error e it demonstrates that the cfd prediction of the parametric roll at full scale is validated at the u v level the time history of the parametric roll from the simulation using the medium grid and medium time step is compared with experimental data from the insean model test sadat hosseini 2009 as shown in fig 19 where the elevation of roll motion is plotted versus nondimensional time ut l pp the numerical results of the full scale simulation show good agreement with the experimental data full scale simulations were also conducted for different forward speeds fn 0 10 0 25 fig 20 presents the roll amplitude from the cfd and efd results with 5 and 10 difference bands from the efd results the cfd results show a similar trend with the efd results for the roll amplitude as a function of fn for fn 0 10 0 20 the differences between the cfd and efd results are within 5 however the roll amplitude predicted at fn 0 25 is underestimated by the cfd approach with a difference of less than 10 the imo has developed provisional acceptance criteria for the numerical prediction method of parametric roll in draft guidelines of direct stability assessment procedures imo 2017b for the roll amplitude of parametric roll the guidelines require the error to be smaller than 10 of the amplitude overall the numerical results from the full scale simulations show good agreement with the model tests which meet the imo requirement 5 2 comparison between model scale and full scale simulations 5 2 1 ship motions fig 21 shows the time histories of ship 3dof unsteady motions heave pitch and roll from full scale simulations an obvious occurrence of parametric roll could be observed in the range of 0 10 fn 0 25 and the period of parametric roll is twice the periods of heave and pitch motions time histories of ship motions from model scale simulations are also presented and compared with the results of the full scale ship these indicate that the scale effect on the parametric roll of the onr tumblehome is not obvious which is consistent with the conclusion from section 4 3 illustrating that viscous forces do not significantly influence ship motion dynamics 5 2 2 forces and moments the total forces and moments acting on the ship in the 6dof directions are obtained from full scale simulations and compared with the results at the model scale figs 22 25 show the comparisons for the surge sway and heave forces between model and full scale simulations in regular head waves at fn 0 10 0 15 0 20 and 0 25 respectively where the total forces are nondimensional for the comparison and the force coefficients are defined as 15 c f x f x 0 5 ρ u 2 s 16 c f y f y 0 5 ρ u 2 s 17 c f z f z 0 5 ρ u 2 s where f x f y and f z are the surge sway and heave forces c fx c fy and c fz are the surge sway and heave force coefficients ρ is the fluid density u is the ship forward speed and s is the wetted surface area of the hull the time histories and results from the fft analysis of the force coefficients at different speeds are presented in figs 22 25 the surge force f x indicates the 0th harmonic amplitude which represents the average value of the total resistance 1st harmonic amplitude at f e and 2nd harmonic amplitude at 2f e caused by the wave effect the sway force f y responses are observed at 1 2f e 3 2f e and 5 2f e due to the roll motion the heave force is dominant at f e with a small 2nd harmonic amplitude at 2f e overall the time histories of the ship forces and the corresponding responses in the frequency domain from the full scale simulations are similar to those from the model scale results in order to study the varying trends of surge sway and heave forces versus ship forward speed intuitively different harmonic amplitudes of ship force coefficients are obtained and plotted in fig 26 as a function of fn the results of the full scale ship are also compared with those of a model scale ship based on the fft analysis shown in figs 22 25 the 0th 1st and 2nd harmonic amplitudes of c fx are presented and they all decrease with the increase in fn the full scale results are consistent with the model scale results for the 1st and 2nd harmonic amplitudes but smaller than the model scale results for the 0th harmonic amplitude which is caused by the difference in friction resistance c fy indicates a dominant harmonic amplitude at 5 2f e and the amplitude decreases with the increase in fn the harmonic amplitude at 1 2f e is small but the harmonic amplitude at 3 2f e is large for fn 0 10 which decreases with the increase in fn it can be observed that the c fy amplitudes of the full scale ship are overestimated compared to the model scale ship especially for fn 0 10 the 1st and 2nd harmonic amplitudes of c fz decrease with the increase in fn which are similar to c fx moreover the c fz amplitudes obtained from full scale simulations are consistent with the model scale results figs 27 30 show the comparisons for roll pitch and yaw moments between model scale and full scale simulations in regular head waves at fn 0 10 0 15 0 20 and 0 25 respectively where the total moments are nondimensional as follows 18 c m x m x 0 5 ρ u 2 s l p p 19 c m y m y 0 5 ρ u 2 s l p p 20 c m z m z 0 5 ρ u 2 s l p p where m x m y and m z are the roll pitch and yaw moments and c mx c my and c mz are the roll pitch and yaw moment coefficients respectively the fft analysis of moment coefficients at different speeds are presented in figs 27 30 the roll moment m x is dominant at 1 2f e inducing the parametric roll the pitch moment m y shows linear oscillation with some nonlinearity at different fn resulting in the linear pitch motion shown in fig 21 the yaw moment m z indicates 1 2 3 2 and 5 2 harmonic amplitudes due to the roll motion it can be observed that the time histories of ship moments and the corresponding responses in the frequency domain from the full scale simulations are similar to the model scale results different harmonic amplitudes of the ship moment coefficients are plotted in fig 31 as a function of fn the 1 2 and 5 2 harmonic amplitudes of c mx decrease with an increase in fn the 1st harmonic amplitude of c my at f e decreases with the increase in fn and the 2nd harmonic amplitude at 2f e is sufficiently small compared with the 1st harmonic amplitude based on the comparisons all the amplitudes of c mx and c my for a full scale ship are consistent with the model scale results c mz shows significant amplitudes at 1 2f e 3 2f e and 5 2f e which all decrease with the increase in fn a difference could be observed between full scale and model scale simulations on c mz the 1 2 and 3 2 c mz harmonic amplitudes of the full scale ship are underestimated but the 5 2 c mz harmonic amplitude is overestimated compared to the model scale simulations 5 3 effect of bilge keels numerical simulations were carried out for the full scale onr tumblehome appended with bilge keels under the same wave condition the geometry of the bilge keels is shown in fig 32 and the dimensions are shown in table 10 which are consistent with the model tests conducted by sadat hosseini 2009 the grid of the hull with bilge keels is shown in fig 33 the numerical setup is the same as that of the full scale simulations introduced in section 3 heave roll pitch 3dof motions were predicted in the range of fn 0 10 0 25 as shown in fig 34 in general the obvious parametric roll disappeared when appending the bilge keels on the ship hull model scale simulations were also carried out to check the scale effect of the bilge keels the comparisons show little difference for the 3dof motions of ship with bilge keels between the model and full scale results for the hull with bilge keels the results of roll motion are consistent with the phenomenon in previous model tests sadat hosseini 2009 which show no evidence of the parametric roll of the onr tumblehome with bilge keels this indicates that the occurrence of parametric roll can be predicted accurately by the urans solver hust ship for the full scale ship with without bilge keels fig 35 presents the comparisons for the roll moment of the bilge keel starboard between model and full scale results at different fn with the increase of fn the roll moment shows nonlinear characteristics obviously the roll moment of the bilge keel starboard at full scale is similar to that at model scale on the whole therefore the scale effect of bilge keels on the parametric roll is not obvious 6 conclusions this paper presents cfd predictions for the parametric roll of a full scale onr tumblehome in a regular head wave with different forward speeds a viscous urans code hust ship was used and a systematic verification study was caried out for two parameters grid and time step based on the experimental data a validation study was performed by comparing the full scale cfd prediction results with the results from model tests both model and full scale simulations were conducted to analyze the scale effect on the parametric roll simulations for ships with bilge keels were also performed to evaluate the effect of bilge keels parametric roll occurs in the cfd prediction for a full scale onr tumblehome ship as observed in model tests the verification study shows reasonable grid and time step convergence behavior and the average difference of the parametric roll amplitude at different fn between the cfd and efd results is less than 5 satisfying the requirement of the imo by comparing the results between model and full scale simulations including ship motions forces and moments it can be seen that the scale effect on the parametric roll is not obvious and can be neglected the simulations of the ship equipped with bilge keels show no evidence of the parametric roll of the onr tumblehome ship with bilge keels which is consistent with the phenomenon observed in model tests the effect of bilge keels on the parametric roll shows little difference between model and full scale ships overall it could be concluded that the occurrence of parametric roll can be simulated well by hust ship and the roll amplitude and period can be predicted accurately declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this research was sponsored by the fundamental research funds for the central universities hust 2020jycxjj064 this essential support is greatly acknowledged 
20639,the dredger operation extended from protected water to harsher environments in recent years this resulted in a change in design strategy understanding these complex dynamic interaction during the dredging operation using a cutter suction dredger csd can improve the production by reducing the downtime csd consists of the dredge hull spud and the cutter shaft a hybrid scaled model of the csd is developed using froude and cauchy scaling for the different section of the csd the assembly was modelled in two sections the spud hull assembly dynamics was modelled using wamit and ansys the system was identified and reduced to a sdof in the surge direction the surge dynamics was coupled to the cutter shaft assembly using a roller support wave excitation acting on the assembly was determined using statistically linearised morison equation the assembly was linearised in frequency domain and transformed to state space and the temporal response was determined a parametric study was carried out to understand the influence of the relative shaft dimensions and the coupling strength on the vibration transmission when subjected to an impulsive load the results from the study indicated that shaft dimension asymmetry and coupling strength influences the vibration transmission keywords froude scaling cauchy scaling curve veering statistical linearisation 1 introduction dredging is the removal of sediments and debris from the bottom of lakes rivers harbours and the other water bodies it is a routine necessity in waterways because sedimentation gradually fills the channels and harbours it is usually required to maintain or increase the depth of navigation channels anchorages or berthing areas for safe passage of boats and ships dredging mainly can be classified into two category namely mechanical and hydraulic dredger cutter suction dredger is a hydraulic dredger the layout of the cutter suction dredger system is shown in fig 1 the dredger consists of hull spud and the cutter shafts the cutter shafts basically transmit power from the prime mover to the cutter it consists of two shafts of different lengths coupled using a universal joint major parameters influencing the performance and workability are hull characteristics restraint imposed by the spud and the dynamics of the spud and cutter shafts an estimation of the response due to restraint imposed on the dredger hull from the spud can provide insights on the vibration transmission during the dredging operation keuning and journee 1983 analysed the dynamics of the cutter suction dredger in irregular waves a mathematical model was developed including the effect of cutter ladder mooring lines spud pole wave excitation forces current forces and viscous roll damping the results from the computational study indicated that the behaviour of dredge is heavily influenced by non linear characteristics of soil khodair and abdel mohti 2014 analysed pile soil interaction subjected to both axial and lateral loading the results from the study indicated that there were reductions in the induced bending moment and lateral displacement by increasing the amount of clay surrounding the piles zachert et al 2016 demonstrated the effect of soil structure interaction due to cyclic loading on foundations for offshore wind turbines soil was modelled using high cycle accumulation hca model a considerable redistribution of contact pressure was observed due to the inhomogeneous accumulation of strain from the cyclic loading lopez querol et al 2017 provides a summary of numerical methods such as p y method finite element method fem and discrete element method dem for long term prediction of offshore wind turbine foundation the deficiency associated with p y method used by american petroleum institute api code or offshore piles are described randolph and gourvenec 2011 p y method underestimates the lateral displacement in comparison to fem for higher load cycles a description on the plastic phenomenon associated with cyclic loading such as adaptation accommodation and ratcheting is provided the implementation of kinematic hardening in fem to model plastic ratcheting is described estimation of the wave induced forces on the offshore structures can be carried out using morison s equation in addition to non linear response due to large deformation the flexibility of the structure generates non linear hydrodynamic forces patel 2013 various author najafian et al 2000 terro and abdel rohman 2007 chang and tung 1990 chakrabarti 1987 have carried out research studies on linearising the morison equation overlooking or ignoring the errors arising from the approximations anagnostopoulos 1982 attempted a linearised solution based on an approximation that lags structural velocity by one time step when forming load vector and neglecting relative velocity chang and tung 1990 carried out an analysis on a seven floor offshore tower linearising morison equation using stochastic linearisation the response statistics of the offshore structure was obtained assuming a linear gaussian narrow banded waves the error estimate indicated that the linearised equation can be used to advantage for preliminary design terro and abdel rohman 2007 presented a comparative analysis of linear and non linear morison equation by predicting a modification to linearise the non linear morison equation the modified form provided better estimation to the wave induced forces the results were validated against the results of the traditional linear and non linear form of equation during excavating material from sea bed surface using cutter suction dredger it is very important to know about the forces exerted on the cutter young and randall 2009 developed an experimental set up to estimate the forces in horizontal vertical and axial direction a static analysis was carried out on the carriage by the application of static loads to the cutter head in horizontal vertical and axial directions yasheng et al 2001 analysed the 3 d cutting forces on the cutter head the emphasis was laid on the blade cutting forces with the small cutting angle within saturated sand the pressure distribution was estimated and compared with experimental results miedema et al 1983 carried out experiment for the soil cutter head interaction subjected to wave loading it was observed that the load on the cutter head can be reduced by operating at a low swing velocities and higher cutter revolution hence it is important to get the knowledge about the soil reaction forces on the cutter however for the present study the effect of cutter soil interaction is not considered the vibrations from the dredging of soil is transmitted through the cutter shafts to the dredge hull assembly the cutter shaft assembly can be considered as two shafts subsystems coupled using universal joints in order to differentiate the two shafts of the cutter shaft in further discussions the inclined shafts will be referred as the primary shaft and the straight shaft attached to the dredge hull as secondary generally for many of the coupled systems when subjected to impulsive loading worst case scenario of high acceleration was linked to a phenomenon known as curve veering kuttler and sigillito 1981 leissa 1974 perkins and mote 1986 vijayan and woodhouse 2014 2013 this can reduce the life of the cutter shaft assembly and increase the downtime dredging operation has extended in recent years gradually from protected waters to harsher environment the design strategy therefore should account for the additional loading arising from the wave structure interaction current work is primarily focused on the influence of the linear vibration transmission of the cutter suction dredger subjected to wave loading and impulsive force understanding the vibration transmission on the cutter shaft subject to dynamic loads is important for the fatigue life of the system the study would be carried out on a scaled theoretical model of the assembled system the purpose of the study will be to understand the influence of cutter shaft dimension on the high vibration and possible mitigation measures by altering the coupling strength of the universal joint 2 system description a scaled model of a cutter suction dredger is developed to understand the system dynamics https 2018 the scaled model was implemented to develop in future a hardware in the loop for the spud soil and the hull system a hybrid approach song et al 2020 tomasicchio et al 2018 börner and alam 2015 was adopted for scaling of the system the scaling of the model could not be carried out using a single scaling law due to the dimensional constraints of the in house towing tank considering the dimensions of the in house towing tank a geometrical scale factor λ of 1 4 was adopted since the dredge hull will mostly be subject to rigid body motion a froude scaling is adopted however for the spud and cutter shaft assembly subjected to flexural load cauchy scaling is adopted chakrabarti 2002 2 1 modelling of dredge hulls dredge hull is a major part of the cutter suction dredger and is scaled using froude scaling as given in table 1 and fig 2 there are two attachments provided on the hull for the spud the central attachment is provided with a groove for the working spud which is attached to a carriage and dredges in concentric circle known as stepping as the carriage moves during operation lamb 2004 auxiliary spud is offset from the centreline of the vessel the auxiliary spud is used to position the vessel when the working spud is raised since during the cutting action only the working spud is operational the auxiliary spud is not modelled in the current study the dredge hull undergoes rigid body motion in the six degrees of freedom when subjected to ocean waves the response of the hull subjected to wave loading can be determined using wamit wave analysis massachusetts institute of technology lee and newman 2013 wamit is a boundary element modelling package for numerical analysis of interaction between floating or submerged structure and waves the underwater hull is modelled in rhinoceros rhinoceros 2018 and exported to wamit the six dof degrees of freedom response of the hull is obtained using wamit after solving the diffraction radiation problem assuming potential flow based on panel method the hull was subjected to a scaled wave height of 20 cm with different periods from 0 5 s to 5 s under head sea condition fig 3 shows the rao response amplitude operator transfer function computed from wamit for the heave and pitch motion for different wave encounter frequencies rao provided the response amplitude corresponding to each wave excitation frequency for unit force input mainly heave and pitch were considered since under head sea condition these motions would be most influenced by the spud imposed restraint as expected the encountering frequency corresponding to maximum heave and pitch are different from the result it is found that both the heave and pitch raos are comparatively higher at the frequency of 2 855 rad s therefore to analyse the effectiveness of the spud restraint the above wave parameter was considered as the excitation frequency 2 2 modelling of spud with soil the working spud restraints the motion of the hull by anchoring into the soil the soil spud system was modelled as shown in fig 4 using ansys ansys mechanical 2017 the spud is embedded within a cylindrical pit of 1 m deep and 2 m wide filled with clayey sand see table 2 clayey sands have low plasticity low compressibility and high strength under loads its specific gravity is 2 5 and the water content level is 10 the wave forces acting on the spud is calculated using morison s equation sarpkaya 2010 the inertia and drag forces are calculated using eqs 1 and 2 at each nodal point accounting for the variation in water particle velocity with water depth and provided as an external force the heave and pitch responses from the dredge hull are applied as a harmonic acceleration on the spud in vertical direction and angular acceleration respectively as shown in fig 4 this ensures a kinematic continuity across the spud hull interface a transient analysis of 30 s was carried out including wave forces and rigid body response of the hull the corresponding temporal response of the spud assembly in the surge direction of the dredge hull is shown in fig 5 the initial transients are due to the flexural modes of the spud a system identification was carried out using the temporal response and a single dof system in the surge direction was identified next the sdof system is coupled to the cutter shaft assembly 1 f i t ρ c m π 4 d 2 a ω 2 cosh k z h sinh k h sin ω t 2 f d t 1 2 ρ c d d a 2 ω 2 cosh 2 k z h sinh 2 k h cos ω t cos ω t where ρ is the density of water c m is the inertia coefficient c d is the drag coefficient d is the diameter of the spud a is the amplitude of water wave ω is the wave frequency h is the water depth g is the acceleration due to gravity and z is the water depth at a particular nodal point 2 3 modelling of dredge cutter shaft a theoretical model of the individual shafts of the cutter suction dredger was developed using finite element analysis paz and leigh 1985 each shaft was considered as an euler bernoulli beam with five degrees of freedoms per node as shown in fig 6 the corresponding elemental mass and stiffness matrices are given below 3 4 the cutter shaft assembly is free at one end and supported on a roller at the other end the roller is coupled to the surge dof as shown in fig 7 the wave forces acting on the cutter shaft assembly is estimated using morison s equations sarpkaya 2010 the morison s equation for the forces acting on an oscillating cylindrical structure of diameter d and length l is given as 5 f t 1 2 ρ c d d l u x u x ρ c a a l u x ρ a l u where the water particle velocity is 6 u a g k ω cosh k h z cosh k h cos k x ω t where c a is added mass coefficient x is the structure displacement a is the surface area of the structure and k is the wave number the force acting on the structure is non linear due to the drag force the primary shaft mass stiffness matrix and the force vector is transformed using rotation matrix to account for the inclination the transformed system satisfies frame indifference gonzalez and stuart 2008 universal joint is modelled as a localised spring element of high stiffness the structural damping was assumed to be proportional rayleigh damping the global system of equation incorporating the wave forces is obtained as 7 m m a x t c x t k x t φ x f t where m a is the added mass matrix for the cylindrical shaft φ x 1 2 ρ c d u x u x is the non linear drag force and f t ρ c a a l u ρ a l u the system of equation is transformed in modal coordinates as 8 m ψ q t c ψ q t k ψ q t φ q ψ t f t where m ψ is the modal mass matrix k ψ is the modal stiffness matrix and c ψ is the damping matrix in modal coordinate and ψ is the mode shape vector a statistical linearisation is carried out on the drag force to obtain the equivalent linearised additional damping to account for the drag force the equivalent linear parameter is determined by minimising the expectation of euclidean error norm between the non linear and equivalent linear system roberts and spanos 1990 corresponding to each dof assuming a gaussian wave spectrum s ω the linearised equivalent damping is obtained based as 9 c e ψ t 1 2 ρ c m π d e d d x u x u x 1 2 ρ c m π d 8 π σ q e u ψ 2 2 σ q 2 2 u ψ erf u ψ 2 σ q the standard deviation of the velocity can be obtained from the transfer function h ω as 10 σ q 2 ω 2 h ω 2 s ω d ω where h ω n ψ i n ψ j n ω n 2 ω 2 2 i ζ ω n ω the equivalent damping matrix is determined iteratively solving eqs 9 and 10 the drag force transforms as an equivalent linear parameter matrix c e added to the rayleigh damping matrix thus the equivalent linear system of equation becomes 11 m ψ q t c ψ c e q t k ψ q t ψ t f t depending on the relative lengths between the two subsystems the spacing between natural frequencies of individual subsystems could be altered this results in variation in the interaction of modes of the individual subsystems 3 parametric study on cutter shaft assembly the natural frequency of the system as expected with reduction in length increases table 3 shows the variation in frequency of individual subsystems for each length only the frequencies within the bandwidth 500 hz are shown the limit was chosen considering the bandwidth of impulsive load provided on the cutter shaft the asymmetry in the frequencies of the bending in two plane is due to the presence of roller in one of the bending planes and also due to the head sea condition added mass effect is present only in one plane the frequencies indicate that modes of different symmetry approach each other with the variation in length this could cause high acceleration level within the coupled system vijayan and woodhouse 2014 2013 such as the cutter shaft assembly 3 1 effect of shaft dimension two shafts of different lengths were coupled using a universal joint a variation in length of the shaft was carried out to understand the influence of modal interaction generally for nearly same length even though frequencies are close modal interactions are expected to be less since the modes of the system have same symmetry however with the mistuning of subsystem dimensions or boundary conditions the possibility of interaction between modes of different symmetry which are close in frequencies increases the mode shape of the coupled system is shown in fig 8 the mode shapes indicates that the universal joints nearly constraints the system at the encircled location another observation is that modes are both local and global for both the orthogonal planes of bending the presence of local or global mode depends on the level of modal interaction 3 2 effect of coupling strength of universal joint these modal interactions can result in high acceleration and failure of the cutter shaft therefore possible measure to mitigate the high acceleration need to be resorted a possible approach could be to vary the coupling strength of the universal joint the linearised equation of motion of the system was converted to state space model as 12 0 i k ψ m ψ c ψ c e m ψ q q 0 f i n e r t i a q q the transient response of the system was obtained after transforming to physical coordinate the transient loading is provided as an initial velocity in the lateral and torsional direction with a bandwidth spanning 500 hz this is carried out to emulate the cutting action of the cutter the coupling strength of the springs forming the universal joint was varied and the maximum acceleration observed across the cutter shaft assembly was noted for the same length of primary and secondary shafts as expected the frequencies will be close to each other across the subsystems and due to asymmetry in the boundary conditions the possibility of modal interaction improves the change in dimension alters the situation and approaching of modes of further asymmetric becomes possible the initial condition in the lateral direction was varied to understand the influence of input excitation bandwidth on the acceleration response from fig 9 it can be observed that a lower coupling strength would cause a higher acceleration this could be attributed to the lower frequency spacing between adjacent modes for low coupling strength however as the dimensional mismatch between the shafts becomes large corresponding to lower length ratios the acceleration ratio reduces this could be due to the less likelihood of having closer modes across the subsystem within the bandwidth of excitation 4 conclusions for making the dredging operation smooth and economical an attempt has been taken to understand the vibration characteristics of cutter suction dredger the dredge hull spud and the cutter shaft were analysed for different environmental condition the dredge hull is designed in rhinoceros and analysed for head sea in wamit the critical wave parameter was found where the heave and pitch raos are comparatively high a transient analysis of the soil spud system dynamics was carried out in ansys corresponding to the critical wave excitation including rigid body dynamics of the hull in the pitch and heave direction the dynamics of spud hull assembly was identified in the surge direction using the transient response the surge model was coupled to the cutter shaft assembly dynamics a statistically linearised model of the assembly was developed by linearising the morison s equation drag force a parametric study was carried out varying the relative dimensions of primary and secondary shaft the possibility of interaction between close asymmetric modes of the primary and secondary subsystem was identified a state space model of the linearised system was developed and the variation of maximum response along the length of the shaft was identified the result from the parametric study for the primary and secondary shaft of different length indicated that a weak coupling could lead to a higher response due to modal interaction credit authorship contribution statement k vijayan conceptualization methodology software writing review editing formal analysis fund acquisition c r barik formal analysis methodology software writing review editing o p sha conceptualization supervision reviewing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement dr kiran vijayan gratefully acknowledge the support and funding received for the work from serb under project no ecr 2016 001531 
20639,the dredger operation extended from protected water to harsher environments in recent years this resulted in a change in design strategy understanding these complex dynamic interaction during the dredging operation using a cutter suction dredger csd can improve the production by reducing the downtime csd consists of the dredge hull spud and the cutter shaft a hybrid scaled model of the csd is developed using froude and cauchy scaling for the different section of the csd the assembly was modelled in two sections the spud hull assembly dynamics was modelled using wamit and ansys the system was identified and reduced to a sdof in the surge direction the surge dynamics was coupled to the cutter shaft assembly using a roller support wave excitation acting on the assembly was determined using statistically linearised morison equation the assembly was linearised in frequency domain and transformed to state space and the temporal response was determined a parametric study was carried out to understand the influence of the relative shaft dimensions and the coupling strength on the vibration transmission when subjected to an impulsive load the results from the study indicated that shaft dimension asymmetry and coupling strength influences the vibration transmission keywords froude scaling cauchy scaling curve veering statistical linearisation 1 introduction dredging is the removal of sediments and debris from the bottom of lakes rivers harbours and the other water bodies it is a routine necessity in waterways because sedimentation gradually fills the channels and harbours it is usually required to maintain or increase the depth of navigation channels anchorages or berthing areas for safe passage of boats and ships dredging mainly can be classified into two category namely mechanical and hydraulic dredger cutter suction dredger is a hydraulic dredger the layout of the cutter suction dredger system is shown in fig 1 the dredger consists of hull spud and the cutter shafts the cutter shafts basically transmit power from the prime mover to the cutter it consists of two shafts of different lengths coupled using a universal joint major parameters influencing the performance and workability are hull characteristics restraint imposed by the spud and the dynamics of the spud and cutter shafts an estimation of the response due to restraint imposed on the dredger hull from the spud can provide insights on the vibration transmission during the dredging operation keuning and journee 1983 analysed the dynamics of the cutter suction dredger in irregular waves a mathematical model was developed including the effect of cutter ladder mooring lines spud pole wave excitation forces current forces and viscous roll damping the results from the computational study indicated that the behaviour of dredge is heavily influenced by non linear characteristics of soil khodair and abdel mohti 2014 analysed pile soil interaction subjected to both axial and lateral loading the results from the study indicated that there were reductions in the induced bending moment and lateral displacement by increasing the amount of clay surrounding the piles zachert et al 2016 demonstrated the effect of soil structure interaction due to cyclic loading on foundations for offshore wind turbines soil was modelled using high cycle accumulation hca model a considerable redistribution of contact pressure was observed due to the inhomogeneous accumulation of strain from the cyclic loading lopez querol et al 2017 provides a summary of numerical methods such as p y method finite element method fem and discrete element method dem for long term prediction of offshore wind turbine foundation the deficiency associated with p y method used by american petroleum institute api code or offshore piles are described randolph and gourvenec 2011 p y method underestimates the lateral displacement in comparison to fem for higher load cycles a description on the plastic phenomenon associated with cyclic loading such as adaptation accommodation and ratcheting is provided the implementation of kinematic hardening in fem to model plastic ratcheting is described estimation of the wave induced forces on the offshore structures can be carried out using morison s equation in addition to non linear response due to large deformation the flexibility of the structure generates non linear hydrodynamic forces patel 2013 various author najafian et al 2000 terro and abdel rohman 2007 chang and tung 1990 chakrabarti 1987 have carried out research studies on linearising the morison equation overlooking or ignoring the errors arising from the approximations anagnostopoulos 1982 attempted a linearised solution based on an approximation that lags structural velocity by one time step when forming load vector and neglecting relative velocity chang and tung 1990 carried out an analysis on a seven floor offshore tower linearising morison equation using stochastic linearisation the response statistics of the offshore structure was obtained assuming a linear gaussian narrow banded waves the error estimate indicated that the linearised equation can be used to advantage for preliminary design terro and abdel rohman 2007 presented a comparative analysis of linear and non linear morison equation by predicting a modification to linearise the non linear morison equation the modified form provided better estimation to the wave induced forces the results were validated against the results of the traditional linear and non linear form of equation during excavating material from sea bed surface using cutter suction dredger it is very important to know about the forces exerted on the cutter young and randall 2009 developed an experimental set up to estimate the forces in horizontal vertical and axial direction a static analysis was carried out on the carriage by the application of static loads to the cutter head in horizontal vertical and axial directions yasheng et al 2001 analysed the 3 d cutting forces on the cutter head the emphasis was laid on the blade cutting forces with the small cutting angle within saturated sand the pressure distribution was estimated and compared with experimental results miedema et al 1983 carried out experiment for the soil cutter head interaction subjected to wave loading it was observed that the load on the cutter head can be reduced by operating at a low swing velocities and higher cutter revolution hence it is important to get the knowledge about the soil reaction forces on the cutter however for the present study the effect of cutter soil interaction is not considered the vibrations from the dredging of soil is transmitted through the cutter shafts to the dredge hull assembly the cutter shaft assembly can be considered as two shafts subsystems coupled using universal joints in order to differentiate the two shafts of the cutter shaft in further discussions the inclined shafts will be referred as the primary shaft and the straight shaft attached to the dredge hull as secondary generally for many of the coupled systems when subjected to impulsive loading worst case scenario of high acceleration was linked to a phenomenon known as curve veering kuttler and sigillito 1981 leissa 1974 perkins and mote 1986 vijayan and woodhouse 2014 2013 this can reduce the life of the cutter shaft assembly and increase the downtime dredging operation has extended in recent years gradually from protected waters to harsher environment the design strategy therefore should account for the additional loading arising from the wave structure interaction current work is primarily focused on the influence of the linear vibration transmission of the cutter suction dredger subjected to wave loading and impulsive force understanding the vibration transmission on the cutter shaft subject to dynamic loads is important for the fatigue life of the system the study would be carried out on a scaled theoretical model of the assembled system the purpose of the study will be to understand the influence of cutter shaft dimension on the high vibration and possible mitigation measures by altering the coupling strength of the universal joint 2 system description a scaled model of a cutter suction dredger is developed to understand the system dynamics https 2018 the scaled model was implemented to develop in future a hardware in the loop for the spud soil and the hull system a hybrid approach song et al 2020 tomasicchio et al 2018 börner and alam 2015 was adopted for scaling of the system the scaling of the model could not be carried out using a single scaling law due to the dimensional constraints of the in house towing tank considering the dimensions of the in house towing tank a geometrical scale factor λ of 1 4 was adopted since the dredge hull will mostly be subject to rigid body motion a froude scaling is adopted however for the spud and cutter shaft assembly subjected to flexural load cauchy scaling is adopted chakrabarti 2002 2 1 modelling of dredge hulls dredge hull is a major part of the cutter suction dredger and is scaled using froude scaling as given in table 1 and fig 2 there are two attachments provided on the hull for the spud the central attachment is provided with a groove for the working spud which is attached to a carriage and dredges in concentric circle known as stepping as the carriage moves during operation lamb 2004 auxiliary spud is offset from the centreline of the vessel the auxiliary spud is used to position the vessel when the working spud is raised since during the cutting action only the working spud is operational the auxiliary spud is not modelled in the current study the dredge hull undergoes rigid body motion in the six degrees of freedom when subjected to ocean waves the response of the hull subjected to wave loading can be determined using wamit wave analysis massachusetts institute of technology lee and newman 2013 wamit is a boundary element modelling package for numerical analysis of interaction between floating or submerged structure and waves the underwater hull is modelled in rhinoceros rhinoceros 2018 and exported to wamit the six dof degrees of freedom response of the hull is obtained using wamit after solving the diffraction radiation problem assuming potential flow based on panel method the hull was subjected to a scaled wave height of 20 cm with different periods from 0 5 s to 5 s under head sea condition fig 3 shows the rao response amplitude operator transfer function computed from wamit for the heave and pitch motion for different wave encounter frequencies rao provided the response amplitude corresponding to each wave excitation frequency for unit force input mainly heave and pitch were considered since under head sea condition these motions would be most influenced by the spud imposed restraint as expected the encountering frequency corresponding to maximum heave and pitch are different from the result it is found that both the heave and pitch raos are comparatively higher at the frequency of 2 855 rad s therefore to analyse the effectiveness of the spud restraint the above wave parameter was considered as the excitation frequency 2 2 modelling of spud with soil the working spud restraints the motion of the hull by anchoring into the soil the soil spud system was modelled as shown in fig 4 using ansys ansys mechanical 2017 the spud is embedded within a cylindrical pit of 1 m deep and 2 m wide filled with clayey sand see table 2 clayey sands have low plasticity low compressibility and high strength under loads its specific gravity is 2 5 and the water content level is 10 the wave forces acting on the spud is calculated using morison s equation sarpkaya 2010 the inertia and drag forces are calculated using eqs 1 and 2 at each nodal point accounting for the variation in water particle velocity with water depth and provided as an external force the heave and pitch responses from the dredge hull are applied as a harmonic acceleration on the spud in vertical direction and angular acceleration respectively as shown in fig 4 this ensures a kinematic continuity across the spud hull interface a transient analysis of 30 s was carried out including wave forces and rigid body response of the hull the corresponding temporal response of the spud assembly in the surge direction of the dredge hull is shown in fig 5 the initial transients are due to the flexural modes of the spud a system identification was carried out using the temporal response and a single dof system in the surge direction was identified next the sdof system is coupled to the cutter shaft assembly 1 f i t ρ c m π 4 d 2 a ω 2 cosh k z h sinh k h sin ω t 2 f d t 1 2 ρ c d d a 2 ω 2 cosh 2 k z h sinh 2 k h cos ω t cos ω t where ρ is the density of water c m is the inertia coefficient c d is the drag coefficient d is the diameter of the spud a is the amplitude of water wave ω is the wave frequency h is the water depth g is the acceleration due to gravity and z is the water depth at a particular nodal point 2 3 modelling of dredge cutter shaft a theoretical model of the individual shafts of the cutter suction dredger was developed using finite element analysis paz and leigh 1985 each shaft was considered as an euler bernoulli beam with five degrees of freedoms per node as shown in fig 6 the corresponding elemental mass and stiffness matrices are given below 3 4 the cutter shaft assembly is free at one end and supported on a roller at the other end the roller is coupled to the surge dof as shown in fig 7 the wave forces acting on the cutter shaft assembly is estimated using morison s equations sarpkaya 2010 the morison s equation for the forces acting on an oscillating cylindrical structure of diameter d and length l is given as 5 f t 1 2 ρ c d d l u x u x ρ c a a l u x ρ a l u where the water particle velocity is 6 u a g k ω cosh k h z cosh k h cos k x ω t where c a is added mass coefficient x is the structure displacement a is the surface area of the structure and k is the wave number the force acting on the structure is non linear due to the drag force the primary shaft mass stiffness matrix and the force vector is transformed using rotation matrix to account for the inclination the transformed system satisfies frame indifference gonzalez and stuart 2008 universal joint is modelled as a localised spring element of high stiffness the structural damping was assumed to be proportional rayleigh damping the global system of equation incorporating the wave forces is obtained as 7 m m a x t c x t k x t φ x f t where m a is the added mass matrix for the cylindrical shaft φ x 1 2 ρ c d u x u x is the non linear drag force and f t ρ c a a l u ρ a l u the system of equation is transformed in modal coordinates as 8 m ψ q t c ψ q t k ψ q t φ q ψ t f t where m ψ is the modal mass matrix k ψ is the modal stiffness matrix and c ψ is the damping matrix in modal coordinate and ψ is the mode shape vector a statistical linearisation is carried out on the drag force to obtain the equivalent linearised additional damping to account for the drag force the equivalent linear parameter is determined by minimising the expectation of euclidean error norm between the non linear and equivalent linear system roberts and spanos 1990 corresponding to each dof assuming a gaussian wave spectrum s ω the linearised equivalent damping is obtained based as 9 c e ψ t 1 2 ρ c m π d e d d x u x u x 1 2 ρ c m π d 8 π σ q e u ψ 2 2 σ q 2 2 u ψ erf u ψ 2 σ q the standard deviation of the velocity can be obtained from the transfer function h ω as 10 σ q 2 ω 2 h ω 2 s ω d ω where h ω n ψ i n ψ j n ω n 2 ω 2 2 i ζ ω n ω the equivalent damping matrix is determined iteratively solving eqs 9 and 10 the drag force transforms as an equivalent linear parameter matrix c e added to the rayleigh damping matrix thus the equivalent linear system of equation becomes 11 m ψ q t c ψ c e q t k ψ q t ψ t f t depending on the relative lengths between the two subsystems the spacing between natural frequencies of individual subsystems could be altered this results in variation in the interaction of modes of the individual subsystems 3 parametric study on cutter shaft assembly the natural frequency of the system as expected with reduction in length increases table 3 shows the variation in frequency of individual subsystems for each length only the frequencies within the bandwidth 500 hz are shown the limit was chosen considering the bandwidth of impulsive load provided on the cutter shaft the asymmetry in the frequencies of the bending in two plane is due to the presence of roller in one of the bending planes and also due to the head sea condition added mass effect is present only in one plane the frequencies indicate that modes of different symmetry approach each other with the variation in length this could cause high acceleration level within the coupled system vijayan and woodhouse 2014 2013 such as the cutter shaft assembly 3 1 effect of shaft dimension two shafts of different lengths were coupled using a universal joint a variation in length of the shaft was carried out to understand the influence of modal interaction generally for nearly same length even though frequencies are close modal interactions are expected to be less since the modes of the system have same symmetry however with the mistuning of subsystem dimensions or boundary conditions the possibility of interaction between modes of different symmetry which are close in frequencies increases the mode shape of the coupled system is shown in fig 8 the mode shapes indicates that the universal joints nearly constraints the system at the encircled location another observation is that modes are both local and global for both the orthogonal planes of bending the presence of local or global mode depends on the level of modal interaction 3 2 effect of coupling strength of universal joint these modal interactions can result in high acceleration and failure of the cutter shaft therefore possible measure to mitigate the high acceleration need to be resorted a possible approach could be to vary the coupling strength of the universal joint the linearised equation of motion of the system was converted to state space model as 12 0 i k ψ m ψ c ψ c e m ψ q q 0 f i n e r t i a q q the transient response of the system was obtained after transforming to physical coordinate the transient loading is provided as an initial velocity in the lateral and torsional direction with a bandwidth spanning 500 hz this is carried out to emulate the cutting action of the cutter the coupling strength of the springs forming the universal joint was varied and the maximum acceleration observed across the cutter shaft assembly was noted for the same length of primary and secondary shafts as expected the frequencies will be close to each other across the subsystems and due to asymmetry in the boundary conditions the possibility of modal interaction improves the change in dimension alters the situation and approaching of modes of further asymmetric becomes possible the initial condition in the lateral direction was varied to understand the influence of input excitation bandwidth on the acceleration response from fig 9 it can be observed that a lower coupling strength would cause a higher acceleration this could be attributed to the lower frequency spacing between adjacent modes for low coupling strength however as the dimensional mismatch between the shafts becomes large corresponding to lower length ratios the acceleration ratio reduces this could be due to the less likelihood of having closer modes across the subsystem within the bandwidth of excitation 4 conclusions for making the dredging operation smooth and economical an attempt has been taken to understand the vibration characteristics of cutter suction dredger the dredge hull spud and the cutter shaft were analysed for different environmental condition the dredge hull is designed in rhinoceros and analysed for head sea in wamit the critical wave parameter was found where the heave and pitch raos are comparatively high a transient analysis of the soil spud system dynamics was carried out in ansys corresponding to the critical wave excitation including rigid body dynamics of the hull in the pitch and heave direction the dynamics of spud hull assembly was identified in the surge direction using the transient response the surge model was coupled to the cutter shaft assembly dynamics a statistically linearised model of the assembly was developed by linearising the morison s equation drag force a parametric study was carried out varying the relative dimensions of primary and secondary shaft the possibility of interaction between close asymmetric modes of the primary and secondary subsystem was identified a state space model of the linearised system was developed and the variation of maximum response along the length of the shaft was identified the result from the parametric study for the primary and secondary shaft of different length indicated that a weak coupling could lead to a higher response due to modal interaction credit authorship contribution statement k vijayan conceptualization methodology software writing review editing formal analysis fund acquisition c r barik formal analysis methodology software writing review editing o p sha conceptualization supervision reviewing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement dr kiran vijayan gratefully acknowledge the support and funding received for the work from serb under project no ecr 2016 001531 
