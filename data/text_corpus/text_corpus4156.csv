index,text
20780,this paper presents a full scale experimental investigation to study the nonlinear dynamic stiffness of high modulus polyethylene hmpe fibre rope under long term cyclic loading three kinds of ropes with different constructions and diameters were selected as test samples the influences of mean load and load amplitude on axial stiffness and the corresponding evolution process were respectively studied the experimental results showed that various braided ropes dynamic stiffness was slightly different which was mainly caused by the different twist angles furthermore the non dimensional stiffness of small scale rope was lower than the large samples to some extent this should be related to the small scale ropes without an outer jacket were much softer and thus had more distinct deformation the validations against two existing empirical expressions have also been performed the results pointed out that these equations had some errors predicting the evolution procedure of the dynamic stiffness and the magnitude of small scale sample s stiffness on these accounts a set of empirical expressions taking into account braid constructions diameter and input load conditions has been newly derived the comparison against the present experimental results proved its good reliability keywords synthetic fibre rope hmpe experiment dynamic stiffness deep sea equipment mooring line 1 introduction deepwater equipment has made numerous breakthroughs in exploring and exploiting ocean resources particularly with the service of synthetic fibre ropes in the systems of mooring and deployment and recovery compared with steel wires and chains fibre ropes have a more excellent strength to weight ratio and require lower maintenance and handling costs foster 2002 while on the other hand the tension elongation relationship of fibre ropes shows significant nonlinearity and is time dependent to the long term loading because of the inherent visco elasticity and visco plasticity of fibre materials in this regard great efforts have been made to investigate their mechanical characteristics to establish a better foundation for the analysis in structural mooring performance dynamic and hydrodynamic response etc one main issue for the mechanical characteristic of fibre ropes is their axial stiffness under dynamic loading unlike steel chains and wires the tensile stiffness of fibre ropes is commonly assumed to depend on two main factors the rope itself factor of material and the loading factors of average amplitude period and the number of the load cycle etc on this account numerous works have been conducted to obtain the empirical expressions for the dynamic stiffness del vecchio 1992 first proposed the polynomials for two kinds of small diameter polyester ropes and the corresponding yarns through a series of experiments the influences of mean load load amplitude and load frequency were respectively considered a group of comparative experiments was then conducted by bosman and hooker 1999 to investigate the diversity between the dynamic moduli of full size rope and its corresponding lower sub rope as the tested ropes were parallel construction its dynamic modulus could thus be extrapolated by the sub rope françois and davies 2008 conducted a load elongation experiment using a full scale parallel construction polyester rope with 800t breaking strength and its corresponding sub rope with 70t breaking strength quasi static loads were considered and the results showed little difference in stiffness between the rope and the sub rope apart from the difference in diameter the main difference between the full scale and the small scale ropes is that the full scale samples have the same construction as those used in practice the theoretical conclusions can thus be directly adopted without a conversion factor in contrast the smaller ropes cost less in tests while the findings may be affected by their simplified construction from what has been mentioned above it can be known that although the dynamic differences between full scale and small diameter samples have been preliminarily concerned there are still several blanks needed to be fulfilled one remaining issue is that the full scale ropes in those studies were mainly parallel construction so that the inner sub ropes were subjected to tension independently and evenly therefore the strength of sub ropes could thus be easily deduced by the full scale integrated ropes however the interaction force compression and abrasion within the braided arrangement of sub ropes see fig 1 may have a more critical effect on the elongation characteristic on this account the hypothesis that the modulus of a smaller sub rope is similar to that of full scale rope may not be directly adopted in the cases of braided ropes beltran 2006 proposed a numerical model for synthetic fibre ropes taking into account the braid construction and the corresponding friction among elements the elongation of polyester ropes with various damaged components in response to static loads was predicted while the long period dynamic stiffness under cyclic load has not been involved the prolonged loading such as cyclic load and creep load with an extended period of time whose duration dominates in affecting the tensile characteristics has a more apparent influence with the increasing duration however whether the stiffness magnitude of a full scale braided rope particularly its evolution under long term dynamic load can be precisely predicted by smaller braided rope is still ambiguous goksoy 1986 and flory et al 1988 first developed a small test machine to investigate the yarn on yarn abrasion the yarn was twined over itself through a set of pulleys and was drawn back and forth under the tension supplied by a weight by measuring the tension at both ends of the tested yarn the friction coefficient was obtained by similar methods various works have been further performed such as chakladar et al 2014 hobbs and ridge 2018 and chevillotte et al 2020 some studies have also been conducted to investigate the friction and abrasion of fibre fabric at a more microcosmic level e g dong and sun 2009 and mulvihill et al 2017 the above works main objective was to investigate the friction and abrasion properties of various fibre materials although the molecular morphology has been proven to be significantly affected by the loading and twist angle the final reflection on the elongation induced by different sizes and configurations remains verified polyester ropes have been well studied in the last two decades typical works include banfield and casey 1998 fernandes et al 1999 and the above papers as another type of synthetic fibre rope high modulus and high tenacity fibre ropes e g high modulus polyethylene hmpe ropes are getting more attention in deep and ultra deep water applications because of the larger ratio of minimum break load to diameter however few published works related to their dynamic stiffness were available to date davies et al 2002 conducted a series of experiments focusing on the tension elongation behaviours of aramid polyester and hmpe ropes with large diameters under cyclic loading they first established a set of empirical equations only considering the influence induced by the input load s average magnitude liu et al 2014 lian et al 2017 2018 further paid close attention to the variation procedure of the axial stiffness under cyclic load using six groups of samples with small diameters they proposed a series of empirical expressions consisting of the terms of load average amplitude and duration three materials and two diameters of 6 mm and 8 mm were respectively concerned and the differences of dynamic stiffness caused by rope size were preliminarily considered whereas there were still two main issues needed to be addressed one was that those two sizes were both small and the difference was less noticeable as a result the influences caused by the rope sizes were only reflected in the numbers of diameters however the small ropes are normally much softer than large ropes which may lead to a more significant variation in response to the same non dimensional tension another issue was that the tested hmpe samples had the same construction the twist angles also vary for different braided ropes which should have an apparent influence on the inner abrasion and further affect dynamic stiffness under various load conditions in these regards the stiffness difference between full and small scale ropes is believed not to be thoroughly investigated to this end comparative experiments presented in this paper aims to study the long term axial tensile properties of hmpe ropes and further model their stiffness under cyclic dynamic loads with empirical equations three types of braided ropes were selected through which the diversity caused by both the rope configurations and the input load conditions can be investigated section 2 gives the details of the experimental setups and the tested samples section 3 provides the input conditions and performs a primary analysis to study the tensile characteristic under different load conditions in section 4 the dynamic stiffness in the present test is calculated and the empirical predictions using two existing expressions are then carried out the comparisons among different loads ropes and empirical expressions are respectively performed and the influences caused by mean tension tension amplitude rope size and configuration are explained afterwards new empirical expressions containing the external loading factors and the rope factors are further fitted in section 5 finally the conclusions are drawn in section 6 2 experimental descriptions the experiments were conducted at the laboratory of zhejiang four brothers rope co ltd under the environment of room temperature of 26 c and 65 humidity the input tension was provided by an 8 m long tensile machine with a capacity of 500 kn and a maximum error of 0 5 the tensile machine s free end could be in both single direction and simple harmonic motion to generate static and dynamic loads on test samples the displacement sensor at the free end and an extensometer were used to continuously record the elongation δl in each case at the frequency of 4 times per second as shown in fig 2 as the tension was recorded separately by two systems the elongation results have been mutually validated three types of braided hmpe ropes manufactured by four brothers rope co ltd were selected as test samples the fibre was produced by dsm trosar table 1 gives the detailed specifications where samples a and b were the typical full scale ropes and covered by the 2 12 hmpe braided jacket see fig 3 a and fig 3 b and the smaller sample c was without the jacket see fig 3 c each eye splice of full scale samples a and b was about 490 mm long and the length of eye splice of samples c was about 150 mm the pitch length and the twist angle were 90 mm and 11 9 deg for sample a 90 mm and 8 9 deg for sample b 20 mm and 11 3 deg for sample c the sample in each case was new and tested in a dry state a bedding in process was performed for each sample before conducting the case study to obtain stable and accurate experimental results the detailed procedure is listed as follows 1 a pretension of 2 minimum breaking strength mbs was imposed after installing each sample a gauge length of l0 1000 mm was first set at the middle of the sample by setting two extensometers out of the splice parts 2 the tension was increased to 20 mbs by moving the free end at a rate of s 50 mm min and held at 20 mbs for 30 min 3 one hundred times cyclic loads were then imposed with mean value t m 20 mbs amplitude t a 10 mbs and varying rate of free end s 200 mm min after the cyclic loads ended the load was decreased to 2 mbs and the bedding in process finished the strain was reset as δl l 0 and the length l between the extensometer was recorded as the original length in the following case studies 3 experimental results 3 1 minimum breaking strength the static strength test was performed to determine the minimum breaking strength mbs of each sample in the first place the values of mbs for the bedding in process were temporarily the rated minimum breaking strength in table 1 after the pre stretching the input load was increased by the free end shifting at the rate of s 30 mm min as given in table 2 all the measured mbs was greater than the rated minimum breaking strength moreover all the rupture occurred away from the junctions of eye splices as shown in fig 4 proving that the present results were appropriate and reasonable thus the mbs in the following dynamic tests was set as those values 3 2 tension versus strain under different mean tension after the bedding in process the dynamic loading was imposed by the harmonic movement of the free end since the frequency of external load has less influence on the dynamic stiffness davies et al 2002 and liu et al 2014 the shifting rate of free end the dynamic test was set as s 100 mm min thus differences existed in the finished time of each case firstly three cases were set to study the effects of mean tension t m on the tensile characteristics the details are listed in table 3 fig 5 shows that after the bedding in processes the strain δl l of three samples gradually increased with the average tension t m the results during the first and last ten cycles are then presented separately in fig 6 in all these cases hysteresis loops were more evident in the first ten cycles indicating that the strain in response to cyclic tension gradually became stable with the increasing duration furthermore the differences between the last and first ten tension strain cycles were the greatest in case 3 and the smallest in case 1 therefore the accumulation of the residual strain has been proved to be more obvious during the initial stage and its magnitude increases with t m according to the present results all braided ropes strain values increased with t m the strain values of samples b and c during the last ten cycles were greater than that of sample a in fig 6 which indicated that inner components of 1 12 samples with a larger diameter and twist might render the integrated ropes resistant residue strain 3 3 tension versus strain under different tension amplitude based on case 2 two more load conditions were set to investigate the tensile characteristics of hmpe ropes under dynamic loads with different amplitudes as listed in table 4 fig 7 gives the time histories of input loads and the corresponding strain the present results also pointed out that the average strain increased with t a while the non dimensional strain was less affected by the rope constructions fig 8 gives the curves of strain δl l as a function of tension t during the first and last ten cycles following the conclusion in sub section 3 2 the present results further showed that the residual strain increased with load amplitude and gradually became stable with the increasing load cycles on the other hand the most significant gradient was found in case 2 and the smallest for case 5 this indicated that the samples had a poor ability to resist the dynamic deformation under large amplitude 4 dynamic stiffness calculation the non dimensional dynamic stiffness kr in each loading cycle n was computed through the following equation 1 k r t p t t mbl δ l p δ l t l where t p and t t are the peak and trough of tension in each cycle δl p and δl t represent the peak and trough of elongation respectively 4 1 cases of mean load the effects of mean load t m on dynamic stiffness are shown in fig 9 a more obvious increment of stiffness kr occurred in the prior cycles after that the stiffness in all cases gradually became stable for the influences caused by t m the gradient of each tension strain loop in case 1 was the smallest and thus kr increased with t m as depicted in fig 9 the present results showed that the stiffness magnitudes of the three samples varied with diameters and constructions when the input load was at a lower level i e case 1 depicted in fig 9 a sample b s stiffness was much greater than that of sample a this might be related to the smaller twist of sample b thus the components directions were much closer to the horizontal axial load leading to a greater strength under the condition of lower tension however with the increasing stiffness of sample a due to the rising mean load the dynamic difference between those two samples gradually decreased as shown in fig 9 c this is because the twist angles between the axis and inner components of both full scale ropes decreased with the increasing tension and both twist values got closer under the large external loading which was reflected in a better strength of sample a under a higher tension level rather than lower tension for sample c with a smaller diameter the results pointed out that its non dimensional dynamic stiffness was nearly 10 15 lower than sample a in all present cases except for the few strength supplied by the braided jacket this phenomenon should be attributed to that the small rope was softer and slacker than those large scale ropes as a result the axial tensile deformability was enlarged and the non dimensional strength of the small scale sample was slightly worse the present experimental results were adopted to validate two existing empirical expressions for hmpe rope one was established by the full scale hmpe ropes in davies et al 2002 and another was derived by liu et al 2014 using the small scale ropes a series of empirical expressions to predict the dynamic stiffness for polyester aramid and hmpe ropes was firstly proposed by davies et al 2002 for the hmpe rope the expression was written as follows 2 k r 59 0 0 54 t m mbl through eq 2 the stable value of dynamic stiffness could be directly calculated by the average input load while the effects of load amplitude and load history have not been involved in this regard the empirical expression derived by liu et al 2014 based on small scale hmpe ropes further considered the effect of both load history and load amplitude 3 k r α β t m mbl γ ε a δ e κ n where coefficients α and β were related to the average tension t m γ represented the coefficients affected by the strain amplitude ε a δ and κ were affected by the number of load cycles for the hmpe samples adopted in this paper the coefficients were defined in table 5 as these expressions haven t taken the influence of rope size and braid type the predictions of three samples calculated by these expressions were similar thus the following results obtained by this empirical expression were evaluated based on the average results in three cases the differences in the cases of full scale samples are explained in the first place on the one hand the expression in davies et al 2002 was derived by full scale hmpe ropes thus an excellent agreement with sample b s experimental results was found after 500 times cylices in all present three cases in contrast the unstable stiffness during the beginning process and its evolution procedure afterwards have not been represented accordingly for sample a an agreement was only found in case 3 because the influence induced by braid construction in such a condition was less obvious on the other hand the results obtained by eq 3 in liu et al 2014 hasn t given a good description of dynamic stiffness s varying procedure the main reason was deduced that this empirical equation was established based on the input elongation when strain ε a in eq 3 was a consequent value and imported by the experimental results the initial strain amplitude might be slightly larger than the afterwards thus the decreasing third term γε a might balance the actual forming process of dynamic stiffness furthermore the relative errors of final predicted magnitudes of eq 2 against eq 3 as well as the experimental results of sample b were around 10 which was in accordance with the conclusion in the work of liu et al 2014 as eq 3 was derived based on the small samples the different softness and deformability between the full and small scale ropes were deduced to be the main excuse concerning the small scale sample c all the present experimental results were lower than both empirical values and unlike those two kinds of full scale ropes the differences of sample c existed in all present cases not vanishing with the increasing average tension the contrast against eq 2 was induced by the larger samples adopted in davies et al 2002 thus the factors including twist slack and outer jacket resulted in the inherent difference of stiffness the diversity against eq 3 should be mainly influenced by the measured mbs according to the present measurement the mbs of 5 5 mm sample c was 29 53 kn larger than the mbs 27 8 kn of 6 mm hmpe ropes in liu et al 2014 the larger denominator in eq 1 decreased the integral kr so that the smaller sample c had a smaller dynamic stiffness on the one hand the various twist angles and pitch lengths might influence the static strength of small size ropes on the other hand the possible reason for various mbs was that the higher bedding in level could slightly increase the breaking strength the bedding in process in this paper was referred to several standards and might differ from liu et al 2014 to investigate the dynamic stiffness s variation tendency the evolution process during the 1000 load cycles was represented by the ratio δkr 4 δ k r k r k r 1000 k r 1000 where kr 1000 is the stable stiffness after 1000 cycles fig 10 gives the variation tendency of stiffness δkr in three cases of t m the results pointed out that dynamic stiffness variations tended to be the same after almost 200 times cycles in all cases when the average magnitude of the input load was small three samples stiffness reached stable values more directly showing a much more straight line during the first 50 cycles in fig 10 a moreover it can be seen from fig 10 b and c that although the stiffness gradually became stable after 200 cycles in cases 2 and 3 δkr in such cases was still not close to zero this indicated that the stiffnesses were slowly increasing to reach stable values during the remaining cycles further proving that the lower tension had less influence on dynamic stiffness variation as the higher tension had more apparent impacts on the deformation of hmpe fibre the energy absorption decreased in such condition which was reflected in the decreasing strain and the increasing kr the present results also explained the different evolution processes between large and small scale samples the increment in three cases of t m was similar for samples a and b simultaneously the increasing rate of δkr was slightly larger for sample c indicating its dynamic stiffness was much closer to the stable value during the beginning process of load cycles this was related to that the better slack and deformability of sample c increased the strain as a result the increment of dynamic stiffness at the beginning process was much more significant and thus the stiffness of small scale rope was more close to the final stable magnitude in such stage 4 2 cases of load amplitude fig 11 gives the dynamic stiffness kr in three cases of different t a depicted in sub section 3 3 the comparisons among the experimental results indicated that the magnitude of dynamic stiffness kr decreased with the increasing amplitude similarly much lower magnitudes were found in all present cases for the smaller sample c which had the same varying tendency as the results in the above sub section 4 1 furthermore when the amplitude was at a lower level sample b had better resistance to the dynamic tension according to fig 11 a in contrast its difference against sample a s dynamic stiffness gradually decreased with the increasing amplitude as shown in fig 11 b c these results proved that the lower twist of 2 12 braided hmpe rope led to a better stiffness in response to the dynamic loading with a smaller amplitude which was because the smaller intersection angle between the inner components and axial direction took good advantage of fibres axial strength in contrast more fibres were braided per unit by the more significant initial twist of sample a and the increased load further decreased the twist angle therefore the stiffness of sample a was greater than sample b in case 3 because eq 2 overlooked the influence induced by load amplitude it only agreed well with the stable value of present experimental results after 600 cycles in the cases 1 3 of small amplitudes however the differences gradually became apparent with the increasing amplitude and the equation lost its accuracy in cases 4 and 5 as depicted in fig 11 b and c regarding the comparison between the present experimental results and the predictions by eq 3 the empirical expression underestimated the results of samples a and b and overestimated sample c likewise the reason for this situation was also in accordance with sub section 4 1 this expression in liu et al 2014 was derived by small diameter ropes and had difficulties predicting the dynamic stiffness of large diameter samples a and b on the other hand the measured mbs of sample c in this paper was larger than that of a similar rope in liu et al 2014 which lowered the overall stiffness in the calculation process fig 12 presents the variation of dynamic stiffness during 1000 times cycles in three cases of t a with the increasing t a the results of two full scale samples were still similar proving that full scale samples evolution processes were close to each other however the differences against the small scale rope sample c gradually were much more apparent the results showed that the differences in δkr between sample c and the full scale samples during the first 100 cycles were enlarged when t a increased from 4 9 mbs to a medium level of 9 7 mbs this was because its softer construction and better deformability enlarged the energy absorption and thus had a distinct influence on stiffness in the case of higher load amplitude when the input amplitude increased to a further higher level of 19 4 mbs a noticeable increment existed during the whole loading process for small scale sample c as shown in fig 11 c it also can be seen from fig 12 c that the increment δkr of sample c was continually increasing leading to that the dynamic stiffness of sample c in case 5 didn t reach a stable value after 1000 times cycles this should be attributed to the fact that the input tension was relatively too large and might beyond the slack component s energy absorption thus the deformation recovery gradually decreased showing the continuously increasing kr 5 empirical model establishment 5 1 separated fitting an empirical expression for the non dimensional dynamic stiffness k r was established considering the effects of mean load t m load amplitude t a and number of load cycle n 5 k r α β t m m b l γ t a m b l δ n 1 2 where coefficients α and β control the influence of t m on stable stiffness after long term load cycles γ reflects the effect of t a on final stable stiffness the last term δn 1 2 is related to the variation tendency during the initial load stage so it gradually approaches to zero with the increasing n these coefficients were derived in two steps the coefficients α β and γ for three kinds of samples in all cases were derived using the least square method in the first place as given in table 6 since the varying rate of dynamic stiffness of every result was different δ was then obtained for each case it was computed by the weighted average with the factors of 0 3 0 1 0 1 0 1 and 0 4 as listed in table 7 the relative error err was written as follow 6 e r r k r e k r 0 k r 0 where kr e denotes the predicting value obtained by the proposed empirical expression eq 5 kr 0 represents the present experimental results since the time dependent variation of dynamic stiffness was only reflected in the variable n in δn 1 2 the comparison was firstly performed to verify the accuracy of δn 1 2 against the increment rate δkr as shown in fig 13 the results confirmed that this term had good agreement with the varying tendency in most cases while slight differences only occurred for sample c in cases 2 and 5 it can be seen from fig 13 b the difference in case 2 appeared from n 50 to n 600 not being the section of the beginning load cycles with the fastest increasing rate thus this difference should be related to the slack and instability of the small sample s inner components on the other hand because the input load in case 5 was relatively large for small sample c and the stiffness kept increasing in such condition the empirical expression only depicted part of the variation after that the validity and feasibility of the complete equation were verified against the experimental stiffness for the full scale samples a and b fig 14 shows that although a slight difference existed during the beginning process from n 0 to n 30 the present empirical model generally agreed well with the entire experimental results and the relative errors were about 1 on the whole for the small scale sample c good agreement has also been found except for cases 4 and 5 the corresponding reason for case 5 has been explained above while the difference in case 4 should be more related to the calculation error during the computation as err was comparatively stable 5 2 integrated model a further step was then taken to integrate the independent eq 6 by introducing the terms in charge of the effects of sample size 7 k r c 1 α β t m m b l c 2 γ t a m b l c 3 δ n 1 2 where α β γ and δ were only related to the rope construction and given in table 8 c 1 c 2 and c 3 were the polynomials corresponding to rope size and given in eqs 8 10 8 c 1 1 1 1 10 d 5 5 2 d 5 5 2 100 9 c 2 1 5 03 10 d 5 5 2 d 5 5 2 100 10 c 3 1 1 85 10 d 5 5 2 d 5 5 2 100 as the empirical expression in davies et al 2002 was derived by the hmpe ropes with greater diameters and showed good agreement with present sample b in some cases the dynamic stiffness of hmpe ropes should not increase with rope diameter without limit thus the influence of rope size was believed to dominate in the smaller ropes furthermore because the present experiment was accomplished using 5 5 mm and 24 mm hmpe ropes the equation was established to hypothesize that the dynamic stiffness increased with a diameter within the range of 5 5 mm 24 mm in these regards the variable d in eqs 8 9 had a minimum value of d 5 5 mm and the terms c 1 c 2 and c 3 reached the maximum and minimum at d 24 mm the main feature of those equations was that they had upper and lower bounds thus the terms in eq 7 could be easily degraded into eq 5 6 conclusions three types of hmpe fibre ropes with various diameters and braided constructions were tested in this paper to examine the dependence of dynamic stiffness on rope configurations and input load conditions based on the experimental results a set of expressions was newly proposed considering the influences of rope diameter braid construction average load load amplitude and the number of load cycles the main conclusions derived in this paper are listed as follows on the one hand the results pointed out that the dynamic stiffness of the 1 12 rope sample was slightly larger than the 2 12 sample in response to greater load amplitude and it is on the contrary for a smaller amplitude case this is because the tensile load decreased the greater twist of 1 12 rope and thus the strength could be slightly enhanced by the smaller intersection angle of inner components on the other hand the non dimensional dynamic stiffness of the 5 5 mm diameter sample was about 10 lower in the comparison against the full scale 24 mm samples this was mainly attributed to the small scale rope not having an outer jacket and with better softness so that it had great deformation under loading furthermore the stiffness was deduced not to increase with diameter without limit because the stiffness of full scale ropes tended to be similar with the increasing diameter according to the present validation the present experimental results were validated against two existing empirical expressions for the dynamic stiffness of hmpe rope respectively as small load amplitude had less influence on the dynamic stiffness the first equation overlooking the load amplitude term only agreed well with the final stable magnitude of a full scale sample in several cases while didn t predict the evolution process of dynamic stiffness the second expression established by the small scale experiments underestimated the full scale sample s results as the measured mbs was found to affect the non dimensional computation procedure this equation also overestimated the small scale sample s stiffness a set of empirical equations was newly proposed on these accounts considering the terms of rope configurations including diameter and construction and loading conditions including average load load amplitude and the number of load cycles good agreement has been found in the validation against the present experiment credit authorship contribution statement gen li conceptualization methodology software validation formal analysis investigation data curation writing original draft writing review editing visualization wenhua li conceptualization methodology formal analysis resources data curation writing review editing visualization supervision project administration funding acquisition shanyin lin data curation writing original draft writing review editing visualization project administration funding acquisition hangyu li conceptualization methodology software validation investigation resources data curation yangyuan ge conceptualization methodology software validation investigation resources project administration funding acquisition yuqing sun resources supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study was supported by the national key research and development program of china 2018yfc0309003 2018yfc0309001 national natural science foundation of china 51779026 high tech ship scientific research project ministry of industry and information technology packing letter 2017 no 614 and 2018 no 473 111 project b18009 liaoning provincial natural science foundation of china 2020 hylh 35 and the fundamental research funds for the central universities 3132020186 3132019368 
20780,this paper presents a full scale experimental investigation to study the nonlinear dynamic stiffness of high modulus polyethylene hmpe fibre rope under long term cyclic loading three kinds of ropes with different constructions and diameters were selected as test samples the influences of mean load and load amplitude on axial stiffness and the corresponding evolution process were respectively studied the experimental results showed that various braided ropes dynamic stiffness was slightly different which was mainly caused by the different twist angles furthermore the non dimensional stiffness of small scale rope was lower than the large samples to some extent this should be related to the small scale ropes without an outer jacket were much softer and thus had more distinct deformation the validations against two existing empirical expressions have also been performed the results pointed out that these equations had some errors predicting the evolution procedure of the dynamic stiffness and the magnitude of small scale sample s stiffness on these accounts a set of empirical expressions taking into account braid constructions diameter and input load conditions has been newly derived the comparison against the present experimental results proved its good reliability keywords synthetic fibre rope hmpe experiment dynamic stiffness deep sea equipment mooring line 1 introduction deepwater equipment has made numerous breakthroughs in exploring and exploiting ocean resources particularly with the service of synthetic fibre ropes in the systems of mooring and deployment and recovery compared with steel wires and chains fibre ropes have a more excellent strength to weight ratio and require lower maintenance and handling costs foster 2002 while on the other hand the tension elongation relationship of fibre ropes shows significant nonlinearity and is time dependent to the long term loading because of the inherent visco elasticity and visco plasticity of fibre materials in this regard great efforts have been made to investigate their mechanical characteristics to establish a better foundation for the analysis in structural mooring performance dynamic and hydrodynamic response etc one main issue for the mechanical characteristic of fibre ropes is their axial stiffness under dynamic loading unlike steel chains and wires the tensile stiffness of fibre ropes is commonly assumed to depend on two main factors the rope itself factor of material and the loading factors of average amplitude period and the number of the load cycle etc on this account numerous works have been conducted to obtain the empirical expressions for the dynamic stiffness del vecchio 1992 first proposed the polynomials for two kinds of small diameter polyester ropes and the corresponding yarns through a series of experiments the influences of mean load load amplitude and load frequency were respectively considered a group of comparative experiments was then conducted by bosman and hooker 1999 to investigate the diversity between the dynamic moduli of full size rope and its corresponding lower sub rope as the tested ropes were parallel construction its dynamic modulus could thus be extrapolated by the sub rope françois and davies 2008 conducted a load elongation experiment using a full scale parallel construction polyester rope with 800t breaking strength and its corresponding sub rope with 70t breaking strength quasi static loads were considered and the results showed little difference in stiffness between the rope and the sub rope apart from the difference in diameter the main difference between the full scale and the small scale ropes is that the full scale samples have the same construction as those used in practice the theoretical conclusions can thus be directly adopted without a conversion factor in contrast the smaller ropes cost less in tests while the findings may be affected by their simplified construction from what has been mentioned above it can be known that although the dynamic differences between full scale and small diameter samples have been preliminarily concerned there are still several blanks needed to be fulfilled one remaining issue is that the full scale ropes in those studies were mainly parallel construction so that the inner sub ropes were subjected to tension independently and evenly therefore the strength of sub ropes could thus be easily deduced by the full scale integrated ropes however the interaction force compression and abrasion within the braided arrangement of sub ropes see fig 1 may have a more critical effect on the elongation characteristic on this account the hypothesis that the modulus of a smaller sub rope is similar to that of full scale rope may not be directly adopted in the cases of braided ropes beltran 2006 proposed a numerical model for synthetic fibre ropes taking into account the braid construction and the corresponding friction among elements the elongation of polyester ropes with various damaged components in response to static loads was predicted while the long period dynamic stiffness under cyclic load has not been involved the prolonged loading such as cyclic load and creep load with an extended period of time whose duration dominates in affecting the tensile characteristics has a more apparent influence with the increasing duration however whether the stiffness magnitude of a full scale braided rope particularly its evolution under long term dynamic load can be precisely predicted by smaller braided rope is still ambiguous goksoy 1986 and flory et al 1988 first developed a small test machine to investigate the yarn on yarn abrasion the yarn was twined over itself through a set of pulleys and was drawn back and forth under the tension supplied by a weight by measuring the tension at both ends of the tested yarn the friction coefficient was obtained by similar methods various works have been further performed such as chakladar et al 2014 hobbs and ridge 2018 and chevillotte et al 2020 some studies have also been conducted to investigate the friction and abrasion of fibre fabric at a more microcosmic level e g dong and sun 2009 and mulvihill et al 2017 the above works main objective was to investigate the friction and abrasion properties of various fibre materials although the molecular morphology has been proven to be significantly affected by the loading and twist angle the final reflection on the elongation induced by different sizes and configurations remains verified polyester ropes have been well studied in the last two decades typical works include banfield and casey 1998 fernandes et al 1999 and the above papers as another type of synthetic fibre rope high modulus and high tenacity fibre ropes e g high modulus polyethylene hmpe ropes are getting more attention in deep and ultra deep water applications because of the larger ratio of minimum break load to diameter however few published works related to their dynamic stiffness were available to date davies et al 2002 conducted a series of experiments focusing on the tension elongation behaviours of aramid polyester and hmpe ropes with large diameters under cyclic loading they first established a set of empirical equations only considering the influence induced by the input load s average magnitude liu et al 2014 lian et al 2017 2018 further paid close attention to the variation procedure of the axial stiffness under cyclic load using six groups of samples with small diameters they proposed a series of empirical expressions consisting of the terms of load average amplitude and duration three materials and two diameters of 6 mm and 8 mm were respectively concerned and the differences of dynamic stiffness caused by rope size were preliminarily considered whereas there were still two main issues needed to be addressed one was that those two sizes were both small and the difference was less noticeable as a result the influences caused by the rope sizes were only reflected in the numbers of diameters however the small ropes are normally much softer than large ropes which may lead to a more significant variation in response to the same non dimensional tension another issue was that the tested hmpe samples had the same construction the twist angles also vary for different braided ropes which should have an apparent influence on the inner abrasion and further affect dynamic stiffness under various load conditions in these regards the stiffness difference between full and small scale ropes is believed not to be thoroughly investigated to this end comparative experiments presented in this paper aims to study the long term axial tensile properties of hmpe ropes and further model their stiffness under cyclic dynamic loads with empirical equations three types of braided ropes were selected through which the diversity caused by both the rope configurations and the input load conditions can be investigated section 2 gives the details of the experimental setups and the tested samples section 3 provides the input conditions and performs a primary analysis to study the tensile characteristic under different load conditions in section 4 the dynamic stiffness in the present test is calculated and the empirical predictions using two existing expressions are then carried out the comparisons among different loads ropes and empirical expressions are respectively performed and the influences caused by mean tension tension amplitude rope size and configuration are explained afterwards new empirical expressions containing the external loading factors and the rope factors are further fitted in section 5 finally the conclusions are drawn in section 6 2 experimental descriptions the experiments were conducted at the laboratory of zhejiang four brothers rope co ltd under the environment of room temperature of 26 c and 65 humidity the input tension was provided by an 8 m long tensile machine with a capacity of 500 kn and a maximum error of 0 5 the tensile machine s free end could be in both single direction and simple harmonic motion to generate static and dynamic loads on test samples the displacement sensor at the free end and an extensometer were used to continuously record the elongation δl in each case at the frequency of 4 times per second as shown in fig 2 as the tension was recorded separately by two systems the elongation results have been mutually validated three types of braided hmpe ropes manufactured by four brothers rope co ltd were selected as test samples the fibre was produced by dsm trosar table 1 gives the detailed specifications where samples a and b were the typical full scale ropes and covered by the 2 12 hmpe braided jacket see fig 3 a and fig 3 b and the smaller sample c was without the jacket see fig 3 c each eye splice of full scale samples a and b was about 490 mm long and the length of eye splice of samples c was about 150 mm the pitch length and the twist angle were 90 mm and 11 9 deg for sample a 90 mm and 8 9 deg for sample b 20 mm and 11 3 deg for sample c the sample in each case was new and tested in a dry state a bedding in process was performed for each sample before conducting the case study to obtain stable and accurate experimental results the detailed procedure is listed as follows 1 a pretension of 2 minimum breaking strength mbs was imposed after installing each sample a gauge length of l0 1000 mm was first set at the middle of the sample by setting two extensometers out of the splice parts 2 the tension was increased to 20 mbs by moving the free end at a rate of s 50 mm min and held at 20 mbs for 30 min 3 one hundred times cyclic loads were then imposed with mean value t m 20 mbs amplitude t a 10 mbs and varying rate of free end s 200 mm min after the cyclic loads ended the load was decreased to 2 mbs and the bedding in process finished the strain was reset as δl l 0 and the length l between the extensometer was recorded as the original length in the following case studies 3 experimental results 3 1 minimum breaking strength the static strength test was performed to determine the minimum breaking strength mbs of each sample in the first place the values of mbs for the bedding in process were temporarily the rated minimum breaking strength in table 1 after the pre stretching the input load was increased by the free end shifting at the rate of s 30 mm min as given in table 2 all the measured mbs was greater than the rated minimum breaking strength moreover all the rupture occurred away from the junctions of eye splices as shown in fig 4 proving that the present results were appropriate and reasonable thus the mbs in the following dynamic tests was set as those values 3 2 tension versus strain under different mean tension after the bedding in process the dynamic loading was imposed by the harmonic movement of the free end since the frequency of external load has less influence on the dynamic stiffness davies et al 2002 and liu et al 2014 the shifting rate of free end the dynamic test was set as s 100 mm min thus differences existed in the finished time of each case firstly three cases were set to study the effects of mean tension t m on the tensile characteristics the details are listed in table 3 fig 5 shows that after the bedding in processes the strain δl l of three samples gradually increased with the average tension t m the results during the first and last ten cycles are then presented separately in fig 6 in all these cases hysteresis loops were more evident in the first ten cycles indicating that the strain in response to cyclic tension gradually became stable with the increasing duration furthermore the differences between the last and first ten tension strain cycles were the greatest in case 3 and the smallest in case 1 therefore the accumulation of the residual strain has been proved to be more obvious during the initial stage and its magnitude increases with t m according to the present results all braided ropes strain values increased with t m the strain values of samples b and c during the last ten cycles were greater than that of sample a in fig 6 which indicated that inner components of 1 12 samples with a larger diameter and twist might render the integrated ropes resistant residue strain 3 3 tension versus strain under different tension amplitude based on case 2 two more load conditions were set to investigate the tensile characteristics of hmpe ropes under dynamic loads with different amplitudes as listed in table 4 fig 7 gives the time histories of input loads and the corresponding strain the present results also pointed out that the average strain increased with t a while the non dimensional strain was less affected by the rope constructions fig 8 gives the curves of strain δl l as a function of tension t during the first and last ten cycles following the conclusion in sub section 3 2 the present results further showed that the residual strain increased with load amplitude and gradually became stable with the increasing load cycles on the other hand the most significant gradient was found in case 2 and the smallest for case 5 this indicated that the samples had a poor ability to resist the dynamic deformation under large amplitude 4 dynamic stiffness calculation the non dimensional dynamic stiffness kr in each loading cycle n was computed through the following equation 1 k r t p t t mbl δ l p δ l t l where t p and t t are the peak and trough of tension in each cycle δl p and δl t represent the peak and trough of elongation respectively 4 1 cases of mean load the effects of mean load t m on dynamic stiffness are shown in fig 9 a more obvious increment of stiffness kr occurred in the prior cycles after that the stiffness in all cases gradually became stable for the influences caused by t m the gradient of each tension strain loop in case 1 was the smallest and thus kr increased with t m as depicted in fig 9 the present results showed that the stiffness magnitudes of the three samples varied with diameters and constructions when the input load was at a lower level i e case 1 depicted in fig 9 a sample b s stiffness was much greater than that of sample a this might be related to the smaller twist of sample b thus the components directions were much closer to the horizontal axial load leading to a greater strength under the condition of lower tension however with the increasing stiffness of sample a due to the rising mean load the dynamic difference between those two samples gradually decreased as shown in fig 9 c this is because the twist angles between the axis and inner components of both full scale ropes decreased with the increasing tension and both twist values got closer under the large external loading which was reflected in a better strength of sample a under a higher tension level rather than lower tension for sample c with a smaller diameter the results pointed out that its non dimensional dynamic stiffness was nearly 10 15 lower than sample a in all present cases except for the few strength supplied by the braided jacket this phenomenon should be attributed to that the small rope was softer and slacker than those large scale ropes as a result the axial tensile deformability was enlarged and the non dimensional strength of the small scale sample was slightly worse the present experimental results were adopted to validate two existing empirical expressions for hmpe rope one was established by the full scale hmpe ropes in davies et al 2002 and another was derived by liu et al 2014 using the small scale ropes a series of empirical expressions to predict the dynamic stiffness for polyester aramid and hmpe ropes was firstly proposed by davies et al 2002 for the hmpe rope the expression was written as follows 2 k r 59 0 0 54 t m mbl through eq 2 the stable value of dynamic stiffness could be directly calculated by the average input load while the effects of load amplitude and load history have not been involved in this regard the empirical expression derived by liu et al 2014 based on small scale hmpe ropes further considered the effect of both load history and load amplitude 3 k r α β t m mbl γ ε a δ e κ n where coefficients α and β were related to the average tension t m γ represented the coefficients affected by the strain amplitude ε a δ and κ were affected by the number of load cycles for the hmpe samples adopted in this paper the coefficients were defined in table 5 as these expressions haven t taken the influence of rope size and braid type the predictions of three samples calculated by these expressions were similar thus the following results obtained by this empirical expression were evaluated based on the average results in three cases the differences in the cases of full scale samples are explained in the first place on the one hand the expression in davies et al 2002 was derived by full scale hmpe ropes thus an excellent agreement with sample b s experimental results was found after 500 times cylices in all present three cases in contrast the unstable stiffness during the beginning process and its evolution procedure afterwards have not been represented accordingly for sample a an agreement was only found in case 3 because the influence induced by braid construction in such a condition was less obvious on the other hand the results obtained by eq 3 in liu et al 2014 hasn t given a good description of dynamic stiffness s varying procedure the main reason was deduced that this empirical equation was established based on the input elongation when strain ε a in eq 3 was a consequent value and imported by the experimental results the initial strain amplitude might be slightly larger than the afterwards thus the decreasing third term γε a might balance the actual forming process of dynamic stiffness furthermore the relative errors of final predicted magnitudes of eq 2 against eq 3 as well as the experimental results of sample b were around 10 which was in accordance with the conclusion in the work of liu et al 2014 as eq 3 was derived based on the small samples the different softness and deformability between the full and small scale ropes were deduced to be the main excuse concerning the small scale sample c all the present experimental results were lower than both empirical values and unlike those two kinds of full scale ropes the differences of sample c existed in all present cases not vanishing with the increasing average tension the contrast against eq 2 was induced by the larger samples adopted in davies et al 2002 thus the factors including twist slack and outer jacket resulted in the inherent difference of stiffness the diversity against eq 3 should be mainly influenced by the measured mbs according to the present measurement the mbs of 5 5 mm sample c was 29 53 kn larger than the mbs 27 8 kn of 6 mm hmpe ropes in liu et al 2014 the larger denominator in eq 1 decreased the integral kr so that the smaller sample c had a smaller dynamic stiffness on the one hand the various twist angles and pitch lengths might influence the static strength of small size ropes on the other hand the possible reason for various mbs was that the higher bedding in level could slightly increase the breaking strength the bedding in process in this paper was referred to several standards and might differ from liu et al 2014 to investigate the dynamic stiffness s variation tendency the evolution process during the 1000 load cycles was represented by the ratio δkr 4 δ k r k r k r 1000 k r 1000 where kr 1000 is the stable stiffness after 1000 cycles fig 10 gives the variation tendency of stiffness δkr in three cases of t m the results pointed out that dynamic stiffness variations tended to be the same after almost 200 times cycles in all cases when the average magnitude of the input load was small three samples stiffness reached stable values more directly showing a much more straight line during the first 50 cycles in fig 10 a moreover it can be seen from fig 10 b and c that although the stiffness gradually became stable after 200 cycles in cases 2 and 3 δkr in such cases was still not close to zero this indicated that the stiffnesses were slowly increasing to reach stable values during the remaining cycles further proving that the lower tension had less influence on dynamic stiffness variation as the higher tension had more apparent impacts on the deformation of hmpe fibre the energy absorption decreased in such condition which was reflected in the decreasing strain and the increasing kr the present results also explained the different evolution processes between large and small scale samples the increment in three cases of t m was similar for samples a and b simultaneously the increasing rate of δkr was slightly larger for sample c indicating its dynamic stiffness was much closer to the stable value during the beginning process of load cycles this was related to that the better slack and deformability of sample c increased the strain as a result the increment of dynamic stiffness at the beginning process was much more significant and thus the stiffness of small scale rope was more close to the final stable magnitude in such stage 4 2 cases of load amplitude fig 11 gives the dynamic stiffness kr in three cases of different t a depicted in sub section 3 3 the comparisons among the experimental results indicated that the magnitude of dynamic stiffness kr decreased with the increasing amplitude similarly much lower magnitudes were found in all present cases for the smaller sample c which had the same varying tendency as the results in the above sub section 4 1 furthermore when the amplitude was at a lower level sample b had better resistance to the dynamic tension according to fig 11 a in contrast its difference against sample a s dynamic stiffness gradually decreased with the increasing amplitude as shown in fig 11 b c these results proved that the lower twist of 2 12 braided hmpe rope led to a better stiffness in response to the dynamic loading with a smaller amplitude which was because the smaller intersection angle between the inner components and axial direction took good advantage of fibres axial strength in contrast more fibres were braided per unit by the more significant initial twist of sample a and the increased load further decreased the twist angle therefore the stiffness of sample a was greater than sample b in case 3 because eq 2 overlooked the influence induced by load amplitude it only agreed well with the stable value of present experimental results after 600 cycles in the cases 1 3 of small amplitudes however the differences gradually became apparent with the increasing amplitude and the equation lost its accuracy in cases 4 and 5 as depicted in fig 11 b and c regarding the comparison between the present experimental results and the predictions by eq 3 the empirical expression underestimated the results of samples a and b and overestimated sample c likewise the reason for this situation was also in accordance with sub section 4 1 this expression in liu et al 2014 was derived by small diameter ropes and had difficulties predicting the dynamic stiffness of large diameter samples a and b on the other hand the measured mbs of sample c in this paper was larger than that of a similar rope in liu et al 2014 which lowered the overall stiffness in the calculation process fig 12 presents the variation of dynamic stiffness during 1000 times cycles in three cases of t a with the increasing t a the results of two full scale samples were still similar proving that full scale samples evolution processes were close to each other however the differences against the small scale rope sample c gradually were much more apparent the results showed that the differences in δkr between sample c and the full scale samples during the first 100 cycles were enlarged when t a increased from 4 9 mbs to a medium level of 9 7 mbs this was because its softer construction and better deformability enlarged the energy absorption and thus had a distinct influence on stiffness in the case of higher load amplitude when the input amplitude increased to a further higher level of 19 4 mbs a noticeable increment existed during the whole loading process for small scale sample c as shown in fig 11 c it also can be seen from fig 12 c that the increment δkr of sample c was continually increasing leading to that the dynamic stiffness of sample c in case 5 didn t reach a stable value after 1000 times cycles this should be attributed to the fact that the input tension was relatively too large and might beyond the slack component s energy absorption thus the deformation recovery gradually decreased showing the continuously increasing kr 5 empirical model establishment 5 1 separated fitting an empirical expression for the non dimensional dynamic stiffness k r was established considering the effects of mean load t m load amplitude t a and number of load cycle n 5 k r α β t m m b l γ t a m b l δ n 1 2 where coefficients α and β control the influence of t m on stable stiffness after long term load cycles γ reflects the effect of t a on final stable stiffness the last term δn 1 2 is related to the variation tendency during the initial load stage so it gradually approaches to zero with the increasing n these coefficients were derived in two steps the coefficients α β and γ for three kinds of samples in all cases were derived using the least square method in the first place as given in table 6 since the varying rate of dynamic stiffness of every result was different δ was then obtained for each case it was computed by the weighted average with the factors of 0 3 0 1 0 1 0 1 and 0 4 as listed in table 7 the relative error err was written as follow 6 e r r k r e k r 0 k r 0 where kr e denotes the predicting value obtained by the proposed empirical expression eq 5 kr 0 represents the present experimental results since the time dependent variation of dynamic stiffness was only reflected in the variable n in δn 1 2 the comparison was firstly performed to verify the accuracy of δn 1 2 against the increment rate δkr as shown in fig 13 the results confirmed that this term had good agreement with the varying tendency in most cases while slight differences only occurred for sample c in cases 2 and 5 it can be seen from fig 13 b the difference in case 2 appeared from n 50 to n 600 not being the section of the beginning load cycles with the fastest increasing rate thus this difference should be related to the slack and instability of the small sample s inner components on the other hand because the input load in case 5 was relatively large for small sample c and the stiffness kept increasing in such condition the empirical expression only depicted part of the variation after that the validity and feasibility of the complete equation were verified against the experimental stiffness for the full scale samples a and b fig 14 shows that although a slight difference existed during the beginning process from n 0 to n 30 the present empirical model generally agreed well with the entire experimental results and the relative errors were about 1 on the whole for the small scale sample c good agreement has also been found except for cases 4 and 5 the corresponding reason for case 5 has been explained above while the difference in case 4 should be more related to the calculation error during the computation as err was comparatively stable 5 2 integrated model a further step was then taken to integrate the independent eq 6 by introducing the terms in charge of the effects of sample size 7 k r c 1 α β t m m b l c 2 γ t a m b l c 3 δ n 1 2 where α β γ and δ were only related to the rope construction and given in table 8 c 1 c 2 and c 3 were the polynomials corresponding to rope size and given in eqs 8 10 8 c 1 1 1 1 10 d 5 5 2 d 5 5 2 100 9 c 2 1 5 03 10 d 5 5 2 d 5 5 2 100 10 c 3 1 1 85 10 d 5 5 2 d 5 5 2 100 as the empirical expression in davies et al 2002 was derived by the hmpe ropes with greater diameters and showed good agreement with present sample b in some cases the dynamic stiffness of hmpe ropes should not increase with rope diameter without limit thus the influence of rope size was believed to dominate in the smaller ropes furthermore because the present experiment was accomplished using 5 5 mm and 24 mm hmpe ropes the equation was established to hypothesize that the dynamic stiffness increased with a diameter within the range of 5 5 mm 24 mm in these regards the variable d in eqs 8 9 had a minimum value of d 5 5 mm and the terms c 1 c 2 and c 3 reached the maximum and minimum at d 24 mm the main feature of those equations was that they had upper and lower bounds thus the terms in eq 7 could be easily degraded into eq 5 6 conclusions three types of hmpe fibre ropes with various diameters and braided constructions were tested in this paper to examine the dependence of dynamic stiffness on rope configurations and input load conditions based on the experimental results a set of expressions was newly proposed considering the influences of rope diameter braid construction average load load amplitude and the number of load cycles the main conclusions derived in this paper are listed as follows on the one hand the results pointed out that the dynamic stiffness of the 1 12 rope sample was slightly larger than the 2 12 sample in response to greater load amplitude and it is on the contrary for a smaller amplitude case this is because the tensile load decreased the greater twist of 1 12 rope and thus the strength could be slightly enhanced by the smaller intersection angle of inner components on the other hand the non dimensional dynamic stiffness of the 5 5 mm diameter sample was about 10 lower in the comparison against the full scale 24 mm samples this was mainly attributed to the small scale rope not having an outer jacket and with better softness so that it had great deformation under loading furthermore the stiffness was deduced not to increase with diameter without limit because the stiffness of full scale ropes tended to be similar with the increasing diameter according to the present validation the present experimental results were validated against two existing empirical expressions for the dynamic stiffness of hmpe rope respectively as small load amplitude had less influence on the dynamic stiffness the first equation overlooking the load amplitude term only agreed well with the final stable magnitude of a full scale sample in several cases while didn t predict the evolution process of dynamic stiffness the second expression established by the small scale experiments underestimated the full scale sample s results as the measured mbs was found to affect the non dimensional computation procedure this equation also overestimated the small scale sample s stiffness a set of empirical equations was newly proposed on these accounts considering the terms of rope configurations including diameter and construction and loading conditions including average load load amplitude and the number of load cycles good agreement has been found in the validation against the present experiment credit authorship contribution statement gen li conceptualization methodology software validation formal analysis investigation data curation writing original draft writing review editing visualization wenhua li conceptualization methodology formal analysis resources data curation writing review editing visualization supervision project administration funding acquisition shanyin lin data curation writing original draft writing review editing visualization project administration funding acquisition hangyu li conceptualization methodology software validation investigation resources data curation yangyuan ge conceptualization methodology software validation investigation resources project administration funding acquisition yuqing sun resources supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study was supported by the national key research and development program of china 2018yfc0309003 2018yfc0309001 national natural science foundation of china 51779026 high tech ship scientific research project ministry of industry and information technology packing letter 2017 no 614 and 2018 no 473 111 project b18009 liaoning provincial natural science foundation of china 2020 hylh 35 and the fundamental research funds for the central universities 3132020186 3132019368 
20781,in this study artificial neural networks ann and multiple additive regression trees mart are employed to predict significant wave heights h s based on the measurement of meteorological and wave data four ann models are proposed namely the multilayer perceptron neural network mpnn cascade correlation neural network ccnn radial basis function neural network rbfnn and general regression neural network grnn the inputs to the various models include wind speed wind direction wind duration fetch sea level pressure and air temperature the models are trained and tested by the cross validation method and compared for performance outcomes based on six different performance measures analyzing the ann models the overall performance of the rbfnn is found to be more accurate than those of the other models and the ccnn model exhibits the worst predictive capabilities the mart model is the most accurate outperforming all other models based on the statistical indices the mart model is efficient and precise and can therefore serve as a practical tool for h s prediction keywords wave height prediction multiple additive regression trees multilayer perceptron cascade correlation radial basis function general regression 1 introduction for the design use and maintenance of coastal and offshore structures accurate prediction of wave heights is critical anns have been utilized in recent years for the prediction of h s owing to their ability to approximate non linear mathematical behavior without prior knowledge of the interrelationships among the system elements deo and naidu 1998 applied ann and autoregressive models to predict h s and they concluded that the ann models were more accurate than the autoregressive models a three layered ffnn model was suggested by deo et al 2001 wherein the current and previous time step wind speed values were used to predict the h s and average wave period t agrawal and deo 2002 employed ccnn and a back propagation neural network bpnn and autoregressive models for the estimation of h s the results revealed that the ann models were more accurate than the autoregressive models tsai et al 2002 employed bpnn that involved the learning of observed wave characteristics in addition to the prediction of h s based on wave records in the neighboring stations makarynskyy 2004 used an ffnn model to predict the h s and t at intervals of 1 h over a period of 24 h to estimate the different missing wave parameter values balas et al 2004 employed ffnn recurrent neural network rnn and autoregressive models makarynskyy et al 2005 employed an ffnn model for the prediction of h s and t at different lead times kalra et al 2005 used bpnn and rbfnn to obtained daily values of h s at a speciﬁc coastal site situated along the west coast of india mandal and prabaharan 2006 applied rnn to the prediction of h s on the west coast of india kazeminezhad et al 2005 2007 özger and sen 2007 lin and chang 2008 mahjoobi et al 2008 zanaganeh et al 2009 and zanaganeh 2017 used fuzzy interface system fis and or anfis for forecasting the wave parameters zanaganeh 2020 combined fis and particle swarm optimization models to predict wave parameters günaydın 2008 kamranzad et al 2011 and asma et al 2012 employed multiple linear regression mlr and anns models to predict h s mahjoobi and mosabbeb 2009 employed anns and support vector machines svms for the prediction of h s using wind characteristics as inputs to predict h s from wind speed values malekmohamadi et al 2011 employed anns bayes networks svms and anfis they found the bn and svm models to be more accurate compared with the other models moreover elbisy 2015a employed the svm bpnn and ccnn for the prediction of wave parameters elgohary et al 2018 compared svm and the mlr method for the prediction of h s they concluded that the svm with the radial basis function is superior to the mlr method malekmohamadi et al 2008 londhe et al 2006 and deshmukh et al 2016 coupled anns and numerical models to enhance the prediction reliability of h s moreover sadeghifar et al 2017 employed an rnn for wave parametric predictions elbisy 2019 and elbisy and osra 2019 employed the mpnn and the group method of data handling type neural network models gmdh nn to estimate h s the findings revealed that the accuracy of prediction for the gmdh nn model was superior to that for the mpnn model mahjoobi and etemad shahidi 2008 examined the performance of classification and regression trees for the prediction of h s the results indicate that a decision tree is an efficient approach for predicting h s among various machine learning ml methods the mart method proposed by friedman 1999 2001 2002 has been considered to be a powerful deep learning model with many successful applications in various fields elbisy 2015b the mart method was developed based on gradient boosting therefore mart is also called gradient boosting trees gulati and gupta 2017 yang et al 2017 this study aims to verify the feasibility and reliability of the mart model for h s prediction compare the mart model performance with the four other ann models mpnn ccnn rbf and grnn using different evaluation indices and investigate the relative importance of the inﬂuencing variables 2 materials and methods 2 1 ann methods the most important factors that determine the most appropriate algorithm for anns are the problem complexity size of training data number of predictor variables intended error level and function of the network that is pattern recognition or function approximation several network algorithms can be used for the h s estimation this study employs the mpnn ccnn grnn and rbfnn algorithms the mpnn comprises an input layer at least one hidden layer and an output layer and all of these are fully interconnected a set of training data is input into the network and the errors are computed according to the outputs this process is reiterated the errors adjust the weights and biases this reiterative procedure eventually results in the optimum weight and bias values that can best simulate the actual case the learning rules employed are the conjugate gradient algorithm for adapting weight values by using the gradient during the backward propagation of errors in the network transfer functions sigmoid and linear were employed as the activation function for the hidden and output layers the ccnn is similar to the mpnn and consists of three layers ccnns are self organizing networks fahlman 1990 fahlman and lebiere 1990 the network only starts with neurons input and output in the ccnn model neurons were nominated from a pool of candidates during training and added to the hidden layer the transfer functions sigmoid and linear were employed as the activation function for the hidden and output layers broomhead and lowe 1988 developed rbfnn in the late 1980s rbfnns afford the advantages of convenient design appropriate generalization and high tolerance to input noise venkatesan and anitha 2006 yu et al 2011 chang et al 2013 rbfnn consists of input hidden and output layers the hidden layer includes several locally tuned units wherein each unit has an rbf that acts as a hidden neuron the input neurons are fully interconnected to the nodes on the hidden layer the connections between the input and hidden layers have unit weights therefore they do not have to be trained haddadnia et al 2003 the outputs of the hidden layer neurons are determined by the euclidean distance between the input of the network and the center of the basis function the output of the neuron decreases rapidly to zero as the input moves away from a given centre point the rbfnn output is essentially weighted sum of hidden layer neuron outputs and unity bias the overall input output response of the rbfnn was described by haddadnia et al 2003 the maximum number of neurons is dependent on the spread of the rbf if the spread is large the rbf gradient gradually decreases leading to a large area around the input vector to which several neurons may respond therefore the rbf gradient is considerably high when the spread is small accordingly the neurons with the weights closest to the input output values that are higher than those of the other neurons the grnn is an approach that was first proposed by specht 1991 as a variation of the rbfnn this is an effective ann that provides a constructive solution for any approximation problem moreover it is a type of feed forward ann that is based on a non linear regression learning mechanism song et al 2016 the grnn contains four layers the input hidden pattern summation and decision layers the learning process is similar to the development of a multidimensional surface in the space that provides a statistically optimal approximation for the dataset if the training set of the grnn model is large the prediction error approaches zero moreover the kernel function gaussian is used wherein the sigma value σ determines the spread of the function 2 2 mart method by combining a boosting technique mart improves the decision tree method the core idea here is to combine a set of weak models to generate a strong consensus single model instead of building a single optimized model friedman et al 2001 2002 2002 mart produces new decision trees sequentially by reducing existing residuals this sequential model construction process is a type of functional gradient descent mason et al 1999 the mart model typically has three major parameters the learning rate v tree complexity and the number of regression trees elith et al 2008 the predictive accuracy of a mart model can be improved ensuring v 1 0 v 1 the mart algorithm established by friedman 1999 is utilized and optimized to enhance the precision of decision tree models the huber m regression loss function is utilized in the mart model that affords it a high resistance to outliers and misclassified cases cross validation methods are utilized to assess the generalization of the mart model and to prevent overfitting friedman 2001 2002 2002 friedman and meulman 2003 elith et al 2008 the development of the various ann and mart models requires two different processes training or learning and testing the training data consist of two subsets the training subset that is utilized to ascertain the best model parameters and the validation subset once the models have been trained a subsequent testing process is conducted to assess their ability to generalize the knowledge acquired in unknown cases during the training process nearly 70 of the entire data were randomly chosen for model training and the rest 30 were used for model testing matlab codes are written for the various models fig 1 demonstrates the data pre processing ﬂow diagram and the process modeling implementation for hs prediction 2 3 study area and data the study area was the abu qir bay coastal zone situated on the egyptian north eastern coast fig 2 overlooking the mediterranean coast it is considered to be one of the most important bays in egypt the meteorological data namely wind data speed and direction air temperature and sea level pressure were recorded between 2010 and 2014 from a weather station located at abu qir bay the pressure was measured at the sea level while wind characteristics and air temperature were measured at 10 m above the sea level to determine trends in the wind speed occurrence in different directions the wind data were statistically analyzed the results revealed that the wind blew predominantly from the north and nw directions northerly winds prevailed throughout the summer season while the predominant wind direction was between n and nw during the spring season with a minimal percentage from the north east direction the average wind speed was 2 knot in summer and spring and 4 knot in winter the maximum mean wind speed of 8 5 knot was observed in december while the minimum of 1 5 knot was observed in august the wave data were measured using s4dw wave data that were collected at a depth of 14 1 m the s4dw consists of an electro magnetic current meter with a pressure sensor these data were statistically analyzed to determine wave characteristics the analysis showed that the average annual h s was approximately 0 94 m and nw was the predominant direction of the wave 42 approximately 87 of h s was less than 1 5 m the maximum h s observed was 4 19 m for the waves from the nw direction during the winter season 3 results and discussion the selection of the input and output variables is a critical step in the development of any ml model the wind speed u wind direction θ wind duration t fetch f sea level pressure p and air temperature t a were considered as the input parameter variables for the ann and mart models and h s was the output the ml models employed were evaluated with six indices as tabulated in table 1 data processing was required before providing the training patterns as input into the network the following is a linear normalization function within zero to one 1 s x x m i n x m a x x m i n where s is the normalized value of variable x and the minimum and maximum variable values are x min and x max respectively 3 1 ann models for each model the results were obtained using 10 fold cross validation based on the average results obtained for each set of test data 10 fold the cross validation method was employed to train and test the various models to ensure that all the data set instances can be applied in both stages table 2 shows the training parameters of each model during the training phase of the various models except the ccnn all the other models were found to adequately approximate the data subset pattern to design a stable mpnn model based on u θ t f p and t a a parametric study was conducted to examine the stability of the network to adjust the optimum size of the mpnn a genetic algorithm ga was utilized fig 3 demonstrates mpnn performance with various neurons in the hidden layer as shown in fig 3 a network of the hidden layer with 13 neurons forms a stable and optimal network the results for the h s predictions are shown in fig 4a the results indicated that the rmse and mape calculated for the training data were 30 88 and 0 34 lower than those of the test data respectively elbisy 2019 and elbisy and osra 2019 obtained similar results supporting the findings reported here the improvement in rmse of the existing study was 86 85 greater than the result reported by elbisy 2015a furthermore elbisy 2015a reported r 0 947 therefore the correlation r 0 983 obtained in this study was judged to be appropriate the h s prediction was repeated based on a ccnn training scheme the results indicated that the rmse and mape calculated for the training data were 32 75 and 15 08 lower than those for the test data respectively fig 4 b presents the comparison of the h s values measured and predicted by the ccnn the results of the grnn model indicated that the rmse and mape calculated for the training data were 52 32 and 0 33 lower than those of the test data respectively fig 4c presents the comparison of the measured and grnn predicted h s values for the rbfnn ga was utilized to adjust the optimum sizes the best result was achieved by the rbfnn with the 6 16 1 architecture fig 5 shows the performance of rbfnn with different hidden neurons the results for the h s predictions are shown in fig 4d the results showed that the rmse and mape calculated in the training data were 15 12 and 0 07 lower than those of the test data respectively the variation in h s values between the measured data and rbfnn predicted results exhibited the same trend upon analyzing the indices it can be seen that all the models have lower index nmse mse mse mae rmse and mape values in the training subset compared with those in the testing subset the results revealed that the performance of the rbfnn model in predicting h s was more accurate than those of the other models table 3 moreover the results indicated that the overall error was significantly reduced in the rbfnn model and the h s values were accurately estimated additionally the four models slightly overestimated positive mse the h s values higher r values were obtained for the four neural network models that varied in the range of 0 973 0 99 mape was used to evaluate the average predictive capability expressed in generic percentage and calculate the accuracy of the predictive methods over the unseen data compared with the other models rbfnn yielded a mape value that was 2 51 27 09 and 3 76 lower than those of the mpnn ccnn and grnn respectively for the training data and 2 78 42 1 and 3 99 lower respectively in the case of the test data moreover the rmse calculated by the rbfnn was 22 34 88 11 and 66 67 lower than those of the mpnn ccnn and grnn respectively for the training data and 36 77 90 58 and 81 26 lower respectively in the case of the test data to predict the h s the neural network with the smallest training and test errors as a comprehensive estimator should be selected the prediction accuracy of the ann models with respect to the various ranges of h s was examined table 4 reveals that the rbfnn demonstrated a better performance than the other models for h s range of h s 1 0 m and h s 3 0 m a comparison of the rbfnn model results with those of the other models revealed that the mape of the rbfnn was 17 29 35 55 and 15 31 lower than those of the mpnn ccnn and grnn respectively for h s 1 0 m fig 6 and 0 68 4 06 and 0 73 lower respectively for h s 3 0 m fig 8d moreover for the h s range of 1 0 m h s 3 0 m all the models performed comparably although the mpnn yielded slightly more accurate results within the range of 1 0 m h s 2 0 m the mape of the mpnn was 0 06 2 27 and 0 67 lower than those of the rbfnn ccnn and grnn respectively and 0 48 2 53 and 1 29 lower respectively within the range of 2 0 m h s 3 0 m elbisy 2015a reported the rmse values of 0 068 m 0 131 m and 0 256 m for the superior svm model rbf kernel corresponding to the ranges of h s 1 0 m 1 0 m h s 2 0 m and h s 2 0 m respectively the results obtained for the mpnn ccnn grnn and rbfnn models used in this study were therefore judged to be appropriate the primary mechanism to achieve the highest efficiency of the model is through regularization that aims to maintain a low model complexity while fitting the data as best as possible the optimal extent of regularization is a trade off between the model simplicity and how well it fits the data ann can successfully map the inputs to the expected output vector by selecting the appropriate inputs in this study seven combinations of the u θ t f p and t a parameters were used as inputs for the prediction of h s by the rbfnn model to determine the optimal combination of input parameters its influence on the accuracy of the results and the performance of the model as can be seen from table 5 and figs 4d and 7 in general the combination of rbfnn parameters u θ t f resulted in more accurate results than the other parametric combinations for example the rmse value of the rbfnn u θ t f was lower than the values obtained for the other parameter combinations the rmse values for the rbfnn u θ t f were 5 81 12 90 35 10 39 60 3 57 and 42 14 lower than those for the rbfnn u θ f t p t a rbfnn u θ f p t a rbfnn u θ f t p rbfnn u θ t f t a rbfnn u θ f and rbfnn u f respectively for the test data the results indicate that the rbfnn u θ t f model significantly reduced the overall error it can therefore be concluded that the combinations of u θ t and f increased the model performance indicating that p and t a have a negligible effect on the h s prediction 3 2 mart model the mart model is yet another prediction model developed in this study u θ f t p and t a were the input variables to the model two methods were used for computing the significance of the predictor variables in the first method the algorithm estimated the relative impact of each parameter in response to prediction based on the friedman 2001 formula the second method was performed using cross validation the two measures of significance obtained were then averaged variable selection was implemented by eliminating input variables that did not contribute to enhancing the model accuracy the model was developed by first utilizing all the predictor variables u θ t f p and t a and thereafter gradually eliminating them according to their relative influence this process created various models and based on the lowest residual deviance obtained the model with the optimal subset of variables was accordingly selected from the analysis u 89 35 was found to be the most relevant predictor followed by f 5 50 θ 2 80 and t 2 35 among the input variables there was no sensitivity noted for p or t a this result is emphasized by the results in section 3 1 to determine the optimal parameters the mart model was trained and validated for a combination of a different number of trees 1 400 learning rates 0 005 0 5 maximum splitting levels 5 minimum size node to split 10 and maximum categories for continuous predictors 1000 to avoid overﬁtting the prediction performance was assessed using the 5 folder cross validation method fig 8 shows the performance of the mart model with various trees and table 2 shows the training parameters of the mart model the best mart model configuration parameter values have been found for 60 trees and a learning rate value of 0 05 based on several experiments conducted in this study according to the results the mart model performance for the training set and test set was similar this indicated that the mart model s generalization performance was good the statistical results for the training data for the predicted h s were as follows nmse 0 00004 m mse 0 00001 m2 mae 0 0003 m rmse 0 0036 m mape 0 015 and r 0 998 all index values of the test data were comparable to those of the training data these results indicate that the mart model is a good predictor of h s as shown in fig 9 the predicted results of the mart model are close to the corresponding actual values of h s the prediction accuracies of the mart model for different h s ranges were investigated the mart model predictions for different h s ranges were reasonable when compared with the recorded values table 6 from the results it can be seen that the predictions of the mart model are closer to the corresponding actual values for all h s ranges compared with those of the ann models 3 3 comparison between the ann and mart methods the prediction performance of the mart model is compared in this section with that of the ann models with respect to both the nmse mse mae rmse mape and r values as well as the computation time of the prediction process the mart method demonstrated the best prediction performance followed by the second best model rbfnn the ccnn model exhibited the worst predictive capabilities indicating that this model cannot reliably approximate the h s the results revealed that the overall performance of the rbfnn model was more accurate than those of the other ann models the results confirmed the high accuracies of the mart and rbfnn models for training data and test data the mape of mart was improved by 2 15 and 2 22 over the rbfnn model the accuracy of the mart and ann models for various h s ranges has been examined based on the results of ann models shown in table 4 it can be said that the rbfnn model leads to better results for h s range of h s 1 0 m and h s 3 0 m while the mpnn model provides slightly more accurate results for h s in the range of 1 0 m h s 3 0 m based on the indices the mart model performs better than the ann models for all h s ranges a comparison of the mape values of the mart and rbfnn models indicated that the smallest difference in the performance of the two techniques 7 45 0 44 1 05 and 0 46 were observed for h s ranges h s 1 0 m 1 0 m h s 2 0 m 2 0 m h s 3 0 m and h s 3 0 m respectively furthermore a comparison of the results of the mart and mpnn models revealed that the mape of the mart model were 24 74 0 38 0 57 and 1 14 lower than those of the mpnn model for h s ranges h s 1 0 m 1 0 m h s 2 0 m 2 0 m h s 3 0 m and h s 3 0 m respectively the correlation coefficients of the three models were almost the same for all the h s ranges in general the results of the mart model were more precise than those of the ann models in other words the mart model produced satisfactory h s predictions for all h s ranges with respect to the predictive accuracy speed convenience and interpretability the results show that mart is the most reliable model for h s prediction because the mart algorithm is fast and overfitting resistant and can automatically select valuables and handle data imperfections outliers missing values and mistakes well it has proved to be superior to the other models 4 conclusions this study developed four ann models mpnn ccnn rbfnn and grnn and mart model to predict h s the ann and mart models were trained and validated using the cross validation approach ensuring that all instances of the data set be employed using six performance measures mse mae mape nmse rmse and r the various predictive methods were comprehensively compared the following conclusions can be drawn based on this analysis for the prediction of h s the best performance of the models was achieved by introducing wind speed wind direction wind duration and fetch in the input layer moreover it has been confirmed that wind speed is the most influencing parameter followed by fetch wind direction and wind duration analyzing the ann models the rbfnn was found to be more accurate than the other models mape of the rbfnn was 2 51 27 09 and 3 76 lower than those of the mpnn ccnn and grnn respectively for the training data and 2 78 42 1 and 3 99 lower respectively for the test data this indicates that the rbfnn has the greatest capability for predicting h s followed by mpnn grnn and ccnn however to be more accurate the mpnn model performs slightly better than the rbfnn model for the h s range of 1 0 m h s 3 0 m the results confirmed the high accuracies of the mart and rbfnn models a comparison of the h s prediction results obtained using the mart model and the rbfnn model showed 2 15 and 2 22 improvement in the mape using the mart model for the training and test data respectively the mart model was more accurate than the ann models for all h s ranges the proposed mart model is efficient and precise and can therefore serve as a practical tool for h s prediction the mart model is a promising complement to conventional forecasting techniques owing to its predictive performance and the simplicity of the model setup credit authorship contribution statement moussa s elbisy conceptualization data curation formal analysis methodology software validation writing original draft writing review editing ahmed m s elbisy methodology software validation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20781,in this study artificial neural networks ann and multiple additive regression trees mart are employed to predict significant wave heights h s based on the measurement of meteorological and wave data four ann models are proposed namely the multilayer perceptron neural network mpnn cascade correlation neural network ccnn radial basis function neural network rbfnn and general regression neural network grnn the inputs to the various models include wind speed wind direction wind duration fetch sea level pressure and air temperature the models are trained and tested by the cross validation method and compared for performance outcomes based on six different performance measures analyzing the ann models the overall performance of the rbfnn is found to be more accurate than those of the other models and the ccnn model exhibits the worst predictive capabilities the mart model is the most accurate outperforming all other models based on the statistical indices the mart model is efficient and precise and can therefore serve as a practical tool for h s prediction keywords wave height prediction multiple additive regression trees multilayer perceptron cascade correlation radial basis function general regression 1 introduction for the design use and maintenance of coastal and offshore structures accurate prediction of wave heights is critical anns have been utilized in recent years for the prediction of h s owing to their ability to approximate non linear mathematical behavior without prior knowledge of the interrelationships among the system elements deo and naidu 1998 applied ann and autoregressive models to predict h s and they concluded that the ann models were more accurate than the autoregressive models a three layered ffnn model was suggested by deo et al 2001 wherein the current and previous time step wind speed values were used to predict the h s and average wave period t agrawal and deo 2002 employed ccnn and a back propagation neural network bpnn and autoregressive models for the estimation of h s the results revealed that the ann models were more accurate than the autoregressive models tsai et al 2002 employed bpnn that involved the learning of observed wave characteristics in addition to the prediction of h s based on wave records in the neighboring stations makarynskyy 2004 used an ffnn model to predict the h s and t at intervals of 1 h over a period of 24 h to estimate the different missing wave parameter values balas et al 2004 employed ffnn recurrent neural network rnn and autoregressive models makarynskyy et al 2005 employed an ffnn model for the prediction of h s and t at different lead times kalra et al 2005 used bpnn and rbfnn to obtained daily values of h s at a speciﬁc coastal site situated along the west coast of india mandal and prabaharan 2006 applied rnn to the prediction of h s on the west coast of india kazeminezhad et al 2005 2007 özger and sen 2007 lin and chang 2008 mahjoobi et al 2008 zanaganeh et al 2009 and zanaganeh 2017 used fuzzy interface system fis and or anfis for forecasting the wave parameters zanaganeh 2020 combined fis and particle swarm optimization models to predict wave parameters günaydın 2008 kamranzad et al 2011 and asma et al 2012 employed multiple linear regression mlr and anns models to predict h s mahjoobi and mosabbeb 2009 employed anns and support vector machines svms for the prediction of h s using wind characteristics as inputs to predict h s from wind speed values malekmohamadi et al 2011 employed anns bayes networks svms and anfis they found the bn and svm models to be more accurate compared with the other models moreover elbisy 2015a employed the svm bpnn and ccnn for the prediction of wave parameters elgohary et al 2018 compared svm and the mlr method for the prediction of h s they concluded that the svm with the radial basis function is superior to the mlr method malekmohamadi et al 2008 londhe et al 2006 and deshmukh et al 2016 coupled anns and numerical models to enhance the prediction reliability of h s moreover sadeghifar et al 2017 employed an rnn for wave parametric predictions elbisy 2019 and elbisy and osra 2019 employed the mpnn and the group method of data handling type neural network models gmdh nn to estimate h s the findings revealed that the accuracy of prediction for the gmdh nn model was superior to that for the mpnn model mahjoobi and etemad shahidi 2008 examined the performance of classification and regression trees for the prediction of h s the results indicate that a decision tree is an efficient approach for predicting h s among various machine learning ml methods the mart method proposed by friedman 1999 2001 2002 has been considered to be a powerful deep learning model with many successful applications in various fields elbisy 2015b the mart method was developed based on gradient boosting therefore mart is also called gradient boosting trees gulati and gupta 2017 yang et al 2017 this study aims to verify the feasibility and reliability of the mart model for h s prediction compare the mart model performance with the four other ann models mpnn ccnn rbf and grnn using different evaluation indices and investigate the relative importance of the inﬂuencing variables 2 materials and methods 2 1 ann methods the most important factors that determine the most appropriate algorithm for anns are the problem complexity size of training data number of predictor variables intended error level and function of the network that is pattern recognition or function approximation several network algorithms can be used for the h s estimation this study employs the mpnn ccnn grnn and rbfnn algorithms the mpnn comprises an input layer at least one hidden layer and an output layer and all of these are fully interconnected a set of training data is input into the network and the errors are computed according to the outputs this process is reiterated the errors adjust the weights and biases this reiterative procedure eventually results in the optimum weight and bias values that can best simulate the actual case the learning rules employed are the conjugate gradient algorithm for adapting weight values by using the gradient during the backward propagation of errors in the network transfer functions sigmoid and linear were employed as the activation function for the hidden and output layers the ccnn is similar to the mpnn and consists of three layers ccnns are self organizing networks fahlman 1990 fahlman and lebiere 1990 the network only starts with neurons input and output in the ccnn model neurons were nominated from a pool of candidates during training and added to the hidden layer the transfer functions sigmoid and linear were employed as the activation function for the hidden and output layers broomhead and lowe 1988 developed rbfnn in the late 1980s rbfnns afford the advantages of convenient design appropriate generalization and high tolerance to input noise venkatesan and anitha 2006 yu et al 2011 chang et al 2013 rbfnn consists of input hidden and output layers the hidden layer includes several locally tuned units wherein each unit has an rbf that acts as a hidden neuron the input neurons are fully interconnected to the nodes on the hidden layer the connections between the input and hidden layers have unit weights therefore they do not have to be trained haddadnia et al 2003 the outputs of the hidden layer neurons are determined by the euclidean distance between the input of the network and the center of the basis function the output of the neuron decreases rapidly to zero as the input moves away from a given centre point the rbfnn output is essentially weighted sum of hidden layer neuron outputs and unity bias the overall input output response of the rbfnn was described by haddadnia et al 2003 the maximum number of neurons is dependent on the spread of the rbf if the spread is large the rbf gradient gradually decreases leading to a large area around the input vector to which several neurons may respond therefore the rbf gradient is considerably high when the spread is small accordingly the neurons with the weights closest to the input output values that are higher than those of the other neurons the grnn is an approach that was first proposed by specht 1991 as a variation of the rbfnn this is an effective ann that provides a constructive solution for any approximation problem moreover it is a type of feed forward ann that is based on a non linear regression learning mechanism song et al 2016 the grnn contains four layers the input hidden pattern summation and decision layers the learning process is similar to the development of a multidimensional surface in the space that provides a statistically optimal approximation for the dataset if the training set of the grnn model is large the prediction error approaches zero moreover the kernel function gaussian is used wherein the sigma value σ determines the spread of the function 2 2 mart method by combining a boosting technique mart improves the decision tree method the core idea here is to combine a set of weak models to generate a strong consensus single model instead of building a single optimized model friedman et al 2001 2002 2002 mart produces new decision trees sequentially by reducing existing residuals this sequential model construction process is a type of functional gradient descent mason et al 1999 the mart model typically has three major parameters the learning rate v tree complexity and the number of regression trees elith et al 2008 the predictive accuracy of a mart model can be improved ensuring v 1 0 v 1 the mart algorithm established by friedman 1999 is utilized and optimized to enhance the precision of decision tree models the huber m regression loss function is utilized in the mart model that affords it a high resistance to outliers and misclassified cases cross validation methods are utilized to assess the generalization of the mart model and to prevent overfitting friedman 2001 2002 2002 friedman and meulman 2003 elith et al 2008 the development of the various ann and mart models requires two different processes training or learning and testing the training data consist of two subsets the training subset that is utilized to ascertain the best model parameters and the validation subset once the models have been trained a subsequent testing process is conducted to assess their ability to generalize the knowledge acquired in unknown cases during the training process nearly 70 of the entire data were randomly chosen for model training and the rest 30 were used for model testing matlab codes are written for the various models fig 1 demonstrates the data pre processing ﬂow diagram and the process modeling implementation for hs prediction 2 3 study area and data the study area was the abu qir bay coastal zone situated on the egyptian north eastern coast fig 2 overlooking the mediterranean coast it is considered to be one of the most important bays in egypt the meteorological data namely wind data speed and direction air temperature and sea level pressure were recorded between 2010 and 2014 from a weather station located at abu qir bay the pressure was measured at the sea level while wind characteristics and air temperature were measured at 10 m above the sea level to determine trends in the wind speed occurrence in different directions the wind data were statistically analyzed the results revealed that the wind blew predominantly from the north and nw directions northerly winds prevailed throughout the summer season while the predominant wind direction was between n and nw during the spring season with a minimal percentage from the north east direction the average wind speed was 2 knot in summer and spring and 4 knot in winter the maximum mean wind speed of 8 5 knot was observed in december while the minimum of 1 5 knot was observed in august the wave data were measured using s4dw wave data that were collected at a depth of 14 1 m the s4dw consists of an electro magnetic current meter with a pressure sensor these data were statistically analyzed to determine wave characteristics the analysis showed that the average annual h s was approximately 0 94 m and nw was the predominant direction of the wave 42 approximately 87 of h s was less than 1 5 m the maximum h s observed was 4 19 m for the waves from the nw direction during the winter season 3 results and discussion the selection of the input and output variables is a critical step in the development of any ml model the wind speed u wind direction θ wind duration t fetch f sea level pressure p and air temperature t a were considered as the input parameter variables for the ann and mart models and h s was the output the ml models employed were evaluated with six indices as tabulated in table 1 data processing was required before providing the training patterns as input into the network the following is a linear normalization function within zero to one 1 s x x m i n x m a x x m i n where s is the normalized value of variable x and the minimum and maximum variable values are x min and x max respectively 3 1 ann models for each model the results were obtained using 10 fold cross validation based on the average results obtained for each set of test data 10 fold the cross validation method was employed to train and test the various models to ensure that all the data set instances can be applied in both stages table 2 shows the training parameters of each model during the training phase of the various models except the ccnn all the other models were found to adequately approximate the data subset pattern to design a stable mpnn model based on u θ t f p and t a a parametric study was conducted to examine the stability of the network to adjust the optimum size of the mpnn a genetic algorithm ga was utilized fig 3 demonstrates mpnn performance with various neurons in the hidden layer as shown in fig 3 a network of the hidden layer with 13 neurons forms a stable and optimal network the results for the h s predictions are shown in fig 4a the results indicated that the rmse and mape calculated for the training data were 30 88 and 0 34 lower than those of the test data respectively elbisy 2019 and elbisy and osra 2019 obtained similar results supporting the findings reported here the improvement in rmse of the existing study was 86 85 greater than the result reported by elbisy 2015a furthermore elbisy 2015a reported r 0 947 therefore the correlation r 0 983 obtained in this study was judged to be appropriate the h s prediction was repeated based on a ccnn training scheme the results indicated that the rmse and mape calculated for the training data were 32 75 and 15 08 lower than those for the test data respectively fig 4 b presents the comparison of the h s values measured and predicted by the ccnn the results of the grnn model indicated that the rmse and mape calculated for the training data were 52 32 and 0 33 lower than those of the test data respectively fig 4c presents the comparison of the measured and grnn predicted h s values for the rbfnn ga was utilized to adjust the optimum sizes the best result was achieved by the rbfnn with the 6 16 1 architecture fig 5 shows the performance of rbfnn with different hidden neurons the results for the h s predictions are shown in fig 4d the results showed that the rmse and mape calculated in the training data were 15 12 and 0 07 lower than those of the test data respectively the variation in h s values between the measured data and rbfnn predicted results exhibited the same trend upon analyzing the indices it can be seen that all the models have lower index nmse mse mse mae rmse and mape values in the training subset compared with those in the testing subset the results revealed that the performance of the rbfnn model in predicting h s was more accurate than those of the other models table 3 moreover the results indicated that the overall error was significantly reduced in the rbfnn model and the h s values were accurately estimated additionally the four models slightly overestimated positive mse the h s values higher r values were obtained for the four neural network models that varied in the range of 0 973 0 99 mape was used to evaluate the average predictive capability expressed in generic percentage and calculate the accuracy of the predictive methods over the unseen data compared with the other models rbfnn yielded a mape value that was 2 51 27 09 and 3 76 lower than those of the mpnn ccnn and grnn respectively for the training data and 2 78 42 1 and 3 99 lower respectively in the case of the test data moreover the rmse calculated by the rbfnn was 22 34 88 11 and 66 67 lower than those of the mpnn ccnn and grnn respectively for the training data and 36 77 90 58 and 81 26 lower respectively in the case of the test data to predict the h s the neural network with the smallest training and test errors as a comprehensive estimator should be selected the prediction accuracy of the ann models with respect to the various ranges of h s was examined table 4 reveals that the rbfnn demonstrated a better performance than the other models for h s range of h s 1 0 m and h s 3 0 m a comparison of the rbfnn model results with those of the other models revealed that the mape of the rbfnn was 17 29 35 55 and 15 31 lower than those of the mpnn ccnn and grnn respectively for h s 1 0 m fig 6 and 0 68 4 06 and 0 73 lower respectively for h s 3 0 m fig 8d moreover for the h s range of 1 0 m h s 3 0 m all the models performed comparably although the mpnn yielded slightly more accurate results within the range of 1 0 m h s 2 0 m the mape of the mpnn was 0 06 2 27 and 0 67 lower than those of the rbfnn ccnn and grnn respectively and 0 48 2 53 and 1 29 lower respectively within the range of 2 0 m h s 3 0 m elbisy 2015a reported the rmse values of 0 068 m 0 131 m and 0 256 m for the superior svm model rbf kernel corresponding to the ranges of h s 1 0 m 1 0 m h s 2 0 m and h s 2 0 m respectively the results obtained for the mpnn ccnn grnn and rbfnn models used in this study were therefore judged to be appropriate the primary mechanism to achieve the highest efficiency of the model is through regularization that aims to maintain a low model complexity while fitting the data as best as possible the optimal extent of regularization is a trade off between the model simplicity and how well it fits the data ann can successfully map the inputs to the expected output vector by selecting the appropriate inputs in this study seven combinations of the u θ t f p and t a parameters were used as inputs for the prediction of h s by the rbfnn model to determine the optimal combination of input parameters its influence on the accuracy of the results and the performance of the model as can be seen from table 5 and figs 4d and 7 in general the combination of rbfnn parameters u θ t f resulted in more accurate results than the other parametric combinations for example the rmse value of the rbfnn u θ t f was lower than the values obtained for the other parameter combinations the rmse values for the rbfnn u θ t f were 5 81 12 90 35 10 39 60 3 57 and 42 14 lower than those for the rbfnn u θ f t p t a rbfnn u θ f p t a rbfnn u θ f t p rbfnn u θ t f t a rbfnn u θ f and rbfnn u f respectively for the test data the results indicate that the rbfnn u θ t f model significantly reduced the overall error it can therefore be concluded that the combinations of u θ t and f increased the model performance indicating that p and t a have a negligible effect on the h s prediction 3 2 mart model the mart model is yet another prediction model developed in this study u θ f t p and t a were the input variables to the model two methods were used for computing the significance of the predictor variables in the first method the algorithm estimated the relative impact of each parameter in response to prediction based on the friedman 2001 formula the second method was performed using cross validation the two measures of significance obtained were then averaged variable selection was implemented by eliminating input variables that did not contribute to enhancing the model accuracy the model was developed by first utilizing all the predictor variables u θ t f p and t a and thereafter gradually eliminating them according to their relative influence this process created various models and based on the lowest residual deviance obtained the model with the optimal subset of variables was accordingly selected from the analysis u 89 35 was found to be the most relevant predictor followed by f 5 50 θ 2 80 and t 2 35 among the input variables there was no sensitivity noted for p or t a this result is emphasized by the results in section 3 1 to determine the optimal parameters the mart model was trained and validated for a combination of a different number of trees 1 400 learning rates 0 005 0 5 maximum splitting levels 5 minimum size node to split 10 and maximum categories for continuous predictors 1000 to avoid overﬁtting the prediction performance was assessed using the 5 folder cross validation method fig 8 shows the performance of the mart model with various trees and table 2 shows the training parameters of the mart model the best mart model configuration parameter values have been found for 60 trees and a learning rate value of 0 05 based on several experiments conducted in this study according to the results the mart model performance for the training set and test set was similar this indicated that the mart model s generalization performance was good the statistical results for the training data for the predicted h s were as follows nmse 0 00004 m mse 0 00001 m2 mae 0 0003 m rmse 0 0036 m mape 0 015 and r 0 998 all index values of the test data were comparable to those of the training data these results indicate that the mart model is a good predictor of h s as shown in fig 9 the predicted results of the mart model are close to the corresponding actual values of h s the prediction accuracies of the mart model for different h s ranges were investigated the mart model predictions for different h s ranges were reasonable when compared with the recorded values table 6 from the results it can be seen that the predictions of the mart model are closer to the corresponding actual values for all h s ranges compared with those of the ann models 3 3 comparison between the ann and mart methods the prediction performance of the mart model is compared in this section with that of the ann models with respect to both the nmse mse mae rmse mape and r values as well as the computation time of the prediction process the mart method demonstrated the best prediction performance followed by the second best model rbfnn the ccnn model exhibited the worst predictive capabilities indicating that this model cannot reliably approximate the h s the results revealed that the overall performance of the rbfnn model was more accurate than those of the other ann models the results confirmed the high accuracies of the mart and rbfnn models for training data and test data the mape of mart was improved by 2 15 and 2 22 over the rbfnn model the accuracy of the mart and ann models for various h s ranges has been examined based on the results of ann models shown in table 4 it can be said that the rbfnn model leads to better results for h s range of h s 1 0 m and h s 3 0 m while the mpnn model provides slightly more accurate results for h s in the range of 1 0 m h s 3 0 m based on the indices the mart model performs better than the ann models for all h s ranges a comparison of the mape values of the mart and rbfnn models indicated that the smallest difference in the performance of the two techniques 7 45 0 44 1 05 and 0 46 were observed for h s ranges h s 1 0 m 1 0 m h s 2 0 m 2 0 m h s 3 0 m and h s 3 0 m respectively furthermore a comparison of the results of the mart and mpnn models revealed that the mape of the mart model were 24 74 0 38 0 57 and 1 14 lower than those of the mpnn model for h s ranges h s 1 0 m 1 0 m h s 2 0 m 2 0 m h s 3 0 m and h s 3 0 m respectively the correlation coefficients of the three models were almost the same for all the h s ranges in general the results of the mart model were more precise than those of the ann models in other words the mart model produced satisfactory h s predictions for all h s ranges with respect to the predictive accuracy speed convenience and interpretability the results show that mart is the most reliable model for h s prediction because the mart algorithm is fast and overfitting resistant and can automatically select valuables and handle data imperfections outliers missing values and mistakes well it has proved to be superior to the other models 4 conclusions this study developed four ann models mpnn ccnn rbfnn and grnn and mart model to predict h s the ann and mart models were trained and validated using the cross validation approach ensuring that all instances of the data set be employed using six performance measures mse mae mape nmse rmse and r the various predictive methods were comprehensively compared the following conclusions can be drawn based on this analysis for the prediction of h s the best performance of the models was achieved by introducing wind speed wind direction wind duration and fetch in the input layer moreover it has been confirmed that wind speed is the most influencing parameter followed by fetch wind direction and wind duration analyzing the ann models the rbfnn was found to be more accurate than the other models mape of the rbfnn was 2 51 27 09 and 3 76 lower than those of the mpnn ccnn and grnn respectively for the training data and 2 78 42 1 and 3 99 lower respectively for the test data this indicates that the rbfnn has the greatest capability for predicting h s followed by mpnn grnn and ccnn however to be more accurate the mpnn model performs slightly better than the rbfnn model for the h s range of 1 0 m h s 3 0 m the results confirmed the high accuracies of the mart and rbfnn models a comparison of the h s prediction results obtained using the mart model and the rbfnn model showed 2 15 and 2 22 improvement in the mape using the mart model for the training and test data respectively the mart model was more accurate than the ann models for all h s ranges the proposed mart model is efficient and precise and can therefore serve as a practical tool for h s prediction the mart model is a promising complement to conventional forecasting techniques owing to its predictive performance and the simplicity of the model setup credit authorship contribution statement moussa s elbisy conceptualization data curation formal analysis methodology software validation writing original draft writing review editing ahmed m s elbisy methodology software validation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20782,the purpose of this discussion is to demonstrate how the formula for the wave induced pipeline scour presented by cheng et al 2020 can be extended to random wave induced pipeline scour favorable results are obtained by comparing the stochastic method predictions with the sumer and fredsøe 1996 data for pipeline scour beneath random waves plus current keywords equilibrium pipeline scour random waves current stochastic method 1 discussion the paper by cheng et al 2020 hereafter referred to as c20 suggested that the equilibrium scour depth normalized with the size of the vortex street can be taken to be constant for both waves alone and waves plus current by performing dimensional analysis in conjunction with experimental data they found the following formula for the equilibrium scour depth s beneath a fixed pipeline with diameter d 1 s a d c where a is the undisturbed near bed orbital displacement amplitude and c is a constant varying from 0 23 to 0 24 however here it is pointed out that one should be careful when interpreting their results first for waves alone eq 1 was deduced based on scour under regular waves giving c 0 24 with a standard deviation of 0 06 second for waves plus current eq 1 was obtained based on the sumer and fredsøe 1996 hereafter referred to as sf96 data for scour under random waves plus current giving values of c ranging from 0 18 to 0 28 with an average of 0 23 thus in this case eq 1 is valid by replacing a with a rms i e the root mean square rms value of a furthermore for regular waves alone c20 defined the densimetric froude number f d by 2 f d u m ρ s ρ 1 g d 50 1 2 where u m ω a is the undisturbed near bed orbital velocity amplitude ω 2 π t w is the angular wave frequency t w is the wave period ρ s is the sediment density ρ is the fluid density g is the acceleration due to gravity d 50 is the median grain size diameter a is related to the linear wave amplitude η by a η sinh k h where h is the water depth and k is the wave number determined from the dispersion relationship ω 2 g k tanh k h for random waves plus current the revised froude number f d r m s is 3 f d r m s u r m s u c ρ s ρ 1 g d 50 1 2 where the rms value of u m is u r m s ω p a r m s ω p 2 π t p is the angular peak frequency corresponding to the peak period t p and u c is the current velocity now a r m s η r m s sinh k p h where η r m s is the rms value of η and k p is the wave number corresponding to ω p 2 g k p tanh k p h as referred to the sf96 data used by c20 in this analysis represent scour beneath pipelines exposed to combined colinear random waves plus current acting perpendicular to the pipelines thus it is relevant to adapt the c20 model in eq 1 for regular waves alone to random waves plus current and compare the results with the sf96 data most of the works on pipeline scour have dealt with current alone regular waves alone and regular waves plus current exceptions are sf96 and works by the present discussers e g scour below pipeline on horizontal bed due to nonlinear random waves plus current myrhaug et al 2009 scour below pipeline on horizontal bed due to long crested and short crested nonlinear random waves myrhaug and ong 2011 here eq 1 is adapted to random waves plus current by considering a sea state containing stationary narrow band random waves consistent with linear regular waves in finite water depth at a fixed location then ω ω p based on the narrow band assumption and accordingly a η sinh k p h for individual narrow band random waves eq 1 is rearranged to 4 s s c a r m s d w 1 2 where w η η r m s is the dimensionless linear wave amplitude as e g in myrhaug et al 2009 it is assumed that the highest waves are responsible for the scour process in the considered narrow band sea state it is also assumed that the sea state has lasted long enough to develop the equilibrium scour depth the highest waves considered here are those with wave amplitudes exceeding the probability 1 n w 1 n i e 1 p w 1 n 1 n where p w is the cumulative distribution function cdf of w which here is taken as the rayleigh cdf i e consistent with the assumptions 5 p w 1 exp w 2 w 0 the characteristic scour depth considered here is the expected mean value of the scour depth caused by the 1 n th highest waves with wave amplitudes exceeding w 1 n i e 6 e s w w w 1 n n w 1 n s w p w d w where s w w 1 2 from eq 4 and p w d p w d w is the probability density function pdf of w then by using the formulae in abramowitz and stegun 1972 chs 6 5 and 26 4 the result of eq 6 is 7 e w 1 2 w w 1 n n γ 1 25 ln n where γ is the incomplete gamma function here n 3 and n 10 are considered giving s 1 3 1 184 and s 1 10 1 339 which inserted in eq 4 with c 0 24 yields 8 s 1 3 a r m s d 0 28 9 s 1 10 a r m s d 0 32 the sf96 data in table 1 of c20 represent random waves plus current i e for t w t p u m u r m s a a r m s the size of vortex street r v r v r m s a r m s d f d f d r m s s r v s a r m s d and the keulegan carpenter number k c k c r m s u r m s t p d thus the results in fig 5 of c20 is valid for random waves plus current when s r v u c u m and kc are replaced with s r v r m s s a r m s d u c u r m s and k c r m s respectively then it is noticed that the result in eq 8 corresponds to the upper value s r v r m s 0 281 sf96 no 5 in table 1 of c20 while eq 9 gives a slightly larger value thus overall the present results agree with those in c20 provided that their results are interpreted correctly i e that eq 1 with c 0 24 can be used for random waves plus current for u c u r m s declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20782,the purpose of this discussion is to demonstrate how the formula for the wave induced pipeline scour presented by cheng et al 2020 can be extended to random wave induced pipeline scour favorable results are obtained by comparing the stochastic method predictions with the sumer and fredsøe 1996 data for pipeline scour beneath random waves plus current keywords equilibrium pipeline scour random waves current stochastic method 1 discussion the paper by cheng et al 2020 hereafter referred to as c20 suggested that the equilibrium scour depth normalized with the size of the vortex street can be taken to be constant for both waves alone and waves plus current by performing dimensional analysis in conjunction with experimental data they found the following formula for the equilibrium scour depth s beneath a fixed pipeline with diameter d 1 s a d c where a is the undisturbed near bed orbital displacement amplitude and c is a constant varying from 0 23 to 0 24 however here it is pointed out that one should be careful when interpreting their results first for waves alone eq 1 was deduced based on scour under regular waves giving c 0 24 with a standard deviation of 0 06 second for waves plus current eq 1 was obtained based on the sumer and fredsøe 1996 hereafter referred to as sf96 data for scour under random waves plus current giving values of c ranging from 0 18 to 0 28 with an average of 0 23 thus in this case eq 1 is valid by replacing a with a rms i e the root mean square rms value of a furthermore for regular waves alone c20 defined the densimetric froude number f d by 2 f d u m ρ s ρ 1 g d 50 1 2 where u m ω a is the undisturbed near bed orbital velocity amplitude ω 2 π t w is the angular wave frequency t w is the wave period ρ s is the sediment density ρ is the fluid density g is the acceleration due to gravity d 50 is the median grain size diameter a is related to the linear wave amplitude η by a η sinh k h where h is the water depth and k is the wave number determined from the dispersion relationship ω 2 g k tanh k h for random waves plus current the revised froude number f d r m s is 3 f d r m s u r m s u c ρ s ρ 1 g d 50 1 2 where the rms value of u m is u r m s ω p a r m s ω p 2 π t p is the angular peak frequency corresponding to the peak period t p and u c is the current velocity now a r m s η r m s sinh k p h where η r m s is the rms value of η and k p is the wave number corresponding to ω p 2 g k p tanh k p h as referred to the sf96 data used by c20 in this analysis represent scour beneath pipelines exposed to combined colinear random waves plus current acting perpendicular to the pipelines thus it is relevant to adapt the c20 model in eq 1 for regular waves alone to random waves plus current and compare the results with the sf96 data most of the works on pipeline scour have dealt with current alone regular waves alone and regular waves plus current exceptions are sf96 and works by the present discussers e g scour below pipeline on horizontal bed due to nonlinear random waves plus current myrhaug et al 2009 scour below pipeline on horizontal bed due to long crested and short crested nonlinear random waves myrhaug and ong 2011 here eq 1 is adapted to random waves plus current by considering a sea state containing stationary narrow band random waves consistent with linear regular waves in finite water depth at a fixed location then ω ω p based on the narrow band assumption and accordingly a η sinh k p h for individual narrow band random waves eq 1 is rearranged to 4 s s c a r m s d w 1 2 where w η η r m s is the dimensionless linear wave amplitude as e g in myrhaug et al 2009 it is assumed that the highest waves are responsible for the scour process in the considered narrow band sea state it is also assumed that the sea state has lasted long enough to develop the equilibrium scour depth the highest waves considered here are those with wave amplitudes exceeding the probability 1 n w 1 n i e 1 p w 1 n 1 n where p w is the cumulative distribution function cdf of w which here is taken as the rayleigh cdf i e consistent with the assumptions 5 p w 1 exp w 2 w 0 the characteristic scour depth considered here is the expected mean value of the scour depth caused by the 1 n th highest waves with wave amplitudes exceeding w 1 n i e 6 e s w w w 1 n n w 1 n s w p w d w where s w w 1 2 from eq 4 and p w d p w d w is the probability density function pdf of w then by using the formulae in abramowitz and stegun 1972 chs 6 5 and 26 4 the result of eq 6 is 7 e w 1 2 w w 1 n n γ 1 25 ln n where γ is the incomplete gamma function here n 3 and n 10 are considered giving s 1 3 1 184 and s 1 10 1 339 which inserted in eq 4 with c 0 24 yields 8 s 1 3 a r m s d 0 28 9 s 1 10 a r m s d 0 32 the sf96 data in table 1 of c20 represent random waves plus current i e for t w t p u m u r m s a a r m s the size of vortex street r v r v r m s a r m s d f d f d r m s s r v s a r m s d and the keulegan carpenter number k c k c r m s u r m s t p d thus the results in fig 5 of c20 is valid for random waves plus current when s r v u c u m and kc are replaced with s r v r m s s a r m s d u c u r m s and k c r m s respectively then it is noticed that the result in eq 8 corresponds to the upper value s r v r m s 0 281 sf96 no 5 in table 1 of c20 while eq 9 gives a slightly larger value thus overall the present results agree with those in c20 provided that their results are interpreted correctly i e that eq 1 with c 0 24 can be used for random waves plus current for u c u r m s declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20783,the wave driven glider is a kind of unmanned ocean surface vehicle solely powered by waves and solar energy which allows marine monitoring in large temporal and spatial scales therefore it has a broad application prospect in ocean survey and observation this paper focuses on the development of the control system for the wave driven glider the hardware distribution and the robot operating system based software framework are developed the sailing control strategies corresponding to position keeping path following and heading control are presented and validated by numerical experiments moreover the wave driven glider named sjtu mouse were developed including the first generation based on side propeller control and the second generation based on rudder control besides the wave glider remote control management platform wgrcmp was developed sea trials were also conducted in the south china sea results show that with the proposed control system the wave driven glider can adapt to different mission and ensure successful vehicle operations demonstrating the feasibility and applicability of the control system keywords wave driven glider control system simulation sea trial 1 introduction the detection and monitoring of ocean is one of the most active front fields of the marine sciences research however due to the oceanic area is gigantic ocean monitoring usually needs to be carried out in a large range and for a long time which brings a great challenge to ocean monitoring equipment the traditional fixed point buoy cannot realize the mobile measurement at sea and the measurement range is very limited the cost of scientific research ship is too high to realize large scale application the underwater gliders such as slocum simonetti and jones 2001 spray sherman et al 2001 seaglider eriksen et al 2001 and deepglider osse and eriksen 2007 have been widely developed in recent years however due to the limitation of battery power their sailing time is limited therefore people are eager to develop a kind of marine unmanned autonomous vehicle which is totally dependent on marine energy in this paper the wave driven glider solely powered by waves and solar energy is investigated wave driven glider a kind of totally wave driven unmanned surface vehicle usv has been investigated for persistent marine monitoring since 2005 hine et al 2009 manley and willcox 2010 smith et al 2011 daniel et al 2011 frolov et al 2011 the structure of the wave driven glider is different from that of the conventional single body usv it is composed of a float at the ocean surface connected to an underwater glider via a flexible cable manley et al 2009 the underwater glider fluctuates up and down with the heaves of the float in the waves meanwhile the hydrofoils installed on the underwater glider rotate passively which will generate continuous forward thrust as shown in fig 1 since the wave driven glider is driven by wave energy completely supported with solar energy for data collection transmission and motion control the wave driven glider can be applied in a wide variety of applications including acoustic data collection communication gateway for subsurface systems meteorological observation and fisheries management fitzpatrick et al 2015 meyer gutbrod et al 2015 wang et al 2018b in order to make the wave driven glider give full play to its unique advantages and complete various tasks at sea it is of great significance to study its control system for usv operating for long periods at sea the quality of the control system directly determines its operation efficiency and safety the liquid robotics has achieved long term autonomous navigation of the wave driven gliders but there is no published documents on the control system there are also some other researches contributing to the development of wave driven glider control system olson 2012 described the data communication architecture of the wave driven glider zhang et al 2014 developed a navigation and positioning shore based monitoring application for the wave driven glider based on the gps beidou dual mode technology and google earth api besides the motion control of the wave driven glider has become a hot spot for its characteristics of underactuation weak maneuverability and low speed caused by its special dual structure and driving mode shi et al 2014 calculated the geodesic distance of current and presupposed position as well as the heading angle deviation based on gaussian geodesic algorithm liao et al 2016 developed an adaptive pid control algorithm combined with light of sight los guidance strategy which can compensate the steady state error of the wave driven glider due to the influence of current in the process of path tracking in 2018 considering the conventional course control methods for single body vehicle are not applicable to the wave driven glider wang et al 2018a proposed the heading information fusion strategy for calculating the desired heading of the wave driven glider simulation experiments and sea trials for the wave driven glider were conducted wang et al proposed a novel robust position keeping guidance strategy wang et al 2020b and an advanced path following approach wang et al 2019b for the wave driven glider based on restricted circle to avoid unnecessary energy consumption however the control system development for the wave driven glider in aspects of overall architecture guidance algorithm operational software and hardware is a very complex and systematic task all parts should be coordinated to meet the working environment and requirements this paper comprehensively introduces the development of the control system of the wave driven glider including the overall architecture framework hardware distribution and software design sailing control algorithms with regard to position keeping path following and heading control are presented and validated by numerical experiments moreover the sea trials was also conducted with the wave driven glider sjtu mouse this work provides an important reference for the complete development of the control system for the wave driven glider and other underactuated unmanned vehicles at sea the main contributions of this work can be summarized as follows 1 the hardware distribution and the robot operating system ros based software framework for the wave driven glider was developed 2 the position keeping and path following guidance strategies are presented and validated by numerical experiments 3 a wave glider remote control management platform was developed 4 sea trials were conducted in the south china sea and the feasibility and applicability of the proposed control system was demonstrated the remainder of the paper is organized as follows dynamic modeling for the wave driven glider in complex waves is presented in section 2 the overall architecture and hardware framework are discussed in section 3 the ros based software framework is presented in section 4 the sailing control strategies are presented in section 5 the development of graphical user interface gui is presented in section 6 field tests are discussed in section 7 and some conclusions are summarized in section 8 2 dynamic modeling to investigate the control performance with respect to the wave driven glider an 8 dof model is developed including a 4 dof model of the float and a 4 dof model of the submarine glider respectively the wave glider s corresponding coordinate systems are shown in fig 2 to facilitate the modeling three right handed coordinate systems are defined consisting of one inertial reference frame n and two body fixed frames b 1 and b 2 for the reference frame n with original point o n set at any place in the sea the x axis points towards true north the y axis points towards east while the z axis points vertically downwards for the body fixed frames b 1 and b 2 the origins o b 1 and o b 2 fixed to the float and the glider respectively are set at the gravity center and the x axis points towards the vehicle s surge direction while the y axis points towards the vehicle s starboard in this work the 4 dof motion of the surface float is divided into a 3 dof low frequency l f horizontal motion and a wave frequency w f heave motion the dynamic equations of the 3 dof l f motion of the surface float are within the horizontal plane and the w f motion in the heave direction the equations of the wave driven glider motions can be written as follows 1 η 1 j θ η 1 v 1 m r b 1 a 1 0 v 1 c r b 1 v 1 c a 1 v 1 r d 1 v 1 v 1 r τ 1 t e t h e r τ w d m 1 a ω h e a v e z 1 b ω h e a v e z 1 ρ g a w p 0 z 1 τ w f τ 1 t e t h e r where η x 1 y 1 z 1 ϕ 1 t denotes the vector of position and attitude of the wave driven glider in the reference frame o n x n y n z n v 1 u 1 v 1 w 1 r 1 and v 1 r is the velocity vector and relative velocity vector of the wave driven glider in the reference frame o b 1 x b 1 y b 1 z b 1 respectively j θ η 1 is the rotation matrix from o b 1 x b 1 y b 1 z b 1 to o n x n y n z n m r b 1 is the rigid body inertia matrix a 1 0 is the added mass matrix calculated at zero frequency and the constant frequency model in the heave should be formulated at its respective natural frequency the term d 1 v 1 includes both linear and quadratic damping c r b 1 v 1 c a 1 v 1 r is the coriolis and centripetal matrix b ω h e a v e is the radiation damping caused by the heave motion of the float τ w d is the second order wave drift forces and τ w f is the first order wave induced forces τ 1 t e t h e r is the tether forces exerted on the float in order to predict the responses of wave driven glider in open sea the jonswap spectrum is used to describe the non fully developed seas fig 3 shows the linear relationship between the wave induced forces and the wave heights the tether can be regarded as a spring with strong stiffness and the mass is ignored tether tension can be calculated with the following equation 2 t k δ l t 0 t 0 0 t 0 where t is the tether tension k 1 7 1 0 8 n m denotes the tether stiffness t 0 is the length change of the tether g 0 represents the wet weight of submarine glider t 0 g 0 k is the initial value of equilibrium state the tether forces at the surface float side are given as 3 τ 1 t e t h e r τ x τ y τ z τ n t s i n β c o s α 1 t s i n β s i n α 1 t c o s β 0 the tether forces at the submarine glider side are given as 4 τ 2 t e t h e r τ x τ y τ z τ n t s i n β c o s α 2 t s i n β s i n α 2 t c o s β 0 where α and β are the relative angles of tether with respect to inertial frame as shown in fig 4 the 4 dof kinematic and kinetic equations of the submarine glider are written in the following form 5 η 2 j θ η 2 v 2 m r b 2 a k 0 v 1 c r b 2 v 2 c a k v 2 r v 2 r d k v 2 r v 2 r g τ 2 t e t h e r τ p τ h f where η 2 x 2 y 2 z 2 ϕ 2 t denotes the vector of position and attitude of the glider in the reference frame n the v 2 u 2 v 2 w 2 r 2 represents velocity vector of the glider in the reference frame b 2 j θ η 2 is the rotation matrix from b 2 to n m r b 2 is the rigid body inertia matrix a k 0 is the added mass matrix of glider keel c r b 2 v 2 c a k v 2 r v 2 r is coriolis and centripetal matrix of glider keel τ 2 t e t h e r denotes the vector of tether forces τ h f is vector of hydrofoil induced forces τ p is vector of propeller induced forces the distance between the gravity center of the glider and the propeller center denotes as l c g f p is the thrust this gives 6 τ p τ p x τ p y τ p z τ p n 0 f p 0 f p l c g it should be noted that eq 6 is suitable for the side propeller control based wave driven glider the rudder based controller is described in wang et al 2019a fig 5 shows the diagram of hydrofoil force at the falling and rising phases respectively the hydrofoil forces as the glider falling and rising 7 τ h f τ h f x τ h f y τ h f z τ h f n f l s i n α f f d c o s α f 0 s i g n w 2 f l c o s α f s i g n w 2 f d s i n α f 0 where v f u 2 2 w 2 2 is hydrofoil real velocity α 0 is hydrofoil limit angle α f a r c t a n w 2 u 2 is the angle of hydrofoil related to horizontal direction α k α f α 0 ia the angle of attack f l is lift force of the hydrofoils f d is drag force of the hydrofoils 3 hardware distribution in this study the wave driven glider named sjtu mouse was designed and developed in shanghai jiao tong university sjtu including the first generation based on side propeller control and the second generation based on rudder control as shown in fig 6 table 1 provides an overview of the characteristics of sjtu mouse the overall architecture and hardware distribution of the control system for the sjtu mouse is designed as shown in fig 7 considering the automation level of the system the whole system is divided into four parts high level part and the energy system that power it low level part as well as the communication system the low level part refers to shipboard module which is responsible for marine environment information collection and transmission navigation guidance and course control this part allows for reliable mission execution and automatic navigation the high level part is responsible for situational awareness of the wave driven glider the centralized control and monitoring of marine environment information navigation task planning etc the low level part is further divided into perception layer decision making layer and execution layer the perception layer uses the sensors arranged on the wave driven glider to sense the marine environment and its own state mission dependent decision making and planing such as position keeping and path following is done in the decision making layer moreover the execution layer is involved in turning the course of the glider by the way of controlling the rudder angle or the rotation speed of the side propeller by grouping the whole system framework the relationship between each component can be clearly defined and the maintainability and expansibility of the system can also be improved moreover the hardware distribution is designed to be modular and expandable each module such as battery compass weather station beidou and propeller is separately sealed and connected to the central control unit the used hardware components for the second generation sjtu mouse are listed in table 2 4 software framework the distributed approach of splitting tasks among multiple parts and layers requires a suitable software framework to manage each component and enable communication between them the software framework must support distributed communication flexible data format scalability and simple user interface ros was chosen as the most suitable software framework in this study ros quigley et al 2009 is a free available software framework for robot development which aims to simplify the difficulty and complexity of creating robust robot behaviors across robot platforms li et al 2013 ros has been applied in many practical engineering cases mason and marthi 2012 borja et al 2013 schulman et al 2013 in this paper the software framework based on ros was developed on the first generation sjtu mouse which communicates with the client based on tcp ip protocols deployment of distributed nodes is presented and topic based communication between nodes is also presented as shown in fig 8 which allows fast data synchronization over wlan ros launch file provides a way to start node manager and multiple nodes at the same time as shown in fig 8 ros nodes are divided into four groups navigation guidance gui this system uses ros distributed multi computer communication pc runs gui node which is responsible for data monitoring and remote control raspberry pi installed on the wave driven glider runs other nodes in navigation group nodes of weather gnss pub and lmu pub are responsible for sensor data acquisition preprocessing and publishing location and velocity of the wave driven glider will be published by gnss pub node course of the wave driven glider will been published by lmu pub node the air pressure wind speed and direction as well as the temperature will be published by weather node as for nodes in guidance control and gui details are discussed in sections 5 and 6 5 sailing control strategies 5 1 heading control base on the desired course φ d from the position keeping strategy or the path following strategy and the real course φ from the compass the pid algorithm is used to calculate the side propeller thrust f p for the first generation sjtu mouse or rudder angle δ for the second generation sjtu mouse so as to adjust the heading the control procedure is shown in fig 9 pid controller is a linear controller that is widely used in the engineering field anderson et al 1988 åström and hägglund 2001 as shown in following equation 8 o u t p u t k p e k i e d t k d e where k p k i and k d are control parameters with regard to proportion integration and derivative respectively e is the error between current course φ and desired value φ d the heading control performances of the two kinds of controllers i e the side propeller based controller and the rudder based controller are compared in simulations in terms of course response course keeping and turning by wang et al 2020a experiments were conducted in the wave tank with the side propeller control based first generation sjtu mouse as shown in fig 10 the results demonstrated that the side propeller control based wave driven glider has better maneuverability than the conventional rudder control based wave driven glider however the side propeller based controller will consume more energy than the rudder based controller for a long sea voyage 5 2 position keeping when the wave driven glider performs some specific tasks on the sea for example communication gateway for subsurface systems or ocean on the spot monitoring it often needs to conduct virtual anchoring which makes the wave driven glider fixed in a certain range of water surface by continuously controlling the course traditionally the desired course is usually set as the direction from the current position to the target position the wave driven glider will always move forward in the waves so when the vehicle is close to the target position the desired course will frequently change greatly concerning the weak maneuverability of the wave driven glider in this case it will cause a lot of energy loss therefore the position keeping strategy based on restricted circle theory proposed by wang et al 2020b is adopted in this study as shown in fig 11 a restricted circle is proposed to limit the continuous turning of the wave driven glider near the target position when the wave driven glider enters the restricted circle area the desired course will no longer change which is determined by the moment just entering the restricted circle when the wave glider is outside the restricted circle area the desired course is defined as the direction from the real time position to the target point which can be expressed as eq 9 9 φ d arctan y d y t x d x t x d x t π arctan y d y t x d x t y d y t x d x t π arctan y d y t x d x t y d y t x d x t π 2 y d y t x d x t π 2 y d y t x d x t based on the mathematical model of the side propeller control based first generation sjtu mouse introduced in section 2 and the position keeping guidance algorithm a time domain simulation program was developed the position keeping performance was investigated under the conditions of different restricted circle radius r and significant wave heights h s as shown in table 3 the peak period of the simulated waves is 6 28 s e is introduced here to quantitatively evaluate the energy consumption of wave driven glider during the position keeping it is defined as the average thrust per time step produced by the propeller 10 e t 1 n t t n where t t is the thrust of the propeller at time step of t n is the number of total time steps it can be seen from fig 12 that when the wave driven glider is sailing in the restricted circle the trajectory is regular and the navigation state is stable fig 13 shows the time series of thrust under different conditions it can be seen from table 3 that consistent with previous studies wang et al 2020b 2019b with the increase of radius r and the decrease of wave height the energy consumption coefficient e of the wave driven glider gradually decreases which means less power consumption in the process of position keeping moreover it can be concluded that under the same sea state the smaller restricted circle ensures a better positioning accuracy whereas leads to a large energy consumption 5 3 path following wave driven glider usually need to navigate through a series of preset way points when it performs a long distance mission at sea such as maritime patrol or marine monitoring the conventional los guidance strategy for path following has been widely studied fossen 2002 2011 however in this case concerning that the position error existence in application to avoid unnecessary energy loss caused by continuous course control near the preset path this study adopts the advanced los guidance strategy based on restricted circle theory proposed by wang et al 2019b as shown in fig 14 if the wave driven glider is out of the restricted circle the desired course φ d is alongside the vector p t p l o s on the other hand if the wave driven glider is in the restricted circle that is the blue area in fig 14 the desired course will not change and it is equal to the direction of the vector p k 1 p k the path following algorithm for the wave driven glider is shown as algorithm 1 to verify the feasibility of the path following algorithm to the side propeller control based first generation sjtu mouse a time domain simulation was conducted the simulated conditions and results of the path following performance are listed in table 4 c represents the average value of the cross tracking error during the voyage and is calculated using eq 11 11 c t 1 n x t x t 0 2 y t y t 0 2 n where x t y t is the real time position of wave driven glider x t 0 y t 0 is the foot point of the vertical line from the real time position of wave driven glider to the current track segment n is the number of total time steps fig 15 presents the sailing paths of the wave driven glider during the path following missions under conditions 1 4 it can be seen that the restricted circle radius r has a great influence on the path following performances of the wave driven glider as r increases the tracking error increases accordingly however the energy consumption shows the opposite trend there could be a phenomenon in application that the wave driven glider is located in the restricted circle but the measured position is outside the restricted circle due to the measurement error resulting in an incorrect control and unnecessary energy consumption therefore a larger radius r can reduce unnecessary energy loss but it will reduce the accuracy of path following in addition fig 15 shows that the effect of wave height on path following is relatively small 6 gui the wave glider remote control management platform wgrcmp was developed in this study as shown in fig 16 it enables command and control of several wave driven gliders based on a single console increasing working efficiency it facilitates mission planning data monitoring and remote control besides it also provides role based access defined roles and access control allow both collaboration and security helping to protect mission and data integrity key functions and benefits include 1 vehicle status and sensor data monitoring profile information communication mode selection working mode display and energy management mode selection marine environmental data display temperature air pressure wind speed wind direction etc vehicle status display battery state speed heading propeller power etc monitoring report generation navigation track environmental conditions operation status etc in any period of time 2 real time management control sailing control mode adapt to different mission and enables swapping between navigation modes with ease energy management mode settings include automaticmode based on energy storage level and manual mode guided by operation task pid parameters adjustment interface 3 log area real time display of received data feedback whether control command is issued successfully 4 map display vector coastline map allowing users to access coastline data support scaling range finding obstacle marking history trail display etc 7 field tests in november 2020 sea trial was conducted in the south china sea with the rudder control based second generation sjtu mouse which is based on the beidou radio dual communication modes as shown in fig 17 a path following task was completed in sea trial the significant wave height during the sea trial is about 0 3 m and the current is about eastward fig 18 shows the path following trajectory as well as the path following error and speed of the sjtu mouse in sea trial which is composed of five track segments the whole sailing distance is about 4 5 km and the sailing time is about 1 4 h fig 19 shows the pitch and roll of the submarine glider of the sjtu mouse it can be seen from fig 18 that under the disturbances of waves and currents in the sea trial the sjtu mouse moved at an average speed of 0 87 m s during the path following test the real path matches well with the desired one and the path tracking error is within 100 m during most of the time however between the fourth and fifth track segments due to the influence of current the tracking error reaches 150 m moreover fig 19 shows that pitch and roll of the submarine glider of the sjtu mouse are within 5 degrees and the mean values of pitch and roll are 1 0 and 0 2 degrees respectively the results show that the motion of the submarine glider is stable during sailing besides the meteorological data including temperature and wind were also recorded as shown in fig 20 8 concluding remarks this paper focuses on the control system development for the wave driven glider the hardware distribution and the robot operating system based software framework are developed sailing control algorithms with regard to position keeping path following and heading control are presented and validated by numerical experiments the wave glider remote control management platform was developed moreover the sea trials was also conducted with the second generation sjtu mouse results show that with the proposed control system the wave driven glider can adapt to different mission and ensure successful vehicle operations demonstrating the feasibility and applicability of the control system this research provides an important reference for the control system development for the wave driven glider and other ocean surface underactuated unmanned vehicles however there are still some deficiencies which need to be further improved in the future 1 the marine environment has a significant impact on the speed and control accuracy of wave driven glider so it is necessary to develop propeller assisted propulsion system to improve the speed of wave driven glider when sailing against the current and the waves are small however due to that the wave driven glider is a fully energy self sufficient system the propeller assisted propulsion must put forward new requirements for the power generation capability and energy management level of the wave driven glider 2 considering that the motion of the wave driven glider is significantly affected by the current it is necessary to develop an intelligent path planning algorithm for the wave driven glider in complex marine environment so as to use the current reasonably to improve the navigation efficiency credit authorship contribution statement peng wang conceptualization methodology formal analysis sea trial writing original draft xinliang tian conceptualization review and editing funding acquisition xin liang editing sea trial xiaoxian guo methodology formal analysis xin li software review and editing xiantao zhang conceptualization review and editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors would like to thank the supports from oceanic interdisciplinary program of shanghai jiao tong university china project number sl2020zd201 scientific research fund of second institute of oceanography mnr china grant no sl2001 the research program of sanya yazhou bay science and techonlogy city sktc 2020 01 006 natural science foundation of shanghai grant no 19zr1426300 national natural science foundation of china grant nos u20a20328 11632011 51779141 shanghai pujiang program china grant no 19pj1405400 shanghai innovation action plan of science and technology china grand no 19dz1207300 
20783,the wave driven glider is a kind of unmanned ocean surface vehicle solely powered by waves and solar energy which allows marine monitoring in large temporal and spatial scales therefore it has a broad application prospect in ocean survey and observation this paper focuses on the development of the control system for the wave driven glider the hardware distribution and the robot operating system based software framework are developed the sailing control strategies corresponding to position keeping path following and heading control are presented and validated by numerical experiments moreover the wave driven glider named sjtu mouse were developed including the first generation based on side propeller control and the second generation based on rudder control besides the wave glider remote control management platform wgrcmp was developed sea trials were also conducted in the south china sea results show that with the proposed control system the wave driven glider can adapt to different mission and ensure successful vehicle operations demonstrating the feasibility and applicability of the control system keywords wave driven glider control system simulation sea trial 1 introduction the detection and monitoring of ocean is one of the most active front fields of the marine sciences research however due to the oceanic area is gigantic ocean monitoring usually needs to be carried out in a large range and for a long time which brings a great challenge to ocean monitoring equipment the traditional fixed point buoy cannot realize the mobile measurement at sea and the measurement range is very limited the cost of scientific research ship is too high to realize large scale application the underwater gliders such as slocum simonetti and jones 2001 spray sherman et al 2001 seaglider eriksen et al 2001 and deepglider osse and eriksen 2007 have been widely developed in recent years however due to the limitation of battery power their sailing time is limited therefore people are eager to develop a kind of marine unmanned autonomous vehicle which is totally dependent on marine energy in this paper the wave driven glider solely powered by waves and solar energy is investigated wave driven glider a kind of totally wave driven unmanned surface vehicle usv has been investigated for persistent marine monitoring since 2005 hine et al 2009 manley and willcox 2010 smith et al 2011 daniel et al 2011 frolov et al 2011 the structure of the wave driven glider is different from that of the conventional single body usv it is composed of a float at the ocean surface connected to an underwater glider via a flexible cable manley et al 2009 the underwater glider fluctuates up and down with the heaves of the float in the waves meanwhile the hydrofoils installed on the underwater glider rotate passively which will generate continuous forward thrust as shown in fig 1 since the wave driven glider is driven by wave energy completely supported with solar energy for data collection transmission and motion control the wave driven glider can be applied in a wide variety of applications including acoustic data collection communication gateway for subsurface systems meteorological observation and fisheries management fitzpatrick et al 2015 meyer gutbrod et al 2015 wang et al 2018b in order to make the wave driven glider give full play to its unique advantages and complete various tasks at sea it is of great significance to study its control system for usv operating for long periods at sea the quality of the control system directly determines its operation efficiency and safety the liquid robotics has achieved long term autonomous navigation of the wave driven gliders but there is no published documents on the control system there are also some other researches contributing to the development of wave driven glider control system olson 2012 described the data communication architecture of the wave driven glider zhang et al 2014 developed a navigation and positioning shore based monitoring application for the wave driven glider based on the gps beidou dual mode technology and google earth api besides the motion control of the wave driven glider has become a hot spot for its characteristics of underactuation weak maneuverability and low speed caused by its special dual structure and driving mode shi et al 2014 calculated the geodesic distance of current and presupposed position as well as the heading angle deviation based on gaussian geodesic algorithm liao et al 2016 developed an adaptive pid control algorithm combined with light of sight los guidance strategy which can compensate the steady state error of the wave driven glider due to the influence of current in the process of path tracking in 2018 considering the conventional course control methods for single body vehicle are not applicable to the wave driven glider wang et al 2018a proposed the heading information fusion strategy for calculating the desired heading of the wave driven glider simulation experiments and sea trials for the wave driven glider were conducted wang et al proposed a novel robust position keeping guidance strategy wang et al 2020b and an advanced path following approach wang et al 2019b for the wave driven glider based on restricted circle to avoid unnecessary energy consumption however the control system development for the wave driven glider in aspects of overall architecture guidance algorithm operational software and hardware is a very complex and systematic task all parts should be coordinated to meet the working environment and requirements this paper comprehensively introduces the development of the control system of the wave driven glider including the overall architecture framework hardware distribution and software design sailing control algorithms with regard to position keeping path following and heading control are presented and validated by numerical experiments moreover the sea trials was also conducted with the wave driven glider sjtu mouse this work provides an important reference for the complete development of the control system for the wave driven glider and other underactuated unmanned vehicles at sea the main contributions of this work can be summarized as follows 1 the hardware distribution and the robot operating system ros based software framework for the wave driven glider was developed 2 the position keeping and path following guidance strategies are presented and validated by numerical experiments 3 a wave glider remote control management platform was developed 4 sea trials were conducted in the south china sea and the feasibility and applicability of the proposed control system was demonstrated the remainder of the paper is organized as follows dynamic modeling for the wave driven glider in complex waves is presented in section 2 the overall architecture and hardware framework are discussed in section 3 the ros based software framework is presented in section 4 the sailing control strategies are presented in section 5 the development of graphical user interface gui is presented in section 6 field tests are discussed in section 7 and some conclusions are summarized in section 8 2 dynamic modeling to investigate the control performance with respect to the wave driven glider an 8 dof model is developed including a 4 dof model of the float and a 4 dof model of the submarine glider respectively the wave glider s corresponding coordinate systems are shown in fig 2 to facilitate the modeling three right handed coordinate systems are defined consisting of one inertial reference frame n and two body fixed frames b 1 and b 2 for the reference frame n with original point o n set at any place in the sea the x axis points towards true north the y axis points towards east while the z axis points vertically downwards for the body fixed frames b 1 and b 2 the origins o b 1 and o b 2 fixed to the float and the glider respectively are set at the gravity center and the x axis points towards the vehicle s surge direction while the y axis points towards the vehicle s starboard in this work the 4 dof motion of the surface float is divided into a 3 dof low frequency l f horizontal motion and a wave frequency w f heave motion the dynamic equations of the 3 dof l f motion of the surface float are within the horizontal plane and the w f motion in the heave direction the equations of the wave driven glider motions can be written as follows 1 η 1 j θ η 1 v 1 m r b 1 a 1 0 v 1 c r b 1 v 1 c a 1 v 1 r d 1 v 1 v 1 r τ 1 t e t h e r τ w d m 1 a ω h e a v e z 1 b ω h e a v e z 1 ρ g a w p 0 z 1 τ w f τ 1 t e t h e r where η x 1 y 1 z 1 ϕ 1 t denotes the vector of position and attitude of the wave driven glider in the reference frame o n x n y n z n v 1 u 1 v 1 w 1 r 1 and v 1 r is the velocity vector and relative velocity vector of the wave driven glider in the reference frame o b 1 x b 1 y b 1 z b 1 respectively j θ η 1 is the rotation matrix from o b 1 x b 1 y b 1 z b 1 to o n x n y n z n m r b 1 is the rigid body inertia matrix a 1 0 is the added mass matrix calculated at zero frequency and the constant frequency model in the heave should be formulated at its respective natural frequency the term d 1 v 1 includes both linear and quadratic damping c r b 1 v 1 c a 1 v 1 r is the coriolis and centripetal matrix b ω h e a v e is the radiation damping caused by the heave motion of the float τ w d is the second order wave drift forces and τ w f is the first order wave induced forces τ 1 t e t h e r is the tether forces exerted on the float in order to predict the responses of wave driven glider in open sea the jonswap spectrum is used to describe the non fully developed seas fig 3 shows the linear relationship between the wave induced forces and the wave heights the tether can be regarded as a spring with strong stiffness and the mass is ignored tether tension can be calculated with the following equation 2 t k δ l t 0 t 0 0 t 0 where t is the tether tension k 1 7 1 0 8 n m denotes the tether stiffness t 0 is the length change of the tether g 0 represents the wet weight of submarine glider t 0 g 0 k is the initial value of equilibrium state the tether forces at the surface float side are given as 3 τ 1 t e t h e r τ x τ y τ z τ n t s i n β c o s α 1 t s i n β s i n α 1 t c o s β 0 the tether forces at the submarine glider side are given as 4 τ 2 t e t h e r τ x τ y τ z τ n t s i n β c o s α 2 t s i n β s i n α 2 t c o s β 0 where α and β are the relative angles of tether with respect to inertial frame as shown in fig 4 the 4 dof kinematic and kinetic equations of the submarine glider are written in the following form 5 η 2 j θ η 2 v 2 m r b 2 a k 0 v 1 c r b 2 v 2 c a k v 2 r v 2 r d k v 2 r v 2 r g τ 2 t e t h e r τ p τ h f where η 2 x 2 y 2 z 2 ϕ 2 t denotes the vector of position and attitude of the glider in the reference frame n the v 2 u 2 v 2 w 2 r 2 represents velocity vector of the glider in the reference frame b 2 j θ η 2 is the rotation matrix from b 2 to n m r b 2 is the rigid body inertia matrix a k 0 is the added mass matrix of glider keel c r b 2 v 2 c a k v 2 r v 2 r is coriolis and centripetal matrix of glider keel τ 2 t e t h e r denotes the vector of tether forces τ h f is vector of hydrofoil induced forces τ p is vector of propeller induced forces the distance between the gravity center of the glider and the propeller center denotes as l c g f p is the thrust this gives 6 τ p τ p x τ p y τ p z τ p n 0 f p 0 f p l c g it should be noted that eq 6 is suitable for the side propeller control based wave driven glider the rudder based controller is described in wang et al 2019a fig 5 shows the diagram of hydrofoil force at the falling and rising phases respectively the hydrofoil forces as the glider falling and rising 7 τ h f τ h f x τ h f y τ h f z τ h f n f l s i n α f f d c o s α f 0 s i g n w 2 f l c o s α f s i g n w 2 f d s i n α f 0 where v f u 2 2 w 2 2 is hydrofoil real velocity α 0 is hydrofoil limit angle α f a r c t a n w 2 u 2 is the angle of hydrofoil related to horizontal direction α k α f α 0 ia the angle of attack f l is lift force of the hydrofoils f d is drag force of the hydrofoils 3 hardware distribution in this study the wave driven glider named sjtu mouse was designed and developed in shanghai jiao tong university sjtu including the first generation based on side propeller control and the second generation based on rudder control as shown in fig 6 table 1 provides an overview of the characteristics of sjtu mouse the overall architecture and hardware distribution of the control system for the sjtu mouse is designed as shown in fig 7 considering the automation level of the system the whole system is divided into four parts high level part and the energy system that power it low level part as well as the communication system the low level part refers to shipboard module which is responsible for marine environment information collection and transmission navigation guidance and course control this part allows for reliable mission execution and automatic navigation the high level part is responsible for situational awareness of the wave driven glider the centralized control and monitoring of marine environment information navigation task planning etc the low level part is further divided into perception layer decision making layer and execution layer the perception layer uses the sensors arranged on the wave driven glider to sense the marine environment and its own state mission dependent decision making and planing such as position keeping and path following is done in the decision making layer moreover the execution layer is involved in turning the course of the glider by the way of controlling the rudder angle or the rotation speed of the side propeller by grouping the whole system framework the relationship between each component can be clearly defined and the maintainability and expansibility of the system can also be improved moreover the hardware distribution is designed to be modular and expandable each module such as battery compass weather station beidou and propeller is separately sealed and connected to the central control unit the used hardware components for the second generation sjtu mouse are listed in table 2 4 software framework the distributed approach of splitting tasks among multiple parts and layers requires a suitable software framework to manage each component and enable communication between them the software framework must support distributed communication flexible data format scalability and simple user interface ros was chosen as the most suitable software framework in this study ros quigley et al 2009 is a free available software framework for robot development which aims to simplify the difficulty and complexity of creating robust robot behaviors across robot platforms li et al 2013 ros has been applied in many practical engineering cases mason and marthi 2012 borja et al 2013 schulman et al 2013 in this paper the software framework based on ros was developed on the first generation sjtu mouse which communicates with the client based on tcp ip protocols deployment of distributed nodes is presented and topic based communication between nodes is also presented as shown in fig 8 which allows fast data synchronization over wlan ros launch file provides a way to start node manager and multiple nodes at the same time as shown in fig 8 ros nodes are divided into four groups navigation guidance gui this system uses ros distributed multi computer communication pc runs gui node which is responsible for data monitoring and remote control raspberry pi installed on the wave driven glider runs other nodes in navigation group nodes of weather gnss pub and lmu pub are responsible for sensor data acquisition preprocessing and publishing location and velocity of the wave driven glider will be published by gnss pub node course of the wave driven glider will been published by lmu pub node the air pressure wind speed and direction as well as the temperature will be published by weather node as for nodes in guidance control and gui details are discussed in sections 5 and 6 5 sailing control strategies 5 1 heading control base on the desired course φ d from the position keeping strategy or the path following strategy and the real course φ from the compass the pid algorithm is used to calculate the side propeller thrust f p for the first generation sjtu mouse or rudder angle δ for the second generation sjtu mouse so as to adjust the heading the control procedure is shown in fig 9 pid controller is a linear controller that is widely used in the engineering field anderson et al 1988 åström and hägglund 2001 as shown in following equation 8 o u t p u t k p e k i e d t k d e where k p k i and k d are control parameters with regard to proportion integration and derivative respectively e is the error between current course φ and desired value φ d the heading control performances of the two kinds of controllers i e the side propeller based controller and the rudder based controller are compared in simulations in terms of course response course keeping and turning by wang et al 2020a experiments were conducted in the wave tank with the side propeller control based first generation sjtu mouse as shown in fig 10 the results demonstrated that the side propeller control based wave driven glider has better maneuverability than the conventional rudder control based wave driven glider however the side propeller based controller will consume more energy than the rudder based controller for a long sea voyage 5 2 position keeping when the wave driven glider performs some specific tasks on the sea for example communication gateway for subsurface systems or ocean on the spot monitoring it often needs to conduct virtual anchoring which makes the wave driven glider fixed in a certain range of water surface by continuously controlling the course traditionally the desired course is usually set as the direction from the current position to the target position the wave driven glider will always move forward in the waves so when the vehicle is close to the target position the desired course will frequently change greatly concerning the weak maneuverability of the wave driven glider in this case it will cause a lot of energy loss therefore the position keeping strategy based on restricted circle theory proposed by wang et al 2020b is adopted in this study as shown in fig 11 a restricted circle is proposed to limit the continuous turning of the wave driven glider near the target position when the wave driven glider enters the restricted circle area the desired course will no longer change which is determined by the moment just entering the restricted circle when the wave glider is outside the restricted circle area the desired course is defined as the direction from the real time position to the target point which can be expressed as eq 9 9 φ d arctan y d y t x d x t x d x t π arctan y d y t x d x t y d y t x d x t π arctan y d y t x d x t y d y t x d x t π 2 y d y t x d x t π 2 y d y t x d x t based on the mathematical model of the side propeller control based first generation sjtu mouse introduced in section 2 and the position keeping guidance algorithm a time domain simulation program was developed the position keeping performance was investigated under the conditions of different restricted circle radius r and significant wave heights h s as shown in table 3 the peak period of the simulated waves is 6 28 s e is introduced here to quantitatively evaluate the energy consumption of wave driven glider during the position keeping it is defined as the average thrust per time step produced by the propeller 10 e t 1 n t t n where t t is the thrust of the propeller at time step of t n is the number of total time steps it can be seen from fig 12 that when the wave driven glider is sailing in the restricted circle the trajectory is regular and the navigation state is stable fig 13 shows the time series of thrust under different conditions it can be seen from table 3 that consistent with previous studies wang et al 2020b 2019b with the increase of radius r and the decrease of wave height the energy consumption coefficient e of the wave driven glider gradually decreases which means less power consumption in the process of position keeping moreover it can be concluded that under the same sea state the smaller restricted circle ensures a better positioning accuracy whereas leads to a large energy consumption 5 3 path following wave driven glider usually need to navigate through a series of preset way points when it performs a long distance mission at sea such as maritime patrol or marine monitoring the conventional los guidance strategy for path following has been widely studied fossen 2002 2011 however in this case concerning that the position error existence in application to avoid unnecessary energy loss caused by continuous course control near the preset path this study adopts the advanced los guidance strategy based on restricted circle theory proposed by wang et al 2019b as shown in fig 14 if the wave driven glider is out of the restricted circle the desired course φ d is alongside the vector p t p l o s on the other hand if the wave driven glider is in the restricted circle that is the blue area in fig 14 the desired course will not change and it is equal to the direction of the vector p k 1 p k the path following algorithm for the wave driven glider is shown as algorithm 1 to verify the feasibility of the path following algorithm to the side propeller control based first generation sjtu mouse a time domain simulation was conducted the simulated conditions and results of the path following performance are listed in table 4 c represents the average value of the cross tracking error during the voyage and is calculated using eq 11 11 c t 1 n x t x t 0 2 y t y t 0 2 n where x t y t is the real time position of wave driven glider x t 0 y t 0 is the foot point of the vertical line from the real time position of wave driven glider to the current track segment n is the number of total time steps fig 15 presents the sailing paths of the wave driven glider during the path following missions under conditions 1 4 it can be seen that the restricted circle radius r has a great influence on the path following performances of the wave driven glider as r increases the tracking error increases accordingly however the energy consumption shows the opposite trend there could be a phenomenon in application that the wave driven glider is located in the restricted circle but the measured position is outside the restricted circle due to the measurement error resulting in an incorrect control and unnecessary energy consumption therefore a larger radius r can reduce unnecessary energy loss but it will reduce the accuracy of path following in addition fig 15 shows that the effect of wave height on path following is relatively small 6 gui the wave glider remote control management platform wgrcmp was developed in this study as shown in fig 16 it enables command and control of several wave driven gliders based on a single console increasing working efficiency it facilitates mission planning data monitoring and remote control besides it also provides role based access defined roles and access control allow both collaboration and security helping to protect mission and data integrity key functions and benefits include 1 vehicle status and sensor data monitoring profile information communication mode selection working mode display and energy management mode selection marine environmental data display temperature air pressure wind speed wind direction etc vehicle status display battery state speed heading propeller power etc monitoring report generation navigation track environmental conditions operation status etc in any period of time 2 real time management control sailing control mode adapt to different mission and enables swapping between navigation modes with ease energy management mode settings include automaticmode based on energy storage level and manual mode guided by operation task pid parameters adjustment interface 3 log area real time display of received data feedback whether control command is issued successfully 4 map display vector coastline map allowing users to access coastline data support scaling range finding obstacle marking history trail display etc 7 field tests in november 2020 sea trial was conducted in the south china sea with the rudder control based second generation sjtu mouse which is based on the beidou radio dual communication modes as shown in fig 17 a path following task was completed in sea trial the significant wave height during the sea trial is about 0 3 m and the current is about eastward fig 18 shows the path following trajectory as well as the path following error and speed of the sjtu mouse in sea trial which is composed of five track segments the whole sailing distance is about 4 5 km and the sailing time is about 1 4 h fig 19 shows the pitch and roll of the submarine glider of the sjtu mouse it can be seen from fig 18 that under the disturbances of waves and currents in the sea trial the sjtu mouse moved at an average speed of 0 87 m s during the path following test the real path matches well with the desired one and the path tracking error is within 100 m during most of the time however between the fourth and fifth track segments due to the influence of current the tracking error reaches 150 m moreover fig 19 shows that pitch and roll of the submarine glider of the sjtu mouse are within 5 degrees and the mean values of pitch and roll are 1 0 and 0 2 degrees respectively the results show that the motion of the submarine glider is stable during sailing besides the meteorological data including temperature and wind were also recorded as shown in fig 20 8 concluding remarks this paper focuses on the control system development for the wave driven glider the hardware distribution and the robot operating system based software framework are developed sailing control algorithms with regard to position keeping path following and heading control are presented and validated by numerical experiments the wave glider remote control management platform was developed moreover the sea trials was also conducted with the second generation sjtu mouse results show that with the proposed control system the wave driven glider can adapt to different mission and ensure successful vehicle operations demonstrating the feasibility and applicability of the control system this research provides an important reference for the control system development for the wave driven glider and other ocean surface underactuated unmanned vehicles however there are still some deficiencies which need to be further improved in the future 1 the marine environment has a significant impact on the speed and control accuracy of wave driven glider so it is necessary to develop propeller assisted propulsion system to improve the speed of wave driven glider when sailing against the current and the waves are small however due to that the wave driven glider is a fully energy self sufficient system the propeller assisted propulsion must put forward new requirements for the power generation capability and energy management level of the wave driven glider 2 considering that the motion of the wave driven glider is significantly affected by the current it is necessary to develop an intelligent path planning algorithm for the wave driven glider in complex marine environment so as to use the current reasonably to improve the navigation efficiency credit authorship contribution statement peng wang conceptualization methodology formal analysis sea trial writing original draft xinliang tian conceptualization review and editing funding acquisition xin liang editing sea trial xiaoxian guo methodology formal analysis xin li software review and editing xiantao zhang conceptualization review and editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors would like to thank the supports from oceanic interdisciplinary program of shanghai jiao tong university china project number sl2020zd201 scientific research fund of second institute of oceanography mnr china grant no sl2001 the research program of sanya yazhou bay science and techonlogy city sktc 2020 01 006 natural science foundation of shanghai grant no 19zr1426300 national natural science foundation of china grant nos u20a20328 11632011 51779141 shanghai pujiang program china grant no 19pj1405400 shanghai innovation action plan of science and technology china grand no 19dz1207300 
20784,the image based visual servoing ibvs problem of a redundant underwater vehicle manipulator system uvms with an eye in hand camera is investigated in this paper with consideration of system constraints dynamic uncertainties and the absence of vehicle velocity sensors for a typical uvms we propose a hierarchical control architecture which is composed of an unscented kalman filtering ukf based vehicle motion estimator a kinematic model predictive ibvs controller and two decoupled dynamic velocity controllers for the vehicle and the manipulator respectively in details the underwater vehicle velocities are estimated by ukf with visual measurements based on the uvms kinematic model with these estimates a nonlinear model predictive controller mpc is designed to solve the ibvs problem of uvmss and generate velocity commands for the underwater vehicle and the manipulator simultaneously the visual kinematic model of uvmss is used to predict the future trajectories and the field of view manipulator joint angle and uvms velocity constraints are handled when solving the optimization problem to reduce the system complexity of uvmss the high dimensional uvms s dynamic model is decoupled into two low dimensional models of the vehicle and the manipulator and a dynamic inversion based active disturbance rejection control di adrc method is developed for dynamic controller design the physical interaction effects between the vehicle and manipulator are considered as external disturbances acting on each other which are estimated by extended state observers eso in adrc the simulation experiments with a typical uvms are performed to demonstrate the effectiveness of the proposed hierarchical ibvs controller in dealing with system redundancy constraints and uncertainties keywords underwater vehicle manipulator system image based visual servoing hierarchical control architecture model predictive control active disturbance rejection control unscented kalman filtering 1 introduction with the rapid development of ocean technology unmanned underwater vehicles uuvs have become a common tool and are widely used in resources investigation seabed mapping object delivery and other underwater missions in order to improve the interventional ability of underwater vehicles to execute dexterous tasks such as grasping from the seabed and rotating valves ridao et al 2014 the underwater vehicle manipulator system uvms also named intervention autonomous underwater vehicle i auv composed of a free floating underwater vehicle and one or more multi joint manipulators has been developed as an effective autonomous manipulation platform uvmss have the advantages of both the dexterity of free floating multi function manipulators and the long range operation of underwater vehicles youakim et al 2017 in recent decades the motion planning and trajectory tracking control of uvmss have attracted a lot of attention around the world several uvms projects have been proposed continuously achieving different levels of autonomy in the pool or harbor tests for typical interventional tasks for examples marani et al 2009 described the semi autonomous underwater vehicle for intervention missions sauvim which was the first underwater vehicle capable of autonomous manipulation khatib et al 2016 at stanford university developed a dual arm humanoid underwater remotely operated vehicle rov named the ocean one which had comprehensive environment perception and object manipulation abilities the european pandora lane et al 2012 project developed new computational methods to enable underwater vehicles remain autonomous and significantly reduce the frequency of human assistance houston mechatronics inc built an underwater transformer named aquanaut which can shift from a submarine that perform long range efficient cruise and full attitude hover control to a humanoid robot to execute stable and short range dual arm operation manley et al 2018 wang et al 2019 developed a biomimetic underwater robot named robcutt ii and proposed autonomous vision based hovering control compared with an individual underwater vehicle or manipulator the uvms is a redundant robotic system with coupled degrees of freedom dofs which brings more challenges to its motion planning and trajectory tracking control the motion planning algorithms including search based algorithms genetic algorithms task priority algorithms etc have been proposed for uvmss with consideration of obstacle avoidance inherent kinematic redundancy hydrodynamic damping energy saving and system constraints pi et al 2019 designed a search based motion planning algorithm for coordinated manipulation of a dual arm uvms banfield and rodriguez 2019 proposed a multi objective genetic algorithm based path planning method for a uvms considering kinematic redundancy sarkar and podder 2001 proposed a motion coordination algorithm which generated the desired trajectories for both the vehicle and the manipulator to minimize the total hydrodynamic drag podder and sarkar 2004 developed a unified motion planning algorithm to provide reference trajectories by exploiting the inherent kinematic redundancy huang et al 2016 designed an optimization based motion planning algorithm in order to achieve the coordinative movement of the uvms and minimize the pitch and roll angles consequently jin et al 2016 designed an improved motion planning method of uvmss subject to joint limits zhao et al 2013 proposed an integrated multi task motion planning method based on the traditional task priority algorithm with consideration of joint limits and minimizing roll and pitch movement tang et al 2017 et al proposed a redundancy resolution planning method on the acceleration level to overcome the acceleration sudden changes in the traditional task priority method zhao et al 2018 proposed a receding horizon motion planning algorithm for uvmss by optimizing system performances under joint constraints trajectory tracking of uvmss is also studied based on the dynamic model which is typically high dimensional with strongly coupled nonlinearities as while as significant uncertainties of modeling and parameters londhe et al 2017 designed a robust single input fuzzy logic control scheme for task space trajectory tracking control under external disturbances for uvmss dai and yu 2018 proposed an indirect adaptive control scheme and the rapid convergence of tracking errors is guaranteed barbalata et al 2018b developed a low level position force control structure for underwater manipulators which combined the parallel control structure with sliding mode control and model information bae et al 2018 evaluated the performances of various alternatives to design and optimize the controller of a uvms amundsen et al 2018 utilized the inverse kinematics with the generalized jacobian matrix to reduce the energy to stabilize the vehicle and drive the underwater manipulators nikou et al 2018 proposed a robust model predicted control nmpc methodology to handle the state and input constraints of force torque controllers which was applied to the environment by the end effector of uvmss in summary the aforementioned motion planning and trajectory tracking methods of uvmss mostly concern with the global pose of the uvms especially that of the end effector however in practice it is almost impossible to obtain precise earth fixed pose information with onboard sensors visual servoing is a sensor based control strategy which is developed initially for robotic manipulators and is farther applied to mobile robots unmanned aerial vehicles uavs and uuvs gao et al 2015 2017 in recent years visual servo control is used to address the grasping control for the mobile manipulator platforms belmonte et al 2019 tsai et al 2020 and aerial manipulators ramon soria et al 2020 santamaria navarro and andrade cetto 2019 santamaria navarro et al 2017 meanwhile a few works have been done from visual servo control of underwater manipulator sivčev et al 2018b implemented the visual servo control of underwater manipulators of industrial work class rovs zhang et al 2019 proposed a grasping control method of underwater manipulators based on monocular visual servoing for the ibvs of uvmss zhang et al 2018 proposed a visual servo control scheme with base motion compensation using an unscented kalman filtering ukf and designed an eye in hand visual servo controller with a disturbance compensator li et al 2019 proposed an uncalibrated visual servoing scheme for a uvms with an eye in hand camera under uncertainties including visual system parameters uvms kinematics and feature position liang et al 2019 designed an ibvs system for uvmss without consideration of system dynamics in these works the velocity joint angle and visibility constraints and the dynamics of uvmss have not been well addressed to solve the visual servoing problem of uvmss under system constraints and dynamic uncertainties and coupling effects between the two parts of a uvms we extend the previous work on mpc ibvs of underwater vehicles gao et al 2016 and model predictive motion planning zhao et al 2018 and propose a complete ibvs control architecture the main contributions of this paper are two folds 1 a hierarchical mpc scheme integrated with adrc dynamic controllers is systematically developed to solve the ibvs problem of a fully actuated uvms the field of view fov and velocity constraints are explicitly handled by the mpc approach which generates velocity commands by optimizing the future trajectories predicted by system models 2 two decoupled dynamic controllers are proposed for the vehicle and the manipulator separately to reduce the system complexity with consideration of the absence of a doppler velocity log dvl in many practical applications we employ ukf to estimate the vehicle velocity with visual measurements a dynamic inversion di based adrc method is proposed in which the pseudo control is constructed with the estimation and compensation of uncertainties and disturbances and the final control inputs are obtained by the dynamic inversion of decoupled nominal dynamic models the dynamic control performance is validated by comprehensive simulation studies in which two cases of that with the adrc based control loop and that without are tested and compared the rest of this paper is organized as follows section 2 describes the mathematical formulation of the uvms control problem including the equations of motion of a uvms and its ibvs system the hierarchical ibvs control algorithm of uvmss is presented in section 3 in this section hierarchical control structure of system vision based and velocity estimation of underwater vehicles model predictive visual servo control and adrc based dynamic decoupled control for the underwater vehicle and manipulator are presented in section 3 1 section 3 2 section 3 3 and section 3 4 respectively the simulation results are presented in section 4 to demonstrate the performances of the proposed method finally some concluding remarks are given in section 5 2 problem formulation 2 1 modeling of uvmss the models of uvms and visual systems are briefly introduced in this section and the control objective of ibvs is described a detailed introduction to the kinematic and dynamic models of uvmss is given in fossen 2002 and antonelli 2018 define the system velocity vector as ζ v 1 t v 2 t q t t r 6 n and the kinematic model of a uvms is 1 η 1 η 2 q r b e o 3 o 3 n o 3 j k o 1 η o 3 n o n 3 o n 3 i n ζ where η η 1 t η 2 t t r 6 and v v 1 t v 2 t t r 6 represent the pose vector and velocity vector of the base uuv η 1 x y z t r 3 represents the position vector of the uuv s center of mass o b in the earth fixed frame η 2 φ θ ψ t r 3 is the euler angle vector of the body fixed frame respect to the earth fixed frame v 1 u v w t r 3 and v 2 p q r t r 3 are the linear and angular velocities in the body fixed frame q r n is the vector of manipulator s joint angles and q ω 1 ω 2 ω n t is the corresponding angular velocity vector n is the number of joints o 3 represents a 3 dimensional zero matrix i n is the n dimensional unit matrix r b e r 3 3 is the orthonormal matrix which represents the coordinate transformation from the body fixed frame to the earth fixed frame and r e b r b e 1 r b e t j k o η r 3 3 represents the transformation matrix between the euler angles rates and the vehicle angular velocities define η ee r 6 as the posture vector including the position and the euler angles of the end effector it is expressed by η ee k η q assuming that the camera coincides with the end effector for simplification we have 2 v c r e c o 3 3 o n 3 j k o η ee η ee j w η 2 q ζ where v c u c v c w c p c q c r c t r 6 is the camera velocity expressed in the end effector frame r e c is the rotation matrix from the earth fixed frame to the end effector frame j w η 2 q is the jacobian matrix of the end effector with respect to the uvms velocity vector the dynamic model of uvms is expressed as antonelli 2018 3 m q ζ c q ζ ζ d q ζ ζ g q r b e τ where m q r 6 n 6 n is the inertia matrix including added mass terms c q ζ is the vector of coriolis and centripetal terms d q ζ is the vector of dissipative effects g q r b e is the vector of gravity and buoyancy effects bayo et al 1989 the relationship between the generalized forces τ and the control input is given by 4 τ τ v τ q b v o 6 n o n 6 i n u bu where u r 6 n is the vector of the control input forces and torques generated by the thrusters and motors b v r 6 6 is a constant matrix known as the thruster control matrix a uvms is a high dimensional nonlinear system with a lot of unknown parameters and unmodeled effects which make it a challenging task to design a robust adaptive controller with satisfactory performances to reduce the complexity of the system we use a decoupled approach by departing it into two lower dimensional systems of the underwater vehicle and the manipulator barbalata et al 2018a the dynamic model of underwater vehicles is presented as 5 m v v c v v v d r b v v g r b r b e τ v τ d m where m v is a positive definite inertial matrix of the rigid body and the added mass c v is composed of the corresponding coriolis and centripetal matrices d r b v 0 is the hydrodynamic damping matrix g r b represents the vector produced by the gravity and buoyancy τ v is the control output of the vehicle controller τ d m is the external disturbances including the coupling effect from the manipulator the model of manipulators is given as 6 m m q q c m q q q d m q q q g m q τ m τ d v where m m q is the inertia matrix of the underwater manipulator c m q q is the coriolis force and centripetal force matrix of the manipulator system d m q q is the damping force matrix of the manipulator under water g m q is the gravity and buoyancy matrix of the manipulator system τ m is the control output of the underwater manipulator controller τ d v is the external disturbances including that from the underwater vehicle the approximate dynamic models of the underwater vehicle and the manipulator in eqs 5 and 6 without external disturbances can be rewritten in the following compact forms 7 v f v η v τ v q f m q q τ m 2 2 modeling of eye in hand visual systems in this paper the ibvs approach of a uvms with an eye in hand camera is investigated where the image coordinates are defined as the control variables gao et al 2019 the visual system of the uvms is shown in fig 1 in fig 1 e denotes the earth fixed frame b denotes the body fixed frame and c is the camera frame that coincides with the end effector of the manipulator i is the planar image frame o 1 o 2 o 3 and o 4 are the four feature points according to the imaging principle of a pinhole camera the image coordinates of feature point o i in the current position and the expected position are given as 8 s i m i n i f z i x i y i s i m i n i f z i x i y i where p i x i y i z i t r 3 and p i x i y i z i t r 3 are the coordinates of the i th feature point o i in the camera frame c m i n i and m i n i are the corresponding the 2 d image coordinates and f is the focal length of the camera the derivative of s is given as 9 s i f z i 0 m i z i m i n i f f 2 m i 2 f n i 0 f z i n i z i f 2 n i 2 f m i n i f m i v c l i s i z i v c where l i s i z i is the image jacobian matrix between the camera velocity and the image velocity yahya and arshad 2017 the current and the desired image coordinates of the n feature points are given respectively as 10 s s 1 s 2 s n t r 2 n s s 1 s 2 s n t r 2 n the visual system model could be formatted as 11 s l s z v c where z z 1 z n t r n is the image depth vector 12 l s z l 1 s 1 z 1 l n s n z n the visual servo control system is designed to make the visual tracking error e s s converge to zeros the derivative of visual tracking error e is obtained as 13 e l s z v c l s z j w η 2 q ζ the classical ibvs feedback control is designed to expect an exponential decrease of image errors 14 ζ d λ j w η 2 q l s z e where j w η 2 q and l s z are the pseudo inverses of the jacobian matrices of j w η 2 q and l s z respectively λ is a positive gain 3 hierarchical visual servo control system architecture in this section a hierarchical control scheme is proposed to solve the ibvs problem of uvmss section 3 1 describes the hierarchical visual servo control structure the vision based velocity estimation of underwater vehicles is discussed in section 3 2 section 3 3 describes the model predictive visual servo control section 3 4 gives the adrc based decoupled dynamic control for the underwater vehicle and manipulator respectively 3 1 hierarchical visual servo control structure the hierarchical ibvs control framework of uvmss is shown in fig 2 in the feedback control loop the vehicle velocity v is estimated by ukf based on visual measurements from an eye in hand camera zhang et al 2018 the mpc ibvs controller generates the desired velocity commands v d q d by solving the constrained optimization of predicted trajectories on line and sends them to the decoupled dynamic adrc controllers in the adrc vehicle controller v ˆ is used to track the desired velocity command v d and the real time thrust signal τ v is obtained meanwhile in the manipulator controller the motor signals τ m is designed to track the desired velocity command q d of the manipulator the proposed mpc ibvs controller and decoupled adrc control design are presented in the following sections 3 2 vision based velocity estimation of underwater vehicles the visual features attached on the target are captured by a camera mounted on the manipulator the feature coordinates in the image plane is used to estimate the pose and velocity of the underwater vehicle the system state vector is defined as 15 x η v q the discrete time system model with constant velocities of the vehicle and manipulator is given as 16 η k 1 η k r b e k 0 3 3 0 3 3 j k 0 k v 1 k v 2 k t v 1 k 1 v 2 k 1 v 1 k v 2 k q k 1 q k q k t q k 1 q k where t is the sampling period the state update function of the system can be described as 17 x k 1 f x k n w k where n w k is the process noise the system measurements include the feature coordinates s angular velocity of the vehicle and the angles of joints 18 z k h x k n v k where 19 h x k s k v 2 k q k and s is a nonlinear function of system state variables of η and q defined by eq 8 n v k is the measurement noise it is reasonable to assume that the process and measurement noises n w and n v obey the zero mean gaussian distribution with covariance matrix σ w and σ v respectively such that n w k n 0 σ w and n v k n 0 σ v based on the system and measurement models in eqs 17 and 18 the ukf can be used to obtain the velocity estimate v ˆ the detailed processing steps of ukf design could be found in wan and van der merwe 2000 and kandepu et al 2008 and are omitted here 3 3 model predictive visual servo control the model predictive ibvs control can be formulated as given the visual servo model of uvmss in 13 find the optimized velocity inputs by solving the following constrained finite time optimization problem dai et al 2019 20 min u ζ k j k s k ζ k with 21 j k s k ζ k j 1 n p s j k s t q s s j k s j 0 n c 1 ζ t j k r v ζ j k subject to 22 s j k 1 s j k t c l s j k z k j w η 2 j k q j k ζ j k f ζ s s j k ζ j k q j 1 k q j k t c q j k η 2 j 1 k η 2 j k t c j k o 1 v 2 j k s j k s q j k q ζ j k u where u ζ k ζ 1 k ζ 2 k ζ n c k is the candidates of velocity inputs j k s k ζ k is the cost function of predicted image errors and velocity commands in the cost function q s and r v represent the weighting matrices of visual errors and velocities respectively n p is the prediction horizon and n c n p is the control horizon k is the prediction starting time s j k q j k η 2 j k are predicted image coordinates of the feature points manipulator joint angles and euler angles at time j respectively s q and u are the constraint sets of features coordinates joint angles and system velocities respectively t c is the control period for a freely moving uvms without obstacles in the working space the following three constraints must be satisfied 1 the field of view constraint the image features must be kept in the image plane during the movement as 23 m min m j k m max n min n j k n max where m max n max are the maximum coordinates and m min n min are the minimum coordinates of the image plane respectively 2 the velocity input constraint the desired velocities should be available under limited thrust forces 24 u j k u max v j k v max w j k w max p j k p max q j k q max r j k r max where u max v max w max p max q max and r max denote the upper bounds of the corresponding velocities 3 manipulator joint angles and their velocities limits each joint position and velocity of the manipulator cannot exceed the mechanical limits 25 q i min q i j k q i max q i min q i j k q i max i 1 6 where q i min q i max q i min q i max are the upper and lower limits of the i th joint angle and its rate the optimization solution of 21 is u ζ k and the first element ζ 1 k is used as the velocity command and the problem will be solved repeatedly at the next period 3 4 adrc based dynamic decoupled control the dynamic properties of the vehicle and the manipulator are quite different e g inertial masses and damping effects and they are driven by different types of actuators base on this point we employ a decoupled approach for the dynamic control of uvmss to track the velocity commands provided by the ibvs controller the whole uvms is separated as two independent systems with lower dimension to be controlled and the interaction effects between the base vehicle and the attached manipulator are considered as disturbances sivčev et al 2018a in this paper we develop a dynamic inversion based adrc controller with the strong adaptability and robustness to system uncertainties and disturbances and it is easy to design and implement the approximate model based dynamic inversion is to cancel the nonlinearities of the dynamic models which generates actual control inputs by the system inversion with pseudo control composed of pd signals and estimated disturbances the adrc controller wang et al 2016 wang et al 2017 barbalata et al 2018a is composed of a tracking differentiator td a nonlinear states error feedback controller nlsef and a extended state observer eso and a di module as shown in fig 3 we have ζ d v d τ τ v and y a v in the underwater vehicle controller and ζ d q d τ τ m and y a q in the manipulator controller the td module is used to generate the filtered command signal ζ r from the command ζ d the discrete form of the td is written as cai et al 2019 26 fh fhan ζ r k ζ d k ζ r k r h 0 ζ r k 1 ζ r k h ζ r k ζ r k 1 ζ r k h fh where ζ r is the derivative of ζ r h is the sampling time r is the fast coefficient and h 0 is the filter coefficient the standard form of function fhan x 1 x 2 r h is 27 d r h d 0 h d y x 1 h x 2 a 0 d 2 8 r y a x 2 a 0 d 2 sign y y d 0 x 2 y h y d 0 fhan r sign a a d r a d a d the design of eso is to estimate the nonlinear terms and external disturbances such as added mass drag forces and external disturbances the eso is designed as cai et al 2019 28 e k z 1 k y a k fe k fal e k 0 5 δ z 1 k 1 z 1 k δ z 2 k ξ 01 e k u k z 2 k 1 z 2 k δ ξ 02 fe k fal e α δ e α sign e e δ e δ α 1 e δ where z 1 k is the filtered velocity of underwater vehicles or manipulators and z 2 k is the estimated disturbances u k is the control signal ξ 01 ξ 02 are the gain coefficients of the observer the nlsef controller is written as cai et al 2019 29 e 1 k ζ r k z 1 k u 0 k β 1 k fal e 1 k α δ ζ r k where e 1 k is the tracking error β 1 k is the gain parameter fal is the continuous power function whose value is near the origin α is a parameter reflecting the nonlinear characteristics the general value of α is 0 5 or 0 25 δ is a positive number to avoid the chattering of the control quantity parameter and is chosen from 2 h to 5 h u 0 k is the output signal of the controller and the pseudo control is u k u 0 k z 2 k the actual control inputs are solved by the following dynamic inversion which make the adrc independent of the system dynamic and alleviate the difficulty to adjust control gains in the adrc 30 τ v f v 1 η v u m v v c v v v d r b v v g r b r b e τ m f m 1 q q u m m q q c m q q q d m q q q g m q where f v 1 and f m 1 are the inverse functions of the dynamic model 7 with respect to the acceleration signals v u and q u respectively 4 simulation results in this part we will test the performances of the proposed hierarchical ibvs controller of uvmss the simulation model of a typical uvms system composed of the nps phoenix underwater vehicle and the smart 3s manipulator is constructed using the toolkit simurv 4 0 by antonelli 2018 and this uvms is also used in dai and yu 2018 and antonelli et al 2000 in the toolkit the hydrodynamic coefficients of the vehicle model including added mass and damping effects are derived by exploiting the geometry of the rigid body the hydrodynamic coefficients of the manipulator are calculated under the assumption of cylinder links with different lengths and radii the parameters of the vehicle phoenix are given in table 1 the actual uvms parameters are given below m v diag 6019 9551 2332 4129 4913 2069 m m diag 260 250 90 20 9 3 5 d r b v diag 50 u 100 v 100 w 10 5 p 80 20 q 80 20 r d m q q diag 0 4 0 4 0 4 0 4 0 4 0 4 the weights of manipulator joints are 80 kg 80 kg 30 kg 50 kg 20 kg 25 kg the robotic manipulator consists of six joints and the denavit hartenberg dh parameters of the robot arm are shown in table 2 it is a difficult task to establish an accurate mathematical model for uvms in order to test the adaptability of the adrc dynamic controller the following damping and inertial matrices in the approximate models differ from the real values m v ˆ diag 6000 9500 2300 4100 4900 2100 m ˆ m diag 250 240 85 22 10 3 7 d ˆ r b v diag 52 u 95 v 95 w 11 5 p 85 20 q 85 20 r d ˆ m q q diag 0 42 0 42 0 42 0 42 0 42 0 42 the underwater vehicle initial states in the uvms simulation model are η 0 0 0 0 5 0 0 0 t the initial joint angles of the manipulator are set as q 0 0 0 0 0 π 2 0 t the limits of the uvms velocity are ζ ub 0 5 0 3 0 3 0 175 0 175 0 524 0 524 0 524 0 524 1 047 1 047 1 571 t with ζ lb ζ ub the maximum and minimum joint of the manipulator are q ub 2 094 2 094 2 094 3 142 3 142 3 142 t r a d with q 1 b q u b the prediction horizon is n p 20 while the control horizon is n c 10 t c 0 01 sec the values of the weighting matrices q s and r v are q s 5 i 8 r v diag 0 1 i 3 5 i 3 i 3 0 01 i 3 the end effector of uvms is equipped with a camera with a focal length of f 0 01 m the coordinates of the visual features in the earth fixed frame are given as o 1 5 0 5 2 5 o 2 5 0 5 2 5 o 3 5 0 5 3 5 o 4 5 0 5 3 5 the desired pose of the end effector is defined as η ee 3 0 3 0 1 57 1 57 and the corresponding desired feature coordinates are given as s 1 0 0025 0 0025 s 2 0 0025 0 0025 s 3 0 0025 0 0025 s 4 0 0025 0 0025 the field of view constraint as n max m max 0 004 m m min n min 0 004 m the control parameters in adrc are chosen as α 1 0 75 α 2 1 25 ξ 01 100 ξ 02 300 r 10 h 0 01 t 0 1 β 1 100 in order to verify the effectiveness of the mpc based kinematic ibvs control and adrc based decoupled dynamic control the following two cases are investigated by comparative simulations 1 case 1 the kinematic mpc ibvs control of the uvms without the dynamic control loop 2 case 2 the whole hierarchical control of the uvms composed of mpc ibvs control and adrc decoupled control with time varying external disturbances the simulation results of case 1 are plotted in figs 5 9 in fig 5 the position and euler angles of the underwater vehicle are presented the linear and angular velocities of the underwater vehicle generated by the mpc ibvs controller are shown in fig 6 figs 7 and 8 depict the joint angles and angular velocities of the manipulator during the simulation the image trajectories of the feature points are presented in fig 4 fig 9 shows the curves of the global coordinates of the end effector which finally reaches the desired position under the system constraints it can be observed that the image features move to their target positions without violating the system constraints and the end effector is finally driven to the desired pose in about 5 s the pose of the underwater vehicle and the joint angles of the manipulator are stabilized in a short time it should be noticed that the uvms is a redundant robotic system which means that there are infinite solutions of the final system states corresponding to the desired end effector pose the generated velocities of the uvms are constrained to the given ranges in case 2 the adrc based dynamic control loops of the underwater vehicle and the manipulator are included in the uvms ibvs system to test the system performances with the dynamic systems in practice uvms suffers from external disturbances caused by the water currents and waves so here we validate the stability of decoupled controller under time varying disturbances in this simulation the external disturbance of underwater vehicle is τ dv 30 s i n π 5 t 30 30 s i n π 5 t 30 1 1 1 1 t the external disturbance of manipulator is τ dm s i n π 5 t 1 1 1 1 1 1 t the simulation results are as follows the simulation results of case 2 are shown in figs 11 13 the position coordinates and euler angles are shown in fig 11 it can be seen that all the states converge to the final value after a longer time compared with case 1 without the dynamic loop the actual linear and angular velocities of the vehicle are shown in fig 12 in which the velocities are well estimated by ukf and actual velocities of the underwater vehicle track the desired velocities commands by adrc the linear velocity of uuv has reached the limit value set by mpc and lasted for a period of time the x axis forward motion of uuv tends to be stable at 15 s however the motion of z axis and y axis tends to be stable in 20 s the attitude adjustment of uuv tends to be stable at 15 s and the corresponding angular velocity converges to zero obviously it can be observed that the proposed hierarchical decoupled control scheme has a good performance fig 15 shows the changes of the end effector s position during the simulation affected by the overall control movement of the system the position of the end effector is stable after 20 s the 2 d trajectories of the four visual features in the image plane are plotted in fig 10 the trajectory of the feature points moves to the middle image panel and rotates to the desired image point in figs 13 and 14 the joint angles and angular velocities of the joints are displayed it can be observed that the actual velocities of the manipulator track the commands generated by the ibvs controller under disturbances which proves the effectiveness of this in the dynamic control method q 5 gradually stabilized after 20 s while other joint angles tended to be stable at 15 s therefore the final control adjustment of manipulator stability is completed by q 5 the control efforts converge to generate necessary forces and torques in figs 16 and 17 the actual disturbances and estimated disturbances of the joints and uuv are displayed respectively it can be observed that eso has good disturbances estimation performance showing the effectiveness of the decoupling method case 1 ignores the dynamics of the system and inputs the velocity of the system when the system is updated in case 2 mpc adrc method is used to input system acceleration to complete system update case 1 ignores the dynamic properties of the system the vehicle velocities are regarded as the inputs to the system when the system is updated case 1 can be used for motion analysis in case 2 mpc adrc method is used to input system acceleration to complete system update case 2 is mainly used for system controller design finally we use the classical ibvs control in 14 instead of mpc in the kinematic ibvs control for comparison where the inverse solution of jacobian matrix is used to calculate the control efforts the simulated 2 d trajectories of the four visual features are plotted in fig 18 the 6 d pose of the underwater vehicle is shown in fig 19 and the joint angles of the manipulator are plotted in fig 20 compared with the mpc adrc strategy shown in figs 10 11 and 13 the visual servoing system controlled by the inverse solution of jacobian matrix combined with adrc control strategy has larger overshoot and takes longer time to be stabilized the image trajectories move farther in the image plane and the visual target is even out of fov temporarily according to the simulation results and discussions above this proposed adrc decoupled control is satisfactory with the ability to resist external disturbances and the mpc ibvs control objective is achieved under system constraints 5 conclusion in this paper the visual servo control of uvmss is investigated using a hierarchical scheme consisted of kinematic and dynamic controllers with consideration of system constraints unavailable velocities and uncertain system model in the kinematic controller the velocity commands of the vehicle and manipulator are solved by employing a nonlinear mpc approach which optimizes the future trajectories under system constraints within a limited predictive horizon in the dynamic controller firstly the vehicle s velocities are estimated with a ukf algorithm based on the uvms s nonlinear kinematic model with the visual measurements then two adrc based dynamic controllers are designed for the underwater vehicle and the manipulator separately to reduce the system dimension with consideration of totally different dynamic properties of the two parts the system uncertainties including the coupling effects are estimated and compensated the comparative simulation results demonstrate the effectiveness of the proposed hierarchical scheme in the future works we will develop effective learning based system identification strategies to get more precise estimation of disturbances and thus improve the dynamic control performance of uvmss also a prototype uvms could be developed for experimental studies in a real underwater environment credit authorship contribution statement jian gao conceptualization methodology funding acquisition xiaomin liang software investigation yimin chen writing review editing lijun zhang software formal analysis shisen jia software formal analysis declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is supported by the national natural science foundation of china under grant 51979228 
20784,the image based visual servoing ibvs problem of a redundant underwater vehicle manipulator system uvms with an eye in hand camera is investigated in this paper with consideration of system constraints dynamic uncertainties and the absence of vehicle velocity sensors for a typical uvms we propose a hierarchical control architecture which is composed of an unscented kalman filtering ukf based vehicle motion estimator a kinematic model predictive ibvs controller and two decoupled dynamic velocity controllers for the vehicle and the manipulator respectively in details the underwater vehicle velocities are estimated by ukf with visual measurements based on the uvms kinematic model with these estimates a nonlinear model predictive controller mpc is designed to solve the ibvs problem of uvmss and generate velocity commands for the underwater vehicle and the manipulator simultaneously the visual kinematic model of uvmss is used to predict the future trajectories and the field of view manipulator joint angle and uvms velocity constraints are handled when solving the optimization problem to reduce the system complexity of uvmss the high dimensional uvms s dynamic model is decoupled into two low dimensional models of the vehicle and the manipulator and a dynamic inversion based active disturbance rejection control di adrc method is developed for dynamic controller design the physical interaction effects between the vehicle and manipulator are considered as external disturbances acting on each other which are estimated by extended state observers eso in adrc the simulation experiments with a typical uvms are performed to demonstrate the effectiveness of the proposed hierarchical ibvs controller in dealing with system redundancy constraints and uncertainties keywords underwater vehicle manipulator system image based visual servoing hierarchical control architecture model predictive control active disturbance rejection control unscented kalman filtering 1 introduction with the rapid development of ocean technology unmanned underwater vehicles uuvs have become a common tool and are widely used in resources investigation seabed mapping object delivery and other underwater missions in order to improve the interventional ability of underwater vehicles to execute dexterous tasks such as grasping from the seabed and rotating valves ridao et al 2014 the underwater vehicle manipulator system uvms also named intervention autonomous underwater vehicle i auv composed of a free floating underwater vehicle and one or more multi joint manipulators has been developed as an effective autonomous manipulation platform uvmss have the advantages of both the dexterity of free floating multi function manipulators and the long range operation of underwater vehicles youakim et al 2017 in recent decades the motion planning and trajectory tracking control of uvmss have attracted a lot of attention around the world several uvms projects have been proposed continuously achieving different levels of autonomy in the pool or harbor tests for typical interventional tasks for examples marani et al 2009 described the semi autonomous underwater vehicle for intervention missions sauvim which was the first underwater vehicle capable of autonomous manipulation khatib et al 2016 at stanford university developed a dual arm humanoid underwater remotely operated vehicle rov named the ocean one which had comprehensive environment perception and object manipulation abilities the european pandora lane et al 2012 project developed new computational methods to enable underwater vehicles remain autonomous and significantly reduce the frequency of human assistance houston mechatronics inc built an underwater transformer named aquanaut which can shift from a submarine that perform long range efficient cruise and full attitude hover control to a humanoid robot to execute stable and short range dual arm operation manley et al 2018 wang et al 2019 developed a biomimetic underwater robot named robcutt ii and proposed autonomous vision based hovering control compared with an individual underwater vehicle or manipulator the uvms is a redundant robotic system with coupled degrees of freedom dofs which brings more challenges to its motion planning and trajectory tracking control the motion planning algorithms including search based algorithms genetic algorithms task priority algorithms etc have been proposed for uvmss with consideration of obstacle avoidance inherent kinematic redundancy hydrodynamic damping energy saving and system constraints pi et al 2019 designed a search based motion planning algorithm for coordinated manipulation of a dual arm uvms banfield and rodriguez 2019 proposed a multi objective genetic algorithm based path planning method for a uvms considering kinematic redundancy sarkar and podder 2001 proposed a motion coordination algorithm which generated the desired trajectories for both the vehicle and the manipulator to minimize the total hydrodynamic drag podder and sarkar 2004 developed a unified motion planning algorithm to provide reference trajectories by exploiting the inherent kinematic redundancy huang et al 2016 designed an optimization based motion planning algorithm in order to achieve the coordinative movement of the uvms and minimize the pitch and roll angles consequently jin et al 2016 designed an improved motion planning method of uvmss subject to joint limits zhao et al 2013 proposed an integrated multi task motion planning method based on the traditional task priority algorithm with consideration of joint limits and minimizing roll and pitch movement tang et al 2017 et al proposed a redundancy resolution planning method on the acceleration level to overcome the acceleration sudden changes in the traditional task priority method zhao et al 2018 proposed a receding horizon motion planning algorithm for uvmss by optimizing system performances under joint constraints trajectory tracking of uvmss is also studied based on the dynamic model which is typically high dimensional with strongly coupled nonlinearities as while as significant uncertainties of modeling and parameters londhe et al 2017 designed a robust single input fuzzy logic control scheme for task space trajectory tracking control under external disturbances for uvmss dai and yu 2018 proposed an indirect adaptive control scheme and the rapid convergence of tracking errors is guaranteed barbalata et al 2018b developed a low level position force control structure for underwater manipulators which combined the parallel control structure with sliding mode control and model information bae et al 2018 evaluated the performances of various alternatives to design and optimize the controller of a uvms amundsen et al 2018 utilized the inverse kinematics with the generalized jacobian matrix to reduce the energy to stabilize the vehicle and drive the underwater manipulators nikou et al 2018 proposed a robust model predicted control nmpc methodology to handle the state and input constraints of force torque controllers which was applied to the environment by the end effector of uvmss in summary the aforementioned motion planning and trajectory tracking methods of uvmss mostly concern with the global pose of the uvms especially that of the end effector however in practice it is almost impossible to obtain precise earth fixed pose information with onboard sensors visual servoing is a sensor based control strategy which is developed initially for robotic manipulators and is farther applied to mobile robots unmanned aerial vehicles uavs and uuvs gao et al 2015 2017 in recent years visual servo control is used to address the grasping control for the mobile manipulator platforms belmonte et al 2019 tsai et al 2020 and aerial manipulators ramon soria et al 2020 santamaria navarro and andrade cetto 2019 santamaria navarro et al 2017 meanwhile a few works have been done from visual servo control of underwater manipulator sivčev et al 2018b implemented the visual servo control of underwater manipulators of industrial work class rovs zhang et al 2019 proposed a grasping control method of underwater manipulators based on monocular visual servoing for the ibvs of uvmss zhang et al 2018 proposed a visual servo control scheme with base motion compensation using an unscented kalman filtering ukf and designed an eye in hand visual servo controller with a disturbance compensator li et al 2019 proposed an uncalibrated visual servoing scheme for a uvms with an eye in hand camera under uncertainties including visual system parameters uvms kinematics and feature position liang et al 2019 designed an ibvs system for uvmss without consideration of system dynamics in these works the velocity joint angle and visibility constraints and the dynamics of uvmss have not been well addressed to solve the visual servoing problem of uvmss under system constraints and dynamic uncertainties and coupling effects between the two parts of a uvms we extend the previous work on mpc ibvs of underwater vehicles gao et al 2016 and model predictive motion planning zhao et al 2018 and propose a complete ibvs control architecture the main contributions of this paper are two folds 1 a hierarchical mpc scheme integrated with adrc dynamic controllers is systematically developed to solve the ibvs problem of a fully actuated uvms the field of view fov and velocity constraints are explicitly handled by the mpc approach which generates velocity commands by optimizing the future trajectories predicted by system models 2 two decoupled dynamic controllers are proposed for the vehicle and the manipulator separately to reduce the system complexity with consideration of the absence of a doppler velocity log dvl in many practical applications we employ ukf to estimate the vehicle velocity with visual measurements a dynamic inversion di based adrc method is proposed in which the pseudo control is constructed with the estimation and compensation of uncertainties and disturbances and the final control inputs are obtained by the dynamic inversion of decoupled nominal dynamic models the dynamic control performance is validated by comprehensive simulation studies in which two cases of that with the adrc based control loop and that without are tested and compared the rest of this paper is organized as follows section 2 describes the mathematical formulation of the uvms control problem including the equations of motion of a uvms and its ibvs system the hierarchical ibvs control algorithm of uvmss is presented in section 3 in this section hierarchical control structure of system vision based and velocity estimation of underwater vehicles model predictive visual servo control and adrc based dynamic decoupled control for the underwater vehicle and manipulator are presented in section 3 1 section 3 2 section 3 3 and section 3 4 respectively the simulation results are presented in section 4 to demonstrate the performances of the proposed method finally some concluding remarks are given in section 5 2 problem formulation 2 1 modeling of uvmss the models of uvms and visual systems are briefly introduced in this section and the control objective of ibvs is described a detailed introduction to the kinematic and dynamic models of uvmss is given in fossen 2002 and antonelli 2018 define the system velocity vector as ζ v 1 t v 2 t q t t r 6 n and the kinematic model of a uvms is 1 η 1 η 2 q r b e o 3 o 3 n o 3 j k o 1 η o 3 n o n 3 o n 3 i n ζ where η η 1 t η 2 t t r 6 and v v 1 t v 2 t t r 6 represent the pose vector and velocity vector of the base uuv η 1 x y z t r 3 represents the position vector of the uuv s center of mass o b in the earth fixed frame η 2 φ θ ψ t r 3 is the euler angle vector of the body fixed frame respect to the earth fixed frame v 1 u v w t r 3 and v 2 p q r t r 3 are the linear and angular velocities in the body fixed frame q r n is the vector of manipulator s joint angles and q ω 1 ω 2 ω n t is the corresponding angular velocity vector n is the number of joints o 3 represents a 3 dimensional zero matrix i n is the n dimensional unit matrix r b e r 3 3 is the orthonormal matrix which represents the coordinate transformation from the body fixed frame to the earth fixed frame and r e b r b e 1 r b e t j k o η r 3 3 represents the transformation matrix between the euler angles rates and the vehicle angular velocities define η ee r 6 as the posture vector including the position and the euler angles of the end effector it is expressed by η ee k η q assuming that the camera coincides with the end effector for simplification we have 2 v c r e c o 3 3 o n 3 j k o η ee η ee j w η 2 q ζ where v c u c v c w c p c q c r c t r 6 is the camera velocity expressed in the end effector frame r e c is the rotation matrix from the earth fixed frame to the end effector frame j w η 2 q is the jacobian matrix of the end effector with respect to the uvms velocity vector the dynamic model of uvms is expressed as antonelli 2018 3 m q ζ c q ζ ζ d q ζ ζ g q r b e τ where m q r 6 n 6 n is the inertia matrix including added mass terms c q ζ is the vector of coriolis and centripetal terms d q ζ is the vector of dissipative effects g q r b e is the vector of gravity and buoyancy effects bayo et al 1989 the relationship between the generalized forces τ and the control input is given by 4 τ τ v τ q b v o 6 n o n 6 i n u bu where u r 6 n is the vector of the control input forces and torques generated by the thrusters and motors b v r 6 6 is a constant matrix known as the thruster control matrix a uvms is a high dimensional nonlinear system with a lot of unknown parameters and unmodeled effects which make it a challenging task to design a robust adaptive controller with satisfactory performances to reduce the complexity of the system we use a decoupled approach by departing it into two lower dimensional systems of the underwater vehicle and the manipulator barbalata et al 2018a the dynamic model of underwater vehicles is presented as 5 m v v c v v v d r b v v g r b r b e τ v τ d m where m v is a positive definite inertial matrix of the rigid body and the added mass c v is composed of the corresponding coriolis and centripetal matrices d r b v 0 is the hydrodynamic damping matrix g r b represents the vector produced by the gravity and buoyancy τ v is the control output of the vehicle controller τ d m is the external disturbances including the coupling effect from the manipulator the model of manipulators is given as 6 m m q q c m q q q d m q q q g m q τ m τ d v where m m q is the inertia matrix of the underwater manipulator c m q q is the coriolis force and centripetal force matrix of the manipulator system d m q q is the damping force matrix of the manipulator under water g m q is the gravity and buoyancy matrix of the manipulator system τ m is the control output of the underwater manipulator controller τ d v is the external disturbances including that from the underwater vehicle the approximate dynamic models of the underwater vehicle and the manipulator in eqs 5 and 6 without external disturbances can be rewritten in the following compact forms 7 v f v η v τ v q f m q q τ m 2 2 modeling of eye in hand visual systems in this paper the ibvs approach of a uvms with an eye in hand camera is investigated where the image coordinates are defined as the control variables gao et al 2019 the visual system of the uvms is shown in fig 1 in fig 1 e denotes the earth fixed frame b denotes the body fixed frame and c is the camera frame that coincides with the end effector of the manipulator i is the planar image frame o 1 o 2 o 3 and o 4 are the four feature points according to the imaging principle of a pinhole camera the image coordinates of feature point o i in the current position and the expected position are given as 8 s i m i n i f z i x i y i s i m i n i f z i x i y i where p i x i y i z i t r 3 and p i x i y i z i t r 3 are the coordinates of the i th feature point o i in the camera frame c m i n i and m i n i are the corresponding the 2 d image coordinates and f is the focal length of the camera the derivative of s is given as 9 s i f z i 0 m i z i m i n i f f 2 m i 2 f n i 0 f z i n i z i f 2 n i 2 f m i n i f m i v c l i s i z i v c where l i s i z i is the image jacobian matrix between the camera velocity and the image velocity yahya and arshad 2017 the current and the desired image coordinates of the n feature points are given respectively as 10 s s 1 s 2 s n t r 2 n s s 1 s 2 s n t r 2 n the visual system model could be formatted as 11 s l s z v c where z z 1 z n t r n is the image depth vector 12 l s z l 1 s 1 z 1 l n s n z n the visual servo control system is designed to make the visual tracking error e s s converge to zeros the derivative of visual tracking error e is obtained as 13 e l s z v c l s z j w η 2 q ζ the classical ibvs feedback control is designed to expect an exponential decrease of image errors 14 ζ d λ j w η 2 q l s z e where j w η 2 q and l s z are the pseudo inverses of the jacobian matrices of j w η 2 q and l s z respectively λ is a positive gain 3 hierarchical visual servo control system architecture in this section a hierarchical control scheme is proposed to solve the ibvs problem of uvmss section 3 1 describes the hierarchical visual servo control structure the vision based velocity estimation of underwater vehicles is discussed in section 3 2 section 3 3 describes the model predictive visual servo control section 3 4 gives the adrc based decoupled dynamic control for the underwater vehicle and manipulator respectively 3 1 hierarchical visual servo control structure the hierarchical ibvs control framework of uvmss is shown in fig 2 in the feedback control loop the vehicle velocity v is estimated by ukf based on visual measurements from an eye in hand camera zhang et al 2018 the mpc ibvs controller generates the desired velocity commands v d q d by solving the constrained optimization of predicted trajectories on line and sends them to the decoupled dynamic adrc controllers in the adrc vehicle controller v ˆ is used to track the desired velocity command v d and the real time thrust signal τ v is obtained meanwhile in the manipulator controller the motor signals τ m is designed to track the desired velocity command q d of the manipulator the proposed mpc ibvs controller and decoupled adrc control design are presented in the following sections 3 2 vision based velocity estimation of underwater vehicles the visual features attached on the target are captured by a camera mounted on the manipulator the feature coordinates in the image plane is used to estimate the pose and velocity of the underwater vehicle the system state vector is defined as 15 x η v q the discrete time system model with constant velocities of the vehicle and manipulator is given as 16 η k 1 η k r b e k 0 3 3 0 3 3 j k 0 k v 1 k v 2 k t v 1 k 1 v 2 k 1 v 1 k v 2 k q k 1 q k q k t q k 1 q k where t is the sampling period the state update function of the system can be described as 17 x k 1 f x k n w k where n w k is the process noise the system measurements include the feature coordinates s angular velocity of the vehicle and the angles of joints 18 z k h x k n v k where 19 h x k s k v 2 k q k and s is a nonlinear function of system state variables of η and q defined by eq 8 n v k is the measurement noise it is reasonable to assume that the process and measurement noises n w and n v obey the zero mean gaussian distribution with covariance matrix σ w and σ v respectively such that n w k n 0 σ w and n v k n 0 σ v based on the system and measurement models in eqs 17 and 18 the ukf can be used to obtain the velocity estimate v ˆ the detailed processing steps of ukf design could be found in wan and van der merwe 2000 and kandepu et al 2008 and are omitted here 3 3 model predictive visual servo control the model predictive ibvs control can be formulated as given the visual servo model of uvmss in 13 find the optimized velocity inputs by solving the following constrained finite time optimization problem dai et al 2019 20 min u ζ k j k s k ζ k with 21 j k s k ζ k j 1 n p s j k s t q s s j k s j 0 n c 1 ζ t j k r v ζ j k subject to 22 s j k 1 s j k t c l s j k z k j w η 2 j k q j k ζ j k f ζ s s j k ζ j k q j 1 k q j k t c q j k η 2 j 1 k η 2 j k t c j k o 1 v 2 j k s j k s q j k q ζ j k u where u ζ k ζ 1 k ζ 2 k ζ n c k is the candidates of velocity inputs j k s k ζ k is the cost function of predicted image errors and velocity commands in the cost function q s and r v represent the weighting matrices of visual errors and velocities respectively n p is the prediction horizon and n c n p is the control horizon k is the prediction starting time s j k q j k η 2 j k are predicted image coordinates of the feature points manipulator joint angles and euler angles at time j respectively s q and u are the constraint sets of features coordinates joint angles and system velocities respectively t c is the control period for a freely moving uvms without obstacles in the working space the following three constraints must be satisfied 1 the field of view constraint the image features must be kept in the image plane during the movement as 23 m min m j k m max n min n j k n max where m max n max are the maximum coordinates and m min n min are the minimum coordinates of the image plane respectively 2 the velocity input constraint the desired velocities should be available under limited thrust forces 24 u j k u max v j k v max w j k w max p j k p max q j k q max r j k r max where u max v max w max p max q max and r max denote the upper bounds of the corresponding velocities 3 manipulator joint angles and their velocities limits each joint position and velocity of the manipulator cannot exceed the mechanical limits 25 q i min q i j k q i max q i min q i j k q i max i 1 6 where q i min q i max q i min q i max are the upper and lower limits of the i th joint angle and its rate the optimization solution of 21 is u ζ k and the first element ζ 1 k is used as the velocity command and the problem will be solved repeatedly at the next period 3 4 adrc based dynamic decoupled control the dynamic properties of the vehicle and the manipulator are quite different e g inertial masses and damping effects and they are driven by different types of actuators base on this point we employ a decoupled approach for the dynamic control of uvmss to track the velocity commands provided by the ibvs controller the whole uvms is separated as two independent systems with lower dimension to be controlled and the interaction effects between the base vehicle and the attached manipulator are considered as disturbances sivčev et al 2018a in this paper we develop a dynamic inversion based adrc controller with the strong adaptability and robustness to system uncertainties and disturbances and it is easy to design and implement the approximate model based dynamic inversion is to cancel the nonlinearities of the dynamic models which generates actual control inputs by the system inversion with pseudo control composed of pd signals and estimated disturbances the adrc controller wang et al 2016 wang et al 2017 barbalata et al 2018a is composed of a tracking differentiator td a nonlinear states error feedback controller nlsef and a extended state observer eso and a di module as shown in fig 3 we have ζ d v d τ τ v and y a v in the underwater vehicle controller and ζ d q d τ τ m and y a q in the manipulator controller the td module is used to generate the filtered command signal ζ r from the command ζ d the discrete form of the td is written as cai et al 2019 26 fh fhan ζ r k ζ d k ζ r k r h 0 ζ r k 1 ζ r k h ζ r k ζ r k 1 ζ r k h fh where ζ r is the derivative of ζ r h is the sampling time r is the fast coefficient and h 0 is the filter coefficient the standard form of function fhan x 1 x 2 r h is 27 d r h d 0 h d y x 1 h x 2 a 0 d 2 8 r y a x 2 a 0 d 2 sign y y d 0 x 2 y h y d 0 fhan r sign a a d r a d a d the design of eso is to estimate the nonlinear terms and external disturbances such as added mass drag forces and external disturbances the eso is designed as cai et al 2019 28 e k z 1 k y a k fe k fal e k 0 5 δ z 1 k 1 z 1 k δ z 2 k ξ 01 e k u k z 2 k 1 z 2 k δ ξ 02 fe k fal e α δ e α sign e e δ e δ α 1 e δ where z 1 k is the filtered velocity of underwater vehicles or manipulators and z 2 k is the estimated disturbances u k is the control signal ξ 01 ξ 02 are the gain coefficients of the observer the nlsef controller is written as cai et al 2019 29 e 1 k ζ r k z 1 k u 0 k β 1 k fal e 1 k α δ ζ r k where e 1 k is the tracking error β 1 k is the gain parameter fal is the continuous power function whose value is near the origin α is a parameter reflecting the nonlinear characteristics the general value of α is 0 5 or 0 25 δ is a positive number to avoid the chattering of the control quantity parameter and is chosen from 2 h to 5 h u 0 k is the output signal of the controller and the pseudo control is u k u 0 k z 2 k the actual control inputs are solved by the following dynamic inversion which make the adrc independent of the system dynamic and alleviate the difficulty to adjust control gains in the adrc 30 τ v f v 1 η v u m v v c v v v d r b v v g r b r b e τ m f m 1 q q u m m q q c m q q q d m q q q g m q where f v 1 and f m 1 are the inverse functions of the dynamic model 7 with respect to the acceleration signals v u and q u respectively 4 simulation results in this part we will test the performances of the proposed hierarchical ibvs controller of uvmss the simulation model of a typical uvms system composed of the nps phoenix underwater vehicle and the smart 3s manipulator is constructed using the toolkit simurv 4 0 by antonelli 2018 and this uvms is also used in dai and yu 2018 and antonelli et al 2000 in the toolkit the hydrodynamic coefficients of the vehicle model including added mass and damping effects are derived by exploiting the geometry of the rigid body the hydrodynamic coefficients of the manipulator are calculated under the assumption of cylinder links with different lengths and radii the parameters of the vehicle phoenix are given in table 1 the actual uvms parameters are given below m v diag 6019 9551 2332 4129 4913 2069 m m diag 260 250 90 20 9 3 5 d r b v diag 50 u 100 v 100 w 10 5 p 80 20 q 80 20 r d m q q diag 0 4 0 4 0 4 0 4 0 4 0 4 the weights of manipulator joints are 80 kg 80 kg 30 kg 50 kg 20 kg 25 kg the robotic manipulator consists of six joints and the denavit hartenberg dh parameters of the robot arm are shown in table 2 it is a difficult task to establish an accurate mathematical model for uvms in order to test the adaptability of the adrc dynamic controller the following damping and inertial matrices in the approximate models differ from the real values m v ˆ diag 6000 9500 2300 4100 4900 2100 m ˆ m diag 250 240 85 22 10 3 7 d ˆ r b v diag 52 u 95 v 95 w 11 5 p 85 20 q 85 20 r d ˆ m q q diag 0 42 0 42 0 42 0 42 0 42 0 42 the underwater vehicle initial states in the uvms simulation model are η 0 0 0 0 5 0 0 0 t the initial joint angles of the manipulator are set as q 0 0 0 0 0 π 2 0 t the limits of the uvms velocity are ζ ub 0 5 0 3 0 3 0 175 0 175 0 524 0 524 0 524 0 524 1 047 1 047 1 571 t with ζ lb ζ ub the maximum and minimum joint of the manipulator are q ub 2 094 2 094 2 094 3 142 3 142 3 142 t r a d with q 1 b q u b the prediction horizon is n p 20 while the control horizon is n c 10 t c 0 01 sec the values of the weighting matrices q s and r v are q s 5 i 8 r v diag 0 1 i 3 5 i 3 i 3 0 01 i 3 the end effector of uvms is equipped with a camera with a focal length of f 0 01 m the coordinates of the visual features in the earth fixed frame are given as o 1 5 0 5 2 5 o 2 5 0 5 2 5 o 3 5 0 5 3 5 o 4 5 0 5 3 5 the desired pose of the end effector is defined as η ee 3 0 3 0 1 57 1 57 and the corresponding desired feature coordinates are given as s 1 0 0025 0 0025 s 2 0 0025 0 0025 s 3 0 0025 0 0025 s 4 0 0025 0 0025 the field of view constraint as n max m max 0 004 m m min n min 0 004 m the control parameters in adrc are chosen as α 1 0 75 α 2 1 25 ξ 01 100 ξ 02 300 r 10 h 0 01 t 0 1 β 1 100 in order to verify the effectiveness of the mpc based kinematic ibvs control and adrc based decoupled dynamic control the following two cases are investigated by comparative simulations 1 case 1 the kinematic mpc ibvs control of the uvms without the dynamic control loop 2 case 2 the whole hierarchical control of the uvms composed of mpc ibvs control and adrc decoupled control with time varying external disturbances the simulation results of case 1 are plotted in figs 5 9 in fig 5 the position and euler angles of the underwater vehicle are presented the linear and angular velocities of the underwater vehicle generated by the mpc ibvs controller are shown in fig 6 figs 7 and 8 depict the joint angles and angular velocities of the manipulator during the simulation the image trajectories of the feature points are presented in fig 4 fig 9 shows the curves of the global coordinates of the end effector which finally reaches the desired position under the system constraints it can be observed that the image features move to their target positions without violating the system constraints and the end effector is finally driven to the desired pose in about 5 s the pose of the underwater vehicle and the joint angles of the manipulator are stabilized in a short time it should be noticed that the uvms is a redundant robotic system which means that there are infinite solutions of the final system states corresponding to the desired end effector pose the generated velocities of the uvms are constrained to the given ranges in case 2 the adrc based dynamic control loops of the underwater vehicle and the manipulator are included in the uvms ibvs system to test the system performances with the dynamic systems in practice uvms suffers from external disturbances caused by the water currents and waves so here we validate the stability of decoupled controller under time varying disturbances in this simulation the external disturbance of underwater vehicle is τ dv 30 s i n π 5 t 30 30 s i n π 5 t 30 1 1 1 1 t the external disturbance of manipulator is τ dm s i n π 5 t 1 1 1 1 1 1 t the simulation results are as follows the simulation results of case 2 are shown in figs 11 13 the position coordinates and euler angles are shown in fig 11 it can be seen that all the states converge to the final value after a longer time compared with case 1 without the dynamic loop the actual linear and angular velocities of the vehicle are shown in fig 12 in which the velocities are well estimated by ukf and actual velocities of the underwater vehicle track the desired velocities commands by adrc the linear velocity of uuv has reached the limit value set by mpc and lasted for a period of time the x axis forward motion of uuv tends to be stable at 15 s however the motion of z axis and y axis tends to be stable in 20 s the attitude adjustment of uuv tends to be stable at 15 s and the corresponding angular velocity converges to zero obviously it can be observed that the proposed hierarchical decoupled control scheme has a good performance fig 15 shows the changes of the end effector s position during the simulation affected by the overall control movement of the system the position of the end effector is stable after 20 s the 2 d trajectories of the four visual features in the image plane are plotted in fig 10 the trajectory of the feature points moves to the middle image panel and rotates to the desired image point in figs 13 and 14 the joint angles and angular velocities of the joints are displayed it can be observed that the actual velocities of the manipulator track the commands generated by the ibvs controller under disturbances which proves the effectiveness of this in the dynamic control method q 5 gradually stabilized after 20 s while other joint angles tended to be stable at 15 s therefore the final control adjustment of manipulator stability is completed by q 5 the control efforts converge to generate necessary forces and torques in figs 16 and 17 the actual disturbances and estimated disturbances of the joints and uuv are displayed respectively it can be observed that eso has good disturbances estimation performance showing the effectiveness of the decoupling method case 1 ignores the dynamics of the system and inputs the velocity of the system when the system is updated in case 2 mpc adrc method is used to input system acceleration to complete system update case 1 ignores the dynamic properties of the system the vehicle velocities are regarded as the inputs to the system when the system is updated case 1 can be used for motion analysis in case 2 mpc adrc method is used to input system acceleration to complete system update case 2 is mainly used for system controller design finally we use the classical ibvs control in 14 instead of mpc in the kinematic ibvs control for comparison where the inverse solution of jacobian matrix is used to calculate the control efforts the simulated 2 d trajectories of the four visual features are plotted in fig 18 the 6 d pose of the underwater vehicle is shown in fig 19 and the joint angles of the manipulator are plotted in fig 20 compared with the mpc adrc strategy shown in figs 10 11 and 13 the visual servoing system controlled by the inverse solution of jacobian matrix combined with adrc control strategy has larger overshoot and takes longer time to be stabilized the image trajectories move farther in the image plane and the visual target is even out of fov temporarily according to the simulation results and discussions above this proposed adrc decoupled control is satisfactory with the ability to resist external disturbances and the mpc ibvs control objective is achieved under system constraints 5 conclusion in this paper the visual servo control of uvmss is investigated using a hierarchical scheme consisted of kinematic and dynamic controllers with consideration of system constraints unavailable velocities and uncertain system model in the kinematic controller the velocity commands of the vehicle and manipulator are solved by employing a nonlinear mpc approach which optimizes the future trajectories under system constraints within a limited predictive horizon in the dynamic controller firstly the vehicle s velocities are estimated with a ukf algorithm based on the uvms s nonlinear kinematic model with the visual measurements then two adrc based dynamic controllers are designed for the underwater vehicle and the manipulator separately to reduce the system dimension with consideration of totally different dynamic properties of the two parts the system uncertainties including the coupling effects are estimated and compensated the comparative simulation results demonstrate the effectiveness of the proposed hierarchical scheme in the future works we will develop effective learning based system identification strategies to get more precise estimation of disturbances and thus improve the dynamic control performance of uvmss also a prototype uvms could be developed for experimental studies in a real underwater environment credit authorship contribution statement jian gao conceptualization methodology funding acquisition xiaomin liang software investigation yimin chen writing review editing lijun zhang software formal analysis shisen jia software formal analysis declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work is supported by the national natural science foundation of china under grant 51979228 
