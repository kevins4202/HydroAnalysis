index,text
4585,the use of data driven models to forecast streamflow has received substantial attention from scholars in recent years however systematic studies have not been performed to examine binary metaheuristic wrapper based input variable selection bmwivs in real world streamflow forecasting in this study we explored binary metaheuristic based shallow machine learning wrappers for one step monthly streamflow forecasting using local weather information and global climate indices from three catchments with different hydroclimatic conditions first the maximal information coefficient mic was employed to investigate the correlations among the forecasting target streamflow and candidate input variables which included both local and global climate information then the bmwivs models obtained by combining eight binary metaheuristic algorithms five commonly used shallow machine learning algorithms two combined filter based input variable selection fivs methods and two forecasting methods were examined finally the performance of each model was compared with the performance of typical benchmark models including the univariate seasonal autoregressive integrated moving average model five machine learning algorithms with no input variable selection and five machine learning algorithms that use five different fivs methods the experimental results emphasized three significant findings first an appropriate input variable selection method should be selected in practice because several examined wrappers were inferior to the benchmark models second the bmwivs model that combined the regularized extreme learning machine method binary gray wolf optimizer fivs results based initialization method and forecasted values averaged over multiple runs yielded the best performance in the three cases studied third the correlations in terms of the mic between the global climate indices and streamflow were lower than those between local weather information and streamflow and the best wrapper and fivs would select more local weather information variables than global climate index variables which suggests that global climate information can be complementary to local weather information for one step monthly streamflow forecasting these findings have remarkable practical applications for forecasting monthly streamflow keywords streamflow forecasting input variable selection binary metaheuristic algorithm wrapper method machine learning 1 introduction streamflow forecasting is important for the defense of floods droughts early warning water resource distribution urban water management and water quality management sun et al 2014 therefore it is essential to accurately and precisely forecast streamflow and researchers have developed various models for streamflow forecasting e g fang et al 2019 huang et al 2014 streamflow forecasting models can be classified into two categories in terms of whether physical mechanisms are involved shoaib et al 2016 one category is theory driven models and the other category is data driven models in which no physical mechanisms are considered theory driven models include conceptual models e g aubert et al 2003 nash and sutcliffe 1970 and distributed hydrological models e g refsgaard 1997 yoshitani et al 2009 and data driven models include classical time series models e g jayawardena and lai 1994 maceira et al 1999 and artificial intelligence based models e g liu et al 2014 mahmood al juboori and guven 2016 osman et al 2020 sun et al 2014 in the last decade developing data driven models to forecast streamflow has gained increasing attention by researchers due to the flexibility and accessibility of these models e g chang et al 2020 kao et al 2020 such models involve various shallow machine learning and deep neural network algorithms such as multivariate adaptive regression splines e g adnan et al 2019 extreme gradient boosting e g yu et al 2020 extreme learning machine e g yaseen et al 2016 and deep belief network e g chu et al 2020 additionally various decomposition based models such as seasonal and trend decomposition based models e g luo et al 2019 wavelet decomposition based models e g shiri and kisi 2010 and variational mode decomposition based models e g zuo et al 2020 have been employed for streamflow forecasting developing a data driven model conventionally involves four procedures namely data processing and transformation input variable selection ivs model deployment and model assessment yaseen et al 2019 2018 among these procedures ivs is a crucial step chandrashekar and sahin 2014 there are two important impacts of ivs first ivs can decrease the complexity and computational burden of the model second ivs can increase the performance of the model because most machine learning algorithms exhibit a decrease in accuracy when irrelevant and redundant variables are incorporated into these algorithms galelli et al 2014 may et al 2011 based on whether a learning algorithm is employed ivs methods have been generally classified into three main types namely filter based wrapper based and embedded based methods blum and langley 1997 filter based ivs fivs methods are independent of the learning algorithm and select input variables by ranking the variables through statistical measures wang et al 2010 both wrapper based ivs wivs methods and embedded based ivs methods in which a learning algorithm is involved use model performance to filter the variable subset chandrashekar and sahin 2014 kohavi and john 1997 these three types of ivs methods have both advantages and disadvantages typically fivs has the advantage of high computational efficiency both the wivs and the embedded based ivs methods suffer from a high computational burden but yield better performance than fivs methods may et al 2011 streamflow which is affected by many factors has very complex evolution and formation mechanisms yaseen et al 2015 therefore when using data driven models to forecast streamflow there are many potential factors that should be noted the frequently used potential factors to drive these models are local weather information e g temperature evaporation precipitation moisture of soil and humidity and global climatic indices e g the pacific decadal oscillation pdo and the north atlantic oscillation nao e g behzad et al 2009 kagoda et al 2010 li et al 2010 makkeasorn et al 2008 noori et al 2011 rasouli et al 2012 sharma et al 2015 thus two important issues should be considered in practice first the dimension of the candidate input variables might be high second the correlations among the variables are not known in advance as a result when applying data driven models in streamflow forecasting it is necessary to perform ivs e g quilty and adamowski 2018 to date various ivs methods have been utilized to select the most informative variables for streamflow forecasting these methods involve the abovementioned three types of ivs namely fivs li et al 2010 liu et al 2014 noori et al 2011 wivs afan et al 2020 dariane and azimi 2016 qu et al 2021 and embedded based ivs chu et al 2020 for example ren et al ren et al 2020 compared eight fivs methods when using data driven models to forecast one step monthly streamflow taormina and chau taormina and chau 2015a proposed a wrapper based rainfall runoff model using extreme learning machine elm however to the best of our knowledge there have been no systematic studies of binary metaheuristic based wivs in real world streamflow forecasting using both local weather and global climate indices three aspects of this research gap should be noted first for wivs two essential factors specifically the search strategy and the learning algorithm el aboudi and benhlima 2016 have not been comprehensively examined in the field of streamflow forecasting for the search strategy previous studies mainly used relatively old metaheuristic algorithms such as particle swarm optimization pso and genetic algorithms gas for the learning algorithm previous studies mainly focused on artificial neural networks anns afan et al 2020 taormina et al 2015 taormina and chau 2015a 2015b novel metaheuristic search strategies such as the moth flame optimization mfo chen et al 2019 and routine learning algorithms such as support vector regression svr have not been applied second few studies considered hybrid filter wrapper ivs e g hu et al 2015 which is an important complementary form of wivs in streamflow forecasting third the candidate input variables including both local weather and global climate variables often encountered in practice were not considered in the previous wivs models for streamflow forecasting the primary aim of this study is to develop a detailed analysis of binary metaheuristic based wivs in streamflow forecasting specifically our work focuses on three perspectives that were not considered in previous studies first we investigate the performance of wivs by combining eight binary metaheuristic search algorithms and five commonly used shallow machining algorithms for one step monthly streamflow forecasting using local weather information and global climate indices second two combined fivs methods and two final forecasting methods are assessed for the proposed binary metaheuristic based wivs models third we investigate the correlations among the candidate variables and the streamflow using the maximal information coefficient mic recently proposed by reshef et al reshef et al 2011 and discuss the variables selected by the models in the remainder of this paper section 2 describes the studied catchments local weather information used and global climate indices used in section 3 we present the mic the binary metaheuristic algorithms used five shallow machine learning algorithms the proposed binary metaheuristic based shallow machine learning wrappers the evaluation criteria for the models and the experimental setup used section 4 gives the study results and section 5 presents the discussion conclusions are drawn in section 6 2 study areas and data three catchments in the united states with dissimilar hydroclimatic conditions and relatively low levels of human activity were selected as study areas for two main reasons first the performance of data driven models was evaluated under different conditions as in previous studies e g ren et al 2020 sun et al 2014 second the impact of human activities which is a driving factor of streamflow forecasting that was not considered in previous studies e g erdal and karakurt 2013 huang et al 2014 kisi and cimen 2011 could be considered negligible due to the minimal disturbances in the selected areas newman et al 2015 fig 1 shows the locations of these catchments the gauge id gauge name catchment area and climate characteristics are presented in table 1 the studied monthly streamflow series m3 s from january 1980 to december 2014 and the autocorrelograms in terms of the mic are shown in fig 2 notably all the streamflow series have strong seasonality which is a typical characteristic of monthly streamflow dettinger and diaz 2000 shortridge et al 2016 wang et al 2011 for the candidate local weather information we considered 12 month lags 1 to 12 monthly lags for the five driving factors including the mean daily precipitation in a month mean daily solar radiation sr in a month mean daily minimum temperature in a month mean daily maximum temperature in a month and mean daily vapor pressure vp in a month for the candidate global climate indices referring to ren et al ren et al 2020 fang et al fang et al 2018 and rasouli et al rasouli et al 2012 the 12 month lags for five indices namely the niño 3 4 the pacific north american pna the arctic oscillation ao the nao and the pdo were considered additionally 12 month lags in streamflow were added to the candidate input variable set which resulted in 132 candidate input variables the data from the above streamflow series and local weather information for the three cases were extracted from the publicly available camels data set addor et al 2017 newman et al 2015 which includes data for 671 small to medium sized basins in the united states the five global climate indices used were acquired from https www esrl noaa gov psd data climateindices list all the samples 408 were split into a training set and a testing set at a ratio of 7 3 the training set included 285 samples and the testing set included 123 samples descriptive information for the studied streamflow is displayed in table 2 to unify the scale for different dimensions of the variables hadi and tombul 2018 according to eq 1 every variable in both the training set and testing set was preprocessed into the interval of 0 1 1 x x x min x max x min where x denotes the time series of the selected variable in the full data set xmin represents the minimum value of the selected variable in the training set and xmax is the maximum value of the selected variable in the training set notably three error criteria section 3 5 were estimated based on the back transformed variables after the forecasting was conducted with the data driven models 3 methods the flow diagram for our study is described in fig 3 first all 132 candidate variables were included in a correlation analysis using the mic second binary metaheuristic based shallow machine learning wrappers were built based on eight selected binary metaheuristic algorithms five shallow machine learning algorithms two methods of final forecasting and two methods of combined fivs finally the results were analyzed 3 1 maximal information coefficient the mic which was proposed by reshef et al reshef et al 2011 is an information theory based measure of association it not only can reflect the linear and nonlinear relationships among variables but also encompasses the nonfunctional dependence relationships among variables therefore the mic has received widespread attention in recent years ge et al 2016 liang et al 2018 lyu et al 2017 the main concept of the mic is that if there are correlations among variables the data distribution in a grid can reflect the correlations according to the grid division result the mic is calculated based on mutual information and grid partitioning to calculate the mic between two variables x and y the following three steps are involved 1 at the given grid resolution a two dimensional scatterplot based on x and y is divided according to different partitioning schemes then the value of mutual information in each grid is calculated 2 the value of maximum mutual information among the different partitioning schemes is retrieved and normalized to the range of 0 1 3 the grid resolution is then changed and steps 1 and 2 are repeated the maximum value of the normalized mutual information at different scales is the mic the formula for calculating the mic is shown in eq 2 2 m i c d max xy b n i d x y l o g min x y where n stands for the sample size b is a function related to n and reshef et al reshef et al 2011 suggest b n n0 6 i d x y denotes the maximum value of mutual information in grid area d when the value of the mic is equal to zero the two variables considered are uncorrelated when the value of the mic is greater than zero there is a correlation between the two variables when the value of the mic is higher the correlation between the two variables is stronger 3 2 eight binary metaheuristic algorithms in wivs when the dimensionality of the candidate variables is high the selection of an optimal set of variables is a nondeterministic polynomial np problem iguyon and elisseeff 2003 to solve this problem various search strategies including forward selection ververidis and kotropoulos 2008 stepwise selection park et al 2008 backward elimination vu et al 2015 and metaheuristic searches oreski and oreski 2014 are frequently used among these search strategies metaheuristic based methods have recently received considerable attention due to their efficiency and global search potential diao and shen 2015 yusta 2009 a metaheuristic based ivs method was used to solve an ivs problem by treating it as a 0 1 optimization problem xue et al 2016 therefore continuous metaheuristic based algorithms need to be transformed to their binary version by a transition function emary et al 2016 in this study the effectiveness of eight binary metaheuristic based algorithms table 3 for wrapper based data driven models of one step monthly streamflow forecasting was examined and compared of these eight algorithms binary pso mirjalili and lewis 2013 and binary ga siedlecki and sklansky 1989 have often been applied to ivs in streamflow forecasting afan et al 2020 dariane and azimi 2016 taormina et al 2015 taormina and chau 2015a 2015b relatively new algorithms including the binary bat algorithm ba mirjalili et al 2014 binary gray wolf optimizer gwo emary et al 2016 binary salp swarm algorithm ssa faris et al 2018 binary dragonfly algorithm da mirjalili 2016 binary whale optimization algorithm woa hussien et al 2020 and binary mfo chen et al 2019 are seldom utilized in the field of hydrology for ivs 3 3 five shallow machine learning algorithms five shallow machine learning algorithms including multiple linear regression mlp regularized extreme learning machine relm svr k nearest neighbor regression knn and generalized regression neural network grnn were selected for comparison table 4 these algorithms are routinely used in the field of hydrological forecasting e g cigizoglu 2005 eskandarin et al 2010 latt and wittenberg 2014 noori et al 2011 taormina and chau 2015a detailed descriptions of the algorithms can be obtained from the corresponding references breiman and friedman 1997 deng et al 2009 dudani 1976 smola and schölkopf 2004 specht 1991 3 4 proposed binary metaheuristic based shallow machine learning wrappers iguyon and elisseeff iguyon and elisseeff 2003 summarized three important points for ivs first presumably redundant variables can be beneficial for the model second it is not possible to determine which combination of variables produces the best performance by scoring the variables separately third two variables that are ineffective individually may be effective when combined therefore compared with fivs wivs can provide better performance in many cases el aboudi and benhlima 2016 furthermore it is reported that forecasting accuracy can be improved by using a particular combination of hyperparameters in machine learning algorithms and the candidate input variables chen and chang 2009 taormina and chau 2015a consequently in this study we implemented binary metaheuristic algorithms to simultaneously optimize the selection of the input variables and hyperparameters in the machine learning algorithms 3 4 1 solution representation the solution representation for individuals in the proposed binary metaheuristic based shallow machine learning wrappers is shown in fig 4 each individual consisted of two parts a variable part to be selected and a hyperparameter part to be adjusted for the variable part if the value at a position presents 1 then the variable that corresponds to this position is selected as an input variable when the value at a position presents 0 the variable that corresponds to this position is rejected the hyperparameter part is a binary encoding representation of the hyperparameters in the corresponding shallow machine learning algorithms notably when these machine learning algorithms were applied the binary values in this part were back transformed into the actual representations of the hyperparameters 3 4 2 two methods for obtaining final forecasting values the method most commonly used to initialize the conditions of binary metaheuristic based wrappers is random initialization which is referred to as the random initialization method in this paper e g faris et al 2020 however a difference in initial conditions can result in variations in the final model li et al 2020 to evaluate the performance of the model we ran it multiple times with initial conditions based on different random seeds e g too et al 2019 there are two methods of obtaining final forecasting values in the first method the model with the best fitness in the training set among the models from multiple runs is the selected model then the final forecasting values in the testing set are determined using this selected model in the second method the forecasted values in the testing set are determined by all the models from multiple runs in the training set the final forecasting values are the means of these forecasted values in this study both methods were explored for brevity the first method is denoted as bffv and the second method is denoted as avfv 3 4 3 two methods of combined filter based input variable selection in the past few years to take advantage of the benefits of both fivs and wivs hybrid filter wrapper ivs has been proposed and applied in many fields hu et al 2015 solorio fernández et al 2016 there are two typical methods among the various hybrid filter wrapper ivs approaches in the first method some initial conditions of wivs are initialized based on the results of fivs which is referred to as the fivs initialization method in this paper e g apolloni et al 2016 the second method has two stages which is referred to as the two stage method in this paper e g akadi et al 2011 in the first stage fivs is performed and the candidate variable set is reduced based on the results of fivs in the second stage wivs is performed on the variable set obtained in the first stage a remarkable difference between the two methods is that when performing wivs the candidate variables in the first method are the original 132 variables while the candidate variables in the second method are the results of fivs from the 132 variables in this study the above two commonly applied methods of hybrid filter wrapper ivs were investigated specifically we selected five typical fivs methods galelli et al 2014 may et al 2008 quilty et al 2016 vergara and estévez 2014 zou et al 2003 to combine with the wrappers table 5 in the fivs initialization method the ivs results of the five fivs methods are utilized to initialize the variable parts of the wrappers and the hyperparameter parts of the wrappers are initialized with the binary representations of the hyperparameters which are adjusted in the training set using corresponding shallow machine learning algorithms in section 3 3 coupled with the corresponding fivs approach in the two stage method we selected the union set of the results of the five fivs methods as the result of the first stage then in the second stage wivs was performed based on the results of the first stage 3 5 evaluation criteria for the models in this study three error criteria namely the nash sutcliffe efficiency nse mean absolute error mae and root mean square error rmse were considered the formulas of these three criteria are shown in eqs 3 5 3 nse 1 i 1 n q i q i 2 i 1 n q i q 2 4 rmse i 1 n q i q i 2 n 5 mae 1 n i 1 n q i q i where q i is the monitored streamflow q represents the average q i q i is the forecasted streamflow q denotes the average q i and n stands for the number of samples used the rmse is employed to estimate the average deviation between the observed value and the forecasted value the nse which ranges from to 1 indicates the predictive accuracy of the hydrological model the mean deviation between the observed value and the forecasted value is estimated using the mae in the field of streamflow forecasting these three criteria are routinely applied to evaluate the performance of models e g cheng et al 2020 erdal and karakurt 2013 sun et al 2014 in addition to the above four criteria the number of selected variables nsv was regarded as an important criterion for the data driven models in this study in general the objective was to obtain a model with maximum accuracy and the minimum nsv which results in a model with excellent prediction performance and a high level of interpretability faris et al 2018 sanz garcia et al 2015 xue et al 2016 furthermore the sign test dixon and mood 1946 was applied to determine whether the differences in the predictive accuracies of different models were significant diebold and mariano 1995 detailed information for the sign test was provided by diebold and mariano diebold and mariano 1995 3 6 experimental setup to test the effectiveness of the proposed wrappers the univariate seasonal autoregressive integrated moving average sarima method five machine learning algorithms with no ivs and five machine learning algorithms using the selected fivs methods table 5 with the hampel test may et al 2008 were selected as the benchmark models the sarima models were performed by the function auto arima in the forecast package hyndman and khandakar 2008 to determine the parameters the relm was adjusted with respect to the number of hidden nodes from 1 to 256 the active function including sigmoid sine purelin and radial basis and the regularization coefficient 2 8 2 7 26 27 as for the hyperparameters in the svr the radial basis function kernel was selected a grid search was performed for the penalty parameter 2 8 2 7 27 the radius of the insensitive tube 0 0 1 0 2 and 0 3 and the kernel parameters 2 8 2 7 27 using libsvm chang and lin 2011 the only hyperparameter in the knn method k the number of nearest neighbors was adjusted from 1 to 32 and inverse distance weighted averaging algorithms were used to obtain the results for the grnn the spread of the radial basis functions was adjusted within a predetermined range 2 6 5 2 6 2 5 5 21 for all eight binary metaheuristic algorithms the size of the population and the maximum number of iterations were set to 20 and 200 respectively for the pso the linear decreasing inertia weight strategy was selected the maximum inertia weight and minimum inertia weight were set to 0 9 and 0 4 respectively the acceleration coefficient was set to 2 and the velocity of the particle was constricted to range 6 6 too et al 2019 for the ga the crossover rate was fixed to 0 8 the mutation rate was fixed to 0 01 too et al 2019 and the roulette wheel selection and double point crossover were employed for the ba the loudness and pulse rate were fixed to 0 25 and 0 1 respectively in addition the binary gwo method used in the study was implemented according to algorithm 2 as described by emary et al emary et al 2016 we set a fixed initial seed when using the relm to ensure the consistency and repeatability of all of the experiments because a difference in the initial solutions for the binary metaheuristic based wrappers could result in various results to compare the performances of the proposed wrappers we performed 20 runs for these wrappers with different random seeds when the wrappers were trained the training set was resampled with a holdout percentage of 30 the fitness values of the wrappers were equal to the rmses that were estimated over the samples that were not resampled in the training set when training the selected machine learning algorithms using fivs we used the same resampling method as above to adjust the hyperparameters pmi and pci were executed using r scripts obtained from https github com gbhumphrey1 pmis pcis the mic calculation was based on the minepy library with default parameters albanese et al 2013 we used the information theoretical estimators ite toolbox szabó 2014 to program mi and cmi according to a method of nonparametric multivariate edgeworth expansion 4 results 4 1 correlations among variables to explore the correlations between all candidate input variables and the streamflow we quantified these correlations in terms of the mic for the three studied cases fig 5 three obvious characteristics can be seen in fig 5 first for all studied cases all candidate input variables are related to the dependent variable namely streamflow in terms of the mic and the resulting values range from approximately 0 15 to 0 84 second the degree of the correlation varied in the three studied catchments for example at station 06191500 the fifth lag in vp displayed an mic value of 0 75 for streamflow while the mic value was 0 21 at station 06191500 third compared to the candidate input variables of the global climate indices most of the candidate input variables associated with the local weather information have stronger correlations with streamflow and the most relevant variables are the candidate input variables that correspond to local weather information for example at station 11266500 the first two most relevant variables in terms of the mic are the first lag in streamflow and the fifth lag in sr furthermore to examine the correlations among the candidate input variables we determined the correlation between the climate series and the autocorrelation metrics for the studied climate series as shown in figs 6 and 7 respectively the data in fig 6 indicate that there are strong correlations among the local weather information variables except for precipitation in addition a slightly high correlation between ao and nao was observed with an mic value of 0 4173 the autocorrelation of the studied climate series is shown in fig 7 notably there is periodic autocorrelation in the series of local weather information except for precipitation for the global climate indices the pdo and niño 3 4 have stronger autocorrelations for their first few lags than for the other lags and other climate indices have similar correlations for all lags 4 2 performance of the benchmark models the performance of the selected benchmark models including the univariate sarima method and the five machine learning algorithms with the five fivs methods and the hampel test are listed in tables 6 9 for comparison three observations reflected in tables 6 9 should be emphasized first in contrast to the four other fivs methods pci with the hampel test yielded the minimum number of variables in all studied cases second the svr using pci produced the best predictive performance in terms of the nse in all studied cases for the rmse criterion the svr using pci is undoubtedly superior to the other methods at stations 06 191 500 and 13340000 although at station 11266500 the rmse achieved by the svr with pci was not the minimum value it was very close to the minimum obtained by the svr with lc a similar result in terms of the mae was also found at station 13340000 the svr with pci had a comparable mae of 64 91 m3 s with the best mae of 62 51 m3 s achieved by the svr with mi third in some cases when the machine learning algorithms were coupled with fivs to drive the 132 candidate input variables the performance of these methods was inferior to the performance of the univariate sarima and the machine learning algorithms with no ivs for example at station 11266500 the grnn using pmi with the hampel test yielded an nse of 0 59 an rmse of 17 89 m3 s and an mae of 10 32 m3 s the sarima yielded an nse of 0 65 an rmse of 16 57 m3 s and an mae of 7 52 m3 s the grnn with no ivs produced an nse of 0 62 an rmse of 16 99 m3 s and an mae of 8 65 m3 s 4 3 performance of the proposed wrappers to compare the performance of the proposed wrappers for the training set the fitness values and nsvs of the proposed wrappers based on the training set figs 8 10 were investigated figs 8 10 show the boxplots of the fitness values and the nsvs for the proposed wrappers based on the training set at the three studied stations over 20 runs three interesting results can be observed in figs 8 10 first when using the gwo for the wrappers in most cases the distributions of the best fitness values over 20 runs had smaller ranges than those using the other seven binary metaheuristic algorithms in all cases second the nsvs based on fivs initialization and two stage methods were significantly lower than the nsvs based on random initialization in almost all cases third grnn based wrappers and svr based wrappers displayed comparable performance in terms of the distributions of the best fitness values over 20 runs and were superior to the knn based wrappers relm based wrappers and mlr based wrappers to examine the performance of the proposed wrappers based on the testing set the rmses maes and nses for these wrappers for the testing set that use two different methods of obtaining the final forecasted values were calculated figs 11 13 show the rmses maes and nses for the testing set using bffv over all 20 runs the rmses maes and nses for the testing set with avfv over all 20 runs are represented in figs 14 16 the data in figs 11 16 display four notable characteristics first in nearly all situations relm based wrappers and svr based wrappers achieved comparable rmses maes and nses and outperformed the knn based wrappers grnn based wrappers and mlr based wrappers regardless of the binary metaheuristic algorithm used for example when using avfv at station 11266500 the nses produced by the relm with the gwo and fivs initialization relm gwo fivs initialization and the svr gwo fivs initialization were 0 85 and 0 86 respectively and the nses produced by the knn gwo fivs initialization grnn gwo fivs initialization and mlr gwo fivs initialization were 0 726 0 723 and 0 739 respectively the maes yielded by the relm gwo fivs initialization and svr gwo fivs initialization were 5 59 m3 s and 5 28 m3 s respectively and the maes yielded by the knn gwo fivs initialization grnn gwo fivs initialization and mlr gwo fivs initialization were 7 24 m3 s 7 21 m3 s and 9 09 m3 s respectively second for several wrapper methods the rmses maes and nses were inferior to those of the regression method with fivs and no ivs for example at station 13 340 000 using bffv the rmse of the relm pso random initialization was 126 84 m3 s and the rmses of the relm with mi and the relm with no ivs in table 9 were 112 25 m3 s and 119 38 m3 s respectively as for the maes the relm pso random initialization was 82 45 m3 s and the relm with mi and the relm with no ivs in table 9 were 66 45 m3 s and 78 83 m3 s respectively third at three stations the best nses maes and rmses obtained by avfv and the best nses maes and rmses obtained by bffv were similar for example at station 13340000 the best nse of bffv and the best nse of avfv were 0 88 based on the relm gwo random initialization and 0 879 based on the relm gwo fivs initialization the lowest mae of bffv and the lowest mae of avfv were 58 46 m3 s based on the relm ssa fivs initialization and 55 60 m3 s based on the relm gwo fivs initialization fourth at three stations the worst nses maes and rmses of avfv were superior to those of bffv for example at station 06191500 the worst nse of bffv and the worst nse of avfv were 0 759 based on the knn ssa random initialization and 0 807 based on the knn pso random initialization the worst mae of bffv and the worst mae of avfv were 35 86 m3 s based on the mlr ba random initialization and 30 65 m3 s based on the mlr woa two stage 4 4 comparison of the accuracies of the typical models using a hypothesis test based on a comparison of the results in section 4 3 the relm based wrappers that use avfv the gwo and the fivs initialization relm avfv gwo fivs initialization appear to be the best choices in this study however in some cases the best nses maes and rmses were yielded by other models and these values were only slightly better than those obtained with the relm avfv gwo fivs initialization model for instance at station 06191500 the best nse was 0 91 obtained with the svr avfv ba fivs initialization model while the relm avfv gwo fivs initialization model yielded an nse of 0 90 the lowest mae was 15 24 m3 s produced by svr avfv ssa ffs initializing while the relm avfv gwo fivs initialization model yielded an mae of 18 28 m3 s additionally at station 06191500 the nse of 0 90 produced by the svr using pci pci svr in table 7 was equal to the nse achieved by the relm avfv gwo fivs initialization model to determine whether these differences were significant in this study sign tests were performed for validation table 10 provides the results of the sign test for these typical models it is apparent that the performance of the compared wrappers displays no obvious differences at stations 06 191 500 and 12266500 however a large difference exists between the forecasted values of the compared wrapper and pci svr at station 06191500 4 5 selected variables to investigate the differences in the variables selected by the studied data driven models the variables selected by the examined fivs methods and the studied wrappers that achieved the best fitness results for the training set are displayed figs 17 and 18 a comparison of the results in figs 17 and 18 yields three notable characteristics first the selected variables by the wrappers and the fivs methods differed within the same studied catchment second the best mlr based knn based grnn based and svr based wrappers generally selected more variables than the best relm based wrappers third the studied ivs methods generally selected more local weather variables than global climate variables 5 discussion based on the results reported in section 4 the main finding of this study is that the relm avfv gwo fivs initialization is highly recommended for one step monthly streamflow forecasting with local weather and global climate information although the studied catchments have different hydroclimatic and topographic conditions it seems that the recommended model performs well regardless of the characteristics of the catchment this conclusion is supported by the fact that the recommended model showed the best performance in all three catchments 5 1 correlations among variables with respect to the correlations among variables the correlation analysis of the streamflow and the 132 candidate input variables in fig 5 suggests that all candidate input variables are associated with streamflow in the context of the mic values this finding does not agree with the results of ren et al ren et al 2020 who found that the correlation values of some candidate input variables were almost equal to zero when using the lc and mi this difference can be attributed to the fact that the mic is a more generalized correlation metric than the lc or mi in addition the results of correlation and autocorrelation in figs 6 and 7 indicate that there were strong correlations among the candidate input variables this result shows that there is redundant information provided by the candidate input variables therefore ivs should be performed galelli et al 2014 5 2 comparison of the models for the five machine learning algorithms examined in the studied cases the corresponding wrappers behaved differently in the training set and the testing set section 4 3 notably overfitting which often occurs when wrapper methods are used galelli et al 2014 was observed for the grnn based wrappers moreover underfitting occurred for the knn based wrappers and mlr based wrappers because of their unsatisfactory performance for both the training and testing sets additionally although relm based wrappers displayed relatively poor performance for the training set their performance for the testing set and in the hypothesis test in section 4 4 was excellent and supported the use of the relm in addition the svr based wrappers displayed a relatively stable performance for both the training and testing sets therefore we are also inclined to choose the svr as an alternative to the relm in practice notably both the relm and svr algorithms involve regularization methods we speculate that this step may be the reason for the absence of overfitting to the best of our knowledge no previous studies have compared wrappers using these learning algorithms although some previous studies e g ahani et al 2018 modaresi et al 2018 compared different machine learning algorithms for monthly streamflow forecasting they did not consider wivs therefore it is recommended that when conducting wivs for streamflow forecasting with local weather information and global climate indices machine learning algorithms with regularization methods should be used for the binary metaheuristic algorithms used the results in section 4 3 show that the gwo was the best choice in practice specifically this algorithm had the best search capability for the training set and no parameters need to be preset too et al 2018 although using other binary metaheuristic algorithms could yield better performance for the testing set than using the gwo in some cases no stable trends could be established notably this is the first investigation of these metaheuristic algorithms for wivs in streamflow forecasting our findings indicate that some new binary metaheuristic algorithms for wivs could be superior to the relatively old algorithms such as ga and pso which were used in previous studies for wivs in streamflow forecasting therefore there seems to be potential for future research to develop new binary metaheuristic algorithms for wivs to improve streamflow forecasting of the two methods for obtaining final forecasted values avfv was selected as the ideal choice in practice based on two specific findings first the results in section 4 3 and the hypothesis test results in section 4 4 show that the best performance was achieved by the models that use avfv second the worst nses and rmses for the models that use avfv were superior to those of the models based on bffv in fact avfv is a type of ensemble learning algorithm that results in better performance than bffv this is consistent with the fact that ensemble models are generally superior to single models kourentzes et al 2014 the two methods of combined fivs were superior to random initialization this finding confirms the conclusion of previous studies that combining filters and wrappers could be beneficial e g hu et al 2015 solorio fernández et al 2016 in the studied cases the best forecasting performance was achieved by the models with fivs initialization and support with fivs initialization should be employed however these results may be affected by the fivs method used an important objective for future studies is to determine which fivs approach should be selected based on the performance levels of the wrappers and benchmark models the relm avfv gwo fivs initialization displays outstanding performance however some models based on wivs were inferior to some models based on fivs this important result emphasizes that if an appropriate wivs is not adopted in practice for streamflow forecasting then a result superior to that achieved with fivs may not be obtained despite the consideration of the interactions and dependencies between the variables additionally the machine learning algorithms that use pci with the hampel test are superior to other benchmark models this result is similar to the findings of ren et al ren et al 2020 importantly it is necessary to mention the unexpected results specifically the performance of the models driven by several ivs methods including both fivs and wivs methods was not as good as the performance of the univariate sarima method which only used the variables of streamflow lags and models with no ivs in some cases it can be speculated that these results are attributed to the inappropriate ivs methods used this finding underscores that it is important to carefully choose the ivs method for adding or removing variables in streamflow forecasting all of the above results agree with the viewpoint that ivs is important for data driven models e g quilty and adamowski 2018 5 3 selected variables the physical factors that underlie the candidate variables are based on the conclusions presented in previous studies e g piechota et al 2001 robertson and wang 2012 sun et al 2014 these studies indicate that two types of information namely the initial states of the catchment and the climate conditions in the forecasting step are key to streamflow forecasting in this study the initial states of the catchment can be represented by the selected variables among the lags in local weather information and streamflow while the climate conditions in the forecasting step are influenced by the selected variables among the antecedent global climate indices from a physical perspective the differences in the selected variables for the studied three catchments can be caused by two reasons first different characteristics in the selected catchments would result in different sensitivities of the catchments to local weather conditions and antecedent streamflow second the impact of climate indices for a catchment is regionally dependent kalra et al 2013 sun et al 2014 which results in differences in the selected variables of global climate indices regarding the selected variables by the wrappers in a catchment listed in fig 18 the difference in the selected variables is likely due to the mechanisms adopted by these wivs algorithms importantly common variables and unique variables are observed among the variable sets selected by these different wivs algorithms in a catchment for the unique variables set they can only be considered to be useful for one data driven model but not for another thus they cannot be used to interpret physical factors by contrast the common variables because of their generality can more reasonably be used to interpret physical factors therefore we believe that the selected variables in the wivs models will not be able to completely explain the physical factors which can be attributed to the black box nature of these models the parsimony property of the selected variables by the best relm based wrappers should be emphasized because a greater number of selected variables increases the difficulty of explaining the model therefore the best relm based wrappers are preferred additionally the development of a parsimonious variables set when using wrappers based on the mlr knn grnn and svr e g sanz garcia et al 2015 was not examined in this study however it represents a worthwhile endeavor and should receive extensive attention in future research as for the importance of the variables local weather information seems to be more important than global climate information for one step monthly streamflow forecasting however global climate information can complement local weather information this result was supported by two findings first the best wrappers and the fivs methods selected more local weather variables than global climate variables figs 17 and 18 second the correlations between global climate information and streamflow were lower in terms of the mic than the correlations between local weather information and streamflow fig 5 notably for multi step monthly streamflow forecasting the role of the variables might be different relative to that for one step forecasting because the antecedent global climate indices might be able to provide more information for multi step forecasting compared with the lags in local weather information therefore the sensitivity of the two groups of variables for forecasting multi step monthly streamflow should be investigated and the number of steps that can be used in the proposed data driven models to forecast monthly streamflow should be determined importantly an interesting characteristic is that although there is redundant information among all candidate variables the gap between the performance of models with no ivs using all candidate variables and the performance of the best examined models does not have a large difference in addition the univariate sarima models which only contained the more important variables of streamflow lags could outperform some models that use ivs these two points lead us to speculate that it seems to be more important to include more influential variables in the model than to remove redundant variables this is similar to the conclusion of sachindra and kanae sachindra and kanae 2019 5 4 limitations several limitations might have influenced the findings obtained in this study first of the potential factors that impact streamflow climate change and human activities are not considered in this study in general the assumption that underlies the studied data driven models is that the distribution and the relation of the data remain unchanged all the time no matter the past or future however this assumption might be broken by these two mentioned factors botter et al 2013 sivapalan et al 2011 second the search capacity of pso ba and ga could be affected by the parameters used sengupta et al 2018 these factors are not examined in this study notably these three algorithms with specific settings for parameters might perform better than the gwo therefore a detailed investigation for the sensitivity of these algorithms in parameter setting should be performed in the future in addition the performance of these binary metaheuristic algorithms except for ga is also affected by the transformation function used mirjalili and lewis 2013 this issue is another important topic for future research third watersheds with other hydroclimate conditions may have different results based on the experimental setup used in this study thus our findings should be validated in more watersheds 6 conclusion in this study binary metaheuristic based shallow machine learning wrappers for one step monthly streamflow forecasting that use local weather information and global climate indices were applied and assessed the algorithms for wivs included eight binary metaheuristic algorithms and five commonly used shallow machine learning algorithms in addition two methods of combined fivs and two methods of obtaining the final forecasting values for the proposed wrappers were explored furthermore to explore the correlations among the variables the mic was employed this is the first study to perform detailed research on binary metaheuristic based wivs for one step monthly streamflow forecasting based on experiments involving three watersheds with different hydroclimatic conditions the principal conclusions can be summarized as follows 1 in the validated models in this study a number of models based on wivs were inferior to some models based on fivs the performance of the models driven by some ivs methods including both fivs and wivs methods was not as good as the performance of the univariate sarima method and models with no ivs this finding suggests that it is essential to choose the appropriate ivs method for one step monthly streamflow forecasting in practice 2 the relm avfv gwo fivs initialization wrapper which combines the use of a regularized learning algorithm an ensemble forecasting method the best searching metaheuristic algorithm and fivs is highly recommended for one step monthly streamflow forecasting with local weather information and global climate indices 3 all 132 candidate input variables including local weather and global climate indices are related to streamflow in terms of the mic and there were strong correlations among the 132 candidate input variables local weather information seems to be more important than global climate indices but global climate indices can be complementary to local weather information for one step monthly streamflow forecasting credit authorship contribution statement kun ren conceptualization methodology software writing original draft writing review editing xue wang writing review editing supervision validation funding acquisition xiaoyu shi data curation investigation jihong qu visualization methodology resources wei fang writing review editing methodology declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was financially supported by the doctoral research fund of the north china university of water resources and electric power china 40464 the authors would also like to thank the anonymous reviewers and the editor for their comments which have substantially improved the quality of this paper 
4585,the use of data driven models to forecast streamflow has received substantial attention from scholars in recent years however systematic studies have not been performed to examine binary metaheuristic wrapper based input variable selection bmwivs in real world streamflow forecasting in this study we explored binary metaheuristic based shallow machine learning wrappers for one step monthly streamflow forecasting using local weather information and global climate indices from three catchments with different hydroclimatic conditions first the maximal information coefficient mic was employed to investigate the correlations among the forecasting target streamflow and candidate input variables which included both local and global climate information then the bmwivs models obtained by combining eight binary metaheuristic algorithms five commonly used shallow machine learning algorithms two combined filter based input variable selection fivs methods and two forecasting methods were examined finally the performance of each model was compared with the performance of typical benchmark models including the univariate seasonal autoregressive integrated moving average model five machine learning algorithms with no input variable selection and five machine learning algorithms that use five different fivs methods the experimental results emphasized three significant findings first an appropriate input variable selection method should be selected in practice because several examined wrappers were inferior to the benchmark models second the bmwivs model that combined the regularized extreme learning machine method binary gray wolf optimizer fivs results based initialization method and forecasted values averaged over multiple runs yielded the best performance in the three cases studied third the correlations in terms of the mic between the global climate indices and streamflow were lower than those between local weather information and streamflow and the best wrapper and fivs would select more local weather information variables than global climate index variables which suggests that global climate information can be complementary to local weather information for one step monthly streamflow forecasting these findings have remarkable practical applications for forecasting monthly streamflow keywords streamflow forecasting input variable selection binary metaheuristic algorithm wrapper method machine learning 1 introduction streamflow forecasting is important for the defense of floods droughts early warning water resource distribution urban water management and water quality management sun et al 2014 therefore it is essential to accurately and precisely forecast streamflow and researchers have developed various models for streamflow forecasting e g fang et al 2019 huang et al 2014 streamflow forecasting models can be classified into two categories in terms of whether physical mechanisms are involved shoaib et al 2016 one category is theory driven models and the other category is data driven models in which no physical mechanisms are considered theory driven models include conceptual models e g aubert et al 2003 nash and sutcliffe 1970 and distributed hydrological models e g refsgaard 1997 yoshitani et al 2009 and data driven models include classical time series models e g jayawardena and lai 1994 maceira et al 1999 and artificial intelligence based models e g liu et al 2014 mahmood al juboori and guven 2016 osman et al 2020 sun et al 2014 in the last decade developing data driven models to forecast streamflow has gained increasing attention by researchers due to the flexibility and accessibility of these models e g chang et al 2020 kao et al 2020 such models involve various shallow machine learning and deep neural network algorithms such as multivariate adaptive regression splines e g adnan et al 2019 extreme gradient boosting e g yu et al 2020 extreme learning machine e g yaseen et al 2016 and deep belief network e g chu et al 2020 additionally various decomposition based models such as seasonal and trend decomposition based models e g luo et al 2019 wavelet decomposition based models e g shiri and kisi 2010 and variational mode decomposition based models e g zuo et al 2020 have been employed for streamflow forecasting developing a data driven model conventionally involves four procedures namely data processing and transformation input variable selection ivs model deployment and model assessment yaseen et al 2019 2018 among these procedures ivs is a crucial step chandrashekar and sahin 2014 there are two important impacts of ivs first ivs can decrease the complexity and computational burden of the model second ivs can increase the performance of the model because most machine learning algorithms exhibit a decrease in accuracy when irrelevant and redundant variables are incorporated into these algorithms galelli et al 2014 may et al 2011 based on whether a learning algorithm is employed ivs methods have been generally classified into three main types namely filter based wrapper based and embedded based methods blum and langley 1997 filter based ivs fivs methods are independent of the learning algorithm and select input variables by ranking the variables through statistical measures wang et al 2010 both wrapper based ivs wivs methods and embedded based ivs methods in which a learning algorithm is involved use model performance to filter the variable subset chandrashekar and sahin 2014 kohavi and john 1997 these three types of ivs methods have both advantages and disadvantages typically fivs has the advantage of high computational efficiency both the wivs and the embedded based ivs methods suffer from a high computational burden but yield better performance than fivs methods may et al 2011 streamflow which is affected by many factors has very complex evolution and formation mechanisms yaseen et al 2015 therefore when using data driven models to forecast streamflow there are many potential factors that should be noted the frequently used potential factors to drive these models are local weather information e g temperature evaporation precipitation moisture of soil and humidity and global climatic indices e g the pacific decadal oscillation pdo and the north atlantic oscillation nao e g behzad et al 2009 kagoda et al 2010 li et al 2010 makkeasorn et al 2008 noori et al 2011 rasouli et al 2012 sharma et al 2015 thus two important issues should be considered in practice first the dimension of the candidate input variables might be high second the correlations among the variables are not known in advance as a result when applying data driven models in streamflow forecasting it is necessary to perform ivs e g quilty and adamowski 2018 to date various ivs methods have been utilized to select the most informative variables for streamflow forecasting these methods involve the abovementioned three types of ivs namely fivs li et al 2010 liu et al 2014 noori et al 2011 wivs afan et al 2020 dariane and azimi 2016 qu et al 2021 and embedded based ivs chu et al 2020 for example ren et al ren et al 2020 compared eight fivs methods when using data driven models to forecast one step monthly streamflow taormina and chau taormina and chau 2015a proposed a wrapper based rainfall runoff model using extreme learning machine elm however to the best of our knowledge there have been no systematic studies of binary metaheuristic based wivs in real world streamflow forecasting using both local weather and global climate indices three aspects of this research gap should be noted first for wivs two essential factors specifically the search strategy and the learning algorithm el aboudi and benhlima 2016 have not been comprehensively examined in the field of streamflow forecasting for the search strategy previous studies mainly used relatively old metaheuristic algorithms such as particle swarm optimization pso and genetic algorithms gas for the learning algorithm previous studies mainly focused on artificial neural networks anns afan et al 2020 taormina et al 2015 taormina and chau 2015a 2015b novel metaheuristic search strategies such as the moth flame optimization mfo chen et al 2019 and routine learning algorithms such as support vector regression svr have not been applied second few studies considered hybrid filter wrapper ivs e g hu et al 2015 which is an important complementary form of wivs in streamflow forecasting third the candidate input variables including both local weather and global climate variables often encountered in practice were not considered in the previous wivs models for streamflow forecasting the primary aim of this study is to develop a detailed analysis of binary metaheuristic based wivs in streamflow forecasting specifically our work focuses on three perspectives that were not considered in previous studies first we investigate the performance of wivs by combining eight binary metaheuristic search algorithms and five commonly used shallow machining algorithms for one step monthly streamflow forecasting using local weather information and global climate indices second two combined fivs methods and two final forecasting methods are assessed for the proposed binary metaheuristic based wivs models third we investigate the correlations among the candidate variables and the streamflow using the maximal information coefficient mic recently proposed by reshef et al reshef et al 2011 and discuss the variables selected by the models in the remainder of this paper section 2 describes the studied catchments local weather information used and global climate indices used in section 3 we present the mic the binary metaheuristic algorithms used five shallow machine learning algorithms the proposed binary metaheuristic based shallow machine learning wrappers the evaluation criteria for the models and the experimental setup used section 4 gives the study results and section 5 presents the discussion conclusions are drawn in section 6 2 study areas and data three catchments in the united states with dissimilar hydroclimatic conditions and relatively low levels of human activity were selected as study areas for two main reasons first the performance of data driven models was evaluated under different conditions as in previous studies e g ren et al 2020 sun et al 2014 second the impact of human activities which is a driving factor of streamflow forecasting that was not considered in previous studies e g erdal and karakurt 2013 huang et al 2014 kisi and cimen 2011 could be considered negligible due to the minimal disturbances in the selected areas newman et al 2015 fig 1 shows the locations of these catchments the gauge id gauge name catchment area and climate characteristics are presented in table 1 the studied monthly streamflow series m3 s from january 1980 to december 2014 and the autocorrelograms in terms of the mic are shown in fig 2 notably all the streamflow series have strong seasonality which is a typical characteristic of monthly streamflow dettinger and diaz 2000 shortridge et al 2016 wang et al 2011 for the candidate local weather information we considered 12 month lags 1 to 12 monthly lags for the five driving factors including the mean daily precipitation in a month mean daily solar radiation sr in a month mean daily minimum temperature in a month mean daily maximum temperature in a month and mean daily vapor pressure vp in a month for the candidate global climate indices referring to ren et al ren et al 2020 fang et al fang et al 2018 and rasouli et al rasouli et al 2012 the 12 month lags for five indices namely the niño 3 4 the pacific north american pna the arctic oscillation ao the nao and the pdo were considered additionally 12 month lags in streamflow were added to the candidate input variable set which resulted in 132 candidate input variables the data from the above streamflow series and local weather information for the three cases were extracted from the publicly available camels data set addor et al 2017 newman et al 2015 which includes data for 671 small to medium sized basins in the united states the five global climate indices used were acquired from https www esrl noaa gov psd data climateindices list all the samples 408 were split into a training set and a testing set at a ratio of 7 3 the training set included 285 samples and the testing set included 123 samples descriptive information for the studied streamflow is displayed in table 2 to unify the scale for different dimensions of the variables hadi and tombul 2018 according to eq 1 every variable in both the training set and testing set was preprocessed into the interval of 0 1 1 x x x min x max x min where x denotes the time series of the selected variable in the full data set xmin represents the minimum value of the selected variable in the training set and xmax is the maximum value of the selected variable in the training set notably three error criteria section 3 5 were estimated based on the back transformed variables after the forecasting was conducted with the data driven models 3 methods the flow diagram for our study is described in fig 3 first all 132 candidate variables were included in a correlation analysis using the mic second binary metaheuristic based shallow machine learning wrappers were built based on eight selected binary metaheuristic algorithms five shallow machine learning algorithms two methods of final forecasting and two methods of combined fivs finally the results were analyzed 3 1 maximal information coefficient the mic which was proposed by reshef et al reshef et al 2011 is an information theory based measure of association it not only can reflect the linear and nonlinear relationships among variables but also encompasses the nonfunctional dependence relationships among variables therefore the mic has received widespread attention in recent years ge et al 2016 liang et al 2018 lyu et al 2017 the main concept of the mic is that if there are correlations among variables the data distribution in a grid can reflect the correlations according to the grid division result the mic is calculated based on mutual information and grid partitioning to calculate the mic between two variables x and y the following three steps are involved 1 at the given grid resolution a two dimensional scatterplot based on x and y is divided according to different partitioning schemes then the value of mutual information in each grid is calculated 2 the value of maximum mutual information among the different partitioning schemes is retrieved and normalized to the range of 0 1 3 the grid resolution is then changed and steps 1 and 2 are repeated the maximum value of the normalized mutual information at different scales is the mic the formula for calculating the mic is shown in eq 2 2 m i c d max xy b n i d x y l o g min x y where n stands for the sample size b is a function related to n and reshef et al reshef et al 2011 suggest b n n0 6 i d x y denotes the maximum value of mutual information in grid area d when the value of the mic is equal to zero the two variables considered are uncorrelated when the value of the mic is greater than zero there is a correlation between the two variables when the value of the mic is higher the correlation between the two variables is stronger 3 2 eight binary metaheuristic algorithms in wivs when the dimensionality of the candidate variables is high the selection of an optimal set of variables is a nondeterministic polynomial np problem iguyon and elisseeff 2003 to solve this problem various search strategies including forward selection ververidis and kotropoulos 2008 stepwise selection park et al 2008 backward elimination vu et al 2015 and metaheuristic searches oreski and oreski 2014 are frequently used among these search strategies metaheuristic based methods have recently received considerable attention due to their efficiency and global search potential diao and shen 2015 yusta 2009 a metaheuristic based ivs method was used to solve an ivs problem by treating it as a 0 1 optimization problem xue et al 2016 therefore continuous metaheuristic based algorithms need to be transformed to their binary version by a transition function emary et al 2016 in this study the effectiveness of eight binary metaheuristic based algorithms table 3 for wrapper based data driven models of one step monthly streamflow forecasting was examined and compared of these eight algorithms binary pso mirjalili and lewis 2013 and binary ga siedlecki and sklansky 1989 have often been applied to ivs in streamflow forecasting afan et al 2020 dariane and azimi 2016 taormina et al 2015 taormina and chau 2015a 2015b relatively new algorithms including the binary bat algorithm ba mirjalili et al 2014 binary gray wolf optimizer gwo emary et al 2016 binary salp swarm algorithm ssa faris et al 2018 binary dragonfly algorithm da mirjalili 2016 binary whale optimization algorithm woa hussien et al 2020 and binary mfo chen et al 2019 are seldom utilized in the field of hydrology for ivs 3 3 five shallow machine learning algorithms five shallow machine learning algorithms including multiple linear regression mlp regularized extreme learning machine relm svr k nearest neighbor regression knn and generalized regression neural network grnn were selected for comparison table 4 these algorithms are routinely used in the field of hydrological forecasting e g cigizoglu 2005 eskandarin et al 2010 latt and wittenberg 2014 noori et al 2011 taormina and chau 2015a detailed descriptions of the algorithms can be obtained from the corresponding references breiman and friedman 1997 deng et al 2009 dudani 1976 smola and schölkopf 2004 specht 1991 3 4 proposed binary metaheuristic based shallow machine learning wrappers iguyon and elisseeff iguyon and elisseeff 2003 summarized three important points for ivs first presumably redundant variables can be beneficial for the model second it is not possible to determine which combination of variables produces the best performance by scoring the variables separately third two variables that are ineffective individually may be effective when combined therefore compared with fivs wivs can provide better performance in many cases el aboudi and benhlima 2016 furthermore it is reported that forecasting accuracy can be improved by using a particular combination of hyperparameters in machine learning algorithms and the candidate input variables chen and chang 2009 taormina and chau 2015a consequently in this study we implemented binary metaheuristic algorithms to simultaneously optimize the selection of the input variables and hyperparameters in the machine learning algorithms 3 4 1 solution representation the solution representation for individuals in the proposed binary metaheuristic based shallow machine learning wrappers is shown in fig 4 each individual consisted of two parts a variable part to be selected and a hyperparameter part to be adjusted for the variable part if the value at a position presents 1 then the variable that corresponds to this position is selected as an input variable when the value at a position presents 0 the variable that corresponds to this position is rejected the hyperparameter part is a binary encoding representation of the hyperparameters in the corresponding shallow machine learning algorithms notably when these machine learning algorithms were applied the binary values in this part were back transformed into the actual representations of the hyperparameters 3 4 2 two methods for obtaining final forecasting values the method most commonly used to initialize the conditions of binary metaheuristic based wrappers is random initialization which is referred to as the random initialization method in this paper e g faris et al 2020 however a difference in initial conditions can result in variations in the final model li et al 2020 to evaluate the performance of the model we ran it multiple times with initial conditions based on different random seeds e g too et al 2019 there are two methods of obtaining final forecasting values in the first method the model with the best fitness in the training set among the models from multiple runs is the selected model then the final forecasting values in the testing set are determined using this selected model in the second method the forecasted values in the testing set are determined by all the models from multiple runs in the training set the final forecasting values are the means of these forecasted values in this study both methods were explored for brevity the first method is denoted as bffv and the second method is denoted as avfv 3 4 3 two methods of combined filter based input variable selection in the past few years to take advantage of the benefits of both fivs and wivs hybrid filter wrapper ivs has been proposed and applied in many fields hu et al 2015 solorio fernández et al 2016 there are two typical methods among the various hybrid filter wrapper ivs approaches in the first method some initial conditions of wivs are initialized based on the results of fivs which is referred to as the fivs initialization method in this paper e g apolloni et al 2016 the second method has two stages which is referred to as the two stage method in this paper e g akadi et al 2011 in the first stage fivs is performed and the candidate variable set is reduced based on the results of fivs in the second stage wivs is performed on the variable set obtained in the first stage a remarkable difference between the two methods is that when performing wivs the candidate variables in the first method are the original 132 variables while the candidate variables in the second method are the results of fivs from the 132 variables in this study the above two commonly applied methods of hybrid filter wrapper ivs were investigated specifically we selected five typical fivs methods galelli et al 2014 may et al 2008 quilty et al 2016 vergara and estévez 2014 zou et al 2003 to combine with the wrappers table 5 in the fivs initialization method the ivs results of the five fivs methods are utilized to initialize the variable parts of the wrappers and the hyperparameter parts of the wrappers are initialized with the binary representations of the hyperparameters which are adjusted in the training set using corresponding shallow machine learning algorithms in section 3 3 coupled with the corresponding fivs approach in the two stage method we selected the union set of the results of the five fivs methods as the result of the first stage then in the second stage wivs was performed based on the results of the first stage 3 5 evaluation criteria for the models in this study three error criteria namely the nash sutcliffe efficiency nse mean absolute error mae and root mean square error rmse were considered the formulas of these three criteria are shown in eqs 3 5 3 nse 1 i 1 n q i q i 2 i 1 n q i q 2 4 rmse i 1 n q i q i 2 n 5 mae 1 n i 1 n q i q i where q i is the monitored streamflow q represents the average q i q i is the forecasted streamflow q denotes the average q i and n stands for the number of samples used the rmse is employed to estimate the average deviation between the observed value and the forecasted value the nse which ranges from to 1 indicates the predictive accuracy of the hydrological model the mean deviation between the observed value and the forecasted value is estimated using the mae in the field of streamflow forecasting these three criteria are routinely applied to evaluate the performance of models e g cheng et al 2020 erdal and karakurt 2013 sun et al 2014 in addition to the above four criteria the number of selected variables nsv was regarded as an important criterion for the data driven models in this study in general the objective was to obtain a model with maximum accuracy and the minimum nsv which results in a model with excellent prediction performance and a high level of interpretability faris et al 2018 sanz garcia et al 2015 xue et al 2016 furthermore the sign test dixon and mood 1946 was applied to determine whether the differences in the predictive accuracies of different models were significant diebold and mariano 1995 detailed information for the sign test was provided by diebold and mariano diebold and mariano 1995 3 6 experimental setup to test the effectiveness of the proposed wrappers the univariate seasonal autoregressive integrated moving average sarima method five machine learning algorithms with no ivs and five machine learning algorithms using the selected fivs methods table 5 with the hampel test may et al 2008 were selected as the benchmark models the sarima models were performed by the function auto arima in the forecast package hyndman and khandakar 2008 to determine the parameters the relm was adjusted with respect to the number of hidden nodes from 1 to 256 the active function including sigmoid sine purelin and radial basis and the regularization coefficient 2 8 2 7 26 27 as for the hyperparameters in the svr the radial basis function kernel was selected a grid search was performed for the penalty parameter 2 8 2 7 27 the radius of the insensitive tube 0 0 1 0 2 and 0 3 and the kernel parameters 2 8 2 7 27 using libsvm chang and lin 2011 the only hyperparameter in the knn method k the number of nearest neighbors was adjusted from 1 to 32 and inverse distance weighted averaging algorithms were used to obtain the results for the grnn the spread of the radial basis functions was adjusted within a predetermined range 2 6 5 2 6 2 5 5 21 for all eight binary metaheuristic algorithms the size of the population and the maximum number of iterations were set to 20 and 200 respectively for the pso the linear decreasing inertia weight strategy was selected the maximum inertia weight and minimum inertia weight were set to 0 9 and 0 4 respectively the acceleration coefficient was set to 2 and the velocity of the particle was constricted to range 6 6 too et al 2019 for the ga the crossover rate was fixed to 0 8 the mutation rate was fixed to 0 01 too et al 2019 and the roulette wheel selection and double point crossover were employed for the ba the loudness and pulse rate were fixed to 0 25 and 0 1 respectively in addition the binary gwo method used in the study was implemented according to algorithm 2 as described by emary et al emary et al 2016 we set a fixed initial seed when using the relm to ensure the consistency and repeatability of all of the experiments because a difference in the initial solutions for the binary metaheuristic based wrappers could result in various results to compare the performances of the proposed wrappers we performed 20 runs for these wrappers with different random seeds when the wrappers were trained the training set was resampled with a holdout percentage of 30 the fitness values of the wrappers were equal to the rmses that were estimated over the samples that were not resampled in the training set when training the selected machine learning algorithms using fivs we used the same resampling method as above to adjust the hyperparameters pmi and pci were executed using r scripts obtained from https github com gbhumphrey1 pmis pcis the mic calculation was based on the minepy library with default parameters albanese et al 2013 we used the information theoretical estimators ite toolbox szabó 2014 to program mi and cmi according to a method of nonparametric multivariate edgeworth expansion 4 results 4 1 correlations among variables to explore the correlations between all candidate input variables and the streamflow we quantified these correlations in terms of the mic for the three studied cases fig 5 three obvious characteristics can be seen in fig 5 first for all studied cases all candidate input variables are related to the dependent variable namely streamflow in terms of the mic and the resulting values range from approximately 0 15 to 0 84 second the degree of the correlation varied in the three studied catchments for example at station 06191500 the fifth lag in vp displayed an mic value of 0 75 for streamflow while the mic value was 0 21 at station 06191500 third compared to the candidate input variables of the global climate indices most of the candidate input variables associated with the local weather information have stronger correlations with streamflow and the most relevant variables are the candidate input variables that correspond to local weather information for example at station 11266500 the first two most relevant variables in terms of the mic are the first lag in streamflow and the fifth lag in sr furthermore to examine the correlations among the candidate input variables we determined the correlation between the climate series and the autocorrelation metrics for the studied climate series as shown in figs 6 and 7 respectively the data in fig 6 indicate that there are strong correlations among the local weather information variables except for precipitation in addition a slightly high correlation between ao and nao was observed with an mic value of 0 4173 the autocorrelation of the studied climate series is shown in fig 7 notably there is periodic autocorrelation in the series of local weather information except for precipitation for the global climate indices the pdo and niño 3 4 have stronger autocorrelations for their first few lags than for the other lags and other climate indices have similar correlations for all lags 4 2 performance of the benchmark models the performance of the selected benchmark models including the univariate sarima method and the five machine learning algorithms with the five fivs methods and the hampel test are listed in tables 6 9 for comparison three observations reflected in tables 6 9 should be emphasized first in contrast to the four other fivs methods pci with the hampel test yielded the minimum number of variables in all studied cases second the svr using pci produced the best predictive performance in terms of the nse in all studied cases for the rmse criterion the svr using pci is undoubtedly superior to the other methods at stations 06 191 500 and 13340000 although at station 11266500 the rmse achieved by the svr with pci was not the minimum value it was very close to the minimum obtained by the svr with lc a similar result in terms of the mae was also found at station 13340000 the svr with pci had a comparable mae of 64 91 m3 s with the best mae of 62 51 m3 s achieved by the svr with mi third in some cases when the machine learning algorithms were coupled with fivs to drive the 132 candidate input variables the performance of these methods was inferior to the performance of the univariate sarima and the machine learning algorithms with no ivs for example at station 11266500 the grnn using pmi with the hampel test yielded an nse of 0 59 an rmse of 17 89 m3 s and an mae of 10 32 m3 s the sarima yielded an nse of 0 65 an rmse of 16 57 m3 s and an mae of 7 52 m3 s the grnn with no ivs produced an nse of 0 62 an rmse of 16 99 m3 s and an mae of 8 65 m3 s 4 3 performance of the proposed wrappers to compare the performance of the proposed wrappers for the training set the fitness values and nsvs of the proposed wrappers based on the training set figs 8 10 were investigated figs 8 10 show the boxplots of the fitness values and the nsvs for the proposed wrappers based on the training set at the three studied stations over 20 runs three interesting results can be observed in figs 8 10 first when using the gwo for the wrappers in most cases the distributions of the best fitness values over 20 runs had smaller ranges than those using the other seven binary metaheuristic algorithms in all cases second the nsvs based on fivs initialization and two stage methods were significantly lower than the nsvs based on random initialization in almost all cases third grnn based wrappers and svr based wrappers displayed comparable performance in terms of the distributions of the best fitness values over 20 runs and were superior to the knn based wrappers relm based wrappers and mlr based wrappers to examine the performance of the proposed wrappers based on the testing set the rmses maes and nses for these wrappers for the testing set that use two different methods of obtaining the final forecasted values were calculated figs 11 13 show the rmses maes and nses for the testing set using bffv over all 20 runs the rmses maes and nses for the testing set with avfv over all 20 runs are represented in figs 14 16 the data in figs 11 16 display four notable characteristics first in nearly all situations relm based wrappers and svr based wrappers achieved comparable rmses maes and nses and outperformed the knn based wrappers grnn based wrappers and mlr based wrappers regardless of the binary metaheuristic algorithm used for example when using avfv at station 11266500 the nses produced by the relm with the gwo and fivs initialization relm gwo fivs initialization and the svr gwo fivs initialization were 0 85 and 0 86 respectively and the nses produced by the knn gwo fivs initialization grnn gwo fivs initialization and mlr gwo fivs initialization were 0 726 0 723 and 0 739 respectively the maes yielded by the relm gwo fivs initialization and svr gwo fivs initialization were 5 59 m3 s and 5 28 m3 s respectively and the maes yielded by the knn gwo fivs initialization grnn gwo fivs initialization and mlr gwo fivs initialization were 7 24 m3 s 7 21 m3 s and 9 09 m3 s respectively second for several wrapper methods the rmses maes and nses were inferior to those of the regression method with fivs and no ivs for example at station 13 340 000 using bffv the rmse of the relm pso random initialization was 126 84 m3 s and the rmses of the relm with mi and the relm with no ivs in table 9 were 112 25 m3 s and 119 38 m3 s respectively as for the maes the relm pso random initialization was 82 45 m3 s and the relm with mi and the relm with no ivs in table 9 were 66 45 m3 s and 78 83 m3 s respectively third at three stations the best nses maes and rmses obtained by avfv and the best nses maes and rmses obtained by bffv were similar for example at station 13340000 the best nse of bffv and the best nse of avfv were 0 88 based on the relm gwo random initialization and 0 879 based on the relm gwo fivs initialization the lowest mae of bffv and the lowest mae of avfv were 58 46 m3 s based on the relm ssa fivs initialization and 55 60 m3 s based on the relm gwo fivs initialization fourth at three stations the worst nses maes and rmses of avfv were superior to those of bffv for example at station 06191500 the worst nse of bffv and the worst nse of avfv were 0 759 based on the knn ssa random initialization and 0 807 based on the knn pso random initialization the worst mae of bffv and the worst mae of avfv were 35 86 m3 s based on the mlr ba random initialization and 30 65 m3 s based on the mlr woa two stage 4 4 comparison of the accuracies of the typical models using a hypothesis test based on a comparison of the results in section 4 3 the relm based wrappers that use avfv the gwo and the fivs initialization relm avfv gwo fivs initialization appear to be the best choices in this study however in some cases the best nses maes and rmses were yielded by other models and these values were only slightly better than those obtained with the relm avfv gwo fivs initialization model for instance at station 06191500 the best nse was 0 91 obtained with the svr avfv ba fivs initialization model while the relm avfv gwo fivs initialization model yielded an nse of 0 90 the lowest mae was 15 24 m3 s produced by svr avfv ssa ffs initializing while the relm avfv gwo fivs initialization model yielded an mae of 18 28 m3 s additionally at station 06191500 the nse of 0 90 produced by the svr using pci pci svr in table 7 was equal to the nse achieved by the relm avfv gwo fivs initialization model to determine whether these differences were significant in this study sign tests were performed for validation table 10 provides the results of the sign test for these typical models it is apparent that the performance of the compared wrappers displays no obvious differences at stations 06 191 500 and 12266500 however a large difference exists between the forecasted values of the compared wrapper and pci svr at station 06191500 4 5 selected variables to investigate the differences in the variables selected by the studied data driven models the variables selected by the examined fivs methods and the studied wrappers that achieved the best fitness results for the training set are displayed figs 17 and 18 a comparison of the results in figs 17 and 18 yields three notable characteristics first the selected variables by the wrappers and the fivs methods differed within the same studied catchment second the best mlr based knn based grnn based and svr based wrappers generally selected more variables than the best relm based wrappers third the studied ivs methods generally selected more local weather variables than global climate variables 5 discussion based on the results reported in section 4 the main finding of this study is that the relm avfv gwo fivs initialization is highly recommended for one step monthly streamflow forecasting with local weather and global climate information although the studied catchments have different hydroclimatic and topographic conditions it seems that the recommended model performs well regardless of the characteristics of the catchment this conclusion is supported by the fact that the recommended model showed the best performance in all three catchments 5 1 correlations among variables with respect to the correlations among variables the correlation analysis of the streamflow and the 132 candidate input variables in fig 5 suggests that all candidate input variables are associated with streamflow in the context of the mic values this finding does not agree with the results of ren et al ren et al 2020 who found that the correlation values of some candidate input variables were almost equal to zero when using the lc and mi this difference can be attributed to the fact that the mic is a more generalized correlation metric than the lc or mi in addition the results of correlation and autocorrelation in figs 6 and 7 indicate that there were strong correlations among the candidate input variables this result shows that there is redundant information provided by the candidate input variables therefore ivs should be performed galelli et al 2014 5 2 comparison of the models for the five machine learning algorithms examined in the studied cases the corresponding wrappers behaved differently in the training set and the testing set section 4 3 notably overfitting which often occurs when wrapper methods are used galelli et al 2014 was observed for the grnn based wrappers moreover underfitting occurred for the knn based wrappers and mlr based wrappers because of their unsatisfactory performance for both the training and testing sets additionally although relm based wrappers displayed relatively poor performance for the training set their performance for the testing set and in the hypothesis test in section 4 4 was excellent and supported the use of the relm in addition the svr based wrappers displayed a relatively stable performance for both the training and testing sets therefore we are also inclined to choose the svr as an alternative to the relm in practice notably both the relm and svr algorithms involve regularization methods we speculate that this step may be the reason for the absence of overfitting to the best of our knowledge no previous studies have compared wrappers using these learning algorithms although some previous studies e g ahani et al 2018 modaresi et al 2018 compared different machine learning algorithms for monthly streamflow forecasting they did not consider wivs therefore it is recommended that when conducting wivs for streamflow forecasting with local weather information and global climate indices machine learning algorithms with regularization methods should be used for the binary metaheuristic algorithms used the results in section 4 3 show that the gwo was the best choice in practice specifically this algorithm had the best search capability for the training set and no parameters need to be preset too et al 2018 although using other binary metaheuristic algorithms could yield better performance for the testing set than using the gwo in some cases no stable trends could be established notably this is the first investigation of these metaheuristic algorithms for wivs in streamflow forecasting our findings indicate that some new binary metaheuristic algorithms for wivs could be superior to the relatively old algorithms such as ga and pso which were used in previous studies for wivs in streamflow forecasting therefore there seems to be potential for future research to develop new binary metaheuristic algorithms for wivs to improve streamflow forecasting of the two methods for obtaining final forecasted values avfv was selected as the ideal choice in practice based on two specific findings first the results in section 4 3 and the hypothesis test results in section 4 4 show that the best performance was achieved by the models that use avfv second the worst nses and rmses for the models that use avfv were superior to those of the models based on bffv in fact avfv is a type of ensemble learning algorithm that results in better performance than bffv this is consistent with the fact that ensemble models are generally superior to single models kourentzes et al 2014 the two methods of combined fivs were superior to random initialization this finding confirms the conclusion of previous studies that combining filters and wrappers could be beneficial e g hu et al 2015 solorio fernández et al 2016 in the studied cases the best forecasting performance was achieved by the models with fivs initialization and support with fivs initialization should be employed however these results may be affected by the fivs method used an important objective for future studies is to determine which fivs approach should be selected based on the performance levels of the wrappers and benchmark models the relm avfv gwo fivs initialization displays outstanding performance however some models based on wivs were inferior to some models based on fivs this important result emphasizes that if an appropriate wivs is not adopted in practice for streamflow forecasting then a result superior to that achieved with fivs may not be obtained despite the consideration of the interactions and dependencies between the variables additionally the machine learning algorithms that use pci with the hampel test are superior to other benchmark models this result is similar to the findings of ren et al ren et al 2020 importantly it is necessary to mention the unexpected results specifically the performance of the models driven by several ivs methods including both fivs and wivs methods was not as good as the performance of the univariate sarima method which only used the variables of streamflow lags and models with no ivs in some cases it can be speculated that these results are attributed to the inappropriate ivs methods used this finding underscores that it is important to carefully choose the ivs method for adding or removing variables in streamflow forecasting all of the above results agree with the viewpoint that ivs is important for data driven models e g quilty and adamowski 2018 5 3 selected variables the physical factors that underlie the candidate variables are based on the conclusions presented in previous studies e g piechota et al 2001 robertson and wang 2012 sun et al 2014 these studies indicate that two types of information namely the initial states of the catchment and the climate conditions in the forecasting step are key to streamflow forecasting in this study the initial states of the catchment can be represented by the selected variables among the lags in local weather information and streamflow while the climate conditions in the forecasting step are influenced by the selected variables among the antecedent global climate indices from a physical perspective the differences in the selected variables for the studied three catchments can be caused by two reasons first different characteristics in the selected catchments would result in different sensitivities of the catchments to local weather conditions and antecedent streamflow second the impact of climate indices for a catchment is regionally dependent kalra et al 2013 sun et al 2014 which results in differences in the selected variables of global climate indices regarding the selected variables by the wrappers in a catchment listed in fig 18 the difference in the selected variables is likely due to the mechanisms adopted by these wivs algorithms importantly common variables and unique variables are observed among the variable sets selected by these different wivs algorithms in a catchment for the unique variables set they can only be considered to be useful for one data driven model but not for another thus they cannot be used to interpret physical factors by contrast the common variables because of their generality can more reasonably be used to interpret physical factors therefore we believe that the selected variables in the wivs models will not be able to completely explain the physical factors which can be attributed to the black box nature of these models the parsimony property of the selected variables by the best relm based wrappers should be emphasized because a greater number of selected variables increases the difficulty of explaining the model therefore the best relm based wrappers are preferred additionally the development of a parsimonious variables set when using wrappers based on the mlr knn grnn and svr e g sanz garcia et al 2015 was not examined in this study however it represents a worthwhile endeavor and should receive extensive attention in future research as for the importance of the variables local weather information seems to be more important than global climate information for one step monthly streamflow forecasting however global climate information can complement local weather information this result was supported by two findings first the best wrappers and the fivs methods selected more local weather variables than global climate variables figs 17 and 18 second the correlations between global climate information and streamflow were lower in terms of the mic than the correlations between local weather information and streamflow fig 5 notably for multi step monthly streamflow forecasting the role of the variables might be different relative to that for one step forecasting because the antecedent global climate indices might be able to provide more information for multi step forecasting compared with the lags in local weather information therefore the sensitivity of the two groups of variables for forecasting multi step monthly streamflow should be investigated and the number of steps that can be used in the proposed data driven models to forecast monthly streamflow should be determined importantly an interesting characteristic is that although there is redundant information among all candidate variables the gap between the performance of models with no ivs using all candidate variables and the performance of the best examined models does not have a large difference in addition the univariate sarima models which only contained the more important variables of streamflow lags could outperform some models that use ivs these two points lead us to speculate that it seems to be more important to include more influential variables in the model than to remove redundant variables this is similar to the conclusion of sachindra and kanae sachindra and kanae 2019 5 4 limitations several limitations might have influenced the findings obtained in this study first of the potential factors that impact streamflow climate change and human activities are not considered in this study in general the assumption that underlies the studied data driven models is that the distribution and the relation of the data remain unchanged all the time no matter the past or future however this assumption might be broken by these two mentioned factors botter et al 2013 sivapalan et al 2011 second the search capacity of pso ba and ga could be affected by the parameters used sengupta et al 2018 these factors are not examined in this study notably these three algorithms with specific settings for parameters might perform better than the gwo therefore a detailed investigation for the sensitivity of these algorithms in parameter setting should be performed in the future in addition the performance of these binary metaheuristic algorithms except for ga is also affected by the transformation function used mirjalili and lewis 2013 this issue is another important topic for future research third watersheds with other hydroclimate conditions may have different results based on the experimental setup used in this study thus our findings should be validated in more watersheds 6 conclusion in this study binary metaheuristic based shallow machine learning wrappers for one step monthly streamflow forecasting that use local weather information and global climate indices were applied and assessed the algorithms for wivs included eight binary metaheuristic algorithms and five commonly used shallow machine learning algorithms in addition two methods of combined fivs and two methods of obtaining the final forecasting values for the proposed wrappers were explored furthermore to explore the correlations among the variables the mic was employed this is the first study to perform detailed research on binary metaheuristic based wivs for one step monthly streamflow forecasting based on experiments involving three watersheds with different hydroclimatic conditions the principal conclusions can be summarized as follows 1 in the validated models in this study a number of models based on wivs were inferior to some models based on fivs the performance of the models driven by some ivs methods including both fivs and wivs methods was not as good as the performance of the univariate sarima method and models with no ivs this finding suggests that it is essential to choose the appropriate ivs method for one step monthly streamflow forecasting in practice 2 the relm avfv gwo fivs initialization wrapper which combines the use of a regularized learning algorithm an ensemble forecasting method the best searching metaheuristic algorithm and fivs is highly recommended for one step monthly streamflow forecasting with local weather information and global climate indices 3 all 132 candidate input variables including local weather and global climate indices are related to streamflow in terms of the mic and there were strong correlations among the 132 candidate input variables local weather information seems to be more important than global climate indices but global climate indices can be complementary to local weather information for one step monthly streamflow forecasting credit authorship contribution statement kun ren conceptualization methodology software writing original draft writing review editing xue wang writing review editing supervision validation funding acquisition xiaoyu shi data curation investigation jihong qu visualization methodology resources wei fang writing review editing methodology declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was financially supported by the doctoral research fund of the north china university of water resources and electric power china 40464 the authors would also like to thank the anonymous reviewers and the editor for their comments which have substantially improved the quality of this paper 
4586,sponge city construction in china is integrated with stormwater management infrastructure which is based on the concept of low impact development such that the urban flooding and nonpoint storm pollution are mitigated we hypothesize that an analytic framework based on isochrone and swmm models can be used to simulate and compare the rainfall runoff process before and after sponge city construction and thus assess the performance of the sponge city infrastructure on controlling stormwater outflows in this paper the analytical framework driven by design storms with return periods of 2 5 20 and 30 year was developed and tested in the catchment in fengxi new city china the modeling results were then analyzed with indicators like peak flow rate outflow volume rainfall runoff ratio and stormwater stored due to sponge city construction outflow hydrographs and volume curve analyses showed that the sponge city infrastructure significantly mitigates the risk of stormwater overflows in the catchment and dramatically relieves the pressure on the flood control system of its downstream areas by a firm limit of the peak flow rate also the performance generally decreases as rainstorms become less frequent and more intense we anticipate that the proposed framework provides a practical approach to quantifying the sponge city s response to rainfalls under complex models keywords stormwater management low impact development urban catchment rainfall runoff model loess region fengxi new city 1 introduction urban storm management faces increasing challenges as a result of rapid urbanization and growing extreme rainfalls urbanization increases impervious land cover accelerates and enlarges rainfall runoff transformation and leads to nonpoint source pollution for example the urban population rate of china increases from 10 64 57 65 million in 1949 to 60 6 in 2019 848 43 million and the area of built in land increases from 30406 19 km2 in 2004 to 58455 66 km2 in 2018 national bureau of statistics of china 2019 simultaneously as a sensitive area to global climate change china has increased the frequencies and intensities of extreme storms despite an apparent regional difference driven by the rising temperatures the average annual precipitation in china shows a slight uptrend from 1961 to 2019 whereas the average annual rain days declines significantly indicating more extreme rainfall events cma climate change centre 2020 these changes are anticipated to impact stormwater runoff and water quality miller and hutchins 2017 rapidly collecting and conveying storm to the treatment works before discharging to natural water bodies proves to be an unsatisfactory solution to adapt the land use cover change and rainfall change instead the urban landscape integrated with stormwater management which enhances the future resilience and reduces the urban risks of storm related damages to life and property has become a trend in many cities these days alexander et al 2019 dong et al 2017 china has officially implemented the sponge city construction in 2015 as its national stormwater management countermeasure sponge city infrastructure represents the basic physical and organizational structures and facilities in an urban catchment mainly built to capture and retain stormwater to reduce and delay peak flows improve water quality and utilize rainwater sponge city construction means the construction of sponge city infrastructure aiming to make the flow that leaves the catchment approaches the pre development status with the least cost and sponge city system contains the structural measures i e sponge city infrastructure and the non structural measures for example lids control rules for stormwater control it can be classified into three categories the low impact development lid system the stormwater drainage system and the drainage system for over standard stormwater yang 2017 regarding sponge city and stormwater management previous studies have focused on the design and optimization of lid practices and drainage system eckart et al 2018 jiang et al 2020 li et al 2020 liu et al 2016 rezazadeh helmi et al 2019 xu et al 2018 zhao et al 2018 urban inundation chen et al 2018 jamali et al 2018 wu et al 2017 hydrological modeling jato espino et al 2019 mancipe munoz et al 2014 salvadore et al 2015 stormwater quality management liu et al 2019 flood hazard assessment schubert et al 2017 and so on while these studies provide strong evidence for the impact mechanism performance and benefits of a specific facility or a few systems the overall effect of sponge city infrastructure on stormwater outflows have yet to be quantitatively addressed therefore to answer how well the sponge city infrastructure can control the stormwater and responds to storms a novel framework based on hydrologic hydraulic modeling is developed to simulate and analyze the stormflows one of its key features is reducing many uncertainties and inaccuracies of rainfall runoff simulation for the catchment before sponge city construction by advancing the isochrone technique which is a method used initially in the field of rainfall runoff transformation on the undeveloped catchment it allows a fair estimation of the outflow hydrograph with fewer parameters and data than other models particularly suitable for the simulation before sponge city construction where measured data is often insufficient the second feature is the four criteria proposed for performance assessment of sponge city infrastructure peak flow rate outflow volume rain runoff ratio and stormwater stored due to sponge city construction in this paper we designed storms with varying return periods calculated and compared the resulting outflows of the catchment before and after sponge city construction the results will reference the subsequent planning design construction and management of stormwater facilities in the sponge city this paper is organized as follows the study area and data are given in section 2 a brief introduction to the design rainfall isochrone technique and the swmm model is presented in section 3 section 4 presents the results and discussion from the perspective of four indicators the conclusions are given in section 5 2 study area and data the study area fig 1 c is a newly developed catchment constructed with sponge city facilities since 2015 in fengxi new city located between xi an and xianyang shaanxi province china fig 1a and b as one of the national pilot sponge cities on loess with a temperate continental monsoon semi arid and semi humid climate it was also designated as the global eco hydrology demonstration site by unesco in 2019 its annual average temperature and precipitation are 13 6 and 520 0 mm respectively rainfalls in the wet season july to september account for around 50 of the annual precipitation it covers an area of 22 5 km2 and has an average slope of 1 1 it is covered by a large area of greens and water bodies also the impervious land surfaces with stormwater management facilities like the green corridor 7 0 km long the stormwaters are drained to the weihe river and fenghe river separately because the study area sites at their confluence the design standards of stormwater systems in fengxi new city are as follows 2 year or 3 year return period rainfalls for ordinary downtown areas 3 year to 5 year return period rainfalls for important downtown areas and 10 year to 20 year return period rainfalls for underground passages and sunken squares ministry of housing and urban rural development of the people s republic of china 2016 however many drainage systems in the catchment are designed to handle storms with 1 year or 2 year return periods as a result storm induced inundations frequently occurred due to insufficient drainage capability before 2014 then the sponge city system led by the conception of lid has been constructed in part of the city to build an urban flooding control system that can handle the 30 year return period storms therefore the study area before construction represents an urban catchment with minimal stormwater management features in contrast after sponge city construction it has been a growing urban catchment that integrated with stormwater management infrastructure based on lid facilities such as rain garden permeable pavement planted roof sunken greenbelt bio retention facility dry well wet pond stormwater wetland stormwater barrel retention basin detention pond grassed swale infiltration pipe and trench vegetative filter strip in this paper most catchment data were obtained from the fengxi management committee including sub catchment boundaries ground elevations stormwater infrastructure details water levels and critical sections flow rates for example fig 2 shows the distributions of the catchment s infiltration capacity before and after sponge city construction respectively 3 methods our analytical framework is illustrated in fig 3 first the return periods of design storms were determined by the conditions of the catchment then the catchment s rainfall runoff processes before and after sponge city construction were simulated using the isochrone model and the epa swmm model respectively third indicators such as integrated runoff coefficient peak flow rate runoff volume and rainfall outflow ratio were introduced one thing to be aware of here is that the model runs on a 20 min timescale because the time steps for designing storms isochrone model and swmm model is 5 20 and 10 min respectively 3 1 design storms the outputs of an isochrone swmm model strongly correlate with its inputs one is the data of storm events in this study the depths of design storms with different return periods were estimated using the annual maximum method specifically by fitting a probability distribution to the annual maximum series the formula of intensity frequency duration ifd relationship for storm design in fengxi new city is expressed in eq 1 the chicago rainfall pattern li et al 2018 which is featured by the unimodal process and principle of symmetry and widely used in china was used to redistribute the rainfall amounts of varying return periods besides based on the rainfall and runoff data observed the position coefficient of peak rainfall with a duration of 120 min was set to 0 35 1 i 16 715 1 1 1658 l g t t 16 813 0 9302 where i is the storm intensity mm min t is the return period of rainstorms equals 2 5 20 or 30 year t is the rainstorm duration equals 0 to 120 by 10 min then the volume of rainfall over the catchment is expressed as follows 2 p t i t where p t is the storm depth of the catchment in t minutes mm in this way storms with return periods of 2 5 20 and 30 year which are generally expected to cause urban flooding in the catchment were designed and input into models to simulate stormflows fig 4 a 3 2 runoff calculation before sponge city construction using isochrone model few observed runoff data of the catchment before sponge city construction were collected therefore the isochrone technique time area routing approach a lumped parameter model which can obtain satisfactory results for a catchment ungauged or that has a few data was used hereby to obtain the urban stormflow hydrographs rather than the nonlinear reservoirs method nrm linear reservoirs method lrm and instantaneous unit hydrograph iuh which all require many measured flows data before the calculation the study area was divided into 19 non uniform sub catchments according to outfalls locations as illustrated in fig 5 3 2 1 effective rainfall the stormwater runoff in the catchment has a short duration from dozens of minutes to several hours and consists of large channel flows mostly source from overland flows in impervious areas and small groundwater flows development and construction management committee of xixian new district 2017b thus the volumes of evapotranspiration and ground flow were ignored for simplification as well as the temporal spatial variations of rainfalls the loss rate then turns a constant thereby calculated using the φ index formula dingman 2015 3 φ 1 α p d where φ is the loss rate mm min α is the runoff coefficient p is the total rainfall depth mm d is the duration of rainfall min the effective rainfall of varying return periods fig 4b is calculated as follows h t 0 p t φ p t φ p t φ where h t is the effective rainfall mm p t is the precipitation of duration t mm 3 2 2 concentration time the manning resistance equation shown in eq 5 is used for estimating concentration time 5 u 0 397 n d 2 3 j 1 2 where u is the average flow velocity of stormflows in conduits pipes and channels m s n is the manning roughness coefficient which is proportional to the flow resistance the estimate is 0 013 d is the average diameter of pipes m the estimate is 0 6 j is the bed slope of the catchment the estimate is 0 011 then the formula of concentration time of conduits is 6 t c l 60 u where t c is the concentration time travel time of stormflows in conduits min l is the distance measured along the flow path namely the length from the junction to the outlets of sub catchments m meanwhile the concentration time of overland flow can be calculated by the drainage formula as follows 7 t o 0 703 1 1 α l s 1 2 j 1 3 where t o is the concentration time of overland flow min α is runoff coefficient the estimate is 0 7 l s is the length of the slope the estimate is 0 5568 m the overall concentration time of the catchment can be estimated as follows 8 τ m t c t o where τ is the total concentration time min m is the reduction factor of conduit which equals two in this paper as all cross sections over the study area are pipes rather than open channels 3 2 3 isochrones the assumptions for the isochrone technique are summarized below whereas we refer the reader to the theories and cases discussed by saghafian et al 2002 her and heatwole 2016 and beven 2020 for detailed descriptions the first assumption is that the droplets on an isochrone zone which is defined as the area surrounded by the adjacent time contour lines isochrones of travel time in the catchment based on velocities and the drainage boundary would take the same time to flow to the outlet section another assumption is that an isochrone zone s flow does not interfere with another during the concentration so the effective rainfalls on different isochrone zones flow chronologically to their corresponding outlets therefore the instantaneous flow rate at the outlet section is the sum of instantaneous flow rates of all isochrone zones with the same travel time the catchment s concentration time equals the travel time of the most hydraulically remote sub catchment to the outlet of the catchment the time to equilibrium which is a function of the rainfall intensity and the catchment s characteristics mentioned in section 2 was loosely substituted by the time of concentration in this paper it was divided into many equal time intervals δt namely the travel time difference between adjacent isochrones then the 19 non uniform sub catchments were divided respectively according to the formula τ n δ t the corresponding time area histograms of each sub catchment are shown in fig 6 so the runoff hydrograph of each sub catchment can be generated through discrete convolution of the time area the area of the corresponding time zone and effective rainfall as follows 9 q j k 1 j e k a j k 1 where j is the time step indicator q is the equilibrium discharge rate e is the intensity of effective rainfall a is the drainage area bounded by isochrones note that the time variability in isochrone maps was not considered for simplicity in this paper however the integrated runoff coefficient irc which is obtained by the weighted average method on runoff coefficients of different underlying surfaces table 1 was used to calibrate and verify the modeling results 3 3 runoff calculation after sponge city construction using swmm since sponge city construction in the catchment the land cover use has changed many lid controls and sewer systems were constructed therefore the hydrologic hydraulic swmm version 5 1 updated with a lid toolbox https www epa gov water research storm water management model swmm driven by design rainstorms generated in section 3 1 was employed to model the stormflow dynamics in sewer networks and on overland surfaces after sponge city construction 268 non uniform sub catchments 603 conduits and 25 outfalls illustrated in fig 2 were generalized in the swmm model based on the layout of drainage networks dem and land use data of the study area furthermore the horton s method nonlinear reservoir method and dynamic wave approach rossman 2017 were selected to compute the infiltration losses routing of overland flow and routing of conduits flow respectively the main parameters for sub catchments are area percent of impervious area width slope infiltration parameters manning s roughness coefficients depression storage depth and internal routing parameters these parameters were set based on the reference manual of swmm rossman 2016 the catchment s characteristics and the suggestions by awol et al 2018 eckart et al 2018 behrouz et al 2020 and dai et al 2020 and were altered during the calibration process the modeling was executed by inputting the design storms of multiple return periods into the time series editor selecting each rainfall time series and performing the simulation table 2 shows the key calibrated parameters of the swmm model and a summary of lid characteristics as reported by the development and construction management committee of xixian new district 2017a the model was calibrated with storm events recorded on august 20 13 4 mm in 96 min september 9 16 0 mm in 960 min and september 16 11 4 mm in 780 min in 2017 at the tianfuheyuan court which is a residential area with a storm sewer system consists of 123 sub catchments 47 conduits 49 conduit junctions and two outlets for three storms the nash sutcliffe efficiency liu 2020 of model errors is 0 63 0 84 and 0 76 respectively relative error of peak flow rate is 0 0038 0 1552 and 0 0153 respectively and time to peak error is 6 min 18 min and 4 min respectively therefore the calibrated model represents the hydrological process well also supported by the observed and simulated hydrographs 4 results and discussion results show that the calculation error of the integrated runoff coefficient by the isochrone model is 8 compared with the theoretical value i e the weighted mean of runoff coefficients of each land cover in the catchment and the continuous calculation errors of the surface runoff and flow by swmm are less than 2 meet the error requirements 10 in this section the results generated by the above two models were discussed we analyzed indicators like peak flow rate outflow volume rainfall outflow ratio and stormwater stored within the catchment due to sponge city construction 4 1 peak flow rate the peak flow rate is an essential reference to determine an urban system s total conveyance capacity street flow included during larger storm events and size the sewer systems in developed areas the high peak flow rate will risk infrastructure and people nearby because it challenges the catchment s drainage capacity regarding it our findings are as follows 1 the appearing time of peak flow rate remains unchanged after sponge city construction as shown in fig 7 indicating that the retarding effect of lid facilities on stormflows may be offset by the acceleration effect of newly built drainage networks in contrast the resulting peak flow rates of different return period rainfalls reduce by 69 due to sponge city construction this finding is consistent with the finding of lucas and sample 2015 and guo et al 2019 who discovered that peak flows were reduced by over 53 87 5 by lid implementations 2 although the peak flow rate for rainfall with a return period of 30 year doubled on that of the 2 year no matter the sponge city system was constructed or not the variations in peak flow rates between a pair of rainfalls decrease after sponge city construction fig 8 a for example the variations in the peak flow rate between 2 year and 30 year storms before and after sponge city construction are 124 5 m3 s and 36 9 m3 s respectively like the discussion on the effectiveness of stormwater management structures in alexander et al 2019 the lower variability indicates that the sponge city construction improves the catchment s resilience to intense rainstorms i e mitigates the risk of overflows besides the increase in peak flow rate is linear before sponge city construction while parabolic after construction fig 8b indicating that the peak flow rate after sponge city construction is more sensitive to the rainfall depth of frequent rainfalls 4 2 outflow volume the outflow volume i e the volume of runoff leaving the catchment conveyed through the drainage network is the sum of outflow volumes at the catchment s outfalls 1 for rainstorms with return periods of 2 5 20 and 30 year the reduction rates of outflow volumes due to sponge city are 71 69 65 and 63 respectively fig 9 showing a slight downtrend as the return period of rainstorm increases this finding supports the results of guo et al 2019 on the degrees of outflow volume reduction by lid practices 2 the outflow volumes of rainstorms with a return period of 30 year are more than twice that of 2 year no matter the sponge city system was constructed or not however the outflow volume growths are 0 43 and 0 20 million m3 respectively indicating that a sponge city s downstream area requires lower flood control capacity to handle upstream stormwater outflows 4 3 rainfall outflow ratio as defined in eq 11 the rainfall outflow ratio which is applicable to various land use types alexander et al 2019 was used to ascertain the catchment s capability to absorb and retain flows of stormwater a low value represents that the stormwater is effectively controlled within the catchment 11 ro 0 d q out δ t p where q out is the flow rate exiting the outfalls of the catchment m3 s p is the total volume of the rainfall m3 d is the duration of the rainfall s results show that the rainfall outflow ratios before sponge city construction of rainfalls with return periods of 2 5 20 and 30 year identically equal to 67 5 the same as the integrated runoff coefficient in contrast the rainfall outflow ratios after sponge city construction are 19 4 21 1 23 9 and 25 2 respectively it indicates that the integrated sponge system substantially reduces the relative proportion of rainfall volume reaching the catchment s outfalls and has higher reduction rates on outflows of frequent rainfalls this result is like the discussion on the response of the catchment integrated with green spaces and storage alexander et al 2019 4 4 stormwater stored due to sponge city construction as an essential component of urban development to control the growing stormflow volumes and reduce pollutants in water bodies the constructed stormwater management system in a sponge city is expected to limit the outflow rate to the pre development status and increase the residence time by temporarily storing stormwater runoff and discharging it afterward this stored water volumes within the catchment due to sponge city construction can be defined as 12 v 0 c q b q a d t where q b and q a are the outflow rate of the catchment before and after sponge city construction respectively m3 s c is when the outflow rate after sponge city construction equals or exceeds to outflow rate before the constructions fig 10 shows that the stormwater stored due to sponge city construction within the catchment for rainfalls with return periods of 2 5 20 and 30 year are 0 31 0 40 0 56 and 0 62 million m3 respectively furthermore the relationship of stored stormwater volume v m3 and the rainfall depth p mm can be expressed by v 11025 p 7476 it shows that the sponge city infrastructure can significantly mitigate the flooding threat of intense storms to the catchment and downstream areas by retaining and controlling the stormwater outflows 5 conclusion to assess how the sponge city infrastructure in the catchment impacts the stormwater outflow we researched the fengxi new city an urban catchment in china implemented with sponge city infrastructure since 2015 and performed the rainfall runoff modeling analysis with an analytic framework based on isochrone technique and swmm simulations first the 120 min storms with return periods of 2 5 20 and 30 year based on the chicago rainstorm pattern were designed and their corresponding effective rainfalls were calculated then the rainfall runoff transformations in the catchment before and after sponge city construction were simulated by the isochrone technique and swmm model respectively besides indicators including the peak flow rate outflow volume rainfall outflow ratio and stormwater stored within the catchment due to sponge city construction were analyzed our findings are as follows 1 the analytic framework based on the isochrone technique and swmm simulations is proved to be a useful tool to simulate and compare the rainfall runoff process before and after sponge city construction this model was applied to the case study in fengxi new city however it is developed to be applicable for other urban catchments that have sponge city infrastructure these catchment samples can be used to evaluate its robustness and generality following the framework higher resolution input data and precise parameters enable users to perform a performance assessment better however this model may be unfriendly for users who are not familiar with swmm and isochrone technique for example it has no graphical user interface to assist the user to plot isochrone maps 2 the sponge city construction significantly mitigates the risk of stormwater overflows in the catchment by a firm limit of the peak flow rate particularly for frequent rainstorms the reasons are that after the construction the peak flow rate reduces by 69 on average for different design storms although the appearing time of peak flow remains unchanged also the peak flow rates of different design storms vary less than before the construction besides the response of peak flow rate to the rain intensity becomes more sensitive for frequent rainstorms 3 the sponge city infrastructure in the catchment also obviously relieves the pressure on the flood control system of its downstream areas particularly for frequent storms this is evidenced by the fact that the rate of outflow volume reduction due to sponge city construction decreases from 71 to 63 as the return period of design storms increases and the variability in outflow volumes of different design storms falls by more than half after the construction besides the volume of stormwater stored due to sponge city construction has a linear relationship with the design storm s depth in conclusion building stormwater infrastructure and distributing them within the urban landscape during sponge city construction perform best against frequent design storms relieve the pressure on the catchment s drainage system and mitigate local flooding risk thus enhancing the resilience and adaptation of the catchment to intense rainfalls moreover the integrated stormwater management system significantly reduces the threat of flood damages for downstream catchments by controlling the outflow process the authors acknowledge that this paper s modeling simplifies some complexities of stormwater management with sponge city infrastructure with a focus on the impact of the infrastructure on the stormflows the analytic framework assumed that the runoff coefficient before sponge city construction is a constant without considering the impact of storm intensity and antecedent moisture conditions of the catchment besides the diversity of input storms for the isochrone and swmm models were simplified as the high resolution rainfall data grows the extremes of the return period and the extremes of temporal spatial distribution should be described and applied to drive the proposed model therefore the future study can incorporate time varying runoff coefficients various temporal patterns of rainfalls hettiarachchi et al 2018 climatic forecasts zhou et al 2018 as well as the antecedent moisture conditions hettiarachchi et al 2019 and performance decline of the lid facilities to reduce the uncertainty of the stormwater assessment of sponge city infrastructure credit authorship contribution statement yuanyuan yang conceptualization writing original draft writing review editing funding acquisition project administration jing li visualization software qiang huang methodology supervision jun xia methodology supervision jiake li validation resources dengfeng liu writing review editing software qintao tan data curation investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this research was jointly funded by the national natural science foundation of china 52009099 42071335 china postdoctoral science foundation funded project 2019m653882xb and the open program of the joint institute of internet of water and digital water governance tsinghua ningxia yinchuan sklhse 2019 ilow06 the authors acknowledge and thank the fengxi management committee for their assistance and the epa usa for freely using the swmm in this study we also extend our collective thanks to the editor and the reviewers for the comments and additions appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 126151 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
4586,sponge city construction in china is integrated with stormwater management infrastructure which is based on the concept of low impact development such that the urban flooding and nonpoint storm pollution are mitigated we hypothesize that an analytic framework based on isochrone and swmm models can be used to simulate and compare the rainfall runoff process before and after sponge city construction and thus assess the performance of the sponge city infrastructure on controlling stormwater outflows in this paper the analytical framework driven by design storms with return periods of 2 5 20 and 30 year was developed and tested in the catchment in fengxi new city china the modeling results were then analyzed with indicators like peak flow rate outflow volume rainfall runoff ratio and stormwater stored due to sponge city construction outflow hydrographs and volume curve analyses showed that the sponge city infrastructure significantly mitigates the risk of stormwater overflows in the catchment and dramatically relieves the pressure on the flood control system of its downstream areas by a firm limit of the peak flow rate also the performance generally decreases as rainstorms become less frequent and more intense we anticipate that the proposed framework provides a practical approach to quantifying the sponge city s response to rainfalls under complex models keywords stormwater management low impact development urban catchment rainfall runoff model loess region fengxi new city 1 introduction urban storm management faces increasing challenges as a result of rapid urbanization and growing extreme rainfalls urbanization increases impervious land cover accelerates and enlarges rainfall runoff transformation and leads to nonpoint source pollution for example the urban population rate of china increases from 10 64 57 65 million in 1949 to 60 6 in 2019 848 43 million and the area of built in land increases from 30406 19 km2 in 2004 to 58455 66 km2 in 2018 national bureau of statistics of china 2019 simultaneously as a sensitive area to global climate change china has increased the frequencies and intensities of extreme storms despite an apparent regional difference driven by the rising temperatures the average annual precipitation in china shows a slight uptrend from 1961 to 2019 whereas the average annual rain days declines significantly indicating more extreme rainfall events cma climate change centre 2020 these changes are anticipated to impact stormwater runoff and water quality miller and hutchins 2017 rapidly collecting and conveying storm to the treatment works before discharging to natural water bodies proves to be an unsatisfactory solution to adapt the land use cover change and rainfall change instead the urban landscape integrated with stormwater management which enhances the future resilience and reduces the urban risks of storm related damages to life and property has become a trend in many cities these days alexander et al 2019 dong et al 2017 china has officially implemented the sponge city construction in 2015 as its national stormwater management countermeasure sponge city infrastructure represents the basic physical and organizational structures and facilities in an urban catchment mainly built to capture and retain stormwater to reduce and delay peak flows improve water quality and utilize rainwater sponge city construction means the construction of sponge city infrastructure aiming to make the flow that leaves the catchment approaches the pre development status with the least cost and sponge city system contains the structural measures i e sponge city infrastructure and the non structural measures for example lids control rules for stormwater control it can be classified into three categories the low impact development lid system the stormwater drainage system and the drainage system for over standard stormwater yang 2017 regarding sponge city and stormwater management previous studies have focused on the design and optimization of lid practices and drainage system eckart et al 2018 jiang et al 2020 li et al 2020 liu et al 2016 rezazadeh helmi et al 2019 xu et al 2018 zhao et al 2018 urban inundation chen et al 2018 jamali et al 2018 wu et al 2017 hydrological modeling jato espino et al 2019 mancipe munoz et al 2014 salvadore et al 2015 stormwater quality management liu et al 2019 flood hazard assessment schubert et al 2017 and so on while these studies provide strong evidence for the impact mechanism performance and benefits of a specific facility or a few systems the overall effect of sponge city infrastructure on stormwater outflows have yet to be quantitatively addressed therefore to answer how well the sponge city infrastructure can control the stormwater and responds to storms a novel framework based on hydrologic hydraulic modeling is developed to simulate and analyze the stormflows one of its key features is reducing many uncertainties and inaccuracies of rainfall runoff simulation for the catchment before sponge city construction by advancing the isochrone technique which is a method used initially in the field of rainfall runoff transformation on the undeveloped catchment it allows a fair estimation of the outflow hydrograph with fewer parameters and data than other models particularly suitable for the simulation before sponge city construction where measured data is often insufficient the second feature is the four criteria proposed for performance assessment of sponge city infrastructure peak flow rate outflow volume rain runoff ratio and stormwater stored due to sponge city construction in this paper we designed storms with varying return periods calculated and compared the resulting outflows of the catchment before and after sponge city construction the results will reference the subsequent planning design construction and management of stormwater facilities in the sponge city this paper is organized as follows the study area and data are given in section 2 a brief introduction to the design rainfall isochrone technique and the swmm model is presented in section 3 section 4 presents the results and discussion from the perspective of four indicators the conclusions are given in section 5 2 study area and data the study area fig 1 c is a newly developed catchment constructed with sponge city facilities since 2015 in fengxi new city located between xi an and xianyang shaanxi province china fig 1a and b as one of the national pilot sponge cities on loess with a temperate continental monsoon semi arid and semi humid climate it was also designated as the global eco hydrology demonstration site by unesco in 2019 its annual average temperature and precipitation are 13 6 and 520 0 mm respectively rainfalls in the wet season july to september account for around 50 of the annual precipitation it covers an area of 22 5 km2 and has an average slope of 1 1 it is covered by a large area of greens and water bodies also the impervious land surfaces with stormwater management facilities like the green corridor 7 0 km long the stormwaters are drained to the weihe river and fenghe river separately because the study area sites at their confluence the design standards of stormwater systems in fengxi new city are as follows 2 year or 3 year return period rainfalls for ordinary downtown areas 3 year to 5 year return period rainfalls for important downtown areas and 10 year to 20 year return period rainfalls for underground passages and sunken squares ministry of housing and urban rural development of the people s republic of china 2016 however many drainage systems in the catchment are designed to handle storms with 1 year or 2 year return periods as a result storm induced inundations frequently occurred due to insufficient drainage capability before 2014 then the sponge city system led by the conception of lid has been constructed in part of the city to build an urban flooding control system that can handle the 30 year return period storms therefore the study area before construction represents an urban catchment with minimal stormwater management features in contrast after sponge city construction it has been a growing urban catchment that integrated with stormwater management infrastructure based on lid facilities such as rain garden permeable pavement planted roof sunken greenbelt bio retention facility dry well wet pond stormwater wetland stormwater barrel retention basin detention pond grassed swale infiltration pipe and trench vegetative filter strip in this paper most catchment data were obtained from the fengxi management committee including sub catchment boundaries ground elevations stormwater infrastructure details water levels and critical sections flow rates for example fig 2 shows the distributions of the catchment s infiltration capacity before and after sponge city construction respectively 3 methods our analytical framework is illustrated in fig 3 first the return periods of design storms were determined by the conditions of the catchment then the catchment s rainfall runoff processes before and after sponge city construction were simulated using the isochrone model and the epa swmm model respectively third indicators such as integrated runoff coefficient peak flow rate runoff volume and rainfall outflow ratio were introduced one thing to be aware of here is that the model runs on a 20 min timescale because the time steps for designing storms isochrone model and swmm model is 5 20 and 10 min respectively 3 1 design storms the outputs of an isochrone swmm model strongly correlate with its inputs one is the data of storm events in this study the depths of design storms with different return periods were estimated using the annual maximum method specifically by fitting a probability distribution to the annual maximum series the formula of intensity frequency duration ifd relationship for storm design in fengxi new city is expressed in eq 1 the chicago rainfall pattern li et al 2018 which is featured by the unimodal process and principle of symmetry and widely used in china was used to redistribute the rainfall amounts of varying return periods besides based on the rainfall and runoff data observed the position coefficient of peak rainfall with a duration of 120 min was set to 0 35 1 i 16 715 1 1 1658 l g t t 16 813 0 9302 where i is the storm intensity mm min t is the return period of rainstorms equals 2 5 20 or 30 year t is the rainstorm duration equals 0 to 120 by 10 min then the volume of rainfall over the catchment is expressed as follows 2 p t i t where p t is the storm depth of the catchment in t minutes mm in this way storms with return periods of 2 5 20 and 30 year which are generally expected to cause urban flooding in the catchment were designed and input into models to simulate stormflows fig 4 a 3 2 runoff calculation before sponge city construction using isochrone model few observed runoff data of the catchment before sponge city construction were collected therefore the isochrone technique time area routing approach a lumped parameter model which can obtain satisfactory results for a catchment ungauged or that has a few data was used hereby to obtain the urban stormflow hydrographs rather than the nonlinear reservoirs method nrm linear reservoirs method lrm and instantaneous unit hydrograph iuh which all require many measured flows data before the calculation the study area was divided into 19 non uniform sub catchments according to outfalls locations as illustrated in fig 5 3 2 1 effective rainfall the stormwater runoff in the catchment has a short duration from dozens of minutes to several hours and consists of large channel flows mostly source from overland flows in impervious areas and small groundwater flows development and construction management committee of xixian new district 2017b thus the volumes of evapotranspiration and ground flow were ignored for simplification as well as the temporal spatial variations of rainfalls the loss rate then turns a constant thereby calculated using the φ index formula dingman 2015 3 φ 1 α p d where φ is the loss rate mm min α is the runoff coefficient p is the total rainfall depth mm d is the duration of rainfall min the effective rainfall of varying return periods fig 4b is calculated as follows h t 0 p t φ p t φ p t φ where h t is the effective rainfall mm p t is the precipitation of duration t mm 3 2 2 concentration time the manning resistance equation shown in eq 5 is used for estimating concentration time 5 u 0 397 n d 2 3 j 1 2 where u is the average flow velocity of stormflows in conduits pipes and channels m s n is the manning roughness coefficient which is proportional to the flow resistance the estimate is 0 013 d is the average diameter of pipes m the estimate is 0 6 j is the bed slope of the catchment the estimate is 0 011 then the formula of concentration time of conduits is 6 t c l 60 u where t c is the concentration time travel time of stormflows in conduits min l is the distance measured along the flow path namely the length from the junction to the outlets of sub catchments m meanwhile the concentration time of overland flow can be calculated by the drainage formula as follows 7 t o 0 703 1 1 α l s 1 2 j 1 3 where t o is the concentration time of overland flow min α is runoff coefficient the estimate is 0 7 l s is the length of the slope the estimate is 0 5568 m the overall concentration time of the catchment can be estimated as follows 8 τ m t c t o where τ is the total concentration time min m is the reduction factor of conduit which equals two in this paper as all cross sections over the study area are pipes rather than open channels 3 2 3 isochrones the assumptions for the isochrone technique are summarized below whereas we refer the reader to the theories and cases discussed by saghafian et al 2002 her and heatwole 2016 and beven 2020 for detailed descriptions the first assumption is that the droplets on an isochrone zone which is defined as the area surrounded by the adjacent time contour lines isochrones of travel time in the catchment based on velocities and the drainage boundary would take the same time to flow to the outlet section another assumption is that an isochrone zone s flow does not interfere with another during the concentration so the effective rainfalls on different isochrone zones flow chronologically to their corresponding outlets therefore the instantaneous flow rate at the outlet section is the sum of instantaneous flow rates of all isochrone zones with the same travel time the catchment s concentration time equals the travel time of the most hydraulically remote sub catchment to the outlet of the catchment the time to equilibrium which is a function of the rainfall intensity and the catchment s characteristics mentioned in section 2 was loosely substituted by the time of concentration in this paper it was divided into many equal time intervals δt namely the travel time difference between adjacent isochrones then the 19 non uniform sub catchments were divided respectively according to the formula τ n δ t the corresponding time area histograms of each sub catchment are shown in fig 6 so the runoff hydrograph of each sub catchment can be generated through discrete convolution of the time area the area of the corresponding time zone and effective rainfall as follows 9 q j k 1 j e k a j k 1 where j is the time step indicator q is the equilibrium discharge rate e is the intensity of effective rainfall a is the drainage area bounded by isochrones note that the time variability in isochrone maps was not considered for simplicity in this paper however the integrated runoff coefficient irc which is obtained by the weighted average method on runoff coefficients of different underlying surfaces table 1 was used to calibrate and verify the modeling results 3 3 runoff calculation after sponge city construction using swmm since sponge city construction in the catchment the land cover use has changed many lid controls and sewer systems were constructed therefore the hydrologic hydraulic swmm version 5 1 updated with a lid toolbox https www epa gov water research storm water management model swmm driven by design rainstorms generated in section 3 1 was employed to model the stormflow dynamics in sewer networks and on overland surfaces after sponge city construction 268 non uniform sub catchments 603 conduits and 25 outfalls illustrated in fig 2 were generalized in the swmm model based on the layout of drainage networks dem and land use data of the study area furthermore the horton s method nonlinear reservoir method and dynamic wave approach rossman 2017 were selected to compute the infiltration losses routing of overland flow and routing of conduits flow respectively the main parameters for sub catchments are area percent of impervious area width slope infiltration parameters manning s roughness coefficients depression storage depth and internal routing parameters these parameters were set based on the reference manual of swmm rossman 2016 the catchment s characteristics and the suggestions by awol et al 2018 eckart et al 2018 behrouz et al 2020 and dai et al 2020 and were altered during the calibration process the modeling was executed by inputting the design storms of multiple return periods into the time series editor selecting each rainfall time series and performing the simulation table 2 shows the key calibrated parameters of the swmm model and a summary of lid characteristics as reported by the development and construction management committee of xixian new district 2017a the model was calibrated with storm events recorded on august 20 13 4 mm in 96 min september 9 16 0 mm in 960 min and september 16 11 4 mm in 780 min in 2017 at the tianfuheyuan court which is a residential area with a storm sewer system consists of 123 sub catchments 47 conduits 49 conduit junctions and two outlets for three storms the nash sutcliffe efficiency liu 2020 of model errors is 0 63 0 84 and 0 76 respectively relative error of peak flow rate is 0 0038 0 1552 and 0 0153 respectively and time to peak error is 6 min 18 min and 4 min respectively therefore the calibrated model represents the hydrological process well also supported by the observed and simulated hydrographs 4 results and discussion results show that the calculation error of the integrated runoff coefficient by the isochrone model is 8 compared with the theoretical value i e the weighted mean of runoff coefficients of each land cover in the catchment and the continuous calculation errors of the surface runoff and flow by swmm are less than 2 meet the error requirements 10 in this section the results generated by the above two models were discussed we analyzed indicators like peak flow rate outflow volume rainfall outflow ratio and stormwater stored within the catchment due to sponge city construction 4 1 peak flow rate the peak flow rate is an essential reference to determine an urban system s total conveyance capacity street flow included during larger storm events and size the sewer systems in developed areas the high peak flow rate will risk infrastructure and people nearby because it challenges the catchment s drainage capacity regarding it our findings are as follows 1 the appearing time of peak flow rate remains unchanged after sponge city construction as shown in fig 7 indicating that the retarding effect of lid facilities on stormflows may be offset by the acceleration effect of newly built drainage networks in contrast the resulting peak flow rates of different return period rainfalls reduce by 69 due to sponge city construction this finding is consistent with the finding of lucas and sample 2015 and guo et al 2019 who discovered that peak flows were reduced by over 53 87 5 by lid implementations 2 although the peak flow rate for rainfall with a return period of 30 year doubled on that of the 2 year no matter the sponge city system was constructed or not the variations in peak flow rates between a pair of rainfalls decrease after sponge city construction fig 8 a for example the variations in the peak flow rate between 2 year and 30 year storms before and after sponge city construction are 124 5 m3 s and 36 9 m3 s respectively like the discussion on the effectiveness of stormwater management structures in alexander et al 2019 the lower variability indicates that the sponge city construction improves the catchment s resilience to intense rainstorms i e mitigates the risk of overflows besides the increase in peak flow rate is linear before sponge city construction while parabolic after construction fig 8b indicating that the peak flow rate after sponge city construction is more sensitive to the rainfall depth of frequent rainfalls 4 2 outflow volume the outflow volume i e the volume of runoff leaving the catchment conveyed through the drainage network is the sum of outflow volumes at the catchment s outfalls 1 for rainstorms with return periods of 2 5 20 and 30 year the reduction rates of outflow volumes due to sponge city are 71 69 65 and 63 respectively fig 9 showing a slight downtrend as the return period of rainstorm increases this finding supports the results of guo et al 2019 on the degrees of outflow volume reduction by lid practices 2 the outflow volumes of rainstorms with a return period of 30 year are more than twice that of 2 year no matter the sponge city system was constructed or not however the outflow volume growths are 0 43 and 0 20 million m3 respectively indicating that a sponge city s downstream area requires lower flood control capacity to handle upstream stormwater outflows 4 3 rainfall outflow ratio as defined in eq 11 the rainfall outflow ratio which is applicable to various land use types alexander et al 2019 was used to ascertain the catchment s capability to absorb and retain flows of stormwater a low value represents that the stormwater is effectively controlled within the catchment 11 ro 0 d q out δ t p where q out is the flow rate exiting the outfalls of the catchment m3 s p is the total volume of the rainfall m3 d is the duration of the rainfall s results show that the rainfall outflow ratios before sponge city construction of rainfalls with return periods of 2 5 20 and 30 year identically equal to 67 5 the same as the integrated runoff coefficient in contrast the rainfall outflow ratios after sponge city construction are 19 4 21 1 23 9 and 25 2 respectively it indicates that the integrated sponge system substantially reduces the relative proportion of rainfall volume reaching the catchment s outfalls and has higher reduction rates on outflows of frequent rainfalls this result is like the discussion on the response of the catchment integrated with green spaces and storage alexander et al 2019 4 4 stormwater stored due to sponge city construction as an essential component of urban development to control the growing stormflow volumes and reduce pollutants in water bodies the constructed stormwater management system in a sponge city is expected to limit the outflow rate to the pre development status and increase the residence time by temporarily storing stormwater runoff and discharging it afterward this stored water volumes within the catchment due to sponge city construction can be defined as 12 v 0 c q b q a d t where q b and q a are the outflow rate of the catchment before and after sponge city construction respectively m3 s c is when the outflow rate after sponge city construction equals or exceeds to outflow rate before the constructions fig 10 shows that the stormwater stored due to sponge city construction within the catchment for rainfalls with return periods of 2 5 20 and 30 year are 0 31 0 40 0 56 and 0 62 million m3 respectively furthermore the relationship of stored stormwater volume v m3 and the rainfall depth p mm can be expressed by v 11025 p 7476 it shows that the sponge city infrastructure can significantly mitigate the flooding threat of intense storms to the catchment and downstream areas by retaining and controlling the stormwater outflows 5 conclusion to assess how the sponge city infrastructure in the catchment impacts the stormwater outflow we researched the fengxi new city an urban catchment in china implemented with sponge city infrastructure since 2015 and performed the rainfall runoff modeling analysis with an analytic framework based on isochrone technique and swmm simulations first the 120 min storms with return periods of 2 5 20 and 30 year based on the chicago rainstorm pattern were designed and their corresponding effective rainfalls were calculated then the rainfall runoff transformations in the catchment before and after sponge city construction were simulated by the isochrone technique and swmm model respectively besides indicators including the peak flow rate outflow volume rainfall outflow ratio and stormwater stored within the catchment due to sponge city construction were analyzed our findings are as follows 1 the analytic framework based on the isochrone technique and swmm simulations is proved to be a useful tool to simulate and compare the rainfall runoff process before and after sponge city construction this model was applied to the case study in fengxi new city however it is developed to be applicable for other urban catchments that have sponge city infrastructure these catchment samples can be used to evaluate its robustness and generality following the framework higher resolution input data and precise parameters enable users to perform a performance assessment better however this model may be unfriendly for users who are not familiar with swmm and isochrone technique for example it has no graphical user interface to assist the user to plot isochrone maps 2 the sponge city construction significantly mitigates the risk of stormwater overflows in the catchment by a firm limit of the peak flow rate particularly for frequent rainstorms the reasons are that after the construction the peak flow rate reduces by 69 on average for different design storms although the appearing time of peak flow remains unchanged also the peak flow rates of different design storms vary less than before the construction besides the response of peak flow rate to the rain intensity becomes more sensitive for frequent rainstorms 3 the sponge city infrastructure in the catchment also obviously relieves the pressure on the flood control system of its downstream areas particularly for frequent storms this is evidenced by the fact that the rate of outflow volume reduction due to sponge city construction decreases from 71 to 63 as the return period of design storms increases and the variability in outflow volumes of different design storms falls by more than half after the construction besides the volume of stormwater stored due to sponge city construction has a linear relationship with the design storm s depth in conclusion building stormwater infrastructure and distributing them within the urban landscape during sponge city construction perform best against frequent design storms relieve the pressure on the catchment s drainage system and mitigate local flooding risk thus enhancing the resilience and adaptation of the catchment to intense rainfalls moreover the integrated stormwater management system significantly reduces the threat of flood damages for downstream catchments by controlling the outflow process the authors acknowledge that this paper s modeling simplifies some complexities of stormwater management with sponge city infrastructure with a focus on the impact of the infrastructure on the stormflows the analytic framework assumed that the runoff coefficient before sponge city construction is a constant without considering the impact of storm intensity and antecedent moisture conditions of the catchment besides the diversity of input storms for the isochrone and swmm models were simplified as the high resolution rainfall data grows the extremes of the return period and the extremes of temporal spatial distribution should be described and applied to drive the proposed model therefore the future study can incorporate time varying runoff coefficients various temporal patterns of rainfalls hettiarachchi et al 2018 climatic forecasts zhou et al 2018 as well as the antecedent moisture conditions hettiarachchi et al 2019 and performance decline of the lid facilities to reduce the uncertainty of the stormwater assessment of sponge city infrastructure credit authorship contribution statement yuanyuan yang conceptualization writing original draft writing review editing funding acquisition project administration jing li visualization software qiang huang methodology supervision jun xia methodology supervision jiake li validation resources dengfeng liu writing review editing software qintao tan data curation investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this research was jointly funded by the national natural science foundation of china 52009099 42071335 china postdoctoral science foundation funded project 2019m653882xb and the open program of the joint institute of internet of water and digital water governance tsinghua ningxia yinchuan sklhse 2019 ilow06 the authors acknowledge and thank the fengxi management committee for their assistance and the epa usa for freely using the swmm in this study we also extend our collective thanks to the editor and the reviewers for the comments and additions appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 126151 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
4587,remote sensing rs based two source models have been widely used to separate soil evaporation e and vegetation transpiration t in ecosystems alternative model assumptions and physical mechanisms employed in different two source models cause the difference in model performance understanding of the characteristics and limitations of alternative two source models is critical to ensure the most effective applications in various climatic zones and underlying surfaces this study investigated two types of land surface temperature lst decomposition based two source models namely two source energy balance model tseb and modified pixel component arranging and comparing algorithm m pcaca as well as a meteorological factors based penman monteith type model pm mu in the partitioning of e and t the three models were compared at 21 flux stations across china which included seven types of underlying surfaces and one isotope station the study demonstrated that all three models were applicable in a large scale study for latent heat flux le estimation overall m pcaca performed the best with average root mean square errors rmse of 38 7 w m2 while pm mu performs the worst with average rmse of 61 4 w m2 for et partitioning the two models based on lst decomposition tseb and m pcaca gave more reliable estimates compared with stable water isotope observations in addition verification results for the seven types of underlying surfaces showed that the tseb gave the best accuracy in the areas with high leaf area index lai and vegetation height e g forest while the pm mu had an advantage in the areas without vegetation e g deserts and water bodies due to the characteristics of the land surface temperature vegetation coverage lst fc trapezoidal framework the m pcaca model had the most stable model performance for various underlying surfaces and gave the best estimates in grassland wetland and farmland areas using a thorough discussion this study identified the sources of discrepancies induced by different physical mechanisms of three remote sensing based two source models this investigation provided insights to better understand the alternative two source models and provides guidance for model application keywords et partition two source model tseb m pcaca pm mu remote sensing 1 introduction accurate estimation of land evapotranspiration et and its partitions e and t are an important link to drought prediction precision irrigation plant productivity water resources management and allocation chen et al 2020a allen et al 2007 kustas and anderson 2009 wang and dickinson 2012 tian et al 2016 huang et al 2020 in particular t dominates et in high vegetation coverage areas and is closely related to the terrestrial co2 emission and then related to climate change jasechko et al 2013 huxman et al 2005 traditional measurement methods for e and t can only reflect surface water fluxes and energy balance fluxes at a single point scale such as eddy correlation ec method stable water isotope method lysimeter and sap flow meters e g chen et al 2020a 2020b trambouze et al 1998 baldocchi et al 1991 čermák et al 2004 wang et al 2010 tian et al 2017 but it is difficult to directly measure surface fluxes over large spatial scales however in recent years with the rapid development of remote sensing rs technology it has become feasible using remote sensing image information to retrieve ground surface parameters and combine physical models to estimate regional surface fluxes jasechko et al 2013 wang et al 2010 rs based surface flux models can be divided into single source models and two source models the single source models do not distinguish between soil evaporation and vegetation transpiration and consider that soil surface and vegetation canopy are from the same water vapor source such as surface energy balance system sebs su 2002 surface energy balance algorithm for land sebal bastiaanssen et al 1998 and mapping evapotranspiration with internalized calibration metric allen et al 2007 compared with single source models the two source schemes divide the et source into soil and vegetation sources and model physical mechanisms using a more advanced procedure than single source schemes to describe surface evaporation processes alternative rs based two source et models rely on different parameterization schemes and model assumptions but generally can be classified into two types of models one type of model is based on the land surface temperature lst to represent the land surface wetness therefore these models rely upon the decomposition of lst into soil surface temperature ts and vegetation canopy temperature tv and then estimation of e and t as a result researchers have proposed various two source models based on different temperature decomposition methods including the following models 1 use of two or multi angle thermal infrared observations to solve two equations about lst ts and tv jia et al 2003 developed an algorithm to separate two component temperatures from bi angular atsr 2 data song et al 2018 proposed a moderate resolution imaging spectroradiometer modis based dual temperature difference dtd model and verified its performance in the heihe river basin with the results showing that the mean absolute percent differences mapd were about 20 compared with measured fluxes however the limited thermal infrared sensors and information sources resulting in these models were not widely applied in past years therefore efforts were undertaken to decompose lst into ts and tv using one angle thermal infrared observation 2 decomposition of component temperature using an iterative method this type of model namely tseb was originally proposed by norman et al 1995 in the tseb the expression of vegetation transpiration was obtained using the priestley taylor p t expression and decomposed the lst based on an iterative method norman et al 1995 priestley 1972 gan and gao 2015 yang et al 2015a 2015b yongmin et al 2018 they considered vegetation transpiration as a function of vegetation coverage fc slope of air temperature ta saturated water vapor pressure es and vegetation net radiance flux rnv recently the tseb model was improved by applying the model for various surface conditions in a more efficient iterative process and with fewer parameter requirements colaizzi et al 2012 coupled the tseb with the p m equation and showed the new model was very suitably applied in advective semiarid areas gan and gao 2015 proposed to minimize the difference of ts as the iteration target which greatly improved the iteration efficiency and accuracy of tseb yao et al 2017 proposed a temperature based two source model based on tseb which greatly reduced the need for ground meteorological factors in general the tseb model has been widely used in different underlying situations and has led to good model performance according to massive reported research e g norman et al 1995 song et al 2016 2018 yang et al 2015a 2015b yongmin et al 2018 yao et al 2017 3 decomposing lst based on the lst fc trapezoid feature space method this type of model assumes that within the lst fc trapezoid framework there exist gradual excesses of iso soil moisture lines carlson et al 1995 long and singh 2012b yang and shang 2013 yang et al 2015a 2015b tang and li 2017 so the model first finds the theoretical or actual dry wet boundary of the lst fc trapezoid and then linearly interpolates the slope of each point inside the trapezoid to decompose lst into ts and tv some representative models include pixel component arranging and comparing algorithm pcaca developed by zhang et al 2005 and its revised version by chen et al 2020c two source trapezoid model for evapotranspiration ttme proposed by long and singh 2012b hybrid dual source scheme and trapezoid framework based et model htem proposed by yang and shang 2013 enhanced two source evapotranspiration model eteml conducted by yang et al 2015a these models showed comparable or better performance than tseb in some cases e g yang et al 2015a 2015b yongmin et al 2018 unlike the idea of component temperature decomposition another type of two source model estimates e and t using a modified p m formula this model is essentially the same as the classic shuttleworth wallace model at site scale since they both rely upon the impedance parameters between soil vegetation atmosphere to reflect water diffusion processes e g shuttleworth and wallace 1985 chen et al 2020a zhao et al 2016 the p m formula based model use rs visible band surface vegetation information and ground meteorological factors to map the e and t in spatial this model was first proposed by mu et al 2007 and considered that vegetation transpiration was constrained by ta and vapor pressure difference vpd and used complementary relationships to incorporate relative humidity to estimate soil evaporation han and tian 2018a 2018b 2020 mu et al 2007 2011 due to pm mu model does not require the thermal infrared information this type of model is very suitable for producing time series e and t data the mod16 et product has been widely validated in various surface conditions e g hu et al 2015 chang et al 2018 ramoelo et al 2014 in practical applications of two source models under specific climate and land cover setting it is important to understand the characteristics of different models efforts have been made to compare one source and two source models in several cloudless test days 2 6 test days through instantaneous remote sensing imagery for various vegetative cover and moisture conditions e g timmermans et al 2007 choi et al 2009 tang et al 2011 josé et al 2019 but inter comparisons of two source models are lacking although some previous studies have compared the performance of different two source models they are all applied at the watershed or regional scale in particular a large number of scholars focused on heihe watershed allied telemetry experimental research multi scale observation experiment on evapotranspiration hiwater musoexe in northwest china e g li et al 2012 yang et al 2015a yang et al 2015b song et al 2016 yao et al 2017 yongmin et al 2018 song et al 2018 and soil moisture atmosphere coupling experiment smacex in iowa u s e g long and singh 2012 choi et al 2009 gonzalez et al 2009 yang et al 2015a yang et al 2015b this leads to the comparison and analysis of alternative two source models limited to one or two types of surface conditions and model performance in various surface types are still unknown yang et al 2015a yang et al 2015b investigated the performance of htem tseb and pm mu models in the heihe river basin for six test days in 2012 and found that htem performed best and pm mu yielded the poorest estimation yongmin et al 2018 inter compared tseb pt tseb pm tseb tv ts in hiwater musoexe campaign for six test days with results showing that different lst decomposition methods would make a big difference to the soil latent heat fluxes les and vegetation latent heat fluxes lev tseb pt led to relatively reliable surface heat fluxes and all three models underestimated the ratio of t in total et t et the same with the ratio of vegetation latent heat flux in total latent heat flux lev le choi et al 2009 studied the tseb metric and trapezoid interpolation model tim in smacex and demonstrated that the tseb outperformed metric and tim until now there has been no identified research conducted that provided a comprehensive systematic two source model comparison in multiple types of climates underlying surfaces as a consequence there is still lacking of knowledge the physical mechanism discrepancy between the three models caused the difference performance in various surfaces to enhance the understanding of different two source models to produce et and partition into e and t this paper compares the performances of three types of classic two source models tseb represents an iteration based lst decomposition method m pcaca represents lst fc trapezoid framework based lst decomposition method pm mu represents p m formula based two source model on seven types of underlying surfaces the objectives of this article are to 1 explore the applicability of three types of two source models in estimating surface energy balance fluxes in china 2 analyze the spatial distribution of e t and et in different regions of china 3 develop greater insights into each model s physical mechanisms by comparing the differences in the performance of the three models in seven typical underlying surfaces finally it should be noted that the model comparison is based on the same meteorological factors and remote sensing imagery driving data to ensure the fairness and comparability between the different models tang et al 2011 yang et al 2015a 2015b yongmin et al 2018 2 methodology 2 1 tseb model the tseb model is a two source energy balance model that estimates le as a residual in the four energy balance components which were originally proposed by norman et al 1995 and revised by kustas and norman 1997 the structure diagram of tseb is present in fig 1 a in tseb rn is separated by soil and vegetation sources and each source follows the energy balance equation 1 r n r ns r nv 2 r ns h s l e s g 3 r nv h v l e v in 1 2 and 3 rn rns and rnv represent the total net radiation fluxes soil and vegetation net radiation fluxes w m2 respectively g is the soil heat flux w m2 for rn and g estimation the three models used the same algorithm in order to ensure that the three models have the same energy forces rn was calculated by nishida et al 2003 s method and g was estimated by empirical relations with rn grimmond and oke 1999 kustas and daughtry 1990 given as appendix a1 a2 lev and les are the vegetation and soil latent heat fluxes w m2 respectively hv and hs are the vegetation and soil sensible heat fluxes w m2 respectively for the impedance network system of the series model hv hs and h use the following parameterization scheme 4 h v ρ c p t v t av r x 5 h s ρ c p t s t av r s 6 h h c h s ρ c p t av t a r a in 4 6 ts and tv are the soil and vegetation surface temperature k tav is the canopy air space temperature k rx rs and ra are the impedance of vegetation canopy boundary source soil surface boundary source and heat diffusion s m the specific calculations of rx and rs are found in norman et al 1995 ra can be estimated by various meteorological factors radiation ra ta wind speed u etc li et al 2005 appendix a10 the calculation of rns and rnv are shown in kustas and norman 1995 and anderson et al 1997 appendix a8 a9 in 2 and 3 lev was estimated by priestley taylor p t formula shown in 7 while les is considered as a residual of energy balance equation 7 l e v α pt f c δ δ γ r nv in 7 αpt is the priestley taylor coefficient the initial value is set to 1 3 according to norman et al 1995 and agam et al 2010 fc is the fractional vegetation coverage calculated by enhanced vegetation index evi mu et al 2007 2011 δ is the slope of the saturated vapor pressure with ta pa k γ is the psychrometric constant approximately estimated as 0 066 kpa oc the tseb model uses an iterative method to decompose the component temperatures the relationships between lst with tv and ts is shown as 8 after norman et al 1995 anderson et al 2007 8 lst f c t v 4 1 f c t s 4 1 4 combining 4 to 8 gets the initial value of les however the les calculated by the residual method will have some unreasonable value such as les 0 which usually appears as condensation on the soil surface but this is impossible during the daytime this indicates that the selected initial p t coefficient overestimates the potential vegetation transpiration so there is a need to repeatedly iterate the p t value until les 0 once a reasonable p t value is determined lev and les can be easily solved 2 2 m pcaca model like the tseb model the mpcaca model also separates the land et by decomposing the component temperatures however different from the tseb the m pcaca uses the lst fc trapezoidal framework to get tv and ts the pcaca was originally proposed by zhang et al 2005 and revised by long and singh 2012b and chen et al 2020c in pcaca the determination of the lst fc trapezoidal theoretical boundary depends on the actual boundary however the shape of the lst fc scatter plot is trapezoidal only at a regional scale such as a watershed or a province this greatly limits the application scale of the pcaca therefore we have made appropriate improvements to the pcaca so that the new model can be applied to large scales the main improvement is that the m pcaca achieves theoretical boundary positioning which does not rely on the actual boundary the lst fc trapezoid framework and four extreme temperature distributions are shown in fig 1b the appendix discusses the specific calculation method to determine the four extreme temperatures of the lst fc trapezoid appendices a3 a7 once the theoretical boundary of the lst fc trapezoid is determined the slope of each internal scatter can be obtained by linear interpolation the m pcaca model uses the bowen ratio method to partition the available energy bowen 1926 cook 2011 shuttleworth and wallace 2007 vegetation canopy bowen ratio and soil surface bowen ratio can be determined by vegetation canopy temperature vegetation coverage trapezoid tv fc and soil surface temperature vegetation coverage trapezoid ts fc zhang et al 2005 long and singh 2012b chen et al 2020c 9 β s t sh t sl t sh t s 1 β v t vh t vl t vh t v 1 in 9 βs and βv are the soil and vegetation bowen ratios respectively unitless tsh and tsl are the upper boundary temperature and lower boundary temperature of ts fc trapezoidal k respectively tvh and tvl are the upper boundary temperature and lower boundary temperature of tv fc trapezoid k respectively the expression of les w m2 and lev w m2 are as 10 10 l e s r ns g 1 β s l e v r nv 1 β v 2 3 pm mu et algorithm the pm mu model has been improved from cleugh s model using a modified p m formula combined with modis data and meteorological factors to calculate e and t cleugh et al 2007 mu et al 2007 2011 based on cleugh s model mu et al 2007 made the following improvements 1 in the calculation of stomatal impedance rc the effects of ta and vpd constraints were considered 2 proposed the replacement of normalized difference vegetation index ndvi with enhanced vegetation index evi thereby improving the calculation accuracy of vegetation coverage 13 3 added a soil evaporation calculation module based on the complementary relationship the expressions of vegetation transpiration and soil evaporation are shown as 11 and 12 11 l e v δ r n f c ρ c p v p d r a δ γ 1 r v r a 12 l e s rh 100 vpd β δ r n 1 f c g ρ c p v p d r a δ γ 1 r tot r a in 11 and 12 ρ is the air density kg m3 cp is the specific air heat capacity j kg k vpd is the saturated vapor pressure difference hpa which is determined from the relationship between ta and vapor pressure p murray 1967 rh is the relative humidity β is an empirical parameter set to 1000 according to fisher et al 2008 rv is the stomatal resistance s m calculated by the potential stomatal resistance and corrected by ta and vpd shown as 14 mt min and m vpd are the function of minimum ta and vpd dang et al 1997 jarvis 1976 leuning 1995 respectively cl is the potential stomatal resistance per unit leaf area s m rtot is the total resistance of aerodynamic and vapor diffusion 1994van de griend 1994 which was calculated by the constant rtot set to 107 s m wallace and holwill 1997 and corrected using atmospheric temperature and p jones 1983 shown as 15 vegetation transpiration is estimated by modified p m equation monteith 1965 shown as 11 soil evaporation is derived using principles based on potential soil evaporation and complementary relationship assumptions bouchet 1962 and shown as 12 the specific pm mu model parameterization scheme can be found in mu et al 2007 mu et al 2011 13 f c evi e v i min ev i max e v i min 14 r v c l m t min m vpd 15 r tot 107 0 1 0 273 15 t 293 15 1 75 101300 p 2 4 eddy covariance flux towers to verify the performance of the three models in china 21 flux sites that contain seven types of underlying surfaces were selected flux data obtained from heihe river basin data sharing platform http data casnw net portal chinaflux net http www chinaflux org asiaflux net http www asiaflux net and lathuileflux net https fluxnet fluxdata org data la thuile dataset huang et al 2008 li et al 2009 guan et al 2009 the geographical locations and specific information of the 21 flux stations are shown in table 1 and fig 2 these flux sites provide continuous observations of h2o heat and co2 concentration using open path ec analyzer and 3d sonic anemometer to capture wind speed in 10 hz data processing and quality control were performed using eddypro software package to get 30 min water and heat flux foken et al 2004 liu et al 2011 since ec observations have energy closure problems le h rn g the residual of the energy balance re was calculated to correct the energy closure twine et al 2000 in addition to these flux station observations daman station in heihe river basin has continuous stable isotope monitoring modell1102 i picarro inc the heights of the two air inlets of the system are installed at 0 5 m and 1 5 m above the corn canopy and the sampling frequency is 0 2 hz soil evaporation water vapor δe calculation using c g model based on conservation of isotope mass craig and gordon 1965 and vegetation transpiration water vapor δt was determined based on the isotope steady state assumption moreira et al 1997 the keeling plot method was used for the determination of system evapotranspiration water vapor isotope δet huang and wen 2014 wen et al 2016 table 1 provides specific information and energy closures about the 21 flux sites these flux sites cover multiple typical land cover types and climate zones 2 5 remote sensing and meteorological data source since the pm mu model is based on modis data products to ensure the comparability of the three models we used the modis data source at a spatial resolution of 1 km for the three models also for the meteorological factors the same inputs for three models were used in addition in order to reveal the physical mechanism and match the time scales of the three models we compared the three two source models with instantaneous values in the satellite passing time note that the comparison of various rs based et model in instantaneous could avoid the uncertainty caused by expanding temporal scale the modis products used in this study included mod11 land surface temperature product wang et al 2008 mod12 landuse product friedl et al 2002 mod13 ndvi evi product huete et al 2002 mod15 lai product myneni et al 2002 for missing or unreliable ndvi at each 1 km pixel scale we filled with the method proposed by zhao et al 2005 mod43 surface albedo product jin 2003a lucht et al 2000 salomon et al 2006 six cloud free days were selected in 2015 to run and test the three models i e 14 april 5 june 2 july 12 august 2 october 28 october doys day of year 104 156 183 224 275 301 respectively the meteorological factors in 817 ground meteorological stations across china were downloaded from china meteorological science data sharing service network platform http data cma cn daily meteorological data included ra u ta vpd and rh 3 results and analysis 3 1 model performance and validation to verify the model performance at the pixel scale the flux station used the average flux in the upwind source area gonzalez et al 2009 li et al 2008 fig 3 shows the scatter plots of rn and g compared with 21 ec sites and fig 4 shows the scatter plots of le and h estimated by three type two source models with measured values table 2 lists the verification statistical parameters the validation results represent the overall performance of the three models in various surface conditions and climatic regions from table 2 the rmse of 20 40 w m2 for rn and 5 20 w m2 for g the absolute value of bias all below 30 w m2 while the results showed a slight overestimation of rn average bias was 6 3 w m2 over the six day period and g average bias was 2 9 w m2 during the six examined days compared with ground observations for le and h the three models showed completely different performances the average rmse of le was 44 5 w m2 and 46 0 w m2 of h for tseb rmse of le was 38 7 w m2 and 40 0 w m2 of h for m pcaca rmse of le was 61 4 w m2 and 53 4 w m2 of h for pm mu in the six test days overall the m pcaca performed best for le estimation followed by tseb while pm mu performed the worst note that tseb provided a similar accuracy to the m pcaca but the error of pm mu was much larger than the other two models from bias results the tseb overestimated le average bias was 16 5 w m2 and underestimated h average bias was 8 9 w m2 in most cases on the contrary m pcaca underestimated le average bias was 16 4 w m2 and overestimated h average bias was 8 w m2 in most cases this over under estimation stemmed from the different mechanisms of the two models long et al 2012b demonstrated that over under estimation of the theoretical boundary could lead to over under production of le of ttme model while tseb was originally designed to improve the estimation of h le was estimated by the residual of the energy balance therefore the le performance of tseb was slightly poorer than m pcaca and the overestimation of le may have been caused by overestimating the αpt in the iteration process related studies have shown similar results where yang et al 2015a yang et al 2015b compared htem tseb and mod16 in heihe river basin and found that htem underestimated le by about 15 7 w m2 tseb model slightly overestimated le 4 8 w m2 and underestimated h about 22 8 w m2 yang et al 2015 used eteml to calculate the latent heat flux and showed le was slightly underestimated by 6 w m2 and h was overestimated by 30 w m2 at the smacex site the pm mu model relying on p m formula and surface meteorological factors resulted in the largest error and worst model performance average rmse of le and h exceeding 50 w m2 but unlike the m pcaca and tseb pm mu did not show a clear tendency to over underestimate of le and h in general although the three models are based on different parameterization schemes and model physics all three models showed comparable skills to the le and h estimation at large scales which contained various surface conditions and climates 3 2 spatial distribution of le and lev le values in various surface conditions fig 5 shows the spatial distribution of le mapped by three models in doy 104 and doy 224 table 3 shows the le and lev le values simulated by the three models for different types of underlying surfaces and fig 6 a shows the boxplot of le values due to higher temperature and vegetation coverage the le values in doy 224 were higher than doy 104 in most areas the three models provided very similar spatial patterns of le from different climates and geographical divisions china s terrestrial le changes significantly and presents obvious zonal distribution characteristics in the northwest arid and cold regions le is significantly lower than southeast humid and warm area the highest le values occur in tropical regions in south of china average of 358 2 w m2 in six test days same bellow followed by temperate regions and forest regions in the northeast china 304 9 w m2 while inner mongolia qinghai province and tibet plateau have the lowest le values due to lower ta and large areas of bare soil 112 4 w m2 seen from table 3 and fig 6 a the underlying surface with sufficient water supply and higher vegetation coverage has the larger le values the largest le area is waterbody with an average le of 560 7 w m2 followed by wetlands 421 7 w m2 forest 299 2 w m2 farmland 264 5 w m2 grassland 229 1 w m2 urban 166 1 w m2 and desert 53 7 w m2 inter comparisons of the three model results of le the total average and standard deviation of le value were 295 3 w m2 and 198 4 w m2 for m pcaca 332 7 w m2 and 238 9 w m2 for tseb 301 4 w m2 and 245 3 w m2 for pm mu et algorithm respectively overall despite the existence of large uncertainties of the three models the spatial distribution and magnitude of annual le in china 35 8 w m2 9 6 w m2 the annual value was converted by the constant evaporative fraction method van niel et al 2012 was consistent with a large number of previous studies e g yao et al 2013 mu et al 2007 jung et al 2010 yao et al 2013 estimated the le in china based on the pm mu et algorithm they suggested the china average annual le was 28 7 1 1 w m2 the le in the south of china was significantly higher than in the north and indicates a slightly decreasing trend during 2001 2010 chen et al 2014 calculated the actual et in china using eight models based on modis data and their results showed that the average annual le varied 36 7 to 58 4 w m2 during 1982 2009 largest le value was in the subtropical and tropical region followed by temperate region and cold and arid regions with lowest le 3 3 the e and t partitioning of the three models fig 7 shows the spatial distribution of lev and les mapped by three models on doy 224 and fig 6 b shows the boxplot of lev le from fig 7 the spatial pattern of les and lev did not show much difference between tseb and m pcaca but pm mu showed a smaller range of spatial variation especially in eastern china in addition lev and les developed a completely different spatial distribution in southeast china due to higher vegetation coverage lev was relatively higher average 289 4 w m2 of three models same below but les was very low 55 7 w m2 however in northwest china les was relatively higher due to the large areas of bare soil 188 5 w m2 but lev was at a lower level 32 8 w m2 the positive relationship between lev and vegetation coverage and the negative relationship between les and vegetation coverage have been confirmed by a large number of previous studies e g xu et al 2018 wei et al 2017 yang and shang 2013 long and singh 2012b from the spatial pattern of lev le the distributions of lev le and lev were roughly the same similar to the spatial pattern of total le and vegetation coverage which proved the dominant role of t in the total et and the crucial effect of vegetation coverage for lev le in different underlying surfaces the value was significantly higher in areas with vegetation coverage the largest lev le value was forest with an average lev le of 0 83 followed by farmland 0 63 grassland 0 62 and wetland 0 58 while due to the lower vegetation coverage urban area 0 21 and desert 0 04 generate the lowest lev le values shown as fig 6 b and table 3 inter comparison of three models results of lev le showed that m pcaca and tseb obtained close results but it should be noted that in farmland pm mu give the lowest lev le estimation compared with m pcaca and tseb however in grassland pm mu give the highest lev le estimation among the three models shown as table 3 and fig 6 this demonstrated the unstable performance of pm mu in partitioning le on different underlying surfaces to investigate the e t partition performance of different models in china we compared the lev le values estimated by the three models with daman isotope ground observation station as shown in fig 8 a the average lev le measured by the isotope method was 0 71 in the six test days m pcaca produced the closest lev le values with 0 70 tseb showed a slight overestimation of lev le 0 74 while the pm mu significantly underestimated lev le 0 56 which was consistent with the pm mu farmland partition results present above results indicated that compared with the p m type model the model based on temperature decomposition can more accurately segment the available le tseb and m pcaca from the temporal scale all three models and isotope results demonstrated that the lev le values increased from doy 104 to doy 224 and decreased from doy 224 to doy 301 indicating the process of lev le gradually changing with the crop growth in different seasons it should be noted that the main crop type in the daman station is corn meaning the verification results of lev le represented only the model partition performance in corn farmland furthermore we expanded the study period from 6 days to 75 days in 2015 for the heihe river basin to further evaluate the et partition performance by three models applying the model in heihe river basin due to daman isotope station being within this region these test days cover a wide range of meteorological conditions and seasons could give a comprehensive understanding of the model performance in various meteorological settings fig 8 b presents the time series of measured lev le and estimated lev le values by three models in 75 test days from fig 8 b the lev le ranges from 0 15 to 0 88 with a median of 0 64 for measured values ranges from 0 17 to 0 89 with a median of 0 63 for m pcaca model ranges from 0 16 to 0 90 with a median of 0 70 for tseb model and ranges from 0 13 to 0 85 with a median of 0 59 for pm mu model in 75 test days validation statistical parameters in heihe river basin suggests similar performance when applying the three models in the entirety of china compared with stable water isotope observations the closest prediction is given by m pcaca model with the rmse of 0 095 and bias of 0 012 followed by tseb model with the rmse of 0 104 and bias of 0 023 with the similar with model performance in china lev le estimated by pm mu resulted in the largest deviation with measured values the rmse was 0 126 and bias was 0 098 in 75 test days the results indicate m pcaca and tseb model can accurately partition le but pm mu model didn t provide comparable performances with m pcaca and tseb 4 discussion 4 1 performance of three models for different underlying surfaces fig 9a and fig 9b show the scatter plot of three model predictions of le with ec observations in various surface conditions and fig 10 shows the box plot of rmse and bias distribution in forested areas the best performing model was the tseb rmse with 39 8 w m2 same as below followed by m pcaca 41 0 w m2 and pm mu 50 1 w m2 in agricultural wetland and grassland areas m pcaca 36 3 w m2 performed better than tseb 44 7 w m2 but pm mu 59 5 w m2 performed worst in this case pm mu provided the best simulation results in desert conditions 19 7 w m2 and waterbody areas 42 5 w m2 while it should be noted that in the urban area although the tseb obtained the best results 53 1 w m2 for this case none of the three models gave reliable forecasts furthermore the rmse values of various ec sites are close to previous rs based et study except for the urban area with most of them varying between 30 60 w m2 in ecosystem farmland forest and wetland which is within the similar range as the rmse results of this study e g chen et al 2020c southwest of china trapezoid framework rmse of 36 3 w m2 tang et al 2011 north china plain triangle framework rmse of 30 64 w m2 tang and li 2017 north china plain trapezoid framework rmse of 59 8 w m2 yang et al 2015a yang et al 2015b smacex trapezoid framework rmse of 59 0 w m2 yongmin et al 2018 hiwater three types two source models rmse of 76 0 w m2 song et al 2016 hiwater tseb rmse of 52 0 58 0 w m2 song et al 2018 hiwater tseb rmse of 77 0 112 0 w m2 choi et al 2009 smacex three types one source models rmse of 55 0 w m2 long and singh 2012b smacex trapezoid framework rmse of 45 6 w m2 yang and shang 2013 smacex trapezoid framework rmse of 31 1 w m2 in general tseb and m pcaca provided higher and comparable model performances in vegetation covered areas in producing le tseb exhibited a better simulation results at high lai and vegetation height area but this advantage diminished as vegetation cover decreased m pcaca had a relatively stable model performance on various underlying surface types while the pm mu showed some advantages in non vegetated areas and worst performance in vegetated areas 4 2 tseb model characteristics and uncertainty the differences in model performance were mainly due to the different mechanisms in model physics and assumptions table 4 summarizes the characteristics and uncertainties of the three two source models for different underlying surface types the tseb and m pcaca models had more accurate le estimates and e t partition results in the vegetation coverage area mainly due to both of these two types of models being based on the component temperature decomposition to separate available energy while the pm mu model is based on the p m formula and uses complementary relationships to obtain soil evaporation many previous studies have shown that the model based on component temperature decomposition more accurately describes the energy partition process e g huntingford et al 1995 choi et al 2009 yongmin et al 2018 compared the performances of tseb pt tseb tv ts and tseb pm in the heihe river basin and showed that the tseb pt and tseb tv ts performed significantly better than tseb pm in le production and partitioning this finding also was proven in yang et al 2015a yang et al 2015b therefore in the vegetation coverage area in order to obtain more reasonable le mapping and separation it s better to use a model based on lst decomposition tseb has some advantages in surface conditions which have higher lai and vegetation height i e forest but had poor performance in non vegetated areas i e desert and waterbody and the model performance started to deteriorate with lai and vegetation height decreases to explain this result we need to explore the model physical mechanisms the uncertainty of the tseb primarily comes from the following aspects 1 determination of the initial p t coefficient the initial p t coefficients were influenced by vpd u lai and vegetation height showed large differences in space this empirical parameter represented the combined effect of aerodynamic and vegetation attribute on vegetation transpiration yang et al 2015a 2015b a larger u and vpd will increase the p t coefficient and vice versa however since the p t formula only performed to estimate vegetation transpiration in tseb and therefore except the aerodynamic effect the initial p t setting did not fully consider the effect of vegetation physiology such as lai in tseb agam et al 2010 moreover it is obvious that there was a limitation in using one p t coefficient to represent different underlying surfaces especially according to previous reports the initial p t value 1 3 setting was lower in arid regions and higher in advection regions komatsu 2003 2 in the tseb iterative processes which develop positive les by reducing the p t coefficient but they overestimate lev does not cause the les to be negative and as a result the tseb tended to overestimate lev but underestimate les in most cases especially when the proportion of les was greater than lev usually this occurs in areas with high proportions of bare soil however when a region has a higher lai and vegetation height the lev was greater than les and this uncertainty of tseb was greatly reduced as a result the model performance would be greatly improved in comparison with bare soil area therefore the initial p t value setting can be appropriately increased in areas with high vegetation coverage and reduced in low vegetation coverage 3 many previous studies have indicated that tseb is very sensitive to impedance parameters rx rs and ra e g norman et al 1995 gan and gao 2015 yao et al 2017 the air impedance parameters are primary controlled by vegetation height wind speed and vpd parameter and highly variable both temporally and spatially while higher lai and vegetation height values are more conducive to reducing the uncertainty of impedance parameter calculations and obtaining more accurate simulations results this explains why tseb performs better in forest areas and poorly in low and non vegetation coverage areas from the model physical mechanism therefore in the future when applying tseb we recommend use of tseb in high lai and vegetation height areas and considering the large spatial variability of the p t coefficient one needs to carefully divide different underlying conditions and different climatic regions to determine the p t coefficient the best solution is to give a physically based expression of p t coefficient considering the combination effect of impedance and vegetation physiology 4 3 m pcaca model characteristics and uncertainty although m pcaca does not perform as well as the other two source models on some underlying surfaces i e in forest desert and waterbodies the value of the m pcaca model is that it provides acceptable performance in producing le and its partition on all types of underlying surfaces and it gives the best estimates in agricultural land wetland and grassland therefore m pcaca is a good choice when the research region contains various types of underlying surface conditions hanyu et al 2014 the wide applicability of m pcaca is due to the following reasons 1 m pcaca locates the theoretical boundary of lst fc trapezoid the advantage of theoretical boundaries is that it overcomes the uncertainty of relying on actual boundaries and selecting extreme pixels and furthermore using the theoretical boundary positioning one can make trapezoidal framework models applicable on a larger scale 2 within the theoretical lst fc trapezoid framework it covers various surface wetting conditions and various combinations of ts and tv previous studies have shown that there exist gradual transitions of equal soil moisture lines in the lst fc trapezoid which can reflect miscellaneous surface wet conditions carlson et al 1995 long and singh 2013 tang et al 2013 therefore the m pcaca model has robust performance in various types of surface conditions the uncertainty of the m pcaca mainly comes from the assumptions of the model 1 the model assumes that there is no influence of advection in the turbulent energy flux leading the m pcaca model to underestimate le in most cases shown as table 2 this phenomenon has also been widely reported by others e g yang and shang 2013 who used htem model to predict le in north china plain verification results showed that le was underestimated by 10 w m2 compared with weishan ec site song et al 2016 estimated energy balance in heihe river basin le was underestimated by 21 w m2 when advection was ignored 2 m pcaca assumes that lst is a non linear combination of ts and tv anderson et al 2007 norman et al 1995 it is noted that this assumption also exists in many rs based et models such as tseb and this does not necessarily reflect the actual situation of the surface ground and will cause systematic errors to the lst decomposition 3 although m pcaca uses theoretical extreme temperatures to locate the boundaries of lst fc trapezoids the calculation of theoretical extreme temperatures depends on spatial meteorological factors since the high resolution meteorological factors obtained from spatial interpolation or data sets these errors and uncertainty in the spatial interpolation or data sets will be accumulated in the determination of the theoretical temperature and then cause the positioning error of the upper and lower boundaries and then effect the calculation accuracy of et and partitioning overall these three reasons lead to the uncertainty of the m pcaca model subsequent research can further improve the accuracy of the trapezoidal framework model focusing on the consideration of advection and the accurate location of the theoretical boundary 4 4 pm mu model characteristics and uncertainty pm mu model is used to calculate time series modis et products here we apply the pm mu to the instantaneous values to ensure the comparability of the three models and this also avoids the uncertainty caused by the temporal scale change unlike tseb and m pcaca decomposing component temperatures to partition le pm mu estimates lev and les using a modified p m equation model results show the best performance in some extreme areas i e desert urban and waterbody and poor performance in vegetated areas this indicates that pm mu has an advantage in non vegetated areas but the model performance is unstable on different underlying surface types for desert and waterbody areas usually almost all of the available energy is used to generate le waterbody or h desert in the absence of vegetation cover le is only influenced by meteorological force factors i e wind speed vpd ta and surface available water the pm mu physical mechanism is based on meteorological factors to predict the potential et then uses the complementary relationship to calculate the actual et this model physical theoretical base is suitable for applying in meteorological dominant underlying surfaces so pm mu shows superiority in these areas since the pm mu does not require component temperature decomposition this type of model avoids complex temperature decomposition processes and is relatively simple to operate however the model in the vegetation coverage area performed significantly worse due to the model uncertainty caused by the mechanism the uncertainty of the pm mu mainly comes from the following aspects 1 pm mu primarily relies on meteorological factors ta and vpd to characterize the impact of soil moisture on actual et while tseb and pm mu use lst to reflect the soil water conditions higher lst with lower soil moisture and vice versa compared with meteorological factors lst has a faster response with soil moisture change and more physically relate to the surface wetness while meteorological factors exhibit very weak interactions with soil moisture especially in small regions but with heterogeneous surfaces long and singh 2010 on the other hand the spatial distribution of lst is more variable compared with meteorological factors and moreover limited meteorological factors do not fully reflect soil moisture restrictions therefore the les and lev mapped by pm mu shows a smaller range than tseb and m pcaca section 3 3 2 pm mu estimates the actual vegetation transpiration by calculating the potential vegetation transpiration and considering the stress of ta and vpd on stomatal impedance however using ta and vpd to downscale the potential transpiration will cause information overlap to some extent because vpd is determined by ta and a positive relationship between the vpd and ta 3 when using complementary relationships to estimate soil evaporation there is greater uncertainty in the determination of β in the original pm mu version mu recommended setting β to 100 mu et al 2007 but in later versions mu recommended setting it to 200 mu et al 2011 this shows that β is an empirical parameter and needs to be carefully calibrated yang et al 2015a yang et al 2015b analyzed the effects of temperature and relative humidity on β and recommended a setting of 1000 so 1000 was used here for calculation in this study fisher et al 2008 lei and yang 2010 however the model error due to the uncertainty of β is still inevitable subsequent studies may give more detailed calculation formulas based on the physical meaning of β to greatly reduce the model uncertainty it should be noted that none of the three models gives reliable le estimates in urban areas and indicated difficulty to quantify the impact of complex underlying conditions human activities and microclimate on et as a result unlike ecosystems which make full use of surface thermal infrared information vegetation properties and meteorological parameters can accurately produce land surface et urban areas need more detailed information about underlying information sources higher resolution remote sensing image and meteorological data in addition it is necessary to develop a customized remote sensing et model for urban areas although some scholars have proposed remote sensing models for urban et zhang et al 2015 2017 in comparison with ecosystems there is still minimal modeling of urban et 4 5 further discussion the different algorithm between the three models is an important reason for the discrepancy in model performance for example although the three models use the same rn and g algorithm the rn decomposition methods are quite different m pcaca partitions the total available energy based on lst decomposition zhang et al 2005 long and singh 2012b tseb uses beer s law to estimate rns and rnv norman et al 1995 anderson et al 1997 while pm mu only relies on the linear relationship between fc to divide rn see eq 11 12 mu et al 2007 2011 whether the simple linear energy partitioning method in pm mu can accurately partition rn still warrants further investigation but it will undoubtedly lead to systematic errors for rns and rnv estimation this could partly explain why the performance of the pm mu model is inferior to both m pcaca and tseb when compared with 21 flux stations therefore future improvements to the pm mu model should focus on optimizing the accurate segmentation of net radiant flux furthermore different input data sources also cause performance gaps between the three models m pcaca requires both remote sensing visible light near infrared and thermal infrared data sources tseb uses visible light and thermal infrared data in model operation while pm mu only relies on visible light data sources to produce les and lev the better model performance of m pcaca and the poor performance of pm mu confirms the importance of fusing multiple remote sensing data sources in mapping spatial et in addition different les and lev parameterization schemes are important reasons for the performance discrepancies between the three models under different underlying surfaces tseb performs better in areas with high vegetation coverage and lai due to tseb relies on the p t formula to estimate lev and gives a les prediction through energy residual method norman et al 1995 anderson et al 1997 usually lev is significantly higher than les in higher vegetation coverage areas and therefore this physical mechanism presents advantages in high vegetation coverage and lai areas however the pm mu model mainly relies on ground meteorological observations to estimate les and lev which is more effective in areas dominated by meteorological elements and available water water body and desert compared with tseb and pm mu m pcaca divides rn based on the trapezoidal framework theory zhang et al 2005 long and singh 2012b chen et al 2020c and relies upon bowen ratio method to estimate les and lev this model mechanism is more physically based bowen 1926 cook 2011 shuttleworth and wallace 2007 and therefore the performance of m pcaca model is robust and reliable in various underlying surface models finally it is worth to point out that the model comparison conduct in this study is based on the instantaneous scale in order to better reveal the different model physics however the ultimate goal of the rs based two source et model is to produce continuous global et data in spatial and temporal therefore although pm mu was lost to tseb and m pcaca for six days of test but due to pm mu does not require the rs based lst data it is suitable for generate the daily e and t products mu et al 2007 2011 this is caused by the remote sensing thermal infrared band is often affected by clouds the resolution of thermal infrared band usually lower than the visible light band in spatial usually 1 km and temporal usually larger than 1 day moreover some empirical parameter settings are based on the model developer s suggestion or default such as p t coefficient and β norman et al 1995 yang et al 2015a 2015b although this parameterization scheme has been verified based on ground observations this does not necessarily mean that these parameter settings are the most appropriate and the difference performance between the three models may be caused by the settings of these empirical parameters furthermore due to the limited test day ground ec sites and stable water isotope site available the characteristics and uncertainties of the three two source models may not be fully captured in this study future research could compare the three models at a longer temporal scale and more ground observation sites to give a deep insight about the various two source et models 5 conclusions this paper compares the performance of three types of two source models tseb m pcaca pm mu in estimating and partitioning of land et in china the four energy balance components were verified at 21 flux sites and t et value verified at daman isotope site in addition the differences in performances of the three models are compared in the seven underlying surface types the physical theory and limitations of the different models are analyzed and recommendations for model application and improvement are provided the main findings and conclusions of this article are as follows 1 for le estimation for 21 flux sites the best performance is by m pcaca rmse with 38 7 w m2 followed by tseb rmse with 44 5 w m2 but pm mu rmse with 61 4 w m2 gave the worst model prediction in most cases the m pcaca tends to overestimate h and underestimate le conversely the tseb tends to underestimate h and overestimate le from the verification results of daman isotope site both m pcaca and tseb which are based on lst decomposition give reliable t et estimates but the pm mu has a large error in partitioning of le 2 the le value is higher in areas with sufficient water supply i e water bodies and wetlands and lower in water scarce areas i e desert and le lev and lev le show similar spatial distributions in china higher in areas with higher vegetative coverage in southeast china and lower values in areas with lower vegetation coverage in northwestern china 3 the tseb is very suitable for applications in areas with high lai and vegetative height i e forest but the model performs poorly in areas with low or non vegetative coverage the uncertainty of the tseb mainly comes from the determination of the initial p t coefficient and the overestimation of lev caused by the iterative process 4 the m pcaca has stable model performance on various underlying surface types and gives the best estimates in wetland grassland and farmland areas therefore this type of model is recommended when the underlying surface type is more complicated however the uncertainty of the m pcaca is mainly due to the neglect of advection resulting in the underestimation of le and the systematic error caused by the uncertainty of the lst fc trapezoidal boundary positioning 5 compared with two types of temperature decomposition based models pm mu has relatively poor model performance of producing and partitioning of le in the vegetation coverage area but in the areas which are dominated by meteorological factors e g desert water body the pm mu gives the most accurate le estimate however the limitations of the pm mu are meteorological factors that do not correspond very well to soil moisture conditions and the errors caused by the β determination 6 due to the complex surface characteristics and the impact of human activities three types of two source models do not perform well in urban areas later studies need to customize a special rs based et model for urban areas credit authorship contribution statement han chen data curation formal analysis validation visualization software writing original draft writing review editing jinhui jeanne huang conceptualization methodology funding acquisition supervision writing review editing edward mcbean resources supervision conceptualization methodology writing review editing vijay p singh conceptualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors acknowledge the financial support of the national key r d program of china for this research under grant number 2016yfc04007009 we thank the anonymous reviewers for their valuable suggestions that allowed us to improve the paper appendix the surface energy balance equation is given as a1 g is calculated as empirical relationship with rn grimmond and oke 1999 kustas and daughtry 1990 a1 r h l e g a2 g 0 3 1 0 9 f c r n when the soil is fully dry it enters an extreme situation with no soil evaporation and crop transpiration and the soil moisture is close to the wilting coefficient based on the energy balance equation the extreme temperature expression of the dry bare point tsd is obtained from the following expression a3 t sd 0 7 s 0 1 α sd σ ε a t sky 4 ρ c p r sda t a ρ c p r sda 0 7 σ ε t a s d 3 when the vegetation status is gradually increased to full coverage the surface temperature is the canopy temperature the canopy surface temperature of the dry and completely covered vegetation points tvd has the following expression a4 t vd 0 97 s 0 1 α vd σ ε a t sky 4 ρ c p r vda t a p c p r vd 0 97 σ ε t avd 3 when the surface condition is fully wet it enters another extreme situation with no energy producing sensible heat flux all available energy rn g generates evaporation and the heat balance equation is a5 r n 1 0 3 l e wet bare ground surface temperature tsw has the following expression a6 t sw 0 7 s 0 1 α sw σ ε a t sky 4 ρ c p δ γ r swa t s w a d sw δ p c p γ r swa 0 7 σ ε t asw 3 when the vegetation status is gradually increased to full coverage the surface temperature is the canopy temperature surface temperatures of the wet covered canopy tvw has the following expression a7 t vw 0 97 s 0 1 α vw σ ε a t sky 4 ρ c p δ γ r vwa t v w a d vw δ p c p γ r vwa 0 97 σ ε t avw 3 in a3 a7 tsd tvd tsw tvw are the four theoretical extreme temperatures k s0 is the solar radiation w m2 α sd α vd α sw α vw are the surface albedo of four extreme pixels unitless ε a is the emissivity of atmosphere calculated by brutsaert 1975 s method unitless t sky is the sky equivalent temperature k which is a function of ta k and vpd hpa r sda r vda r swa r vwa are the aerodynamic impedance of the four extreme pixels s m which are estimated by kondo s 1994 method combined with paulson 1970 and webb s 1970 method tasd tavd tasw tavw are the mean surface temperature k of four theoretical extreme point σ is the stefen boltzmann constant 5 67 10 8 w m 2 k 4 dsw and dvw are the air saturated water vapor pressure difference in wet bare land and wet vegetation land pa rns and rnv are estimated by the exponential function of rn anderson et al 1997 given as a8 a9 a8 r nv r n 1 exp k l a i a9 r ns r n exp k l a i in a8 a9 k unitless is an extinction coefficient set as 0 6 according to impens and lemur 1969 ra is aerodynamic impedance s m calculated by the function of wind speed and roughness length li et al 2005 a10 r a i n z u d o z om ψ m i n z t d o z om ψ h k 2 u in a10 zu and zt are the measured height of u and ta do is displacement calculated by the canopy height do 2 3hc zom is calculated as zom 1 8hc zoh is the heat roughness length taken as zoh 1 7zom k is the von karman s constant 0 41 the ψh and ψm are heat stability functions and momentum stability functions respectively calculated by brutsaert 1982 method 
4587,remote sensing rs based two source models have been widely used to separate soil evaporation e and vegetation transpiration t in ecosystems alternative model assumptions and physical mechanisms employed in different two source models cause the difference in model performance understanding of the characteristics and limitations of alternative two source models is critical to ensure the most effective applications in various climatic zones and underlying surfaces this study investigated two types of land surface temperature lst decomposition based two source models namely two source energy balance model tseb and modified pixel component arranging and comparing algorithm m pcaca as well as a meteorological factors based penman monteith type model pm mu in the partitioning of e and t the three models were compared at 21 flux stations across china which included seven types of underlying surfaces and one isotope station the study demonstrated that all three models were applicable in a large scale study for latent heat flux le estimation overall m pcaca performed the best with average root mean square errors rmse of 38 7 w m2 while pm mu performs the worst with average rmse of 61 4 w m2 for et partitioning the two models based on lst decomposition tseb and m pcaca gave more reliable estimates compared with stable water isotope observations in addition verification results for the seven types of underlying surfaces showed that the tseb gave the best accuracy in the areas with high leaf area index lai and vegetation height e g forest while the pm mu had an advantage in the areas without vegetation e g deserts and water bodies due to the characteristics of the land surface temperature vegetation coverage lst fc trapezoidal framework the m pcaca model had the most stable model performance for various underlying surfaces and gave the best estimates in grassland wetland and farmland areas using a thorough discussion this study identified the sources of discrepancies induced by different physical mechanisms of three remote sensing based two source models this investigation provided insights to better understand the alternative two source models and provides guidance for model application keywords et partition two source model tseb m pcaca pm mu remote sensing 1 introduction accurate estimation of land evapotranspiration et and its partitions e and t are an important link to drought prediction precision irrigation plant productivity water resources management and allocation chen et al 2020a allen et al 2007 kustas and anderson 2009 wang and dickinson 2012 tian et al 2016 huang et al 2020 in particular t dominates et in high vegetation coverage areas and is closely related to the terrestrial co2 emission and then related to climate change jasechko et al 2013 huxman et al 2005 traditional measurement methods for e and t can only reflect surface water fluxes and energy balance fluxes at a single point scale such as eddy correlation ec method stable water isotope method lysimeter and sap flow meters e g chen et al 2020a 2020b trambouze et al 1998 baldocchi et al 1991 čermák et al 2004 wang et al 2010 tian et al 2017 but it is difficult to directly measure surface fluxes over large spatial scales however in recent years with the rapid development of remote sensing rs technology it has become feasible using remote sensing image information to retrieve ground surface parameters and combine physical models to estimate regional surface fluxes jasechko et al 2013 wang et al 2010 rs based surface flux models can be divided into single source models and two source models the single source models do not distinguish between soil evaporation and vegetation transpiration and consider that soil surface and vegetation canopy are from the same water vapor source such as surface energy balance system sebs su 2002 surface energy balance algorithm for land sebal bastiaanssen et al 1998 and mapping evapotranspiration with internalized calibration metric allen et al 2007 compared with single source models the two source schemes divide the et source into soil and vegetation sources and model physical mechanisms using a more advanced procedure than single source schemes to describe surface evaporation processes alternative rs based two source et models rely on different parameterization schemes and model assumptions but generally can be classified into two types of models one type of model is based on the land surface temperature lst to represent the land surface wetness therefore these models rely upon the decomposition of lst into soil surface temperature ts and vegetation canopy temperature tv and then estimation of e and t as a result researchers have proposed various two source models based on different temperature decomposition methods including the following models 1 use of two or multi angle thermal infrared observations to solve two equations about lst ts and tv jia et al 2003 developed an algorithm to separate two component temperatures from bi angular atsr 2 data song et al 2018 proposed a moderate resolution imaging spectroradiometer modis based dual temperature difference dtd model and verified its performance in the heihe river basin with the results showing that the mean absolute percent differences mapd were about 20 compared with measured fluxes however the limited thermal infrared sensors and information sources resulting in these models were not widely applied in past years therefore efforts were undertaken to decompose lst into ts and tv using one angle thermal infrared observation 2 decomposition of component temperature using an iterative method this type of model namely tseb was originally proposed by norman et al 1995 in the tseb the expression of vegetation transpiration was obtained using the priestley taylor p t expression and decomposed the lst based on an iterative method norman et al 1995 priestley 1972 gan and gao 2015 yang et al 2015a 2015b yongmin et al 2018 they considered vegetation transpiration as a function of vegetation coverage fc slope of air temperature ta saturated water vapor pressure es and vegetation net radiance flux rnv recently the tseb model was improved by applying the model for various surface conditions in a more efficient iterative process and with fewer parameter requirements colaizzi et al 2012 coupled the tseb with the p m equation and showed the new model was very suitably applied in advective semiarid areas gan and gao 2015 proposed to minimize the difference of ts as the iteration target which greatly improved the iteration efficiency and accuracy of tseb yao et al 2017 proposed a temperature based two source model based on tseb which greatly reduced the need for ground meteorological factors in general the tseb model has been widely used in different underlying situations and has led to good model performance according to massive reported research e g norman et al 1995 song et al 2016 2018 yang et al 2015a 2015b yongmin et al 2018 yao et al 2017 3 decomposing lst based on the lst fc trapezoid feature space method this type of model assumes that within the lst fc trapezoid framework there exist gradual excesses of iso soil moisture lines carlson et al 1995 long and singh 2012b yang and shang 2013 yang et al 2015a 2015b tang and li 2017 so the model first finds the theoretical or actual dry wet boundary of the lst fc trapezoid and then linearly interpolates the slope of each point inside the trapezoid to decompose lst into ts and tv some representative models include pixel component arranging and comparing algorithm pcaca developed by zhang et al 2005 and its revised version by chen et al 2020c two source trapezoid model for evapotranspiration ttme proposed by long and singh 2012b hybrid dual source scheme and trapezoid framework based et model htem proposed by yang and shang 2013 enhanced two source evapotranspiration model eteml conducted by yang et al 2015a these models showed comparable or better performance than tseb in some cases e g yang et al 2015a 2015b yongmin et al 2018 unlike the idea of component temperature decomposition another type of two source model estimates e and t using a modified p m formula this model is essentially the same as the classic shuttleworth wallace model at site scale since they both rely upon the impedance parameters between soil vegetation atmosphere to reflect water diffusion processes e g shuttleworth and wallace 1985 chen et al 2020a zhao et al 2016 the p m formula based model use rs visible band surface vegetation information and ground meteorological factors to map the e and t in spatial this model was first proposed by mu et al 2007 and considered that vegetation transpiration was constrained by ta and vapor pressure difference vpd and used complementary relationships to incorporate relative humidity to estimate soil evaporation han and tian 2018a 2018b 2020 mu et al 2007 2011 due to pm mu model does not require the thermal infrared information this type of model is very suitable for producing time series e and t data the mod16 et product has been widely validated in various surface conditions e g hu et al 2015 chang et al 2018 ramoelo et al 2014 in practical applications of two source models under specific climate and land cover setting it is important to understand the characteristics of different models efforts have been made to compare one source and two source models in several cloudless test days 2 6 test days through instantaneous remote sensing imagery for various vegetative cover and moisture conditions e g timmermans et al 2007 choi et al 2009 tang et al 2011 josé et al 2019 but inter comparisons of two source models are lacking although some previous studies have compared the performance of different two source models they are all applied at the watershed or regional scale in particular a large number of scholars focused on heihe watershed allied telemetry experimental research multi scale observation experiment on evapotranspiration hiwater musoexe in northwest china e g li et al 2012 yang et al 2015a yang et al 2015b song et al 2016 yao et al 2017 yongmin et al 2018 song et al 2018 and soil moisture atmosphere coupling experiment smacex in iowa u s e g long and singh 2012 choi et al 2009 gonzalez et al 2009 yang et al 2015a yang et al 2015b this leads to the comparison and analysis of alternative two source models limited to one or two types of surface conditions and model performance in various surface types are still unknown yang et al 2015a yang et al 2015b investigated the performance of htem tseb and pm mu models in the heihe river basin for six test days in 2012 and found that htem performed best and pm mu yielded the poorest estimation yongmin et al 2018 inter compared tseb pt tseb pm tseb tv ts in hiwater musoexe campaign for six test days with results showing that different lst decomposition methods would make a big difference to the soil latent heat fluxes les and vegetation latent heat fluxes lev tseb pt led to relatively reliable surface heat fluxes and all three models underestimated the ratio of t in total et t et the same with the ratio of vegetation latent heat flux in total latent heat flux lev le choi et al 2009 studied the tseb metric and trapezoid interpolation model tim in smacex and demonstrated that the tseb outperformed metric and tim until now there has been no identified research conducted that provided a comprehensive systematic two source model comparison in multiple types of climates underlying surfaces as a consequence there is still lacking of knowledge the physical mechanism discrepancy between the three models caused the difference performance in various surfaces to enhance the understanding of different two source models to produce et and partition into e and t this paper compares the performances of three types of classic two source models tseb represents an iteration based lst decomposition method m pcaca represents lst fc trapezoid framework based lst decomposition method pm mu represents p m formula based two source model on seven types of underlying surfaces the objectives of this article are to 1 explore the applicability of three types of two source models in estimating surface energy balance fluxes in china 2 analyze the spatial distribution of e t and et in different regions of china 3 develop greater insights into each model s physical mechanisms by comparing the differences in the performance of the three models in seven typical underlying surfaces finally it should be noted that the model comparison is based on the same meteorological factors and remote sensing imagery driving data to ensure the fairness and comparability between the different models tang et al 2011 yang et al 2015a 2015b yongmin et al 2018 2 methodology 2 1 tseb model the tseb model is a two source energy balance model that estimates le as a residual in the four energy balance components which were originally proposed by norman et al 1995 and revised by kustas and norman 1997 the structure diagram of tseb is present in fig 1 a in tseb rn is separated by soil and vegetation sources and each source follows the energy balance equation 1 r n r ns r nv 2 r ns h s l e s g 3 r nv h v l e v in 1 2 and 3 rn rns and rnv represent the total net radiation fluxes soil and vegetation net radiation fluxes w m2 respectively g is the soil heat flux w m2 for rn and g estimation the three models used the same algorithm in order to ensure that the three models have the same energy forces rn was calculated by nishida et al 2003 s method and g was estimated by empirical relations with rn grimmond and oke 1999 kustas and daughtry 1990 given as appendix a1 a2 lev and les are the vegetation and soil latent heat fluxes w m2 respectively hv and hs are the vegetation and soil sensible heat fluxes w m2 respectively for the impedance network system of the series model hv hs and h use the following parameterization scheme 4 h v ρ c p t v t av r x 5 h s ρ c p t s t av r s 6 h h c h s ρ c p t av t a r a in 4 6 ts and tv are the soil and vegetation surface temperature k tav is the canopy air space temperature k rx rs and ra are the impedance of vegetation canopy boundary source soil surface boundary source and heat diffusion s m the specific calculations of rx and rs are found in norman et al 1995 ra can be estimated by various meteorological factors radiation ra ta wind speed u etc li et al 2005 appendix a10 the calculation of rns and rnv are shown in kustas and norman 1995 and anderson et al 1997 appendix a8 a9 in 2 and 3 lev was estimated by priestley taylor p t formula shown in 7 while les is considered as a residual of energy balance equation 7 l e v α pt f c δ δ γ r nv in 7 αpt is the priestley taylor coefficient the initial value is set to 1 3 according to norman et al 1995 and agam et al 2010 fc is the fractional vegetation coverage calculated by enhanced vegetation index evi mu et al 2007 2011 δ is the slope of the saturated vapor pressure with ta pa k γ is the psychrometric constant approximately estimated as 0 066 kpa oc the tseb model uses an iterative method to decompose the component temperatures the relationships between lst with tv and ts is shown as 8 after norman et al 1995 anderson et al 2007 8 lst f c t v 4 1 f c t s 4 1 4 combining 4 to 8 gets the initial value of les however the les calculated by the residual method will have some unreasonable value such as les 0 which usually appears as condensation on the soil surface but this is impossible during the daytime this indicates that the selected initial p t coefficient overestimates the potential vegetation transpiration so there is a need to repeatedly iterate the p t value until les 0 once a reasonable p t value is determined lev and les can be easily solved 2 2 m pcaca model like the tseb model the mpcaca model also separates the land et by decomposing the component temperatures however different from the tseb the m pcaca uses the lst fc trapezoidal framework to get tv and ts the pcaca was originally proposed by zhang et al 2005 and revised by long and singh 2012b and chen et al 2020c in pcaca the determination of the lst fc trapezoidal theoretical boundary depends on the actual boundary however the shape of the lst fc scatter plot is trapezoidal only at a regional scale such as a watershed or a province this greatly limits the application scale of the pcaca therefore we have made appropriate improvements to the pcaca so that the new model can be applied to large scales the main improvement is that the m pcaca achieves theoretical boundary positioning which does not rely on the actual boundary the lst fc trapezoid framework and four extreme temperature distributions are shown in fig 1b the appendix discusses the specific calculation method to determine the four extreme temperatures of the lst fc trapezoid appendices a3 a7 once the theoretical boundary of the lst fc trapezoid is determined the slope of each internal scatter can be obtained by linear interpolation the m pcaca model uses the bowen ratio method to partition the available energy bowen 1926 cook 2011 shuttleworth and wallace 2007 vegetation canopy bowen ratio and soil surface bowen ratio can be determined by vegetation canopy temperature vegetation coverage trapezoid tv fc and soil surface temperature vegetation coverage trapezoid ts fc zhang et al 2005 long and singh 2012b chen et al 2020c 9 β s t sh t sl t sh t s 1 β v t vh t vl t vh t v 1 in 9 βs and βv are the soil and vegetation bowen ratios respectively unitless tsh and tsl are the upper boundary temperature and lower boundary temperature of ts fc trapezoidal k respectively tvh and tvl are the upper boundary temperature and lower boundary temperature of tv fc trapezoid k respectively the expression of les w m2 and lev w m2 are as 10 10 l e s r ns g 1 β s l e v r nv 1 β v 2 3 pm mu et algorithm the pm mu model has been improved from cleugh s model using a modified p m formula combined with modis data and meteorological factors to calculate e and t cleugh et al 2007 mu et al 2007 2011 based on cleugh s model mu et al 2007 made the following improvements 1 in the calculation of stomatal impedance rc the effects of ta and vpd constraints were considered 2 proposed the replacement of normalized difference vegetation index ndvi with enhanced vegetation index evi thereby improving the calculation accuracy of vegetation coverage 13 3 added a soil evaporation calculation module based on the complementary relationship the expressions of vegetation transpiration and soil evaporation are shown as 11 and 12 11 l e v δ r n f c ρ c p v p d r a δ γ 1 r v r a 12 l e s rh 100 vpd β δ r n 1 f c g ρ c p v p d r a δ γ 1 r tot r a in 11 and 12 ρ is the air density kg m3 cp is the specific air heat capacity j kg k vpd is the saturated vapor pressure difference hpa which is determined from the relationship between ta and vapor pressure p murray 1967 rh is the relative humidity β is an empirical parameter set to 1000 according to fisher et al 2008 rv is the stomatal resistance s m calculated by the potential stomatal resistance and corrected by ta and vpd shown as 14 mt min and m vpd are the function of minimum ta and vpd dang et al 1997 jarvis 1976 leuning 1995 respectively cl is the potential stomatal resistance per unit leaf area s m rtot is the total resistance of aerodynamic and vapor diffusion 1994van de griend 1994 which was calculated by the constant rtot set to 107 s m wallace and holwill 1997 and corrected using atmospheric temperature and p jones 1983 shown as 15 vegetation transpiration is estimated by modified p m equation monteith 1965 shown as 11 soil evaporation is derived using principles based on potential soil evaporation and complementary relationship assumptions bouchet 1962 and shown as 12 the specific pm mu model parameterization scheme can be found in mu et al 2007 mu et al 2011 13 f c evi e v i min ev i max e v i min 14 r v c l m t min m vpd 15 r tot 107 0 1 0 273 15 t 293 15 1 75 101300 p 2 4 eddy covariance flux towers to verify the performance of the three models in china 21 flux sites that contain seven types of underlying surfaces were selected flux data obtained from heihe river basin data sharing platform http data casnw net portal chinaflux net http www chinaflux org asiaflux net http www asiaflux net and lathuileflux net https fluxnet fluxdata org data la thuile dataset huang et al 2008 li et al 2009 guan et al 2009 the geographical locations and specific information of the 21 flux stations are shown in table 1 and fig 2 these flux sites provide continuous observations of h2o heat and co2 concentration using open path ec analyzer and 3d sonic anemometer to capture wind speed in 10 hz data processing and quality control were performed using eddypro software package to get 30 min water and heat flux foken et al 2004 liu et al 2011 since ec observations have energy closure problems le h rn g the residual of the energy balance re was calculated to correct the energy closure twine et al 2000 in addition to these flux station observations daman station in heihe river basin has continuous stable isotope monitoring modell1102 i picarro inc the heights of the two air inlets of the system are installed at 0 5 m and 1 5 m above the corn canopy and the sampling frequency is 0 2 hz soil evaporation water vapor δe calculation using c g model based on conservation of isotope mass craig and gordon 1965 and vegetation transpiration water vapor δt was determined based on the isotope steady state assumption moreira et al 1997 the keeling plot method was used for the determination of system evapotranspiration water vapor isotope δet huang and wen 2014 wen et al 2016 table 1 provides specific information and energy closures about the 21 flux sites these flux sites cover multiple typical land cover types and climate zones 2 5 remote sensing and meteorological data source since the pm mu model is based on modis data products to ensure the comparability of the three models we used the modis data source at a spatial resolution of 1 km for the three models also for the meteorological factors the same inputs for three models were used in addition in order to reveal the physical mechanism and match the time scales of the three models we compared the three two source models with instantaneous values in the satellite passing time note that the comparison of various rs based et model in instantaneous could avoid the uncertainty caused by expanding temporal scale the modis products used in this study included mod11 land surface temperature product wang et al 2008 mod12 landuse product friedl et al 2002 mod13 ndvi evi product huete et al 2002 mod15 lai product myneni et al 2002 for missing or unreliable ndvi at each 1 km pixel scale we filled with the method proposed by zhao et al 2005 mod43 surface albedo product jin 2003a lucht et al 2000 salomon et al 2006 six cloud free days were selected in 2015 to run and test the three models i e 14 april 5 june 2 july 12 august 2 october 28 october doys day of year 104 156 183 224 275 301 respectively the meteorological factors in 817 ground meteorological stations across china were downloaded from china meteorological science data sharing service network platform http data cma cn daily meteorological data included ra u ta vpd and rh 3 results and analysis 3 1 model performance and validation to verify the model performance at the pixel scale the flux station used the average flux in the upwind source area gonzalez et al 2009 li et al 2008 fig 3 shows the scatter plots of rn and g compared with 21 ec sites and fig 4 shows the scatter plots of le and h estimated by three type two source models with measured values table 2 lists the verification statistical parameters the validation results represent the overall performance of the three models in various surface conditions and climatic regions from table 2 the rmse of 20 40 w m2 for rn and 5 20 w m2 for g the absolute value of bias all below 30 w m2 while the results showed a slight overestimation of rn average bias was 6 3 w m2 over the six day period and g average bias was 2 9 w m2 during the six examined days compared with ground observations for le and h the three models showed completely different performances the average rmse of le was 44 5 w m2 and 46 0 w m2 of h for tseb rmse of le was 38 7 w m2 and 40 0 w m2 of h for m pcaca rmse of le was 61 4 w m2 and 53 4 w m2 of h for pm mu in the six test days overall the m pcaca performed best for le estimation followed by tseb while pm mu performed the worst note that tseb provided a similar accuracy to the m pcaca but the error of pm mu was much larger than the other two models from bias results the tseb overestimated le average bias was 16 5 w m2 and underestimated h average bias was 8 9 w m2 in most cases on the contrary m pcaca underestimated le average bias was 16 4 w m2 and overestimated h average bias was 8 w m2 in most cases this over under estimation stemmed from the different mechanisms of the two models long et al 2012b demonstrated that over under estimation of the theoretical boundary could lead to over under production of le of ttme model while tseb was originally designed to improve the estimation of h le was estimated by the residual of the energy balance therefore the le performance of tseb was slightly poorer than m pcaca and the overestimation of le may have been caused by overestimating the αpt in the iteration process related studies have shown similar results where yang et al 2015a yang et al 2015b compared htem tseb and mod16 in heihe river basin and found that htem underestimated le by about 15 7 w m2 tseb model slightly overestimated le 4 8 w m2 and underestimated h about 22 8 w m2 yang et al 2015 used eteml to calculate the latent heat flux and showed le was slightly underestimated by 6 w m2 and h was overestimated by 30 w m2 at the smacex site the pm mu model relying on p m formula and surface meteorological factors resulted in the largest error and worst model performance average rmse of le and h exceeding 50 w m2 but unlike the m pcaca and tseb pm mu did not show a clear tendency to over underestimate of le and h in general although the three models are based on different parameterization schemes and model physics all three models showed comparable skills to the le and h estimation at large scales which contained various surface conditions and climates 3 2 spatial distribution of le and lev le values in various surface conditions fig 5 shows the spatial distribution of le mapped by three models in doy 104 and doy 224 table 3 shows the le and lev le values simulated by the three models for different types of underlying surfaces and fig 6 a shows the boxplot of le values due to higher temperature and vegetation coverage the le values in doy 224 were higher than doy 104 in most areas the three models provided very similar spatial patterns of le from different climates and geographical divisions china s terrestrial le changes significantly and presents obvious zonal distribution characteristics in the northwest arid and cold regions le is significantly lower than southeast humid and warm area the highest le values occur in tropical regions in south of china average of 358 2 w m2 in six test days same bellow followed by temperate regions and forest regions in the northeast china 304 9 w m2 while inner mongolia qinghai province and tibet plateau have the lowest le values due to lower ta and large areas of bare soil 112 4 w m2 seen from table 3 and fig 6 a the underlying surface with sufficient water supply and higher vegetation coverage has the larger le values the largest le area is waterbody with an average le of 560 7 w m2 followed by wetlands 421 7 w m2 forest 299 2 w m2 farmland 264 5 w m2 grassland 229 1 w m2 urban 166 1 w m2 and desert 53 7 w m2 inter comparisons of the three model results of le the total average and standard deviation of le value were 295 3 w m2 and 198 4 w m2 for m pcaca 332 7 w m2 and 238 9 w m2 for tseb 301 4 w m2 and 245 3 w m2 for pm mu et algorithm respectively overall despite the existence of large uncertainties of the three models the spatial distribution and magnitude of annual le in china 35 8 w m2 9 6 w m2 the annual value was converted by the constant evaporative fraction method van niel et al 2012 was consistent with a large number of previous studies e g yao et al 2013 mu et al 2007 jung et al 2010 yao et al 2013 estimated the le in china based on the pm mu et algorithm they suggested the china average annual le was 28 7 1 1 w m2 the le in the south of china was significantly higher than in the north and indicates a slightly decreasing trend during 2001 2010 chen et al 2014 calculated the actual et in china using eight models based on modis data and their results showed that the average annual le varied 36 7 to 58 4 w m2 during 1982 2009 largest le value was in the subtropical and tropical region followed by temperate region and cold and arid regions with lowest le 3 3 the e and t partitioning of the three models fig 7 shows the spatial distribution of lev and les mapped by three models on doy 224 and fig 6 b shows the boxplot of lev le from fig 7 the spatial pattern of les and lev did not show much difference between tseb and m pcaca but pm mu showed a smaller range of spatial variation especially in eastern china in addition lev and les developed a completely different spatial distribution in southeast china due to higher vegetation coverage lev was relatively higher average 289 4 w m2 of three models same below but les was very low 55 7 w m2 however in northwest china les was relatively higher due to the large areas of bare soil 188 5 w m2 but lev was at a lower level 32 8 w m2 the positive relationship between lev and vegetation coverage and the negative relationship between les and vegetation coverage have been confirmed by a large number of previous studies e g xu et al 2018 wei et al 2017 yang and shang 2013 long and singh 2012b from the spatial pattern of lev le the distributions of lev le and lev were roughly the same similar to the spatial pattern of total le and vegetation coverage which proved the dominant role of t in the total et and the crucial effect of vegetation coverage for lev le in different underlying surfaces the value was significantly higher in areas with vegetation coverage the largest lev le value was forest with an average lev le of 0 83 followed by farmland 0 63 grassland 0 62 and wetland 0 58 while due to the lower vegetation coverage urban area 0 21 and desert 0 04 generate the lowest lev le values shown as fig 6 b and table 3 inter comparison of three models results of lev le showed that m pcaca and tseb obtained close results but it should be noted that in farmland pm mu give the lowest lev le estimation compared with m pcaca and tseb however in grassland pm mu give the highest lev le estimation among the three models shown as table 3 and fig 6 this demonstrated the unstable performance of pm mu in partitioning le on different underlying surfaces to investigate the e t partition performance of different models in china we compared the lev le values estimated by the three models with daman isotope ground observation station as shown in fig 8 a the average lev le measured by the isotope method was 0 71 in the six test days m pcaca produced the closest lev le values with 0 70 tseb showed a slight overestimation of lev le 0 74 while the pm mu significantly underestimated lev le 0 56 which was consistent with the pm mu farmland partition results present above results indicated that compared with the p m type model the model based on temperature decomposition can more accurately segment the available le tseb and m pcaca from the temporal scale all three models and isotope results demonstrated that the lev le values increased from doy 104 to doy 224 and decreased from doy 224 to doy 301 indicating the process of lev le gradually changing with the crop growth in different seasons it should be noted that the main crop type in the daman station is corn meaning the verification results of lev le represented only the model partition performance in corn farmland furthermore we expanded the study period from 6 days to 75 days in 2015 for the heihe river basin to further evaluate the et partition performance by three models applying the model in heihe river basin due to daman isotope station being within this region these test days cover a wide range of meteorological conditions and seasons could give a comprehensive understanding of the model performance in various meteorological settings fig 8 b presents the time series of measured lev le and estimated lev le values by three models in 75 test days from fig 8 b the lev le ranges from 0 15 to 0 88 with a median of 0 64 for measured values ranges from 0 17 to 0 89 with a median of 0 63 for m pcaca model ranges from 0 16 to 0 90 with a median of 0 70 for tseb model and ranges from 0 13 to 0 85 with a median of 0 59 for pm mu model in 75 test days validation statistical parameters in heihe river basin suggests similar performance when applying the three models in the entirety of china compared with stable water isotope observations the closest prediction is given by m pcaca model with the rmse of 0 095 and bias of 0 012 followed by tseb model with the rmse of 0 104 and bias of 0 023 with the similar with model performance in china lev le estimated by pm mu resulted in the largest deviation with measured values the rmse was 0 126 and bias was 0 098 in 75 test days the results indicate m pcaca and tseb model can accurately partition le but pm mu model didn t provide comparable performances with m pcaca and tseb 4 discussion 4 1 performance of three models for different underlying surfaces fig 9a and fig 9b show the scatter plot of three model predictions of le with ec observations in various surface conditions and fig 10 shows the box plot of rmse and bias distribution in forested areas the best performing model was the tseb rmse with 39 8 w m2 same as below followed by m pcaca 41 0 w m2 and pm mu 50 1 w m2 in agricultural wetland and grassland areas m pcaca 36 3 w m2 performed better than tseb 44 7 w m2 but pm mu 59 5 w m2 performed worst in this case pm mu provided the best simulation results in desert conditions 19 7 w m2 and waterbody areas 42 5 w m2 while it should be noted that in the urban area although the tseb obtained the best results 53 1 w m2 for this case none of the three models gave reliable forecasts furthermore the rmse values of various ec sites are close to previous rs based et study except for the urban area with most of them varying between 30 60 w m2 in ecosystem farmland forest and wetland which is within the similar range as the rmse results of this study e g chen et al 2020c southwest of china trapezoid framework rmse of 36 3 w m2 tang et al 2011 north china plain triangle framework rmse of 30 64 w m2 tang and li 2017 north china plain trapezoid framework rmse of 59 8 w m2 yang et al 2015a yang et al 2015b smacex trapezoid framework rmse of 59 0 w m2 yongmin et al 2018 hiwater three types two source models rmse of 76 0 w m2 song et al 2016 hiwater tseb rmse of 52 0 58 0 w m2 song et al 2018 hiwater tseb rmse of 77 0 112 0 w m2 choi et al 2009 smacex three types one source models rmse of 55 0 w m2 long and singh 2012b smacex trapezoid framework rmse of 45 6 w m2 yang and shang 2013 smacex trapezoid framework rmse of 31 1 w m2 in general tseb and m pcaca provided higher and comparable model performances in vegetation covered areas in producing le tseb exhibited a better simulation results at high lai and vegetation height area but this advantage diminished as vegetation cover decreased m pcaca had a relatively stable model performance on various underlying surface types while the pm mu showed some advantages in non vegetated areas and worst performance in vegetated areas 4 2 tseb model characteristics and uncertainty the differences in model performance were mainly due to the different mechanisms in model physics and assumptions table 4 summarizes the characteristics and uncertainties of the three two source models for different underlying surface types the tseb and m pcaca models had more accurate le estimates and e t partition results in the vegetation coverage area mainly due to both of these two types of models being based on the component temperature decomposition to separate available energy while the pm mu model is based on the p m formula and uses complementary relationships to obtain soil evaporation many previous studies have shown that the model based on component temperature decomposition more accurately describes the energy partition process e g huntingford et al 1995 choi et al 2009 yongmin et al 2018 compared the performances of tseb pt tseb tv ts and tseb pm in the heihe river basin and showed that the tseb pt and tseb tv ts performed significantly better than tseb pm in le production and partitioning this finding also was proven in yang et al 2015a yang et al 2015b therefore in the vegetation coverage area in order to obtain more reasonable le mapping and separation it s better to use a model based on lst decomposition tseb has some advantages in surface conditions which have higher lai and vegetation height i e forest but had poor performance in non vegetated areas i e desert and waterbody and the model performance started to deteriorate with lai and vegetation height decreases to explain this result we need to explore the model physical mechanisms the uncertainty of the tseb primarily comes from the following aspects 1 determination of the initial p t coefficient the initial p t coefficients were influenced by vpd u lai and vegetation height showed large differences in space this empirical parameter represented the combined effect of aerodynamic and vegetation attribute on vegetation transpiration yang et al 2015a 2015b a larger u and vpd will increase the p t coefficient and vice versa however since the p t formula only performed to estimate vegetation transpiration in tseb and therefore except the aerodynamic effect the initial p t setting did not fully consider the effect of vegetation physiology such as lai in tseb agam et al 2010 moreover it is obvious that there was a limitation in using one p t coefficient to represent different underlying surfaces especially according to previous reports the initial p t value 1 3 setting was lower in arid regions and higher in advection regions komatsu 2003 2 in the tseb iterative processes which develop positive les by reducing the p t coefficient but they overestimate lev does not cause the les to be negative and as a result the tseb tended to overestimate lev but underestimate les in most cases especially when the proportion of les was greater than lev usually this occurs in areas with high proportions of bare soil however when a region has a higher lai and vegetation height the lev was greater than les and this uncertainty of tseb was greatly reduced as a result the model performance would be greatly improved in comparison with bare soil area therefore the initial p t value setting can be appropriately increased in areas with high vegetation coverage and reduced in low vegetation coverage 3 many previous studies have indicated that tseb is very sensitive to impedance parameters rx rs and ra e g norman et al 1995 gan and gao 2015 yao et al 2017 the air impedance parameters are primary controlled by vegetation height wind speed and vpd parameter and highly variable both temporally and spatially while higher lai and vegetation height values are more conducive to reducing the uncertainty of impedance parameter calculations and obtaining more accurate simulations results this explains why tseb performs better in forest areas and poorly in low and non vegetation coverage areas from the model physical mechanism therefore in the future when applying tseb we recommend use of tseb in high lai and vegetation height areas and considering the large spatial variability of the p t coefficient one needs to carefully divide different underlying conditions and different climatic regions to determine the p t coefficient the best solution is to give a physically based expression of p t coefficient considering the combination effect of impedance and vegetation physiology 4 3 m pcaca model characteristics and uncertainty although m pcaca does not perform as well as the other two source models on some underlying surfaces i e in forest desert and waterbodies the value of the m pcaca model is that it provides acceptable performance in producing le and its partition on all types of underlying surfaces and it gives the best estimates in agricultural land wetland and grassland therefore m pcaca is a good choice when the research region contains various types of underlying surface conditions hanyu et al 2014 the wide applicability of m pcaca is due to the following reasons 1 m pcaca locates the theoretical boundary of lst fc trapezoid the advantage of theoretical boundaries is that it overcomes the uncertainty of relying on actual boundaries and selecting extreme pixels and furthermore using the theoretical boundary positioning one can make trapezoidal framework models applicable on a larger scale 2 within the theoretical lst fc trapezoid framework it covers various surface wetting conditions and various combinations of ts and tv previous studies have shown that there exist gradual transitions of equal soil moisture lines in the lst fc trapezoid which can reflect miscellaneous surface wet conditions carlson et al 1995 long and singh 2013 tang et al 2013 therefore the m pcaca model has robust performance in various types of surface conditions the uncertainty of the m pcaca mainly comes from the assumptions of the model 1 the model assumes that there is no influence of advection in the turbulent energy flux leading the m pcaca model to underestimate le in most cases shown as table 2 this phenomenon has also been widely reported by others e g yang and shang 2013 who used htem model to predict le in north china plain verification results showed that le was underestimated by 10 w m2 compared with weishan ec site song et al 2016 estimated energy balance in heihe river basin le was underestimated by 21 w m2 when advection was ignored 2 m pcaca assumes that lst is a non linear combination of ts and tv anderson et al 2007 norman et al 1995 it is noted that this assumption also exists in many rs based et models such as tseb and this does not necessarily reflect the actual situation of the surface ground and will cause systematic errors to the lst decomposition 3 although m pcaca uses theoretical extreme temperatures to locate the boundaries of lst fc trapezoids the calculation of theoretical extreme temperatures depends on spatial meteorological factors since the high resolution meteorological factors obtained from spatial interpolation or data sets these errors and uncertainty in the spatial interpolation or data sets will be accumulated in the determination of the theoretical temperature and then cause the positioning error of the upper and lower boundaries and then effect the calculation accuracy of et and partitioning overall these three reasons lead to the uncertainty of the m pcaca model subsequent research can further improve the accuracy of the trapezoidal framework model focusing on the consideration of advection and the accurate location of the theoretical boundary 4 4 pm mu model characteristics and uncertainty pm mu model is used to calculate time series modis et products here we apply the pm mu to the instantaneous values to ensure the comparability of the three models and this also avoids the uncertainty caused by the temporal scale change unlike tseb and m pcaca decomposing component temperatures to partition le pm mu estimates lev and les using a modified p m equation model results show the best performance in some extreme areas i e desert urban and waterbody and poor performance in vegetated areas this indicates that pm mu has an advantage in non vegetated areas but the model performance is unstable on different underlying surface types for desert and waterbody areas usually almost all of the available energy is used to generate le waterbody or h desert in the absence of vegetation cover le is only influenced by meteorological force factors i e wind speed vpd ta and surface available water the pm mu physical mechanism is based on meteorological factors to predict the potential et then uses the complementary relationship to calculate the actual et this model physical theoretical base is suitable for applying in meteorological dominant underlying surfaces so pm mu shows superiority in these areas since the pm mu does not require component temperature decomposition this type of model avoids complex temperature decomposition processes and is relatively simple to operate however the model in the vegetation coverage area performed significantly worse due to the model uncertainty caused by the mechanism the uncertainty of the pm mu mainly comes from the following aspects 1 pm mu primarily relies on meteorological factors ta and vpd to characterize the impact of soil moisture on actual et while tseb and pm mu use lst to reflect the soil water conditions higher lst with lower soil moisture and vice versa compared with meteorological factors lst has a faster response with soil moisture change and more physically relate to the surface wetness while meteorological factors exhibit very weak interactions with soil moisture especially in small regions but with heterogeneous surfaces long and singh 2010 on the other hand the spatial distribution of lst is more variable compared with meteorological factors and moreover limited meteorological factors do not fully reflect soil moisture restrictions therefore the les and lev mapped by pm mu shows a smaller range than tseb and m pcaca section 3 3 2 pm mu estimates the actual vegetation transpiration by calculating the potential vegetation transpiration and considering the stress of ta and vpd on stomatal impedance however using ta and vpd to downscale the potential transpiration will cause information overlap to some extent because vpd is determined by ta and a positive relationship between the vpd and ta 3 when using complementary relationships to estimate soil evaporation there is greater uncertainty in the determination of β in the original pm mu version mu recommended setting β to 100 mu et al 2007 but in later versions mu recommended setting it to 200 mu et al 2011 this shows that β is an empirical parameter and needs to be carefully calibrated yang et al 2015a yang et al 2015b analyzed the effects of temperature and relative humidity on β and recommended a setting of 1000 so 1000 was used here for calculation in this study fisher et al 2008 lei and yang 2010 however the model error due to the uncertainty of β is still inevitable subsequent studies may give more detailed calculation formulas based on the physical meaning of β to greatly reduce the model uncertainty it should be noted that none of the three models gives reliable le estimates in urban areas and indicated difficulty to quantify the impact of complex underlying conditions human activities and microclimate on et as a result unlike ecosystems which make full use of surface thermal infrared information vegetation properties and meteorological parameters can accurately produce land surface et urban areas need more detailed information about underlying information sources higher resolution remote sensing image and meteorological data in addition it is necessary to develop a customized remote sensing et model for urban areas although some scholars have proposed remote sensing models for urban et zhang et al 2015 2017 in comparison with ecosystems there is still minimal modeling of urban et 4 5 further discussion the different algorithm between the three models is an important reason for the discrepancy in model performance for example although the three models use the same rn and g algorithm the rn decomposition methods are quite different m pcaca partitions the total available energy based on lst decomposition zhang et al 2005 long and singh 2012b tseb uses beer s law to estimate rns and rnv norman et al 1995 anderson et al 1997 while pm mu only relies on the linear relationship between fc to divide rn see eq 11 12 mu et al 2007 2011 whether the simple linear energy partitioning method in pm mu can accurately partition rn still warrants further investigation but it will undoubtedly lead to systematic errors for rns and rnv estimation this could partly explain why the performance of the pm mu model is inferior to both m pcaca and tseb when compared with 21 flux stations therefore future improvements to the pm mu model should focus on optimizing the accurate segmentation of net radiant flux furthermore different input data sources also cause performance gaps between the three models m pcaca requires both remote sensing visible light near infrared and thermal infrared data sources tseb uses visible light and thermal infrared data in model operation while pm mu only relies on visible light data sources to produce les and lev the better model performance of m pcaca and the poor performance of pm mu confirms the importance of fusing multiple remote sensing data sources in mapping spatial et in addition different les and lev parameterization schemes are important reasons for the performance discrepancies between the three models under different underlying surfaces tseb performs better in areas with high vegetation coverage and lai due to tseb relies on the p t formula to estimate lev and gives a les prediction through energy residual method norman et al 1995 anderson et al 1997 usually lev is significantly higher than les in higher vegetation coverage areas and therefore this physical mechanism presents advantages in high vegetation coverage and lai areas however the pm mu model mainly relies on ground meteorological observations to estimate les and lev which is more effective in areas dominated by meteorological elements and available water water body and desert compared with tseb and pm mu m pcaca divides rn based on the trapezoidal framework theory zhang et al 2005 long and singh 2012b chen et al 2020c and relies upon bowen ratio method to estimate les and lev this model mechanism is more physically based bowen 1926 cook 2011 shuttleworth and wallace 2007 and therefore the performance of m pcaca model is robust and reliable in various underlying surface models finally it is worth to point out that the model comparison conduct in this study is based on the instantaneous scale in order to better reveal the different model physics however the ultimate goal of the rs based two source et model is to produce continuous global et data in spatial and temporal therefore although pm mu was lost to tseb and m pcaca for six days of test but due to pm mu does not require the rs based lst data it is suitable for generate the daily e and t products mu et al 2007 2011 this is caused by the remote sensing thermal infrared band is often affected by clouds the resolution of thermal infrared band usually lower than the visible light band in spatial usually 1 km and temporal usually larger than 1 day moreover some empirical parameter settings are based on the model developer s suggestion or default such as p t coefficient and β norman et al 1995 yang et al 2015a 2015b although this parameterization scheme has been verified based on ground observations this does not necessarily mean that these parameter settings are the most appropriate and the difference performance between the three models may be caused by the settings of these empirical parameters furthermore due to the limited test day ground ec sites and stable water isotope site available the characteristics and uncertainties of the three two source models may not be fully captured in this study future research could compare the three models at a longer temporal scale and more ground observation sites to give a deep insight about the various two source et models 5 conclusions this paper compares the performance of three types of two source models tseb m pcaca pm mu in estimating and partitioning of land et in china the four energy balance components were verified at 21 flux sites and t et value verified at daman isotope site in addition the differences in performances of the three models are compared in the seven underlying surface types the physical theory and limitations of the different models are analyzed and recommendations for model application and improvement are provided the main findings and conclusions of this article are as follows 1 for le estimation for 21 flux sites the best performance is by m pcaca rmse with 38 7 w m2 followed by tseb rmse with 44 5 w m2 but pm mu rmse with 61 4 w m2 gave the worst model prediction in most cases the m pcaca tends to overestimate h and underestimate le conversely the tseb tends to underestimate h and overestimate le from the verification results of daman isotope site both m pcaca and tseb which are based on lst decomposition give reliable t et estimates but the pm mu has a large error in partitioning of le 2 the le value is higher in areas with sufficient water supply i e water bodies and wetlands and lower in water scarce areas i e desert and le lev and lev le show similar spatial distributions in china higher in areas with higher vegetative coverage in southeast china and lower values in areas with lower vegetation coverage in northwestern china 3 the tseb is very suitable for applications in areas with high lai and vegetative height i e forest but the model performs poorly in areas with low or non vegetative coverage the uncertainty of the tseb mainly comes from the determination of the initial p t coefficient and the overestimation of lev caused by the iterative process 4 the m pcaca has stable model performance on various underlying surface types and gives the best estimates in wetland grassland and farmland areas therefore this type of model is recommended when the underlying surface type is more complicated however the uncertainty of the m pcaca is mainly due to the neglect of advection resulting in the underestimation of le and the systematic error caused by the uncertainty of the lst fc trapezoidal boundary positioning 5 compared with two types of temperature decomposition based models pm mu has relatively poor model performance of producing and partitioning of le in the vegetation coverage area but in the areas which are dominated by meteorological factors e g desert water body the pm mu gives the most accurate le estimate however the limitations of the pm mu are meteorological factors that do not correspond very well to soil moisture conditions and the errors caused by the β determination 6 due to the complex surface characteristics and the impact of human activities three types of two source models do not perform well in urban areas later studies need to customize a special rs based et model for urban areas credit authorship contribution statement han chen data curation formal analysis validation visualization software writing original draft writing review editing jinhui jeanne huang conceptualization methodology funding acquisition supervision writing review editing edward mcbean resources supervision conceptualization methodology writing review editing vijay p singh conceptualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors acknowledge the financial support of the national key r d program of china for this research under grant number 2016yfc04007009 we thank the anonymous reviewers for their valuable suggestions that allowed us to improve the paper appendix the surface energy balance equation is given as a1 g is calculated as empirical relationship with rn grimmond and oke 1999 kustas and daughtry 1990 a1 r h l e g a2 g 0 3 1 0 9 f c r n when the soil is fully dry it enters an extreme situation with no soil evaporation and crop transpiration and the soil moisture is close to the wilting coefficient based on the energy balance equation the extreme temperature expression of the dry bare point tsd is obtained from the following expression a3 t sd 0 7 s 0 1 α sd σ ε a t sky 4 ρ c p r sda t a ρ c p r sda 0 7 σ ε t a s d 3 when the vegetation status is gradually increased to full coverage the surface temperature is the canopy temperature the canopy surface temperature of the dry and completely covered vegetation points tvd has the following expression a4 t vd 0 97 s 0 1 α vd σ ε a t sky 4 ρ c p r vda t a p c p r vd 0 97 σ ε t avd 3 when the surface condition is fully wet it enters another extreme situation with no energy producing sensible heat flux all available energy rn g generates evaporation and the heat balance equation is a5 r n 1 0 3 l e wet bare ground surface temperature tsw has the following expression a6 t sw 0 7 s 0 1 α sw σ ε a t sky 4 ρ c p δ γ r swa t s w a d sw δ p c p γ r swa 0 7 σ ε t asw 3 when the vegetation status is gradually increased to full coverage the surface temperature is the canopy temperature surface temperatures of the wet covered canopy tvw has the following expression a7 t vw 0 97 s 0 1 α vw σ ε a t sky 4 ρ c p δ γ r vwa t v w a d vw δ p c p γ r vwa 0 97 σ ε t avw 3 in a3 a7 tsd tvd tsw tvw are the four theoretical extreme temperatures k s0 is the solar radiation w m2 α sd α vd α sw α vw are the surface albedo of four extreme pixels unitless ε a is the emissivity of atmosphere calculated by brutsaert 1975 s method unitless t sky is the sky equivalent temperature k which is a function of ta k and vpd hpa r sda r vda r swa r vwa are the aerodynamic impedance of the four extreme pixels s m which are estimated by kondo s 1994 method combined with paulson 1970 and webb s 1970 method tasd tavd tasw tavw are the mean surface temperature k of four theoretical extreme point σ is the stefen boltzmann constant 5 67 10 8 w m 2 k 4 dsw and dvw are the air saturated water vapor pressure difference in wet bare land and wet vegetation land pa rns and rnv are estimated by the exponential function of rn anderson et al 1997 given as a8 a9 a8 r nv r n 1 exp k l a i a9 r ns r n exp k l a i in a8 a9 k unitless is an extinction coefficient set as 0 6 according to impens and lemur 1969 ra is aerodynamic impedance s m calculated by the function of wind speed and roughness length li et al 2005 a10 r a i n z u d o z om ψ m i n z t d o z om ψ h k 2 u in a10 zu and zt are the measured height of u and ta do is displacement calculated by the canopy height do 2 3hc zom is calculated as zom 1 8hc zoh is the heat roughness length taken as zoh 1 7zom k is the von karman s constant 0 41 the ψh and ψm are heat stability functions and momentum stability functions respectively calculated by brutsaert 1982 method 
4588,karst systems present multiple challenges for the application of physically based numerical models due to the heterogeneity and high spatial variability of their hydrogeological parameters some models can face conceptual limitations specific to the karst environment like equivalent porous medium models a new version of modflow called modflow usg unstructured grid was developed and released panday et al 2013 implementing unstructured grids and finite volume numerical solutions to enable a more physically accurate modelling of karst aquifers in this study we tested for the first time the abilities of modflow usg with cln within on a small irish catchment feeding the spring of manorhamilton located in county leitrim ireland in order to create a numerical model of this karst system we developed a methodology combining 3d geological models built using the software move and leapfrog geo to characterise accurately the aquifer and set up its hydrogeological properties the model is then exported to modflow usg with cln using the gui groundwater vistas 7 the flow model is calibrated against the measured spring discharge with a qualitative assessment of the variations of the potentiometric surfaces the manning equation is used to simulate the non laminar groundwater flow in the conduit system while the darcy equation is used for laminar groundwater flow in the continuum porous medium sensitivity analysis indicates that matrix hydraulic conductivity specific yield conduit drain conductance and conduit radius are important parameters in the model the dynamics of diffuse flow in areas of the aquifer between conduits are investigated which reveals that the most influential conduit in terms of groundwater flow through such areas can change over time depending on prevailing hydrological conditions overall whilst such a modelling approach does require a good understanding a the system large datasets and a relatively long calibration process to achieve a satisfying performance in the current configuration of the code and gui and available data at the site modflow usg with cln proves to be a powerful tool which can be used to further understand the dynamics of the karst aquifer involved and can help inform the management of water resources both quantitatively and qualitatively keywords karst aquifer distributed numerical model modflow diffuse flow discrete continuum model 1 introduction karst aquifers provide potable water sources around the world with the total population served by karst sources estimated to be between 9 and 20 of the world s population according to different studies and about 13 of the total water withdrawal ford and williams 2007 stevanović 2019 because of the heterogeneity of karst systems assessing their flow pathways and dynamics is challenging yet is essential with respect to critical societal concerns such as water management and flood risk assessment about half of the republic of ireland is underlain by carboniferous limestones which are largely karstified a large part of these carbonates formations coincide with productive agricultural lands and major centres of population consequently the groundwater resources are often highly vulnerable to anthropogenic influences such as diffuse pollution from the high number of on site wastewater treatment systems septic tanks etc in rural areas gill and mockler 2016 from agricultural activities including emerging contaminants such as veterinary drugs or pesticides the flow dynamics especially the rapid transit through conduits linked with direct infiltration in swallow holes the lowland nature of much irish karst and the relatively thin layer of soil cover or heterogeneous glacial till with typical preferential pathways all increase the risk of contamination and flooding issues in this context distributed models of groundwater flow at a catchment scale can prove essential tools to simulate flow and contaminant transport within the aquifer and help to manage the groundwater resources more efficiently in order to understand better the functioning of karst aquifers and to address different water quality and or quantity issues a range of models have been used in the literature including reservoir models black box or transfer function models machine learning models and physically based distributed models each of these approaches have their advantages and drawbacks depending on the application when it comes to simulate in detail what is physically happening in the different compartments of a karst system epikarst conduits fracture saturated zone unsaturated zone matrix the distributed models can represent the complex flow and transport processes across an entire catchment these numerical models can be used to predict different scenarios changes in pumping or climate and hence impacts on resources to test previous conceptual models or to estimate hydraulic parameters flow models may simulate hydraulic heads groundwater fluxes and discharge at springs while transport models simulate the transport and distribution of substances in the aquifer scanlon et al 2003 depending on the specificities of the studied karst catchment and the aim of the modelling different types of distributed models can be implemented equivalent porous medium epm discrete fracture network dfn discrete conduit networks dcn and discrete conduit continuum models dcc also called coupled continuum pipe flow models or hybrid models ghasemizadeh et al 2012 epm models make the assumption that a karst aquifer can be represented by a porous medium or two for the double continuum porous equivalent model or dpm and darcy s law is applied on the full catchment they have been successfully used to simulate flow at regional scale or to model slightly karstified aquifers abusaada and sauter 2012 angelini and dragoni 1997 doummar et al 2012 kuniansky et al 2001 larocque et al 1999 scanlon et al 2003 teutsch 1993 however they are not best suited for catchment scale simulations especially when considering epm rather than dpm and can lead to underestimates of peak travel times which are crucial when it comes to assess risks of contamination in karstified and fractured aquifers in some cases yielding misleading conclusions as in the case of the walkerton aquifer where several people died from drinking a contaminated groundwater source worthington and smart 2017 in contrast for other models the assumption is made that the permeability of the rock is negligible or not best conceptually suited to represent a representative volume element the flow is simulated only within a network of fractures or of conduits respectively dfn and dcn models the application of these approaches depends on how much detailed information on fractures and geometry is available for the studied catchment aside from the theoretical background there are some examples of models based on fractured based simulations to represent the hydrogeology of studied karst catchments cacas et al 1990 graf and therrien 2008 others authors simulate flow and transport within a network of conduits dcn approach which ideally requires an extensive knowledge of the configuration of the conduit system campbell and sullivan 2002 chen and goldscheider 2014 gabrovšek et al 2018 jeannin 2001 peterson and wicks 2006 or semi distributed approach with a distributed recharge and alternative ways to take into account diffuse flow with the main flow routed through the conduits network gill et al 2013b 2013a mccormack et al 2017 schuler et al 2018 finally another approach combines equivalent porous media and discrete models dcc or hybrid models many authors have developed the theory of these numerical models and applied it to synthetic cases kaufmann 2003 kiraly et al 1995 liedl et al 2003 sauter 1992 this approach was first implemented in modflow as conduit flow process cfp for modflow 2005 reimann and hill 2009 shoemaker et al 2005 and different studies presented different applications using the carbonate aquifer void evolution code cave which allows the simulation of the genesis of karst aquifers during geologic time periods using a coupled continuum pipe flow model liedl et al 2003 cave is sometimes coupled with modflow bauer et al 2000 birk et al 2006 other studies added drainable conduit storage to enable transient water storage and unsteady flow in a filled pipe network in the simulations de rooij et al 2013 reimann et al 2011 modelling studies applied on actual karst systems often following on from large scale field experiments have become more common as data and computational power are increasing assari and mohammadi 2017 chang et al 2019 gallegos et al 2013 hill et al 2010 reimann et al 2014 saller et al 2013 xu et al 2015 another example of a model applicable to karst hydrogeology is modflow nlfp mayaud et al 2015 using the darcy forchheimer equation to account for the non linear behaviour and more particularly the gradual transition from laminar to turbulent flow but without explicitly simulating flow within conduits other hybrid models combining matrix and fracture or conduit flow are feflow and frac3dvs hydrogeosphere code therrien and sudicky 1996 finally a new version of the modflow program called modflow unstructured grid usg was developed to allow a better flexibility in grid design enabling flow in channels rivers fine hydrostratigraphic units and karst conduits to be represented panday et al 2013 more specifically this version includes a connected linear network process cln simulating flow within conduits wells and drains connected with the groundwater flow process in a way that the equations are solved simultaneously kresic and panday 2017 modflow usg has been used in different hydrogeological contexts for example to study aquifers used in relation with production of coalbed methane herckenrath et al 2015 or in multilayer quaternary aquifers ezzeldin et al 2018 radial or multi lateral collector wells božović et al 2020 lux et al 2016 or mining applications krčmář and sracek 2014 however to our knowledge the code has not been applied yet to a full karst catchment the code developed in modflow usg with cln is particularly interesting from the perspective of modeling complex karst hydrogeology for several reasons first it offers different formulations to simulate the flow within conduits as detailed in methods in comparison with other existing codes that use a single formulation second the flexibility in grid design allows the karst conduits nodes to be connected to several layers and matrix cells as well as other conduits nodes which enables complex geology to be captured more accurately and finally the fully coupled solution between groundwater cells and conduits nodes gives a stronger robustness to the numerical solving methods kresic and panday 2017 consequently in this paper we used modflow usg with cln to model the hydrogeology of an irish karst system simulating the flow within the aquifer and discharge at the spring this approach was applied with the aim to gain insights about the hydrogeological behaviour and hydraulic parameters of the aquifer it is the first time that such a fully distributed hybrid model approach has been applied in ireland irish karst catchments have been modelled with success with semi distributed pipe networks approaches as presented by gill et al 2013b mccormack et al 2014 schuler et al 2020 it is also the first application of modflow usg with cln to a karst spring including with a 3d model of a complete hydrogeological catchment and with a calibration against an observed time series for a spring discharge 2 methods 2 1 modflow usg cln modflow unstructured grid usg presents the possibility to build different grids structured or unstructured nested grids and a variety of cell shapes triangle rectangles hexagons for example that can take several sizes within the same model as a result the grids are flexible and can have an increased resolution along hydrogeological features around rivers or wells for example additionally the cln package enables one dimensional connected features to be incorporated into the gwf grid hydrogeological or hydrological water features whose size is much smaller than the groundwater flow cell around it karst conduit wells pipes fractures canals rivers streams kresic and panday 2017 these features make the program suitable to undertake a full numerical distributed modelling of a karst catchment as investigated in this study within the conduits the flow can be simulated either as laminar using the hagen poiseuille equation or turbulent with optional formulations darcy weisbach equation hazen williams equation or manning s equation their geometry however can only be of cylindrical shape at present the flow between the conduits cln cells and the surrounding aquifer gwf cells is constrained through different options effective leakance value skin conductance and thickness or the use of a thiem solution the interaction flow γ cpn between conduits and the surrounding aquifer between cln cells and gwf cells is expressed by the following eq 1 panday et al 2013 1 γ cpn α cpn f upn h p h n where α cpn is the saturated conductance between the cln cell n and the gwf cell p hn is the head in the cln cell hp is the head in the gwf cell and fupn is the wetted fraction of the upstream perimeter function of the flow depth more precisely for vertical and angled cln cells fupn is equal to the fraction of the total volume of a cln cell that is saturated given by the set of following eq 2 f upn 0 f o r h n bot n 0 f upn h n bot n l n f o r 0 h n bot n 1 2 f upn 1 f o r h n bot n 1 where bot is the bottom elevation of the cell lcn is the length of cln cells n hn hp and fupn are defined in eq 1 for horizontal cln cells the wetted fraction is the ratio of wetted perimeters of the cln cells as following in eq 3 3 f upn p wu p t where pwu is the wetted perimeter computed using the upstream head of h p and h n pt is the total perimeter of the cln cell the conductance term α cpn between cln cells and gwf cells can be an input to the model alternatively the user provides the skin thickness and the skin hydraulic conductivity into the model and the conductance is then computed as eq 4 4 α cpn k s p t l b s with ks the hydraulic conductivity of the skin surrounding the interface between conduit and aquifer i e cln cells and gwf cells bs the thickness of the skin surrounding this same interface equations presenting alternative options different available geometries convertible cells can be found in the aforementioned reference panday et al 2013 in this study the majority of conduits were chosen as cylindrical angled conduits but with some vertical for concentrated infiltration form sinkholes or horizontal in some portions of the network the sparse matrix solver sms package was used to solve the sets of equations via nonlinear solution methods 2 2 general methodology model building and calibration the following methodology was developed to model the hydrogeological behaviour of the selected catchment fig 1 first fieldwork and times series analysis are used to build a conceptual model including the main infiltration points direct connections proven by tracer tests and characterisation of the different flow regimes secondly using all available data geological maps field surveys borehole logs dip data available cross sections in the literature a geological model is built using the software move petex this geological model once validated is then exported to the software leapfrog geo seequent this other modelling platform includes a hydrogeological module that i enables the grid for the geological model to be created that is compatible with modflow and ii assigns certain hydrological properties of each formation hydraulic conductivity specific storage specific yield initial hydraulic head this hydrogeological grid is then exported for use in modflow usg with cln using groundwater vistas 7 environmental solutions inc as the graphic user interface to carry out flow simulations results of the flow simulations are analysed and visualised i directly in gwv7 using mass balance tools and hydrographs ii in leapfrog to be able to better visualise in 3d the relationships between the potentiometric surface with the geological layers and the surface in time and iii in r where different scripts were developed to extract and analyse the discharge time series and calculate the performance these scripts are used to calibrate the model the full process described from the beginning is carried out several times incrementally starting from a simplified model rough geology simplification of the flow paths progressing towards a more complex model additionally the different steps of the model building geological model hydrogeological set up flow simulation and calibration are checked against the current conceptual model of the studied site however they are also used to complete and refine the conceptual model when necessary the model was calibrated through different steps the initial values for the different parameters were set up using field data including tracer tests or available literature data from previous pumping tests in the same geological formation for example the full evaluation of the model a posteriori was carried out using different performance indicators for overall performance estimation the following indicators were selected kling gupta efficiency kge gupta et al 2009 nash sutcliffe efficiency nse nash and sutcliffe 1970 and variations of those parameters logarithm and root mean square error to assess low flow performance the log transformed nse and mean squared logarithmic error msle were calculated de vos and rientjes 2007 the kge has been used recently by different authors in hydrology and karst hydrology because the orthogonal set up of the kge allows separate comparisons of correlation variability and bias between the simulations and observations hartmann et al 2013 some of the problems than can rise due to a calibration based only on the nse for example its use of the observed mean as baseline which can lead to overestimation of model performance for highly seasonal variables see gupta et al 2009 are avoided here by the use of several criteria as well as the visual assessment of the potentiometric surface 3 study site and data the selected study site is a karst spring near the town manorhamilton in county leitrim ireland fig 2 the manorhamilton spring catchment ranges between 112 m above sea level masl at the spring and 392 masl covering 3 6 km2 fig 2 as described in the water framework directive groundwater monitoring programme epa report site information manorhamilton august 2011 the catchment is highly karstified including many swallow holes and minor springs that act as epikarst discharge the spring catchment is an upland karst system located in a thinly populated area with land use predominantly dominated by pasture based agriculture the small size of the catchment enabling extensive field surveys the fact that water level time series and rating curves were already available epa data its accessibility and the fact that this spring is no longer used as a source of potable water supply for the town were characteristics leading to its selection for this first fully distributed model of a karst system in ireland it is characterised by relatively steep hydraulic gradients point recharge conduit dominated flow inferred from its flashy hydrograph behaviour low storage and concentrated discharge this site was chosen to trial the modflow usg cln approach to assess its ability to reproduce the hydrogeology of a classical karst aquifer from which more complex aquifers in an irish karst context can be undertaken such as lowland karst systems with groundwater surface interaction through turloughs and flooding patterns inter tidal and submarine springs or seawater intrusion in terms of local geology the dartry group of limestones are of lower carboniferous age asbian and comprise the argillaceous glencar limestones which is overlain by shale free dartry limestone the dartry limestone contains cherty and lime mud mound reef facies and cave formation has taken place in both particularly in the massive reef facies however the thin beds and argillaceous nature of the glencar limestones do not facilitate water movement and so this formation forms the local base level for underground drainage gunn 1982 glencar limestone contains 58 5 limestone content whilst dartry limestone has 94 8 content the dartry limestones can present a small variation of facies laterally fossils content with no impact on their hydrogeological properties schwarzacher 1964 nearby karst systems in the same geological formations have been studied in the past which provide useful insights and comparison that enable more refined the hypotheses about the behaviour and geometry of the manorhamilton spring system to be formed as well as giving possible range of values for parameters related to the karst network not accessible on the manorhamilton catchment for example the cuilcagh karst 15 km south east of enniskillen also occurs within the dartry limestones formations tracer tests have been carried out in this area resulting in unimodal recovery curves that suggest there is no large underground reservoir and that the conduits are relatively simple and well connected possibly in a dendritic pattern the aquifer is not confined the flow is moving freely under the influence of gravity with velocities between 50 and 320 m h finally the recharge is mainly autogenic gunn 1982 further data was gathered through several studies carried out on the dartry limestones formation including pumping tests in the fractured aquifer misstear et al 2008 yielding transmissivity ranging from 1 10 5 to 4 10 2 m2 d depending on the well location and its depth within the formation these elements were therefore used to define initial values in the model and initial configurations of the network geometry additionally three tracer tests were carried out during this study to check and redefine the catchment boundaries on the study site using fluorescein rhodamine and optical brightener fig 2 sinkholes and infiltration features were mapped through a field survey time series analysis and signal analysis were used to characterise the hydrology of the catchment schuler et al 2020 the geological dataset geological formations extents dip data main exokarst features was obtained through the geological survey ireland database it was completed by field survey observation of outcrops addition of dolines including the correction of some that had been misidentified by orthophotography aside from the available water level data and rating curve the study site was further instrumented with a ctd diver and a rain gauge at a 15 min time step processed to a daily time step for the model aggregating by mean and by cumulative volume respectively additional rain gauges from the met eireann data station manorhamilton sligo airport lough glencar finner and markree were used to complete gaps if necessary and to obtain additional data for evapotranspiration estimation synoptic station evapotranspiration was calculated using penman monteith formula at a daily time step fao 1998 the yearly mean rainfall between 2014 and 2019 is 1594 4 mm whilst the yearly mean evapotranspiration is 774 4 mm the annual volume at the spring ranging from 3 3 to 5 1 million cubic meters a water balance budget was carried out assuming that the outflow of the catchment is fully recorded at the spring i e there are no other deeper flows this hypothesis is based on the absence of other resurgences downstream and on the likelihood of the fault being sealed by shaley fault rocks gouge and restite or post dissolution clays in this geological context moore and walsh 2013 this confirmed that the catchment was bigger than expected after analysing the tracer tests results with a size of approximately 4 9 km2 the catchment boundaries are further discussed in section 4 1 below using geological maps dip data and developing multiple cross sections to be interpolated the 3d geological model was then built using move and leapfrog fig 3 it can be seen that the heart of the catchment is a depression syncline in both directions as indicated on the figure 4 results and discussion 4 1 preliminary analyses assessment of characteristics of the catchment set up in the process of testing and calibrating the model first a very simplified version was set up no topography just one geological formation to explore the behaviour of the system in relation to the range of different parameters and the effect of conduits on the aquifer fig 4 a and b amongst other hydrological properties simple recharge events were tested one event maximum observed between 2014 and 2019 with a 60 mm recharge followed by a 30 days recession and a set of two events a one day recharge event r 50 mm followed by a 10 days recession and a two days recharge of 40 mm with a 15 days recession following this a more complex model was developed with detailed geology of the main aquifer but also surrounding geological formations and topography this model was used to refine the catchment boundaries the hydrogeological model was set to cover a larger area than just the manorhamilton spring catchment in order to assess the changes of potentiometric surface related to the geology and to provide better insights into the southern boundary of the catchment fig 4 c these simulations helped to define the most likely karst network and catchment boundaries given the very different hydrogeological properties surface watershed topography and steep hydraulic gradient the surrounding non karstified geological formations i e the glencar limestones and slishwood paragneiss with hydraulic conductivities of k 1e 8 and k 1e 11 m s respectively were then removed definitively from the model to focus on the karst aquifer and improve computational time setting up no flow boundary conditions around the newly refined catchment boundaries finally different configurations of the conduit network were tested fig 5 from the most simple to the most ramified always constrained by known sinkholes and field observations and from the more shallow to the deepest all of these tests were checked and calibrated first in steady state analysing the resulting potentiometric surface and then in transient state against the spring discharge over a few events the steady state was set up at 365 days with a recharge of 0 0082 m a recharge equivalent to around three times the actual annual recharge of the catchment for initialisation purposes the grid was set up with 40 40 m cells for the general aquifer with smaller size for cells around the conduit 20 20 m and 10 10 m using quadtree grid refinement with 65 rows and columns and ten vertical layers elevations 63 to 348 m in total but the thickness of each layer is not homogeneous depending on the geological variations for the conduits manning s formula was selected to solve for turbulent flow conduits clns were circular vertical horizontal or angled depending on their position a constant head at 120 m was set up on the eastern boundary of the catchment in the dartry limestones formation the conduit network which yielded the best performances as detailed in the next section was the deepest conduit configuration with the conduits following the geological transition between the dartry limestones and glencar limestones with higher clay content as seen in fig 5 c these results provoked a new definition of the catchment boundaries and the most likely conduit morphometry of the karst network as illustrated in fig 6 the boundaries of the catchment itself were set through a combination of information obtained by tracer tests topography 3d geology and results of simulations of the groundwater model more precisely the northern boundary is straightforward based on geology glencar shaley limestones formations combined with topography the south east boundary is defined by the geology fault against slishwood paragneiss formation assumed sealed the south boundary was defined after analysing the 3d geological model folding of the dartry limestones and glencar formation in a bowl like shape compared with the potentiometric surface of an extreme event twice the maximum recorded daily rainfall happening in high flow conditions this boundary could be displaced but as it is it s the most likely groundwater divide with available information finally the south west and western boundaries are also not as straightforward based on the geology alone but the analysis of recorded karst features in the larger area shows a smaller karst spring whose catchment is adjacent to the manorhamilton catchment and the groundwater divide is likely to be located along the end of this geological folding and around mid distance between known conduits and this neighbouring catchment finally the potentiometric surface in steady state for the optimal configuration is shown on fig 7 the steady state was set up at 365 days before the beginning of transient time steps 4 2 flow simulation results the flow simulations were conducted on five different time periods 1 from february 17th 2017 to may 8 2017 2 july 4th 2017 to october 2nd 2017 3 january 1st 2018 to march 1st 2018 4 may 20th 2020 to august 28th 2018 and 5 january 5th 2018 to april 5th 2019 these different time series cover a wide range of hydrological conditions recessions floods with different initial state enabling the general behaviour of the model to be thoroughly assessed the simulated discharge at the outlet compared to the observed spring discharge for each period is presented on fig 8 the set of parameters used for these simulations is detailed on table 1 the only change between time periods being the recharge value in steady state for initialisation purposes simulations on longer time periods could not be achieved due to stability and non convergence issues possibly due to different bias addressed below in discussion and the constraints of the current beta version of modflow usg with cln the model using the deepest configuration of conduits achieved the best performance based on kling gupta efficiency as a primary calibration parameter combined with a visual assessment of the potentiometric surface variations across the simulated time period simulations were run only within the dartry limestones aquifer in these final versions of the model hydrogeological properties of slishwood paragneiss and glencar limestones are hence not presented in table 1 additional performance indicators were calculated to identify where the model would perform best and where it would underperform as summarised in table 2 the kge values range between 0 5 and 0 75 from an average to an acceptable good performance the coefficient β of the kge is the bias ratio dimensionless here between 0 72 and 1 3 optimal when equal to 1 the correlation coefficient r is between 0 65 and 0 8 and the variability ratio γ dimensionless is between 0 73 and 1 3 from these first two indicators it is clear that a balance needs to be struck between the different parameters to enable satisfactory performances across very different hydrological conditions for some periods the bias ratio is superior to 1 and the mean simulated discharge is above the observed discharge and vice versa however the variability ratio is a bit too low for all periods which shows that the model is not able to reproduce exactly the dynamics of the aquifer in particular the fast response the nse is between 0 49 and 0 63 if excluding one value at 0 16 for period 3 which seems to be significantly impacted by a delayed peak shifted on the recession especially on a shorter time series the log transformed nse ranges between 0 49 and 0 67 show average to good simulations of baseflow and low flows finally the volume cumulative errors are relatively low and the root mean square logarithmic error is between 0 63 and 0 72 finally the potentiometric surfaces were checked for each simulation to make sure of their consistency with physical observations i e not overflowing the surface adequacy with ephemeral springs etc the maximum and minimum level of potentiometric surface for period 4 are illustrated on fig 9 because the aquifer in the dartry limestones formation outside of the karst network represented by the clns is approximated here by a porous medium with a single hydraulic conductivity it does not represent the water table but the computed hydraulic heads within the limits of the approximation of the model not taking into account a fine representation of the heterogeneity of the aquifer consequently the presence of any fractures and or undetected conduits might have a strong impact on this potentiometric surface 4 3 sensitivity analysis a sensitivity analysis was carried out for the main parameters on their impact on the main outputs hydraulic head and on the spring discharge different boundary conditions were tested out constant head no flow cells and different geological set ups as well permeability in the matrix domain configuration of the karst network simulations were run in steady state and transient configurations and calibrated manually against observed data for the sensitivity analysis results are compared to a base case scenario here period 1 for each simulation the variation of one dependent variable ξ is compared with the variations in another parameter π the values of the different variables ξ associated with values of parameter π defined as low reference base scenario and high the dimensionless sensitivity of the model parameter π x π is evaluated using the following equation graf and therrien 2007 zheng and bennet 2002 5 χ π ξ ξ ref π π ref the selection of the range of variations for the input parameters is subjective if too small differences can be concealed while perturbations too large can yield inaccurate sensitivities especially if the relationship between the dependant variable and the modified parameter is nonlinear graf and therrien 2007 here a perturbation size of 2 was applied for the equivalent permeability of the matrix and the drain conductance as presented in fig 9 the effect of a small disturbance of the main matrix parameter kd and the main conduit parameter drain conductance cd 2 on the discharge at the spring was assessed for mean discharge minimum discharge baseflow and maximum discharge peak flow to help identify the effect of parameters on both average and extreme conditions fig 10 kd has a strong influence on the baseflow and less on the peak flows as expected from this parameter linked to the diffuse delayed response of the karstic aquifer its effect is also symmetrical as shown in fig 10 the 2 disturbance applied on cd has more effect in increasing or decreasing the mean flow and peak flow but less on the baseflow for other parameters a few percent variation would cause the model to fail converging for example a change in kd of 5 would cause the model to fail converging for others porosity specific yield radius it would show little to no effect on the discharges observed at the outlet in order to visualize other parameters sensitivities additional simulations were carried out with much wider ranges of the input parameters in particular the specific yield sy has a strong impact on peaks shape and the recessions fig 11 the recessions are not steep enough in the final simulation for period 1 however decreasing the value of sy any further than 1e 4 does not produce any steeper recessions and causes the model to fail converging after reaching that threshold the size of the network had also an important effect on the discharge at the outlet in the final conduit configurations the radius of the conduits cln elements ranges from 0 1 m upstream to 0 5 m at the spring to study the sensitivity of the discharge to this parameter some simulations were run comparing a range of conduits sizes dividing the radiuses of all conduits by 2 and 5 and multiplying them by 2 and 5 fig 12 in the extreme scenario all conduit radiuses multiplied by 5 the radius at the spring is 2 5 m in this case the main flow peak is better represented but because the system is not draining fast enough the recession not steep enough it results in an excessive modelled volume at the spring this is likely to be due to the selected configuration of deepest conduits pressurised and below the water table especially for the southern conduit and downstream part of the network with the high drain conductance the limiting factor constraining the volume extracted at the spring is the size of the conduits and the difference in volume is coming from the matrix storage hence the potentiometric surface is lowered when increasing the size of conduits there is a trade off found manually between the different parameters see 4 4 diffuse flow one of the advantages of distributed model is being able to quantify diffuse flow and flow paths across any area of the 3 d catchment as an example the effect of the main conduits on the diffuse flow within the aquifer between them is shown in fig 13 here the studied area is located at 31 m depth and in layer four of the model 14 m thickness at this location indicated with the yellow rectangle the major part of the flow is draining towards the east to the spring the overall flow shows a flashy response due to the closeness of conduits part of the flow is drained directly to layer 5 below i e bottom flow the remaining volume either moves towards the northern conduit around 30 40 m depth close to the studied area or towards the southern conduit located around 50 40 m deep in high flow conditions most of the flow is drains toward the northern conduits but this direction changes towards the end of recessions with the flow increasingly starting to feed the deeper southern conduits 4 5 discussion visualisation is very important in geosciences in general which can be particularly enhanced when using distributed models visualisation enable geoscientists to better understand complex and varied datasets and systems and therefore communicate more effectively with each other and with end users 3d modelling is the foundation of the 3d visualization technology which can avoid the loss and distortion of spatial information that can result from using only projected data on planes shao et al 2011 in a karst context it can be used for example to identify geomorphological features jouves et al 2017 silvestre et al 2013 to build better conceptual models and to improve the interpretability of collected data jeannin et al 2012 in this study the use of a 3d detailed geological model combined with a distributed flow modelling approach proved very useful for defining the boundaries of the catchment and likelihood of distribution of the karstic network it was also very important in the calibration process using the discharge time series at the outlet spring as the only parameter to compare the performance of the model against would not have been sufficient to develop the most realistic karst aquifer morphometry the observation of the modelled potentiometric surfaces across the full catchment and at all time steps was necessary to remove configurations where the potentiometric surface would not be consistent with the known hydrogeological behaviour of the catchment i e above the topographic surface or too deep in comparison with known ephemeral springs at a later stage the visualisation tools can be then used to study flow paths and contaminant transport within the karstic system thus achieving a more reliable modelling of the processes involved the diffuse flow analysis highlights the variability of the internal hydrogeological behaviour within the karst catchment it opens new possibilities to assess contaminant transport pathways in karstic contexts including different flow paths under different hydrogeological conditions for example as observed in the previous section the autogenic diffuse flows do not always drain toward the same conduit but change direction depending upon the time since the recharge event such information and insights are essential to better understand diffuse flow behaviour and therefore helping to protect and preserve water resources possible bias in this distributed model include the lack of piezometer data to calibrate the potentiometric surface the assessment of the reliability of the modelled potentiometric surface was done visually compared with the field survey data an ephemeral spring in the north east boundary of the catchment for example building a model based on calibration both at the outlet and from boreholes available more widely across a catchment would help assess the strength of the modelled hydrogeological behaviour a model is only as good as the quality and availability of data and conceptual understanding of a catchment as discussed in the flow simulation results section above undetected conduits or the heterogeneity of fractures in the more diffuse flow zone not included in the model at this stage can have a strong effect especially on the potentiometric surface further fieldwork and the use of geophysical techniques like ert methods would prove useful to validate and refine current hypothesis on the karst network and hydrogeological properties like most hydrological models the question of equifinality arises different representations of an environmental system can be considered acceptable linked with unicity identifiability and stability of the problem solution beven 2006 ebel and loague 2006 here the calibration process combines the comparison against discharge the sensitivity analysis and the visual assessment of the potentiometric surface in the 3d visual model however at this stage of the study for each new simulation a specific set of parameters was modified manually in groundwater vistas 7 the implementation of a target feature for the cln elements in particular for the last cln with drain boundary conditions the spring would enable the automation of a much larger number of simulations using for example a quasi monte carlo procedure with a sobol sequence sampling of the parameter space sobol 1976 the equifinality could then be better assessed through distribution of optimal values of each parameter variance based sensitivity indexes and interactions between parameters mazzilli et al 2017 saltelli 2002 possible ways to improve the model relate to 1 testing a wider range of geological features adding complexity 2 using additional modflow packages discussed below or choices of equations 3 investigating hourly time step regarding the possible variations of geology the possibility of several levels of conduits instead of a single one with variations of depths is currently investigated further work could include more variations of size of the network possible constrictions tortuosity and variations of the number of sinkholes as concentrated infiltration pathways one way to explore changes in the conduit network could be using a pseudo genetic approach to generate a large set of karst conduits based on fracture distribution data like the stochastic karst simulator sks borghi et al 2016 2012 sivelle et al 2020 vuilleumier et al 2012 different ways to account for an epikarst layer in the upper part of the model could also help to achieve a better performance and representation of the hydrogeological catchment vertical gradient of hydraulic conductivity fractures or additional network of smaller conduits lateral variations of parameters the use of additional modflow and modflow usg packages like the evapotranspiration package et fractures unsaturated zone flow uzf dual domain flow packages fractures can be incorporated in the model at a later stage different formulations could also be tested like the preissmann slot concept to incorporate pressurised flow to reproduce the transition between free surface flow and pressurized flow this approach was implemented in different studies using us environmental protection agency storm water management model swmm for urban drainage networks ferreri et al 2010 and in karst environment gabrovšek and peric 2006 halihan et al 1998 perne et al 2012 peterson and wicks 2006 and in the pipe network models using infoworks cs gill et al 2013b schuler et al 2020 2018 in modflow usg cln currently confined flow within cln is used to account for pressurised conditions but between cln only and through the use of convertible cells to simulate flow to dry cells between cln and gwf cell the flow exchange between cln and gwf cells is then possible in both directions and wet and dry cells however there is not an explicit pressurised formulation available assessing the difference that could result in the flow path and dynamics could be a perspective of such future work finally as seen discussed above in the flow simulation results section the dynamics of the discharge were not always simulated with very high nash sutcliffe efficiency and king gupta efficiency between the observed and simulated discharge time series particularly during the recession periods working at a hourly time step might help to improve this issue even though in this case the time series available in hourly time step contained some gaps which would need to filled based on alternative rainfall data collected in the region finally using the adaptive time stepping option ats package in modflow usg could be used to try and prevent non convergence and increase the stability 5 conclusions numerical groundwater models are one of the most important predictive tools available for managing water resources in aquifers scanlon et al 2003 the recently developed hybrid model modflow usg with connected linear networks clns was used to simulate flow and transport on a small irish catchment the combined use of calibration against flow discharge at the spring and visualisation of the potentiometric surface is useful to build more trustworthy models and investigate the hydrogeological behaviour of karst aquifers and their internal dynamics these first results using modflow usg with clns are promising to model karst systems specifically however the performance will benefit from automation and added feature in groundwater vistas like the possibility to use cln as targets for a more extensive calibration such models can inform the management of water resources both quantitatively and qualitatively in particular they have a lot of potential for evaluating diffuse contaminant transport in karst environments credit authorship contribution statement lea duran conceptualization methodology formal analysis investigation software laurence gill supervision validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was conducted within the irish centre for research in applied geosciences icrag and trinity college dublin supported in part by a research grant from science foundation ireland sfi and is co funded under the european regional development fund and by icrag industry partners sincerest thanks to sorab panday and james rumbaugh for answering my questions on the code and groundwater vistas 7 the authors thank philip schuler from the department of civil structural and environmental engineering trinity college dublin for the help on the study site 
4588,karst systems present multiple challenges for the application of physically based numerical models due to the heterogeneity and high spatial variability of their hydrogeological parameters some models can face conceptual limitations specific to the karst environment like equivalent porous medium models a new version of modflow called modflow usg unstructured grid was developed and released panday et al 2013 implementing unstructured grids and finite volume numerical solutions to enable a more physically accurate modelling of karst aquifers in this study we tested for the first time the abilities of modflow usg with cln within on a small irish catchment feeding the spring of manorhamilton located in county leitrim ireland in order to create a numerical model of this karst system we developed a methodology combining 3d geological models built using the software move and leapfrog geo to characterise accurately the aquifer and set up its hydrogeological properties the model is then exported to modflow usg with cln using the gui groundwater vistas 7 the flow model is calibrated against the measured spring discharge with a qualitative assessment of the variations of the potentiometric surfaces the manning equation is used to simulate the non laminar groundwater flow in the conduit system while the darcy equation is used for laminar groundwater flow in the continuum porous medium sensitivity analysis indicates that matrix hydraulic conductivity specific yield conduit drain conductance and conduit radius are important parameters in the model the dynamics of diffuse flow in areas of the aquifer between conduits are investigated which reveals that the most influential conduit in terms of groundwater flow through such areas can change over time depending on prevailing hydrological conditions overall whilst such a modelling approach does require a good understanding a the system large datasets and a relatively long calibration process to achieve a satisfying performance in the current configuration of the code and gui and available data at the site modflow usg with cln proves to be a powerful tool which can be used to further understand the dynamics of the karst aquifer involved and can help inform the management of water resources both quantitatively and qualitatively keywords karst aquifer distributed numerical model modflow diffuse flow discrete continuum model 1 introduction karst aquifers provide potable water sources around the world with the total population served by karst sources estimated to be between 9 and 20 of the world s population according to different studies and about 13 of the total water withdrawal ford and williams 2007 stevanović 2019 because of the heterogeneity of karst systems assessing their flow pathways and dynamics is challenging yet is essential with respect to critical societal concerns such as water management and flood risk assessment about half of the republic of ireland is underlain by carboniferous limestones which are largely karstified a large part of these carbonates formations coincide with productive agricultural lands and major centres of population consequently the groundwater resources are often highly vulnerable to anthropogenic influences such as diffuse pollution from the high number of on site wastewater treatment systems septic tanks etc in rural areas gill and mockler 2016 from agricultural activities including emerging contaminants such as veterinary drugs or pesticides the flow dynamics especially the rapid transit through conduits linked with direct infiltration in swallow holes the lowland nature of much irish karst and the relatively thin layer of soil cover or heterogeneous glacial till with typical preferential pathways all increase the risk of contamination and flooding issues in this context distributed models of groundwater flow at a catchment scale can prove essential tools to simulate flow and contaminant transport within the aquifer and help to manage the groundwater resources more efficiently in order to understand better the functioning of karst aquifers and to address different water quality and or quantity issues a range of models have been used in the literature including reservoir models black box or transfer function models machine learning models and physically based distributed models each of these approaches have their advantages and drawbacks depending on the application when it comes to simulate in detail what is physically happening in the different compartments of a karst system epikarst conduits fracture saturated zone unsaturated zone matrix the distributed models can represent the complex flow and transport processes across an entire catchment these numerical models can be used to predict different scenarios changes in pumping or climate and hence impacts on resources to test previous conceptual models or to estimate hydraulic parameters flow models may simulate hydraulic heads groundwater fluxes and discharge at springs while transport models simulate the transport and distribution of substances in the aquifer scanlon et al 2003 depending on the specificities of the studied karst catchment and the aim of the modelling different types of distributed models can be implemented equivalent porous medium epm discrete fracture network dfn discrete conduit networks dcn and discrete conduit continuum models dcc also called coupled continuum pipe flow models or hybrid models ghasemizadeh et al 2012 epm models make the assumption that a karst aquifer can be represented by a porous medium or two for the double continuum porous equivalent model or dpm and darcy s law is applied on the full catchment they have been successfully used to simulate flow at regional scale or to model slightly karstified aquifers abusaada and sauter 2012 angelini and dragoni 1997 doummar et al 2012 kuniansky et al 2001 larocque et al 1999 scanlon et al 2003 teutsch 1993 however they are not best suited for catchment scale simulations especially when considering epm rather than dpm and can lead to underestimates of peak travel times which are crucial when it comes to assess risks of contamination in karstified and fractured aquifers in some cases yielding misleading conclusions as in the case of the walkerton aquifer where several people died from drinking a contaminated groundwater source worthington and smart 2017 in contrast for other models the assumption is made that the permeability of the rock is negligible or not best conceptually suited to represent a representative volume element the flow is simulated only within a network of fractures or of conduits respectively dfn and dcn models the application of these approaches depends on how much detailed information on fractures and geometry is available for the studied catchment aside from the theoretical background there are some examples of models based on fractured based simulations to represent the hydrogeology of studied karst catchments cacas et al 1990 graf and therrien 2008 others authors simulate flow and transport within a network of conduits dcn approach which ideally requires an extensive knowledge of the configuration of the conduit system campbell and sullivan 2002 chen and goldscheider 2014 gabrovšek et al 2018 jeannin 2001 peterson and wicks 2006 or semi distributed approach with a distributed recharge and alternative ways to take into account diffuse flow with the main flow routed through the conduits network gill et al 2013b 2013a mccormack et al 2017 schuler et al 2018 finally another approach combines equivalent porous media and discrete models dcc or hybrid models many authors have developed the theory of these numerical models and applied it to synthetic cases kaufmann 2003 kiraly et al 1995 liedl et al 2003 sauter 1992 this approach was first implemented in modflow as conduit flow process cfp for modflow 2005 reimann and hill 2009 shoemaker et al 2005 and different studies presented different applications using the carbonate aquifer void evolution code cave which allows the simulation of the genesis of karst aquifers during geologic time periods using a coupled continuum pipe flow model liedl et al 2003 cave is sometimes coupled with modflow bauer et al 2000 birk et al 2006 other studies added drainable conduit storage to enable transient water storage and unsteady flow in a filled pipe network in the simulations de rooij et al 2013 reimann et al 2011 modelling studies applied on actual karst systems often following on from large scale field experiments have become more common as data and computational power are increasing assari and mohammadi 2017 chang et al 2019 gallegos et al 2013 hill et al 2010 reimann et al 2014 saller et al 2013 xu et al 2015 another example of a model applicable to karst hydrogeology is modflow nlfp mayaud et al 2015 using the darcy forchheimer equation to account for the non linear behaviour and more particularly the gradual transition from laminar to turbulent flow but without explicitly simulating flow within conduits other hybrid models combining matrix and fracture or conduit flow are feflow and frac3dvs hydrogeosphere code therrien and sudicky 1996 finally a new version of the modflow program called modflow unstructured grid usg was developed to allow a better flexibility in grid design enabling flow in channels rivers fine hydrostratigraphic units and karst conduits to be represented panday et al 2013 more specifically this version includes a connected linear network process cln simulating flow within conduits wells and drains connected with the groundwater flow process in a way that the equations are solved simultaneously kresic and panday 2017 modflow usg has been used in different hydrogeological contexts for example to study aquifers used in relation with production of coalbed methane herckenrath et al 2015 or in multilayer quaternary aquifers ezzeldin et al 2018 radial or multi lateral collector wells božović et al 2020 lux et al 2016 or mining applications krčmář and sracek 2014 however to our knowledge the code has not been applied yet to a full karst catchment the code developed in modflow usg with cln is particularly interesting from the perspective of modeling complex karst hydrogeology for several reasons first it offers different formulations to simulate the flow within conduits as detailed in methods in comparison with other existing codes that use a single formulation second the flexibility in grid design allows the karst conduits nodes to be connected to several layers and matrix cells as well as other conduits nodes which enables complex geology to be captured more accurately and finally the fully coupled solution between groundwater cells and conduits nodes gives a stronger robustness to the numerical solving methods kresic and panday 2017 consequently in this paper we used modflow usg with cln to model the hydrogeology of an irish karst system simulating the flow within the aquifer and discharge at the spring this approach was applied with the aim to gain insights about the hydrogeological behaviour and hydraulic parameters of the aquifer it is the first time that such a fully distributed hybrid model approach has been applied in ireland irish karst catchments have been modelled with success with semi distributed pipe networks approaches as presented by gill et al 2013b mccormack et al 2014 schuler et al 2020 it is also the first application of modflow usg with cln to a karst spring including with a 3d model of a complete hydrogeological catchment and with a calibration against an observed time series for a spring discharge 2 methods 2 1 modflow usg cln modflow unstructured grid usg presents the possibility to build different grids structured or unstructured nested grids and a variety of cell shapes triangle rectangles hexagons for example that can take several sizes within the same model as a result the grids are flexible and can have an increased resolution along hydrogeological features around rivers or wells for example additionally the cln package enables one dimensional connected features to be incorporated into the gwf grid hydrogeological or hydrological water features whose size is much smaller than the groundwater flow cell around it karst conduit wells pipes fractures canals rivers streams kresic and panday 2017 these features make the program suitable to undertake a full numerical distributed modelling of a karst catchment as investigated in this study within the conduits the flow can be simulated either as laminar using the hagen poiseuille equation or turbulent with optional formulations darcy weisbach equation hazen williams equation or manning s equation their geometry however can only be of cylindrical shape at present the flow between the conduits cln cells and the surrounding aquifer gwf cells is constrained through different options effective leakance value skin conductance and thickness or the use of a thiem solution the interaction flow γ cpn between conduits and the surrounding aquifer between cln cells and gwf cells is expressed by the following eq 1 panday et al 2013 1 γ cpn α cpn f upn h p h n where α cpn is the saturated conductance between the cln cell n and the gwf cell p hn is the head in the cln cell hp is the head in the gwf cell and fupn is the wetted fraction of the upstream perimeter function of the flow depth more precisely for vertical and angled cln cells fupn is equal to the fraction of the total volume of a cln cell that is saturated given by the set of following eq 2 f upn 0 f o r h n bot n 0 f upn h n bot n l n f o r 0 h n bot n 1 2 f upn 1 f o r h n bot n 1 where bot is the bottom elevation of the cell lcn is the length of cln cells n hn hp and fupn are defined in eq 1 for horizontal cln cells the wetted fraction is the ratio of wetted perimeters of the cln cells as following in eq 3 3 f upn p wu p t where pwu is the wetted perimeter computed using the upstream head of h p and h n pt is the total perimeter of the cln cell the conductance term α cpn between cln cells and gwf cells can be an input to the model alternatively the user provides the skin thickness and the skin hydraulic conductivity into the model and the conductance is then computed as eq 4 4 α cpn k s p t l b s with ks the hydraulic conductivity of the skin surrounding the interface between conduit and aquifer i e cln cells and gwf cells bs the thickness of the skin surrounding this same interface equations presenting alternative options different available geometries convertible cells can be found in the aforementioned reference panday et al 2013 in this study the majority of conduits were chosen as cylindrical angled conduits but with some vertical for concentrated infiltration form sinkholes or horizontal in some portions of the network the sparse matrix solver sms package was used to solve the sets of equations via nonlinear solution methods 2 2 general methodology model building and calibration the following methodology was developed to model the hydrogeological behaviour of the selected catchment fig 1 first fieldwork and times series analysis are used to build a conceptual model including the main infiltration points direct connections proven by tracer tests and characterisation of the different flow regimes secondly using all available data geological maps field surveys borehole logs dip data available cross sections in the literature a geological model is built using the software move petex this geological model once validated is then exported to the software leapfrog geo seequent this other modelling platform includes a hydrogeological module that i enables the grid for the geological model to be created that is compatible with modflow and ii assigns certain hydrological properties of each formation hydraulic conductivity specific storage specific yield initial hydraulic head this hydrogeological grid is then exported for use in modflow usg with cln using groundwater vistas 7 environmental solutions inc as the graphic user interface to carry out flow simulations results of the flow simulations are analysed and visualised i directly in gwv7 using mass balance tools and hydrographs ii in leapfrog to be able to better visualise in 3d the relationships between the potentiometric surface with the geological layers and the surface in time and iii in r where different scripts were developed to extract and analyse the discharge time series and calculate the performance these scripts are used to calibrate the model the full process described from the beginning is carried out several times incrementally starting from a simplified model rough geology simplification of the flow paths progressing towards a more complex model additionally the different steps of the model building geological model hydrogeological set up flow simulation and calibration are checked against the current conceptual model of the studied site however they are also used to complete and refine the conceptual model when necessary the model was calibrated through different steps the initial values for the different parameters were set up using field data including tracer tests or available literature data from previous pumping tests in the same geological formation for example the full evaluation of the model a posteriori was carried out using different performance indicators for overall performance estimation the following indicators were selected kling gupta efficiency kge gupta et al 2009 nash sutcliffe efficiency nse nash and sutcliffe 1970 and variations of those parameters logarithm and root mean square error to assess low flow performance the log transformed nse and mean squared logarithmic error msle were calculated de vos and rientjes 2007 the kge has been used recently by different authors in hydrology and karst hydrology because the orthogonal set up of the kge allows separate comparisons of correlation variability and bias between the simulations and observations hartmann et al 2013 some of the problems than can rise due to a calibration based only on the nse for example its use of the observed mean as baseline which can lead to overestimation of model performance for highly seasonal variables see gupta et al 2009 are avoided here by the use of several criteria as well as the visual assessment of the potentiometric surface 3 study site and data the selected study site is a karst spring near the town manorhamilton in county leitrim ireland fig 2 the manorhamilton spring catchment ranges between 112 m above sea level masl at the spring and 392 masl covering 3 6 km2 fig 2 as described in the water framework directive groundwater monitoring programme epa report site information manorhamilton august 2011 the catchment is highly karstified including many swallow holes and minor springs that act as epikarst discharge the spring catchment is an upland karst system located in a thinly populated area with land use predominantly dominated by pasture based agriculture the small size of the catchment enabling extensive field surveys the fact that water level time series and rating curves were already available epa data its accessibility and the fact that this spring is no longer used as a source of potable water supply for the town were characteristics leading to its selection for this first fully distributed model of a karst system in ireland it is characterised by relatively steep hydraulic gradients point recharge conduit dominated flow inferred from its flashy hydrograph behaviour low storage and concentrated discharge this site was chosen to trial the modflow usg cln approach to assess its ability to reproduce the hydrogeology of a classical karst aquifer from which more complex aquifers in an irish karst context can be undertaken such as lowland karst systems with groundwater surface interaction through turloughs and flooding patterns inter tidal and submarine springs or seawater intrusion in terms of local geology the dartry group of limestones are of lower carboniferous age asbian and comprise the argillaceous glencar limestones which is overlain by shale free dartry limestone the dartry limestone contains cherty and lime mud mound reef facies and cave formation has taken place in both particularly in the massive reef facies however the thin beds and argillaceous nature of the glencar limestones do not facilitate water movement and so this formation forms the local base level for underground drainage gunn 1982 glencar limestone contains 58 5 limestone content whilst dartry limestone has 94 8 content the dartry limestones can present a small variation of facies laterally fossils content with no impact on their hydrogeological properties schwarzacher 1964 nearby karst systems in the same geological formations have been studied in the past which provide useful insights and comparison that enable more refined the hypotheses about the behaviour and geometry of the manorhamilton spring system to be formed as well as giving possible range of values for parameters related to the karst network not accessible on the manorhamilton catchment for example the cuilcagh karst 15 km south east of enniskillen also occurs within the dartry limestones formations tracer tests have been carried out in this area resulting in unimodal recovery curves that suggest there is no large underground reservoir and that the conduits are relatively simple and well connected possibly in a dendritic pattern the aquifer is not confined the flow is moving freely under the influence of gravity with velocities between 50 and 320 m h finally the recharge is mainly autogenic gunn 1982 further data was gathered through several studies carried out on the dartry limestones formation including pumping tests in the fractured aquifer misstear et al 2008 yielding transmissivity ranging from 1 10 5 to 4 10 2 m2 d depending on the well location and its depth within the formation these elements were therefore used to define initial values in the model and initial configurations of the network geometry additionally three tracer tests were carried out during this study to check and redefine the catchment boundaries on the study site using fluorescein rhodamine and optical brightener fig 2 sinkholes and infiltration features were mapped through a field survey time series analysis and signal analysis were used to characterise the hydrology of the catchment schuler et al 2020 the geological dataset geological formations extents dip data main exokarst features was obtained through the geological survey ireland database it was completed by field survey observation of outcrops addition of dolines including the correction of some that had been misidentified by orthophotography aside from the available water level data and rating curve the study site was further instrumented with a ctd diver and a rain gauge at a 15 min time step processed to a daily time step for the model aggregating by mean and by cumulative volume respectively additional rain gauges from the met eireann data station manorhamilton sligo airport lough glencar finner and markree were used to complete gaps if necessary and to obtain additional data for evapotranspiration estimation synoptic station evapotranspiration was calculated using penman monteith formula at a daily time step fao 1998 the yearly mean rainfall between 2014 and 2019 is 1594 4 mm whilst the yearly mean evapotranspiration is 774 4 mm the annual volume at the spring ranging from 3 3 to 5 1 million cubic meters a water balance budget was carried out assuming that the outflow of the catchment is fully recorded at the spring i e there are no other deeper flows this hypothesis is based on the absence of other resurgences downstream and on the likelihood of the fault being sealed by shaley fault rocks gouge and restite or post dissolution clays in this geological context moore and walsh 2013 this confirmed that the catchment was bigger than expected after analysing the tracer tests results with a size of approximately 4 9 km2 the catchment boundaries are further discussed in section 4 1 below using geological maps dip data and developing multiple cross sections to be interpolated the 3d geological model was then built using move and leapfrog fig 3 it can be seen that the heart of the catchment is a depression syncline in both directions as indicated on the figure 4 results and discussion 4 1 preliminary analyses assessment of characteristics of the catchment set up in the process of testing and calibrating the model first a very simplified version was set up no topography just one geological formation to explore the behaviour of the system in relation to the range of different parameters and the effect of conduits on the aquifer fig 4 a and b amongst other hydrological properties simple recharge events were tested one event maximum observed between 2014 and 2019 with a 60 mm recharge followed by a 30 days recession and a set of two events a one day recharge event r 50 mm followed by a 10 days recession and a two days recharge of 40 mm with a 15 days recession following this a more complex model was developed with detailed geology of the main aquifer but also surrounding geological formations and topography this model was used to refine the catchment boundaries the hydrogeological model was set to cover a larger area than just the manorhamilton spring catchment in order to assess the changes of potentiometric surface related to the geology and to provide better insights into the southern boundary of the catchment fig 4 c these simulations helped to define the most likely karst network and catchment boundaries given the very different hydrogeological properties surface watershed topography and steep hydraulic gradient the surrounding non karstified geological formations i e the glencar limestones and slishwood paragneiss with hydraulic conductivities of k 1e 8 and k 1e 11 m s respectively were then removed definitively from the model to focus on the karst aquifer and improve computational time setting up no flow boundary conditions around the newly refined catchment boundaries finally different configurations of the conduit network were tested fig 5 from the most simple to the most ramified always constrained by known sinkholes and field observations and from the more shallow to the deepest all of these tests were checked and calibrated first in steady state analysing the resulting potentiometric surface and then in transient state against the spring discharge over a few events the steady state was set up at 365 days with a recharge of 0 0082 m a recharge equivalent to around three times the actual annual recharge of the catchment for initialisation purposes the grid was set up with 40 40 m cells for the general aquifer with smaller size for cells around the conduit 20 20 m and 10 10 m using quadtree grid refinement with 65 rows and columns and ten vertical layers elevations 63 to 348 m in total but the thickness of each layer is not homogeneous depending on the geological variations for the conduits manning s formula was selected to solve for turbulent flow conduits clns were circular vertical horizontal or angled depending on their position a constant head at 120 m was set up on the eastern boundary of the catchment in the dartry limestones formation the conduit network which yielded the best performances as detailed in the next section was the deepest conduit configuration with the conduits following the geological transition between the dartry limestones and glencar limestones with higher clay content as seen in fig 5 c these results provoked a new definition of the catchment boundaries and the most likely conduit morphometry of the karst network as illustrated in fig 6 the boundaries of the catchment itself were set through a combination of information obtained by tracer tests topography 3d geology and results of simulations of the groundwater model more precisely the northern boundary is straightforward based on geology glencar shaley limestones formations combined with topography the south east boundary is defined by the geology fault against slishwood paragneiss formation assumed sealed the south boundary was defined after analysing the 3d geological model folding of the dartry limestones and glencar formation in a bowl like shape compared with the potentiometric surface of an extreme event twice the maximum recorded daily rainfall happening in high flow conditions this boundary could be displaced but as it is it s the most likely groundwater divide with available information finally the south west and western boundaries are also not as straightforward based on the geology alone but the analysis of recorded karst features in the larger area shows a smaller karst spring whose catchment is adjacent to the manorhamilton catchment and the groundwater divide is likely to be located along the end of this geological folding and around mid distance between known conduits and this neighbouring catchment finally the potentiometric surface in steady state for the optimal configuration is shown on fig 7 the steady state was set up at 365 days before the beginning of transient time steps 4 2 flow simulation results the flow simulations were conducted on five different time periods 1 from february 17th 2017 to may 8 2017 2 july 4th 2017 to october 2nd 2017 3 january 1st 2018 to march 1st 2018 4 may 20th 2020 to august 28th 2018 and 5 january 5th 2018 to april 5th 2019 these different time series cover a wide range of hydrological conditions recessions floods with different initial state enabling the general behaviour of the model to be thoroughly assessed the simulated discharge at the outlet compared to the observed spring discharge for each period is presented on fig 8 the set of parameters used for these simulations is detailed on table 1 the only change between time periods being the recharge value in steady state for initialisation purposes simulations on longer time periods could not be achieved due to stability and non convergence issues possibly due to different bias addressed below in discussion and the constraints of the current beta version of modflow usg with cln the model using the deepest configuration of conduits achieved the best performance based on kling gupta efficiency as a primary calibration parameter combined with a visual assessment of the potentiometric surface variations across the simulated time period simulations were run only within the dartry limestones aquifer in these final versions of the model hydrogeological properties of slishwood paragneiss and glencar limestones are hence not presented in table 1 additional performance indicators were calculated to identify where the model would perform best and where it would underperform as summarised in table 2 the kge values range between 0 5 and 0 75 from an average to an acceptable good performance the coefficient β of the kge is the bias ratio dimensionless here between 0 72 and 1 3 optimal when equal to 1 the correlation coefficient r is between 0 65 and 0 8 and the variability ratio γ dimensionless is between 0 73 and 1 3 from these first two indicators it is clear that a balance needs to be struck between the different parameters to enable satisfactory performances across very different hydrological conditions for some periods the bias ratio is superior to 1 and the mean simulated discharge is above the observed discharge and vice versa however the variability ratio is a bit too low for all periods which shows that the model is not able to reproduce exactly the dynamics of the aquifer in particular the fast response the nse is between 0 49 and 0 63 if excluding one value at 0 16 for period 3 which seems to be significantly impacted by a delayed peak shifted on the recession especially on a shorter time series the log transformed nse ranges between 0 49 and 0 67 show average to good simulations of baseflow and low flows finally the volume cumulative errors are relatively low and the root mean square logarithmic error is between 0 63 and 0 72 finally the potentiometric surfaces were checked for each simulation to make sure of their consistency with physical observations i e not overflowing the surface adequacy with ephemeral springs etc the maximum and minimum level of potentiometric surface for period 4 are illustrated on fig 9 because the aquifer in the dartry limestones formation outside of the karst network represented by the clns is approximated here by a porous medium with a single hydraulic conductivity it does not represent the water table but the computed hydraulic heads within the limits of the approximation of the model not taking into account a fine representation of the heterogeneity of the aquifer consequently the presence of any fractures and or undetected conduits might have a strong impact on this potentiometric surface 4 3 sensitivity analysis a sensitivity analysis was carried out for the main parameters on their impact on the main outputs hydraulic head and on the spring discharge different boundary conditions were tested out constant head no flow cells and different geological set ups as well permeability in the matrix domain configuration of the karst network simulations were run in steady state and transient configurations and calibrated manually against observed data for the sensitivity analysis results are compared to a base case scenario here period 1 for each simulation the variation of one dependent variable ξ is compared with the variations in another parameter π the values of the different variables ξ associated with values of parameter π defined as low reference base scenario and high the dimensionless sensitivity of the model parameter π x π is evaluated using the following equation graf and therrien 2007 zheng and bennet 2002 5 χ π ξ ξ ref π π ref the selection of the range of variations for the input parameters is subjective if too small differences can be concealed while perturbations too large can yield inaccurate sensitivities especially if the relationship between the dependant variable and the modified parameter is nonlinear graf and therrien 2007 here a perturbation size of 2 was applied for the equivalent permeability of the matrix and the drain conductance as presented in fig 9 the effect of a small disturbance of the main matrix parameter kd and the main conduit parameter drain conductance cd 2 on the discharge at the spring was assessed for mean discharge minimum discharge baseflow and maximum discharge peak flow to help identify the effect of parameters on both average and extreme conditions fig 10 kd has a strong influence on the baseflow and less on the peak flows as expected from this parameter linked to the diffuse delayed response of the karstic aquifer its effect is also symmetrical as shown in fig 10 the 2 disturbance applied on cd has more effect in increasing or decreasing the mean flow and peak flow but less on the baseflow for other parameters a few percent variation would cause the model to fail converging for example a change in kd of 5 would cause the model to fail converging for others porosity specific yield radius it would show little to no effect on the discharges observed at the outlet in order to visualize other parameters sensitivities additional simulations were carried out with much wider ranges of the input parameters in particular the specific yield sy has a strong impact on peaks shape and the recessions fig 11 the recessions are not steep enough in the final simulation for period 1 however decreasing the value of sy any further than 1e 4 does not produce any steeper recessions and causes the model to fail converging after reaching that threshold the size of the network had also an important effect on the discharge at the outlet in the final conduit configurations the radius of the conduits cln elements ranges from 0 1 m upstream to 0 5 m at the spring to study the sensitivity of the discharge to this parameter some simulations were run comparing a range of conduits sizes dividing the radiuses of all conduits by 2 and 5 and multiplying them by 2 and 5 fig 12 in the extreme scenario all conduit radiuses multiplied by 5 the radius at the spring is 2 5 m in this case the main flow peak is better represented but because the system is not draining fast enough the recession not steep enough it results in an excessive modelled volume at the spring this is likely to be due to the selected configuration of deepest conduits pressurised and below the water table especially for the southern conduit and downstream part of the network with the high drain conductance the limiting factor constraining the volume extracted at the spring is the size of the conduits and the difference in volume is coming from the matrix storage hence the potentiometric surface is lowered when increasing the size of conduits there is a trade off found manually between the different parameters see 4 4 diffuse flow one of the advantages of distributed model is being able to quantify diffuse flow and flow paths across any area of the 3 d catchment as an example the effect of the main conduits on the diffuse flow within the aquifer between them is shown in fig 13 here the studied area is located at 31 m depth and in layer four of the model 14 m thickness at this location indicated with the yellow rectangle the major part of the flow is draining towards the east to the spring the overall flow shows a flashy response due to the closeness of conduits part of the flow is drained directly to layer 5 below i e bottom flow the remaining volume either moves towards the northern conduit around 30 40 m depth close to the studied area or towards the southern conduit located around 50 40 m deep in high flow conditions most of the flow is drains toward the northern conduits but this direction changes towards the end of recessions with the flow increasingly starting to feed the deeper southern conduits 4 5 discussion visualisation is very important in geosciences in general which can be particularly enhanced when using distributed models visualisation enable geoscientists to better understand complex and varied datasets and systems and therefore communicate more effectively with each other and with end users 3d modelling is the foundation of the 3d visualization technology which can avoid the loss and distortion of spatial information that can result from using only projected data on planes shao et al 2011 in a karst context it can be used for example to identify geomorphological features jouves et al 2017 silvestre et al 2013 to build better conceptual models and to improve the interpretability of collected data jeannin et al 2012 in this study the use of a 3d detailed geological model combined with a distributed flow modelling approach proved very useful for defining the boundaries of the catchment and likelihood of distribution of the karstic network it was also very important in the calibration process using the discharge time series at the outlet spring as the only parameter to compare the performance of the model against would not have been sufficient to develop the most realistic karst aquifer morphometry the observation of the modelled potentiometric surfaces across the full catchment and at all time steps was necessary to remove configurations where the potentiometric surface would not be consistent with the known hydrogeological behaviour of the catchment i e above the topographic surface or too deep in comparison with known ephemeral springs at a later stage the visualisation tools can be then used to study flow paths and contaminant transport within the karstic system thus achieving a more reliable modelling of the processes involved the diffuse flow analysis highlights the variability of the internal hydrogeological behaviour within the karst catchment it opens new possibilities to assess contaminant transport pathways in karstic contexts including different flow paths under different hydrogeological conditions for example as observed in the previous section the autogenic diffuse flows do not always drain toward the same conduit but change direction depending upon the time since the recharge event such information and insights are essential to better understand diffuse flow behaviour and therefore helping to protect and preserve water resources possible bias in this distributed model include the lack of piezometer data to calibrate the potentiometric surface the assessment of the reliability of the modelled potentiometric surface was done visually compared with the field survey data an ephemeral spring in the north east boundary of the catchment for example building a model based on calibration both at the outlet and from boreholes available more widely across a catchment would help assess the strength of the modelled hydrogeological behaviour a model is only as good as the quality and availability of data and conceptual understanding of a catchment as discussed in the flow simulation results section above undetected conduits or the heterogeneity of fractures in the more diffuse flow zone not included in the model at this stage can have a strong effect especially on the potentiometric surface further fieldwork and the use of geophysical techniques like ert methods would prove useful to validate and refine current hypothesis on the karst network and hydrogeological properties like most hydrological models the question of equifinality arises different representations of an environmental system can be considered acceptable linked with unicity identifiability and stability of the problem solution beven 2006 ebel and loague 2006 here the calibration process combines the comparison against discharge the sensitivity analysis and the visual assessment of the potentiometric surface in the 3d visual model however at this stage of the study for each new simulation a specific set of parameters was modified manually in groundwater vistas 7 the implementation of a target feature for the cln elements in particular for the last cln with drain boundary conditions the spring would enable the automation of a much larger number of simulations using for example a quasi monte carlo procedure with a sobol sequence sampling of the parameter space sobol 1976 the equifinality could then be better assessed through distribution of optimal values of each parameter variance based sensitivity indexes and interactions between parameters mazzilli et al 2017 saltelli 2002 possible ways to improve the model relate to 1 testing a wider range of geological features adding complexity 2 using additional modflow packages discussed below or choices of equations 3 investigating hourly time step regarding the possible variations of geology the possibility of several levels of conduits instead of a single one with variations of depths is currently investigated further work could include more variations of size of the network possible constrictions tortuosity and variations of the number of sinkholes as concentrated infiltration pathways one way to explore changes in the conduit network could be using a pseudo genetic approach to generate a large set of karst conduits based on fracture distribution data like the stochastic karst simulator sks borghi et al 2016 2012 sivelle et al 2020 vuilleumier et al 2012 different ways to account for an epikarst layer in the upper part of the model could also help to achieve a better performance and representation of the hydrogeological catchment vertical gradient of hydraulic conductivity fractures or additional network of smaller conduits lateral variations of parameters the use of additional modflow and modflow usg packages like the evapotranspiration package et fractures unsaturated zone flow uzf dual domain flow packages fractures can be incorporated in the model at a later stage different formulations could also be tested like the preissmann slot concept to incorporate pressurised flow to reproduce the transition between free surface flow and pressurized flow this approach was implemented in different studies using us environmental protection agency storm water management model swmm for urban drainage networks ferreri et al 2010 and in karst environment gabrovšek and peric 2006 halihan et al 1998 perne et al 2012 peterson and wicks 2006 and in the pipe network models using infoworks cs gill et al 2013b schuler et al 2020 2018 in modflow usg cln currently confined flow within cln is used to account for pressurised conditions but between cln only and through the use of convertible cells to simulate flow to dry cells between cln and gwf cell the flow exchange between cln and gwf cells is then possible in both directions and wet and dry cells however there is not an explicit pressurised formulation available assessing the difference that could result in the flow path and dynamics could be a perspective of such future work finally as seen discussed above in the flow simulation results section the dynamics of the discharge were not always simulated with very high nash sutcliffe efficiency and king gupta efficiency between the observed and simulated discharge time series particularly during the recession periods working at a hourly time step might help to improve this issue even though in this case the time series available in hourly time step contained some gaps which would need to filled based on alternative rainfall data collected in the region finally using the adaptive time stepping option ats package in modflow usg could be used to try and prevent non convergence and increase the stability 5 conclusions numerical groundwater models are one of the most important predictive tools available for managing water resources in aquifers scanlon et al 2003 the recently developed hybrid model modflow usg with connected linear networks clns was used to simulate flow and transport on a small irish catchment the combined use of calibration against flow discharge at the spring and visualisation of the potentiometric surface is useful to build more trustworthy models and investigate the hydrogeological behaviour of karst aquifers and their internal dynamics these first results using modflow usg with clns are promising to model karst systems specifically however the performance will benefit from automation and added feature in groundwater vistas like the possibility to use cln as targets for a more extensive calibration such models can inform the management of water resources both quantitatively and qualitatively in particular they have a lot of potential for evaluating diffuse contaminant transport in karst environments credit authorship contribution statement lea duran conceptualization methodology formal analysis investigation software laurence gill supervision validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was conducted within the irish centre for research in applied geosciences icrag and trinity college dublin supported in part by a research grant from science foundation ireland sfi and is co funded under the european regional development fund and by icrag industry partners sincerest thanks to sorab panday and james rumbaugh for answering my questions on the code and groundwater vistas 7 the authors thank philip schuler from the department of civil structural and environmental engineering trinity college dublin for the help on the study site 
4589,bioclogging resulting from excess biomass growth in porous media can influence flow solute transport and biogeochemical reactions in natural and remedial subsurface systems in this study we investigated bioclogging in heterogeneous porous media using a reactive transport model with a focus on the effect of shear stresses on the spatial changes of biomass accumulation and hydraulic properties the results show that when the shearing induced detachment was negligible the accumulation of biomass was mainly controlled by substrate transport newly generated biomass was then accumulated in the regions with high hydraulic conductivity due to the fast substrate supply resulting in a homogenization of hydraulic conductivity when the shearing induced detachment was significant newly generated biomass was less accumulated in the flow paths with higher hydraulic conductivity and more in the pore regions with relatively low hydraulic conductivity resulting in the increase of heterogeneity in hydraulic conductivity the results were then used to establish a macroscopic correlation between the reduction of porosity and the reduction of hydraulic conductivity as a result of biomass growth and to identify factors controlling such a correlation a correlation was established and was found to be significantly affected by flow velocity and shearing induced biomass detachment overall this study indicated that flow induced shearing is important in understanding bioclogging and its effect on hydraulic conductivity and water flow in porous media keywords bioclogging shear stresses hydraulic heterogeneity upscaling 1 introduction water flow and biogeochemical reactions in porous media are the two key processes that control the transformation and reactive transport of nutrients and contaminants in various subsurface environments such as hyporheic zones boano et al 2014 liu et al 2017 yang et al 2018 constructed or natural wetlands hunt et al 1997 polizzotto et al 2008 and remedial aquifers neumann et al 2010 biogeochemical reactions are often catalyzed by microorganisms that gain energy for survival and growth from the reactions the growth of microorganisms stimulates biogeochemical reactions however the accumulation of biomass including cells and extracellular polymeric substances eps can modify the geometry of porous media thus reducing local porosity and hydraulic conductivity affecting water flow and subsequent substrate supply for biogeochemical reactions baveye et al 1998 brovelli et al 2009 dupin and mccarty 2000 thullner 2010 vandevivere and baveye 1992b the microscopic morphology and spatial distribution of accumulated biomass in the porous media were investigated with pore scale in situ visualization experiments aufrecht et al 2019 carrel et al 2018 kim et al 2010 or numerical simulations deng et al 2013 yan et al 2018 by conceptualizing the pore scale behavior of biomass accumulation and pore geometry change some semi empirical correlations were proposed to describe the effect of biomass accumulation on local porosity and hydraulic conductivity at darcy scale clement et al 1996 seki and miyazaki 2001 taylor et al 1990 thullner et al 2002 vandevivere 1995 integrating these empirical correlations into reactive transport models berlin et al 2015 caruso et al 2017 newcomer et al 2016 2018 rajabzadeh et al 2015 samso et al 2016 xian et al 2019 zhu et al 2019 indicated that biomass accumulation can be an important factor influencing the evolution of the porous media structure and subsequent water flow and reactive transport the influence of biomass growth and accumulation on water flow and reactive transport is further complicated by hydraulic heterogeneity that is common in subsurface environments janot et al 2016 li et al 2010 liu et al 2015 yan et al 2017 biomass induced bioclogging may enhance or decrease hydraulic heterogeneity depending on the accumulation of biomass at global scale bottero et al 2013 dupin and mccarty 2000 karrabi et al 2011 kildsgaard and engesgaard 2001 2002 seifert and engesgaard 2007 2012 stewart and fogler 2001 when biomass accumulation occurs in preferential flow domains hydraulic heterogeneity will decrease while when biomass accumulates in low flow regions the heterogeneity of hydraulic conductivity will increase ehlinger et al 1987 ostvar et al 2018 rodríguez escales et al 2016 seki et al 2006 sharp et al 1999 the biomass accumulation locations will likely depend on the relative rates of biomass growth that is affected by the supply of nutrients and biomass removal that is mainly controlled by the shear stresses induced by fluid flow however the influence of biomass induced bioclogging on the evolution of hydraulic properties and their feedback influence on subsequent water flow nutrient supply and biogeochemical reactions especially in heterogeneous porous media are not well understood in this study we investigated biomass growth and removal using fluid flow and reactive transport models with a focus on the effect of shear stresses from fluid flow on the evolution of porosity and hydraulic conductivity in heterogeneous porous media the models integrated biogeochemical reactions and biomass growth kinetics shearing induced biomass detachment the effect of biomass accumulation on the transient changes of local porosity and hydraulic conductivity and their feedback effects on biogeochemical reactions and biomass growth the models were first calibrated with the experimental data reported in literature and then used to investigate the preferential locations of biomass accumulation assess the effect of biomass removal by shear stresses on biomass accumulation and evolution of hydraulic heterogeneity and evaluate the empirical correlations between biomass accumulation and hydraulic conductivity in heterogeneous porous domain under different flow conditions 2 model description 2 1 water flow water flow in saturated porous media is described using darcy s law 1 t ε ρ ρ u 0 2 u k ρ g p where ε is the porosity of the porous media ρ kg m 3 is the density of water k m s 1 denotes the hydraulic conductivity of the porous media g m s 2 is acceleration due to gravity p pa is the water pressure u m s 1 is the darcy s velocity and t s is time the change of local porosity as a result of biomass accumulation was described using the following equation 3 ε bio x bio m bio ρ bio 4 ε ε 0 ε bio where ε bio is the local volume fraction of biomass ε 0 is the initial porosity of the porous media x bio mol m 3 is the biomass concentration m bio kg mol 1 is the molar mass of biomass i e m bio 0 113 kg mol if biomass is represented using c5h7o2n rittmann and maccarty 2001 and ρ bio kg m 3 is the biomass density dry weight per wet volume there are several bioclogging models to describe the correlation between the decrease of local porosity and the change of local hydraulic conductivity at the darcy scale generally the correlations depend on the hypothesis of microscopic distribution of the biomass in pore spaces dupin and mccarty 2000 thullner 2010 thullner et al 2002 vandevivere and baveye 1992b biomass may cover the surface of the grains homogeneously forming biofilms or may accumulate in the pore throats to form discrete colonies the accumulation of biomass in the pore throats or places with wide pore diameter can have a strong effect on the bioclogging kim et al 2010 or et al 2007 ostvar et al 2018 several studies found thick biofilms in eutrophic systems that contain large amount of extracellular polymeric substances e g in substrate rich experiments and in bioengineering of sewage treatment plants colonies are considered to be more common in unpolluted groundwater systems barai et al 2016 perujo et al 2019 rosenzweig et al 2013 in this work a semi empirical model proposed by vandevivere 1995 was adopted to calculate the local hydraulic conductivity from the local porosity change as shown in eq 5 the model considers both of aforementioned phenomena and has been widely used in previous studies with good prediction performance karrabi et al 2011 seifert and engesgaard 2012 5 k ε k 0 f ε ε ε 0 2 1 f ε k r min 1 ε ε 0 1 k r min 6 f ε exp 0 5 1 ε ε 0 1 ε rc 2 where k 0 m s 1 is the initial hydraulic conductivity of the porous media ε rc is fitting parameter and k r min is minimum relative saturated hydraulic conductivity 2 2 biomass growth and biogeochemical reactions aerobic respiration with acetate as electron donor and nitrate as nitrogen source table s1 was considered as a simplified example to demonstrate the effect of biomass accumulation as a result of biomass growth and shearing induced removal on the evolution of porous media structure and subsequent biogeochemical reactions the overall reaction for biomass growth and biogeochemical reactions can be expressed using a thermodynamic approach rittmann and maccarty 2001 7 1 8 ch 3 coo 1 f s 4 o 2 f s 28 no 3 f s 28 h f s 28 c 5 h 7 o 2 n 7 6 f s 56 h 2 o 7 10 f s 56 co 2 1 8 hco 3 where f s is the electron equivalent ratio of the electron donor used for biomass synthesis in the overall microbial process a dual saturation type rate expression with respect to acetate doc and dissolved oxygen do that includes a biomass inhibition term was used to describe the rates of biomass growth and associated biogeochemical reactions rittmann and maccarty 2001 8 r doc v bio x bio c doc k doc c doc c do k do c do k bio k bio x bio 9 r do 2 1 f s v bio x bio c doc k doc c doc c do k do c do k bio k bio x bio 10 r bio 2 f s 7 v bio x bio c doc k doc c doc c do k do c do k bio k bio x bio where r doc mol m 3s 1 is the doc consumption rate r do mol m 3s 1 is the dissolved oxygen do consumption rate r bio mol m 3s 1 is the growth rate of microorganisms c doc mol m 3 and c do mol m 3 are the concentrations of doc and do respectively k doc mol m 3 and k do mol m 3 are the half saturation constants for doc and do respectively v bio s 1 is the maximum specific growth rate k bio mol m 3 is the biomass inhibition constant and the k bio k bio x bio is the biomass limitation term of substrate utilization and biomass growth which may be attributed to limited pore space contact inhibition and concentration gradients within and outside the microbial aggregate akhavan et al 2013 berlin et al 2015 kindred and celia 1989 lee et al 2006 macquarrie and sudicky 2001 the reaction rates for other chemicals were calculated from the stoichiometric relationship eq 7 the endogenous decay of biomass and the detachment of biomass by shear stresses were considered as two mechanisms responsible for the loss of biomass from the attached locations the combined rates of these two processes were described as follows 11 r loss b dec b det x bio where b dec s 1 is specific biomass decay coefficient b det s 1 is specific biomass detachment coefficient which has a following expression rittman 1982 12 b det c d σ 0 58 l f 3 10 5 m c d σ 1 443 2 100 l f 0 003 0 58 l f 3 10 5 m where l f m is the biofilm thickness c d is an empirical parameter and σ kg m 1s 2 is the shear stress 13 σ 100 μ u 1 ε 3 d 2 ε 3 a u m s 1 is the pore velocity a m 1 is the specific surface area and d m is the diameter of the particles in the equation u was calculated from the darcy velocity in eqs 1 and 2 and a was estimated from the kozeny carman equation 14 u u ε 15 a 5 ε 0 3 ρ g k 0 μ 1 ε 0 2 0 5 where μ kg m 1s 1 is the dynamic viscosity of water to calculate d and l f in eq 13 the solid particles in the porous media are assumed to be spherical 16 d 6 a 17 l f ε bio 1 ε 0 a the net accumulation rate of bacteria can be calculated as 18 d x bio dt r bio r loss 2 3 reactive transport model the local concentrations of soluble substrates including do and doc depend on the combined effect of advective and diffusive transport in the aqueous phase and their consumption by biogeochemical reactions the coupling of these processes is described using the multicomponent advection dispersion reaction equation 19 ε c i t d d i d e i c i u c i r i where c i mol m 3 is the concentration of a chemical species r i mol m 3s 1 is the reaction rate of a chemical species d d i m2s 1 and d e i m2s 1 are the mechanical dispersion coefficient and diffusion coefficient of a chemical species respectively 20 d d i α i u where α i m is the dispersity of a chemical species a two dimensional rectangular heterogeneous media with an initial porosity of 0 35 was used as a simulation domain in this study the simulation domain has a dimension of 1 5 m 0 5 m and was discretized to 300 100 grid blocks the initial distribution of hydraulic conductivity was assumed to follow a log normal distribution with a geometric mean of 1 10 4 m s and a variance σ lg k 2 of 0 64 fig 1 and was generated using sequential gaussian simulation by the sgems software remy et al 2009 a constant hydraulic head was imposed at the right side boundary and a constant flux condition at the left side boundary no flow boundary conditions were implemented on the top and bottom of the model the soluble substrates including doc and do were injected into the model domain from the left side boundary with a constant acetate concentration of 0 05 mol m3 represent a moderate pollution and dissolved oxygen concentration of 0 22 mol m3 two comparative scenarios were considered the first scenario scenario a did not consider the shearing induced biomass detachment a scenario similar to those investigated previously berlin et al 2015 caruso et al 2017 newcomer et al 2016 2018 samso et al 2016 xian et al 2019 while the second scenario scenario b considered the shearing induced detachment of biomass six simulations were performed for each scenario to investigate the biomass detachments under different flow rates expressed as f f 1 1 10 5 m s f 2 5 10 5 m s f 3 1 10 4 m s f 4 5 10 4 m s f 5 1 10 3 m s equations 1 20 were solved using comsol multiphysics comsol inc and the parameters used in these simulations are provided in table 1 after 200 days of simulation the porosity and hydraulic conductivity in the model domain no longer changed fig s1 indicating that the simulation results reached a steady state 3 results 3 1 model validation the models both for scenarios a and b were calibrated based on the experiment results reported previously seifert and engesgaard 2012 the initial porosity permeability flow and substrate input boundary conditions used in the experiments were adopted here in the model calibration in the experiments three repetitive cases were obtained in 20 days fig 2 in the model biomass decay coefficient b dec was not provided in the experimental studies and was therefore adjusted to fit the experimental results for both scenarios the fitted parameter values were provided in table 1 using the parameters in table 1 in the model the model simulation results matched well with the measured results fig 2 3 2 biomass growth and bioclogging biomass accumulation started from the inlet boundary as this was the supply side for organic carbon and oxygen in both scenarios a and b fig 3 generally the accumulated amount of biomass decreased along flow direction as the substrates i e organic carbon and oxygen carried by fluid were gradually consumed the flow velocity had a strong influence on biomass growth and distribution a lower flow velocity increased fluid residence time allowing more time for biogeochemical reactions and biomass growth resulting in more biomass being accumulated near the inlet in both scenarios biomass removal by the shear stresses has a strong effect on biomass accumulation and its distribution fig 3 when the shearing was not considered scenario a biomass preferentially accumulated in higher hydraulic conductivity region as a result of the higher availability of the substrates delivered by higher local velocity fig 4 when the shearing was considered scenario b the degree of biomass accumulation along the high permeability path decreased as compared to the cases in scenario a this is because a higher local flow velocity generated a higher shear stresses which enhanced the detachment of the attached biomass fig 4 3 3 biomass accumulation and hydraulic heterogeneity the different biomass distributions with and without considering the shearing effect resulted in different temporal evolution of hydraulic conductivity in fig 5 the porous media was sectioned in x direction x 0 05 m 0 25 m 0 5 m 0 75 m 1 m and 1 25 m to calculate the local hydraulic conductivity within each section the calculated hydraulic conductivity was log scaled and used to estimate their log standard deviation σ lgk for each cross section in general a larger σ lgk indicates higher local heterogeneity fogg 1986 freeze 1975 hoeksema and kitanidis 1985 fig 5 showed that in scenario a the calculated σ lgk gradually decreased with time in each cross section indicating that the local heterogeneity of hydraulic conductivity decreased as biomass accumulated because biomass gradually filled in high permeable domains with time fig 3 in scenario b however the σ lgk only decreased with time under a condition of low flow velocity because the shear stresses are negligible when flow velocity was low under high velocity conditions σ lgk slightly increased with time indicating that the heterogeneity of local hydraulic conductivity increased because biomass mainly accumulated in relatively low flow velocity regions leading to an increase in spatial disparity of local hydraulic conductivity 3 4 macroscopic correlation between porosity and hydraulic conductivity in the simulations as described above eqs 5 and 6 were used to estimate local hydraulic conductivity as a function of local porosity that was influenced by biomass accumulation to evaluate whether such a relationship used to describe the domain scale change of hydraulic conductivity as a function of domain scale porosity the domain averaged relative porosity ε r and relative hydraulic conductivity k r were calculated from local porosity and hydraulic conductivity 21 ε r ε ε 0 22 k r k ε k 0 23 k ε f ρ g l δ p where ε is the domain averaged porosity k ε is the domain averaged hydraulic conductivity l m is the length of the domain δ p pa is the hydraulic pressure difference between right side and left side boundaries ε 0 and k 0 m s are the averaged initial porosity and hydraulic conductivity in the domain respectively and all other parameters were defined before in both scenarios a and b the domain averaged relative porosity and relative hydraulic conductivity were lower than the initial values as biomass accumulation decreased the overall porosity and hydraulic conductivity in the domain fig 6 however in scenario b the domain averaged relative porosity and relative hydraulic conductivity first decreased and then decreased with increasing average flow rate this is because the biomass accumulation was mainly controlled by the substrate transport and shearing induced biomass detachment was less important under low flow condition when flow velocity is fast the removal of biomass by the shearing force led to rebounding of the relative porosity and hydraulic conductivity in the domain the domain averaged k r ε r relationship in both scenarios a and b matched well with the biofilm plug formation model eq 5 under high flow condition fig 7 but increasingly deviated from the model with decreasing flow velocity when the flow velocity was high the local scale heterogeneity of hydraulic conductivity would increase as described before however such an increase occurred relatively homogeneously in the domain and biomass was uniform distributed along the flow direction at the macroscopic scale fig 8 so that the local scale model was valid in linking macroscopic porosity with hydraulic conductivity conversely when the flow velocity was low biomass was unevenly distributed along the flow direction on the macroscopic scale fig 8 and thus the local scale model was not applicable 4 discussion heterogeneous hydraulic conductivity is a common phenomenon in subsurface as the result of biogeochemical reactions in porous media an enhancement of flow heterogeneity has been generally observed bottero et al 2013 dupin and mccarty 2000 ehlinger et al 1987 kildsgaard and engesgaard 2001 murphy et al 1997 rodríguez escales et al 2016 seifert and engesgaard 2007 seki et al 2006 sharp et al 1999 stewart and fogler 2001 and that was hypothetically attributed to the preferential detachment of biomass by shear stresses the result in this study indicated that the effect of shearing induced biomass detachment on hydraulic heterogeneity depended on flow velocity when the flow velocity was low the effect of the shear stresses on biomass detachment was negligible and biomass mainly accumulated in high flow paths with fast substrate supply as a result the local porosity and hydraulic conductivity became more homogeneous conversely when the flow velocity was high the shearing induced detachment prevented biomass accumulation in the areas with high hydraulic conductivity however biomass still accumulated in regions with relatively lower flow velocity and lower shear stresses resulting in an increase of local porosity and hydraulic conductivity heterogeneity reactive transport models are often used to study bioclogging process in natural and remedial environments as a result of biomass growth and accumulation berlin et al 2015 caruso et al 2017 newcomer et al 2016 2018 samso et al 2016 xian et al 2019 although the maximum flow velocity reported in these studies is consistent with the flow conditions considered in this study the effect of biomass detachment induced by shearing was typically not considered our results suggested that it s necessary to take the shearing induced biomass detachment into account in simulations of bioclogging especially when it is during high flow events this is important for simulating biogeochemical processes in contaminated subsurface environment that involves preferred flow paths where the maximum flow velocity may even be higher than the flow velocity used in this study constantz 2008 mosley 1982 vogt et al 2010 the key to study bioclogging is to establish an appropriate model to link macroscopic hydraulic conductivity changes with the porosity changes a number of correlation models have been developed based on experimental results cunningham et al 1991 karrabi et al 2011 seifert and engesgaard 2012 taylor and jaffé 1990 vandevivere and baveye 1992a these models considered the effects of various factors including the properties of sediment particles and microorganisms such as grain size shape arrangement as well as mineralogical composition this study showed that the flow velocity was an important factor that may significantly affect the application of the correlations in large scale systems when flow velocity was high sufficient substrate supplies allow the biomass to be uniformly distributed across the domain the local scale model well matched with the domain averaged correlations between hydraulic conductivity and porosity fig 7 conversely when the flow velocity was low biomass primarily accumulated near the inlet region leading to large difference in porosity and hydraulic conductivity between inlet and outlet sides fig 8 the local scale correlation models were apparently not applicable to such scenarios at the macroscopic scale on the one hand when the shearing induced biomass detachment was taken into account the bioclogging at the inlet side was avoided due to shearing induced removal of biomass fig 3 and the domain averaged correlations would better match the local scale correlation models in addition to the flow velocity the temporal fluctuation of flow condition ning et al 2020 temperature kadlec and reddy 2001 zheng and cardenas 2018 and inlet substrate concentrations liu et al 2019 can also influence biomass growth or detachment behaviors process level models and or model parameters are often not available currently that allow to simultaneously integrates the effects of the factors above and thus were not considered in this study coupled experimental and numerical studies are therefore needed to fully assess the biomass growth and detachment behaviors 5 conclusions the results indicated that the effect of shearing induced biomass detachment depended on overall and local flow velocities when overall flow velocity was low the effect of shearing induced biomass detachment can be ignored however under such scenarios biomass would primarily accumulate in the areas with high local flow velocity near the inlet regions leading to a high potential of bioclogging that affected subsequent flow and solute transport and biogeochemical reactions in the downstream on the contrary when overall flow velocity was high biomass accumulation in high flow velocity paths was minimized by the shear stresses of the fluid flow preventing bioclogging the results implied that in subsurface environments with variable flow velocities such as in hyporheic zones biomass may accumulate in preferential flow paths when flow velocity is low and may be removed when flow velocity is high resulting in a dynamic change in biomass accumulation and removal this study also showed the local and overall heterogeneity of porosity and hydraulic conductivity changed as result of biomass accumulation when flow velocity was low local porosity and hydraulic conductivity became more homogeneous in the inlet regions as biomass accumulated in the fast flow paths but less changed in the outlet side this generated a large discrepancy of porosity and hydraulic conductivity between inlet and outlet sides leading to the failure of the local scale relationship between hydraulic conductivity and porosity such as the biofilm plug formation model eq 5 in this work to describe the domain averaged hydraulic conductivity as a function of domain averaged porosity on the other hand when flow velocity was high the biomass was primarily accumulated in flow paths with relatively lower flow velocity that did not have a strong shear stress this would preserve preferential flow paths and decrease hydraulic conductivity in other regions resulting in an increase in the local heterogeneity of hydraulic conductivity however under such scenarios the flow was not clogged at the domain scale and thus biomass can accumulate in the entire domain resulting in relatively homogeneous distribution of biomass at the domain scale and the applicability of the macroscopic relationship between hydraulic conductivity and porosity despite the increase of heterogeneity in local porosity and heterogeneity declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national key research and development project china 2019yfc1803900 and national natural science foundation of china grant no 41830861 41907166 additional support was from the project no 2017zt07z479 the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 126083 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
4589,bioclogging resulting from excess biomass growth in porous media can influence flow solute transport and biogeochemical reactions in natural and remedial subsurface systems in this study we investigated bioclogging in heterogeneous porous media using a reactive transport model with a focus on the effect of shear stresses on the spatial changes of biomass accumulation and hydraulic properties the results show that when the shearing induced detachment was negligible the accumulation of biomass was mainly controlled by substrate transport newly generated biomass was then accumulated in the regions with high hydraulic conductivity due to the fast substrate supply resulting in a homogenization of hydraulic conductivity when the shearing induced detachment was significant newly generated biomass was less accumulated in the flow paths with higher hydraulic conductivity and more in the pore regions with relatively low hydraulic conductivity resulting in the increase of heterogeneity in hydraulic conductivity the results were then used to establish a macroscopic correlation between the reduction of porosity and the reduction of hydraulic conductivity as a result of biomass growth and to identify factors controlling such a correlation a correlation was established and was found to be significantly affected by flow velocity and shearing induced biomass detachment overall this study indicated that flow induced shearing is important in understanding bioclogging and its effect on hydraulic conductivity and water flow in porous media keywords bioclogging shear stresses hydraulic heterogeneity upscaling 1 introduction water flow and biogeochemical reactions in porous media are the two key processes that control the transformation and reactive transport of nutrients and contaminants in various subsurface environments such as hyporheic zones boano et al 2014 liu et al 2017 yang et al 2018 constructed or natural wetlands hunt et al 1997 polizzotto et al 2008 and remedial aquifers neumann et al 2010 biogeochemical reactions are often catalyzed by microorganisms that gain energy for survival and growth from the reactions the growth of microorganisms stimulates biogeochemical reactions however the accumulation of biomass including cells and extracellular polymeric substances eps can modify the geometry of porous media thus reducing local porosity and hydraulic conductivity affecting water flow and subsequent substrate supply for biogeochemical reactions baveye et al 1998 brovelli et al 2009 dupin and mccarty 2000 thullner 2010 vandevivere and baveye 1992b the microscopic morphology and spatial distribution of accumulated biomass in the porous media were investigated with pore scale in situ visualization experiments aufrecht et al 2019 carrel et al 2018 kim et al 2010 or numerical simulations deng et al 2013 yan et al 2018 by conceptualizing the pore scale behavior of biomass accumulation and pore geometry change some semi empirical correlations were proposed to describe the effect of biomass accumulation on local porosity and hydraulic conductivity at darcy scale clement et al 1996 seki and miyazaki 2001 taylor et al 1990 thullner et al 2002 vandevivere 1995 integrating these empirical correlations into reactive transport models berlin et al 2015 caruso et al 2017 newcomer et al 2016 2018 rajabzadeh et al 2015 samso et al 2016 xian et al 2019 zhu et al 2019 indicated that biomass accumulation can be an important factor influencing the evolution of the porous media structure and subsequent water flow and reactive transport the influence of biomass growth and accumulation on water flow and reactive transport is further complicated by hydraulic heterogeneity that is common in subsurface environments janot et al 2016 li et al 2010 liu et al 2015 yan et al 2017 biomass induced bioclogging may enhance or decrease hydraulic heterogeneity depending on the accumulation of biomass at global scale bottero et al 2013 dupin and mccarty 2000 karrabi et al 2011 kildsgaard and engesgaard 2001 2002 seifert and engesgaard 2007 2012 stewart and fogler 2001 when biomass accumulation occurs in preferential flow domains hydraulic heterogeneity will decrease while when biomass accumulates in low flow regions the heterogeneity of hydraulic conductivity will increase ehlinger et al 1987 ostvar et al 2018 rodríguez escales et al 2016 seki et al 2006 sharp et al 1999 the biomass accumulation locations will likely depend on the relative rates of biomass growth that is affected by the supply of nutrients and biomass removal that is mainly controlled by the shear stresses induced by fluid flow however the influence of biomass induced bioclogging on the evolution of hydraulic properties and their feedback influence on subsequent water flow nutrient supply and biogeochemical reactions especially in heterogeneous porous media are not well understood in this study we investigated biomass growth and removal using fluid flow and reactive transport models with a focus on the effect of shear stresses from fluid flow on the evolution of porosity and hydraulic conductivity in heterogeneous porous media the models integrated biogeochemical reactions and biomass growth kinetics shearing induced biomass detachment the effect of biomass accumulation on the transient changes of local porosity and hydraulic conductivity and their feedback effects on biogeochemical reactions and biomass growth the models were first calibrated with the experimental data reported in literature and then used to investigate the preferential locations of biomass accumulation assess the effect of biomass removal by shear stresses on biomass accumulation and evolution of hydraulic heterogeneity and evaluate the empirical correlations between biomass accumulation and hydraulic conductivity in heterogeneous porous domain under different flow conditions 2 model description 2 1 water flow water flow in saturated porous media is described using darcy s law 1 t ε ρ ρ u 0 2 u k ρ g p where ε is the porosity of the porous media ρ kg m 3 is the density of water k m s 1 denotes the hydraulic conductivity of the porous media g m s 2 is acceleration due to gravity p pa is the water pressure u m s 1 is the darcy s velocity and t s is time the change of local porosity as a result of biomass accumulation was described using the following equation 3 ε bio x bio m bio ρ bio 4 ε ε 0 ε bio where ε bio is the local volume fraction of biomass ε 0 is the initial porosity of the porous media x bio mol m 3 is the biomass concentration m bio kg mol 1 is the molar mass of biomass i e m bio 0 113 kg mol if biomass is represented using c5h7o2n rittmann and maccarty 2001 and ρ bio kg m 3 is the biomass density dry weight per wet volume there are several bioclogging models to describe the correlation between the decrease of local porosity and the change of local hydraulic conductivity at the darcy scale generally the correlations depend on the hypothesis of microscopic distribution of the biomass in pore spaces dupin and mccarty 2000 thullner 2010 thullner et al 2002 vandevivere and baveye 1992b biomass may cover the surface of the grains homogeneously forming biofilms or may accumulate in the pore throats to form discrete colonies the accumulation of biomass in the pore throats or places with wide pore diameter can have a strong effect on the bioclogging kim et al 2010 or et al 2007 ostvar et al 2018 several studies found thick biofilms in eutrophic systems that contain large amount of extracellular polymeric substances e g in substrate rich experiments and in bioengineering of sewage treatment plants colonies are considered to be more common in unpolluted groundwater systems barai et al 2016 perujo et al 2019 rosenzweig et al 2013 in this work a semi empirical model proposed by vandevivere 1995 was adopted to calculate the local hydraulic conductivity from the local porosity change as shown in eq 5 the model considers both of aforementioned phenomena and has been widely used in previous studies with good prediction performance karrabi et al 2011 seifert and engesgaard 2012 5 k ε k 0 f ε ε ε 0 2 1 f ε k r min 1 ε ε 0 1 k r min 6 f ε exp 0 5 1 ε ε 0 1 ε rc 2 where k 0 m s 1 is the initial hydraulic conductivity of the porous media ε rc is fitting parameter and k r min is minimum relative saturated hydraulic conductivity 2 2 biomass growth and biogeochemical reactions aerobic respiration with acetate as electron donor and nitrate as nitrogen source table s1 was considered as a simplified example to demonstrate the effect of biomass accumulation as a result of biomass growth and shearing induced removal on the evolution of porous media structure and subsequent biogeochemical reactions the overall reaction for biomass growth and biogeochemical reactions can be expressed using a thermodynamic approach rittmann and maccarty 2001 7 1 8 ch 3 coo 1 f s 4 o 2 f s 28 no 3 f s 28 h f s 28 c 5 h 7 o 2 n 7 6 f s 56 h 2 o 7 10 f s 56 co 2 1 8 hco 3 where f s is the electron equivalent ratio of the electron donor used for biomass synthesis in the overall microbial process a dual saturation type rate expression with respect to acetate doc and dissolved oxygen do that includes a biomass inhibition term was used to describe the rates of biomass growth and associated biogeochemical reactions rittmann and maccarty 2001 8 r doc v bio x bio c doc k doc c doc c do k do c do k bio k bio x bio 9 r do 2 1 f s v bio x bio c doc k doc c doc c do k do c do k bio k bio x bio 10 r bio 2 f s 7 v bio x bio c doc k doc c doc c do k do c do k bio k bio x bio where r doc mol m 3s 1 is the doc consumption rate r do mol m 3s 1 is the dissolved oxygen do consumption rate r bio mol m 3s 1 is the growth rate of microorganisms c doc mol m 3 and c do mol m 3 are the concentrations of doc and do respectively k doc mol m 3 and k do mol m 3 are the half saturation constants for doc and do respectively v bio s 1 is the maximum specific growth rate k bio mol m 3 is the biomass inhibition constant and the k bio k bio x bio is the biomass limitation term of substrate utilization and biomass growth which may be attributed to limited pore space contact inhibition and concentration gradients within and outside the microbial aggregate akhavan et al 2013 berlin et al 2015 kindred and celia 1989 lee et al 2006 macquarrie and sudicky 2001 the reaction rates for other chemicals were calculated from the stoichiometric relationship eq 7 the endogenous decay of biomass and the detachment of biomass by shear stresses were considered as two mechanisms responsible for the loss of biomass from the attached locations the combined rates of these two processes were described as follows 11 r loss b dec b det x bio where b dec s 1 is specific biomass decay coefficient b det s 1 is specific biomass detachment coefficient which has a following expression rittman 1982 12 b det c d σ 0 58 l f 3 10 5 m c d σ 1 443 2 100 l f 0 003 0 58 l f 3 10 5 m where l f m is the biofilm thickness c d is an empirical parameter and σ kg m 1s 2 is the shear stress 13 σ 100 μ u 1 ε 3 d 2 ε 3 a u m s 1 is the pore velocity a m 1 is the specific surface area and d m is the diameter of the particles in the equation u was calculated from the darcy velocity in eqs 1 and 2 and a was estimated from the kozeny carman equation 14 u u ε 15 a 5 ε 0 3 ρ g k 0 μ 1 ε 0 2 0 5 where μ kg m 1s 1 is the dynamic viscosity of water to calculate d and l f in eq 13 the solid particles in the porous media are assumed to be spherical 16 d 6 a 17 l f ε bio 1 ε 0 a the net accumulation rate of bacteria can be calculated as 18 d x bio dt r bio r loss 2 3 reactive transport model the local concentrations of soluble substrates including do and doc depend on the combined effect of advective and diffusive transport in the aqueous phase and their consumption by biogeochemical reactions the coupling of these processes is described using the multicomponent advection dispersion reaction equation 19 ε c i t d d i d e i c i u c i r i where c i mol m 3 is the concentration of a chemical species r i mol m 3s 1 is the reaction rate of a chemical species d d i m2s 1 and d e i m2s 1 are the mechanical dispersion coefficient and diffusion coefficient of a chemical species respectively 20 d d i α i u where α i m is the dispersity of a chemical species a two dimensional rectangular heterogeneous media with an initial porosity of 0 35 was used as a simulation domain in this study the simulation domain has a dimension of 1 5 m 0 5 m and was discretized to 300 100 grid blocks the initial distribution of hydraulic conductivity was assumed to follow a log normal distribution with a geometric mean of 1 10 4 m s and a variance σ lg k 2 of 0 64 fig 1 and was generated using sequential gaussian simulation by the sgems software remy et al 2009 a constant hydraulic head was imposed at the right side boundary and a constant flux condition at the left side boundary no flow boundary conditions were implemented on the top and bottom of the model the soluble substrates including doc and do were injected into the model domain from the left side boundary with a constant acetate concentration of 0 05 mol m3 represent a moderate pollution and dissolved oxygen concentration of 0 22 mol m3 two comparative scenarios were considered the first scenario scenario a did not consider the shearing induced biomass detachment a scenario similar to those investigated previously berlin et al 2015 caruso et al 2017 newcomer et al 2016 2018 samso et al 2016 xian et al 2019 while the second scenario scenario b considered the shearing induced detachment of biomass six simulations were performed for each scenario to investigate the biomass detachments under different flow rates expressed as f f 1 1 10 5 m s f 2 5 10 5 m s f 3 1 10 4 m s f 4 5 10 4 m s f 5 1 10 3 m s equations 1 20 were solved using comsol multiphysics comsol inc and the parameters used in these simulations are provided in table 1 after 200 days of simulation the porosity and hydraulic conductivity in the model domain no longer changed fig s1 indicating that the simulation results reached a steady state 3 results 3 1 model validation the models both for scenarios a and b were calibrated based on the experiment results reported previously seifert and engesgaard 2012 the initial porosity permeability flow and substrate input boundary conditions used in the experiments were adopted here in the model calibration in the experiments three repetitive cases were obtained in 20 days fig 2 in the model biomass decay coefficient b dec was not provided in the experimental studies and was therefore adjusted to fit the experimental results for both scenarios the fitted parameter values were provided in table 1 using the parameters in table 1 in the model the model simulation results matched well with the measured results fig 2 3 2 biomass growth and bioclogging biomass accumulation started from the inlet boundary as this was the supply side for organic carbon and oxygen in both scenarios a and b fig 3 generally the accumulated amount of biomass decreased along flow direction as the substrates i e organic carbon and oxygen carried by fluid were gradually consumed the flow velocity had a strong influence on biomass growth and distribution a lower flow velocity increased fluid residence time allowing more time for biogeochemical reactions and biomass growth resulting in more biomass being accumulated near the inlet in both scenarios biomass removal by the shear stresses has a strong effect on biomass accumulation and its distribution fig 3 when the shearing was not considered scenario a biomass preferentially accumulated in higher hydraulic conductivity region as a result of the higher availability of the substrates delivered by higher local velocity fig 4 when the shearing was considered scenario b the degree of biomass accumulation along the high permeability path decreased as compared to the cases in scenario a this is because a higher local flow velocity generated a higher shear stresses which enhanced the detachment of the attached biomass fig 4 3 3 biomass accumulation and hydraulic heterogeneity the different biomass distributions with and without considering the shearing effect resulted in different temporal evolution of hydraulic conductivity in fig 5 the porous media was sectioned in x direction x 0 05 m 0 25 m 0 5 m 0 75 m 1 m and 1 25 m to calculate the local hydraulic conductivity within each section the calculated hydraulic conductivity was log scaled and used to estimate their log standard deviation σ lgk for each cross section in general a larger σ lgk indicates higher local heterogeneity fogg 1986 freeze 1975 hoeksema and kitanidis 1985 fig 5 showed that in scenario a the calculated σ lgk gradually decreased with time in each cross section indicating that the local heterogeneity of hydraulic conductivity decreased as biomass accumulated because biomass gradually filled in high permeable domains with time fig 3 in scenario b however the σ lgk only decreased with time under a condition of low flow velocity because the shear stresses are negligible when flow velocity was low under high velocity conditions σ lgk slightly increased with time indicating that the heterogeneity of local hydraulic conductivity increased because biomass mainly accumulated in relatively low flow velocity regions leading to an increase in spatial disparity of local hydraulic conductivity 3 4 macroscopic correlation between porosity and hydraulic conductivity in the simulations as described above eqs 5 and 6 were used to estimate local hydraulic conductivity as a function of local porosity that was influenced by biomass accumulation to evaluate whether such a relationship used to describe the domain scale change of hydraulic conductivity as a function of domain scale porosity the domain averaged relative porosity ε r and relative hydraulic conductivity k r were calculated from local porosity and hydraulic conductivity 21 ε r ε ε 0 22 k r k ε k 0 23 k ε f ρ g l δ p where ε is the domain averaged porosity k ε is the domain averaged hydraulic conductivity l m is the length of the domain δ p pa is the hydraulic pressure difference between right side and left side boundaries ε 0 and k 0 m s are the averaged initial porosity and hydraulic conductivity in the domain respectively and all other parameters were defined before in both scenarios a and b the domain averaged relative porosity and relative hydraulic conductivity were lower than the initial values as biomass accumulation decreased the overall porosity and hydraulic conductivity in the domain fig 6 however in scenario b the domain averaged relative porosity and relative hydraulic conductivity first decreased and then decreased with increasing average flow rate this is because the biomass accumulation was mainly controlled by the substrate transport and shearing induced biomass detachment was less important under low flow condition when flow velocity is fast the removal of biomass by the shearing force led to rebounding of the relative porosity and hydraulic conductivity in the domain the domain averaged k r ε r relationship in both scenarios a and b matched well with the biofilm plug formation model eq 5 under high flow condition fig 7 but increasingly deviated from the model with decreasing flow velocity when the flow velocity was high the local scale heterogeneity of hydraulic conductivity would increase as described before however such an increase occurred relatively homogeneously in the domain and biomass was uniform distributed along the flow direction at the macroscopic scale fig 8 so that the local scale model was valid in linking macroscopic porosity with hydraulic conductivity conversely when the flow velocity was low biomass was unevenly distributed along the flow direction on the macroscopic scale fig 8 and thus the local scale model was not applicable 4 discussion heterogeneous hydraulic conductivity is a common phenomenon in subsurface as the result of biogeochemical reactions in porous media an enhancement of flow heterogeneity has been generally observed bottero et al 2013 dupin and mccarty 2000 ehlinger et al 1987 kildsgaard and engesgaard 2001 murphy et al 1997 rodríguez escales et al 2016 seifert and engesgaard 2007 seki et al 2006 sharp et al 1999 stewart and fogler 2001 and that was hypothetically attributed to the preferential detachment of biomass by shear stresses the result in this study indicated that the effect of shearing induced biomass detachment on hydraulic heterogeneity depended on flow velocity when the flow velocity was low the effect of the shear stresses on biomass detachment was negligible and biomass mainly accumulated in high flow paths with fast substrate supply as a result the local porosity and hydraulic conductivity became more homogeneous conversely when the flow velocity was high the shearing induced detachment prevented biomass accumulation in the areas with high hydraulic conductivity however biomass still accumulated in regions with relatively lower flow velocity and lower shear stresses resulting in an increase of local porosity and hydraulic conductivity heterogeneity reactive transport models are often used to study bioclogging process in natural and remedial environments as a result of biomass growth and accumulation berlin et al 2015 caruso et al 2017 newcomer et al 2016 2018 samso et al 2016 xian et al 2019 although the maximum flow velocity reported in these studies is consistent with the flow conditions considered in this study the effect of biomass detachment induced by shearing was typically not considered our results suggested that it s necessary to take the shearing induced biomass detachment into account in simulations of bioclogging especially when it is during high flow events this is important for simulating biogeochemical processes in contaminated subsurface environment that involves preferred flow paths where the maximum flow velocity may even be higher than the flow velocity used in this study constantz 2008 mosley 1982 vogt et al 2010 the key to study bioclogging is to establish an appropriate model to link macroscopic hydraulic conductivity changes with the porosity changes a number of correlation models have been developed based on experimental results cunningham et al 1991 karrabi et al 2011 seifert and engesgaard 2012 taylor and jaffé 1990 vandevivere and baveye 1992a these models considered the effects of various factors including the properties of sediment particles and microorganisms such as grain size shape arrangement as well as mineralogical composition this study showed that the flow velocity was an important factor that may significantly affect the application of the correlations in large scale systems when flow velocity was high sufficient substrate supplies allow the biomass to be uniformly distributed across the domain the local scale model well matched with the domain averaged correlations between hydraulic conductivity and porosity fig 7 conversely when the flow velocity was low biomass primarily accumulated near the inlet region leading to large difference in porosity and hydraulic conductivity between inlet and outlet sides fig 8 the local scale correlation models were apparently not applicable to such scenarios at the macroscopic scale on the one hand when the shearing induced biomass detachment was taken into account the bioclogging at the inlet side was avoided due to shearing induced removal of biomass fig 3 and the domain averaged correlations would better match the local scale correlation models in addition to the flow velocity the temporal fluctuation of flow condition ning et al 2020 temperature kadlec and reddy 2001 zheng and cardenas 2018 and inlet substrate concentrations liu et al 2019 can also influence biomass growth or detachment behaviors process level models and or model parameters are often not available currently that allow to simultaneously integrates the effects of the factors above and thus were not considered in this study coupled experimental and numerical studies are therefore needed to fully assess the biomass growth and detachment behaviors 5 conclusions the results indicated that the effect of shearing induced biomass detachment depended on overall and local flow velocities when overall flow velocity was low the effect of shearing induced biomass detachment can be ignored however under such scenarios biomass would primarily accumulate in the areas with high local flow velocity near the inlet regions leading to a high potential of bioclogging that affected subsequent flow and solute transport and biogeochemical reactions in the downstream on the contrary when overall flow velocity was high biomass accumulation in high flow velocity paths was minimized by the shear stresses of the fluid flow preventing bioclogging the results implied that in subsurface environments with variable flow velocities such as in hyporheic zones biomass may accumulate in preferential flow paths when flow velocity is low and may be removed when flow velocity is high resulting in a dynamic change in biomass accumulation and removal this study also showed the local and overall heterogeneity of porosity and hydraulic conductivity changed as result of biomass accumulation when flow velocity was low local porosity and hydraulic conductivity became more homogeneous in the inlet regions as biomass accumulated in the fast flow paths but less changed in the outlet side this generated a large discrepancy of porosity and hydraulic conductivity between inlet and outlet sides leading to the failure of the local scale relationship between hydraulic conductivity and porosity such as the biofilm plug formation model eq 5 in this work to describe the domain averaged hydraulic conductivity as a function of domain averaged porosity on the other hand when flow velocity was high the biomass was primarily accumulated in flow paths with relatively lower flow velocity that did not have a strong shear stress this would preserve preferential flow paths and decrease hydraulic conductivity in other regions resulting in an increase in the local heterogeneity of hydraulic conductivity however under such scenarios the flow was not clogged at the domain scale and thus biomass can accumulate in the entire domain resulting in relatively homogeneous distribution of biomass at the domain scale and the applicability of the macroscopic relationship between hydraulic conductivity and porosity despite the increase of heterogeneity in local porosity and heterogeneity declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national key research and development project china 2019yfc1803900 and national natural science foundation of china grant no 41830861 41907166 additional support was from the project no 2017zt07z479 the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2021 126083 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
