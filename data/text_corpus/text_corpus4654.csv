index,text
23270,a method based on spectrum analysis is proposed for predicting fatigue crack propagation fcp of a crack in marine structures the stress intensity factors sif for a crack can be different under different load cases such as loading conditions heading angles and wave frequencies even at the same level of nominal or hotspot stress therefore the load spectrum obtained from the stress transfer function and wave spectrum may be failing to calculate the fcp accurately in current study sif transfer functions were evaluated through detailed structural analysis for different crack sizes and the short term sif distribution obtained from the sif transfer function fcp life could then be calculated from numerous short term sif distribution and the improved paris formula a sub model technique was integrated facilitating sif re analysis due to crack growth and an improved euler method was adopted to reduce the computational steps fcp of a semi elliptical surface crack at the weld toe between hatch coaming and forward bulkhead of a container ship superstructure was used to demonstrate the application of the proposed spectral method this paper offers a way of combining the spectral analysis and fracture mechanics in fatigue crack growth calculation for marine structures keywords fatigue crack propagation marine structure spectrum analysis short term distribution stress intensity factor improved euler method nomenclature ω angular frequency rad s θ heading angles u ship forward speed used in seakeeping analysis and spectral analysis equal to 2 3 times design speed hs significant wave height t z wave period h s i f ω θ sif transfer function s ω h s t z wave energy spectrum s s i f ω θ h s t z sif energy spectrum λ n n th order sif energy spectral moment k sif amplitude induced by waves δ k sif range induced by waves δ k n nominal sif range induced by waves k s t a t i c sif induced by still water bending moment δ k e f f effective sif range k e q equivalent sif of mixed fracture modes k m a x k m i n maximum and minimum sif value k r e s sif induced by residual stress ς k probability density function of sif amplitude induced by waves ς δ k δ k n probability density function of nominal sif range induced by waves σ x rayleigh distribution scale parameter f average zero up crossing frequency λ 0 λ 2 zeroth second order sif energy spectral moment d a d n fatigue crack propagation rate c m coefficient and exponent in crack growth relationship β β 1 exponential parameters in huang s model r stress ratio m r correction factor for the effect of stress ratio δ k t h threshold of sif range corresponding to stress ratio r 0 δ k t h value of δ k when m r δ k δ k t h d a i crack increment in a sea state i e expected value δ n i the number of load cycles in sea state i a c depth and half length of the semi elliptical crack a 0 c 0 the initial crack size δ a t o l accuracy controlling parameter a f critical crack depth subscripts i sea state i i ii iii opening sliding and tearing fracture mode a c deepest point surface ends point of a semi elliptical crack 1 introduction ships and marine structures are subjected to fluctuating loading at sea which could lead to inducing fatigue crack growth generally ships are designed with a fatigue life of 25 years using conventional high cycle fatigue principles i e the s n method det norsk veritas 2010 however large uncertainties are often disregarded in ship structural fatigue analysis such as real wave environments corrosion weld defects etc cui 2003 fricke et al 2002 these factors contribute to fatigue cracks being initiated much earlier than expected in many vessels which challenge ship safety and reliability the high expenses of repairs and lost time mean that it is not practical or possible to repair every minor to moderate crack at once mao 2014 hence forecasting fatigue crack growth and identifying specific cracks that are critical to structural integrity are important issues okawa et al 2007 therefore tools and methods based on fracture mechanics are required to predict fatigue crack propagation fcp lifetime and crack growing path rationally and accurately among s n methods spectral based fatigue analysis provides a more accurate method to consider some factors with a clear and reasonable calculation process american bureau of shipping 2016 however fcp using spectral based methods for marine structures is rarely applied some scholars jang et al 2010 mao 2014 yan et al 2016a 2016b have derived the load spectrum consisting of stress ranges from the stress transfer function and wave spectrum with the stress intensity factor sif then calculated by empirical formula or a finite element model fem to simulate the fcp this is referred to as the stress spectral method unfortunately there are two drawbacks when using load spectra obtained from stress transfer functions in fcp 1 it is not easy to find the relationship between the sif and the stress when the crack in the complex stress field one needs to choose the appropriate stress normally the maximum stress on the top surfaces and then calculates the sifs by empirical formula or fea however many critical spots of marine structure are in complex stress states and may subject to tension bending shear and non uniform distributed boundary stresses synchronously thus it can be difficult to determine how sif can be calculated accurately from stress for the actual structure 2 the boundary conditions of actual structures are very complicated and a single stress value cannot represent the true loading conditions that is the sif for a crack can be different under different load cases such as loading conditions and heading angles etc even for the same value of nominal or hotspot stress thus it may be difficult to determine a harmonious relationship between stress and sif for a crack in complex structural detail this study proposes an approach to predict fatigue crack propagation incorporating spectral analysis section 2 presents a method to generate short term sif distributions for real structural details combining the short term sif distributions and improved paris formula to calculate fcp directly is described in section 3 validation for the proposed spectral methods are demonstrated using a semi elliptical surface crack in a rectangular plate and a semi elliptical surface crack at the weld joint toe of a detail between hatch coaming and superstructure of a container ship in section 4 and section 5 2 spectral analysis for marine structures linear elastic fracture mechanics lefm is often used to predict fcp stephens et al 2000 the empirical paris law has become a widely recognized approach to estimate the fcp based on the sif range rather than stress and fcp can be obtained directly if the short term sif distribution can be derived generally fatigue analysis of marine structures involves the local structure fracture mechanics sub model is employed to simulate fcp of actual structures and the displacement boundary conditions of the sub model should be obtained from the global structural response analysis fig 1 presents a brief description of the proposed spectral based fcp the pre processor mainly contains global hydrodynamic and structural response analysis and extract displacement boundary conditions for sub model analysis then according to the encounter waves and load state continuously apply the corresponding boundary conditions to the fracture sub model calculate the sifs of cracks with different sizes crack propagation can be simulated through update the sub model step by step 2 1 global structural response fatigue damage in ships is mainly caused by wave loads acting on ship structures for more reliable fatigue assessment a direct calculation method is often used to evaluate the wave loads under different sailing conditions and loadings american bureau of shipping 2016 the wave loads can be computed by hydrodynamic software and structural analysis provides the structural stress strain response by either simple hull girder theory or fem in general the response is calculated by linear analysis in the frequency domain as described by lewis 1988 2 2 stress intensity factor transfer functions after the global structural stress analysis dangerous regions with cracks are selected as the critical regions or hot spots to balance the demands of computational efficiency and precision element types of the whole ship fe model are mainly two dimensional shell element and one dimensional beam element and the element size is usually very coarse to calculate sifs for three dimensional 3d surface cracks it is necessary to refine the shell elements in the vicinity of the hot spot create solid elements with surface cracks and build multi point constraints mpcs ansys 2013 between the shell and solid elements fig 2 is an example of a sub model in a ship structure boundary displacements obtained from the global structural analysis and all relevant local loads should be applied to the sub models the sif of the crack is then calculated using fem the sub model regions should be large enough to consider the load shedding induced by cracks growth and structural redundancy okawa et al 2007 it needs to rebuild the sub fracture model when the crack size is large enough and increasing the area of submodel until the sif value gradually converging fea has been widely used in sif calculation of a 3 d crack in structural detail newman and raju 1981 evaluated the sif of a semi elliptical surface crack in a rectangular plate under uniform tensile and bending load bowness and lee 1996 2000 numerically calculated the sifs of surface cracks in weld toe of t joints and proposed corresponding empirical formulations some scholars bowness and lee 1995 chiew et al 2001 lee et al 2005 proposed methods to model 3 d doubly curved semi elliptical crack at weld toe in tubular joints some specialized software such as franc3d zencrack feacrack etc provide non planar crack growth prediction via automated adaptive meshing techniques dolbow and belytschko 1999 fries and belytschko 2010 proposed a finite element method for crack growth without remeshing i e extended finite element method xfem these studies have greatly facilitated sif calculation and simulation of fcp the current study mainly focuses on a spectral method and how to model a fracture fe model is not the focus of this article the authors take semi elliptical surface cracks at butt weld toe as an example to illustrate the proposed spectral method referring to bsi 2013 where the flaws often treated as an equivalent elliptical crack two parameters were used to describe propagation of the surface crack the crack depth a and the crack half length c the current study followed common practice branco et al 2015 singular element dedicated to sif calculation collapsed from a 20 nodes hexahedral element and solid95 element 20 nodes hexahedral element was adopted when creating the solid model using commercial software ansys 2013 shown in fig 2 the radius of the first ring element at the crack tip r 0 0375a when a 15 mm to ensure accurate results this method has been validated by our research group yan et al 2016a 2016b in the linear spectral analysis global structural analysis is performed for a series of unit amplitude harmonic waves ω and various heading angles θ the sif transfer function h s i f ω θ is then obtained for a given crack size 2 3 spectral analysis generally the relationship between wave loads and induced stress is linear in spectral based fatigue for a given crack size there is also a linear relationship between sif and stress in lefm i e there is a linear relationship between sif and wave loads which is a precondition for applying spectral analysis for the fatigue assessment of ships the response under real wave environments is often divided into a series of stationary process known as sea states a sea state can be described by the classic wave energy spectrum s ω h s t z for example pierson moskowitz p m or jonswap lewis 1988 which can be expressed as a function of significant wave height h s and wave period t z thus for a given crack size the sif energy spectrum under arbitrary sea states can be computed by 1 s s i f ω θ h s t z h s i f ω θ 2 s ω h s t z where s ω h s t z is the wave energy spectrum the nth order sif energy spectral moment at the ship forward speed u is similar to the stress spectral moment american bureau of shipping 2016 and can be expressed as 2 λ n 0 ω ω 2 u c o s θ g n s s i f ω θ h s t z d ω this study used a wave scatter diagram to describe the expected sea states encountered the north atlantic scatter diagram was selected and a sea state was assumed to last two hours and to be described by the p m spectrum suppose that each short sea condition lasts two hours and determine the number of cycles in two hours based on the average zero crossing rate generate load block for each short sea condition which consists of a number of random stress ranges that following the rayleigh distribution determine the probability of occurrence for each load block based on the wave scatter diagram the total number of cycles is determined by the average zero crossing rate various short sea conditions appear randomly in accordance with a certain probability constitute the long term fatigue load spectrum 2 4 short term stress intensity factor distribution in a stationary sea state it is generally assumed that the waves are zero mean narrow banded random gaussian process american bureau of shipping 2016 thus for linear systems fluctuating stress sif induced by wave loads are also a zero mean narrow banded gaussian process according to the theory of random process sif amplitude induced by waves k will follow the rayleigh distribution the corresponding probability density function is 3 ς k k σ x 2 e x p k 2 2 σ x 2 theoretically compression force does not have sif values in the fatigue crack growth model we employed equivalent sif to consider the effect of the mean stress and the residual stress is considered as part of the mean stress the sif range δ k equals to two times of sif amplitude and coresponding probability density function can be expressed as 4 ς δ k δ k δ k n 4 σ x 2 e x p δ k 2 8 σ x 2 where σ x and the average zero up crossing frequency f can be expressed as 5 σ x λ 0 a n d 1 2 π λ 2 λ 0 where λ 0 and λ 2 are the zeroth and second order moment of the sif response spectrum 3 fatigue crack propagation calculation 3 1 fatigue crack growth rate model kujawski et al 2001 2004 proposed a two parameter driving force model to account for r ratio the crack growth rate is expressed as 6 d a d n c δ k m 7 δ k k m a x α δ k 1 α m δ k where α is the correlation parameter and δ k δ k for r 0 and δ k k m a x for r 0 this model is based on the premise that for a negative r ratio the negative part of δ k does not contribute to the crack growth however it has been mentioned that the model was better for positive r ratios than for negative ones from the comparison with the experimental data huang and moan 2007 noroozi et al 2007 huang and moan 2007 2009 further studied the effect of r ratio from an extensive analysis using experimental data from the literature and proposed an improved fcp rate model in the current study huang s model was selected in the spectral fcp the basic expression is 8 d a d n c δ k e m δ k t h m 9 δ k e m r δ k and 10 m r 1 r β 1 5 r 0 1 r β 0 r 0 5 1 05 1 4 r 0 6 r 2 β 0 5 r 1 11 r k m i n k r e s k m a x k r e s 0 5 δ k n k s t a t i c k r e s 0 5 δ k n k s t a t i c k r e s where n is the number of cycles δ k e is the equivalent sif range c and m are the paris parameters corresponding to stress ratio r 0 δ k t h is the threshold of sif range corresponding to stress ratio r 0 β and β 1 are shape exponents depending on the material property and environment m r is the correction factor for the effect of stress ratio k m i n is the minimum sif k m a x is the maximum sif k r e s is the sif induced by residual stress and k s t a t i c is the sif induced by static load since huang model is valid for r 5 k s t a t i c and k r e s are set to zero for safety consideration when mean stress induced by still water bending σ s t a t i c and residual stress are negative in this study owing to absence of specified material parameters the paris law parameters for steel recommended by international institute of welding iiw 2016 were adopted as c 1 65 10 11 m 3 and δ k t h 5 4 mpa m for da dn in m cycle and δ k in mpa m for demonstration the exponential parameters of steel in huang s model were chosen as β 0 5 β 1 0 8 huang and moan 2007 3 2 closed form expression for fatigue crack propagation during one sea state in general fcp under the one sea state is vanishingly small and thousands of sea states may be needed for a small crack to grow to a given length e g 1 mm therefore during the ith sea state the sif transfer function can be treated as constant thus the sif range probability density function is also constant in a sea state since the sif range x is a random variable the crack growth rate d a d n x is a function of random variables the expected crack increment e d a i can be expressed as 12 e d a i c δ n i 0 d a d n x ς i δ k x d x with 13 δ n i δ t i f i δ t i 2 π λ 2 i λ 0 i where δ n i is the number of load cycles in sea state i δ t i is the duration time in one sea state f i is the average zero crossing frequency substituting equations 13 and 8 into 12 the expected crack increments in a sea state can be expressed as 14 e d a i c δ t i 2 π λ 2 i λ 0 i δ k t h x m m r x m ς i δ k x d x δ k t h m δ k t h ς i δ k x d x where δ k t h is the value of δ k n when m r δ k n δ k t h since x m r x is strictly monotonic increasing there must exists a unique x that meets x m r x δ k t h the unique value x namely is δ k t h it allows to compute e d a i easily through equation 14 using numeral integral 3 3 crack growth within a computational step if the fem mesh and ς δ k δ k are updated for every stationary sea state although the result would be more accurate too much time would be required to perform the fcp simulation therefore the forward euler method has been widely used in fcp simulation he et al 2014 mao 2014 sumi et al 2005 when the crack increment is δ a t o l e g 1 mm the fem mesh is not updated to save calculation time unfortunately there is a major drawback associated with the forward euler method in that it requires choosing a small step size to maintain stability and accuracy of the solution thus an improved euler method is presented in the current study the main procedure is shown in fig 3 4 validation of the proposed spectral based method the crack growth analysis of a semi elliptical surface crack in a structural detail was performed by using the proposed procedure to check the accuracy of the proposed spectral method it was assumed that the structural detail had the same stress state i e uniform tension as shown in fig 4 thus there was a consistent relationship between stress and sif a widely recognized empirical formula proposed by newman and raju 1981 was used calculate sif we also computed it numerically using ansys which could be used for more complex structural details the flat plate size is 600 300 65 mm with initial crack size a 0 5 mm c 0 20 mm and critical crack depth a f 42 mm there is no residual mean stress in the structure and only head waves were encountered fig 5 shows the nominal stress transfer functions first the short term distributions of stress ranges were obtained from the stress transfer function in combination with the wave scatter diagram fcp life was then calculated based on empirical sif formula and fcp model discussed in section 3 1 using the cycle by cycle cbc counting method cui et al 2011 a time consuming but accurate method to calculate fcp alternatively the sif transfer function was derived from ansys and we also calculated it using the newman raju empirical formula fig 6 shows that the results are in close agreement the short term δ k distributions were obtained following sections 2 3 and 2 4 then fcp life was calculated following section 3 calculation accuracy may differ due to the different crack growth calculation steps δ a t o l and the crack growth curves for different step sizes and stress spectral method using cbc are shown in fig 7 the fcp life obtained from sif spectral method closely agrees with stress spectral method when the stress state loading mode of critical spot are the same or similar among different load cases the euler and improved euler methods both provide good precision with small step size however the improved euler method shows better consistency with the cbc when the step size was set to 1 2 mm sufficient accuracy could be obtained through the improved euler method 5 example application of the proposed method to a container ship detail to demonstrate the proposed spectral methods a joint between the hatch coaming and front bulkhead of superstructure in a large container ship was selected as a real structure example fig 8 shows the sketch of hot spot location fig 9 shows the detail structural geometry of the hot spot the hatch coaming plate and bulkhead plate were welded together and the fillet weld was assumed to have a throat thickness of 10 mm and the weld toe radius ρ 1 mm the hatch coaming was constructed from e40 steel with yield stress σ y 390 mpa and a semi elliptical surface crack at the weld toe found in an inspection with initial crack size a 0 2 mm c 0 8 mm the proposed spectral based fcp method was used to compute the sailing hours until the crack depth grows to a f 0 6 t for safety consideration yan et al 2016a 2016b for a flaw lying in a plane parallel to the welding direction residual stress σ r e s should be considered referring to bsi 2013 residual stress was assumed to be 20 of σ y in the structures subject to post weld heat treated then k r e s could be calculated through weight function method wu and carlsson 1991 the mean stress induced by still water bending σ s t a t i c approximately equal to 39 mpa tensile stress for the full load case 5 1 global structural stress response hydrodynamic software walcs developed by the china classification society 2013 was used to compute the wave loads on the target marine structure based on 3d frequency domain linear hydrodynamics principles parameters for the hydrodynamic analysis were wave frequency 0 1 1 8 rad s step 0 1 rad s 18 frequencies ship speed u 2 3 times design speed the design speed is 25 knots heading angle 0 180 step 30 7 directions given the symmetry of the ship hull heading angle 180 represents the head sea and a heading angle 0 denotes the following sea only the full load condition was considered in this study for each wave with determined heading angle and frequency unit wave amplitude was used to generate the real and imaginary hydrodynamic wave pressures on the panels after fe analysis the stress and displacement responses of the target structure for different wave frequencies and directions were obtained fig 10 shows the global structure response of the container ship induced by waves load 5 2 sifs for different load cases the structural detail shown in fig 11 was a sub model of the whole ship fem model and it was modeled following procedure described in section 2 2 three types of crack opening modes were considered i e opening mode i sliding mode ii and tearing mode iii owing to the imaginary and real part of wave pressure are loaded separately the sif amplitude becomes k k real 2 k i m a g i n a r y 2 the sif transfer function at different heading angle shown in fig 12 and the data in table 1 and table 2 show that the mode i constitutes the main component of the sif for both surface end point and deepest point more specifically compared with surface end point the effect of mode ii and mode iii is smaller in the deepest point in head and following waves sifs of cracks have smaller share of mode ii than that in oblique and beam waves this can be caused by shearing force induced by the torsion and horizontal bending the equivalent sif bowness and lee 1996 is 15 k e q k i 2 k i i 2 k i i i 2 1 ν where ν is poisson s ratio the average proportions of k i k ii and k iii to k e q in a heading angle are summarized in table 1 and table 2 the share of mode ii and mode iii will be less for larger crack size and more for smaller crack size but for simulate the crack growth direction it can be done by rebuilt the crack increment with an angle determined by an adopted criteria such as the maximum circumferential stress criterion in the submode when the k ii or k iii is big enough this issue will be discussed in the future 5 3 inconsistent relationship between sif and stress in different load cases since the nominal stress is not always possible to define in real structures hot spot stress hss is widely used in the s n curve spectral method the hss is adopted to illustrate the inconsistent relationship and it was generated by the recommended extrapolation approach american bureau of shipping 2016 the hss amplitude is σ h σ real 2 σ i m a g i n a r y 2 fig 13 shows the hss transfer functions of the local structure for a relative large crack size i e a 10 a c 0 3 the k e q is basically equal to k i see table 2 k e q is used to illustrate the inconsistent relationship the equivalent sif value at unit hss can be obtained through sif transfer functions divided by corresponding hss transfer functions as shown in fig 14 it is difficult to define a harmonious relationship between hot spot stress and sif that consider all the load cases more specifically an approximate consistent correspondence can be founded in heading waves and following waves i e 180 and 0 the stress status of the detail is near uniform tension longitudinally as shown in fig 15 while in the oblique waves the ship structure is under horizontal bending and torsion the stress status of local structure mainly is under combined tension and bending as shown in fig 15 the degree of bending dob ahmadi et al 2015 in hatch coaming plate varies with waves frequency as shown in fig 16 and there is a similar trend between figs 14 and 16 it can be the specific reason for the inconsistent relationship the results represent only one structural detail however for other details it is foreseeable that there is an inconsistent relationship between stress and sif if the loading situation of local structure changes considerably among different load case otherwise the relationship would be consistent 5 4 comparison of crack increment in a short sea state for comparison we take the crack increment in a sea state when the crack depth a 10 mm crack aspect ratio a c 0 3 for example since the crack increment in a short sea state is very small both the sif transfer functions in proposed method and the relationship between stress signal and sif in stress spectral method remain constant the significant wave height of the short sea state is 8 m and the wave period is 11 s in the stress spectral method we calculate fcp through cbc method using the simulated stress signal based on the calculated stress spectra the relationship between stress signal and sif i e sif value at unit hss as shown in fig 14 is not consistent in different heading angles and frequencies we chose relationship in a frequency that the hss transfer function is at its maximum to calculate fcp the cbc method was repeated 100 times and the average crack increment was used to eliminate the effect of uncertainty of pseudo random stress signal comparison of crack increment computed by the two methods are presented in table 3 apparently different relationships between stress signal and sif have quite large impact on fcp in cbc method according to fig 14 when using the stress spectral method it could be difficult to determine an exact relationship that take into account of all the heading angles and frequencies while the proposed method would not have the problem it is noticed that the relationships almost are consistent in heading angle 180 and 0 and the corresponding fcp results using cbc and integral are nearly equal it confirms that sif spectral method closely agrees with stress spectral method when the loading mode of critical spot are the same or similar among different heading angles and frequencies 5 5 fatigue crack propagation following the improved euler method in section 3 the fcp of the structural detail was simulated step by step with step size δ a t o l 1 mm a program code was developed to update the fem mesh automatically and calculate the fatigue life the probability of heading angle is assumed to follow a uniform distribution fig 17 shows the fcp curves using k e q and k i the expected fatigue life is 35244 h approximately 35244 365 24 4 02 years and 37418 sailing hours respectively for simulating fcp by fea additional calculation of k ii and k iii almost does not increase the computational cost and neglecting the influence of k ii and k iii would lead to no conservative results therefore k e q is recommended in the present demo fig 18 shows shape changes of the surface crack using k e q since the sifs were evaluated according to the actual boundary conditions this method automatically considers the impact of stress distribution through the plate thickness 6 conclusions a compatible relationship may not exist between sif and nominal or hotspot stress for a specific crack size at different loading conditions heading angles and wave frequencies therefore a method to calculate the fcp from multiple short term sif distributions which derived from the sif transfer functions and wave spectrum has been proposed some conclusions can be drawn the proposed method needs to calculate the sif transfer function for crack at different sizes which requires too much computation cost for reanalysis and updating the fem model therefore an improved euler method was proposed to reduce the computation steps and improve precision a case study of a real structural detail with an initial semi elliptical surface crack was used to demonstrate the application of the proposed procedure the results showed that the expected service time for the ship was approximately 4 years sailing before the crack depth reached 0 6 t the proposed spectral based method which uses short term sif distribution instead of short term stress distribution to predict the fcp of a detail under random fatigue loading is a new trial and still in its early stage compared with the stress spectral method sif spectral method is still complicated in computation of sifs further work should be focused on overcoming this drawback and developing a much faster and easier use of numerical computation method acknowledgement this study was supported by the state key program of national natural science of china grant no 51439004 and the national key basic research special foundation of china 2013cb036105 
23270,a method based on spectrum analysis is proposed for predicting fatigue crack propagation fcp of a crack in marine structures the stress intensity factors sif for a crack can be different under different load cases such as loading conditions heading angles and wave frequencies even at the same level of nominal or hotspot stress therefore the load spectrum obtained from the stress transfer function and wave spectrum may be failing to calculate the fcp accurately in current study sif transfer functions were evaluated through detailed structural analysis for different crack sizes and the short term sif distribution obtained from the sif transfer function fcp life could then be calculated from numerous short term sif distribution and the improved paris formula a sub model technique was integrated facilitating sif re analysis due to crack growth and an improved euler method was adopted to reduce the computational steps fcp of a semi elliptical surface crack at the weld toe between hatch coaming and forward bulkhead of a container ship superstructure was used to demonstrate the application of the proposed spectral method this paper offers a way of combining the spectral analysis and fracture mechanics in fatigue crack growth calculation for marine structures keywords fatigue crack propagation marine structure spectrum analysis short term distribution stress intensity factor improved euler method nomenclature ω angular frequency rad s θ heading angles u ship forward speed used in seakeeping analysis and spectral analysis equal to 2 3 times design speed hs significant wave height t z wave period h s i f ω θ sif transfer function s ω h s t z wave energy spectrum s s i f ω θ h s t z sif energy spectrum λ n n th order sif energy spectral moment k sif amplitude induced by waves δ k sif range induced by waves δ k n nominal sif range induced by waves k s t a t i c sif induced by still water bending moment δ k e f f effective sif range k e q equivalent sif of mixed fracture modes k m a x k m i n maximum and minimum sif value k r e s sif induced by residual stress ς k probability density function of sif amplitude induced by waves ς δ k δ k n probability density function of nominal sif range induced by waves σ x rayleigh distribution scale parameter f average zero up crossing frequency λ 0 λ 2 zeroth second order sif energy spectral moment d a d n fatigue crack propagation rate c m coefficient and exponent in crack growth relationship β β 1 exponential parameters in huang s model r stress ratio m r correction factor for the effect of stress ratio δ k t h threshold of sif range corresponding to stress ratio r 0 δ k t h value of δ k when m r δ k δ k t h d a i crack increment in a sea state i e expected value δ n i the number of load cycles in sea state i a c depth and half length of the semi elliptical crack a 0 c 0 the initial crack size δ a t o l accuracy controlling parameter a f critical crack depth subscripts i sea state i i ii iii opening sliding and tearing fracture mode a c deepest point surface ends point of a semi elliptical crack 1 introduction ships and marine structures are subjected to fluctuating loading at sea which could lead to inducing fatigue crack growth generally ships are designed with a fatigue life of 25 years using conventional high cycle fatigue principles i e the s n method det norsk veritas 2010 however large uncertainties are often disregarded in ship structural fatigue analysis such as real wave environments corrosion weld defects etc cui 2003 fricke et al 2002 these factors contribute to fatigue cracks being initiated much earlier than expected in many vessels which challenge ship safety and reliability the high expenses of repairs and lost time mean that it is not practical or possible to repair every minor to moderate crack at once mao 2014 hence forecasting fatigue crack growth and identifying specific cracks that are critical to structural integrity are important issues okawa et al 2007 therefore tools and methods based on fracture mechanics are required to predict fatigue crack propagation fcp lifetime and crack growing path rationally and accurately among s n methods spectral based fatigue analysis provides a more accurate method to consider some factors with a clear and reasonable calculation process american bureau of shipping 2016 however fcp using spectral based methods for marine structures is rarely applied some scholars jang et al 2010 mao 2014 yan et al 2016a 2016b have derived the load spectrum consisting of stress ranges from the stress transfer function and wave spectrum with the stress intensity factor sif then calculated by empirical formula or a finite element model fem to simulate the fcp this is referred to as the stress spectral method unfortunately there are two drawbacks when using load spectra obtained from stress transfer functions in fcp 1 it is not easy to find the relationship between the sif and the stress when the crack in the complex stress field one needs to choose the appropriate stress normally the maximum stress on the top surfaces and then calculates the sifs by empirical formula or fea however many critical spots of marine structure are in complex stress states and may subject to tension bending shear and non uniform distributed boundary stresses synchronously thus it can be difficult to determine how sif can be calculated accurately from stress for the actual structure 2 the boundary conditions of actual structures are very complicated and a single stress value cannot represent the true loading conditions that is the sif for a crack can be different under different load cases such as loading conditions and heading angles etc even for the same value of nominal or hotspot stress thus it may be difficult to determine a harmonious relationship between stress and sif for a crack in complex structural detail this study proposes an approach to predict fatigue crack propagation incorporating spectral analysis section 2 presents a method to generate short term sif distributions for real structural details combining the short term sif distributions and improved paris formula to calculate fcp directly is described in section 3 validation for the proposed spectral methods are demonstrated using a semi elliptical surface crack in a rectangular plate and a semi elliptical surface crack at the weld joint toe of a detail between hatch coaming and superstructure of a container ship in section 4 and section 5 2 spectral analysis for marine structures linear elastic fracture mechanics lefm is often used to predict fcp stephens et al 2000 the empirical paris law has become a widely recognized approach to estimate the fcp based on the sif range rather than stress and fcp can be obtained directly if the short term sif distribution can be derived generally fatigue analysis of marine structures involves the local structure fracture mechanics sub model is employed to simulate fcp of actual structures and the displacement boundary conditions of the sub model should be obtained from the global structural response analysis fig 1 presents a brief description of the proposed spectral based fcp the pre processor mainly contains global hydrodynamic and structural response analysis and extract displacement boundary conditions for sub model analysis then according to the encounter waves and load state continuously apply the corresponding boundary conditions to the fracture sub model calculate the sifs of cracks with different sizes crack propagation can be simulated through update the sub model step by step 2 1 global structural response fatigue damage in ships is mainly caused by wave loads acting on ship structures for more reliable fatigue assessment a direct calculation method is often used to evaluate the wave loads under different sailing conditions and loadings american bureau of shipping 2016 the wave loads can be computed by hydrodynamic software and structural analysis provides the structural stress strain response by either simple hull girder theory or fem in general the response is calculated by linear analysis in the frequency domain as described by lewis 1988 2 2 stress intensity factor transfer functions after the global structural stress analysis dangerous regions with cracks are selected as the critical regions or hot spots to balance the demands of computational efficiency and precision element types of the whole ship fe model are mainly two dimensional shell element and one dimensional beam element and the element size is usually very coarse to calculate sifs for three dimensional 3d surface cracks it is necessary to refine the shell elements in the vicinity of the hot spot create solid elements with surface cracks and build multi point constraints mpcs ansys 2013 between the shell and solid elements fig 2 is an example of a sub model in a ship structure boundary displacements obtained from the global structural analysis and all relevant local loads should be applied to the sub models the sif of the crack is then calculated using fem the sub model regions should be large enough to consider the load shedding induced by cracks growth and structural redundancy okawa et al 2007 it needs to rebuild the sub fracture model when the crack size is large enough and increasing the area of submodel until the sif value gradually converging fea has been widely used in sif calculation of a 3 d crack in structural detail newman and raju 1981 evaluated the sif of a semi elliptical surface crack in a rectangular plate under uniform tensile and bending load bowness and lee 1996 2000 numerically calculated the sifs of surface cracks in weld toe of t joints and proposed corresponding empirical formulations some scholars bowness and lee 1995 chiew et al 2001 lee et al 2005 proposed methods to model 3 d doubly curved semi elliptical crack at weld toe in tubular joints some specialized software such as franc3d zencrack feacrack etc provide non planar crack growth prediction via automated adaptive meshing techniques dolbow and belytschko 1999 fries and belytschko 2010 proposed a finite element method for crack growth without remeshing i e extended finite element method xfem these studies have greatly facilitated sif calculation and simulation of fcp the current study mainly focuses on a spectral method and how to model a fracture fe model is not the focus of this article the authors take semi elliptical surface cracks at butt weld toe as an example to illustrate the proposed spectral method referring to bsi 2013 where the flaws often treated as an equivalent elliptical crack two parameters were used to describe propagation of the surface crack the crack depth a and the crack half length c the current study followed common practice branco et al 2015 singular element dedicated to sif calculation collapsed from a 20 nodes hexahedral element and solid95 element 20 nodes hexahedral element was adopted when creating the solid model using commercial software ansys 2013 shown in fig 2 the radius of the first ring element at the crack tip r 0 0375a when a 15 mm to ensure accurate results this method has been validated by our research group yan et al 2016a 2016b in the linear spectral analysis global structural analysis is performed for a series of unit amplitude harmonic waves ω and various heading angles θ the sif transfer function h s i f ω θ is then obtained for a given crack size 2 3 spectral analysis generally the relationship between wave loads and induced stress is linear in spectral based fatigue for a given crack size there is also a linear relationship between sif and stress in lefm i e there is a linear relationship between sif and wave loads which is a precondition for applying spectral analysis for the fatigue assessment of ships the response under real wave environments is often divided into a series of stationary process known as sea states a sea state can be described by the classic wave energy spectrum s ω h s t z for example pierson moskowitz p m or jonswap lewis 1988 which can be expressed as a function of significant wave height h s and wave period t z thus for a given crack size the sif energy spectrum under arbitrary sea states can be computed by 1 s s i f ω θ h s t z h s i f ω θ 2 s ω h s t z where s ω h s t z is the wave energy spectrum the nth order sif energy spectral moment at the ship forward speed u is similar to the stress spectral moment american bureau of shipping 2016 and can be expressed as 2 λ n 0 ω ω 2 u c o s θ g n s s i f ω θ h s t z d ω this study used a wave scatter diagram to describe the expected sea states encountered the north atlantic scatter diagram was selected and a sea state was assumed to last two hours and to be described by the p m spectrum suppose that each short sea condition lasts two hours and determine the number of cycles in two hours based on the average zero crossing rate generate load block for each short sea condition which consists of a number of random stress ranges that following the rayleigh distribution determine the probability of occurrence for each load block based on the wave scatter diagram the total number of cycles is determined by the average zero crossing rate various short sea conditions appear randomly in accordance with a certain probability constitute the long term fatigue load spectrum 2 4 short term stress intensity factor distribution in a stationary sea state it is generally assumed that the waves are zero mean narrow banded random gaussian process american bureau of shipping 2016 thus for linear systems fluctuating stress sif induced by wave loads are also a zero mean narrow banded gaussian process according to the theory of random process sif amplitude induced by waves k will follow the rayleigh distribution the corresponding probability density function is 3 ς k k σ x 2 e x p k 2 2 σ x 2 theoretically compression force does not have sif values in the fatigue crack growth model we employed equivalent sif to consider the effect of the mean stress and the residual stress is considered as part of the mean stress the sif range δ k equals to two times of sif amplitude and coresponding probability density function can be expressed as 4 ς δ k δ k δ k n 4 σ x 2 e x p δ k 2 8 σ x 2 where σ x and the average zero up crossing frequency f can be expressed as 5 σ x λ 0 a n d 1 2 π λ 2 λ 0 where λ 0 and λ 2 are the zeroth and second order moment of the sif response spectrum 3 fatigue crack propagation calculation 3 1 fatigue crack growth rate model kujawski et al 2001 2004 proposed a two parameter driving force model to account for r ratio the crack growth rate is expressed as 6 d a d n c δ k m 7 δ k k m a x α δ k 1 α m δ k where α is the correlation parameter and δ k δ k for r 0 and δ k k m a x for r 0 this model is based on the premise that for a negative r ratio the negative part of δ k does not contribute to the crack growth however it has been mentioned that the model was better for positive r ratios than for negative ones from the comparison with the experimental data huang and moan 2007 noroozi et al 2007 huang and moan 2007 2009 further studied the effect of r ratio from an extensive analysis using experimental data from the literature and proposed an improved fcp rate model in the current study huang s model was selected in the spectral fcp the basic expression is 8 d a d n c δ k e m δ k t h m 9 δ k e m r δ k and 10 m r 1 r β 1 5 r 0 1 r β 0 r 0 5 1 05 1 4 r 0 6 r 2 β 0 5 r 1 11 r k m i n k r e s k m a x k r e s 0 5 δ k n k s t a t i c k r e s 0 5 δ k n k s t a t i c k r e s where n is the number of cycles δ k e is the equivalent sif range c and m are the paris parameters corresponding to stress ratio r 0 δ k t h is the threshold of sif range corresponding to stress ratio r 0 β and β 1 are shape exponents depending on the material property and environment m r is the correction factor for the effect of stress ratio k m i n is the minimum sif k m a x is the maximum sif k r e s is the sif induced by residual stress and k s t a t i c is the sif induced by static load since huang model is valid for r 5 k s t a t i c and k r e s are set to zero for safety consideration when mean stress induced by still water bending σ s t a t i c and residual stress are negative in this study owing to absence of specified material parameters the paris law parameters for steel recommended by international institute of welding iiw 2016 were adopted as c 1 65 10 11 m 3 and δ k t h 5 4 mpa m for da dn in m cycle and δ k in mpa m for demonstration the exponential parameters of steel in huang s model were chosen as β 0 5 β 1 0 8 huang and moan 2007 3 2 closed form expression for fatigue crack propagation during one sea state in general fcp under the one sea state is vanishingly small and thousands of sea states may be needed for a small crack to grow to a given length e g 1 mm therefore during the ith sea state the sif transfer function can be treated as constant thus the sif range probability density function is also constant in a sea state since the sif range x is a random variable the crack growth rate d a d n x is a function of random variables the expected crack increment e d a i can be expressed as 12 e d a i c δ n i 0 d a d n x ς i δ k x d x with 13 δ n i δ t i f i δ t i 2 π λ 2 i λ 0 i where δ n i is the number of load cycles in sea state i δ t i is the duration time in one sea state f i is the average zero crossing frequency substituting equations 13 and 8 into 12 the expected crack increments in a sea state can be expressed as 14 e d a i c δ t i 2 π λ 2 i λ 0 i δ k t h x m m r x m ς i δ k x d x δ k t h m δ k t h ς i δ k x d x where δ k t h is the value of δ k n when m r δ k n δ k t h since x m r x is strictly monotonic increasing there must exists a unique x that meets x m r x δ k t h the unique value x namely is δ k t h it allows to compute e d a i easily through equation 14 using numeral integral 3 3 crack growth within a computational step if the fem mesh and ς δ k δ k are updated for every stationary sea state although the result would be more accurate too much time would be required to perform the fcp simulation therefore the forward euler method has been widely used in fcp simulation he et al 2014 mao 2014 sumi et al 2005 when the crack increment is δ a t o l e g 1 mm the fem mesh is not updated to save calculation time unfortunately there is a major drawback associated with the forward euler method in that it requires choosing a small step size to maintain stability and accuracy of the solution thus an improved euler method is presented in the current study the main procedure is shown in fig 3 4 validation of the proposed spectral based method the crack growth analysis of a semi elliptical surface crack in a structural detail was performed by using the proposed procedure to check the accuracy of the proposed spectral method it was assumed that the structural detail had the same stress state i e uniform tension as shown in fig 4 thus there was a consistent relationship between stress and sif a widely recognized empirical formula proposed by newman and raju 1981 was used calculate sif we also computed it numerically using ansys which could be used for more complex structural details the flat plate size is 600 300 65 mm with initial crack size a 0 5 mm c 0 20 mm and critical crack depth a f 42 mm there is no residual mean stress in the structure and only head waves were encountered fig 5 shows the nominal stress transfer functions first the short term distributions of stress ranges were obtained from the stress transfer function in combination with the wave scatter diagram fcp life was then calculated based on empirical sif formula and fcp model discussed in section 3 1 using the cycle by cycle cbc counting method cui et al 2011 a time consuming but accurate method to calculate fcp alternatively the sif transfer function was derived from ansys and we also calculated it using the newman raju empirical formula fig 6 shows that the results are in close agreement the short term δ k distributions were obtained following sections 2 3 and 2 4 then fcp life was calculated following section 3 calculation accuracy may differ due to the different crack growth calculation steps δ a t o l and the crack growth curves for different step sizes and stress spectral method using cbc are shown in fig 7 the fcp life obtained from sif spectral method closely agrees with stress spectral method when the stress state loading mode of critical spot are the same or similar among different load cases the euler and improved euler methods both provide good precision with small step size however the improved euler method shows better consistency with the cbc when the step size was set to 1 2 mm sufficient accuracy could be obtained through the improved euler method 5 example application of the proposed method to a container ship detail to demonstrate the proposed spectral methods a joint between the hatch coaming and front bulkhead of superstructure in a large container ship was selected as a real structure example fig 8 shows the sketch of hot spot location fig 9 shows the detail structural geometry of the hot spot the hatch coaming plate and bulkhead plate were welded together and the fillet weld was assumed to have a throat thickness of 10 mm and the weld toe radius ρ 1 mm the hatch coaming was constructed from e40 steel with yield stress σ y 390 mpa and a semi elliptical surface crack at the weld toe found in an inspection with initial crack size a 0 2 mm c 0 8 mm the proposed spectral based fcp method was used to compute the sailing hours until the crack depth grows to a f 0 6 t for safety consideration yan et al 2016a 2016b for a flaw lying in a plane parallel to the welding direction residual stress σ r e s should be considered referring to bsi 2013 residual stress was assumed to be 20 of σ y in the structures subject to post weld heat treated then k r e s could be calculated through weight function method wu and carlsson 1991 the mean stress induced by still water bending σ s t a t i c approximately equal to 39 mpa tensile stress for the full load case 5 1 global structural stress response hydrodynamic software walcs developed by the china classification society 2013 was used to compute the wave loads on the target marine structure based on 3d frequency domain linear hydrodynamics principles parameters for the hydrodynamic analysis were wave frequency 0 1 1 8 rad s step 0 1 rad s 18 frequencies ship speed u 2 3 times design speed the design speed is 25 knots heading angle 0 180 step 30 7 directions given the symmetry of the ship hull heading angle 180 represents the head sea and a heading angle 0 denotes the following sea only the full load condition was considered in this study for each wave with determined heading angle and frequency unit wave amplitude was used to generate the real and imaginary hydrodynamic wave pressures on the panels after fe analysis the stress and displacement responses of the target structure for different wave frequencies and directions were obtained fig 10 shows the global structure response of the container ship induced by waves load 5 2 sifs for different load cases the structural detail shown in fig 11 was a sub model of the whole ship fem model and it was modeled following procedure described in section 2 2 three types of crack opening modes were considered i e opening mode i sliding mode ii and tearing mode iii owing to the imaginary and real part of wave pressure are loaded separately the sif amplitude becomes k k real 2 k i m a g i n a r y 2 the sif transfer function at different heading angle shown in fig 12 and the data in table 1 and table 2 show that the mode i constitutes the main component of the sif for both surface end point and deepest point more specifically compared with surface end point the effect of mode ii and mode iii is smaller in the deepest point in head and following waves sifs of cracks have smaller share of mode ii than that in oblique and beam waves this can be caused by shearing force induced by the torsion and horizontal bending the equivalent sif bowness and lee 1996 is 15 k e q k i 2 k i i 2 k i i i 2 1 ν where ν is poisson s ratio the average proportions of k i k ii and k iii to k e q in a heading angle are summarized in table 1 and table 2 the share of mode ii and mode iii will be less for larger crack size and more for smaller crack size but for simulate the crack growth direction it can be done by rebuilt the crack increment with an angle determined by an adopted criteria such as the maximum circumferential stress criterion in the submode when the k ii or k iii is big enough this issue will be discussed in the future 5 3 inconsistent relationship between sif and stress in different load cases since the nominal stress is not always possible to define in real structures hot spot stress hss is widely used in the s n curve spectral method the hss is adopted to illustrate the inconsistent relationship and it was generated by the recommended extrapolation approach american bureau of shipping 2016 the hss amplitude is σ h σ real 2 σ i m a g i n a r y 2 fig 13 shows the hss transfer functions of the local structure for a relative large crack size i e a 10 a c 0 3 the k e q is basically equal to k i see table 2 k e q is used to illustrate the inconsistent relationship the equivalent sif value at unit hss can be obtained through sif transfer functions divided by corresponding hss transfer functions as shown in fig 14 it is difficult to define a harmonious relationship between hot spot stress and sif that consider all the load cases more specifically an approximate consistent correspondence can be founded in heading waves and following waves i e 180 and 0 the stress status of the detail is near uniform tension longitudinally as shown in fig 15 while in the oblique waves the ship structure is under horizontal bending and torsion the stress status of local structure mainly is under combined tension and bending as shown in fig 15 the degree of bending dob ahmadi et al 2015 in hatch coaming plate varies with waves frequency as shown in fig 16 and there is a similar trend between figs 14 and 16 it can be the specific reason for the inconsistent relationship the results represent only one structural detail however for other details it is foreseeable that there is an inconsistent relationship between stress and sif if the loading situation of local structure changes considerably among different load case otherwise the relationship would be consistent 5 4 comparison of crack increment in a short sea state for comparison we take the crack increment in a sea state when the crack depth a 10 mm crack aspect ratio a c 0 3 for example since the crack increment in a short sea state is very small both the sif transfer functions in proposed method and the relationship between stress signal and sif in stress spectral method remain constant the significant wave height of the short sea state is 8 m and the wave period is 11 s in the stress spectral method we calculate fcp through cbc method using the simulated stress signal based on the calculated stress spectra the relationship between stress signal and sif i e sif value at unit hss as shown in fig 14 is not consistent in different heading angles and frequencies we chose relationship in a frequency that the hss transfer function is at its maximum to calculate fcp the cbc method was repeated 100 times and the average crack increment was used to eliminate the effect of uncertainty of pseudo random stress signal comparison of crack increment computed by the two methods are presented in table 3 apparently different relationships between stress signal and sif have quite large impact on fcp in cbc method according to fig 14 when using the stress spectral method it could be difficult to determine an exact relationship that take into account of all the heading angles and frequencies while the proposed method would not have the problem it is noticed that the relationships almost are consistent in heading angle 180 and 0 and the corresponding fcp results using cbc and integral are nearly equal it confirms that sif spectral method closely agrees with stress spectral method when the loading mode of critical spot are the same or similar among different heading angles and frequencies 5 5 fatigue crack propagation following the improved euler method in section 3 the fcp of the structural detail was simulated step by step with step size δ a t o l 1 mm a program code was developed to update the fem mesh automatically and calculate the fatigue life the probability of heading angle is assumed to follow a uniform distribution fig 17 shows the fcp curves using k e q and k i the expected fatigue life is 35244 h approximately 35244 365 24 4 02 years and 37418 sailing hours respectively for simulating fcp by fea additional calculation of k ii and k iii almost does not increase the computational cost and neglecting the influence of k ii and k iii would lead to no conservative results therefore k e q is recommended in the present demo fig 18 shows shape changes of the surface crack using k e q since the sifs were evaluated according to the actual boundary conditions this method automatically considers the impact of stress distribution through the plate thickness 6 conclusions a compatible relationship may not exist between sif and nominal or hotspot stress for a specific crack size at different loading conditions heading angles and wave frequencies therefore a method to calculate the fcp from multiple short term sif distributions which derived from the sif transfer functions and wave spectrum has been proposed some conclusions can be drawn the proposed method needs to calculate the sif transfer function for crack at different sizes which requires too much computation cost for reanalysis and updating the fem model therefore an improved euler method was proposed to reduce the computation steps and improve precision a case study of a real structural detail with an initial semi elliptical surface crack was used to demonstrate the application of the proposed procedure the results showed that the expected service time for the ship was approximately 4 years sailing before the crack depth reached 0 6 t the proposed spectral based method which uses short term sif distribution instead of short term stress distribution to predict the fcp of a detail under random fatigue loading is a new trial and still in its early stage compared with the stress spectral method sif spectral method is still complicated in computation of sifs further work should be focused on overcoming this drawback and developing a much faster and easier use of numerical computation method acknowledgement this study was supported by the state key program of national natural science of china grant no 51439004 and the national key basic research special foundation of china 2013cb036105 
23271,this paper presents a semi analytical methodology for the determination of prediction error statistics in deterministic sea wave predictions dswp based on linear wave models the underlying wave elevation is modelled as a gaussian stochastic process and the coefficients of the wave propagation model are assumed to be determined by linear fitting on available measurements in time and or space the possible data contamination due to measurement error is also explicitly considered the resulting approach eventually provides a linear estimator of prediction error lepre in time and space in terms of prediction error standard deviation given the fitting procedure and the sea spectrum the presented approach allows supplementing deterministic predictions based on phase resolved linear wave models with a sound prediction error measure and allows defining the concept of predictability region in a consistent probabilistic framework example applications are reported both for long crested and short crested waves with verification through monte carlo simulations single point wave gauge wave buoy measurements as well as wave radar measurements have been considered as simulated examples the developed methodology is also compared with existing approaches highlighting and discussing both the differences and the interesting qualitative commonalities keywords deterministic sea wave prediction dswp predictability region phase resolved wave models prediction error wave radar 1 introduction the nowadays interest about deterministic wave propagation models based on the marine wave radar technology is encouraged by the outlook of possible applications to real time waves and ship motion forecasting the development of early warning guidance and decision support systems based on deterministic prediction procedures could possibly have a positive impact for the safety and operability at sea a main asset in this kind of emerging short term forecasting technology with temporal horizon of the order of minutes and spatial horizon of the order of hundreds meters is the marine wave radar in fact the marine wave radar has been shown to be potentially capable of scanning the sea surface and retrieving the instantaneous images of the nearby wave field in a wide spatial range dankert and rosenthal 2004 nieto borge et al 2004 serafino et al 2011 naaijen and wijaya 2014 it is however to be noted that challenges in modelling of the associated basic electromagnetic backscattering mechanism still require evolutions of this technology to obtain very accurate measurements at least when used to feed deterministic sea wave prediction dswp models the lidar technology has also been explored for the measurement of wave elevation belmont et al 2007 grilli et al 2011 nouguier et al 2014 in principle lidar could be considered as an alternative to wave radar however presently available research on corresponding local wave elevation measurements belmont et al 2007 grilli et al 2011 nouguier et al 2014 indicate a yet too limited spatial extent of the measurement region as a result the application of such technology in case of deterministic predictions in realistic sea states characterised by long waves in open sea becomes difficult nevertheless an extension of the lidar wave measurement range could allow this technology to become a possible alternative to wave radar once wave elevation data are assumed to be available from a suitable wave measurement system a phase resolved propagation procedure can then be applied to perform a deterministic forecasting the procedure is required to be fast if the use is intended for real time applications furthermore it is required to have a prediction time horizon compatible with the operational needs particularly due to computational speed requirements linear deterministic wave propagation models are often preferred hilmer and thornhill 2015 especially for intended uses in real time applications and different aspects of their implementation have been investigated in the past belmont et al 2006 2014 blondel couprie and naaijen 2012 connell et al 2015 naaijen and blondel couprie 2012 naaijen et al 2014 naaijen and huijsmans 2008 linear dswp procedures usually consist of two main steps first in the fitting step fs the wave elevation data are analysed in the measurement domain by means of fourier decomposition techniques either based on the dft morris et al 1998 naaijen and blondel couprie 2012 vettor 2010 or on a least squares approach connell et al 2015 naaijen et al 2009 vettor 2010 afterwards a linear propagation model is defined in the propagation step ps the extensive use of the fft both in the fs and in the ps steps is deeply discussed for short crested sea applications by blondel couprie and naaijen 2012 and naaijen and blondel couprie 2012 different implementations of linear fitting and propagation procedures still based on a fourier analysis are presented by abusedra and belmont 2011 and belmont et al 2006 nonlinear phase resolved wave propagation models have been proposed by several authors e g blondel et al 2010 blondel couprie et al 2013 nouguier et al 2014 wu 2004 zhang et al 1999a b yoon et al 2016 the main issue of these techniques is represented by the costly fitting initialization step in fact in general the measured wave elevation data has to be pre processed before being actually available for the propagation model the pre processing step and its consequent complexity depend mainly on the nature of the available measurement and on the nonlinear model considered the reconstruction of the initial conditions of the nonlinear wave model can require iterative procedures on the measured data zhang et al 1999a b or data assimilation procedures as in wu 2004 blondel et al 2010 blondel couprie et al 2013 or yoon et al 2016 in particular the variational data assimilation procedure proposed by wu 2004 and blondel et al 2010 can be considered as an optimization problem for the initial conditions of the model with cost function defined as a suitable measure of the distance between the wave elevation given by the nonlinear model and the measured wave elevation data also nouguier et al 2014 used the minimization of a cost function representing the average squared difference between measured wave elevation and wave model to be propagated for the identification of the free parameters of the wave propagation model actually such approach in addition of being used for forecasting purposes served also the purpose of wave elevation reconstruction procedure for lidar measurements grilli et al 2011 nouguier et al 2014 a common issue to all dswp methods is related to the need of providing an estimation of the region where the deterministic prediction can be considered to be sufficiently reliable for the intended purposes in fact any dswp procedure is inevitably affected by prediction errors with respect to the true wave elevation which indirectly define the limits of application of this kind of procedures one source of prediction error is the inherent limitation of the assumed propagation model which does not exactly represent the underlying wave elevation field as a result even when a propagation model perfectly fits the true wave elevation at some discrete sampling points in time and or space the predicted or reconstructed wave elevation at different locations in time and or space will differ from the true one in addition in real applications the wave measurements themselves are affected by measurement errors which bring into the problem an additional source of uncertainty an aspect which is often overlooked this means that a key aspect of dswp should be the capability of providing not only an estimation of the predicted wave elevation but also some information regarding the prediction error however although the assessment of the prediction error is crucial for a consistent deterministic wave prediction the problem is rarely addressed specifically in this context the idea of using brute force tools such as massive monte carlo simulations to estimate the expected prediction errors statistics is in general practically unfeasible due to the time consuming computations that eventually will go to detriment of a direct use in real time applications therefore concepts of faster and more direct application are required the most widespread concept related to the prediction performance of dswp approaches is the so called predictability region the predictability region is considered to be the region of space and time where it is considered possible to predict the wave elevation ideally without errors it is therefore originally a binary concept which split the time space domain in a region where the prediction is possible and a region where the prediction is not possible in the past a matter of discussion has been whether to use the group velocity or the phase velocity of the waves for the identification of the predictability region e g abusedra and belmont 2011 edgar et al 2000 morris et al 1998 naaijen et al 2014 wu 2004 for example based on wave propagation considerations morris et al 1998 selected the wave phase velocity for the determination of the region where the propagation of information and the corresponding deterministic prediction can be considered possible see also edgar et al 2000 in case of long crested seas instead wu 2004 used the wave group speed for the determination of the predictability region and further extended the concept to the case of short crested seas according to wu 2004 see also naaijen et al 2014 the predictability region is defined using the group velocity of the fastest and slowest wave components of the considered sea spectrum however abusedra and belmont 2011 have shown that the use of wave group velocity cannot be completely justified and they also challenged those previous justifications for such use which were based on asymptotic stationary phase approximation the concept of predictability region has been further developed by wu 2004 and naaijen et al 2014 with the introduction of the predictability indicator a measure of the prediction capability at a generic point in time and space given the sea spectrum the predictability indicator takes into account the actual shape of the wave spectrum and this represents an advance with respect to the standard predictability region which instead accounts only for the assumed lowest and highest frequency limits of the spectrum naaijen et al 2014 verified the predictability indicator method to be qualitatively consistent with monte carlo simulations for which every realization of the sea states is ideally measured and then propagated to create a reference statistics for ensemble analysis the encouraging results showed by naaijen et al 2014 and the simple formulation of the method makes the predictability indicator an interesting tool for a more advanced and potentially more precise definition of predictability region compared to the original concept however the predictability indicator still lacks a consistent statistical background theory able to provide a clear probabilistic interpretation of the obtained quantitative values it is then useful to make a step forward in the definition of the concept of predictability region with a view to more soundly account for the prediction error from a probabilistic perspective to this end a theoretical approach for providing a consistent probabilistic measure of prediction error for deterministic phase resolved linear wave prediction models is herein presented the approach is based on the description of the sea as a gaussian stationary stochastic process the features of the fitting procedure and of the prediction model are naturally embedded in the formulation furthermore the formulation takes into account in an analytic way the actual shape of the spectrum for long crested and short crested waves on top of this the proposed framework also allows taking consistently into account the possible presence of additional measurement noise the paper is structured as follows first the theoretical background is presented starting from the definition of the fitting model and then providing the definition of the prediction error as a stochastic process the assessment of the ensemble variance of the error process leads to the natural definition of a linear estimator of prediction error lepre which accounts also for the possible contribution of measurement noise a section then follows containing three different simulated verification test cases considering long crested and short crested sea states to show how lepre can be used in identifying the level of prediction error reported results from the application of lepre are verified along with corresponding sets of monte carlo simulations eventually some comparisons with the classical binary predictability region and the predictability indicator by wu 2004 and naaijen et al 2014 are also provided in order to show how the presented lepre compares with existing approaches in order to provide consistent comparisons between simulations and lepre predictions for verification purposes simulated wave fields in all synthetic applications are based on the hypothesis of linear waves the first application is conceived to present an ideal though realistic laboratory experiment where the measurement device used for the propagation step is affected by measurement noise the second application shows details of a comparison between lepre approach monte carlo simulations binary predictability region and prediction error indicator for a simplified bimodal spectrum made of two separated band limited white noise regions in the third and last application the lepre methodology is applied to a more realistic scenario where an offshore structure is considered and the wave elevation used for the propagation model is assumed to be measured by means of a wave radar device following the verifying applications section a specific section is dedicated to a discussion regarding nonlinear effects which are not addressed by the lepre approach also in view of possible future studies on this topic the paper eventually provides some concluding remarks 2 theoretical background as anticipated the scope of this work is to provide a methodology for addressing the so called predictability region in phase resolved wave propagation models from a consistent probabilistic perspective the aim is to provide an approach representing a step forward with respect to the present common practice of identifying a conventionally defined predictability region by means of the loosely defined slowest and fastest components of the sea spectrum see e g blondel et al 2010 blondel couprie and naaijen 2012 naaijen and huijsmans 2008 wu 2004 and with respect to the more advanced yet partially semi empirical predictability indicator naaijen et al 2014 wu 2004 to this end this section presents a methodology for the semi analytical estimation of prediction error when a model for the propagation of the wave elevation field is fitted on a set of data corresponding to measured wave elevation in space and or time the framework presented herein is general and applicable to both long crested and short crested waves with and without presence of measurement error and for generic linear fitting procedures more specific applications are reported in the application section preliminary results for the long crested 1d case in absence of measurement error and using a fourier fitting have been reported by fucile et al 2016b 2 1 linear estimator of prediction error lepre and definition of predictability region it is firstly assumed that the true wave elevation field η x t is a stationary gaussian process for which a single generic realization can be represented as follows 1 η x t i 1 n η a i c i b i s i p η x t α p η x t c 1 s 1 c n η s n η α a 1 b 1 a n η b n η t c i cos k i x ω i t i 1 n η s i sin k i x ω i t i 1 n η p η x t ℝ 1 2 n η α ℝ 2 n η 1 in the expression for the wave elevation η x t k i k x k y t is the wave number vector for the i th harmonic component which is linked to the wave frequency ω i by a suitable dispersion relation in the case of linear waves and infinite water depth ω i g k i the space and time dependent vector p η x t can be referred to as the propagator vector for η see also connell et al 2015 since it propagates the wave elevation field in time and space if the coefficients vector α is known in 1 a finite but sufficiently large number of harmonic components n η is considered while the actual stochastic process is in principle recovered in the limit n η it is also assumed that η x t can be measured at certain points in space x ℝ 2 1 and or time t ℝ and that the measured wave elevation η m x t is associated with a certain measurement error δ η i e 2 η m x t η x t δ η x t the case of measurements without error represents a special case of 2 where δ η x t 0 for all positions and time instants herein the wording measured is used for sake of simplicity although in general the wave elevation can be either measured e g at a wave gauge or wave buoy or estimated e g from the inversion of wave radar images connell et al 2015 dankert and rosenthal 2004 fucile et al 2016a nieto borge et al 2004 wijaya et al 2015 it is now assumed that the true wave elevation is fitted through a phase resolved wave model ζ x t having the following expression similar to that of η x t 3 ζ x t h 1 n ζ a h c h b h s h p ζ x t β p ζ x t c 1 s 1 c n ζ s n ζ β a 1 b 1 a n ζ b n ζ t c h cos k h x ω h t h 1 n ζ s h sin k h x ω h t h 1 n ζ p ζ x t ℝ 1 2 n ζ β ℝ 2 n ζ 1 where in general the harmonic components of ζ x t differ from those of η x t and in addition typically n ζ n η the next assumption is that given a set of n m measurements η m x j t j j 1 n m at different points in space and or time the coefficients vector β can be determined by a linear transformation of the available measurements through an appropriate matrix t m i e 4 β t m η m t m ℝ 2 n ζ n m η m η m x 1 t 1 η m x n m t n m t ℝ n m 1 such an assumption covers at least three important cases the first case is the classical fourier analysis on rectangular grids in which case t m is the dft matrix golub and van loan 2013 the second one is associated with a direct least squares fitting process see connell et al 2015 vettor 2010 in such case the fitting is firstly setup as follows 5 p ζ m β η m with p ζ m p ζ x 1 t 1 p ζ x n m t n m ℝ n m 2 n ζ n m 2 n ζ where p ζ m can be referred to as the propagator matrix connell et al 2015 at the measurement points in time and space and t m is the moore penrose pseudoinverse of p ζ m i e 6 t m p ζ m p ζ m t p ζ m 1 p ζ m t the third case covered by the assumption 4 is the regularised least squares fitting using tikhonov regularisation hansen 1998 vogel 2002 where a solution β is sought such to minimize the following objective function 7 p ζ m β η m 2 λ β 2 in 7 λ is a 2 n ζ 2 n ζ regularisation matrix which is often chosen as λ λ i 2 n ζ 2 n ζ being i 2 n ζ 2 n ζ the 2 n ζ 2 n ζ identity matrix and λ the regularisation parameter in the general case of tikhonov regularisation the matrix t m then becomes 8 t m p ζ m t p ζ m λ t λ 1 p ζ m t it is worth noticing that the classical least squares case is a special case of the tikhonov regularisation while the classical fourier case can also be seen as a special case of both the other two using the model 3 and the assumption 4 the fitted model can be evaluated at any point in space and time as follows 9 ζ f δ x t p ζ x t β p ζ x t t m η m the subscript f δ indicates that the model is using coefficients which have been determined through fitting taking into account the presence of measurement error δ η it is now possible to determine the error between the fitted model and the true wave elevation η x t as follows 10 ε δ x t ζ f δ x t η x t p ζ x t t m η m p η x t α furthermore using 1 and 2 the vector of measured wave elevation can be written as 11 η m η δ η m p η m α δ η m p η m p η x 1 t 1 p η x n m t n m ℝ n m 2 n η δ η m δ η x 1 t 1 δ η x n m t n m t ℝ n m 1 combining 10 and 11 the error ε δ x t can therefore be written as 12 ε δ x t q x t α n x t δ η m with q x t p ζ x t t m p η m p η x t n x t p ζ x t t m q x t ℝ 1 2 n η n x t ℝ 1 n m from the first equation in 12 it can be seen that the error ε δ x t is due to two sources the first term q x t α represents the error due to the fact that the fitted model in general differs from the actual process the second term n x t δ η m represents the propagation of the measurement error through the fitted model both error sources also embed the effect of the fitting procedure it is now worth noticing that the error ε δ x t as obtained in 12 is a linear function of the amplitudes of the harmonic components of the true wave elevation η x t furthermore taking into account the fact that η x t is actually a stochastic process and the fact that δ η m is a random vector the error ε δ x t can be interpreted as a stochastic process in all the following considerations the set of n m measurement points is assumed to be deterministically fixed in the ensemble domain i e across multiple realizations furthermore it is assumed that other possible fitting parameters e g the regularisation matrix λ in 8 are also deterministically fixed these two latter assumptions mean that the matrices t m and p η m are deterministic matrices as a result such assumptions allow to consider q x t and n x t in 12 as deterministic functions of space and time by using the assumption that η x t is a discretised linear gaussian process similarly to the one dimensional case tucker et al 1984 the amplitudes a i and b i of the harmonic components are considered as zero mean independent gaussian variables they are linked to the single side directional wave energy spectrum s η k i as follows 13 a i n 0 σ i 2 b i n 0 σ i 2 σ i 2 s η k i δ k x i δ k y i c o v a i a j 0 i j σ i 2 i j c o v b i b j 0 i j σ i 2 i j c o v a i b j 0 i j where n 0 σ i 2 indicates a normal distribution with zero mean and variance σ i 2 δ k x i and δ k y i are wave number intervals associated with the assumed discretization of the spectrum s η k i in n η wave components and c o v indicates the covariance operator according to 13 the wave amplitudes vector α is a zero mean gaussian random vector with diagonal covariance matrix that is 14 μ α e α 0 c α α e α μ α α μ α t σ 1 2 0 0 0 0 σ 1 2 0 0 0 0 σ n η 2 0 0 0 0 σ n η 2 d i a g σ 1 2 σ 1 2 σ n η 2 σ n η 2 where e is the expected value operator in addition it is assumed that the measurement error δ η x t is a zero mean gaussian process and that it is independent of η as a consequence given the specific set of n m measurement points in space and or time the vector δ η m is a zero mean gaussian vector with a given covariance matrix depending on the assumed measurement error characteristics i e 15 μ δ η m e δ η m 0 c δ η m δ η m e δ η m μ δ η m δ η m μ δ η m t by using 12 14 and 15 the assumption that δ η x t is independent of η and recalling that from the considered assumptions q x t and n x t are deterministic vector functions it is now possible to provide a full probabilistic characterization of the prediction error ε δ x t in fact from 12 it follows that ε δ x t is a gaussian process since it is a linear combination of random gaussian vectors furthermore the mean and the variance of ε δ x t can be determined as follows 16 e ε δ x t 0 v a r ε δ x t σ ε δ 2 x t q x t c α α q t x t n x t c δ η m δ η m n t x t where e is the expected value operator v a r is the variance operator and σ ε δ 2 x t is the variance of the prediction error at x t from the considered assumptions it follows that the prediction error has zero mean in addition similarly to what was noticed when commenting 12 it can be noticed that also in 16 the variance of the prediction error is composed of two terms the first term is associated with the inherent difference between the fitted model and the true process while the second term represents the effect of the measurement error if it is assumed that the measurement errors δ η at two different points in time and space are independent actually it is sufficient they are uncorrelated then the covariance matrix c δ η m δ η m becomes diagonal 17 c δ η m δ η m σ δ η 2 x 1 t 1 0 0 0 σ δ η 2 x 2 t 2 0 0 0 σ δ η 2 x n m t n m the generic term σ δ η 2 x j t j with j 1 n m represents the measurement error variance at point x j in space and at time t j if in addition it is assumed that the measurement error is a uniform noise with variance σ δ η 2 then the covariance matrix c δ η m δ η m simplifies to 18 c δ η m δ η m σ δ η 2 i n m n m making use of the fact that the covariance matrix c α α is diagonal and if it is assumed that c δ η m δ η m is also diagonal and by using 13 the expression for the variance of the prediction error can be simplified to 19 σ ε δ 2 x t i 1 n η q 2 i 1 2 x t q 2 i 2 x t σ i 2 j 1 n m n j 2 x t σ δ η 2 x j t j i 1 n η q 2 i 1 2 x t q 2 i 2 x t s η k i δ k x i δ k y i j 1 n m n j 2 x t σ δ η 2 x j t j each term in the first summation in 19 represents the contribution to the prediction error variance at x t coming from the spectral energy around the wave number vector k i each term in the second summation in 19 represents instead the contribution to the prediction error variance at x t coming from the measurement error at the measurement point x j t j in the limit the number of harmonics assumed in the model of η x t increases towards infinity n η the first term in 19 tends to an integral involving the spectrum of η and the variance of the prediction error can be rewritten as 20 σ ε δ 2 x t f 1 2 k x t f 2 2 k x t s η k d k x d k y j 1 n m n j 2 x t σ δ η 2 x j t j where f 1 2 k x t and f 2 2 k x t are functions depending on the fitting procedure it is important at this point to underline that the single side energy spectrum s η k appearing in 19 and 20 is the spectrum of the true wave elevation η and it must not be confused with the spectrum assuming it could be consistently defined of the measured wave elevation in fact the measured wave elevation is contaminated in general by the effect of the measurement error process for a realistic measurement the assumption of diagonal covariance matrix c δ η m δ η m may be considered as a reasonable or at least convenient approximation when measurement points are sufficiently far each other in space and time however in the general case the matrix c δ η m δ η m cannot be assumed to be diagonal in fact it is expectable that there may be a correlation in time and space between measurement error at different points particularly when such measurement points are close in space or time in essence the covariance matrix c δ η m δ η m provides a probabilistic characterization of the measurement error for the assumed measurement system although the specification of such a matrix is expected to be a complex problem in the general case when c δ η m δ η m is not diagonal equations 19 and 20 keep their more general form which is based only on the fact that c α α is always diagonal i e 21 σ ε δ 2 x t i 1 n η q 2 i 1 2 x t q 2 i 2 x t s η k i δ k x i δ k y i n x t c δ η m δ η m n t x t σ ε δ 2 x t f 1 2 k x t f 2 2 k x t s η k d k x d k y n x t c δ η m δ η m n t x t a closed form analytical formulation for the functions f 1 2 k x t and f 2 2 k x t is difficult to derive in the general case for it depends on the fitting model as it has to embed the solution step in 4 however some specific consideration can be given to the case where the fitting model is derived from a discrete fourier transform dft approach in fact choosing a suitable orthogonal basis in the sense of dft possibly accounting only for a subset of allowed fourier frequencies the calculation of the t m matrix and of the product t m p η m can be carried out analytically leading eventually to analytical expressions for the resulting functions f 1 2 k x t and f 2 2 k x t further details about the calculation of the functions f 1 2 k x t and f 2 2 k x t in such special case are provided in the appendix moreover it is worth to mention that once specified the fitting model completely defines the matrix t m that consequently will remain a constant quantity of the problem the majority of the computational burden is then limited to the calculation of the matrix t m at the beginning of the procedure while other quantities can then be easily calculated afterwards the linear estimator of prediction error lepre in 19 21 or its continuous version 20 21 can now be used for providing a sound definition of predictability region in fact being ε δ x t a zero mean gaussian process in space and time it is completely characterised for each single point x t by its variance the predictability region can therefore be defined as that region π in time and space where the variance of the prediction error is sufficiently small given a threshold τ ε for the standard deviation of the prediction error the predictability region can then be defined as 22 π τ ε x t σ ε δ 2 x t τ ε 2 it can be noticed that in the probabilistic framework developed herein there is no single predictability region and the predictability region depends on which level of prediction error is considered to be acceptable through the specification of the threshold τ ε a similar definition of predictability region was also considered by naaijen et al 2014 although they based their definition on a threshold level for the predictability indicator 2 2 implementation and usage expression 19 20 or the more general forms 21 can be used in deterministic phase resolved wave predictions to supplement the prediction of wave elevation along with an estimation of the prediction error associated with the specific fitting and prediction procedure to this end in general a fitting model 3 is firstly chosen and this corresponds to the definition of a certain set of wave number vectors k h h 1 n ζ then it is necessary to define the set of n m points in time and or space which are used for the fitting of the propagation model according to the decided fitting procedure to further proceed it is necessary to know or at least to have an as good as possible estimation of the sea elevation spectrum s η k in some applications such as laboratory experiments or numerical simulations the spectrum s η k is known with sufficient accuracy however in applications at sea the estimation of s η k can be a critical issue depending on the specific application methods based on wave radar processing nieto borge et al 2004 wave buoys or ship as a wave buoy e g mas soler et al 2018 tannuri et al 2012 can be exploited to estimate s η k it is however crucial that the estimator of the true wave elevation spectrum s η k is depurated as much as possible from the effects of measurement error in this respect if the measurement error is assumed to have a flat spectrum s δ η additive to s η k it follows that the spectrum of the measured wave elevation becomes s δ η s η k in such case the analysis of very low and very high wave number regions could be used to estimate the contamination s δ η which should then be removed from the spectrum of the measured wave elevation to get eventually the depurated estimation of s η k another step for the application of the proposed methodology is the definition of a modelling for the covariance matrix of the error in the measurement of the wave elevation see 15 in case a flat spectral noise level s δ η is determined the variance of the measurement error can be obtained from the integration of s δ η over the region of k up to nyquist limits from the fourier analysis alternatively the measurement error can be defined for instance from the knowledge of the measurement system being it e g a wave gauge a wave buoy or a wave radar as appropriate other application specific methods can of course also be used from the description above almost all the major information would be available at this stage however in order to determine an estimator of σ ε δ 2 x t it is necessary to make some additional assumption regarding the process η x t if the fitting procedure is such that analytical expressions for the functions f 1 2 k x t and f 2 2 k x t can be determined then expression 20 or its general form in 21 can be directly used combined with a suitable numerical integration procedure alternatively the discrete formulation 19 or its general form in 21 can be directly used in the general case however when using 19 21 it is necessary to specify a certain number of harmonic components n η which are assumed to represent the underlying unknown stochastic process η x t in order for η x t to be a sufficiently good approximation of the true underlying sea elevation gaussian process n η should be sufficiently large from application it has been noticed that when the number of components n η is sufficiently large and in particular sufficiently larger than the number of components n ζ used for the fitted model the behaviour of σ ε δ 2 x t converges sufficiently for practical purposes to the value which would be obtained with n η this is expectable since part of σ ε δ 2 x t represents the prediction error for ζ x t which loosely speaking is associated with an insufficient frequency resolution in ζ x t to resolve all the components of η x t the wording all is in quotation marks since in reality η x t as a stochastic process has infinite harmonic components of infinitesimal amplitude this convergence can also be understood from a numerical perspective when 19 21 is considered as a discretised version of the integral in 20 21 the drawback of using the discrete formulation 19 21 is that an increase of n η tends to increase the dimensions of some of the matrices involved in the calculations with a consequent increase of memory consumption and computational time in order for the procedure to be practically viable with present resources it is necessary to find a trade off for n η such that it has a sufficiently large value to have a sufficiently good converged estimation of σ ε δ 2 x t but without exceeding the available computational time and resources it is nevertheless to be noted that the problem of memory consumption can be practically solved by calculating the functions q 2 i 1 2 x t q 2 i 2 x t in 19 21 or f 1 2 k x t f 2 2 k x t in 20 21 separately for each generic wave number k and then respectively performing the summation in 19 21 or applying usual numerical integration methods for calculating the integral in 20 21 with all data available σ ε δ 2 x t can then be estimated in a suitable range of space and or time this allows first to supplement the prediction ζ x t with an associated gaussian confidence interval based on σ ε δ x t furthermore given a limit threshold level τ ε the predictability region π τ ε can eventually be determined in accordance with 22 it is also to be noted that the possibility of estimating σ ε δ 2 x t allows in addition to devise optimum prediction strategies and or fitting and prediction setups in order to provide wave elevation predictions with minimum smaller confidence bounds 3 verification through simulated applications three simulated applications exploiting the described lepre methodology are herein reported as examples the first two applications are simplified long crested sea cases and they are used to show and discuss the main characteristics and capabilities of the lepre methodology in the third application a more realistic scenario dealing with the prediction of water wave elevation in short crested sea is investigated the considered applications are meant to verify the developed lepre approach and as a result they are based on the same main assumptions on which the lepre approach is based such applications are therefore not to be considered as full validations of the method in fact a full validation exercise would require comparisons with experimental data or as an alternative a comparison with data based on nonlinear wave field simulations see e g blondel couprie et al 2013 such a validation process is considered to be part of future development activities the first application presents a simulated laboratory experiment where the wave elevation is assumed to be produced by a wave maker the purpose of this application is to set up a controlled and yet realistic environment where to test the lepre methodology dealing also with the effects of measurement error noise the main results are then verified with respect to a set of monte carlo simulations and the effect of the measurement noise is discussed the second application has been conceived to show how the lepre methodology compares with respect to the predictability region wu 2004 and predictability indicator wu 2004 naaijen et al 2014 techniques in the case of a simplified archetypal strongly bimodal spectrum the considered simplified spectrum is used for comparison and description purposes in order to emphasize the effects which might appear less evidently in a smoother realistic wind waves plus swell bimodal case in the last simulated application the lepre methodology is applied to a more realistic scenario where an offshore structure is considered and the wave elevation used for the propagation model is assumed to be measured by means of a wave radar device although the wave radar inversion problem and related errors are out of the scope of this work on this topic see e g fucile et al 2016a who compared the performance of radar inversion based on the modulation transfer function mtf technique with those of a least squares technique using tikhonov regularisation the main quantities involved in the fitting and propagation process are chosen to be representative of a realistic scenario involving wave radar measurement the lepre methodology is used to provide the standard deviation of prediction error for the propagated wave elevation process different spreading angles are considered and the corresponding effect on the wave elevation prediction error is discussed results are then verified against a corresponding set of monte carlo simulations 3 1 simulated laboratory experiments with wave gauge measurement seakeeping experiments may require measuring the wave elevation at particular locations along the wave tank or at the tested model surroundings in some cases a direct instrumental measurement may be prevented by the presence of obstacles like the tested model itself or the setup of the wave probes can turn out to be particularly inconvenient a possible solution is to measure the wave elevation at suitable distance upstream from the points of interest and then derive an indirect measure of the undisturbed wave elevation where this information is needed this kind of reconstruction process will eventually be affected by errors and therefore it must be supplemented with a sound error analysis if the measurement error is assumed to be uncorrelated which is the case assumed in this example then the lepre methodology can be applied to this scenario in its definition 19 or 20 which allows dealing with deterministic predictions in presence of measurement noise the complete forms 21 could in principle be applied if a general possibly non diagonal covariance matrix c δ η m δ η m for the measurement error is available for this example application a wave probe is assumed to be placed in the middle of a wave tank with depth d t 3 8 m see fig 1 the indirectly reconstructed wave elevation is required at two downstream probing points at distance d 1 3 0 m and d 2 6 0 m from the measuring wave probe according to 19 20 the lepre methodology requires the knowledge of the wave spectrum s η in general the true wave spectrum is unknown and it has to be assessed from the wave measurement however for sake of simplicity in this case the nominal spectrum is assumed to be known since it is a typical input for the experimental wave generation in particular the spectrum considered in this example is a jonswap spectrum with peak period t p 9 30 s corresponding to peak spectral frequency ω p 0 676 r a d s and peak enhancement factor γ 3 3 it is assumed that this spectrum is realized in the experimental laboratory at a model scale λ 50 at this scale which is the one at which results presented in this section are reported the peak period of the spectrum is 1 32s the wave probe measurements are considered to be affected by gaussian random noise with a standard deviation proportional to the significant wave height h s two different levels of noise are considered namely σ n 0 02 h s and σ n 0 10 h s accounting for the linearity of the approach all results reported hereinafter for this example are normalized by the significant wave height they can therefore be considered to represent outcomes per unitary h s within the limits of the linearity assumption the characteristics of the fitting model are defined by the recording time window assumed to have a length t m 10 t p and the wave probe sampling frequency assumed to be 50 hz corresponding to δ t 0 02 s with the considered time step the measurement is then defined to start at t 0 s and to finish at t t m 13 14 s 10 t p the fitting propagation model is based on dft analysis the selected fourier frequencies used for fitting model are ω j j 2 π n m δ t with j 1 n m 2 1 where n m 658 thus zero and nyquist wave frequencies are not taken into account in the calculations for the propagation model the finite depth dispersion relation ω j g k j tanh k j d t has been used with d t being the wave tank depth results from the lepre methodology are verified against a set of 500 monte carlo realizations and a 95 confidence interval is provided to account for sampling uncertainty of monte carlo simulations realizations of wave elevation have been generated following tucker et al 1984 using a total of 1026 harmonic components in the range of wave frequencies 0 3 ω p ω 3 ω p the error standard deviation σ ε δ is presented in non dimensional form i e by normalization with respect to h s first fig 2 reports the reconstruction of the wave elevation normalized by h s for four different random realizations of the considered sea state at the probe location x d 1 3 m with x 0 at the measuring wave probe and with the measurement noise level σ n 0 02 h s the true wave elevation is also reported the lepre methodology is used to provide the reconstructed wave elevation with an error bound 2 σ ε δ corresponding approximately to the 95 confidence interval the exact 95 confidence interval would correspond to 1 96 σ ε δ it is possible to note that there is a time interval where the reconstructed wave elevation matches particularly well the true wave elevation and this time window is independent of the realization assuming a conventional threshold level σ ε δ 0 05 h s a predictability time window can therefore be defined on the basis of the lepre prediction error standard deviation in the context of this specific example the prediction error is to be intended as a reconstruction error and the predictability time window is to be intended as the region of time where the reconstruction error is sufficiently small at a particular location such time window is indicated in fig 2 it can be noticed that consistently for all the reported realizations within the defined predictability time window the reconstructed wave elevation well reproduces the true wave elevation whereas outside it tends to deviate it is important to underline that as described before it is herein assumed that measurement are taken at the wave probe for a time interval t m e a s 0 s t m 13 14 s at model scale it therefore means that for the probe location at x d 1 3 m in fig 2 the best reconstruction is obtained for time instants before the end of the measurement instant while this is not an acceptable situation in case of a forecasting application in the case of the present example this is not posing any problem because the scope herein is to provide an a posteriori not real time reconstruction of the wave elevation field fig 3 and fig 4 show the time history of the prediction error standard deviation as calculated at the two probe locations for the two considered levels of noise furthermore the optimal time delay δ t o p t is also identified and highlighted this is the time delay from the beginning of the measurement window at which the standard deviation of prediction error σ ε δ shows its minimum for the considered probe location this information could be useful in devising optimum reconstruction strategies based on the minimization of the prediction error lepre results in figs 3 and 4 are almost indistinguishable from monte carlo simulations and clearly within the confidence interval indicating that the lepre methodology has been properly implemented looking at figs 3 and 4 it can be seen how the distance from the measurement wave probe changes the behaviour of σ ε δ with the region of minimum error shifting forward in time and higher in value as the reconstruction point is farther from the measurement probe in the direction of wave propagation a comparison between results of figs 3 and 4 indicates that as the noise level increases the prediction error standard deviation tends to show a flattening of the region of minimum error however at least for the two tested cases characterised by small and moderate noise levels the optimal time δ t o p t is independent of the noise level and it only depends on the probe location it is worth underlining that in case of the location at x d 1 3 m the optimum reconstruction time occurs before the end of the measurement time window whereas the opposite occurs for the farther probe at x d 2 6 m fig 5 and fig 6 provide a wider picture by showing the space time error maps for both the noise levels using the lepre methodology in the figures the locations of the probe are highlighted with vertical red lines and the points of corresponding minimum prediction error standard deviation are also indicated by a circular yellow symbol the comparison of the two maps shows that the lepre methodology consistently accounts for the presence of higher measurement noise the increase of the noise level causes an increase of the values of σ ε δ in the whole space time domain in addition to the analysis of the wave reconstruction at locations different from the wave measurement probe it is also interesting to provide some more information regarding the measurement position itself data regarding the prediction error at the measurement location can be obtained directly from figs 5 and 6 however it is worth providing some more specific detail showing the peculiar behaviour of the quantities of interest at the measurement point to this end fig 7 shows the reconstruction of the wave elevation normalized by h s for four different random realizations of the considered sea state at the measuring wave probe for the case with the measurement noise level of σ n 0 02 h s this figure is to be compared with fig 2 from fig 7 it can be seen that at the measurement location the model ζ x 0 t fits the wave elevation within the measurement time window 0 t m as expected by the described fitting and propagation procedure as a result in the measurement time window the difference between the true wave elevation η x 0 t and the model ζ x 0 t is basically due to the considered measurement noise however for time instants after the end of the measurement time window the model ζ x 0 t loses its prediction capabilities as it is expectable this is clearly represented by the time dependence of the normalized prediction error standard deviation at the wave measurement location as reported in fig 8 to be compared with fig 3 which shows a characteristic jump at t t m this sudden increase of the prediction error standard deviation corresponds to the sharp widening of confidence intervals in fig 7 it can be noted that also for this location results from the application of lepre are verified by the monte carlo simulations it is finally worth underlining that results obtained in this section are in line with those obtained by naaijen et al 2014 who carried out deterministic sea wave predictions and corresponding prediction error analyses through simulations and experiments in conditions that are qualitatively similar to those used in the simulated example reported herein 3 2 simulated long crested bimodal sea this example considers the application of lepre methodology in case of a simplified idealised bimodal spectrum the main aim is to establish a simple archetypal scenario able to highlight the common behaviours and the main differences between the lepre methodology the binary predictability region wu 2004 and the predictability indicator naaijen et al 2014 wu 2004 techniques the details of these two techniques are not reported herein and major details can be found in wu 2004 and naaijen et al 2014 more precisely in this example case results from the lepre methodology are compared with the quantity 1 p where p is the predictability indicator from wu 2004 and naaijen et al 2014 by borrowing the nomenclature from naaijen et al 2014 1 p is referred to as prediction error indicator although strictly speaking this name was used by naaijen et al 2014 for the quantity 1 p for verification purposes all results are also compared against a set of 500 monte carlo realizations realizations of wave elevation have been generated following tucker et al 1984 using a total of 2000 harmonic components in the range of frequencies identified by the nonzero values of the bi modal spectrum i e 1000 harmonic components within each of the two spectral bands the two bimodal spectra used for this application are reported in fig 9 each spectrum is designed as the sum of two simple band limited flat spectra with a narrow bandwidth b w 0 1 k 0 and with symmetric peaks separated by δ k 0 25 0 75 k 0 from the central reference wave number k 0 2 π λ 0 1 m the corresponding reference period is t 0 2 π ω 0 and the reference wave frequency in deep water is ω 0 g k 0 with g the gravitational acceleration these spectra represent an interesting benchmark for a comparison with the predictability region and predictability indicator in fact the predictability region approach takes into account only the fastest and lowest component of the spectrum without accounting for the actual spectral shape basing the identification of the predictability region on the assumption of using the group velocity as reference speed on the other hand the predictability indicator approach although still using the group velocity as reference speed for the computations is able to take into account the actual spectral shape finally the lepre approach accounts in an analytic way for all the features of the fitting procedure and for the exact spectral shape of the underlying wave elevation process without any additional semi empirical assumption the fitting is carried out in the space domain on a measurement region of length l m 13 λ 0 with sampling interval δ x λ 0 15 the measurement interval is 0 x λ 0 13 the fitting propagation model is defined on the basis of dft analysis the fourier wave numbers selected for the fitting model are k j j 2 π n m δ x with j 1 n m 2 1 with n m 196 thus zero and nyquist wave frequencies are not taken into account in the calculations for the propagation model the infinite depth dispersion relation ω j g k j has been used results from the application of the different methodologies are reported in fig 10 where surfaces of σ ε x t h s 2 2 are shown since in this case no measurement error is considered the standard deviation of prediction error is indicated as σ ε instead of σ ε δ it can be noticed that there is an overall qualitative consistency among the different methodologies the region where the lepre approach shows small values of prediction error standard deviation are in line with the identified predictability region according to wu 2004 and are also in line with the regions where the prediction error indicator according to naaijen et al 2014 is small furthermore the outcomes from the lepre methodology are fully verified by the comparison with monte carlo simulations as the two methods show almost indistinguishable prediction error maps it can be noticed that all methods agree in identifying a reduction of the minimum error region when the bimodal spectrum is characterised by a wider separation between the two bands which corresponds to the presence of wave components with very different group speeds the presence of traces in the time space map associated with the different speeds of the components belonging to the two bands is quite evident particularly in case of δ k 0 75 k 0 however a closer look to results shows how the lepre method provides much more information on the prediction error in terms of error pattern thanks to its capability of implicitly embedding the exact characteristics of the fitting model as well as the exact spectral characteristics of the underlying wave elevation process it is also worth recalling that in the limit of the underlying assumptions the lepre formulation stems directly from exact statistical considerations and it therefore provides clear and unambiguous information about the expected prediction error on the other hand the prediction error indicator and the predictability region while qualitatively enabling the identification of regions with small prediction errors they lack a direct relation with a statistical description of the error however from the reported comparison the high level of qualitative agreement between the prediction error indicator and the lepre methodology is evident this suggests the possibility of identifying some underlying semi empirical relation between the two approaches and provides a sort of justification to the assumptions used in the determination of the prediction error indicator at least for the considered fitting procedure setup and for the selected spectral shape 3 3 simulated short crested sea with wave radar sensing in this case the lepre methodology is applied to a realistic scenario where the wave elevation is predicted on the basis of the assumed availability of wave radar measurements fig 11 presents the overall scheme of the problem where a wave radar on an offshore structure scans the nearby sea surface the wave elevation signal is considered to be measured in an annular domain defined by a maximum radar range r 3000 m and limited by a proximity blind range r 250 m the notional wave radar imaging bounds are considered to be representative of a usual wave radar measurement for sake of simplicity the wave radar is assumed to provide a reconstruction of the instantaneous wave field on the whole domain without errors accordingly and similarly to the previous example application the prediction error standard deviation is indicated as σ ε and not as σ ε δ the fitting procedure is carried out on a square sub domain of the sensing region with dimensions l x l y 1800 m as reported in fig 11 and the wave elevation signal is sampled on an evenly spaced grid with spacing δ x δ y 10 m which is a typical wave radar resolution as observed by blondel couprie and naaijen 2012 the propagation model based on the dft fitting of an instantaneous wave radar image is particularly sensitive to misinterpretation of the correct propagation direction of the wave components because of lack of information in time domain and because of leakage effects this leads to an incorrect propagation of waves and is in general detrimental to a correct prediction of the wave field in this work the problem has been dealt with by defining the wave numbers used in the fitting and propagation model to belong to the same quadrant of the main propagation direction of the waves so to have k x k y 0 blondel couprie and naaijen 2012 this assumption basically corresponds to the implementation in the fitting model of specific information regarding the directional wave spectrum and the lepre methodology can directly handle this sort of situation a grid of n x n y points with n x n y 181 is used for the chosen domain the time instant of the measurement is conventionally set to t 0 s the fitting propagation model is defined on the basis of dft analysis the selected fourier wave numbers for the fitting model are defined in vector form as k i j k x i k y j t with k x i i 2 π n x δ x and k y j j 2 π n y δ y with i 0 n x 1 2 and j 0 n y 1 2 the zero wave number k k x 0 k y 0 is excluded from the calculations for the propagation model the infinite depth dispersion relation has been used so that the wave frequency is calculated as ω i j g k i j and k i j k x i 2 k y j 2 a jonswap wave elevation spectrum with significant wave height h s 3 m peak period t p 12 s corresponding to peak spectral frequency ω p 0 524 r a d s and peak enhancement factor γ 3 3 is considered in this case the directional wave spectrum s k θ is defined by using a multiplicative cosine squared spreading function d θ as follows 23 s k θ s k d θ d θ 2 θ s p r e a d cos 2 π θ χ θ s p r e a d θ χ θ s p r e a d 2 χ θ s p r e a d 2 where θ s p r e a d is the spreading angle and χ is the main propagation direction different spreading angles are considered namely θ s p r e a d 30 60 90 deg while the main propagation direction is kept constant to χ 45 deg an example of directional spectrum is presented in fig 12 the lepre approach is used here to determine the prediction error standard deviation associated with the assumed fitting and propagation scheme the determination of the prediction error standard deviation allows also to define on the one hand an optimum time delay for the prediction as discussed before and on the other hand a predictability region given a specified threshold value τ ε see 22 in the following examples a conventional value τ ε 0 05 h s is used reported results are also verified against a set of 100 monte carlo realizations for the case with θ s p r e a d 30 deg which have been analysed in ensemble domain providing estimated expected values and 95 confidence intervals for the prediction error standard deviation realizations of wave elevation have been generated by discretizing the spectrum and using random amplitude and phase of each component the random amplitudes were generated using the local energy of the spectrum i e the local integral of the spectrum associated to each wave component in accordance with what tucker et al 1984 detailed for the long crested sea case a total of 3 4 10 5 harmonic components were used in the range of wave frequencies 0 25 ω p ω 2 5 ω p and in the range of directions 30 deg θ 60 deg see the spreading function d θ in 23 fig 13 shows the comparison of normalized prediction error standard deviation between monte carlo simulation and lepre results at the offshore structure location it is noted that the coordinates reported in fig 13 and in the subsequent figures are referenced to the lower left corner of the sensing sub domain shown in fig 11 and therefore the structure is placed at coordinates x y 2000 m the very good matching between lepre results and monte carlo simulations taking into account the sampling uncertainty reflected by confidence intervals verifies the implementation of lepre also for short crested sea applications similarly to the previously reported examples the time history of the normalized prediction error standard deviation shows a minimum which allows to identify the optimal time delay for a deterministic prediction to be carried out in the considered situation fitting region fitting model and sea spectrum furthermore given the considered situation the behaviour of the prediction error allows also to define the predictability region here in the form of a predictability time window this time window corresponds to the time interval during which the prediction error standard deviation is below the defined threshold τ ε 0 05 h s i e the time window in the future within which the prediction error is considered to be acceptable according to the threshold limit from a probabilistic perspective fig 14 presents the lepre results again at the offshore structure location as obtained for different spreading angles θ s p r e a d 30 60 90 d e g results indicate an increase of prediction error standard deviation as the spreading angle increases in the specific case of θ s p r e a d 90 d e g the prediction error standard deviation of the propagation model fails to drop below the specified although notional acceptable threshold limit requirements this indicates that in some cases a predictability region could not exist and this should be taken as an indication about the need of improving the fitting model and or changing the measurement region finally fig 15 to fig 19 provide maps of the normalized prediction error standard deviation in the space region surrounding the offshore structure for different time instants being t 0 s the instant when the fitting of the propagation model takes place normalization in this case is carried out using the normalization factor h s 2 2 results from monte carlo simulations are also reported as verification of the lepre predictions showing that considering the natural sampling uncertainty from monte carlo simulations the lepre implementation can be considered to be verified looking at figs 15 19 as time evolution of the surface of normalized σ ε x t it can be noticed that the region of minimum of the surface i e the region of better prediction from a probabilistic perspective while modifying its shape in time propagates along the main wave propagation direction a smoothing of the edges regions of large gradients of the surface can also be noted as the time increase particularly when comparing fig 15 and fig 16 4 some considerations regarding nonlinear effects the scope of the lepre methodology presented herein is to provide a fast tool for supplementing dswp with a related estimation of the prediction error characteristics in order to derive a formulation for prediction error statistics the lepre methodology uses assumptions that are consistent with a linear dswp framework as reported in the introduction the choice of linear dswp models is usually justified in light of computational efficiency and robustness although in principle it is pertinent only to those situations where wave field nonlinearities are negligible nonetheless even when nonlinear dswp models are considered and nonlinear wave contributions are explicitly accounted for linear tools are still used to provide relevant though approximate indications for the higher order models e g blondel et al 2010 blondel couprie et al 2013 grilli et al 2011 nouguier et al 2014 wu 2004 in this respect the lepre methodology by redefining some key aspects of the linear dswp framework represents a step forward compared to existing linear approaches modelling the evolution of a water wave field simulating its interaction with the environment and catching transient and highly nonlinear water wave phenomena is generally acknowledged as a difficult task it is therefore not surprising that embedding such complexity within fast and efficient dswp models still represents a prohibitive challenge hence in the dswp framework some of the most complex nonlinear aspects of the wave dynamics such as wave breaking or interaction with arbitrary bottom topography are seldom considered or only partially addressed wu 2004 however major efforts are done in modelling some of the peculiar nonlinear features of a propagating wave train such as bound waves nonlinear dispersion relation or even multiple resonant waves interaction by using more or less refined nonlinear or weakly nonlinear models among them the most relevant to dswp are related to the role of the bound waves for a correct modelling of the wave profile and to the nonlinear effects on the dispersion relation for the correct wave propagation blondel et al 2010 blondel couprie et al 2013 the former aspect is associated with second and higher order nonlinear effects i e bound waves leading de facto to a departure from the gaussianity of the wave elevation field e g fedele et al 2017 nouguier et al 2009 tayfun and fedele 2007 the modification of the dispersion relation is due to effects arising at least at the third order the number of studies regarding deterministic sea wave predictions based on nonlinear wave models are however not numerous zhang et al 1999a b developed and successfully applied a directional hybrid wave model based on second order approach for deterministic sea wave predictions but they did not compare the outcomes against linear ones wu 2004 studied deterministic sea wave forecasting considering a multi level approach based on a first order linear model a second order model with possibility of accounting for nonlinear dispersion relation and a nonlinear hos model with possible arbitrary order of nonlinearly the last one was also supplemented with a filtering technique aimed to overcome the problems related to the inception of wave breaking and spilling breakers the analysis by wu 2004 highlighted the importance of considering nonlinear effects in case of large significant wave steepnesses whereas the linear model was shown to provide good results in case of milder sea states in general for severe sea states the study by wu 2004 highlighted the importance of considering the nonlinear wave dispersion relation and showed that the use of nonlinear prediction models tend to improve the predictions at the cost however of an increased computational time wu 2004 also highlighted that wave wave interaction effects become more relevant for wave evolutions on long time horizons referring to wu 2004 blondel et al 2010 carried out a numerical study associated with deterministic sea wave predictions for unidirectional irregular waves they compared the prediction capabilities of first order wave model pure second order wave model second order wave model enhanced with a third order nonlinear dispersion relation and a third order wave model based on hos for small significant wave steepenesses the first order linear model provided results comparable with nonlinear models at larger significant wave steepness the relative prediction error by all models increased as well indicating the effect of nonlinearities in a fully linear framework the magnitude of the relative prediction error for a given spectral shape is independent of the significant wave height the comparison between prediction capabilities from different models showed that nonlinear models performed better as the significant wave steepness increased interestingly the first order and the second order model performed quite similarly whereas an improvement of the prediction performances was much more noticeable when using the enhanced second order model and even further when using the hos third order model this indicates the importance of a modified nonlinear dispersion relation in particular the comparison between the predicted and the target wave elevation showed a reasonably good agreement of the wave profile for all models but the first order and the second order model showed a systematic phase shift indicating the effect of the nonlinear dispersion relation terms generally wave peaks and troughs were better reproduced by the second order model this showing a beneficial effect of considering bound waves and wave wave interactions terms however first order and second order model performed very similarly a subsequent study by blondel couprie et al 2013 provided an experimental confirmation of the trends observed by blondel et al 2010 on the basis of long crested irregular waves experiments nouguier et al 2014 referring to synthetic lidar data studied a reconstruction and forecasting approach see also grilli et al 2011 based on a linear wave model and on a nonlinear lagrangian choppy wave model nouguier et al 2009 both linear and nonlinear model provided similar reconstruction performance but the nonlinear model showed better forecasting capabilities the highlighted nonlinear effects cannot be directly accounted for by the proposed lepre methodology indeed the lepre approach is essentially linear and gaussian it is therefore representative for describing the free waves contribution an important characteristic of the lepre approach is that according to the linearity assumption the harmonics of the single wave components of the underlying wave field are assumed to be statistically independent random variables in ensemble domain the introduction of bound waves and wave wave interactions would break this assumption because the amplitudes of nonlinearly generated wave components would deterministically depend on those of the free waves to account for nonlinear effects in the wave elevation it could be useful to revisit the proposed approach by separating the free waves from the bound waves contributions at the same time it is to be noted that the lepre approach is not strictly tied to the use of a basic linear dispersion relation in fact a general relation between wave number and wave frequency can be used without any restriction this means that effects such as current could be directly accounted for but it is also possible to consider the possibility of introducing a nonlinear corrected dispersion relation although not being yet a fully consistent nonlinear extension of the lepre approach such a modification could possibly provide some improvements with respect to the use of a linear approach it is clear that a linear model as the one underlying the proposed lepre methodology has a series of limitations however it may be useful at least in an approximate framework to try keeping separate the concept of providing an accurate deterministic forecasting of wave elevation from the concept of providing a corresponding measure of the associated uncertainty which is the target herein one of the aims of the lepre methodology is to provide a linearly approximate but fast and a priori estimation of the confidence interval for the forecasting notwithstanding the inherent limits in the interpretation of the prediction during an actual application the lepre estimation could be used either quantitatively for mild linear sea states or alternatively as an approximate guide for more severe nonlinear but not strongly nonlinear sea states in this latter case it is not unreasonable to imagine that a lepre estimation of the uncertainty level could be combined with a deterministic prediction based on nonlinear approaches at least for not too severe sea states in such a situation the high computational effort due to the use of nonlinear wave models would be limited to the single deterministic prediction while the fast semi analytical approach from lepre would be used for the approximate estimation of uncertainty bounds if a fully nonlinear approach would be used also for the determination of the confidence interval for the prediction this would likely require the use of monte carlo simulations which may be impractical for real time approaches beside the scenario of a real time application it shall also be underlined that an estimation of the prediction error statistics could also be useful as a guide for the preliminary setting up of the parameters of a prediction system in fact when a large space of design alternatives is to be explored the use of nonlinear monte carlo approaches could become impractical or basically impossible depending on the computational effort and the number of parameters to be tested in such a situation the use of lepre could be of help at least for a preliminary screening in all cases as usual the gain in computational time compared to the use of monte carlo simulations based on nonlinear models is paid in the lepre methodology by the introduction of a series of simplifying assumptions on the basis of these considerations it would therefore be useful to carry out future investigations regarding the qualitative and quantitative comparison between prediction error statistics as obtained from direct nonlinear monte carlo simulations and from the proposed lepre methodology 5 conclusions deterministic predictions of wave elevation could contribute to the safety and operability of vessels and other types of units operating at sea through implementation in early warning guidance and decision support systems while one of the issues in this respect is how to generate the deterministic predictions another parallel issue is how to supplement deterministic predictions with a consistent prediction error measure confidence band this paper has specifically addressed the latter problem by presenting a semi analytical methodology for the determination of prediction error statistics in deterministic sea wave predictions focusing on linear wave models the approach is based on the assumption that the underlying wave elevation stochastic process is gaussian and that the coefficients of the fitting and propagation model can be obtained from a linear fit of the measured wave elevation in space and time furthermore the presented methodology allows to take into account also the presence of measurement error eventually the presented approach allows to obtain a linear estimator of prediction error lepre in space and time where the prediction error is measured through its ensemble variance this estimator takes into account the characteristics of the fitting model and of the fitting points in time and or space as well as the exact characteristics of the sea spectrum the approach is applicable in both long crested and short crested sea states and allows to directly account for different types of fitting procedures for the coefficients of the propagation model the presented lepre approach allows to provide a sound and statistically consistent measure of prediction error as a result it represents a conceptual step forward with respect to existing approaches binary predictability region and prediction error indicator which while being easier to apply in some situations are unfortunately characterised by a level of semi empiricism which could lead to a difficult quantitative interpretation of their outcomes overall the application of lepre methodology provides a full picture of the evolution of the standard deviation of prediction error in space and time this in turns allows to properly determine a predictability region given a specified acceptable threshold for the prediction error standard deviation the capability of determining the prediction error standard deviation also allows the definition of optimum prediction delays in space and or time given the fitting model and the underlying sea spectrum as points of minimum of prediction error standard deviation the presented approach has been applied to a series of representative simulated example cases covering long crested and short crested seas as well as unimodal and archetypal bimodal spectra corresponding monte carlo simulations have also been reported for verification purposes showing the expected agreement with the lepre semi analytical calculations the considered example cases are relevant to laboratory applications as well as applications where the wave elevation could be considered to be measured from a wave elevation sensing device such as a wave radar the presented approach has also been compared with the existing binary predictability region approach and the prediction error indicator showing differences and highlighting interesting qualitative commonalities it is envisioned that the lepre approach could be useful in the future for a deeper and more clear understanding of the characteristics of error in deterministic predictions and for the definition of optimal deterministic prediction strategies furthermore the scheme of the presented approach has also been extended by the authors for application to deterministic ship motions predictions and it is now being tested with results expected to be reported in the near future acknowledgments the contribution of fabio fucile to this work has been carried out in the framework of his ph d programme at university of trieste ph d scholarship d 4 cycle xxix funded by cnr insean c lugni was supported by the research council of norway through the centres of excellence funding scheme amos project number 223254 appendix analytical formulation of lepre in case of dft fitting applied to long crested 1d and short crested 2d waves this appendix presents the derivation of functions f 1 2 k x t and f 2 2 k x t in equation 20 21 in the special case when a dft fitting approach is applied both long crested 1d and short crested 2d waves are considered the derivation starts from the case of long crested 1d sea states where waves propagate in the same direction in this case the generic wave number vector k can be replaced by its corresponding scalar magnitude k and the generic position vector x can be replaced by a scalar coordinate x the possible presence of measurement error does not affect the definition of f 1 2 k x t and f 2 2 k x t in 20 since the contribution to the prediction error standard deviation due to the presence of measurement error represents an additive term therefore for the purpose of this appendix the prediction error can be defined by combining equations 10 and 12 as follows without considering measurement error a 1 ε x t ζ f x t η x t p ζ x t t m p η m p η x t α q x t α the measurement of the wave elevation is assumed to be carried out on an evenly spaced 1d grid of m points with sampling resolution δ x so that the sampled positions are x m x 0 m δ x with m 0 m 1 and x 0 is a given bias position the corresponding fourier wave numbers are defined as k s 2 π s m δ x with the index s taking the values on a convenient subset of the set 0 1 m 2 the fitting model is then assumed to be based on a set of n ζ wave numbers k i k 1 k n ζ chosen among the previously defined fourier ones for sake of simplicity the analytical solution will not account for the zero wave number k 0 and for the possible nyquist wave number k π δ x exploiting the properties of the dft matrix it is straightforward to prove that the matrix t m appearing in 4 can be actually written as a 2 t m 2 m p ζ m t the matrix product t m p η m can now be rewritten in the following block matrix form a 3 f m f 1 1 f 1 n η f i j f n ζ 1 f n ζ n η where f i j f c c k i k j f c s k i k j f s c k i k j f s s k i k j the determination of the elements of f i j can be carried out analytically leading to the following results a 4 f c c k i k j 2 m m 0 m 1 cos k i x m cos k j x m cos π μ i ν j θ d μ i ν j m cos π μ i ν j θ d μ i ν j m a 5 f s s k i k j 2 m m 0 m 1 sin k i x m sin k j x m cos π μ i ν j θ d μ i ν j m cos π μ i ν j θ d μ i ν j m a 6 f c s k i k j 2 m m 0 m 1 cos k i x m sin k j x m sin π μ i ν j θ d μ i ν j m sin π μ i ν j θ d μ i ν j m a 7 f s c k i k j 2 m m 0 m 1 sin k i x m cos k j x m sin π μ i ν j θ d μ i ν j m sin π μ i ν j θ d μ i ν j m where θ m 1 m α with α 2 x 0 m δ x μ i is a natural number defined as μ i k i 2 π m δ x ℕ and v j is in general a real number defined as v j k j 2 π m δ x ℝ the function d p m appearing in the previous expressions is defined as a 8 d p m sin π p m sin π p m with p ℝ the wave numbers k i and k j are respectively the fourier wave number of the fitting model and the assumed wave number of the underlying model this latter in general can be arbitrary and not necessarily linked to the sampling grid the results reported so far are provided assuming that the measurement and fitting is carried out in the space domain however the obtained results can be recast in a form suitable for the dual situation where the measurement and fitting procedure is carried out in time domain in such case it is necessary to interchange space and time as well as wave numbers and wave frequencies in a time domain fitting it shall also be assumed that the fitting frequencies correspond to an orthogonal basis with respect to the measurement domain and that the wave numbers corresponding to the fitting frequencies are determined from the dispersion relation it is worth noticing at this point that in phase resolved propagation methods it is good practice to define the sampling grid in such a way to avoid as much as possible aliasing problems however in general the sampling grid is defined by the sampling resolution of the measuring device and some aliasing is unavoidable in this case the whole fitting and propagation procedure will be affected by aliasing the lepre methodology naturally embeds the fitting model characteristics in its definition and consequently it will provide a prediction error that consistently takes into account the presence of aliasing the elements of the vector q x t in a 1 can now be rewritten as a 9 q 2 j 1 x t i 1 n ζ f c c k i k j cos k i x ω k i t f s c k i k j sin k i x ω k i t cos k j x ω k j t q 2 j x t i 1 n ζ f s c k i k j cos k i x ω k i t f s s k i k j sin k i x ω k i t sin k j x ω k j t however the terms q 2 j 1 x t and q 2 j x t are now in a closed form with respect to the generic arbitrary wave number k j as a result the subscript j can be dropped and the final formulation of the functions f 1 2 k x t and f 2 2 k x t can be written as a 10 f 1 2 k x t i 1 n ζ f c c k i k cos k i x ω k i t f c s k i k sin k i x ω k i t cos k x ω k t 2 f 2 2 k x t i 1 n ζ f s c k i k cos k i x ω k i t f s s k i k sin k i x ω k i t sin k x ω k t 2 the formulation developed so far can be easily extended to the short crested 2d case within the hypothesis that the fitting procedure is carried out using an orthogonal fourier basis the measurement of the wave elevation is assumed to be carried out on an evenly spaced 2d grid of m n points with sampling resolution δ x along the x direction and δ y along the y direction the grid points x m n x m y n t are defined as x m x 0 m δ x with m 0 m 1 and y n y 0 n δ y with n 0 n 1 with x 0 y 0 being the given bias position the corresponding fourier wave numbers considered in their vector form k k x k y t are defined as k x r 2 π r m δ x with the index r taking the values on a convenient subset of the set 0 1 m 2 and k y s 2 π s n δ y with the index s taking the values on 0 1 n 2 the fitting model is then assumed to be based on a set of n ζ wave numbers k i k x i k y i t k 1 k n ζ chosen among the previously defined fourier ones excluding the zero and the nyquist wave numbers in this case the functions f c c f c s f s c f s s presented in equation a 4 to a 7 can be exploited to calculate a set of corresponding functions associated with the 2d case as a 11 g c c k i k j 2 m n n 0 n 1 m 0 m 1 cos k x i x m k y i y n cos k x j x m k y j y n 1 2 f c c k x i k x j f c c k y i k y j f c s k x i k x j f c s k y i k y j f s c k x i k x j f s c k y i k y j f s s k x i k x j f s s k y i k y j a 12 g s s k i k j 2 m n n 0 n 1 m 0 m 1 sin k x i x m k y i y n sin k x j x m k y j y n 1 2 f s s k x i k x j f c c k y i k y j f s c k x i k x j f c s k y i k y j f c s k x i k x j f s c k y i k y j f c c k x i k x j f s s k y i k y j a 13 g c s k i k j 2 m n n 0 n 1 m 0 m 1 cos k x i x m k y i y n sin k x j x m k y j y n 1 2 f c s k x i k x j f c c k y i k y j f c c k x i k x j f c s k y i k y j f s s k x i k x j f s c k y i k y j f s c k x i k x j f s s k y i k y j a 14 g s c k i k j 2 m n n 0 n 1 m 0 m 1 sin k x i x m k y i y n cos k x j x m k y j y n 1 2 f s c k x i k x j f c c k y i k y j f s s k x i k x j f c s k y i k y j f c c k x i k x j f s c k y i k y j f c s k x i k x j f s s k y i k y j similarly to a 10 the index j associated to the frequency in the underlying assumed wave elevation model η can now be dropped so that the functions f 1 2 k x t and f 2 2 k x t for the general short crested 2d case can finally be written as a 15 f 1 2 k x t i 1 n ζ g c c k i k cos k i x ω i t g c s k i k sin k i x ω i t cos k x ω t 2 f 2 2 k x t i 1 n ζ g s c k i k cos k i x ω i t g s s k i k sin k i x ω i t sin k x ω t 2 with ω i ω k i ω ω k 
23271,this paper presents a semi analytical methodology for the determination of prediction error statistics in deterministic sea wave predictions dswp based on linear wave models the underlying wave elevation is modelled as a gaussian stochastic process and the coefficients of the wave propagation model are assumed to be determined by linear fitting on available measurements in time and or space the possible data contamination due to measurement error is also explicitly considered the resulting approach eventually provides a linear estimator of prediction error lepre in time and space in terms of prediction error standard deviation given the fitting procedure and the sea spectrum the presented approach allows supplementing deterministic predictions based on phase resolved linear wave models with a sound prediction error measure and allows defining the concept of predictability region in a consistent probabilistic framework example applications are reported both for long crested and short crested waves with verification through monte carlo simulations single point wave gauge wave buoy measurements as well as wave radar measurements have been considered as simulated examples the developed methodology is also compared with existing approaches highlighting and discussing both the differences and the interesting qualitative commonalities keywords deterministic sea wave prediction dswp predictability region phase resolved wave models prediction error wave radar 1 introduction the nowadays interest about deterministic wave propagation models based on the marine wave radar technology is encouraged by the outlook of possible applications to real time waves and ship motion forecasting the development of early warning guidance and decision support systems based on deterministic prediction procedures could possibly have a positive impact for the safety and operability at sea a main asset in this kind of emerging short term forecasting technology with temporal horizon of the order of minutes and spatial horizon of the order of hundreds meters is the marine wave radar in fact the marine wave radar has been shown to be potentially capable of scanning the sea surface and retrieving the instantaneous images of the nearby wave field in a wide spatial range dankert and rosenthal 2004 nieto borge et al 2004 serafino et al 2011 naaijen and wijaya 2014 it is however to be noted that challenges in modelling of the associated basic electromagnetic backscattering mechanism still require evolutions of this technology to obtain very accurate measurements at least when used to feed deterministic sea wave prediction dswp models the lidar technology has also been explored for the measurement of wave elevation belmont et al 2007 grilli et al 2011 nouguier et al 2014 in principle lidar could be considered as an alternative to wave radar however presently available research on corresponding local wave elevation measurements belmont et al 2007 grilli et al 2011 nouguier et al 2014 indicate a yet too limited spatial extent of the measurement region as a result the application of such technology in case of deterministic predictions in realistic sea states characterised by long waves in open sea becomes difficult nevertheless an extension of the lidar wave measurement range could allow this technology to become a possible alternative to wave radar once wave elevation data are assumed to be available from a suitable wave measurement system a phase resolved propagation procedure can then be applied to perform a deterministic forecasting the procedure is required to be fast if the use is intended for real time applications furthermore it is required to have a prediction time horizon compatible with the operational needs particularly due to computational speed requirements linear deterministic wave propagation models are often preferred hilmer and thornhill 2015 especially for intended uses in real time applications and different aspects of their implementation have been investigated in the past belmont et al 2006 2014 blondel couprie and naaijen 2012 connell et al 2015 naaijen and blondel couprie 2012 naaijen et al 2014 naaijen and huijsmans 2008 linear dswp procedures usually consist of two main steps first in the fitting step fs the wave elevation data are analysed in the measurement domain by means of fourier decomposition techniques either based on the dft morris et al 1998 naaijen and blondel couprie 2012 vettor 2010 or on a least squares approach connell et al 2015 naaijen et al 2009 vettor 2010 afterwards a linear propagation model is defined in the propagation step ps the extensive use of the fft both in the fs and in the ps steps is deeply discussed for short crested sea applications by blondel couprie and naaijen 2012 and naaijen and blondel couprie 2012 different implementations of linear fitting and propagation procedures still based on a fourier analysis are presented by abusedra and belmont 2011 and belmont et al 2006 nonlinear phase resolved wave propagation models have been proposed by several authors e g blondel et al 2010 blondel couprie et al 2013 nouguier et al 2014 wu 2004 zhang et al 1999a b yoon et al 2016 the main issue of these techniques is represented by the costly fitting initialization step in fact in general the measured wave elevation data has to be pre processed before being actually available for the propagation model the pre processing step and its consequent complexity depend mainly on the nature of the available measurement and on the nonlinear model considered the reconstruction of the initial conditions of the nonlinear wave model can require iterative procedures on the measured data zhang et al 1999a b or data assimilation procedures as in wu 2004 blondel et al 2010 blondel couprie et al 2013 or yoon et al 2016 in particular the variational data assimilation procedure proposed by wu 2004 and blondel et al 2010 can be considered as an optimization problem for the initial conditions of the model with cost function defined as a suitable measure of the distance between the wave elevation given by the nonlinear model and the measured wave elevation data also nouguier et al 2014 used the minimization of a cost function representing the average squared difference between measured wave elevation and wave model to be propagated for the identification of the free parameters of the wave propagation model actually such approach in addition of being used for forecasting purposes served also the purpose of wave elevation reconstruction procedure for lidar measurements grilli et al 2011 nouguier et al 2014 a common issue to all dswp methods is related to the need of providing an estimation of the region where the deterministic prediction can be considered to be sufficiently reliable for the intended purposes in fact any dswp procedure is inevitably affected by prediction errors with respect to the true wave elevation which indirectly define the limits of application of this kind of procedures one source of prediction error is the inherent limitation of the assumed propagation model which does not exactly represent the underlying wave elevation field as a result even when a propagation model perfectly fits the true wave elevation at some discrete sampling points in time and or space the predicted or reconstructed wave elevation at different locations in time and or space will differ from the true one in addition in real applications the wave measurements themselves are affected by measurement errors which bring into the problem an additional source of uncertainty an aspect which is often overlooked this means that a key aspect of dswp should be the capability of providing not only an estimation of the predicted wave elevation but also some information regarding the prediction error however although the assessment of the prediction error is crucial for a consistent deterministic wave prediction the problem is rarely addressed specifically in this context the idea of using brute force tools such as massive monte carlo simulations to estimate the expected prediction errors statistics is in general practically unfeasible due to the time consuming computations that eventually will go to detriment of a direct use in real time applications therefore concepts of faster and more direct application are required the most widespread concept related to the prediction performance of dswp approaches is the so called predictability region the predictability region is considered to be the region of space and time where it is considered possible to predict the wave elevation ideally without errors it is therefore originally a binary concept which split the time space domain in a region where the prediction is possible and a region where the prediction is not possible in the past a matter of discussion has been whether to use the group velocity or the phase velocity of the waves for the identification of the predictability region e g abusedra and belmont 2011 edgar et al 2000 morris et al 1998 naaijen et al 2014 wu 2004 for example based on wave propagation considerations morris et al 1998 selected the wave phase velocity for the determination of the region where the propagation of information and the corresponding deterministic prediction can be considered possible see also edgar et al 2000 in case of long crested seas instead wu 2004 used the wave group speed for the determination of the predictability region and further extended the concept to the case of short crested seas according to wu 2004 see also naaijen et al 2014 the predictability region is defined using the group velocity of the fastest and slowest wave components of the considered sea spectrum however abusedra and belmont 2011 have shown that the use of wave group velocity cannot be completely justified and they also challenged those previous justifications for such use which were based on asymptotic stationary phase approximation the concept of predictability region has been further developed by wu 2004 and naaijen et al 2014 with the introduction of the predictability indicator a measure of the prediction capability at a generic point in time and space given the sea spectrum the predictability indicator takes into account the actual shape of the wave spectrum and this represents an advance with respect to the standard predictability region which instead accounts only for the assumed lowest and highest frequency limits of the spectrum naaijen et al 2014 verified the predictability indicator method to be qualitatively consistent with monte carlo simulations for which every realization of the sea states is ideally measured and then propagated to create a reference statistics for ensemble analysis the encouraging results showed by naaijen et al 2014 and the simple formulation of the method makes the predictability indicator an interesting tool for a more advanced and potentially more precise definition of predictability region compared to the original concept however the predictability indicator still lacks a consistent statistical background theory able to provide a clear probabilistic interpretation of the obtained quantitative values it is then useful to make a step forward in the definition of the concept of predictability region with a view to more soundly account for the prediction error from a probabilistic perspective to this end a theoretical approach for providing a consistent probabilistic measure of prediction error for deterministic phase resolved linear wave prediction models is herein presented the approach is based on the description of the sea as a gaussian stationary stochastic process the features of the fitting procedure and of the prediction model are naturally embedded in the formulation furthermore the formulation takes into account in an analytic way the actual shape of the spectrum for long crested and short crested waves on top of this the proposed framework also allows taking consistently into account the possible presence of additional measurement noise the paper is structured as follows first the theoretical background is presented starting from the definition of the fitting model and then providing the definition of the prediction error as a stochastic process the assessment of the ensemble variance of the error process leads to the natural definition of a linear estimator of prediction error lepre which accounts also for the possible contribution of measurement noise a section then follows containing three different simulated verification test cases considering long crested and short crested sea states to show how lepre can be used in identifying the level of prediction error reported results from the application of lepre are verified along with corresponding sets of monte carlo simulations eventually some comparisons with the classical binary predictability region and the predictability indicator by wu 2004 and naaijen et al 2014 are also provided in order to show how the presented lepre compares with existing approaches in order to provide consistent comparisons between simulations and lepre predictions for verification purposes simulated wave fields in all synthetic applications are based on the hypothesis of linear waves the first application is conceived to present an ideal though realistic laboratory experiment where the measurement device used for the propagation step is affected by measurement noise the second application shows details of a comparison between lepre approach monte carlo simulations binary predictability region and prediction error indicator for a simplified bimodal spectrum made of two separated band limited white noise regions in the third and last application the lepre methodology is applied to a more realistic scenario where an offshore structure is considered and the wave elevation used for the propagation model is assumed to be measured by means of a wave radar device following the verifying applications section a specific section is dedicated to a discussion regarding nonlinear effects which are not addressed by the lepre approach also in view of possible future studies on this topic the paper eventually provides some concluding remarks 2 theoretical background as anticipated the scope of this work is to provide a methodology for addressing the so called predictability region in phase resolved wave propagation models from a consistent probabilistic perspective the aim is to provide an approach representing a step forward with respect to the present common practice of identifying a conventionally defined predictability region by means of the loosely defined slowest and fastest components of the sea spectrum see e g blondel et al 2010 blondel couprie and naaijen 2012 naaijen and huijsmans 2008 wu 2004 and with respect to the more advanced yet partially semi empirical predictability indicator naaijen et al 2014 wu 2004 to this end this section presents a methodology for the semi analytical estimation of prediction error when a model for the propagation of the wave elevation field is fitted on a set of data corresponding to measured wave elevation in space and or time the framework presented herein is general and applicable to both long crested and short crested waves with and without presence of measurement error and for generic linear fitting procedures more specific applications are reported in the application section preliminary results for the long crested 1d case in absence of measurement error and using a fourier fitting have been reported by fucile et al 2016b 2 1 linear estimator of prediction error lepre and definition of predictability region it is firstly assumed that the true wave elevation field η x t is a stationary gaussian process for which a single generic realization can be represented as follows 1 η x t i 1 n η a i c i b i s i p η x t α p η x t c 1 s 1 c n η s n η α a 1 b 1 a n η b n η t c i cos k i x ω i t i 1 n η s i sin k i x ω i t i 1 n η p η x t ℝ 1 2 n η α ℝ 2 n η 1 in the expression for the wave elevation η x t k i k x k y t is the wave number vector for the i th harmonic component which is linked to the wave frequency ω i by a suitable dispersion relation in the case of linear waves and infinite water depth ω i g k i the space and time dependent vector p η x t can be referred to as the propagator vector for η see also connell et al 2015 since it propagates the wave elevation field in time and space if the coefficients vector α is known in 1 a finite but sufficiently large number of harmonic components n η is considered while the actual stochastic process is in principle recovered in the limit n η it is also assumed that η x t can be measured at certain points in space x ℝ 2 1 and or time t ℝ and that the measured wave elevation η m x t is associated with a certain measurement error δ η i e 2 η m x t η x t δ η x t the case of measurements without error represents a special case of 2 where δ η x t 0 for all positions and time instants herein the wording measured is used for sake of simplicity although in general the wave elevation can be either measured e g at a wave gauge or wave buoy or estimated e g from the inversion of wave radar images connell et al 2015 dankert and rosenthal 2004 fucile et al 2016a nieto borge et al 2004 wijaya et al 2015 it is now assumed that the true wave elevation is fitted through a phase resolved wave model ζ x t having the following expression similar to that of η x t 3 ζ x t h 1 n ζ a h c h b h s h p ζ x t β p ζ x t c 1 s 1 c n ζ s n ζ β a 1 b 1 a n ζ b n ζ t c h cos k h x ω h t h 1 n ζ s h sin k h x ω h t h 1 n ζ p ζ x t ℝ 1 2 n ζ β ℝ 2 n ζ 1 where in general the harmonic components of ζ x t differ from those of η x t and in addition typically n ζ n η the next assumption is that given a set of n m measurements η m x j t j j 1 n m at different points in space and or time the coefficients vector β can be determined by a linear transformation of the available measurements through an appropriate matrix t m i e 4 β t m η m t m ℝ 2 n ζ n m η m η m x 1 t 1 η m x n m t n m t ℝ n m 1 such an assumption covers at least three important cases the first case is the classical fourier analysis on rectangular grids in which case t m is the dft matrix golub and van loan 2013 the second one is associated with a direct least squares fitting process see connell et al 2015 vettor 2010 in such case the fitting is firstly setup as follows 5 p ζ m β η m with p ζ m p ζ x 1 t 1 p ζ x n m t n m ℝ n m 2 n ζ n m 2 n ζ where p ζ m can be referred to as the propagator matrix connell et al 2015 at the measurement points in time and space and t m is the moore penrose pseudoinverse of p ζ m i e 6 t m p ζ m p ζ m t p ζ m 1 p ζ m t the third case covered by the assumption 4 is the regularised least squares fitting using tikhonov regularisation hansen 1998 vogel 2002 where a solution β is sought such to minimize the following objective function 7 p ζ m β η m 2 λ β 2 in 7 λ is a 2 n ζ 2 n ζ regularisation matrix which is often chosen as λ λ i 2 n ζ 2 n ζ being i 2 n ζ 2 n ζ the 2 n ζ 2 n ζ identity matrix and λ the regularisation parameter in the general case of tikhonov regularisation the matrix t m then becomes 8 t m p ζ m t p ζ m λ t λ 1 p ζ m t it is worth noticing that the classical least squares case is a special case of the tikhonov regularisation while the classical fourier case can also be seen as a special case of both the other two using the model 3 and the assumption 4 the fitted model can be evaluated at any point in space and time as follows 9 ζ f δ x t p ζ x t β p ζ x t t m η m the subscript f δ indicates that the model is using coefficients which have been determined through fitting taking into account the presence of measurement error δ η it is now possible to determine the error between the fitted model and the true wave elevation η x t as follows 10 ε δ x t ζ f δ x t η x t p ζ x t t m η m p η x t α furthermore using 1 and 2 the vector of measured wave elevation can be written as 11 η m η δ η m p η m α δ η m p η m p η x 1 t 1 p η x n m t n m ℝ n m 2 n η δ η m δ η x 1 t 1 δ η x n m t n m t ℝ n m 1 combining 10 and 11 the error ε δ x t can therefore be written as 12 ε δ x t q x t α n x t δ η m with q x t p ζ x t t m p η m p η x t n x t p ζ x t t m q x t ℝ 1 2 n η n x t ℝ 1 n m from the first equation in 12 it can be seen that the error ε δ x t is due to two sources the first term q x t α represents the error due to the fact that the fitted model in general differs from the actual process the second term n x t δ η m represents the propagation of the measurement error through the fitted model both error sources also embed the effect of the fitting procedure it is now worth noticing that the error ε δ x t as obtained in 12 is a linear function of the amplitudes of the harmonic components of the true wave elevation η x t furthermore taking into account the fact that η x t is actually a stochastic process and the fact that δ η m is a random vector the error ε δ x t can be interpreted as a stochastic process in all the following considerations the set of n m measurement points is assumed to be deterministically fixed in the ensemble domain i e across multiple realizations furthermore it is assumed that other possible fitting parameters e g the regularisation matrix λ in 8 are also deterministically fixed these two latter assumptions mean that the matrices t m and p η m are deterministic matrices as a result such assumptions allow to consider q x t and n x t in 12 as deterministic functions of space and time by using the assumption that η x t is a discretised linear gaussian process similarly to the one dimensional case tucker et al 1984 the amplitudes a i and b i of the harmonic components are considered as zero mean independent gaussian variables they are linked to the single side directional wave energy spectrum s η k i as follows 13 a i n 0 σ i 2 b i n 0 σ i 2 σ i 2 s η k i δ k x i δ k y i c o v a i a j 0 i j σ i 2 i j c o v b i b j 0 i j σ i 2 i j c o v a i b j 0 i j where n 0 σ i 2 indicates a normal distribution with zero mean and variance σ i 2 δ k x i and δ k y i are wave number intervals associated with the assumed discretization of the spectrum s η k i in n η wave components and c o v indicates the covariance operator according to 13 the wave amplitudes vector α is a zero mean gaussian random vector with diagonal covariance matrix that is 14 μ α e α 0 c α α e α μ α α μ α t σ 1 2 0 0 0 0 σ 1 2 0 0 0 0 σ n η 2 0 0 0 0 σ n η 2 d i a g σ 1 2 σ 1 2 σ n η 2 σ n η 2 where e is the expected value operator in addition it is assumed that the measurement error δ η x t is a zero mean gaussian process and that it is independent of η as a consequence given the specific set of n m measurement points in space and or time the vector δ η m is a zero mean gaussian vector with a given covariance matrix depending on the assumed measurement error characteristics i e 15 μ δ η m e δ η m 0 c δ η m δ η m e δ η m μ δ η m δ η m μ δ η m t by using 12 14 and 15 the assumption that δ η x t is independent of η and recalling that from the considered assumptions q x t and n x t are deterministic vector functions it is now possible to provide a full probabilistic characterization of the prediction error ε δ x t in fact from 12 it follows that ε δ x t is a gaussian process since it is a linear combination of random gaussian vectors furthermore the mean and the variance of ε δ x t can be determined as follows 16 e ε δ x t 0 v a r ε δ x t σ ε δ 2 x t q x t c α α q t x t n x t c δ η m δ η m n t x t where e is the expected value operator v a r is the variance operator and σ ε δ 2 x t is the variance of the prediction error at x t from the considered assumptions it follows that the prediction error has zero mean in addition similarly to what was noticed when commenting 12 it can be noticed that also in 16 the variance of the prediction error is composed of two terms the first term is associated with the inherent difference between the fitted model and the true process while the second term represents the effect of the measurement error if it is assumed that the measurement errors δ η at two different points in time and space are independent actually it is sufficient they are uncorrelated then the covariance matrix c δ η m δ η m becomes diagonal 17 c δ η m δ η m σ δ η 2 x 1 t 1 0 0 0 σ δ η 2 x 2 t 2 0 0 0 σ δ η 2 x n m t n m the generic term σ δ η 2 x j t j with j 1 n m represents the measurement error variance at point x j in space and at time t j if in addition it is assumed that the measurement error is a uniform noise with variance σ δ η 2 then the covariance matrix c δ η m δ η m simplifies to 18 c δ η m δ η m σ δ η 2 i n m n m making use of the fact that the covariance matrix c α α is diagonal and if it is assumed that c δ η m δ η m is also diagonal and by using 13 the expression for the variance of the prediction error can be simplified to 19 σ ε δ 2 x t i 1 n η q 2 i 1 2 x t q 2 i 2 x t σ i 2 j 1 n m n j 2 x t σ δ η 2 x j t j i 1 n η q 2 i 1 2 x t q 2 i 2 x t s η k i δ k x i δ k y i j 1 n m n j 2 x t σ δ η 2 x j t j each term in the first summation in 19 represents the contribution to the prediction error variance at x t coming from the spectral energy around the wave number vector k i each term in the second summation in 19 represents instead the contribution to the prediction error variance at x t coming from the measurement error at the measurement point x j t j in the limit the number of harmonics assumed in the model of η x t increases towards infinity n η the first term in 19 tends to an integral involving the spectrum of η and the variance of the prediction error can be rewritten as 20 σ ε δ 2 x t f 1 2 k x t f 2 2 k x t s η k d k x d k y j 1 n m n j 2 x t σ δ η 2 x j t j where f 1 2 k x t and f 2 2 k x t are functions depending on the fitting procedure it is important at this point to underline that the single side energy spectrum s η k appearing in 19 and 20 is the spectrum of the true wave elevation η and it must not be confused with the spectrum assuming it could be consistently defined of the measured wave elevation in fact the measured wave elevation is contaminated in general by the effect of the measurement error process for a realistic measurement the assumption of diagonal covariance matrix c δ η m δ η m may be considered as a reasonable or at least convenient approximation when measurement points are sufficiently far each other in space and time however in the general case the matrix c δ η m δ η m cannot be assumed to be diagonal in fact it is expectable that there may be a correlation in time and space between measurement error at different points particularly when such measurement points are close in space or time in essence the covariance matrix c δ η m δ η m provides a probabilistic characterization of the measurement error for the assumed measurement system although the specification of such a matrix is expected to be a complex problem in the general case when c δ η m δ η m is not diagonal equations 19 and 20 keep their more general form which is based only on the fact that c α α is always diagonal i e 21 σ ε δ 2 x t i 1 n η q 2 i 1 2 x t q 2 i 2 x t s η k i δ k x i δ k y i n x t c δ η m δ η m n t x t σ ε δ 2 x t f 1 2 k x t f 2 2 k x t s η k d k x d k y n x t c δ η m δ η m n t x t a closed form analytical formulation for the functions f 1 2 k x t and f 2 2 k x t is difficult to derive in the general case for it depends on the fitting model as it has to embed the solution step in 4 however some specific consideration can be given to the case where the fitting model is derived from a discrete fourier transform dft approach in fact choosing a suitable orthogonal basis in the sense of dft possibly accounting only for a subset of allowed fourier frequencies the calculation of the t m matrix and of the product t m p η m can be carried out analytically leading eventually to analytical expressions for the resulting functions f 1 2 k x t and f 2 2 k x t further details about the calculation of the functions f 1 2 k x t and f 2 2 k x t in such special case are provided in the appendix moreover it is worth to mention that once specified the fitting model completely defines the matrix t m that consequently will remain a constant quantity of the problem the majority of the computational burden is then limited to the calculation of the matrix t m at the beginning of the procedure while other quantities can then be easily calculated afterwards the linear estimator of prediction error lepre in 19 21 or its continuous version 20 21 can now be used for providing a sound definition of predictability region in fact being ε δ x t a zero mean gaussian process in space and time it is completely characterised for each single point x t by its variance the predictability region can therefore be defined as that region π in time and space where the variance of the prediction error is sufficiently small given a threshold τ ε for the standard deviation of the prediction error the predictability region can then be defined as 22 π τ ε x t σ ε δ 2 x t τ ε 2 it can be noticed that in the probabilistic framework developed herein there is no single predictability region and the predictability region depends on which level of prediction error is considered to be acceptable through the specification of the threshold τ ε a similar definition of predictability region was also considered by naaijen et al 2014 although they based their definition on a threshold level for the predictability indicator 2 2 implementation and usage expression 19 20 or the more general forms 21 can be used in deterministic phase resolved wave predictions to supplement the prediction of wave elevation along with an estimation of the prediction error associated with the specific fitting and prediction procedure to this end in general a fitting model 3 is firstly chosen and this corresponds to the definition of a certain set of wave number vectors k h h 1 n ζ then it is necessary to define the set of n m points in time and or space which are used for the fitting of the propagation model according to the decided fitting procedure to further proceed it is necessary to know or at least to have an as good as possible estimation of the sea elevation spectrum s η k in some applications such as laboratory experiments or numerical simulations the spectrum s η k is known with sufficient accuracy however in applications at sea the estimation of s η k can be a critical issue depending on the specific application methods based on wave radar processing nieto borge et al 2004 wave buoys or ship as a wave buoy e g mas soler et al 2018 tannuri et al 2012 can be exploited to estimate s η k it is however crucial that the estimator of the true wave elevation spectrum s η k is depurated as much as possible from the effects of measurement error in this respect if the measurement error is assumed to have a flat spectrum s δ η additive to s η k it follows that the spectrum of the measured wave elevation becomes s δ η s η k in such case the analysis of very low and very high wave number regions could be used to estimate the contamination s δ η which should then be removed from the spectrum of the measured wave elevation to get eventually the depurated estimation of s η k another step for the application of the proposed methodology is the definition of a modelling for the covariance matrix of the error in the measurement of the wave elevation see 15 in case a flat spectral noise level s δ η is determined the variance of the measurement error can be obtained from the integration of s δ η over the region of k up to nyquist limits from the fourier analysis alternatively the measurement error can be defined for instance from the knowledge of the measurement system being it e g a wave gauge a wave buoy or a wave radar as appropriate other application specific methods can of course also be used from the description above almost all the major information would be available at this stage however in order to determine an estimator of σ ε δ 2 x t it is necessary to make some additional assumption regarding the process η x t if the fitting procedure is such that analytical expressions for the functions f 1 2 k x t and f 2 2 k x t can be determined then expression 20 or its general form in 21 can be directly used combined with a suitable numerical integration procedure alternatively the discrete formulation 19 or its general form in 21 can be directly used in the general case however when using 19 21 it is necessary to specify a certain number of harmonic components n η which are assumed to represent the underlying unknown stochastic process η x t in order for η x t to be a sufficiently good approximation of the true underlying sea elevation gaussian process n η should be sufficiently large from application it has been noticed that when the number of components n η is sufficiently large and in particular sufficiently larger than the number of components n ζ used for the fitted model the behaviour of σ ε δ 2 x t converges sufficiently for practical purposes to the value which would be obtained with n η this is expectable since part of σ ε δ 2 x t represents the prediction error for ζ x t which loosely speaking is associated with an insufficient frequency resolution in ζ x t to resolve all the components of η x t the wording all is in quotation marks since in reality η x t as a stochastic process has infinite harmonic components of infinitesimal amplitude this convergence can also be understood from a numerical perspective when 19 21 is considered as a discretised version of the integral in 20 21 the drawback of using the discrete formulation 19 21 is that an increase of n η tends to increase the dimensions of some of the matrices involved in the calculations with a consequent increase of memory consumption and computational time in order for the procedure to be practically viable with present resources it is necessary to find a trade off for n η such that it has a sufficiently large value to have a sufficiently good converged estimation of σ ε δ 2 x t but without exceeding the available computational time and resources it is nevertheless to be noted that the problem of memory consumption can be practically solved by calculating the functions q 2 i 1 2 x t q 2 i 2 x t in 19 21 or f 1 2 k x t f 2 2 k x t in 20 21 separately for each generic wave number k and then respectively performing the summation in 19 21 or applying usual numerical integration methods for calculating the integral in 20 21 with all data available σ ε δ 2 x t can then be estimated in a suitable range of space and or time this allows first to supplement the prediction ζ x t with an associated gaussian confidence interval based on σ ε δ x t furthermore given a limit threshold level τ ε the predictability region π τ ε can eventually be determined in accordance with 22 it is also to be noted that the possibility of estimating σ ε δ 2 x t allows in addition to devise optimum prediction strategies and or fitting and prediction setups in order to provide wave elevation predictions with minimum smaller confidence bounds 3 verification through simulated applications three simulated applications exploiting the described lepre methodology are herein reported as examples the first two applications are simplified long crested sea cases and they are used to show and discuss the main characteristics and capabilities of the lepre methodology in the third application a more realistic scenario dealing with the prediction of water wave elevation in short crested sea is investigated the considered applications are meant to verify the developed lepre approach and as a result they are based on the same main assumptions on which the lepre approach is based such applications are therefore not to be considered as full validations of the method in fact a full validation exercise would require comparisons with experimental data or as an alternative a comparison with data based on nonlinear wave field simulations see e g blondel couprie et al 2013 such a validation process is considered to be part of future development activities the first application presents a simulated laboratory experiment where the wave elevation is assumed to be produced by a wave maker the purpose of this application is to set up a controlled and yet realistic environment where to test the lepre methodology dealing also with the effects of measurement error noise the main results are then verified with respect to a set of monte carlo simulations and the effect of the measurement noise is discussed the second application has been conceived to show how the lepre methodology compares with respect to the predictability region wu 2004 and predictability indicator wu 2004 naaijen et al 2014 techniques in the case of a simplified archetypal strongly bimodal spectrum the considered simplified spectrum is used for comparison and description purposes in order to emphasize the effects which might appear less evidently in a smoother realistic wind waves plus swell bimodal case in the last simulated application the lepre methodology is applied to a more realistic scenario where an offshore structure is considered and the wave elevation used for the propagation model is assumed to be measured by means of a wave radar device although the wave radar inversion problem and related errors are out of the scope of this work on this topic see e g fucile et al 2016a who compared the performance of radar inversion based on the modulation transfer function mtf technique with those of a least squares technique using tikhonov regularisation the main quantities involved in the fitting and propagation process are chosen to be representative of a realistic scenario involving wave radar measurement the lepre methodology is used to provide the standard deviation of prediction error for the propagated wave elevation process different spreading angles are considered and the corresponding effect on the wave elevation prediction error is discussed results are then verified against a corresponding set of monte carlo simulations 3 1 simulated laboratory experiments with wave gauge measurement seakeeping experiments may require measuring the wave elevation at particular locations along the wave tank or at the tested model surroundings in some cases a direct instrumental measurement may be prevented by the presence of obstacles like the tested model itself or the setup of the wave probes can turn out to be particularly inconvenient a possible solution is to measure the wave elevation at suitable distance upstream from the points of interest and then derive an indirect measure of the undisturbed wave elevation where this information is needed this kind of reconstruction process will eventually be affected by errors and therefore it must be supplemented with a sound error analysis if the measurement error is assumed to be uncorrelated which is the case assumed in this example then the lepre methodology can be applied to this scenario in its definition 19 or 20 which allows dealing with deterministic predictions in presence of measurement noise the complete forms 21 could in principle be applied if a general possibly non diagonal covariance matrix c δ η m δ η m for the measurement error is available for this example application a wave probe is assumed to be placed in the middle of a wave tank with depth d t 3 8 m see fig 1 the indirectly reconstructed wave elevation is required at two downstream probing points at distance d 1 3 0 m and d 2 6 0 m from the measuring wave probe according to 19 20 the lepre methodology requires the knowledge of the wave spectrum s η in general the true wave spectrum is unknown and it has to be assessed from the wave measurement however for sake of simplicity in this case the nominal spectrum is assumed to be known since it is a typical input for the experimental wave generation in particular the spectrum considered in this example is a jonswap spectrum with peak period t p 9 30 s corresponding to peak spectral frequency ω p 0 676 r a d s and peak enhancement factor γ 3 3 it is assumed that this spectrum is realized in the experimental laboratory at a model scale λ 50 at this scale which is the one at which results presented in this section are reported the peak period of the spectrum is 1 32s the wave probe measurements are considered to be affected by gaussian random noise with a standard deviation proportional to the significant wave height h s two different levels of noise are considered namely σ n 0 02 h s and σ n 0 10 h s accounting for the linearity of the approach all results reported hereinafter for this example are normalized by the significant wave height they can therefore be considered to represent outcomes per unitary h s within the limits of the linearity assumption the characteristics of the fitting model are defined by the recording time window assumed to have a length t m 10 t p and the wave probe sampling frequency assumed to be 50 hz corresponding to δ t 0 02 s with the considered time step the measurement is then defined to start at t 0 s and to finish at t t m 13 14 s 10 t p the fitting propagation model is based on dft analysis the selected fourier frequencies used for fitting model are ω j j 2 π n m δ t with j 1 n m 2 1 where n m 658 thus zero and nyquist wave frequencies are not taken into account in the calculations for the propagation model the finite depth dispersion relation ω j g k j tanh k j d t has been used with d t being the wave tank depth results from the lepre methodology are verified against a set of 500 monte carlo realizations and a 95 confidence interval is provided to account for sampling uncertainty of monte carlo simulations realizations of wave elevation have been generated following tucker et al 1984 using a total of 1026 harmonic components in the range of wave frequencies 0 3 ω p ω 3 ω p the error standard deviation σ ε δ is presented in non dimensional form i e by normalization with respect to h s first fig 2 reports the reconstruction of the wave elevation normalized by h s for four different random realizations of the considered sea state at the probe location x d 1 3 m with x 0 at the measuring wave probe and with the measurement noise level σ n 0 02 h s the true wave elevation is also reported the lepre methodology is used to provide the reconstructed wave elevation with an error bound 2 σ ε δ corresponding approximately to the 95 confidence interval the exact 95 confidence interval would correspond to 1 96 σ ε δ it is possible to note that there is a time interval where the reconstructed wave elevation matches particularly well the true wave elevation and this time window is independent of the realization assuming a conventional threshold level σ ε δ 0 05 h s a predictability time window can therefore be defined on the basis of the lepre prediction error standard deviation in the context of this specific example the prediction error is to be intended as a reconstruction error and the predictability time window is to be intended as the region of time where the reconstruction error is sufficiently small at a particular location such time window is indicated in fig 2 it can be noticed that consistently for all the reported realizations within the defined predictability time window the reconstructed wave elevation well reproduces the true wave elevation whereas outside it tends to deviate it is important to underline that as described before it is herein assumed that measurement are taken at the wave probe for a time interval t m e a s 0 s t m 13 14 s at model scale it therefore means that for the probe location at x d 1 3 m in fig 2 the best reconstruction is obtained for time instants before the end of the measurement instant while this is not an acceptable situation in case of a forecasting application in the case of the present example this is not posing any problem because the scope herein is to provide an a posteriori not real time reconstruction of the wave elevation field fig 3 and fig 4 show the time history of the prediction error standard deviation as calculated at the two probe locations for the two considered levels of noise furthermore the optimal time delay δ t o p t is also identified and highlighted this is the time delay from the beginning of the measurement window at which the standard deviation of prediction error σ ε δ shows its minimum for the considered probe location this information could be useful in devising optimum reconstruction strategies based on the minimization of the prediction error lepre results in figs 3 and 4 are almost indistinguishable from monte carlo simulations and clearly within the confidence interval indicating that the lepre methodology has been properly implemented looking at figs 3 and 4 it can be seen how the distance from the measurement wave probe changes the behaviour of σ ε δ with the region of minimum error shifting forward in time and higher in value as the reconstruction point is farther from the measurement probe in the direction of wave propagation a comparison between results of figs 3 and 4 indicates that as the noise level increases the prediction error standard deviation tends to show a flattening of the region of minimum error however at least for the two tested cases characterised by small and moderate noise levels the optimal time δ t o p t is independent of the noise level and it only depends on the probe location it is worth underlining that in case of the location at x d 1 3 m the optimum reconstruction time occurs before the end of the measurement time window whereas the opposite occurs for the farther probe at x d 2 6 m fig 5 and fig 6 provide a wider picture by showing the space time error maps for both the noise levels using the lepre methodology in the figures the locations of the probe are highlighted with vertical red lines and the points of corresponding minimum prediction error standard deviation are also indicated by a circular yellow symbol the comparison of the two maps shows that the lepre methodology consistently accounts for the presence of higher measurement noise the increase of the noise level causes an increase of the values of σ ε δ in the whole space time domain in addition to the analysis of the wave reconstruction at locations different from the wave measurement probe it is also interesting to provide some more information regarding the measurement position itself data regarding the prediction error at the measurement location can be obtained directly from figs 5 and 6 however it is worth providing some more specific detail showing the peculiar behaviour of the quantities of interest at the measurement point to this end fig 7 shows the reconstruction of the wave elevation normalized by h s for four different random realizations of the considered sea state at the measuring wave probe for the case with the measurement noise level of σ n 0 02 h s this figure is to be compared with fig 2 from fig 7 it can be seen that at the measurement location the model ζ x 0 t fits the wave elevation within the measurement time window 0 t m as expected by the described fitting and propagation procedure as a result in the measurement time window the difference between the true wave elevation η x 0 t and the model ζ x 0 t is basically due to the considered measurement noise however for time instants after the end of the measurement time window the model ζ x 0 t loses its prediction capabilities as it is expectable this is clearly represented by the time dependence of the normalized prediction error standard deviation at the wave measurement location as reported in fig 8 to be compared with fig 3 which shows a characteristic jump at t t m this sudden increase of the prediction error standard deviation corresponds to the sharp widening of confidence intervals in fig 7 it can be noted that also for this location results from the application of lepre are verified by the monte carlo simulations it is finally worth underlining that results obtained in this section are in line with those obtained by naaijen et al 2014 who carried out deterministic sea wave predictions and corresponding prediction error analyses through simulations and experiments in conditions that are qualitatively similar to those used in the simulated example reported herein 3 2 simulated long crested bimodal sea this example considers the application of lepre methodology in case of a simplified idealised bimodal spectrum the main aim is to establish a simple archetypal scenario able to highlight the common behaviours and the main differences between the lepre methodology the binary predictability region wu 2004 and the predictability indicator naaijen et al 2014 wu 2004 techniques the details of these two techniques are not reported herein and major details can be found in wu 2004 and naaijen et al 2014 more precisely in this example case results from the lepre methodology are compared with the quantity 1 p where p is the predictability indicator from wu 2004 and naaijen et al 2014 by borrowing the nomenclature from naaijen et al 2014 1 p is referred to as prediction error indicator although strictly speaking this name was used by naaijen et al 2014 for the quantity 1 p for verification purposes all results are also compared against a set of 500 monte carlo realizations realizations of wave elevation have been generated following tucker et al 1984 using a total of 2000 harmonic components in the range of frequencies identified by the nonzero values of the bi modal spectrum i e 1000 harmonic components within each of the two spectral bands the two bimodal spectra used for this application are reported in fig 9 each spectrum is designed as the sum of two simple band limited flat spectra with a narrow bandwidth b w 0 1 k 0 and with symmetric peaks separated by δ k 0 25 0 75 k 0 from the central reference wave number k 0 2 π λ 0 1 m the corresponding reference period is t 0 2 π ω 0 and the reference wave frequency in deep water is ω 0 g k 0 with g the gravitational acceleration these spectra represent an interesting benchmark for a comparison with the predictability region and predictability indicator in fact the predictability region approach takes into account only the fastest and lowest component of the spectrum without accounting for the actual spectral shape basing the identification of the predictability region on the assumption of using the group velocity as reference speed on the other hand the predictability indicator approach although still using the group velocity as reference speed for the computations is able to take into account the actual spectral shape finally the lepre approach accounts in an analytic way for all the features of the fitting procedure and for the exact spectral shape of the underlying wave elevation process without any additional semi empirical assumption the fitting is carried out in the space domain on a measurement region of length l m 13 λ 0 with sampling interval δ x λ 0 15 the measurement interval is 0 x λ 0 13 the fitting propagation model is defined on the basis of dft analysis the fourier wave numbers selected for the fitting model are k j j 2 π n m δ x with j 1 n m 2 1 with n m 196 thus zero and nyquist wave frequencies are not taken into account in the calculations for the propagation model the infinite depth dispersion relation ω j g k j has been used results from the application of the different methodologies are reported in fig 10 where surfaces of σ ε x t h s 2 2 are shown since in this case no measurement error is considered the standard deviation of prediction error is indicated as σ ε instead of σ ε δ it can be noticed that there is an overall qualitative consistency among the different methodologies the region where the lepre approach shows small values of prediction error standard deviation are in line with the identified predictability region according to wu 2004 and are also in line with the regions where the prediction error indicator according to naaijen et al 2014 is small furthermore the outcomes from the lepre methodology are fully verified by the comparison with monte carlo simulations as the two methods show almost indistinguishable prediction error maps it can be noticed that all methods agree in identifying a reduction of the minimum error region when the bimodal spectrum is characterised by a wider separation between the two bands which corresponds to the presence of wave components with very different group speeds the presence of traces in the time space map associated with the different speeds of the components belonging to the two bands is quite evident particularly in case of δ k 0 75 k 0 however a closer look to results shows how the lepre method provides much more information on the prediction error in terms of error pattern thanks to its capability of implicitly embedding the exact characteristics of the fitting model as well as the exact spectral characteristics of the underlying wave elevation process it is also worth recalling that in the limit of the underlying assumptions the lepre formulation stems directly from exact statistical considerations and it therefore provides clear and unambiguous information about the expected prediction error on the other hand the prediction error indicator and the predictability region while qualitatively enabling the identification of regions with small prediction errors they lack a direct relation with a statistical description of the error however from the reported comparison the high level of qualitative agreement between the prediction error indicator and the lepre methodology is evident this suggests the possibility of identifying some underlying semi empirical relation between the two approaches and provides a sort of justification to the assumptions used in the determination of the prediction error indicator at least for the considered fitting procedure setup and for the selected spectral shape 3 3 simulated short crested sea with wave radar sensing in this case the lepre methodology is applied to a realistic scenario where the wave elevation is predicted on the basis of the assumed availability of wave radar measurements fig 11 presents the overall scheme of the problem where a wave radar on an offshore structure scans the nearby sea surface the wave elevation signal is considered to be measured in an annular domain defined by a maximum radar range r 3000 m and limited by a proximity blind range r 250 m the notional wave radar imaging bounds are considered to be representative of a usual wave radar measurement for sake of simplicity the wave radar is assumed to provide a reconstruction of the instantaneous wave field on the whole domain without errors accordingly and similarly to the previous example application the prediction error standard deviation is indicated as σ ε and not as σ ε δ the fitting procedure is carried out on a square sub domain of the sensing region with dimensions l x l y 1800 m as reported in fig 11 and the wave elevation signal is sampled on an evenly spaced grid with spacing δ x δ y 10 m which is a typical wave radar resolution as observed by blondel couprie and naaijen 2012 the propagation model based on the dft fitting of an instantaneous wave radar image is particularly sensitive to misinterpretation of the correct propagation direction of the wave components because of lack of information in time domain and because of leakage effects this leads to an incorrect propagation of waves and is in general detrimental to a correct prediction of the wave field in this work the problem has been dealt with by defining the wave numbers used in the fitting and propagation model to belong to the same quadrant of the main propagation direction of the waves so to have k x k y 0 blondel couprie and naaijen 2012 this assumption basically corresponds to the implementation in the fitting model of specific information regarding the directional wave spectrum and the lepre methodology can directly handle this sort of situation a grid of n x n y points with n x n y 181 is used for the chosen domain the time instant of the measurement is conventionally set to t 0 s the fitting propagation model is defined on the basis of dft analysis the selected fourier wave numbers for the fitting model are defined in vector form as k i j k x i k y j t with k x i i 2 π n x δ x and k y j j 2 π n y δ y with i 0 n x 1 2 and j 0 n y 1 2 the zero wave number k k x 0 k y 0 is excluded from the calculations for the propagation model the infinite depth dispersion relation has been used so that the wave frequency is calculated as ω i j g k i j and k i j k x i 2 k y j 2 a jonswap wave elevation spectrum with significant wave height h s 3 m peak period t p 12 s corresponding to peak spectral frequency ω p 0 524 r a d s and peak enhancement factor γ 3 3 is considered in this case the directional wave spectrum s k θ is defined by using a multiplicative cosine squared spreading function d θ as follows 23 s k θ s k d θ d θ 2 θ s p r e a d cos 2 π θ χ θ s p r e a d θ χ θ s p r e a d 2 χ θ s p r e a d 2 where θ s p r e a d is the spreading angle and χ is the main propagation direction different spreading angles are considered namely θ s p r e a d 30 60 90 deg while the main propagation direction is kept constant to χ 45 deg an example of directional spectrum is presented in fig 12 the lepre approach is used here to determine the prediction error standard deviation associated with the assumed fitting and propagation scheme the determination of the prediction error standard deviation allows also to define on the one hand an optimum time delay for the prediction as discussed before and on the other hand a predictability region given a specified threshold value τ ε see 22 in the following examples a conventional value τ ε 0 05 h s is used reported results are also verified against a set of 100 monte carlo realizations for the case with θ s p r e a d 30 deg which have been analysed in ensemble domain providing estimated expected values and 95 confidence intervals for the prediction error standard deviation realizations of wave elevation have been generated by discretizing the spectrum and using random amplitude and phase of each component the random amplitudes were generated using the local energy of the spectrum i e the local integral of the spectrum associated to each wave component in accordance with what tucker et al 1984 detailed for the long crested sea case a total of 3 4 10 5 harmonic components were used in the range of wave frequencies 0 25 ω p ω 2 5 ω p and in the range of directions 30 deg θ 60 deg see the spreading function d θ in 23 fig 13 shows the comparison of normalized prediction error standard deviation between monte carlo simulation and lepre results at the offshore structure location it is noted that the coordinates reported in fig 13 and in the subsequent figures are referenced to the lower left corner of the sensing sub domain shown in fig 11 and therefore the structure is placed at coordinates x y 2000 m the very good matching between lepre results and monte carlo simulations taking into account the sampling uncertainty reflected by confidence intervals verifies the implementation of lepre also for short crested sea applications similarly to the previously reported examples the time history of the normalized prediction error standard deviation shows a minimum which allows to identify the optimal time delay for a deterministic prediction to be carried out in the considered situation fitting region fitting model and sea spectrum furthermore given the considered situation the behaviour of the prediction error allows also to define the predictability region here in the form of a predictability time window this time window corresponds to the time interval during which the prediction error standard deviation is below the defined threshold τ ε 0 05 h s i e the time window in the future within which the prediction error is considered to be acceptable according to the threshold limit from a probabilistic perspective fig 14 presents the lepre results again at the offshore structure location as obtained for different spreading angles θ s p r e a d 30 60 90 d e g results indicate an increase of prediction error standard deviation as the spreading angle increases in the specific case of θ s p r e a d 90 d e g the prediction error standard deviation of the propagation model fails to drop below the specified although notional acceptable threshold limit requirements this indicates that in some cases a predictability region could not exist and this should be taken as an indication about the need of improving the fitting model and or changing the measurement region finally fig 15 to fig 19 provide maps of the normalized prediction error standard deviation in the space region surrounding the offshore structure for different time instants being t 0 s the instant when the fitting of the propagation model takes place normalization in this case is carried out using the normalization factor h s 2 2 results from monte carlo simulations are also reported as verification of the lepre predictions showing that considering the natural sampling uncertainty from monte carlo simulations the lepre implementation can be considered to be verified looking at figs 15 19 as time evolution of the surface of normalized σ ε x t it can be noticed that the region of minimum of the surface i e the region of better prediction from a probabilistic perspective while modifying its shape in time propagates along the main wave propagation direction a smoothing of the edges regions of large gradients of the surface can also be noted as the time increase particularly when comparing fig 15 and fig 16 4 some considerations regarding nonlinear effects the scope of the lepre methodology presented herein is to provide a fast tool for supplementing dswp with a related estimation of the prediction error characteristics in order to derive a formulation for prediction error statistics the lepre methodology uses assumptions that are consistent with a linear dswp framework as reported in the introduction the choice of linear dswp models is usually justified in light of computational efficiency and robustness although in principle it is pertinent only to those situations where wave field nonlinearities are negligible nonetheless even when nonlinear dswp models are considered and nonlinear wave contributions are explicitly accounted for linear tools are still used to provide relevant though approximate indications for the higher order models e g blondel et al 2010 blondel couprie et al 2013 grilli et al 2011 nouguier et al 2014 wu 2004 in this respect the lepre methodology by redefining some key aspects of the linear dswp framework represents a step forward compared to existing linear approaches modelling the evolution of a water wave field simulating its interaction with the environment and catching transient and highly nonlinear water wave phenomena is generally acknowledged as a difficult task it is therefore not surprising that embedding such complexity within fast and efficient dswp models still represents a prohibitive challenge hence in the dswp framework some of the most complex nonlinear aspects of the wave dynamics such as wave breaking or interaction with arbitrary bottom topography are seldom considered or only partially addressed wu 2004 however major efforts are done in modelling some of the peculiar nonlinear features of a propagating wave train such as bound waves nonlinear dispersion relation or even multiple resonant waves interaction by using more or less refined nonlinear or weakly nonlinear models among them the most relevant to dswp are related to the role of the bound waves for a correct modelling of the wave profile and to the nonlinear effects on the dispersion relation for the correct wave propagation blondel et al 2010 blondel couprie et al 2013 the former aspect is associated with second and higher order nonlinear effects i e bound waves leading de facto to a departure from the gaussianity of the wave elevation field e g fedele et al 2017 nouguier et al 2009 tayfun and fedele 2007 the modification of the dispersion relation is due to effects arising at least at the third order the number of studies regarding deterministic sea wave predictions based on nonlinear wave models are however not numerous zhang et al 1999a b developed and successfully applied a directional hybrid wave model based on second order approach for deterministic sea wave predictions but they did not compare the outcomes against linear ones wu 2004 studied deterministic sea wave forecasting considering a multi level approach based on a first order linear model a second order model with possibility of accounting for nonlinear dispersion relation and a nonlinear hos model with possible arbitrary order of nonlinearly the last one was also supplemented with a filtering technique aimed to overcome the problems related to the inception of wave breaking and spilling breakers the analysis by wu 2004 highlighted the importance of considering nonlinear effects in case of large significant wave steepnesses whereas the linear model was shown to provide good results in case of milder sea states in general for severe sea states the study by wu 2004 highlighted the importance of considering the nonlinear wave dispersion relation and showed that the use of nonlinear prediction models tend to improve the predictions at the cost however of an increased computational time wu 2004 also highlighted that wave wave interaction effects become more relevant for wave evolutions on long time horizons referring to wu 2004 blondel et al 2010 carried out a numerical study associated with deterministic sea wave predictions for unidirectional irregular waves they compared the prediction capabilities of first order wave model pure second order wave model second order wave model enhanced with a third order nonlinear dispersion relation and a third order wave model based on hos for small significant wave steepenesses the first order linear model provided results comparable with nonlinear models at larger significant wave steepness the relative prediction error by all models increased as well indicating the effect of nonlinearities in a fully linear framework the magnitude of the relative prediction error for a given spectral shape is independent of the significant wave height the comparison between prediction capabilities from different models showed that nonlinear models performed better as the significant wave steepness increased interestingly the first order and the second order model performed quite similarly whereas an improvement of the prediction performances was much more noticeable when using the enhanced second order model and even further when using the hos third order model this indicates the importance of a modified nonlinear dispersion relation in particular the comparison between the predicted and the target wave elevation showed a reasonably good agreement of the wave profile for all models but the first order and the second order model showed a systematic phase shift indicating the effect of the nonlinear dispersion relation terms generally wave peaks and troughs were better reproduced by the second order model this showing a beneficial effect of considering bound waves and wave wave interactions terms however first order and second order model performed very similarly a subsequent study by blondel couprie et al 2013 provided an experimental confirmation of the trends observed by blondel et al 2010 on the basis of long crested irregular waves experiments nouguier et al 2014 referring to synthetic lidar data studied a reconstruction and forecasting approach see also grilli et al 2011 based on a linear wave model and on a nonlinear lagrangian choppy wave model nouguier et al 2009 both linear and nonlinear model provided similar reconstruction performance but the nonlinear model showed better forecasting capabilities the highlighted nonlinear effects cannot be directly accounted for by the proposed lepre methodology indeed the lepre approach is essentially linear and gaussian it is therefore representative for describing the free waves contribution an important characteristic of the lepre approach is that according to the linearity assumption the harmonics of the single wave components of the underlying wave field are assumed to be statistically independent random variables in ensemble domain the introduction of bound waves and wave wave interactions would break this assumption because the amplitudes of nonlinearly generated wave components would deterministically depend on those of the free waves to account for nonlinear effects in the wave elevation it could be useful to revisit the proposed approach by separating the free waves from the bound waves contributions at the same time it is to be noted that the lepre approach is not strictly tied to the use of a basic linear dispersion relation in fact a general relation between wave number and wave frequency can be used without any restriction this means that effects such as current could be directly accounted for but it is also possible to consider the possibility of introducing a nonlinear corrected dispersion relation although not being yet a fully consistent nonlinear extension of the lepre approach such a modification could possibly provide some improvements with respect to the use of a linear approach it is clear that a linear model as the one underlying the proposed lepre methodology has a series of limitations however it may be useful at least in an approximate framework to try keeping separate the concept of providing an accurate deterministic forecasting of wave elevation from the concept of providing a corresponding measure of the associated uncertainty which is the target herein one of the aims of the lepre methodology is to provide a linearly approximate but fast and a priori estimation of the confidence interval for the forecasting notwithstanding the inherent limits in the interpretation of the prediction during an actual application the lepre estimation could be used either quantitatively for mild linear sea states or alternatively as an approximate guide for more severe nonlinear but not strongly nonlinear sea states in this latter case it is not unreasonable to imagine that a lepre estimation of the uncertainty level could be combined with a deterministic prediction based on nonlinear approaches at least for not too severe sea states in such a situation the high computational effort due to the use of nonlinear wave models would be limited to the single deterministic prediction while the fast semi analytical approach from lepre would be used for the approximate estimation of uncertainty bounds if a fully nonlinear approach would be used also for the determination of the confidence interval for the prediction this would likely require the use of monte carlo simulations which may be impractical for real time approaches beside the scenario of a real time application it shall also be underlined that an estimation of the prediction error statistics could also be useful as a guide for the preliminary setting up of the parameters of a prediction system in fact when a large space of design alternatives is to be explored the use of nonlinear monte carlo approaches could become impractical or basically impossible depending on the computational effort and the number of parameters to be tested in such a situation the use of lepre could be of help at least for a preliminary screening in all cases as usual the gain in computational time compared to the use of monte carlo simulations based on nonlinear models is paid in the lepre methodology by the introduction of a series of simplifying assumptions on the basis of these considerations it would therefore be useful to carry out future investigations regarding the qualitative and quantitative comparison between prediction error statistics as obtained from direct nonlinear monte carlo simulations and from the proposed lepre methodology 5 conclusions deterministic predictions of wave elevation could contribute to the safety and operability of vessels and other types of units operating at sea through implementation in early warning guidance and decision support systems while one of the issues in this respect is how to generate the deterministic predictions another parallel issue is how to supplement deterministic predictions with a consistent prediction error measure confidence band this paper has specifically addressed the latter problem by presenting a semi analytical methodology for the determination of prediction error statistics in deterministic sea wave predictions focusing on linear wave models the approach is based on the assumption that the underlying wave elevation stochastic process is gaussian and that the coefficients of the fitting and propagation model can be obtained from a linear fit of the measured wave elevation in space and time furthermore the presented methodology allows to take into account also the presence of measurement error eventually the presented approach allows to obtain a linear estimator of prediction error lepre in space and time where the prediction error is measured through its ensemble variance this estimator takes into account the characteristics of the fitting model and of the fitting points in time and or space as well as the exact characteristics of the sea spectrum the approach is applicable in both long crested and short crested sea states and allows to directly account for different types of fitting procedures for the coefficients of the propagation model the presented lepre approach allows to provide a sound and statistically consistent measure of prediction error as a result it represents a conceptual step forward with respect to existing approaches binary predictability region and prediction error indicator which while being easier to apply in some situations are unfortunately characterised by a level of semi empiricism which could lead to a difficult quantitative interpretation of their outcomes overall the application of lepre methodology provides a full picture of the evolution of the standard deviation of prediction error in space and time this in turns allows to properly determine a predictability region given a specified acceptable threshold for the prediction error standard deviation the capability of determining the prediction error standard deviation also allows the definition of optimum prediction delays in space and or time given the fitting model and the underlying sea spectrum as points of minimum of prediction error standard deviation the presented approach has been applied to a series of representative simulated example cases covering long crested and short crested seas as well as unimodal and archetypal bimodal spectra corresponding monte carlo simulations have also been reported for verification purposes showing the expected agreement with the lepre semi analytical calculations the considered example cases are relevant to laboratory applications as well as applications where the wave elevation could be considered to be measured from a wave elevation sensing device such as a wave radar the presented approach has also been compared with the existing binary predictability region approach and the prediction error indicator showing differences and highlighting interesting qualitative commonalities it is envisioned that the lepre approach could be useful in the future for a deeper and more clear understanding of the characteristics of error in deterministic predictions and for the definition of optimal deterministic prediction strategies furthermore the scheme of the presented approach has also been extended by the authors for application to deterministic ship motions predictions and it is now being tested with results expected to be reported in the near future acknowledgments the contribution of fabio fucile to this work has been carried out in the framework of his ph d programme at university of trieste ph d scholarship d 4 cycle xxix funded by cnr insean c lugni was supported by the research council of norway through the centres of excellence funding scheme amos project number 223254 appendix analytical formulation of lepre in case of dft fitting applied to long crested 1d and short crested 2d waves this appendix presents the derivation of functions f 1 2 k x t and f 2 2 k x t in equation 20 21 in the special case when a dft fitting approach is applied both long crested 1d and short crested 2d waves are considered the derivation starts from the case of long crested 1d sea states where waves propagate in the same direction in this case the generic wave number vector k can be replaced by its corresponding scalar magnitude k and the generic position vector x can be replaced by a scalar coordinate x the possible presence of measurement error does not affect the definition of f 1 2 k x t and f 2 2 k x t in 20 since the contribution to the prediction error standard deviation due to the presence of measurement error represents an additive term therefore for the purpose of this appendix the prediction error can be defined by combining equations 10 and 12 as follows without considering measurement error a 1 ε x t ζ f x t η x t p ζ x t t m p η m p η x t α q x t α the measurement of the wave elevation is assumed to be carried out on an evenly spaced 1d grid of m points with sampling resolution δ x so that the sampled positions are x m x 0 m δ x with m 0 m 1 and x 0 is a given bias position the corresponding fourier wave numbers are defined as k s 2 π s m δ x with the index s taking the values on a convenient subset of the set 0 1 m 2 the fitting model is then assumed to be based on a set of n ζ wave numbers k i k 1 k n ζ chosen among the previously defined fourier ones for sake of simplicity the analytical solution will not account for the zero wave number k 0 and for the possible nyquist wave number k π δ x exploiting the properties of the dft matrix it is straightforward to prove that the matrix t m appearing in 4 can be actually written as a 2 t m 2 m p ζ m t the matrix product t m p η m can now be rewritten in the following block matrix form a 3 f m f 1 1 f 1 n η f i j f n ζ 1 f n ζ n η where f i j f c c k i k j f c s k i k j f s c k i k j f s s k i k j the determination of the elements of f i j can be carried out analytically leading to the following results a 4 f c c k i k j 2 m m 0 m 1 cos k i x m cos k j x m cos π μ i ν j θ d μ i ν j m cos π μ i ν j θ d μ i ν j m a 5 f s s k i k j 2 m m 0 m 1 sin k i x m sin k j x m cos π μ i ν j θ d μ i ν j m cos π μ i ν j θ d μ i ν j m a 6 f c s k i k j 2 m m 0 m 1 cos k i x m sin k j x m sin π μ i ν j θ d μ i ν j m sin π μ i ν j θ d μ i ν j m a 7 f s c k i k j 2 m m 0 m 1 sin k i x m cos k j x m sin π μ i ν j θ d μ i ν j m sin π μ i ν j θ d μ i ν j m where θ m 1 m α with α 2 x 0 m δ x μ i is a natural number defined as μ i k i 2 π m δ x ℕ and v j is in general a real number defined as v j k j 2 π m δ x ℝ the function d p m appearing in the previous expressions is defined as a 8 d p m sin π p m sin π p m with p ℝ the wave numbers k i and k j are respectively the fourier wave number of the fitting model and the assumed wave number of the underlying model this latter in general can be arbitrary and not necessarily linked to the sampling grid the results reported so far are provided assuming that the measurement and fitting is carried out in the space domain however the obtained results can be recast in a form suitable for the dual situation where the measurement and fitting procedure is carried out in time domain in such case it is necessary to interchange space and time as well as wave numbers and wave frequencies in a time domain fitting it shall also be assumed that the fitting frequencies correspond to an orthogonal basis with respect to the measurement domain and that the wave numbers corresponding to the fitting frequencies are determined from the dispersion relation it is worth noticing at this point that in phase resolved propagation methods it is good practice to define the sampling grid in such a way to avoid as much as possible aliasing problems however in general the sampling grid is defined by the sampling resolution of the measuring device and some aliasing is unavoidable in this case the whole fitting and propagation procedure will be affected by aliasing the lepre methodology naturally embeds the fitting model characteristics in its definition and consequently it will provide a prediction error that consistently takes into account the presence of aliasing the elements of the vector q x t in a 1 can now be rewritten as a 9 q 2 j 1 x t i 1 n ζ f c c k i k j cos k i x ω k i t f s c k i k j sin k i x ω k i t cos k j x ω k j t q 2 j x t i 1 n ζ f s c k i k j cos k i x ω k i t f s s k i k j sin k i x ω k i t sin k j x ω k j t however the terms q 2 j 1 x t and q 2 j x t are now in a closed form with respect to the generic arbitrary wave number k j as a result the subscript j can be dropped and the final formulation of the functions f 1 2 k x t and f 2 2 k x t can be written as a 10 f 1 2 k x t i 1 n ζ f c c k i k cos k i x ω k i t f c s k i k sin k i x ω k i t cos k x ω k t 2 f 2 2 k x t i 1 n ζ f s c k i k cos k i x ω k i t f s s k i k sin k i x ω k i t sin k x ω k t 2 the formulation developed so far can be easily extended to the short crested 2d case within the hypothesis that the fitting procedure is carried out using an orthogonal fourier basis the measurement of the wave elevation is assumed to be carried out on an evenly spaced 2d grid of m n points with sampling resolution δ x along the x direction and δ y along the y direction the grid points x m n x m y n t are defined as x m x 0 m δ x with m 0 m 1 and y n y 0 n δ y with n 0 n 1 with x 0 y 0 being the given bias position the corresponding fourier wave numbers considered in their vector form k k x k y t are defined as k x r 2 π r m δ x with the index r taking the values on a convenient subset of the set 0 1 m 2 and k y s 2 π s n δ y with the index s taking the values on 0 1 n 2 the fitting model is then assumed to be based on a set of n ζ wave numbers k i k x i k y i t k 1 k n ζ chosen among the previously defined fourier ones excluding the zero and the nyquist wave numbers in this case the functions f c c f c s f s c f s s presented in equation a 4 to a 7 can be exploited to calculate a set of corresponding functions associated with the 2d case as a 11 g c c k i k j 2 m n n 0 n 1 m 0 m 1 cos k x i x m k y i y n cos k x j x m k y j y n 1 2 f c c k x i k x j f c c k y i k y j f c s k x i k x j f c s k y i k y j f s c k x i k x j f s c k y i k y j f s s k x i k x j f s s k y i k y j a 12 g s s k i k j 2 m n n 0 n 1 m 0 m 1 sin k x i x m k y i y n sin k x j x m k y j y n 1 2 f s s k x i k x j f c c k y i k y j f s c k x i k x j f c s k y i k y j f c s k x i k x j f s c k y i k y j f c c k x i k x j f s s k y i k y j a 13 g c s k i k j 2 m n n 0 n 1 m 0 m 1 cos k x i x m k y i y n sin k x j x m k y j y n 1 2 f c s k x i k x j f c c k y i k y j f c c k x i k x j f c s k y i k y j f s s k x i k x j f s c k y i k y j f s c k x i k x j f s s k y i k y j a 14 g s c k i k j 2 m n n 0 n 1 m 0 m 1 sin k x i x m k y i y n cos k x j x m k y j y n 1 2 f s c k x i k x j f c c k y i k y j f s s k x i k x j f c s k y i k y j f c c k x i k x j f s c k y i k y j f c s k x i k x j f s s k y i k y j similarly to a 10 the index j associated to the frequency in the underlying assumed wave elevation model η can now be dropped so that the functions f 1 2 k x t and f 2 2 k x t for the general short crested 2d case can finally be written as a 15 f 1 2 k x t i 1 n ζ g c c k i k cos k i x ω i t g c s k i k sin k i x ω i t cos k x ω t 2 f 2 2 k x t i 1 n ζ g s c k i k cos k i x ω i t g s s k i k sin k i x ω i t sin k x ω t 2 with ω i ω k i ω ω k 
23272,this paper presents a practical inverse design method for certain body surface a potential based panel method in combination with the niche genetic optimization algorithm is adopted to design the body surface of given target pressure distribution through dealing with dirichlet boundary condition first a niche genetic optimization model is established to provide ideal target pressure distribution for the inverse design method then the integral equation of the relation between the given perturbation velocity potential and the local flux of the unknown surface is derived through the green s theorem together with the mutual restraint model between the change of the velocity potential and the body surface correction established finally the body surface which meets the target pressure distribution is obtained after several iterations through the modified function design examples show that the inverse design method is of good convergence and effectiveness and can be applied to design two dimensional and three dimensional body surface keywords body surface design niche genetic optimization algorithm target pressure distribution modified function 1 introduction in the field of ship hydrodynamics the forward problem is to predict the performance of a ship with certain geometry on the contrary the inverse problem is to find the ship s shape when the ship s performance is given miao et al 1996 peters barra 2013 with the rapid development of cfd the research on the forward problem for the known body surface has reached a quite high level lv et al 2013 kao et al 2015 sun et al 2016 while the research level of the inverse problem is far from expectation due to the nonlinear problem of unknown boundary it should be noted that the inverse problem may be more important for engineers as they usually faced with these problems in their design process cai and li 1997 dai and wang 2006 at present the inverse design method which turns the problem with unknown boundary to the iterative problem with known boundary is mainly adopted to solve the inverse problem there are the dirichlet type and the neumann type for the different ways of iteration the neumann type undertakes the forward and inverse calculation at the same time garabedian mefadden s method gm garabedian and mcfadden 1982 and its corrected version mgm malone and narramore 1991 takanashi s allowance correction method takanashi 1984 hirose et al 1985 and campbell s disc method campbell 1992 belong to the neumann type while the dirichlet type only needs to calculate the inverse problem hence it is called pure inverse method which was proposed by tranen 1974 then shankar 1982 volpe and melnik 1986 made great contributions in its development this method links the target pressure distribution to the body surface and has a clear physical meaning in recent years the inverse design method was applied to airfoil design bristow 1974 zeden and dalton 1978 zedan et al 1994 lee et al 1994 gopalarathnam and selig 2002 broughton and selig 2006 adopted different inverse design methods to carry out the airfoil design under giving target pressure distribution or velocity distribution in terms of ship design huang et al 1998 chen and huang 2002 2004 chen et al 2006 developed an inverse design algorithm in determining the optimal shape of the bulbous bow by utilizing the levenberg marquardt method lmm and b spline surface control technique the design targets were the desired wave height and wave resistance coefficient corresponding to a prescribed pressure distribution yoo 2007 presented a surface panel method by treating a boundary value problem of the dirichlet type to design a three dimensional body surface no matter which kind of inverse design method is applied by the designer it is the first problem to get proper target pressure distribution for unreasonable target pressure it is hard to satisfy the design target or the solution of the inverse design may be divergent though the skilled designer can give the proper target pressure distribution by their rich experience it is inefficient if a tool is provided to determine the pressure distribution it will improve the design efficiency largely some researchers determined the target pressure distribution by optimization method in airfoil design field obayashi and takanashi 1996 kim and rho 1997 1998 li et al 2008 inverse design method is adopt in this paper in combination with the genetic optimization algorithm to design 2d or 3d body surface of given target pressure distribution by dealing with the dirichlet boundary condition first in order to solve the problem that the target pressure distribution is hard to be given the niche genetic optimization model is established to provide the ideal target pressure distribution for the inverse design then the integral equation with the known perturbation potential and the unknown body surface local flux is deduced from the green s theorem together with mutual constraint model between the change of the velocity potential and surface correction value established after that the body surface which satisfies the target pressure distribution can be obtained by iterative calculation finally this method is adopted to design 2d airfoil of propeller and 3d ship bow form 2 inverse design method 2 1 target pressure distribution optimization model the primary problem in inverse design process is to determine target pressure distribution satisfying the design requirement in the past the target pressure distribution of the unknown surface was given by experienced designer and then the fluid dynamics of the designed surface was calculated the target pressure distribution needed to be modified until the result satisfied the requirement this method is inefficiency since the target pressure distribution is determined by experience in order to solve this problem the optimized method is adopted first the parametric mathematical model which controls surface pressure distribution is constructed then the target pressure distribution that satisfies the surface design requirement is determined by the niche genetic algorithm nga 2 1 1 parametric expression of target pressure distribution for the optimization problem the parametric mathematical model is constructed first take the target pressure distribution as the parametric object and construct parametric mathematical model according to the feature of the target pressure distribution in the optimization process the number of control parameters in the expression of the target pressure distribution is as little as possible the b spline function can express the shape of the pressure distribution by less control points once control points move the shape of the pressure distribution changes correspondingly in this paper b spline curve and surface are used to express the pressure distribution of 2d and 3d body surface for n 1 control points pi i 0 1 n also called vertexes of characteristic polygon the k th k 1 order b spline curve reads 1 c u i 0 n p i n i k u 1 k n where n i k u is the basis function defined as 2 n i 0 u 1 if x i u x i 1 0 o t h e r w i s e n i k u u x i n i k 1 u x i k x i x i k 1 u n i 1 k 1 u x i k 1 x i 1 for m 1 n 1 space control points array pi j i 0 1 m j 0 1 n the k l th k 1 l 1 order b spline surface reads 3 s u w i 0 m j 0 n p i j n i k u n j l w 1 k m 1 l n where n i k u and n j l w are basis function x i and y i are the node vectors u and w are the node parameters once the control points p i and p i j are given c u and s u w can be calculated by equations 1 2 and 3 the parameterization of the pressure distribution is to use several b spline control points to represent the pressure distribution along a certain direction the control points are defined by x and y coordinates and corresponding pressure coefficient c p the b spline function is used as the shape function to connect the control points and the detailed pressure distribution is got fig 1 shows the expression of 2d pressure distribution and fig 2 shows the expression of 3d pressure distribution 2 1 2 mathematical model of optimization problem usually there are two objectives for optimization one is to derive the extremum or minimum and maximum value of the function under certain conditions and the other is to derive the values of variables when the function reaches its extreme value the mathematical model can be expressed as follows the objective function 4 f f x x x 1 x 2 x n constraints 5 h i x 0 o r h i x 0 i 1 2 m g i x 0 i 1 2 p x l x x u where f x represents the objective function x is the design variable h i x is the inequality constraint g i x is the equality constraint x u and x l represent the upper and lower limits of the design variables the establishment of optimal mathematical model is actually the process of determining the optimizing objective the design variables and the constraints after the mathematical model is established optimization of target pressure distribution can be carried out using the niche genetic algorithm 2 1 3 niche genetic algorithm the principle of the niche genetic algorithm comes from gregarious feature of creatures the individuals in population evolve in certain living circumstance to sustain diversity in population the niche genetic algorithm adjusts the fitness of every individual by the sharing function which reflects the level of similarity between individuals the sharing function can be written as 6 s d i j 1 d i j σ α d i j σ 0 o t h e r w i s e i 1 2 m 1 j i 1 i 2 m where d ij represents a relationship between individual i and j the hamming distance is used to characterize the relationship and defined as follows 7 d i j x i x j k 1 m x i k x j k 2 i 1 2 m 1 j i 1 i 2 m where x i and x j are ith and jth individual respectively m is the size of the population σ and α are custom constants and they are set to 0 5 and 1 in this article the higher the degree of similarity the larger the value of the sharing function the degree of similarity of the individual in group is measured by s i which is defined as 8 s i j 1 m s d i j i 1 2 m after individual s sharing function is calculated the individual fitness can be adjusted by following formula 9 f i x f i x s i i 1 2 m the niche genetic algorithm classifies individuals into several categories and individuals with good fitness are selected as a new group in each category then a new generation can be obtained by crossover and mutation operation between individuals in same group or different groups meanwhile the outstanding individuals will be retained by pre selection mechanism 2 1 4 the process of pressure distribution optimization taking pressure distribution optimization of an airfoil as an example two b spline curves are constructed to represent the pressure distributions on the upper and lower surfaces of the airfoil as shown in fig 1 each b spline curve is defined by seven control points the pressure of the stagnation point and the trailing edge point is specified in advance according to the pressure distribution of the typical airfoil specifying the stagnation pressure cp l at x 0 and the trailing edge pressure cp 0 4 at x 1 among 14 control points 10 points are free to move the x and y y c p coordinates of those points are the design variables and thus we have 20 design variables in total the optimization model of the pressure distribution is defined as follows maximize c l c d the lift drag ratio subject to 1 the lift coefficient c l 0 4 2 the maximum thickness ratio t constant 3 the maximum camber ratio f 0 02 4 c p u c p l c p u the pressure of upper surface c p l the pressure of lower surface 5 the change of the design variable c p is not more than 20 the niche genetic algorithm is used to optimize the pressure distribution of the airfoil initial population is generated randomly in the region of 0 x 1 and 2 66 y 1 the hydrodynamic characteristics of each individual are estimated by using the empirical formula and integral formula and combine with constraints to form a single fitness function with certain penalties the optimization is performed through loop iterations until the stop criterion is met the optimal solution of the pressure distribution is the individual with the largest fitness the optimization process is achieved through the matlab program the specific steps are as follows step 1 population initialization first let s set evolutionary algebra counter t 1 the pressure distribution genes are expressed as binary numbers of 0 and 1 then the initial population p is generated randomly and population size is 75 the maximum number of generations is set to 100 step 2 fitness evaluation calculate the fitness of all individuals and sort them in descending order and remember former n individuals the n individuals do not participate in selection crossover and mutation operation and participate in niche selection operation with mutated individuals directly step 3 selection operation a new population p1 is generated by competitive selection from the existing population p step 4 crossover operation according to the given crossover probability pc 0 9 the crossover operation is carried out on the population p1 and a new population p2 is obtained if the two individuals selected are the same then uniform crossover operation is carried out on one of the individuals step 5 mutation operation according to the given mutation probability pm 0 01 the mutation operation is carried out on the population p2 and a new population p3 with m individuals is generated step 6 niche selection operation the m individuals of step 5 and the n individuals of step 2 are merged into a new population with m n individuals and the niche selection operation is carried out on them step 7 new population generation let s sort the fitness of the m n individuals of step 6 in descending order and remember former n individuals again the former m individuals in the order are the new generation population step 8 termination criterion determine whether meet the condition of the termination if t 100 update the evolutionary algebra counter t t 1 and the former m individuals of step 7 will be as the next generation population then go to step 3 if t 100 output results the optimum is obtained after about 80 generations fig 3 shows the optimization history of cl cd of the best fit in generation fig 4 shows the process of the niche genetic algorithm 2 2 the description of boundary value problem after the optimum pressure distribution is got by the niche genetic algorithm the inverse design method is adopted to design the unknown body surface with given target pressure distribution through dealing with dirichlet boundary problem based on the potential theory we consider the steady irrotational flow of an inviscid incompressible fluid past the body surface the flow is described in cartesian coordinate system the coordinate system of 2d flow in infinite domain is showed in fig 5 the coordinate system of 3d flow with free surface is showed in fig 6 the positive direction of x axis is consistent with the flow direction the total velocity in flow field is calculated by total velocity potential which is obtained by the inflow velocity potential and the disturbing velocity potential the total velocity potential ф is defined as follows 10 φ u x φ where u x is the velocity potential of uniform inflow φ is the disturbing potential which satisfies the laplace equation 11 2 φ 0 the boundary conditions are showed as follows on the boundary of the body surface s b 12 φ n u n on the free surface s f considering the linear boundary condition 13 φ z u 2 g 2 φ x 2 0 on the wake surface s w when the wake surface exists 14 δ p s w p p 0 15 δ φ n s w φ n φ n 0 on the infinite range control surface s 16 φ 0 for the inverse design problem the pressure distribution of the body surface is given and the dynamic boundary condition on the body surface is 17 p p g i v e n for the body surface the flux flowing through the surface is 0 18 s b n ϕ u x d s 0 2 3 integral equation of inverse design method according to lamb s classical fluid mechanics theory the disturbing potential φ can be got by the green theorem 19 s φ g n g φ n d s 0 applying the green theorem to the disturbing potential φ and basis solution g the integration on s is zero equation 20 can be expressed as follows 20 4 π e δ φ p s b s f s w g φ n d s s b s f s w φ g n d s where coefficient e and δ satisfy 21 e 1 2 2 d 1 3 d δ 0 p s p ω 1 2 p s 1 p ω this article is to find the body surface that matches the given pressure distribution or velocity distribution so the disturbing potential is different from that in common neumann problem it needs to be redefined 22 φ φ o x o x v d l φ o φ where φ o is the disturbing potential at the reference point φ o 0 can be got in the suitable reference point for the 2d problem rankine source g ln r e 1 2 is taken as the basis solution when field point p x y z is located on the body surface s b δ 1 2 the integration is 23 φ p 1 π s b s f s w ln r φ n φ ln r n d s for the 3d problem rankine source g 1 r e 1 is taken as the basis solution the disturbing potential on trailing edge of symmetrical surface satisfies δ φ 0 when the field point p x y z is located on the body surface s b δ 1 2 the integration is 24 φ p 1 2 π s b s f 1 r φ n φ n 1 r d s where r is the distance between the field point and the source point 2 4 numerical discretization of integral equations in order to solve the integral equation the initial body surface and other boundary surface are divided into a series of panels fig 7 shows the panel generation of ship surface and free surface the panels from 1 0 ship length upstream to 2 0 ship length downstream cover the free surface domain the transverse extension of the free surface is about 1 0 ship length the body surface s b is divided into n b panels the free surface s f is divided into n f panels the field points p x i y i z i and the source points q x j y j z j are put on the centroid of each panel the integral equation 25 can be discretized as follows 25 j 1 n b s i j φ n j 2 π φ i j 1 j i n b n f g i j φ j j n b 1 n b n f s i j φ n j where i j 1 2 3 n b n f k ij and g ij are influence coefficients k i j s j ln r d s g i j s j n ln r d s the normal velocity on the free surface φ n φ z u g 2 φ x 2 is calculated by four point finite upstream scheme to ensure that the free surface waves vanish upstream of the disturbance the target velocity potential is arranged in the initial body surface the normal disturbance velocity φ n of the surface can be obtained by solving the integral equation the total normal velocity is expressed as follows 26 φ n φ n u n the surface correction t can be got by integration along the current body surface 27 t s b φ n u n d s after the correction of the body surface the target pressure distribution is loaded on the new surface and the new surface correction is gained by repeating this process the method of loop iterations is adopted in the whole process to gradually approach the target body surface to simplify the problem the control points are moved only in one direction with these are fixed in other directions the process of the inverse design is realized through the fortran program the specific steps are as follows step 1 the flow conditions such as flow velocity u flow direction α etc and the geometric parameters of the initial body surface are given the total number of surface mesh is set to n t step 2 the mesh generation of the body surface follows certain rules and directions the integral equation 23 or 24 of the velocity potential is applied to each surface element and the integral equation is discretized into algebraic equations composed of nt equations step 3 calculate the geometric quantities of each surface element such as the area s ij of the space quadrilateral element and calculate the corresponding influence factors k ij and g ij of each surface element step 4 the program of the niche genetic algorithm is used to optimize the pressure distribution of the initial body surface and the target pressure distribution p x is got according to the bernoulli equation the target pressure distribution is transformed into velocity distribution v x then disturbance velocity potential φ is obtained by integral approach step 5 the disturbance velocity potential is loaded on the initial body surface to solve the integral equation 25 and normal disturbance velocity φ n of the current body surface is got then source intensity φ n of the current body surface is obtained by solving equation 26 step 6 the correction t is obtained by integrating the source intensity φ n along the body surface then the current body surface is modified step 7 after the modification of the body surface the steps 3 5 and 6 are repeated to get new surface constantly until the source intensity φ n is less than convergence parameter ε then the iteration is end and the final target body surface is got the process of the inverse design method is shown in fig 8 3 method verification 3 1 numerical verification of boundary value method to verify the numerical solution of the boundary value method computation of the flow around an ellipsoid with an analytic solution of potential flow in an infinite domain is performed the mathematical expression of ellipsoid can be given by 28 x 2 a 2 y 2 b 2 z 2 c 2 1 where a b and c are the semi axes aligned along the coordinate axes and the values are set to a 1 b 0 5 c 1 the oncoming velocity is 1 m s and the direction is parallel to the x axis the analytical solution of the potential flow around an ellipsoid is given by lamb s classical theory the ellipsoid surface is divided into n c panels along the chord direction the x axis and n r panels along the spanwise direction the z axis by cosine method distribution of surface element is presented in fig 9 to study the mesh convergence perturbation velocity potential of the ellipsoid is calculated and compared with the analytical solutions on the condition that nr 20 and nc 20 40 60 calculation results of the perturbation velocity potential with different numbers of grids are shown in fig 10 where horizontal ordinate c is the dimensionless chord coordinate 0 represents the leading edge 1 represents the trailing edge longitudinal coordinates φ ɛ is the perturbation velocity potential the results show that mismatch does exist near the leading edge and trailing edge when nr 20 nc 20 however numerical solution agrees well with analytical solution when nr 20 nc 40 as well as nr 20 nc 60 for the purpose of ensuring the accuracy and efficiency the 20 40 mesh type is used to calculate flow around the ellipsoid fig 11 shows perturbation velocity potential distribution along chordwise at three spanwise positions which are r 0 233 r 0 758 and r 0 969 fig 12 shows perturbation velocity potential distribution along spanwise at three different chordwise positions which are c 0 616 c 0 824 and c 0 961 it can be seen that the calculation results of the perturbation velocity potential agree well with the analytical solution both in chordwise direction and spanwise direction fig 13 shows tangential velocity distribution along chordwise at two spanwise positions which are r 0 078 and r 0 521 fig 14 shows pressure distribution along chordwise at two spanwise positions which are r 0 078 and r 0 521 it can be found that the calculation results of velocity and pressure agree well with the analytical solution in most region except places nearby leading edge and trailing edge comparisons between numerical solutions and analytical solutions confirm that using the boundary value method to solve perturbation velocity potential and pressure distribution of flow around the ellipsoid has good precision which proves that the boundary value method is effective 3 2 verification of inverse design method the inverse design method for the body surface with target pressure distribution based on dirichlet boundary value problem can be used to solve design problem of both two dimensional surface and three dimensional surface in the following design examples of airfoil and wigley hull are used to verify the effectiveness of the inverse design method 3 2 1 design of two dimensional airfoil we take two dimensional airfoil of naca0012 in infinite domain as the design object the coordinate system is shown in fig 5 the initial body surface is the ellipse whose semi major axis is 0 5 and semi minor axis is 0 15 the target body surface can be obtained by the inverse design method after the pressure distribution of the naca0012 airfoil is given figs 15 18 show the convergence of shape normal velocity tangential velocity and pressure distribution of the design surface during the iterative calculation process respectively in fig 18 we compare the non dimensional pressure results by present method with the analytical solution mushtaq et al 2010 they are in good agreement with each other the design surface is able to approach the target surface very quickly after 4 5 iterations the design surface is essentially in agreement with the target surface after 16 iterations and its normal velocity is close to zero besides the tangential velocity and the pressure distribution of the design surface are in good agreement with that of the target surface it indicates that the inverse design method has good accuracy and convergence to design the two dimensional body surface with given pressure distribution 3 2 2 design of wigley hull wigley hull with free surface is chosen as the case to demonstrate the effectiveness of inverse design method in ship hull design the coordinate system is shown in fig 6 the froude number is fn 0 22 the initial body surface is a modified wigley hull which is widened 1 5 times of the original hull the target pressure distribution of the wigley hull is given the target body surface can be obtained after several iterations fig 19 shows convergence history of waterline for wigley hull design fig 20 shows convergence history of pressure distribution for the nearest strip to free surface the design surface is able to approach the target surface very quickly through first iteration and it converges to the target surface after 12 iterations besides the surface correction valve approaches to zero and the pressure distribution of body surface is basically in agreement with that of the target surface fig 21 shows shape convergence process of the hull form the pressure distribution and wave contours of initial and target hull form are shown in fig 22 and fig 23 respectively it indicates that the inverse design method has good accuracy and convergence to design the three dimensional body surface with given target pressure distribution 4 design examples 4 1 design of propeller airfoil profile in the process of marine propeller design there are two principles in choice of blade airfoil profile one is to have lower drag lift ratio which is helpful to reduce the loss of efficiency due to viscosity and the other is to resist or delay cavitation occurred the blade airfoil profile with the maximum critical cavitation velocity or the minimum negative pressure coefficient is selected as design objective the pressure distribution or velocity profile of the naca0016 airfoil is optimized by using the pressure distribution optimization model and the target pressure distribution which is satisfied with design requirement is obtained then the inverse design method is used to get the body surface firstly seven points are used to define the pressure distribution on the upper and lower surfaces of naca66 airfoil respectively the b spline curve control points are taken as optimization design variables the control points are defined by their x and y coordinate the leading edge and trailing edge pressure stays the same and thus we have 20 design variables in total during the optimization process the lift coefficient cannot reduce the maximum generation number is 800 the change of x coordinate is in the range of 0 and 1 0 and the change of y coordinate is in the range of 2 0 and 1 0 the initial individuals of the pressure distribution are created randomly the initial population size is 90 the average fitness value does not decrease after the 300th generation and keeps oscillating fig 24 shows the target pressure distribution which is obtained by nga it can be seen that the negative pressure coefficient absolute value is smaller than the original value naca0016 is used as the initial body surface to carry out inverse design calculation fig 25 and fig 26 show the convergence processes of shape and pressure distribution the design surface is able to approach the target surface very quickly by 4 5 iterations after 12 iterations the design body surface is basically in agreement with the target surface meantime its normal velocity approaches to zero and the tangential velocity and pressure distribution of the body surface are basically in agreement with that of the target surface 4 2 design of ship bow form high wave and concentration of high pressure around the bow account for large proportion of wave resistance if the pressure distribution around the bow is optimized especially the peak area of the pressure distribution is adjusted wave making resistance can be reduced based on the design goal of lower wave making resistance the pressure distribution optimization model is adopted to optimize pressure distribution of the bow area of a 4250teu container ship which is in the condition of fn 0 238 then with target pressure and initial surface already known the body surface can be solved using inverse design method in the process of designing computation the initial container ship hull is replaced by 15 longitudinal strips and with 48 panels for each strip in order to carry out pressure distribution optimization the b spline function method is used to define initial pressure distribution of the bow area of the 4250teu container ship it means the pressure distribution is expressed by several control points of b spline function along a certain direction the b spline control points are taken as optimization design variables every control points are defined by their x coordinate y coordinate and pressure coefficient cp in addition to the unchanged control points of boundary pressure distribution a total of 20 points can be moved so there are total 60 design variables in the process of the optimization the maximum generation number is 1500 the x and y coordinate are in the range of initial boundary and the variation of the pressure value is less than 10 the initial individuals of the pressure distribution are created randomly the initial populations of genetic algorithm are 200 the average fitness value does not decrease after the 600 t h generation and keeps oscillating fig 27 shows the target pressure distribution along each strip near the free surface the pressure peak is lower and the high pressure distribution is more evenly the 4250teu container ship is used as the initial body surface to carry out inverse design computation fig 28 shows the initial ship form and the designed ship form fig 29 shows the waterlines and section lines of initial and designed hull form the design surface is able to approach the target surface very quickly by 10 15 iterations after 26 iterations the design body surface is basically in agreement with the target surface the pressure distribution contours of initial and designed hull form at fn 0 238 are shown in fig 30 the wave contours of initial and designed hull form at fn 0 238 are shown in fig 31 compared with the wave field caused by initial hull form the wave field caused by the designed hull form is globally smoother and with a smaller wave fig 32 shows the comparisons of wave profiles of initial ship with that of designed ship the wave profiles of designed ship are lower than initial ship s fig 33 shows wave resistance values of initial and designed forms it can be seen that the designed hull form has a smaller wave resistance value than the initial one 5 conclusion in this paper a practical inverse design method is studied to design body surface the niche genetic optimization model for target pressure distribution is introduced to provide ideal target pressure distribution for inverse design integral equation of the relation between the known perturbation velocity potential and the local flux of unknown surface is derived through the green s theorem then the model of the inverse design method is established the convergence and effectiveness of the inverse design method is verified finally the method is applied to design airfoil of propeller and moulded line of ship bow propeller airfoil with good pressure distribution and ship bow form with excellent resistance performance are achieved it demonstrates that this method can be applied to design two dimensional and three dimensional body surface at present the method in this paper is mainly used to design local surface of ship form in future work the variation range of the given pressure distribution will be deep researched to make the method can be applied to design more complex body surface acknowledgement the authors gratefully acknowledge the financial support from the national natural science foundation of china nsfc under project number 51679097 51474109 the financial support from the opening fund of the hubei key laboratory of naval architecture ocean engineering hydrodynamics under project number 201701 and financial support from the china postdoctoral science foundation under project number 2018m632867 
23272,this paper presents a practical inverse design method for certain body surface a potential based panel method in combination with the niche genetic optimization algorithm is adopted to design the body surface of given target pressure distribution through dealing with dirichlet boundary condition first a niche genetic optimization model is established to provide ideal target pressure distribution for the inverse design method then the integral equation of the relation between the given perturbation velocity potential and the local flux of the unknown surface is derived through the green s theorem together with the mutual restraint model between the change of the velocity potential and the body surface correction established finally the body surface which meets the target pressure distribution is obtained after several iterations through the modified function design examples show that the inverse design method is of good convergence and effectiveness and can be applied to design two dimensional and three dimensional body surface keywords body surface design niche genetic optimization algorithm target pressure distribution modified function 1 introduction in the field of ship hydrodynamics the forward problem is to predict the performance of a ship with certain geometry on the contrary the inverse problem is to find the ship s shape when the ship s performance is given miao et al 1996 peters barra 2013 with the rapid development of cfd the research on the forward problem for the known body surface has reached a quite high level lv et al 2013 kao et al 2015 sun et al 2016 while the research level of the inverse problem is far from expectation due to the nonlinear problem of unknown boundary it should be noted that the inverse problem may be more important for engineers as they usually faced with these problems in their design process cai and li 1997 dai and wang 2006 at present the inverse design method which turns the problem with unknown boundary to the iterative problem with known boundary is mainly adopted to solve the inverse problem there are the dirichlet type and the neumann type for the different ways of iteration the neumann type undertakes the forward and inverse calculation at the same time garabedian mefadden s method gm garabedian and mcfadden 1982 and its corrected version mgm malone and narramore 1991 takanashi s allowance correction method takanashi 1984 hirose et al 1985 and campbell s disc method campbell 1992 belong to the neumann type while the dirichlet type only needs to calculate the inverse problem hence it is called pure inverse method which was proposed by tranen 1974 then shankar 1982 volpe and melnik 1986 made great contributions in its development this method links the target pressure distribution to the body surface and has a clear physical meaning in recent years the inverse design method was applied to airfoil design bristow 1974 zeden and dalton 1978 zedan et al 1994 lee et al 1994 gopalarathnam and selig 2002 broughton and selig 2006 adopted different inverse design methods to carry out the airfoil design under giving target pressure distribution or velocity distribution in terms of ship design huang et al 1998 chen and huang 2002 2004 chen et al 2006 developed an inverse design algorithm in determining the optimal shape of the bulbous bow by utilizing the levenberg marquardt method lmm and b spline surface control technique the design targets were the desired wave height and wave resistance coefficient corresponding to a prescribed pressure distribution yoo 2007 presented a surface panel method by treating a boundary value problem of the dirichlet type to design a three dimensional body surface no matter which kind of inverse design method is applied by the designer it is the first problem to get proper target pressure distribution for unreasonable target pressure it is hard to satisfy the design target or the solution of the inverse design may be divergent though the skilled designer can give the proper target pressure distribution by their rich experience it is inefficient if a tool is provided to determine the pressure distribution it will improve the design efficiency largely some researchers determined the target pressure distribution by optimization method in airfoil design field obayashi and takanashi 1996 kim and rho 1997 1998 li et al 2008 inverse design method is adopt in this paper in combination with the genetic optimization algorithm to design 2d or 3d body surface of given target pressure distribution by dealing with the dirichlet boundary condition first in order to solve the problem that the target pressure distribution is hard to be given the niche genetic optimization model is established to provide the ideal target pressure distribution for the inverse design then the integral equation with the known perturbation potential and the unknown body surface local flux is deduced from the green s theorem together with mutual constraint model between the change of the velocity potential and surface correction value established after that the body surface which satisfies the target pressure distribution can be obtained by iterative calculation finally this method is adopted to design 2d airfoil of propeller and 3d ship bow form 2 inverse design method 2 1 target pressure distribution optimization model the primary problem in inverse design process is to determine target pressure distribution satisfying the design requirement in the past the target pressure distribution of the unknown surface was given by experienced designer and then the fluid dynamics of the designed surface was calculated the target pressure distribution needed to be modified until the result satisfied the requirement this method is inefficiency since the target pressure distribution is determined by experience in order to solve this problem the optimized method is adopted first the parametric mathematical model which controls surface pressure distribution is constructed then the target pressure distribution that satisfies the surface design requirement is determined by the niche genetic algorithm nga 2 1 1 parametric expression of target pressure distribution for the optimization problem the parametric mathematical model is constructed first take the target pressure distribution as the parametric object and construct parametric mathematical model according to the feature of the target pressure distribution in the optimization process the number of control parameters in the expression of the target pressure distribution is as little as possible the b spline function can express the shape of the pressure distribution by less control points once control points move the shape of the pressure distribution changes correspondingly in this paper b spline curve and surface are used to express the pressure distribution of 2d and 3d body surface for n 1 control points pi i 0 1 n also called vertexes of characteristic polygon the k th k 1 order b spline curve reads 1 c u i 0 n p i n i k u 1 k n where n i k u is the basis function defined as 2 n i 0 u 1 if x i u x i 1 0 o t h e r w i s e n i k u u x i n i k 1 u x i k x i x i k 1 u n i 1 k 1 u x i k 1 x i 1 for m 1 n 1 space control points array pi j i 0 1 m j 0 1 n the k l th k 1 l 1 order b spline surface reads 3 s u w i 0 m j 0 n p i j n i k u n j l w 1 k m 1 l n where n i k u and n j l w are basis function x i and y i are the node vectors u and w are the node parameters once the control points p i and p i j are given c u and s u w can be calculated by equations 1 2 and 3 the parameterization of the pressure distribution is to use several b spline control points to represent the pressure distribution along a certain direction the control points are defined by x and y coordinates and corresponding pressure coefficient c p the b spline function is used as the shape function to connect the control points and the detailed pressure distribution is got fig 1 shows the expression of 2d pressure distribution and fig 2 shows the expression of 3d pressure distribution 2 1 2 mathematical model of optimization problem usually there are two objectives for optimization one is to derive the extremum or minimum and maximum value of the function under certain conditions and the other is to derive the values of variables when the function reaches its extreme value the mathematical model can be expressed as follows the objective function 4 f f x x x 1 x 2 x n constraints 5 h i x 0 o r h i x 0 i 1 2 m g i x 0 i 1 2 p x l x x u where f x represents the objective function x is the design variable h i x is the inequality constraint g i x is the equality constraint x u and x l represent the upper and lower limits of the design variables the establishment of optimal mathematical model is actually the process of determining the optimizing objective the design variables and the constraints after the mathematical model is established optimization of target pressure distribution can be carried out using the niche genetic algorithm 2 1 3 niche genetic algorithm the principle of the niche genetic algorithm comes from gregarious feature of creatures the individuals in population evolve in certain living circumstance to sustain diversity in population the niche genetic algorithm adjusts the fitness of every individual by the sharing function which reflects the level of similarity between individuals the sharing function can be written as 6 s d i j 1 d i j σ α d i j σ 0 o t h e r w i s e i 1 2 m 1 j i 1 i 2 m where d ij represents a relationship between individual i and j the hamming distance is used to characterize the relationship and defined as follows 7 d i j x i x j k 1 m x i k x j k 2 i 1 2 m 1 j i 1 i 2 m where x i and x j are ith and jth individual respectively m is the size of the population σ and α are custom constants and they are set to 0 5 and 1 in this article the higher the degree of similarity the larger the value of the sharing function the degree of similarity of the individual in group is measured by s i which is defined as 8 s i j 1 m s d i j i 1 2 m after individual s sharing function is calculated the individual fitness can be adjusted by following formula 9 f i x f i x s i i 1 2 m the niche genetic algorithm classifies individuals into several categories and individuals with good fitness are selected as a new group in each category then a new generation can be obtained by crossover and mutation operation between individuals in same group or different groups meanwhile the outstanding individuals will be retained by pre selection mechanism 2 1 4 the process of pressure distribution optimization taking pressure distribution optimization of an airfoil as an example two b spline curves are constructed to represent the pressure distributions on the upper and lower surfaces of the airfoil as shown in fig 1 each b spline curve is defined by seven control points the pressure of the stagnation point and the trailing edge point is specified in advance according to the pressure distribution of the typical airfoil specifying the stagnation pressure cp l at x 0 and the trailing edge pressure cp 0 4 at x 1 among 14 control points 10 points are free to move the x and y y c p coordinates of those points are the design variables and thus we have 20 design variables in total the optimization model of the pressure distribution is defined as follows maximize c l c d the lift drag ratio subject to 1 the lift coefficient c l 0 4 2 the maximum thickness ratio t constant 3 the maximum camber ratio f 0 02 4 c p u c p l c p u the pressure of upper surface c p l the pressure of lower surface 5 the change of the design variable c p is not more than 20 the niche genetic algorithm is used to optimize the pressure distribution of the airfoil initial population is generated randomly in the region of 0 x 1 and 2 66 y 1 the hydrodynamic characteristics of each individual are estimated by using the empirical formula and integral formula and combine with constraints to form a single fitness function with certain penalties the optimization is performed through loop iterations until the stop criterion is met the optimal solution of the pressure distribution is the individual with the largest fitness the optimization process is achieved through the matlab program the specific steps are as follows step 1 population initialization first let s set evolutionary algebra counter t 1 the pressure distribution genes are expressed as binary numbers of 0 and 1 then the initial population p is generated randomly and population size is 75 the maximum number of generations is set to 100 step 2 fitness evaluation calculate the fitness of all individuals and sort them in descending order and remember former n individuals the n individuals do not participate in selection crossover and mutation operation and participate in niche selection operation with mutated individuals directly step 3 selection operation a new population p1 is generated by competitive selection from the existing population p step 4 crossover operation according to the given crossover probability pc 0 9 the crossover operation is carried out on the population p1 and a new population p2 is obtained if the two individuals selected are the same then uniform crossover operation is carried out on one of the individuals step 5 mutation operation according to the given mutation probability pm 0 01 the mutation operation is carried out on the population p2 and a new population p3 with m individuals is generated step 6 niche selection operation the m individuals of step 5 and the n individuals of step 2 are merged into a new population with m n individuals and the niche selection operation is carried out on them step 7 new population generation let s sort the fitness of the m n individuals of step 6 in descending order and remember former n individuals again the former m individuals in the order are the new generation population step 8 termination criterion determine whether meet the condition of the termination if t 100 update the evolutionary algebra counter t t 1 and the former m individuals of step 7 will be as the next generation population then go to step 3 if t 100 output results the optimum is obtained after about 80 generations fig 3 shows the optimization history of cl cd of the best fit in generation fig 4 shows the process of the niche genetic algorithm 2 2 the description of boundary value problem after the optimum pressure distribution is got by the niche genetic algorithm the inverse design method is adopted to design the unknown body surface with given target pressure distribution through dealing with dirichlet boundary problem based on the potential theory we consider the steady irrotational flow of an inviscid incompressible fluid past the body surface the flow is described in cartesian coordinate system the coordinate system of 2d flow in infinite domain is showed in fig 5 the coordinate system of 3d flow with free surface is showed in fig 6 the positive direction of x axis is consistent with the flow direction the total velocity in flow field is calculated by total velocity potential which is obtained by the inflow velocity potential and the disturbing velocity potential the total velocity potential ф is defined as follows 10 φ u x φ where u x is the velocity potential of uniform inflow φ is the disturbing potential which satisfies the laplace equation 11 2 φ 0 the boundary conditions are showed as follows on the boundary of the body surface s b 12 φ n u n on the free surface s f considering the linear boundary condition 13 φ z u 2 g 2 φ x 2 0 on the wake surface s w when the wake surface exists 14 δ p s w p p 0 15 δ φ n s w φ n φ n 0 on the infinite range control surface s 16 φ 0 for the inverse design problem the pressure distribution of the body surface is given and the dynamic boundary condition on the body surface is 17 p p g i v e n for the body surface the flux flowing through the surface is 0 18 s b n ϕ u x d s 0 2 3 integral equation of inverse design method according to lamb s classical fluid mechanics theory the disturbing potential φ can be got by the green theorem 19 s φ g n g φ n d s 0 applying the green theorem to the disturbing potential φ and basis solution g the integration on s is zero equation 20 can be expressed as follows 20 4 π e δ φ p s b s f s w g φ n d s s b s f s w φ g n d s where coefficient e and δ satisfy 21 e 1 2 2 d 1 3 d δ 0 p s p ω 1 2 p s 1 p ω this article is to find the body surface that matches the given pressure distribution or velocity distribution so the disturbing potential is different from that in common neumann problem it needs to be redefined 22 φ φ o x o x v d l φ o φ where φ o is the disturbing potential at the reference point φ o 0 can be got in the suitable reference point for the 2d problem rankine source g ln r e 1 2 is taken as the basis solution when field point p x y z is located on the body surface s b δ 1 2 the integration is 23 φ p 1 π s b s f s w ln r φ n φ ln r n d s for the 3d problem rankine source g 1 r e 1 is taken as the basis solution the disturbing potential on trailing edge of symmetrical surface satisfies δ φ 0 when the field point p x y z is located on the body surface s b δ 1 2 the integration is 24 φ p 1 2 π s b s f 1 r φ n φ n 1 r d s where r is the distance between the field point and the source point 2 4 numerical discretization of integral equations in order to solve the integral equation the initial body surface and other boundary surface are divided into a series of panels fig 7 shows the panel generation of ship surface and free surface the panels from 1 0 ship length upstream to 2 0 ship length downstream cover the free surface domain the transverse extension of the free surface is about 1 0 ship length the body surface s b is divided into n b panels the free surface s f is divided into n f panels the field points p x i y i z i and the source points q x j y j z j are put on the centroid of each panel the integral equation 25 can be discretized as follows 25 j 1 n b s i j φ n j 2 π φ i j 1 j i n b n f g i j φ j j n b 1 n b n f s i j φ n j where i j 1 2 3 n b n f k ij and g ij are influence coefficients k i j s j ln r d s g i j s j n ln r d s the normal velocity on the free surface φ n φ z u g 2 φ x 2 is calculated by four point finite upstream scheme to ensure that the free surface waves vanish upstream of the disturbance the target velocity potential is arranged in the initial body surface the normal disturbance velocity φ n of the surface can be obtained by solving the integral equation the total normal velocity is expressed as follows 26 φ n φ n u n the surface correction t can be got by integration along the current body surface 27 t s b φ n u n d s after the correction of the body surface the target pressure distribution is loaded on the new surface and the new surface correction is gained by repeating this process the method of loop iterations is adopted in the whole process to gradually approach the target body surface to simplify the problem the control points are moved only in one direction with these are fixed in other directions the process of the inverse design is realized through the fortran program the specific steps are as follows step 1 the flow conditions such as flow velocity u flow direction α etc and the geometric parameters of the initial body surface are given the total number of surface mesh is set to n t step 2 the mesh generation of the body surface follows certain rules and directions the integral equation 23 or 24 of the velocity potential is applied to each surface element and the integral equation is discretized into algebraic equations composed of nt equations step 3 calculate the geometric quantities of each surface element such as the area s ij of the space quadrilateral element and calculate the corresponding influence factors k ij and g ij of each surface element step 4 the program of the niche genetic algorithm is used to optimize the pressure distribution of the initial body surface and the target pressure distribution p x is got according to the bernoulli equation the target pressure distribution is transformed into velocity distribution v x then disturbance velocity potential φ is obtained by integral approach step 5 the disturbance velocity potential is loaded on the initial body surface to solve the integral equation 25 and normal disturbance velocity φ n of the current body surface is got then source intensity φ n of the current body surface is obtained by solving equation 26 step 6 the correction t is obtained by integrating the source intensity φ n along the body surface then the current body surface is modified step 7 after the modification of the body surface the steps 3 5 and 6 are repeated to get new surface constantly until the source intensity φ n is less than convergence parameter ε then the iteration is end and the final target body surface is got the process of the inverse design method is shown in fig 8 3 method verification 3 1 numerical verification of boundary value method to verify the numerical solution of the boundary value method computation of the flow around an ellipsoid with an analytic solution of potential flow in an infinite domain is performed the mathematical expression of ellipsoid can be given by 28 x 2 a 2 y 2 b 2 z 2 c 2 1 where a b and c are the semi axes aligned along the coordinate axes and the values are set to a 1 b 0 5 c 1 the oncoming velocity is 1 m s and the direction is parallel to the x axis the analytical solution of the potential flow around an ellipsoid is given by lamb s classical theory the ellipsoid surface is divided into n c panels along the chord direction the x axis and n r panels along the spanwise direction the z axis by cosine method distribution of surface element is presented in fig 9 to study the mesh convergence perturbation velocity potential of the ellipsoid is calculated and compared with the analytical solutions on the condition that nr 20 and nc 20 40 60 calculation results of the perturbation velocity potential with different numbers of grids are shown in fig 10 where horizontal ordinate c is the dimensionless chord coordinate 0 represents the leading edge 1 represents the trailing edge longitudinal coordinates φ ɛ is the perturbation velocity potential the results show that mismatch does exist near the leading edge and trailing edge when nr 20 nc 20 however numerical solution agrees well with analytical solution when nr 20 nc 40 as well as nr 20 nc 60 for the purpose of ensuring the accuracy and efficiency the 20 40 mesh type is used to calculate flow around the ellipsoid fig 11 shows perturbation velocity potential distribution along chordwise at three spanwise positions which are r 0 233 r 0 758 and r 0 969 fig 12 shows perturbation velocity potential distribution along spanwise at three different chordwise positions which are c 0 616 c 0 824 and c 0 961 it can be seen that the calculation results of the perturbation velocity potential agree well with the analytical solution both in chordwise direction and spanwise direction fig 13 shows tangential velocity distribution along chordwise at two spanwise positions which are r 0 078 and r 0 521 fig 14 shows pressure distribution along chordwise at two spanwise positions which are r 0 078 and r 0 521 it can be found that the calculation results of velocity and pressure agree well with the analytical solution in most region except places nearby leading edge and trailing edge comparisons between numerical solutions and analytical solutions confirm that using the boundary value method to solve perturbation velocity potential and pressure distribution of flow around the ellipsoid has good precision which proves that the boundary value method is effective 3 2 verification of inverse design method the inverse design method for the body surface with target pressure distribution based on dirichlet boundary value problem can be used to solve design problem of both two dimensional surface and three dimensional surface in the following design examples of airfoil and wigley hull are used to verify the effectiveness of the inverse design method 3 2 1 design of two dimensional airfoil we take two dimensional airfoil of naca0012 in infinite domain as the design object the coordinate system is shown in fig 5 the initial body surface is the ellipse whose semi major axis is 0 5 and semi minor axis is 0 15 the target body surface can be obtained by the inverse design method after the pressure distribution of the naca0012 airfoil is given figs 15 18 show the convergence of shape normal velocity tangential velocity and pressure distribution of the design surface during the iterative calculation process respectively in fig 18 we compare the non dimensional pressure results by present method with the analytical solution mushtaq et al 2010 they are in good agreement with each other the design surface is able to approach the target surface very quickly after 4 5 iterations the design surface is essentially in agreement with the target surface after 16 iterations and its normal velocity is close to zero besides the tangential velocity and the pressure distribution of the design surface are in good agreement with that of the target surface it indicates that the inverse design method has good accuracy and convergence to design the two dimensional body surface with given pressure distribution 3 2 2 design of wigley hull wigley hull with free surface is chosen as the case to demonstrate the effectiveness of inverse design method in ship hull design the coordinate system is shown in fig 6 the froude number is fn 0 22 the initial body surface is a modified wigley hull which is widened 1 5 times of the original hull the target pressure distribution of the wigley hull is given the target body surface can be obtained after several iterations fig 19 shows convergence history of waterline for wigley hull design fig 20 shows convergence history of pressure distribution for the nearest strip to free surface the design surface is able to approach the target surface very quickly through first iteration and it converges to the target surface after 12 iterations besides the surface correction valve approaches to zero and the pressure distribution of body surface is basically in agreement with that of the target surface fig 21 shows shape convergence process of the hull form the pressure distribution and wave contours of initial and target hull form are shown in fig 22 and fig 23 respectively it indicates that the inverse design method has good accuracy and convergence to design the three dimensional body surface with given target pressure distribution 4 design examples 4 1 design of propeller airfoil profile in the process of marine propeller design there are two principles in choice of blade airfoil profile one is to have lower drag lift ratio which is helpful to reduce the loss of efficiency due to viscosity and the other is to resist or delay cavitation occurred the blade airfoil profile with the maximum critical cavitation velocity or the minimum negative pressure coefficient is selected as design objective the pressure distribution or velocity profile of the naca0016 airfoil is optimized by using the pressure distribution optimization model and the target pressure distribution which is satisfied with design requirement is obtained then the inverse design method is used to get the body surface firstly seven points are used to define the pressure distribution on the upper and lower surfaces of naca66 airfoil respectively the b spline curve control points are taken as optimization design variables the control points are defined by their x and y coordinate the leading edge and trailing edge pressure stays the same and thus we have 20 design variables in total during the optimization process the lift coefficient cannot reduce the maximum generation number is 800 the change of x coordinate is in the range of 0 and 1 0 and the change of y coordinate is in the range of 2 0 and 1 0 the initial individuals of the pressure distribution are created randomly the initial population size is 90 the average fitness value does not decrease after the 300th generation and keeps oscillating fig 24 shows the target pressure distribution which is obtained by nga it can be seen that the negative pressure coefficient absolute value is smaller than the original value naca0016 is used as the initial body surface to carry out inverse design calculation fig 25 and fig 26 show the convergence processes of shape and pressure distribution the design surface is able to approach the target surface very quickly by 4 5 iterations after 12 iterations the design body surface is basically in agreement with the target surface meantime its normal velocity approaches to zero and the tangential velocity and pressure distribution of the body surface are basically in agreement with that of the target surface 4 2 design of ship bow form high wave and concentration of high pressure around the bow account for large proportion of wave resistance if the pressure distribution around the bow is optimized especially the peak area of the pressure distribution is adjusted wave making resistance can be reduced based on the design goal of lower wave making resistance the pressure distribution optimization model is adopted to optimize pressure distribution of the bow area of a 4250teu container ship which is in the condition of fn 0 238 then with target pressure and initial surface already known the body surface can be solved using inverse design method in the process of designing computation the initial container ship hull is replaced by 15 longitudinal strips and with 48 panels for each strip in order to carry out pressure distribution optimization the b spline function method is used to define initial pressure distribution of the bow area of the 4250teu container ship it means the pressure distribution is expressed by several control points of b spline function along a certain direction the b spline control points are taken as optimization design variables every control points are defined by their x coordinate y coordinate and pressure coefficient cp in addition to the unchanged control points of boundary pressure distribution a total of 20 points can be moved so there are total 60 design variables in the process of the optimization the maximum generation number is 1500 the x and y coordinate are in the range of initial boundary and the variation of the pressure value is less than 10 the initial individuals of the pressure distribution are created randomly the initial populations of genetic algorithm are 200 the average fitness value does not decrease after the 600 t h generation and keeps oscillating fig 27 shows the target pressure distribution along each strip near the free surface the pressure peak is lower and the high pressure distribution is more evenly the 4250teu container ship is used as the initial body surface to carry out inverse design computation fig 28 shows the initial ship form and the designed ship form fig 29 shows the waterlines and section lines of initial and designed hull form the design surface is able to approach the target surface very quickly by 10 15 iterations after 26 iterations the design body surface is basically in agreement with the target surface the pressure distribution contours of initial and designed hull form at fn 0 238 are shown in fig 30 the wave contours of initial and designed hull form at fn 0 238 are shown in fig 31 compared with the wave field caused by initial hull form the wave field caused by the designed hull form is globally smoother and with a smaller wave fig 32 shows the comparisons of wave profiles of initial ship with that of designed ship the wave profiles of designed ship are lower than initial ship s fig 33 shows wave resistance values of initial and designed forms it can be seen that the designed hull form has a smaller wave resistance value than the initial one 5 conclusion in this paper a practical inverse design method is studied to design body surface the niche genetic optimization model for target pressure distribution is introduced to provide ideal target pressure distribution for inverse design integral equation of the relation between the known perturbation velocity potential and the local flux of unknown surface is derived through the green s theorem then the model of the inverse design method is established the convergence and effectiveness of the inverse design method is verified finally the method is applied to design airfoil of propeller and moulded line of ship bow propeller airfoil with good pressure distribution and ship bow form with excellent resistance performance are achieved it demonstrates that this method can be applied to design two dimensional and three dimensional body surface at present the method in this paper is mainly used to design local surface of ship form in future work the variation range of the given pressure distribution will be deep researched to make the method can be applied to design more complex body surface acknowledgement the authors gratefully acknowledge the financial support from the national natural science foundation of china nsfc under project number 51679097 51474109 the financial support from the opening fund of the hubei key laboratory of naval architecture ocean engineering hydrodynamics under project number 201701 and financial support from the china postdoctoral science foundation under project number 2018m632867 
23273,the discrete module beam bending based hydroelasticity method proposed by lu et al 2016 deals with the hydroelastic response of a flexible structure by discretising it into several rigid submodules which are connected by euler bernoulli beam elements a stiffness matrix is determined in terms of the geometrical and physical properties of the flexible structure for each beam element and it has an analytical form for simple geometric features such as a rectangular cross section unchanged along the longitudinal direction however the analytical stiffness matrix may not exist for a flexible structure with complex geometric features in the present study with the aid of finite element method the discrete module beam bending based hydroelasticity method proposed by lu et al 2016 is extended to be applicable for a flexible structure with complex geometric features keywords hydroelasticity waves flexible structure finite element method 1 introduction hydroelasticity is concerned with the deformation of flexible structures responding to hydrodynamic excitations and simultaneously the modification of the excitations due to the structural deformation traditional three dimensional hydroelasticity theory based on mode superposition approach has been widely adopted for the dynamic response of flexible structures in waves senjanović et al 2008 this method contains three steps 1 evaluation of the natural oscillation modes of the flexible structure 2 hydrodynamic analysis for each mode and 3 superposition of all modes together and solution of the coupled modal equation to obtain the hydroelastic response of the flexible structure unlike the traditional mode superposition approach lu et al 2016 proposed a discrete module beam bending based hydroelasticity method the underlying idea is outlined as follow first a continuous flexible structure is discretised into several rigid submodules multi rigid body hydrodynamics is adopted to obtain the hydrodynamic forces wave excitation force added mass force and radiation damping force on each rigid submodule which together with the hydrostatic force and inertia force comprises the total external force on each submodule then each submodule is simplified as a lumped mass at its center of gravity and adjacent lumped masses are connected by a beam element to account for effects of structural deformation finally the equations of motion for a flexible structure in waves are established by considering the equilibrium of total external forces and structural deformation induced forces on each lumped mass some recent researches on application of this hydroelasticity method can refer to sun et al 2018 wei et al 2017 xu et al 2017 zhang et al 2018a 2018b the flexible structures investigated in the above mentioned researches have simple shapes with unchanged cross section in the longitudinal direction a rectangular plate in sun et al 2018 wei et al 2017 xu et al 2017 and zhang et al 2018b and an elliptic cylinder in zhang et al 2018a thus for each beam element added between two adjacent lumped masses an analytical stiffness matrix exists see appendix a however in reality large ships or very large floating structures may have complicated geometric features and thus no analytical stiffness matrix exists for the beam element the aim of the present study is to extend the discrete module beam bending based hydroelasticity method proposed by lu et al 2016 to be applicable for a flexible structure with complex geometric features with the aid of finite element method an outline of the underlying idea for the extension is given and some validations are provided 2 extension of the discrete module beam bending based hydroelasticity method 2 1 revisitation of the hydroelasticity method the discrete module beam bending based hydroelasticity method proposed by lu et al 2016 is revisited here for lu s hydroelasticity method a linear hydrodynamic approach is used and the solution is obtained in frequency domain as shown in fig 1 a continuous flexible structure is first discretised into n rigid submodules then multi rigid body hydrodynamics theory can be used to obtain the wave excitation force f e added mass force f a ω 2 a ω ξ radiation damping force f rd i ω b ω ξ for all submodules here ω is the wave frequency ξ is the total displacement vector at the center of each submodule with the dimension 6n 1 each submodule has 6 degrees of freedom a ω and b ω are the added mass and radiation damping respectively with the dimension 6n 6n the hydrostatic restoring force is f hs c ξ with c whose dimension is 6n 6n being the hydrostatic restoring coefficients the inertia force of all submodules is f i n ω 2 m ξ where m whose dimension is 6n 6n is the mass matrix the hydrodynamic formulations related to the calculation of the above mentioned forces can be referred to lu et al 2016 and zhang et al 2018b the total external force exerted on the center of all submodules is 1 f t f e f a f rd f in f hs subsequently each submodule is simplified as a lumped mass at its center of gravity and the adjacent lumped masses are connected by a beam element the geometrical and physical properties of which are derived from the flexible structure the force on lumped masses caused by structural deformation is f st k st ξ where k s t 6n 6n is the stiffness matrix of the entire structure and it is given by overlaying the beam element stiffness matrix k e according to the standard process of finite element method more details can be referred to zhang et al 2018a 2018b finally the equations of motion of a flexible structure in waves are established in frequency domain by considering the equilibrium of forces for each lumped mass 2 ω 2 m a ω i ω b ω c k st ξ f e by solving eq 2 the displacement at the center of gravity of each submodule is obtained then the beam bending theory can be applied to solve the structural deflection shear force and bending moment 2 2 extension of the hydroelasticity method if the flexible structure has a simple shape an analytical expression of the beam element stiffness matrix k e the dimension is 12 12 can be given for example for a uniform beam element with a rectangular cross section the expression of k e is given in appendix a however for a flexible structure with complex geometric features we can never obtain such an analytical expression for the beam element stiffness matrix as a result the finite element approach will be adopted to extend the present hydroelasticity method when it comes to the finite element approach we mean that the beam between two adjacent lumped masses is discretised into a large number of small elements a standard discretization process used in the finite element analysis we consider a beam element with arbitrary shape of cross section and varied geometric features along the longitudinal direction shown in fig 2 this beam element is bounded by the center of gravity of the ith and jth submodules the extension of the approach actually includes two steps 1 to represent the physical variables displacement and forces of all the nodes of the beam element by the physical variables of nodes on the cross section of the beam element and 2 to represent the physical variables of nodes on the cross section by the ones at the center of cross section of the beam element the finite element method fem is applied to the beam element for calculation of the overall stiffness of the structure suppose that the beam element is discretised into a number of small elements with the number of nodes n each node has three components of displacement and force which is defined as ξ p ξ x p ξ y p ξ z p t and f p f x p f y p f z p t p 1 2 n the force is related with the displacement by the spatial stiffness matrix k the dimension is 3n 3n as 3 k ξ k ξ 1 ξ 2 ξ n 3 n 1 f f 1 f 2 f n 3 n 1 where the spatial stiffness matrix k can be obtained using the software ansys 2013 in eq 3 the nodes are spatially distributed within the beam element this means that there are nodes both on the two end cross sections of the beam two cross sections where the centers i and j are located and in the inner space of the beam so the first step is to represent the physical variables i e displacements and forces of all the nodes of the beam element by the physical variables of nodes on two end cross sections of the beam element i e to establish the stiffness matrix of the nodes on two end cross sections k b this process is quite similar to the static condensation process in finite element method wilson 1974 eq 3 can be modified as 4 k bb k bi k ib k ii ξ b ξ i f b f i where ξ b and ξ i are the displacement of the nodes on two end cross sections and in the inner space of the beam element respectively f b and f i are the external forces of the nodes on two end cross sections and in the inner space of the beam element respectively k bb k bi k i b k ii are the partitioned matrix of the matrix k it should be noted that f i 0 because these nodes are inner nodes of the beam element and no external forces are exerted on inner nodes for the discrete module beam bending method all forces have been assumed to be exerted on the center of gravity of each submodule from eq 4 we can obtain the following expressions 5 k b ξ b k bb k bi k ii 1 k ib ξ b f b the second step is to represent the physical variables of nodes on two end cross sections by the ones at the center of each cross section of the beam element center i and j in fig 2 the equivalent displacements and forces on the centers of two cross sections at the end of the beam are defined as ξ cg and f cg respectively if the equivalent stiffness is defined as k cg then 6 k cg ξ cg f cg the problem now is to seek the relationship between the equivalent stiffness matrix k cg and the stiffness matrix of nodes on two end cross sections k b which will make use of the rigid body motion transformation matrix linking between the motion of center i and j and the motion of other nodes on two end cross sections the displacements of nodes on two end cross sections can be related to the displacements at the centers i and j in fig 2 of two cross sections as follows 7 ξ b t ξ cg t i 0 0 t j ξ cg i ξ cg j where t is a transform matrix if the number of nodes on two end cross sections is n 1 then the dimension for ξ b t and ξ cg is 3n 1 1 3n 1 12 and 12 1 respectively it should be noted that the dimension is 6 1 for both ξ cg i and ξ cg j this is because ξ cg i and ξ cg j represent the displacements of two rigid submodules used in hydroelastic analysis which have six components including surge sway and heave linear displacement along x y and z direction respectively and roll pitch and yaw angular displacement along x y and z axis respectively the number of nodes at the left and right end cross section is n i and n j n i n j n 1 respectively then 8 t i t 1 i t 2 i t n i i and t j t 1 j t 2 j t n j j where t p i t p j is the partitioned matrix of t i t j corresponding to the transformation of the displacements from the center i j to the pth node assuming that the relative position of the pth node which belongs to the left end cross section to center i of the cross section is r i p x i p y i p z i p t then the expression of t p i is given as follows 9 t p i 1 0 0 0 z i p y i p 0 1 0 z i p 0 x i p 0 0 1 y i p x i p 0 3 6 similarly we can obtain t p j as follows 10 t p j 1 0 0 0 z j p y j p 0 1 0 z j p 0 x j p 0 0 1 y j p x j p 0 3 6 where r j p x j p y j p z j p t is the relative position of the pth node which belongs to the right end cross section to center j of the cross section as the forces on the nodes of two end cross sections and the relative coordinates of nodes to the centers of two cross sections are both known it can be easy to transform the forces on the nodes f b to the forces on the centers of two end cross sections f cg by the following expression 11 f cg t t f b combining eqs 5 11 we have 12 k cg t t k b t k b k bb k bi k ii 1 k ib k k bb k bi k ib k ii eq 12 shows the relationship between the equivalent stiffness at the centers of two end cross sections k cg and the stiffness matrix of all nodes of a beam element k and k can be obtained with the aid of a finite element software such as ansys using eq 12 the hydroelastic response of a floating flexible structure with complex geometric features can be solved 2 3 validation of the extension of the hydroelasticity method first we choose a cubic steel model the physical properties and dimension of which are given in fig 3 a for this simple shape the stiffness matrix can be calculated using the expression given in appendix a the result is noted as k a n a l and it is given in table 1 the stiffness matrix for this cubic model is also calculated from eq 12 with the aid of finite element software ansys the steel model is discretised with the number of nodes 20 8 and 6 in the direction of length width and height respectively see fig 3 b the ansys software is used to extract the stiffness matrix k after which the equivalent stiffness matrix for the centers of two end cross sections k cg is calculated using eq 12 the result is given in table 2 and the difference between k a n a l and k cg is given in table 3 it can be seen that the relative error of all components of the stiffness matrix calculated by two approaches is within 10 which validates the correctness of eq 12 next we consider a model adopted in the experiment conducted by yago and endo 1996 to further evaluate the above mentioned methodology as shown in fig 4 the model is a continuous pontoon type very large floating structure vlfs the physical properties and dimension shown in fig 4 all correspond to the prototype scale the hydroelastic response of the model is calculated for heading waves of different wave length the continuous structure is discretised into 8 submodules to perform the hydroelastic analysis refer to fig 1 the structural stiffness matrix for each beam element is calculated using both analytical expression in appendix a denoted as approach 1 and fem method with eq 12 denoted as approach 2 the finite element model of a beam element to connect the centers of gravity of two adjacent submodules is shown in fig 5 the length width and height of this macro beam element are 60 60 and 2 m respectively the number of elements in these three directions are 20 20 and 4 respectively the experimental results obtained by yago and endo 1996 is denoted as experiment the numerical results calculated using three dimensional hydroelasticity method based on mode superposition approach fu et al 2007 is denoted as mode superposition as shown in fig 6 the dynamic responses of the continuous vlfs in waves are almost identical for two approaches both of which agree well with experimental results this further validates the correctness of extension of the hydroelasticity theory proposed by lu et al 2016 a detailed comparison of numerical results calculated by different numerical methods with experimental results expressed as the relative differences is listed in table 4 3 conclusions the discrete module beam bending based hydroelasticity method proposed by lu et al 2016 is extended to be applicable for a flexible structure with complex geometric features with the aid of finite element method first the elastic beam used to consider the structural deformation effects is considered as a macro element and it is discretised following the standard finite element method after which the structural stiffness matrix of this macro element can be obtained using the static condensation technique and rigid body motion transformation matrix the equivalent stiffness matrix corresponding to the displacements at the centers of two end cross sections of this beam can then be derived from the macro element s stiffness matrix subsequently the hydroelastic response of a flexible structure with complex geometric features can be solved the extension of the hydroelasticity method is validated by ⅰ a small difference within 5 of the stiffness matrix for a cubic steel model calculated using the analytical formulation and the proposed approach and ⅱ a good agreement between the experimentally measured vertical response of a vlfs and that calculated using the present method the extension of the discrete module beam bending based hydroelasticity method is a big step for its application in practical engineering problems in the future work relevant experiments will be carried out on the hydroelastic response of a flexible structure with complex geometric features in waves to further validate the present study acknowledgement the first author would like to acknowledge the support of the iprs apa and shell uwa offshore engineering phd research top up scholarships appendix a the stiffness matrix k e for a uniform beam element with unchanged cross section is given as follows a1 k e e a l 0 12 e i z l 3 1 β y 0 0 12 e i y l 3 1 β z symmetry 0 0 0 g κ h 3 b l 0 0 6 e i y l 2 1 β z 0 4 β z e i y l 1 β z 0 6 e i z l 2 1 β y 0 0 0 4 β y e i z l 1 β y e a l 0 0 0 0 0 e a l 0 12 e i z l 3 1 β y 0 0 0 6 e i z l 2 1 β y 0 12 e i z l 3 1 β y 0 0 12 e i y l 3 1 β z 0 6 e i y l 2 1 β z 0 0 0 12 e i y l 3 1 β z 0 0 0 g κ h 3 b l 0 0 0 0 0 g κ h 3 b l 0 0 6 e i y l 2 1 β z 0 2 β z e i y l 1 β z 0 0 0 6 e i y l 2 1 β z 0 4 β z e i y l 1 β z 0 6 e i z l 2 1 β y 0 0 0 2 β y e i z l 1 β y 0 6 e i z l 2 1 β y 0 0 0 4 β y e i z l 1 β y the size of the symmetric matrix is 12 12 l is the length of beam element the dimension along x axis b is width of the beam element the dimension along y axis h is the height the dimension along z axis κ is a constant related to b and h a is cross sectional area with a bh e is young modulus β y is the correction factor considering shear deformation for the beam element bending in xoy plane β z is the correction factor considering shear deformation for the beam element bending in xoz plane i y is the moment of inertia around the y axis i z is the moment of inertia around the z axis g is the shear modulus 
23273,the discrete module beam bending based hydroelasticity method proposed by lu et al 2016 deals with the hydroelastic response of a flexible structure by discretising it into several rigid submodules which are connected by euler bernoulli beam elements a stiffness matrix is determined in terms of the geometrical and physical properties of the flexible structure for each beam element and it has an analytical form for simple geometric features such as a rectangular cross section unchanged along the longitudinal direction however the analytical stiffness matrix may not exist for a flexible structure with complex geometric features in the present study with the aid of finite element method the discrete module beam bending based hydroelasticity method proposed by lu et al 2016 is extended to be applicable for a flexible structure with complex geometric features keywords hydroelasticity waves flexible structure finite element method 1 introduction hydroelasticity is concerned with the deformation of flexible structures responding to hydrodynamic excitations and simultaneously the modification of the excitations due to the structural deformation traditional three dimensional hydroelasticity theory based on mode superposition approach has been widely adopted for the dynamic response of flexible structures in waves senjanović et al 2008 this method contains three steps 1 evaluation of the natural oscillation modes of the flexible structure 2 hydrodynamic analysis for each mode and 3 superposition of all modes together and solution of the coupled modal equation to obtain the hydroelastic response of the flexible structure unlike the traditional mode superposition approach lu et al 2016 proposed a discrete module beam bending based hydroelasticity method the underlying idea is outlined as follow first a continuous flexible structure is discretised into several rigid submodules multi rigid body hydrodynamics is adopted to obtain the hydrodynamic forces wave excitation force added mass force and radiation damping force on each rigid submodule which together with the hydrostatic force and inertia force comprises the total external force on each submodule then each submodule is simplified as a lumped mass at its center of gravity and adjacent lumped masses are connected by a beam element to account for effects of structural deformation finally the equations of motion for a flexible structure in waves are established by considering the equilibrium of total external forces and structural deformation induced forces on each lumped mass some recent researches on application of this hydroelasticity method can refer to sun et al 2018 wei et al 2017 xu et al 2017 zhang et al 2018a 2018b the flexible structures investigated in the above mentioned researches have simple shapes with unchanged cross section in the longitudinal direction a rectangular plate in sun et al 2018 wei et al 2017 xu et al 2017 and zhang et al 2018b and an elliptic cylinder in zhang et al 2018a thus for each beam element added between two adjacent lumped masses an analytical stiffness matrix exists see appendix a however in reality large ships or very large floating structures may have complicated geometric features and thus no analytical stiffness matrix exists for the beam element the aim of the present study is to extend the discrete module beam bending based hydroelasticity method proposed by lu et al 2016 to be applicable for a flexible structure with complex geometric features with the aid of finite element method an outline of the underlying idea for the extension is given and some validations are provided 2 extension of the discrete module beam bending based hydroelasticity method 2 1 revisitation of the hydroelasticity method the discrete module beam bending based hydroelasticity method proposed by lu et al 2016 is revisited here for lu s hydroelasticity method a linear hydrodynamic approach is used and the solution is obtained in frequency domain as shown in fig 1 a continuous flexible structure is first discretised into n rigid submodules then multi rigid body hydrodynamics theory can be used to obtain the wave excitation force f e added mass force f a ω 2 a ω ξ radiation damping force f rd i ω b ω ξ for all submodules here ω is the wave frequency ξ is the total displacement vector at the center of each submodule with the dimension 6n 1 each submodule has 6 degrees of freedom a ω and b ω are the added mass and radiation damping respectively with the dimension 6n 6n the hydrostatic restoring force is f hs c ξ with c whose dimension is 6n 6n being the hydrostatic restoring coefficients the inertia force of all submodules is f i n ω 2 m ξ where m whose dimension is 6n 6n is the mass matrix the hydrodynamic formulations related to the calculation of the above mentioned forces can be referred to lu et al 2016 and zhang et al 2018b the total external force exerted on the center of all submodules is 1 f t f e f a f rd f in f hs subsequently each submodule is simplified as a lumped mass at its center of gravity and the adjacent lumped masses are connected by a beam element the geometrical and physical properties of which are derived from the flexible structure the force on lumped masses caused by structural deformation is f st k st ξ where k s t 6n 6n is the stiffness matrix of the entire structure and it is given by overlaying the beam element stiffness matrix k e according to the standard process of finite element method more details can be referred to zhang et al 2018a 2018b finally the equations of motion of a flexible structure in waves are established in frequency domain by considering the equilibrium of forces for each lumped mass 2 ω 2 m a ω i ω b ω c k st ξ f e by solving eq 2 the displacement at the center of gravity of each submodule is obtained then the beam bending theory can be applied to solve the structural deflection shear force and bending moment 2 2 extension of the hydroelasticity method if the flexible structure has a simple shape an analytical expression of the beam element stiffness matrix k e the dimension is 12 12 can be given for example for a uniform beam element with a rectangular cross section the expression of k e is given in appendix a however for a flexible structure with complex geometric features we can never obtain such an analytical expression for the beam element stiffness matrix as a result the finite element approach will be adopted to extend the present hydroelasticity method when it comes to the finite element approach we mean that the beam between two adjacent lumped masses is discretised into a large number of small elements a standard discretization process used in the finite element analysis we consider a beam element with arbitrary shape of cross section and varied geometric features along the longitudinal direction shown in fig 2 this beam element is bounded by the center of gravity of the ith and jth submodules the extension of the approach actually includes two steps 1 to represent the physical variables displacement and forces of all the nodes of the beam element by the physical variables of nodes on the cross section of the beam element and 2 to represent the physical variables of nodes on the cross section by the ones at the center of cross section of the beam element the finite element method fem is applied to the beam element for calculation of the overall stiffness of the structure suppose that the beam element is discretised into a number of small elements with the number of nodes n each node has three components of displacement and force which is defined as ξ p ξ x p ξ y p ξ z p t and f p f x p f y p f z p t p 1 2 n the force is related with the displacement by the spatial stiffness matrix k the dimension is 3n 3n as 3 k ξ k ξ 1 ξ 2 ξ n 3 n 1 f f 1 f 2 f n 3 n 1 where the spatial stiffness matrix k can be obtained using the software ansys 2013 in eq 3 the nodes are spatially distributed within the beam element this means that there are nodes both on the two end cross sections of the beam two cross sections where the centers i and j are located and in the inner space of the beam so the first step is to represent the physical variables i e displacements and forces of all the nodes of the beam element by the physical variables of nodes on two end cross sections of the beam element i e to establish the stiffness matrix of the nodes on two end cross sections k b this process is quite similar to the static condensation process in finite element method wilson 1974 eq 3 can be modified as 4 k bb k bi k ib k ii ξ b ξ i f b f i where ξ b and ξ i are the displacement of the nodes on two end cross sections and in the inner space of the beam element respectively f b and f i are the external forces of the nodes on two end cross sections and in the inner space of the beam element respectively k bb k bi k i b k ii are the partitioned matrix of the matrix k it should be noted that f i 0 because these nodes are inner nodes of the beam element and no external forces are exerted on inner nodes for the discrete module beam bending method all forces have been assumed to be exerted on the center of gravity of each submodule from eq 4 we can obtain the following expressions 5 k b ξ b k bb k bi k ii 1 k ib ξ b f b the second step is to represent the physical variables of nodes on two end cross sections by the ones at the center of each cross section of the beam element center i and j in fig 2 the equivalent displacements and forces on the centers of two cross sections at the end of the beam are defined as ξ cg and f cg respectively if the equivalent stiffness is defined as k cg then 6 k cg ξ cg f cg the problem now is to seek the relationship between the equivalent stiffness matrix k cg and the stiffness matrix of nodes on two end cross sections k b which will make use of the rigid body motion transformation matrix linking between the motion of center i and j and the motion of other nodes on two end cross sections the displacements of nodes on two end cross sections can be related to the displacements at the centers i and j in fig 2 of two cross sections as follows 7 ξ b t ξ cg t i 0 0 t j ξ cg i ξ cg j where t is a transform matrix if the number of nodes on two end cross sections is n 1 then the dimension for ξ b t and ξ cg is 3n 1 1 3n 1 12 and 12 1 respectively it should be noted that the dimension is 6 1 for both ξ cg i and ξ cg j this is because ξ cg i and ξ cg j represent the displacements of two rigid submodules used in hydroelastic analysis which have six components including surge sway and heave linear displacement along x y and z direction respectively and roll pitch and yaw angular displacement along x y and z axis respectively the number of nodes at the left and right end cross section is n i and n j n i n j n 1 respectively then 8 t i t 1 i t 2 i t n i i and t j t 1 j t 2 j t n j j where t p i t p j is the partitioned matrix of t i t j corresponding to the transformation of the displacements from the center i j to the pth node assuming that the relative position of the pth node which belongs to the left end cross section to center i of the cross section is r i p x i p y i p z i p t then the expression of t p i is given as follows 9 t p i 1 0 0 0 z i p y i p 0 1 0 z i p 0 x i p 0 0 1 y i p x i p 0 3 6 similarly we can obtain t p j as follows 10 t p j 1 0 0 0 z j p y j p 0 1 0 z j p 0 x j p 0 0 1 y j p x j p 0 3 6 where r j p x j p y j p z j p t is the relative position of the pth node which belongs to the right end cross section to center j of the cross section as the forces on the nodes of two end cross sections and the relative coordinates of nodes to the centers of two cross sections are both known it can be easy to transform the forces on the nodes f b to the forces on the centers of two end cross sections f cg by the following expression 11 f cg t t f b combining eqs 5 11 we have 12 k cg t t k b t k b k bb k bi k ii 1 k ib k k bb k bi k ib k ii eq 12 shows the relationship between the equivalent stiffness at the centers of two end cross sections k cg and the stiffness matrix of all nodes of a beam element k and k can be obtained with the aid of a finite element software such as ansys using eq 12 the hydroelastic response of a floating flexible structure with complex geometric features can be solved 2 3 validation of the extension of the hydroelasticity method first we choose a cubic steel model the physical properties and dimension of which are given in fig 3 a for this simple shape the stiffness matrix can be calculated using the expression given in appendix a the result is noted as k a n a l and it is given in table 1 the stiffness matrix for this cubic model is also calculated from eq 12 with the aid of finite element software ansys the steel model is discretised with the number of nodes 20 8 and 6 in the direction of length width and height respectively see fig 3 b the ansys software is used to extract the stiffness matrix k after which the equivalent stiffness matrix for the centers of two end cross sections k cg is calculated using eq 12 the result is given in table 2 and the difference between k a n a l and k cg is given in table 3 it can be seen that the relative error of all components of the stiffness matrix calculated by two approaches is within 10 which validates the correctness of eq 12 next we consider a model adopted in the experiment conducted by yago and endo 1996 to further evaluate the above mentioned methodology as shown in fig 4 the model is a continuous pontoon type very large floating structure vlfs the physical properties and dimension shown in fig 4 all correspond to the prototype scale the hydroelastic response of the model is calculated for heading waves of different wave length the continuous structure is discretised into 8 submodules to perform the hydroelastic analysis refer to fig 1 the structural stiffness matrix for each beam element is calculated using both analytical expression in appendix a denoted as approach 1 and fem method with eq 12 denoted as approach 2 the finite element model of a beam element to connect the centers of gravity of two adjacent submodules is shown in fig 5 the length width and height of this macro beam element are 60 60 and 2 m respectively the number of elements in these three directions are 20 20 and 4 respectively the experimental results obtained by yago and endo 1996 is denoted as experiment the numerical results calculated using three dimensional hydroelasticity method based on mode superposition approach fu et al 2007 is denoted as mode superposition as shown in fig 6 the dynamic responses of the continuous vlfs in waves are almost identical for two approaches both of which agree well with experimental results this further validates the correctness of extension of the hydroelasticity theory proposed by lu et al 2016 a detailed comparison of numerical results calculated by different numerical methods with experimental results expressed as the relative differences is listed in table 4 3 conclusions the discrete module beam bending based hydroelasticity method proposed by lu et al 2016 is extended to be applicable for a flexible structure with complex geometric features with the aid of finite element method first the elastic beam used to consider the structural deformation effects is considered as a macro element and it is discretised following the standard finite element method after which the structural stiffness matrix of this macro element can be obtained using the static condensation technique and rigid body motion transformation matrix the equivalent stiffness matrix corresponding to the displacements at the centers of two end cross sections of this beam can then be derived from the macro element s stiffness matrix subsequently the hydroelastic response of a flexible structure with complex geometric features can be solved the extension of the hydroelasticity method is validated by ⅰ a small difference within 5 of the stiffness matrix for a cubic steel model calculated using the analytical formulation and the proposed approach and ⅱ a good agreement between the experimentally measured vertical response of a vlfs and that calculated using the present method the extension of the discrete module beam bending based hydroelasticity method is a big step for its application in practical engineering problems in the future work relevant experiments will be carried out on the hydroelastic response of a flexible structure with complex geometric features in waves to further validate the present study acknowledgement the first author would like to acknowledge the support of the iprs apa and shell uwa offshore engineering phd research top up scholarships appendix a the stiffness matrix k e for a uniform beam element with unchanged cross section is given as follows a1 k e e a l 0 12 e i z l 3 1 β y 0 0 12 e i y l 3 1 β z symmetry 0 0 0 g κ h 3 b l 0 0 6 e i y l 2 1 β z 0 4 β z e i y l 1 β z 0 6 e i z l 2 1 β y 0 0 0 4 β y e i z l 1 β y e a l 0 0 0 0 0 e a l 0 12 e i z l 3 1 β y 0 0 0 6 e i z l 2 1 β y 0 12 e i z l 3 1 β y 0 0 12 e i y l 3 1 β z 0 6 e i y l 2 1 β z 0 0 0 12 e i y l 3 1 β z 0 0 0 g κ h 3 b l 0 0 0 0 0 g κ h 3 b l 0 0 6 e i y l 2 1 β z 0 2 β z e i y l 1 β z 0 0 0 6 e i y l 2 1 β z 0 4 β z e i y l 1 β z 0 6 e i z l 2 1 β y 0 0 0 2 β y e i z l 1 β y 0 6 e i z l 2 1 β y 0 0 0 4 β y e i z l 1 β y the size of the symmetric matrix is 12 12 l is the length of beam element the dimension along x axis b is width of the beam element the dimension along y axis h is the height the dimension along z axis κ is a constant related to b and h a is cross sectional area with a bh e is young modulus β y is the correction factor considering shear deformation for the beam element bending in xoy plane β z is the correction factor considering shear deformation for the beam element bending in xoz plane i y is the moment of inertia around the y axis i z is the moment of inertia around the z axis g is the shear modulus 
23274,in this study wave excitation and radiation terms in 2dof equations of vertical ship motion are obtained by using a urans solver based on the finite volume method the dtmb 5512 hull form is chosen for the calculations at the froude number of 0 41 numerical simulations are performed for 7 different regular wave conditions first in the regular wave the excitation heave force and pitch moment with the related phase angle are computed while the ship is fixed to heave and pitch motions then the body is forced to oscillate in the heave and pitch directions with a certain frequency and the radiation coefficients are obtained after finding the excitation and radiated terms the 2dof vertical ship motion equations are solved in the frequency domain and motion transfer functions are plotted the results are compared with those obtained through strip theory fully nonlinear urans approach and experiments the new urans based approach presented in this paper offers a more accurate prediction of vertical ship motions compared to strip theory outputs because it takes the viscous effects and free surface nonlinearities into account the new urans based approach can be considered as a better alternative to the fully nonlinear urans approach keywords vertical ship motions urans dtmb 5512 strip theory nomenclature a wave amplitude m b wl waterline breadth m c b block coefficient c m midship section coefficient fn froude number g gravitational acceleration ms 2 iy inertia moment of mass tonm2 k wave number m 1 l pp length between perpendiculars m l wl waterline length m n number of elements r refinement factor r convergence coefficient re reynolds number s wetted surface area m2 t draught m t e wave encounter period s ω wave frequency rad s ω e encounter wave frequency rad s v ship speed m s λ wave length m λm model scale δ mass ton ε difference between two scalars cfd computational fluid dynamics cfl courant friedrichs lewy cpu central processing unit dfbi dynamic fluid body interaction dof degree of freedom fs fourier series fvm finite volume method gci grid convergence index iihr hydroscience engineering the university of iowa n s navier stokes smp ship motion program tf transfer functions urans unsteady reynolds averaged navier stokes 1 introduction the vertical ship motion problem in regular or irregular waves is still one of the leading fields of investigation for the naval architect community the major complexities faced in this field are listed as follows 1 the second order velocity term on computing the hydrodynamic pressure 2 very high reynolds numbers are encountered and the potential method may fail in some certain cases 3 waves are not in a sinusoidal form due to the gravitational force in nature 4 potential based approaches may yield misleading results in the seakeeping performance prediction of non slender geometries 5 unsteady divergent wave systems generated by the ship may affect the ship motions in waves especially at high froude numbers in addition to these complexities considering time dependent measurements the experimental set up and execution of seakeeping tests are highly challenging issues which require qualified facilities and personnel and as well as high cost in comparison with steady state resistance experiments additional difficulties are listed below measurement of the amplitude of incident waves to the ship determination of certain values of the radius of gyration of the ship due to the increasing number of highly capable flow solvers with recent developments in computer hardware and software technology the researchers have been motivated to focus on alternative numerical methods which may support ship motion experiments and handle such challenging problems after the significant studies of froude and krylov researchers have incessantly continued to contribute to the solution of the ship motion problem froude 1861 krylov 1896 first ursell solved the linear boundary value problem of an oscillating circular cylinder on the free surface in the frequency domain ursell 1949a 1949b the velocity potential was represented as the summation of an infinite set of multipoles which satisfies the free surface boundary condition and each is multiplied by a coefficient to satisfy the body boundary condition ursell s remarkable studies paved the way for the theoretical exploration on ship motion problems his main assumptions were that the forward speed was assumed to be zero and the incident wave and body both oscillate with the same frequency tasai merged the conformal mapping transformation technique with ursell s studies in order to reach a solution for more realistic ship sections tasai 1959a 1959b tasai s method transforms the ship sections to a half circle using a scale factor and two or more mapping coefficients especially the ships with round bilge were correctly represented by this method however this method was not yet sufficient to produce adequate results for hulls like swath small waterplane area twin hull or hulls transom sterns or blunt or bulbous bows frank 1967 focused on this problem and developed a close fit method frank s method was a better option in representing the added mass and damping terms of the arbitrary ship sections since the solutions generated by this method were valid for the arbitrary cross sections velocity potential is represented by a distribution of sources on the mean submerged cross sections the method adopts green s function which satisfies the linear free surface boundary condition the density of the sources is an unknown function to be found from integral equations obtained by applying the body boundary condition frank 1967 however studies on the ship motion problem were limited with 1dof motion of a body in a fluid due to the difficulties in coupling the hydrodynamic coefficients to each other salvesen et al 1970 presented the original strip theory by using 2d hydrodynamic coefficients which are calculated by frank s method with strip theory it became possible to get transfer functions tf for the vertical motions of any 3d ship forms in regular waves strip theory is still a common method to run seakeeping analyses of ships and there are many studies in the literature implementing this theory the strip theory s agreement at low froude numbers and in slender bodies has been proven in many studies in the field however it is also shown that it loses its effectiveness both at higher froude numbers and beam length ratios as another numerical approach urans and the additional turbulence equations discretized by implementing finite volume method fvm have recently been used to predict vertical ship motions the leading research associated with urans was initiated by the study of sato et al 1999 they studied the coupled vertical motions for wigley and series 60 hull forms in regular head waves and compared the urans results with the experimental data although the cfd analyses results of the wigley hull are in agreement with the experiments they concluded that series 60 results do not conform to the experiments when the existing methods were evaluated beck and reed 2001 in their extensive work proposed that 3d urans methods are the best option to solve marine hydrodynamics problems since 2005 researchers from different countries have focused on solving ship motion problems with the urans method carrica et al 2006 studied the forward speed diffraction problem for the dtmb 5512 model in head seas for two different speeds and wave lengths they found that relatively short waves show nonlinear characteristics on heave forces and pitch moments with a remarkable second harmonic component in their following study carrica et al 2007 performed several urans analyses to calculate the heave and pitch motions of the same ship model in small and large amplitude regular head waves it should be noted that they were only interested in the encounter frequencies near the resonance region this study showed that transom wave breaks accompanied by extreme ship motions occur in large amplitude head waves irvine et al 2008 carried out numerous seakeeping experiments of coupled heave and pitch motions of dtmb 5512 in a towing tank and presented a very large database for the vertical motions weymouth et al 2005 performed seakeeping simulations for a wide range of froude numbers by using cfd and advised possible methods to be implemented the numerical simulations were carried out for a low wave slope range and the results were compatible with the experiments wilson et al 2008 also implemented the cfd method to achieve tf of the vertical responses of the s175 container ship in regular head waves bhushan et al 2009 carried out vertical ship motion analyses for both the model and full scale of the athena hull form simonsen and stern 2010 2013 prepared a comprehensive study by using cfd for many different types of ships for seakeeping calculations tezdogan et al 2015 investigated the behaviour of the vertical motions of a kcs kriso container ship in waves by performing full scale cfd simulations where their predictions were quite satisfactory ozdemir and barlas 2017 focused on resistance in calm water ship motions and they added the resistance calculations for the kvlcc2 model while their numerical prediction was in convincing agreement for resistance pitch and heave motions an accurate prediction was not achieved for added resistance calculations in waves the nonlinear urans approach was also used by many researchers to find the hydrodynamic coefficients regarding the added mass as well as the damping one of these studies was the work of querard et al 2009 where they dealt with the computations of added mass and damping of 2d sections calculations were done for a very wide frequency range the main focus of their work was to make a comparison with the results obtained by the potential theory and experiments conducted by vugts 1968 for the first time bonfiglio et al tried to obtain tf of the vertical motions by using a hybrid method assuming the linear mathematical model of the vertical motions they separated the radiation and excitation terms while radiation terms were calculated by performing urans excitation terms were calculated by the potential method the main disadvantage of the study was that they obtained the radiation terms for 2d ship sections then they used a strip theory method to get 3d radiation terms this process indeed increased the solution time bonfiglio et al 2016 in this study heave and pitch tf in regular head waves are obtained by using a new urans approach wave conditions are taken to be the same as with the experiments carried out in iihr irvine et al 2008 in the present solution method the total force and moments acting on the ship hull due to waves are considered in superposition of diffraction and radiation terms these terms are computed separately using the urans approach as a first step the ship is fixed to vertical ship motions while she encounters regular head waves excitation or diffraction forces based on several regular waves associated with heave and pitch directions are calculated by considering the first harmonics of the signals as a second step the ship is forced to oscillate in the heave and pitch directions with several frequencies radiation terms are calculated by considering the first harmonics of the signals as a final step using the linear 2dof vertical equation of motion the associated transfer functions are plotted for heave and pitch motions vertical motion tf graphs which were obtained by the present method are compared with fully nonlinear urans approach strip theory and the experimental data in the fully nonlinear urans approach the pitch and heave motions of the ship in regular head waves are calculated directly by using urans and dfbi equations detailed information about the fully nonlinear urans approach can be found cakici et al 2017a b ozdemir and barlas 2017 tezdogan et al 2015 simonsen et al 2013 simonsen and stern 2010 bhushan et al 2009 wilson et al 2008 carrica et al 2006 2007 weymouth et al 2005 sato et al 1999 the commercial cfd software star ccm is used to discretize the urans equations by implementing fvm the main purpose of this study is to compare different numerical approaches with each other in terms of accuracy and cpu hours this paper is organised as follows in chapter 2 the geometrical properties of the hull form and the simulation cases are presented in chapter 3 the mathematical model for the problem is given in chapter 4 cfd verification studies are given the results of the study are discussed in chapter 5 with the help of several graphs and tables finally in chapter 6 the concluding remarks of the study are briefly summarized 2 hull form and simulation cases the well known naval surface combatant dtmb 5512 in 1 46 588 model scale ratio is chosen for the hydrodynamic analyses the numerical simulations are performed for the bare hull condition the 3d view of the ship model with a sonar dome and a transom stern is shown in fig 1 the principal particulars of the ship model are given in table 1 simman 2014 all numerical simulations presented in the study are performed at the froude number of 0 41 representing a relatively high speed case in deep water seven different wave conditions are used in the study which correspond to the ratio of wave length over ship length varying between 0 66 and 2 30 the wave encounter frequency for head waves can be found through the use of 1 ω e ω ω 2 v g in equation 1 g denotes the earth s gravity ω denotes the frequency of the wave and v denotes the advance velocity of the ship small amplitude waves ak 0 025 are selected for cfd simulations to be the same as the experiments conducted by irvine et al 2008 where a denotes the wave amplitude and k denotes the wave number the wave number can be calculated by k 2 π λ here λ denotes the wave length it should be noted that the wave amplitudes which can be seen in table 2 are used for the wave amplitudes of the incoming waves when the excitation terms are calculated in addition the wave amplitudes refer to the oscillation amplitudes when the radiation terms are calculated in chapter 3 2 detailed information for the calculation of the excitation and radiation terms are given 3 mathematical model 3 1 governing equations the averaged continuity and momentum equations can be written for incompressible flow in cartesian coordinates and tensor form as indicated in equations 2 and 3 2 δu i δx i 0 3 ρ δu i δt u j δu i δx i δp δx i δτ δx j δ ρ u i u j δx j where ρ u i u j is the reynolds stress tensor u is the mean velocity vector u is the time varying velocity vector p is the mean pressure ρ is the density and μ is the dynamic viscosity 4 τ τ ij μ δu i δx j δu j δx i where τ ij are the mean viscous stress tensor components as shown in equation 4 in this paper the two equation k ε turbulence model is used in order to include the viscous effects as it is considered to be one of the most commonly used turbulence models for industrial applications querard et al 2008 besides it is cheaper in terms of computer memory compared to the k ω sst model which requires higher cpu time tezdogan et al 2015 querard et al 2008 the employed solver uses a finite volume method which discretizes the navier stokes n s and additional turbulence equations for the numerical model of fluid flow the segregated flow model is used in the urans solver and convection terms in the urans equations are discretized by implementing a second order upwind scheme the urans solver runs a predictor corrector simple type algorithm between the continuity and momentum equations in the analyses volume of fluid vof model is used to represent the deforming free surface in this model calculations are done for water and air phases because of the mesh structure and the number of elements having great importance in capturing the free surface deformations some refinements are made close to the free surface to accurately predict vof wave profiles a second order convection scheme is used to present the free surface profile more precisely for the unsteady terms a first order scheme is applied in the n s equations a summarized list of the numerical discretizations is given in table 3 3 2 calculation of hydrodynamic coefficients and excitation terms one can obtain heave and pitch displacements for relatively small motions and sinusoidal inputs by solving linear vertical motion equations in the time domain as given in equation 5 5 j 3 5 m ij a ij η j b ij η j c ij η j f i cos ω t β f o r i 3 5 where denotes mass or inertia a ij denotes added mass coefficients b ij denotes damping coefficients c ij denotes restoring coefficients f i denotes excitation terms and β denotes the phase angle between heave force and pitch moment also η j denotes the displacements η j denotes the velocities and η j denotes the accelerations in equation 5 all coefficients except for the restoring terms are computed using urans approach in three steps i the total of incoming and scattered wave terms in the heave direction f 3 and in the pitch direction f 5 are calculated for the time domain for several frequencies while the ship model is fixed in order to prevent pitch and heave motions in other words the hull is stationary after fourier analyses as explained in chapter 4 4 the first harmonics of heave forces and pitch moments based on regular waves are calculated the β phase angle between heave force and pitch moment is also recorded for each encounter frequency ii the ship model is forced to oscillate in the heave direction for several frequencies with the amplitude of a after fourier analyses and related statements in chapter 4 4 b 33 a 53 and b 53 are calculated for all encounter frequencies iii the ship model is forced to oscillate in the pitch direction for several frequencies with the wave slope of ak 0 025 after fourier analyses and related statements as in chapter 4 4 a 55 b 55 a 35 and b 35 are calculated for all encounter frequencies the restoring coefficients are taken from linear in house seakeeping software sarioz et al 2000 see table 4 with the solution to equation 5 in the frequency or time domain the heave and pitch transfer functions are plotted if the solution is carried out in the time domain the first harmonics of the heave or pitch motions have to be considered after the steady state solutions are reached 3 3 time step size determination the time step size is selected according to cfl number if any explicit unsteady simulations are carried out the cfl number for each cell is calculated by cfl uδt δx and should be less than or equal to 1 for numerical stability here u stands for the mesh flow speed δ t stands for the time step size and δ x stands for the mesh cell dimension however an implicit method is generally used for unsteady simulations if the solution domain is relatively large ittc 2014 in unsteady implicit problems the restriction imposed by the cfl condition is not a strict issue anymore which relaxes the memory required in the computer in this study time step size is selected to be 1 28 of t e for all analyses which is considered to be more accurate than the value recommended by ittc 2014 here t e denotes the encounter period the variation of time step size and the obtained results are given in chapter 4 3 4 computational domain and boundaries two computational domains of different sizes are used in the study the radiation forces and the moment are calculated using a square shaped computational domain while the forces and the moment resulting from the incoming waves are calculated in a rectangular shaped one see fig 2 and fig 3 the radiation waves caused by the harmonic motion of the hull propagate in all directions in the horizontal plane the upstream distance should be kept wide enough as should the downstream distance thus a square domain is chosen in the calculation of radiation forces and moments on the other hand the incoming wave propagates in the transverse direction and towards the downstream therefore a rectangular domain is preferred in order to calculate diffraction terms it should be noted that a square domain can be used for both of these radiation and diffraction problems however using two different domains is more economical considering cpu time it can also be noted that the grid structure around the hull is identical for both domains for the square solution domain an earth fixed xyz cartesian coordinate system is selected the xy plane represents the free surface which is initially assumed to be calm water in the draught of the model it should be noted that the x axis is aligned to parallel incoming waves and the z axis is the vertical axis normal to the xy plane on the other hand for the rectangular solution domain the xy plane represents the free surface which is initially assumed to be fifth order stokes waves fenton 1985 the incoming waves are represented as a fifth order wave because a fifth order wave is more successful in representing real regular waves compared to a first order wave the fluids water and air are considered to flow in the positive x direction the intersection of forward perpendicular and the free surface is set as the origin of the xyz cartesian coordinate system while the face in the negative x or upstream is selected as velocity inlet the face in the positive x or downstream is selected as pressure outlet to avoid the boundary effects the faces in the negative y positive z top and negative z bottom directions are considered as the velocity inlets ship boundaries are defined as no slip walls where the normal and tangential velocities are zero thus both the kinematic boundary condition and no slip condition are satisfied on the hull surfaces since the problem has a symmetrical behaviour according to y 0 only half of the computational domains is used for the simulations in order to reduce the computational cost hence the side face located at the xz plane where y 0 is assigned as a symmetrical boundary see figs 2 and 3 the computational domain dimensions are given in table 5 and table 6 3 5 grid resolution the computational domains are discretized with fvm using fully hexahedral elements local grid refinements are applied around the hull and near the free surface overset grid technique which has great capability to solve the flow around a moving body is used for all simulations reported in the study according to this method there are two different computational regions background and overset the grid system around the hull is created in overset region and is allowed to move freely as a whole without any modification or deformation unlike the other standard meshing techniques the information of the fluid particles e g velocity or pressure is transferred between the background and overset regions via overset boundaries although there are many options to transfer the flow properties between two regions linear interpolation is preferred in this study it is possible to find more detailed information for the use of overset grid techniques implemented in vertical ship motion problems tezdogan et al 2015 carrica et al 2007 cakici et al 2017a b total cell numbers for different grids are shown in table 7 which are used for the grid verification study on urans simulations of the radiation problem detailed information is given in chapter 4 grid structure around the hull can be seen clearly from fig 4 since a logarithmic universal velocity profile two layer all y wall treatment is used around the no slip wall boundaries the dimensionless wall y value is set to be in the range of 30 300 at the froude number of 0 41 by creating a structured hexahedral fine grid in the near wall boundary layer cd adapco 2014 the cell sizes are gradually increased with a fixed ratio starting from the boundary layer of the hull to the outer boundaries a transverse section plane is taken from x l 0 60 in order to show the structured grid very near to the hull see fig 5 it is cost effective to use a triangular grid structure in order to capture the free surface deformations for non zero speeds since the kelvin waves have a specific angle 19 28 and it is unnecessary to use rectangular refinement far from the hull therefore a kelvin wave adopted grid is applied in order to capture the wave patterns as shown in fig 6 3 6 fourier series expansion post processing in the determination of excitation and radiation terms is performed by using fourier series expansion method the fourier series process is one the most important parts of this study this method is used not only to represent instantaneous force moment histories but also to discretize their components unsteady time histories of forces moments φ t obtained by urans approach can be represented as follows in equation 6 6 φ t φ 0 n 1 n a n cos ω e t b n sin ω e t n 1 2 3 in equation 6 φ 0 ω e and φ n represent the zeroth harmonic of the signal encounter frequency and nth harmonic amplitude of the signal respectively here φ 0 also corresponds to the averaged value of the signal and it can be obtained by using equation 7 7 φ 0 1 t e 0 t e φ t d t for the tf approach only first harmonics are considered therefore the components of the instantaneous signal a1 and b1 were calculated by using equation 8 and equation 9 8 a 1 2 t e 0 t e φ t cos ω e t d t 9 b 1 2 t e 0 t e φ t sin ω e t d t in these equations t e denotes the sampling time first harmonic amplitude of the given signal is found using equation 10 10 φ 1 a 1 2 b 1 2 in all analyses the equations which are explained above are used in order to obtain the excitation and radiation terms wave excitation terms can be found in the following statement 11 f i φ 1 aξ where i 3 5 for heave force or pitch moment in this equation φ 1 may correspond to the first harmonic of the heave force or pitch moment and a is the amplitude of the motion if the excitation is in heave direction ξ is equal to 1 however if the excitation is in pitch direction ξ is equal to wave number k in order to find the phase angle β first harmonics of the heave and pitch motion are plotted and the related phase angle is recorded on the other hand for forced heave and forced pitch simulations the coefficients are derived as follows 12 a ij b 1 aξ c ij ω e 2 13 b ij a 1 ω e aξ where i 3 5 and j 3 5 for coupled heave and pitch motion in these equations a 1 and b 1 refer to the sine and cosine related component of the first harmonic querard et al 2008 a is the amplitude of the motion and a ij b ij and c ij represent the hydrodynamic coefficients which are related to added mass damping and restoring respectively if the forced heave motion is simulated ξ is equal to 1 however if the simulation is forced pitch ξ is equal to wave number k after the solution of equation 5 transfer functions of heave and pitch motions tf 3 and tf 5 can be obtained by using equation 14 and equation 15 14 tf 3 η 3 15 tf 5 η 5 k 4 cfd verification study the verification study is one of the most important steps in all computational fluid dynamics analyses in this chapter only the procedure of verification has been carried out as the procedure of validation cannot be carried out because of the lack of corresponding experimental data however a validation study was performed by the authors cakici et al 2018 for the radiation problem of the wigley hull by urans approach the abstract of this conference paper is given in the appendix of the study grid convergence method gci which is based on richardson extrapolation richardson 1910 is applied for the verification procedure this method was offered by roache 1998 and has been applied with some modifications in numerous studies the methodology which has been described by celik et al 2008 was implemented for the verification of time step and grid resolution the grid spacing and time step size are refined systematically refinement factor r is selected as 2 because it is often used in cfd applications tezdogan et al 2016 for each convergence study three solutions are considered and only one variable is changed tezdogan et al 2016 for instance the grid size is kept constant while the time step size is being refined systematically the procedure implemented in the present study is described below celik et al 2008 the difference between the solution scalars ε should be determined by equation 16 16 ε 21 φ 2 φ 1 ε 32 φ 3 φ 2 in these equations φ 1 φ 2 and φ 3 refer to the solution of fine medium and coarse mesh grid or time step size respectively convergence conditions of the numerical study can be calculated by equation 17 17 r ε 21 ε 32 the possible r values and possibilities are listed below stern et al 2006 a 1 r 0 oscillatory convergence b 0 r 1 monotonic convergence c r 1 oscillatory divergence d r 1 monotonic divergence if the values for convergence condition is like case a the procedure can be implemented however in case b often more than three solutions are needed and the uncertainty u k should be calculated as follows stern et al 2001 de luca et al 2016 18 u k 1 2 s u s l in equation 18 s u and s l are the maximum and minimum values of oscillation respectively if the convergence condition is like case c or d it is not possible to predict the uncertainty de luca et al 2016 stern et al 2001 the apparent order of p can be found by equation 19 celik et al 2008 19 p ln ε 32 ε 21 q ln r 21 here 20 q ln r 21 s r 32 s 21 s sgn ε 32 ε 21 the extrapolated value is 22 φ e x t 21 r p φ 1 φ 2 r p 1 the approximate relative error and extrapolated relative error are 23 e a 21 φ 1 φ 2 φ 1 e ext 21 φ ext 12 φ 1 φ ext 12 finally the gci index is calculated by 24 gci fine 21 1 25 e a 21 r 21 p 1 the total radiation force for forced heave motion in case 6 is selected for numerical uncertainties for grid uncertainty time step size is selected as the fine which is equal to te 28 on the other hand when the time step size uncertainty is calculated grid size is selected as the fine grid see table 7 the results of the verification study are given in table 8 in table 8 it can be seen that time step uncertainty is at an applicable level however in the grid verification case the convergence condition is between 1 and 0 oscillatory convergence therefore another grid resolution which is the finer grid is used in order to estimate the trend of oscillation according to obtained results it is still in oscillatory convergence range thus the uncertainty of grid spacing is calculated by equation 18 and the percentage of uncertainty is derived by simply dividing this result u k by the fine grid solution φ 1 5 results and discussion this chapter presents the numerical results and discussions on vertical motion computations in regular head waves of dtmb 5512 in deep water with figures and tables vertical ship motions obtained by the present method are compared with the experimental data of the same ship model irvine et al 2008 pitch and heave tf graphs at the froude number of 0 41 which were obtained by implementing urans fully cakici et al 2017acakici et al 2017a strip theory experiments and the present method named as urans coefficient are demonstrated in the figures the cfd analyses for the present method took approximately 11 5 h of wall clock time in a 10 core processor with 128 gb ram for five periods of simulations for each case in the present study as already underlined transfer functions of the vertical ship motions are executed with the new prediction method according to this method excitation and radiation terms are computed by urans approach separately then the linear 2dof mathematical model for the vertical motions is solved in the frequency domain and the associated transfer functions are plotted for pitch and heave motions before the discussion part it may be useful to give some information on the radiation problem in the study as is well known a rigid body moving with a non zero speed on the surface of an unbound infinite depth water creates a wave system called a kelvin pattern fig 7 left on the other hand the harmonic motion of a body in the vertical plane with zero advance speed behaves like a source and generates waves which start at the centre of motion and radiate away fig 7 right this is the main reason of the selection of the square domain rather than the rectangular domain on the other hand the wave propagates in the x direction for the diffraction problem therefore a rectangular domain can be used to reduce the computational cost as described in the previous chapters the ship model is forced to oscillate in heave and pitch directions at the froude number of 0 41 in calm water in order to calculate the radiation terms before obtaining radiation terms a study is carried out in order to show the positive and negative wave peaks due to forced heave with zero and non zero advance speeds the 6th case is chosen for this comparison first the analysis is run at the froude number of 0 41 in calm water and the wave peaks are recorded fig 7 left then the model is forced to make the heave motion at the froude number of 0 fig 7 right and the wave peaks are recorded as well since the maximum amplitude of the wave peaks takes place as a result of forced heave motion at the froude number of 0 which is relatively smaller than for the straight towing condition at the froude number of 0 41 it is very hard to observe the radiation waves in the dominant wave system as shown in fig 8 and table 9 a comparison between strip theory and the present method urans coefficient is made in terms of radiation and excitation terms in the calculation of a33 there are no remarkable differences observed between the present study and strip theory however small deviations at relatively higher encounter frequencies can be noticed from fig 9 a it is found that the discrepancies between the present study and strip theory are very large at relatively low encounter frequencies for a55 while the differences get smaller for higher values as seen in fig 9a the main reason for the deviations at low encounter frequencies between strip theory and urans may be caused by the speed correction term which excessively affects the value of a55 in the original strip theory formulation when the coefficient b33 is taken into consideration for the entire encounter frequency range the damping values by urans solutions are expected to be larger than those obtained by strip theory due to the fact that the urans approach takes the viscous effects and free surface non linearities into account see fig 9b however in the computation of coefficient b55 remarkable deviations can be seen between the present study and strip theory at relatively low encounter frequencies as already pointed out the speed correction term in strip theory formulation leads to an increase in damping moment at lower frequencies but its effect vanishes as the frequencies get higher see fig 9b detailed information on the speed correction terms in strip theory formulations can be found in the paper of salvesen et al 1970 for calculation of the coupled coefficients and excitation term phases in the present paper interesting findings such as below were observed in the paper of salvesen et al 1970 the coordinate system is defined as x and forward speed directions are to be the same however in the present study x and forward speed directions are defined as being opposite see figs 2 and 3 the differences in the definition of the coordinate systems cause remarkable deviations when obtaining the coupled coefficients as seen in fig 10 a and fig 10b the phase angle between heave force and pitch moment are also affected by that reversed definition with a remarkable deviation as seen in fig 11 and fig 12 for case 6 the pitch moment and heave force time series for the first harmonic of urans coefficient and strip theory are shown in fig 11 for the unit amplitude wave as can be seen the phase angle between pitch and heave motions has opposite signs for the urans coefficient and strip theory the first peak of the pitch moment based on incoming waves is observed earlier than the heave force for almost the entire encounter frequency range in contrast to smp as for the magnitudes of the excitation terms the deviations are very small at relatively lower encounter frequencies however as the encounter frequencies increase the differences between urans and strip theory increase due to strong non linearities at the high frequencies as demonstrated in fig 12 all the coefficients obtained by urans approach are tabulated in table 10 comparison of the heave and pitch tf is given in table 11 with the mean differences with the experimental data while calculation by strip theory gives approximately 25 mean differences the urans coefficient method gives approximately 8 mean differences fig 13 reveals the heave and pitch tf graphs as is clearly seen in fig 13 the present method offers more accurate results than strip theory outputs as the froude number increases the motions in waves flowing around the ship become highly turbulent and nonlinear effects start to play an important role in such real flow problems the flow separation phenomena which occur around the bulbous bow and transom stern can only be calculated by considering the viscous effects since these effects are taken into account in a urans solver the radiation and excitation terms are expected to be predicted more precisely another important issue is that the excitation wave terms are assumed to be in sinusoidal form in potential strip theory in fact there is no such wave that has sinusoidal form because of the earth s gravity due to the possibility of generating more realistic waves by urans approach such as a fifth order stokes wave the urans approach has advantages over strip theory when computing the excitation terms the cpu times of the two methods urans fully and urans coefficient are also compared to each other for the 6th case in table 12 the comparison study is performed with a computer 10 core processor with 128 gb ram for the convergence of the pitch and heave time histories obtained by the urans fully method at least six periods are needed the main reason is that the equations of motion are solved in urans fully method using high order iterations in order to find the new position of the ship which may delay the convergence of the first harmonic of the signals additionally in the dfbi solver release and ramp time settings must be carefully identified on the other hand in the urans coefficient method the position of the ship is imposed harmonically which shortens the convergence of the first harmonic of the signals in fig 14 the time histories of pitch motion urans fully and forced pitch radiation moment urans coefficient are given for the 6th case 6 conclusion based on the numerical analyses using the urans approach a new solution approach to the vertical ship motion problem of a fast displacement ship form dtmb 5512 in regular head waves is presented in this paper the verification study is performed for the radiation problem 6th case the findings through the new method are compared with the corresponding outputs offered by the experiment strip theory and fully nonlinear urans calculations the new method presented in this study is potentially a significant alternative for the prediction of vertical ship motions with its accuracy and approximately 20 reduction in cpu time in comparison with fully nonlinear urans approach in addition obtaining radiation and excitation coefficients in the present method will ensure a better understanding of the underlying physics for ship motion problems knowledge of the coefficients with a high level of accuracy will provide a more robust mathematical model for other maritime disciplines such as control oriented studies in such a problem the calculation of retardation functions which are associated with the damping is significantly important for a more accurate prediction of fluid memory effects in the same way computation of the infinite frequency value of the added mass is also an important issue in the mathematical model for the controller design calculation of both radiation and diffraction terms by the urans approach may ensure more robust coefficients which may enhance the quality of the controller the authors suggest that the new method should be adopted for relatively fast and non slender bodies in future studies acknowledgment the first author was supported by aselsan graduate scholarship for turkish academicians appendix abstract of the validation and verification study implemented in the wigley hull computational prediction of hydrodynamic coefficients for heave motion ferdi cakici emre kahramanoglu suleyman duman ahmet dursun alkan yıldız technical university istanbul türkiye fcakici yildiz edu tr emrek yildiz edu tr sduman yildiz edu tr alkanad yildiz edu tr national defense university naval academy istanbul türkiye adalkan dho edu tr abstract in this study the hydrodynamic coefficients associated with heave motion are obtained by using unsteady reynolds averaged navier stokes urans approach the well known wigley hull is selected for the calculations of uncoupled added mass and damping coefficients a33 b33 in deep water numerical simulations are performed for six different oscillation frequencies at the froude number 0 3 first the 3d ship model is forced in the heave direction with certain frequencies and then the hydrodynamic coefficients are computed with the help of fourier series expansion numerical results are compared with those obtained by the experiments and strip theory the verification and validation study for the damping term is also performed by implementing the grid convergence index gci method keywords hydrodynamic coefficients urans wigley hull heave motion 
23274,in this study wave excitation and radiation terms in 2dof equations of vertical ship motion are obtained by using a urans solver based on the finite volume method the dtmb 5512 hull form is chosen for the calculations at the froude number of 0 41 numerical simulations are performed for 7 different regular wave conditions first in the regular wave the excitation heave force and pitch moment with the related phase angle are computed while the ship is fixed to heave and pitch motions then the body is forced to oscillate in the heave and pitch directions with a certain frequency and the radiation coefficients are obtained after finding the excitation and radiated terms the 2dof vertical ship motion equations are solved in the frequency domain and motion transfer functions are plotted the results are compared with those obtained through strip theory fully nonlinear urans approach and experiments the new urans based approach presented in this paper offers a more accurate prediction of vertical ship motions compared to strip theory outputs because it takes the viscous effects and free surface nonlinearities into account the new urans based approach can be considered as a better alternative to the fully nonlinear urans approach keywords vertical ship motions urans dtmb 5512 strip theory nomenclature a wave amplitude m b wl waterline breadth m c b block coefficient c m midship section coefficient fn froude number g gravitational acceleration ms 2 iy inertia moment of mass tonm2 k wave number m 1 l pp length between perpendiculars m l wl waterline length m n number of elements r refinement factor r convergence coefficient re reynolds number s wetted surface area m2 t draught m t e wave encounter period s ω wave frequency rad s ω e encounter wave frequency rad s v ship speed m s λ wave length m λm model scale δ mass ton ε difference between two scalars cfd computational fluid dynamics cfl courant friedrichs lewy cpu central processing unit dfbi dynamic fluid body interaction dof degree of freedom fs fourier series fvm finite volume method gci grid convergence index iihr hydroscience engineering the university of iowa n s navier stokes smp ship motion program tf transfer functions urans unsteady reynolds averaged navier stokes 1 introduction the vertical ship motion problem in regular or irregular waves is still one of the leading fields of investigation for the naval architect community the major complexities faced in this field are listed as follows 1 the second order velocity term on computing the hydrodynamic pressure 2 very high reynolds numbers are encountered and the potential method may fail in some certain cases 3 waves are not in a sinusoidal form due to the gravitational force in nature 4 potential based approaches may yield misleading results in the seakeeping performance prediction of non slender geometries 5 unsteady divergent wave systems generated by the ship may affect the ship motions in waves especially at high froude numbers in addition to these complexities considering time dependent measurements the experimental set up and execution of seakeeping tests are highly challenging issues which require qualified facilities and personnel and as well as high cost in comparison with steady state resistance experiments additional difficulties are listed below measurement of the amplitude of incident waves to the ship determination of certain values of the radius of gyration of the ship due to the increasing number of highly capable flow solvers with recent developments in computer hardware and software technology the researchers have been motivated to focus on alternative numerical methods which may support ship motion experiments and handle such challenging problems after the significant studies of froude and krylov researchers have incessantly continued to contribute to the solution of the ship motion problem froude 1861 krylov 1896 first ursell solved the linear boundary value problem of an oscillating circular cylinder on the free surface in the frequency domain ursell 1949a 1949b the velocity potential was represented as the summation of an infinite set of multipoles which satisfies the free surface boundary condition and each is multiplied by a coefficient to satisfy the body boundary condition ursell s remarkable studies paved the way for the theoretical exploration on ship motion problems his main assumptions were that the forward speed was assumed to be zero and the incident wave and body both oscillate with the same frequency tasai merged the conformal mapping transformation technique with ursell s studies in order to reach a solution for more realistic ship sections tasai 1959a 1959b tasai s method transforms the ship sections to a half circle using a scale factor and two or more mapping coefficients especially the ships with round bilge were correctly represented by this method however this method was not yet sufficient to produce adequate results for hulls like swath small waterplane area twin hull or hulls transom sterns or blunt or bulbous bows frank 1967 focused on this problem and developed a close fit method frank s method was a better option in representing the added mass and damping terms of the arbitrary ship sections since the solutions generated by this method were valid for the arbitrary cross sections velocity potential is represented by a distribution of sources on the mean submerged cross sections the method adopts green s function which satisfies the linear free surface boundary condition the density of the sources is an unknown function to be found from integral equations obtained by applying the body boundary condition frank 1967 however studies on the ship motion problem were limited with 1dof motion of a body in a fluid due to the difficulties in coupling the hydrodynamic coefficients to each other salvesen et al 1970 presented the original strip theory by using 2d hydrodynamic coefficients which are calculated by frank s method with strip theory it became possible to get transfer functions tf for the vertical motions of any 3d ship forms in regular waves strip theory is still a common method to run seakeeping analyses of ships and there are many studies in the literature implementing this theory the strip theory s agreement at low froude numbers and in slender bodies has been proven in many studies in the field however it is also shown that it loses its effectiveness both at higher froude numbers and beam length ratios as another numerical approach urans and the additional turbulence equations discretized by implementing finite volume method fvm have recently been used to predict vertical ship motions the leading research associated with urans was initiated by the study of sato et al 1999 they studied the coupled vertical motions for wigley and series 60 hull forms in regular head waves and compared the urans results with the experimental data although the cfd analyses results of the wigley hull are in agreement with the experiments they concluded that series 60 results do not conform to the experiments when the existing methods were evaluated beck and reed 2001 in their extensive work proposed that 3d urans methods are the best option to solve marine hydrodynamics problems since 2005 researchers from different countries have focused on solving ship motion problems with the urans method carrica et al 2006 studied the forward speed diffraction problem for the dtmb 5512 model in head seas for two different speeds and wave lengths they found that relatively short waves show nonlinear characteristics on heave forces and pitch moments with a remarkable second harmonic component in their following study carrica et al 2007 performed several urans analyses to calculate the heave and pitch motions of the same ship model in small and large amplitude regular head waves it should be noted that they were only interested in the encounter frequencies near the resonance region this study showed that transom wave breaks accompanied by extreme ship motions occur in large amplitude head waves irvine et al 2008 carried out numerous seakeeping experiments of coupled heave and pitch motions of dtmb 5512 in a towing tank and presented a very large database for the vertical motions weymouth et al 2005 performed seakeeping simulations for a wide range of froude numbers by using cfd and advised possible methods to be implemented the numerical simulations were carried out for a low wave slope range and the results were compatible with the experiments wilson et al 2008 also implemented the cfd method to achieve tf of the vertical responses of the s175 container ship in regular head waves bhushan et al 2009 carried out vertical ship motion analyses for both the model and full scale of the athena hull form simonsen and stern 2010 2013 prepared a comprehensive study by using cfd for many different types of ships for seakeeping calculations tezdogan et al 2015 investigated the behaviour of the vertical motions of a kcs kriso container ship in waves by performing full scale cfd simulations where their predictions were quite satisfactory ozdemir and barlas 2017 focused on resistance in calm water ship motions and they added the resistance calculations for the kvlcc2 model while their numerical prediction was in convincing agreement for resistance pitch and heave motions an accurate prediction was not achieved for added resistance calculations in waves the nonlinear urans approach was also used by many researchers to find the hydrodynamic coefficients regarding the added mass as well as the damping one of these studies was the work of querard et al 2009 where they dealt with the computations of added mass and damping of 2d sections calculations were done for a very wide frequency range the main focus of their work was to make a comparison with the results obtained by the potential theory and experiments conducted by vugts 1968 for the first time bonfiglio et al tried to obtain tf of the vertical motions by using a hybrid method assuming the linear mathematical model of the vertical motions they separated the radiation and excitation terms while radiation terms were calculated by performing urans excitation terms were calculated by the potential method the main disadvantage of the study was that they obtained the radiation terms for 2d ship sections then they used a strip theory method to get 3d radiation terms this process indeed increased the solution time bonfiglio et al 2016 in this study heave and pitch tf in regular head waves are obtained by using a new urans approach wave conditions are taken to be the same as with the experiments carried out in iihr irvine et al 2008 in the present solution method the total force and moments acting on the ship hull due to waves are considered in superposition of diffraction and radiation terms these terms are computed separately using the urans approach as a first step the ship is fixed to vertical ship motions while she encounters regular head waves excitation or diffraction forces based on several regular waves associated with heave and pitch directions are calculated by considering the first harmonics of the signals as a second step the ship is forced to oscillate in the heave and pitch directions with several frequencies radiation terms are calculated by considering the first harmonics of the signals as a final step using the linear 2dof vertical equation of motion the associated transfer functions are plotted for heave and pitch motions vertical motion tf graphs which were obtained by the present method are compared with fully nonlinear urans approach strip theory and the experimental data in the fully nonlinear urans approach the pitch and heave motions of the ship in regular head waves are calculated directly by using urans and dfbi equations detailed information about the fully nonlinear urans approach can be found cakici et al 2017a b ozdemir and barlas 2017 tezdogan et al 2015 simonsen et al 2013 simonsen and stern 2010 bhushan et al 2009 wilson et al 2008 carrica et al 2006 2007 weymouth et al 2005 sato et al 1999 the commercial cfd software star ccm is used to discretize the urans equations by implementing fvm the main purpose of this study is to compare different numerical approaches with each other in terms of accuracy and cpu hours this paper is organised as follows in chapter 2 the geometrical properties of the hull form and the simulation cases are presented in chapter 3 the mathematical model for the problem is given in chapter 4 cfd verification studies are given the results of the study are discussed in chapter 5 with the help of several graphs and tables finally in chapter 6 the concluding remarks of the study are briefly summarized 2 hull form and simulation cases the well known naval surface combatant dtmb 5512 in 1 46 588 model scale ratio is chosen for the hydrodynamic analyses the numerical simulations are performed for the bare hull condition the 3d view of the ship model with a sonar dome and a transom stern is shown in fig 1 the principal particulars of the ship model are given in table 1 simman 2014 all numerical simulations presented in the study are performed at the froude number of 0 41 representing a relatively high speed case in deep water seven different wave conditions are used in the study which correspond to the ratio of wave length over ship length varying between 0 66 and 2 30 the wave encounter frequency for head waves can be found through the use of 1 ω e ω ω 2 v g in equation 1 g denotes the earth s gravity ω denotes the frequency of the wave and v denotes the advance velocity of the ship small amplitude waves ak 0 025 are selected for cfd simulations to be the same as the experiments conducted by irvine et al 2008 where a denotes the wave amplitude and k denotes the wave number the wave number can be calculated by k 2 π λ here λ denotes the wave length it should be noted that the wave amplitudes which can be seen in table 2 are used for the wave amplitudes of the incoming waves when the excitation terms are calculated in addition the wave amplitudes refer to the oscillation amplitudes when the radiation terms are calculated in chapter 3 2 detailed information for the calculation of the excitation and radiation terms are given 3 mathematical model 3 1 governing equations the averaged continuity and momentum equations can be written for incompressible flow in cartesian coordinates and tensor form as indicated in equations 2 and 3 2 δu i δx i 0 3 ρ δu i δt u j δu i δx i δp δx i δτ δx j δ ρ u i u j δx j where ρ u i u j is the reynolds stress tensor u is the mean velocity vector u is the time varying velocity vector p is the mean pressure ρ is the density and μ is the dynamic viscosity 4 τ τ ij μ δu i δx j δu j δx i where τ ij are the mean viscous stress tensor components as shown in equation 4 in this paper the two equation k ε turbulence model is used in order to include the viscous effects as it is considered to be one of the most commonly used turbulence models for industrial applications querard et al 2008 besides it is cheaper in terms of computer memory compared to the k ω sst model which requires higher cpu time tezdogan et al 2015 querard et al 2008 the employed solver uses a finite volume method which discretizes the navier stokes n s and additional turbulence equations for the numerical model of fluid flow the segregated flow model is used in the urans solver and convection terms in the urans equations are discretized by implementing a second order upwind scheme the urans solver runs a predictor corrector simple type algorithm between the continuity and momentum equations in the analyses volume of fluid vof model is used to represent the deforming free surface in this model calculations are done for water and air phases because of the mesh structure and the number of elements having great importance in capturing the free surface deformations some refinements are made close to the free surface to accurately predict vof wave profiles a second order convection scheme is used to present the free surface profile more precisely for the unsteady terms a first order scheme is applied in the n s equations a summarized list of the numerical discretizations is given in table 3 3 2 calculation of hydrodynamic coefficients and excitation terms one can obtain heave and pitch displacements for relatively small motions and sinusoidal inputs by solving linear vertical motion equations in the time domain as given in equation 5 5 j 3 5 m ij a ij η j b ij η j c ij η j f i cos ω t β f o r i 3 5 where denotes mass or inertia a ij denotes added mass coefficients b ij denotes damping coefficients c ij denotes restoring coefficients f i denotes excitation terms and β denotes the phase angle between heave force and pitch moment also η j denotes the displacements η j denotes the velocities and η j denotes the accelerations in equation 5 all coefficients except for the restoring terms are computed using urans approach in three steps i the total of incoming and scattered wave terms in the heave direction f 3 and in the pitch direction f 5 are calculated for the time domain for several frequencies while the ship model is fixed in order to prevent pitch and heave motions in other words the hull is stationary after fourier analyses as explained in chapter 4 4 the first harmonics of heave forces and pitch moments based on regular waves are calculated the β phase angle between heave force and pitch moment is also recorded for each encounter frequency ii the ship model is forced to oscillate in the heave direction for several frequencies with the amplitude of a after fourier analyses and related statements in chapter 4 4 b 33 a 53 and b 53 are calculated for all encounter frequencies iii the ship model is forced to oscillate in the pitch direction for several frequencies with the wave slope of ak 0 025 after fourier analyses and related statements as in chapter 4 4 a 55 b 55 a 35 and b 35 are calculated for all encounter frequencies the restoring coefficients are taken from linear in house seakeeping software sarioz et al 2000 see table 4 with the solution to equation 5 in the frequency or time domain the heave and pitch transfer functions are plotted if the solution is carried out in the time domain the first harmonics of the heave or pitch motions have to be considered after the steady state solutions are reached 3 3 time step size determination the time step size is selected according to cfl number if any explicit unsteady simulations are carried out the cfl number for each cell is calculated by cfl uδt δx and should be less than or equal to 1 for numerical stability here u stands for the mesh flow speed δ t stands for the time step size and δ x stands for the mesh cell dimension however an implicit method is generally used for unsteady simulations if the solution domain is relatively large ittc 2014 in unsteady implicit problems the restriction imposed by the cfl condition is not a strict issue anymore which relaxes the memory required in the computer in this study time step size is selected to be 1 28 of t e for all analyses which is considered to be more accurate than the value recommended by ittc 2014 here t e denotes the encounter period the variation of time step size and the obtained results are given in chapter 4 3 4 computational domain and boundaries two computational domains of different sizes are used in the study the radiation forces and the moment are calculated using a square shaped computational domain while the forces and the moment resulting from the incoming waves are calculated in a rectangular shaped one see fig 2 and fig 3 the radiation waves caused by the harmonic motion of the hull propagate in all directions in the horizontal plane the upstream distance should be kept wide enough as should the downstream distance thus a square domain is chosen in the calculation of radiation forces and moments on the other hand the incoming wave propagates in the transverse direction and towards the downstream therefore a rectangular domain is preferred in order to calculate diffraction terms it should be noted that a square domain can be used for both of these radiation and diffraction problems however using two different domains is more economical considering cpu time it can also be noted that the grid structure around the hull is identical for both domains for the square solution domain an earth fixed xyz cartesian coordinate system is selected the xy plane represents the free surface which is initially assumed to be calm water in the draught of the model it should be noted that the x axis is aligned to parallel incoming waves and the z axis is the vertical axis normal to the xy plane on the other hand for the rectangular solution domain the xy plane represents the free surface which is initially assumed to be fifth order stokes waves fenton 1985 the incoming waves are represented as a fifth order wave because a fifth order wave is more successful in representing real regular waves compared to a first order wave the fluids water and air are considered to flow in the positive x direction the intersection of forward perpendicular and the free surface is set as the origin of the xyz cartesian coordinate system while the face in the negative x or upstream is selected as velocity inlet the face in the positive x or downstream is selected as pressure outlet to avoid the boundary effects the faces in the negative y positive z top and negative z bottom directions are considered as the velocity inlets ship boundaries are defined as no slip walls where the normal and tangential velocities are zero thus both the kinematic boundary condition and no slip condition are satisfied on the hull surfaces since the problem has a symmetrical behaviour according to y 0 only half of the computational domains is used for the simulations in order to reduce the computational cost hence the side face located at the xz plane where y 0 is assigned as a symmetrical boundary see figs 2 and 3 the computational domain dimensions are given in table 5 and table 6 3 5 grid resolution the computational domains are discretized with fvm using fully hexahedral elements local grid refinements are applied around the hull and near the free surface overset grid technique which has great capability to solve the flow around a moving body is used for all simulations reported in the study according to this method there are two different computational regions background and overset the grid system around the hull is created in overset region and is allowed to move freely as a whole without any modification or deformation unlike the other standard meshing techniques the information of the fluid particles e g velocity or pressure is transferred between the background and overset regions via overset boundaries although there are many options to transfer the flow properties between two regions linear interpolation is preferred in this study it is possible to find more detailed information for the use of overset grid techniques implemented in vertical ship motion problems tezdogan et al 2015 carrica et al 2007 cakici et al 2017a b total cell numbers for different grids are shown in table 7 which are used for the grid verification study on urans simulations of the radiation problem detailed information is given in chapter 4 grid structure around the hull can be seen clearly from fig 4 since a logarithmic universal velocity profile two layer all y wall treatment is used around the no slip wall boundaries the dimensionless wall y value is set to be in the range of 30 300 at the froude number of 0 41 by creating a structured hexahedral fine grid in the near wall boundary layer cd adapco 2014 the cell sizes are gradually increased with a fixed ratio starting from the boundary layer of the hull to the outer boundaries a transverse section plane is taken from x l 0 60 in order to show the structured grid very near to the hull see fig 5 it is cost effective to use a triangular grid structure in order to capture the free surface deformations for non zero speeds since the kelvin waves have a specific angle 19 28 and it is unnecessary to use rectangular refinement far from the hull therefore a kelvin wave adopted grid is applied in order to capture the wave patterns as shown in fig 6 3 6 fourier series expansion post processing in the determination of excitation and radiation terms is performed by using fourier series expansion method the fourier series process is one the most important parts of this study this method is used not only to represent instantaneous force moment histories but also to discretize their components unsteady time histories of forces moments φ t obtained by urans approach can be represented as follows in equation 6 6 φ t φ 0 n 1 n a n cos ω e t b n sin ω e t n 1 2 3 in equation 6 φ 0 ω e and φ n represent the zeroth harmonic of the signal encounter frequency and nth harmonic amplitude of the signal respectively here φ 0 also corresponds to the averaged value of the signal and it can be obtained by using equation 7 7 φ 0 1 t e 0 t e φ t d t for the tf approach only first harmonics are considered therefore the components of the instantaneous signal a1 and b1 were calculated by using equation 8 and equation 9 8 a 1 2 t e 0 t e φ t cos ω e t d t 9 b 1 2 t e 0 t e φ t sin ω e t d t in these equations t e denotes the sampling time first harmonic amplitude of the given signal is found using equation 10 10 φ 1 a 1 2 b 1 2 in all analyses the equations which are explained above are used in order to obtain the excitation and radiation terms wave excitation terms can be found in the following statement 11 f i φ 1 aξ where i 3 5 for heave force or pitch moment in this equation φ 1 may correspond to the first harmonic of the heave force or pitch moment and a is the amplitude of the motion if the excitation is in heave direction ξ is equal to 1 however if the excitation is in pitch direction ξ is equal to wave number k in order to find the phase angle β first harmonics of the heave and pitch motion are plotted and the related phase angle is recorded on the other hand for forced heave and forced pitch simulations the coefficients are derived as follows 12 a ij b 1 aξ c ij ω e 2 13 b ij a 1 ω e aξ where i 3 5 and j 3 5 for coupled heave and pitch motion in these equations a 1 and b 1 refer to the sine and cosine related component of the first harmonic querard et al 2008 a is the amplitude of the motion and a ij b ij and c ij represent the hydrodynamic coefficients which are related to added mass damping and restoring respectively if the forced heave motion is simulated ξ is equal to 1 however if the simulation is forced pitch ξ is equal to wave number k after the solution of equation 5 transfer functions of heave and pitch motions tf 3 and tf 5 can be obtained by using equation 14 and equation 15 14 tf 3 η 3 15 tf 5 η 5 k 4 cfd verification study the verification study is one of the most important steps in all computational fluid dynamics analyses in this chapter only the procedure of verification has been carried out as the procedure of validation cannot be carried out because of the lack of corresponding experimental data however a validation study was performed by the authors cakici et al 2018 for the radiation problem of the wigley hull by urans approach the abstract of this conference paper is given in the appendix of the study grid convergence method gci which is based on richardson extrapolation richardson 1910 is applied for the verification procedure this method was offered by roache 1998 and has been applied with some modifications in numerous studies the methodology which has been described by celik et al 2008 was implemented for the verification of time step and grid resolution the grid spacing and time step size are refined systematically refinement factor r is selected as 2 because it is often used in cfd applications tezdogan et al 2016 for each convergence study three solutions are considered and only one variable is changed tezdogan et al 2016 for instance the grid size is kept constant while the time step size is being refined systematically the procedure implemented in the present study is described below celik et al 2008 the difference between the solution scalars ε should be determined by equation 16 16 ε 21 φ 2 φ 1 ε 32 φ 3 φ 2 in these equations φ 1 φ 2 and φ 3 refer to the solution of fine medium and coarse mesh grid or time step size respectively convergence conditions of the numerical study can be calculated by equation 17 17 r ε 21 ε 32 the possible r values and possibilities are listed below stern et al 2006 a 1 r 0 oscillatory convergence b 0 r 1 monotonic convergence c r 1 oscillatory divergence d r 1 monotonic divergence if the values for convergence condition is like case a the procedure can be implemented however in case b often more than three solutions are needed and the uncertainty u k should be calculated as follows stern et al 2001 de luca et al 2016 18 u k 1 2 s u s l in equation 18 s u and s l are the maximum and minimum values of oscillation respectively if the convergence condition is like case c or d it is not possible to predict the uncertainty de luca et al 2016 stern et al 2001 the apparent order of p can be found by equation 19 celik et al 2008 19 p ln ε 32 ε 21 q ln r 21 here 20 q ln r 21 s r 32 s 21 s sgn ε 32 ε 21 the extrapolated value is 22 φ e x t 21 r p φ 1 φ 2 r p 1 the approximate relative error and extrapolated relative error are 23 e a 21 φ 1 φ 2 φ 1 e ext 21 φ ext 12 φ 1 φ ext 12 finally the gci index is calculated by 24 gci fine 21 1 25 e a 21 r 21 p 1 the total radiation force for forced heave motion in case 6 is selected for numerical uncertainties for grid uncertainty time step size is selected as the fine which is equal to te 28 on the other hand when the time step size uncertainty is calculated grid size is selected as the fine grid see table 7 the results of the verification study are given in table 8 in table 8 it can be seen that time step uncertainty is at an applicable level however in the grid verification case the convergence condition is between 1 and 0 oscillatory convergence therefore another grid resolution which is the finer grid is used in order to estimate the trend of oscillation according to obtained results it is still in oscillatory convergence range thus the uncertainty of grid spacing is calculated by equation 18 and the percentage of uncertainty is derived by simply dividing this result u k by the fine grid solution φ 1 5 results and discussion this chapter presents the numerical results and discussions on vertical motion computations in regular head waves of dtmb 5512 in deep water with figures and tables vertical ship motions obtained by the present method are compared with the experimental data of the same ship model irvine et al 2008 pitch and heave tf graphs at the froude number of 0 41 which were obtained by implementing urans fully cakici et al 2017acakici et al 2017a strip theory experiments and the present method named as urans coefficient are demonstrated in the figures the cfd analyses for the present method took approximately 11 5 h of wall clock time in a 10 core processor with 128 gb ram for five periods of simulations for each case in the present study as already underlined transfer functions of the vertical ship motions are executed with the new prediction method according to this method excitation and radiation terms are computed by urans approach separately then the linear 2dof mathematical model for the vertical motions is solved in the frequency domain and the associated transfer functions are plotted for pitch and heave motions before the discussion part it may be useful to give some information on the radiation problem in the study as is well known a rigid body moving with a non zero speed on the surface of an unbound infinite depth water creates a wave system called a kelvin pattern fig 7 left on the other hand the harmonic motion of a body in the vertical plane with zero advance speed behaves like a source and generates waves which start at the centre of motion and radiate away fig 7 right this is the main reason of the selection of the square domain rather than the rectangular domain on the other hand the wave propagates in the x direction for the diffraction problem therefore a rectangular domain can be used to reduce the computational cost as described in the previous chapters the ship model is forced to oscillate in heave and pitch directions at the froude number of 0 41 in calm water in order to calculate the radiation terms before obtaining radiation terms a study is carried out in order to show the positive and negative wave peaks due to forced heave with zero and non zero advance speeds the 6th case is chosen for this comparison first the analysis is run at the froude number of 0 41 in calm water and the wave peaks are recorded fig 7 left then the model is forced to make the heave motion at the froude number of 0 fig 7 right and the wave peaks are recorded as well since the maximum amplitude of the wave peaks takes place as a result of forced heave motion at the froude number of 0 which is relatively smaller than for the straight towing condition at the froude number of 0 41 it is very hard to observe the radiation waves in the dominant wave system as shown in fig 8 and table 9 a comparison between strip theory and the present method urans coefficient is made in terms of radiation and excitation terms in the calculation of a33 there are no remarkable differences observed between the present study and strip theory however small deviations at relatively higher encounter frequencies can be noticed from fig 9 a it is found that the discrepancies between the present study and strip theory are very large at relatively low encounter frequencies for a55 while the differences get smaller for higher values as seen in fig 9a the main reason for the deviations at low encounter frequencies between strip theory and urans may be caused by the speed correction term which excessively affects the value of a55 in the original strip theory formulation when the coefficient b33 is taken into consideration for the entire encounter frequency range the damping values by urans solutions are expected to be larger than those obtained by strip theory due to the fact that the urans approach takes the viscous effects and free surface non linearities into account see fig 9b however in the computation of coefficient b55 remarkable deviations can be seen between the present study and strip theory at relatively low encounter frequencies as already pointed out the speed correction term in strip theory formulation leads to an increase in damping moment at lower frequencies but its effect vanishes as the frequencies get higher see fig 9b detailed information on the speed correction terms in strip theory formulations can be found in the paper of salvesen et al 1970 for calculation of the coupled coefficients and excitation term phases in the present paper interesting findings such as below were observed in the paper of salvesen et al 1970 the coordinate system is defined as x and forward speed directions are to be the same however in the present study x and forward speed directions are defined as being opposite see figs 2 and 3 the differences in the definition of the coordinate systems cause remarkable deviations when obtaining the coupled coefficients as seen in fig 10 a and fig 10b the phase angle between heave force and pitch moment are also affected by that reversed definition with a remarkable deviation as seen in fig 11 and fig 12 for case 6 the pitch moment and heave force time series for the first harmonic of urans coefficient and strip theory are shown in fig 11 for the unit amplitude wave as can be seen the phase angle between pitch and heave motions has opposite signs for the urans coefficient and strip theory the first peak of the pitch moment based on incoming waves is observed earlier than the heave force for almost the entire encounter frequency range in contrast to smp as for the magnitudes of the excitation terms the deviations are very small at relatively lower encounter frequencies however as the encounter frequencies increase the differences between urans and strip theory increase due to strong non linearities at the high frequencies as demonstrated in fig 12 all the coefficients obtained by urans approach are tabulated in table 10 comparison of the heave and pitch tf is given in table 11 with the mean differences with the experimental data while calculation by strip theory gives approximately 25 mean differences the urans coefficient method gives approximately 8 mean differences fig 13 reveals the heave and pitch tf graphs as is clearly seen in fig 13 the present method offers more accurate results than strip theory outputs as the froude number increases the motions in waves flowing around the ship become highly turbulent and nonlinear effects start to play an important role in such real flow problems the flow separation phenomena which occur around the bulbous bow and transom stern can only be calculated by considering the viscous effects since these effects are taken into account in a urans solver the radiation and excitation terms are expected to be predicted more precisely another important issue is that the excitation wave terms are assumed to be in sinusoidal form in potential strip theory in fact there is no such wave that has sinusoidal form because of the earth s gravity due to the possibility of generating more realistic waves by urans approach such as a fifth order stokes wave the urans approach has advantages over strip theory when computing the excitation terms the cpu times of the two methods urans fully and urans coefficient are also compared to each other for the 6th case in table 12 the comparison study is performed with a computer 10 core processor with 128 gb ram for the convergence of the pitch and heave time histories obtained by the urans fully method at least six periods are needed the main reason is that the equations of motion are solved in urans fully method using high order iterations in order to find the new position of the ship which may delay the convergence of the first harmonic of the signals additionally in the dfbi solver release and ramp time settings must be carefully identified on the other hand in the urans coefficient method the position of the ship is imposed harmonically which shortens the convergence of the first harmonic of the signals in fig 14 the time histories of pitch motion urans fully and forced pitch radiation moment urans coefficient are given for the 6th case 6 conclusion based on the numerical analyses using the urans approach a new solution approach to the vertical ship motion problem of a fast displacement ship form dtmb 5512 in regular head waves is presented in this paper the verification study is performed for the radiation problem 6th case the findings through the new method are compared with the corresponding outputs offered by the experiment strip theory and fully nonlinear urans calculations the new method presented in this study is potentially a significant alternative for the prediction of vertical ship motions with its accuracy and approximately 20 reduction in cpu time in comparison with fully nonlinear urans approach in addition obtaining radiation and excitation coefficients in the present method will ensure a better understanding of the underlying physics for ship motion problems knowledge of the coefficients with a high level of accuracy will provide a more robust mathematical model for other maritime disciplines such as control oriented studies in such a problem the calculation of retardation functions which are associated with the damping is significantly important for a more accurate prediction of fluid memory effects in the same way computation of the infinite frequency value of the added mass is also an important issue in the mathematical model for the controller design calculation of both radiation and diffraction terms by the urans approach may ensure more robust coefficients which may enhance the quality of the controller the authors suggest that the new method should be adopted for relatively fast and non slender bodies in future studies acknowledgment the first author was supported by aselsan graduate scholarship for turkish academicians appendix abstract of the validation and verification study implemented in the wigley hull computational prediction of hydrodynamic coefficients for heave motion ferdi cakici emre kahramanoglu suleyman duman ahmet dursun alkan yıldız technical university istanbul türkiye fcakici yildiz edu tr emrek yildiz edu tr sduman yildiz edu tr alkanad yildiz edu tr national defense university naval academy istanbul türkiye adalkan dho edu tr abstract in this study the hydrodynamic coefficients associated with heave motion are obtained by using unsteady reynolds averaged navier stokes urans approach the well known wigley hull is selected for the calculations of uncoupled added mass and damping coefficients a33 b33 in deep water numerical simulations are performed for six different oscillation frequencies at the froude number 0 3 first the 3d ship model is forced in the heave direction with certain frequencies and then the hydrodynamic coefficients are computed with the help of fourier series expansion numerical results are compared with those obtained by the experiments and strip theory the verification and validation study for the damping term is also performed by implementing the grid convergence index gci method keywords hydrodynamic coefficients urans wigley hull heave motion 
