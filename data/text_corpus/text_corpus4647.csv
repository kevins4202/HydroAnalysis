index,text
23235,with the need to integrate renewable energy sources into the current energy portfolio and the proximity of power consumers to ocean coastlines it is important to evaluate marine energy systems specifically wave energy converters wecs as potential solutions for meeting electricity needs the ability to model these systems computationally is vital to their eventual deployment the power development economics grid integration requirements operations and maintenance requirements and ecological impacts must be understood before these devices are physically installed however the research area of wec array optimization is young and the few available results of previously implemented optimization methods are preliminary the purpose of this work is to introduce a new wec array optimization framework to explore systems level concerns specifically wec layout and device spacing a genetic algorithm approach that utilizes an analytical hydrodynamic model and includes an array cost model is presented and the resulting optimal layouts for a preliminary test case are discussed this initial work is integral in providing an understanding of device layout and spacing and is a foundational starting point for subsequent and more advanced wec array optimization research keywords offshore energy marine energy wave energy converters array optimization genetic algorithms 1 introduction as demand for electricity changes and as communities seek to continually improve the quality of life and affluence of the growing population the development and optimization of new clean energy sources is of paramount importance of potential sources ocean waves have a vast amount of energy and for the last few decades research and development regarding the harnessing of this energy has been ongoing however the economics of developing implementing and maintaining wave energy converters wecs is lacking particularly considering sea state volatility over the lifetime of wecs as the industry moves towards ocean deployment of full scale grid connected wecs an a priori optimization of the theoretical power system including contributing factors such as power development cost and system parameters is required especially when demonstrating viability to stakeholders current wec array layout research considers only array power development resulting in a lack of realism that precludes application of these approaches in deployment situations by offshore energy developers fitzgerald and thomas 2007 bellew et al 2009 snyder and moarefdoost 2014 ricci et al 2007 child and venugopal 2010 child et al 2011 the primary information missing from current wec array optimization work is array economics however at this early stage of development there is limited information about the various costs of wec arrays despite this current limitation it is important that any wec array optimization framework incorporates cost modeling that can be updated as such information becomes available and accuracy improves this article presents a means of finding a wec array configuration that optimizes conflicting objectives using a genetic algorithm optimization method first we will discuss previous approaches that have been used to generate wec array layouts followed by a discussion of our developed optimization method a genetic algorithm approach next the objective formulations of cost and power will be presented finally initial results of a preliminary wec array optimization study using a binary genetic algorithm will be shown involving five devices in a random unidirectional sea state since our previous work explores the inclusion of array economics in a binary genetic algorithm ga to generate optimal layouts sharp and dupont 2015a 2015b the work presented here further investigates the significance of adjusting the prescribed minimum separation distance on an array s interaction factor as well as comparing the results with those of existing research 2 previous approaches much of the research in wec array configuration draws upon lessons learned from the wind industry particularly the effect of a device on its neighbors however unlike wind turbines where nearby devices negatively affect the power production of surrounding turbines wec interactions have the capability to increase the electricity produced by an array mcnatt et al 2014 wolgamot et al 2012 achieving an interaction factor q greater than one has been the driving goal of current array optimization work this demonstrates that array power production is greater than the power produced by the same number of devices acting in isolation weller et al 2010 borgarino et al 2011 goteman et al 2015 babarit investigates the interaction factor between single pairs of devices and arrays of devices noting that while it is possible to achieve positive interaction factors in regular waves the introduction of irregular waves limits this possibility the potential for negative interaction between devices in tightly spaced arrays is discussed babarit 2010 2013 weller et al found that positive interaction between devices due to proximity are reduced with increasing significant wave height weller et al 2010 borgarino et al suggests that the interaction between devices leads to triangular shaped arrays achieving a greater value of q than square based shapes due to masking borgarino et al 2011 göteman et al looks at optimizing an array with a large number of devices they note that arrays are important for limiting power output fluctuation and the clustering of point absorber type devices within an array will help with minimizing energy output variation goteman et al 2015 without the use of optimization methods to better account for the factors influencing the configuration of a wec array many wec layouts presented in previous literature have been chosen based on a researcher s educated judgment and then evaluated for power and interaction effects as an example vicente et al considers several configurations of wecs single line hexagonal triangular square and offset line vicente et al 2013 through evaluating these different arrangements and applying waves from different directions the authors conclude that an increase in the interaction factor will not drive the design of array layouts but rather factors such as cost and mooring will most influence layout configuration decisions additionally nambiar et al utilized empirically derived variations of radial layouts in the evaluation of cost associated with different electricity transmission options however while these works explored cost considerations of wec arrays the layouts presented were not explicitly optimized with cost as an objective function nambiar et al 2015 introductory research has been conducted utilizing optimization methods for wec layout design mcguinness and thomas implemented an analytical method to optimize the spacing between heave constrained spherical point absorbers that are in a line parallel to the oncoming wave mcguinness and thomas 2015 however it is challenging to include realistic complexities regarding device type and arrangement in a purely analytical method in later work they further explored the behavior of three devices in a line perpendicular to the incident wave and show the great variability that can come in power development based on a regular or an irregular sea state mcguinness et al 2017 the initial primary research used for array optimization comparison was conducted by child and venugopal 2010 they have presented two methods for optimizing wec layouts each considering five truncated wec cylinders similar to fig 8 vertically constrained to act in heave the first method parabolic intersection pi involved placing down wave devices in the parabolic wake of the up wave devices fig 1 a shows an example array achieved by this method in addition to the parabolic intersection method a genetic algorithm approach within matlab s optimization toolbox was used this method limited to 50 generations achieved configurations such as the layout shown in fig 1b child and venugopal 2010 this baseline work allows for further exploration regarding implementing more advanced optimization techniques in wec array design more recently wu et al demonstrated an improvement in their optimization efficiency when considering a three tether submerged buoy array a variation of an evolutionary algorithm and a covariance matrix adaption based evolutionary strategy were both utilized for this specific device type and single frequency an interaction factor gain was shown that increases the speed of the optimization process compared to their previous work wu et al 2016 sarkar et al have also completed work in array optimization specifically of oscillating surge type devices using machine learning and a genetic algorithm they state that for these types of devices clustering should be avoided but that a positive interaction can be attained between the devices sarkar et al 2016 ferri considers a covariance matrix adaptation evolutionary strategy cma es and a metamodel algorithm mm in order to compare computational expense and developed power the mm is found to be able to converge rapidly but was not accurate though it could be potentially used as an initial step if paired with a more accurate method in a second phase ferri and cork 2017 giassi et al has also investigated the optimization of a wec array where the diameter of the device and the gridded spacing of the devices was varied the results indicate that the changing of a device s diameter primarily affects the cost of a device not the power development of a device however varying the mass has a greater impact on the power developed giassi et al 2017 bozzi et al considers annual energy production hydrodynamic interaction and electrical interaction in connection with array configuration assuming a small array they show that the optimum layouts for their experienced sea states are in the shape of a rhombus or a line bozzi et al 2017 the referenced work serves as a starting point for wec array optimization research and the goal of our current work is to expand the capability of wec array optimization methods and to increase fidelity of models employed specifically cost consideration and advanced input parameters the following sections discuss our novel genetic algorithm approach for finding optimal wec arrays and show preliminary results using a similar problem formulation to that of child and venugopal 2010 3 genetic algorithm approach we used a ga approach because of its ability to efficiently converge on optimal solutions while considering continuous and discrete factors system optimization with gas is not a new method however the application of such an optimization method in the realm of wave energy converter array design is novel additionally our presented ga was developed specifically to be tuned for this challenge applications in the analogous field of wind energy turbine array optimization indicate the need for distinctively implemented algorithms dupont and cagan 2010 in this section we will give an overview of the workings of our ga discussing the features that are uniquely important to our problem of optimizing an array of wecs within a binary grid to evaluate and compare different possible layouts an objective function that includes both cost and power is created and utilized the multi objective formulation shown in eq 1 reflects the trade off between cost and power as demonstrated by previous research dupont and cagan 2010 mosetti et al 1994 grady et al 2005 1 objective function cost p 20 in this objective function the values of cost and p 20 represent the cost of and power generated by an array over a 20 year lifetime throughout the search the objective function is minimized and the units are cents per kilowatt as cost models achieve increased robustness eq 1 could readily represent a lifetime average cost of energy and could be used for comparing wave energy against sources such as wind or solar for this specific study the cost does not impact the layouts due to the simplicity of the cost model and the number of wecs being fixed unfortunately current cost models do not exist that allow for greater fidelity when considering an array of devices at this current stage of wec array optimization research we are considering a scenario that allows for better comparison with previous research which only considers for a fixed number of devices fixing the number of devices allows us to acquire a better understanding of other influencers on the configuration of wecs in an array inclusion of the cost in the objective function provides a placeholder for future implementation of improved cost models as they are developed as an evolutionary optimization algorithm a ga mimics the passing of traits from parents to children with mutations preventing local optima convergence utilizing stochastic attributes such as generating a random parent solution population improves the ga s performance in the implemented algorithm several tunable parameters exist elitism crossover and mutation an individual parent represents a unique array solution fig 2 shows how the arrays are represented as strings for the ga each cell of an individual parent string correlates to a section of the ocean and includes either a one indicating a wec s existence in that ocean section or a zero indicating the lack of a wec s existence in that ocean section the binary ga readily evaluates the minimum separation distance between devices a previously unexplored aspect of array design the effects of the minimum separation distance are shown in section 7 1 once generated the random initial parents are evaluated and ranked by objective function eq 1 the elitism function clones an upper percentage of the sorted parent population by copying potential solutions directly to the children set to balance this elitism the same percentage of lowest ranked solutions are removed from the parent set after elitism pairs of solutions in the parent population are mated via crossover because the wecs are located sparsely throughout the space and the number of devices is constrained to a set value multi point crossover is intractable instead our integrated method creates the crossed over children population by placing wecs in locations extracted from pairs of parent population solutions this method of crossover ensures that the number of wecs within each new layout remains constant by equally exchanging devices between two solutions to create two new unique solutions specifically children solutions are created in pairs by randomly selecting device locations from two parent solutions and combining them in a manner that creates two new solutions which have devices in locations that are extracted from each parent essentially if a new child solution is examined it will have device s that are in the exact position s as one of the parents and device s that are in the exact position s as the other parent no child solution s device location will be entirely unique when comparing against the parents however the child solution as a whole will be unique assuming the two parent solutions weren t identical to begin with fig 3 demonstrates the implemented crossover method the selection of wec locations to swap is tunable selecting the number of wec locations to swap and random selecting which locations will be swapped crossover is performed on a defined upper percentage of the parent population including the parent solutions used for elitism with crossover complete mutation is performed on the resulting children for mutation randomly selected devices in a small percentage of randomly selected solutions receive new locations this is achieved by first randomly selecting a cell from a randomly selected solution and changing the contained value since we are operating with a binary convention the cell contains either a 1 indicating a wec or a 0 indicating the absence of a wec depending on the selected cell s value either a 0 or a 1 a cell in the same solution but with the opposite value is also randomly selected and its value changed to maintain the required number of devices within the solution after elitism crossover and mutation and only if necessary the children population is filled with randomly generated layouts so that the same number of solutions as the parent population is attained the children population solutions are then evaluated using the objective function shown in eq 1 and ranked according to this objective function evaluation after ranking the population is evaluated for convergence elitism ensures that the solution with the best objective function is maintained or updated between populations consequently convergence is defined as a percentage of the population having an identical layout and objective function to the best solution once convergence is attained the algorithm returns the converged solution as the reported optimal array layout if convergence is not attained the children population becomes the next parent population and the process continues fig 4 shows the pseudocode for the ga used in our work 4 modeling there are two models used for the objective function in this research one for the development of array power and one for array economics computational models calculate and predict the necessary factors of array layouts and the accuracy of the optimization method depends on the accuracy of the models utilized 4 1 power model in previous research power has been the driving consideration for determining optimal device arrangements this emphasis is due to the vast availability of the wave energy resource and the potential ability of wec arrays producing more power than the same number of devices in isolation specifically work in array design has focused on maximizing the interaction factor q eq 2 defines q as deandrés et al 2014 2 q p array n p isolated p array represents the total power produced by an array of devices p isolated is the power of a single device acting in isolation and n is the number of devices in the array in scenarios where multiple wecs interact with the incident ocean waves the value of q has been theoretically found to be greater than one borgarino et al 2011 such a value of q indicates that devices could positively impact array power development when placed in specific layouts when an incident wave encounters a floating body in this case a wec two behaviors affect the value of q first the object begins to bob and waves radiate away from the body like the ripples from a stone thrown into a pond second the incident waves pile up and bend around the device consequently the wave height increases if devices are placed to benefit from these radiated and diffracted waves the device can generate more power than it would in isolation mcnatt et al 2014 existing software approaches such as the linear wave body software wamit 2012 can be used to calculate the power produced by an array of devices in a given sea state but this software is prohibitively computationally expensive for use within an iterative optimization method alternatively mcnatt et al has created a novel method for calculating power produced by an array of wecs that utilizes wamit once for a given device geometry and then analytically calculates the power produced for different array configurations mcnatt et al 2014 the damping added mass and hydrostatic matrices of a wec in isolation are determined using wamit these hydrodynamic properties are found for a specific device geometry and water depth as well as for a range of wave periods and directions fig 5 shows the behavior of a single device in a wave field using the hydrodynamic properties of a single device generated in wamit the analytical model described in mcnatt et al 2014 extrapolates these effects to multiple devices in an array accounting for the orientation of each device the complex excitation force and damping of the entire array is found using the scattered waves of a plane incident wave and the radiated wave coefficients mcnatt et al 2014 with this information the power developed by an array is found using eq 3 cruz 2008 3 p 1 8 x b 1 x in eq 3 x is the complex excitation force and b is the damping of the array for this work the damping of the power take off is fixed for all devices in the array 4 2 cost model the cost associated with developing deploying and maintaining a wec array should be included in an algorithm s objective function but has been previously neglected in wec array optimization work considering only an array s power development as a system objective lacks the realism necessary for wave energy industry s success the cost model used in our optimization work comes from sandia national lab s snl s reference model project rmp previsic 2012 while not a calculating tool specifically this reference model includes subsets of costs for different wec array nameplate capacities there are many assumptions involved but these are explicitly stated within the rmp and the rmp can be readily updated as new information becomes available figs 6 and 7 show examples of information provided by the rmp for our developed optimization method the cost equation was formulated by fitting a polynomial to the information provided by snl s rmp and is shown in eq 4 the values of the rmp are based on reference model 3 which is a variation of a heaving point absorber previsic 2012 4 cost 3 10 7 n 0 6735 in eq 4 the cost in usd of an array is based solely on n the number of devices in an array this formulation serves as a placeholder which we will update with new information as it is developed sharp and dupont 2015a due to the offshore renewable energy sector being in its early stages the economics involved are often unknown or are intellectual property we understand that eq 4 is limited and recognize that the economics of arrays will greatly if not primarily influence future development of wec array design it is therefore important to include whatever knowledge is currently available regarding the economics of an array sharp and dupont 2015c 5 problem formulation to achieve our preliminary results five scaled truncated cylinders are placed in a bretschneider spectrum of unidirectional waves the heave constrained cylinders represent point absorber type wecs acting in the vertical direction and the unidirectional waves indicate that the incident waves come from a single cardinal direction placed in a water depth of 8 m the cylinders have a diameter of 2 m and a draft of 1 m as shown in fig 8 we used a scaled system with the same device geometry sea state and water depth as child and venugopal 2010 to better compare against child and venugopal s previous work the incorporated bretschneider spectrum had a modal frequency of 0 2 hz a significant wave height of 2 m and periods ranging from 4 s to 8 s again these parameters were chosen based on the work of child and venugopal 2010 to facilitate comparison the parameters used to achieve the preliminary results are shown in table 1 since information on the minimum distance between devices is unknown this minimum separation distance is deliberately varied for each case the chosen values indicate the scaled nature of our problem formulation wecs are placed in a 10 10 grid that has 100 different potential wec locations resulting in over 9 109 total potential layouts the population size was chosen to balance computational efficiency and potential solution diversity since a ga is a population based optimization method that doesn t guarantee global optimality we keep the algorithm from converging too quickly by having a large enough population however we also the unidirectional wave field and single degree of freedom wec implementation serve as a test case for proving the efficacy of our ga method as we adjust the minimum spacing requirement the size of the represented physical space changes accordingly the smallest being 30 m by 30 m case 1 and the largest being 60 m by 60 m case 4 6 results fig 9 12 show the suggested arrays developed from the four test cases listed in table 1 for each test case we ran the algorithm ten times the results shown are those with the best overall objective function evaluation for each test case and also appeared consistently throughout each individual case for all the test cases waves are unidirectional coming from the west or directly from the left in figs 9 12 for each of the results presented the interaction factor q is calculated as described in eq 2 and the values are shown in table 2 7 discussion utilizing a scaled test case scenario our binary genetic algorithm determined optimal layouts for four different allowable minimum separation distances when designed in an informed way the layout of wec devices in an array scenario can increase power production through device interaction as well as potentially minimize the involved cost through shared infrastructure prior to our work wec array design research considered maximizing an array s power production with little understanding of the influence of device spacing on said power production as a note the results shown in figs 9 12 were found by running the algorithm ten times per case the results shown are not only the best found from these runs but were also found repeatedly additionally every start of the algorithm begins with a unique set of random initial parents to minimize the possibility of population takeover 7 1 spacing effect when considering the deployment of devices in real sea scenarios we must allow for a watch circle around individual devices to prohibit or minimize physical contact with other devices and entanglement of mooring systms examining the depicted arrays in figs 9 12 varying shapes are observed depending on the minimum allowable distance between wecs in case 1 when restricted to a 3 m minimum separation distance the devices line up in pairs parallel to the oncoming wave however when the minimum distance increases to 6 m the converged layouts place themselves in a diamond shape with one corner pointing towards the oncoming incident wave this transition is due to the dissipation of radiated waves as discussed in section 4 1 a device can alter the wave field and power experienced by its neighbors through its radiated and diffracted waves for the 3 m separation distance shown in fig 9 the devices appear to be utilizing the radiated waves of their immediate up wave neighbors however with increased separation distance the wecs place themselves to benefit from their neighbor s diffracted waves as indicated by the interaction factors reported in table 2 the overall optimal layout occurs when devices capitalize on upstream radiated waves an increase in allowable minimum separation distance initially generates layouts with worse q values until the diffracted waves can be effectively captured at which point the interaction factor increases again it is important to note that if different parameters are used in the applied bretschneider spectrum resulting layouts would differ from these shown borgarino et al 2011 also the difference in layout configurations based on the minimum separation distance is likely directly related to the sea state that the initial individual wec experiences if we consider what might happen at a large scale 7 2 comparison to results of previous research our results validate the ability of our created optimization method to find array arrangements that maximize power produced as was presented in section 2 child and venugopal utilized two methods for optimizing a layout as shown in fig 1 child and venugopal 2010 table 3 shows the comparison of the objective function evaluation of case 4 to those layouts shown in fig 1 case 4 was chosen for comparison due to a similar minimum separation distance 6 m between devices as seen in child and venugopal 2010 to ensure a more equivalent comparison we calculated the interaction factors of all three layouts using our presented power model when comparing the interaction factors from table 3 the wec arrangement found by our method achieves a higher interaction factor than the example layouts from child venugopal it should be noted that the interaction factor found for the results of child venugopal when using the method presented in this article differ from their reported interaction factors 0 9961 versus 1 787 for the parabolic intersection pi method and 0 9942 versus 2 1010 for the matlab ga method child and venugopal 2010 this indicates that the power is being calculated in a different manner than what we have presented additionally the referenced results from the parabolic intersection and matlab ga methods use a regular wave set rather than the bretschneider spectrum utilized by our presented optimization method these differing wave fields would also affect the power developed we chose to utilize the bretschneider spectrum for this comparison to include some realistic complexity 8 conclusion in wec array development the optimal layout for devices is determined to be dependent on the local sea state device design and geometry the minimum distance between devices and costs based on local information additionally for array optimization work to remove industry implementation barriers all factors that impact the wec array system should be accurately modeled currently power is the driving factor regarding array configurations we have shown our optimization method to be useful for generating theoretical wec arrays that maximize power by achieving interaction factors greater than one our preliminary ga results show the capability of this method to aid the industry in better understanding optimal arrangement offshore renewable energy industries are in relatively early stages of research and development as such the economic factors and their corresponding influence are not well known yet cost will likely be a driving factor of grid connected layout design as such it is vital to prepare for the inclusion of up to date cost models when they become available eq 4 represents an introductory cost model that is consistent to similar research that can be easily updated this work demonstrates the effect that radiated and diffracted waves can have on an array s optimal layout if for instance a minimum spacing requirement is implemented to minimize harmful physical interaction or to allow for easier operations and maintenance comparing against previous work shows that using our genetic algorithm approach created specifically for wec array optimization will provide results with improved interaction factors using an objective function similar to previous research but with the inclusion of cost future work will involve removing simplifications such as discretized space wave direction and fixed number of devices also as cost and power models are improved and environmental impact models created we will update the algorithm accordingly acknowledgments this work was funded by the us department of energy award ee 0006816 oregon state university and the oregon built environment sustainable technologies center inc oregon best under the nw energy experience prize the authors would also like to thank cameron mcnatt for his assistance in the generating of the wec hydrodynamic properties 
23235,with the need to integrate renewable energy sources into the current energy portfolio and the proximity of power consumers to ocean coastlines it is important to evaluate marine energy systems specifically wave energy converters wecs as potential solutions for meeting electricity needs the ability to model these systems computationally is vital to their eventual deployment the power development economics grid integration requirements operations and maintenance requirements and ecological impacts must be understood before these devices are physically installed however the research area of wec array optimization is young and the few available results of previously implemented optimization methods are preliminary the purpose of this work is to introduce a new wec array optimization framework to explore systems level concerns specifically wec layout and device spacing a genetic algorithm approach that utilizes an analytical hydrodynamic model and includes an array cost model is presented and the resulting optimal layouts for a preliminary test case are discussed this initial work is integral in providing an understanding of device layout and spacing and is a foundational starting point for subsequent and more advanced wec array optimization research keywords offshore energy marine energy wave energy converters array optimization genetic algorithms 1 introduction as demand for electricity changes and as communities seek to continually improve the quality of life and affluence of the growing population the development and optimization of new clean energy sources is of paramount importance of potential sources ocean waves have a vast amount of energy and for the last few decades research and development regarding the harnessing of this energy has been ongoing however the economics of developing implementing and maintaining wave energy converters wecs is lacking particularly considering sea state volatility over the lifetime of wecs as the industry moves towards ocean deployment of full scale grid connected wecs an a priori optimization of the theoretical power system including contributing factors such as power development cost and system parameters is required especially when demonstrating viability to stakeholders current wec array layout research considers only array power development resulting in a lack of realism that precludes application of these approaches in deployment situations by offshore energy developers fitzgerald and thomas 2007 bellew et al 2009 snyder and moarefdoost 2014 ricci et al 2007 child and venugopal 2010 child et al 2011 the primary information missing from current wec array optimization work is array economics however at this early stage of development there is limited information about the various costs of wec arrays despite this current limitation it is important that any wec array optimization framework incorporates cost modeling that can be updated as such information becomes available and accuracy improves this article presents a means of finding a wec array configuration that optimizes conflicting objectives using a genetic algorithm optimization method first we will discuss previous approaches that have been used to generate wec array layouts followed by a discussion of our developed optimization method a genetic algorithm approach next the objective formulations of cost and power will be presented finally initial results of a preliminary wec array optimization study using a binary genetic algorithm will be shown involving five devices in a random unidirectional sea state since our previous work explores the inclusion of array economics in a binary genetic algorithm ga to generate optimal layouts sharp and dupont 2015a 2015b the work presented here further investigates the significance of adjusting the prescribed minimum separation distance on an array s interaction factor as well as comparing the results with those of existing research 2 previous approaches much of the research in wec array configuration draws upon lessons learned from the wind industry particularly the effect of a device on its neighbors however unlike wind turbines where nearby devices negatively affect the power production of surrounding turbines wec interactions have the capability to increase the electricity produced by an array mcnatt et al 2014 wolgamot et al 2012 achieving an interaction factor q greater than one has been the driving goal of current array optimization work this demonstrates that array power production is greater than the power produced by the same number of devices acting in isolation weller et al 2010 borgarino et al 2011 goteman et al 2015 babarit investigates the interaction factor between single pairs of devices and arrays of devices noting that while it is possible to achieve positive interaction factors in regular waves the introduction of irregular waves limits this possibility the potential for negative interaction between devices in tightly spaced arrays is discussed babarit 2010 2013 weller et al found that positive interaction between devices due to proximity are reduced with increasing significant wave height weller et al 2010 borgarino et al suggests that the interaction between devices leads to triangular shaped arrays achieving a greater value of q than square based shapes due to masking borgarino et al 2011 göteman et al looks at optimizing an array with a large number of devices they note that arrays are important for limiting power output fluctuation and the clustering of point absorber type devices within an array will help with minimizing energy output variation goteman et al 2015 without the use of optimization methods to better account for the factors influencing the configuration of a wec array many wec layouts presented in previous literature have been chosen based on a researcher s educated judgment and then evaluated for power and interaction effects as an example vicente et al considers several configurations of wecs single line hexagonal triangular square and offset line vicente et al 2013 through evaluating these different arrangements and applying waves from different directions the authors conclude that an increase in the interaction factor will not drive the design of array layouts but rather factors such as cost and mooring will most influence layout configuration decisions additionally nambiar et al utilized empirically derived variations of radial layouts in the evaluation of cost associated with different electricity transmission options however while these works explored cost considerations of wec arrays the layouts presented were not explicitly optimized with cost as an objective function nambiar et al 2015 introductory research has been conducted utilizing optimization methods for wec layout design mcguinness and thomas implemented an analytical method to optimize the spacing between heave constrained spherical point absorbers that are in a line parallel to the oncoming wave mcguinness and thomas 2015 however it is challenging to include realistic complexities regarding device type and arrangement in a purely analytical method in later work they further explored the behavior of three devices in a line perpendicular to the incident wave and show the great variability that can come in power development based on a regular or an irregular sea state mcguinness et al 2017 the initial primary research used for array optimization comparison was conducted by child and venugopal 2010 they have presented two methods for optimizing wec layouts each considering five truncated wec cylinders similar to fig 8 vertically constrained to act in heave the first method parabolic intersection pi involved placing down wave devices in the parabolic wake of the up wave devices fig 1 a shows an example array achieved by this method in addition to the parabolic intersection method a genetic algorithm approach within matlab s optimization toolbox was used this method limited to 50 generations achieved configurations such as the layout shown in fig 1b child and venugopal 2010 this baseline work allows for further exploration regarding implementing more advanced optimization techniques in wec array design more recently wu et al demonstrated an improvement in their optimization efficiency when considering a three tether submerged buoy array a variation of an evolutionary algorithm and a covariance matrix adaption based evolutionary strategy were both utilized for this specific device type and single frequency an interaction factor gain was shown that increases the speed of the optimization process compared to their previous work wu et al 2016 sarkar et al have also completed work in array optimization specifically of oscillating surge type devices using machine learning and a genetic algorithm they state that for these types of devices clustering should be avoided but that a positive interaction can be attained between the devices sarkar et al 2016 ferri considers a covariance matrix adaptation evolutionary strategy cma es and a metamodel algorithm mm in order to compare computational expense and developed power the mm is found to be able to converge rapidly but was not accurate though it could be potentially used as an initial step if paired with a more accurate method in a second phase ferri and cork 2017 giassi et al has also investigated the optimization of a wec array where the diameter of the device and the gridded spacing of the devices was varied the results indicate that the changing of a device s diameter primarily affects the cost of a device not the power development of a device however varying the mass has a greater impact on the power developed giassi et al 2017 bozzi et al considers annual energy production hydrodynamic interaction and electrical interaction in connection with array configuration assuming a small array they show that the optimum layouts for their experienced sea states are in the shape of a rhombus or a line bozzi et al 2017 the referenced work serves as a starting point for wec array optimization research and the goal of our current work is to expand the capability of wec array optimization methods and to increase fidelity of models employed specifically cost consideration and advanced input parameters the following sections discuss our novel genetic algorithm approach for finding optimal wec arrays and show preliminary results using a similar problem formulation to that of child and venugopal 2010 3 genetic algorithm approach we used a ga approach because of its ability to efficiently converge on optimal solutions while considering continuous and discrete factors system optimization with gas is not a new method however the application of such an optimization method in the realm of wave energy converter array design is novel additionally our presented ga was developed specifically to be tuned for this challenge applications in the analogous field of wind energy turbine array optimization indicate the need for distinctively implemented algorithms dupont and cagan 2010 in this section we will give an overview of the workings of our ga discussing the features that are uniquely important to our problem of optimizing an array of wecs within a binary grid to evaluate and compare different possible layouts an objective function that includes both cost and power is created and utilized the multi objective formulation shown in eq 1 reflects the trade off between cost and power as demonstrated by previous research dupont and cagan 2010 mosetti et al 1994 grady et al 2005 1 objective function cost p 20 in this objective function the values of cost and p 20 represent the cost of and power generated by an array over a 20 year lifetime throughout the search the objective function is minimized and the units are cents per kilowatt as cost models achieve increased robustness eq 1 could readily represent a lifetime average cost of energy and could be used for comparing wave energy against sources such as wind or solar for this specific study the cost does not impact the layouts due to the simplicity of the cost model and the number of wecs being fixed unfortunately current cost models do not exist that allow for greater fidelity when considering an array of devices at this current stage of wec array optimization research we are considering a scenario that allows for better comparison with previous research which only considers for a fixed number of devices fixing the number of devices allows us to acquire a better understanding of other influencers on the configuration of wecs in an array inclusion of the cost in the objective function provides a placeholder for future implementation of improved cost models as they are developed as an evolutionary optimization algorithm a ga mimics the passing of traits from parents to children with mutations preventing local optima convergence utilizing stochastic attributes such as generating a random parent solution population improves the ga s performance in the implemented algorithm several tunable parameters exist elitism crossover and mutation an individual parent represents a unique array solution fig 2 shows how the arrays are represented as strings for the ga each cell of an individual parent string correlates to a section of the ocean and includes either a one indicating a wec s existence in that ocean section or a zero indicating the lack of a wec s existence in that ocean section the binary ga readily evaluates the minimum separation distance between devices a previously unexplored aspect of array design the effects of the minimum separation distance are shown in section 7 1 once generated the random initial parents are evaluated and ranked by objective function eq 1 the elitism function clones an upper percentage of the sorted parent population by copying potential solutions directly to the children set to balance this elitism the same percentage of lowest ranked solutions are removed from the parent set after elitism pairs of solutions in the parent population are mated via crossover because the wecs are located sparsely throughout the space and the number of devices is constrained to a set value multi point crossover is intractable instead our integrated method creates the crossed over children population by placing wecs in locations extracted from pairs of parent population solutions this method of crossover ensures that the number of wecs within each new layout remains constant by equally exchanging devices between two solutions to create two new unique solutions specifically children solutions are created in pairs by randomly selecting device locations from two parent solutions and combining them in a manner that creates two new solutions which have devices in locations that are extracted from each parent essentially if a new child solution is examined it will have device s that are in the exact position s as one of the parents and device s that are in the exact position s as the other parent no child solution s device location will be entirely unique when comparing against the parents however the child solution as a whole will be unique assuming the two parent solutions weren t identical to begin with fig 3 demonstrates the implemented crossover method the selection of wec locations to swap is tunable selecting the number of wec locations to swap and random selecting which locations will be swapped crossover is performed on a defined upper percentage of the parent population including the parent solutions used for elitism with crossover complete mutation is performed on the resulting children for mutation randomly selected devices in a small percentage of randomly selected solutions receive new locations this is achieved by first randomly selecting a cell from a randomly selected solution and changing the contained value since we are operating with a binary convention the cell contains either a 1 indicating a wec or a 0 indicating the absence of a wec depending on the selected cell s value either a 0 or a 1 a cell in the same solution but with the opposite value is also randomly selected and its value changed to maintain the required number of devices within the solution after elitism crossover and mutation and only if necessary the children population is filled with randomly generated layouts so that the same number of solutions as the parent population is attained the children population solutions are then evaluated using the objective function shown in eq 1 and ranked according to this objective function evaluation after ranking the population is evaluated for convergence elitism ensures that the solution with the best objective function is maintained or updated between populations consequently convergence is defined as a percentage of the population having an identical layout and objective function to the best solution once convergence is attained the algorithm returns the converged solution as the reported optimal array layout if convergence is not attained the children population becomes the next parent population and the process continues fig 4 shows the pseudocode for the ga used in our work 4 modeling there are two models used for the objective function in this research one for the development of array power and one for array economics computational models calculate and predict the necessary factors of array layouts and the accuracy of the optimization method depends on the accuracy of the models utilized 4 1 power model in previous research power has been the driving consideration for determining optimal device arrangements this emphasis is due to the vast availability of the wave energy resource and the potential ability of wec arrays producing more power than the same number of devices in isolation specifically work in array design has focused on maximizing the interaction factor q eq 2 defines q as deandrés et al 2014 2 q p array n p isolated p array represents the total power produced by an array of devices p isolated is the power of a single device acting in isolation and n is the number of devices in the array in scenarios where multiple wecs interact with the incident ocean waves the value of q has been theoretically found to be greater than one borgarino et al 2011 such a value of q indicates that devices could positively impact array power development when placed in specific layouts when an incident wave encounters a floating body in this case a wec two behaviors affect the value of q first the object begins to bob and waves radiate away from the body like the ripples from a stone thrown into a pond second the incident waves pile up and bend around the device consequently the wave height increases if devices are placed to benefit from these radiated and diffracted waves the device can generate more power than it would in isolation mcnatt et al 2014 existing software approaches such as the linear wave body software wamit 2012 can be used to calculate the power produced by an array of devices in a given sea state but this software is prohibitively computationally expensive for use within an iterative optimization method alternatively mcnatt et al has created a novel method for calculating power produced by an array of wecs that utilizes wamit once for a given device geometry and then analytically calculates the power produced for different array configurations mcnatt et al 2014 the damping added mass and hydrostatic matrices of a wec in isolation are determined using wamit these hydrodynamic properties are found for a specific device geometry and water depth as well as for a range of wave periods and directions fig 5 shows the behavior of a single device in a wave field using the hydrodynamic properties of a single device generated in wamit the analytical model described in mcnatt et al 2014 extrapolates these effects to multiple devices in an array accounting for the orientation of each device the complex excitation force and damping of the entire array is found using the scattered waves of a plane incident wave and the radiated wave coefficients mcnatt et al 2014 with this information the power developed by an array is found using eq 3 cruz 2008 3 p 1 8 x b 1 x in eq 3 x is the complex excitation force and b is the damping of the array for this work the damping of the power take off is fixed for all devices in the array 4 2 cost model the cost associated with developing deploying and maintaining a wec array should be included in an algorithm s objective function but has been previously neglected in wec array optimization work considering only an array s power development as a system objective lacks the realism necessary for wave energy industry s success the cost model used in our optimization work comes from sandia national lab s snl s reference model project rmp previsic 2012 while not a calculating tool specifically this reference model includes subsets of costs for different wec array nameplate capacities there are many assumptions involved but these are explicitly stated within the rmp and the rmp can be readily updated as new information becomes available figs 6 and 7 show examples of information provided by the rmp for our developed optimization method the cost equation was formulated by fitting a polynomial to the information provided by snl s rmp and is shown in eq 4 the values of the rmp are based on reference model 3 which is a variation of a heaving point absorber previsic 2012 4 cost 3 10 7 n 0 6735 in eq 4 the cost in usd of an array is based solely on n the number of devices in an array this formulation serves as a placeholder which we will update with new information as it is developed sharp and dupont 2015a due to the offshore renewable energy sector being in its early stages the economics involved are often unknown or are intellectual property we understand that eq 4 is limited and recognize that the economics of arrays will greatly if not primarily influence future development of wec array design it is therefore important to include whatever knowledge is currently available regarding the economics of an array sharp and dupont 2015c 5 problem formulation to achieve our preliminary results five scaled truncated cylinders are placed in a bretschneider spectrum of unidirectional waves the heave constrained cylinders represent point absorber type wecs acting in the vertical direction and the unidirectional waves indicate that the incident waves come from a single cardinal direction placed in a water depth of 8 m the cylinders have a diameter of 2 m and a draft of 1 m as shown in fig 8 we used a scaled system with the same device geometry sea state and water depth as child and venugopal 2010 to better compare against child and venugopal s previous work the incorporated bretschneider spectrum had a modal frequency of 0 2 hz a significant wave height of 2 m and periods ranging from 4 s to 8 s again these parameters were chosen based on the work of child and venugopal 2010 to facilitate comparison the parameters used to achieve the preliminary results are shown in table 1 since information on the minimum distance between devices is unknown this minimum separation distance is deliberately varied for each case the chosen values indicate the scaled nature of our problem formulation wecs are placed in a 10 10 grid that has 100 different potential wec locations resulting in over 9 109 total potential layouts the population size was chosen to balance computational efficiency and potential solution diversity since a ga is a population based optimization method that doesn t guarantee global optimality we keep the algorithm from converging too quickly by having a large enough population however we also the unidirectional wave field and single degree of freedom wec implementation serve as a test case for proving the efficacy of our ga method as we adjust the minimum spacing requirement the size of the represented physical space changes accordingly the smallest being 30 m by 30 m case 1 and the largest being 60 m by 60 m case 4 6 results fig 9 12 show the suggested arrays developed from the four test cases listed in table 1 for each test case we ran the algorithm ten times the results shown are those with the best overall objective function evaluation for each test case and also appeared consistently throughout each individual case for all the test cases waves are unidirectional coming from the west or directly from the left in figs 9 12 for each of the results presented the interaction factor q is calculated as described in eq 2 and the values are shown in table 2 7 discussion utilizing a scaled test case scenario our binary genetic algorithm determined optimal layouts for four different allowable minimum separation distances when designed in an informed way the layout of wec devices in an array scenario can increase power production through device interaction as well as potentially minimize the involved cost through shared infrastructure prior to our work wec array design research considered maximizing an array s power production with little understanding of the influence of device spacing on said power production as a note the results shown in figs 9 12 were found by running the algorithm ten times per case the results shown are not only the best found from these runs but were also found repeatedly additionally every start of the algorithm begins with a unique set of random initial parents to minimize the possibility of population takeover 7 1 spacing effect when considering the deployment of devices in real sea scenarios we must allow for a watch circle around individual devices to prohibit or minimize physical contact with other devices and entanglement of mooring systms examining the depicted arrays in figs 9 12 varying shapes are observed depending on the minimum allowable distance between wecs in case 1 when restricted to a 3 m minimum separation distance the devices line up in pairs parallel to the oncoming wave however when the minimum distance increases to 6 m the converged layouts place themselves in a diamond shape with one corner pointing towards the oncoming incident wave this transition is due to the dissipation of radiated waves as discussed in section 4 1 a device can alter the wave field and power experienced by its neighbors through its radiated and diffracted waves for the 3 m separation distance shown in fig 9 the devices appear to be utilizing the radiated waves of their immediate up wave neighbors however with increased separation distance the wecs place themselves to benefit from their neighbor s diffracted waves as indicated by the interaction factors reported in table 2 the overall optimal layout occurs when devices capitalize on upstream radiated waves an increase in allowable minimum separation distance initially generates layouts with worse q values until the diffracted waves can be effectively captured at which point the interaction factor increases again it is important to note that if different parameters are used in the applied bretschneider spectrum resulting layouts would differ from these shown borgarino et al 2011 also the difference in layout configurations based on the minimum separation distance is likely directly related to the sea state that the initial individual wec experiences if we consider what might happen at a large scale 7 2 comparison to results of previous research our results validate the ability of our created optimization method to find array arrangements that maximize power produced as was presented in section 2 child and venugopal utilized two methods for optimizing a layout as shown in fig 1 child and venugopal 2010 table 3 shows the comparison of the objective function evaluation of case 4 to those layouts shown in fig 1 case 4 was chosen for comparison due to a similar minimum separation distance 6 m between devices as seen in child and venugopal 2010 to ensure a more equivalent comparison we calculated the interaction factors of all three layouts using our presented power model when comparing the interaction factors from table 3 the wec arrangement found by our method achieves a higher interaction factor than the example layouts from child venugopal it should be noted that the interaction factor found for the results of child venugopal when using the method presented in this article differ from their reported interaction factors 0 9961 versus 1 787 for the parabolic intersection pi method and 0 9942 versus 2 1010 for the matlab ga method child and venugopal 2010 this indicates that the power is being calculated in a different manner than what we have presented additionally the referenced results from the parabolic intersection and matlab ga methods use a regular wave set rather than the bretschneider spectrum utilized by our presented optimization method these differing wave fields would also affect the power developed we chose to utilize the bretschneider spectrum for this comparison to include some realistic complexity 8 conclusion in wec array development the optimal layout for devices is determined to be dependent on the local sea state device design and geometry the minimum distance between devices and costs based on local information additionally for array optimization work to remove industry implementation barriers all factors that impact the wec array system should be accurately modeled currently power is the driving factor regarding array configurations we have shown our optimization method to be useful for generating theoretical wec arrays that maximize power by achieving interaction factors greater than one our preliminary ga results show the capability of this method to aid the industry in better understanding optimal arrangement offshore renewable energy industries are in relatively early stages of research and development as such the economic factors and their corresponding influence are not well known yet cost will likely be a driving factor of grid connected layout design as such it is vital to prepare for the inclusion of up to date cost models when they become available eq 4 represents an introductory cost model that is consistent to similar research that can be easily updated this work demonstrates the effect that radiated and diffracted waves can have on an array s optimal layout if for instance a minimum spacing requirement is implemented to minimize harmful physical interaction or to allow for easier operations and maintenance comparing against previous work shows that using our genetic algorithm approach created specifically for wec array optimization will provide results with improved interaction factors using an objective function similar to previous research but with the inclusion of cost future work will involve removing simplifications such as discretized space wave direction and fixed number of devices also as cost and power models are improved and environmental impact models created we will update the algorithm accordingly acknowledgments this work was funded by the us department of energy award ee 0006816 oregon state university and the oregon built environment sustainable technologies center inc oregon best under the nw energy experience prize the authors would also like to thank cameron mcnatt for his assistance in the generating of the wec hydrodynamic properties 
23236,flammable gas dispersion and deflagration above sea resulting from subsea release have the possibility to cause an adverse impact on the operation safety of surface vessels this paper presents a systematic simulation of gas dispersion and deflagration above sea from a subsea release using cfd based approach aiming to study the evolution process of accident scenario and assess its impact on surface vessels a jack up drilling platform is used as a case to discuss the impact of gas dispersion and deflagration the uniqueness of this study is the integration of release dispersion and deflagration scenarios the simulation includes the modelling of wind flow gas dispersion and subsequent deflagration due to accidental ignition the wind flow above sea surface is given using wind speed profile equation to generate steady wind field around offshore platform simulation of gas dispersion is conducted based on the generated wind field the development of flammable gas cloud is predicted and the dangerous area on offshore platform is assessed considering the appearance of ignition source a deflagration simulation based on dispersion results is performed to predict the consequences including overpressure high temperature and heat radiation eventually the damage criterion is utilized to evaluate their impact on offshore platform keywords risk assessment simulation flammable gas cloud dispersion and deflagration offshore platform 1 introduction accidental subsea gas release e g leakage of subsea pipelines or blowout poses a threat to human life assets integrity and corporate reputation skjetne and olsen 2012 once a subsea gas release happens gas will move into atmosphere and disperse above sea under wind hissong et al 2014 the flammable gas cloud above sea may escalate into the fire or explosion accident due to the possible appearance of ignition source the improved knowledge of gas dispersion and deflagration above sea from a subsea release is important for risk assessment mitigation and prevention at present considerable attentions were paid on the subsea gas release and dispersion induced by the leakage of subsea pipelines or other subsea installations as well as blowout a series of integral models e g deepblow cdog and megadeep johansen 2000 zheng et al 2003 chen and yapa 2003 yapa et al 2010 premathilake et al 2016 wimalaratne et al 2015 were developed for the transport and fate of subsea gas release furthermore some computer models based on eulerian lagrangian method were also developed for the underwater gas plume and free surface behavior resulting from a subsea gas release cloete et al 2009 olsen and skjetne 2016 olsen et al 2017a 2017b underwater gas plumes dissolution and hydrate formation gas fate and transport and physicochemical process that underwater gas undergoes were well studied based on these developed models for a subsea gas release the whole dispersion process encompasses underwater and above water movement however the studies about gas dispersion above sea surface from a subsea release can only be found sporadically in literature huser et al 2015 estimated the range of flammable gas cloud above sea caused by a subsea gas release and a look up table for maximum plume dimensions was developed however the detailed development of flammable gas cloud subsequent deflagration scenario and the corresponding impact on surface vessels are not mentioned in their studies detailed safety analysis of gas dispersion and deflagration is useful for risk assessment and inherent safety design in oil and gas sector and a number of researches contribute to this field hazardous gas dispersion in enclosed or open area such as complex terrains chemical plant offshore platform fpso and engine room spaces of lng gas fueled ships was studied in previous years to analyze gas behavior and predict consequence zhu and chen 2010 liu et al 2015 zhang and chen 2010 dadashzadeh et al 2016 wilkening and baraldi 2007 li et al 2016 shi et al 2018 furthermore a series of efforts were made on safety assessment of gas deflagration due to ignition which focused on deflagration development process and consequence assessment dadashzadeh et al 2013 wei et al 2014 bao et al 2016 shi et al 2017 modelling of hazardous gas release dispersion and deflagration are essential for such a proper safety analysis in these works cfd simulation with the advantages of low cost high efficiency and powerful modelling capabilities has been widely adopted cfd can model required physics of a certain accident and are also capable of presenting the fully detailed geometry involved in the area of concern which plays an important role in consequence analysis studies the objective of this paper is to present a systematic simulation of gas dispersion and deflagration above sea from a subsea gas release which is used to predict accident evolution process and assess its impact on offshore platform for this purpose a generic methodology for simulation and assessment is proposed and an integrated 3d cfd model is built the wind flow above sea gas dispersion and subsequent deflagration are simulated based on the developed model the simulations could provide some useful and safety related results including wind field around offshore platform the spatial distribution of flammable gas cloud dangerous area on offshore platform as well as influencing area of deflagration consequences based on simulation results the impact of gas dispersion and deflagration on offshore platform is assessed and the corresponding risk prevention and mitigation measures are discussed the rest of paper is organized as follows section 2 presents the proposed methodology for modelling and assessment of gas dispersion and deflagration above sea from a subsea release the cfd theoretical model for gas dispersion and deflagration is shown in section 3 while the cfd modelling and calculation process is presented in section 4 the case simulations for a specific accident scenario is conducted in section 5 section 6 gives the summary and conclusions of this paper 2 simulation and assessment methodology a comprehensive diagram of subsea gas release and dispersion is shown in fig 1 which is adapted from cloete et al 2009 and takagi et al 2012 when a subsea gas pipeline leaks gas releases into seawater and rises from seafloor to sea surface under the action of ocean current a circular gas pool on sea surface is generated when gas reaches sea surface then gas releases from the surface gas pool and disperses in atmosphere under the action of wind due to continuous release of gas a flammable gas cloud with certain length and height is formed above sea surface which has an adverse impact on the operation safety of offshore platform locating in downwind direction of surface gas pool this paper focuses on safety analysis of such a specific accident scenario and the present study is planned to analyze the simulation results and assess the accident consequences fig 2 outlines the procedures of the proposed methodology for simulation and assessment of gas dispersion and deflagration above sea from a subsea gas release which includes geometric modelling mesh generation parameters definition simulation solution and results analysis cfd modelling is conducted based on the accident scenario through the preparation of a typical simulation procedure the simulation of gas dispersion is run to obtain some important parameters of flammable gas cloud including spatial distribution length height coverage area volume and dangerous area on offshore platform subsequently the deflagration scenario is simulated based on the dispersion results and flammable gas cloud is ignited by potential ignition sources on offshore platform thus influencing areas of deflagration parameters e g overpressure high temperature and heat radiation are predicted and assessed eventually the deflagration damage criteria wei 2013 are utilized to evaluate specific impact of deflagration consequences on offshore platform the present simulations are conducted using cfd software fluent in previous years a series of studies were performed to validate the application of cfd fluent in dispersion and deflagration of flammable gas released in oil and gas industries savvides et al 2001 utilized cfd software fluent to model the gas dispersion in offshore module used in the experimental measurement of gas buildup as part of the joint industry project jip gas buildup from high pressure natural gas releases in naturally ventilated offshore modules in which the results of fluent simulations are compared with the experimental data the validation indicated that fluent can predict with good accuracy for gas dispersion and accumulation from a release in an offshore module in particular the predicted gas volume as defined by the lfl concentration agrees well with the measured data chan et al 2002 validated the cfd model for fluid flow development and pollutant dispersion within an isolated street canyon using an extensive experimental database obtained from the atmospheric boundary layer wind tunnel visser et al 2012 validated a cfd fluent model for hydrogen distribution in a containment using the thai hm 2 test rakhimov et al 2017 presented a cfd model for turbulent flame propagation in slow deflagration regime in hydrogen air steam mixtures and validated against the three slow deflagration experiments performed in the thai facility above these studies indicates that cfd simulation is a reliable tool for safety analysis of gas dispersion and deflagration and the application of a validated cfd code fluent is capable of giving a convincing result 3 theoretical model 3 1 governing equations the process of gas dispersion meets continuity equation momentum and energy conversation since natural gas is a multicomponent substance its movement also yields to the mass conservation of each component the mathematical expressions of these conversation equations are shown as follows liu et al 2015 fluent 2011 1 δ ρ δ t ρ v 0 2 δ ρ v δ t ρ v v p τ ρ g 3 δ ρ h δ t ρ v h ρ μ σ μ t σ t h 4 ρ y i t ρ v y i ρ μ σ μ t σ t y i where μ is the turbulence of molecular viscosity μ t is the turbulence viscosity σ is the schmidt number of turbulence t is the time ρ represents the density of gas mixture p is the static pressure τ is the viscous stress tensor v is the velocity vector after reynolds average g is the body force of gravity h is the enthalpy of gas mixture y i represents mass fraction of ith gas component 3 2 turbulence flammable gas dispersion is a kind of unsteady turbulence movement and the proper turbulence equation is required to depict the turbulence induced by gas dispersion and make basic governing equations close liu et al 2015 the work of tauseef et al 2011 indicated that the realizable κ ε model had a better performance compared to other rans models therefore the realizable κ ε model is adopted in the present study and its transport equations are shown as follows li et al 2017 fluent 2011 5 t ρ κ x j ρ κ u j x j μ μ t σ κ κ x j g κ g b ρ ε y m s κ 6 t ρ ε x j ρ ε u j x j μ μ t σ ε ε x j ρ c 1 s ε ρ c 2 ε 2 κ ν ε c 1 ε ε κ c 3 ε g b s ε 7 c 1 max 0 43 η η 5 8 η s κ ε 9 s 2 s i j s i j 10 s i j 1 2 u j x i u i x j where κ is the turbulent kinetic energy ε is the dissipation rate of turbulent kinetic energy σ κ and σ ε are the turbulent prandtl numbers for κ and ε which were taken as 1 0 and 1 2 respectively u i and u j are the velocity components in x i and x j of axis respectively g κ represents the generation of turbulence kinetic energy due to the mean velocity gradients g b is the generation of turbulence kinetic energy due to buoyancy y m represents the contribution of the fluctuating dilatation in compressible turbulence to the overall dissipation rate c 2 and c 1ε are constants which are taken as 1 9 and 1 44 respectively c 3ε is the impact of buoyancy on turbulent dissipation rate η is the time scale ratio of turbulence on the average strain s is the tensor coefficient of average strain rate s ij is the average strain rate s κ and s ε are user defined source terms 3 3 deflagration model the generalized finite rate model is used to simulate the chemical reaction during gas deflagration it is based on the solution of transport equations of species mass fraction and simulation of the chemical reaction is carried out by predefined reaction mechanism reaction rate as source term appears in species transport equation eddy dissipation model is used to calculate reaction rate and depict the interaction between turbulence and chemical reaction most of gas can burn rapidly during deflagration and the overall reaction rate is controlled by turbulence mixing rate the production rate r i r of substance i in reaction r is shown as eq 11 wei et al 2014 fluent 2011 11 r i r min v i r m w r a ρ ε k min r y r v r r m w r v i r m w i a b ρ ε k p y p j n v j r n m w j where y p and y r are the mass fraction of product p and reactant r respectively a and b are the magnussen constant of product and reactant respectively 4 cfd calculation 4 1 mesh generation this paper accounts for the impact of flammable gas cloud on offshore platform locating in downwind and a simplified 3d jack up drilling platform shown in fig 3 is included in the accident scenario the partial structures and equipment of jack up drilling platform are simplified and only some main topside modules are considered in the model the main topside modules of jack up drilling platform considered in this paper are follows 1 crane 2 lifting frame 3 rig 4 drill floor 5 living building 6 cantilever beam 7 deck channel 8 barite tank 9 ash tank 10 main deck 11 helicopter platform 12 control room of power system note that the number of these modules are corresponding to the numbers in fig 3 the simulation is carried out on a 3d mesh model the space dimension of computational domain is 420 m 260 m 200 m which is nearly an infinite dimensional space and can reduce the effect of boundaries on gas flow meshing technology of dividing blocks is used for mesh generation the whole computational domain is divided into several blocks the central zone of computational domain is meshed with tetrahedral grids while the outside zones are meshed with hexahedral grids in addition a size function is used to refine the girds in the central zone which can improve the solution accuracy of this zone the mesh generation is conducted by the gambit 2 3 mesh generator a suitable grid density is reached by repeating computations until a satisfactory independent grid is found at last the total number of grids used for simulation is 3319456 the unstructured hybrid grids in computational domain generated by above method are shown in fig 4 4 2 boundary conditions the boundaries of computational domain encompass up plane platform surface side planes wind inlet wind outlet and surface gas pool as shown in fig 5 during numerical solution up and side planes are treated as zero flux planes platform surface is set as no slip wall wind inlet is defined as velocity inlet boundary and wind profile function is used to depict the shear velocity distribution of wind as shown in eq 12 liu et al 2015 wind outlet is set as outflow boundary surface gas pool is defined as velocity inlet boundary and gas releases from surface gas pool with certain velocity during gas deflagration solution the compressibility of gas should be considered in the chemical reaction and the gauge pressure is set as zero to deduce the density and velocity of gas wei et al 2014 12 u z u 10 z 10 0 091 where u z is the wind speed at the height of z m above sea surface u 10 is the wind speed at the height of 10 m above sea 4 3 solution method finite volume method is utilized to conduct a second order discrete of governing equations an unsteady pressure based solver is used to simulate gas dispersion and deflagration above sea and the simple algorithm is adopted for the pressure and velocity coupling schemes wei et al 2014 the simulation solution of the entire accident scenario is divided into three steps firstly the wind flow in computational domain is simulated to generate a steady wind field around offshore platform then the release of surface gas pool is activated and the dispersion simulation of gas released from surface gas pool is conducted based on the steady wind field in computational domain eventually deflagration simulation of flammable gas cloud is performed accounting for the appearance of ignition source on offshore platform 5 results and discussions 5 1 subsea gas release and dispersion to show an integrated development process of subsea gas release incident a brief description of underwater gas release and dispersion is presented in this section which could render a theoretical and logical basis for the research of gas dispersion and deflagration above sea a subsea gas pipeline in the south china sea is utilized as the case to illustrate the development of underwater gas plume and the environmental conditions in the south china sea including water depth ocean current speed and wind speed are used in simulations the example pipeline locates at the water depth of 110 m and the maximum ocean current speed is 0 7 m s a subsea gas pipeline ruptures fully due to fatigue failure fig 6 presents the bubbles movement trajectory in seawater which is predicted using eulerian lagrangian approach since the surrounding parameters of seawater such as pressure and temperature vary with water depth and the density and diameter of bubbles also vary with the water depth the density of bubbles decreases with water depth decreasing while the diameter of bubbles increases with water depth decreasing bakli 2014 when a subsea gas release happens the gas moves into seawater rapidly and disperses towards free surface under the action of buoyant force besides bubbles also move along downstream direction due to carry of current in the end the gas reaches sea surface and disperses into atmosphere generating a circular gas pool with the radius of 34 m on sea surface as shown in fig 5 it is assumed that surface gas release rate is 390 kg s which is used for illustrative purpose in practice any release rate is possible due to change of operational conditions due to the appearance of offshore platform the flammable gas on sea surface has an adverse impact on its operation safety a potential scenario is assumed that a jack up drilling platform locates in the downwind of surface gas pool the distance between surface gas pool and jack up drilling platform is 30 m the diagram of the accident scenario depicted above can be clearly seen in fig 5 5 2 flammable gas cloud assessment 5 2 1 wind field on sea surface the average wind speed at the height of 10 m above sea is 4 5 m s liu et al 2015 which is based on actual observation data in this area wind speed distribution at different heights is depicted by eq 12 fig 7 presents the wind velocity distribution in the vertical direction it is clear that wind speed above sea increases with the increase of height as can be seen offshore platform has a significant effect on wind speed distribution due to the obstruction and reflection of offshore platform the speed and direction of wind around offshore platform change apparently and some zones with low wind speed are generated in downwind direction including the surrounding area of the cantilever beam and the helicopter platform as well as the behind of living building in addition since the effect of topside modules of offshore platform on airstream distribution some zones with swirl flow are formed on offshore platform e g peripheral areas of cantilever beam main deck behind of living building and helicopter platform shown as the velocity vector profile in fig 7 b above mentioned zones have the poor ventilation condition which may lead to flammable gas gather and induce a flammable gas deflagration accident fig 8 gives the wind speed distribution on offshore platform in the horizontal direction a symmetrical airstream speed distribution on offshore platform is presented and the wind speed distributions on the port and the starboard are nearly same which takes the longitudinal central line of offshore platform as the symmetry axis due to the obstruction and shelter of topside modules the airstream speed decreases apparently as shown in the zones with blue color in fig 8 a in addition some zones with low airstream speed and swirl flow can also be clearly seen in the horizontal velocity vector profile fig 8 b which includes the areas between cantilever beam and living building as well as behind of living building the low airstream speed on offshore platform ranges from 0 to 0 6 m s while the maximum speed of airstream on offshore platform is 4 17 m s fig 9 presents the turbulence kinetic energy and intensity of offshore platform surface under the action of wind which is corresponding to the wind speed distribution on offshore platform the complex turbulence filed is generated on the offshore platform surface due to the action of wind the strong turbulent movement appears on offshore platform surface the maximum turbulence kinetic energy is 1 65 m2 s2 and the maximum turbulence intensity is 1 34 as can be seen the area of weak turbulent movement mainly locates behind of cantilever beam and living building flammable gas may gather in these areas and necessary ventilation and fire prevention measures are required to be carried out in the scenario that flammable gas releases in the upwind direction 5 2 2 dispersion analysis the combustible concentration range of natural gas is within 0 05 0 15 li et al 2016 the concentration isosurface of 0 05 is defined as the distribution area of flammable gas cloud the development process of flammable gas cloud above sea under the action of wind is shown in fig 10 because of surface gas pool with large size the surface gas release velocity is very small during the initial stage of dispersion flammable gas cloud moves along downwind and closes to offshore platform gradually when flammable gas cloud reaches offshore platform it crosses over the stern of offshore platform and covers the drill floor rig and cantilever beam shown as the flammable gas cloud in 30 s besides flammable gas cloud also moves upwards under buoyant force and the height of flammable gas cloud increases with dispersion time eventually a steady flammable gas cloud with a certain geometric size is generated which locates above offshore platform fig 11 presents the variation process of spatial parameters of flammable gas cloud including length height width coverage area and volume length and width of flammable gas cloud gradually increase with time and reach the maximum values at 80 s then they decrease and reach the steady values the steady values of length and height are 322 m and 103 m respectively while the width of flammable gas cloud nearly has no change with time which approximately equals to the diameter of gas pool the coverage area is defined as the projection area of flammable gas cloud along the vertical direction as seen in fig 11 b the coverage area and volume of flammable gas cloud increase with time and then reach the steady values after a little drop the steady values of coverage area and volume are 12394 m2 and 44139 m3 respectively fig 12 presents the dangerous area distribution on offshore platform dangerous area is defined as the zone that the concentration of flammable gas is within the flammability limits as seen in fig 12 the dangerous area mainly distributes on drill floor and cantilever beam while the gas with lower concentration distributes on the main deck due to the shelter of living building no flammable gas exists behind of living building therefore the drill floor and the cantilever beam are identified as the main dangerous area on offshore platform drill floor is the core operation area of offshore drilling platform due to the continuous drilling operation some potential ignition source e g sparks from a collision hot surface etc may induce a deflagration accident based on the simulation results of gas dispersion flammable gas detection and alarm devices are required to be equipped in windward side of offshore platform through which the flammable gas from the release in upwind direction can be detected in time and the emergency response can also be implemented rapidly furthermore the positive ventilation and fire suppression system are required to reduce the accumulation of flammable gas and prevent fires in the present study the above mentioned safety measures are recommended to be placed in drill floor area and these devices with safety functions should be maintained regularly to improve their availability and ensure that can be activated in an accident scenario when the flammable gas from upwind is detected all operations should be stopped to avoid the possible ignition induced by operations and fire suppression system should be prepared well to prevent and mitigate the possible fire accident 5 3 deflagration consequences assessment 5 3 1 overpressure this paper accounts for the possibility of ignition due to operations on offshore platform and the subsequent deflagration scenario is studied in this section it is assumed that ignition happens on drill floor at 2 min after surface gas release and dispersion the overpressure distribution on offshore platform surface is shown in fig 13 in the example scenario drill floor is a nearly full open space on the other hand flammable gas cloud locates on an open space and it is diluted timely under the action of wind thus the deflagration overpressure is small the maximum overpressure is about 960 pa and a negative pressure area is generated in drill floor according to overpressure damage criterion wei 2013 deflagration overpressure in example scenario cannot pose a damage to human life and steel structures 5 3 2 high temperature due to the continuous release of gas from surface gas pool the gas deflagration gradually develops into pool fire on sea surface the development process of deflagration flame is depicted in fig 14 by the geometric shape of flame at different times overall the development process of deflagration flame can be divided into initial stage propagation stage peak stage decremental stage and steady stage since the initial ignition happens on the drill floor the flame starts and propagates from drill floor and it mainly spreads towards the top of computational domain in the initial stage with the continuous reaction more and more flammable gas involves burning flame propagates to upper space of surface gas pool and geometric size of deflagration flame reaches maximum seen as the flame at 40 s the height of flame is 198 m and the width of flame is 129 m note that some small flames distribute in the surrounding area of helicopter platform and living building which may hamper the operation of rescue and escape the simulation indicates that deflagration flame develops along downwind under the action of wind the steady deflagration flame distributes above offshore platform and covers some topside modules of offshore platform in the later stage of deflagration flame development height and width of flame gradually decrease due to consumption of flammable gas in external space eventually burning state of deflagration flame is into the steady state and height width length of flame in steady state are 210 m 111 m 122 m respectively the flame flows along downwind direction under the action of wind which almost completely covers the offshore platform besides steady flame also exists below the main deck seen as the deflagration flame at 140 s fig 15 presents the temperature distribution on offshore platform surface under the steady deflagration flame the maximum temperature on platform surface is 1020 k while the minimum temperature is 390 k the area on offshore platform with high temperature mainly distributes on drill floor and cantilever beam and the temperature on these areas is out of 840 k as seen in fig 14 rig is always covered by deflagration flame and the maximum temperature on rig surface is above 930 k damage criterion of flame temperature on human and steel structure is shown in table 1 wei et al 2014 which gives four critical damage temperature on human body and steel structure based on critical damage temperature the areas with critical temperatures on offshore platform surface are shown in fig 16 it can be seen that the temperature on drill floor cantilever beam bottom of rig and main deck reaches critical damage value of steel structure i e 673 k and 873 k the structural strength stiffness and fire resistance of steel structure will decrease in a short time under the continuous action of deflagration flame above mentioned structures on offshore platform may undergo a partial or complete failure the temperature on the whole offshore platform surface is out of critical damage value of human body i e 391 k and 453 k people on offshore platform will suffer from the serious damage due to high temperature note that the temperature on helicopter platform is not able to induce steel structure failure therefore when the deflagration accident happens the operators should evacuate towards the bow of offshore platform and the potential rescue and escape can be achieved by helicopter platform the temperature distribution in vertical and horizontal planes of offshore platform is shown in fig 17 which presents the temperature field around offshore platform generated by surface gas pool fire comprehensively as seen in vertical temperature field the higher temperature distributes below the main deck which ranges from 1962 k to 2146 k due to the shelter of topside modules the front of barite tank and ash tank as well as the behind of living building have the relatively lower temperature the temperature in above two zones ranges from 300 k to 485 k which are identified as the potential safety areas for rescue and escape as seen in horizontal temperature field the maximum temperature distributes on starboard which ranges from 1777 k to 2146 k in addition it can be found that the temperature on the port is lower than the starboard 5 3 3 heat radiation heat radiation is the other important damage form of deflagration flame and it can cause deformation and breakdown of equipment as well as human life loss the head radiation distribution on offshore platform surface is shown in fig 18 due to the influence of wind and topside modules on flame flow the heat radiation intensity on the bottom surface of offshore platform is greater than the top surface and the radiation intensity on the stern is greater than the bow the areas with minimum heat radiation intensity include behind of living building and the top of helicopter platform damage criteria of heat radiation shown in table 2 wei 2013 is utilized to assess the impact of heat radiation on offshore platform the damage criteria of heat radiation define the critical values of radiation intensity and the corresponding impact on steel structures and human body the heat radiation distribution on offshore platform surface with critical damage values is shown in fig 19 the radiation intensity on the most area of offshore platform the area in fig 19 with fluorescent color is out of the critical value of serious structure damage i e 37 5 kw m2 according to damage criteria drill floor rig and main deck will suffer from a serious structural damage and even collapse the whole bottom of offshore platform will experience a serious failure or deformation under the continuous action of heat radiation with high intensity which means that the whole platform may collapse note that the helicopter platform just undergoes a slight damage however the radiation intensity on offshore platform is far above the critical damage value of human body and the major personal injury will be caused based on the simulation results of deflagration the high temperature and heat radiation are the main damage forms of gas deflagration in a deflagration scenario the fire suppression measures including a carbon dioxide fire suppression system as well as a water deluge system are recommended to be installed on offshore platform which should be activated to mitigate deflagration consequences due to the large influencing area of high temperature and heat radiation in upwind direction of offshore platform the operators on offshore platform should evacuate towards the bow of offshore platform in the case of deflagration accident and helicopter platform is the possible approach for rescue and escape 6 summary and conclusions this paper conducts a systematic simulation and assessment for flammable gas dispersion and deflagration above sea from a subsea release which is based on an integrated 3d cfd model the simulations integrate gas release dispersion and deflagration the concern of this paper is a specific accident scenario and the focus is to analyze the evolution process of accident and assess its impact on offshore platform some useful results including the wind filed around offshore platform the spatial distribution of flammable gas cloud the dangerous area on offshore platform and the influencing area of deflagration consequences are derived from the simulations based on simulation results the corresponding prevention and mitigation strategies are discussed the process of gas dispersion and deflagration above sea from subsea release can be summarized as follows when a subsea gas release happens underwater gas migrates from seafloor to sea surface and disperses into atmosphere generating a circular gas pool on sea surface subsequently gas releases continuously from surface gas pool and migrates above sea under the action of wind generating a flammable gas cloud on sea surface due to the appearance of ignition source a deflagration accident of flammable gas is induced which have a serious impact on offshore platform the topside modules of offshore platform have an important effect on the airflow distribution around offshore platform due to their obstruction and reflection some areas with low airstream speed and swirl flow are generated which may cause flammable gas gather in these areas in the case simulation a steady flammable gas cloud is formed above offshore platform which crosses over stern and covers drill floor rig and cantilever beam the size of flammable gas cloud increases with dispersion time drill floor and cantilever beam are identified as the dangerous area and gas concentration in these areas is within the flammability limits effective prevention and mitigation measures such as flammable gas detection and alarm device ventilation and water spray are required to be placed in identified dangerous areas since flammable gas cloud distributes in an open space deflagration overpressure is smaller than the minimum critical damage value which cannot pose a damage to human body and steel structure however the high temperature and the heat radiation from gas deflagration are very great which have the serious damage to steel structure of offshore platform and human life in the case of deflagration operators should evacuate towards the bow and the helicopter platform is the available approach for rescue and escape acknowledgement the authors gratefully acknowledge the financial support provided by the national key r d program of china no 2016yfc0802305 the fundamental research funds for the central universities no 15cx05022a and the postgraduate innovation engineering project of china university of petroleum east china no ycx2018053 furthermore the thanks are also given to anonymous reviewers for giving the valuable comments and suggestions 
23236,flammable gas dispersion and deflagration above sea resulting from subsea release have the possibility to cause an adverse impact on the operation safety of surface vessels this paper presents a systematic simulation of gas dispersion and deflagration above sea from a subsea release using cfd based approach aiming to study the evolution process of accident scenario and assess its impact on surface vessels a jack up drilling platform is used as a case to discuss the impact of gas dispersion and deflagration the uniqueness of this study is the integration of release dispersion and deflagration scenarios the simulation includes the modelling of wind flow gas dispersion and subsequent deflagration due to accidental ignition the wind flow above sea surface is given using wind speed profile equation to generate steady wind field around offshore platform simulation of gas dispersion is conducted based on the generated wind field the development of flammable gas cloud is predicted and the dangerous area on offshore platform is assessed considering the appearance of ignition source a deflagration simulation based on dispersion results is performed to predict the consequences including overpressure high temperature and heat radiation eventually the damage criterion is utilized to evaluate their impact on offshore platform keywords risk assessment simulation flammable gas cloud dispersion and deflagration offshore platform 1 introduction accidental subsea gas release e g leakage of subsea pipelines or blowout poses a threat to human life assets integrity and corporate reputation skjetne and olsen 2012 once a subsea gas release happens gas will move into atmosphere and disperse above sea under wind hissong et al 2014 the flammable gas cloud above sea may escalate into the fire or explosion accident due to the possible appearance of ignition source the improved knowledge of gas dispersion and deflagration above sea from a subsea release is important for risk assessment mitigation and prevention at present considerable attentions were paid on the subsea gas release and dispersion induced by the leakage of subsea pipelines or other subsea installations as well as blowout a series of integral models e g deepblow cdog and megadeep johansen 2000 zheng et al 2003 chen and yapa 2003 yapa et al 2010 premathilake et al 2016 wimalaratne et al 2015 were developed for the transport and fate of subsea gas release furthermore some computer models based on eulerian lagrangian method were also developed for the underwater gas plume and free surface behavior resulting from a subsea gas release cloete et al 2009 olsen and skjetne 2016 olsen et al 2017a 2017b underwater gas plumes dissolution and hydrate formation gas fate and transport and physicochemical process that underwater gas undergoes were well studied based on these developed models for a subsea gas release the whole dispersion process encompasses underwater and above water movement however the studies about gas dispersion above sea surface from a subsea release can only be found sporadically in literature huser et al 2015 estimated the range of flammable gas cloud above sea caused by a subsea gas release and a look up table for maximum plume dimensions was developed however the detailed development of flammable gas cloud subsequent deflagration scenario and the corresponding impact on surface vessels are not mentioned in their studies detailed safety analysis of gas dispersion and deflagration is useful for risk assessment and inherent safety design in oil and gas sector and a number of researches contribute to this field hazardous gas dispersion in enclosed or open area such as complex terrains chemical plant offshore platform fpso and engine room spaces of lng gas fueled ships was studied in previous years to analyze gas behavior and predict consequence zhu and chen 2010 liu et al 2015 zhang and chen 2010 dadashzadeh et al 2016 wilkening and baraldi 2007 li et al 2016 shi et al 2018 furthermore a series of efforts were made on safety assessment of gas deflagration due to ignition which focused on deflagration development process and consequence assessment dadashzadeh et al 2013 wei et al 2014 bao et al 2016 shi et al 2017 modelling of hazardous gas release dispersion and deflagration are essential for such a proper safety analysis in these works cfd simulation with the advantages of low cost high efficiency and powerful modelling capabilities has been widely adopted cfd can model required physics of a certain accident and are also capable of presenting the fully detailed geometry involved in the area of concern which plays an important role in consequence analysis studies the objective of this paper is to present a systematic simulation of gas dispersion and deflagration above sea from a subsea gas release which is used to predict accident evolution process and assess its impact on offshore platform for this purpose a generic methodology for simulation and assessment is proposed and an integrated 3d cfd model is built the wind flow above sea gas dispersion and subsequent deflagration are simulated based on the developed model the simulations could provide some useful and safety related results including wind field around offshore platform the spatial distribution of flammable gas cloud dangerous area on offshore platform as well as influencing area of deflagration consequences based on simulation results the impact of gas dispersion and deflagration on offshore platform is assessed and the corresponding risk prevention and mitigation measures are discussed the rest of paper is organized as follows section 2 presents the proposed methodology for modelling and assessment of gas dispersion and deflagration above sea from a subsea release the cfd theoretical model for gas dispersion and deflagration is shown in section 3 while the cfd modelling and calculation process is presented in section 4 the case simulations for a specific accident scenario is conducted in section 5 section 6 gives the summary and conclusions of this paper 2 simulation and assessment methodology a comprehensive diagram of subsea gas release and dispersion is shown in fig 1 which is adapted from cloete et al 2009 and takagi et al 2012 when a subsea gas pipeline leaks gas releases into seawater and rises from seafloor to sea surface under the action of ocean current a circular gas pool on sea surface is generated when gas reaches sea surface then gas releases from the surface gas pool and disperses in atmosphere under the action of wind due to continuous release of gas a flammable gas cloud with certain length and height is formed above sea surface which has an adverse impact on the operation safety of offshore platform locating in downwind direction of surface gas pool this paper focuses on safety analysis of such a specific accident scenario and the present study is planned to analyze the simulation results and assess the accident consequences fig 2 outlines the procedures of the proposed methodology for simulation and assessment of gas dispersion and deflagration above sea from a subsea gas release which includes geometric modelling mesh generation parameters definition simulation solution and results analysis cfd modelling is conducted based on the accident scenario through the preparation of a typical simulation procedure the simulation of gas dispersion is run to obtain some important parameters of flammable gas cloud including spatial distribution length height coverage area volume and dangerous area on offshore platform subsequently the deflagration scenario is simulated based on the dispersion results and flammable gas cloud is ignited by potential ignition sources on offshore platform thus influencing areas of deflagration parameters e g overpressure high temperature and heat radiation are predicted and assessed eventually the deflagration damage criteria wei 2013 are utilized to evaluate specific impact of deflagration consequences on offshore platform the present simulations are conducted using cfd software fluent in previous years a series of studies were performed to validate the application of cfd fluent in dispersion and deflagration of flammable gas released in oil and gas industries savvides et al 2001 utilized cfd software fluent to model the gas dispersion in offshore module used in the experimental measurement of gas buildup as part of the joint industry project jip gas buildup from high pressure natural gas releases in naturally ventilated offshore modules in which the results of fluent simulations are compared with the experimental data the validation indicated that fluent can predict with good accuracy for gas dispersion and accumulation from a release in an offshore module in particular the predicted gas volume as defined by the lfl concentration agrees well with the measured data chan et al 2002 validated the cfd model for fluid flow development and pollutant dispersion within an isolated street canyon using an extensive experimental database obtained from the atmospheric boundary layer wind tunnel visser et al 2012 validated a cfd fluent model for hydrogen distribution in a containment using the thai hm 2 test rakhimov et al 2017 presented a cfd model for turbulent flame propagation in slow deflagration regime in hydrogen air steam mixtures and validated against the three slow deflagration experiments performed in the thai facility above these studies indicates that cfd simulation is a reliable tool for safety analysis of gas dispersion and deflagration and the application of a validated cfd code fluent is capable of giving a convincing result 3 theoretical model 3 1 governing equations the process of gas dispersion meets continuity equation momentum and energy conversation since natural gas is a multicomponent substance its movement also yields to the mass conservation of each component the mathematical expressions of these conversation equations are shown as follows liu et al 2015 fluent 2011 1 δ ρ δ t ρ v 0 2 δ ρ v δ t ρ v v p τ ρ g 3 δ ρ h δ t ρ v h ρ μ σ μ t σ t h 4 ρ y i t ρ v y i ρ μ σ μ t σ t y i where μ is the turbulence of molecular viscosity μ t is the turbulence viscosity σ is the schmidt number of turbulence t is the time ρ represents the density of gas mixture p is the static pressure τ is the viscous stress tensor v is the velocity vector after reynolds average g is the body force of gravity h is the enthalpy of gas mixture y i represents mass fraction of ith gas component 3 2 turbulence flammable gas dispersion is a kind of unsteady turbulence movement and the proper turbulence equation is required to depict the turbulence induced by gas dispersion and make basic governing equations close liu et al 2015 the work of tauseef et al 2011 indicated that the realizable κ ε model had a better performance compared to other rans models therefore the realizable κ ε model is adopted in the present study and its transport equations are shown as follows li et al 2017 fluent 2011 5 t ρ κ x j ρ κ u j x j μ μ t σ κ κ x j g κ g b ρ ε y m s κ 6 t ρ ε x j ρ ε u j x j μ μ t σ ε ε x j ρ c 1 s ε ρ c 2 ε 2 κ ν ε c 1 ε ε κ c 3 ε g b s ε 7 c 1 max 0 43 η η 5 8 η s κ ε 9 s 2 s i j s i j 10 s i j 1 2 u j x i u i x j where κ is the turbulent kinetic energy ε is the dissipation rate of turbulent kinetic energy σ κ and σ ε are the turbulent prandtl numbers for κ and ε which were taken as 1 0 and 1 2 respectively u i and u j are the velocity components in x i and x j of axis respectively g κ represents the generation of turbulence kinetic energy due to the mean velocity gradients g b is the generation of turbulence kinetic energy due to buoyancy y m represents the contribution of the fluctuating dilatation in compressible turbulence to the overall dissipation rate c 2 and c 1ε are constants which are taken as 1 9 and 1 44 respectively c 3ε is the impact of buoyancy on turbulent dissipation rate η is the time scale ratio of turbulence on the average strain s is the tensor coefficient of average strain rate s ij is the average strain rate s κ and s ε are user defined source terms 3 3 deflagration model the generalized finite rate model is used to simulate the chemical reaction during gas deflagration it is based on the solution of transport equations of species mass fraction and simulation of the chemical reaction is carried out by predefined reaction mechanism reaction rate as source term appears in species transport equation eddy dissipation model is used to calculate reaction rate and depict the interaction between turbulence and chemical reaction most of gas can burn rapidly during deflagration and the overall reaction rate is controlled by turbulence mixing rate the production rate r i r of substance i in reaction r is shown as eq 11 wei et al 2014 fluent 2011 11 r i r min v i r m w r a ρ ε k min r y r v r r m w r v i r m w i a b ρ ε k p y p j n v j r n m w j where y p and y r are the mass fraction of product p and reactant r respectively a and b are the magnussen constant of product and reactant respectively 4 cfd calculation 4 1 mesh generation this paper accounts for the impact of flammable gas cloud on offshore platform locating in downwind and a simplified 3d jack up drilling platform shown in fig 3 is included in the accident scenario the partial structures and equipment of jack up drilling platform are simplified and only some main topside modules are considered in the model the main topside modules of jack up drilling platform considered in this paper are follows 1 crane 2 lifting frame 3 rig 4 drill floor 5 living building 6 cantilever beam 7 deck channel 8 barite tank 9 ash tank 10 main deck 11 helicopter platform 12 control room of power system note that the number of these modules are corresponding to the numbers in fig 3 the simulation is carried out on a 3d mesh model the space dimension of computational domain is 420 m 260 m 200 m which is nearly an infinite dimensional space and can reduce the effect of boundaries on gas flow meshing technology of dividing blocks is used for mesh generation the whole computational domain is divided into several blocks the central zone of computational domain is meshed with tetrahedral grids while the outside zones are meshed with hexahedral grids in addition a size function is used to refine the girds in the central zone which can improve the solution accuracy of this zone the mesh generation is conducted by the gambit 2 3 mesh generator a suitable grid density is reached by repeating computations until a satisfactory independent grid is found at last the total number of grids used for simulation is 3319456 the unstructured hybrid grids in computational domain generated by above method are shown in fig 4 4 2 boundary conditions the boundaries of computational domain encompass up plane platform surface side planes wind inlet wind outlet and surface gas pool as shown in fig 5 during numerical solution up and side planes are treated as zero flux planes platform surface is set as no slip wall wind inlet is defined as velocity inlet boundary and wind profile function is used to depict the shear velocity distribution of wind as shown in eq 12 liu et al 2015 wind outlet is set as outflow boundary surface gas pool is defined as velocity inlet boundary and gas releases from surface gas pool with certain velocity during gas deflagration solution the compressibility of gas should be considered in the chemical reaction and the gauge pressure is set as zero to deduce the density and velocity of gas wei et al 2014 12 u z u 10 z 10 0 091 where u z is the wind speed at the height of z m above sea surface u 10 is the wind speed at the height of 10 m above sea 4 3 solution method finite volume method is utilized to conduct a second order discrete of governing equations an unsteady pressure based solver is used to simulate gas dispersion and deflagration above sea and the simple algorithm is adopted for the pressure and velocity coupling schemes wei et al 2014 the simulation solution of the entire accident scenario is divided into three steps firstly the wind flow in computational domain is simulated to generate a steady wind field around offshore platform then the release of surface gas pool is activated and the dispersion simulation of gas released from surface gas pool is conducted based on the steady wind field in computational domain eventually deflagration simulation of flammable gas cloud is performed accounting for the appearance of ignition source on offshore platform 5 results and discussions 5 1 subsea gas release and dispersion to show an integrated development process of subsea gas release incident a brief description of underwater gas release and dispersion is presented in this section which could render a theoretical and logical basis for the research of gas dispersion and deflagration above sea a subsea gas pipeline in the south china sea is utilized as the case to illustrate the development of underwater gas plume and the environmental conditions in the south china sea including water depth ocean current speed and wind speed are used in simulations the example pipeline locates at the water depth of 110 m and the maximum ocean current speed is 0 7 m s a subsea gas pipeline ruptures fully due to fatigue failure fig 6 presents the bubbles movement trajectory in seawater which is predicted using eulerian lagrangian approach since the surrounding parameters of seawater such as pressure and temperature vary with water depth and the density and diameter of bubbles also vary with the water depth the density of bubbles decreases with water depth decreasing while the diameter of bubbles increases with water depth decreasing bakli 2014 when a subsea gas release happens the gas moves into seawater rapidly and disperses towards free surface under the action of buoyant force besides bubbles also move along downstream direction due to carry of current in the end the gas reaches sea surface and disperses into atmosphere generating a circular gas pool with the radius of 34 m on sea surface as shown in fig 5 it is assumed that surface gas release rate is 390 kg s which is used for illustrative purpose in practice any release rate is possible due to change of operational conditions due to the appearance of offshore platform the flammable gas on sea surface has an adverse impact on its operation safety a potential scenario is assumed that a jack up drilling platform locates in the downwind of surface gas pool the distance between surface gas pool and jack up drilling platform is 30 m the diagram of the accident scenario depicted above can be clearly seen in fig 5 5 2 flammable gas cloud assessment 5 2 1 wind field on sea surface the average wind speed at the height of 10 m above sea is 4 5 m s liu et al 2015 which is based on actual observation data in this area wind speed distribution at different heights is depicted by eq 12 fig 7 presents the wind velocity distribution in the vertical direction it is clear that wind speed above sea increases with the increase of height as can be seen offshore platform has a significant effect on wind speed distribution due to the obstruction and reflection of offshore platform the speed and direction of wind around offshore platform change apparently and some zones with low wind speed are generated in downwind direction including the surrounding area of the cantilever beam and the helicopter platform as well as the behind of living building in addition since the effect of topside modules of offshore platform on airstream distribution some zones with swirl flow are formed on offshore platform e g peripheral areas of cantilever beam main deck behind of living building and helicopter platform shown as the velocity vector profile in fig 7 b above mentioned zones have the poor ventilation condition which may lead to flammable gas gather and induce a flammable gas deflagration accident fig 8 gives the wind speed distribution on offshore platform in the horizontal direction a symmetrical airstream speed distribution on offshore platform is presented and the wind speed distributions on the port and the starboard are nearly same which takes the longitudinal central line of offshore platform as the symmetry axis due to the obstruction and shelter of topside modules the airstream speed decreases apparently as shown in the zones with blue color in fig 8 a in addition some zones with low airstream speed and swirl flow can also be clearly seen in the horizontal velocity vector profile fig 8 b which includes the areas between cantilever beam and living building as well as behind of living building the low airstream speed on offshore platform ranges from 0 to 0 6 m s while the maximum speed of airstream on offshore platform is 4 17 m s fig 9 presents the turbulence kinetic energy and intensity of offshore platform surface under the action of wind which is corresponding to the wind speed distribution on offshore platform the complex turbulence filed is generated on the offshore platform surface due to the action of wind the strong turbulent movement appears on offshore platform surface the maximum turbulence kinetic energy is 1 65 m2 s2 and the maximum turbulence intensity is 1 34 as can be seen the area of weak turbulent movement mainly locates behind of cantilever beam and living building flammable gas may gather in these areas and necessary ventilation and fire prevention measures are required to be carried out in the scenario that flammable gas releases in the upwind direction 5 2 2 dispersion analysis the combustible concentration range of natural gas is within 0 05 0 15 li et al 2016 the concentration isosurface of 0 05 is defined as the distribution area of flammable gas cloud the development process of flammable gas cloud above sea under the action of wind is shown in fig 10 because of surface gas pool with large size the surface gas release velocity is very small during the initial stage of dispersion flammable gas cloud moves along downwind and closes to offshore platform gradually when flammable gas cloud reaches offshore platform it crosses over the stern of offshore platform and covers the drill floor rig and cantilever beam shown as the flammable gas cloud in 30 s besides flammable gas cloud also moves upwards under buoyant force and the height of flammable gas cloud increases with dispersion time eventually a steady flammable gas cloud with a certain geometric size is generated which locates above offshore platform fig 11 presents the variation process of spatial parameters of flammable gas cloud including length height width coverage area and volume length and width of flammable gas cloud gradually increase with time and reach the maximum values at 80 s then they decrease and reach the steady values the steady values of length and height are 322 m and 103 m respectively while the width of flammable gas cloud nearly has no change with time which approximately equals to the diameter of gas pool the coverage area is defined as the projection area of flammable gas cloud along the vertical direction as seen in fig 11 b the coverage area and volume of flammable gas cloud increase with time and then reach the steady values after a little drop the steady values of coverage area and volume are 12394 m2 and 44139 m3 respectively fig 12 presents the dangerous area distribution on offshore platform dangerous area is defined as the zone that the concentration of flammable gas is within the flammability limits as seen in fig 12 the dangerous area mainly distributes on drill floor and cantilever beam while the gas with lower concentration distributes on the main deck due to the shelter of living building no flammable gas exists behind of living building therefore the drill floor and the cantilever beam are identified as the main dangerous area on offshore platform drill floor is the core operation area of offshore drilling platform due to the continuous drilling operation some potential ignition source e g sparks from a collision hot surface etc may induce a deflagration accident based on the simulation results of gas dispersion flammable gas detection and alarm devices are required to be equipped in windward side of offshore platform through which the flammable gas from the release in upwind direction can be detected in time and the emergency response can also be implemented rapidly furthermore the positive ventilation and fire suppression system are required to reduce the accumulation of flammable gas and prevent fires in the present study the above mentioned safety measures are recommended to be placed in drill floor area and these devices with safety functions should be maintained regularly to improve their availability and ensure that can be activated in an accident scenario when the flammable gas from upwind is detected all operations should be stopped to avoid the possible ignition induced by operations and fire suppression system should be prepared well to prevent and mitigate the possible fire accident 5 3 deflagration consequences assessment 5 3 1 overpressure this paper accounts for the possibility of ignition due to operations on offshore platform and the subsequent deflagration scenario is studied in this section it is assumed that ignition happens on drill floor at 2 min after surface gas release and dispersion the overpressure distribution on offshore platform surface is shown in fig 13 in the example scenario drill floor is a nearly full open space on the other hand flammable gas cloud locates on an open space and it is diluted timely under the action of wind thus the deflagration overpressure is small the maximum overpressure is about 960 pa and a negative pressure area is generated in drill floor according to overpressure damage criterion wei 2013 deflagration overpressure in example scenario cannot pose a damage to human life and steel structures 5 3 2 high temperature due to the continuous release of gas from surface gas pool the gas deflagration gradually develops into pool fire on sea surface the development process of deflagration flame is depicted in fig 14 by the geometric shape of flame at different times overall the development process of deflagration flame can be divided into initial stage propagation stage peak stage decremental stage and steady stage since the initial ignition happens on the drill floor the flame starts and propagates from drill floor and it mainly spreads towards the top of computational domain in the initial stage with the continuous reaction more and more flammable gas involves burning flame propagates to upper space of surface gas pool and geometric size of deflagration flame reaches maximum seen as the flame at 40 s the height of flame is 198 m and the width of flame is 129 m note that some small flames distribute in the surrounding area of helicopter platform and living building which may hamper the operation of rescue and escape the simulation indicates that deflagration flame develops along downwind under the action of wind the steady deflagration flame distributes above offshore platform and covers some topside modules of offshore platform in the later stage of deflagration flame development height and width of flame gradually decrease due to consumption of flammable gas in external space eventually burning state of deflagration flame is into the steady state and height width length of flame in steady state are 210 m 111 m 122 m respectively the flame flows along downwind direction under the action of wind which almost completely covers the offshore platform besides steady flame also exists below the main deck seen as the deflagration flame at 140 s fig 15 presents the temperature distribution on offshore platform surface under the steady deflagration flame the maximum temperature on platform surface is 1020 k while the minimum temperature is 390 k the area on offshore platform with high temperature mainly distributes on drill floor and cantilever beam and the temperature on these areas is out of 840 k as seen in fig 14 rig is always covered by deflagration flame and the maximum temperature on rig surface is above 930 k damage criterion of flame temperature on human and steel structure is shown in table 1 wei et al 2014 which gives four critical damage temperature on human body and steel structure based on critical damage temperature the areas with critical temperatures on offshore platform surface are shown in fig 16 it can be seen that the temperature on drill floor cantilever beam bottom of rig and main deck reaches critical damage value of steel structure i e 673 k and 873 k the structural strength stiffness and fire resistance of steel structure will decrease in a short time under the continuous action of deflagration flame above mentioned structures on offshore platform may undergo a partial or complete failure the temperature on the whole offshore platform surface is out of critical damage value of human body i e 391 k and 453 k people on offshore platform will suffer from the serious damage due to high temperature note that the temperature on helicopter platform is not able to induce steel structure failure therefore when the deflagration accident happens the operators should evacuate towards the bow of offshore platform and the potential rescue and escape can be achieved by helicopter platform the temperature distribution in vertical and horizontal planes of offshore platform is shown in fig 17 which presents the temperature field around offshore platform generated by surface gas pool fire comprehensively as seen in vertical temperature field the higher temperature distributes below the main deck which ranges from 1962 k to 2146 k due to the shelter of topside modules the front of barite tank and ash tank as well as the behind of living building have the relatively lower temperature the temperature in above two zones ranges from 300 k to 485 k which are identified as the potential safety areas for rescue and escape as seen in horizontal temperature field the maximum temperature distributes on starboard which ranges from 1777 k to 2146 k in addition it can be found that the temperature on the port is lower than the starboard 5 3 3 heat radiation heat radiation is the other important damage form of deflagration flame and it can cause deformation and breakdown of equipment as well as human life loss the head radiation distribution on offshore platform surface is shown in fig 18 due to the influence of wind and topside modules on flame flow the heat radiation intensity on the bottom surface of offshore platform is greater than the top surface and the radiation intensity on the stern is greater than the bow the areas with minimum heat radiation intensity include behind of living building and the top of helicopter platform damage criteria of heat radiation shown in table 2 wei 2013 is utilized to assess the impact of heat radiation on offshore platform the damage criteria of heat radiation define the critical values of radiation intensity and the corresponding impact on steel structures and human body the heat radiation distribution on offshore platform surface with critical damage values is shown in fig 19 the radiation intensity on the most area of offshore platform the area in fig 19 with fluorescent color is out of the critical value of serious structure damage i e 37 5 kw m2 according to damage criteria drill floor rig and main deck will suffer from a serious structural damage and even collapse the whole bottom of offshore platform will experience a serious failure or deformation under the continuous action of heat radiation with high intensity which means that the whole platform may collapse note that the helicopter platform just undergoes a slight damage however the radiation intensity on offshore platform is far above the critical damage value of human body and the major personal injury will be caused based on the simulation results of deflagration the high temperature and heat radiation are the main damage forms of gas deflagration in a deflagration scenario the fire suppression measures including a carbon dioxide fire suppression system as well as a water deluge system are recommended to be installed on offshore platform which should be activated to mitigate deflagration consequences due to the large influencing area of high temperature and heat radiation in upwind direction of offshore platform the operators on offshore platform should evacuate towards the bow of offshore platform in the case of deflagration accident and helicopter platform is the possible approach for rescue and escape 6 summary and conclusions this paper conducts a systematic simulation and assessment for flammable gas dispersion and deflagration above sea from a subsea release which is based on an integrated 3d cfd model the simulations integrate gas release dispersion and deflagration the concern of this paper is a specific accident scenario and the focus is to analyze the evolution process of accident and assess its impact on offshore platform some useful results including the wind filed around offshore platform the spatial distribution of flammable gas cloud the dangerous area on offshore platform and the influencing area of deflagration consequences are derived from the simulations based on simulation results the corresponding prevention and mitigation strategies are discussed the process of gas dispersion and deflagration above sea from subsea release can be summarized as follows when a subsea gas release happens underwater gas migrates from seafloor to sea surface and disperses into atmosphere generating a circular gas pool on sea surface subsequently gas releases continuously from surface gas pool and migrates above sea under the action of wind generating a flammable gas cloud on sea surface due to the appearance of ignition source a deflagration accident of flammable gas is induced which have a serious impact on offshore platform the topside modules of offshore platform have an important effect on the airflow distribution around offshore platform due to their obstruction and reflection some areas with low airstream speed and swirl flow are generated which may cause flammable gas gather in these areas in the case simulation a steady flammable gas cloud is formed above offshore platform which crosses over stern and covers drill floor rig and cantilever beam the size of flammable gas cloud increases with dispersion time drill floor and cantilever beam are identified as the dangerous area and gas concentration in these areas is within the flammability limits effective prevention and mitigation measures such as flammable gas detection and alarm device ventilation and water spray are required to be placed in identified dangerous areas since flammable gas cloud distributes in an open space deflagration overpressure is smaller than the minimum critical damage value which cannot pose a damage to human body and steel structure however the high temperature and the heat radiation from gas deflagration are very great which have the serious damage to steel structure of offshore platform and human life in the case of deflagration operators should evacuate towards the bow and the helicopter platform is the available approach for rescue and escape acknowledgement the authors gratefully acknowledge the financial support provided by the national key r d program of china no 2016yfc0802305 the fundamental research funds for the central universities no 15cx05022a and the postgraduate innovation engineering project of china university of petroleum east china no ycx2018053 furthermore the thanks are also given to anonymous reviewers for giving the valuable comments and suggestions 
23237,we present the system of linear equations to be solved to evaluate the reflection coefficient at a sponge layer boundary with damping forces ρ f s l ρ β u where β is the sponge layer function the case of 2d waves is discussed in details and different sponge layer functions are proposed the linear system is solved using the finite element method fem at low computational cost compared to the target simulations this method should enable the design of efficient sponge layer for any full navier stokes solvers the linear model results solved with a fem solver are compared here to sph simulations with good agreement the linear model is then used to determine the reflection coefficient for different power sponge functions length and dissipation coefficient using the fem solver the linear model solved by a simple fem solver can be used to evaluate the suitable dissipation coefficients for waves ranging from shallow to deep water for a given sponge layer length the coefficient depends on the non dimensional frequency for ω ω d g 2 a table of suitable parameters for different sponge layer functions is provided over a large range of non dimensional frequency and sponge layer length a 3d application of waves is also presented with 45 incidence angle keywords water waves wave absorption sponge layer linear theory 1 introduction the study of water wave problems in open ocean is a challenge for the design and optimization of various ocean and coastal engineering problems coastal defence works oil platforms ships wave energy converters etc experimentally these problems are studied in finite length facilities and waves are absorbed using most popularly beach like passive absorption regions le méhauté 1972 poupardin et al 2012 brossard et al 2009 tiedeman et al 2012 ouellet and datta 1986 straub et al 1957 or active absorbers at the wave generator called active wave absorber systems awas milgram 1970 schäffer and klopman 2000 numerically the models are limited by computational cost thus the strategy is to simulate the waves in the smallest possible domain to capture all the desired physics with the desired accuracy to capture for instance the radiation but also in some cases the induced currents and let the waves exit the domain without reflecting on the boundaries there exist different strategies to absorb waves in simulations a sommerfeld condition luppes et al 2010 clément 1996 higuera et al 2013 and momentum source term or damping force to absorb the waves are the most popular grilli and horrillo 1997 clément 1996 perić and abdel maksoud 2016 park et al 1999 different forms of the forces have been investigated an external pressure correction based on the vertical velocity grilli and horrillo 1997 clément 1996 or a volume force perić and abdel maksoud 2016 park et al 1999 the latter is the simplest absorption to implement it consists in adding dissipative forces to the governing equations one can for instance add viscous forces by increasing the viscosity of the fluid to absorb the waves this requires to implement implicit viscous forces to avoid penalty on the time step and can be a challenge in certain numerical methods a simpler idea is to add linear dissipative forces of the form of 1 ρ f s l ρ β u in the absorbing region where ρ is the density β is called the sponge layer function and u is the velocity vector the sponge layer function can be characterized by its mean value in the sponge layer β m e a n or the dimensional sponge layer strength and its length x s l this damping force can be straightforwardly implemented implicitly thus has no effect on the time step of the original method it is also possible to apply the dissipation force to certain directions of the momentum conservation equations perić and abdel maksoud 2016 periä and abdel maksoud 2018 in the present paper we consider solely the case where the dissipation is applied to all the directions the region of absorption has many names in the literature sponge or absorbing layers altomare et al 2015 2017 modave et al 2010 damping zones altomare et al 2015 numerical beaches clément 1996 to cite a few in this paper it will be referred to as sponge layer the cost of the method is then directly linked to the length of this absorbing layer x s l and the efficiency to the value of the sponge layer strength β m e a n a sponge layer is said to be effective if the reflection coefficient is smaller than a threshold value here 5 it is not rare to proceed by trials and errors to find the best coefficient perìc abdel maksoud perić and abdel maksoud 2016 proposed a scaling law to select the length and coefficient based on numerical trials and developed a pseudo analytical model with good agreement with their simulations perić and abdel maksoud 2018 their model is developed for the case of damping forces applied to the horizontal momentum conservation le méhauté le méhauté 1972 proposed the design of permeable beaches in experimental tank with a similar model as most experimental and actual application tests are in intermediate and even shallow water waves above a submerged plate poupardin et al 2012 carmigniani et al 2017 murakami et al 1992 graws m 1989 mean current induced by short crested waves wei and dalrymple 2017 long shore currents longuet higgin 1970 to cite a few modave et al 2010 investigated the choice of the absorption parameters for shallow waters and show the importance of parameter β m e a n and its space dependance on the absorption efficiency the present study aims to provide a method to simply predict the optimal coefficients for the entire wave spectrum from shallow to deep water waves it is therefore important to use non dimensional notations to make the results universal based on le méhauté le méhauté wave diagram we define the non dimensional frequency ω ω d g the goal of the present paper is to provide the values of the sponge layer strength b m e a n β m e a n ω ℱ ω where ℱ 1 when ω 1 deep water limit for a given sponge layer function and sponge layer length x s l λ in this paper the general wave equations are derived with additional linear wave absorption forces compared to the potential wave theory it appears that no general bernoulli s equation can be derived the case of monochromatic waves is then considered writing the equation in terms of the pressure leads to a laplace s equation with a redefined gradient operator this equation is discussed in the case of two dimensional water waves the case of variable β with space is investigated and the solutions of the equations are compared to simulations of the full navier stokes equations for weakly compressible fluid with the smoothed particle hydrodynamics sph method as an example sponge layer optimal coefficients are evaluated for various sponge layer functions and sponge layer length using the linear model presented here with a golden section search algorithm the tables provided can be used for the design of efficient wave absorptions sponge layer for any numerical models in the last section a three dimensional configuration is considered to verify the ability of the results to absorb waves with an incident angle 2 waves absorption by energy penalisation general formulation 2 1 equations of motions and bernoulli s equations the motion of an ideal homogenous incompressible fluid of depth d x y with a free surface z ζ x y t is governed by the euler equations with boundary conditions 2 u 0 d z ζ t u u u 1 ρ p f s l 0 d z ζ p ρ g ζ p a t m at z ζ t ζ u ζ w 0 at z ζ u d w 0 at z d with appropriate conditions on the lateral boundaries where u u v w is the velocity vector g denotes the gravitational acceleration p the kinematic pressure minus the equilibrium pressure ρ g z and f s l is the additional damping force used in the sponge layer in this paper the dissipation is applied to all directions from now on it will be considered that 3 f s l β x y u note that the study is limited to function that depends only on the horizontal coordinates x and y a standard approximation in water wave problems is to consider the flow irrotational and thus potential 4 u ϕ where ϕ is the scalar velocity potential in the absence of damping forces f s l 0 the bernoulli s equation can then be derived and links the scalar velocity to the pressure allowing to write the well known potential wave theory equations the general bernoulli s equation reads 5 t ϕ 1 2 u 2 1 ρ p 0 x nonetheless adding the sponge layer dissipation term does not allow the derivation of the bernoulli s equation everywhere in the fluid anymore for all the cases it is possible though to derive a modified bernoulli s equation in the case of constant dissipation β β 0 6 t ϕ 1 2 u 2 1 ρ p β 0 ϕ 0 x as done by le méhauté le méhauté 1972 while studying the design of porous absorbing beaches for experimental implementation it appears then that the potential flow approximation is not proper for this case using a perturbation method and redefining the gradient operator it is yet possible to write the problem similarly to the well known linear potential theory in the form of a laplace s equation with proper boundary conditions 2 2 perturbation method and sponge layer equations consider a monochromatic wave train similarly to water wave problems the solution is expanded near an undisturbed configuration and using complex notation 7 u p ζ ℜ ε u 1 p 1 ζ 1 e i ω t ε 2 u 0 p 0 ζ 0 u 2 p 2 ζ 2 e 2 i ω t 0 ε 3 where ε is a small parameter ω is the angular wave frequency the superscripts k refer to the expansion terms 0 being the time independent induced terms 1 the first harmonic and so on retaining only first order terms in the momentum equation second line of eq 2 leads to 8 u 1 i ω β 1 ρ p 1 thus the velocity is still directly linked to the pressure but not through a simple gradient as it is the case for the linear potential wave t0heory it is clear also from this development that the term β can be linked to the wave angular frequency ω a new gradient operator is defined as 9 grad 1 i b where the nabla operator refers to the regular gradient and b β ω injecting into the continuity equation first line of eq 2 yields a modified laplace equation for the pressure the general problem to be solved to evaluate the efficiency of the sponge layer is then 10 i ω 1 i β ω δ p 1 p 1 β 0 d z 0 z p 1 p 1 1 i β ω ω 2 g 0 at z 0 p 1 d z p 1 0 at z d with adequate lateral boundary conditions the free surface can be reconstructed using 11 ζ 1 p 1 ρ g at z 0 note that the first equation is a laplace s equation with the newly defined gradient operator and can be written 12 grad p 1 0 using this set of equations the efficiency of the sponge layer is found by evaluating the reflection coefficient upstream of the sponge layer the value found corresponds to the first order reflection coefficient in experimental works it is common to evaluate the reflection and transmission coefficients using the two probes method of goda suzuki goda and suzuki 1976 or a single moving probe method brossard et al 2009 in all cases a fast fourier transform fft is done to extract the first harmonic and thus only the first order coefficients are evaluated this justifies the limitation to the first order theory in the evaluation of the efficiency of the sponge layer note that the reflection coefficient for the wave s first harmonic cannot be directly evaluated from the surface envelope due to non linearities for instance free modes can induce envelope oscillations which are different from reflection another example is the surface envelope of a non linear wave reflection at a wall for which second order terms lead to non zero surface oscillations at the linear nodes the equations eq 10 are written in a general manner in 3d with variable depth d this enables the extension of the present study to the evaluation of combined inclined beaches and simple sponge layer in the next section the study is limited to two dimensions and constant water depth 3 two dimensional applications with constant depth in this section it is first assumed that flow is two dimensional i e we assume the flow to be invariant through y translations with zero y velocity component and the water depth d is constant 3 1 linear two dimensional equations and sponge layer functions the sponge layer function is written 13 β x ω b x where b is a positive non dimensional shape function and is zero outside of the sponge layer region the system of equations of eq 10 now reads in 2d 14 1 i b δ p 1 i x p 1 x b 0 d z 0 z p 1 p 1 1 i b ω 2 g 0 at z 0 z p 1 0 at z d the velocity and surface elevation are reconstructed using 15 u 1 grad p 1 i ρ ω 16 ζ 1 p 1 ρ g at z 0 in the above equations the laplace and gradient operators are two dimensional i e the x z plane z denoting the vertical coordinate it is convenient to work with non dimensional equations from now on so that the results found in the present paper can be straightforwardly applied to other cases we define the following non dimensional parameters 17 x z x z d t t g d k k d ω ω d g p p 1 ρ g d the system of equations reads 18 1 i b δ p i x p x b 0 1 z 0 z p p 1 i b ω 2 0 at z 0 z p 0 at z 1 the non dimensional velocity and surface elevation are reconstructed using 19 u 1 grad φ 20 z 1 p at z 0 where the scalar velocity potential φ is 21 φ p iω 3 2 sponge layer functions we consider the case of continuous sponge functions different forms of sponge functions are proposed based on the literature the linear sponge layer model eq 18 or eq 14 developed in the previous section can then be solved using a fem solver to evaluate the reflection coefficient the case of power sponge layer is then studied in details and the fem based solutions compared to numerical simulations obtained using the sph method the linear sponge layer model solved with fem can be used to find the optimal coefficient for a given sponge layer length in the literature different types of sponge layer functions are considered in this paper we define three general sponge layer functions 1 the power sponge layer altomare et al 2015 22 b x b m a x x x 0 x m a x x 0 n b ℋ x x 0 2 the trigonometric sponge layer cherfils et al 2008 23 b x b m a x sin n b π 2 x x 0 x m a x x 0 ℋ x x 0 3 the exponential sponge layer perić and abdel maksoud 2018 24 b x b m a x e x x 0 x m a x x 0 n b 1 e 1 ℋ x x 0 where in all cases n b 0 b m a x is the maximum value of the sponge layer coefficient at the end of the sponge layer domain x m a x x 0 denotes the beginning of the sponge layer region and ℋ is the heaviside function fig 1 shows different sponge layer function profiles it appears that the slope is more gentle near the beginning of the sponge layer as the power coefficient n b is increased the trigonometric sponge layer presents the characteristic of having a gentle slope toward the end of the sponge layer domain too at the cost of higher slope within the main part of the sponge in the next section the power sponge layer is primarily used as it is simpler to define the mean value of b in the sponge layer b m e a n b m a x n b 1 and it has been used before for sph simulations by previous authors altomare et al 2015 with rather good results here the goal is to provide a method to evaluate the suitable parameters for the sponge layer so the function in itself is not important all the sponge layer functions are considered in section 3 4 where suitable absorption parameters are provided for numerical modelling 3 3 finite element solver and sph model the system eq 18 or eq 14 can be easily solved using a commercial finite element solver in this paper the ndsolve function of mathematica is used to solve the linear system at low cost to find the reflection coefficient for different sponge layer parameters see convergence study in appendix a a single cpu is used to run the mathematica code and it takes about 0 5 s to solve the linear problem for this optimization problem the following numerical configuration is considered a physical domain of length l ϕ 2 m and water depth d 0 15 m where no dissipation is added and a sponge layer of variable length x s l x m a x x 0 d see fig 2 the frequency is fixed to f 0 1 5 hz this configuration corresponds to ω 1 17 and the waves are considered to be generated using a piston type wave maker in the linear theory approximation this is equivalent to a neumann boundary condition on the horizontal velocity at the mean piston position the piston stroke amplitude can be linked to the target incident wave amplitude by 25 s 0 a inc 2 k d sinh 2 k d 4 sinh 2 k d where a inc is the target wave amplitude in the absence of reflection linton and mciver 2001 since the theory is for linear waves the wave amplitude is a scaling parameter the results are compared to numerical simulations obtained using the smoothed particle hydrodynamic sph method see violeau and rogers 2015 violeau and rogers 2016 for a description of the method and appendix b for a short presentation of the model used here and how to implement the sponge layer the sph simulations are run on a single gpu card geforce gtx titan black and takes about 6 h for the sph simulations the wave amplitude is first fixed to a inc 1 cm and the skewness is k a inc 0 1 the simulations are run with a fixed particle size r 0 such that d r 0 60 and for 35 waves periods the waves can travel about 10 times the entire tank length the surface particle positions are sampled at δ t t 101 where t 1 f 0 is the wave period using marrone et al s method marrone et al 2010 with a threshold of 0 55 fig 3 shows the instantaneous horizontal velocity at the end of the simulation for the case x s l 2 λ with n b 3 b m a x 0 5 the surface particles are outlined in black to check that an asymptotic regime is reached the goda suzuki goda and suzuki 1976 two probes method is applied on sample time of 2 wave periods at different instance for a tank with a power sponge layer of length x s l 2 λ with n b 3 b m a x 0 5 the method uses a fft to evaluate the amplitudes of the incident wave a i travelling away of the wave maker shoreward and the reflected wave a r travelling toward the wave maker seaward the reflection coefficient is found by evaluating r a r a i more details on the method can be found in goda and suzuki 1976 the probes are spaced by a quarter of wavelength and centered in the physical part of tank see fig 2 fig 4 shows the measured reflection coefficient and incident wave amplitude with time an asymptotic regime is reached after 20 wave periods note that from now x s l x s l λ is the non dimensional sponge layer length and is compared to the wavelength instead of the undisturbed water depth d as in section 3 1 to see the influence of b m a x on the reflection coefficient fig 5 shows the surface enveloppe over the last 5 wave periods for three cases with a power sponge layer of length x s l 2 λ with n b 3 b m a x 0 5 5 32 for the first case clear reflections are visible and outlined in the envelope by the red lines which are spaced by half a wavelength on the other hand for the case b m a x 5 the enveloppe shows small fluctuations these fluctuations are not due to reflections but to combinations of different wavelength waves the piston generates also free modes of higher order in this case the reflection is not as high as it might appear from this graph to capture only the first harmonic terms a fast fourier transform with time of the different probes position is performed the amplitude of the first harmonic is displayed in fig 6 for the three cases this is different from the enveloppe amplitude the amplitude is non dimensionalised by the incident wave amplitude the results are compared to the linear sponge layer model red dashed lines with good agreement for the last case with the largest value of b m a x 32 the surface shows again reflection characteristics fig 7 shows the influence of the value of mean sponge layer strength in the sponge layer on the reflection coefficient for different power sponge layer functions compared to the theory the mean sponge layer strength is defined as 26 b m e a n 1 x s l x 0 x m a x b x d x for power sponge layers it comes 27 b m e a n b m a x n b 1 the choice of this non dimensional parameter is such that the minimum of the sponge layer theoretical reflections are aligned first notice that in the simulations the reflection coefficient plateaus to a threshold value of 1 2 this is partially due to the particle size used here and other non linear effects not accounted for in the simplified linear sponge layer model the simulations then follow the theory trend when the reflection increases again above this threshold value the linear theory correctly predicts the position of the minimum and the influence of the b m e a n and n b on this large range of values for the cases n b 3 or 4 the value of b m e a n can be set anywhere between 0 2 and 6 and the reflection will be lower than 3 this large range of acceptable values outlines the fact that the sponge layer is probably larger than it could be for this power function using the theory one can show that it is possible to reduce significantly the sponge layer length while keeping the same absorption efficiency absorption efficiency means here small reflection coefficient the value n b 3 is fixed and the sponge layer length is varied in this second test fig 8 shows the influence of the sponge layer length on the results compared to the theory we see that with a sponge layer as small as 0 8 λ it is possible to have a reflection coefficient as small as 2 this is enough for numerical simulations compared to experimental wave fume where the reflection coefficients can be of the order of 10 or even larger ouellet and datta 1986 rey and touboul 2011 the drawback is that the range of values of b m e a n for which the reflection is small is narrower this justifies the importance of using the linear theory equations derived earlier to find this optimal prior to running the full navier stokes numerical model 3 4 sponge layer prediction and optimal for fixed ω as an application example the previous case with ω 1 17 fixed is now studied using the fem based solution of the linear theory to seek the optimal sponge layer strength b m e a n for a given sponge layer length x s l non dimensionalised by the incident wavelength and for power sponge layer type functions we chose to work with the sponge layer as there is a simple relationship between the mean value of the sponge layer strength and its maximum a similar method can be used for other type of sponge functions fig 9 shows the reflection of the sponge layer contour plot obtained for 4 different values of n b for the power sponge layer function the red contours outline the limit for 1 and 2 reflections for n b 1 to have a reflection of less than 5 about the numerical accuracy the smallest theoretical sponge layer length is 0 5 λ and b m e a n 0 51 0 81 and for 2 b m e a n 0 58 0 68 the minimum reflection for this length of sponge layer is found at b m e a n 0 62 with a theoretical reflection of the order of 0 8 the values are found using a golden section section search algorithm kiefer 1953 assuming unimodal behaviour yet this small reflection range is also limited in terms of sponge layer length one can see that increasing the sponge layer length for b m e a n can lead to larger reflection coefficient for this case the present linear theory shows that it is possible to use as small as 0 5 λ long sponge layer for this case to verify this result found using the present linear model simulations are run with x s l 0 5 λ using the sph method the results are shown in fig 10 for larger n b the minimum sponge length to reach the 5 and 2 thresholds increases for n b 3 at x s l 0 5 the minimum reflections is 13 for b m e a n 0 69 one needs to have about x s l 0 7 to reach less than 5 reflection with b m e a n 0 5 and x s l 0 8 to get less than 2 with b m e a n 0 46 for n b 4 the minimum length is 0 9 b m e a n 0 41 and 1 0 b m e a n 0 4 respectively the contour plots of fig 9 provide important informations for efficient absorptions one wants to have the smallest possible sponge layer but also the one that absorbs efficiently all the free and linked modes due to non linearities and scattering for instance if one chooses a sponge layer with a linear sponge layer function n b 1 of non dimensional length x s l 0 5 with b m e a n 0 6 then the second harmonic will see a sponge layer equal to its wavelength and the free mode of about 1 8 time its wavelength though the absorption of the second harmonic requires to develop the theory to the next order the free mode absorption follows the same theory the sponge layer efficiency for the free mode can therefore be inferred from the contour plots of fig 9 the apparent b m e a n will be half the one of the first harmonic thus 0 3 for the free mode see green diamond point it is still in the acceptable range of 5 for this case yet it is clear that the higher frequency free modes will be less efficiently absorbed as the apparent b m e a n diminishes the green point in fig 9 shows this case example for n b 1 a good strategy is thus to select a value near the upper bound of the interval of interest to have the best absorption of higher modes note though that usually these modes have smaller amplitudes or also dissipate faster due to viscous dissipation wave breaking and so on table 1 shows the confidence intervals for a reflection of 5 and the minimum of reflection in this range the data outlined in red shows the cases where the minimum is below 2 the results of the table are also displayed in the contour plots the blue points show the range of 5 while the white line shows the minimum path once the 5 threshold is reached and the white diamonds the minimum values listed in table 1 so far the angular frequency was fixed to ω 1 17 we showed that it was possible to use the linear theory and a simple fem solver to predict the optimal absorption conditions it is found that one can have a sponge layer as small as 0 5 λ for this case due to the non linearity of the dispersion relation one cannot use directly the optimal value found for ω 1 17 for other wave angular frequencies 3 5 sponge layer prediction as a function of ω in this subsection we fix the water depth and the sponge layer length to x s l λ ω d where the brackets outline the fact that the wavelength is a function of the frequency and depth a power sponge layer is used with n b 3 and a sponge layer mean coefficient b m e a n 0 36 this value corresponds to an optimal sponge layer strength in the limit of deep water waves see fig 12 commented in the next paragraph the wave angular frequency is varied the reflection coefficients measured in the simulations are displayed in fig 11 in gray as a function of the non dimensional angular frequency ω the sph simulations gray symbols are compared to the linear theory results found using the fem solver solid gray line it is clear that the ability of the sponge layer to absorb the wave depends on the wave frequency this is due to the non linear form of the dispersion relation the difference of trend between the sph simulations and the linear model as ω increases slightly increasing reflection is believed to be due to the relative coarseness the particle size is fixed and the wavelength diminishes the increasing non linearities the wave amplitude is fixed here and the increasing numerical dissipation in the wave propagation an improvement in the sph simulations would be to reduce the particle size as the wave frequency is increased and use renormalisation operators as done in vila 2005 this is outside the scope of the present study using the golden section search algorithm and the fem solver we show in fig 12 the evolution of the optimal b m e a n with ω for the power sponge layer for n b 3 and x s l 1 it appears clearly in this graph that b m e a n is a constant in the limit of deep water waves this optimal value was used to generate the gray data in fig 11 for ω 2 the optimal is no more a constant referring to the linear model the optimal value of b m e a n increases as ω diminishes in fig 11 the reflection coefficient found for this optimal values using the sph method and the fem solver are displayed in black with the optimal value we are able to keep the reflection coefficient below 3 dashed line on the entire spectrum tested here this illustrates the importance of knowing the proper b m e a n as a function of ω note that the reflection coefficient still increases as ω diminishes in the linear sponge layer model with optimal absorption to get a constant reflection coefficient one would probably need to increase the sponge layer length to wavelength ratio as ω diminishes in the present study we limit ourself to finding the optimal value for a given sponge layer length to wavelength ratio here x s l 1 and wave angular frequency finally table 2 provides values of b m e a n for which the reflection is minimum for different values of ω and different sponge layer functions the values are listed if below 5 and in red if below 2 the results are obtained using the golden section search algorithm kiefer 1953 the table stops at ω 2 0 as for larger values the variations are not significant and b m e a n is approximatively a constant consistently with the results of perić and abdel maksoud 2016 perić and abdel maksoud 2018 solving the present linear problem and search for the optimal for a given ω is cheap in computational time and can save precious computational efforts in the present case fem solver takes about half of a second to solve the linear equations and the golden section search takes about a minute to find the optimal value on the other hand the sph solver needs about 6 h to reach an asymptotic regime 4 3d application to show that the results found in 2d can be directly applied to 3d consider a wave flume of length l ϕ 2 m and ℓ 25 cm wide with an inclined sponge layer boundary of θ 45 incidence the simulations are run using the gpusph open source solver gpusph org 2017 with usaw boundary conditions see appendix b the particle size r 0 is fixed such that d r 0 30 there are 1 25 millions particules in the tank the simulation is ran on 4 gpu s nvidia gk110gl quadro k5200 for 15 s of physical times taking 48 h of simulation time the waves are generated using a piston wave maker the water depth is still 15 cm and the frequency 1 5 hz thus ω 1 17 the waves have a 45 incident angle with the sponge layer the sponge layer is designed to absorb most efficiently the waves perpendicular to it with a power sponge layer function optimized for x s l 1 for n b 3 we set b m e a n 0 45 see table 1 a top view of the simulated tank is shown in fig 13 fig 14 shows the instantaneous horizontal velocity field at the end of the simulation the surface is sampled on 3 lines perpendicular to the wave crest evenly spaced at the middle and quarter widths from the lateral walls the amplitude of the first harmonic and the phase are plotted along these three lines in fig 15 first it is noticed that in 3d the dissipation is important in the physical part this is due to additional numerical dissipation along with physical friction on the lateral walls the wavenumber of the generated waves is k 9 54 m 1 instead of k 0 10 0 m 1 of the linear theory the difference can originate from the difficulty of filling the tank using our current software which leads to a diminution of the water depth after particle rearrangement along with the increased friction at the lateral walls and non linear effects no apparent reflection patterns are visible in the amplitude graph as the sponge layer is inclined with the incident waves one might expect a modification of the incidence angle in the sponge layer and this is visible in the phase plot where the different profiles are out of phased in the sponge layer 5 conclusion in this paper the sponge layer equations are derived and perturbation method is applied for monochromatic waves a linear theory sponge layer pressure equation is found and can be easily solved using fem solver it predicts accurately the reflection coefficient as confirmed using a sph navier stokes solver the case of 2 dimensional waves is considered we show that the model can be used to predict accurately the optimal reflection coefficient using a golden search algorithm we are able to provide the optimal absorption parameters for a given sponge layer function shape and length at low computational cost we verified that the optimal sponge layer strength is a constant for deep water waves ω 2 and varies for intermediate depth waves tables of optimal absorptions are provided over a range of non dimensional wave angular frequencies where the coefficient varies for various sponge layer functions found in the literature a 3d application with the gpusph open source solver gpusph org 2017 is presented with this choice of parameters the reflection coefficient does not differ significantly from the predictions of the 2d problem a change of incident angle is observed in the sponge layer the authors outline the simplicity of solving the linear theory sponge layer problem which can be done before running a full navier stokes simulation to select the proper form and value of the sponge layer function the results match our simulations as long as the reflection is above a numerical threshold of 1 2 which is satisfactory for numerical simulations of water wave problems the linear theory can also be used to assess the efficiency of sponge layer used in previous papers where the authors frequently omit providing this essential information furthermore this can be also used to design a sponge layer such that the reflection coefficient matches the one of experimental investigations if provided acknowledgments the authors would like to thank alex ghaïtanellis sofiane martel martin ferrand and alexis hérault for their useful comments and interest in the project the authors would also like to thank edf for providing the cluster used for the 3d simulations finally they would like to acknowledge the valuable input from the reviewers which helped improve the clarity of the paper appendix a fem solver mesh and convergence the linear problem of eq 18 or eq 14 is solved using the fem solver embodied in mathematica w r inc 2017 ndsolve the mesh is constructed using toboundarymesh function first to correctly capture the edges then the toelementmesh function is used to mesh the interior the mesh is refined near the free surface such that the area of a cell is 100 times smaller for cells above the mid water depth the refinement is defined as the root square of the cells near the surface figure a 16 shows a mesh for a resolution d x λ 50 thus d x λ 5 at the sea bed fig a16 example of mesh used in the fem for d x λ 50 the mesh is refined near the free surface 3 fig a16 the resolution is first varied for a fixed value of the dissipation coefficient a power sponge layer of length 2λ with n b 3 and b m a x 0 5 is used here this corresponds to the configuration in the top graph of figs 5 and 6 the reflection coefficient is measured near the center of the physical part of the tank using the formula a 1 r z m a x z m i n z m a x z m i n the error corresponds to the relative difference between the most refined simulations here d x λ 10 3 the expected reflection is about 9 03 the results converges as seen in figure a 17 the vertical dashed line shows the resolution selected to evaluate the contour profiles fig a17 convergence test error on the value of the reflection coefficient for power sponge layer with n b 3 and b m a x 0 5 the dashed line shows the resolution used for the contour plots 4 fig a17 to see the effect of the grid size on the variation of the damping coefficient a convergence test is performed for power sponge layer of length 2λ with n b 3 with variable damping coefficient b m e a n the results are shown in figure a 18 away from the minimum region the curve converges rapidly the resolution of the red curve is used to construct the contour plots fig a18 convergence test reflection coefficient for power sponge layer with n b 3 as a fonction of b m e a n for different mesh resolution the red curve shows the resolution used for the contour plots 5 fig a18 appendix b sph method quick description in the present study we use a weakly compressible smoothed particle hydrodynamics method wcsph to solve the navier stokes equation sphynx solver in 2 d and gpusph open source solve in 3d gpusph org 2017 the equations are b 1 d d t ρ u ρ u 1 ρ g σ where g g e z is the gravitational acceleration g 9 81 m s 2 and σ is the stress tensor b 2 σ p i μ u u t in order to close this system of equations an equation of state is defined to relate the pressure and the density li 1967 b 3 p ρ 0 c 0 2 ζ ρ ρ 0 ζ 1 where ρ 0 is the reference density c 0 is the numerical speed of sound and ζ is the adiabatic index equals to 7 for water in the present simulations the speed of sound is fixed to c 0 10 g d max where d max is the maximum water depth which ensures that the flow is close to incompressible sph method is used to solve this problem the fluid is decomposed in particles which represents material points of fixed mass m and initial size at rest r 0 for example a p in fig b 19 fig b19 sketch of a fluid portion ω shaded blue domain near a solid boundary ω orange lines and the solid domain shaded in gray with a fluid particle a p and its kernel compact support ω a truncated by the boundary a vertex particle b v and its opening angle θ b the two connected segments s i s at the vertex particle b 6 fig b19 a function f evaluated at a position a is given by b 4 f a 1 γ a b p v b f b w a b where p is the set of all particles v b denotes the volume of the particle b w a b w r a r b the kernel function as a function of the distance between the particle b and the position a which is the quintic polynomial by wendland 1995 throughout the paper in the usaw unified semi analytical wall boundary conditions sph variant we define a kernel wall renormalisation factor γ a b 5 γ a ω w r a r b d r b where ω is the fluid domain which takes into account the fact that the kernel of a particle is truncated near a boundary it is possible to analytically evaluate this integral in 2 d ferrand et al 2011 but in the present study the value is computed throughout a governing equation b 6 d γ a d t v a r γ a where v a r is the relative velocity to the rigid boundary and γ a is given by a surface integral b 7 γ a ω w r a r n d r with n the inward oriented unit normal the boundaries in 2 d are divided in straight segments s linked by vertex particles v of mass a fraction θ of the reference mass m the fraction or opening angle θ b of the vertex particle b represents the interior opening angle of the two connected segments at this particle see fig b 19 and can be evaluated using b 8 θ b π sign t 1 t 2 n 1 n 2 arccos n 1 n 2 where t i and n i are the tangent and the inward normal vector of the two connected segments respectively the gradient and divergence standard sph operators are given with usaw boundary terms by b 9 g a γ f ρ a γ a b p v m b f a ρ a 2 f b ρ b 2 w a b ρ a γ a s s ρ s f s ρ s 2 f a ρ a 2 γ a s b 10 d a γ b 1 γ a ρ a b p v m b b a b b w a b 1 γ a ρ a s s ρ s b a b s γ a s where γ a s is the integral of the kernel on a boundary segment furthermore the usaw variant of the sph laplacian is defined as b 11 l a γ f a ρ a γ a b p v m b 4 f a f b f a f b a a a b r a b 2 r a b w a b 1 γ a s s f s a s f a a a γ a s where r a b r a r b the symplectic time integration scheme used is b 12 u a n 1 u a n 1 ρ a n g a γ p n μ ρ a n l a γ 1 u n g δ t r a n 1 r a n u a n 1 δ t γ a n 1 γ a n s s u a n u s n γ a s δ t ρ a n 1 1 γ a n 1 γ a n ρ a n b p m b w a b n 1 w a b n δ t d b δ n where the index n denotes the time iteration μ 10 6 m2 s is the kinematic molecular viscosity δ t c h 0 h c 0 with c h 0 0 1 in all the numerical applications d b 0 1 is the brezzi and pitkäranta diffusion coefficient and b 13 δ n ρ a n l a γ δ t g r b n l a γ δ t ρ b n p b n as shown in brezzi and pitkäranta 1984 ghaitanellis et al 2015 this additional term acts like a diffusive terms in the continuity equation and helps limit acoustic discrepancy in the pressure terms the pressure at the boundaries are interpolated from the fluid b 14 p w b p p b v b w w b b p ρ b g r w b v b w w b b p v b w w b the acceleration of the wall is not taken into account as it is always small compared to the gravity acceleration term at most 10 more details about the usaw variant of the wcsph method and its implementation can be found in the papers by ferrand et al 2011 and mayrhofer et al 2012 2013 in the sponge layer domain the velocity update is changed to b 15 u a n 1 u a n 1 1 β δ t where u a n 1 corresponds to the right hand side of the first equation in the system eq b 12 simulations in 2d are run using a single gpu card geforce gtx titan black while 3d applications are run on multi gpu s on a cluster 42 cards nvidia gk110gl quadro k5200 a 2d simulation takes about 6 h to run the results correspond to over 100 different configurations 
23237,we present the system of linear equations to be solved to evaluate the reflection coefficient at a sponge layer boundary with damping forces ρ f s l ρ β u where β is the sponge layer function the case of 2d waves is discussed in details and different sponge layer functions are proposed the linear system is solved using the finite element method fem at low computational cost compared to the target simulations this method should enable the design of efficient sponge layer for any full navier stokes solvers the linear model results solved with a fem solver are compared here to sph simulations with good agreement the linear model is then used to determine the reflection coefficient for different power sponge functions length and dissipation coefficient using the fem solver the linear model solved by a simple fem solver can be used to evaluate the suitable dissipation coefficients for waves ranging from shallow to deep water for a given sponge layer length the coefficient depends on the non dimensional frequency for ω ω d g 2 a table of suitable parameters for different sponge layer functions is provided over a large range of non dimensional frequency and sponge layer length a 3d application of waves is also presented with 45 incidence angle keywords water waves wave absorption sponge layer linear theory 1 introduction the study of water wave problems in open ocean is a challenge for the design and optimization of various ocean and coastal engineering problems coastal defence works oil platforms ships wave energy converters etc experimentally these problems are studied in finite length facilities and waves are absorbed using most popularly beach like passive absorption regions le méhauté 1972 poupardin et al 2012 brossard et al 2009 tiedeman et al 2012 ouellet and datta 1986 straub et al 1957 or active absorbers at the wave generator called active wave absorber systems awas milgram 1970 schäffer and klopman 2000 numerically the models are limited by computational cost thus the strategy is to simulate the waves in the smallest possible domain to capture all the desired physics with the desired accuracy to capture for instance the radiation but also in some cases the induced currents and let the waves exit the domain without reflecting on the boundaries there exist different strategies to absorb waves in simulations a sommerfeld condition luppes et al 2010 clément 1996 higuera et al 2013 and momentum source term or damping force to absorb the waves are the most popular grilli and horrillo 1997 clément 1996 perić and abdel maksoud 2016 park et al 1999 different forms of the forces have been investigated an external pressure correction based on the vertical velocity grilli and horrillo 1997 clément 1996 or a volume force perić and abdel maksoud 2016 park et al 1999 the latter is the simplest absorption to implement it consists in adding dissipative forces to the governing equations one can for instance add viscous forces by increasing the viscosity of the fluid to absorb the waves this requires to implement implicit viscous forces to avoid penalty on the time step and can be a challenge in certain numerical methods a simpler idea is to add linear dissipative forces of the form of 1 ρ f s l ρ β u in the absorbing region where ρ is the density β is called the sponge layer function and u is the velocity vector the sponge layer function can be characterized by its mean value in the sponge layer β m e a n or the dimensional sponge layer strength and its length x s l this damping force can be straightforwardly implemented implicitly thus has no effect on the time step of the original method it is also possible to apply the dissipation force to certain directions of the momentum conservation equations perić and abdel maksoud 2016 periä and abdel maksoud 2018 in the present paper we consider solely the case where the dissipation is applied to all the directions the region of absorption has many names in the literature sponge or absorbing layers altomare et al 2015 2017 modave et al 2010 damping zones altomare et al 2015 numerical beaches clément 1996 to cite a few in this paper it will be referred to as sponge layer the cost of the method is then directly linked to the length of this absorbing layer x s l and the efficiency to the value of the sponge layer strength β m e a n a sponge layer is said to be effective if the reflection coefficient is smaller than a threshold value here 5 it is not rare to proceed by trials and errors to find the best coefficient perìc abdel maksoud perić and abdel maksoud 2016 proposed a scaling law to select the length and coefficient based on numerical trials and developed a pseudo analytical model with good agreement with their simulations perić and abdel maksoud 2018 their model is developed for the case of damping forces applied to the horizontal momentum conservation le méhauté le méhauté 1972 proposed the design of permeable beaches in experimental tank with a similar model as most experimental and actual application tests are in intermediate and even shallow water waves above a submerged plate poupardin et al 2012 carmigniani et al 2017 murakami et al 1992 graws m 1989 mean current induced by short crested waves wei and dalrymple 2017 long shore currents longuet higgin 1970 to cite a few modave et al 2010 investigated the choice of the absorption parameters for shallow waters and show the importance of parameter β m e a n and its space dependance on the absorption efficiency the present study aims to provide a method to simply predict the optimal coefficients for the entire wave spectrum from shallow to deep water waves it is therefore important to use non dimensional notations to make the results universal based on le méhauté le méhauté wave diagram we define the non dimensional frequency ω ω d g the goal of the present paper is to provide the values of the sponge layer strength b m e a n β m e a n ω ℱ ω where ℱ 1 when ω 1 deep water limit for a given sponge layer function and sponge layer length x s l λ in this paper the general wave equations are derived with additional linear wave absorption forces compared to the potential wave theory it appears that no general bernoulli s equation can be derived the case of monochromatic waves is then considered writing the equation in terms of the pressure leads to a laplace s equation with a redefined gradient operator this equation is discussed in the case of two dimensional water waves the case of variable β with space is investigated and the solutions of the equations are compared to simulations of the full navier stokes equations for weakly compressible fluid with the smoothed particle hydrodynamics sph method as an example sponge layer optimal coefficients are evaluated for various sponge layer functions and sponge layer length using the linear model presented here with a golden section search algorithm the tables provided can be used for the design of efficient wave absorptions sponge layer for any numerical models in the last section a three dimensional configuration is considered to verify the ability of the results to absorb waves with an incident angle 2 waves absorption by energy penalisation general formulation 2 1 equations of motions and bernoulli s equations the motion of an ideal homogenous incompressible fluid of depth d x y with a free surface z ζ x y t is governed by the euler equations with boundary conditions 2 u 0 d z ζ t u u u 1 ρ p f s l 0 d z ζ p ρ g ζ p a t m at z ζ t ζ u ζ w 0 at z ζ u d w 0 at z d with appropriate conditions on the lateral boundaries where u u v w is the velocity vector g denotes the gravitational acceleration p the kinematic pressure minus the equilibrium pressure ρ g z and f s l is the additional damping force used in the sponge layer in this paper the dissipation is applied to all directions from now on it will be considered that 3 f s l β x y u note that the study is limited to function that depends only on the horizontal coordinates x and y a standard approximation in water wave problems is to consider the flow irrotational and thus potential 4 u ϕ where ϕ is the scalar velocity potential in the absence of damping forces f s l 0 the bernoulli s equation can then be derived and links the scalar velocity to the pressure allowing to write the well known potential wave theory equations the general bernoulli s equation reads 5 t ϕ 1 2 u 2 1 ρ p 0 x nonetheless adding the sponge layer dissipation term does not allow the derivation of the bernoulli s equation everywhere in the fluid anymore for all the cases it is possible though to derive a modified bernoulli s equation in the case of constant dissipation β β 0 6 t ϕ 1 2 u 2 1 ρ p β 0 ϕ 0 x as done by le méhauté le méhauté 1972 while studying the design of porous absorbing beaches for experimental implementation it appears then that the potential flow approximation is not proper for this case using a perturbation method and redefining the gradient operator it is yet possible to write the problem similarly to the well known linear potential theory in the form of a laplace s equation with proper boundary conditions 2 2 perturbation method and sponge layer equations consider a monochromatic wave train similarly to water wave problems the solution is expanded near an undisturbed configuration and using complex notation 7 u p ζ ℜ ε u 1 p 1 ζ 1 e i ω t ε 2 u 0 p 0 ζ 0 u 2 p 2 ζ 2 e 2 i ω t 0 ε 3 where ε is a small parameter ω is the angular wave frequency the superscripts k refer to the expansion terms 0 being the time independent induced terms 1 the first harmonic and so on retaining only first order terms in the momentum equation second line of eq 2 leads to 8 u 1 i ω β 1 ρ p 1 thus the velocity is still directly linked to the pressure but not through a simple gradient as it is the case for the linear potential wave t0heory it is clear also from this development that the term β can be linked to the wave angular frequency ω a new gradient operator is defined as 9 grad 1 i b where the nabla operator refers to the regular gradient and b β ω injecting into the continuity equation first line of eq 2 yields a modified laplace equation for the pressure the general problem to be solved to evaluate the efficiency of the sponge layer is then 10 i ω 1 i β ω δ p 1 p 1 β 0 d z 0 z p 1 p 1 1 i β ω ω 2 g 0 at z 0 p 1 d z p 1 0 at z d with adequate lateral boundary conditions the free surface can be reconstructed using 11 ζ 1 p 1 ρ g at z 0 note that the first equation is a laplace s equation with the newly defined gradient operator and can be written 12 grad p 1 0 using this set of equations the efficiency of the sponge layer is found by evaluating the reflection coefficient upstream of the sponge layer the value found corresponds to the first order reflection coefficient in experimental works it is common to evaluate the reflection and transmission coefficients using the two probes method of goda suzuki goda and suzuki 1976 or a single moving probe method brossard et al 2009 in all cases a fast fourier transform fft is done to extract the first harmonic and thus only the first order coefficients are evaluated this justifies the limitation to the first order theory in the evaluation of the efficiency of the sponge layer note that the reflection coefficient for the wave s first harmonic cannot be directly evaluated from the surface envelope due to non linearities for instance free modes can induce envelope oscillations which are different from reflection another example is the surface envelope of a non linear wave reflection at a wall for which second order terms lead to non zero surface oscillations at the linear nodes the equations eq 10 are written in a general manner in 3d with variable depth d this enables the extension of the present study to the evaluation of combined inclined beaches and simple sponge layer in the next section the study is limited to two dimensions and constant water depth 3 two dimensional applications with constant depth in this section it is first assumed that flow is two dimensional i e we assume the flow to be invariant through y translations with zero y velocity component and the water depth d is constant 3 1 linear two dimensional equations and sponge layer functions the sponge layer function is written 13 β x ω b x where b is a positive non dimensional shape function and is zero outside of the sponge layer region the system of equations of eq 10 now reads in 2d 14 1 i b δ p 1 i x p 1 x b 0 d z 0 z p 1 p 1 1 i b ω 2 g 0 at z 0 z p 1 0 at z d the velocity and surface elevation are reconstructed using 15 u 1 grad p 1 i ρ ω 16 ζ 1 p 1 ρ g at z 0 in the above equations the laplace and gradient operators are two dimensional i e the x z plane z denoting the vertical coordinate it is convenient to work with non dimensional equations from now on so that the results found in the present paper can be straightforwardly applied to other cases we define the following non dimensional parameters 17 x z x z d t t g d k k d ω ω d g p p 1 ρ g d the system of equations reads 18 1 i b δ p i x p x b 0 1 z 0 z p p 1 i b ω 2 0 at z 0 z p 0 at z 1 the non dimensional velocity and surface elevation are reconstructed using 19 u 1 grad φ 20 z 1 p at z 0 where the scalar velocity potential φ is 21 φ p iω 3 2 sponge layer functions we consider the case of continuous sponge functions different forms of sponge functions are proposed based on the literature the linear sponge layer model eq 18 or eq 14 developed in the previous section can then be solved using a fem solver to evaluate the reflection coefficient the case of power sponge layer is then studied in details and the fem based solutions compared to numerical simulations obtained using the sph method the linear sponge layer model solved with fem can be used to find the optimal coefficient for a given sponge layer length in the literature different types of sponge layer functions are considered in this paper we define three general sponge layer functions 1 the power sponge layer altomare et al 2015 22 b x b m a x x x 0 x m a x x 0 n b ℋ x x 0 2 the trigonometric sponge layer cherfils et al 2008 23 b x b m a x sin n b π 2 x x 0 x m a x x 0 ℋ x x 0 3 the exponential sponge layer perić and abdel maksoud 2018 24 b x b m a x e x x 0 x m a x x 0 n b 1 e 1 ℋ x x 0 where in all cases n b 0 b m a x is the maximum value of the sponge layer coefficient at the end of the sponge layer domain x m a x x 0 denotes the beginning of the sponge layer region and ℋ is the heaviside function fig 1 shows different sponge layer function profiles it appears that the slope is more gentle near the beginning of the sponge layer as the power coefficient n b is increased the trigonometric sponge layer presents the characteristic of having a gentle slope toward the end of the sponge layer domain too at the cost of higher slope within the main part of the sponge in the next section the power sponge layer is primarily used as it is simpler to define the mean value of b in the sponge layer b m e a n b m a x n b 1 and it has been used before for sph simulations by previous authors altomare et al 2015 with rather good results here the goal is to provide a method to evaluate the suitable parameters for the sponge layer so the function in itself is not important all the sponge layer functions are considered in section 3 4 where suitable absorption parameters are provided for numerical modelling 3 3 finite element solver and sph model the system eq 18 or eq 14 can be easily solved using a commercial finite element solver in this paper the ndsolve function of mathematica is used to solve the linear system at low cost to find the reflection coefficient for different sponge layer parameters see convergence study in appendix a a single cpu is used to run the mathematica code and it takes about 0 5 s to solve the linear problem for this optimization problem the following numerical configuration is considered a physical domain of length l ϕ 2 m and water depth d 0 15 m where no dissipation is added and a sponge layer of variable length x s l x m a x x 0 d see fig 2 the frequency is fixed to f 0 1 5 hz this configuration corresponds to ω 1 17 and the waves are considered to be generated using a piston type wave maker in the linear theory approximation this is equivalent to a neumann boundary condition on the horizontal velocity at the mean piston position the piston stroke amplitude can be linked to the target incident wave amplitude by 25 s 0 a inc 2 k d sinh 2 k d 4 sinh 2 k d where a inc is the target wave amplitude in the absence of reflection linton and mciver 2001 since the theory is for linear waves the wave amplitude is a scaling parameter the results are compared to numerical simulations obtained using the smoothed particle hydrodynamic sph method see violeau and rogers 2015 violeau and rogers 2016 for a description of the method and appendix b for a short presentation of the model used here and how to implement the sponge layer the sph simulations are run on a single gpu card geforce gtx titan black and takes about 6 h for the sph simulations the wave amplitude is first fixed to a inc 1 cm and the skewness is k a inc 0 1 the simulations are run with a fixed particle size r 0 such that d r 0 60 and for 35 waves periods the waves can travel about 10 times the entire tank length the surface particle positions are sampled at δ t t 101 where t 1 f 0 is the wave period using marrone et al s method marrone et al 2010 with a threshold of 0 55 fig 3 shows the instantaneous horizontal velocity at the end of the simulation for the case x s l 2 λ with n b 3 b m a x 0 5 the surface particles are outlined in black to check that an asymptotic regime is reached the goda suzuki goda and suzuki 1976 two probes method is applied on sample time of 2 wave periods at different instance for a tank with a power sponge layer of length x s l 2 λ with n b 3 b m a x 0 5 the method uses a fft to evaluate the amplitudes of the incident wave a i travelling away of the wave maker shoreward and the reflected wave a r travelling toward the wave maker seaward the reflection coefficient is found by evaluating r a r a i more details on the method can be found in goda and suzuki 1976 the probes are spaced by a quarter of wavelength and centered in the physical part of tank see fig 2 fig 4 shows the measured reflection coefficient and incident wave amplitude with time an asymptotic regime is reached after 20 wave periods note that from now x s l x s l λ is the non dimensional sponge layer length and is compared to the wavelength instead of the undisturbed water depth d as in section 3 1 to see the influence of b m a x on the reflection coefficient fig 5 shows the surface enveloppe over the last 5 wave periods for three cases with a power sponge layer of length x s l 2 λ with n b 3 b m a x 0 5 5 32 for the first case clear reflections are visible and outlined in the envelope by the red lines which are spaced by half a wavelength on the other hand for the case b m a x 5 the enveloppe shows small fluctuations these fluctuations are not due to reflections but to combinations of different wavelength waves the piston generates also free modes of higher order in this case the reflection is not as high as it might appear from this graph to capture only the first harmonic terms a fast fourier transform with time of the different probes position is performed the amplitude of the first harmonic is displayed in fig 6 for the three cases this is different from the enveloppe amplitude the amplitude is non dimensionalised by the incident wave amplitude the results are compared to the linear sponge layer model red dashed lines with good agreement for the last case with the largest value of b m a x 32 the surface shows again reflection characteristics fig 7 shows the influence of the value of mean sponge layer strength in the sponge layer on the reflection coefficient for different power sponge layer functions compared to the theory the mean sponge layer strength is defined as 26 b m e a n 1 x s l x 0 x m a x b x d x for power sponge layers it comes 27 b m e a n b m a x n b 1 the choice of this non dimensional parameter is such that the minimum of the sponge layer theoretical reflections are aligned first notice that in the simulations the reflection coefficient plateaus to a threshold value of 1 2 this is partially due to the particle size used here and other non linear effects not accounted for in the simplified linear sponge layer model the simulations then follow the theory trend when the reflection increases again above this threshold value the linear theory correctly predicts the position of the minimum and the influence of the b m e a n and n b on this large range of values for the cases n b 3 or 4 the value of b m e a n can be set anywhere between 0 2 and 6 and the reflection will be lower than 3 this large range of acceptable values outlines the fact that the sponge layer is probably larger than it could be for this power function using the theory one can show that it is possible to reduce significantly the sponge layer length while keeping the same absorption efficiency absorption efficiency means here small reflection coefficient the value n b 3 is fixed and the sponge layer length is varied in this second test fig 8 shows the influence of the sponge layer length on the results compared to the theory we see that with a sponge layer as small as 0 8 λ it is possible to have a reflection coefficient as small as 2 this is enough for numerical simulations compared to experimental wave fume where the reflection coefficients can be of the order of 10 or even larger ouellet and datta 1986 rey and touboul 2011 the drawback is that the range of values of b m e a n for which the reflection is small is narrower this justifies the importance of using the linear theory equations derived earlier to find this optimal prior to running the full navier stokes numerical model 3 4 sponge layer prediction and optimal for fixed ω as an application example the previous case with ω 1 17 fixed is now studied using the fem based solution of the linear theory to seek the optimal sponge layer strength b m e a n for a given sponge layer length x s l non dimensionalised by the incident wavelength and for power sponge layer type functions we chose to work with the sponge layer as there is a simple relationship between the mean value of the sponge layer strength and its maximum a similar method can be used for other type of sponge functions fig 9 shows the reflection of the sponge layer contour plot obtained for 4 different values of n b for the power sponge layer function the red contours outline the limit for 1 and 2 reflections for n b 1 to have a reflection of less than 5 about the numerical accuracy the smallest theoretical sponge layer length is 0 5 λ and b m e a n 0 51 0 81 and for 2 b m e a n 0 58 0 68 the minimum reflection for this length of sponge layer is found at b m e a n 0 62 with a theoretical reflection of the order of 0 8 the values are found using a golden section section search algorithm kiefer 1953 assuming unimodal behaviour yet this small reflection range is also limited in terms of sponge layer length one can see that increasing the sponge layer length for b m e a n can lead to larger reflection coefficient for this case the present linear theory shows that it is possible to use as small as 0 5 λ long sponge layer for this case to verify this result found using the present linear model simulations are run with x s l 0 5 λ using the sph method the results are shown in fig 10 for larger n b the minimum sponge length to reach the 5 and 2 thresholds increases for n b 3 at x s l 0 5 the minimum reflections is 13 for b m e a n 0 69 one needs to have about x s l 0 7 to reach less than 5 reflection with b m e a n 0 5 and x s l 0 8 to get less than 2 with b m e a n 0 46 for n b 4 the minimum length is 0 9 b m e a n 0 41 and 1 0 b m e a n 0 4 respectively the contour plots of fig 9 provide important informations for efficient absorptions one wants to have the smallest possible sponge layer but also the one that absorbs efficiently all the free and linked modes due to non linearities and scattering for instance if one chooses a sponge layer with a linear sponge layer function n b 1 of non dimensional length x s l 0 5 with b m e a n 0 6 then the second harmonic will see a sponge layer equal to its wavelength and the free mode of about 1 8 time its wavelength though the absorption of the second harmonic requires to develop the theory to the next order the free mode absorption follows the same theory the sponge layer efficiency for the free mode can therefore be inferred from the contour plots of fig 9 the apparent b m e a n will be half the one of the first harmonic thus 0 3 for the free mode see green diamond point it is still in the acceptable range of 5 for this case yet it is clear that the higher frequency free modes will be less efficiently absorbed as the apparent b m e a n diminishes the green point in fig 9 shows this case example for n b 1 a good strategy is thus to select a value near the upper bound of the interval of interest to have the best absorption of higher modes note though that usually these modes have smaller amplitudes or also dissipate faster due to viscous dissipation wave breaking and so on table 1 shows the confidence intervals for a reflection of 5 and the minimum of reflection in this range the data outlined in red shows the cases where the minimum is below 2 the results of the table are also displayed in the contour plots the blue points show the range of 5 while the white line shows the minimum path once the 5 threshold is reached and the white diamonds the minimum values listed in table 1 so far the angular frequency was fixed to ω 1 17 we showed that it was possible to use the linear theory and a simple fem solver to predict the optimal absorption conditions it is found that one can have a sponge layer as small as 0 5 λ for this case due to the non linearity of the dispersion relation one cannot use directly the optimal value found for ω 1 17 for other wave angular frequencies 3 5 sponge layer prediction as a function of ω in this subsection we fix the water depth and the sponge layer length to x s l λ ω d where the brackets outline the fact that the wavelength is a function of the frequency and depth a power sponge layer is used with n b 3 and a sponge layer mean coefficient b m e a n 0 36 this value corresponds to an optimal sponge layer strength in the limit of deep water waves see fig 12 commented in the next paragraph the wave angular frequency is varied the reflection coefficients measured in the simulations are displayed in fig 11 in gray as a function of the non dimensional angular frequency ω the sph simulations gray symbols are compared to the linear theory results found using the fem solver solid gray line it is clear that the ability of the sponge layer to absorb the wave depends on the wave frequency this is due to the non linear form of the dispersion relation the difference of trend between the sph simulations and the linear model as ω increases slightly increasing reflection is believed to be due to the relative coarseness the particle size is fixed and the wavelength diminishes the increasing non linearities the wave amplitude is fixed here and the increasing numerical dissipation in the wave propagation an improvement in the sph simulations would be to reduce the particle size as the wave frequency is increased and use renormalisation operators as done in vila 2005 this is outside the scope of the present study using the golden section search algorithm and the fem solver we show in fig 12 the evolution of the optimal b m e a n with ω for the power sponge layer for n b 3 and x s l 1 it appears clearly in this graph that b m e a n is a constant in the limit of deep water waves this optimal value was used to generate the gray data in fig 11 for ω 2 the optimal is no more a constant referring to the linear model the optimal value of b m e a n increases as ω diminishes in fig 11 the reflection coefficient found for this optimal values using the sph method and the fem solver are displayed in black with the optimal value we are able to keep the reflection coefficient below 3 dashed line on the entire spectrum tested here this illustrates the importance of knowing the proper b m e a n as a function of ω note that the reflection coefficient still increases as ω diminishes in the linear sponge layer model with optimal absorption to get a constant reflection coefficient one would probably need to increase the sponge layer length to wavelength ratio as ω diminishes in the present study we limit ourself to finding the optimal value for a given sponge layer length to wavelength ratio here x s l 1 and wave angular frequency finally table 2 provides values of b m e a n for which the reflection is minimum for different values of ω and different sponge layer functions the values are listed if below 5 and in red if below 2 the results are obtained using the golden section search algorithm kiefer 1953 the table stops at ω 2 0 as for larger values the variations are not significant and b m e a n is approximatively a constant consistently with the results of perić and abdel maksoud 2016 perić and abdel maksoud 2018 solving the present linear problem and search for the optimal for a given ω is cheap in computational time and can save precious computational efforts in the present case fem solver takes about half of a second to solve the linear equations and the golden section search takes about a minute to find the optimal value on the other hand the sph solver needs about 6 h to reach an asymptotic regime 4 3d application to show that the results found in 2d can be directly applied to 3d consider a wave flume of length l ϕ 2 m and ℓ 25 cm wide with an inclined sponge layer boundary of θ 45 incidence the simulations are run using the gpusph open source solver gpusph org 2017 with usaw boundary conditions see appendix b the particle size r 0 is fixed such that d r 0 30 there are 1 25 millions particules in the tank the simulation is ran on 4 gpu s nvidia gk110gl quadro k5200 for 15 s of physical times taking 48 h of simulation time the waves are generated using a piston wave maker the water depth is still 15 cm and the frequency 1 5 hz thus ω 1 17 the waves have a 45 incident angle with the sponge layer the sponge layer is designed to absorb most efficiently the waves perpendicular to it with a power sponge layer function optimized for x s l 1 for n b 3 we set b m e a n 0 45 see table 1 a top view of the simulated tank is shown in fig 13 fig 14 shows the instantaneous horizontal velocity field at the end of the simulation the surface is sampled on 3 lines perpendicular to the wave crest evenly spaced at the middle and quarter widths from the lateral walls the amplitude of the first harmonic and the phase are plotted along these three lines in fig 15 first it is noticed that in 3d the dissipation is important in the physical part this is due to additional numerical dissipation along with physical friction on the lateral walls the wavenumber of the generated waves is k 9 54 m 1 instead of k 0 10 0 m 1 of the linear theory the difference can originate from the difficulty of filling the tank using our current software which leads to a diminution of the water depth after particle rearrangement along with the increased friction at the lateral walls and non linear effects no apparent reflection patterns are visible in the amplitude graph as the sponge layer is inclined with the incident waves one might expect a modification of the incidence angle in the sponge layer and this is visible in the phase plot where the different profiles are out of phased in the sponge layer 5 conclusion in this paper the sponge layer equations are derived and perturbation method is applied for monochromatic waves a linear theory sponge layer pressure equation is found and can be easily solved using fem solver it predicts accurately the reflection coefficient as confirmed using a sph navier stokes solver the case of 2 dimensional waves is considered we show that the model can be used to predict accurately the optimal reflection coefficient using a golden search algorithm we are able to provide the optimal absorption parameters for a given sponge layer function shape and length at low computational cost we verified that the optimal sponge layer strength is a constant for deep water waves ω 2 and varies for intermediate depth waves tables of optimal absorptions are provided over a range of non dimensional wave angular frequencies where the coefficient varies for various sponge layer functions found in the literature a 3d application with the gpusph open source solver gpusph org 2017 is presented with this choice of parameters the reflection coefficient does not differ significantly from the predictions of the 2d problem a change of incident angle is observed in the sponge layer the authors outline the simplicity of solving the linear theory sponge layer problem which can be done before running a full navier stokes simulation to select the proper form and value of the sponge layer function the results match our simulations as long as the reflection is above a numerical threshold of 1 2 which is satisfactory for numerical simulations of water wave problems the linear theory can also be used to assess the efficiency of sponge layer used in previous papers where the authors frequently omit providing this essential information furthermore this can be also used to design a sponge layer such that the reflection coefficient matches the one of experimental investigations if provided acknowledgments the authors would like to thank alex ghaïtanellis sofiane martel martin ferrand and alexis hérault for their useful comments and interest in the project the authors would also like to thank edf for providing the cluster used for the 3d simulations finally they would like to acknowledge the valuable input from the reviewers which helped improve the clarity of the paper appendix a fem solver mesh and convergence the linear problem of eq 18 or eq 14 is solved using the fem solver embodied in mathematica w r inc 2017 ndsolve the mesh is constructed using toboundarymesh function first to correctly capture the edges then the toelementmesh function is used to mesh the interior the mesh is refined near the free surface such that the area of a cell is 100 times smaller for cells above the mid water depth the refinement is defined as the root square of the cells near the surface figure a 16 shows a mesh for a resolution d x λ 50 thus d x λ 5 at the sea bed fig a16 example of mesh used in the fem for d x λ 50 the mesh is refined near the free surface 3 fig a16 the resolution is first varied for a fixed value of the dissipation coefficient a power sponge layer of length 2λ with n b 3 and b m a x 0 5 is used here this corresponds to the configuration in the top graph of figs 5 and 6 the reflection coefficient is measured near the center of the physical part of the tank using the formula a 1 r z m a x z m i n z m a x z m i n the error corresponds to the relative difference between the most refined simulations here d x λ 10 3 the expected reflection is about 9 03 the results converges as seen in figure a 17 the vertical dashed line shows the resolution selected to evaluate the contour profiles fig a17 convergence test error on the value of the reflection coefficient for power sponge layer with n b 3 and b m a x 0 5 the dashed line shows the resolution used for the contour plots 4 fig a17 to see the effect of the grid size on the variation of the damping coefficient a convergence test is performed for power sponge layer of length 2λ with n b 3 with variable damping coefficient b m e a n the results are shown in figure a 18 away from the minimum region the curve converges rapidly the resolution of the red curve is used to construct the contour plots fig a18 convergence test reflection coefficient for power sponge layer with n b 3 as a fonction of b m e a n for different mesh resolution the red curve shows the resolution used for the contour plots 5 fig a18 appendix b sph method quick description in the present study we use a weakly compressible smoothed particle hydrodynamics method wcsph to solve the navier stokes equation sphynx solver in 2 d and gpusph open source solve in 3d gpusph org 2017 the equations are b 1 d d t ρ u ρ u 1 ρ g σ where g g e z is the gravitational acceleration g 9 81 m s 2 and σ is the stress tensor b 2 σ p i μ u u t in order to close this system of equations an equation of state is defined to relate the pressure and the density li 1967 b 3 p ρ 0 c 0 2 ζ ρ ρ 0 ζ 1 where ρ 0 is the reference density c 0 is the numerical speed of sound and ζ is the adiabatic index equals to 7 for water in the present simulations the speed of sound is fixed to c 0 10 g d max where d max is the maximum water depth which ensures that the flow is close to incompressible sph method is used to solve this problem the fluid is decomposed in particles which represents material points of fixed mass m and initial size at rest r 0 for example a p in fig b 19 fig b19 sketch of a fluid portion ω shaded blue domain near a solid boundary ω orange lines and the solid domain shaded in gray with a fluid particle a p and its kernel compact support ω a truncated by the boundary a vertex particle b v and its opening angle θ b the two connected segments s i s at the vertex particle b 6 fig b19 a function f evaluated at a position a is given by b 4 f a 1 γ a b p v b f b w a b where p is the set of all particles v b denotes the volume of the particle b w a b w r a r b the kernel function as a function of the distance between the particle b and the position a which is the quintic polynomial by wendland 1995 throughout the paper in the usaw unified semi analytical wall boundary conditions sph variant we define a kernel wall renormalisation factor γ a b 5 γ a ω w r a r b d r b where ω is the fluid domain which takes into account the fact that the kernel of a particle is truncated near a boundary it is possible to analytically evaluate this integral in 2 d ferrand et al 2011 but in the present study the value is computed throughout a governing equation b 6 d γ a d t v a r γ a where v a r is the relative velocity to the rigid boundary and γ a is given by a surface integral b 7 γ a ω w r a r n d r with n the inward oriented unit normal the boundaries in 2 d are divided in straight segments s linked by vertex particles v of mass a fraction θ of the reference mass m the fraction or opening angle θ b of the vertex particle b represents the interior opening angle of the two connected segments at this particle see fig b 19 and can be evaluated using b 8 θ b π sign t 1 t 2 n 1 n 2 arccos n 1 n 2 where t i and n i are the tangent and the inward normal vector of the two connected segments respectively the gradient and divergence standard sph operators are given with usaw boundary terms by b 9 g a γ f ρ a γ a b p v m b f a ρ a 2 f b ρ b 2 w a b ρ a γ a s s ρ s f s ρ s 2 f a ρ a 2 γ a s b 10 d a γ b 1 γ a ρ a b p v m b b a b b w a b 1 γ a ρ a s s ρ s b a b s γ a s where γ a s is the integral of the kernel on a boundary segment furthermore the usaw variant of the sph laplacian is defined as b 11 l a γ f a ρ a γ a b p v m b 4 f a f b f a f b a a a b r a b 2 r a b w a b 1 γ a s s f s a s f a a a γ a s where r a b r a r b the symplectic time integration scheme used is b 12 u a n 1 u a n 1 ρ a n g a γ p n μ ρ a n l a γ 1 u n g δ t r a n 1 r a n u a n 1 δ t γ a n 1 γ a n s s u a n u s n γ a s δ t ρ a n 1 1 γ a n 1 γ a n ρ a n b p m b w a b n 1 w a b n δ t d b δ n where the index n denotes the time iteration μ 10 6 m2 s is the kinematic molecular viscosity δ t c h 0 h c 0 with c h 0 0 1 in all the numerical applications d b 0 1 is the brezzi and pitkäranta diffusion coefficient and b 13 δ n ρ a n l a γ δ t g r b n l a γ δ t ρ b n p b n as shown in brezzi and pitkäranta 1984 ghaitanellis et al 2015 this additional term acts like a diffusive terms in the continuity equation and helps limit acoustic discrepancy in the pressure terms the pressure at the boundaries are interpolated from the fluid b 14 p w b p p b v b w w b b p ρ b g r w b v b w w b b p v b w w b the acceleration of the wall is not taken into account as it is always small compared to the gravity acceleration term at most 10 more details about the usaw variant of the wcsph method and its implementation can be found in the papers by ferrand et al 2011 and mayrhofer et al 2012 2013 in the sponge layer domain the velocity update is changed to b 15 u a n 1 u a n 1 1 β δ t where u a n 1 corresponds to the right hand side of the first equation in the system eq b 12 simulations in 2d are run using a single gpu card geforce gtx titan black while 3d applications are run on multi gpu s on a cluster 42 cards nvidia gk110gl quadro k5200 a 2d simulation takes about 6 h to run the results correspond to over 100 different configurations 
23238,the vector propulsion systems have been equipped in numerous autonomous underwater vehicles auvs nowadays in most cases the vector propulsion is achieved by changing the direction of the entire vector propulsion system which requires a spacious room for complex mechanical structures at the tail of the auv the deflectable duct propeller however as a new way to achieve vector propulsion can generate lateral force and moment enabling the auv to perform various motions in this work the 6 dof notion model of the novel auv with a deflectable duct propeller is developed based on the newton s and euler s equation considering the forces and moments generated by the deflectable duct propeller and a cfd model is proposed to estimate performance of a deflectable duct propeller the motion simulations including 2d longitudinal motions 2d lateral motions and 3d space motions are conducted to analyze the maneuvering performance of the novel auv with a deflectable duct propeller and simulation results illustrate that the novel auv with a deflectable duct propeller has a better maneuverability than traditional propeller rudder system keywords deflectable duct propeller mathematical model maneuverability performance estimation motion simulation nomenclature χ rotating angle δ deflection angle cb centre of buoyancy cg center of gravity r c g position vector of cg in the body fixed reference frame r c g x c g y c g z c g t η generalized position vector η p t θ t t p position vector p x y z t θ vector of euler angles θ θ ψ φ t v velocity vector v s t ω t t s translational velocity vector s u v w t ω angular velocity vector ω p q r t j η transformation matrix r e a θ velocity transformation matrix t e a θ angular velocity transformation matrix α attack angle β sideslip angle v speed of the auv v u 2 v 2 w 2 m r b inertia mass matrix c r b v coriolis centripetal matrix v derivative of velocity vector m mass of the whole auv f forces and moments vector acting on the novel auv f f a f b g f h f p e 3 3 3 by 3 identity matrix i a inertia matrix about the origin a ω ˆ skew symmetric matrix of ω r ˆ c g skew symmetric matrix of r c g f a added mass forces f b g gravitational and buoyancy forces f h damping forces and moments f p deflectable duct propeller forces and moments m a added mass inertia matrix c a v added coriolis centripetal matrix λ i j added mass coefficients s ˆ skew symmetric matrix of s b buoyancy force vector g gravitational force vector ρ sea water density g gravitational acceleration h auv drainage volume r a e θ inverse matrix of r a e θ s maximum cross sectional area of auv l total length of auv c x c y α c y r m x β hydrodynamic coefficients of the novel auv with a deflectable duct propeller f t thrust of deflectable duct propeller f c lateral force perpendicular to the axis 2 q t torque of deflectable duct propeller q c lateral torque around the axis 2 n propeller rotation speed d diameter of the duct j advanced coefficient l ac distance between the duct rotation center and the center of buoyancy cb of auv u i u j fluid velocity components p static fluid pressure μ dynamic viscosity coefficient δ i j kronecker delta function f i mass force ρ u i u j reynolds stress term μ t turbulent viscosity coefficient c μ turbulent generation term k t thrust coefficient k c lateral force coefficient k qt torque coefficients k qc lateral torque coefficient v f inflow velocity to the entire domain f t thrust calculated in cfd method f c lateral force calculated in cfd method q t torque calculated in cfd method q c lateral torque calculated in cfd method η propulsive efficiency y r e f reference depth θ ref reference pitch angle ψ ref reference yaw angle t simulation time r turning radius of lateral motion k y k θ k r k ψ k q control coefficients c y δ h m z δ h c z δ v m y δ v hydrodynamic forces coefficients of the traditional propeller rudder r t ratio of turning radius of lateral motion to the length of auv 1 introduction recently due to the shortage of land resources oceans have attracted more and more people s sights autonomous underwater vehicle auv has grown up to be an important research topic today as they have become indispensable for their assistance in underwater missions f bellavia et al 2017 the maneuverability of auv is an important consideration to judge their performance nowadays the control of the auv is mainly depended on the fins and rudders however this control mode has a low efficiency when auv is manipulated at minimal speed in order to improve the manipulation efficiency of auv at low speed some researchers have put forward the vector propulsion system instead of the traditional propeller rudder control mode mishra and chitre 2016 the vector propulsion system can produce forces and moments used to accomplish the control of auv and has replaced traditional propeller rudder control mode on a certain extent nowadays with the improvements of the vector propulsion technology auv can change its movement state only by altering the direction of vector propulsion system zhang et al 2016 developed a vectored underwater vehicle with the parallel vectored thruster and the propeller shaft attitude is controlled by two dof spherical parallel mechanism they simulated the dynamic behavior and maneuverability of the vectored underwater vehicle in addition cavallo et al 2004 proposed a spherical parallel mechanism to achieve the vector propulsion however the vector propulsion system for auvs has extremely complex mechanical structures which limits its application to the small underwater vehicles therefore based on the commercial duct propeller a kind of vector propulsion system including a deflectable duct propeller is proposed in this paper it is all known that commercial duct propeller can only produce thrust without any additional control force however when the propeller is fixed and the duct is deflected the deflectable duct propeller will generate the lateral force and moment controlling auv to change its states and the thrust to drive auv kopman et al 2012 presented the design of a streamlined underwater vehicle utilizing an entirely enclosed propulsion and steering system and the steering of the vehicle is controlled by controlling the vectoring cone s orientation hence providing a thrust vectoring effect to the jet of water exiting through the back of the stern section in order to analyze the influence of the deflectable duct propeller on maneuverability of auv the motion model of the novel auv equipped with a deflectable duct propeller should be analyzed systematically basically a nonlinear six degrees of freedom dof model of auv which was used widely for modeling and control of underwater vehicles is described in fossen 2002 and antonelli et al 2008 the kinematic modeling in dynamic systems is based on the newton euler method which divides the main force components into distinguished terms on the other hand the mathematical model and motion control analysis of underwater vehicles have been presented by many researchers tian et al 2012 liu et al 2017 chen et al 2014 2016 liang et al 2016 tian w et al developed a three dimensional mathematical model of haishen vehicle with two independently controlled hydrofoils and the effect of controllable hydrofoils on the vehicle stable motion performance is studied theoretically liu f et al built a 3d dynamic model of petrel ii using linear momentum and angular momentum equations and the spiral motion in the underwater space is simulated for the gliding mode similarly the cycle motion on the water surface and the depth keeping motion underwater are simulated for the level flight mode although numerous underwater vehicle models have been presented there is a little study of the model of the novel auv with a deflectable duct propeller thus as for the novel auv with a deflectable duct propeller there is an urgent need to build dynamics model for this system in terms of the performance estimation of the deflectable duct propeller in recent years with the realization of high performance computing technology computational fluid dynamics cfd has become a dominant tool to predict the performance of commercial duct propeller numerically martio et al 2017 bhattacharyya et al 2016 de barros and dantas 2012 park et al 2005 hoekstra 2006 go et al 2017 martio et al 2017 et al studied the virtual mass and damping coefficients of an open and ducted propeller are determined using urans computations based on cfd method bhattacharyya et al 2016 et al addressed the problem of scale effect on the open water characteristics of ducted propellers using the results of extensive cfd investigations at different reynolds numbers and loading conditions it can be concluded that the cfd method can numerically predict the hydrodynamic characteristics of a ducted propeller accurately de barros and dantas 2012 proposed the modeling of the hydrodynamic forces and moments on a duct propeller according to a numerical cfd simulation the results confirm that the advantages of the symbiosis between cfd and ase methods for modeling the influence of the propeller duct in the auv maneuverability thus performance of the deflectable duct propeller is estimated by using computational fluid dynamics cfd method in this work this study puts forward the following contributions a complete mathematical model describing the motion of the novel auv with a deflectable duct propeller is developed for motion simulation and maneuverability analysis the novel design of the deflectable duct propeller ensures a high maneuverability by introducing control forces and moments generated from the deflectable duct additionally a cfd technique is used for estimating and analyzing the performance of the deflectable duct propeller with different deflection angles and different advance coefficients for analysis of the maneuverability of the novel auv with a deflectable duct propeller a series of motion simulations are conducted with or without control in motion simulations the control forces and moments generated from the deflectable duct propeller are calculated by the numerical interpolation method the simulation results illustrate that the novel auv with a deflectable duct propeller has a better 2d and 3d maneuverability than the traditional propeller rudder system 2 mathematical model 2 1 geometric model based on the conventional duct propeller a new auv with a deflectable duct propeller is proposed in this paper as shown in fig 1 and fig 2 shows the new deflectable duct propeller which consists of one rotating base four pins two hydraulic rods two bearings and one duct according to fig 2 the operation principle of the new deflectable duct propeller is briefly introduced firstly the rotating base has two rigid rods which connect with the duct symmetrically and two rigid supports for hydraulic rod installation similarly the duct also has two rigid struts for hydraulic rod installation the hydraulic rod connects the rotating base and the duct by two pins the rotating base can rotate around axis 1 shown in fig 2 and the rotating angle defined as χ ranges from 0 to 90 in addition the bearings are installed at the connection position of the duct and the two rigid rods which makes sure that the duct can rotate around the axis 2 shown in fig 2 and under the action of the push pull cooperation of the two hydraulic rods the deflection angle around axis 2 defined as δ also ranges from 20 to 20 fig 3 also shows the new deflectable duct propeller with 20 deflection around axis 2 δ 20 as shown in fig 3 the first hydraulic rod elongates and the second hydraulic rod shortens when the length of the first hydraulic rod reaches its maximum and the length of the second hydraulic rod reaches its minimum the deflection angle of the duct is 20 therefore different lengths of two hydraulic rods will cause different deflection angle of the duct we can control the lengths of two hydraulic rods to control the auv 2 2 reference frames in order to model the auv with a deflectable duct propeller mathematically the two reference frames are defined to describe motion of auv the body fixed reference frame a xyz and the earth fixed reference frame e xyz fig 4 shows the reference frames the body fixed frame a xyz is a moving frame with its origin at the center of buoyancy cb which is located at the geometric center of the auv let the a x axis lies along the longitudinal axis from tail to the nose the transversal axis a z points to the right side of the auv and the a y axis which is known as the normal axis is orthogonal to the a x and a z directing from bottom to top on the other hand the earth fixed reference frame e xyz considered to be a fixed reference frame is located at the sea surface the e x axis and the e z axis are in the horizontal plane while the e y axis is in the opposite direction of the gravity 2 3 kinematics model in this present work the center of gravity cg of the auv is situated slightly under the center of buoyancy cb this important parameter is denoted as r c g x c g y c g z c g t in the body fixed reference frame a xyz the generalized position vector of the auv with respect to the earth fixed reference frame is denoted as 1 η p t θ t t x y z θ ψ φ t where p x y z t is a position vector and x y and z are position components of the auv in the earth fixed reference frame and θ θ ψ φ t is a vector of euler angles where θ ψ and φ are defined as pitch angle yaw angle and roll angle respectively in addition the velocity vector of the auv in the earth fixed reference frame is defined as 2 v s t ω t t u v w p q r t where s u v w t is a translational velocity vector and u v and w are the translational velocity components in the earth fixed reference frame and ω p q r t is an angular velocity vector and p q and r are the angular velocity components in the earth fixed reference frame therefore the kinematic equations describe the geometrical relationship between the inertial coordinate frame and the body fixed coordinate frame and can be described as follows 3 η j η v where j η is defined as the transformation matrix to transform vectors from the body fixed coordinate frame a xyz to the earth fixed reference frame e xyz and it can be formulated by a matrix which can be defined as follows 4 j η r e a θ 0 0 t e a θ where 5 r e a θ cos θ cos ψ sin θ cos ψ cos φ sin ψ sin φ sin θ cos ψ sin φ sin ψ cos φ sin θ cos θ cos φ cos θ sin φ cos θ sin ψ sin θ sin ψ cos φ cos ψ sin φ sin θ sin ψ sin φ cos ψ cos φ and 6 t e a θ 0 sin φ cos φ cos φ tan θ 0 sin φ tan θ 1 tan θ cos φ tan θ sin φ in addition in order to calculate the hydrodynamic forces on the novel auv we define two hydrodynamic angles the angle of attack α and the sideslip angle β these two angles are formulated as 7 α tan 1 v u 8 β tan 1 w v where v is the speed of the auv which can be directly calculated by using the following equation 9 v u 2 v 2 w 2 2 4 dynamics model in terms of the dynamic model based on the newton s and euler s equation the motion equation of the novel auv is defined as 10 m r b v c r b v v f where m r b represents the inertia mass matrix c r b v is the coriolis centripetal matrix and f denotes the force and moment vector acting on the body fossen 2002 the m r b and c r b v are defined as follows 11 m r b m e 3 3 m r ˆ c g m r ˆ c g i 12 c r b v m ω ˆ m ω ˆ r ˆ c g m r ˆ c g ω ˆ ω ˆ i where m represents the mass of rigid body e 3 3 is the 3 by 3 identity matrix i represents the inertia matrix about the origin r ˆ c g represents the skew symmetric matrix of the center of gravity position with respect to the body frame ω ˆ is the skew symmetric matrix of angular velocity the i r ˆ c g and ω ˆ can be formulated as i i x x 0 0 0 i y y 0 0 0 i z z r ˆ c g 0 z c g y c g z c g 0 x c g y c g x c g 0 and ω ˆ 0 r q r 0 p q p 0 2 5 forces and moments in our model the force and moment vector f is the sum of the added mass and forces f a the gravitational and buoyancy forces f b g the hydrodynamic forces and moments f h and the deflectable duct propeller forces and moments f p and the forces and moments vector f can be defined as 13 f f a f b g f h f p 2 5 1 added mass forces and moments the added mass forces and moments are obtained due to the inertia of the surrounding fluid which depends on the acceleration of the auv s body with respect to the water hence the added mass and forces can be expressed as 14 f a m a v c a v v where m a is the added mass matrix c a v is a coriolis centripetal matrix depending on the added mass considering the auv excluding the deflectable duct propeller is symmetrical about the a xy plane and a yz plane in the body fixed coordinate frame the m a and c a v are simplified to the following form 15 m a λ 11 0 0 0 0 0 0 λ 22 0 0 0 λ 26 0 0 λ 33 0 λ 35 0 0 0 0 λ 44 0 0 0 0 λ 53 0 λ 55 0 0 λ 62 0 0 0 λ 66 16 c a v ω ˆ 0 v ˆ ω ˆ m a where λ i j i 1 6 j 1 6 means the added mass coefficients and 17 v ˆ 0 w v w 0 u v u 0 2 5 2 gravitational and buoyancy forces the gravitational and buoyancy forces occurred due to weight and buoyancy these are also called restoring forces and moments thus this is defined as 18 f b g r a e b g r ˆ c g r a e g where r a e θ is the inverse of r e a θ that is r a e θ r e a θ 1 b 0 ρ g h 0 t is the buoyancy force vector of the auv where ρ is the density of sea which was set as 1024 kg m3 g is the gravitational acceleration which was set as 9 8 m s2 in this paper h is the volume of auv g 0 m g 0 t represents the gravitational force of the auv 2 5 3 damping forces and moments in this work the hydrodynamic forces and moments include hydrodynamic position forces and moments and damping forces and moments hydrodynamic position forces and moments occur when the vehicle translates in water at a constant velocity and the hydrodynamic damping forces and moments are produced when the vehicle rotates in water with a constant angular velocity thus hydrodynamic forces and moments can be calculated with a linear approximation defined as 19 f h 1 2 ρ s v c x c y α α v c y r r l c z β β v c z q q l m x β β v l m x p p m x q q l 2 m y β β v l m y p p m y q q l 2 m z α α v l m z r r l 2 where c x c y α c y r m x β are the hydrodynamic coefficients s means the maximum cross sectional area of the hull l is the length of auv 2 5 4 forces and moments of deflectable duct propeller the deflectable duct propeller will generate the thrust along the longitudinal axis of the novel auv f t the torque around the longitudinal axis of the novel auv q t the lateral force perpendicular to the axis 2 and parallel to the a yz plane f c and the lateral torque around the axis 2 q c shown in fig 5 according to fig 5 the f t q t f c and q c are relative to the propeller rotation speed n the diameter of the duct d and these are defined as 20 f t k t δ j ρ n 2 d 4 q t k q t δ j ρ n 2 d 5 f c k c δ j ρ n 2 d 4 q c k q c δ j ρ n 2 d 5 where j is the advanced coefficient k t δ j k q t δ j k c δ j and k q c δ j calculated by the cfd method are the hydrodynamic forces coefficients of deflectable duct propeller and will be described in section 3 therefore the forces and moments of the deflectable duct propeller is defined as 21 f p f t f c cos χ f c sin χ q t q c f c l a c sin χ q c f c l a c cos χ where l ac represents the distance between the duct rotation center and the center of buoyancy cb of auv 3 performance estimation of deflectable duct propeller estimating the performance of the deflectable duct propeller is a challenging task when the duct is deflected the flow field is no longer symmetry about the rotation axis increasing the difficulty of grid generation of calculating domain thus a three dimensional full channel calculation is necessary in order to describe the performance in order to estimate and analyze the performance of the deflectable duct propeller the computational fluid dynamics method cfd has been applied the ansys cfx15 0 and icem software are used for cfd analysis icem is used to discretize the flow domain onto a finite set of the control volume and ansys cfx15 0 is used to solve the flow in the domain 3 1 numerical model the cfd analysis is based on the reynolds averaged navier stokes rans equations and the continuity equations in addition the rng k ε turbulence model is used to solve the complex rotating flow field the governing equations can be written as follows 22 u i x i 0 23 ρ u i t ρ u i u j x j p x i x j μ u i x j u j x i 2 3 μ u l x l δ i j ρ f i x j ρ u i u j where u i u j i j 1 2 3 are the fluid velocity components p is the static fluid pressure μ is the dynamic viscosity coefficient δ i j is the kronecker delta function f i is the mass force ρ u i u j is the reynolds stress term the rng k ε turbulent model is originated from a rigorous statistical technique it adds a condition to the ε model so the precision is improved effectively moreover the influence of turbulent vortex on the calculation process is fully considered in the rng k ε turbulent model which makes the rng k ε turbulent model more accurate and reliable to solve the complex rotating flow field considering that the deflectable duct can lead to the asymmetrical flow fields it is more complex than conventional ducted propeller flow fields therefore the rng k ε turbulent model is utilized to close the rans equations and the rng k ε turbulent model can be written as follows 24 t ρ k x i ρ k u i x j α k μ e f f k x j g k g b ρ ε y m 25 t ρ ε x i ρ ε u i x j μ 0 μ t σ ε ε x j c ε 1 ε k p k c ε 2 ρ ε 2 k r ε where 26 μ t ρ c μ k 2 ε r ε c μ ρ η 3 1 η η 0 1 β η 3 ε 2 k where μ t is the turbulent viscosity coefficient c μ is the turbulent generation term and the other parameters are c ε 1 1 42 c ε 2 1 42 c μ 0 0845 η 0 4 38 β 0 012 in the cfd analysis in order to calculate the forces and moments coefficients of the deflectable duct propeller we define advance coefficient j thrust coefficient k t and lateral force coefficient k c torque coefficients k qt and lateral torque coefficient k qc and they are defined as 27 j v f n d k t f t ρ n 2 d 4 k c f c ρ n 2 d 4 k q t q t ρ n 2 d 5 k q c q c ρ n 2 d 5 where v f is the inflow velocity to the entire domain f t f c q c and q c are the thrust lateral force torque and lateral torque of the deflectable duct propeller calculated in cfd method respectively and in this cfd analysis the fluid density is defined as 1024 kg m3 and the rotation speed of the propeller is set as 1500 rpm 3 2 computational domain and hybrid grid in the present study the 19a duct and the ka4 70 propeller which are introduced by sheng et al 2004 are utilized to estimate and analyze the performance of the deflectable duct propeller the major parameters of the duct are illustrated in table 1 thus for sake of brevity we do not present the geometric model of the 19a duct and the ka4 70 propeller which can be found in sheng et al 2004 in order to avoid the interference between the deflectable duct and propeller blade the clearance between propeller blade tip and duct inner wall is defined as 5 mm when the duct is deflected the wake flow field of propeller is no longer symmetric thus the full flow field calculation method is necessary to calculate the flow field of the deflectable duct propeller the length of the cylindrical computational domain is set as 3200 mm and the radius is set as 1000 mm the computational domain is divided into three parts the first part is the stationary domain and global domain the second part is a cylindrical domain containing duct and is also called the stationary domain and the third part is a rotating domain containing the propeller as shown in fig 6 the flow field in the duct is no longer symmetric because of the deflectable duct therefore a proper grid division technique is of most importance to solve the rans equations accurately and it has great influence on accuracy and efficiency of the calculation following consideration of the complexity of the flow field in this paper the single grid can t meet the calculation requirements so the structured grid and the unstructured grid are combined and the multi blocks hybrid grid is utilized to divide the global computational domain in the present paper for the first part the domain is a large cylinder subtracting a small cylinder thus this regular geometry fits the hexahedral structured grid for the second part and third part because of the deflectable duct and irregular propeller blade the structured grid is difficult to build therefore the unstructured tetrahedral grid is built in these two parts and the prismatic grid is generated to catch the boundary layer around the propeller blades and duct wall the hybrid grid is illustrated in fig 7 3 3 grid verification in cfd numerical simulations the grid number has great influence on the simulation results thus before the cfd numerical calculation we perform the grid verification study with four different grids at the advance ratio of j 0 6 as listed in table 1 these four different grids are gained by adjusting the first layer s height the number of grid nodes and the maximum grid size of propeller rotating domain the grid verification study was considered for the duct without deflection since it is hard to find data relevant to the duct with deflection as shown in table 2 we compare the three parameter including k t k q and η at j 0 6 k t k q and η start to converge with the increase of gird number consequently we conclude that the 3 15 million grids are suitable for the cfd numerical simulation with the proper accuracy and calculation time in addition we compared hydrodynamic force coefficients from the present numerical data with those from the design diagram data when the duct is not deflected and the comparison results are illustrated in fig 8 according to fig 8 the numerical data from the present work are in good agreement with design diagram data therefore it can be concluded from fig 8 that the grid division method proposed in this study is reliable for performing numerical simulations 3 4 calculation results 3 4 1 hydrodynamic forces coefficients for analyzing the influence of the deflection angle δ on the performance of deflectable duct propeller we calculate the hydrodynamic forces coefficients with different deflection angles δ the deflection angles δ ranges from 0 to 20 with 5 interval and the advanced coefficient j ranges from 0 2 to 1 by changing the inflow velocity to the entire domain the thrust coefficient torque coefficient and propulsive efficiency with different deflection angles δ are shown in fig 9 in addition lateral force coefficient and lateral torque coefficient with different deflection angles δ are shown in fig 10 as shown in fig 9 with the increase of deflection angle δ the thrust coefficient torque coefficient and propulsive efficiency all have decreased when δ 5 the thrust coefficient has an obvious decrease compared with δ 0 at low advanced coefficient when the advanced coefficient is 0 2 the thrust coefficient has dropped by 10 7 in addition the difference in thrust coefficient between δ 0 and δ 5 has decreased with regard to the torque coefficient it has the same trend with thrust coefficient but it has more obvious decrease at large advanced coefficient the maximum propulsion efficiency has obvious drop with the increase of δ at the same time the advanced coefficient corresponding to the maximum propulsion efficiency is moved up when δ 0 the maximum propulsion efficiency is 58 7 the advanced coefficient for maximum efficiency is 0 7 however when δ 20 the maximum propulsion efficiency is 32 9 the advanced coefficient for maximum efficiency is 0 55 fig 10 illustrates that when the duct is deflected the deflectable duct propeller can generate lateral force and lateral torque with the increase of the advanced coefficient and the deflection angle δ the lateral force efficiency and lateral torque coefficient increase it is worth mentioning that the lateral force is greater than thrust when δ 10 and j 0 4 in addition the lateral torque coefficient increases with the increase of j and the growth rate of lateral torque coefficient is slow when j 0 4 however when j 0 4 the growth rate increases and the lateral torque coefficient increases approximately linearly with the increase of j 3 4 2 flow fields for analyzing the flow field of deflectable duct propeller we compare the pressure contours of different vertical surfaces when δ 0 and when δ 20 fig 11 shows the pressure contours of different vertical surfaces when j 0 7 and the upper part shows the pressure contours of different vertical surfaces when δ 0 and the lower part shows the pressure contours of different vertical surfaces when δ 20 and the distance between different vertical surfaces and the center of rotation of the duct is shown in table 3 and the mean forward the propeller while the means behind the propeller and fig 12 shows the velocity contours with different δ when j 0 7 as shown in fig 11 when δ 0 the deflectable duct propeller is a common duct propeller the flow fields is symmetrical and the pressure distribution on inner wall of the duct is also symmetrical in addition the pressure gradient between blade tip and duct is larger in vertical surface 3 however when δ 20 the flow fields is obviously no longer symmetrical and the pressure distribution is extremely uneven the lower part of the fluid flows around the duct wall and starts to accelerate in vertical surface 1 which contributes to the lower pressure and the velocity of the upper part of the fluid starts to decline and the high pressure region appears in vertical surface 2 in addition the pressure gradient at blade is larger with vertical surface moves from 1 to 5 the fluid will mainly hit the upper part of the duct which causes that the velocity of the upper part of the fluid reduces but the velocity of the lower part of the fluid gradually increases thus the pressure of the upper part increases and the pressure of the lower part decreases gradually it can be seen from fig 12 that when the deflection angle δ 0 it can be seen that the tail acceleration zone caused by the rotation of the propeller is symmetrical and with the increase of δ the lower part of the duct will cause the fluid to accelerate which is consistent with the pressure distribution in fig 10 however with the increase of δ the upper part of the duct will cause the fluid backflow and the inflow area will increase causing an increase in resistance lateral force and lateral torque 4 motion simulation and maneuverability analysis based on the above 6 dof mathematical model and the performance estimation of the deflectable duct propeller we perform motion simulation and maneuverability analysis of the novel auv with a deflectable duct propeller firstly based on the performance estimation of the deflectable duct propeller we use an interpolation method to obtain the fluid hydrodynamic forces coefficients in simulation fig 13 shows the hydrodynamic forces coefficients interpolation surfaces with advance coefficient j and deflection angle δ secondly in order to demonstrate the 6 dof motion responses physical parameters of the novel auv with a deflectable duct propeller are classified into two subsystems table 4 shows the parameters of the auv with the deflectable duct propeller and table 5 shows the hydrodynamic parameters in order to estimate the hydrodynamic parameters of the novel auv with a deflectable duct propeller computational fluid dynamics method cfd is utilized to estimate the hydrodynamic forces for the novel auv such as drag lift and moment coefficients in various angles of attack and velocity in this paper the fluent and icem software are used for cfd analysis icem is used to discretize the flow domain onto a finite set of the control volume and fluent is used to solve the flow in the domain finally the hydrodynamic coefficients are obtained by fitting method in order to analyze the maneuverability of novel auv with the deflectable duct propeller the motion simulations are developed in present work the motion simulations examine three main aspects 2d longitudinal motions 2d lateral motions and 3d space motions 4 1 2d longitudinal motions the 2d longitudinal motions are performed by setting the rotating angle χ equal to 0 in addition the different longitudinal motions can be simulated by changing the deflection angle δ in this section we perform two mainly 2d longitudinal motions 2d motion with depth control and 2d motion with pitch angle control 4 1 1 depth control the 2d motion of depth change is performed by the pd depth control scheme the pd depth control scheme is realized by using the difference of the real depth of the novel auv and the reference depth y r e f the pitch angle of the auv and the surge of the auv the reference depth and the pd depth control scheme of the novel auv with a deflectable duct propeller are given by 28 y r e f 1 int t 100 1 4 δ k y y y r e f k θ θ k r r where k y k θ and k r are the control coefficients of the pd depth control scheme and in this present simulation k y is defined as 0 5 k θ is defined as 5 and k r is set as 2 and int is a rounding function t is the simulation time and is set as 200s in addition we simulate the 2d motion of depth change when the same auv is equipped with traditional propeller rudder control system with same pd depth control scheme and the rotating speed of the propeller is same both are 600 rpm the hydrodynamic forces coefficients of the traditional propeller rudder are c y δ h 1 453 and m z δ h 0 6496 the simulation results in fig 14 show the simulation results including the trajectory of auv the pitch angle of auv and the deflection angle of the duct fig 14 a shows that with pd depth control scheme the novel auv with a deflectable duct propeller achieves the movement of changing depth in the early stage the depth of auv has a definite fluctuation and then the depth of auv reaches the reference depth the pitch angle also illustrates this phenomenon in fig 14 b as shown in fig 14 c with pd depth control scheme the deflection angle changes when the depth of auv changes and then the forces and moments caused by the deflection angle will lead auv to navigate to the reference depth when the auv reaches the reference depth the deflection angle of the duct is equal to zero approximately in addition comparing the depth of auv with a deflectable propeller and that with a traditional propeller rudder system the auv with a deflectable propeller has a desired trajectory and has a small depth fluctuations when reference depth changes this phenomenon is also illustrated in fig 14 c so it illustrates that the novel auv with a deflectable duct propeller has a better control of 2d longitudinal motions with depth control 4 1 2 pitch angle control the 2d motion simulation with pitch angle change is also performed by the pd control scheme the pd pitch angle control scheme is depended on the difference of the real pitch angle of the novel auv and the reference pitch angle θ ref and the surge of the auv and the reference pitch angle of auv and the pd pitch angle control scheme are formulated as 29 θ r e f 5 1 int t 100 1 δ k θ θ θ r e f k r r where k θ and k r are the control coefficients of the pd control scheme of pitch angle k θ is defined as 0 7 and k r is set as 0 4 and t is the simulation time and is set as 200s and we also simulate the 2d motion with pitch angle change when the same auv is equipped with traditional propeller rudder control system with same control scheme and the rotating speed of the propeller is same both are 600 rpm fig 15 shows the trajectory the pitch angle of the auv and the deflection angle of the duct fig 15 a shows that with pd pitch angle control scheme the novel auv with a deflectable duct propeller achieves the movement changing pitch angle fig 15 b shows that in the early stage of changing pitch angle movement the pitch angle of auv have a certain fluctuation in addition although pitch angle of auv finally reaches a steady state there still is a small error between the pitch angle of auv and the reference pitch angle this is mainly due to that the pd control scheme will cause a certain steady state error which is related to the control coefficients the deflection angle of the duct during the changing pitch angle movement is shown in fig 15 c with the pd depth control scheme proposed above the deflection angle of the duct changes when the pitch angle of auv changes and it will control auv move to a state which the pitch angle of auv is approximately close the reference pitch angle and then the pitch angle of auv reaches a steady state at the same time the deflection angle of the duct is also steady in addition by comparing the pitch angle of auv with a deflectable duct propeller and that with a traditional propeller rudder system the pitch angle steady state error of auv with a deflectable duct propeller is smaller than the traditional propeller rudder system with same pd control shame in general the novel auv with a deflectable duct propeller has a better pitch angle control 4 2 2d lateral motions 2d lateral motions are performed by setting the rotating angle equal to 90 in addition the different lateral motions of novel auv can be simulated with different deflection angles of the duct in this section we performed two mainly lateral motions 1 2d lateral motions with different deflection angles of the duct without control 2 2d lateral changing yaw angle motions with pd control scheme 4 2 1 different deflection angles in order to analyze the manipulation of the novel auv with different deflection angles of the duct the deflection angles are defined as 5 10 and 15 respectively and in simulation the deflection angle of the duct remains constant without changing note that there is no control scheme to control the trajectory of the novel auv that is we simulate the natural dynamics response of novel auv with constant deflection angle of the duct in this section in addition we also simulate the natural dynamics response of same auv with a propeller rudder system the hydrodynamic forces coefficients of the traditional propeller rudder are c z δ v 1 453 and m y δ v 0 6496 and the rotating speed of the propeller is same both are 600 rpm the termination condition in simulation is that the yaw angle is equal to 500 the 2d simulation results with different deflection angles of the duct show the trajectory of novel auv and the yaw angle of auv in fig 16 as shown in fig 16 with the increase of the deflection angle the turning radius of the lateral motion decreases and the increasing rate of the yaw angle grows in order to illustrate the motion characteristics of the novel auv we define the ratio of turning radius of lateral motion r to the length of auv l as r t and table 6 shows the ratio of turning radius of lateral motion to the length of auv with different deflection angles as shown in table 3 in the present work when δ 5 the r t is 9 66 and when δ 15 the r t is 3 55 with the increase of deflection angle of the duct the lateral force grows thus the torque used to control the auv also increase which results in the decrease of r t in addition when the rudder angle is 10 the r t of the same auv with traditional propeller rudder system is 7 52 and larger than the novel auv with a deflectable duct propeller zhang r m had proposed a vectored thrust underwater vehicle and the r t is 11 08 when the vertical angle of the vectored propeller is 15 based on the above comparison the novel auv with a deflectable duct propeller proposed in this paper has a high maneuverability 4 2 2 yaw angle control the 2d lateral motions with yaw angle change are analyzed by pd yaw angle control scheme the deflection angle of the duct is obtained by pd control scheme in simulation the pd control scheme of yaw angle similar with pitch angle is depended on the difference of real yaw angle of the auv and the reference yaw angle ψ ref and the yaw of the auv therefore the reference yaw angle and the pd yaw angle control scheme are formulated as 30 ψ r e f 10 1 int t 50 1 δ k ψ ψ ψ r e f k q q where k ψ and k q are the control coefficients of the pd control scheme of yaw angle and in this present simulation k ψ is defined as 0 7 and k q is set as 0 4 and t is set as 200s similarly we also simulate the 2d motion with yaw angle change when the same auv is equipped with traditional propeller rudder control system with same control scheme and the rotating speed of the propeller is same both are 600 rpm the simulation results are shown in fig 17 it can be seen from fig 17 that the auv enters a regular motion with the yaw angle control a similar change in the yaw angle and the deflection angle is found in fig 17 b and c when the reference yaw angle changes auv changes the real yaw angle with the pd yaw angle control and at the beginning there is a fluctuation in the real yaw angle and the deflection angle of the duct in addition fig 17 b shows that the real yaw angle of the auv follows the reference yaw angle and the real yaw angle is stable and reaches the reference yaw angle in a short time by comparing the yaw angle of auv with a deflectable duct and that with traditional propeller rudder system it is obvious that the novel auv with a deflectable duct propeller has a better control about yaw angle at low rotating speed of propeller than the auv with a traditional propeller rudder system which illustrates that novel auv with a deflectable duct has a high maneuverability 4 3 3d space motions 3d motions are performed by setting the rotating angle not equal to 0 in addition different 3d motions can be simulated by changing the rotating angle and the deflection angle of the duct in this section we analyze two main 3d motions 1 3d motion with different rotating angles which are 10 20 and 30 respectively 2 3d motion with different deflection angles which are 5 10 and 15 respectively 4 3 1 different rotating angles when the deflection angle of the duct δ is fixed the components of the lateral force in the body fixed frame will change with the rotating angle thus in order to illustrate the motion characteristics of novel auv with different rotating angles we set the deflection angle of the duct as 5 and the different rotating angles are 10 20 and 30 respectively in addition the simulation time is 50s fig 18 a and b indicate that novel auv can perform the 3d spiral motion however because there is no any control scheme the center positions of 3d spiral motions when the auv reaches a stable 3d spiral motion are different when the rotating angles are different and the radius of 3d spiral motion increases with the increase of the rotating angle this is because the horizontal component of the lateral force generated from the deflectable duct reduces with the rotating angle increasing fig 18 c illustrates the sideslip angle get stable smaller than 40s in addition fig 18 d shows that the increasing rate of the yaw angle grows as rotating angle decreases 4 3 2 different deflection angles when the rotating angle is fixed the size of the lateral force will change with the deflection angle of the duct thus in order to illustrate the motion characteristics of novel auv with different deflection angles we set the rotating angle as 20 and the different deflection angles are set as 5 10 and 15 respectively in addition the simulation time is 50s similarly when the rotating angle is fixed as 20 the novel auv can perform different 3d spiral motions by changing the deflection angle of the duct shown in fig 19 because there is no any control scheme the center positions of 3d spiral motions when the auv reaches a stable state change with the deflection angle changing in addition with the deflection angle increasing the radius of 3d spiral motion will reduce in addition the sideslip angle and the increasing rate of the yaw angle will grow 5 conclusion to conclude this paper introduces a novel auv with a deflectable duct propeller and concentrates on the mathematical model and maneuverability analysis of novel auv considering the effect of the deflectable duct on the performance of the duct propeller the geometrical model of the deflectable propeller is proposed and a 6 dof motion model is built based on the newton s and euler s equation the forces and moments of the whole auv with a deflectable duct propeller are analyzed in detail and the performance of the deflectable duct propeller is estimated and analyzed by the cfd numerical computation the maneuverability of auv is analyzed by a series of simulation experiments including the 2d longitudinal motions 2d lateral motions and 3d space motions the major achievements can be summarized as follows 1 the 6 dof notion model of the novel auv with a deflectable duct propeller is proposed in this work and the performance estimation of the deflectable duct propeller is studied based on cfd method 2 the analysis results demonstrate that deflectable duct propeller can generate the lateral force and moment for controlling the auv when the duct is deflected in addition the control force and control moment are related to the deflection angle and the rotating angle 3 the motion simulations are conducted by changing the rotating angle and deflection angle of the duct and the simulation results illustrate that the ratio of turning radius of lateral motion to the length of auv is 5 03 when the deflection angle of the duct is 10 in the present work and is less than the traditional propeller rudder system which indicates that the novel auv with a deflectable duct propeller has a better 2d and 3d maneuverability than the traditional propeller rudder system 
23238,the vector propulsion systems have been equipped in numerous autonomous underwater vehicles auvs nowadays in most cases the vector propulsion is achieved by changing the direction of the entire vector propulsion system which requires a spacious room for complex mechanical structures at the tail of the auv the deflectable duct propeller however as a new way to achieve vector propulsion can generate lateral force and moment enabling the auv to perform various motions in this work the 6 dof notion model of the novel auv with a deflectable duct propeller is developed based on the newton s and euler s equation considering the forces and moments generated by the deflectable duct propeller and a cfd model is proposed to estimate performance of a deflectable duct propeller the motion simulations including 2d longitudinal motions 2d lateral motions and 3d space motions are conducted to analyze the maneuvering performance of the novel auv with a deflectable duct propeller and simulation results illustrate that the novel auv with a deflectable duct propeller has a better maneuverability than traditional propeller rudder system keywords deflectable duct propeller mathematical model maneuverability performance estimation motion simulation nomenclature χ rotating angle δ deflection angle cb centre of buoyancy cg center of gravity r c g position vector of cg in the body fixed reference frame r c g x c g y c g z c g t η generalized position vector η p t θ t t p position vector p x y z t θ vector of euler angles θ θ ψ φ t v velocity vector v s t ω t t s translational velocity vector s u v w t ω angular velocity vector ω p q r t j η transformation matrix r e a θ velocity transformation matrix t e a θ angular velocity transformation matrix α attack angle β sideslip angle v speed of the auv v u 2 v 2 w 2 m r b inertia mass matrix c r b v coriolis centripetal matrix v derivative of velocity vector m mass of the whole auv f forces and moments vector acting on the novel auv f f a f b g f h f p e 3 3 3 by 3 identity matrix i a inertia matrix about the origin a ω ˆ skew symmetric matrix of ω r ˆ c g skew symmetric matrix of r c g f a added mass forces f b g gravitational and buoyancy forces f h damping forces and moments f p deflectable duct propeller forces and moments m a added mass inertia matrix c a v added coriolis centripetal matrix λ i j added mass coefficients s ˆ skew symmetric matrix of s b buoyancy force vector g gravitational force vector ρ sea water density g gravitational acceleration h auv drainage volume r a e θ inverse matrix of r a e θ s maximum cross sectional area of auv l total length of auv c x c y α c y r m x β hydrodynamic coefficients of the novel auv with a deflectable duct propeller f t thrust of deflectable duct propeller f c lateral force perpendicular to the axis 2 q t torque of deflectable duct propeller q c lateral torque around the axis 2 n propeller rotation speed d diameter of the duct j advanced coefficient l ac distance between the duct rotation center and the center of buoyancy cb of auv u i u j fluid velocity components p static fluid pressure μ dynamic viscosity coefficient δ i j kronecker delta function f i mass force ρ u i u j reynolds stress term μ t turbulent viscosity coefficient c μ turbulent generation term k t thrust coefficient k c lateral force coefficient k qt torque coefficients k qc lateral torque coefficient v f inflow velocity to the entire domain f t thrust calculated in cfd method f c lateral force calculated in cfd method q t torque calculated in cfd method q c lateral torque calculated in cfd method η propulsive efficiency y r e f reference depth θ ref reference pitch angle ψ ref reference yaw angle t simulation time r turning radius of lateral motion k y k θ k r k ψ k q control coefficients c y δ h m z δ h c z δ v m y δ v hydrodynamic forces coefficients of the traditional propeller rudder r t ratio of turning radius of lateral motion to the length of auv 1 introduction recently due to the shortage of land resources oceans have attracted more and more people s sights autonomous underwater vehicle auv has grown up to be an important research topic today as they have become indispensable for their assistance in underwater missions f bellavia et al 2017 the maneuverability of auv is an important consideration to judge their performance nowadays the control of the auv is mainly depended on the fins and rudders however this control mode has a low efficiency when auv is manipulated at minimal speed in order to improve the manipulation efficiency of auv at low speed some researchers have put forward the vector propulsion system instead of the traditional propeller rudder control mode mishra and chitre 2016 the vector propulsion system can produce forces and moments used to accomplish the control of auv and has replaced traditional propeller rudder control mode on a certain extent nowadays with the improvements of the vector propulsion technology auv can change its movement state only by altering the direction of vector propulsion system zhang et al 2016 developed a vectored underwater vehicle with the parallel vectored thruster and the propeller shaft attitude is controlled by two dof spherical parallel mechanism they simulated the dynamic behavior and maneuverability of the vectored underwater vehicle in addition cavallo et al 2004 proposed a spherical parallel mechanism to achieve the vector propulsion however the vector propulsion system for auvs has extremely complex mechanical structures which limits its application to the small underwater vehicles therefore based on the commercial duct propeller a kind of vector propulsion system including a deflectable duct propeller is proposed in this paper it is all known that commercial duct propeller can only produce thrust without any additional control force however when the propeller is fixed and the duct is deflected the deflectable duct propeller will generate the lateral force and moment controlling auv to change its states and the thrust to drive auv kopman et al 2012 presented the design of a streamlined underwater vehicle utilizing an entirely enclosed propulsion and steering system and the steering of the vehicle is controlled by controlling the vectoring cone s orientation hence providing a thrust vectoring effect to the jet of water exiting through the back of the stern section in order to analyze the influence of the deflectable duct propeller on maneuverability of auv the motion model of the novel auv equipped with a deflectable duct propeller should be analyzed systematically basically a nonlinear six degrees of freedom dof model of auv which was used widely for modeling and control of underwater vehicles is described in fossen 2002 and antonelli et al 2008 the kinematic modeling in dynamic systems is based on the newton euler method which divides the main force components into distinguished terms on the other hand the mathematical model and motion control analysis of underwater vehicles have been presented by many researchers tian et al 2012 liu et al 2017 chen et al 2014 2016 liang et al 2016 tian w et al developed a three dimensional mathematical model of haishen vehicle with two independently controlled hydrofoils and the effect of controllable hydrofoils on the vehicle stable motion performance is studied theoretically liu f et al built a 3d dynamic model of petrel ii using linear momentum and angular momentum equations and the spiral motion in the underwater space is simulated for the gliding mode similarly the cycle motion on the water surface and the depth keeping motion underwater are simulated for the level flight mode although numerous underwater vehicle models have been presented there is a little study of the model of the novel auv with a deflectable duct propeller thus as for the novel auv with a deflectable duct propeller there is an urgent need to build dynamics model for this system in terms of the performance estimation of the deflectable duct propeller in recent years with the realization of high performance computing technology computational fluid dynamics cfd has become a dominant tool to predict the performance of commercial duct propeller numerically martio et al 2017 bhattacharyya et al 2016 de barros and dantas 2012 park et al 2005 hoekstra 2006 go et al 2017 martio et al 2017 et al studied the virtual mass and damping coefficients of an open and ducted propeller are determined using urans computations based on cfd method bhattacharyya et al 2016 et al addressed the problem of scale effect on the open water characteristics of ducted propellers using the results of extensive cfd investigations at different reynolds numbers and loading conditions it can be concluded that the cfd method can numerically predict the hydrodynamic characteristics of a ducted propeller accurately de barros and dantas 2012 proposed the modeling of the hydrodynamic forces and moments on a duct propeller according to a numerical cfd simulation the results confirm that the advantages of the symbiosis between cfd and ase methods for modeling the influence of the propeller duct in the auv maneuverability thus performance of the deflectable duct propeller is estimated by using computational fluid dynamics cfd method in this work this study puts forward the following contributions a complete mathematical model describing the motion of the novel auv with a deflectable duct propeller is developed for motion simulation and maneuverability analysis the novel design of the deflectable duct propeller ensures a high maneuverability by introducing control forces and moments generated from the deflectable duct additionally a cfd technique is used for estimating and analyzing the performance of the deflectable duct propeller with different deflection angles and different advance coefficients for analysis of the maneuverability of the novel auv with a deflectable duct propeller a series of motion simulations are conducted with or without control in motion simulations the control forces and moments generated from the deflectable duct propeller are calculated by the numerical interpolation method the simulation results illustrate that the novel auv with a deflectable duct propeller has a better 2d and 3d maneuverability than the traditional propeller rudder system 2 mathematical model 2 1 geometric model based on the conventional duct propeller a new auv with a deflectable duct propeller is proposed in this paper as shown in fig 1 and fig 2 shows the new deflectable duct propeller which consists of one rotating base four pins two hydraulic rods two bearings and one duct according to fig 2 the operation principle of the new deflectable duct propeller is briefly introduced firstly the rotating base has two rigid rods which connect with the duct symmetrically and two rigid supports for hydraulic rod installation similarly the duct also has two rigid struts for hydraulic rod installation the hydraulic rod connects the rotating base and the duct by two pins the rotating base can rotate around axis 1 shown in fig 2 and the rotating angle defined as χ ranges from 0 to 90 in addition the bearings are installed at the connection position of the duct and the two rigid rods which makes sure that the duct can rotate around the axis 2 shown in fig 2 and under the action of the push pull cooperation of the two hydraulic rods the deflection angle around axis 2 defined as δ also ranges from 20 to 20 fig 3 also shows the new deflectable duct propeller with 20 deflection around axis 2 δ 20 as shown in fig 3 the first hydraulic rod elongates and the second hydraulic rod shortens when the length of the first hydraulic rod reaches its maximum and the length of the second hydraulic rod reaches its minimum the deflection angle of the duct is 20 therefore different lengths of two hydraulic rods will cause different deflection angle of the duct we can control the lengths of two hydraulic rods to control the auv 2 2 reference frames in order to model the auv with a deflectable duct propeller mathematically the two reference frames are defined to describe motion of auv the body fixed reference frame a xyz and the earth fixed reference frame e xyz fig 4 shows the reference frames the body fixed frame a xyz is a moving frame with its origin at the center of buoyancy cb which is located at the geometric center of the auv let the a x axis lies along the longitudinal axis from tail to the nose the transversal axis a z points to the right side of the auv and the a y axis which is known as the normal axis is orthogonal to the a x and a z directing from bottom to top on the other hand the earth fixed reference frame e xyz considered to be a fixed reference frame is located at the sea surface the e x axis and the e z axis are in the horizontal plane while the e y axis is in the opposite direction of the gravity 2 3 kinematics model in this present work the center of gravity cg of the auv is situated slightly under the center of buoyancy cb this important parameter is denoted as r c g x c g y c g z c g t in the body fixed reference frame a xyz the generalized position vector of the auv with respect to the earth fixed reference frame is denoted as 1 η p t θ t t x y z θ ψ φ t where p x y z t is a position vector and x y and z are position components of the auv in the earth fixed reference frame and θ θ ψ φ t is a vector of euler angles where θ ψ and φ are defined as pitch angle yaw angle and roll angle respectively in addition the velocity vector of the auv in the earth fixed reference frame is defined as 2 v s t ω t t u v w p q r t where s u v w t is a translational velocity vector and u v and w are the translational velocity components in the earth fixed reference frame and ω p q r t is an angular velocity vector and p q and r are the angular velocity components in the earth fixed reference frame therefore the kinematic equations describe the geometrical relationship between the inertial coordinate frame and the body fixed coordinate frame and can be described as follows 3 η j η v where j η is defined as the transformation matrix to transform vectors from the body fixed coordinate frame a xyz to the earth fixed reference frame e xyz and it can be formulated by a matrix which can be defined as follows 4 j η r e a θ 0 0 t e a θ where 5 r e a θ cos θ cos ψ sin θ cos ψ cos φ sin ψ sin φ sin θ cos ψ sin φ sin ψ cos φ sin θ cos θ cos φ cos θ sin φ cos θ sin ψ sin θ sin ψ cos φ cos ψ sin φ sin θ sin ψ sin φ cos ψ cos φ and 6 t e a θ 0 sin φ cos φ cos φ tan θ 0 sin φ tan θ 1 tan θ cos φ tan θ sin φ in addition in order to calculate the hydrodynamic forces on the novel auv we define two hydrodynamic angles the angle of attack α and the sideslip angle β these two angles are formulated as 7 α tan 1 v u 8 β tan 1 w v where v is the speed of the auv which can be directly calculated by using the following equation 9 v u 2 v 2 w 2 2 4 dynamics model in terms of the dynamic model based on the newton s and euler s equation the motion equation of the novel auv is defined as 10 m r b v c r b v v f where m r b represents the inertia mass matrix c r b v is the coriolis centripetal matrix and f denotes the force and moment vector acting on the body fossen 2002 the m r b and c r b v are defined as follows 11 m r b m e 3 3 m r ˆ c g m r ˆ c g i 12 c r b v m ω ˆ m ω ˆ r ˆ c g m r ˆ c g ω ˆ ω ˆ i where m represents the mass of rigid body e 3 3 is the 3 by 3 identity matrix i represents the inertia matrix about the origin r ˆ c g represents the skew symmetric matrix of the center of gravity position with respect to the body frame ω ˆ is the skew symmetric matrix of angular velocity the i r ˆ c g and ω ˆ can be formulated as i i x x 0 0 0 i y y 0 0 0 i z z r ˆ c g 0 z c g y c g z c g 0 x c g y c g x c g 0 and ω ˆ 0 r q r 0 p q p 0 2 5 forces and moments in our model the force and moment vector f is the sum of the added mass and forces f a the gravitational and buoyancy forces f b g the hydrodynamic forces and moments f h and the deflectable duct propeller forces and moments f p and the forces and moments vector f can be defined as 13 f f a f b g f h f p 2 5 1 added mass forces and moments the added mass forces and moments are obtained due to the inertia of the surrounding fluid which depends on the acceleration of the auv s body with respect to the water hence the added mass and forces can be expressed as 14 f a m a v c a v v where m a is the added mass matrix c a v is a coriolis centripetal matrix depending on the added mass considering the auv excluding the deflectable duct propeller is symmetrical about the a xy plane and a yz plane in the body fixed coordinate frame the m a and c a v are simplified to the following form 15 m a λ 11 0 0 0 0 0 0 λ 22 0 0 0 λ 26 0 0 λ 33 0 λ 35 0 0 0 0 λ 44 0 0 0 0 λ 53 0 λ 55 0 0 λ 62 0 0 0 λ 66 16 c a v ω ˆ 0 v ˆ ω ˆ m a where λ i j i 1 6 j 1 6 means the added mass coefficients and 17 v ˆ 0 w v w 0 u v u 0 2 5 2 gravitational and buoyancy forces the gravitational and buoyancy forces occurred due to weight and buoyancy these are also called restoring forces and moments thus this is defined as 18 f b g r a e b g r ˆ c g r a e g where r a e θ is the inverse of r e a θ that is r a e θ r e a θ 1 b 0 ρ g h 0 t is the buoyancy force vector of the auv where ρ is the density of sea which was set as 1024 kg m3 g is the gravitational acceleration which was set as 9 8 m s2 in this paper h is the volume of auv g 0 m g 0 t represents the gravitational force of the auv 2 5 3 damping forces and moments in this work the hydrodynamic forces and moments include hydrodynamic position forces and moments and damping forces and moments hydrodynamic position forces and moments occur when the vehicle translates in water at a constant velocity and the hydrodynamic damping forces and moments are produced when the vehicle rotates in water with a constant angular velocity thus hydrodynamic forces and moments can be calculated with a linear approximation defined as 19 f h 1 2 ρ s v c x c y α α v c y r r l c z β β v c z q q l m x β β v l m x p p m x q q l 2 m y β β v l m y p p m y q q l 2 m z α α v l m z r r l 2 where c x c y α c y r m x β are the hydrodynamic coefficients s means the maximum cross sectional area of the hull l is the length of auv 2 5 4 forces and moments of deflectable duct propeller the deflectable duct propeller will generate the thrust along the longitudinal axis of the novel auv f t the torque around the longitudinal axis of the novel auv q t the lateral force perpendicular to the axis 2 and parallel to the a yz plane f c and the lateral torque around the axis 2 q c shown in fig 5 according to fig 5 the f t q t f c and q c are relative to the propeller rotation speed n the diameter of the duct d and these are defined as 20 f t k t δ j ρ n 2 d 4 q t k q t δ j ρ n 2 d 5 f c k c δ j ρ n 2 d 4 q c k q c δ j ρ n 2 d 5 where j is the advanced coefficient k t δ j k q t δ j k c δ j and k q c δ j calculated by the cfd method are the hydrodynamic forces coefficients of deflectable duct propeller and will be described in section 3 therefore the forces and moments of the deflectable duct propeller is defined as 21 f p f t f c cos χ f c sin χ q t q c f c l a c sin χ q c f c l a c cos χ where l ac represents the distance between the duct rotation center and the center of buoyancy cb of auv 3 performance estimation of deflectable duct propeller estimating the performance of the deflectable duct propeller is a challenging task when the duct is deflected the flow field is no longer symmetry about the rotation axis increasing the difficulty of grid generation of calculating domain thus a three dimensional full channel calculation is necessary in order to describe the performance in order to estimate and analyze the performance of the deflectable duct propeller the computational fluid dynamics method cfd has been applied the ansys cfx15 0 and icem software are used for cfd analysis icem is used to discretize the flow domain onto a finite set of the control volume and ansys cfx15 0 is used to solve the flow in the domain 3 1 numerical model the cfd analysis is based on the reynolds averaged navier stokes rans equations and the continuity equations in addition the rng k ε turbulence model is used to solve the complex rotating flow field the governing equations can be written as follows 22 u i x i 0 23 ρ u i t ρ u i u j x j p x i x j μ u i x j u j x i 2 3 μ u l x l δ i j ρ f i x j ρ u i u j where u i u j i j 1 2 3 are the fluid velocity components p is the static fluid pressure μ is the dynamic viscosity coefficient δ i j is the kronecker delta function f i is the mass force ρ u i u j is the reynolds stress term the rng k ε turbulent model is originated from a rigorous statistical technique it adds a condition to the ε model so the precision is improved effectively moreover the influence of turbulent vortex on the calculation process is fully considered in the rng k ε turbulent model which makes the rng k ε turbulent model more accurate and reliable to solve the complex rotating flow field considering that the deflectable duct can lead to the asymmetrical flow fields it is more complex than conventional ducted propeller flow fields therefore the rng k ε turbulent model is utilized to close the rans equations and the rng k ε turbulent model can be written as follows 24 t ρ k x i ρ k u i x j α k μ e f f k x j g k g b ρ ε y m 25 t ρ ε x i ρ ε u i x j μ 0 μ t σ ε ε x j c ε 1 ε k p k c ε 2 ρ ε 2 k r ε where 26 μ t ρ c μ k 2 ε r ε c μ ρ η 3 1 η η 0 1 β η 3 ε 2 k where μ t is the turbulent viscosity coefficient c μ is the turbulent generation term and the other parameters are c ε 1 1 42 c ε 2 1 42 c μ 0 0845 η 0 4 38 β 0 012 in the cfd analysis in order to calculate the forces and moments coefficients of the deflectable duct propeller we define advance coefficient j thrust coefficient k t and lateral force coefficient k c torque coefficients k qt and lateral torque coefficient k qc and they are defined as 27 j v f n d k t f t ρ n 2 d 4 k c f c ρ n 2 d 4 k q t q t ρ n 2 d 5 k q c q c ρ n 2 d 5 where v f is the inflow velocity to the entire domain f t f c q c and q c are the thrust lateral force torque and lateral torque of the deflectable duct propeller calculated in cfd method respectively and in this cfd analysis the fluid density is defined as 1024 kg m3 and the rotation speed of the propeller is set as 1500 rpm 3 2 computational domain and hybrid grid in the present study the 19a duct and the ka4 70 propeller which are introduced by sheng et al 2004 are utilized to estimate and analyze the performance of the deflectable duct propeller the major parameters of the duct are illustrated in table 1 thus for sake of brevity we do not present the geometric model of the 19a duct and the ka4 70 propeller which can be found in sheng et al 2004 in order to avoid the interference between the deflectable duct and propeller blade the clearance between propeller blade tip and duct inner wall is defined as 5 mm when the duct is deflected the wake flow field of propeller is no longer symmetric thus the full flow field calculation method is necessary to calculate the flow field of the deflectable duct propeller the length of the cylindrical computational domain is set as 3200 mm and the radius is set as 1000 mm the computational domain is divided into three parts the first part is the stationary domain and global domain the second part is a cylindrical domain containing duct and is also called the stationary domain and the third part is a rotating domain containing the propeller as shown in fig 6 the flow field in the duct is no longer symmetric because of the deflectable duct therefore a proper grid division technique is of most importance to solve the rans equations accurately and it has great influence on accuracy and efficiency of the calculation following consideration of the complexity of the flow field in this paper the single grid can t meet the calculation requirements so the structured grid and the unstructured grid are combined and the multi blocks hybrid grid is utilized to divide the global computational domain in the present paper for the first part the domain is a large cylinder subtracting a small cylinder thus this regular geometry fits the hexahedral structured grid for the second part and third part because of the deflectable duct and irregular propeller blade the structured grid is difficult to build therefore the unstructured tetrahedral grid is built in these two parts and the prismatic grid is generated to catch the boundary layer around the propeller blades and duct wall the hybrid grid is illustrated in fig 7 3 3 grid verification in cfd numerical simulations the grid number has great influence on the simulation results thus before the cfd numerical calculation we perform the grid verification study with four different grids at the advance ratio of j 0 6 as listed in table 1 these four different grids are gained by adjusting the first layer s height the number of grid nodes and the maximum grid size of propeller rotating domain the grid verification study was considered for the duct without deflection since it is hard to find data relevant to the duct with deflection as shown in table 2 we compare the three parameter including k t k q and η at j 0 6 k t k q and η start to converge with the increase of gird number consequently we conclude that the 3 15 million grids are suitable for the cfd numerical simulation with the proper accuracy and calculation time in addition we compared hydrodynamic force coefficients from the present numerical data with those from the design diagram data when the duct is not deflected and the comparison results are illustrated in fig 8 according to fig 8 the numerical data from the present work are in good agreement with design diagram data therefore it can be concluded from fig 8 that the grid division method proposed in this study is reliable for performing numerical simulations 3 4 calculation results 3 4 1 hydrodynamic forces coefficients for analyzing the influence of the deflection angle δ on the performance of deflectable duct propeller we calculate the hydrodynamic forces coefficients with different deflection angles δ the deflection angles δ ranges from 0 to 20 with 5 interval and the advanced coefficient j ranges from 0 2 to 1 by changing the inflow velocity to the entire domain the thrust coefficient torque coefficient and propulsive efficiency with different deflection angles δ are shown in fig 9 in addition lateral force coefficient and lateral torque coefficient with different deflection angles δ are shown in fig 10 as shown in fig 9 with the increase of deflection angle δ the thrust coefficient torque coefficient and propulsive efficiency all have decreased when δ 5 the thrust coefficient has an obvious decrease compared with δ 0 at low advanced coefficient when the advanced coefficient is 0 2 the thrust coefficient has dropped by 10 7 in addition the difference in thrust coefficient between δ 0 and δ 5 has decreased with regard to the torque coefficient it has the same trend with thrust coefficient but it has more obvious decrease at large advanced coefficient the maximum propulsion efficiency has obvious drop with the increase of δ at the same time the advanced coefficient corresponding to the maximum propulsion efficiency is moved up when δ 0 the maximum propulsion efficiency is 58 7 the advanced coefficient for maximum efficiency is 0 7 however when δ 20 the maximum propulsion efficiency is 32 9 the advanced coefficient for maximum efficiency is 0 55 fig 10 illustrates that when the duct is deflected the deflectable duct propeller can generate lateral force and lateral torque with the increase of the advanced coefficient and the deflection angle δ the lateral force efficiency and lateral torque coefficient increase it is worth mentioning that the lateral force is greater than thrust when δ 10 and j 0 4 in addition the lateral torque coefficient increases with the increase of j and the growth rate of lateral torque coefficient is slow when j 0 4 however when j 0 4 the growth rate increases and the lateral torque coefficient increases approximately linearly with the increase of j 3 4 2 flow fields for analyzing the flow field of deflectable duct propeller we compare the pressure contours of different vertical surfaces when δ 0 and when δ 20 fig 11 shows the pressure contours of different vertical surfaces when j 0 7 and the upper part shows the pressure contours of different vertical surfaces when δ 0 and the lower part shows the pressure contours of different vertical surfaces when δ 20 and the distance between different vertical surfaces and the center of rotation of the duct is shown in table 3 and the mean forward the propeller while the means behind the propeller and fig 12 shows the velocity contours with different δ when j 0 7 as shown in fig 11 when δ 0 the deflectable duct propeller is a common duct propeller the flow fields is symmetrical and the pressure distribution on inner wall of the duct is also symmetrical in addition the pressure gradient between blade tip and duct is larger in vertical surface 3 however when δ 20 the flow fields is obviously no longer symmetrical and the pressure distribution is extremely uneven the lower part of the fluid flows around the duct wall and starts to accelerate in vertical surface 1 which contributes to the lower pressure and the velocity of the upper part of the fluid starts to decline and the high pressure region appears in vertical surface 2 in addition the pressure gradient at blade is larger with vertical surface moves from 1 to 5 the fluid will mainly hit the upper part of the duct which causes that the velocity of the upper part of the fluid reduces but the velocity of the lower part of the fluid gradually increases thus the pressure of the upper part increases and the pressure of the lower part decreases gradually it can be seen from fig 12 that when the deflection angle δ 0 it can be seen that the tail acceleration zone caused by the rotation of the propeller is symmetrical and with the increase of δ the lower part of the duct will cause the fluid to accelerate which is consistent with the pressure distribution in fig 10 however with the increase of δ the upper part of the duct will cause the fluid backflow and the inflow area will increase causing an increase in resistance lateral force and lateral torque 4 motion simulation and maneuverability analysis based on the above 6 dof mathematical model and the performance estimation of the deflectable duct propeller we perform motion simulation and maneuverability analysis of the novel auv with a deflectable duct propeller firstly based on the performance estimation of the deflectable duct propeller we use an interpolation method to obtain the fluid hydrodynamic forces coefficients in simulation fig 13 shows the hydrodynamic forces coefficients interpolation surfaces with advance coefficient j and deflection angle δ secondly in order to demonstrate the 6 dof motion responses physical parameters of the novel auv with a deflectable duct propeller are classified into two subsystems table 4 shows the parameters of the auv with the deflectable duct propeller and table 5 shows the hydrodynamic parameters in order to estimate the hydrodynamic parameters of the novel auv with a deflectable duct propeller computational fluid dynamics method cfd is utilized to estimate the hydrodynamic forces for the novel auv such as drag lift and moment coefficients in various angles of attack and velocity in this paper the fluent and icem software are used for cfd analysis icem is used to discretize the flow domain onto a finite set of the control volume and fluent is used to solve the flow in the domain finally the hydrodynamic coefficients are obtained by fitting method in order to analyze the maneuverability of novel auv with the deflectable duct propeller the motion simulations are developed in present work the motion simulations examine three main aspects 2d longitudinal motions 2d lateral motions and 3d space motions 4 1 2d longitudinal motions the 2d longitudinal motions are performed by setting the rotating angle χ equal to 0 in addition the different longitudinal motions can be simulated by changing the deflection angle δ in this section we perform two mainly 2d longitudinal motions 2d motion with depth control and 2d motion with pitch angle control 4 1 1 depth control the 2d motion of depth change is performed by the pd depth control scheme the pd depth control scheme is realized by using the difference of the real depth of the novel auv and the reference depth y r e f the pitch angle of the auv and the surge of the auv the reference depth and the pd depth control scheme of the novel auv with a deflectable duct propeller are given by 28 y r e f 1 int t 100 1 4 δ k y y y r e f k θ θ k r r where k y k θ and k r are the control coefficients of the pd depth control scheme and in this present simulation k y is defined as 0 5 k θ is defined as 5 and k r is set as 2 and int is a rounding function t is the simulation time and is set as 200s in addition we simulate the 2d motion of depth change when the same auv is equipped with traditional propeller rudder control system with same pd depth control scheme and the rotating speed of the propeller is same both are 600 rpm the hydrodynamic forces coefficients of the traditional propeller rudder are c y δ h 1 453 and m z δ h 0 6496 the simulation results in fig 14 show the simulation results including the trajectory of auv the pitch angle of auv and the deflection angle of the duct fig 14 a shows that with pd depth control scheme the novel auv with a deflectable duct propeller achieves the movement of changing depth in the early stage the depth of auv has a definite fluctuation and then the depth of auv reaches the reference depth the pitch angle also illustrates this phenomenon in fig 14 b as shown in fig 14 c with pd depth control scheme the deflection angle changes when the depth of auv changes and then the forces and moments caused by the deflection angle will lead auv to navigate to the reference depth when the auv reaches the reference depth the deflection angle of the duct is equal to zero approximately in addition comparing the depth of auv with a deflectable propeller and that with a traditional propeller rudder system the auv with a deflectable propeller has a desired trajectory and has a small depth fluctuations when reference depth changes this phenomenon is also illustrated in fig 14 c so it illustrates that the novel auv with a deflectable duct propeller has a better control of 2d longitudinal motions with depth control 4 1 2 pitch angle control the 2d motion simulation with pitch angle change is also performed by the pd control scheme the pd pitch angle control scheme is depended on the difference of the real pitch angle of the novel auv and the reference pitch angle θ ref and the surge of the auv and the reference pitch angle of auv and the pd pitch angle control scheme are formulated as 29 θ r e f 5 1 int t 100 1 δ k θ θ θ r e f k r r where k θ and k r are the control coefficients of the pd control scheme of pitch angle k θ is defined as 0 7 and k r is set as 0 4 and t is the simulation time and is set as 200s and we also simulate the 2d motion with pitch angle change when the same auv is equipped with traditional propeller rudder control system with same control scheme and the rotating speed of the propeller is same both are 600 rpm fig 15 shows the trajectory the pitch angle of the auv and the deflection angle of the duct fig 15 a shows that with pd pitch angle control scheme the novel auv with a deflectable duct propeller achieves the movement changing pitch angle fig 15 b shows that in the early stage of changing pitch angle movement the pitch angle of auv have a certain fluctuation in addition although pitch angle of auv finally reaches a steady state there still is a small error between the pitch angle of auv and the reference pitch angle this is mainly due to that the pd control scheme will cause a certain steady state error which is related to the control coefficients the deflection angle of the duct during the changing pitch angle movement is shown in fig 15 c with the pd depth control scheme proposed above the deflection angle of the duct changes when the pitch angle of auv changes and it will control auv move to a state which the pitch angle of auv is approximately close the reference pitch angle and then the pitch angle of auv reaches a steady state at the same time the deflection angle of the duct is also steady in addition by comparing the pitch angle of auv with a deflectable duct propeller and that with a traditional propeller rudder system the pitch angle steady state error of auv with a deflectable duct propeller is smaller than the traditional propeller rudder system with same pd control shame in general the novel auv with a deflectable duct propeller has a better pitch angle control 4 2 2d lateral motions 2d lateral motions are performed by setting the rotating angle equal to 90 in addition the different lateral motions of novel auv can be simulated with different deflection angles of the duct in this section we performed two mainly lateral motions 1 2d lateral motions with different deflection angles of the duct without control 2 2d lateral changing yaw angle motions with pd control scheme 4 2 1 different deflection angles in order to analyze the manipulation of the novel auv with different deflection angles of the duct the deflection angles are defined as 5 10 and 15 respectively and in simulation the deflection angle of the duct remains constant without changing note that there is no control scheme to control the trajectory of the novel auv that is we simulate the natural dynamics response of novel auv with constant deflection angle of the duct in this section in addition we also simulate the natural dynamics response of same auv with a propeller rudder system the hydrodynamic forces coefficients of the traditional propeller rudder are c z δ v 1 453 and m y δ v 0 6496 and the rotating speed of the propeller is same both are 600 rpm the termination condition in simulation is that the yaw angle is equal to 500 the 2d simulation results with different deflection angles of the duct show the trajectory of novel auv and the yaw angle of auv in fig 16 as shown in fig 16 with the increase of the deflection angle the turning radius of the lateral motion decreases and the increasing rate of the yaw angle grows in order to illustrate the motion characteristics of the novel auv we define the ratio of turning radius of lateral motion r to the length of auv l as r t and table 6 shows the ratio of turning radius of lateral motion to the length of auv with different deflection angles as shown in table 3 in the present work when δ 5 the r t is 9 66 and when δ 15 the r t is 3 55 with the increase of deflection angle of the duct the lateral force grows thus the torque used to control the auv also increase which results in the decrease of r t in addition when the rudder angle is 10 the r t of the same auv with traditional propeller rudder system is 7 52 and larger than the novel auv with a deflectable duct propeller zhang r m had proposed a vectored thrust underwater vehicle and the r t is 11 08 when the vertical angle of the vectored propeller is 15 based on the above comparison the novel auv with a deflectable duct propeller proposed in this paper has a high maneuverability 4 2 2 yaw angle control the 2d lateral motions with yaw angle change are analyzed by pd yaw angle control scheme the deflection angle of the duct is obtained by pd control scheme in simulation the pd control scheme of yaw angle similar with pitch angle is depended on the difference of real yaw angle of the auv and the reference yaw angle ψ ref and the yaw of the auv therefore the reference yaw angle and the pd yaw angle control scheme are formulated as 30 ψ r e f 10 1 int t 50 1 δ k ψ ψ ψ r e f k q q where k ψ and k q are the control coefficients of the pd control scheme of yaw angle and in this present simulation k ψ is defined as 0 7 and k q is set as 0 4 and t is set as 200s similarly we also simulate the 2d motion with yaw angle change when the same auv is equipped with traditional propeller rudder control system with same control scheme and the rotating speed of the propeller is same both are 600 rpm the simulation results are shown in fig 17 it can be seen from fig 17 that the auv enters a regular motion with the yaw angle control a similar change in the yaw angle and the deflection angle is found in fig 17 b and c when the reference yaw angle changes auv changes the real yaw angle with the pd yaw angle control and at the beginning there is a fluctuation in the real yaw angle and the deflection angle of the duct in addition fig 17 b shows that the real yaw angle of the auv follows the reference yaw angle and the real yaw angle is stable and reaches the reference yaw angle in a short time by comparing the yaw angle of auv with a deflectable duct and that with traditional propeller rudder system it is obvious that the novel auv with a deflectable duct propeller has a better control about yaw angle at low rotating speed of propeller than the auv with a traditional propeller rudder system which illustrates that novel auv with a deflectable duct has a high maneuverability 4 3 3d space motions 3d motions are performed by setting the rotating angle not equal to 0 in addition different 3d motions can be simulated by changing the rotating angle and the deflection angle of the duct in this section we analyze two main 3d motions 1 3d motion with different rotating angles which are 10 20 and 30 respectively 2 3d motion with different deflection angles which are 5 10 and 15 respectively 4 3 1 different rotating angles when the deflection angle of the duct δ is fixed the components of the lateral force in the body fixed frame will change with the rotating angle thus in order to illustrate the motion characteristics of novel auv with different rotating angles we set the deflection angle of the duct as 5 and the different rotating angles are 10 20 and 30 respectively in addition the simulation time is 50s fig 18 a and b indicate that novel auv can perform the 3d spiral motion however because there is no any control scheme the center positions of 3d spiral motions when the auv reaches a stable 3d spiral motion are different when the rotating angles are different and the radius of 3d spiral motion increases with the increase of the rotating angle this is because the horizontal component of the lateral force generated from the deflectable duct reduces with the rotating angle increasing fig 18 c illustrates the sideslip angle get stable smaller than 40s in addition fig 18 d shows that the increasing rate of the yaw angle grows as rotating angle decreases 4 3 2 different deflection angles when the rotating angle is fixed the size of the lateral force will change with the deflection angle of the duct thus in order to illustrate the motion characteristics of novel auv with different deflection angles we set the rotating angle as 20 and the different deflection angles are set as 5 10 and 15 respectively in addition the simulation time is 50s similarly when the rotating angle is fixed as 20 the novel auv can perform different 3d spiral motions by changing the deflection angle of the duct shown in fig 19 because there is no any control scheme the center positions of 3d spiral motions when the auv reaches a stable state change with the deflection angle changing in addition with the deflection angle increasing the radius of 3d spiral motion will reduce in addition the sideslip angle and the increasing rate of the yaw angle will grow 5 conclusion to conclude this paper introduces a novel auv with a deflectable duct propeller and concentrates on the mathematical model and maneuverability analysis of novel auv considering the effect of the deflectable duct on the performance of the duct propeller the geometrical model of the deflectable propeller is proposed and a 6 dof motion model is built based on the newton s and euler s equation the forces and moments of the whole auv with a deflectable duct propeller are analyzed in detail and the performance of the deflectable duct propeller is estimated and analyzed by the cfd numerical computation the maneuverability of auv is analyzed by a series of simulation experiments including the 2d longitudinal motions 2d lateral motions and 3d space motions the major achievements can be summarized as follows 1 the 6 dof notion model of the novel auv with a deflectable duct propeller is proposed in this work and the performance estimation of the deflectable duct propeller is studied based on cfd method 2 the analysis results demonstrate that deflectable duct propeller can generate the lateral force and moment for controlling the auv when the duct is deflected in addition the control force and control moment are related to the deflection angle and the rotating angle 3 the motion simulations are conducted by changing the rotating angle and deflection angle of the duct and the simulation results illustrate that the ratio of turning radius of lateral motion to the length of auv is 5 03 when the deflection angle of the duct is 10 in the present work and is less than the traditional propeller rudder system which indicates that the novel auv with a deflectable duct propeller has a better 2d and 3d maneuverability than the traditional propeller rudder system 
23239,a hydroelastic study of a deformable catamaran is presented two way coupling has been implemented between a rans reynolds averaged navier stokes multiphase finite volume flow solver and a finite element method for a highly flexible hull structure the presented cases consider the hull is advancing at a constant speed in head waves different levels of stiffness are tested and deformation time series are recorded simulated motion response appears to be very sensitive to the stiffness of the hull which is responsible for a steady and unsteady structural deformation the deformable hull does not help improve vessel motions the largest deformations occur at the transom the bow and the aft part of the boat acquire a combination of permanent and dynamic deformations both of them have the same effect a variation of the effective length of the boat as a consequence of the shortening of the hull the pitch restoring moment and the heave resorting force will be reduced so there will have to be bigger heave and pitch movements to compensate similar forces keywords fluid structure interaction seakeeping cfd fully nonlinear motion simulations coupling ship hydrodynamics 1 introduction a small easy to handle and inexpensive boat capable of exploring and characterizing coastal waters is an essential tool for any laboratory dealing with coastal environmental problems mit sea grant is such a laboratory and over the years has developed a number of such platforms to carry the necessary instruments and sensors it uses to study the coastal waters of boston harbor over the years it has become evident that a catamaran boat is the preferred type of boat because such a boat provides ample deck space to house all the necessary equipment needed to study surface and subsurface up to 100m coastal processes the original sea grant catamaran boat was made using rigid hulls actually canoes about 5 years ago onr office of naval research donated to mit sea grant the boat it uses for its coastal research known as rex reef explorer fig 1 the catamaran hulls are inflatable which has proved very convenient for transportation and storage however the question arose if the inflatable hulls had an effect on the performance of the vessel in this paper we answer this question in a qualitative way setting the basis to study the trade off between optimum vessel performance and the convenient features of inflatable hulls for daily operation see fig 2 the study of large deformations in vessels with flexible inflatable hulls has not been widely developed no particular rigorous scientific evidence exists and at the authors best knowledge no studies have been published about hydroelastic behavior of highly flexible hulls particularly no study has attempted to correlate amount of hull deformation with variation in motion response for a given vessel this is the main objective of this paper research over the past few years has focused on coupling several of strip theory bem boundary element methods and rans numerical solvers to a wide range of structural solvers in references suresh et al 2016 and suresh and soares 2016 numerical results are compared with experimental tests obtaining a good agreement the hydroelastic problem is modeled using a non linear time domain method based on strip theory where the hull is modeled as a non uniform timoshenko beam reference enrico 2004 is another example of linear seakeeping analysis but with a higher focus on evaluating bending loads on the ship rather than its motion response other linear seakeeping methods have been used successfully in the study of hydro elasticity such as rankine panel methods an example of this can be found in reference kazuhiro et al 2016 which also considers the elastoplastic behavior of the floating structure rans codes have also been used in the study of hydro elasticity considering non linear and viscous effects in the motion response of ships however until quite recently there has not been an extensive validation of rans codes for motion prediction in references löhrmann et al 2014 and tahsin et al 2015 a validation of a rans code for calm water resistance and motion prediction is successfully performed an example of a rans code used to study hydro elasticity is reference lakshmynarayanana et al 2015 where a two way coupling is done between rans and a fe structural solver symmetric motion and response of flexible floating bodies in regular head waves is obtained assimilating a flexible barge to a linear elastic continuous beam however the limitation of the timoshenko beam to planar bending modes has led the way to other numerical methods in the structural modeling in reference jan et al 2011 a ship structure is modeled by a timoshenko beam modal decomposition and by a full fe model of the ship by comparing these approaches it was concluded that given the computational cost the better value was given by the modal decomposition approach because of the limitations of the timoshenko beam and the computational cost of the global fe model the above studies calculate stresses and influence in the motion response for a given hull structure and stiffness additionally there have also been studies characterizing articulated vessels some examples of the latter are given in references maysam et al mehdi mousaviraad et al 2013 and conger and anthony 2015 in this paper a urans solver is tightly coupled to a computational solid mechanics csm solver to provide the most accurate solution possible simplifications and modifications have been made to facilitate the calculations and to create a feasible problem to analyze the goal of the paper is to capture the effects of a deformable hull particularly the bow and stern deformations in the vessel s motions when it advances in regular head waves the modifications made to the original vessel are 1 the upper articulated structure has not been considered although it is expected to improve the seakeeping properties of the vessel and stabilize the central platform carrying the electronic instrumentation 2 the articulated engine pontoons are modeled as extensions of the deformable hull this is done to consider their deformation or more accurately their change of position during the pitch motion 3 the original vessel has a pair of steel structural platforms that provide support for the inflatable hull pontoons and articulated damping system this part has been considered as a rigid surface 4 the original vessel uses an inflatable hull due to easiness of storage and transportation inflatable and engine pontoons are assimilated to solid bodies with an equivalent density to obtain the total same weight the elastic properties of the material are considered to be linear with the purpose of simplifying the co simulations in fig 12 an example of the csm mesh and the result of the above simplifications is given 1 1 geometry and principal characteristics the principal characteristics of the vessel chosen for the study are the presented in table 1 the geometry used is inspired by rex the vessel currently being used at mit sea grant to carry out ocean environmental sensing 2 material properties and structure dynamics this section provides the rationale behind the choice of material properties and the process followed to improve robustness and convergence of the coupled numerical simulations the influence of the mechanical properties of the modeled structure is also discussed from a general standpoint 2 1 stiffness mass damping properties and treatment of induced accelerations motion dynamics resultant from heave and pitch movements induce accelerations in the deformable hulls these induced accelerations are considered through the superposition of the acceleration fields obtained from the simulation of the rigid hull case since only pressure and shear stress fields can be exported between the two numerical methods unfortunately the structural dynamic model becomes more prone to numerical instabilities as the structural mass decreases compared to the impact loads induced by the motions in waves low mass to force ratio is a long standing issue in fsi simulations in the marine industry jaiman et al 2009 and as such we have verified that the deformations obtained by the simplified csm solver are comparable to those obtained by an inflatable model using membrane elements results presented in fig 3 have been obtained by applying a concentrated load at the vessel s transom and recording the resulting displacements in this comparison the internal pressure of the inflatable hull has been adjusted to match the behavior of the least rigid continuous body the idea of obtaining an equivalent stiffness was first introduced and justified in reference jean christophe et al 2006 a similar thing can be said about the damping properties of the material its value needs to avoid an over damped structural dynamic response while ensuring numerical stability to the structural model so that the material stiffness can be varied in the chosen range of the parametric study a rayleigh damping matrix is used to define the damping properties in this method the damping matrix c s is proportional to the system s mass m s and stiffness k s matrices the values of the constants used are α 1000 and β 0 in a second set of simulations the constants are varied to α 500 and β 0 by defining β 0 the contribution of the stiffness matrix to the damping matrix is eliminated therefore the damping matrix remains unaffected when varying the young s modulus 1 c s α m s β k s our study focuses on vertical plane motions namely pitch and heave at constant forward speed in regular waves for this reason as almost always in naval architecture a symmetry condition is applied on the longitudinal symmetry plane of the vessel this is not the case in extreme violent motions where turbulence effects may induce asymmetries in the flow field evidence of flow asymmetry around catamaran sections undergoing periodic large amplitude oscillation in heave motion has been reported by luca and stefano 2018 but the effect of the asymmetric flow on the lateral force though not reported by the authors was really negligible 2 2 structure dynamic tests set up dynamic loading geometrically nonlinear simulations have been carried out to characterize the sensitivity of the model to the material damping density and mass properties to identify the characteristics of the uniform density model leading to the same structural response computed for the inflatable hull structure figs 3 and 4 a concentrated force has been applied at the extreme of the stern the dynamic response of one of the nodes in the proximity of the point of application has been recorded while varying systematically the material damping density and amplitude of the applied sinusoidal force the periodic force applied has the same period of the incident regular wave considered in the rest of the study during these tests the validity of linear transformations applied to the calculated displacements based on the assumed linear material properties has been verified enabling higher mass to force ratios the study regarded the following objectives 1 confirm that the dynamic response changes proportionally and in a correlated way between the cases 2 verify that differences in geometric nonlinearities are small in spite of the relative high displacements and the transformation done 3 check that the vibration frequencies and modes remain unchanged some of the results obtained are presented in fig 4 this change in properties can lead to undesired phenomena if it is improperly applied the reasons are discussed here in the simplified but fundamentally relevant example of a simple forced oscillator the vibration modes of the structure once the transformation is applied will remain the same thanks to the linear properties of the material this way the frequency response of the structure will be unvaried some additional factors need to be considered it has to be emphasized that in the system studied the forces and masses are distributed over a continuous media consequently this kind of systems have an infinite number of vibration modes the regular wave is assimilated to a sinusoidal force that is applied to a 1 dof system then a simple analogy with a 2nd order 1 dof dynamic system can help in the discussion in the following equations m c k x represent mass damping stiffness and position respectively f 0 ω ω o ϕ and t are the periodic force amplitude the force s angular frequency the natural frequency the phase difference between the resulting oscillation and the periodic force and time respectively 2 m x c x k x f 0 s i n ω t the solution to this differential equation can be divided into the sum of two parts a transient x e and a stationary x p solution the stationary solution is a function of the magnitude and the frequency of the force applied and the mechanical properties of the system the solution relevant to our problem is given below and it corresponds to the steady state solution of the system excited by a regular periodic forcing term loads induced by regular waves 3 x x e x p 4 x p f 0 k m ω 2 2 c ω 2 s i n ω t ϕ 5 t a n ϕ c ω ω 0 2 ω 2 in equation 5 an important effect of increasing the damping can be seen it will cause a delay in the response if this delay is small to start with it won t affect too much the response to increase damping it is worth remembering that it needs to be high enough to ensure the structural part of the simulation remains stable in the cases studied because the damping was small it has only been observed a 0 08 s delay this is small when compared with the 1 47 s encounter period having tested that a simple relation could be established when increasing ρ and e in the linear transformations 3 fluid dynamic model in this section a description of the fluid dynamic model is provided 3 1 governing equations for incompressible fluids where there are no body forces the averaged continuity and momentum equations are 6 ρ u i x i 0 7 ρ u i t x j ρ u i u j ρ u i u j p x i τ i j x j 8 τ i j μ u i x j u j x i where τ i j in equation 7 are the components of the averaged viscous force tensor furthermore p is the averaged pressure and u are the cartesian components of the averaged velocity in equation 7 u i u j are the reynolds stresses ρ the fluid density and μ the dynamic viscosity due to wally values of about 50 the discretization of the integral formulation of the navier stokes equations requires a turbulence model to calculate the boundary layer in naval applications the two turbulence models mainly used are k ε and k ω the model that has been used in these simulations is a combination of the two the sst k ω menter turbulence model menter 1994 this turbulence model mixes the two previous models using the k ε in areas away from the walls where the boundary layer develops and the k ω when calculating near to the walls to model the free surface star ccm uses a volume of fluid method vof hirt and nichols 1981 this model assumes that the same equations governing the physics of one of the phases can be solved for all phases present in the computational domain each cell or finite volume it assumes that these phases will have the same velocity pressure and temperature in order to simulate the behavior and to obtain realistic ship motions a dynamic fluid body interaction dfbi model is used cd adapco 2018 the ship is allowed to move in two degrees of freedom longitudinally in the vertical direction heave and to rotate around the y axis pitch 3 2 time step chosen to choose a suitable time step for the simulation it is necessary to identify constraints that depend on the data that must be obtained the monitoring of following data must be done 1 heave and pitch ship motions 2 the deformation of the hulls 3 the waves that travel on the free surface as a function of time for the heave and pitch movements the ittc recommends at least 100 time steps per period of encounter with the waves for more details on these recommendations see references tahsin et al 2015 milovan 2012 and krishna et al 2014 the period of encounter is 1 47 s so 0 0147 s is the minimum time step regarding the motions furthermore the courant number cnn on the free surface should stay below 0 1 in the worst case scenario this value reaches 0 08 without considering the numerical beach or damping zone at the end of the computational domain this is achieved with a time step of 0 00625 s continuing with the time step in the structural simulation a convergence study has been carried within abaqus in this analysis a maximum allowed time step of 3 125 10 4 s was defined the hull was submitted to a sinusoidal force which had the same time period than the period of encounter 1 47 s then the number of time steps applied was varied to measure the sensitivity of the dynamic response to a time step variation it should be said that three factors have been taken into account when selecting the maximum allowed time step size 1 the rate of variation of the applied loading in relation to this the dynamic loads were applied with a moderate dissipation to ensure stable calculations for the lower end of young s modulus tested to do a more complex and complete study the time step should be probably reduced an order of magnitude so that there are not big pressure variations between time steps 2 the complexity of the non linear damping and stiffness properties that are expected to occur during the co simulation since there is no certain way of anticipating the phenomena that will be encountered a security margin has been allowed 3 the natural period of vibration of the structure in general a maximum increment versus vibration period of the structure ratio of 1 10 is a good reference for setting an upper limit for the integration time step in the csm solver 50 time steps per encounter period have been deemed as sufficient however the coupling of the code was done to match the motion time step criteria this way the codes were coupled every 2 time steps within the urans simulation between every co simulation time step 20 time steps were done in the dynamic implicit scheme adopted in the csm solver this makes the csm solver time step 6 25 10 4 s well below the 0 0272s time step calculated in the dynamic time step convergence the coupled structural simulation was the part of the study that introduced the biggest uncertainty bigger deformations were observed if this time step was not small enough a smaller time step of 3 125 10 4 s was tested for the least rigid model resulting in practically negligible differences nevertheless the time cost of the dynamic structural simulation was relatively low compared to the urans analysis it took one only 11 of the total simulation time 3 3 fluid domain mesh generation and characterization two overlapped computational domains chimera grid are used in the urans simulation namely the background region is used to model a virtual towing tank and the overset region is destined to capture the physics in the proximity of the vessel allowing it to move freely without compromising mesh quality an hexahedral volume mesh is used and prism layers are introduced in the overset region around the hull surface boundary the sizes of the domains background region and overset region are chosen using best practice derived from previous seakeeping studies with star ccm a good example is reference tahsin et al 2015 the dimensions of the vessel and the wave are used to perform the necessary proportions the final measures for this particular case are the following being the length between perpendiculars l p p 4 21 m and the wave length λ w 2 l p p 1 length 4 λ w 8 l p p 2 width 2 4 l p p 3 depth 3 5 l p p the vessel as it can be seen in figs 5 and 6 is positioned 1 1 l p p times from the velocity inlet the hull is positioned so that the maximum distance to the symmetry plane is b m a x 2 this is done so that a symmetry condition can be applied regarding the length of water ref 2 refinement 2 5 λ w it is advised that this length is at least equal to twice the length of the largest wave simulated in the simulations overset meshes are used along with dfbi morphing floating boundary conditions are used in the overset boundaries of the overset region the morphing is used to enable the consideration of structural deformation of the hull dfbi morphing given the floating boundary conditions will deform the overset region proportionally to the structural deformations and the heave and pitch motions see fig 7 a series of volume controls have been applied to generate an unstructured grid with the necessary refinements to capture the different physical scales that characterize the problem studied these volume controls are described in fig 6 the mesh refinements in the volume controls have been defined in relation to the wave dimensions and the estimated boundary layer size these dimensions are presented in tables 2 and 3 the volume refinement regions are 1 water ref 1 the main purpose of this volume refinement is to establish continuity in the vertical dimension of the mesh while providing an expansion of the mesh in the horizontal plane this is done with the objective of creating numerical dissipation at the end of the domain before the pressure outlet the objective is to damp out the waves that enter the domain to eliminate any possible reflections in the pressure outlet that introduce perturbations in the solution 2 water ref 2 the intention of this volume control is to provide an adequate continuum for the wave to propagate uniformly with the minimum numerical dissipation possible 3 wake refinement the goal of this volume control is to capture the wake of the catamaran the surface control used is the following 1 hull the surface size control has been created to represent accurately the hull geometry moreover this enables a good quality prism layer expansion for the mesh convergence two levels of refinement have been compared for the coarse mesh case the values used in the surface refinements remain constant on the other hand in volume controls the dimensions are double the ones used in the finer mesh case the motions of the boat are obtained and compared between these two resolutions since they are the output to be compared in the study the maximum differences encountered were smaller than 5 for this reason the convergence was judged sufficient and the finer mesh has been used for all simulations presented some numerical wave dissipation was noted especially in the less refined region of the domain aft of the hull this could be corrected with an even finer mesh resolution throughout the whole domain however because the intention of this study is to provide a relative comparison and to serve as an initial proof it has been concluded that a higher level of refinement should be encouraged for further studies once the phenomena presented in this paper is deemed relevant for the particular application 3 4 boundary conditions boundary conditions have been defined according to the particularities of the problem multiple boundary conditions can be applied to this same problem without a clear argument to select a preferable way exploiting the symmetry of the problem granted by the incoming head wave condition only half symmetric hull is modeled the boundary conditions used are illustrated in fig 8 see fig 9 a numerical beach has been created in the area before the pressure outlet that is within the range of 1 5 times the wave length used 12m the purpose is to avoid numerical wave reflections from the outlet this boundary condition reduces the vertical velocity of fluid particles by applying damping to the movement in that direction the guidelines stated in reference perić and abdel maksoud 2016 have been followed to set up the induced damping 3 5 coordinate systems two reference frames are used for the computations first the problem of flow and magnitude of the resultant force over the body is calculated then forces and moments are translated to the local reference system of the ship the reference system has its origin in its center of gravity with the x axis in the fore aft direction given these resultant forces the movement of the vessel is calculated for the rigid body it is assumed that structural deformation obtained during the co simulation does not affect much the mass centroid and inertia moments of the vessel since most of this deformation occurs in the lightest part of the vessel its hull nevertheless this aspect may have to be taken into account in further studies 3 6 computational solid mechanics solver and co simulation configuration a co simulation involves a strong coupling between the two programs there are a number of different couplings that can be established between abaqus and starccm the one that is interesting for the purpose of this study is the mechanical coupling according this coupling mode the cfd solver passes fluid loads in terms of pressure and wall shear stress to the csm solver while the csm solver returns displacements to the cfd solver in the csm solver the loads exported from the cfd solver are applied to the structure and the structural response is calculated stresses and displacements the displacements exported from the csm solver are used as an input for the mesh morpher in the cfd solver the mesh morpher deforms the mesh so that the change of the hull geometry can be taken into account in the fluid dynamic computations each time step 3 7 challenges and limitations of the code coupling a successful co simulation relies on the stability and convergence properties of the individual physics solvers this means that both codes must be stable separately and the time space resolution and integration scheme needed must be similar between the two codes a trade off has to be made between sufficient accuracy and the required combined computation time for the particular case simulated a parametric study relating the stiffness and the vessel s motions has been carried out this has allowed to study the dynamic numerical stability of the model which made it difficult to simulate low stiffness cases the problem encountered with low stiffness cases has been mesh distortion and negative volumes in the csm solver caused by slamming impacts into waves that occurred along the simulation in fig 10 an example of the evolution of the deformation can be observed for a low stiffness case with mesh distortions during the evolution it can be seen how the bow deforms suddenly around the intersection point between the free surface and the bow after this sudden deformation the hull starts behaving in a way that has no relation with the applied global load this seems to suggest that a stagnation point is causing a concentrated high pressure area that is also moving rapidly in time the instantaneous pressure coefficient calculated on the hull surface can be used to comment this phenomenon better fig 11 the conclusion was what had been anticipated a large pressure concentration point was developing in the bow of the boat each time it impacted the water fig 11 presents the view from below of the hull at the time of the slamming impact the large pressure coefficient of about 4 must be noted the solution to this problem was obtained taking advantage of the linearity of the material chosen this has made possible to increase stiffness mass and damping properties and then scale the displacements again to determine the shape to be used in the fluid code assuming that differences in geometric non linearities remain small in spite of the relatively high deformations displacements calculated are smaller in relation to the size of the elements in the mesh of the structural simulation thus increasing the stability of the numerical method and lowering the high force to mass ratios consequently the probability of mesh distortion occurring due to large pressure concentrations is minimized tests have been carried out to check that any change in the response that may occur is negligible figs 3 and 4 for this specific case the equations used in the geometrically non linear structural solver are presented now the overall equilibrium equation obtained from the virtual work per reference volume is displayed below in equation 9 9 v 0 τ c δ ε d v 0 s t t δ v d s v f t δ v d v where τ c and are any conjugate pairing of material stress and strain measures moreover t represents force per unit of current area f is the force per unit of current volume and δ v is the virtual field the finite element approximation to this equilibrium is presented in equation 10 10 m n m u m i n p n 0 where m n m is the consistent mass matrix n n and n m are interpolation matrices and ρ 0 is the material s density 11 m n m v 0 ρ 0 n n n m d v 0 i n is the internal force vector β n defines the strain variation from the variation of the kinematic variables and σ is the cauchy stress matrix 12 i n v 0 β n σ d v 0 p n is the external force vector and f f ρ u these matrices and vectors are defined in the space of the nodal variables u 13 p n s n n t d s v n n f d v 3 8 fem mesh characterization to choose the element size and the local refinements for the volume mesh used in the csm solver a small convergence study was made a set of tests where different forces were applied to the hull was created the mesh size was varied and a convergence of the output results was obtained the final mesh is composed of tetrahedral elements their size varies from 0 08 m to 0 05 m and the total mesh size is approximately 80 000 elements 4 cases simulated results and discussion in the following section the conditions that have been simulated will be described the results obtained will be presented and a detailed discussion will be made in order to draw some final conclusions in the last section 4 1 simulation cases the cases that have been simulated are first a unilateral variation of the material young s modulus given a fixed advancing velocity and a regular head wave then in a second set of cases the rayleigh damping constant α of the material has been reduced to a half of its original value not all the previous cases from the first set are simulated in the second just the ones where the impact of the damping variation is the biggest the intention of this variation is to increase the amplitude of the dynamic deformation and to check whether they have a measurable effect on the simulation outputs in the first set of cases they are small compared with the permanent of deformations obtained the advance velocity chosen is 4 0 k n fn 0 32 a fifth order wave with a length of 8 42 m λ w 2 l p p and a height of 0 3 m h w λ w 0 036 is used for the study this wave has been chosen mainly because of the response it infers on the rigid boat for this given speed the properties sought in this response are two regularity and stability the response obtained can be seen in figs 13 and 14 the wave parameters have been kept constant and the mesh resolution has been adapted to this single wave condition the set of young s modulus chosen has been selected because it complies with the following statements 1 high enough values need to be tested to obtain the limit where structural deformations do not affect the vessel s movements 2 low enough values need to be tested to obtain the limit were for a given variation of stiffness the variation in structural deformations represent the non linear coupling of the simulated fluid structure interaction this would be attributed to big changes in the shape of the hull that can alter significantly the way in which it interacts with the surrounding fluid 3 also enough simulation cases need to be done to capture the transition between the two cases described previously the fluid structure interaction related to these dynamics is extremely complex it is typical of systems whose restoring forces and applied forces depend on the relative position of the system at a given time this will be studied in more detail in the next sections the simulations must not be too far apart in order to capture an expected change in trend it will be obtained comparing the displacements recorded in different parts of the hull with the young s modulus corresponding to each case a minimum distance between cases will be required to capture it the set of young s modulus that were found to satisfy the conditions stated above is presented in table 4 4 2 results the main results obtained for each simulated case are the following 1 wave cut records a wave cut at the end of each simulation in the undisturbed zone of the domain near the lateral symmetry planes this way it can be checked that the numeric dissipation remains constant an example of a wave cut obtained during the mesh convergence is given in fig 15 2 pitch time series monitors the angular displacement around the y axis in the coordinate system chosen 3 heave time series monitors the longitudinal translation along the z axis in the coordinate system chosen 4 maximum nodal displacement per zone given a series of local areas of interest on the structure the maximum nodal displacement is recorded in each of them for each time step the local areas can be seen in fig 16 5 pitch angular acceleration time series monitors the angular acceleration around the y axis in the chosen coordinate system pitch and heave accelerations are used to impose loads on the structure due to the vessel s movements 6 heave displacement acceleration time series monitor the longitudinal acceleration along the z axis in the coordinate system chosen to analyze that the results obtained and to make it easier to interpret them a series of variables are defined from the recorded data to understand the logic followed in the analysis careful attention must be paid to fig 17 in this figure the maximum nodal displacement time series of a local area around the stern zone code 5 in fig 16 and for a particular case is presented from these maximum displacements at this particular the area it can be seen that a certain permanent deformation is acquired then oscillations around this permanent deformation occur the deformations in the aft part of the vessel will be analyzed first because they are believed to have the biggest influence on the change of behavior at least for the first set of simulations this is because the center of gravity is in the aft part of the boat which is also the section where the biggest deformations are recorded maximum deformations are also analysed in the bow area the permanent deformation and the amplitudes of the oscillations are key to understanding why and how the behavior of the boat changes when the material stiffness is varied to calculate them the local maximums and minimums of the dynamic response are averaged as it can be seen in fig 17 the average values provide a good reference to compare between different simulations although these oscillations are not completely regular two sets of four graphs given in figs 18 and 19 are used to analyze the displacements in the stern and bow area zone codes 5 and 1 in fig 16 respectively each of these figures contains four graphs in the first graph the amplitudes obtained from the averaged local maximums and minimums are plotted as a function of the material stiffness in the second graph the heave and pitch time responses are compared with the ones obtained from the case where the hull is rigid for each case the maximum difference is calculated the objective of this particular graph is to see how the amplitudes of the boat s movements variate given the change in stiffness and the change in the hull shape that is related to it in the third graph the reference displacement that results from permanent deformations is plotted as a function the corresponding young s modulus simulated this reference displacement can be considered as the origin for the dynamic oscillations last but not least in the fourth graph the values from the third and first graph are added to obtain the overall maximum displacements for each simulation it is also interesting to compare in a plot the heave and pitch time responses since it is the actual output that the boat generates when it is excited by the wave a superposition of these time responses is presented in fig 22 4 3 discussion in this section a detailed analysis and engineering interpretation of the results is provided 4 3 1 deformation at the aft part and its influence in the vessel s response let s start by analyzing the data in the first graph of fig 18 if we observe the higher end of young s modulus values it can be seen that the mean displacement amplitudes follow a linear trend in the same way if we observe the plot below we can see that the motions of the boat are not changing much if we take as a reference the motions of the rigid hull this means that deformations in these initial cases where the hull is fairly rigid is not affecting much the motions of the vessel consequently it is reasonable to think that the loads on the hulls are not varying much however if one thinks about the environment modeled the last thing to expect here is a linear correlation the true nature of the problem can be seen when lower values of the young s modulus are simulated in the simulations the interaction with the water cannot be said to be linear for many reasons to cut it short the reason is that restoring forces and moments are not proportional to displacements and damping forces are not proportional to the velocity this can be particularized for this specific case in the following statements 1 the added masses variate throughout the large motions 2 the forces applied to the hull variate during the impact and also because of the structure deformation 3 forces derived from viscous effects which are already non linear also have to interact with other nonlinearities like the changing structural deformation 4 the restoring forces for the heave and the pitch motions vary due to large displacements and change of shape of the hull having analyzed the 7 stiffer cases e 16 10 6 40 10 6 pa now it is time to analyze the first 4 e 4 10 6 12 10 6 pa cases simulated it can be said that these simulations are characterized by big displacements in relation to the size of the boat analyzed a perceptible change in the manner the vessel reacts to the incoming waves is detected this is attributed to the significant change of shape of the hull one of the situations where these deformations are biggest is presented in fig 20 the nodal displacements are plotted with a color code on the surface of the hull in meters this is done to provide a convenient representation fig 20 is going to be analyzed to understand better the dynamics of the motion in the first picture the boat is coming up the wave in the second picture the wave impact on the bow provides a counter clockwise moment that is compensated with the submergence of the aft part of the boat this creates higher buoyancy forces than usual at the stern which deforms upwards to account for the additional vertical buoyancy and froude krylov forces it should be reminded that if the hull were to rest on calm water because the weight of the structure can t compensate the static buoyancy forces it would have a permanent deformation this initial deformation is in a first approximation represented in fig 17 as the reference value considered as the origin for the dynamic oscillations in the second picture of fig 20 the bow is impacting the water surface this case is the opposite of the previously described the bow submerges and deforms upwards because of the increase in vertical forces derived from the impact with the incoming waves the buoyancy and froude krylov forces continuing with the analysis of the first 4 cases if we observe the lower end of the young s modulus values in the first graph of fig 18 a reduction of this variable leads to another reduction in the amplitude of the dynamic oscillations this at first sight may not be expected but if we consider the permanent deformations that the structure is experiencing it can be seen as quite reasonable the fact is the hydrostatic forces are bending the hull tips upwards when the young s modulus is reduced this causes the fore and aft ends of the hulls to initially bend because they cannot compensate the hydrostatic forces with their own weight as a result the way in which the hydrodynamic loads are applied changes if we then imagine the boat pitching or heaving because the tips are bent upwards the submerged part per unit of displacement due to the motions is smaller and thus the applied loads decrease the magnitude of the motions increases due to smaller restoring forces this increase in the magnitude of the motions is recorded through the second graph of figs 18 and 19 the reason for this can be found in the relation between the variation of the shape of the hull and variation of the applied force by the fluid so if structural deformations are so big that it causes a big enough change in the way fluid force is applied the restoring force in the structure may also change the way in which it reacts this gives way to a change in trend between the relation of these forces the change in the relation between these forces causes the change of trend seen in the first graph of fig 18 for at simulated stiffness of 6 10 6 pa additionally the large motions observed induce slamming impact pressures and loads and this enhances the non linear behavior of the vessel s responses continuing the analysis in the third graph of fig 18 the reference displacement considered as the origin for the dynamic oscillations is plotted as a function of the young s modulus in the same way as explained in the previous case starting with the 7 stiffer values e 16 10 6 40 10 6 pa the response of the boat to the incoming wave doesn t change significantly then the loads on the hull can be considered in a first approximation constant simplifying again the nodal displacements can be expressed as u k 1 f where u are the nodal displacements k the stiffness matrix of the structure and f is the equivalent nodal loads because k depends linearly on e it is reasonable to think that this data ought to be approximated easily by a function of the form a e b where a can be related to the equivalent load applied and b should be equal to 1 as it can be seen in fig 21 the results obtained from matlab s curve fitting tool agree with the expected results given the assumptions made if we go now a step further and try to correlate displacements with the change in response the following conclusions are obtained in this stage the first and third graphs of fig 18 are compared with the second graph in the second graph a big change both in heave and pitch response can be seen for the three lowest young s modulus simulated e 4 10 6 8 10 6 pa analyzing this same set of young s modulus in the first graph it can be seen that these values represent the change in the trend of the dynamic deformations this means that the permanent deformation represented by the reference displacement in the analysis are already big enough to change significantly the way in which the fluid forces are applied to the structure consequently the structure starts responding in a different manner having seen this it can then be said that there is a joint point of change of behavior of the structure and hydrodynamic interaction so it can be concluded that a correlation has been obtained between the structural deformations and the change of hydrodynamic response of the vessel in fig 22 several time series of heave and pitch responses are presented it can be seen how for the first variations of young s modulus the difference in the time responses don t change much especially in heave and the general trend can be appreciated the maximum values for the pitch time response tend to increase and the minimum values also tend to increase this can be seen as a consequence of a reduction of pitch restoring moment and an increase in the static trim position in the heave response a similar trend can be appreciated the main difference is that maximum and minimum values of the heave response change equally as the reference position does not change see fig 23 now the deformations obtained in the second set of simulations is going to be analyzed in these simulations the damping constant has been reduced to a half of its original value consequently an increase in the amplitudes of the dynamic oscillations is recorded the aim of this variation is to increase the relation of the dynamic displacements in relation to the permanent ones the reason for this is to see if there is a direct relation with the total deformation and the change in behavior previously encountered only an increase in dynamic deformations is expected since the permanent deformations are directly related to the static equilibrium the expected outcomes are the following 1 if the previous hypothesis is true then the change in pitch and heave time response will be bigger throughout all the simulations 2 additionally and more importantly the reduction in the amplitude of the oscillations should start with a bigger young s modulus this is because the bigger overall displacements will lead to a sooner change in the way forces are applied and consequently the way in which the structure reacts in the fourth graph of fig 18 it can be seen how the overall registered displacements are bigger compared to the first set of simulations if we check the second graph of fig 18 it can also be seen how the differences increase earlier and with the same trend as in the first set of simulations the reference displacements do not change significantly since that component of the equilibrium as expected should not have an important variation finally if we check the first graph of the same figure the amplitudes of the dynamic displacements start to decrease one simulation later 8 10 6 pa than in the first set of cases so overall the variation in the results fit in the predictions made 4 3 2 deformation at the bow and its influence in the vessel s response having laid out the main findings we continue the analysis regarding the deformations registered at the bows for both first and second set of simulations carried out if the higher end of young s modulus simulated values is observed e 16 10 6 40 10 6 pa in the first graph of fig 19 a somewhat similar trend to the one fitted in fig 21 can be seen however for the same reasons as the ones commented when the deformations at the stern were discussed this variation in displacements cannot be resemblant along the whole set of simulations if the lower end of the young s modulus simulated values is observed e 4 10 6 12 10 6 pa no clear trend can be distinguished it can be expected that the slamming dynamics should have a big influence on this deformation so having said this further studies will be needed to analyze and quantify this in a better way if the lower end of the simulated young s modulus e 4 10 6 12 10 6 pa is observed the trend that has been seen when analyzing the displacements of the aft part of the vessel is not resembled this is because the combination of forces applied to the bow of the vessel is very different these forces in both cases are a combination of buoyancy forces impact and slamming forces due to the sudden changes of orientation and position however the impact and slamming forces are much larger in the bow than at the aft part this way the different manner of change of behavior may be due to the different phenomena encountered it is not straightforward to correlate the change in behavior through the pitch and heave time series with the deformation in the bow it is quite possible that the bigger aft deformations because of bigger loads are overshadowing any effect obtained from the deforming bow anyway to explain what effects we might encounter a series of renders are presented in these renders the bow has very big deformations and the effects that they may have in the behavior of the boat may be inferred from them to describe briefly the succession of renders the following particularities of the different stages of the bow dynamics can be highlighted first just before coming down the wave the bow has a negligible deformation and therefore the obtained displacements are very small once the bow starts submerging the impact slamming and additional buoyancy forces create an increasing deformation this deformation reaches its maximum value near the point of maximum submergence when the vessel returns to the zero trim level deformations in the bow are still pretty much the same as a few instances ago and only decrease significantly once the bow is well out of the water so the conclusion to this brief description would be persistent bow deformations occur throughout the emergence phase of the motion the next question to ask is how these deformations can affect the motions and if there is just one single way to cut it short the change in curvature of the bow is the main result of the deformation additionally given that the vessel is not nose diving in this particular situation a change in orientation towards the incoming fluid will take place this change in relative orientation is prone to increase the resultant forces on the hull and if we add the two a change in the trajectory of the out coming bow is expected to be encountered the trajectory can be approximated at first as tangential to the bow this way the vertical induced acceleration is bigger and thus the pitch should be bigger this would add to the reduction of pitch restoring moment and contribute towards the increase of pitch motion response for the cases simulated and their particular conditions these results in a more violent emergence of the bow so in synthesis the bow submerges further because of the decrease in heave and pitch restoring forces and moments and then it emerges more violently due to the increase of forces applied to the bow and its change of shape this last effect translates into a more pronounced emergence trajectory all these deformations modify actively the pitch restoring moment and in less magnitude the heave restoring moment since the recorded deformation of this part of the hull is not as big as the deformation of the stern these deformations are added to the initial deformation which is again smaller since this part of the hull is not permanently submerged although the modeling of the motions of this part of the hull is more complex the overall effect on the vessels motions is smaller because the main cause of deformations is hydrostatic and froude krylov forces which are smaller in this particular part ending this detailed analysis the systematic fully coupled fluid structure interaction simulation results allow for some inter conclusions the relation between the reference displacement of the dynamic oscillations and the mean amplitudes should be highlighted as it can be obtained from fig 18 the dynamic oscillations are always smaller than the permanent deformation in fact if the biggest values of both variables are compared it can be seen that the maximum reference displacement are two times the height of the maximum dynamic oscillation this can explain in a way the reason why the second graph of fig 18 correlates better with the third than with the first to put it simply the type of deformation that provides the biggest change in shape has the biggest weight in the change in response this relation is particular to the case analyzed the relation between these displacements will vary if the material properties are changed adequately and consequently the impact in the way the boat reacts to the waves will be different as it can be seen in the second set of simulations 5 conclusions the purpose of the following lines is to summarize the change in the behavior of the vessel analyzed and to establish a trade off between optimum vessel performance and the convenient features of inflatable hulls for daily operation as commented in the previous paragraph the deformations expected can be of two types 1 permanent due to hydrostatic forces 2 dynamic due to forces derived from the impacts with the waves radiation restoring diffraction and froude krylov forces the bow and the aft part of the boat acquire a combination of vertical displacements a permanent one and a dynamic one nevertheless both of them have the same effect a variation of the effective length of the boat which will have large overhangs if the main the resultant displacement is in the positive vertical direction this is the particular final outcome as a consequence of the shortening of the hull the pitch restoring moment and the heave resorting force will be reduced so it is expected that there will have to be bigger movements to compensate similar forces finally what trade off should be established between optimum vessel performance and the convenient features for the daily operation of the inflatable hull as the last graph in fig 18 shows once hull displacements go beyond 2 5 of l p p a significant change of behavior is recorded consistently on the other hand if the pressure inside the hull makes it stiff enough then the convenient features for daily operation will outweigh any possible small changes in the behavior of the vessel acknowledgements this work was sponsored by the technical university of madrid through a scholarship program and by mit n00014 16 1 2956 sea grant 
23239,a hydroelastic study of a deformable catamaran is presented two way coupling has been implemented between a rans reynolds averaged navier stokes multiphase finite volume flow solver and a finite element method for a highly flexible hull structure the presented cases consider the hull is advancing at a constant speed in head waves different levels of stiffness are tested and deformation time series are recorded simulated motion response appears to be very sensitive to the stiffness of the hull which is responsible for a steady and unsteady structural deformation the deformable hull does not help improve vessel motions the largest deformations occur at the transom the bow and the aft part of the boat acquire a combination of permanent and dynamic deformations both of them have the same effect a variation of the effective length of the boat as a consequence of the shortening of the hull the pitch restoring moment and the heave resorting force will be reduced so there will have to be bigger heave and pitch movements to compensate similar forces keywords fluid structure interaction seakeeping cfd fully nonlinear motion simulations coupling ship hydrodynamics 1 introduction a small easy to handle and inexpensive boat capable of exploring and characterizing coastal waters is an essential tool for any laboratory dealing with coastal environmental problems mit sea grant is such a laboratory and over the years has developed a number of such platforms to carry the necessary instruments and sensors it uses to study the coastal waters of boston harbor over the years it has become evident that a catamaran boat is the preferred type of boat because such a boat provides ample deck space to house all the necessary equipment needed to study surface and subsurface up to 100m coastal processes the original sea grant catamaran boat was made using rigid hulls actually canoes about 5 years ago onr office of naval research donated to mit sea grant the boat it uses for its coastal research known as rex reef explorer fig 1 the catamaran hulls are inflatable which has proved very convenient for transportation and storage however the question arose if the inflatable hulls had an effect on the performance of the vessel in this paper we answer this question in a qualitative way setting the basis to study the trade off between optimum vessel performance and the convenient features of inflatable hulls for daily operation see fig 2 the study of large deformations in vessels with flexible inflatable hulls has not been widely developed no particular rigorous scientific evidence exists and at the authors best knowledge no studies have been published about hydroelastic behavior of highly flexible hulls particularly no study has attempted to correlate amount of hull deformation with variation in motion response for a given vessel this is the main objective of this paper research over the past few years has focused on coupling several of strip theory bem boundary element methods and rans numerical solvers to a wide range of structural solvers in references suresh et al 2016 and suresh and soares 2016 numerical results are compared with experimental tests obtaining a good agreement the hydroelastic problem is modeled using a non linear time domain method based on strip theory where the hull is modeled as a non uniform timoshenko beam reference enrico 2004 is another example of linear seakeeping analysis but with a higher focus on evaluating bending loads on the ship rather than its motion response other linear seakeeping methods have been used successfully in the study of hydro elasticity such as rankine panel methods an example of this can be found in reference kazuhiro et al 2016 which also considers the elastoplastic behavior of the floating structure rans codes have also been used in the study of hydro elasticity considering non linear and viscous effects in the motion response of ships however until quite recently there has not been an extensive validation of rans codes for motion prediction in references löhrmann et al 2014 and tahsin et al 2015 a validation of a rans code for calm water resistance and motion prediction is successfully performed an example of a rans code used to study hydro elasticity is reference lakshmynarayanana et al 2015 where a two way coupling is done between rans and a fe structural solver symmetric motion and response of flexible floating bodies in regular head waves is obtained assimilating a flexible barge to a linear elastic continuous beam however the limitation of the timoshenko beam to planar bending modes has led the way to other numerical methods in the structural modeling in reference jan et al 2011 a ship structure is modeled by a timoshenko beam modal decomposition and by a full fe model of the ship by comparing these approaches it was concluded that given the computational cost the better value was given by the modal decomposition approach because of the limitations of the timoshenko beam and the computational cost of the global fe model the above studies calculate stresses and influence in the motion response for a given hull structure and stiffness additionally there have also been studies characterizing articulated vessels some examples of the latter are given in references maysam et al mehdi mousaviraad et al 2013 and conger and anthony 2015 in this paper a urans solver is tightly coupled to a computational solid mechanics csm solver to provide the most accurate solution possible simplifications and modifications have been made to facilitate the calculations and to create a feasible problem to analyze the goal of the paper is to capture the effects of a deformable hull particularly the bow and stern deformations in the vessel s motions when it advances in regular head waves the modifications made to the original vessel are 1 the upper articulated structure has not been considered although it is expected to improve the seakeeping properties of the vessel and stabilize the central platform carrying the electronic instrumentation 2 the articulated engine pontoons are modeled as extensions of the deformable hull this is done to consider their deformation or more accurately their change of position during the pitch motion 3 the original vessel has a pair of steel structural platforms that provide support for the inflatable hull pontoons and articulated damping system this part has been considered as a rigid surface 4 the original vessel uses an inflatable hull due to easiness of storage and transportation inflatable and engine pontoons are assimilated to solid bodies with an equivalent density to obtain the total same weight the elastic properties of the material are considered to be linear with the purpose of simplifying the co simulations in fig 12 an example of the csm mesh and the result of the above simplifications is given 1 1 geometry and principal characteristics the principal characteristics of the vessel chosen for the study are the presented in table 1 the geometry used is inspired by rex the vessel currently being used at mit sea grant to carry out ocean environmental sensing 2 material properties and structure dynamics this section provides the rationale behind the choice of material properties and the process followed to improve robustness and convergence of the coupled numerical simulations the influence of the mechanical properties of the modeled structure is also discussed from a general standpoint 2 1 stiffness mass damping properties and treatment of induced accelerations motion dynamics resultant from heave and pitch movements induce accelerations in the deformable hulls these induced accelerations are considered through the superposition of the acceleration fields obtained from the simulation of the rigid hull case since only pressure and shear stress fields can be exported between the two numerical methods unfortunately the structural dynamic model becomes more prone to numerical instabilities as the structural mass decreases compared to the impact loads induced by the motions in waves low mass to force ratio is a long standing issue in fsi simulations in the marine industry jaiman et al 2009 and as such we have verified that the deformations obtained by the simplified csm solver are comparable to those obtained by an inflatable model using membrane elements results presented in fig 3 have been obtained by applying a concentrated load at the vessel s transom and recording the resulting displacements in this comparison the internal pressure of the inflatable hull has been adjusted to match the behavior of the least rigid continuous body the idea of obtaining an equivalent stiffness was first introduced and justified in reference jean christophe et al 2006 a similar thing can be said about the damping properties of the material its value needs to avoid an over damped structural dynamic response while ensuring numerical stability to the structural model so that the material stiffness can be varied in the chosen range of the parametric study a rayleigh damping matrix is used to define the damping properties in this method the damping matrix c s is proportional to the system s mass m s and stiffness k s matrices the values of the constants used are α 1000 and β 0 in a second set of simulations the constants are varied to α 500 and β 0 by defining β 0 the contribution of the stiffness matrix to the damping matrix is eliminated therefore the damping matrix remains unaffected when varying the young s modulus 1 c s α m s β k s our study focuses on vertical plane motions namely pitch and heave at constant forward speed in regular waves for this reason as almost always in naval architecture a symmetry condition is applied on the longitudinal symmetry plane of the vessel this is not the case in extreme violent motions where turbulence effects may induce asymmetries in the flow field evidence of flow asymmetry around catamaran sections undergoing periodic large amplitude oscillation in heave motion has been reported by luca and stefano 2018 but the effect of the asymmetric flow on the lateral force though not reported by the authors was really negligible 2 2 structure dynamic tests set up dynamic loading geometrically nonlinear simulations have been carried out to characterize the sensitivity of the model to the material damping density and mass properties to identify the characteristics of the uniform density model leading to the same structural response computed for the inflatable hull structure figs 3 and 4 a concentrated force has been applied at the extreme of the stern the dynamic response of one of the nodes in the proximity of the point of application has been recorded while varying systematically the material damping density and amplitude of the applied sinusoidal force the periodic force applied has the same period of the incident regular wave considered in the rest of the study during these tests the validity of linear transformations applied to the calculated displacements based on the assumed linear material properties has been verified enabling higher mass to force ratios the study regarded the following objectives 1 confirm that the dynamic response changes proportionally and in a correlated way between the cases 2 verify that differences in geometric nonlinearities are small in spite of the relative high displacements and the transformation done 3 check that the vibration frequencies and modes remain unchanged some of the results obtained are presented in fig 4 this change in properties can lead to undesired phenomena if it is improperly applied the reasons are discussed here in the simplified but fundamentally relevant example of a simple forced oscillator the vibration modes of the structure once the transformation is applied will remain the same thanks to the linear properties of the material this way the frequency response of the structure will be unvaried some additional factors need to be considered it has to be emphasized that in the system studied the forces and masses are distributed over a continuous media consequently this kind of systems have an infinite number of vibration modes the regular wave is assimilated to a sinusoidal force that is applied to a 1 dof system then a simple analogy with a 2nd order 1 dof dynamic system can help in the discussion in the following equations m c k x represent mass damping stiffness and position respectively f 0 ω ω o ϕ and t are the periodic force amplitude the force s angular frequency the natural frequency the phase difference between the resulting oscillation and the periodic force and time respectively 2 m x c x k x f 0 s i n ω t the solution to this differential equation can be divided into the sum of two parts a transient x e and a stationary x p solution the stationary solution is a function of the magnitude and the frequency of the force applied and the mechanical properties of the system the solution relevant to our problem is given below and it corresponds to the steady state solution of the system excited by a regular periodic forcing term loads induced by regular waves 3 x x e x p 4 x p f 0 k m ω 2 2 c ω 2 s i n ω t ϕ 5 t a n ϕ c ω ω 0 2 ω 2 in equation 5 an important effect of increasing the damping can be seen it will cause a delay in the response if this delay is small to start with it won t affect too much the response to increase damping it is worth remembering that it needs to be high enough to ensure the structural part of the simulation remains stable in the cases studied because the damping was small it has only been observed a 0 08 s delay this is small when compared with the 1 47 s encounter period having tested that a simple relation could be established when increasing ρ and e in the linear transformations 3 fluid dynamic model in this section a description of the fluid dynamic model is provided 3 1 governing equations for incompressible fluids where there are no body forces the averaged continuity and momentum equations are 6 ρ u i x i 0 7 ρ u i t x j ρ u i u j ρ u i u j p x i τ i j x j 8 τ i j μ u i x j u j x i where τ i j in equation 7 are the components of the averaged viscous force tensor furthermore p is the averaged pressure and u are the cartesian components of the averaged velocity in equation 7 u i u j are the reynolds stresses ρ the fluid density and μ the dynamic viscosity due to wally values of about 50 the discretization of the integral formulation of the navier stokes equations requires a turbulence model to calculate the boundary layer in naval applications the two turbulence models mainly used are k ε and k ω the model that has been used in these simulations is a combination of the two the sst k ω menter turbulence model menter 1994 this turbulence model mixes the two previous models using the k ε in areas away from the walls where the boundary layer develops and the k ω when calculating near to the walls to model the free surface star ccm uses a volume of fluid method vof hirt and nichols 1981 this model assumes that the same equations governing the physics of one of the phases can be solved for all phases present in the computational domain each cell or finite volume it assumes that these phases will have the same velocity pressure and temperature in order to simulate the behavior and to obtain realistic ship motions a dynamic fluid body interaction dfbi model is used cd adapco 2018 the ship is allowed to move in two degrees of freedom longitudinally in the vertical direction heave and to rotate around the y axis pitch 3 2 time step chosen to choose a suitable time step for the simulation it is necessary to identify constraints that depend on the data that must be obtained the monitoring of following data must be done 1 heave and pitch ship motions 2 the deformation of the hulls 3 the waves that travel on the free surface as a function of time for the heave and pitch movements the ittc recommends at least 100 time steps per period of encounter with the waves for more details on these recommendations see references tahsin et al 2015 milovan 2012 and krishna et al 2014 the period of encounter is 1 47 s so 0 0147 s is the minimum time step regarding the motions furthermore the courant number cnn on the free surface should stay below 0 1 in the worst case scenario this value reaches 0 08 without considering the numerical beach or damping zone at the end of the computational domain this is achieved with a time step of 0 00625 s continuing with the time step in the structural simulation a convergence study has been carried within abaqus in this analysis a maximum allowed time step of 3 125 10 4 s was defined the hull was submitted to a sinusoidal force which had the same time period than the period of encounter 1 47 s then the number of time steps applied was varied to measure the sensitivity of the dynamic response to a time step variation it should be said that three factors have been taken into account when selecting the maximum allowed time step size 1 the rate of variation of the applied loading in relation to this the dynamic loads were applied with a moderate dissipation to ensure stable calculations for the lower end of young s modulus tested to do a more complex and complete study the time step should be probably reduced an order of magnitude so that there are not big pressure variations between time steps 2 the complexity of the non linear damping and stiffness properties that are expected to occur during the co simulation since there is no certain way of anticipating the phenomena that will be encountered a security margin has been allowed 3 the natural period of vibration of the structure in general a maximum increment versus vibration period of the structure ratio of 1 10 is a good reference for setting an upper limit for the integration time step in the csm solver 50 time steps per encounter period have been deemed as sufficient however the coupling of the code was done to match the motion time step criteria this way the codes were coupled every 2 time steps within the urans simulation between every co simulation time step 20 time steps were done in the dynamic implicit scheme adopted in the csm solver this makes the csm solver time step 6 25 10 4 s well below the 0 0272s time step calculated in the dynamic time step convergence the coupled structural simulation was the part of the study that introduced the biggest uncertainty bigger deformations were observed if this time step was not small enough a smaller time step of 3 125 10 4 s was tested for the least rigid model resulting in practically negligible differences nevertheless the time cost of the dynamic structural simulation was relatively low compared to the urans analysis it took one only 11 of the total simulation time 3 3 fluid domain mesh generation and characterization two overlapped computational domains chimera grid are used in the urans simulation namely the background region is used to model a virtual towing tank and the overset region is destined to capture the physics in the proximity of the vessel allowing it to move freely without compromising mesh quality an hexahedral volume mesh is used and prism layers are introduced in the overset region around the hull surface boundary the sizes of the domains background region and overset region are chosen using best practice derived from previous seakeeping studies with star ccm a good example is reference tahsin et al 2015 the dimensions of the vessel and the wave are used to perform the necessary proportions the final measures for this particular case are the following being the length between perpendiculars l p p 4 21 m and the wave length λ w 2 l p p 1 length 4 λ w 8 l p p 2 width 2 4 l p p 3 depth 3 5 l p p the vessel as it can be seen in figs 5 and 6 is positioned 1 1 l p p times from the velocity inlet the hull is positioned so that the maximum distance to the symmetry plane is b m a x 2 this is done so that a symmetry condition can be applied regarding the length of water ref 2 refinement 2 5 λ w it is advised that this length is at least equal to twice the length of the largest wave simulated in the simulations overset meshes are used along with dfbi morphing floating boundary conditions are used in the overset boundaries of the overset region the morphing is used to enable the consideration of structural deformation of the hull dfbi morphing given the floating boundary conditions will deform the overset region proportionally to the structural deformations and the heave and pitch motions see fig 7 a series of volume controls have been applied to generate an unstructured grid with the necessary refinements to capture the different physical scales that characterize the problem studied these volume controls are described in fig 6 the mesh refinements in the volume controls have been defined in relation to the wave dimensions and the estimated boundary layer size these dimensions are presented in tables 2 and 3 the volume refinement regions are 1 water ref 1 the main purpose of this volume refinement is to establish continuity in the vertical dimension of the mesh while providing an expansion of the mesh in the horizontal plane this is done with the objective of creating numerical dissipation at the end of the domain before the pressure outlet the objective is to damp out the waves that enter the domain to eliminate any possible reflections in the pressure outlet that introduce perturbations in the solution 2 water ref 2 the intention of this volume control is to provide an adequate continuum for the wave to propagate uniformly with the minimum numerical dissipation possible 3 wake refinement the goal of this volume control is to capture the wake of the catamaran the surface control used is the following 1 hull the surface size control has been created to represent accurately the hull geometry moreover this enables a good quality prism layer expansion for the mesh convergence two levels of refinement have been compared for the coarse mesh case the values used in the surface refinements remain constant on the other hand in volume controls the dimensions are double the ones used in the finer mesh case the motions of the boat are obtained and compared between these two resolutions since they are the output to be compared in the study the maximum differences encountered were smaller than 5 for this reason the convergence was judged sufficient and the finer mesh has been used for all simulations presented some numerical wave dissipation was noted especially in the less refined region of the domain aft of the hull this could be corrected with an even finer mesh resolution throughout the whole domain however because the intention of this study is to provide a relative comparison and to serve as an initial proof it has been concluded that a higher level of refinement should be encouraged for further studies once the phenomena presented in this paper is deemed relevant for the particular application 3 4 boundary conditions boundary conditions have been defined according to the particularities of the problem multiple boundary conditions can be applied to this same problem without a clear argument to select a preferable way exploiting the symmetry of the problem granted by the incoming head wave condition only half symmetric hull is modeled the boundary conditions used are illustrated in fig 8 see fig 9 a numerical beach has been created in the area before the pressure outlet that is within the range of 1 5 times the wave length used 12m the purpose is to avoid numerical wave reflections from the outlet this boundary condition reduces the vertical velocity of fluid particles by applying damping to the movement in that direction the guidelines stated in reference perić and abdel maksoud 2016 have been followed to set up the induced damping 3 5 coordinate systems two reference frames are used for the computations first the problem of flow and magnitude of the resultant force over the body is calculated then forces and moments are translated to the local reference system of the ship the reference system has its origin in its center of gravity with the x axis in the fore aft direction given these resultant forces the movement of the vessel is calculated for the rigid body it is assumed that structural deformation obtained during the co simulation does not affect much the mass centroid and inertia moments of the vessel since most of this deformation occurs in the lightest part of the vessel its hull nevertheless this aspect may have to be taken into account in further studies 3 6 computational solid mechanics solver and co simulation configuration a co simulation involves a strong coupling between the two programs there are a number of different couplings that can be established between abaqus and starccm the one that is interesting for the purpose of this study is the mechanical coupling according this coupling mode the cfd solver passes fluid loads in terms of pressure and wall shear stress to the csm solver while the csm solver returns displacements to the cfd solver in the csm solver the loads exported from the cfd solver are applied to the structure and the structural response is calculated stresses and displacements the displacements exported from the csm solver are used as an input for the mesh morpher in the cfd solver the mesh morpher deforms the mesh so that the change of the hull geometry can be taken into account in the fluid dynamic computations each time step 3 7 challenges and limitations of the code coupling a successful co simulation relies on the stability and convergence properties of the individual physics solvers this means that both codes must be stable separately and the time space resolution and integration scheme needed must be similar between the two codes a trade off has to be made between sufficient accuracy and the required combined computation time for the particular case simulated a parametric study relating the stiffness and the vessel s motions has been carried out this has allowed to study the dynamic numerical stability of the model which made it difficult to simulate low stiffness cases the problem encountered with low stiffness cases has been mesh distortion and negative volumes in the csm solver caused by slamming impacts into waves that occurred along the simulation in fig 10 an example of the evolution of the deformation can be observed for a low stiffness case with mesh distortions during the evolution it can be seen how the bow deforms suddenly around the intersection point between the free surface and the bow after this sudden deformation the hull starts behaving in a way that has no relation with the applied global load this seems to suggest that a stagnation point is causing a concentrated high pressure area that is also moving rapidly in time the instantaneous pressure coefficient calculated on the hull surface can be used to comment this phenomenon better fig 11 the conclusion was what had been anticipated a large pressure concentration point was developing in the bow of the boat each time it impacted the water fig 11 presents the view from below of the hull at the time of the slamming impact the large pressure coefficient of about 4 must be noted the solution to this problem was obtained taking advantage of the linearity of the material chosen this has made possible to increase stiffness mass and damping properties and then scale the displacements again to determine the shape to be used in the fluid code assuming that differences in geometric non linearities remain small in spite of the relatively high deformations displacements calculated are smaller in relation to the size of the elements in the mesh of the structural simulation thus increasing the stability of the numerical method and lowering the high force to mass ratios consequently the probability of mesh distortion occurring due to large pressure concentrations is minimized tests have been carried out to check that any change in the response that may occur is negligible figs 3 and 4 for this specific case the equations used in the geometrically non linear structural solver are presented now the overall equilibrium equation obtained from the virtual work per reference volume is displayed below in equation 9 9 v 0 τ c δ ε d v 0 s t t δ v d s v f t δ v d v where τ c and are any conjugate pairing of material stress and strain measures moreover t represents force per unit of current area f is the force per unit of current volume and δ v is the virtual field the finite element approximation to this equilibrium is presented in equation 10 10 m n m u m i n p n 0 where m n m is the consistent mass matrix n n and n m are interpolation matrices and ρ 0 is the material s density 11 m n m v 0 ρ 0 n n n m d v 0 i n is the internal force vector β n defines the strain variation from the variation of the kinematic variables and σ is the cauchy stress matrix 12 i n v 0 β n σ d v 0 p n is the external force vector and f f ρ u these matrices and vectors are defined in the space of the nodal variables u 13 p n s n n t d s v n n f d v 3 8 fem mesh characterization to choose the element size and the local refinements for the volume mesh used in the csm solver a small convergence study was made a set of tests where different forces were applied to the hull was created the mesh size was varied and a convergence of the output results was obtained the final mesh is composed of tetrahedral elements their size varies from 0 08 m to 0 05 m and the total mesh size is approximately 80 000 elements 4 cases simulated results and discussion in the following section the conditions that have been simulated will be described the results obtained will be presented and a detailed discussion will be made in order to draw some final conclusions in the last section 4 1 simulation cases the cases that have been simulated are first a unilateral variation of the material young s modulus given a fixed advancing velocity and a regular head wave then in a second set of cases the rayleigh damping constant α of the material has been reduced to a half of its original value not all the previous cases from the first set are simulated in the second just the ones where the impact of the damping variation is the biggest the intention of this variation is to increase the amplitude of the dynamic deformation and to check whether they have a measurable effect on the simulation outputs in the first set of cases they are small compared with the permanent of deformations obtained the advance velocity chosen is 4 0 k n fn 0 32 a fifth order wave with a length of 8 42 m λ w 2 l p p and a height of 0 3 m h w λ w 0 036 is used for the study this wave has been chosen mainly because of the response it infers on the rigid boat for this given speed the properties sought in this response are two regularity and stability the response obtained can be seen in figs 13 and 14 the wave parameters have been kept constant and the mesh resolution has been adapted to this single wave condition the set of young s modulus chosen has been selected because it complies with the following statements 1 high enough values need to be tested to obtain the limit where structural deformations do not affect the vessel s movements 2 low enough values need to be tested to obtain the limit were for a given variation of stiffness the variation in structural deformations represent the non linear coupling of the simulated fluid structure interaction this would be attributed to big changes in the shape of the hull that can alter significantly the way in which it interacts with the surrounding fluid 3 also enough simulation cases need to be done to capture the transition between the two cases described previously the fluid structure interaction related to these dynamics is extremely complex it is typical of systems whose restoring forces and applied forces depend on the relative position of the system at a given time this will be studied in more detail in the next sections the simulations must not be too far apart in order to capture an expected change in trend it will be obtained comparing the displacements recorded in different parts of the hull with the young s modulus corresponding to each case a minimum distance between cases will be required to capture it the set of young s modulus that were found to satisfy the conditions stated above is presented in table 4 4 2 results the main results obtained for each simulated case are the following 1 wave cut records a wave cut at the end of each simulation in the undisturbed zone of the domain near the lateral symmetry planes this way it can be checked that the numeric dissipation remains constant an example of a wave cut obtained during the mesh convergence is given in fig 15 2 pitch time series monitors the angular displacement around the y axis in the coordinate system chosen 3 heave time series monitors the longitudinal translation along the z axis in the coordinate system chosen 4 maximum nodal displacement per zone given a series of local areas of interest on the structure the maximum nodal displacement is recorded in each of them for each time step the local areas can be seen in fig 16 5 pitch angular acceleration time series monitors the angular acceleration around the y axis in the chosen coordinate system pitch and heave accelerations are used to impose loads on the structure due to the vessel s movements 6 heave displacement acceleration time series monitor the longitudinal acceleration along the z axis in the coordinate system chosen to analyze that the results obtained and to make it easier to interpret them a series of variables are defined from the recorded data to understand the logic followed in the analysis careful attention must be paid to fig 17 in this figure the maximum nodal displacement time series of a local area around the stern zone code 5 in fig 16 and for a particular case is presented from these maximum displacements at this particular the area it can be seen that a certain permanent deformation is acquired then oscillations around this permanent deformation occur the deformations in the aft part of the vessel will be analyzed first because they are believed to have the biggest influence on the change of behavior at least for the first set of simulations this is because the center of gravity is in the aft part of the boat which is also the section where the biggest deformations are recorded maximum deformations are also analysed in the bow area the permanent deformation and the amplitudes of the oscillations are key to understanding why and how the behavior of the boat changes when the material stiffness is varied to calculate them the local maximums and minimums of the dynamic response are averaged as it can be seen in fig 17 the average values provide a good reference to compare between different simulations although these oscillations are not completely regular two sets of four graphs given in figs 18 and 19 are used to analyze the displacements in the stern and bow area zone codes 5 and 1 in fig 16 respectively each of these figures contains four graphs in the first graph the amplitudes obtained from the averaged local maximums and minimums are plotted as a function of the material stiffness in the second graph the heave and pitch time responses are compared with the ones obtained from the case where the hull is rigid for each case the maximum difference is calculated the objective of this particular graph is to see how the amplitudes of the boat s movements variate given the change in stiffness and the change in the hull shape that is related to it in the third graph the reference displacement that results from permanent deformations is plotted as a function the corresponding young s modulus simulated this reference displacement can be considered as the origin for the dynamic oscillations last but not least in the fourth graph the values from the third and first graph are added to obtain the overall maximum displacements for each simulation it is also interesting to compare in a plot the heave and pitch time responses since it is the actual output that the boat generates when it is excited by the wave a superposition of these time responses is presented in fig 22 4 3 discussion in this section a detailed analysis and engineering interpretation of the results is provided 4 3 1 deformation at the aft part and its influence in the vessel s response let s start by analyzing the data in the first graph of fig 18 if we observe the higher end of young s modulus values it can be seen that the mean displacement amplitudes follow a linear trend in the same way if we observe the plot below we can see that the motions of the boat are not changing much if we take as a reference the motions of the rigid hull this means that deformations in these initial cases where the hull is fairly rigid is not affecting much the motions of the vessel consequently it is reasonable to think that the loads on the hulls are not varying much however if one thinks about the environment modeled the last thing to expect here is a linear correlation the true nature of the problem can be seen when lower values of the young s modulus are simulated in the simulations the interaction with the water cannot be said to be linear for many reasons to cut it short the reason is that restoring forces and moments are not proportional to displacements and damping forces are not proportional to the velocity this can be particularized for this specific case in the following statements 1 the added masses variate throughout the large motions 2 the forces applied to the hull variate during the impact and also because of the structure deformation 3 forces derived from viscous effects which are already non linear also have to interact with other nonlinearities like the changing structural deformation 4 the restoring forces for the heave and the pitch motions vary due to large displacements and change of shape of the hull having analyzed the 7 stiffer cases e 16 10 6 40 10 6 pa now it is time to analyze the first 4 e 4 10 6 12 10 6 pa cases simulated it can be said that these simulations are characterized by big displacements in relation to the size of the boat analyzed a perceptible change in the manner the vessel reacts to the incoming waves is detected this is attributed to the significant change of shape of the hull one of the situations where these deformations are biggest is presented in fig 20 the nodal displacements are plotted with a color code on the surface of the hull in meters this is done to provide a convenient representation fig 20 is going to be analyzed to understand better the dynamics of the motion in the first picture the boat is coming up the wave in the second picture the wave impact on the bow provides a counter clockwise moment that is compensated with the submergence of the aft part of the boat this creates higher buoyancy forces than usual at the stern which deforms upwards to account for the additional vertical buoyancy and froude krylov forces it should be reminded that if the hull were to rest on calm water because the weight of the structure can t compensate the static buoyancy forces it would have a permanent deformation this initial deformation is in a first approximation represented in fig 17 as the reference value considered as the origin for the dynamic oscillations in the second picture of fig 20 the bow is impacting the water surface this case is the opposite of the previously described the bow submerges and deforms upwards because of the increase in vertical forces derived from the impact with the incoming waves the buoyancy and froude krylov forces continuing with the analysis of the first 4 cases if we observe the lower end of the young s modulus values in the first graph of fig 18 a reduction of this variable leads to another reduction in the amplitude of the dynamic oscillations this at first sight may not be expected but if we consider the permanent deformations that the structure is experiencing it can be seen as quite reasonable the fact is the hydrostatic forces are bending the hull tips upwards when the young s modulus is reduced this causes the fore and aft ends of the hulls to initially bend because they cannot compensate the hydrostatic forces with their own weight as a result the way in which the hydrodynamic loads are applied changes if we then imagine the boat pitching or heaving because the tips are bent upwards the submerged part per unit of displacement due to the motions is smaller and thus the applied loads decrease the magnitude of the motions increases due to smaller restoring forces this increase in the magnitude of the motions is recorded through the second graph of figs 18 and 19 the reason for this can be found in the relation between the variation of the shape of the hull and variation of the applied force by the fluid so if structural deformations are so big that it causes a big enough change in the way fluid force is applied the restoring force in the structure may also change the way in which it reacts this gives way to a change in trend between the relation of these forces the change in the relation between these forces causes the change of trend seen in the first graph of fig 18 for at simulated stiffness of 6 10 6 pa additionally the large motions observed induce slamming impact pressures and loads and this enhances the non linear behavior of the vessel s responses continuing the analysis in the third graph of fig 18 the reference displacement considered as the origin for the dynamic oscillations is plotted as a function of the young s modulus in the same way as explained in the previous case starting with the 7 stiffer values e 16 10 6 40 10 6 pa the response of the boat to the incoming wave doesn t change significantly then the loads on the hull can be considered in a first approximation constant simplifying again the nodal displacements can be expressed as u k 1 f where u are the nodal displacements k the stiffness matrix of the structure and f is the equivalent nodal loads because k depends linearly on e it is reasonable to think that this data ought to be approximated easily by a function of the form a e b where a can be related to the equivalent load applied and b should be equal to 1 as it can be seen in fig 21 the results obtained from matlab s curve fitting tool agree with the expected results given the assumptions made if we go now a step further and try to correlate displacements with the change in response the following conclusions are obtained in this stage the first and third graphs of fig 18 are compared with the second graph in the second graph a big change both in heave and pitch response can be seen for the three lowest young s modulus simulated e 4 10 6 8 10 6 pa analyzing this same set of young s modulus in the first graph it can be seen that these values represent the change in the trend of the dynamic deformations this means that the permanent deformation represented by the reference displacement in the analysis are already big enough to change significantly the way in which the fluid forces are applied to the structure consequently the structure starts responding in a different manner having seen this it can then be said that there is a joint point of change of behavior of the structure and hydrodynamic interaction so it can be concluded that a correlation has been obtained between the structural deformations and the change of hydrodynamic response of the vessel in fig 22 several time series of heave and pitch responses are presented it can be seen how for the first variations of young s modulus the difference in the time responses don t change much especially in heave and the general trend can be appreciated the maximum values for the pitch time response tend to increase and the minimum values also tend to increase this can be seen as a consequence of a reduction of pitch restoring moment and an increase in the static trim position in the heave response a similar trend can be appreciated the main difference is that maximum and minimum values of the heave response change equally as the reference position does not change see fig 23 now the deformations obtained in the second set of simulations is going to be analyzed in these simulations the damping constant has been reduced to a half of its original value consequently an increase in the amplitudes of the dynamic oscillations is recorded the aim of this variation is to increase the relation of the dynamic displacements in relation to the permanent ones the reason for this is to see if there is a direct relation with the total deformation and the change in behavior previously encountered only an increase in dynamic deformations is expected since the permanent deformations are directly related to the static equilibrium the expected outcomes are the following 1 if the previous hypothesis is true then the change in pitch and heave time response will be bigger throughout all the simulations 2 additionally and more importantly the reduction in the amplitude of the oscillations should start with a bigger young s modulus this is because the bigger overall displacements will lead to a sooner change in the way forces are applied and consequently the way in which the structure reacts in the fourth graph of fig 18 it can be seen how the overall registered displacements are bigger compared to the first set of simulations if we check the second graph of fig 18 it can also be seen how the differences increase earlier and with the same trend as in the first set of simulations the reference displacements do not change significantly since that component of the equilibrium as expected should not have an important variation finally if we check the first graph of the same figure the amplitudes of the dynamic displacements start to decrease one simulation later 8 10 6 pa than in the first set of cases so overall the variation in the results fit in the predictions made 4 3 2 deformation at the bow and its influence in the vessel s response having laid out the main findings we continue the analysis regarding the deformations registered at the bows for both first and second set of simulations carried out if the higher end of young s modulus simulated values is observed e 16 10 6 40 10 6 pa in the first graph of fig 19 a somewhat similar trend to the one fitted in fig 21 can be seen however for the same reasons as the ones commented when the deformations at the stern were discussed this variation in displacements cannot be resemblant along the whole set of simulations if the lower end of the young s modulus simulated values is observed e 4 10 6 12 10 6 pa no clear trend can be distinguished it can be expected that the slamming dynamics should have a big influence on this deformation so having said this further studies will be needed to analyze and quantify this in a better way if the lower end of the simulated young s modulus e 4 10 6 12 10 6 pa is observed the trend that has been seen when analyzing the displacements of the aft part of the vessel is not resembled this is because the combination of forces applied to the bow of the vessel is very different these forces in both cases are a combination of buoyancy forces impact and slamming forces due to the sudden changes of orientation and position however the impact and slamming forces are much larger in the bow than at the aft part this way the different manner of change of behavior may be due to the different phenomena encountered it is not straightforward to correlate the change in behavior through the pitch and heave time series with the deformation in the bow it is quite possible that the bigger aft deformations because of bigger loads are overshadowing any effect obtained from the deforming bow anyway to explain what effects we might encounter a series of renders are presented in these renders the bow has very big deformations and the effects that they may have in the behavior of the boat may be inferred from them to describe briefly the succession of renders the following particularities of the different stages of the bow dynamics can be highlighted first just before coming down the wave the bow has a negligible deformation and therefore the obtained displacements are very small once the bow starts submerging the impact slamming and additional buoyancy forces create an increasing deformation this deformation reaches its maximum value near the point of maximum submergence when the vessel returns to the zero trim level deformations in the bow are still pretty much the same as a few instances ago and only decrease significantly once the bow is well out of the water so the conclusion to this brief description would be persistent bow deformations occur throughout the emergence phase of the motion the next question to ask is how these deformations can affect the motions and if there is just one single way to cut it short the change in curvature of the bow is the main result of the deformation additionally given that the vessel is not nose diving in this particular situation a change in orientation towards the incoming fluid will take place this change in relative orientation is prone to increase the resultant forces on the hull and if we add the two a change in the trajectory of the out coming bow is expected to be encountered the trajectory can be approximated at first as tangential to the bow this way the vertical induced acceleration is bigger and thus the pitch should be bigger this would add to the reduction of pitch restoring moment and contribute towards the increase of pitch motion response for the cases simulated and their particular conditions these results in a more violent emergence of the bow so in synthesis the bow submerges further because of the decrease in heave and pitch restoring forces and moments and then it emerges more violently due to the increase of forces applied to the bow and its change of shape this last effect translates into a more pronounced emergence trajectory all these deformations modify actively the pitch restoring moment and in less magnitude the heave restoring moment since the recorded deformation of this part of the hull is not as big as the deformation of the stern these deformations are added to the initial deformation which is again smaller since this part of the hull is not permanently submerged although the modeling of the motions of this part of the hull is more complex the overall effect on the vessels motions is smaller because the main cause of deformations is hydrostatic and froude krylov forces which are smaller in this particular part ending this detailed analysis the systematic fully coupled fluid structure interaction simulation results allow for some inter conclusions the relation between the reference displacement of the dynamic oscillations and the mean amplitudes should be highlighted as it can be obtained from fig 18 the dynamic oscillations are always smaller than the permanent deformation in fact if the biggest values of both variables are compared it can be seen that the maximum reference displacement are two times the height of the maximum dynamic oscillation this can explain in a way the reason why the second graph of fig 18 correlates better with the third than with the first to put it simply the type of deformation that provides the biggest change in shape has the biggest weight in the change in response this relation is particular to the case analyzed the relation between these displacements will vary if the material properties are changed adequately and consequently the impact in the way the boat reacts to the waves will be different as it can be seen in the second set of simulations 5 conclusions the purpose of the following lines is to summarize the change in the behavior of the vessel analyzed and to establish a trade off between optimum vessel performance and the convenient features of inflatable hulls for daily operation as commented in the previous paragraph the deformations expected can be of two types 1 permanent due to hydrostatic forces 2 dynamic due to forces derived from the impacts with the waves radiation restoring diffraction and froude krylov forces the bow and the aft part of the boat acquire a combination of vertical displacements a permanent one and a dynamic one nevertheless both of them have the same effect a variation of the effective length of the boat which will have large overhangs if the main the resultant displacement is in the positive vertical direction this is the particular final outcome as a consequence of the shortening of the hull the pitch restoring moment and the heave resorting force will be reduced so it is expected that there will have to be bigger movements to compensate similar forces finally what trade off should be established between optimum vessel performance and the convenient features for the daily operation of the inflatable hull as the last graph in fig 18 shows once hull displacements go beyond 2 5 of l p p a significant change of behavior is recorded consistently on the other hand if the pressure inside the hull makes it stiff enough then the convenient features for daily operation will outweigh any possible small changes in the behavior of the vessel acknowledgements this work was sponsored by the technical university of madrid through a scholarship program and by mit n00014 16 1 2956 sea grant 
