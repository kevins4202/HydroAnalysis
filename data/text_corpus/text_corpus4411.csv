index,text
22055,understanding the role of land cover changes on climate and hydrology during typhoon events is vital for coastal hazard mitigation prevention as well as the regulation of land cover to investigate the effects of land cover changes simulation studies using the wrf model to calculate the meteorological field combined with the delft3d flow model capable of accurately simulating storm surges were conducted the accuracy of this modeling approach is guaranteed since the models were validated against available in situ and satellite measurements during typhoon rammasun 2014 period through comparing simulation results obtained with the modis 2001 and the globcover 2009 land cover data scenarios it is found that land cover changes in the study region exert an apparent influence on the atmospheric and storm surge simulations notable disagreements exist between the selected two land cover data different types of land cover have disparate physical properties such as roughness length that alters the typhoon induced wind field simulation results thus resulting in changes in storm surge simulation results determining the impact of land cover changes on atmosphere and storm surge provides clearer insight into the land cover impacts which is of great benefit to the atmospheric and storm surge models improvement keywords land cover wind field storm surge wrf delft3d flow 1 introduction storm surge is one of the major threatening natural hazards along the coast that can bring about severe destruction to coastal defenses and result in considerable loss of lives and property hurricane katrina 2005 that struck the united states resulted in the death of 1833 people knabb et al 2006 cyclone nargis 2008 that caused up to 138000 fatalities in myanmar fritz et al 2009 and typhoon haiyan 2013 which killed 6293 people in philippines takagi et al 2015 provide convincing evidence for the ruinous effects of storm surge given the damage of storm surge hazard it is imperative to enhance the capability to predict storm surge processes and their impacts and prepare for responses to future storm events in order to minimize the societal and economic damages considerable efforts have recently been devoted to simulating storm surge around the world cialone et al 2017 deltares 2017 dietrich et al 2018 hu et al 2015 jelesnianski et al 1992 kerr et al 2013 li et al 2018 luettich et al 1992 srinivasa kumar et al 2015 these modeling studies typically focused on improving the hydrodynamic model accuracy stability and reliability despite these achievements model uncertainties still exist in particular areas and storm events aside from grid resolution bathymetry bottom roughness waves and complex effects of the interaction between tide and river discharge in deltas zhang et al 2018 storm surge simulation is also dominated by atmospheric forcing bresson et al 2018 cardone and cox 2009 dietrich et al 2018 irish et al 2008 peng et al 2004 wang et al 2017 better representation of atmospheric forcing could be of great benefit to further improve storm surge models as the critical driver of storm surge and waves during typhoon event lewis et al 2014 liang et al 2019 shao et al 2018 weisberg and zheng 2006 atmospheric forcing is provided in the form of surface pressure and wind fields in storm surge simulations to date four main types of models concerned with different kinds of simulation methods have been developed and introduced they range from simple analytical parametric wind models to steady state dynamical models kinematical models and non steady dynamical models cardone and cox 2009 typical simple analytical parametric wind models include those introduced by holland 1980 jelesnianski 1965 takahashi 1939 and fujita 1952 these models can effectively and efficiently calculate pressure and wind field based on tropical cyclone position and parameters issued by meteorological agencies during its lifetime parametric wind models perform well within a given range from cyclone center especially within areas on the ocean however they usually underestimate the results for areas far away from the cyclone track besides remarkable discrepancies have been found among tropical cyclone databases provided by different agencies knapp and kruk 2010 ying et al 2014 which may result in erroneous estimates in storm surge simulation steady state dynamical models describe wind field by numerically solving equations of motion of a translating cyclone such as planetary boundary layer model given by chow 1971 and later models developed by shapiro 1983 vickery et al 2000 thompson and cardone 1996 and yan et al 1995 although steady state dynamical models have the theoretical advantage compared to simple analytical parametric wind models neither the parametric wind models nor the steady state dynamical models could capture mesoscale wind structures in cyclones zhang et al 2017 typical kinematical models include the interactive objective kinematic analysis system from ocean weather cox et al 1995 and the hwind analysis from the national oceanic and atmospheric administration s hurricane research division powell et al 1998 these two wind models depend on the density and quality of observational data which is generally fine in the hurricane s inner core region and sparse at large distances from hurricane center klausmann 2014 non steady dynamical models offer another sophisticated approach to generate surface wind and air pressure during cyclone period they can capture a large range of physical mechanisms controlling atmosphere through the full set of primitive dynamical equations that govern atmospheric motions some of the better known non steady dynamical models are the fifth generation ncar penn state mesoscale model mm5 grell et al 1995 the geophysical fluid dynamics laboratory hurricane prediction system gfdl kurihara et al 1998 and the weather research and forecasting model wrf skamarock et al 2008 above all each of the four main methods providing wind fields has its advantages and disadvantages in recent years there has been an increasing amount of researches on utilizing wrf as a tool for simulating wind fields for historical storm events bhaskaran et al 2013 colle et al 2015 lakshmi et al 2017 pattanayak et al 2016 ramos valle et al 2018 wu et al 2019 yablonsky et al 2015 zhang et al 2017 moreover wrf has already been utilized to drive the hydrodynamic model for the purpose of providing an improved storm surge prediction system consequently the non steady dynamical wrf atmospheric model was employed for this investigation although the wrf model has emerged as a preferred mesoscale atmospheric model for cyclone simulation zhang et al 2017 further work is still required to reach a satisfactory level of confidence krien et al 2017 numerous studies have revealed that the accuracy of surface wind field estimates based on wrf depends on adequate representation of terrain elevation carvalho et al 2012 santos alamillos et al 2013 sea surface temperature bongirwar et al 2011 kilic and raible 2013 and proper selection of the model physics options hariprasad et al 2014 nasrollahi et al 2012 shepherd and walsh 2017 aside from these factors accuracy of land cover data also play an important role in microscale mesoscale regional and global meteorological simulations chen and dudhia 2001 du et al 2016 gao et al 2008 lam et al 2006 lin et al 2008 since the physical characteristics of land cover regulates the exchanges of heat moisture and momentum between the land and the atmosphere jiménez esteve et al 2018 land cover related parameters play a role in determining friction velocities and exchange coefficients in the surface layer scheme radiative forcing in the radiation scheme and heat and moisture fluxes in the land surface scheme thereby influencing the lower boundary condition for the vertical transport done in the pbl schemes hence an accurate description of land cover characteristics is a chief component in simulating wind fields however recent evidence suggests that significant disagreements exist between the various land cover data giri et al 2005 hansen and reed 2000 mccallum et al 2006 besides there can even be disagreement within a single data released in different years because land cover may change over time owing to continuing human and natural processes such as urbanization forestation deforestation ecological engineering natural disasters and climate change rajasree and deo 2018 it has been demonstrated that adopting more accurate and reliable land cover data can lead to the improvement of regional atmospheric model simulations cheng and byun 2008 kumar et al 2014 sertel et al 2010 for example through multiple storm simulations based on pre european settlement land cover and land cover representing sydney s current land use pattern gero et al 2006 claimed that local convective storms were highly sensitive to the triggering mechanism associated with land surface influences in the lombardy region north italy de meij and vinuesa 2014 found that the simulated average wind speeds by the wrf simulation with the srtm and corine land cover are better than the wrf simulation with usgs land cover data due to a better representation of the urban fraction similarly santos alamillos et al 2015 pointed out that corine land cover data performed better than glcc data associated with wrf wind speed simulations in southern spain for applications in the taiwan area cheng et al 2013 performed three wrf simulations with three different land cover data the results showed the surface wind speeds estimated based on ncu national central university of taiwan and modis land cover data are in better agreement with the observed data when compared with the simulation performed using the usgs land cover data in the pearl river delta there is a substantial difference between the 1992 usgs land cover data and the 2004 modis land cover data the wrf simulation results showed that this difference could significantly modify the near surface temperature humidity wind speed and regional precipitation wang et al 2014 although extensive research has been carried out on the effects of land cover data on wind field simulation and the effects of wind fields on storm surge simulation little research has been done to investigate how storm surge simulation depends on the land cover data in the mesoscale atmospheric model it remains unclear how uncertainties in the land cover data selection propagate to the hydrodynamic model and produce discrepancies in the storm surge simulations in this investigation the aim was to assess how land cover data affect the atmospheric model simulation of wind fields and the hydrodynamic model prediction of storm surge the hainan island and the leizhou peninsula located around the qiongzhou strait are the focus of the land cover data fig 1 this region is selected because of not only its complex land cover characteristics but also its known exceptional vulnerability to severe storms the qiongzhou strait is affected by some of the strongest typhoons ever recorded such as typhoon rammasun 2014 and typhoon kalmaegi 2014 and typhoon krovanh 2003 determining the impact of land cover data on atmosphere and storm surge can improve the understanding of the land cover contribution and the simulation capability of storm surge which can in turn provide an important scientific basis for storm surge hazard mitigation through the regulation of land cover 2 description of selected typhoon and land cover data 2 1 typhoon rammasun as the strongest typhoon to make landfall in china since 1949 state oceanic administration 2014 typhoon rammasun 2014 was selected for model validation and further investigation in this study the typhoon track and intensity information were obtained from the china meteorological administration s tropical cyclone database tcdata typhoon org cn ying et al 2014 rammasun originated from a tropical depression in the northwestern pacific on 10 july 2014 fig 2 then this tropical depression moved westward due to the influence of a subtropical anticyclone by early july 12 it had intensified into a tropical storm while moving westward to the philippines the storm continued to strengthen and it had reached severe tropical storm status by early on 14 july later on the same day rammasun became a typhoon shortly before making landfall on the philippines on 15 july rammasun strengthened rapidly and reached severe typhoon status thereafter it turned west northwestward and moved across the philippines by 0000 utc on 16 july rammasun entered the south china sea as a typhoon when rammasun moved over the warm waters of the south china sea the typhoon was on a strengthening trend once again and became a severe typhoon on 17 july later that day rammasun attained super typhoon intensity as a super typhoon rammasun made landfall on hainan province around 0730 utc 18 july with maximum winds of 60 m s and a minimum pressure of 910 hpa after crossing the qiongzhou strait rammasun maintained its super typhoon intensity and made its second landfall on guangdong province keeping moving west northwestward rammasun had weakened to severe typhoon and made its third landfall on guangxi province on 19 july after this landfall its interaction with land weakened itself significantly until dissipation rammasun was a rapid moving and extraordinarily powerful typhoon that struck hainan guangdong and guangxi provinces it had caused direct economic losses of cny 8 08 billion to these three provinces as a result of its strong storm surge and waves state oceanic administration 2014 seven tide gauges recorded a storm surges of more than 2 m in these provinces the peak storm surge was 3 92 m observed at nandu station in guangdong province the statistics showed that 5 44 million people affected and 33 77 thousand homes toppled in three provinces due to rammasun 2 2 land cover data to better understand the influence of land cover on typhoon and storm surge simulations modis 2001 and globcover 2009 land cover data around the qiongzhou strait were applied as the default land cover data used in the wrf model since version 3 1 modis 2001 land cover data was derived from high quality data sets from instruments operating on both the terra and aqua spacecraft for the year 2001 it can identify 17 land cover classes with a resolution of 500 m following the international geosphere biosphere programme igbp classification which includes 11 classes of natural vegetation 3 classes of developed and mosaic lands and 3 classes of non vegetated lands friedl et al 2002 loveland and belward 1997 the second land cover data merged in the wrf model is the globcover 2009 land cover data which was carried out by european space agency and the université catholique de louvain bontemps et al 2011 the globcover 2009 land cover data of 300 m resolution was produced based on medium resolution imaging spectrometer full resolution mosaics produced for the year 2009 it is described by a legend counting 22 land cover types that are compatible with the united nations land cover classification system spatial distribution of land cover classes in wrf inner domain for the modis 2001 and globcover 2009 data are presented in fig 3 table 1 presents the percentages of each land cover distribution class by grid points over the inner model domain in each data set the comparison shows that land cover characteristics are quite different between these two datasets the most significant difference of 4 27 between these two data is the percentage for the dryland cropland and pasture in the modis 2001 data it is primarily situated in the leizhou peninsula and the northern hainan island whereas in the globcover 2009 data its distribution area is smaller another notable distinction is found in the mixed shrubland grassland this land cover is marginally represented in the modis 2001 data but is substantially identified in the globcover 2009 data in both the leizhou peninsula and hainan island the percentage of this land cover in the globcover 2009 data is more than 15 times larger than in the modis 2001 data aside from these two classes percentage differences for mixed forest and shrubland are both higher than 2 the globcover 2009 data shows more shrubland while more mixed forest is represented in another dataset also the evergreen broadleaf in the two datasets is obviously different the area of evergreen broadleaf represents 1 73 more in the globcover 2009 data than that in the modis 2001 data as for the urban and built up land it takes up 0 54 in the globcover 2009 data while 0 37 in the other these land cover differences among the two data would cause impacts on wind field and storm surge as will be discussed in the following sections 3 model configuration and validation in order to investigate the effect of land cover data on atmospheric and storm surge simulations wrf and delft3d flow models were integrated with two land cover scenarios during typhoon rammasun 2014 the wrf model performs atmospheric simulations as well as analysis providing temporal and spatial variation of wind and pressure field for delft3d flow hydrodynamic model subsequently storm surge process during typhoon period is simulated with the delft3d flow model accordingly the physical system can be accurately defined and numerically resolved 3 1 model description wrf is a mesoscale forecast model and data assimilation system which is developed to simulate mesoscale weather with a domain size from tens of meters to thousands of kilometers skamarock et al 2008 the version of wrf applied here is 3 6 1 there are two dynamics solvers in the wrf system they are the arw advanced research wrf solver developed primarily at ncar national center for atmospheric research and the nmm nonhydrostatic mesoscale model solver developed at ncep national centers for environmental prediction the arw dynamics solver which was used in this study integrates the fully compressible nonhydrostatic euler equations these equations are solved using the terrain following mass vertical coordinate and staggered arakawa c grid this model also supports horizontal nesting that allows specific representations of the region of interest through high resolution grids many physics options are available in the arw including microphysics cumulus parameterization planetary boundary layer land surface model radiation and diffusion due to its major features the wrf model serves a wide range of meteorological applications such as real time numerical weather prediction data assimilation development and studies parameterized physics research regional climate simulations air quality modeling atmosphere ocean coupling and idealized simulations for storm surge analyses the two dimensional hydrodynamic module delft3d flow developed by deltares 2017 was adopted forced with tidal levels wind and pressure fields given by wrf delft3d flow hydrodynamic model can produce a prediction of water surface elevation by solving the navier stokes equations on a rectilinear or a curvilinear boundary fitted grid for an incompressible fluid under the shallow water and the boussinesq assumptions governing equations of the numerical hydrodynamic modeling system delft3d flow consists of the horizontal equations of motion the continuity equation and the transport equations for conservative constituents 3 2 model configuration to resolve features that may control atmosphere and flow behavior over the region of interest efficiently and accurately two way triply nested grid wrf simulations were configured fig 4 table 2 the outer domain covers multinational territory including the western philippine sea the northern south china sea and the southern east china sea most of the typhoon rammasun s path can be simulated in this domain which consists of 331 251 grid points with a coarse resolution of 18 km the intermediate domain has a resolution of 9 km and 139 115 grid points it covers the track of typhoon rammasun from 17 to 19 july 2014 which is the period of the focus of this study the inner domain covers the coastal and inland areas that were significantly affected by rammasun the total number of grids for the inner domain is 190 172 and the corresponding resolution is 3 km the starting time of the wrf simulations is 1200 utc on 17 july about 19 5 h before typhoon rammasun s first landfall the total length of the simulation is 48 h to initialize the wrf simulations the fnl operational global analysis data https rda ucar edu datasets ds083 2 from the national centers for environmental prediction ncep was utilized this dataset has a spatial resolution of 1 and a temporal resolution of 6 h fnl data were interpolated to the respective wrf grid by the wrf preprocessing system boundary conditions are forced every 6 h the wrf physical options were selected based on model validations all simulations ran with 30 vertical sigma levels with a top of 50 hpa a relatively sophisticated microphysics scheme named purdue lin scheme chen and sun 2002 was applied to resolve water vapor cloud and precipitation processes the modified version of the kain fritsch scheme kain 2004 was selected for cumulus parameterization furthermore eta surface layer scheme janjic 1996 and noah lsm scheme chen and dudhia 2001 were adopted for the surface layer and land surface model parameterization all simulations were performed with the yonsei university scheme boundary layer parameterization hong et al 2006 as for atmospheric radiation longwave and shortwave radiation were taken into account by the rapid radiative transfer model rrtm scheme mlawer et al 1997 and mm5 dudhia scheme dudhia 1989 forced by wrf simulation results a nested modeling system based on delft3d flow was utilized to simulate storm surge in the study area fig 5 nested orthogonal curvilinear grids fig 6 were adopted to obtain a good representation of the bathymetry around the qiongzhou strait and simultaneously satisfy the efficiency and accuracy requirements of the storm surge simulation the outer model domain covers major parts of the northern south china sea and the entire coastal waters of guangdong guangxi and hainan province it has one closed land boundary along the coastline in the north and the west and two open sea boundaries in the east at 118 e and in the south at 15 n the outer model consists of 581 981 grids and 382944 elements with a uniform resolution of 2 km in the horizontal direction and 1 km in the latitudinal direction with a varying resolution ranging from 1 km on the edges of the model to about 200 m near the qiongzhou strait the inner model has 334 359 grids and 67865 elements this small model domain focuses on the study area and spans about 174 km from the west open boundary to the east open boundary the bathymetric data for grid cells were obtained from the noaa website https maps ngdc noaa gov viewers wcs client and the survey data around the qiongzhou strait the mean sea level msl was utilized as the water level datum simulations were forced by wind and pressure forces given by wrf simulations and 13 tidal constituents along the ocean boundary simulation starting time and period are the same as those applied in wrf models 3 3 model validation to test the models the typhoon track the wind field and the time series of wind speed given by the wrf model as well as the storm surge provided by the delft3d flow model were validated with available observations and satellite measurements during this process considering the data time and accuracy for the two land cover data introduced in the previous section the globcover 2009 data was applied for model configuration meanwhile simulation results based on the modis 2001 land cover data were also compared with observations as well as satellite measurements by utilizing identical boundary conditions and model configuration fig 7 presents the china meteorological administration s cma best track and the wrf modeled track for typhoon rammasun verification covers the typhoon influence period around the qiongzhou strait from 1200 utc on 17 july 2014 the simulated tracks were determined by locating the minimum sea surface pressure at 6 h intervals which compares well to the best track provided by the cma the root mean square error rmse between the simulated and the observed tracks during this period is 32 25 km for the globcover 2009 and 31 90 km for the modis 2001 land cover data subsequently the daily advanced scatterometer ascat surface wind on july 18 which have spatial resolutions of 0 25 in longitude and latitude bentamy and fillon 2011 was utilized for wrf model validation the results obtained from the ascat satellite measurements and wrf results are compared in fig 8 as can be seen from this figure wrf modeled daily averaged wind field reproduces the wind speeds and wind directions well on both land cover scenarios meanwhile as the outputs of the wrf model wind speed collected by the two stations fig 7 were utilized for validation fig 9 the rmse of wind speed with globcover 2009 land cover data at these two stations is 3 07 m s with a correlation coefficient of 0 94 the good consistency between the simulated and the observed wind speed indicates that the triply nested grid wrf model can provide wind field for the hydrodynamic model besides under the influence of modis 2001 land cover data the corresponding rmse as well as the correlation coefficient of wind speed at the two stations are 5 42 m s and 0 92 eventually the observation data of storm surge during typhoon rammasun event collected by xiuying and naozhou stations were utilized to validate and assess the capacity of the hydrodynamic model as illustrated in fig 9 c d the simulation of the surge process is valid at xiuying station the rmse and the correlation coefficient of the simulated storm surge under globcover 2009 land cover data from the measured are 0 35 m and 0 87 respectively while these two values are 0 38 m and 0 86 under the modis 2001 scenario as for the naozhou station the averaged rmse and the correlation coefficient under two land cover scenarios are 0 27 m and 0 91 respectively according to the validation results the hydrodynamic delft3d flow model could provide a reasonable simulation of storm surge during the typhoon process under the premise of the accurate simulation of wind field given by wrf in summary good consistency between the simulated and the observed typhoon track wind field and storm surge confirmed the capacity of the model which laid a solid foundation for further discussion about the effect of land cover on atmospheric and storm surge simulations 4 response of wind field and storm surge simulations to land cover change based on the model configuration and validation mentioned above established models were further utilized to test the effect of different land cover data on wind field and storm surge simulations the method involved simulating typhoon rammasun event with the globcover 2009 land cover data followed by simulating the same event using identical boundary conditions and model configuration with the modis 2001 land cover data a comparison was then conducted between the results obtained with these two scenarios to find out whether the atmospheric and storm surge simulations are impacted by the land cover changes in this region 4 1 impacts of land cover change on wind field to characterize wrf land cover change impacts on wind field in the study area spatial distributions of the wind field at two selected points of time were selected for analysis fig 10 illustrates the wind field distributions under the two land cover scenarios and their differences at 07 00 utc 18 july 2014 typhoon rammasun made its first landfall on hainan island around this time comparisons of the wind field distribution patterns under two land cover scenarios clearly show that the change of land cover causes apparent variation of the wind field in the study area since the typhoon center is close to the mainland the shape of wind distribution near the typhoon center changes under the influence of land cover variation the shape of simulated typhoon center under the globcover 2009 scenario is rounder than that under the modis 2001 scenario the modis 2001 scenario simulation presents stronger maximum wind speeds on the northeastern side of the typhoon center than the globcover 2009 scenarios simulation the differences in this area are mainly larger than 5 m s with a maximum difference of 19 73 m s nevertheless the results of the modis 2001 scenario in the south side near the center are covered by lower wind speeds the biggest difference reaches 26 64 m s in large areas on the northeastern hainan island and a small area on the southeastern leizhou peninsula the wind speed calculated under the modis 2001 scenario is at least 5 m s slower than that under the globcover 2009 scenario at 12 00 utc july 18 the typhoon center had crossed the qiongzhou strait and moved around to its second landfall location in guangdong province fig 11 with further interaction between typhoon rammasun and land cover the effect of land cover change on wind field is further enhanced the difference of the wind distribution shape near the typhoon center under the two land cover scenarios is even more significant the shape of simulated typhoon center under the globcover 2009 scenario is further rounder than that under the modis 2001 scenario besides a similar distinction between the two scenarios has been found on the northeastern side of the typhoon center in this strip area the simulated wind speeds under modis 2001 scenario are on average higher than that under globcover 2009 scenario differences are generally larger than 5 m s with a maximum value of 18 17 m s meanwhile the modis 2001 scenario also results in higher wind speeds on the local southern side of the typhoon center with a maximum difference of 17 95 m s as for the southeastern leizhou peninsula the northeastern hainan island and southeastern side of the typhoon center the modis 2001 scenario generates lower wind speeds with differences larger than 10 m s in local areas simulated variation of wind field between the selected two land cover data can be explained by different land cover distribution in this area in the noah land surface model which has been applied in the established wrf model a series of physical parameters are determined based on land cover class such as surface albedo roughness length minimal stomatal resistance and visible solar flux chen and dudhia 2001 the noah land surface model is sensitive to the processing of these parameters especially the calculation of the roughness length for heat moisture the roughness length is specified according to the given dominant land cover class this parameter plays a key role in determining the surface exchange coefficient for heat and moisture thus affecting the simulation of surface wind the change in land cover can significantly lead to different roughness lengths in the study area as can be seen from fig 3 and table 1 an obvious distinction between the two land cover data is found for the evergreen broadleaf mixed forest evergreen needleleaf as well as urban and built up land which all have higher roughness length because of the counterclockwise rotation of typhoon winds the southeastern leizhou peninsula and the northeastern hainan island can affect the typhoon center directly significant distinctions of land cover characteristics between these two data are bound to cause different wind speed in this area 4 2 impacts of land cover change on storm surge through the change of wind field storm surge is mainly produced by water being pushed toward the shore by the force of typhoon induced winds numerous researches have demonstrated the importance of wind field in storm surge simulations lakshmi et al 2017 torres et al 2019 wang et al 2017 yin et al 2017 2018 as illustrated in the previous section different land cover data result in obvious variation of wind field in study area to further improve the understanding of land cover contribution during a typhoon period the impacts of land cover change on storm surge simulation were also investigated by the validated hydrodynamic model in the numerical model only wind field was updated due to the variations of land cover data while the other factors remained unchanged to illustrate the storm surge response to land cover data the difference of storm surge modis 2001 scenario minus globcover 2009 scenario at two time points between the globcover 2009 and modis 2001 land cover data are shown in fig 12 examination of the spatial distribution of storm surge differences between the two land cover data scenarios reveals that the impacts of land cover change on storm surge are significant at 07 00 utc 18 july 2014 when typhoon rammasun made its first landfall on hainan island the modis 2001 scenario induces larger storm surge around the qiongzhou strait especially in the eastern coastal areas of the leizhou peninsula the difference is between 0 03 m and 0 06 m around the qiongzhou strait while this value reaches 0 10 m in the southeastern leizhou peninsula and even 0 15 m in the eastern area since the eastern sea areas are closer to the typhoon center and wind speed differences are more significant in this area difference values in the areas north of the typhoon center in the eastern leizhou peninsula are larger than those on the other sea areas in the west coastal areas of the qiongzhou strait difference values are basically lower than 0 025 m this spatial pattern can be explained by the wind field difference between the two land cover scenarios at this time as can be seen from fig 10 the modis 2001 scenario generates larger wind speed in the north of the typhoon center east of the leizhou peninsula thus causing larger storm surge distinction in this area when the typhoon center moves to its second landfall location there are also considerable differences in storm surge between the two land cover scenarios in the qiongzhou strait north of haikou city the modis 2001 scenario changes storm surge by 0 06 m 0 13 m in the southeastern leizhou peninsula the variation reaches 0 20 m meanwhile the modis 2001 scenario decreases storm surge by 0 15 m in the east of the land away from the typhoon center similar to the results at 07 00 the variation of storm surge in the eastern areas are larger than those in the western areas such a variation pattern is also related to the wind field differences shown in fig 11 5 conclusions this study is intended to evaluate the influence of land cover representation data on atmospheric and storm surge around the qiongzhou strait using typhoon rammasun 2014 as a case study for this purpose a triply nested wrf atmospheric model and a nested hydrodynamic delft3d flow model have been established for temporal and spatial varying wind field and storm surge simulations respectively two land cover data including the modis 2001 and the globcover 2009 data have been utilized for further comparative analysis the model simulated typhoon track compares well with observations while the calculated daily averaged wind field wind speed and storm surge match well with satellite measurements as well as time series of observed values at several stations accordingly reliable performances have been produced of established models in simulating typhoon wind field and storm surge in the studied region the comparative analysis shows that different land cover distributions can lead to variation of wind speed and storm surge simulation results during a typhoon period maximum differences in wind speed and storm surge can reach 26 64 m s and 0 15 m in the example analysis spatial distributions of land cover classes are relatively distinct between the modis 2001 and the globcover 2009 land cover data different land cover classes bring about notable distinct roughness lengths based on the noah land surface model thus further cause wind field changes in the study area such wind field difference eventually leads to obvious distinctions of storm surge simulation results the results provided in this paper improve our understanding of the performance of land cover data in the typhoon wind field and storm surge the model predicted influencing results provide valuable supports in assessing the role of potential land cover change on local hydrology and climate meanwhile understanding the effects of land cover will contribute to further development in the storm surge simulations such as the improvement in the meteorological inputs joint researches should be strengthened in the fields of engineering atmospheric science and ocean science as this is of great significance to the development of ocean engineering however it should be noted that regional land cover changes could in fact differ significantly due to distinct human and natural processes even in the case where the land covers are of similar features owing to the complexities of depending on many factors such as terrain elevation river discharge tide waves and sea surface temperature there is no one size fits all response of atmospheric and storm surge to land cover changes therefore further studies are essential to ascertain the impacts of land cover changes more accurately credit authorship contribution statement kai yin methodology formal analysis writing original draft writing review editing visualization sudong xu conceptualization supervision project administration funding acquisition quan zhao software investigation validation wenrui huang supervision ke yang software meiting guo validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by the national natural science foundation of china grant number 51879043 and the china scholarship council for supporting the visit to florida state university 
22055,understanding the role of land cover changes on climate and hydrology during typhoon events is vital for coastal hazard mitigation prevention as well as the regulation of land cover to investigate the effects of land cover changes simulation studies using the wrf model to calculate the meteorological field combined with the delft3d flow model capable of accurately simulating storm surges were conducted the accuracy of this modeling approach is guaranteed since the models were validated against available in situ and satellite measurements during typhoon rammasun 2014 period through comparing simulation results obtained with the modis 2001 and the globcover 2009 land cover data scenarios it is found that land cover changes in the study region exert an apparent influence on the atmospheric and storm surge simulations notable disagreements exist between the selected two land cover data different types of land cover have disparate physical properties such as roughness length that alters the typhoon induced wind field simulation results thus resulting in changes in storm surge simulation results determining the impact of land cover changes on atmosphere and storm surge provides clearer insight into the land cover impacts which is of great benefit to the atmospheric and storm surge models improvement keywords land cover wind field storm surge wrf delft3d flow 1 introduction storm surge is one of the major threatening natural hazards along the coast that can bring about severe destruction to coastal defenses and result in considerable loss of lives and property hurricane katrina 2005 that struck the united states resulted in the death of 1833 people knabb et al 2006 cyclone nargis 2008 that caused up to 138000 fatalities in myanmar fritz et al 2009 and typhoon haiyan 2013 which killed 6293 people in philippines takagi et al 2015 provide convincing evidence for the ruinous effects of storm surge given the damage of storm surge hazard it is imperative to enhance the capability to predict storm surge processes and their impacts and prepare for responses to future storm events in order to minimize the societal and economic damages considerable efforts have recently been devoted to simulating storm surge around the world cialone et al 2017 deltares 2017 dietrich et al 2018 hu et al 2015 jelesnianski et al 1992 kerr et al 2013 li et al 2018 luettich et al 1992 srinivasa kumar et al 2015 these modeling studies typically focused on improving the hydrodynamic model accuracy stability and reliability despite these achievements model uncertainties still exist in particular areas and storm events aside from grid resolution bathymetry bottom roughness waves and complex effects of the interaction between tide and river discharge in deltas zhang et al 2018 storm surge simulation is also dominated by atmospheric forcing bresson et al 2018 cardone and cox 2009 dietrich et al 2018 irish et al 2008 peng et al 2004 wang et al 2017 better representation of atmospheric forcing could be of great benefit to further improve storm surge models as the critical driver of storm surge and waves during typhoon event lewis et al 2014 liang et al 2019 shao et al 2018 weisberg and zheng 2006 atmospheric forcing is provided in the form of surface pressure and wind fields in storm surge simulations to date four main types of models concerned with different kinds of simulation methods have been developed and introduced they range from simple analytical parametric wind models to steady state dynamical models kinematical models and non steady dynamical models cardone and cox 2009 typical simple analytical parametric wind models include those introduced by holland 1980 jelesnianski 1965 takahashi 1939 and fujita 1952 these models can effectively and efficiently calculate pressure and wind field based on tropical cyclone position and parameters issued by meteorological agencies during its lifetime parametric wind models perform well within a given range from cyclone center especially within areas on the ocean however they usually underestimate the results for areas far away from the cyclone track besides remarkable discrepancies have been found among tropical cyclone databases provided by different agencies knapp and kruk 2010 ying et al 2014 which may result in erroneous estimates in storm surge simulation steady state dynamical models describe wind field by numerically solving equations of motion of a translating cyclone such as planetary boundary layer model given by chow 1971 and later models developed by shapiro 1983 vickery et al 2000 thompson and cardone 1996 and yan et al 1995 although steady state dynamical models have the theoretical advantage compared to simple analytical parametric wind models neither the parametric wind models nor the steady state dynamical models could capture mesoscale wind structures in cyclones zhang et al 2017 typical kinematical models include the interactive objective kinematic analysis system from ocean weather cox et al 1995 and the hwind analysis from the national oceanic and atmospheric administration s hurricane research division powell et al 1998 these two wind models depend on the density and quality of observational data which is generally fine in the hurricane s inner core region and sparse at large distances from hurricane center klausmann 2014 non steady dynamical models offer another sophisticated approach to generate surface wind and air pressure during cyclone period they can capture a large range of physical mechanisms controlling atmosphere through the full set of primitive dynamical equations that govern atmospheric motions some of the better known non steady dynamical models are the fifth generation ncar penn state mesoscale model mm5 grell et al 1995 the geophysical fluid dynamics laboratory hurricane prediction system gfdl kurihara et al 1998 and the weather research and forecasting model wrf skamarock et al 2008 above all each of the four main methods providing wind fields has its advantages and disadvantages in recent years there has been an increasing amount of researches on utilizing wrf as a tool for simulating wind fields for historical storm events bhaskaran et al 2013 colle et al 2015 lakshmi et al 2017 pattanayak et al 2016 ramos valle et al 2018 wu et al 2019 yablonsky et al 2015 zhang et al 2017 moreover wrf has already been utilized to drive the hydrodynamic model for the purpose of providing an improved storm surge prediction system consequently the non steady dynamical wrf atmospheric model was employed for this investigation although the wrf model has emerged as a preferred mesoscale atmospheric model for cyclone simulation zhang et al 2017 further work is still required to reach a satisfactory level of confidence krien et al 2017 numerous studies have revealed that the accuracy of surface wind field estimates based on wrf depends on adequate representation of terrain elevation carvalho et al 2012 santos alamillos et al 2013 sea surface temperature bongirwar et al 2011 kilic and raible 2013 and proper selection of the model physics options hariprasad et al 2014 nasrollahi et al 2012 shepherd and walsh 2017 aside from these factors accuracy of land cover data also play an important role in microscale mesoscale regional and global meteorological simulations chen and dudhia 2001 du et al 2016 gao et al 2008 lam et al 2006 lin et al 2008 since the physical characteristics of land cover regulates the exchanges of heat moisture and momentum between the land and the atmosphere jiménez esteve et al 2018 land cover related parameters play a role in determining friction velocities and exchange coefficients in the surface layer scheme radiative forcing in the radiation scheme and heat and moisture fluxes in the land surface scheme thereby influencing the lower boundary condition for the vertical transport done in the pbl schemes hence an accurate description of land cover characteristics is a chief component in simulating wind fields however recent evidence suggests that significant disagreements exist between the various land cover data giri et al 2005 hansen and reed 2000 mccallum et al 2006 besides there can even be disagreement within a single data released in different years because land cover may change over time owing to continuing human and natural processes such as urbanization forestation deforestation ecological engineering natural disasters and climate change rajasree and deo 2018 it has been demonstrated that adopting more accurate and reliable land cover data can lead to the improvement of regional atmospheric model simulations cheng and byun 2008 kumar et al 2014 sertel et al 2010 for example through multiple storm simulations based on pre european settlement land cover and land cover representing sydney s current land use pattern gero et al 2006 claimed that local convective storms were highly sensitive to the triggering mechanism associated with land surface influences in the lombardy region north italy de meij and vinuesa 2014 found that the simulated average wind speeds by the wrf simulation with the srtm and corine land cover are better than the wrf simulation with usgs land cover data due to a better representation of the urban fraction similarly santos alamillos et al 2015 pointed out that corine land cover data performed better than glcc data associated with wrf wind speed simulations in southern spain for applications in the taiwan area cheng et al 2013 performed three wrf simulations with three different land cover data the results showed the surface wind speeds estimated based on ncu national central university of taiwan and modis land cover data are in better agreement with the observed data when compared with the simulation performed using the usgs land cover data in the pearl river delta there is a substantial difference between the 1992 usgs land cover data and the 2004 modis land cover data the wrf simulation results showed that this difference could significantly modify the near surface temperature humidity wind speed and regional precipitation wang et al 2014 although extensive research has been carried out on the effects of land cover data on wind field simulation and the effects of wind fields on storm surge simulation little research has been done to investigate how storm surge simulation depends on the land cover data in the mesoscale atmospheric model it remains unclear how uncertainties in the land cover data selection propagate to the hydrodynamic model and produce discrepancies in the storm surge simulations in this investigation the aim was to assess how land cover data affect the atmospheric model simulation of wind fields and the hydrodynamic model prediction of storm surge the hainan island and the leizhou peninsula located around the qiongzhou strait are the focus of the land cover data fig 1 this region is selected because of not only its complex land cover characteristics but also its known exceptional vulnerability to severe storms the qiongzhou strait is affected by some of the strongest typhoons ever recorded such as typhoon rammasun 2014 and typhoon kalmaegi 2014 and typhoon krovanh 2003 determining the impact of land cover data on atmosphere and storm surge can improve the understanding of the land cover contribution and the simulation capability of storm surge which can in turn provide an important scientific basis for storm surge hazard mitigation through the regulation of land cover 2 description of selected typhoon and land cover data 2 1 typhoon rammasun as the strongest typhoon to make landfall in china since 1949 state oceanic administration 2014 typhoon rammasun 2014 was selected for model validation and further investigation in this study the typhoon track and intensity information were obtained from the china meteorological administration s tropical cyclone database tcdata typhoon org cn ying et al 2014 rammasun originated from a tropical depression in the northwestern pacific on 10 july 2014 fig 2 then this tropical depression moved westward due to the influence of a subtropical anticyclone by early july 12 it had intensified into a tropical storm while moving westward to the philippines the storm continued to strengthen and it had reached severe tropical storm status by early on 14 july later on the same day rammasun became a typhoon shortly before making landfall on the philippines on 15 july rammasun strengthened rapidly and reached severe typhoon status thereafter it turned west northwestward and moved across the philippines by 0000 utc on 16 july rammasun entered the south china sea as a typhoon when rammasun moved over the warm waters of the south china sea the typhoon was on a strengthening trend once again and became a severe typhoon on 17 july later that day rammasun attained super typhoon intensity as a super typhoon rammasun made landfall on hainan province around 0730 utc 18 july with maximum winds of 60 m s and a minimum pressure of 910 hpa after crossing the qiongzhou strait rammasun maintained its super typhoon intensity and made its second landfall on guangdong province keeping moving west northwestward rammasun had weakened to severe typhoon and made its third landfall on guangxi province on 19 july after this landfall its interaction with land weakened itself significantly until dissipation rammasun was a rapid moving and extraordinarily powerful typhoon that struck hainan guangdong and guangxi provinces it had caused direct economic losses of cny 8 08 billion to these three provinces as a result of its strong storm surge and waves state oceanic administration 2014 seven tide gauges recorded a storm surges of more than 2 m in these provinces the peak storm surge was 3 92 m observed at nandu station in guangdong province the statistics showed that 5 44 million people affected and 33 77 thousand homes toppled in three provinces due to rammasun 2 2 land cover data to better understand the influence of land cover on typhoon and storm surge simulations modis 2001 and globcover 2009 land cover data around the qiongzhou strait were applied as the default land cover data used in the wrf model since version 3 1 modis 2001 land cover data was derived from high quality data sets from instruments operating on both the terra and aqua spacecraft for the year 2001 it can identify 17 land cover classes with a resolution of 500 m following the international geosphere biosphere programme igbp classification which includes 11 classes of natural vegetation 3 classes of developed and mosaic lands and 3 classes of non vegetated lands friedl et al 2002 loveland and belward 1997 the second land cover data merged in the wrf model is the globcover 2009 land cover data which was carried out by european space agency and the université catholique de louvain bontemps et al 2011 the globcover 2009 land cover data of 300 m resolution was produced based on medium resolution imaging spectrometer full resolution mosaics produced for the year 2009 it is described by a legend counting 22 land cover types that are compatible with the united nations land cover classification system spatial distribution of land cover classes in wrf inner domain for the modis 2001 and globcover 2009 data are presented in fig 3 table 1 presents the percentages of each land cover distribution class by grid points over the inner model domain in each data set the comparison shows that land cover characteristics are quite different between these two datasets the most significant difference of 4 27 between these two data is the percentage for the dryland cropland and pasture in the modis 2001 data it is primarily situated in the leizhou peninsula and the northern hainan island whereas in the globcover 2009 data its distribution area is smaller another notable distinction is found in the mixed shrubland grassland this land cover is marginally represented in the modis 2001 data but is substantially identified in the globcover 2009 data in both the leizhou peninsula and hainan island the percentage of this land cover in the globcover 2009 data is more than 15 times larger than in the modis 2001 data aside from these two classes percentage differences for mixed forest and shrubland are both higher than 2 the globcover 2009 data shows more shrubland while more mixed forest is represented in another dataset also the evergreen broadleaf in the two datasets is obviously different the area of evergreen broadleaf represents 1 73 more in the globcover 2009 data than that in the modis 2001 data as for the urban and built up land it takes up 0 54 in the globcover 2009 data while 0 37 in the other these land cover differences among the two data would cause impacts on wind field and storm surge as will be discussed in the following sections 3 model configuration and validation in order to investigate the effect of land cover data on atmospheric and storm surge simulations wrf and delft3d flow models were integrated with two land cover scenarios during typhoon rammasun 2014 the wrf model performs atmospheric simulations as well as analysis providing temporal and spatial variation of wind and pressure field for delft3d flow hydrodynamic model subsequently storm surge process during typhoon period is simulated with the delft3d flow model accordingly the physical system can be accurately defined and numerically resolved 3 1 model description wrf is a mesoscale forecast model and data assimilation system which is developed to simulate mesoscale weather with a domain size from tens of meters to thousands of kilometers skamarock et al 2008 the version of wrf applied here is 3 6 1 there are two dynamics solvers in the wrf system they are the arw advanced research wrf solver developed primarily at ncar national center for atmospheric research and the nmm nonhydrostatic mesoscale model solver developed at ncep national centers for environmental prediction the arw dynamics solver which was used in this study integrates the fully compressible nonhydrostatic euler equations these equations are solved using the terrain following mass vertical coordinate and staggered arakawa c grid this model also supports horizontal nesting that allows specific representations of the region of interest through high resolution grids many physics options are available in the arw including microphysics cumulus parameterization planetary boundary layer land surface model radiation and diffusion due to its major features the wrf model serves a wide range of meteorological applications such as real time numerical weather prediction data assimilation development and studies parameterized physics research regional climate simulations air quality modeling atmosphere ocean coupling and idealized simulations for storm surge analyses the two dimensional hydrodynamic module delft3d flow developed by deltares 2017 was adopted forced with tidal levels wind and pressure fields given by wrf delft3d flow hydrodynamic model can produce a prediction of water surface elevation by solving the navier stokes equations on a rectilinear or a curvilinear boundary fitted grid for an incompressible fluid under the shallow water and the boussinesq assumptions governing equations of the numerical hydrodynamic modeling system delft3d flow consists of the horizontal equations of motion the continuity equation and the transport equations for conservative constituents 3 2 model configuration to resolve features that may control atmosphere and flow behavior over the region of interest efficiently and accurately two way triply nested grid wrf simulations were configured fig 4 table 2 the outer domain covers multinational territory including the western philippine sea the northern south china sea and the southern east china sea most of the typhoon rammasun s path can be simulated in this domain which consists of 331 251 grid points with a coarse resolution of 18 km the intermediate domain has a resolution of 9 km and 139 115 grid points it covers the track of typhoon rammasun from 17 to 19 july 2014 which is the period of the focus of this study the inner domain covers the coastal and inland areas that were significantly affected by rammasun the total number of grids for the inner domain is 190 172 and the corresponding resolution is 3 km the starting time of the wrf simulations is 1200 utc on 17 july about 19 5 h before typhoon rammasun s first landfall the total length of the simulation is 48 h to initialize the wrf simulations the fnl operational global analysis data https rda ucar edu datasets ds083 2 from the national centers for environmental prediction ncep was utilized this dataset has a spatial resolution of 1 and a temporal resolution of 6 h fnl data were interpolated to the respective wrf grid by the wrf preprocessing system boundary conditions are forced every 6 h the wrf physical options were selected based on model validations all simulations ran with 30 vertical sigma levels with a top of 50 hpa a relatively sophisticated microphysics scheme named purdue lin scheme chen and sun 2002 was applied to resolve water vapor cloud and precipitation processes the modified version of the kain fritsch scheme kain 2004 was selected for cumulus parameterization furthermore eta surface layer scheme janjic 1996 and noah lsm scheme chen and dudhia 2001 were adopted for the surface layer and land surface model parameterization all simulations were performed with the yonsei university scheme boundary layer parameterization hong et al 2006 as for atmospheric radiation longwave and shortwave radiation were taken into account by the rapid radiative transfer model rrtm scheme mlawer et al 1997 and mm5 dudhia scheme dudhia 1989 forced by wrf simulation results a nested modeling system based on delft3d flow was utilized to simulate storm surge in the study area fig 5 nested orthogonal curvilinear grids fig 6 were adopted to obtain a good representation of the bathymetry around the qiongzhou strait and simultaneously satisfy the efficiency and accuracy requirements of the storm surge simulation the outer model domain covers major parts of the northern south china sea and the entire coastal waters of guangdong guangxi and hainan province it has one closed land boundary along the coastline in the north and the west and two open sea boundaries in the east at 118 e and in the south at 15 n the outer model consists of 581 981 grids and 382944 elements with a uniform resolution of 2 km in the horizontal direction and 1 km in the latitudinal direction with a varying resolution ranging from 1 km on the edges of the model to about 200 m near the qiongzhou strait the inner model has 334 359 grids and 67865 elements this small model domain focuses on the study area and spans about 174 km from the west open boundary to the east open boundary the bathymetric data for grid cells were obtained from the noaa website https maps ngdc noaa gov viewers wcs client and the survey data around the qiongzhou strait the mean sea level msl was utilized as the water level datum simulations were forced by wind and pressure forces given by wrf simulations and 13 tidal constituents along the ocean boundary simulation starting time and period are the same as those applied in wrf models 3 3 model validation to test the models the typhoon track the wind field and the time series of wind speed given by the wrf model as well as the storm surge provided by the delft3d flow model were validated with available observations and satellite measurements during this process considering the data time and accuracy for the two land cover data introduced in the previous section the globcover 2009 data was applied for model configuration meanwhile simulation results based on the modis 2001 land cover data were also compared with observations as well as satellite measurements by utilizing identical boundary conditions and model configuration fig 7 presents the china meteorological administration s cma best track and the wrf modeled track for typhoon rammasun verification covers the typhoon influence period around the qiongzhou strait from 1200 utc on 17 july 2014 the simulated tracks were determined by locating the minimum sea surface pressure at 6 h intervals which compares well to the best track provided by the cma the root mean square error rmse between the simulated and the observed tracks during this period is 32 25 km for the globcover 2009 and 31 90 km for the modis 2001 land cover data subsequently the daily advanced scatterometer ascat surface wind on july 18 which have spatial resolutions of 0 25 in longitude and latitude bentamy and fillon 2011 was utilized for wrf model validation the results obtained from the ascat satellite measurements and wrf results are compared in fig 8 as can be seen from this figure wrf modeled daily averaged wind field reproduces the wind speeds and wind directions well on both land cover scenarios meanwhile as the outputs of the wrf model wind speed collected by the two stations fig 7 were utilized for validation fig 9 the rmse of wind speed with globcover 2009 land cover data at these two stations is 3 07 m s with a correlation coefficient of 0 94 the good consistency between the simulated and the observed wind speed indicates that the triply nested grid wrf model can provide wind field for the hydrodynamic model besides under the influence of modis 2001 land cover data the corresponding rmse as well as the correlation coefficient of wind speed at the two stations are 5 42 m s and 0 92 eventually the observation data of storm surge during typhoon rammasun event collected by xiuying and naozhou stations were utilized to validate and assess the capacity of the hydrodynamic model as illustrated in fig 9 c d the simulation of the surge process is valid at xiuying station the rmse and the correlation coefficient of the simulated storm surge under globcover 2009 land cover data from the measured are 0 35 m and 0 87 respectively while these two values are 0 38 m and 0 86 under the modis 2001 scenario as for the naozhou station the averaged rmse and the correlation coefficient under two land cover scenarios are 0 27 m and 0 91 respectively according to the validation results the hydrodynamic delft3d flow model could provide a reasonable simulation of storm surge during the typhoon process under the premise of the accurate simulation of wind field given by wrf in summary good consistency between the simulated and the observed typhoon track wind field and storm surge confirmed the capacity of the model which laid a solid foundation for further discussion about the effect of land cover on atmospheric and storm surge simulations 4 response of wind field and storm surge simulations to land cover change based on the model configuration and validation mentioned above established models were further utilized to test the effect of different land cover data on wind field and storm surge simulations the method involved simulating typhoon rammasun event with the globcover 2009 land cover data followed by simulating the same event using identical boundary conditions and model configuration with the modis 2001 land cover data a comparison was then conducted between the results obtained with these two scenarios to find out whether the atmospheric and storm surge simulations are impacted by the land cover changes in this region 4 1 impacts of land cover change on wind field to characterize wrf land cover change impacts on wind field in the study area spatial distributions of the wind field at two selected points of time were selected for analysis fig 10 illustrates the wind field distributions under the two land cover scenarios and their differences at 07 00 utc 18 july 2014 typhoon rammasun made its first landfall on hainan island around this time comparisons of the wind field distribution patterns under two land cover scenarios clearly show that the change of land cover causes apparent variation of the wind field in the study area since the typhoon center is close to the mainland the shape of wind distribution near the typhoon center changes under the influence of land cover variation the shape of simulated typhoon center under the globcover 2009 scenario is rounder than that under the modis 2001 scenario the modis 2001 scenario simulation presents stronger maximum wind speeds on the northeastern side of the typhoon center than the globcover 2009 scenarios simulation the differences in this area are mainly larger than 5 m s with a maximum difference of 19 73 m s nevertheless the results of the modis 2001 scenario in the south side near the center are covered by lower wind speeds the biggest difference reaches 26 64 m s in large areas on the northeastern hainan island and a small area on the southeastern leizhou peninsula the wind speed calculated under the modis 2001 scenario is at least 5 m s slower than that under the globcover 2009 scenario at 12 00 utc july 18 the typhoon center had crossed the qiongzhou strait and moved around to its second landfall location in guangdong province fig 11 with further interaction between typhoon rammasun and land cover the effect of land cover change on wind field is further enhanced the difference of the wind distribution shape near the typhoon center under the two land cover scenarios is even more significant the shape of simulated typhoon center under the globcover 2009 scenario is further rounder than that under the modis 2001 scenario besides a similar distinction between the two scenarios has been found on the northeastern side of the typhoon center in this strip area the simulated wind speeds under modis 2001 scenario are on average higher than that under globcover 2009 scenario differences are generally larger than 5 m s with a maximum value of 18 17 m s meanwhile the modis 2001 scenario also results in higher wind speeds on the local southern side of the typhoon center with a maximum difference of 17 95 m s as for the southeastern leizhou peninsula the northeastern hainan island and southeastern side of the typhoon center the modis 2001 scenario generates lower wind speeds with differences larger than 10 m s in local areas simulated variation of wind field between the selected two land cover data can be explained by different land cover distribution in this area in the noah land surface model which has been applied in the established wrf model a series of physical parameters are determined based on land cover class such as surface albedo roughness length minimal stomatal resistance and visible solar flux chen and dudhia 2001 the noah land surface model is sensitive to the processing of these parameters especially the calculation of the roughness length for heat moisture the roughness length is specified according to the given dominant land cover class this parameter plays a key role in determining the surface exchange coefficient for heat and moisture thus affecting the simulation of surface wind the change in land cover can significantly lead to different roughness lengths in the study area as can be seen from fig 3 and table 1 an obvious distinction between the two land cover data is found for the evergreen broadleaf mixed forest evergreen needleleaf as well as urban and built up land which all have higher roughness length because of the counterclockwise rotation of typhoon winds the southeastern leizhou peninsula and the northeastern hainan island can affect the typhoon center directly significant distinctions of land cover characteristics between these two data are bound to cause different wind speed in this area 4 2 impacts of land cover change on storm surge through the change of wind field storm surge is mainly produced by water being pushed toward the shore by the force of typhoon induced winds numerous researches have demonstrated the importance of wind field in storm surge simulations lakshmi et al 2017 torres et al 2019 wang et al 2017 yin et al 2017 2018 as illustrated in the previous section different land cover data result in obvious variation of wind field in study area to further improve the understanding of land cover contribution during a typhoon period the impacts of land cover change on storm surge simulation were also investigated by the validated hydrodynamic model in the numerical model only wind field was updated due to the variations of land cover data while the other factors remained unchanged to illustrate the storm surge response to land cover data the difference of storm surge modis 2001 scenario minus globcover 2009 scenario at two time points between the globcover 2009 and modis 2001 land cover data are shown in fig 12 examination of the spatial distribution of storm surge differences between the two land cover data scenarios reveals that the impacts of land cover change on storm surge are significant at 07 00 utc 18 july 2014 when typhoon rammasun made its first landfall on hainan island the modis 2001 scenario induces larger storm surge around the qiongzhou strait especially in the eastern coastal areas of the leizhou peninsula the difference is between 0 03 m and 0 06 m around the qiongzhou strait while this value reaches 0 10 m in the southeastern leizhou peninsula and even 0 15 m in the eastern area since the eastern sea areas are closer to the typhoon center and wind speed differences are more significant in this area difference values in the areas north of the typhoon center in the eastern leizhou peninsula are larger than those on the other sea areas in the west coastal areas of the qiongzhou strait difference values are basically lower than 0 025 m this spatial pattern can be explained by the wind field difference between the two land cover scenarios at this time as can be seen from fig 10 the modis 2001 scenario generates larger wind speed in the north of the typhoon center east of the leizhou peninsula thus causing larger storm surge distinction in this area when the typhoon center moves to its second landfall location there are also considerable differences in storm surge between the two land cover scenarios in the qiongzhou strait north of haikou city the modis 2001 scenario changes storm surge by 0 06 m 0 13 m in the southeastern leizhou peninsula the variation reaches 0 20 m meanwhile the modis 2001 scenario decreases storm surge by 0 15 m in the east of the land away from the typhoon center similar to the results at 07 00 the variation of storm surge in the eastern areas are larger than those in the western areas such a variation pattern is also related to the wind field differences shown in fig 11 5 conclusions this study is intended to evaluate the influence of land cover representation data on atmospheric and storm surge around the qiongzhou strait using typhoon rammasun 2014 as a case study for this purpose a triply nested wrf atmospheric model and a nested hydrodynamic delft3d flow model have been established for temporal and spatial varying wind field and storm surge simulations respectively two land cover data including the modis 2001 and the globcover 2009 data have been utilized for further comparative analysis the model simulated typhoon track compares well with observations while the calculated daily averaged wind field wind speed and storm surge match well with satellite measurements as well as time series of observed values at several stations accordingly reliable performances have been produced of established models in simulating typhoon wind field and storm surge in the studied region the comparative analysis shows that different land cover distributions can lead to variation of wind speed and storm surge simulation results during a typhoon period maximum differences in wind speed and storm surge can reach 26 64 m s and 0 15 m in the example analysis spatial distributions of land cover classes are relatively distinct between the modis 2001 and the globcover 2009 land cover data different land cover classes bring about notable distinct roughness lengths based on the noah land surface model thus further cause wind field changes in the study area such wind field difference eventually leads to obvious distinctions of storm surge simulation results the results provided in this paper improve our understanding of the performance of land cover data in the typhoon wind field and storm surge the model predicted influencing results provide valuable supports in assessing the role of potential land cover change on local hydrology and climate meanwhile understanding the effects of land cover will contribute to further development in the storm surge simulations such as the improvement in the meteorological inputs joint researches should be strengthened in the fields of engineering atmospheric science and ocean science as this is of great significance to the development of ocean engineering however it should be noted that regional land cover changes could in fact differ significantly due to distinct human and natural processes even in the case where the land covers are of similar features owing to the complexities of depending on many factors such as terrain elevation river discharge tide waves and sea surface temperature there is no one size fits all response of atmospheric and storm surge to land cover changes therefore further studies are essential to ascertain the impacts of land cover changes more accurately credit authorship contribution statement kai yin methodology formal analysis writing original draft writing review editing visualization sudong xu conceptualization supervision project administration funding acquisition quan zhao software investigation validation wenrui huang supervision ke yang software meiting guo validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by the national natural science foundation of china grant number 51879043 and the china scholarship council for supporting the visit to florida state university 
22056,this paper proposes two robust dynamic positioning dp approaches for autonomous surface vessels when full states are measurable and when only partial states are available with measurement errors high fidelity nonlinear hydrodynamics are considered which are approximated as linear models in the local area of dp setpoint the linearization errors are seen as bounded unmodeled dynamics and are accommodated in the tube based model predictive control mpc together with environmental disturbances the tube based mpc controller contains all the possible uncertain trajectories in a tube that is based on a precomputed robust positive invariant set and a nominal trajectory solved online the total controller consists of a feedforward part compensating the predicted environmental forces a nominal part guiding the vessel towards and stabilizing it at the origin and an affine feedback part bounding the uncertain vessel trajectory within the tube furthermore an output feedback robust dp controller is proposed by utilizing a simple luenberger observer to estimate the system states when full states are not available the resultant estimation and measurement errors are also incorporated in the tube based mpc simulation results show that the proposed full state and output feedback robust dp controllers can achieve the dp goals within system constraints keywords robust dynamic positioning model predictive control output feedback control observer autonomous surface vessels 1 introduction autonomous surfaces vessels asvs have been widely used for various purposes e g military environment monitoring and rescue zheng et al 2013 asvs can be seen as a special type of robotic systems in the sense that they can comprehend the surroundings and figure out what to do autonomously however the major difference of asvs with the frequently encountered ground robots is that asvs maneuver in the fluid therefore usually complex hydrodynamics are involved and the system itself cannot stay at its equilibrium when exposed to the fluid disturbances besides sensors for localization and velocities are generally more expensive with degraded performance over water these issues brought about new challenges in maintaining asvs in a fixed position for offshore operations principally there are two ways to maintain a fixed asv pose over water by using external mooring lines tethers or by thrusters the case when thrusters are exclusively used is the so called dynamic positioning dp and is known to be more flexible fossen 2011 the large body of literature on dp control systems until 2011 are reviewed and discussed in sørensen 2011 and the references therein representative dp control methods include the widely implemented pid controllers cetin and akkaya 2010 nonlinear passivity theory based control fossen and strand 1999 and sliding mode control tannuri et al 2010 the methods in fossen and strand 1999 tannuri et al 2010 can deal with vessel nonlinear hydrodynamics directly while pid usually needs to be equipped with gain scheduling torsetnes et al 2004 or fuzzy logic cetin and akkaya 2010 designs to deal with nonlinearities however these methods are often associated with tedious tuning procedure and the control performance differs when the environment load or tasks change the environmental disturbances also play an important role in the dp control performance kalman filter or the extended kalman filter fossen and perez 2009 sørensen et al 1996 is commonly used for estimating the vessel motion states and for filtering disturbances working together with the previous mentioned controllers however most kalman filter based designs assume that the separation principle holds so that the controller and the observer could be designed separately which is not valid if system constraints are imposed more recent approaches utilize integrated controller and observer designs and achieve robust bounded control performance when uncertain environmental disturbances exist an adaptive backstepping control law is proposed in witkowska and śmierzchalski 2018 to accommodate the unknown environmental disturbances system constraints are considered in the low level control allocation problem the high gain observer approach with an auxiliary dynamic system to deal with the estimation error has been popular in dp control systems see e g du et al 2015 du et al 2016 lin et al 2018 in du et al 2015 the robustness against unknown system dynamic parameters unmeasured velocities and unknown time varying disturbances is achieved by combining adaptive neural networks and high gain observer into the backstepping method the not considered input saturation in du et al 2015 is treated in du et al 2016 a similar high gain observer approach using an adaptive fuzzy system to approximate any continuous system with arbitrary small error is proposed in lin et al 2018 for dp four observer and integral action based methods for compensating of bias loads in dp of vessels are compared in værnø et al 2019 the bias loads estimated from the designed observers with fine tuning can generally work well for the dp problem note that all these controller derivations are based on linear hydrodynamic drag in vessel dynamics however the real vessel dynamics are inherently nonlinear and the effects of the unmodeled dynamics in the presence of environmental disturbances should be kept in mind besides the dp task is often accomplished without considering the control efforts taken i e not in an optimal way by employing the vessel parallel coordinate and linear hydrodynamic drag fossen 2011 linear control methods such as linear quadratic gaussian fossen and perez 2009 sørensen et al 1996 can be applied to achieve optimal control performance however using a new coordinate system might complicate the problem formulation if design criteria or system limitations are specified in the conventional coordinate system moreover since optimal solutions generally occur on the boundary of feasible regions the unmodeled dynamics as uncertainties could degrade the control performance or result in actuator failures if not properly handled in addition to systematically handling system constraints and optimizing performance model predictive control mpc mayne 2014 can be designed to be robust to various types of disturbances e g unmodeled dynamics yan and wang 2012 bounded mayne et al 2005 and stochastic disturbances kouvaritakis et al 2010 in robust mpc an intuitive idea is to compute the open loop predicted trajectory by taking into account of all possible realizations of uncertainties over the prediction horizon min max routines can then be applied as in yan and wang 2012 jia and krogh 2002 however this could lead to conservativeness and even infeasibility incorporating feedback in predictions have therefore become standard practice for controlling uncertain systems using mpc tube based mpc which has the same order of complexity as that of conventional mpc trades off complication and conservativeness with an affine local feedback policy mayne et al 2005 the tube containing all possible system trajectories uses a nominal trajectory as its center and uncertainties that are steered to the center by the local feedback as cross sections rigorous robust mpc synthesis has been derived for a class of constrained linear discrete time invariant system with bounded disturbances mayne et al 2005 raković et al 2012 robust mpc has been successfully applied to the stabilization li and yan 2017 tracking zheng et al 2016a integrated motion and torque allocation veksler et al 2016 distributed tracking control zheng et al 2018 and vessel platooning chen et al 2018 problems of marine surface vessels system robustness against uncertainties optimal control performance and constraint satisfactions are systematically achieved when all the states can be measured accurately however localization and velocity states of marine surface vessels are usually only measured partially with errors moreover due to the complexity of the utilized prediction models closed loop system properties are not analyzed zheng et al 2018 research on dp of asvs with system constraints unmodeled system dynamics partially measured states with errors and uncertain environmental disturbances using mpc to the best of our knowledge has not been presented in the literature to date in this paper we propose using tube based mpc to design robust dp controllers for asvs in dealing with all these factors simultaneously in face of system constraints nonlinear hydrodynamics partially measured system states with errors and uncertain external environmental forces the vessel can still converge to and maintain within a bounded neighborhood of the specified dp pose at optimal control efforts for the convenience of controller design and tractability of the mpc optimization problems we approximate the system dynamics in the local area of dp as a linear uncertain model by jacobian linearization at the equilibrium point the unmodeled dynamics act as a type of additional bounded disturbances in addition to the environmental uncertainties both full state feedback and output feedback robust dp controllers are designed in the framework of tube based mpc a luenberger observer is designed to estimate the system states when only partially inaccurate states are available simulation results demonstrate the effectiveness of the proposed robust dp controllers the remainder of the paper is organized as follows section 2 presents the dp problem formulation and the dynamic models of asvs then in section 3 the robust dp controller with tube based mpc is first proposed when full system states are available when system states are only measured partially an output feedback robust mpc controller is further proposed in section 4 section 5 presents simulation results and discussions followed by concluding remarks and future research directions in section 6 2 modeling of asvs for dp for designing the dp robust controller that maintains the vessel s position and heading we consider the three degree of freedom dof low frequency marine surface vessel motion model on the horizontal plane as shown in fig 1 the vessel s motions are influenced not only by active thrusters but also by the uncontrollable environmental disturbances due to wind waves and currents in open waters dynamics of surface vessels considering forces and moment due to wind waves and currents are modeled following the notations in fossen 2011 as 1 η t r ψ t ν t 2 ν t m 1 τ t τ env t b t c ν t ν t d ν t ν t where r ψ t is the rotation matrix converting motions from body fixed frame b to the inertial north east down frame n with r ψ t cos ψ t sin ψ t 0 sin ψ t cos ψ t 0 0 0 1 m r 3 3 is the mass matrix including the rigid body mass and added mass c ν t r 3 3 is the nonlinear coriolis and centripetal matrix and d ν t r 3 3 is the nonlinear damping matrix system states η t t ν t t t x t y t ψ t u t v t r t t are translational rotational positions and speeds in n and b respectively the control input force is τ t τ u t τ v t τ r t t from the active thrusters on surge sway and yaw generally marine surface vessels only set schedules to travel in a certain limit of weather conditions based on weather forecast for example the port authority cooperates with local water management organizations and installs hydrological and meteorological sensors at different locations in the port of rotterdam to provide information ranging from visibility tides flow rates wave heights to wind speeds and directions port of rotterdam 2015 however predictions with weather forecast and sensor information are not accurate enough and are usually with prediction errors therefore we assume that the uncontrollable predicted input τ env t due to environmental disturbances could in principle be obtained from the meteorological predictions but with bounded uncertain prediction errors b t w with w being a compact set containing the origin in the interior and τ env t τ u env t τ v env t τ r env t b t b u t b v t b r t t when those extreme disturbances do occur or when the weather forecast accuracy cannot be guaranteed rarely though extra safety and recovery mechanisms need to be designed which falls out of the scope of this paper the certain limit of weather condition a surface vessel can be against to is limited by the designed thrust and power capacity therefore the physical limitations on vessel motions and inputs need to be satisfied as 3 η min η t η max 4 ν min ν t ν max 5 τ min τ t τ max where min and max denote minimal and maximal values of corresponding parameters for scenarios over water sensors like gps and accelerometer are usually installed on marine structure to measure the system states however high accuracy sensors are usually expensive and speed sensors are frequently not installed denote the measured system output y t as 6 y t c η t t ν t t t v based on 6 when all the system states η t t ν t t t can be measured accurately c i 6 6 and v 0 a full state feedback robust controller is designed in section 3 when only localization sensors are available and measurement errors exist i e c i 3 3 0 3 3 and v 0 an output feedback robust controller is designed in section 4 3 robust dp control with full state feedback in this section considering the nonlinear uncertain vessel dynamics 1 2 with full state feedback we design a robust dp controller with tube based mpc mayne et al 2005 the vessel is guaranteed to converge to and maintain at a bounded neighborhood of the specified dp position and heading with as small as possible control efforts all state and actuator constraints are satisfied in spite of environmental disturbances specifically a feedforward controller is first designed converting the equilibrium point of 1 2 to the origin then linearization at the equilibrium point of the feedforward controlled system is applied to decompose the system into a linear time invariant model and higher order taylor series terms the higher order terms together with the environmental uncertainties are treated as bounded errors which are then accommodated in the designed tube based mpc controller 3 1 feedforward control and linearization given the predicted environmental force values τ env t define 7 u t τ t τ env t i e the actually implemented thruster forces are τ t u t τ env t with feedforward compensation for the predicted environmental forces then the vessel dynamics 1 2 is generalized for notational consistency and simplicity as 8 x f x t u t b t with f r 6 r 3 r 3 r 6 being continuous and f 0 0 0 0 system states control inputs and unknown disturbance inputs are represented by x k r 6 u k r 3 and b k r 3 respectively the nonlinearity and uncertainty in 8 with constraints 3 5 render a robust controller design and implementation extremely difficult if not impossible therefore for computational efficiency and controller design easiness we apply jacobian linearizations to 8 at the origin and approximate 8 as 9 x a c x t b c u t e c b t ε t where a c f x 0 0 0 b c f u 0 0 0 e c f b 0 0 0 and ε t r 6 represents the higher order taylor series term since f is continuous x u b are all bounded and contains the origin in the interior the linearization error ε t e which is also bounded and contains the origin in its interior and ε t 0 when x u b 0 0 0 note that linearized vessel dynamics have also been successfully applied in tracking controller designs in zheng et al 2016b zheng et al 2014 the performance of using the original nonlinear dynamics 1 2 and linearized prediction models of marine surface vessels in mpc has been compared in zheng et al 2014 the performance of the linearized mpc without considering the effects of linearization errors is comparable to the nonlinear mpc by treating the linearization errors as bounded uncertainties that are then handled in the tube based control framework is therefore expected to achieve better performance for numerical simulations 9 is usually discretized by zero order hold assumption as 10 x k 1 ax k bu k eb k ε k where a b and e are the discrete time matrices corresponding to a c b c and e c moreover for the considered vessel dynamics a b is controllable and a c is observable the discrete time k relates to t as t k t s with sampling time t s 3 2 robust dp with tube based mpc for the dp problem of asvs the main idea of tube based robust mpc mayne et al 2005 is to contain all the possible uncertain vessel trajectories in a tube the tube center is generated by solving online nominal convex optimization problems and the tube cross section is precomputed offline as robust positive invariant sets based on 10 and the bounded uncertainties controlled vessel trajectories for every possible realization of the uncertainties then evolve around the tube center within the tube and converge to the specified dp position and heading for the mpc problem we consider the predicted vessel trajectories over a future finite prediction horizon n p zheng et al 2016b whenever contextually clear we denote i k as the ith prediction step at time step k with i 0 1 n p 1 for control inputs and i 0 1 n p for system states then the uncertain predicted system state trajectories x i k are partitioned as 11 x i k x i k e i k where x denotes the nominal state trajectory and e is the deviation of the actual state x i k from the nominal state x i k on the one hand the tube cross section may be unnecessarily large resulting in conservativeness if an open loop control sequence without feedback is directly employed on the other hand optimizing over arbitral feedback policies is untractable therefore the simple affine feedback policy is introduced to restrict the size of tube cross sections as 12 u i k u i k ke i k where k is a time invariant feedback gain and is chosen such that a k a bk is stable in our case k is computed offline as the feedback gain of the infinite horizon linear quadratic regulator for the unconstrained system 10 with proper weighting matrices then we could decompose the closed loop system with 12 as a nominal part 13 x i 1 k a x i k b u i k and an uncertain part 14 e i 1 k a k e i k eb i k ε i k where b w and ε e denote the sets for the uncertain system dynamics 14 as s i i e e i k s i we further have s i 1 a k s i e w e and therefore 15 s i a k i s 0 j 0 i 1 a k j e w e note that since the system matrices of 10 and the compact sets w e are all time invariant the set s i is also irrelevant with time step k moreover the sets s i are expected to be smaller than those calculated from open loop unstable a since a k is now stable by design the operator denotes the minkowski set sum defined as a b a b a a b b with some abuse of notations since a k is stable the robust positive invariant set s exists for 15 mayne et al 2005 i e i b w ε e if e 0 k s then e i k s i i i 0 however the computation of s is difficult in practice we could compute an robust positive invariant outer approximation set s s as in rakovic et al 2005 with s 1 α 1 s n p to reduce conservativeness α 0 1 should be chosen suitably small therefore 11 can be written as a tube x i k with x i k as the center and s as cross sections as demonstrated in fig 2 would be 16 x i k x i k s likewise 12 is written as 17 u i k u i k k s if c x and c u are denoted as system state and input constraint sets respectively imposed by actual system constraints 3 5 and c x f is denoted as the terminal positive invariant constraint set mayne et al 2000 for 10 with c x and c u then all state and input trajectories by tubes 16 17 need to satisfy x i k c x x n p k c x f u i k c u equivalently the nominal state and input trajectories x i k and u i k need to satisfy tighter constraints as 18 x i k c x s 19 x n p k c x f s 20 u i k c u k s where the operator denotes minkowski set difference defined as a b a b a a b b assumption 1 the bounded uncertainties b and ε are all small so that s c x s c x f and k s c u assumption 1 can be satisfied if the vessel only operates when the weather forecast is precise and operates within a local area of the dp setpoint large system constraint sets could also help tolerate relatively large uncertainty values with assumption 1 the nominal optimal predictive control problem for the robust dp of asvs is then readily formulated as 21 min u i k x n p k q f 2 i 0 n p 1 x i k q 2 u i k r 2 subject to 13 18 20 the nominal cost function 21 aims to steer the nominal state trajectory to the origin with optimal control efforts the three terms are the terminal cost the stage cost and the control input cost the notation x i k q 2 x i k t q x i k and the same go for the control input cost and the terminal cost q q and q f are positive definite weighting matrices for the respective cost terms and can be adjusted to set priority between convergence speed and control efforts the terminal weight matrix q f is chosen as the solution to the corresponding riccati equation mayne 2014 the robust positive invariant set s feedback gain k terminal weighting matrix q f and the terminal constraint set c x f can all be precomputed offline the online optimization problem 21 subject to 13 18 20 has comparable computational complexity with that of the conventional mpc moreover with assumption 1 the nominal problem is feasible and is guaranteed to converge to the system origin mayne et al 2000 then the uncertain system is guaranteed to converge to a bounded neighborhood s around the origin 4 output feedback robust controller design in the previous section we have considered the robust dp problem using tube based mpc with full state feedback i e c i 6 6 and v 0 however system states are usually only partially and roughly available over water due to the cost and inaccuracy of marine application oriented sensors therefore we extend the full state feedback robust dp controller to an output feedback robust controller mayne et al 2006 in this section a luenberger observer is designed to estimate the system states based on the output measurement errors and estimation errors are both accommodated by treating them as extra system bounded disturbances we now consider only the vessel pose states are available i e c i 3 3 0 3 3 and there exist unknown bounded measurement errors i e v v with v being a compact set containing the origin in its interior with output y we design the luenberger observer dynamics as 22 x ˆ k 1 a x ˆ k bu k l y k y ˆ k 23 y ˆ k c x ˆ k where x ˆ k r 6 is the estimated state at time step k and l is luenberger observer gain with l t g x 1 where g is a arbitrary matrix set to the identity matrix hereby and x is the solution to the sylvester equation hou et al 1999 a t x x a k c t g combining 10 6 22 and 23 we have 24 x k 1 a l x k eb k ε k lv where x k x k x ˆ k is the state estimation error and a l a lc with ρ a l 1 by design the estimation error of 22 from 9 can be bounded as a robust positive invariant set as in 15 since ρ a l 1 eb k ε k lv is a compact set containing the origin in its interior there exists a robust positive invariant set s so that if x k s then b k w ε e v v x k 1 s to extend the tube based mpc design in section 3 we can now consider 13 as the nominal observer dynamics for 22 instead of the state dynamics 9 and bound the real state trajectory x k around x ˆ k with some abuse of notations define e k x ˆ k x k now as the error between the observer state and nominal state the affine feedback policy u k u k ke k then the closed loop observer dynamics are 25 x ˆ k 1 a x ˆ k b u k bke k l c x k v k with x k s combining 13 with 25 14 becomes 26 e i 1 k a k e i k l c x k v k and a k is the same as before and is stable by design since l c x k v k is compact and contains the origin in its interior there still exists the robust positive invariant set s for 26 therefore we now can confine the real state trajectory which is 27 x k x k x k e k in a tube with x k as the center and s s as the cross section as shown in fig 3 the nominal state and input trajectory can be obtained by solving a similar problem with 21 the overall robust dp with output feedback tube based mpc can be implemented as algorithm 1 note step 4 is implemented in case the bounded disturbance assumptions are not satisfied algorithm 1 output feedback robust dp for asvs image 1 5 simulation results and discussions simulations are carried out to demonstrate the effectiveness of the proposed robust dp algorithms for asvs with full state feedback and output feedback the vessel is initially positioned at a location away from the origin and is controlled to converge to and maintain at the origin with specified heading in spite of environmental disturbances due to wind waves and currents it is assumed that the environmental forces acting on the vessel hull can be predicted however there exist bounded prediction errors in the simulations the considered uncertainties b ε and v are implemented as random but bounded values i e numbers that follow normal distribution but are truncated with lower upper bounds in fossen and strand 1999 fossen and perez 2009 uncertainties are also considered as white gaussian noises following normal distributions particularly the boundary values for the uncertainties are set as b 0 28 ε 0 2 and v 0 2 controller parameters are set as follows prediction horizons n p 6 for the full state feedback controller and n p 10 for the output feedback controller weight parameter q d i a g 10 10 0 1 0 1 0 1 0 1 where d i a g means diagonal matrices r i 3 3 sampling time t s 0 5 s physical system constraints are 10 10 π 0 65 0 5 0 8 t x 10 10 π 0 5 0 5 0 8 t and τ max τ min 7 4 4 t note that the simulated vessel dynamics 1 2 are based on a 1 70 small scaled vessel model cs ii fossen 2011 therefore the parameter values involved in the system dynamics and constraints have been down scaled accordingly based on the froude scaling law moreira et al 2007 all the algorithms are implemented in matlab 2016b matlab 2016 with solver cplex ilog 2010 on a platform with intel r core tm i3 7100 cpu 3 70 ghz 5 1 full state feedback robust dp when full system states are measured accurately the vessel s real trajectory is confined within a tube with a nominal trajectory as the center and an offline computed robust positive invariant set as the cross section as the nominal trajectory converges to the origin the tube that contains the real trajectory converges to a bounded neighborhood of the origin as shown in fig 4 the vessel is initially positioned at 1 1 with uncertain environmental disturbances with the proposed robust dp controller the green nominal trajectory converges to 0 0 around the discrete nominal north east positions we also plot the robust positive invariant bounded sets s that form the tube together with the nominal trajectory the red real trajectory then evolves within the tube and also converges to and maintains at the neighborhood of origin although environmental disturbances exist by solving the nominal mpc problem 21 original system constraints are tightened fig 5 and fig 6 show the speed and control input trajectories respectively on surge sway and yaw the nominal trajectories satisfy the tightened constraints and the real trajectory satisfy the original constraints fig 7 and fig 8 further show the constraint satisfactions of the speed and control input trajectory over the prediction horizon at one time step note that the nominal and real trajectories are not fitting tightly to the system limits this is partly due to the design of tube cross sections and partly due to the approximated feedback control policy 12 for the trade off between conservativeness and computational complexity 5 2 output feedback robust dp when only partial system states are measured with errors fig 9 shows the nominal trajectory the estimated trajectory and the real vessel trajectory from the initial position to the origin it can be seen that the nominal trajectory converges to and stabilizes at the origin the estimated and real trajectories converges to and maintains at the corresponding robust invariant sets s and s s around the origin to show the tube and the trajectories more clearly we further plot the three dimensional set series in fig 10 similar with the full state feedback robust dp controller system constraints are also all satisfied with the output feedback robust dp controller as shown in fig 11 and fig 12 for trajectories over the entire simulation and fig 13 and fig 14 over the prediction horizon at one time step the nominal trajectories are restricted within the tightened constraint limits and the real trajectories are restricted within the original constraint limits the difference between the tightened and original limits can be seen as a type of buffer zones saved for the uncertain bounded disturbances 5 3 comparisons of the two robust dp controllers in practice whether employing the full state feedback controller or the output feedback controller depends on the availability of precise state measurements however to further explore the control performance in simulations we report the comparison results of the proposed robust controllers in fig 15 the east position and north position trajectories of the two controllers are plotted the trajectories controlled by both controllers can converge to zero robustly with comparable tracking errors however the full state feedback controller has faster convergence speed than the oput feedback controller this is not doubtful since the full state feedback controller has more accurate dynamic system information in real time to relieve the potential computational burden of the mpc online optimization problems linearized prediction models 10 are used instead of highly nonlinear dynamics 1 2 therefore the involved online problems are all convex and can be efficiently solved the computational times of the proposed full state feedback and output feedback robust controllers are reported in fig 16 it can be observed that the computational times of the two proposed robust controllers are comparable throughout the simulations the computational times are all around 15 ms and are all far smaller than the system sampling time t s 0 5 s it thus can be concluded that the proposed robust dynamics positioning controllers are in principle suitable for real time applications 6 conclusions and future work depending on whether accurate full vessel states being available or not this paper proposes two robust dynamic positioning dp approaches for autonomous surface vessels asvs the control goals to guarantee that the vessel s pose converges to and maintains within a bounded neighborhood of the specified dp pose have been well achieved under uncertain environmental disturbances we have considered high fidelity nonlinear vessel hydrodynamics and used an approximated linear model in the tube based mpc controller design all the possible uncertain system trajectories lie in a tube that is guided by a nominal trajectory towards the origin and confined by precomputed robust positive invariant sets the online optimization problems have comparable complexity with that of conventional mpc moreover a luenberger observer is designed to estimate the system states when only vessel poses are available with measurement errors the resultant estimation errors and measurement errors are further incorporated in the tube based mpc simulation results have demonstrated the effectiveness of the proposed robust dp controllers in both full state and output feedback cases future research will consider robust trajectory tracking problems of asvs with environmental disturbances credit author statement huarong zheng conceptualization methodology software writing original draft preparation jun wu data curation investigation supervision weimin wu resources investigation writing reviewing and editing supervision funding acquisition yifeng zhang writing reviewing and editing declaration of competing interest none acknowledgements this research is supported in part by the china postdoctoral science foundation china under grant 2019m652086 in part by the national natural science foundation of china under grants 61773343 in part by the key research and development program of guangdong province of china under grant 2019b010120001 and in part by the project of state key laboratory of industrial control technology zhejiang university of china under grant ict1921 
22056,this paper proposes two robust dynamic positioning dp approaches for autonomous surface vessels when full states are measurable and when only partial states are available with measurement errors high fidelity nonlinear hydrodynamics are considered which are approximated as linear models in the local area of dp setpoint the linearization errors are seen as bounded unmodeled dynamics and are accommodated in the tube based model predictive control mpc together with environmental disturbances the tube based mpc controller contains all the possible uncertain trajectories in a tube that is based on a precomputed robust positive invariant set and a nominal trajectory solved online the total controller consists of a feedforward part compensating the predicted environmental forces a nominal part guiding the vessel towards and stabilizing it at the origin and an affine feedback part bounding the uncertain vessel trajectory within the tube furthermore an output feedback robust dp controller is proposed by utilizing a simple luenberger observer to estimate the system states when full states are not available the resultant estimation and measurement errors are also incorporated in the tube based mpc simulation results show that the proposed full state and output feedback robust dp controllers can achieve the dp goals within system constraints keywords robust dynamic positioning model predictive control output feedback control observer autonomous surface vessels 1 introduction autonomous surfaces vessels asvs have been widely used for various purposes e g military environment monitoring and rescue zheng et al 2013 asvs can be seen as a special type of robotic systems in the sense that they can comprehend the surroundings and figure out what to do autonomously however the major difference of asvs with the frequently encountered ground robots is that asvs maneuver in the fluid therefore usually complex hydrodynamics are involved and the system itself cannot stay at its equilibrium when exposed to the fluid disturbances besides sensors for localization and velocities are generally more expensive with degraded performance over water these issues brought about new challenges in maintaining asvs in a fixed position for offshore operations principally there are two ways to maintain a fixed asv pose over water by using external mooring lines tethers or by thrusters the case when thrusters are exclusively used is the so called dynamic positioning dp and is known to be more flexible fossen 2011 the large body of literature on dp control systems until 2011 are reviewed and discussed in sørensen 2011 and the references therein representative dp control methods include the widely implemented pid controllers cetin and akkaya 2010 nonlinear passivity theory based control fossen and strand 1999 and sliding mode control tannuri et al 2010 the methods in fossen and strand 1999 tannuri et al 2010 can deal with vessel nonlinear hydrodynamics directly while pid usually needs to be equipped with gain scheduling torsetnes et al 2004 or fuzzy logic cetin and akkaya 2010 designs to deal with nonlinearities however these methods are often associated with tedious tuning procedure and the control performance differs when the environment load or tasks change the environmental disturbances also play an important role in the dp control performance kalman filter or the extended kalman filter fossen and perez 2009 sørensen et al 1996 is commonly used for estimating the vessel motion states and for filtering disturbances working together with the previous mentioned controllers however most kalman filter based designs assume that the separation principle holds so that the controller and the observer could be designed separately which is not valid if system constraints are imposed more recent approaches utilize integrated controller and observer designs and achieve robust bounded control performance when uncertain environmental disturbances exist an adaptive backstepping control law is proposed in witkowska and śmierzchalski 2018 to accommodate the unknown environmental disturbances system constraints are considered in the low level control allocation problem the high gain observer approach with an auxiliary dynamic system to deal with the estimation error has been popular in dp control systems see e g du et al 2015 du et al 2016 lin et al 2018 in du et al 2015 the robustness against unknown system dynamic parameters unmeasured velocities and unknown time varying disturbances is achieved by combining adaptive neural networks and high gain observer into the backstepping method the not considered input saturation in du et al 2015 is treated in du et al 2016 a similar high gain observer approach using an adaptive fuzzy system to approximate any continuous system with arbitrary small error is proposed in lin et al 2018 for dp four observer and integral action based methods for compensating of bias loads in dp of vessels are compared in værnø et al 2019 the bias loads estimated from the designed observers with fine tuning can generally work well for the dp problem note that all these controller derivations are based on linear hydrodynamic drag in vessel dynamics however the real vessel dynamics are inherently nonlinear and the effects of the unmodeled dynamics in the presence of environmental disturbances should be kept in mind besides the dp task is often accomplished without considering the control efforts taken i e not in an optimal way by employing the vessel parallel coordinate and linear hydrodynamic drag fossen 2011 linear control methods such as linear quadratic gaussian fossen and perez 2009 sørensen et al 1996 can be applied to achieve optimal control performance however using a new coordinate system might complicate the problem formulation if design criteria or system limitations are specified in the conventional coordinate system moreover since optimal solutions generally occur on the boundary of feasible regions the unmodeled dynamics as uncertainties could degrade the control performance or result in actuator failures if not properly handled in addition to systematically handling system constraints and optimizing performance model predictive control mpc mayne 2014 can be designed to be robust to various types of disturbances e g unmodeled dynamics yan and wang 2012 bounded mayne et al 2005 and stochastic disturbances kouvaritakis et al 2010 in robust mpc an intuitive idea is to compute the open loop predicted trajectory by taking into account of all possible realizations of uncertainties over the prediction horizon min max routines can then be applied as in yan and wang 2012 jia and krogh 2002 however this could lead to conservativeness and even infeasibility incorporating feedback in predictions have therefore become standard practice for controlling uncertain systems using mpc tube based mpc which has the same order of complexity as that of conventional mpc trades off complication and conservativeness with an affine local feedback policy mayne et al 2005 the tube containing all possible system trajectories uses a nominal trajectory as its center and uncertainties that are steered to the center by the local feedback as cross sections rigorous robust mpc synthesis has been derived for a class of constrained linear discrete time invariant system with bounded disturbances mayne et al 2005 raković et al 2012 robust mpc has been successfully applied to the stabilization li and yan 2017 tracking zheng et al 2016a integrated motion and torque allocation veksler et al 2016 distributed tracking control zheng et al 2018 and vessel platooning chen et al 2018 problems of marine surface vessels system robustness against uncertainties optimal control performance and constraint satisfactions are systematically achieved when all the states can be measured accurately however localization and velocity states of marine surface vessels are usually only measured partially with errors moreover due to the complexity of the utilized prediction models closed loop system properties are not analyzed zheng et al 2018 research on dp of asvs with system constraints unmodeled system dynamics partially measured states with errors and uncertain environmental disturbances using mpc to the best of our knowledge has not been presented in the literature to date in this paper we propose using tube based mpc to design robust dp controllers for asvs in dealing with all these factors simultaneously in face of system constraints nonlinear hydrodynamics partially measured system states with errors and uncertain external environmental forces the vessel can still converge to and maintain within a bounded neighborhood of the specified dp pose at optimal control efforts for the convenience of controller design and tractability of the mpc optimization problems we approximate the system dynamics in the local area of dp as a linear uncertain model by jacobian linearization at the equilibrium point the unmodeled dynamics act as a type of additional bounded disturbances in addition to the environmental uncertainties both full state feedback and output feedback robust dp controllers are designed in the framework of tube based mpc a luenberger observer is designed to estimate the system states when only partially inaccurate states are available simulation results demonstrate the effectiveness of the proposed robust dp controllers the remainder of the paper is organized as follows section 2 presents the dp problem formulation and the dynamic models of asvs then in section 3 the robust dp controller with tube based mpc is first proposed when full system states are available when system states are only measured partially an output feedback robust mpc controller is further proposed in section 4 section 5 presents simulation results and discussions followed by concluding remarks and future research directions in section 6 2 modeling of asvs for dp for designing the dp robust controller that maintains the vessel s position and heading we consider the three degree of freedom dof low frequency marine surface vessel motion model on the horizontal plane as shown in fig 1 the vessel s motions are influenced not only by active thrusters but also by the uncontrollable environmental disturbances due to wind waves and currents in open waters dynamics of surface vessels considering forces and moment due to wind waves and currents are modeled following the notations in fossen 2011 as 1 η t r ψ t ν t 2 ν t m 1 τ t τ env t b t c ν t ν t d ν t ν t where r ψ t is the rotation matrix converting motions from body fixed frame b to the inertial north east down frame n with r ψ t cos ψ t sin ψ t 0 sin ψ t cos ψ t 0 0 0 1 m r 3 3 is the mass matrix including the rigid body mass and added mass c ν t r 3 3 is the nonlinear coriolis and centripetal matrix and d ν t r 3 3 is the nonlinear damping matrix system states η t t ν t t t x t y t ψ t u t v t r t t are translational rotational positions and speeds in n and b respectively the control input force is τ t τ u t τ v t τ r t t from the active thrusters on surge sway and yaw generally marine surface vessels only set schedules to travel in a certain limit of weather conditions based on weather forecast for example the port authority cooperates with local water management organizations and installs hydrological and meteorological sensors at different locations in the port of rotterdam to provide information ranging from visibility tides flow rates wave heights to wind speeds and directions port of rotterdam 2015 however predictions with weather forecast and sensor information are not accurate enough and are usually with prediction errors therefore we assume that the uncontrollable predicted input τ env t due to environmental disturbances could in principle be obtained from the meteorological predictions but with bounded uncertain prediction errors b t w with w being a compact set containing the origin in the interior and τ env t τ u env t τ v env t τ r env t b t b u t b v t b r t t when those extreme disturbances do occur or when the weather forecast accuracy cannot be guaranteed rarely though extra safety and recovery mechanisms need to be designed which falls out of the scope of this paper the certain limit of weather condition a surface vessel can be against to is limited by the designed thrust and power capacity therefore the physical limitations on vessel motions and inputs need to be satisfied as 3 η min η t η max 4 ν min ν t ν max 5 τ min τ t τ max where min and max denote minimal and maximal values of corresponding parameters for scenarios over water sensors like gps and accelerometer are usually installed on marine structure to measure the system states however high accuracy sensors are usually expensive and speed sensors are frequently not installed denote the measured system output y t as 6 y t c η t t ν t t t v based on 6 when all the system states η t t ν t t t can be measured accurately c i 6 6 and v 0 a full state feedback robust controller is designed in section 3 when only localization sensors are available and measurement errors exist i e c i 3 3 0 3 3 and v 0 an output feedback robust controller is designed in section 4 3 robust dp control with full state feedback in this section considering the nonlinear uncertain vessel dynamics 1 2 with full state feedback we design a robust dp controller with tube based mpc mayne et al 2005 the vessel is guaranteed to converge to and maintain at a bounded neighborhood of the specified dp position and heading with as small as possible control efforts all state and actuator constraints are satisfied in spite of environmental disturbances specifically a feedforward controller is first designed converting the equilibrium point of 1 2 to the origin then linearization at the equilibrium point of the feedforward controlled system is applied to decompose the system into a linear time invariant model and higher order taylor series terms the higher order terms together with the environmental uncertainties are treated as bounded errors which are then accommodated in the designed tube based mpc controller 3 1 feedforward control and linearization given the predicted environmental force values τ env t define 7 u t τ t τ env t i e the actually implemented thruster forces are τ t u t τ env t with feedforward compensation for the predicted environmental forces then the vessel dynamics 1 2 is generalized for notational consistency and simplicity as 8 x f x t u t b t with f r 6 r 3 r 3 r 6 being continuous and f 0 0 0 0 system states control inputs and unknown disturbance inputs are represented by x k r 6 u k r 3 and b k r 3 respectively the nonlinearity and uncertainty in 8 with constraints 3 5 render a robust controller design and implementation extremely difficult if not impossible therefore for computational efficiency and controller design easiness we apply jacobian linearizations to 8 at the origin and approximate 8 as 9 x a c x t b c u t e c b t ε t where a c f x 0 0 0 b c f u 0 0 0 e c f b 0 0 0 and ε t r 6 represents the higher order taylor series term since f is continuous x u b are all bounded and contains the origin in the interior the linearization error ε t e which is also bounded and contains the origin in its interior and ε t 0 when x u b 0 0 0 note that linearized vessel dynamics have also been successfully applied in tracking controller designs in zheng et al 2016b zheng et al 2014 the performance of using the original nonlinear dynamics 1 2 and linearized prediction models of marine surface vessels in mpc has been compared in zheng et al 2014 the performance of the linearized mpc without considering the effects of linearization errors is comparable to the nonlinear mpc by treating the linearization errors as bounded uncertainties that are then handled in the tube based control framework is therefore expected to achieve better performance for numerical simulations 9 is usually discretized by zero order hold assumption as 10 x k 1 ax k bu k eb k ε k where a b and e are the discrete time matrices corresponding to a c b c and e c moreover for the considered vessel dynamics a b is controllable and a c is observable the discrete time k relates to t as t k t s with sampling time t s 3 2 robust dp with tube based mpc for the dp problem of asvs the main idea of tube based robust mpc mayne et al 2005 is to contain all the possible uncertain vessel trajectories in a tube the tube center is generated by solving online nominal convex optimization problems and the tube cross section is precomputed offline as robust positive invariant sets based on 10 and the bounded uncertainties controlled vessel trajectories for every possible realization of the uncertainties then evolve around the tube center within the tube and converge to the specified dp position and heading for the mpc problem we consider the predicted vessel trajectories over a future finite prediction horizon n p zheng et al 2016b whenever contextually clear we denote i k as the ith prediction step at time step k with i 0 1 n p 1 for control inputs and i 0 1 n p for system states then the uncertain predicted system state trajectories x i k are partitioned as 11 x i k x i k e i k where x denotes the nominal state trajectory and e is the deviation of the actual state x i k from the nominal state x i k on the one hand the tube cross section may be unnecessarily large resulting in conservativeness if an open loop control sequence without feedback is directly employed on the other hand optimizing over arbitral feedback policies is untractable therefore the simple affine feedback policy is introduced to restrict the size of tube cross sections as 12 u i k u i k ke i k where k is a time invariant feedback gain and is chosen such that a k a bk is stable in our case k is computed offline as the feedback gain of the infinite horizon linear quadratic regulator for the unconstrained system 10 with proper weighting matrices then we could decompose the closed loop system with 12 as a nominal part 13 x i 1 k a x i k b u i k and an uncertain part 14 e i 1 k a k e i k eb i k ε i k where b w and ε e denote the sets for the uncertain system dynamics 14 as s i i e e i k s i we further have s i 1 a k s i e w e and therefore 15 s i a k i s 0 j 0 i 1 a k j e w e note that since the system matrices of 10 and the compact sets w e are all time invariant the set s i is also irrelevant with time step k moreover the sets s i are expected to be smaller than those calculated from open loop unstable a since a k is now stable by design the operator denotes the minkowski set sum defined as a b a b a a b b with some abuse of notations since a k is stable the robust positive invariant set s exists for 15 mayne et al 2005 i e i b w ε e if e 0 k s then e i k s i i i 0 however the computation of s is difficult in practice we could compute an robust positive invariant outer approximation set s s as in rakovic et al 2005 with s 1 α 1 s n p to reduce conservativeness α 0 1 should be chosen suitably small therefore 11 can be written as a tube x i k with x i k as the center and s as cross sections as demonstrated in fig 2 would be 16 x i k x i k s likewise 12 is written as 17 u i k u i k k s if c x and c u are denoted as system state and input constraint sets respectively imposed by actual system constraints 3 5 and c x f is denoted as the terminal positive invariant constraint set mayne et al 2000 for 10 with c x and c u then all state and input trajectories by tubes 16 17 need to satisfy x i k c x x n p k c x f u i k c u equivalently the nominal state and input trajectories x i k and u i k need to satisfy tighter constraints as 18 x i k c x s 19 x n p k c x f s 20 u i k c u k s where the operator denotes minkowski set difference defined as a b a b a a b b assumption 1 the bounded uncertainties b and ε are all small so that s c x s c x f and k s c u assumption 1 can be satisfied if the vessel only operates when the weather forecast is precise and operates within a local area of the dp setpoint large system constraint sets could also help tolerate relatively large uncertainty values with assumption 1 the nominal optimal predictive control problem for the robust dp of asvs is then readily formulated as 21 min u i k x n p k q f 2 i 0 n p 1 x i k q 2 u i k r 2 subject to 13 18 20 the nominal cost function 21 aims to steer the nominal state trajectory to the origin with optimal control efforts the three terms are the terminal cost the stage cost and the control input cost the notation x i k q 2 x i k t q x i k and the same go for the control input cost and the terminal cost q q and q f are positive definite weighting matrices for the respective cost terms and can be adjusted to set priority between convergence speed and control efforts the terminal weight matrix q f is chosen as the solution to the corresponding riccati equation mayne 2014 the robust positive invariant set s feedback gain k terminal weighting matrix q f and the terminal constraint set c x f can all be precomputed offline the online optimization problem 21 subject to 13 18 20 has comparable computational complexity with that of the conventional mpc moreover with assumption 1 the nominal problem is feasible and is guaranteed to converge to the system origin mayne et al 2000 then the uncertain system is guaranteed to converge to a bounded neighborhood s around the origin 4 output feedback robust controller design in the previous section we have considered the robust dp problem using tube based mpc with full state feedback i e c i 6 6 and v 0 however system states are usually only partially and roughly available over water due to the cost and inaccuracy of marine application oriented sensors therefore we extend the full state feedback robust dp controller to an output feedback robust controller mayne et al 2006 in this section a luenberger observer is designed to estimate the system states based on the output measurement errors and estimation errors are both accommodated by treating them as extra system bounded disturbances we now consider only the vessel pose states are available i e c i 3 3 0 3 3 and there exist unknown bounded measurement errors i e v v with v being a compact set containing the origin in its interior with output y we design the luenberger observer dynamics as 22 x ˆ k 1 a x ˆ k bu k l y k y ˆ k 23 y ˆ k c x ˆ k where x ˆ k r 6 is the estimated state at time step k and l is luenberger observer gain with l t g x 1 where g is a arbitrary matrix set to the identity matrix hereby and x is the solution to the sylvester equation hou et al 1999 a t x x a k c t g combining 10 6 22 and 23 we have 24 x k 1 a l x k eb k ε k lv where x k x k x ˆ k is the state estimation error and a l a lc with ρ a l 1 by design the estimation error of 22 from 9 can be bounded as a robust positive invariant set as in 15 since ρ a l 1 eb k ε k lv is a compact set containing the origin in its interior there exists a robust positive invariant set s so that if x k s then b k w ε e v v x k 1 s to extend the tube based mpc design in section 3 we can now consider 13 as the nominal observer dynamics for 22 instead of the state dynamics 9 and bound the real state trajectory x k around x ˆ k with some abuse of notations define e k x ˆ k x k now as the error between the observer state and nominal state the affine feedback policy u k u k ke k then the closed loop observer dynamics are 25 x ˆ k 1 a x ˆ k b u k bke k l c x k v k with x k s combining 13 with 25 14 becomes 26 e i 1 k a k e i k l c x k v k and a k is the same as before and is stable by design since l c x k v k is compact and contains the origin in its interior there still exists the robust positive invariant set s for 26 therefore we now can confine the real state trajectory which is 27 x k x k x k e k in a tube with x k as the center and s s as the cross section as shown in fig 3 the nominal state and input trajectory can be obtained by solving a similar problem with 21 the overall robust dp with output feedback tube based mpc can be implemented as algorithm 1 note step 4 is implemented in case the bounded disturbance assumptions are not satisfied algorithm 1 output feedback robust dp for asvs image 1 5 simulation results and discussions simulations are carried out to demonstrate the effectiveness of the proposed robust dp algorithms for asvs with full state feedback and output feedback the vessel is initially positioned at a location away from the origin and is controlled to converge to and maintain at the origin with specified heading in spite of environmental disturbances due to wind waves and currents it is assumed that the environmental forces acting on the vessel hull can be predicted however there exist bounded prediction errors in the simulations the considered uncertainties b ε and v are implemented as random but bounded values i e numbers that follow normal distribution but are truncated with lower upper bounds in fossen and strand 1999 fossen and perez 2009 uncertainties are also considered as white gaussian noises following normal distributions particularly the boundary values for the uncertainties are set as b 0 28 ε 0 2 and v 0 2 controller parameters are set as follows prediction horizons n p 6 for the full state feedback controller and n p 10 for the output feedback controller weight parameter q d i a g 10 10 0 1 0 1 0 1 0 1 where d i a g means diagonal matrices r i 3 3 sampling time t s 0 5 s physical system constraints are 10 10 π 0 65 0 5 0 8 t x 10 10 π 0 5 0 5 0 8 t and τ max τ min 7 4 4 t note that the simulated vessel dynamics 1 2 are based on a 1 70 small scaled vessel model cs ii fossen 2011 therefore the parameter values involved in the system dynamics and constraints have been down scaled accordingly based on the froude scaling law moreira et al 2007 all the algorithms are implemented in matlab 2016b matlab 2016 with solver cplex ilog 2010 on a platform with intel r core tm i3 7100 cpu 3 70 ghz 5 1 full state feedback robust dp when full system states are measured accurately the vessel s real trajectory is confined within a tube with a nominal trajectory as the center and an offline computed robust positive invariant set as the cross section as the nominal trajectory converges to the origin the tube that contains the real trajectory converges to a bounded neighborhood of the origin as shown in fig 4 the vessel is initially positioned at 1 1 with uncertain environmental disturbances with the proposed robust dp controller the green nominal trajectory converges to 0 0 around the discrete nominal north east positions we also plot the robust positive invariant bounded sets s that form the tube together with the nominal trajectory the red real trajectory then evolves within the tube and also converges to and maintains at the neighborhood of origin although environmental disturbances exist by solving the nominal mpc problem 21 original system constraints are tightened fig 5 and fig 6 show the speed and control input trajectories respectively on surge sway and yaw the nominal trajectories satisfy the tightened constraints and the real trajectory satisfy the original constraints fig 7 and fig 8 further show the constraint satisfactions of the speed and control input trajectory over the prediction horizon at one time step note that the nominal and real trajectories are not fitting tightly to the system limits this is partly due to the design of tube cross sections and partly due to the approximated feedback control policy 12 for the trade off between conservativeness and computational complexity 5 2 output feedback robust dp when only partial system states are measured with errors fig 9 shows the nominal trajectory the estimated trajectory and the real vessel trajectory from the initial position to the origin it can be seen that the nominal trajectory converges to and stabilizes at the origin the estimated and real trajectories converges to and maintains at the corresponding robust invariant sets s and s s around the origin to show the tube and the trajectories more clearly we further plot the three dimensional set series in fig 10 similar with the full state feedback robust dp controller system constraints are also all satisfied with the output feedback robust dp controller as shown in fig 11 and fig 12 for trajectories over the entire simulation and fig 13 and fig 14 over the prediction horizon at one time step the nominal trajectories are restricted within the tightened constraint limits and the real trajectories are restricted within the original constraint limits the difference between the tightened and original limits can be seen as a type of buffer zones saved for the uncertain bounded disturbances 5 3 comparisons of the two robust dp controllers in practice whether employing the full state feedback controller or the output feedback controller depends on the availability of precise state measurements however to further explore the control performance in simulations we report the comparison results of the proposed robust controllers in fig 15 the east position and north position trajectories of the two controllers are plotted the trajectories controlled by both controllers can converge to zero robustly with comparable tracking errors however the full state feedback controller has faster convergence speed than the oput feedback controller this is not doubtful since the full state feedback controller has more accurate dynamic system information in real time to relieve the potential computational burden of the mpc online optimization problems linearized prediction models 10 are used instead of highly nonlinear dynamics 1 2 therefore the involved online problems are all convex and can be efficiently solved the computational times of the proposed full state feedback and output feedback robust controllers are reported in fig 16 it can be observed that the computational times of the two proposed robust controllers are comparable throughout the simulations the computational times are all around 15 ms and are all far smaller than the system sampling time t s 0 5 s it thus can be concluded that the proposed robust dynamics positioning controllers are in principle suitable for real time applications 6 conclusions and future work depending on whether accurate full vessel states being available or not this paper proposes two robust dynamic positioning dp approaches for autonomous surface vessels asvs the control goals to guarantee that the vessel s pose converges to and maintains within a bounded neighborhood of the specified dp pose have been well achieved under uncertain environmental disturbances we have considered high fidelity nonlinear vessel hydrodynamics and used an approximated linear model in the tube based mpc controller design all the possible uncertain system trajectories lie in a tube that is guided by a nominal trajectory towards the origin and confined by precomputed robust positive invariant sets the online optimization problems have comparable complexity with that of conventional mpc moreover a luenberger observer is designed to estimate the system states when only vessel poses are available with measurement errors the resultant estimation errors and measurement errors are further incorporated in the tube based mpc simulation results have demonstrated the effectiveness of the proposed robust dp controllers in both full state and output feedback cases future research will consider robust trajectory tracking problems of asvs with environmental disturbances credit author statement huarong zheng conceptualization methodology software writing original draft preparation jun wu data curation investigation supervision weimin wu resources investigation writing reviewing and editing supervision funding acquisition yifeng zhang writing reviewing and editing declaration of competing interest none acknowledgements this research is supported in part by the china postdoctoral science foundation china under grant 2019m652086 in part by the national natural science foundation of china under grants 61773343 in part by the key research and development program of guangdong province of china under grant 2019b010120001 and in part by the project of state key laboratory of industrial control technology zhejiang university of china under grant ict1921 
22057,this study presents a mixed analytical numerical method based on the analytical method and the wave superposition method to predict the acoustic radiation of a spherical double shell immersed in the ocean acoustic environment using the green s function the fluid structure coupled vibration as well as the near and far field acoustic radiations can be simultaneously analyzed different forms of green s functions are utilized to deal with the near and far field distribution of sound pressure to reduce the complexity of the computation the image source method is used in the near field while the normal mode method is adopted in the far field the acoustic radiation fields of the spherical double shell in finite depth ocean acoustic environment with positive and negative gradient sound speed profiles are calculated using the proposed method numerical results compared with results using the finite element method obtained by comsol verify that the proposed method improves the computational efficiency without losing computational accuracy further taking the spherical double shell as an example the effects of seabed sea surface and sound speed profile of seawater on the fluid structure coupled vibration acoustic radiation and sound propagation of underwater structures are analyzed some figures are also included to show these effects clearly the main idea proposed in this paper can be applied to the integrated calculation of fluid structure coupled vibration and the near and far field acoustic radiations of arbitrary three dimensional elastic floating bodies in the ocean acoustic environment graphical abstract image 1 keywords spherical double shell ocean acoustic environment acoustic radiation analytical method wave superposition method wsm 1 introduction for a long time acoustic radiation of floating bodies in the ocean acoustic environment has been the focus of attention in the field of acoustics which has been widely used in the applications of marine science economic development and military investigations there are two components in the calculation of acoustic radiation of floating bodies in an ocean acoustic environment the one is the evaluation of vibration and acoustic radiation of floating bodies immersed in an infinite fluid in most of these studies the water is regarded as an infinite ideal acoustic medium without taking into consideration the seabed energy absorption and the sound speed profile the other one is the simulation of sound propagation in the ocean acoustic environment although the sound propagation calculation of simple sound sources such as a monopole in seawater with various sound speed profiles has been realized the acoustic radiation behaviors of specific structures have not been fully investigated recently some researchers combined the three dimensional sono elasticity theory of ships zou et al 2013a wu et al 2016 with the ocean acoustic propagation theory jensen et al 2011 to develop a suitable integrated calculation scheme for the acoustic radiation and sound propagation of three dimensional elastic structures in the ocean acoustic environment this scheme can account for both the arbitrary sound speed profile and the acoustic reflection from the sea surface and the seabed jiang et al 2018 here the acoustic radiation in the far field is referred to as sound propagation the spherical shell is the earliest type of model used for the study of vibration and acoustic radiation of underwater structures since the 1960s acoustic radiation and the scattering of a single elastic spherical shell surrounded by infinite fluid have been widely studied by many scholars hickling 1964 dicrecks and hickling 1967 junger and feit 1986 skelton and james 1997 these studies provide an intuitive and clear physical image to understand the vibration acoustic radiation and scattering behaviors of elastic structures in water based on this huang 1979 investigated the acoustic scattering problem of a double elastic spherical shell filled with water between the inner and outer walls he employed the laplace transform and the thin shell theory to calculate the transient response of the double spherical shell under an incident pressure pulse zou et al 2013b adopted an analytical approach to simulate the acoustic radiation of a double elastic spherical shell and investigated the transmission characteristics of the power flow between the spherical shell and the water the results of this analytical approach for the acoustic radiation and scattering of single and double elastic spherical shells in water could be considered benchmark cases to verify the accuracy of results obtained by numerical methods apart from studies on simple shape structures such as the spherical shell several literatures focus on the vibration and acoustic performances of complicated doubly curved shell structures talebitooti et al 2018 ghassabi et al 2019 in the research field of underwater acoustic radiation and scattering analysis for a three dimensional elastic structure with arbitrary shape one of the most commonly used methods is the fem bem which is a hybrid method combining the finite element method fem to address the structure and the boundary element method bem to address the fluid field everstine and henderson 1990 argued that the fem bem is the most practical method to deal with the acoustic radiation of large scale structures with high precision peters et al 2015 analyzed the underwater acoustic radiation characteristics of a three compartment stiffened hull with internally distributed masses using the fem bem method zou et al 2019 developed an advantageous and effective approach based on the fem bem to predict the underwater acoustic power radiated by elastic structures in the time domain which is suitable for the transient and nonlinear acoustic radiation problems analogous to the bem the wave superposition method wsm a type of wave based method wbm is also a numerical method derived from the acoustic boundary integral equation the main features of this method include the facts that the unknown source points are flexibly arranged inside the floating body and the calculation of singular integrals can be effectively avoided koopmann et al 1989 miller et al 1991 due to these good properties the wsm is widely studied and used genechten et al 2010 put forward a multilevel wave based method ml wbm to solve time harmonic multiple scattering problems atak et al 2014 proposed a hybrid bem wbm method for solving the complex acoustic multiple scattering problems while the bem is more convenient for handling complex geometries it is beneficial to use wbm for the fast and efficient performance with the relatively simple geometries xiang et al 2012 combined the wsm with the two dimensional fast fourier transform 2 d fft algorithm to analyze the acoustic radiation from an axisymmetric body with high precision and efficiency wang and guo 2016 derived a semi analytical method based on the precise transfer matrix method ptmm and the wsm to analyze the structural responses of a submerged stiffened submarine hull according to the aforementioned characteristics the present work employs the wsm to address the axisymmetric acoustic problems which will not only simplify the problem but also greatly reduce the computational cost and improve the numerical accuracy the acoustic radiation and sound propagation characteristics of floating bodies in the ocean acoustic environment may be affected by the sea surface the seabed and the sound speed profile of seawater a comprehensive consideration of the acoustic radiation of floating bodies in the ocean acoustic environment and the propagation of sound waves in the ocean environment are conducive to the direct study of quantitative rules for the acoustic radiation field of floating bodies in the ocean acoustic environment at present the study of acoustic radiation of the floating bodies in the ocean acoustic environment considering the effect of the sound speed profile is still lacking although we can use the fem to obtain the result the range of calculation is limited since the computational cost increases quickly as the seawater domain increases consequently it is necessary to develop a new numerical strategy that can both effectively reduce the computational complexity and improve the computational efficiency during the past 50 years significant progress has been made in the theoretical and computational methods of predicting sound propagation in the ocean acoustic environment under certain conditions the acoustic reflection effect from boundaries seabed and sea surface can be modelled with constant reflection factors neglecting the influence of the sound speed profile it is convenient to derive analytically the near field in shallow seas by using the image source method ism jensen et al 2011 brekhovskikh 1980 additionally the normal mode method is a relatively mature method and has been widely used in the field of hydro acoustics especially in addressing far field acoustic radiation problems in this paper we focus on the acoustic radiation field of floating bodies in the ocean acoustic environment the near and far fields are regarded as a unified system to simulate the acoustic radiation field of floating bodies in seawater by considering complicated sound speed profiles taking the accuracy and efficiency simultaneously into account a new strategy is proposed where the acoustic radiating body is regarded as a set of internal virtual point sources using the green s function as a link the ism is used to obtain the source intensity and to calculate the near field acoustic radiation while the normal mode method is used to calculate the far field acoustic radiation specifically the wsm can effectively avoid the problem of singular integrals the ism can obtain acceptable results and avoid the complicated calculation of the derivatives of green s functions the conventional normal mode method is used in the far field generally the calculation process is greatly simplified in this paper the radiated sound field of a spherical double shell immersed in finite depth water will be investigated by considering sound speed profiles of positive and negative gradients to validate the correctness of the proposed method the calculated results are compared with the fem results obtained via comsol the proposed method shows an improvement in the computational efficiency while preserving adequate accuracy even with a large computational domain around the structures additionally the calculation results in this paper could serve as benchmark examples for the integrated calculation of fluid structure coupled vibration acoustic radiation and sound propagation of three dimensional elastic floating bodies with arbitrary shapes in the ocean acoustic environment 2 mathematical derivation of the mixed analytical numerical method 2 1 equations of motion of the spherical shell the spherical double shell is oriented with its center at the origin of a spherical coordinate system as shown in fig 1 in which oz is the polar axis the shell is totally submerged in the water and the space between the inner and outer walls of the shell is also filled with water hereafter referred to as the in between water the mid surface displacement of the spherical shell is expressed in spherical coordinates as 1 s u r n r u θ n θ u φ n φ where n r n θ and n φ denote the unit vectors along the r θ and φ directions while u r u θ and u φ are the three components of the displacement vector s along the three directions of the spherical coordinate system in fig 1 f denotes the exciting force applied on the inner spherical wall of the double shell the model is required to be axisymmetric in the present method therefore the excitation is allowed to be a concentrated force at a specific point or a distributed pressure on a line or a surface the location of the excitation can also vary as long as the axisymmetry of the loads are guaranteed as an example of the allowable excitation types a concentrated force acting at the bottom of the inner spherical wall is considered in this work when the excitation on the spherical double shell is symmetric about the polar axis oz the motions of the shell are also symmetric about oz the only nonvanishing components of motion are u r and u θ the radial and tangential motions in the direction of increasing θ respectively the tangential component of motion in the φ direction vanishes i e u φ 0 both u r r θ t and u θ r θ t are independent of φ first the vibrations of the inner spherical wall will be analyzed the equations of motion for the inner spherical wall are derived using hamilton s variational principle junger and feit 1986 2 1 β 2 2 θ 2 cot θ θ σ cot 2 θ r 2 2 c p 2 2 t 2 u θ β 2 3 θ 3 β 2 cot θ 2 θ 2 1 σ β 2 σ cot 2 θ θ u r r 2 2 ρ s h 2 c p 2 f 2 θ β 2 3 θ 3 2 β 2 cot θ 2 θ 2 1 σ 1 β 2 β 2 cot 2 θ θ cot θ β 2 2 σ cot 2 θ 1 σ u θ β 2 4 θ 4 2 β 2 cot θ 3 θ 3 β 2 1 σ cot 2 θ 2 θ 2 β 2 cot θ 2 σ cot 2 θ θ 2 1 σ r 2 2 c p 2 2 t 2 u r r 2 2 ρ s h 2 c p 2 p 2 f 2 r where r 2 h 2 and ρ s are the radius thickness and density of the material of the inner spherical wall respectively β 2 is a constant defined by β 2 h 2 2 12 r 2 2 σ e and c p e ρ s 1 σ 2 are poisson s ratio young s modulus and the speed of longitudinal waves transmitting in the shell respectively the acoustic pressure acted on the surface of the inner wall which is induced by the in between water is p 2 p 2 r θ t r r 2 the radial and tangential components of the excitation are f 2 r and f 2 θ it is seen in eq 2 that the radial and tangential displacements of the spherical shell are coupled it will be more convenient to work with the following transformation 3 η cos θ η 2 d d η 1 η 2 d d η 4 ω 2 ω r 2 c p 2 if we make this transformation the foregoing set of equations eq 2 assuming harmonic time variation e i ω t where ω is the angular frequency can be written as 5 l 11 u θ l 12 u r 2 u θ 1 ρ s h 2 r 2 c p 2 f 2 θ ω l 21 u θ l 22 u r 2 u r 1 ρ s h 2 r 2 c p 2 f 2 r ω p 2 r θ ω r r 2 where the operators l 11 l 12 l 21 and l 22 are given by 6 l 11 1 β 2 1 η 2 1 2 d 2 d η 2 1 η 2 1 2 1 σ l 12 1 η 2 1 2 β 2 1 σ 1 σ d d η β 2 d d η η 2 l 21 β 2 1 σ 1 σ d d η 1 η 2 1 2 β 2 η 2 d d η 1 η 2 1 2 l 22 β 2 η 4 β 2 1 σ η 2 2 1 σ the equations of motion for the outer spherical wall is similar to eq 5 except that the acoustic pressure of the outside fluid should be additionally considered in the equation the radius and thickness of the outer spherical wall are r 1 and h 1 respectively the acoustic pressure from the in between water is p 2 r θ t r r 1 while the acoustic pressure from the outside fluid is denoted as p 1 r θ t r r 1 the radial and tangential components of the excitation are f 1 r and f 1 θ 2 2 the interactions between the in between water and the inner and outer walls of the spherical double shell to carry out an analysis in the frequency domain the helmholtz equation in the spherical coordinates can be solved by separation of variables the velocity potential of the acoustic wave for the in between water can be expressed as skudrzyk 1971 7 φ 2 r θ n 0 i n 2 n 1 p n cos θ f n j n k r g n y n k r where f n and g n are undetermined coefficients k ω c 0 is the acoustic wave number in the water c 0 is the speed of sound in the water p n denotes the legendre polynomials and j n and y n are spherical bessel and neumann functions respectively the relationship between velocity potential and acoustic pressure is 8 p 2 r θ i ω ρ 0 φ 2 r θ where p 2 is the acoustic pressure of the in between water and ρ 0 is the density of the water for the convenience of description the radial and tangential displacements of the inner spherical wall are denoted as w 2 θ and u 2 θ respectively while those of the outer spherical wall are denoted as w 1 θ and u 1 θ respectively for the case of symmetric vibration the radial and tangential displacements of the inner spherical wall can now be expressed in terms of an infinite series as junger and feit 1986 9 w 2 θ n 0 w 2 n p n η u 2 θ n 0 u 2 n 1 η 2 1 2 d p n η d η similarly the displacement components of the outer spherical wall are written as 10 w 1 θ n 0 w 1 n p n η u 1 θ n 0 u 1 n 1 η 2 1 2 d p n η d η w 1 n w 2 n u 1 n and u 2 n in the above equations eq 9 and 10 are the unknown generalized coordinates needed to be found it is assumed that the radial displacements of the two spherical walls are positive when pointing outward according to the compatibility condition on the wet surface of fluid structure interaction the boundary condition at the connecting interface of the inner spherical wall and the in between water can be expressed as 11 φ 2 r r r 2 i ω w 2 substituting eqs 7 and 9 in eq 11 yields 12 i n 2 n 1 f n k d j n χ d χ χ k r 2 g n k d y n χ d χ χ k r 2 i ω w 2 n the boundary condition at the interface of the outer spherical wall and the in between water can be derived in a similar way to yield 13 i n 2 n 1 f n k d j n χ d χ χ k r 1 g n k d y n χ d χ χ k r 1 i ω w 1 n combining eqs 12 and 13 results in 14 f n ω i n 1 2 n 1 a 4 w 2 n a 2 w 1 n a 1 a 4 a 2 a 3 g n ω i n 1 2 n 1 a 1 w 1 n a 3 w 2 n a 1 a 4 a 2 a 3 where a 1 k d j n χ d χ χ k r 2 a 2 k d y n χ d χ χ k r 2 a 3 k d j n χ d χ χ k r 1 a 4 k d y n χ d χ χ k r 1 the acoustic pressure of the in between water on the inner spherical wall can now be expressed as 15 p 2 r 2 θ ρ 0 ω 2 n 0 p n cos θ a 4 w 2 n a 2 w 1 n a 1 a 4 a 2 a 3 j n k r 2 a 1 w 1 n a 3 w 2 n a 1 a 4 a 2 a 3 y n k r 2 for the inner spherical wall the excitation f 2 r and f 2 θ can also be expressed in terms of p n η as in eq 15 p 2 f 2 r and f 2 θ can then be substituted into eq 5 taking into consideration the orthogonality of the legendre polynomials the fluid structure interaction equations of motion can be derived for each mode shape order n 16 l 11 n u 2 n l 12 n w 2 n 1 ρ s h 2 r 2 c p 2 f 2 θ n l 21 n u 2 n l 22 n f l n w 2 n f h n w 1 n 1 ρ s h 2 r 2 c p 2 f 2 r n where l 11 n ω 2 1 β 2 σ λ n 1 l 12 n β 2 σ λ n 1 1 σ l 21 n λ n β 2 σ λ n 1 1 σ l 22 n ω 2 2 1 σ β 2 λ n σ λ n 1 λ n n n 1 f l n ρ 0 ω 2 a 4 a 1 a 4 a 2 a 3 j n k r 2 a 3 a 1 a 4 a 2 a 3 y n k r 2 r 2 2 ρ s h 2 c p 2 f h n ρ 0 ω 2 a 2 a 1 a 4 a 2 a 3 j n k r 2 a 1 a 1 a 4 a 2 a 3 y n k r 2 r 2 2 ρ s h 2 c p 2 the radial exciting force is set at the location of r r 2 θ π on the inner spherical wall with the amplitude being unity f r δ θ π 2 π r 2 2 sin θ where δ is the dirac delta function now in eq 16 f 2 θ n 0 f 2 r n 2 n 1 2 p n 1 2 π r 2 2 analogously the acoustic pressure from the in between water on the outer spherical wall can be derived 17 p 2 r 1 θ ρ 0 ω 2 n 0 p n cos θ a 4 w 2 n a 2 w 1 n a 1 a 4 a 2 a 3 j n k r 1 a 1 w 1 n a 3 w 2 n a 1 a 4 a 2 a 3 y n k r 1 2 3 the interaction between the outer spherical wall and the ambient finite depth water for various ocean acoustic environments the corresponding green s functions which represent the sound propagation model of a monopole sound source in this hydro acoustic environment can be introduced here jensen et al 2011 as shown in fig 2 the spherical double shell is submerged in a finite depth water domain the seawater density and sound speed in the seawater are denoted as ρ 0 and c 0 respectively while the seabed density and sound speed in the seabed are denoted as ρ 1 and c 1 respectively in this work ρ 0 ρ 1 and c 1 are assumed constant while c 0 will vary along the direction of depth the sea surface is treated as a pressure release boundary i e the acoustic pressure is zero when the sound speed c 0 is a constant i e the sound speed profile is uniform the finite depth water environment is reduced to the pekeris hydro acoustic waveguide environment it can be understood qualitatively that the near field of the radiated sound from underwater structures is not sensitive to the sound speed profile of the seawater this will be further verified in the following sections using practical calculation results therefore the sound speed profile of the seawater is assumed to be approximately uniform i e the pekeris hydro acoustic waveguide when analyzing the sound structure interaction between the ambient fluid and the spherical shell as well as calculating the near field acoustic radiation of the spherical shell it is known from the literature zou et al 2013a that the pekeris hydro acoustic waveguide can be approximated as a finite depth water domain with constant acoustic reflection factors at both the seabed and the sea surface when the condition s 2 d 2 z 0 z 1 19 is satisfied d 2 is the distance from the center of the shell to the seabed while the meaning of s z 0 and z can be referred to the description below eq 18 generally s 2 d 2 z 0 z 1 19 will be satisfied in the vicinity of the shell under this circumstance the green s function can be expressed in terms of an infinite series zou et al 2013a 2018 brekhovskikh 1980 as follows 18 g r r 0 l 0 γ γ 1 l e i k r l 1 r l 1 γ e i k r l 2 r l 2 γ 1 e i k r l 3 r l 3 γ γ 1 e i k r l 4 r l 4 where γ and γ 1 denote the acoustic reflection factors of the seabed and sea surface respectively r 0 x 0 y 0 z 0 is the position of the source point and r x y z represents the field point r l 1 r l 2 r l 3 r l 4 and s are defined as follows r l 1 s 2 2 l d z z 0 2 1 2 r l 2 s 2 2 l d 2 d 2 z z 0 2 1 2 r l 3 s 2 2 l d 2 d 1 z z 0 2 1 2 r l 4 s 2 2 l 1 d z z 0 2 1 2 s x x 0 2 y y 0 2 1 2 in which d is the water depth d 1 is the distance from the center of the spherical shell to the sea surface also known as the submerging depth and d 2 is the distance from the center of the spherical shell to the seabed it should be mentioned that the green s function corresponds to a virtual source chain formed by the reflection of sound waves between the seabed and sea surface and satisfies the boundary conditions at the seabed and sea surface automatically the sea surface is treated as the pressure release boundary γ 1 1 as the constitution of the seabed differs the acoustic reflection factor γ may vary it is found that when γ 0 1 0 6 only the first nine items of the sum in eq 18 are required to ensure sufficient precision and convergence the wsm is adopted to solve the interaction problem between the outer spherical wall and the outside fluid field as well as the radiation problem in the water the external excitation is applied at the bottom of the inner spherical wall at the location of r r 2 θ π this results in a symmetrical vibration problem according to the symmetric characteristic of vibration the acoustic boundary integral equation can be simplified from a surface integral to a line integral by using the wave superposition approach which can greatly improve the computational efficiency the source points are distributed on a line that coincides with the polar axis oz while the field points are on the generating line of the outer spherical wall as shown in fig 3 the numbers of both source and field points are set as n j the x and y coordinates of the n j th 1 n j n j source point is zero and the z coordinate is expressed as 19 z 0 n j r 1 1 2 n j 1 n j the y coordinate of the n j th 1 n j n j field point is zero and the x and z coordinates are defined respectively as 20 x n j r 1 sin n j 0 5 π n j z n j r 1 cos n j 0 5 π n j according to the wave superposition approach the acoustic wave potential induced by the vibration mode of order n of the outer spherical wall can be expressed as 21 φ 1 n r n j 1 n j q n j r 0 g r r 0 where q n j r 0 is the undetermined source intensity of the n j th source point combining eq 10 and eq 21 and taking into account the orthogonality of the legendre polynomials the boundary conditions for the fluid structure interaction between the outer spherical wall and the outside fluid field can be derived 22 i ω p n η n j 1 n j q n j r 0 g r r 0 n r where the field point r lies on the surface of the outer spherical wall and g r r 0 n r denotes the normal derivative of the green s function on the outer spherical surface the source intensity q n j r 0 can be determined from the above equation the acoustic wave potential of the outside fluid field can be expressed by a linear superposition 23 φ 1 r n 0 w 1 n n j 1 n j q n j r 0 g r r 0 the sound pressure at a field point is 24 p 1 r i ω ρ 0 φ 1 r the sound pressure on the surface of the outer spherical wall can be written in terms of the legendre polynomials 25 p 1 r n 0 w 1 n m 0 a m n p m η combining eq 21 eq 23 eq 24 and eq 25 and taking into consideration the orthogonality of the legendre polynomials the coefficient a m n is derived 26 a m n 2 m 1 2 i ω ρ 0 π n j n j 1 n j φ 1 n r p m η sin n j 0 5 π n j where η cos n j 0 5 π n j for the n j th field point substituting eq 17 and eq 25 into eq 5 and making use of the orthogonality of the legendre polynomials the fluid structure interaction equations of motion can be derived for the outer wall 27 l 11 n u 1 n l 12 n w 1 n 0 l 21 n u 1 n l 22 n f i n w 1 n m 0 b n m w 1 m f g n w 2 n 0 where l 11 n l 12 n l 21 n and l 22 n are similar to l 11 n l 12 n l 21 n and l 22 n in eq 16 only the dimensions of the inner spherical wall should be changed to those of the outer wall here b n m r 1 2 ρ s h 1 c p 2 a n m f i n ρ 0 ω 2 a 2 a 1 a 4 a 2 a 3 j n k r 1 a 1 a 1 a 4 a 2 a 3 y n k r 1 r 1 2 ρ s h 1 c p 2 f g n ρ 0 ω 2 a 4 a 1 a 4 a 2 a 3 j n k r 1 a 3 a 1 a 4 a 2 a 3 y n k r 1 r 1 2 ρ s h 1 c p 2 by combining eq 16 and eq 27 and truncating the mode order of the spherical shell to n the following matrix equation is derived 28 l 220 f i 0 b 00 l 210 f g 0 0 b 0 n 0 0 0 l 120 l 110 0 0 0 0 0 0 f h 0 0 l 220 f l 0 l 210 0 0 0 0 0 0 l 120 l 110 0 0 0 0 b n 0 0 0 0 l 22 n f i n b n n l 21 n f g n 0 0 0 0 0 l 12 n l 11 n 0 0 0 0 0 0 f h n 0 l 22 n f l n l 21 n 0 0 0 0 0 0 l 12 n l 11 n w 10 u 10 w 20 u 20 w 1 n u 1 n w 2 n u 2 n 0 0 1 ρ s h 2 r 2 c p 2 1 2 p 0 1 2 π r 2 2 0 0 0 1 ρ s h 2 r 2 c p 2 2 n 1 2 p n 1 2 π r 2 2 0 2 4 calculation of the far field green s function using the normal mode method considering the non constant sound speed profile and the non constant acoustic reflection coefficient of the seabed in the far field the solution to the far field green s function in the ocean acoustic waveguide environment is the key to the proposed integrated calculation scheme the normal mode method is used to solve the far field green s function in this study which is a fast accurate and efficient method in the field of computational ocean acoustics jensen et al 2011 in the normal mode method the computational scale is independent of the distance and the sound field in the whole fluid domain can be directly calculated for the readability of this paper the normal mode method is briefly introduced in this subsection for a general sound speed profile it is usually impossible to derive an analytical solution using the normal mode method therefore a numerical approach is introduced to obtain the corresponding green s function in this work the far field green s function is derived by using the normal mode method based on finite difference the seawater region d 2 z d 1 is divided into n equidistant layers along the depth direction so that n 1 grid points are formulated the z coordinates of the grid points from the sea surface to the seabed are denoted as z s j d 1 j h j 0 1 n where h is the thickness of each layer it is required that h d n is less than one tenth of the wavelength of the acoustic waves assuming that the eigenfunction of the normal mode with respect to depth can be denoted as ψ z the function value at each grid point can be expressed as ψ j ψ z s j the density of the seawater is a constant ρ 0 using the standard three point finite difference formula the eigenvalue problem expressions of the whole sound field can be written as 29 ψ j 1 2 h 2 ω 2 c 0 2 z s j k s 2 ψ j ψ j 1 0 j 1 2 n 1 f t g t ψ 0 1 ρ 0 ψ 1 ψ 0 h ω 2 c 0 2 z s 0 k s 2 ψ 0 h 2 0 f b g b ψ n 1 ρ 0 ψ n ψ n 1 h ω 2 c 0 2 z s n k s 2 ψ n h 2 0 where c 0 z s j is the sound speed at depth z s j k s is the eigenvalue k s is also the horizontally propagating wavenumber of the normal mode and f t b and g t b represent the boundary impedance conditions for the pressure release boundary the sea surface f t g t tends to be infinite while f b k s 2 1 and g b k s 2 ρ 1 k s 2 ω c 1 2 for the fluid bottom the finite difference formula in eq 29 can also be rewritten in the form of an algebraic eigenvalue problem 30 c k s 2 ψ 0 where ψ is the vector with components ψ 0 ψ 1 ψ n and c is a symmetric tri diagonal matrix defined as 31 c b 0 e 1 e 1 b 1 e 2 e 2 b 2 e 3 e n 2 b n 2 e n 1 e n 1 b n 1 e n e n b n the matrix elements b j and e j are defined as 32 b 0 2 h 2 ω 2 c 0 2 z s 0 k s 2 2 h ρ 0 f t k s 2 g t k s 2 33 b j 2 h 2 ω 2 c 0 2 z s j k s 2 2 h ρ 0 j 1 2 n 1 34 b n 2 h 2 ω 2 c 0 2 z s n k s 2 2 h ρ 0 f b k s 2 g b k s 2 35 e j 1 h ρ 0 j 1 2 n when the boundary condition is ideal e g the case of free sea surface and rigid seabed the functions f t b and g t b are independent of k s and the above problem is reduced to a standard algebraic eigenvalue problem that can be solved using standard routines however for the fluid bottom considered in this work a suitable method is needed to extract the corresponding eigenvectors and eigenvalues in the present work the sturm s method combined with the bisection method and inverse iteration is used to solve the eigenvalue problem porter and reiss 1984 this method is of high precision efficiency and numerical stability based on the attenuation rules of acoustic waves in the horizontal direction denoted by s the m eigenvalues normal mode wavenumbers and the corresponding normalized eigenvectors normal modes are substituted into the following formula to obtain the green s function jensen et al 2011 36 g r r 0 π i ρ 0 m 1 m ψ m z 0 ψ m z h 0 1 k s m s where h 0 1 is the zeroth order hankel function of the first kind and k s m is the mth real eigenvalue it should be noted that the m eigenvalues involved in eq 36 which is used to calculate the green s function contain all the real roots of the eigenvalue problem i e the propagation mode whose energy will remain in the seawater however for the leaky mode corresponding to the complex roots of the eigenvalue problem the energy will radiate into the half space of the seabed and thus the contribution to the entire sound field will decrease exponentially with increasing distance in this paper the influence of the leaky mode will be ignored and only the propagation mode is considered in the calculation of the far field green s function generally for the region that can be regarded as the far field the real roots are enough to use in the normal mode method since the complex roots make little contribution to the far field for example porter 1992 the author of the well known normal mode program kraken states that considering only the real root parts of the normal modes in the algorithm is sufficient to obtain accurate results for the region beyond ten times the water depth 2 5 acoustic radiation in the water the generalized coordinates w 10 w 11 w 1 n can be obtained from eq 28 subsequently the vibratory response and acoustic radiation of the outer spherical wall can be calculated from eq 10 and eq 23 it should be noted that the virtual source method eq 18 is used to calculate the green s function when solving the source intensity and evaluating the near field acoustic radiation also the normal mode method introduced in sec 2 4 is adopted to calculate the green s function when evaluating the far field acoustic radiation the radiated power into water can then be calculated by the integration on the outer surface 37 p s ω 1 2 re n j 1 n j i ω w 1 p 1 r δ s n j where the superscript denotes the complex conjugate the field point r lies on the surface of the outer spherical wall and δ s n j is the wet surface area corresponding to the n j th field point which equals the area generated by multiplying the length π r 1 n j of the arc and the corresponding perimeter 2 π r 1 sin n j 0 5 π n j 38 δ s n j 2 π r 1 sin n j 0 5 π n j π r 1 n j the sound pressure level l p based on the sound pressure and the sound source level s l s based on the acoustic power can be expressed as follows 39 l p 20 log 10 p 1 2 p 0 40 s l s 10 log 10 p s p 0 where the reference pressure is p 0 1 10 6 pa and the reference acoustic power is p 0 0 65 4 π 10 18 w 3 validation of the computational methods and computer codes the general process of the calculation is summarized as follows 1 analytically express the displacement components of the inner and outer walls of the spherical double shell using a series expansion analogous to the concept of the shell s in vacuo modes the unknown generalized coordinates are w 1 n w 2 n u 1 n u 2 n 2 evaluate the interaction between the spherical walls with the in between water using an analytical method express the acoustic pressure on the outer surface of the inner wall and on the inner surface of the outer wall in terms of series where the generalized coordinates are unknowns 3 evaluate the interaction between the outer spherical shell and the ambient fluid using the wsm express the acoustic pressure on the outer surface of the outer wall in terms of a series expansion the green s function is in the summing form of a series as shown in eq 18 the effect of the sound speed profile is ignored 4 solve explicitly the generalized fluid structure interaction dynamic equation eq 28 to obtain the generalized coordinates w 1 n w 2 n u 1 n u 2 n 5 by substituting the generalized coordinates into the corresponding formulas the vibration and near and far fields acoustic radiation can be calculated the normal mode method is used to calculate the green s function when evaluating the far field acoustic radiation the effect of the sound speed profile is considered to validate the correctness of the computational methods and the corresponding computer codes described in this paper the calculation results obtained using the proposed method the number of source points in the wave superposition method is n j 80 are compared with those calculated using comsol the detailed parameters for the validation example are given below the radius and thickness of the inner wall are 0 5 m and 0 8 mm while the radius and thickness of the outer wall are 0 65 m and 0 3 mm respectively the material density young s modulus poisson s ratio and the structural damping factor for the inner and outer walls of the double shell are 7800 kg m3 2 1 1011 n m2 0 3 and 0 02 respectively the distance from the center of the spherical shell to the sea surface is 6 m i e the submerging depth is 6 m the seabed density and sound speed in the seabed are 2600 kg m3 and 1620 m s respectively the density of the seawater is 1025 kg m3 two sound speed profiles are used here see fig 4 1 positive gradient profile where the speed range is 1507 m s to 1517 m s 2 negative gradient profile where the speed range is 1513 m s to 1503 m s in the following numerical implementation a harmonic normal force is assumed to be applied on the bottom of the inner wall it is worth noting that the effective value of the harmonic force is set as unity here i e the amplitude is 2 n the near field green s function can be calculated using eq 18 with the aforementioned seawater and seabed parameters the acoustic reflection factor of the seabed where the detailed calculation can be found in the literature zou et al 2013a is set as γ 0 4626 by considering the characteristic of symmetry of the spherical double shell a two dimensional equivalent model shown in fig 5 is established using comsol to balance both the computational accuracy and computational cost three finite element sizes 0 04 m 0 12 m 0 5 m are used the mesh size increases as the field point varies from the vicinity of the spherical shell to the far field however the calculation region of the seawater is set to only 1 25 km the effective calculation region is only about 1 km since the calculation accuracy will be worse due to the effect of boundary truncation using the perfectly matched layer pml between 1 km and 1 25 km the fem requires much more computational resource than the present method if the entire three dimensional fem model is used to calculate the acoustic radiation at a relatively larger computational domain the computational cost will be too large however the present wsm only requires 80 source points to obtain acceptable results for the same example from the comparison of sound pressure level curves in fig 6 and the comparison of sound pressure level contour plots in fig 7 the proposed numerical results are in good agreement with the fem results when the test field point is relatively far from the spherical shell a small distinction exists between the results obtained by the proposed method and the fem it may be caused by the following two reasons 1 the leaky modes corresponding to complex roots are not taken into account which may still have a slight influence on the calculation of the green s function by using the normal mode method in the vicinity of 1 km 2 the field points in the vicinity of 1 km are close to the pml region and calculation deviations may exist using comsol in addition all three curves in fig 6a agree with each other well which reveal that the sound speed profile has little effect on the radiated acoustic pressure in the vicinity of the spherical shell this also validates the conclusion in sec 2 3 that the sound speed profile of the seawater can be regarded as uniform when analyzing the sound structure interaction of the external fluid and the spherical shell and the near field sound field radiated by the spherical shell it is seen from figs 6b and 7 that the far field sound pressure distribution varies significantly when the sound speed profile differs therefore the sound speed profile has an effect on the radiated sound pressure at a relatively large distance at present the effective calculation region is confined to 1 km it is predicted that the influence of the sound speed profile will also increase with a much farther field point from the spherical shell it can be seen from the results shown in fig 7 that there is a clear interference phenomenon in each contour plot of the radiated sound field due to the acoustic reflection of the sea surface and the seabed two dark spot areas can be observed in each contour plot moreover the results in fig 7c and d have an overall translation along the x direction relative to the results in fig 7a and b this phenomenon is caused by the distinction of sound speed profiles 4 acoustic radiation analysis of a double elastic spherical shell in ocean acoustic environment in this section the mixed analytical numerical method established in this paper will be implemented to the acoustic radiation analysis of a double elastic spherical shell in the ocean acoustic environment specifically the effect of submerging depths and seabed parameters on the acoustic radiation of the spherical double shell will be analyzed it should be noted that the origin of the coordinates is set at the center of the spherical double shell 4 1 acoustic radiation analysis of the double shell with different submerging depths and a fixed water depth in this section the water depth is set to a fixed value of 20 m two submerging depths the distance from the center of the spherical shell to the sea surface 10 m and 14 m are considered the remaining parameters are the same as those defined in sec 3 it is seen from fig 8 that there is a distinction between the two sound pressure level curves with different submerging depths the varied distinctions could be found with different field points at different frequencies there may be several factors that lead to this distinction the detailed mechanism underlying this phenomenon needs further investigation it can be imagined intuitively that there will be a fluctuation in the sound pressure level curve of the far field point x 1000 y 0 z 0 due to the acoustic wave interference caused by the reflection of the seabed and the sea surface however the two curves in fig 8b submerging depth 14 m positive gradient and submerging depth 14 m negative gradient are different from the above mentioned intuitive imagination i e there is no fluctuation in the frequency range larger than 100 hz similar numerical results can be obtained using comsol for the same physical model this anomalous phenomenon is interesting but its mechanism is not clear yet and will be further studied in the future fig 9 a and b shows the sound pressure distribution corresponding to the submerging depth 10 m case the basic rules shown in these two figures are analogous to those in fig 7 the contour plots in fig 9c and d are special because there is no obvious acoustic interference caused by the acoustic reflection from the seabed and the sea surface this is consistent with the results in fig 8b the detailed mechanism underlying this phenomenon still needs further investigation 4 2 effect of seabed parameters on the acoustic radiation of the double shell in this subsection the water depth is 20 m and the submerging depth is 10 m two cases are considered to figure out the effect of seabed parameters 1 the seabed density and sound speed in the seabed are ρ 1 1400 kg m 3 and c 1 1620 m s respectively the acoustic reflection factor of the seabed is γ 0 1888 2 the seabed density and sound speed in the seabed are ρ 1 3000 kg m 3 and c 1 2050 m s respectively the acoustic reflection factor of the seabed is γ 0 5979 the remaining parameters are the same as those in sec 3 from fig 10 it can be found that the seabed parameters have a significant effect on the sound pressure level at the far field point which may be larger than the effect caused by the sound speed profile with the stronger acoustic reflection from the seabed the sound pressure level fluctuates more drastically along with the increasing frequencies the sound pressure distributions in the xz plane are plotted for two groups of seabed parameters with two different sound speed profiles at the frequency 200 hz from the viewpoint of seabed reflection the acoustic reflection induced by the sea floor is relatively strong when the seabed parameters are ρ 1 3000 kg m 3 and c 1 2050 m s it can be seen from fig 11 that the acoustic interference phenomenon exists for the two sets of seabed parameters the sound speed profile has a certain influence on the spatial distribution of the sound field the fluctuation of the acoustic field caused by acoustic wave interference increases with the stronger acoustic reflection from the seabed 5 conclusion unlike the previous studies on the acoustic radiation of three dimensional elastic floating bodies in an infinite acoustic medium and the sound propagation of monopoles in the ocean acoustic environment a new calculation strategy is proposed in this paper to evaluate the acoustic radiation field of a three dimensional spherical double shell in finite depth water while considering the effect of the arbitrary sound speed profile both the sound speed profile in finite depth water and the sound absorption of the seabed are considered the near and far fields of the radiated sound are regarded as a unified system in particular the proposed method gives reliable results even with a large computational domain around the structures the radiated sound field of a spherical double shell is evaluated by considering sound speed profiles of positive and negative gradients which are compared with the fem results calculated via comsol the proposed results are in good agreement with the fem results the wsm can effectively avoid the problem of singular integrals the ism can obtain acceptable results and avoid the complicated calculation of the derivatives of green s functions the normal mode method is used to deal with the far field therefore the proposed method can improve the computational efficiency while preserving adequate accuracy the proposed wsm only requires 80 internal source points on the axis of the spherical shell in order to obtain accurate results in comparison with the fem the proposed mixed analytical numerical method has the advantage of high computational efficiency and accuracy for the sound field beyond several kilometers the computational cost of the fem is almost unaffordable in contrast the computational cost of the proposed method is independent of the size of the computational domain this feature guarantees that the calculation results in this paper could serve as benchmark examples for the integrated calculation of fluid structure coupled vibration acoustic radiation and sound propagation of three dimensional elastic floating bodies with arbitrary shapes in the ocean acoustic environment under the investigation on the acoustic radiation of a spherical double shell in finite depth water environment with sound speed profiles of positive and negative gradients it can be found that the sound speed profile the sea surface and the seabed have certain effects on the underwater acoustic radiation of floating bodies specifically the details of these effects are closely related to the water depth submerging depth sound speed profile parameters of the seabed excitation frequency etc due to the acoustic reflection of the sea surface and seabed there is a clear interfering phenomenon on the contour map of the sound pressure distribution which is different from the case of the unbounded water domain however there is no obvious interfering phenomenon in the contour of the sound pressure distribution when the spherical shell is at a certain submerging depth this requires further study of the related mechanism it should be noted that these examples also demonstrate the importance of establishing an integrated calculation method for the fluid structure coupled vibration acoustic radiation and sound propagation of an arbitrary three dimensional elastic floating body in the ocean acoustic environment author contribution statement ming song zou conceptualization methodology investigation validation shu xiao liu writing original draft preparation writing reviewing and editing ling wen jiang methodology visualization he huang software declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national key r d program of china grant no 2017yfb0202701 the national natural science foundation of china grant nos 11772304 and 51709241 and the natural science foundation of jiangsu province of china grant no bk20170216 the authors wish to thank assoc prof bin wang at shanghai jiao tong university for his kind help in using comsol besides the authors are grateful to prof zhuo jia fu at hohai university and assistant prof d watson at mississippi college for their help in improving the english writing of the manuscript 
22057,this study presents a mixed analytical numerical method based on the analytical method and the wave superposition method to predict the acoustic radiation of a spherical double shell immersed in the ocean acoustic environment using the green s function the fluid structure coupled vibration as well as the near and far field acoustic radiations can be simultaneously analyzed different forms of green s functions are utilized to deal with the near and far field distribution of sound pressure to reduce the complexity of the computation the image source method is used in the near field while the normal mode method is adopted in the far field the acoustic radiation fields of the spherical double shell in finite depth ocean acoustic environment with positive and negative gradient sound speed profiles are calculated using the proposed method numerical results compared with results using the finite element method obtained by comsol verify that the proposed method improves the computational efficiency without losing computational accuracy further taking the spherical double shell as an example the effects of seabed sea surface and sound speed profile of seawater on the fluid structure coupled vibration acoustic radiation and sound propagation of underwater structures are analyzed some figures are also included to show these effects clearly the main idea proposed in this paper can be applied to the integrated calculation of fluid structure coupled vibration and the near and far field acoustic radiations of arbitrary three dimensional elastic floating bodies in the ocean acoustic environment graphical abstract image 1 keywords spherical double shell ocean acoustic environment acoustic radiation analytical method wave superposition method wsm 1 introduction for a long time acoustic radiation of floating bodies in the ocean acoustic environment has been the focus of attention in the field of acoustics which has been widely used in the applications of marine science economic development and military investigations there are two components in the calculation of acoustic radiation of floating bodies in an ocean acoustic environment the one is the evaluation of vibration and acoustic radiation of floating bodies immersed in an infinite fluid in most of these studies the water is regarded as an infinite ideal acoustic medium without taking into consideration the seabed energy absorption and the sound speed profile the other one is the simulation of sound propagation in the ocean acoustic environment although the sound propagation calculation of simple sound sources such as a monopole in seawater with various sound speed profiles has been realized the acoustic radiation behaviors of specific structures have not been fully investigated recently some researchers combined the three dimensional sono elasticity theory of ships zou et al 2013a wu et al 2016 with the ocean acoustic propagation theory jensen et al 2011 to develop a suitable integrated calculation scheme for the acoustic radiation and sound propagation of three dimensional elastic structures in the ocean acoustic environment this scheme can account for both the arbitrary sound speed profile and the acoustic reflection from the sea surface and the seabed jiang et al 2018 here the acoustic radiation in the far field is referred to as sound propagation the spherical shell is the earliest type of model used for the study of vibration and acoustic radiation of underwater structures since the 1960s acoustic radiation and the scattering of a single elastic spherical shell surrounded by infinite fluid have been widely studied by many scholars hickling 1964 dicrecks and hickling 1967 junger and feit 1986 skelton and james 1997 these studies provide an intuitive and clear physical image to understand the vibration acoustic radiation and scattering behaviors of elastic structures in water based on this huang 1979 investigated the acoustic scattering problem of a double elastic spherical shell filled with water between the inner and outer walls he employed the laplace transform and the thin shell theory to calculate the transient response of the double spherical shell under an incident pressure pulse zou et al 2013b adopted an analytical approach to simulate the acoustic radiation of a double elastic spherical shell and investigated the transmission characteristics of the power flow between the spherical shell and the water the results of this analytical approach for the acoustic radiation and scattering of single and double elastic spherical shells in water could be considered benchmark cases to verify the accuracy of results obtained by numerical methods apart from studies on simple shape structures such as the spherical shell several literatures focus on the vibration and acoustic performances of complicated doubly curved shell structures talebitooti et al 2018 ghassabi et al 2019 in the research field of underwater acoustic radiation and scattering analysis for a three dimensional elastic structure with arbitrary shape one of the most commonly used methods is the fem bem which is a hybrid method combining the finite element method fem to address the structure and the boundary element method bem to address the fluid field everstine and henderson 1990 argued that the fem bem is the most practical method to deal with the acoustic radiation of large scale structures with high precision peters et al 2015 analyzed the underwater acoustic radiation characteristics of a three compartment stiffened hull with internally distributed masses using the fem bem method zou et al 2019 developed an advantageous and effective approach based on the fem bem to predict the underwater acoustic power radiated by elastic structures in the time domain which is suitable for the transient and nonlinear acoustic radiation problems analogous to the bem the wave superposition method wsm a type of wave based method wbm is also a numerical method derived from the acoustic boundary integral equation the main features of this method include the facts that the unknown source points are flexibly arranged inside the floating body and the calculation of singular integrals can be effectively avoided koopmann et al 1989 miller et al 1991 due to these good properties the wsm is widely studied and used genechten et al 2010 put forward a multilevel wave based method ml wbm to solve time harmonic multiple scattering problems atak et al 2014 proposed a hybrid bem wbm method for solving the complex acoustic multiple scattering problems while the bem is more convenient for handling complex geometries it is beneficial to use wbm for the fast and efficient performance with the relatively simple geometries xiang et al 2012 combined the wsm with the two dimensional fast fourier transform 2 d fft algorithm to analyze the acoustic radiation from an axisymmetric body with high precision and efficiency wang and guo 2016 derived a semi analytical method based on the precise transfer matrix method ptmm and the wsm to analyze the structural responses of a submerged stiffened submarine hull according to the aforementioned characteristics the present work employs the wsm to address the axisymmetric acoustic problems which will not only simplify the problem but also greatly reduce the computational cost and improve the numerical accuracy the acoustic radiation and sound propagation characteristics of floating bodies in the ocean acoustic environment may be affected by the sea surface the seabed and the sound speed profile of seawater a comprehensive consideration of the acoustic radiation of floating bodies in the ocean acoustic environment and the propagation of sound waves in the ocean environment are conducive to the direct study of quantitative rules for the acoustic radiation field of floating bodies in the ocean acoustic environment at present the study of acoustic radiation of the floating bodies in the ocean acoustic environment considering the effect of the sound speed profile is still lacking although we can use the fem to obtain the result the range of calculation is limited since the computational cost increases quickly as the seawater domain increases consequently it is necessary to develop a new numerical strategy that can both effectively reduce the computational complexity and improve the computational efficiency during the past 50 years significant progress has been made in the theoretical and computational methods of predicting sound propagation in the ocean acoustic environment under certain conditions the acoustic reflection effect from boundaries seabed and sea surface can be modelled with constant reflection factors neglecting the influence of the sound speed profile it is convenient to derive analytically the near field in shallow seas by using the image source method ism jensen et al 2011 brekhovskikh 1980 additionally the normal mode method is a relatively mature method and has been widely used in the field of hydro acoustics especially in addressing far field acoustic radiation problems in this paper we focus on the acoustic radiation field of floating bodies in the ocean acoustic environment the near and far fields are regarded as a unified system to simulate the acoustic radiation field of floating bodies in seawater by considering complicated sound speed profiles taking the accuracy and efficiency simultaneously into account a new strategy is proposed where the acoustic radiating body is regarded as a set of internal virtual point sources using the green s function as a link the ism is used to obtain the source intensity and to calculate the near field acoustic radiation while the normal mode method is used to calculate the far field acoustic radiation specifically the wsm can effectively avoid the problem of singular integrals the ism can obtain acceptable results and avoid the complicated calculation of the derivatives of green s functions the conventional normal mode method is used in the far field generally the calculation process is greatly simplified in this paper the radiated sound field of a spherical double shell immersed in finite depth water will be investigated by considering sound speed profiles of positive and negative gradients to validate the correctness of the proposed method the calculated results are compared with the fem results obtained via comsol the proposed method shows an improvement in the computational efficiency while preserving adequate accuracy even with a large computational domain around the structures additionally the calculation results in this paper could serve as benchmark examples for the integrated calculation of fluid structure coupled vibration acoustic radiation and sound propagation of three dimensional elastic floating bodies with arbitrary shapes in the ocean acoustic environment 2 mathematical derivation of the mixed analytical numerical method 2 1 equations of motion of the spherical shell the spherical double shell is oriented with its center at the origin of a spherical coordinate system as shown in fig 1 in which oz is the polar axis the shell is totally submerged in the water and the space between the inner and outer walls of the shell is also filled with water hereafter referred to as the in between water the mid surface displacement of the spherical shell is expressed in spherical coordinates as 1 s u r n r u θ n θ u φ n φ where n r n θ and n φ denote the unit vectors along the r θ and φ directions while u r u θ and u φ are the three components of the displacement vector s along the three directions of the spherical coordinate system in fig 1 f denotes the exciting force applied on the inner spherical wall of the double shell the model is required to be axisymmetric in the present method therefore the excitation is allowed to be a concentrated force at a specific point or a distributed pressure on a line or a surface the location of the excitation can also vary as long as the axisymmetry of the loads are guaranteed as an example of the allowable excitation types a concentrated force acting at the bottom of the inner spherical wall is considered in this work when the excitation on the spherical double shell is symmetric about the polar axis oz the motions of the shell are also symmetric about oz the only nonvanishing components of motion are u r and u θ the radial and tangential motions in the direction of increasing θ respectively the tangential component of motion in the φ direction vanishes i e u φ 0 both u r r θ t and u θ r θ t are independent of φ first the vibrations of the inner spherical wall will be analyzed the equations of motion for the inner spherical wall are derived using hamilton s variational principle junger and feit 1986 2 1 β 2 2 θ 2 cot θ θ σ cot 2 θ r 2 2 c p 2 2 t 2 u θ β 2 3 θ 3 β 2 cot θ 2 θ 2 1 σ β 2 σ cot 2 θ θ u r r 2 2 ρ s h 2 c p 2 f 2 θ β 2 3 θ 3 2 β 2 cot θ 2 θ 2 1 σ 1 β 2 β 2 cot 2 θ θ cot θ β 2 2 σ cot 2 θ 1 σ u θ β 2 4 θ 4 2 β 2 cot θ 3 θ 3 β 2 1 σ cot 2 θ 2 θ 2 β 2 cot θ 2 σ cot 2 θ θ 2 1 σ r 2 2 c p 2 2 t 2 u r r 2 2 ρ s h 2 c p 2 p 2 f 2 r where r 2 h 2 and ρ s are the radius thickness and density of the material of the inner spherical wall respectively β 2 is a constant defined by β 2 h 2 2 12 r 2 2 σ e and c p e ρ s 1 σ 2 are poisson s ratio young s modulus and the speed of longitudinal waves transmitting in the shell respectively the acoustic pressure acted on the surface of the inner wall which is induced by the in between water is p 2 p 2 r θ t r r 2 the radial and tangential components of the excitation are f 2 r and f 2 θ it is seen in eq 2 that the radial and tangential displacements of the spherical shell are coupled it will be more convenient to work with the following transformation 3 η cos θ η 2 d d η 1 η 2 d d η 4 ω 2 ω r 2 c p 2 if we make this transformation the foregoing set of equations eq 2 assuming harmonic time variation e i ω t where ω is the angular frequency can be written as 5 l 11 u θ l 12 u r 2 u θ 1 ρ s h 2 r 2 c p 2 f 2 θ ω l 21 u θ l 22 u r 2 u r 1 ρ s h 2 r 2 c p 2 f 2 r ω p 2 r θ ω r r 2 where the operators l 11 l 12 l 21 and l 22 are given by 6 l 11 1 β 2 1 η 2 1 2 d 2 d η 2 1 η 2 1 2 1 σ l 12 1 η 2 1 2 β 2 1 σ 1 σ d d η β 2 d d η η 2 l 21 β 2 1 σ 1 σ d d η 1 η 2 1 2 β 2 η 2 d d η 1 η 2 1 2 l 22 β 2 η 4 β 2 1 σ η 2 2 1 σ the equations of motion for the outer spherical wall is similar to eq 5 except that the acoustic pressure of the outside fluid should be additionally considered in the equation the radius and thickness of the outer spherical wall are r 1 and h 1 respectively the acoustic pressure from the in between water is p 2 r θ t r r 1 while the acoustic pressure from the outside fluid is denoted as p 1 r θ t r r 1 the radial and tangential components of the excitation are f 1 r and f 1 θ 2 2 the interactions between the in between water and the inner and outer walls of the spherical double shell to carry out an analysis in the frequency domain the helmholtz equation in the spherical coordinates can be solved by separation of variables the velocity potential of the acoustic wave for the in between water can be expressed as skudrzyk 1971 7 φ 2 r θ n 0 i n 2 n 1 p n cos θ f n j n k r g n y n k r where f n and g n are undetermined coefficients k ω c 0 is the acoustic wave number in the water c 0 is the speed of sound in the water p n denotes the legendre polynomials and j n and y n are spherical bessel and neumann functions respectively the relationship between velocity potential and acoustic pressure is 8 p 2 r θ i ω ρ 0 φ 2 r θ where p 2 is the acoustic pressure of the in between water and ρ 0 is the density of the water for the convenience of description the radial and tangential displacements of the inner spherical wall are denoted as w 2 θ and u 2 θ respectively while those of the outer spherical wall are denoted as w 1 θ and u 1 θ respectively for the case of symmetric vibration the radial and tangential displacements of the inner spherical wall can now be expressed in terms of an infinite series as junger and feit 1986 9 w 2 θ n 0 w 2 n p n η u 2 θ n 0 u 2 n 1 η 2 1 2 d p n η d η similarly the displacement components of the outer spherical wall are written as 10 w 1 θ n 0 w 1 n p n η u 1 θ n 0 u 1 n 1 η 2 1 2 d p n η d η w 1 n w 2 n u 1 n and u 2 n in the above equations eq 9 and 10 are the unknown generalized coordinates needed to be found it is assumed that the radial displacements of the two spherical walls are positive when pointing outward according to the compatibility condition on the wet surface of fluid structure interaction the boundary condition at the connecting interface of the inner spherical wall and the in between water can be expressed as 11 φ 2 r r r 2 i ω w 2 substituting eqs 7 and 9 in eq 11 yields 12 i n 2 n 1 f n k d j n χ d χ χ k r 2 g n k d y n χ d χ χ k r 2 i ω w 2 n the boundary condition at the interface of the outer spherical wall and the in between water can be derived in a similar way to yield 13 i n 2 n 1 f n k d j n χ d χ χ k r 1 g n k d y n χ d χ χ k r 1 i ω w 1 n combining eqs 12 and 13 results in 14 f n ω i n 1 2 n 1 a 4 w 2 n a 2 w 1 n a 1 a 4 a 2 a 3 g n ω i n 1 2 n 1 a 1 w 1 n a 3 w 2 n a 1 a 4 a 2 a 3 where a 1 k d j n χ d χ χ k r 2 a 2 k d y n χ d χ χ k r 2 a 3 k d j n χ d χ χ k r 1 a 4 k d y n χ d χ χ k r 1 the acoustic pressure of the in between water on the inner spherical wall can now be expressed as 15 p 2 r 2 θ ρ 0 ω 2 n 0 p n cos θ a 4 w 2 n a 2 w 1 n a 1 a 4 a 2 a 3 j n k r 2 a 1 w 1 n a 3 w 2 n a 1 a 4 a 2 a 3 y n k r 2 for the inner spherical wall the excitation f 2 r and f 2 θ can also be expressed in terms of p n η as in eq 15 p 2 f 2 r and f 2 θ can then be substituted into eq 5 taking into consideration the orthogonality of the legendre polynomials the fluid structure interaction equations of motion can be derived for each mode shape order n 16 l 11 n u 2 n l 12 n w 2 n 1 ρ s h 2 r 2 c p 2 f 2 θ n l 21 n u 2 n l 22 n f l n w 2 n f h n w 1 n 1 ρ s h 2 r 2 c p 2 f 2 r n where l 11 n ω 2 1 β 2 σ λ n 1 l 12 n β 2 σ λ n 1 1 σ l 21 n λ n β 2 σ λ n 1 1 σ l 22 n ω 2 2 1 σ β 2 λ n σ λ n 1 λ n n n 1 f l n ρ 0 ω 2 a 4 a 1 a 4 a 2 a 3 j n k r 2 a 3 a 1 a 4 a 2 a 3 y n k r 2 r 2 2 ρ s h 2 c p 2 f h n ρ 0 ω 2 a 2 a 1 a 4 a 2 a 3 j n k r 2 a 1 a 1 a 4 a 2 a 3 y n k r 2 r 2 2 ρ s h 2 c p 2 the radial exciting force is set at the location of r r 2 θ π on the inner spherical wall with the amplitude being unity f r δ θ π 2 π r 2 2 sin θ where δ is the dirac delta function now in eq 16 f 2 θ n 0 f 2 r n 2 n 1 2 p n 1 2 π r 2 2 analogously the acoustic pressure from the in between water on the outer spherical wall can be derived 17 p 2 r 1 θ ρ 0 ω 2 n 0 p n cos θ a 4 w 2 n a 2 w 1 n a 1 a 4 a 2 a 3 j n k r 1 a 1 w 1 n a 3 w 2 n a 1 a 4 a 2 a 3 y n k r 1 2 3 the interaction between the outer spherical wall and the ambient finite depth water for various ocean acoustic environments the corresponding green s functions which represent the sound propagation model of a monopole sound source in this hydro acoustic environment can be introduced here jensen et al 2011 as shown in fig 2 the spherical double shell is submerged in a finite depth water domain the seawater density and sound speed in the seawater are denoted as ρ 0 and c 0 respectively while the seabed density and sound speed in the seabed are denoted as ρ 1 and c 1 respectively in this work ρ 0 ρ 1 and c 1 are assumed constant while c 0 will vary along the direction of depth the sea surface is treated as a pressure release boundary i e the acoustic pressure is zero when the sound speed c 0 is a constant i e the sound speed profile is uniform the finite depth water environment is reduced to the pekeris hydro acoustic waveguide environment it can be understood qualitatively that the near field of the radiated sound from underwater structures is not sensitive to the sound speed profile of the seawater this will be further verified in the following sections using practical calculation results therefore the sound speed profile of the seawater is assumed to be approximately uniform i e the pekeris hydro acoustic waveguide when analyzing the sound structure interaction between the ambient fluid and the spherical shell as well as calculating the near field acoustic radiation of the spherical shell it is known from the literature zou et al 2013a that the pekeris hydro acoustic waveguide can be approximated as a finite depth water domain with constant acoustic reflection factors at both the seabed and the sea surface when the condition s 2 d 2 z 0 z 1 19 is satisfied d 2 is the distance from the center of the shell to the seabed while the meaning of s z 0 and z can be referred to the description below eq 18 generally s 2 d 2 z 0 z 1 19 will be satisfied in the vicinity of the shell under this circumstance the green s function can be expressed in terms of an infinite series zou et al 2013a 2018 brekhovskikh 1980 as follows 18 g r r 0 l 0 γ γ 1 l e i k r l 1 r l 1 γ e i k r l 2 r l 2 γ 1 e i k r l 3 r l 3 γ γ 1 e i k r l 4 r l 4 where γ and γ 1 denote the acoustic reflection factors of the seabed and sea surface respectively r 0 x 0 y 0 z 0 is the position of the source point and r x y z represents the field point r l 1 r l 2 r l 3 r l 4 and s are defined as follows r l 1 s 2 2 l d z z 0 2 1 2 r l 2 s 2 2 l d 2 d 2 z z 0 2 1 2 r l 3 s 2 2 l d 2 d 1 z z 0 2 1 2 r l 4 s 2 2 l 1 d z z 0 2 1 2 s x x 0 2 y y 0 2 1 2 in which d is the water depth d 1 is the distance from the center of the spherical shell to the sea surface also known as the submerging depth and d 2 is the distance from the center of the spherical shell to the seabed it should be mentioned that the green s function corresponds to a virtual source chain formed by the reflection of sound waves between the seabed and sea surface and satisfies the boundary conditions at the seabed and sea surface automatically the sea surface is treated as the pressure release boundary γ 1 1 as the constitution of the seabed differs the acoustic reflection factor γ may vary it is found that when γ 0 1 0 6 only the first nine items of the sum in eq 18 are required to ensure sufficient precision and convergence the wsm is adopted to solve the interaction problem between the outer spherical wall and the outside fluid field as well as the radiation problem in the water the external excitation is applied at the bottom of the inner spherical wall at the location of r r 2 θ π this results in a symmetrical vibration problem according to the symmetric characteristic of vibration the acoustic boundary integral equation can be simplified from a surface integral to a line integral by using the wave superposition approach which can greatly improve the computational efficiency the source points are distributed on a line that coincides with the polar axis oz while the field points are on the generating line of the outer spherical wall as shown in fig 3 the numbers of both source and field points are set as n j the x and y coordinates of the n j th 1 n j n j source point is zero and the z coordinate is expressed as 19 z 0 n j r 1 1 2 n j 1 n j the y coordinate of the n j th 1 n j n j field point is zero and the x and z coordinates are defined respectively as 20 x n j r 1 sin n j 0 5 π n j z n j r 1 cos n j 0 5 π n j according to the wave superposition approach the acoustic wave potential induced by the vibration mode of order n of the outer spherical wall can be expressed as 21 φ 1 n r n j 1 n j q n j r 0 g r r 0 where q n j r 0 is the undetermined source intensity of the n j th source point combining eq 10 and eq 21 and taking into account the orthogonality of the legendre polynomials the boundary conditions for the fluid structure interaction between the outer spherical wall and the outside fluid field can be derived 22 i ω p n η n j 1 n j q n j r 0 g r r 0 n r where the field point r lies on the surface of the outer spherical wall and g r r 0 n r denotes the normal derivative of the green s function on the outer spherical surface the source intensity q n j r 0 can be determined from the above equation the acoustic wave potential of the outside fluid field can be expressed by a linear superposition 23 φ 1 r n 0 w 1 n n j 1 n j q n j r 0 g r r 0 the sound pressure at a field point is 24 p 1 r i ω ρ 0 φ 1 r the sound pressure on the surface of the outer spherical wall can be written in terms of the legendre polynomials 25 p 1 r n 0 w 1 n m 0 a m n p m η combining eq 21 eq 23 eq 24 and eq 25 and taking into consideration the orthogonality of the legendre polynomials the coefficient a m n is derived 26 a m n 2 m 1 2 i ω ρ 0 π n j n j 1 n j φ 1 n r p m η sin n j 0 5 π n j where η cos n j 0 5 π n j for the n j th field point substituting eq 17 and eq 25 into eq 5 and making use of the orthogonality of the legendre polynomials the fluid structure interaction equations of motion can be derived for the outer wall 27 l 11 n u 1 n l 12 n w 1 n 0 l 21 n u 1 n l 22 n f i n w 1 n m 0 b n m w 1 m f g n w 2 n 0 where l 11 n l 12 n l 21 n and l 22 n are similar to l 11 n l 12 n l 21 n and l 22 n in eq 16 only the dimensions of the inner spherical wall should be changed to those of the outer wall here b n m r 1 2 ρ s h 1 c p 2 a n m f i n ρ 0 ω 2 a 2 a 1 a 4 a 2 a 3 j n k r 1 a 1 a 1 a 4 a 2 a 3 y n k r 1 r 1 2 ρ s h 1 c p 2 f g n ρ 0 ω 2 a 4 a 1 a 4 a 2 a 3 j n k r 1 a 3 a 1 a 4 a 2 a 3 y n k r 1 r 1 2 ρ s h 1 c p 2 by combining eq 16 and eq 27 and truncating the mode order of the spherical shell to n the following matrix equation is derived 28 l 220 f i 0 b 00 l 210 f g 0 0 b 0 n 0 0 0 l 120 l 110 0 0 0 0 0 0 f h 0 0 l 220 f l 0 l 210 0 0 0 0 0 0 l 120 l 110 0 0 0 0 b n 0 0 0 0 l 22 n f i n b n n l 21 n f g n 0 0 0 0 0 l 12 n l 11 n 0 0 0 0 0 0 f h n 0 l 22 n f l n l 21 n 0 0 0 0 0 0 l 12 n l 11 n w 10 u 10 w 20 u 20 w 1 n u 1 n w 2 n u 2 n 0 0 1 ρ s h 2 r 2 c p 2 1 2 p 0 1 2 π r 2 2 0 0 0 1 ρ s h 2 r 2 c p 2 2 n 1 2 p n 1 2 π r 2 2 0 2 4 calculation of the far field green s function using the normal mode method considering the non constant sound speed profile and the non constant acoustic reflection coefficient of the seabed in the far field the solution to the far field green s function in the ocean acoustic waveguide environment is the key to the proposed integrated calculation scheme the normal mode method is used to solve the far field green s function in this study which is a fast accurate and efficient method in the field of computational ocean acoustics jensen et al 2011 in the normal mode method the computational scale is independent of the distance and the sound field in the whole fluid domain can be directly calculated for the readability of this paper the normal mode method is briefly introduced in this subsection for a general sound speed profile it is usually impossible to derive an analytical solution using the normal mode method therefore a numerical approach is introduced to obtain the corresponding green s function in this work the far field green s function is derived by using the normal mode method based on finite difference the seawater region d 2 z d 1 is divided into n equidistant layers along the depth direction so that n 1 grid points are formulated the z coordinates of the grid points from the sea surface to the seabed are denoted as z s j d 1 j h j 0 1 n where h is the thickness of each layer it is required that h d n is less than one tenth of the wavelength of the acoustic waves assuming that the eigenfunction of the normal mode with respect to depth can be denoted as ψ z the function value at each grid point can be expressed as ψ j ψ z s j the density of the seawater is a constant ρ 0 using the standard three point finite difference formula the eigenvalue problem expressions of the whole sound field can be written as 29 ψ j 1 2 h 2 ω 2 c 0 2 z s j k s 2 ψ j ψ j 1 0 j 1 2 n 1 f t g t ψ 0 1 ρ 0 ψ 1 ψ 0 h ω 2 c 0 2 z s 0 k s 2 ψ 0 h 2 0 f b g b ψ n 1 ρ 0 ψ n ψ n 1 h ω 2 c 0 2 z s n k s 2 ψ n h 2 0 where c 0 z s j is the sound speed at depth z s j k s is the eigenvalue k s is also the horizontally propagating wavenumber of the normal mode and f t b and g t b represent the boundary impedance conditions for the pressure release boundary the sea surface f t g t tends to be infinite while f b k s 2 1 and g b k s 2 ρ 1 k s 2 ω c 1 2 for the fluid bottom the finite difference formula in eq 29 can also be rewritten in the form of an algebraic eigenvalue problem 30 c k s 2 ψ 0 where ψ is the vector with components ψ 0 ψ 1 ψ n and c is a symmetric tri diagonal matrix defined as 31 c b 0 e 1 e 1 b 1 e 2 e 2 b 2 e 3 e n 2 b n 2 e n 1 e n 1 b n 1 e n e n b n the matrix elements b j and e j are defined as 32 b 0 2 h 2 ω 2 c 0 2 z s 0 k s 2 2 h ρ 0 f t k s 2 g t k s 2 33 b j 2 h 2 ω 2 c 0 2 z s j k s 2 2 h ρ 0 j 1 2 n 1 34 b n 2 h 2 ω 2 c 0 2 z s n k s 2 2 h ρ 0 f b k s 2 g b k s 2 35 e j 1 h ρ 0 j 1 2 n when the boundary condition is ideal e g the case of free sea surface and rigid seabed the functions f t b and g t b are independent of k s and the above problem is reduced to a standard algebraic eigenvalue problem that can be solved using standard routines however for the fluid bottom considered in this work a suitable method is needed to extract the corresponding eigenvectors and eigenvalues in the present work the sturm s method combined with the bisection method and inverse iteration is used to solve the eigenvalue problem porter and reiss 1984 this method is of high precision efficiency and numerical stability based on the attenuation rules of acoustic waves in the horizontal direction denoted by s the m eigenvalues normal mode wavenumbers and the corresponding normalized eigenvectors normal modes are substituted into the following formula to obtain the green s function jensen et al 2011 36 g r r 0 π i ρ 0 m 1 m ψ m z 0 ψ m z h 0 1 k s m s where h 0 1 is the zeroth order hankel function of the first kind and k s m is the mth real eigenvalue it should be noted that the m eigenvalues involved in eq 36 which is used to calculate the green s function contain all the real roots of the eigenvalue problem i e the propagation mode whose energy will remain in the seawater however for the leaky mode corresponding to the complex roots of the eigenvalue problem the energy will radiate into the half space of the seabed and thus the contribution to the entire sound field will decrease exponentially with increasing distance in this paper the influence of the leaky mode will be ignored and only the propagation mode is considered in the calculation of the far field green s function generally for the region that can be regarded as the far field the real roots are enough to use in the normal mode method since the complex roots make little contribution to the far field for example porter 1992 the author of the well known normal mode program kraken states that considering only the real root parts of the normal modes in the algorithm is sufficient to obtain accurate results for the region beyond ten times the water depth 2 5 acoustic radiation in the water the generalized coordinates w 10 w 11 w 1 n can be obtained from eq 28 subsequently the vibratory response and acoustic radiation of the outer spherical wall can be calculated from eq 10 and eq 23 it should be noted that the virtual source method eq 18 is used to calculate the green s function when solving the source intensity and evaluating the near field acoustic radiation also the normal mode method introduced in sec 2 4 is adopted to calculate the green s function when evaluating the far field acoustic radiation the radiated power into water can then be calculated by the integration on the outer surface 37 p s ω 1 2 re n j 1 n j i ω w 1 p 1 r δ s n j where the superscript denotes the complex conjugate the field point r lies on the surface of the outer spherical wall and δ s n j is the wet surface area corresponding to the n j th field point which equals the area generated by multiplying the length π r 1 n j of the arc and the corresponding perimeter 2 π r 1 sin n j 0 5 π n j 38 δ s n j 2 π r 1 sin n j 0 5 π n j π r 1 n j the sound pressure level l p based on the sound pressure and the sound source level s l s based on the acoustic power can be expressed as follows 39 l p 20 log 10 p 1 2 p 0 40 s l s 10 log 10 p s p 0 where the reference pressure is p 0 1 10 6 pa and the reference acoustic power is p 0 0 65 4 π 10 18 w 3 validation of the computational methods and computer codes the general process of the calculation is summarized as follows 1 analytically express the displacement components of the inner and outer walls of the spherical double shell using a series expansion analogous to the concept of the shell s in vacuo modes the unknown generalized coordinates are w 1 n w 2 n u 1 n u 2 n 2 evaluate the interaction between the spherical walls with the in between water using an analytical method express the acoustic pressure on the outer surface of the inner wall and on the inner surface of the outer wall in terms of series where the generalized coordinates are unknowns 3 evaluate the interaction between the outer spherical shell and the ambient fluid using the wsm express the acoustic pressure on the outer surface of the outer wall in terms of a series expansion the green s function is in the summing form of a series as shown in eq 18 the effect of the sound speed profile is ignored 4 solve explicitly the generalized fluid structure interaction dynamic equation eq 28 to obtain the generalized coordinates w 1 n w 2 n u 1 n u 2 n 5 by substituting the generalized coordinates into the corresponding formulas the vibration and near and far fields acoustic radiation can be calculated the normal mode method is used to calculate the green s function when evaluating the far field acoustic radiation the effect of the sound speed profile is considered to validate the correctness of the computational methods and the corresponding computer codes described in this paper the calculation results obtained using the proposed method the number of source points in the wave superposition method is n j 80 are compared with those calculated using comsol the detailed parameters for the validation example are given below the radius and thickness of the inner wall are 0 5 m and 0 8 mm while the radius and thickness of the outer wall are 0 65 m and 0 3 mm respectively the material density young s modulus poisson s ratio and the structural damping factor for the inner and outer walls of the double shell are 7800 kg m3 2 1 1011 n m2 0 3 and 0 02 respectively the distance from the center of the spherical shell to the sea surface is 6 m i e the submerging depth is 6 m the seabed density and sound speed in the seabed are 2600 kg m3 and 1620 m s respectively the density of the seawater is 1025 kg m3 two sound speed profiles are used here see fig 4 1 positive gradient profile where the speed range is 1507 m s to 1517 m s 2 negative gradient profile where the speed range is 1513 m s to 1503 m s in the following numerical implementation a harmonic normal force is assumed to be applied on the bottom of the inner wall it is worth noting that the effective value of the harmonic force is set as unity here i e the amplitude is 2 n the near field green s function can be calculated using eq 18 with the aforementioned seawater and seabed parameters the acoustic reflection factor of the seabed where the detailed calculation can be found in the literature zou et al 2013a is set as γ 0 4626 by considering the characteristic of symmetry of the spherical double shell a two dimensional equivalent model shown in fig 5 is established using comsol to balance both the computational accuracy and computational cost three finite element sizes 0 04 m 0 12 m 0 5 m are used the mesh size increases as the field point varies from the vicinity of the spherical shell to the far field however the calculation region of the seawater is set to only 1 25 km the effective calculation region is only about 1 km since the calculation accuracy will be worse due to the effect of boundary truncation using the perfectly matched layer pml between 1 km and 1 25 km the fem requires much more computational resource than the present method if the entire three dimensional fem model is used to calculate the acoustic radiation at a relatively larger computational domain the computational cost will be too large however the present wsm only requires 80 source points to obtain acceptable results for the same example from the comparison of sound pressure level curves in fig 6 and the comparison of sound pressure level contour plots in fig 7 the proposed numerical results are in good agreement with the fem results when the test field point is relatively far from the spherical shell a small distinction exists between the results obtained by the proposed method and the fem it may be caused by the following two reasons 1 the leaky modes corresponding to complex roots are not taken into account which may still have a slight influence on the calculation of the green s function by using the normal mode method in the vicinity of 1 km 2 the field points in the vicinity of 1 km are close to the pml region and calculation deviations may exist using comsol in addition all three curves in fig 6a agree with each other well which reveal that the sound speed profile has little effect on the radiated acoustic pressure in the vicinity of the spherical shell this also validates the conclusion in sec 2 3 that the sound speed profile of the seawater can be regarded as uniform when analyzing the sound structure interaction of the external fluid and the spherical shell and the near field sound field radiated by the spherical shell it is seen from figs 6b and 7 that the far field sound pressure distribution varies significantly when the sound speed profile differs therefore the sound speed profile has an effect on the radiated sound pressure at a relatively large distance at present the effective calculation region is confined to 1 km it is predicted that the influence of the sound speed profile will also increase with a much farther field point from the spherical shell it can be seen from the results shown in fig 7 that there is a clear interference phenomenon in each contour plot of the radiated sound field due to the acoustic reflection of the sea surface and the seabed two dark spot areas can be observed in each contour plot moreover the results in fig 7c and d have an overall translation along the x direction relative to the results in fig 7a and b this phenomenon is caused by the distinction of sound speed profiles 4 acoustic radiation analysis of a double elastic spherical shell in ocean acoustic environment in this section the mixed analytical numerical method established in this paper will be implemented to the acoustic radiation analysis of a double elastic spherical shell in the ocean acoustic environment specifically the effect of submerging depths and seabed parameters on the acoustic radiation of the spherical double shell will be analyzed it should be noted that the origin of the coordinates is set at the center of the spherical double shell 4 1 acoustic radiation analysis of the double shell with different submerging depths and a fixed water depth in this section the water depth is set to a fixed value of 20 m two submerging depths the distance from the center of the spherical shell to the sea surface 10 m and 14 m are considered the remaining parameters are the same as those defined in sec 3 it is seen from fig 8 that there is a distinction between the two sound pressure level curves with different submerging depths the varied distinctions could be found with different field points at different frequencies there may be several factors that lead to this distinction the detailed mechanism underlying this phenomenon needs further investigation it can be imagined intuitively that there will be a fluctuation in the sound pressure level curve of the far field point x 1000 y 0 z 0 due to the acoustic wave interference caused by the reflection of the seabed and the sea surface however the two curves in fig 8b submerging depth 14 m positive gradient and submerging depth 14 m negative gradient are different from the above mentioned intuitive imagination i e there is no fluctuation in the frequency range larger than 100 hz similar numerical results can be obtained using comsol for the same physical model this anomalous phenomenon is interesting but its mechanism is not clear yet and will be further studied in the future fig 9 a and b shows the sound pressure distribution corresponding to the submerging depth 10 m case the basic rules shown in these two figures are analogous to those in fig 7 the contour plots in fig 9c and d are special because there is no obvious acoustic interference caused by the acoustic reflection from the seabed and the sea surface this is consistent with the results in fig 8b the detailed mechanism underlying this phenomenon still needs further investigation 4 2 effect of seabed parameters on the acoustic radiation of the double shell in this subsection the water depth is 20 m and the submerging depth is 10 m two cases are considered to figure out the effect of seabed parameters 1 the seabed density and sound speed in the seabed are ρ 1 1400 kg m 3 and c 1 1620 m s respectively the acoustic reflection factor of the seabed is γ 0 1888 2 the seabed density and sound speed in the seabed are ρ 1 3000 kg m 3 and c 1 2050 m s respectively the acoustic reflection factor of the seabed is γ 0 5979 the remaining parameters are the same as those in sec 3 from fig 10 it can be found that the seabed parameters have a significant effect on the sound pressure level at the far field point which may be larger than the effect caused by the sound speed profile with the stronger acoustic reflection from the seabed the sound pressure level fluctuates more drastically along with the increasing frequencies the sound pressure distributions in the xz plane are plotted for two groups of seabed parameters with two different sound speed profiles at the frequency 200 hz from the viewpoint of seabed reflection the acoustic reflection induced by the sea floor is relatively strong when the seabed parameters are ρ 1 3000 kg m 3 and c 1 2050 m s it can be seen from fig 11 that the acoustic interference phenomenon exists for the two sets of seabed parameters the sound speed profile has a certain influence on the spatial distribution of the sound field the fluctuation of the acoustic field caused by acoustic wave interference increases with the stronger acoustic reflection from the seabed 5 conclusion unlike the previous studies on the acoustic radiation of three dimensional elastic floating bodies in an infinite acoustic medium and the sound propagation of monopoles in the ocean acoustic environment a new calculation strategy is proposed in this paper to evaluate the acoustic radiation field of a three dimensional spherical double shell in finite depth water while considering the effect of the arbitrary sound speed profile both the sound speed profile in finite depth water and the sound absorption of the seabed are considered the near and far fields of the radiated sound are regarded as a unified system in particular the proposed method gives reliable results even with a large computational domain around the structures the radiated sound field of a spherical double shell is evaluated by considering sound speed profiles of positive and negative gradients which are compared with the fem results calculated via comsol the proposed results are in good agreement with the fem results the wsm can effectively avoid the problem of singular integrals the ism can obtain acceptable results and avoid the complicated calculation of the derivatives of green s functions the normal mode method is used to deal with the far field therefore the proposed method can improve the computational efficiency while preserving adequate accuracy the proposed wsm only requires 80 internal source points on the axis of the spherical shell in order to obtain accurate results in comparison with the fem the proposed mixed analytical numerical method has the advantage of high computational efficiency and accuracy for the sound field beyond several kilometers the computational cost of the fem is almost unaffordable in contrast the computational cost of the proposed method is independent of the size of the computational domain this feature guarantees that the calculation results in this paper could serve as benchmark examples for the integrated calculation of fluid structure coupled vibration acoustic radiation and sound propagation of three dimensional elastic floating bodies with arbitrary shapes in the ocean acoustic environment under the investigation on the acoustic radiation of a spherical double shell in finite depth water environment with sound speed profiles of positive and negative gradients it can be found that the sound speed profile the sea surface and the seabed have certain effects on the underwater acoustic radiation of floating bodies specifically the details of these effects are closely related to the water depth submerging depth sound speed profile parameters of the seabed excitation frequency etc due to the acoustic reflection of the sea surface and seabed there is a clear interfering phenomenon on the contour map of the sound pressure distribution which is different from the case of the unbounded water domain however there is no obvious interfering phenomenon in the contour of the sound pressure distribution when the spherical shell is at a certain submerging depth this requires further study of the related mechanism it should be noted that these examples also demonstrate the importance of establishing an integrated calculation method for the fluid structure coupled vibration acoustic radiation and sound propagation of an arbitrary three dimensional elastic floating body in the ocean acoustic environment author contribution statement ming song zou conceptualization methodology investigation validation shu xiao liu writing original draft preparation writing reviewing and editing ling wen jiang methodology visualization he huang software declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national key r d program of china grant no 2017yfb0202701 the national natural science foundation of china grant nos 11772304 and 51709241 and the natural science foundation of jiangsu province of china grant no bk20170216 the authors wish to thank assoc prof bin wang at shanghai jiao tong university for his kind help in using comsol besides the authors are grateful to prof zhuo jia fu at hohai university and assistant prof d watson at mississippi college for their help in improving the english writing of the manuscript 
22058,there are challenges in simulating two phase flows with large density ratios using traditional sph taking full advantages of riemann solver in dealing with contact discontinuity problems and combining two phase flow sph method with riemann solver a new model of two phase flow coupling with structure based on an improved riemann solver is described for the water entry problems with the effect of air the flow momentum equation of the riemann form is improved to decrease the riemann dissipation and simulate the two phase flows with different viscosity ratios one sided riemann problem considering the free slip and no slip conditions at a wall is used to deal with the fluid body interaction a switch function based riemann solver dissipation is used to improve the instability of interface owing to the strong impact in order to test the accuracy of the model in fluid structure coupling problems five cases including dam break sinking of a rectangle body water entry of a wedge flat plate slamming on water and water entry of a catamaran are numerically simulated the agreements between the present results and other reference results demonstrate that the proposed method is robust and stable to simulate the water entry problems with the air graphical abstract image 10238 keywords two phase flows fluid structure coupling sph smoothed particle hydrodynamics riemann solver water entry 1 introduction in the ocean engineering field fluid structure coupling problems such as diving of sportsman ship slamming waves slapping and landing of aircraft on water are important subject matter the accurate prediction of the structure dynamics response can provide guide and reference for engineering design e g the ship design in naval architecture and ocean engineering the structure entering water is a typical fluid structure coupling problem which involves complex hydrodynamics and kinetics problems wang et al 2015 when the structure enters the water due to the strong impact structure will produce rolling pitching and vertical movement which causes internal device malfunction or even local damage of structure and the water surface will produce splashing breaking and rolling phenomena therefore it is worthy to make further studies numerical study of water entry problems using the traditional eulerian grid based numerical methods have been challenging considering the influence of the air on the water entry structure the difficulties will increase to capture the large free interface deformation and track the moving objects special algorithms need to be added which will complicate the algorithms lin 2007 wick 2011 mesh free numerical methods such as smoothed particle hydrodynamics sph monaghan 1985 and moving particle semi implicit mps koshizuka and oka 1996 can overcome above difficulties and have the advantage of modeling the water entry problems oger et al 2006 was the first to apply the weakly compressible sph wsph to simulate the water entry problems and a technic was introduced to evaluate fluid pressure on solid boundaries then maruzewski et al 2010 further developed the sph method for the water entry problems afterwards skillen et al 2013 adopted incompressible sph isph to simulate the water entry of the wedge and cylinder sun et al 2018 studied 2d and 3d water entry cylinder using the developed δ sph in which the adaptive particle refinement apr was applied to reduce the computational cost to accurately predict the high and localized impact pressure marrone et al 2018 used a riemann ale smoothed particle hydrodynamics model to simulate the high speed water entry of plates in recent literature liu and zhang 2019 reviewed applications of the sph method in various water entry problems however above simulations of water entry problems generally are limited in the scope of a single phase flow coupling with structure none of these works investigate the effect of air due to the discontinuity of property across the interface the simulation of two phase flow problems is difficult with the traditional particle methods especially in the multi phase flow problems with large density ratios in view of this many scholars have conducted studies on the simulation of the multi phase flow and multi phase flow coupling with structure by particle methods monaghan and kocharyan 1995 were the first to put forward the concept of multi phase sph model for the simulation of two phase flows with small density ratios subsequently to steady the interface of multi phase flows with large density ratios colagrossi and landrini 2003 hu and adams 2006 2007 and grenier et al 2009 2013 presented various modifications including density reinitialization artificial viscosity cohesive force xsph technique and so on khayyer and gotoh 2013 combined an extended version of sph density smoothening scheme with mps method to enhance the numerical stability of multi phase flows with high density ratios later khayyer et al 2019 improved previously schemes and proposed a novel projection based particle method for simulation of multi phase flows which was called the improved mps ops optimized particle shifting for the studies of multi phase flow coupling with structure in lind et al 2015 it proved that the air cushion had an important effect on the slamming load subjected to entry structure with a low dead rise angle like plate yan et al 2015 studied the water entry catamaran hull where the air was trapped beneath the hull and the effect of air was pronounced again khayyer and gotoh 2016 proposed to adopt a modified error compensating source term of poisson pressure equations in the framework of multi phase mps to model water entry of a rigid plate and the air cushioning effect was validated based on riemann ale smoothed particle hydrodynamics model marrone et al 2017 considered the influence of air cushioning to study the water entry of the 3d complex geometries in the above simulation of the two phase flow coupling with structure problems pressure oscillation is always a tricky problem to deal with in order to reduce pressure oscillation of multi phase flow field produced by the impacting of water entry most researches introduced the artificial viscosity term proposed by monaghan 1994 into the momentum equation but the artificial viscosity is not the real viscosity of fluid which easily affects the real motion characteristics of the fluid and energy conservation by reconstructing the sph convolution integrals a godunov sph gsph algorithm with no artificial viscosity was proposed by inutsuka 1994 where the riemann problem was applied to construct an imaginary interface between two particles later various kinds of godunov sph schemes had been proposed in the literature cha and whitworth 2003 sirotkin and yoh 2013 puri and ramachandan 2014 yang et al 2020 puri and ramachandan 2014 established the equivalence of the dissipative terms in gsph to the signal based artificial viscosity in sph and pointed that the gsph dissipation helped to prevent particle penetration in some cases such as subsonic and supersonic flow collision tests cha and whitworth 2003 teschner et al 2019 utilized the numerical dissipation introduced by the riemann solver to preserve pressure stability of steady state flows taking full advantages of riemann solver in dealing with contact discontinuity problems rezavand et al 2019 proposed a multi phase sph method to simulate highly violent flows problems on the base of the zhang and hu 2017 study but this multi phase sph model cannot simulate the two phase flow problems with various viscosity ratios and has limitations in application therefore this paper develops a set of novel gas liquid two phase sph model based on riemann solver which can simulate the problems of the viscous two phase flow coupling with structure in the present work the momentum equation of the riemann form is improved to make up for the defects of rezavand et al 2019 model and reduce the riemann dissipation for the sake of establishing a consistent sph model based on riemann solver one sided riemann problem proposed by zhang and hu 2017 is expanded and used to impose the interaction between two phase flow and structure which is different from the previous literature zhang and hu 2017 and can deal with both the no slip boundary and free slip boundary and a switch function based riemann solver dissipation as a new lower numerical diffusion term is used to improve the instability of flow field where the strong impact occurs this imposed dissipation is different from that of the global application of the artificial diffusion used in the previous studies yan et al 2015 cao et al 2018 this paper is organized as follows in section 2 governing equations of two phase flow and the motion equations of moving object are presented the detailed derivations of the proposed two phase sph model based on an improved riemann solver are reported in section 3 including some strategies to ensure the stability and accuracy in section 4 five representative cases including dam break sinking of a rectangle body water entry of a wedge flat plate slamming on water and water entry of a catamaran are numerically simulated by the present two phase sph model several conclusions are drawn in section 5 2 fluid structure interact formulation the governing equations of the two phase fluid and the motion equations of structure are introduced first the following sph formulations are descripted and the two phase sph model based on an improved riemann solver for simulating fluid structure problems is presented in the section 3 2 1 governing equations for two phase fluid in the present work the mass and momentum conservation equations of two phase fluid based on the compressible navier stokes equations are 1 d ρ d t ρ v d v d t 1 ρ p g where ρ v p and g refer to the density the velocity the pressure and gravitational acceleration respectively in order to fulfill the incompressible limit the two phase fluid is assumed to be weakly compressible monaghan and gingold 1983 morris et al 1997 the eq 1 is non closed the tait equation of state is used to solve the two phase fluid evolution moreover the form of the tait equation of state is applied 2 p ρ 0 c 2 γ ρ ρ 0 γ 1 p 0 where ρ 0 is the reference density for water the initial density is ρ w0 1000 kg m3 while for air the initial density is ρ a0 1 29 kg m3 for the heavier phase γ 7 is used and γ 1 4 is used in the lighter phase as suggested in literature zhang et al 2015 colagrossi and landrini 2003 p 0 is the background pressure which can keep the particle uniform distribution and prevent the tension instability induced by negative pressure the background pressure is only used in two phase flow problems and its value should be carefully chosen gong et al 2016 to ensure the initial pressure is smooth at the interface the different phases would have the same coefficient ρ 0 c 2 γ c 0 is the artificial sound speed which is chosen to keep the variation of density within 1 so the sound speed c 0w of the heavier phase meets conditions as follows marrone et al 2017 3 c 0 w 10 max v max p max ρ 0 where v max and p max are the maximum expected velocity and pressure respectively and the sound speed c 0h of the lighter phase is c 0h ρ 0w c 0w 2 γ h ρ 0h γ w 0 5 2 2 the motion equations for moving object we consider the rotation of the object during the motion based on the newton s law of motion the motion equations of the object s center of mass can be written as follows 4 d v 0 d t f m g d w 0 d t j i where v 0 and w 0 denote the velocity and the angular velocity of the object s center of mass respectively f m j and i are the summation of forces without gravity the mass of the object the total moment of force on the object about the center of mass and the moment of inertia respectively the velocity of a point i on the object is 5 v i v 0 w 0 r i o where r io is the vector r io r i r o 3 the present two phase sph model 3 1 basic sph smoothed particle hydrodynamics sph is a lagrangian meshless method in which the continuous matter field is discretized into particles possessing physical properties such as density velocity acceleration pressure and viscosity liu and liu 2003 the governing equations of two phase fluid and moving object will be solved by sph method an arbitrary field function f r i and its derivative f r i at particle i position can be approximated by kernel interpolation in its supported domain as monaghan 1985 6 f r i ω f r w r i r h d r j m j ρ j f r j w r i r j h f r i ω f r i w r i r h d r j m j ρ j f r j i w r i r j h j m j ρ j f r i f r j i w r i r j h where ω is the support domain of the smooth function the subscript j represents the j th particle within the supported domain of the particle i m j and ρ j are the mass and density of particle j respectively h refers to the smoothing length of the area affected by the kernel function which is chosen to be 1 25δx and δx is the initial particle spacing w r i r j h and i w r i r j h are the kernel function and its gradient with respect to the particle i respectively in this paper the kernel function proposed by wendland 1995 is applied 7 w r i r j h α 2 q 4 2 q 1 0 q 2 0 q 2 where q r i r j h one dimensional problems α 3 64h two dimensional problems α 7 64h 2 three dimensional problems α 21 256h 3 through the transformation of sph method in eq 6 governing equations for two phase fluid in eq 1 can be expressed as 8 d ρ i d t ρ i j m j ρ j v i v j i w i j r i r j h 2 ρ i j m j ρ j v i v i j i w i j r i r j h d v i d t 1 ρ i j m j ρ j p i p j i w i j r i r j h g 2 ρ i j m j ρ j p i j i w i j r i r j h g where v i j v i v j 2 and p i j p i p j 2 are the average velocity and pressure of particle i and particle j respectively 3 2 the improved sph model based on riemann solver the new sph model unlike the conventional sph method describing the interaction between particles only by the weighting summation of the neighboring particles in the support domain is based on riemann solver where each pair of particles is regarded as a riemann problem this riemann problem is constructed along the vector e ij r i r j r i r j and this interaction point is located at the midway point between particle i and particle j puri and ramachandan 2014 zhang and hu 2017 as shown in fig 1 a the left and right states of a constructed inter particle riemann problem are shown as 9 ρ l u l p l ρ i v i e i j p i ρ r u r p r ρ j v j e i j p j the contact discontinuity of riemann problem is located at r r i r j 2 the first order riemann solver is used to approximate the riemann problem four states are divided by three waves as shown in fig 1 b assume that the intermediate states on both sides of the middle wave are equivalent similarly to zhang and hu 2017 a linearized riemann solver is used to approximate the intermediate states 10 u l u r u i j u 1 2 p l p r ρ i j c i j p l p r p i j p 1 2 ρ i j c u l u r where u ρ c and p are the inter particle velocity density sound speed and pressure respectively c is the inter particular sound speed which is related to the riemann dissipation in sph model see more in puri and ramachandan 2014 in the two phase flows the abrupt discontinuities of density and viscosity across the interface contribute to the numerical instability especially in the water entry problems with the effect of air at the moment of impact the pressure of two phase flow suddenly increases near the slamming area water splash and the large interface deformation can be observed so the reasonable way to assume values of the inter particle physical quantity such as velocity density sound speed and pressure has a crucial influence on the stability and precision of numerical simulation rezavand et al 2019 adopted the density weighted inter particle velocity and pressure to represent the inter particle velocity and pressure respectively these formulas are reasonable for two phase flows with small density ratios however for the two phase flows with large density ratios the introduction of the density weighted average pressure or velocity will reduce the denser fluid influence on the lighter fluid which will obviously lead to great error e g when ρ a ρ b p ρ a p b ρ b p a ρ a ρ b p a detailed discussion can be found in chen et al 2015 in the reference grenier et al 2013 it showed the considerable discrepancy between the results of the arithmetic mean viscosity and the harmonic mean viscosity in two phase flow with large viscosity ratio e g when μ a μ b the viscosity based on the arithmetic mean is μ a b μ a μ b 2 μ b 2 and the viscosity based on the harmonic mean is μ a b 2μ a μ b μ a μ b 2μ a therefore the inter particle properties based on the harmonic mean are used in our two phase sph model 11 u 2 u l u r u l u r ρ i j c i j 2 ρ i c i ρ j c j ρ i c i ρ j c j p 2 p i p j p i p j ρ i j 2 ρ i ρ j ρ i ρ j after the riemann solver is obtained in eq 10 p i j and v i j are used to replace the term p i p j 2 and the term v i v j 2 in eq 8 respectively through this transformation the continuity and momentum equation in eq 8 can be written as 12 d ρ i d t 2 ρ i j v i v i j i w i j v j d v i d t 2 ρ i j p i j i w i j v j g where v i j u i j e i j v u e i j the harmonic mean continues to be adopted in the average velocity between particle i and j namely v i j 2 v i v j v i v j it is different from the literature rezavand et al 2019 if the model in eq 12 is used directly for simulating the two phase flow the numerical dissipation introduced by riemann solver will influence the real motion characteristics of the two phase flows the dissipation term is 1 2 ρ i j c u l u r for the sake of reducing the numerical dissipation zhang and hu 2017 applied a limiter to replace the inter particular sound speed and simulate single phase flows later rezavand et al 2019 used it to simulate the multi phase flows but when the fluid properties change such as viscosity the use of the limiter is restricted in order to reduce the riemann dissipation in eq 12 and simulate the fluid structure coupling problems in two phase flows with different viscosity ratios the intermediate pressure is improved in the present model and shown as 13 p i j p λ μ i j h u l u r u l u r 0 p u l u r 0 where λ 5 2 d 4 is the correction coefficient of viscous term which is similar to the coefficient proposed by monaghan and gingold 1983 according to the numerical examples and d is the dimension μ i j 2 μ i μ j μ i μ j is the inter particle dynamic viscosity and μ i is the dynamic viscosity of particle i substituting eq 13 in eq 12 the improved sph model based on riemann solver can be obtained 3 3 a switch function based riemann solver dissipation the water entry problems involve complicated flow phenomena namely overturning breaking and merging of free surface and vortex shedding the traditional grid based methods used in modeling these phenomenon have difficulties when the effect of the air is considered it is even more numerically difficult though the particle methods such as sph method can make up the above defects the numerical instability still remains to deal with this instability caused by complex interface deformation and the strong impact we propose to add a switch function based riemann solver dissipation into the intermediate pressure in eq 13 the new intermediate pressure can be written as 14 p i j p i j 1 2 η ρ i j u u l u r where η is the switch function if the dissipation term 1 2 ρ i j u u l u r in eq 14 is used throughout the whole two phase flow field the numerical instability induced by the impact can be solved while the excessive dissipation is introduced into the model the best way is to timely adjust the dissipation the effectiveness of this dissipation term would be opened in the strong impact domain and be closed in the weak shock parts the morris and monaghan 1997 introduced the switch function to adjust the artificial viscosity the parameter of artificial viscosity varied with time and location but it was not fully switched off at free position referring to the work of morris and monaghan 1997 and considering the consistency of riemann solver in our sph model we propose a new switch function based riemann solver dissipation for water entry problems in the two phase flow the switch function η is written as 15 η 1 ϕ χ 0 ϕ χ where ϕ p v as a color function can be interpreted as the pressure convection rate χ is the threshold parameter which is determined according to the impact strength of fsi problems the formula of χ ρgv max is used in this paper if not specially noted v max is the maximum particle velocity in the calculation finally combining with the improved sph model based on riemann solver and the switch function based riemann solver dissipation the new intermediate pressure in eq 14 is used to replace the pressure term in eq 12 and the novel two phase sph model based on an improved riemann solver can be obtained 3 4 algorithm for the fluid body interaction the dummy boundary is adopted adami et al 2012 in this paper the boundary particles are treated as the fluid particles participating in the calculation of n s governing equations for two phase fluid to compensate the lack of particles in the support domain of fluid particles near the boundary to prevent the fluid particles from penetrating the solid boundary the reference density of the boundary particles will be the initial density of heavier fluid the interaction between a fluid particle and a boundary particle is regarded as a one sided riemann problem and the direction is along the boundary normal direction n wang et al 2019 the initial states of the fluid particle i and the boundary particle j are written as 16 u i ρ l u l p l ρ i v i n p i 17 u j ρ r u r p r ρ j v j n p l ρ i a w g r i j where v j is the boundary velocity and a w is the boundary acceleration for the free slip condition we ignore the viscous interaction between the fluid and boundary and the intermediate pressure is p i j p for the no slip boundary the viscous force is not ignored in the momentum equation the intermediate pressure is obtained from the eq 13 and the right state velocity u r in eq 17 should be written as follows 18 u r v i n 2 v j n the final pressure of the boundary particles is obtained through the shepard interpolation from the neighboring fluid particles the pressure at each time step is calculated as 19 p w j f l u i d p r w i j j f l u i d w i j j f l u i d p l ρ j a w g r i j w i j j f l u i d w i j where w represents the boundary and f is the fluid p l is the pressure of fluid particles around the boundary particle the density of the boundary particle can be obtained by solving the equation of state eq 2 the free slip boundaries are implemented in the cases of this paper unless otherwise stated in the water entry problems the object is regarded as the moving boundary under the fluid inertia force and the gravity force the motion of the object has two types translation and rotation through the transformation of eq 6 the eq 4 can be expressed as 20 d v 0 d t 1 m w o b j e c t j f l u i d 2 m w ρ w p w j w w w j v j g d w 0 d t 1 i w o b j e c t j f l u i d r w r 0 2 m w ρ w j p w j w w w j v j where r 0 is the centre of the object s mass m the position of the object is updated by the velocity and the angular velocity of the object 21 d r 0 d t v 0 d θ d t w 0 where θ θ x θ y θ z denotes the angular vector of rotations at new time step which is the sum of the object rotation angle with respect to the initial position so based on the rotation formula of coordinate axis the position r wi velocity v wi and the acceleration a wi of each object particle can be written as leroy et al 2014 22 r w i r 0 t r w i 0 r 0 v w i v 0 θ r w i r 0 a w i d w d t r w i r 0 w w r w i r 0 where t is the transformation matrix note that the particle velocity v wi is not used to update the particle position the transformation matrix is given by 23 t cos θ e x 2 1 cos θ e x e y 1 cos θ e z sin θ e x e z 1 cos θ e y sin θ e x e y 1 cos θ e z sin θ cos θ e y 2 1 cos θ e y e z 1 cos θ e x sin θ e x e z 1 cos θ e y sin θ e y e z 1 cos θ e x sin θ cos θ e z 2 1 cos θ where e θ e x e y e z and θ are the unit vector and modulus of the angular vector θ respectively after adding this new technical means our model can simulate the multi degree motion of body in water entry problems in order to eliminate the non physical pressure reflection from the solid wall the sponge layer with a certain thickness is arranged inside the solid wall the sponge layer is initially introduced by gong et al 2009 which is applied to the fluid particles the forms are shown as 24 d ρ i d t s 1 100 0 9 50 ξ d ρ i d t 25 d v i d t s 1 100 0 9 50 ξ d v i d t where ξ l s l is the perpendicular distance from particle i to solid wall and s is the sponge layer thickness 3 5 time integration scheme to integrate the system of the governing equations of two phase fluid and object a velocity verlet scheme which is second order accurate and reversible is adopted adami et al 2012 to ensure the stability simulation the time step must satisfy the cfl conditions 26 δ t 0 25 min h c v max δ t 0 125 min ρ h 2 μ δ t 0 25 min h g where v max is the maximum particle velocity in the calculation the minimum value of the above conditions is the numerical time step 4 numerical examples in this section five cases of the fluid structure coupling problems are simulated to demonstrate the stability and accuracy of the present two phase sph model for two dimensional simulation firstly the two phase dam break is presented and the ability of our model to deal with the impact between fluids is tested by the switch function based riemann solver dissipation then the sinking of a rectangle body is simulated to verify the accuracy for predicting multi degree motion of sinking body in the viscous two phase flow then the water entry of a wedge flat plate slamming on water and water entry of a catamaran are simulated with the change of the structure shape the influence of air on fluid structure coupling problems becomes more and more apparent it can test the ability of the present two phase sph model to deal with the complicated water entry problems these cases we select have been studied by many researchers adopted by experiment and numerical simulation 4 1 the dam break the dam break case is a typical violent free surface flow which involves the phenomena of the flow impacting on the solid wall and overturning breaking and merging of free surface this case can validate the accuracy of the proposed two phase model in predicting impact load capturing two phase flow interface and keeping the numerical stability in two phase flow it was also modeled by the sph method gong et al 2016 chen et al 2015 adami et al 2012 rezavand et al 2019 and experimented in literature buchner 2002 although the air has no effect on the motion of the water which has been proved by colagrossi and landrini 2003 the two phase flow simulation of dam break can capture the formation and collapse of the closed air cavity which is an exact reproduction of the natural phenomena of dam break the initial setup of the two phase dam break is shown in fig 2 which is the same as the experiment in buchner 2002 the length of the dam break is l w 1 2 m and the height of the dam break is h w 0 6 m where g 9 81 m s2 the length of the computational domain is l t 5 366h w the height is h t 3h w and the solid wall is simulated with free slip condition at each wall the water column of dam break is surrounded by the air in the sph simulation the reference density of water is ρ 0w 1000 kg m3 and the viscosity is μ w 0 001 pa s and the reference density of air is ρ 0a 1 kg m3 and the viscosity is μ a 1 0 10 5 pa s the initial particle spacing δx 0 005 m is used to discrete the computational domain the artificial sound speed for water is c w 10 gh w 0 5 and the time step is 1 0 10 6s the physical time is nondimensionalized by the gravity and dam break height the background pressure is p 0 1000pa the initial pressure distribution of dam break is also plotted as fig 2 which is derived by greco 2001 and given in eq 27 the initial setup is to simulate the process of water released from a gate in the experiment 27 p w x y ρ 0 w g h w y 8 ρ 0 w g h w π 2 n 1 2 n 1 2 e 2 n 1 π x 2 h w cos 2 n 1 2 h w π y fig 3 presents the pressure field distribution for water and the velocity field distribution for air at six instants of dam break evolution it can predict the main flow characteristics of break dam evolution at t g h w 0 5 2 41 the water front reaches the right wall and impacts the vertical wall then the water climbs along the right wall and the backward plunging jet forms at t g h w 0 5 5 92 subsequently it shows that the air cavity region is enclosed under the action of gravity then the water jet forms at t g h w 0 5 6 15 the two phase interface is captured clearly and the stable pressure field in water is simulated in the process of dam break evolution to visualize the effect of the new switch function based riemann solver dissipation in such two phase flow we show the results of phase distribution of dam break in fig 4 without this strategy the instable phenomena of particle penetration particle clumping and unnatural void can be observed when the water water impact occurs with the strategy the interface between two phases is captured clearly and smoothly and the numerical calculation will continue steadily through the comparison the effectiveness of the switch function based riemann solver dissipation in suppressing the numerical instability is validated in fig 5 for convergence study we show the time histories of surge wave front of dam break with four different particle resolution namely δx 0 04 m δx 0 02 m δx 0 01 m and δx 0 005 m the results from present model are compared with the experimental data buchner 2002 and an analytical solution ritter 1982 from the fig 5 we can see that the speed of front wave is slower in the experiment than that in the present simulation the main reasons for these differences are attributed to the uncertain factors existing in experiment which include measuring accuracy of the experiment the roughness of the water tank and so on the free slip condition is used in the present simulation after t g h w 0 5 1 7 the present results agree well with the results of shallow water theory ritter 1982 it can also be seen that the results from the present are convergence with the increasing particle spacing fig 6 shows the time histories of a pressure probe located at 0 19h w from the bottom of the right wall at t g h w 0 5 2 41 the surge wave front impacts the right wall in the fig 3 the pressure at the probe suddenly reaches the first peak then the water moves along the rigid wall and the pressure remains roughly invariant at t g h w 0 5 6 15 the air cavity closes the pressure reaches the maximum and a water jet is formed later due to the closed air cavity the pressure curve oscillates compared with the experiment second pressure peak of the present results is slightly larger and the occurrence time is later than the experiment it is also necessary to see that the present results in general agree well with the experimental results and the present two phase sph model is reliable in predicting the impact loads for the study of the energy conservation of the present two phase sph model the time histories of the total energy variation are shown in fig 7 the total energy variation δe is calculated by the method of the literature cao et al 2018 by contrasting the results of the present model without the switch function based riemann solver dissipation and the literature cao et al 2018 it can be observed that the curves of the energy loss show two significant turning point at the time of the water wall impact and the water water impact for the same resolution δx 0 005 the present two phase sph model produces a better conservation than the model in literature cao et al 2018 without the switch function based riemann solver dissipation it produces a best conservation while the simulation may not continue due to the numerical instability caused by strong impact it is shown in fig 4 a 4 2 sinking of a rectangle body to further validate the effectiveness of the new two phase sph method in predicting the translation and rotation of rigid the sinking of a rectangle body with the asymmetric distribution of mass in the two phase flow is simulated the setup is the same as that of finite volume particle method fvpm in barcaolo 2013 early sun et al 2015 used this case to validate their single fluid sph model against the fvpm results barcaolo 2013 the initial configuration of the system is shown in fig 8 the rectangle body has the length of l 1 0 m and the height of h 0 5l which is placed in a 4l 5l container the depth of water is h w 3l the mass center of the rectangle body is g 2 25l 3l the mass is m 1 0 kg m the mass of unit thickness is 1 0 kg in 2d numerical model and the inertia moment is i 0 083 kg m2 the container contains two phases the density of the heavier phase is set to ρ w 1 kg m3 and the kinematic viscosity is υ 2 10 3 m2 s and the density of the other phase is ρ a 1 10 3kg m3 and the kinematic viscosity is υ 1 10 3 m2 s the case is simulated in two dimensional space and the rectangle body freely sinks into the heavier phase under the gravity in which the rectangle body has three degrees motion the initial particle spacing is δx 0 01 m the time step is δt 5 10 6s the background pressure is p 0 1pa and the numerical sound speed of the heavier phase is c 0 10 3gh 0 5 the free slip boundary conditions are applied in the rectangle body and solid wall and the sponge layer is not used in this case to reveal the flow field structure of the sinking process of rectangle body the pressure field distribution for water and the velocity field distribution for air at eight instants are shown in fig 9 under the gravity and buoyancy the rectangle body with the asymmetric distribution of mass starts to sink and do rotational motion at t 0 75s the heavier phase slams the side wall of the rectangle body and the lighter phase cavity forms at t 1 91s the slamming load stops the further rotation of the body then the lighter phase in the cavity is seen escaping from the upper right corner of the body and a lighter phase cavity above the body forms at t 2 65s with the continuous sinking the lighter phase continuously escapes from the upper of the body finally the body continues to sink almost without rotational motions t 3 68s there is no pressure noise and two phase flow interface is smooth and clear in the sinking process in fig 10 the time histories of the horizontal displacement and the vertical displacement of the rectangle body are presented together with the results of finite volume particle fvpm without lighter phase from barcaolo 2013 four examples with different particle spacing δx 0 04 m δx 0 02 m δx 0 01 m and δx 0 005 m are simulated as the resolution increases from δx 0 04 m to δx 0 005 m the results of the horizontal displacement curve and the vertical displacement curve are convergent and in good coincidence with the fvpm results comparing the results of two methods in the horizontal displacement it can be found that the lighter phase has little effect on the horizontal motion of the rectangle body due to the influence of enclosed cavity of lighter phase and the present two phase flow sph model can well simulate such fluid structure coupling problems and can be a new technical means for the study on multi degree motion of body in two phase flow 4 3 water entry of a wedge water entry problems are very significant in ocean engineering fields in this section the proposed two phase sph model is used to simulate the wedge entry into the water the experiment of which is conducted by zhao et al 1996 this case not only validates the accuracy of the numerical calculation model in predicting the fluid force subjected on the structure and the motion characteristics of the structure but also tests the model s ability in capturing the flow characteristics of the lighter phase and in suppressing instability due to the strong impact in water entry problems as shown in fig 11 the total mass of the free falling wedge with d 0 5 m width and 1 0 m length is 241 kg in the experiment the mass of unit thickness is 241 kg in 2d numerical model the deadrise angle of the wedge is 30 and the entry water velocity is 6 15 m s the numerical water tank is b 7d wide and h 3d deep in order to improve the computational accuracy and capture the detailed flowing behaviors the particle spacing δx 0 005 m is used about 0 65 million particles are used in the numerical study and the time step is δt 2 10 6s the density and viscosity of the water are ρ w 1000 kg m3 and μ w 0 001 pa s and that of air are taken as ρ a 1 kg m3 and μ a 1 0 10 5 pa s respectively the background pressure is 1500pa besides the sponge layer is adopted in the solid boundary wall of the water tank to reduce the effect of pressure reflection on the flow field pressure and impact load on wedge fig 12 presents the snapshots of the wedge entry process in order to better observe the stability of the present model in simulating multiphase flows each snapshot presents the pressure field of water and the velocity field of air it can be seen that the velocity field of air keeps smooth and stable in the free falling process of wedge and air vortex field appears in the rear of wedge due to the pressure reducing when the wedge is approaching the water surface the air between wedge and water is seen escaping at high velocity at t 0 63s the wedge reaches the water which brings high pressure region in the water soon the water jet forms at t 0 64s to further demonstrate the stability of our sph model in long time numerical simulation of water entry problems it is simulated that the wedge further moves down after slamming water surface it can be observed that the air vortex generates outside the splashing jets at t 0 9s a clear interface between water air and solid wall and a stable pressure field are observed during the whole process of wedge entry in order to further illuminate the effect of the new switch function based riemann solver dissipation on such strong impact problems fig 13 shows the snapshots of wedge entry at t 0 67s adding this treatment technology or not without this treatment technology the unstable interface particle clumping and unnatural void regions can be observed as shown in fig 13 a the time histories of the fluid force acting on the wedge and the falling velocity are shown in the fig 14 comparing with the experimental data of zhao et al 1996 a good agreement can be observed minor deviations in the falling velocity can be seen the falling velocity of the present sph results goes down more quickly than the experiment which is likely due to the three dimensional effect in experiment it is also noted that there is almost no difference in the contact force and falling velocity between sph results with air and no air the effect of the air on the water entry of wedge can be ignored the present two phase sph model can predict the impacting loads and motion characteristics of structure very well in simulating such fluid structure coupling problems in order to study the convergence of the present method in water entry problems two cases of water entry of a wedge are carried out δx 0 01 m and δx 0 02 m fig 15 shows the comparisons of the simulation results the present method achieves convergence with increasing particle resolution 4 4 flat plate slamming on water in the present section the influence of the air on water entry of the flat plate is investigated past research lind et al 2015 has demonstrated that the air has little effect on low speed water entry problems in the water entry early stages especially the structures with the deep dead rise angle for the water entry plate with a low dead rise angle the air trapped underneath has a major effect on the structure subjected to water impact load the plate we simulate is the same as that in the experimental study is carried out by ma et al 2016 in the experiment the mass of plate is 32 kg the size is 0 25 m 0 25 m and the impact velocity of the free falling plate is 5 5 m s the width of water entry plate is 0 25 m in 2d simulation by our present two phase sph model in order to reduce the large amount of computation the initial distance from the free falling plate to water surface is 0 6 m and the initial velocity is 4 3 m s this treatment has no effect on the impact phenomenon the sketch of the simulation is shown in fig 16 the computational domain is 1 2 m 1 5 m and the water depth is h 0 8 m the physical properties of water and air are the same as the section 4 3 the particle spacing is δx 0 002 m the numerical sound speed of water is c w 60 m s the background pressure is p 0 2000pa and the time step is 1 5 10 5s to investigate the dynamics characteristic of the two phase flow in the water entry plate the fig 17 shows several snapshots of the computed process about water pressure field and air velocity field before t 0 12s the falling plate has no influence on the water surface the air velocity behind plate increases as the plate moves down air vortex zones forms at the both sides of plate where the velocity is much less than neighboring region at t 0 12s the plate does not touch the water surface the air between the plate and water is seen escaping quickly from the both sides of plate and the air is compressed and high pressure zone occurs in the water when t 0 13s the plate slams the water surface and water pressure increases dramatically there is still a small amount of air that could not have time to escape and is entrapped beneath the plate at t 0 132s the high pressure region of water enlarges and water jets form because of plate slamming on water at t 0 14s the high pressure region propagates far away and the jets continue to develop due to the sponge layer implemented inside the solid wall non physical pressure reflection phenomenon could not be seen considering the air effect fig 18 shows the time histories of the contact force on the plate from the present single phase sph model two phase sph model and experiment during the water entry process the time t 0 is the time of contact force peak it can be seen that the force peak and the changing gradient of the contact force curve in present single phase model are much larger than the others the main reason is that air is not considered in the single phase model and air cushion effect that can reduce slamming load cannot be shown in the respect of force peak the changing gradient of contact force and the duration of impact the two phase sph results are in general agreement with the experimental data ma et al 2016 and the minor deviation of the contact force peak can be seen due to the influence of three dimensional effect it also illustrates that the air can cushion the impact load of structure with a low dead rise angle in the water entry process 4 5 water entry of a catamaran one of the most challenging water entry problems in the two phase flow is the water entry of a catamaran which involves many dynamic problems such as the two phase flow coupling with the complex structure the complex air flow the distribution of flow field structure the impact loads the dynamic response of the structure and so on in this section the water entry catamaran with a 25 dead rise angle is simulated when the catamaran impacts the water the air beneath the catamaran cannot escape easily in our 2d simulation but the air can escape from the fore and aft of the 3d model in the whelan 2004 experiment the cabin effect will be more obvious when the catamaran touches the water surface the 2d catamaran model is shown in fig 19 in the fig 19 b the air model 1 is the same as that used by shahraki et al 2011 the width of this mode is 0 56 m the height of side wall is 0 19 m depth of the inward valley is 0 13 m the dead rise angle of the intermediate wedge is 25 and the mass is 72 25 kg m the mass of unit thickness is 72 25 kg in 2d numerical model for the study of the effect of air beneath the catamaran the air model 2 with short side wall in fig 19 c is added and simulated in addition to the height of side wall other parameters are the same as the air model 1 the computational domain is 1 8 m 1 8 m and the depth of water is 1 m which is the same as the experiment conducted by whelan 2004 in order to study the influence of air on the water entry catamaran the impact velocity of the catamaran in all models is 1 03 m s for the air model the initial velocity and initial distance between the intermediate wedge bottom and water surface are 0 85 m s and 0 082 m respectively the values of the no air model are 0 97 m s and 0 03 m the same as that in yan et al 2015 we adopt the present sph model to simulate this water entry problem the initial particle spacing is 0 003 m the time step is 1 0 10 5s the sound speed of water is 15 m s and the background pressure is 1000 pa the time evolutions of the catamaran acceleration are shown in fig 20 where the results of no air and air sph models are compared to the experiment data whelan 2004 it is clear that the results of the present sph solution without air have two peaks the first peak at t 61 5 ms is due to the impact on the intermediate wedge the second peak at t 88 5 is due to the water impact on the corner of the center wedge meeting the side panels the snapshots are shown in fig 21 however the sph acceleration of two peaks is higher than the acceleration recorded in the experiment and the experimental time histories are much smoother and gentler it can be concluded that the air cushion effects cannot be ignored in the simulation of a water entry catamaran as in the air model 1 large differences appear for the time histories of acceleration and the peak time relative to the experimental measurements the reason for these discrepancies is that the experiment builds the three degree model of water entry catamaran the air beneath the catamaran could escape easily from the fore and aft of the 3d model however in the air model 1 most air is trapped under the catamaran and cannot escape away at the peak time t 62 5 ms the snapshot is reported in fig 22 the center wedge does not touch the water surface due to the entrapped air and the acceleration peak occurs earlier than that in the experiment the same conclusion can be seen in yan et al 2015 the smooth and uniform pressure field across the interface can be observed in fig 22 a in order to reduce the excessive influence of the air cushion effects in 2d numerical model the air model 2 with shorter side wall is simulated at t 82 5 ms the snapshot of the peak acceleration of air model 2 is shown in fig 23 it can be seen that there is only a small amount of air trapped in the catamaran from fig 20 it is possible to observe that the changing gradient and peak time of the acceleration time histories are much closer to the experimental data than that in the air model 1 to further study the dynamic response of catamaran entry the time histories of the pressure at p4 are shown in fig 24 the location of point p4 is shown in fig 19 the results are compared with the experimental data whelan 2004 by comparing the fig 20 and the fig 24 it is possible to observe that the p4 pressure peak and the acceleration peak appear almost at the same time in our 2d model in the experiment the air can escape from the fore and aft of the 3d catamaran model and the peak pressure is caused by the direct impact of water which is similar to the no air model the results of the experiment show that the pressure increases slowly in early stage due to the influence of the air cushion effect and a sharp rise with an inflexion is on the pressure curve and a maximum value occurs although the pressure time curve of our no air model agrees well with the experimental results whelan 2004 it can be seen from the impact time that the cushioning effect of air cannot be reproduced by the no air model in the air model 1 and 2 the air beneath the catamaran cannot escape in time and is trapped under the catamaran and a smooth and gentle rise is on the pressure curve the p4 peak pressure is not caused by the direct impact of water but by the trapped air which occurs earlier than those in the no air model and experiment comparison between the results of air model 1 and 2 reducing the height of side wall can decrease the influence of air cushion effect of 2d model and delay the appearance of the peak pressure and the results of 2d air model 2 are closer to the 3d experimental data than the air model 1 through the numerical simulation of the water entry of a 2d catamaran it is proved that the present two phase sph model is suitable for the study of fluid structure coupling problems considering air cushion effect in engineering applications because of the limit of computational scale this paper only analyzed the 2d model of water entry catamaran by extending the 2d two phase sph model presented in this paper to 3d the whole dynamic process of catamaran entry can be reproduced 5 conclusion in the fluid structure coupling problems the effect of the air on the dynamic response of the water entry rigid structure is significant in this paper a new two phase sph model based on an improved riemann solver is presented for simulating the water entry problems of the two phase flow with large density ratios coupling with the structure four improved measures are made in this paper an intermediate pressure of a riemann form is developed and implemented in the discretized momentum equation and this term can decrease the riemann dissipation and simulate the two phase flows with different viscosity ratios the inter particle properties based on the harmonic mean are adopted to weaken the influence of the interfacial instability and increase precision of numerical computation considering the free slip or no slip condition at the wall one sided riemann problem is used to impose the fluid body interaction in two phase flow which could guarantee the stability of the intersection region between the solid wall and the two phase flow interface a switch function based riemann solver dissipation is introduced in the momentum equation such strategy could improve the instability of interface owing to the strong impact five fluid structure coupling examples are simulated by this new two phase sph model through rigorous comparisons with the existing numerical results and experimental data it is demonstrated that the present model can give accurate dynamic response solutions of structure and stable two phase flow field distribution it is also found that the effect of air on the water entry structure with a deep dead rise angle is great and the cushion effect can reduce the impact loads and protect the water entry structure from failure further work will be dedicated to studying the air cushion effect on the high speed impact problems by the two phase sph model described in this paper credit authorship contribution statement qiuzu yang investigation data curation writing original draft visualization fei xu formal analysis resources supervision funding acquisition yang yang software writing review editing jingyu wang methodology visualization investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national natural science foundation of china grant no 11972309 the national natural science foundation for young scientists of china grant no 11702220 the fundamental research funds for the central universities grant no 310201901a012 and overseas expertise introduction project for discipline innovation the 111 project grant no bp0719007 
22058,there are challenges in simulating two phase flows with large density ratios using traditional sph taking full advantages of riemann solver in dealing with contact discontinuity problems and combining two phase flow sph method with riemann solver a new model of two phase flow coupling with structure based on an improved riemann solver is described for the water entry problems with the effect of air the flow momentum equation of the riemann form is improved to decrease the riemann dissipation and simulate the two phase flows with different viscosity ratios one sided riemann problem considering the free slip and no slip conditions at a wall is used to deal with the fluid body interaction a switch function based riemann solver dissipation is used to improve the instability of interface owing to the strong impact in order to test the accuracy of the model in fluid structure coupling problems five cases including dam break sinking of a rectangle body water entry of a wedge flat plate slamming on water and water entry of a catamaran are numerically simulated the agreements between the present results and other reference results demonstrate that the proposed method is robust and stable to simulate the water entry problems with the air graphical abstract image 10238 keywords two phase flows fluid structure coupling sph smoothed particle hydrodynamics riemann solver water entry 1 introduction in the ocean engineering field fluid structure coupling problems such as diving of sportsman ship slamming waves slapping and landing of aircraft on water are important subject matter the accurate prediction of the structure dynamics response can provide guide and reference for engineering design e g the ship design in naval architecture and ocean engineering the structure entering water is a typical fluid structure coupling problem which involves complex hydrodynamics and kinetics problems wang et al 2015 when the structure enters the water due to the strong impact structure will produce rolling pitching and vertical movement which causes internal device malfunction or even local damage of structure and the water surface will produce splashing breaking and rolling phenomena therefore it is worthy to make further studies numerical study of water entry problems using the traditional eulerian grid based numerical methods have been challenging considering the influence of the air on the water entry structure the difficulties will increase to capture the large free interface deformation and track the moving objects special algorithms need to be added which will complicate the algorithms lin 2007 wick 2011 mesh free numerical methods such as smoothed particle hydrodynamics sph monaghan 1985 and moving particle semi implicit mps koshizuka and oka 1996 can overcome above difficulties and have the advantage of modeling the water entry problems oger et al 2006 was the first to apply the weakly compressible sph wsph to simulate the water entry problems and a technic was introduced to evaluate fluid pressure on solid boundaries then maruzewski et al 2010 further developed the sph method for the water entry problems afterwards skillen et al 2013 adopted incompressible sph isph to simulate the water entry of the wedge and cylinder sun et al 2018 studied 2d and 3d water entry cylinder using the developed δ sph in which the adaptive particle refinement apr was applied to reduce the computational cost to accurately predict the high and localized impact pressure marrone et al 2018 used a riemann ale smoothed particle hydrodynamics model to simulate the high speed water entry of plates in recent literature liu and zhang 2019 reviewed applications of the sph method in various water entry problems however above simulations of water entry problems generally are limited in the scope of a single phase flow coupling with structure none of these works investigate the effect of air due to the discontinuity of property across the interface the simulation of two phase flow problems is difficult with the traditional particle methods especially in the multi phase flow problems with large density ratios in view of this many scholars have conducted studies on the simulation of the multi phase flow and multi phase flow coupling with structure by particle methods monaghan and kocharyan 1995 were the first to put forward the concept of multi phase sph model for the simulation of two phase flows with small density ratios subsequently to steady the interface of multi phase flows with large density ratios colagrossi and landrini 2003 hu and adams 2006 2007 and grenier et al 2009 2013 presented various modifications including density reinitialization artificial viscosity cohesive force xsph technique and so on khayyer and gotoh 2013 combined an extended version of sph density smoothening scheme with mps method to enhance the numerical stability of multi phase flows with high density ratios later khayyer et al 2019 improved previously schemes and proposed a novel projection based particle method for simulation of multi phase flows which was called the improved mps ops optimized particle shifting for the studies of multi phase flow coupling with structure in lind et al 2015 it proved that the air cushion had an important effect on the slamming load subjected to entry structure with a low dead rise angle like plate yan et al 2015 studied the water entry catamaran hull where the air was trapped beneath the hull and the effect of air was pronounced again khayyer and gotoh 2016 proposed to adopt a modified error compensating source term of poisson pressure equations in the framework of multi phase mps to model water entry of a rigid plate and the air cushioning effect was validated based on riemann ale smoothed particle hydrodynamics model marrone et al 2017 considered the influence of air cushioning to study the water entry of the 3d complex geometries in the above simulation of the two phase flow coupling with structure problems pressure oscillation is always a tricky problem to deal with in order to reduce pressure oscillation of multi phase flow field produced by the impacting of water entry most researches introduced the artificial viscosity term proposed by monaghan 1994 into the momentum equation but the artificial viscosity is not the real viscosity of fluid which easily affects the real motion characteristics of the fluid and energy conservation by reconstructing the sph convolution integrals a godunov sph gsph algorithm with no artificial viscosity was proposed by inutsuka 1994 where the riemann problem was applied to construct an imaginary interface between two particles later various kinds of godunov sph schemes had been proposed in the literature cha and whitworth 2003 sirotkin and yoh 2013 puri and ramachandan 2014 yang et al 2020 puri and ramachandan 2014 established the equivalence of the dissipative terms in gsph to the signal based artificial viscosity in sph and pointed that the gsph dissipation helped to prevent particle penetration in some cases such as subsonic and supersonic flow collision tests cha and whitworth 2003 teschner et al 2019 utilized the numerical dissipation introduced by the riemann solver to preserve pressure stability of steady state flows taking full advantages of riemann solver in dealing with contact discontinuity problems rezavand et al 2019 proposed a multi phase sph method to simulate highly violent flows problems on the base of the zhang and hu 2017 study but this multi phase sph model cannot simulate the two phase flow problems with various viscosity ratios and has limitations in application therefore this paper develops a set of novel gas liquid two phase sph model based on riemann solver which can simulate the problems of the viscous two phase flow coupling with structure in the present work the momentum equation of the riemann form is improved to make up for the defects of rezavand et al 2019 model and reduce the riemann dissipation for the sake of establishing a consistent sph model based on riemann solver one sided riemann problem proposed by zhang and hu 2017 is expanded and used to impose the interaction between two phase flow and structure which is different from the previous literature zhang and hu 2017 and can deal with both the no slip boundary and free slip boundary and a switch function based riemann solver dissipation as a new lower numerical diffusion term is used to improve the instability of flow field where the strong impact occurs this imposed dissipation is different from that of the global application of the artificial diffusion used in the previous studies yan et al 2015 cao et al 2018 this paper is organized as follows in section 2 governing equations of two phase flow and the motion equations of moving object are presented the detailed derivations of the proposed two phase sph model based on an improved riemann solver are reported in section 3 including some strategies to ensure the stability and accuracy in section 4 five representative cases including dam break sinking of a rectangle body water entry of a wedge flat plate slamming on water and water entry of a catamaran are numerically simulated by the present two phase sph model several conclusions are drawn in section 5 2 fluid structure interact formulation the governing equations of the two phase fluid and the motion equations of structure are introduced first the following sph formulations are descripted and the two phase sph model based on an improved riemann solver for simulating fluid structure problems is presented in the section 3 2 1 governing equations for two phase fluid in the present work the mass and momentum conservation equations of two phase fluid based on the compressible navier stokes equations are 1 d ρ d t ρ v d v d t 1 ρ p g where ρ v p and g refer to the density the velocity the pressure and gravitational acceleration respectively in order to fulfill the incompressible limit the two phase fluid is assumed to be weakly compressible monaghan and gingold 1983 morris et al 1997 the eq 1 is non closed the tait equation of state is used to solve the two phase fluid evolution moreover the form of the tait equation of state is applied 2 p ρ 0 c 2 γ ρ ρ 0 γ 1 p 0 where ρ 0 is the reference density for water the initial density is ρ w0 1000 kg m3 while for air the initial density is ρ a0 1 29 kg m3 for the heavier phase γ 7 is used and γ 1 4 is used in the lighter phase as suggested in literature zhang et al 2015 colagrossi and landrini 2003 p 0 is the background pressure which can keep the particle uniform distribution and prevent the tension instability induced by negative pressure the background pressure is only used in two phase flow problems and its value should be carefully chosen gong et al 2016 to ensure the initial pressure is smooth at the interface the different phases would have the same coefficient ρ 0 c 2 γ c 0 is the artificial sound speed which is chosen to keep the variation of density within 1 so the sound speed c 0w of the heavier phase meets conditions as follows marrone et al 2017 3 c 0 w 10 max v max p max ρ 0 where v max and p max are the maximum expected velocity and pressure respectively and the sound speed c 0h of the lighter phase is c 0h ρ 0w c 0w 2 γ h ρ 0h γ w 0 5 2 2 the motion equations for moving object we consider the rotation of the object during the motion based on the newton s law of motion the motion equations of the object s center of mass can be written as follows 4 d v 0 d t f m g d w 0 d t j i where v 0 and w 0 denote the velocity and the angular velocity of the object s center of mass respectively f m j and i are the summation of forces without gravity the mass of the object the total moment of force on the object about the center of mass and the moment of inertia respectively the velocity of a point i on the object is 5 v i v 0 w 0 r i o where r io is the vector r io r i r o 3 the present two phase sph model 3 1 basic sph smoothed particle hydrodynamics sph is a lagrangian meshless method in which the continuous matter field is discretized into particles possessing physical properties such as density velocity acceleration pressure and viscosity liu and liu 2003 the governing equations of two phase fluid and moving object will be solved by sph method an arbitrary field function f r i and its derivative f r i at particle i position can be approximated by kernel interpolation in its supported domain as monaghan 1985 6 f r i ω f r w r i r h d r j m j ρ j f r j w r i r j h f r i ω f r i w r i r h d r j m j ρ j f r j i w r i r j h j m j ρ j f r i f r j i w r i r j h where ω is the support domain of the smooth function the subscript j represents the j th particle within the supported domain of the particle i m j and ρ j are the mass and density of particle j respectively h refers to the smoothing length of the area affected by the kernel function which is chosen to be 1 25δx and δx is the initial particle spacing w r i r j h and i w r i r j h are the kernel function and its gradient with respect to the particle i respectively in this paper the kernel function proposed by wendland 1995 is applied 7 w r i r j h α 2 q 4 2 q 1 0 q 2 0 q 2 where q r i r j h one dimensional problems α 3 64h two dimensional problems α 7 64h 2 three dimensional problems α 21 256h 3 through the transformation of sph method in eq 6 governing equations for two phase fluid in eq 1 can be expressed as 8 d ρ i d t ρ i j m j ρ j v i v j i w i j r i r j h 2 ρ i j m j ρ j v i v i j i w i j r i r j h d v i d t 1 ρ i j m j ρ j p i p j i w i j r i r j h g 2 ρ i j m j ρ j p i j i w i j r i r j h g where v i j v i v j 2 and p i j p i p j 2 are the average velocity and pressure of particle i and particle j respectively 3 2 the improved sph model based on riemann solver the new sph model unlike the conventional sph method describing the interaction between particles only by the weighting summation of the neighboring particles in the support domain is based on riemann solver where each pair of particles is regarded as a riemann problem this riemann problem is constructed along the vector e ij r i r j r i r j and this interaction point is located at the midway point between particle i and particle j puri and ramachandan 2014 zhang and hu 2017 as shown in fig 1 a the left and right states of a constructed inter particle riemann problem are shown as 9 ρ l u l p l ρ i v i e i j p i ρ r u r p r ρ j v j e i j p j the contact discontinuity of riemann problem is located at r r i r j 2 the first order riemann solver is used to approximate the riemann problem four states are divided by three waves as shown in fig 1 b assume that the intermediate states on both sides of the middle wave are equivalent similarly to zhang and hu 2017 a linearized riemann solver is used to approximate the intermediate states 10 u l u r u i j u 1 2 p l p r ρ i j c i j p l p r p i j p 1 2 ρ i j c u l u r where u ρ c and p are the inter particle velocity density sound speed and pressure respectively c is the inter particular sound speed which is related to the riemann dissipation in sph model see more in puri and ramachandan 2014 in the two phase flows the abrupt discontinuities of density and viscosity across the interface contribute to the numerical instability especially in the water entry problems with the effect of air at the moment of impact the pressure of two phase flow suddenly increases near the slamming area water splash and the large interface deformation can be observed so the reasonable way to assume values of the inter particle physical quantity such as velocity density sound speed and pressure has a crucial influence on the stability and precision of numerical simulation rezavand et al 2019 adopted the density weighted inter particle velocity and pressure to represent the inter particle velocity and pressure respectively these formulas are reasonable for two phase flows with small density ratios however for the two phase flows with large density ratios the introduction of the density weighted average pressure or velocity will reduce the denser fluid influence on the lighter fluid which will obviously lead to great error e g when ρ a ρ b p ρ a p b ρ b p a ρ a ρ b p a detailed discussion can be found in chen et al 2015 in the reference grenier et al 2013 it showed the considerable discrepancy between the results of the arithmetic mean viscosity and the harmonic mean viscosity in two phase flow with large viscosity ratio e g when μ a μ b the viscosity based on the arithmetic mean is μ a b μ a μ b 2 μ b 2 and the viscosity based on the harmonic mean is μ a b 2μ a μ b μ a μ b 2μ a therefore the inter particle properties based on the harmonic mean are used in our two phase sph model 11 u 2 u l u r u l u r ρ i j c i j 2 ρ i c i ρ j c j ρ i c i ρ j c j p 2 p i p j p i p j ρ i j 2 ρ i ρ j ρ i ρ j after the riemann solver is obtained in eq 10 p i j and v i j are used to replace the term p i p j 2 and the term v i v j 2 in eq 8 respectively through this transformation the continuity and momentum equation in eq 8 can be written as 12 d ρ i d t 2 ρ i j v i v i j i w i j v j d v i d t 2 ρ i j p i j i w i j v j g where v i j u i j e i j v u e i j the harmonic mean continues to be adopted in the average velocity between particle i and j namely v i j 2 v i v j v i v j it is different from the literature rezavand et al 2019 if the model in eq 12 is used directly for simulating the two phase flow the numerical dissipation introduced by riemann solver will influence the real motion characteristics of the two phase flows the dissipation term is 1 2 ρ i j c u l u r for the sake of reducing the numerical dissipation zhang and hu 2017 applied a limiter to replace the inter particular sound speed and simulate single phase flows later rezavand et al 2019 used it to simulate the multi phase flows but when the fluid properties change such as viscosity the use of the limiter is restricted in order to reduce the riemann dissipation in eq 12 and simulate the fluid structure coupling problems in two phase flows with different viscosity ratios the intermediate pressure is improved in the present model and shown as 13 p i j p λ μ i j h u l u r u l u r 0 p u l u r 0 where λ 5 2 d 4 is the correction coefficient of viscous term which is similar to the coefficient proposed by monaghan and gingold 1983 according to the numerical examples and d is the dimension μ i j 2 μ i μ j μ i μ j is the inter particle dynamic viscosity and μ i is the dynamic viscosity of particle i substituting eq 13 in eq 12 the improved sph model based on riemann solver can be obtained 3 3 a switch function based riemann solver dissipation the water entry problems involve complicated flow phenomena namely overturning breaking and merging of free surface and vortex shedding the traditional grid based methods used in modeling these phenomenon have difficulties when the effect of the air is considered it is even more numerically difficult though the particle methods such as sph method can make up the above defects the numerical instability still remains to deal with this instability caused by complex interface deformation and the strong impact we propose to add a switch function based riemann solver dissipation into the intermediate pressure in eq 13 the new intermediate pressure can be written as 14 p i j p i j 1 2 η ρ i j u u l u r where η is the switch function if the dissipation term 1 2 ρ i j u u l u r in eq 14 is used throughout the whole two phase flow field the numerical instability induced by the impact can be solved while the excessive dissipation is introduced into the model the best way is to timely adjust the dissipation the effectiveness of this dissipation term would be opened in the strong impact domain and be closed in the weak shock parts the morris and monaghan 1997 introduced the switch function to adjust the artificial viscosity the parameter of artificial viscosity varied with time and location but it was not fully switched off at free position referring to the work of morris and monaghan 1997 and considering the consistency of riemann solver in our sph model we propose a new switch function based riemann solver dissipation for water entry problems in the two phase flow the switch function η is written as 15 η 1 ϕ χ 0 ϕ χ where ϕ p v as a color function can be interpreted as the pressure convection rate χ is the threshold parameter which is determined according to the impact strength of fsi problems the formula of χ ρgv max is used in this paper if not specially noted v max is the maximum particle velocity in the calculation finally combining with the improved sph model based on riemann solver and the switch function based riemann solver dissipation the new intermediate pressure in eq 14 is used to replace the pressure term in eq 12 and the novel two phase sph model based on an improved riemann solver can be obtained 3 4 algorithm for the fluid body interaction the dummy boundary is adopted adami et al 2012 in this paper the boundary particles are treated as the fluid particles participating in the calculation of n s governing equations for two phase fluid to compensate the lack of particles in the support domain of fluid particles near the boundary to prevent the fluid particles from penetrating the solid boundary the reference density of the boundary particles will be the initial density of heavier fluid the interaction between a fluid particle and a boundary particle is regarded as a one sided riemann problem and the direction is along the boundary normal direction n wang et al 2019 the initial states of the fluid particle i and the boundary particle j are written as 16 u i ρ l u l p l ρ i v i n p i 17 u j ρ r u r p r ρ j v j n p l ρ i a w g r i j where v j is the boundary velocity and a w is the boundary acceleration for the free slip condition we ignore the viscous interaction between the fluid and boundary and the intermediate pressure is p i j p for the no slip boundary the viscous force is not ignored in the momentum equation the intermediate pressure is obtained from the eq 13 and the right state velocity u r in eq 17 should be written as follows 18 u r v i n 2 v j n the final pressure of the boundary particles is obtained through the shepard interpolation from the neighboring fluid particles the pressure at each time step is calculated as 19 p w j f l u i d p r w i j j f l u i d w i j j f l u i d p l ρ j a w g r i j w i j j f l u i d w i j where w represents the boundary and f is the fluid p l is the pressure of fluid particles around the boundary particle the density of the boundary particle can be obtained by solving the equation of state eq 2 the free slip boundaries are implemented in the cases of this paper unless otherwise stated in the water entry problems the object is regarded as the moving boundary under the fluid inertia force and the gravity force the motion of the object has two types translation and rotation through the transformation of eq 6 the eq 4 can be expressed as 20 d v 0 d t 1 m w o b j e c t j f l u i d 2 m w ρ w p w j w w w j v j g d w 0 d t 1 i w o b j e c t j f l u i d r w r 0 2 m w ρ w j p w j w w w j v j where r 0 is the centre of the object s mass m the position of the object is updated by the velocity and the angular velocity of the object 21 d r 0 d t v 0 d θ d t w 0 where θ θ x θ y θ z denotes the angular vector of rotations at new time step which is the sum of the object rotation angle with respect to the initial position so based on the rotation formula of coordinate axis the position r wi velocity v wi and the acceleration a wi of each object particle can be written as leroy et al 2014 22 r w i r 0 t r w i 0 r 0 v w i v 0 θ r w i r 0 a w i d w d t r w i r 0 w w r w i r 0 where t is the transformation matrix note that the particle velocity v wi is not used to update the particle position the transformation matrix is given by 23 t cos θ e x 2 1 cos θ e x e y 1 cos θ e z sin θ e x e z 1 cos θ e y sin θ e x e y 1 cos θ e z sin θ cos θ e y 2 1 cos θ e y e z 1 cos θ e x sin θ e x e z 1 cos θ e y sin θ e y e z 1 cos θ e x sin θ cos θ e z 2 1 cos θ where e θ e x e y e z and θ are the unit vector and modulus of the angular vector θ respectively after adding this new technical means our model can simulate the multi degree motion of body in water entry problems in order to eliminate the non physical pressure reflection from the solid wall the sponge layer with a certain thickness is arranged inside the solid wall the sponge layer is initially introduced by gong et al 2009 which is applied to the fluid particles the forms are shown as 24 d ρ i d t s 1 100 0 9 50 ξ d ρ i d t 25 d v i d t s 1 100 0 9 50 ξ d v i d t where ξ l s l is the perpendicular distance from particle i to solid wall and s is the sponge layer thickness 3 5 time integration scheme to integrate the system of the governing equations of two phase fluid and object a velocity verlet scheme which is second order accurate and reversible is adopted adami et al 2012 to ensure the stability simulation the time step must satisfy the cfl conditions 26 δ t 0 25 min h c v max δ t 0 125 min ρ h 2 μ δ t 0 25 min h g where v max is the maximum particle velocity in the calculation the minimum value of the above conditions is the numerical time step 4 numerical examples in this section five cases of the fluid structure coupling problems are simulated to demonstrate the stability and accuracy of the present two phase sph model for two dimensional simulation firstly the two phase dam break is presented and the ability of our model to deal with the impact between fluids is tested by the switch function based riemann solver dissipation then the sinking of a rectangle body is simulated to verify the accuracy for predicting multi degree motion of sinking body in the viscous two phase flow then the water entry of a wedge flat plate slamming on water and water entry of a catamaran are simulated with the change of the structure shape the influence of air on fluid structure coupling problems becomes more and more apparent it can test the ability of the present two phase sph model to deal with the complicated water entry problems these cases we select have been studied by many researchers adopted by experiment and numerical simulation 4 1 the dam break the dam break case is a typical violent free surface flow which involves the phenomena of the flow impacting on the solid wall and overturning breaking and merging of free surface this case can validate the accuracy of the proposed two phase model in predicting impact load capturing two phase flow interface and keeping the numerical stability in two phase flow it was also modeled by the sph method gong et al 2016 chen et al 2015 adami et al 2012 rezavand et al 2019 and experimented in literature buchner 2002 although the air has no effect on the motion of the water which has been proved by colagrossi and landrini 2003 the two phase flow simulation of dam break can capture the formation and collapse of the closed air cavity which is an exact reproduction of the natural phenomena of dam break the initial setup of the two phase dam break is shown in fig 2 which is the same as the experiment in buchner 2002 the length of the dam break is l w 1 2 m and the height of the dam break is h w 0 6 m where g 9 81 m s2 the length of the computational domain is l t 5 366h w the height is h t 3h w and the solid wall is simulated with free slip condition at each wall the water column of dam break is surrounded by the air in the sph simulation the reference density of water is ρ 0w 1000 kg m3 and the viscosity is μ w 0 001 pa s and the reference density of air is ρ 0a 1 kg m3 and the viscosity is μ a 1 0 10 5 pa s the initial particle spacing δx 0 005 m is used to discrete the computational domain the artificial sound speed for water is c w 10 gh w 0 5 and the time step is 1 0 10 6s the physical time is nondimensionalized by the gravity and dam break height the background pressure is p 0 1000pa the initial pressure distribution of dam break is also plotted as fig 2 which is derived by greco 2001 and given in eq 27 the initial setup is to simulate the process of water released from a gate in the experiment 27 p w x y ρ 0 w g h w y 8 ρ 0 w g h w π 2 n 1 2 n 1 2 e 2 n 1 π x 2 h w cos 2 n 1 2 h w π y fig 3 presents the pressure field distribution for water and the velocity field distribution for air at six instants of dam break evolution it can predict the main flow characteristics of break dam evolution at t g h w 0 5 2 41 the water front reaches the right wall and impacts the vertical wall then the water climbs along the right wall and the backward plunging jet forms at t g h w 0 5 5 92 subsequently it shows that the air cavity region is enclosed under the action of gravity then the water jet forms at t g h w 0 5 6 15 the two phase interface is captured clearly and the stable pressure field in water is simulated in the process of dam break evolution to visualize the effect of the new switch function based riemann solver dissipation in such two phase flow we show the results of phase distribution of dam break in fig 4 without this strategy the instable phenomena of particle penetration particle clumping and unnatural void can be observed when the water water impact occurs with the strategy the interface between two phases is captured clearly and smoothly and the numerical calculation will continue steadily through the comparison the effectiveness of the switch function based riemann solver dissipation in suppressing the numerical instability is validated in fig 5 for convergence study we show the time histories of surge wave front of dam break with four different particle resolution namely δx 0 04 m δx 0 02 m δx 0 01 m and δx 0 005 m the results from present model are compared with the experimental data buchner 2002 and an analytical solution ritter 1982 from the fig 5 we can see that the speed of front wave is slower in the experiment than that in the present simulation the main reasons for these differences are attributed to the uncertain factors existing in experiment which include measuring accuracy of the experiment the roughness of the water tank and so on the free slip condition is used in the present simulation after t g h w 0 5 1 7 the present results agree well with the results of shallow water theory ritter 1982 it can also be seen that the results from the present are convergence with the increasing particle spacing fig 6 shows the time histories of a pressure probe located at 0 19h w from the bottom of the right wall at t g h w 0 5 2 41 the surge wave front impacts the right wall in the fig 3 the pressure at the probe suddenly reaches the first peak then the water moves along the rigid wall and the pressure remains roughly invariant at t g h w 0 5 6 15 the air cavity closes the pressure reaches the maximum and a water jet is formed later due to the closed air cavity the pressure curve oscillates compared with the experiment second pressure peak of the present results is slightly larger and the occurrence time is later than the experiment it is also necessary to see that the present results in general agree well with the experimental results and the present two phase sph model is reliable in predicting the impact loads for the study of the energy conservation of the present two phase sph model the time histories of the total energy variation are shown in fig 7 the total energy variation δe is calculated by the method of the literature cao et al 2018 by contrasting the results of the present model without the switch function based riemann solver dissipation and the literature cao et al 2018 it can be observed that the curves of the energy loss show two significant turning point at the time of the water wall impact and the water water impact for the same resolution δx 0 005 the present two phase sph model produces a better conservation than the model in literature cao et al 2018 without the switch function based riemann solver dissipation it produces a best conservation while the simulation may not continue due to the numerical instability caused by strong impact it is shown in fig 4 a 4 2 sinking of a rectangle body to further validate the effectiveness of the new two phase sph method in predicting the translation and rotation of rigid the sinking of a rectangle body with the asymmetric distribution of mass in the two phase flow is simulated the setup is the same as that of finite volume particle method fvpm in barcaolo 2013 early sun et al 2015 used this case to validate their single fluid sph model against the fvpm results barcaolo 2013 the initial configuration of the system is shown in fig 8 the rectangle body has the length of l 1 0 m and the height of h 0 5l which is placed in a 4l 5l container the depth of water is h w 3l the mass center of the rectangle body is g 2 25l 3l the mass is m 1 0 kg m the mass of unit thickness is 1 0 kg in 2d numerical model and the inertia moment is i 0 083 kg m2 the container contains two phases the density of the heavier phase is set to ρ w 1 kg m3 and the kinematic viscosity is υ 2 10 3 m2 s and the density of the other phase is ρ a 1 10 3kg m3 and the kinematic viscosity is υ 1 10 3 m2 s the case is simulated in two dimensional space and the rectangle body freely sinks into the heavier phase under the gravity in which the rectangle body has three degrees motion the initial particle spacing is δx 0 01 m the time step is δt 5 10 6s the background pressure is p 0 1pa and the numerical sound speed of the heavier phase is c 0 10 3gh 0 5 the free slip boundary conditions are applied in the rectangle body and solid wall and the sponge layer is not used in this case to reveal the flow field structure of the sinking process of rectangle body the pressure field distribution for water and the velocity field distribution for air at eight instants are shown in fig 9 under the gravity and buoyancy the rectangle body with the asymmetric distribution of mass starts to sink and do rotational motion at t 0 75s the heavier phase slams the side wall of the rectangle body and the lighter phase cavity forms at t 1 91s the slamming load stops the further rotation of the body then the lighter phase in the cavity is seen escaping from the upper right corner of the body and a lighter phase cavity above the body forms at t 2 65s with the continuous sinking the lighter phase continuously escapes from the upper of the body finally the body continues to sink almost without rotational motions t 3 68s there is no pressure noise and two phase flow interface is smooth and clear in the sinking process in fig 10 the time histories of the horizontal displacement and the vertical displacement of the rectangle body are presented together with the results of finite volume particle fvpm without lighter phase from barcaolo 2013 four examples with different particle spacing δx 0 04 m δx 0 02 m δx 0 01 m and δx 0 005 m are simulated as the resolution increases from δx 0 04 m to δx 0 005 m the results of the horizontal displacement curve and the vertical displacement curve are convergent and in good coincidence with the fvpm results comparing the results of two methods in the horizontal displacement it can be found that the lighter phase has little effect on the horizontal motion of the rectangle body due to the influence of enclosed cavity of lighter phase and the present two phase flow sph model can well simulate such fluid structure coupling problems and can be a new technical means for the study on multi degree motion of body in two phase flow 4 3 water entry of a wedge water entry problems are very significant in ocean engineering fields in this section the proposed two phase sph model is used to simulate the wedge entry into the water the experiment of which is conducted by zhao et al 1996 this case not only validates the accuracy of the numerical calculation model in predicting the fluid force subjected on the structure and the motion characteristics of the structure but also tests the model s ability in capturing the flow characteristics of the lighter phase and in suppressing instability due to the strong impact in water entry problems as shown in fig 11 the total mass of the free falling wedge with d 0 5 m width and 1 0 m length is 241 kg in the experiment the mass of unit thickness is 241 kg in 2d numerical model the deadrise angle of the wedge is 30 and the entry water velocity is 6 15 m s the numerical water tank is b 7d wide and h 3d deep in order to improve the computational accuracy and capture the detailed flowing behaviors the particle spacing δx 0 005 m is used about 0 65 million particles are used in the numerical study and the time step is δt 2 10 6s the density and viscosity of the water are ρ w 1000 kg m3 and μ w 0 001 pa s and that of air are taken as ρ a 1 kg m3 and μ a 1 0 10 5 pa s respectively the background pressure is 1500pa besides the sponge layer is adopted in the solid boundary wall of the water tank to reduce the effect of pressure reflection on the flow field pressure and impact load on wedge fig 12 presents the snapshots of the wedge entry process in order to better observe the stability of the present model in simulating multiphase flows each snapshot presents the pressure field of water and the velocity field of air it can be seen that the velocity field of air keeps smooth and stable in the free falling process of wedge and air vortex field appears in the rear of wedge due to the pressure reducing when the wedge is approaching the water surface the air between wedge and water is seen escaping at high velocity at t 0 63s the wedge reaches the water which brings high pressure region in the water soon the water jet forms at t 0 64s to further demonstrate the stability of our sph model in long time numerical simulation of water entry problems it is simulated that the wedge further moves down after slamming water surface it can be observed that the air vortex generates outside the splashing jets at t 0 9s a clear interface between water air and solid wall and a stable pressure field are observed during the whole process of wedge entry in order to further illuminate the effect of the new switch function based riemann solver dissipation on such strong impact problems fig 13 shows the snapshots of wedge entry at t 0 67s adding this treatment technology or not without this treatment technology the unstable interface particle clumping and unnatural void regions can be observed as shown in fig 13 a the time histories of the fluid force acting on the wedge and the falling velocity are shown in the fig 14 comparing with the experimental data of zhao et al 1996 a good agreement can be observed minor deviations in the falling velocity can be seen the falling velocity of the present sph results goes down more quickly than the experiment which is likely due to the three dimensional effect in experiment it is also noted that there is almost no difference in the contact force and falling velocity between sph results with air and no air the effect of the air on the water entry of wedge can be ignored the present two phase sph model can predict the impacting loads and motion characteristics of structure very well in simulating such fluid structure coupling problems in order to study the convergence of the present method in water entry problems two cases of water entry of a wedge are carried out δx 0 01 m and δx 0 02 m fig 15 shows the comparisons of the simulation results the present method achieves convergence with increasing particle resolution 4 4 flat plate slamming on water in the present section the influence of the air on water entry of the flat plate is investigated past research lind et al 2015 has demonstrated that the air has little effect on low speed water entry problems in the water entry early stages especially the structures with the deep dead rise angle for the water entry plate with a low dead rise angle the air trapped underneath has a major effect on the structure subjected to water impact load the plate we simulate is the same as that in the experimental study is carried out by ma et al 2016 in the experiment the mass of plate is 32 kg the size is 0 25 m 0 25 m and the impact velocity of the free falling plate is 5 5 m s the width of water entry plate is 0 25 m in 2d simulation by our present two phase sph model in order to reduce the large amount of computation the initial distance from the free falling plate to water surface is 0 6 m and the initial velocity is 4 3 m s this treatment has no effect on the impact phenomenon the sketch of the simulation is shown in fig 16 the computational domain is 1 2 m 1 5 m and the water depth is h 0 8 m the physical properties of water and air are the same as the section 4 3 the particle spacing is δx 0 002 m the numerical sound speed of water is c w 60 m s the background pressure is p 0 2000pa and the time step is 1 5 10 5s to investigate the dynamics characteristic of the two phase flow in the water entry plate the fig 17 shows several snapshots of the computed process about water pressure field and air velocity field before t 0 12s the falling plate has no influence on the water surface the air velocity behind plate increases as the plate moves down air vortex zones forms at the both sides of plate where the velocity is much less than neighboring region at t 0 12s the plate does not touch the water surface the air between the plate and water is seen escaping quickly from the both sides of plate and the air is compressed and high pressure zone occurs in the water when t 0 13s the plate slams the water surface and water pressure increases dramatically there is still a small amount of air that could not have time to escape and is entrapped beneath the plate at t 0 132s the high pressure region of water enlarges and water jets form because of plate slamming on water at t 0 14s the high pressure region propagates far away and the jets continue to develop due to the sponge layer implemented inside the solid wall non physical pressure reflection phenomenon could not be seen considering the air effect fig 18 shows the time histories of the contact force on the plate from the present single phase sph model two phase sph model and experiment during the water entry process the time t 0 is the time of contact force peak it can be seen that the force peak and the changing gradient of the contact force curve in present single phase model are much larger than the others the main reason is that air is not considered in the single phase model and air cushion effect that can reduce slamming load cannot be shown in the respect of force peak the changing gradient of contact force and the duration of impact the two phase sph results are in general agreement with the experimental data ma et al 2016 and the minor deviation of the contact force peak can be seen due to the influence of three dimensional effect it also illustrates that the air can cushion the impact load of structure with a low dead rise angle in the water entry process 4 5 water entry of a catamaran one of the most challenging water entry problems in the two phase flow is the water entry of a catamaran which involves many dynamic problems such as the two phase flow coupling with the complex structure the complex air flow the distribution of flow field structure the impact loads the dynamic response of the structure and so on in this section the water entry catamaran with a 25 dead rise angle is simulated when the catamaran impacts the water the air beneath the catamaran cannot escape easily in our 2d simulation but the air can escape from the fore and aft of the 3d model in the whelan 2004 experiment the cabin effect will be more obvious when the catamaran touches the water surface the 2d catamaran model is shown in fig 19 in the fig 19 b the air model 1 is the same as that used by shahraki et al 2011 the width of this mode is 0 56 m the height of side wall is 0 19 m depth of the inward valley is 0 13 m the dead rise angle of the intermediate wedge is 25 and the mass is 72 25 kg m the mass of unit thickness is 72 25 kg in 2d numerical model for the study of the effect of air beneath the catamaran the air model 2 with short side wall in fig 19 c is added and simulated in addition to the height of side wall other parameters are the same as the air model 1 the computational domain is 1 8 m 1 8 m and the depth of water is 1 m which is the same as the experiment conducted by whelan 2004 in order to study the influence of air on the water entry catamaran the impact velocity of the catamaran in all models is 1 03 m s for the air model the initial velocity and initial distance between the intermediate wedge bottom and water surface are 0 85 m s and 0 082 m respectively the values of the no air model are 0 97 m s and 0 03 m the same as that in yan et al 2015 we adopt the present sph model to simulate this water entry problem the initial particle spacing is 0 003 m the time step is 1 0 10 5s the sound speed of water is 15 m s and the background pressure is 1000 pa the time evolutions of the catamaran acceleration are shown in fig 20 where the results of no air and air sph models are compared to the experiment data whelan 2004 it is clear that the results of the present sph solution without air have two peaks the first peak at t 61 5 ms is due to the impact on the intermediate wedge the second peak at t 88 5 is due to the water impact on the corner of the center wedge meeting the side panels the snapshots are shown in fig 21 however the sph acceleration of two peaks is higher than the acceleration recorded in the experiment and the experimental time histories are much smoother and gentler it can be concluded that the air cushion effects cannot be ignored in the simulation of a water entry catamaran as in the air model 1 large differences appear for the time histories of acceleration and the peak time relative to the experimental measurements the reason for these discrepancies is that the experiment builds the three degree model of water entry catamaran the air beneath the catamaran could escape easily from the fore and aft of the 3d model however in the air model 1 most air is trapped under the catamaran and cannot escape away at the peak time t 62 5 ms the snapshot is reported in fig 22 the center wedge does not touch the water surface due to the entrapped air and the acceleration peak occurs earlier than that in the experiment the same conclusion can be seen in yan et al 2015 the smooth and uniform pressure field across the interface can be observed in fig 22 a in order to reduce the excessive influence of the air cushion effects in 2d numerical model the air model 2 with shorter side wall is simulated at t 82 5 ms the snapshot of the peak acceleration of air model 2 is shown in fig 23 it can be seen that there is only a small amount of air trapped in the catamaran from fig 20 it is possible to observe that the changing gradient and peak time of the acceleration time histories are much closer to the experimental data than that in the air model 1 to further study the dynamic response of catamaran entry the time histories of the pressure at p4 are shown in fig 24 the location of point p4 is shown in fig 19 the results are compared with the experimental data whelan 2004 by comparing the fig 20 and the fig 24 it is possible to observe that the p4 pressure peak and the acceleration peak appear almost at the same time in our 2d model in the experiment the air can escape from the fore and aft of the 3d catamaran model and the peak pressure is caused by the direct impact of water which is similar to the no air model the results of the experiment show that the pressure increases slowly in early stage due to the influence of the air cushion effect and a sharp rise with an inflexion is on the pressure curve and a maximum value occurs although the pressure time curve of our no air model agrees well with the experimental results whelan 2004 it can be seen from the impact time that the cushioning effect of air cannot be reproduced by the no air model in the air model 1 and 2 the air beneath the catamaran cannot escape in time and is trapped under the catamaran and a smooth and gentle rise is on the pressure curve the p4 peak pressure is not caused by the direct impact of water but by the trapped air which occurs earlier than those in the no air model and experiment comparison between the results of air model 1 and 2 reducing the height of side wall can decrease the influence of air cushion effect of 2d model and delay the appearance of the peak pressure and the results of 2d air model 2 are closer to the 3d experimental data than the air model 1 through the numerical simulation of the water entry of a 2d catamaran it is proved that the present two phase sph model is suitable for the study of fluid structure coupling problems considering air cushion effect in engineering applications because of the limit of computational scale this paper only analyzed the 2d model of water entry catamaran by extending the 2d two phase sph model presented in this paper to 3d the whole dynamic process of catamaran entry can be reproduced 5 conclusion in the fluid structure coupling problems the effect of the air on the dynamic response of the water entry rigid structure is significant in this paper a new two phase sph model based on an improved riemann solver is presented for simulating the water entry problems of the two phase flow with large density ratios coupling with the structure four improved measures are made in this paper an intermediate pressure of a riemann form is developed and implemented in the discretized momentum equation and this term can decrease the riemann dissipation and simulate the two phase flows with different viscosity ratios the inter particle properties based on the harmonic mean are adopted to weaken the influence of the interfacial instability and increase precision of numerical computation considering the free slip or no slip condition at the wall one sided riemann problem is used to impose the fluid body interaction in two phase flow which could guarantee the stability of the intersection region between the solid wall and the two phase flow interface a switch function based riemann solver dissipation is introduced in the momentum equation such strategy could improve the instability of interface owing to the strong impact five fluid structure coupling examples are simulated by this new two phase sph model through rigorous comparisons with the existing numerical results and experimental data it is demonstrated that the present model can give accurate dynamic response solutions of structure and stable two phase flow field distribution it is also found that the effect of air on the water entry structure with a deep dead rise angle is great and the cushion effect can reduce the impact loads and protect the water entry structure from failure further work will be dedicated to studying the air cushion effect on the high speed impact problems by the two phase sph model described in this paper credit authorship contribution statement qiuzu yang investigation data curation writing original draft visualization fei xu formal analysis resources supervision funding acquisition yang yang software writing review editing jingyu wang methodology visualization investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national natural science foundation of china grant no 11972309 the national natural science foundation for young scientists of china grant no 11702220 the fundamental research funds for the central universities grant no 310201901a012 and overseas expertise introduction project for discipline innovation the 111 project grant no bp0719007 
22059,the effects of incident wave nonlinearity on motions of ships advancing in irregular waves are investigated here in statistical sense the study is carried out by exploiting the combination of hos method high order spectral method and time domain rankine source method incorporated with hobem higher order boundary element method in the proposed model hos method is employed to simulate nonlinear irregular wave fields in cubic order and rankine source method incorporated with hobem is applied to compute ship wave potential as well as disturbed potential the equations of motions of ship advancing with constant forward speed in nonlinear waves are further established instead of employing simplified steady flow models such as uniform stream steady ship wave potential is computed beforehand and applied to solve ship motions weakly nonlinear scheme considering nonlinear f k froude krylov and restoring forces is adopted the proposed model is first validated in the case of linear regular and irregular waves via comparisons to experiment data and then applied to three different irregular sea states defined by spectrum with respective bfis benjamin feir index a series of long time numerical simulations are carried out for both linear wave cases and nonlinear ones and the statistical properties of nonlinear incident waves and the induced influence on ship motions are investigated and further analyzed the analysis reveals that with large bfi the skewness and kurtosis of wave surface elevation manifest departures from gaussian values and the probability density function p d f of the surface elevation performs departures from gaussian behavior in nonlinear cases p d f of instantaneous motions and motion amplitudes as well as exceedance probability of motion amplitudes are notably different from their linear counterparts higher possibilities for large motions occur in nonlinear cases keywords hos method rankine source method hobem irregular waves statistical analysis wave nonlinearity 1 introduction of essence for the ship design is the accurate estimation of wave induced loads and motions of ships advancing in various sea states owing to its low cost and relative ease of computational performing the potential flow theory plays an important role in the current ship design currently there are two popular 3d time domain numerical approaches to estimate wave loads acting on ship hull based on the potential flow theory free surface green function method and rankine source method the former one only discretizes the hull boundary while employs the free surface green function to enforce the free surface conditions neumann kelvin linearized free surface condition and radiation condition by this method qiu and peng 2013 and sengupta et al 2016 have conducted simulations on motions of ship in waves however challenges come with this method when dealing with sea keeping problems of ships with flare as well as flat hulls at a relatively high froude numbers for one thing it is hard to evaluate transient green function efficiently and precisely for its numerical instability for another free surface green function is derived based on linearized free surface condition which confines the condition only to linear form and fails to take account of nonlinear influence the later one discretizes not only ship surface but also free surface kim et al 2011 zhang et al 2010 chen et al 2018 a b employed this method to investigate sea keeping problems of ships advancing in waves not only is the rankine source method using fundamental solution of 1 r of the laplace equation much more stable than green function method but also it could impose any form of free surface boundary conditions which overcomes the problems encountered in the adoption of green function method on consideration of free surface conditions double body linearized condition has gained a lot of popularity over last decades see nakos 1990 kring 1994 huang 1997 kim et al 2011 sclavounos and ma 2018 a b ma et al 2018 sclavounos et al 2019 fan et al 2019 li et al 2012 li et al 2019 for more information and recent developments in related fields however the double body flow assuming rigid free surface relies on the approximation of slow ships and is not the best suit for problems with relatively high froude numbers here adopted is the ship wave obtained by a nonlinear potential flow method see chen et al 2016 for details following chen et al 2018 a b in an effort to taking account of the effects that steady flow imposes on the unsteady motions of ships steady ship wave sw potential is solved beforehand and ship motion is evaluated with it considered in free surface and body boundary conditions it means that sw taken as steady flow is involved in the evaluation of m j terms and thus in the calculation of unsteady disturbed problems under no circumstances can the significance of accurate modelling of irregular sea waves with a proper description of the probability of extreme wave occurrence be ignored for it is essential to the critical performance safety even survival of marine structures to describe random wave fields researchers resort to a statistical description instead of deterministic description in linear case the surface is expected to be described by a gaussian distribution and the probability distribution for wave height under the narrow band approximation follows a rayleigh distribution longuet higgins 1952 furthermore a number of probability distributions with second order included have been proposed by researchers see tayfun 1980 forristall 2000 and references therein in spite of the fact that the skewness of the surface elevation narrower crests and broader troughs could be estimated accurately by the second order approximation it is far from enough in order to accurately predict the whole probability density function especially the tail of it i e the occurrence probability of large waves janssen 2009 stansell 2005 hence attention moved further to including the third order nonlinear interactions modulational instability also called benjamin feir instability benjamin and feir 1967 at cubic order remains the most plausible cause for the generation of rogue waves in deep water except for superposition of wave modes and effects of currents as well as bottom topography see janssen 2003 alber 1978 onorato et al 2001 onorato et al 2004 onorato et al 2013 the bfi benjamin feir index has been introduced as the mi criterion to assess the importance of mi for a given spectrum and it is related to the kurtosis so is the probability of high waves janssen 2003 onorato et al 2001 nonlinear schrodinger nls equations and their extended forms have been adopted to study wave statistics by many wave researchers e g onorato et al 2001 socquet juglard et al 2005 it requires narrow bandedness and slowly spatial and temporal modulations which confines its adoption two more general alternatives to nls are the zakharov equations zakharov 1968 and the mode coupling methods phillips 1960 west et al 1974 by extending both of the methods into a direct computational approaches the high order spectral hos method has been developed hos treats the nonlinear free surface condition with a pseudo spectral manner and accounts for nonlinear interactions up to the desired perturbation order presenting two merits of fast convergence and resolution quickness by means of ffts ever since the pioneering work of dommermuth and yue 1987 and west et al 1987 proposing hos method independently the same idea was exploited by numerous researchers to continue its development see ducrozet et al 2007 ducrozet et al 2012 bonnefoy et al 2010 most recently an open source solver called hos ocean is released and allowed to be developed under the terms of gnu general public license gplv3 ducrozet et al 2016 along with its wrapper program called grid2grid choi et al 2017 despite much effort on investigating statistical properties of nonlinear water waves little is done with the significance and influence of such nonlinear wave fields on motions of ship advancing with constant speed xiao et al 2019 combined hos method with a time domain model with diffraction and radiation problems solved through frequency to time transformation method and investigated nonlinear incident wave field effects while it only conducted short time simulations with no statistical analysis involved this gives the motivation to conduct time domain simulations of motions of ship advancing in nonlinear irregular wave fields and undertake statistical analysis of the nonlinear random waves and resultant influence on wave loads and ship motions the main objective and interest here in this paper hos is applied to simulate the incident random wave fields described in the earth based coordinates with the inclusion of cubic order and incorporated with a 3d time domain ship motion model calculated in the reference coordinates in the ship motion model 3d time domain rankine source method incorporated with hobem is proposed and developed to compute seakeeping problems for ship advancing in irregular wave conditions sw is evaluated and applied in free surface and ship surface boundary conditions when solving ship motions considering its effects on the description of ship motions chen et al 2016 hobem based on bi quadratic isoparametric elements is adopted here to discretize the boundary integral equation weakly nonlinearity assumption is chosen and froude krylov and hydrostatic forces are evaluated over the instantaneous wetted surface validation works are carried out with various ships at different froude numbers encountering linear regular and irregular waves the obtained results are compared with the related experimental data and the performance of the proposed model is assessed furthermore long time simulations of random waves with spectrum defined by different parameters are accomplished in both linear and nonlinear cases and those waves get introduced into the ship motion model the nonlinear wave statistics as well as the influence of its nonlinearity on ship motions are investigated in a statistical sense 2 rankine source method with hobem for time domain ship motion we deal with the problem of a 6 dof freely floating ship moving forward with constant speed u in the presence of nonlinear incoming waves based on potential theory three cartesian coordinates are used here and defined as shown in fig 1 the inertial frame o 0 x 0 y 0 z 0 is fixed in space in which x 0 axis directs to bow and y 0 axis points portside o x y z reference system translates with ship with o x y plane coinciding with undisturbed free surface x axis pointing to bow z axis vertically upwards o x y z fitted to the hull translates and rotates with ship o locates on midship while o passes through the center of gravity of ship total velocity potential ϕ could be expressed as the summation of steady flow potential ϕ s incident wave potential ϕ 0 and unsteady disturbance potential ϕ d which contains radiation and diffraction potential so is the total wave elevation 1 ϕ x y z t u x ϕ s x y z ϕ 0 x y z t ϕ d x y z t 2 ζ x y z t ζ s x y z ζ 0 x y z t ζ d x y z t detailed formulations concerning ϕ s ϕ d parts are given below in this section that of ϕ 0 will be shown in the following section with hos method 2 1 steady ship wave problem according to the potential flow theory steady flow potential satisfies laplace s equation within fluid domain ω nonlinear free surface conditions are employed on actual wavy free surface s f body boundary condition is set on exact body s b no free surface waves going upstream is set as the radiation condition it is shown as follows 3 2 ϕ s 0 ω u ϕ s x ζ s x ϕ s y ζ s y ϕ s z 0 s f z ζ s u ϕ s x 1 2 ϕ s ϕ s g ζ s 0 s f z ζ s ϕ s n u n 1 s b ϕ s ο 1 x 2 y 2 s source distribution method is applied to solve this problem with the help of the technique that source points are shifted slightly downstream from the collection points liu 2003 radiation condition gets satisfied in numerical computation 9 nodes biquadratic isoparametric panel is chosen in hobem and subsequently distributions of source strength among each panel are quadratic and continuous a station iteration method is applied sinkage and trim are considered and attitude of ship is adjusted in each iteration more details concerning numerical implementation refer to chen et al 2016 it is worthwhile to mention that compared with uniform stream assuming no disturbances and double body flow which assumes rigid free surface and slow ship the way ship wave problem gets tackled here allows more accurate prediction and provides better solution for unsteady problems chen et al 2016 2 2 unsteady disturbance problem 4 2 ϕ d 0 ω t u ϕ s ζ d ϕ d z ϕ s z 2 ϕ s z 2 ζ d ϕ s ζ 0 u ϕ s ζ s s f z 0 t u ϕ s ϕ d g ζ d ζ s ϕ s ϕ 0 u ϕ s 1 2 ϕ s ϕ s s f z 0 ϕ d n j 1 6 ξ j n j ξ j m j ϕ 0 n s b ϕ d 0 ϕ d n 0 ϕ d 0 s ϕ d 0 ϕ d t 0 t 0 s f z 0 assuming steady flow potential ϕ s and related wave elevation ζ s to be o 1 unsteady disturbance potential ϕ d and wave elevation ζ d to be o ε in which ε is a small quantity according to kring 1994 huang 1997 the free surface conditions are obtained by conducting taylor s expansion on z 0 and ignoring high order small quantities o ε 2 hence the initial boundary value problem of ϕ d could be defined as above instead of employing simplified m j term m 0 0 0 0 u 0 n 3 u 0 n 2 m j term employed here is 5 m 1 m 2 m 3 n u ϕ s m 4 m 5 m 6 n r u ϕ s in the calculation we only solve the first three terms and other terms can be calculated by 6 m 4 m 3 y m 2 z ϕ s y n 3 ϕ s z n 2 m 5 m 1 z m 3 x ϕ s z n 1 ϕ s x u n 3 m 6 m 2 x m 1 y ϕ s x u n 2 ϕ s y n 1 in order to improve stability and accuracy we follow kring 1994 and further decompose ϕ d into time local term ϕ l and memory term ϕ m 7 ϕ d x y z t ϕ l x y z t ϕ m x y z t the boundary condition of time local term ϕ l is given below 8 ϕ l n j 1 6 ξ j n j ξ j m j s b m e a n b o d y s u r f a c e ϕ l 0 s f the boundary condition of memory term ϕ m thus follows the remaining condition 9 ϕ m n ϕ 0 n s b mean body surface t u ϕ s ζ m ϕ l ϕ m ϕ s z 2 ϕ s z 2 ζ m ϕ s ζ 0 u ϕ s ζ s s f t u ϕ s ϕ m g ζ d ζ s ϕ s ϕ 0 u ϕ s 1 2 ϕ s ϕ s s f radiation condition is satisfied through adding artificial damping term 2 ν ζ ν 2 g ϕ ν cooling strength into free surface condition kinematic condition the boundary integral equation bie related to memory term ϕ m is discretized by hobem with 9 nodes biquadratic isoparametric panels refer to chen et al 2018 a for more information 3 hos method for incident wave flows a nonlinear model belonging to the family of hos schemes is implemented for incident fields a space fixed coordinate defined here coincides with o 0 x 0 y 0 z 0 described above in sec 2 the fluid domain is considered as a rectangular fluid domain and the velocity potential ϕ 0 satisfies the laplace equation within the fluid domain since we only cope with unidirectional regular and long crested irregular waves in deep water the bottom condition of impenetrability is exploited double periodic boundary conditions on horizontal plane are applied the nonlinear free surface conditions are expressed in the zakharov form zakharov 1968 10 ζ 0 t ζ 0 ϕ 0 s 1 ζ 0 ζ 0 ϕ 0 x y ζ 0 t z 0 z ζ 0 x y t ϕ 0 s t g ζ 0 1 2 ϕ 0 s ϕ 0 s 1 2 1 ζ 0 ζ 0 2 ϕ 0 x y ζ 0 t z 2 p f ρ z ζ 0 x y t where p f is the given pressure on free surface ϕ 0 s represents surface potential in incident problem hos method treats the nonlinear boundary conditions in a pseudo spectral manner solving the problem in a fourier domain it has been developed and tested extensively for a variety of wave interaction problems its solution is compared to experiments and other weakly fully nonlinear numerical prediction models dommermuth and yue 1987 west et al 1987 xiao et al 2013 toffoli et al 2010 a large number of free wave modes n x are used in the present simulation and nonlinear interactions up to cubic order are considered here in order to capture the third order nonlinearity involved in mi a relaxation period with duration t a and exponent parameter n are introduced for relieving the discrepancy between linear initial wave fields and fully nonlinear computations which otherwise induces numerical instability dommermuth 2000 in this study t a 10 t p n 4 is chosen for all nonlinear cases where t p is the peak period 4 equations of ship motion the 6 dof time domain motion equations of ship moving in nonlinear waves could be expressed according to newton s second law as the following expression chen et al 2018a 11 m ξ f f k f l f m f c where 12 f l i s b p l n i d s w h e r e p l ρ t u ϕ s ϕ l 13 f m i s b p m n i d s w h e r e p m ρ t u ϕ s ϕ m 14 f f k i s b p 0 n i d s w h e r e p 0 ρ ϕ 0 t 1 2 ρ ϕ 0 2 15 f c i s b ρ g z n i d s where m is the mass coefficients matrix i index represents related terms concerning i th modes f l and f m are evaluated on the mean body surface s b f f k and f c are the nonlinear forms and are evaluated on the exact wetted ship hull s b which is obtained by intersecting hull surface with instant wave profile and cubic b spline interpolation is used for the calculation of instantaneous wetted surface underwater grids need to be found out first at each step considering the instantaneous motions of ship the coordinates of offsets in reference coordinate system could be obtained and updated each time step based on the coordinate transformation and cubic b spline interpolation has been conducted to obtain the curved hull surface the intersection points between ship hull curve and free surface could be calculated via iteration method eg dichotomy once the intersection points have been detected the underwater parts would be reserved and the instantaneous wetted surface could be acquired via cubic b spline interpolations a sketch of exact wetted s175 body surface is shown for an instance in fig 2 the artificial spring is added in i th modes when i 1 2 6 i e the modes in horizontal plane since they do not show restoring stiffness we chose the fourth order adams bashforth moulton method for time marching it is worth noting that hos method is described in earth fixed coordinates while the ship motion is calculated in reference system hence coordinates need to be transformed in addition nonlinear incident wave model hos solver only transfers field information to the ship motion solver while the backward transferring is ignored moreover when solving unsteady disturbance problem linear incident field is employed for simplicity the flow chart of the whole simulation is plotted in fig 3 5 numerical results and analysis in numerical simulation a rectangular free surface truncated at finite distance is used and it gets split into three parts longitudinally which are downstream midship and upstream parts an example of grids and boundaries arrangements with s175 hull involved is provided in fig 4 the standards here of choosing reasonable domain size and grid size are consistent with chen et al 2018 a 3 0 λ 1 2 λ 1 5 λ are chosen for downstream upstream and transverse direction of the domain in this section we commence with the validation study linear regular waves and irregular waves are considered in the validation the performance of the hybrid model is evaluated through comparison between the obtained numerical results and experimental data series 60 with block coefficient c b 0 7 in a realistic scale and s175 at different froude numbers as well as encountering wave angles are chosen here and their main particulars are given in table 1 furthermore we investigate nonlinear wave statistics up to cubic order in irregular waves characterized by jonswap power spectrum with different bfis the influence that nonlinearity of incident wave field poses on ship motions is investigated in a statistical sense followed by related analysis and its implications 5 1 validation in linear regular and irregular waves 5 1 1 linear regular waves cases of s175 with flare at f n 0 275 in head oblique regular waves when β 120 150 are considered here nodes on s175 hull are 43 17 2 1462 for all regular wave cases here time step length δ t is chosen by controlling at least 120 steps for each encountering wave period and incident wave amplitude is fixed to be a 2 625 m for regular wave cases both airy waves serving as a theoretical reference and linear waves simulated by hos m 1 are introduced into the time domain model and the obtained results as well as experimental data ittc seakeeping committee 1978 are presented in figs 5 and 6 7 non dimensional raos in heave x 3 a x 3 a a roll x 4 a x 4 a k a and pitch x 5 a x 5 a k a and dimensionless frequency ω ω l g are employed in which x 3 a x 4 a x 5 a are motion amplitudes a wave amplitude k wave number l ship length ω wave natural frequency noting that non dimensional roll damping of s175 in oblique wave cases here is set as b 44 0 0045 5 1 2 linear irregular waves series 60 s60 with the block coefficient c b 0 7 and s175 at two different froude numbers in long crest irregular waves are our targeted cases here f n 0 15 and f n 0 25 for s60 f n 0 25 and f n 0 275 for s175 ittc power spectrum with peak period t p 12 4 s significant wave height h s 5 0 m is used for all cases of s175 in this part 43 17 2 1462 nodes are employed for s60 hull as well wave spectrum parameter settings are t p 8 8 s and h s 3 0 m for all cases of s60 in this part ittc spectra is typically 16 s ω 173 h s 2 t p 4 ω 5 exp 691 t p 4 ω 4 at first we carried out 20 times with each duration t d u r 1020 s and δ t 0 03 s for s175 at f n 0 275 results of 20 times are all processed by fourier analysis to be more detailed we obtain frequency amplitude relationship of motion responses through fourier analysis and then the results get their non dimensional forms by dividing frequency amplitude of input wave followed by smoothing operations over raw data by this way can we obtain raos in irregular waves for individual simulations and average values are considered later we conduct the simulation of t d u r 3000 s δ t 0 03 s once and acquire non dimensional raos by the same way the average values of 20 times and results of one time as well as experimental data ittc seakeeping committee 1978 are exhibited in fig 8 excellent agreement has been achieved between numerical results and experimental data then for the remaining cases we only launch calculations once with t d u r 3000 s δ t 0 03 s for cases of s175 and δ t 0 05 s for cases of s60 for each case for simplicity fig 9 provides an example of time history of calculation with t d u r 3000 s fig 10 fig 11 fig 12 show the results of current hybrid model and corresponding experimental data ittc seakeeping committee 1978 gerritsma et al 1976 fonseca and guedes soares 2004 in all cases in validation section we select grid that provides a fine resolution by applying the standard that wavelength dominant wavelength in irregular cases is described by 30 grid points for head wave cases comparisons of heave and pitch raos are focused while for oblique waves heave pitch as well as roll motions are considered comparisons show some slight distinctions and discrepancies between our simulations and experimental data for predictions of peak value those discrepancies may be induced by several factors for example we ignore the nonlinearity of radiation and diffraction forces which may contribute to such distinctions nevertheless generally speaking results that current model yields achieve satisfactory agreement with relevant experimental data over a vast range of frequencies which demonstrates the effectiveness and accuracy of proposed model it could accommodate hull forms with large flare and own extensive applicability we could safely conclude that the proposed model performs well yields results with satisfactory accuracy and efficiency for problems of ship with forward speed and is well adaptive to a wide range of incident wave length and encountering angles which means it is qualified enough for predicting motions of ships in irregular sea states representing real sea states and further conducting analysis based on the predictions this is of vital importance in practical design 5 2 simulations in nonlinear irregular waves in this section we perform long time simulations of ships advancing in large scale nonlinear irregular head waves in deep water with random phases specified by jonswap spectrum which is typically 17 s ω α g 2 ω 5 exp 5 4 ω ω p 4 γ exp ω ω p 2 2 σ 2 ω p 2 18 σ 0 07 ω ω p 0 09 ω ω p where α is the phillips parameter ω is the wave frequency ω p the peak wave frequency γ the peak enhancement factor defining spectral bandwidth a random superposition of sinusoidal waves with random phases assumed to be uniformly distributed in 0 2 π are chosen for the initial start three different pairs of γ and the significant height h s haven been chosen so that three sea states with corresponding bfis are defined the peak wave periods of all cases are fixed wave steepness is ε k p h s 2 k p the peak wave number phillip parameter α 3 279 e in which dimensionless energy density of wave field is estimated by e h s 4 2 non dimensional significant wave height h s h s λ p 2 π λ p peak wavelength tanaka 2001 ducrozet et al 2007 bfi is the ratio of wave steepness ε to the spectral bandwidth δ k k p 2 δ ω ω p δ ω is estimated by the half width at the half maximum of the spectrum onorato et al 2006 the values of the parameters involved for the input wave spectrum are summarized in table 2 since we consider nonlinearity influence linear irregular wave for each designed sea states will also be calculated in order to make comparison with nonlinear ones for all linear as well as nonlinear cases peak wavelengths and wave periods are fixed to be the same hence all the numerical settings are length of the computational domain l x 61 λ p 8539 40 m duration of the simulation t d 222 t p 2102 12 s grid number n x 2048 which means every peak wavelength includes 30 grid points time step d t t p 100 0 09469 s for nonlinear cases m 3 linear cases m 1 in order to gain enough samples for statistical analysis 20 realizations with the same imposed sea states are performed which is slightly small but enough to lay a qualitative analysis according to toffoli et al 2010 noting the values of significant height keep relatively stable during the whole simulation and decrease slightly when simulation time is relatively large referring the energy keeps stable during simulations 5 2 1 wave field analysis 5 2 1 1 skewness and kurtosis of surface elevation an initial guassian wave field with rayleigh distributed wave amplitude is used for initial condition which implies the third and the fourth order moment of the surface elevation i e the skewness and kurtosis are assumed to be 0 and 3 respectively note that skewness describes the vertical asymmetry of the wave file sharper wave crest and flatter wave though i e second order nonlinearity kurtosis serves as an indication of the occurrence of extreme events third order nonlinearity kurtosis and skewness are plotted in fig 13 as a function of time which is scaled by peak period as can be observed both skewness and kurtosis show a substantial departure from expected values for gaussian statistics as for skewness initially symmetric wave profile has been modified during the propagation and vertically asymmetric profile with narrower crests followed by wider trough deviations from linear value and subsequently gaussian statistics come then bound modes are the main culprits of this non normality mori et al 2007 noting that the results plotted above are extracted every ten peak period 10 t p it fails to give a clearly decreasing trend of skewness which is induced by spectral downshift as the wave propagates kurtosis manifests a notable departure from linear value as well as an indication of large wave occurrence it mainly depends on the dynamics of free waves as the wave field propagates it goes up and reaches it maximum and then decreases owing to the downshift of the spectral peak reducing the wave steepness such features demonstrated above are most obvious for case iii followed by case ii and the last case i the conclusions drew out here are in consistent with literatures socquet juglard et al 2005 onorato et al 2009 5 2 1 2 probability density function fig 14 depicts the probability density function p d f of the surface elevation at different time one for initial start the other for the time when kurtosis achieves its maximum value during the simulations the surface elevation is scaled by standard deviation σ of the concurrent signals of surface elevation the simulation results are compared with the normalized gaussian distributions it is observed that p d f exhibits a relatively remarkable deviation of both its tails from normal distribution for all cases especially in case iii according to the previous study socquet juglard et al 2005 onorato et al 2009 the effects concerning bound modes dominate the statistical properties and as wave propagates and evolves the effects bringing by free waves develop and manifest when the kurtosis reaches its maximum that helps explain the difference of p d f compared with normal distribution at different instant time it is worth mentioning that we gain similar results with previous studies concerning wave height and wave crest distribution against rayleigh distribution but since kurtosis is tightly related to large wave occurrence and wave field analysis is not our main interest here they are no longer presented here 5 2 2 ship motion analysis to launch investigation on how wave nonlinearity affects ship motions and how impressive the influence is we conduct simulations of s175 advancing in six different head sea states defined above for all realizations linear and nonlinear ones at f n 0 1 to be more clear we calculated 20 2000 s for six head sea conditions with d t 0 05 s phases of each wave component in linear cases are set to be identical with their nonlinear counterparts in order to compare according to kim and kim 2011 20 2000 s is enough for acquiring stable results and doing analysis based on such results standards for computational domain for free surface and hull grid keep the same with validation part for background volume grids uniform distributed grids are employed in both horizontal directions and the gird sizes are δ x 3 3 m δ y 1 35 m grids are not evenly distributed vertically instead girds are more intense near the free surface and the average grid size is δ z 0 8 m fig 15 provides time history of amidship encountering wave elevation ship motion responses and forces of one realization in case iii just for an example and helping to gain a picture of the difference between linear and nonlinear results we could find out that nonlinear cases exhibit larger restoring forces and larger motion responses than linear ones it does not only confines within case iii but it shows in all our cases table 3 records the significant heave and pitch motion amplitudes of linear simulations and their nonlinear ones to be more detailed we estimate the significant motions by averaging the largest one third amplitudes after exploiting zero up crossing analysis to obtain motion amplitudes obviously ships in nonlinear waves are excited to gain a larger motion than they are in corresponding linear waves for further illustrate the effects of nonlinear wave excitation and offer a clear explanation of obvious difference between the results in linear and nonlinear waves fig 16 provides comparison of the results obtained by three computational models in fig 16 linear wave linear f k fc refers to the results obtained from model with linear f k and restoring forces when ship advances in linear irregular wave m 1 nonlinear f k fc refers to the results obtained from model with nonlinear f k and restoring forces when ship advances in linear irregular wave m 3 nonlinear f k fc refers to the results obtained from model with nonlinear f k and restoring forces when ship advances in third order nonlinear irregular wave for comparison the linear wave and nonlinear wave involved here keep all initial wave fields the same it is shown in fig 16 that if the incident wave keeps the same the motions and forces do not manifest significant differences but as the incident wave excitation changing from linear wave field to nonlinear ones the resultant motions and forces perform an obvious difference the effects induced by wave field nonlinearity are such that it cannot be ignored especially for severe sea states under that situation may a little stronger response lead to capsize and catastrophic consequence fig 17 depicts the p d f of instantaneous heave and pitch motions for both linear and nonlinear cases compared with their corresponding gaussian distribution fig 18 plots the p d f of heave and pitch motion amplitudes compared with their rayleigh distributions fig 19 demonstrates the exceedance probability of motion amplitudes for linear and nonlinear cases deviations from gaussian distributions for instant motions and rayleigh distributions for motion amplitudes result from the fact that our model is weakly nonlinear model with many nonlinear effects considered thus we could capture motion nonlinearity for ships in both linear and nonlinear waves gaussian distribution slightly overestimates the probability of motions near still place and underestimates the probability of large motions moreover and most critically there are remarkable differences between linear and nonlinear cases for instantaneous motion distributions and motion amplitude distributions that the probability of large motions in nonlinear waves is notably larger than motions in linear waves with identical initial sea states which is extremely contributive to the design and check for ship in severe states aiming to keep it safe and do not capsize it is worth noting that even though we do not consider incident nonlinearity in the calculation of disturbed potential for the time being this would be reflected along with body nonlinearity in our later work currently some nonlinearities are taken into account when conducting calculation of disturbed potential and our main improvements are focused on nonlinear f k forces restoring forces as well as the instantaneous wetted hull based on nonlinear incident wave field simulated by hos method moreover the extensions to short crested irregular waves of 3d wave field simulations including direction spectrum and thus corresponding researches concerning ship motions are our next interests 6 concluding remarks the motivation of this paper lies on exploring statistically potential effects that incident wave field nonlinearity imposes on ship motions in a more realistic sea states it is crucial to the community of security checking for motion predictions in extremely severe sea states at stake is to accurately describe potential encountering sea conditions and corresponding ship motion responses a hybrid model proposed here combines hos method for wave simulation and time domain rankine source method incorporated with hobem for ship motion in which nonlinear f k and restoring forces are calculated over instantaneous wetted hull based on weakly nonlinear assumption hos is chosen for its capability of capturing cubic nonlinearity modulation instability with fast convergence and high accuracy a container ship s175 advancing at f n 0 275 in linear regular waves with different encountering wave angles β 120 β 150 β 180 then simulations of s175 moving at f n 0 275 as well as f n 0 25 and also s60 at f n 0 15 f n 0 25 in linear irregular waves are studied to verify the effectiveness and reliability of numerical models to predict ship motions in waves in regular cases waves simulated by hos m 1 and defined by airy wave theory are both introduced into the motion model they agree well with each other implying the introducing and combining work are successful further numerical results in both regular and irregular cases are compared with experimental data and agree with each other well demonstrating the extensive applicability of the proposed model to accommodate various hull forms with different speed in various sea states long time simulations of three different sea conditions characterized by different bfis of irregular random wave fields are conducted for 20 times in an effort to acquiring wave statistics hos method with third order nonlinearity is used to trace the evolution and propagation of statistical properties for an initially gaussian surface elevation skewness kurtosis p d f of the surface elevation are analyzed a strong deviation from gaussian statistics have been found due to nonlinear wave interactions yielding same conclusions with published references e g mori et al 2007 janssen 2003 onorato et al 2001 this further motivates us to launch studies on its influence on ship motions 20 2000 s for each six sea states linear and their nonlinear ones share same input spectrum and same phases that is to say they share same initial states are simulated and their results are analyzed p d f of ship instantaneous motions as well as motion amplitudes are drew out for linear and nonlinear ones compared with gaussian and rayleigh distribution in addition exceedance probability of motion amplitude is analyzed for linear and nonlinear cases aiming to see influence caused by wave nonlinearity slight distinctions between our simulations and norm distributions gaussian distribution and rayleigh distribution appear as our model is capable of catching nonlinear ship motions more interestingly and significantly differences between the values of p d f of motions and motion amplitudes for ship in linear and nonlinear waves aware us that wave field nonlinearity cannot be ignored especially for severe sea states where such nonlinearity may be fatal to ship safety this research offers valuable implications to ship design and security checking we would like to exert our efforts to further consider directionality credit authorship contribution statement qian xiao conceptualization data curation investigation methodology validation visualization writing original draft wenjun zhou investigation methodology validation renchuan zhu supervision writing review editing declaration of competing interest no conflict of interest exits in the submission of this manuscript and manuscript is approved by all authors for publication i would like to declare on behalf of my co authors that we have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper the work described was original research that has not been published previously and not under consideration for publication elsewhere in whole or in part all the authors listed have approved the manuscript that is enclosed acknowledgements this work was supported by the national natural science foundation of china grant no 51579147 
22059,the effects of incident wave nonlinearity on motions of ships advancing in irregular waves are investigated here in statistical sense the study is carried out by exploiting the combination of hos method high order spectral method and time domain rankine source method incorporated with hobem higher order boundary element method in the proposed model hos method is employed to simulate nonlinear irregular wave fields in cubic order and rankine source method incorporated with hobem is applied to compute ship wave potential as well as disturbed potential the equations of motions of ship advancing with constant forward speed in nonlinear waves are further established instead of employing simplified steady flow models such as uniform stream steady ship wave potential is computed beforehand and applied to solve ship motions weakly nonlinear scheme considering nonlinear f k froude krylov and restoring forces is adopted the proposed model is first validated in the case of linear regular and irregular waves via comparisons to experiment data and then applied to three different irregular sea states defined by spectrum with respective bfis benjamin feir index a series of long time numerical simulations are carried out for both linear wave cases and nonlinear ones and the statistical properties of nonlinear incident waves and the induced influence on ship motions are investigated and further analyzed the analysis reveals that with large bfi the skewness and kurtosis of wave surface elevation manifest departures from gaussian values and the probability density function p d f of the surface elevation performs departures from gaussian behavior in nonlinear cases p d f of instantaneous motions and motion amplitudes as well as exceedance probability of motion amplitudes are notably different from their linear counterparts higher possibilities for large motions occur in nonlinear cases keywords hos method rankine source method hobem irregular waves statistical analysis wave nonlinearity 1 introduction of essence for the ship design is the accurate estimation of wave induced loads and motions of ships advancing in various sea states owing to its low cost and relative ease of computational performing the potential flow theory plays an important role in the current ship design currently there are two popular 3d time domain numerical approaches to estimate wave loads acting on ship hull based on the potential flow theory free surface green function method and rankine source method the former one only discretizes the hull boundary while employs the free surface green function to enforce the free surface conditions neumann kelvin linearized free surface condition and radiation condition by this method qiu and peng 2013 and sengupta et al 2016 have conducted simulations on motions of ship in waves however challenges come with this method when dealing with sea keeping problems of ships with flare as well as flat hulls at a relatively high froude numbers for one thing it is hard to evaluate transient green function efficiently and precisely for its numerical instability for another free surface green function is derived based on linearized free surface condition which confines the condition only to linear form and fails to take account of nonlinear influence the later one discretizes not only ship surface but also free surface kim et al 2011 zhang et al 2010 chen et al 2018 a b employed this method to investigate sea keeping problems of ships advancing in waves not only is the rankine source method using fundamental solution of 1 r of the laplace equation much more stable than green function method but also it could impose any form of free surface boundary conditions which overcomes the problems encountered in the adoption of green function method on consideration of free surface conditions double body linearized condition has gained a lot of popularity over last decades see nakos 1990 kring 1994 huang 1997 kim et al 2011 sclavounos and ma 2018 a b ma et al 2018 sclavounos et al 2019 fan et al 2019 li et al 2012 li et al 2019 for more information and recent developments in related fields however the double body flow assuming rigid free surface relies on the approximation of slow ships and is not the best suit for problems with relatively high froude numbers here adopted is the ship wave obtained by a nonlinear potential flow method see chen et al 2016 for details following chen et al 2018 a b in an effort to taking account of the effects that steady flow imposes on the unsteady motions of ships steady ship wave sw potential is solved beforehand and ship motion is evaluated with it considered in free surface and body boundary conditions it means that sw taken as steady flow is involved in the evaluation of m j terms and thus in the calculation of unsteady disturbed problems under no circumstances can the significance of accurate modelling of irregular sea waves with a proper description of the probability of extreme wave occurrence be ignored for it is essential to the critical performance safety even survival of marine structures to describe random wave fields researchers resort to a statistical description instead of deterministic description in linear case the surface is expected to be described by a gaussian distribution and the probability distribution for wave height under the narrow band approximation follows a rayleigh distribution longuet higgins 1952 furthermore a number of probability distributions with second order included have been proposed by researchers see tayfun 1980 forristall 2000 and references therein in spite of the fact that the skewness of the surface elevation narrower crests and broader troughs could be estimated accurately by the second order approximation it is far from enough in order to accurately predict the whole probability density function especially the tail of it i e the occurrence probability of large waves janssen 2009 stansell 2005 hence attention moved further to including the third order nonlinear interactions modulational instability also called benjamin feir instability benjamin and feir 1967 at cubic order remains the most plausible cause for the generation of rogue waves in deep water except for superposition of wave modes and effects of currents as well as bottom topography see janssen 2003 alber 1978 onorato et al 2001 onorato et al 2004 onorato et al 2013 the bfi benjamin feir index has been introduced as the mi criterion to assess the importance of mi for a given spectrum and it is related to the kurtosis so is the probability of high waves janssen 2003 onorato et al 2001 nonlinear schrodinger nls equations and their extended forms have been adopted to study wave statistics by many wave researchers e g onorato et al 2001 socquet juglard et al 2005 it requires narrow bandedness and slowly spatial and temporal modulations which confines its adoption two more general alternatives to nls are the zakharov equations zakharov 1968 and the mode coupling methods phillips 1960 west et al 1974 by extending both of the methods into a direct computational approaches the high order spectral hos method has been developed hos treats the nonlinear free surface condition with a pseudo spectral manner and accounts for nonlinear interactions up to the desired perturbation order presenting two merits of fast convergence and resolution quickness by means of ffts ever since the pioneering work of dommermuth and yue 1987 and west et al 1987 proposing hos method independently the same idea was exploited by numerous researchers to continue its development see ducrozet et al 2007 ducrozet et al 2012 bonnefoy et al 2010 most recently an open source solver called hos ocean is released and allowed to be developed under the terms of gnu general public license gplv3 ducrozet et al 2016 along with its wrapper program called grid2grid choi et al 2017 despite much effort on investigating statistical properties of nonlinear water waves little is done with the significance and influence of such nonlinear wave fields on motions of ship advancing with constant speed xiao et al 2019 combined hos method with a time domain model with diffraction and radiation problems solved through frequency to time transformation method and investigated nonlinear incident wave field effects while it only conducted short time simulations with no statistical analysis involved this gives the motivation to conduct time domain simulations of motions of ship advancing in nonlinear irregular wave fields and undertake statistical analysis of the nonlinear random waves and resultant influence on wave loads and ship motions the main objective and interest here in this paper hos is applied to simulate the incident random wave fields described in the earth based coordinates with the inclusion of cubic order and incorporated with a 3d time domain ship motion model calculated in the reference coordinates in the ship motion model 3d time domain rankine source method incorporated with hobem is proposed and developed to compute seakeeping problems for ship advancing in irregular wave conditions sw is evaluated and applied in free surface and ship surface boundary conditions when solving ship motions considering its effects on the description of ship motions chen et al 2016 hobem based on bi quadratic isoparametric elements is adopted here to discretize the boundary integral equation weakly nonlinearity assumption is chosen and froude krylov and hydrostatic forces are evaluated over the instantaneous wetted surface validation works are carried out with various ships at different froude numbers encountering linear regular and irregular waves the obtained results are compared with the related experimental data and the performance of the proposed model is assessed furthermore long time simulations of random waves with spectrum defined by different parameters are accomplished in both linear and nonlinear cases and those waves get introduced into the ship motion model the nonlinear wave statistics as well as the influence of its nonlinearity on ship motions are investigated in a statistical sense 2 rankine source method with hobem for time domain ship motion we deal with the problem of a 6 dof freely floating ship moving forward with constant speed u in the presence of nonlinear incoming waves based on potential theory three cartesian coordinates are used here and defined as shown in fig 1 the inertial frame o 0 x 0 y 0 z 0 is fixed in space in which x 0 axis directs to bow and y 0 axis points portside o x y z reference system translates with ship with o x y plane coinciding with undisturbed free surface x axis pointing to bow z axis vertically upwards o x y z fitted to the hull translates and rotates with ship o locates on midship while o passes through the center of gravity of ship total velocity potential ϕ could be expressed as the summation of steady flow potential ϕ s incident wave potential ϕ 0 and unsteady disturbance potential ϕ d which contains radiation and diffraction potential so is the total wave elevation 1 ϕ x y z t u x ϕ s x y z ϕ 0 x y z t ϕ d x y z t 2 ζ x y z t ζ s x y z ζ 0 x y z t ζ d x y z t detailed formulations concerning ϕ s ϕ d parts are given below in this section that of ϕ 0 will be shown in the following section with hos method 2 1 steady ship wave problem according to the potential flow theory steady flow potential satisfies laplace s equation within fluid domain ω nonlinear free surface conditions are employed on actual wavy free surface s f body boundary condition is set on exact body s b no free surface waves going upstream is set as the radiation condition it is shown as follows 3 2 ϕ s 0 ω u ϕ s x ζ s x ϕ s y ζ s y ϕ s z 0 s f z ζ s u ϕ s x 1 2 ϕ s ϕ s g ζ s 0 s f z ζ s ϕ s n u n 1 s b ϕ s ο 1 x 2 y 2 s source distribution method is applied to solve this problem with the help of the technique that source points are shifted slightly downstream from the collection points liu 2003 radiation condition gets satisfied in numerical computation 9 nodes biquadratic isoparametric panel is chosen in hobem and subsequently distributions of source strength among each panel are quadratic and continuous a station iteration method is applied sinkage and trim are considered and attitude of ship is adjusted in each iteration more details concerning numerical implementation refer to chen et al 2016 it is worthwhile to mention that compared with uniform stream assuming no disturbances and double body flow which assumes rigid free surface and slow ship the way ship wave problem gets tackled here allows more accurate prediction and provides better solution for unsteady problems chen et al 2016 2 2 unsteady disturbance problem 4 2 ϕ d 0 ω t u ϕ s ζ d ϕ d z ϕ s z 2 ϕ s z 2 ζ d ϕ s ζ 0 u ϕ s ζ s s f z 0 t u ϕ s ϕ d g ζ d ζ s ϕ s ϕ 0 u ϕ s 1 2 ϕ s ϕ s s f z 0 ϕ d n j 1 6 ξ j n j ξ j m j ϕ 0 n s b ϕ d 0 ϕ d n 0 ϕ d 0 s ϕ d 0 ϕ d t 0 t 0 s f z 0 assuming steady flow potential ϕ s and related wave elevation ζ s to be o 1 unsteady disturbance potential ϕ d and wave elevation ζ d to be o ε in which ε is a small quantity according to kring 1994 huang 1997 the free surface conditions are obtained by conducting taylor s expansion on z 0 and ignoring high order small quantities o ε 2 hence the initial boundary value problem of ϕ d could be defined as above instead of employing simplified m j term m 0 0 0 0 u 0 n 3 u 0 n 2 m j term employed here is 5 m 1 m 2 m 3 n u ϕ s m 4 m 5 m 6 n r u ϕ s in the calculation we only solve the first three terms and other terms can be calculated by 6 m 4 m 3 y m 2 z ϕ s y n 3 ϕ s z n 2 m 5 m 1 z m 3 x ϕ s z n 1 ϕ s x u n 3 m 6 m 2 x m 1 y ϕ s x u n 2 ϕ s y n 1 in order to improve stability and accuracy we follow kring 1994 and further decompose ϕ d into time local term ϕ l and memory term ϕ m 7 ϕ d x y z t ϕ l x y z t ϕ m x y z t the boundary condition of time local term ϕ l is given below 8 ϕ l n j 1 6 ξ j n j ξ j m j s b m e a n b o d y s u r f a c e ϕ l 0 s f the boundary condition of memory term ϕ m thus follows the remaining condition 9 ϕ m n ϕ 0 n s b mean body surface t u ϕ s ζ m ϕ l ϕ m ϕ s z 2 ϕ s z 2 ζ m ϕ s ζ 0 u ϕ s ζ s s f t u ϕ s ϕ m g ζ d ζ s ϕ s ϕ 0 u ϕ s 1 2 ϕ s ϕ s s f radiation condition is satisfied through adding artificial damping term 2 ν ζ ν 2 g ϕ ν cooling strength into free surface condition kinematic condition the boundary integral equation bie related to memory term ϕ m is discretized by hobem with 9 nodes biquadratic isoparametric panels refer to chen et al 2018 a for more information 3 hos method for incident wave flows a nonlinear model belonging to the family of hos schemes is implemented for incident fields a space fixed coordinate defined here coincides with o 0 x 0 y 0 z 0 described above in sec 2 the fluid domain is considered as a rectangular fluid domain and the velocity potential ϕ 0 satisfies the laplace equation within the fluid domain since we only cope with unidirectional regular and long crested irregular waves in deep water the bottom condition of impenetrability is exploited double periodic boundary conditions on horizontal plane are applied the nonlinear free surface conditions are expressed in the zakharov form zakharov 1968 10 ζ 0 t ζ 0 ϕ 0 s 1 ζ 0 ζ 0 ϕ 0 x y ζ 0 t z 0 z ζ 0 x y t ϕ 0 s t g ζ 0 1 2 ϕ 0 s ϕ 0 s 1 2 1 ζ 0 ζ 0 2 ϕ 0 x y ζ 0 t z 2 p f ρ z ζ 0 x y t where p f is the given pressure on free surface ϕ 0 s represents surface potential in incident problem hos method treats the nonlinear boundary conditions in a pseudo spectral manner solving the problem in a fourier domain it has been developed and tested extensively for a variety of wave interaction problems its solution is compared to experiments and other weakly fully nonlinear numerical prediction models dommermuth and yue 1987 west et al 1987 xiao et al 2013 toffoli et al 2010 a large number of free wave modes n x are used in the present simulation and nonlinear interactions up to cubic order are considered here in order to capture the third order nonlinearity involved in mi a relaxation period with duration t a and exponent parameter n are introduced for relieving the discrepancy between linear initial wave fields and fully nonlinear computations which otherwise induces numerical instability dommermuth 2000 in this study t a 10 t p n 4 is chosen for all nonlinear cases where t p is the peak period 4 equations of ship motion the 6 dof time domain motion equations of ship moving in nonlinear waves could be expressed according to newton s second law as the following expression chen et al 2018a 11 m ξ f f k f l f m f c where 12 f l i s b p l n i d s w h e r e p l ρ t u ϕ s ϕ l 13 f m i s b p m n i d s w h e r e p m ρ t u ϕ s ϕ m 14 f f k i s b p 0 n i d s w h e r e p 0 ρ ϕ 0 t 1 2 ρ ϕ 0 2 15 f c i s b ρ g z n i d s where m is the mass coefficients matrix i index represents related terms concerning i th modes f l and f m are evaluated on the mean body surface s b f f k and f c are the nonlinear forms and are evaluated on the exact wetted ship hull s b which is obtained by intersecting hull surface with instant wave profile and cubic b spline interpolation is used for the calculation of instantaneous wetted surface underwater grids need to be found out first at each step considering the instantaneous motions of ship the coordinates of offsets in reference coordinate system could be obtained and updated each time step based on the coordinate transformation and cubic b spline interpolation has been conducted to obtain the curved hull surface the intersection points between ship hull curve and free surface could be calculated via iteration method eg dichotomy once the intersection points have been detected the underwater parts would be reserved and the instantaneous wetted surface could be acquired via cubic b spline interpolations a sketch of exact wetted s175 body surface is shown for an instance in fig 2 the artificial spring is added in i th modes when i 1 2 6 i e the modes in horizontal plane since they do not show restoring stiffness we chose the fourth order adams bashforth moulton method for time marching it is worth noting that hos method is described in earth fixed coordinates while the ship motion is calculated in reference system hence coordinates need to be transformed in addition nonlinear incident wave model hos solver only transfers field information to the ship motion solver while the backward transferring is ignored moreover when solving unsteady disturbance problem linear incident field is employed for simplicity the flow chart of the whole simulation is plotted in fig 3 5 numerical results and analysis in numerical simulation a rectangular free surface truncated at finite distance is used and it gets split into three parts longitudinally which are downstream midship and upstream parts an example of grids and boundaries arrangements with s175 hull involved is provided in fig 4 the standards here of choosing reasonable domain size and grid size are consistent with chen et al 2018 a 3 0 λ 1 2 λ 1 5 λ are chosen for downstream upstream and transverse direction of the domain in this section we commence with the validation study linear regular waves and irregular waves are considered in the validation the performance of the hybrid model is evaluated through comparison between the obtained numerical results and experimental data series 60 with block coefficient c b 0 7 in a realistic scale and s175 at different froude numbers as well as encountering wave angles are chosen here and their main particulars are given in table 1 furthermore we investigate nonlinear wave statistics up to cubic order in irregular waves characterized by jonswap power spectrum with different bfis the influence that nonlinearity of incident wave field poses on ship motions is investigated in a statistical sense followed by related analysis and its implications 5 1 validation in linear regular and irregular waves 5 1 1 linear regular waves cases of s175 with flare at f n 0 275 in head oblique regular waves when β 120 150 are considered here nodes on s175 hull are 43 17 2 1462 for all regular wave cases here time step length δ t is chosen by controlling at least 120 steps for each encountering wave period and incident wave amplitude is fixed to be a 2 625 m for regular wave cases both airy waves serving as a theoretical reference and linear waves simulated by hos m 1 are introduced into the time domain model and the obtained results as well as experimental data ittc seakeeping committee 1978 are presented in figs 5 and 6 7 non dimensional raos in heave x 3 a x 3 a a roll x 4 a x 4 a k a and pitch x 5 a x 5 a k a and dimensionless frequency ω ω l g are employed in which x 3 a x 4 a x 5 a are motion amplitudes a wave amplitude k wave number l ship length ω wave natural frequency noting that non dimensional roll damping of s175 in oblique wave cases here is set as b 44 0 0045 5 1 2 linear irregular waves series 60 s60 with the block coefficient c b 0 7 and s175 at two different froude numbers in long crest irregular waves are our targeted cases here f n 0 15 and f n 0 25 for s60 f n 0 25 and f n 0 275 for s175 ittc power spectrum with peak period t p 12 4 s significant wave height h s 5 0 m is used for all cases of s175 in this part 43 17 2 1462 nodes are employed for s60 hull as well wave spectrum parameter settings are t p 8 8 s and h s 3 0 m for all cases of s60 in this part ittc spectra is typically 16 s ω 173 h s 2 t p 4 ω 5 exp 691 t p 4 ω 4 at first we carried out 20 times with each duration t d u r 1020 s and δ t 0 03 s for s175 at f n 0 275 results of 20 times are all processed by fourier analysis to be more detailed we obtain frequency amplitude relationship of motion responses through fourier analysis and then the results get their non dimensional forms by dividing frequency amplitude of input wave followed by smoothing operations over raw data by this way can we obtain raos in irregular waves for individual simulations and average values are considered later we conduct the simulation of t d u r 3000 s δ t 0 03 s once and acquire non dimensional raos by the same way the average values of 20 times and results of one time as well as experimental data ittc seakeeping committee 1978 are exhibited in fig 8 excellent agreement has been achieved between numerical results and experimental data then for the remaining cases we only launch calculations once with t d u r 3000 s δ t 0 03 s for cases of s175 and δ t 0 05 s for cases of s60 for each case for simplicity fig 9 provides an example of time history of calculation with t d u r 3000 s fig 10 fig 11 fig 12 show the results of current hybrid model and corresponding experimental data ittc seakeeping committee 1978 gerritsma et al 1976 fonseca and guedes soares 2004 in all cases in validation section we select grid that provides a fine resolution by applying the standard that wavelength dominant wavelength in irregular cases is described by 30 grid points for head wave cases comparisons of heave and pitch raos are focused while for oblique waves heave pitch as well as roll motions are considered comparisons show some slight distinctions and discrepancies between our simulations and experimental data for predictions of peak value those discrepancies may be induced by several factors for example we ignore the nonlinearity of radiation and diffraction forces which may contribute to such distinctions nevertheless generally speaking results that current model yields achieve satisfactory agreement with relevant experimental data over a vast range of frequencies which demonstrates the effectiveness and accuracy of proposed model it could accommodate hull forms with large flare and own extensive applicability we could safely conclude that the proposed model performs well yields results with satisfactory accuracy and efficiency for problems of ship with forward speed and is well adaptive to a wide range of incident wave length and encountering angles which means it is qualified enough for predicting motions of ships in irregular sea states representing real sea states and further conducting analysis based on the predictions this is of vital importance in practical design 5 2 simulations in nonlinear irregular waves in this section we perform long time simulations of ships advancing in large scale nonlinear irregular head waves in deep water with random phases specified by jonswap spectrum which is typically 17 s ω α g 2 ω 5 exp 5 4 ω ω p 4 γ exp ω ω p 2 2 σ 2 ω p 2 18 σ 0 07 ω ω p 0 09 ω ω p where α is the phillips parameter ω is the wave frequency ω p the peak wave frequency γ the peak enhancement factor defining spectral bandwidth a random superposition of sinusoidal waves with random phases assumed to be uniformly distributed in 0 2 π are chosen for the initial start three different pairs of γ and the significant height h s haven been chosen so that three sea states with corresponding bfis are defined the peak wave periods of all cases are fixed wave steepness is ε k p h s 2 k p the peak wave number phillip parameter α 3 279 e in which dimensionless energy density of wave field is estimated by e h s 4 2 non dimensional significant wave height h s h s λ p 2 π λ p peak wavelength tanaka 2001 ducrozet et al 2007 bfi is the ratio of wave steepness ε to the spectral bandwidth δ k k p 2 δ ω ω p δ ω is estimated by the half width at the half maximum of the spectrum onorato et al 2006 the values of the parameters involved for the input wave spectrum are summarized in table 2 since we consider nonlinearity influence linear irregular wave for each designed sea states will also be calculated in order to make comparison with nonlinear ones for all linear as well as nonlinear cases peak wavelengths and wave periods are fixed to be the same hence all the numerical settings are length of the computational domain l x 61 λ p 8539 40 m duration of the simulation t d 222 t p 2102 12 s grid number n x 2048 which means every peak wavelength includes 30 grid points time step d t t p 100 0 09469 s for nonlinear cases m 3 linear cases m 1 in order to gain enough samples for statistical analysis 20 realizations with the same imposed sea states are performed which is slightly small but enough to lay a qualitative analysis according to toffoli et al 2010 noting the values of significant height keep relatively stable during the whole simulation and decrease slightly when simulation time is relatively large referring the energy keeps stable during simulations 5 2 1 wave field analysis 5 2 1 1 skewness and kurtosis of surface elevation an initial guassian wave field with rayleigh distributed wave amplitude is used for initial condition which implies the third and the fourth order moment of the surface elevation i e the skewness and kurtosis are assumed to be 0 and 3 respectively note that skewness describes the vertical asymmetry of the wave file sharper wave crest and flatter wave though i e second order nonlinearity kurtosis serves as an indication of the occurrence of extreme events third order nonlinearity kurtosis and skewness are plotted in fig 13 as a function of time which is scaled by peak period as can be observed both skewness and kurtosis show a substantial departure from expected values for gaussian statistics as for skewness initially symmetric wave profile has been modified during the propagation and vertically asymmetric profile with narrower crests followed by wider trough deviations from linear value and subsequently gaussian statistics come then bound modes are the main culprits of this non normality mori et al 2007 noting that the results plotted above are extracted every ten peak period 10 t p it fails to give a clearly decreasing trend of skewness which is induced by spectral downshift as the wave propagates kurtosis manifests a notable departure from linear value as well as an indication of large wave occurrence it mainly depends on the dynamics of free waves as the wave field propagates it goes up and reaches it maximum and then decreases owing to the downshift of the spectral peak reducing the wave steepness such features demonstrated above are most obvious for case iii followed by case ii and the last case i the conclusions drew out here are in consistent with literatures socquet juglard et al 2005 onorato et al 2009 5 2 1 2 probability density function fig 14 depicts the probability density function p d f of the surface elevation at different time one for initial start the other for the time when kurtosis achieves its maximum value during the simulations the surface elevation is scaled by standard deviation σ of the concurrent signals of surface elevation the simulation results are compared with the normalized gaussian distributions it is observed that p d f exhibits a relatively remarkable deviation of both its tails from normal distribution for all cases especially in case iii according to the previous study socquet juglard et al 2005 onorato et al 2009 the effects concerning bound modes dominate the statistical properties and as wave propagates and evolves the effects bringing by free waves develop and manifest when the kurtosis reaches its maximum that helps explain the difference of p d f compared with normal distribution at different instant time it is worth mentioning that we gain similar results with previous studies concerning wave height and wave crest distribution against rayleigh distribution but since kurtosis is tightly related to large wave occurrence and wave field analysis is not our main interest here they are no longer presented here 5 2 2 ship motion analysis to launch investigation on how wave nonlinearity affects ship motions and how impressive the influence is we conduct simulations of s175 advancing in six different head sea states defined above for all realizations linear and nonlinear ones at f n 0 1 to be more clear we calculated 20 2000 s for six head sea conditions with d t 0 05 s phases of each wave component in linear cases are set to be identical with their nonlinear counterparts in order to compare according to kim and kim 2011 20 2000 s is enough for acquiring stable results and doing analysis based on such results standards for computational domain for free surface and hull grid keep the same with validation part for background volume grids uniform distributed grids are employed in both horizontal directions and the gird sizes are δ x 3 3 m δ y 1 35 m grids are not evenly distributed vertically instead girds are more intense near the free surface and the average grid size is δ z 0 8 m fig 15 provides time history of amidship encountering wave elevation ship motion responses and forces of one realization in case iii just for an example and helping to gain a picture of the difference between linear and nonlinear results we could find out that nonlinear cases exhibit larger restoring forces and larger motion responses than linear ones it does not only confines within case iii but it shows in all our cases table 3 records the significant heave and pitch motion amplitudes of linear simulations and their nonlinear ones to be more detailed we estimate the significant motions by averaging the largest one third amplitudes after exploiting zero up crossing analysis to obtain motion amplitudes obviously ships in nonlinear waves are excited to gain a larger motion than they are in corresponding linear waves for further illustrate the effects of nonlinear wave excitation and offer a clear explanation of obvious difference between the results in linear and nonlinear waves fig 16 provides comparison of the results obtained by three computational models in fig 16 linear wave linear f k fc refers to the results obtained from model with linear f k and restoring forces when ship advances in linear irregular wave m 1 nonlinear f k fc refers to the results obtained from model with nonlinear f k and restoring forces when ship advances in linear irregular wave m 3 nonlinear f k fc refers to the results obtained from model with nonlinear f k and restoring forces when ship advances in third order nonlinear irregular wave for comparison the linear wave and nonlinear wave involved here keep all initial wave fields the same it is shown in fig 16 that if the incident wave keeps the same the motions and forces do not manifest significant differences but as the incident wave excitation changing from linear wave field to nonlinear ones the resultant motions and forces perform an obvious difference the effects induced by wave field nonlinearity are such that it cannot be ignored especially for severe sea states under that situation may a little stronger response lead to capsize and catastrophic consequence fig 17 depicts the p d f of instantaneous heave and pitch motions for both linear and nonlinear cases compared with their corresponding gaussian distribution fig 18 plots the p d f of heave and pitch motion amplitudes compared with their rayleigh distributions fig 19 demonstrates the exceedance probability of motion amplitudes for linear and nonlinear cases deviations from gaussian distributions for instant motions and rayleigh distributions for motion amplitudes result from the fact that our model is weakly nonlinear model with many nonlinear effects considered thus we could capture motion nonlinearity for ships in both linear and nonlinear waves gaussian distribution slightly overestimates the probability of motions near still place and underestimates the probability of large motions moreover and most critically there are remarkable differences between linear and nonlinear cases for instantaneous motion distributions and motion amplitude distributions that the probability of large motions in nonlinear waves is notably larger than motions in linear waves with identical initial sea states which is extremely contributive to the design and check for ship in severe states aiming to keep it safe and do not capsize it is worth noting that even though we do not consider incident nonlinearity in the calculation of disturbed potential for the time being this would be reflected along with body nonlinearity in our later work currently some nonlinearities are taken into account when conducting calculation of disturbed potential and our main improvements are focused on nonlinear f k forces restoring forces as well as the instantaneous wetted hull based on nonlinear incident wave field simulated by hos method moreover the extensions to short crested irregular waves of 3d wave field simulations including direction spectrum and thus corresponding researches concerning ship motions are our next interests 6 concluding remarks the motivation of this paper lies on exploring statistically potential effects that incident wave field nonlinearity imposes on ship motions in a more realistic sea states it is crucial to the community of security checking for motion predictions in extremely severe sea states at stake is to accurately describe potential encountering sea conditions and corresponding ship motion responses a hybrid model proposed here combines hos method for wave simulation and time domain rankine source method incorporated with hobem for ship motion in which nonlinear f k and restoring forces are calculated over instantaneous wetted hull based on weakly nonlinear assumption hos is chosen for its capability of capturing cubic nonlinearity modulation instability with fast convergence and high accuracy a container ship s175 advancing at f n 0 275 in linear regular waves with different encountering wave angles β 120 β 150 β 180 then simulations of s175 moving at f n 0 275 as well as f n 0 25 and also s60 at f n 0 15 f n 0 25 in linear irregular waves are studied to verify the effectiveness and reliability of numerical models to predict ship motions in waves in regular cases waves simulated by hos m 1 and defined by airy wave theory are both introduced into the motion model they agree well with each other implying the introducing and combining work are successful further numerical results in both regular and irregular cases are compared with experimental data and agree with each other well demonstrating the extensive applicability of the proposed model to accommodate various hull forms with different speed in various sea states long time simulations of three different sea conditions characterized by different bfis of irregular random wave fields are conducted for 20 times in an effort to acquiring wave statistics hos method with third order nonlinearity is used to trace the evolution and propagation of statistical properties for an initially gaussian surface elevation skewness kurtosis p d f of the surface elevation are analyzed a strong deviation from gaussian statistics have been found due to nonlinear wave interactions yielding same conclusions with published references e g mori et al 2007 janssen 2003 onorato et al 2001 this further motivates us to launch studies on its influence on ship motions 20 2000 s for each six sea states linear and their nonlinear ones share same input spectrum and same phases that is to say they share same initial states are simulated and their results are analyzed p d f of ship instantaneous motions as well as motion amplitudes are drew out for linear and nonlinear ones compared with gaussian and rayleigh distribution in addition exceedance probability of motion amplitude is analyzed for linear and nonlinear cases aiming to see influence caused by wave nonlinearity slight distinctions between our simulations and norm distributions gaussian distribution and rayleigh distribution appear as our model is capable of catching nonlinear ship motions more interestingly and significantly differences between the values of p d f of motions and motion amplitudes for ship in linear and nonlinear waves aware us that wave field nonlinearity cannot be ignored especially for severe sea states where such nonlinearity may be fatal to ship safety this research offers valuable implications to ship design and security checking we would like to exert our efforts to further consider directionality credit authorship contribution statement qian xiao conceptualization data curation investigation methodology validation visualization writing original draft wenjun zhou investigation methodology validation renchuan zhu supervision writing review editing declaration of competing interest no conflict of interest exits in the submission of this manuscript and manuscript is approved by all authors for publication i would like to declare on behalf of my co authors that we have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper the work described was original research that has not been published previously and not under consideration for publication elsewhere in whole or in part all the authors listed have approved the manuscript that is enclosed acknowledgements this work was supported by the national natural science foundation of china grant no 51579147 
